[{"tags": ["ruby"], "comments": [{"owner": {"reputation": 279749, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 6, "creation_date": 1510789610, "post_id": 47319232, "comment_id": 81589633, "body": "why would False == nil? are apples == oranges?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8651755"}, "edited": false, "score": 4, "creation_date": 1510789838, "post_id": 47319232, "comment_id": 81589696, "body": "Doesn&#39;t seem weird to me. They&#39;re different <i>types</i> of things. You&#39;ll find the same kind of thing in other languages. Try <code>False == None</code> in Python or <code>false == null</code> in JavaScript. In Python <code>False == 0</code>, but that&#39;s a quirk if you ask me. And in JavaScript, <code>null == undefined</code>, but that&#39;s pretty bizarre IMO. When things of different types are considered equal, that leads to all kinds of headaches, which is why it&#39;s recommended to use <code>===</code> in JS for example."}, {"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "edited": false, "score": 3, "creation_date": 1510789842, "post_id": 47319232, "comment_id": 81589697, "body": "Ruby isn&#39;t acting weird. It&#39;s per the spec. I think the expectations of what is &quot;normal&quot; is what&#39;s unwarranted. In Ruby, all values evaluate to <i>truthy</i> except for FALSE and nil which evaluate to <i>falsey</i>. (All of the comparisons shown in the question evaluate to false, and that is the behavior we expect, because that&#39;s whats documented in the language specification."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 3, "creation_date": 1510813858, "post_id": 47319232, "comment_id": 81596791, "body": "Your question is unclear. <code>fase == 0</code> is <code>false</code>, because <code>false</code> and <code>0</code> are not equal. They are completely different things that have absolutely nothing whatsoever to do with each other. Why <i>would</i> they be equal? It would help if you explain why you explain they should be equal, otherwise the simple answer to your question is just: &quot;because they aren&#39;t equal, and anything else just makes no sense&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 4530, "user_id": 2973474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100004343619888/picture?type=large", "display_name": "alexisdevarennes", "link": "https://stackoverflow.com/users/2973474/alexisdevarennes"}, "reply_to_user": {"reputation": 83, "user_id": 8897668, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k7LG-ltjGc8/AAAAAAAAAAI/AAAAAAAAAD0/YS9WptA4OfM/photo.jpg?sz=128", "display_name": "Chay Huan", "link": "https://stackoverflow.com/users/8897668/chay-huan"}, "edited": false, "score": 0, "creation_date": 1510790069, "post_id": 47319279, "comment_id": 81589784, "body": "@ChayHuan Glad I could help. Please consider marking the answer as correct."}, {"owner": {"reputation": 4530, "user_id": 2973474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100004343619888/picture?type=large", "display_name": "alexisdevarennes", "link": "https://stackoverflow.com/users/2973474/alexisdevarennes"}, "edited": false, "score": 0, "creation_date": 1510790264, "post_id": 47319279, "comment_id": 81589839, "body": "Updated :) Thank you very much!"}, {"owner": {"reputation": 4530, "user_id": 2973474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100004343619888/picture?type=large", "display_name": "alexisdevarennes", "link": "https://stackoverflow.com/users/2973474/alexisdevarennes"}, "edited": false, "score": 2, "creation_date": 1510790303, "post_id": 47319279, "comment_id": 81589851, "body": "Thank you for caring about our future sentient NLP engines in their attempts to learn Ruby!"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 83, "user_id": 8897668, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k7LG-ltjGc8/AAAAAAAAAAI/AAAAAAAAAD0/YS9WptA4OfM/photo.jpg?sz=128", "display_name": "Chay Huan", "link": "https://stackoverflow.com/users/8897668/chay-huan"}, "edited": false, "score": 0, "creation_date": 1510791127, "post_id": 47319279, "comment_id": 81590083, "body": "@ChayHuan Probably better to wait a while for other answers before accepting. There is no rush."}, {"owner": {"reputation": 4530, "user_id": 2973474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100004343619888/picture?type=large", "display_name": "alexisdevarennes", "link": "https://stackoverflow.com/users/2973474/alexisdevarennes"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1510791304, "post_id": 47319279, "comment_id": 81590119, "body": "@SagarPandya Which kind of other answers might there be? (Just out of curiosity, wonder what else could be covered)"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1510791987, "post_id": 47319279, "comment_id": 81590288, "body": "I guess we&#39;ll have to wait and see. Others may point out something new or provide a different explanation which may or may not be clearer. My previous comment is by no means a slight on your answer."}, {"owner": {"reputation": 4530, "user_id": 2973474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100004343619888/picture?type=large", "display_name": "alexisdevarennes", "link": "https://stackoverflow.com/users/2973474/alexisdevarennes"}, "edited": false, "score": 0, "creation_date": 1510792022, "post_id": 47319279, "comment_id": 81590298, "body": "no, I didnt take it like that at all. Im meant it more really curiously what else I might be able to cover, thats all :)"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1510793499, "post_id": 47319279, "comment_id": 81590734, "body": "Pedantry: Your JavaScript example would be better with <code>===</code> as <code>==</code> can do some surprising conversions. And careful with <code>null</code> in SQL, <code>null = null</code> is not true in SQL so SQL&#39;s <code>null</code> isn&#39;t quite the same as Ruby&#39;s <code>nil</code>."}, {"owner": {"reputation": 4530, "user_id": 2973474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100004343619888/picture?type=large", "display_name": "alexisdevarennes", "link": "https://stackoverflow.com/users/2973474/alexisdevarennes"}, "edited": false, "score": 0, "creation_date": 1510793553, "post_id": 47319279, "comment_id": 81590752, "body": "Updated - Thank you!"}], "tags": [], "owner": {"reputation": 4530, "user_id": 2973474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100004343619888/picture?type=large", "display_name": "alexisdevarennes", "link": "https://stackoverflow.com/users/2973474/alexisdevarennes"}, "is_accepted": false, "score": 5, "last_activity_date": 1510793541, "last_edit_date": 1510793541, "creation_date": 1510789789, "answer_id": 47319279, "question_id": 47319232, "link": "https://stackoverflow.com/questions/47319232/why-isnt-false-equal-to-nil/47319279#47319279", "title": "Why isn&#39;t &#39;false&#39; equal to &#39;nil&#39;?", "body": "<p>In Ruby, the only time <code>nil</code> will return <code>true</code> on a <code>==</code> comparison is when you do: <code>nil == nil</code></p>\n\n<p>You can read more about <code>nil</code> here:</p>\n\n<p><a href=\"https://ruby-doc.org/core-2.2.3/NilClass.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.3/NilClass.html</a></p>\n\n<p><code>nil</code> is the equivalent of <code>undefined</code> in JavaScript  or <code>None</code> in Python</p>\n\n<p>Consider in JavaScript:</p>\n\n<pre><code>&gt;&gt; (undefined === false)\n=&gt; false\n</code></pre>\n\n<p>Or Python:</p>\n\n<pre><code>&gt;&gt; (None == False)\n=&gt; False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "is_accepted": false, "score": 3, "last_activity_date": 1510855654, "last_edit_date": 1510855654, "creation_date": 1510794749, "answer_id": 47319966, "question_id": 47319232, "link": "https://stackoverflow.com/questions/47319232/why-isnt-false-equal-to-nil/47319966#47319966", "title": "Why isn&#39;t &#39;false&#39; equal to &#39;nil&#39;?", "body": "<h2>Nil and False (Equality)</h2>\n\n<p>Despite what many people new to the language may expect, <code>nil</code> and <code>false</code> are objects rather than language keywords. Consider <a href=\"https://ruby-doc.org/core-2.4.2/FalseClass.html\" rel=\"nofollow noreferrer\">FalseClass</a> which says:</p>\n\n<blockquote>\n  <p>The global value <code>false</code> is the only instance of class <code>FalseClass</code> and represents a logically false value in boolean expressions.</p>\n</blockquote>\n\n<p>Likewise, <a href=\"https://ruby-doc.org/core-2.4.2/NilClass.html\" rel=\"nofollow noreferrer\">NilClass</a> is:</p>\n\n<blockquote>\n  <p>[t]he class of the singleton object <code>nil</code>.</p>\n</blockquote>\n\n<p>When you use a method like <a href=\"https://ruby-doc.org/core-2.4.2/Comparable.html#method-i-3D-3D\" rel=\"nofollow noreferrer\">Comparable#==</a> to compare them, Ruby invokes the spaceship operator <code>&lt;=&gt;</code> on the instances since neither class defines the <code>#==</code> method. Because nil and false are not the same objects, and because neither overrides the basic equality operator, the expression <code>false == nil</code> will always be false.</p>\n\n<p>Likewise, an Integer like <code>0</code> is neither an instance of FalseClass nor NilClass. Both <code>false == 0</code> and <code>nil == 0</code> are therefore also false because neither instance evaluates to zero.</p>\n\n<h2>Truthy and Falsey (Conditionals)</h2>\n\n<p>For branching purposes, both <code>false</code> and <code>nil</code> evaluate as false in a conditional expression. Everything else evaluates as true.</p>\n\n<p>Consider the following non-idiomatic, contrived, but hopefully illustrative example of Ruby's basic truth tables:</p>\n\n<pre><code>def truth_table value\n  if value\n    true\n  else\n    false\n  end\nend\n\ntruth_table nil\n#=&gt; false\n\ntruth_table false\n#=&gt; false\n\ntruth_table true\n#=&gt; true\n\ntruth_table 'a'\n#=&gt; true\n\ntruth_table 0\n#=&gt; true\n\ntruth_table 1\n#=&gt; true\n</code></pre>\n\n<h2>Boolean Evaluation</h2>\n\n<p>Nil and false are semantically different in Ruby, and descend from different base classes. They are also not equal to each other. However, they can both be treated as \"not true\" for branching purposes or within a Boolean context. For example, consider the following idioms for casting a result as a Boolean true or false value:</p>\n\n<pre><code>!(nil)\n#=&gt; true\n\n!!(nil)\n#=&gt; false\n</code></pre>\n\n<p>You can use this idiom to shorten the previous truth table example to:</p>\n\n<pre><code># Convert any value to a Boolean.\ndef truth_table value\n  !!value\nend\n\n# Test our truth table again in a more compact but less readable way.\ntable = {}\n[nil, false, true, 'a', 0, 1].map { |v| table[v] = truth_table(v) }; table\n#=&gt; {nil=&gt;false, false=&gt;false, true=&gt;true, \"a\"=&gt;true, 0=&gt;true, 1=&gt;true}\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8897668, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k7LG-ltjGc8/AAAAAAAAAAI/AAAAAAAAAD0/YS9WptA4OfM/photo.jpg?sz=128", "display_name": "Chay Huan", "link": "https://stackoverflow.com/users/8897668/chay-huan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510855654, "creation_date": 1510789555, "last_edit_date": 1510816242, "question_id": 47319232, "link": "https://stackoverflow.com/questions/47319232/why-isnt-false-equal-to-nil", "title": "Why isn&#39;t &#39;false&#39; equal to &#39;nil&#39;?", "body": "<p><code>false</code> is not equal to <code>nil</code>, for example:</p>\n\n<pre><code>false == nil # =&gt; false\n</code></pre>\n\n<p>The same goes for <code>false</code> and <code>0</code>:</p>\n\n<pre><code>false == 0 # =&gt; false\n</code></pre>\n\n<p>You get the same result for <code>nil</code> and <code>0</code>:</p>\n\n<pre><code>nil == 0 # =&gt; false\n</code></pre>\n\n<p>Why does Ruby act like this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3049944, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eXCXb.png?s=128&g=1", "display_name": "Jeff B.", "link": "https://stackoverflow.com/users/3049944/jeff-b"}, "edited": false, "score": 0, "creation_date": 1510933955, "post_id": 47319839, "comment_id": 81661347, "body": "Unfortunately when I do that <code>args</code> is received as <code>nil</code>... it seems like I have some digging to do, but the call made is simply <code>email_service.send_many_async(email, recipients)</code> -- the strange thing is that I&#39;m able to create a demo test that works the way you describe (the only change I had to make, was to use <code>args</code> not <code>*args</code>) so really confused why it doesn&#39;t work with my actual case."}], "tags": [], "owner": {"reputation": 20292, "user_id": 29262, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42d4590355a1404230fbc9aff4dd377b?s=128&d=identicon&r=PG", "display_name": "Myron Marston", "link": "https://stackoverflow.com/users/29262/myron-marston"}, "is_accepted": true, "score": 1, "last_activity_date": 1510793723, "creation_date": 1510793723, "answer_id": 47319839, "question_id": 47318940, "link": "https://stackoverflow.com/questions/47318940/mocking-rspec-any-instance-of-method-return-value-relative-to-instances-actual/47319839#47319839", "title": "Mocking Rspec any_instance_of method return value relative to instance&#39;s actual args", "body": "<p>When you use <code>allow_any_instance_of(...).to receive(...).and_wrap_original</code>, the block receives the following:</p>\n\n<ul>\n<li>The original method</li>\n<li>The instance that received the message (in case you want to use any of the state of the instance in your block)</li>\n<li>The arguments passed by the caller, in order</li>\n</ul>\n\n<p>In your case, it sounds like you don't need to use the <code>EmailService</code> instance in your block, so you can just ignore that argument:</p>\n\n<pre><code>allow_any_instance_of(Emails::EmailService)\n  .to receive(:send_many_async)\n  .and_wrap_original { |m, _, *args| args[1].map { |recipient| Emails::EmailResult.new(recipient.email) } }\n</code></pre>\n\n<p>Alternately, I'd encourage you to consider if there's a way to improve the interface of <code>Emails::EmailService</code> so that you don't need to use <code>any_instance</code> (which suffers from these sorts of confusing usability problems and also tends to calcify existing designs instead of putting pressure on your design).  We talk about this in my book <a href=\"https://pragprog.com/book/rspec3/effective-testing-with-rspec-3\" rel=\"nofollow noreferrer\">Effective Testing with RSpec 3: Build Ruby Apps with Confidence</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 3049944, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eXCXb.png?s=128&g=1", "display_name": "Jeff B.", "link": "https://stackoverflow.com/users/3049944/jeff-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 47319839, "answer_count": 1, "score": 1, "last_activity_date": 1510945130, "creation_date": 1510787738, "last_edit_date": 1510945130, "question_id": 47318940, "link": "https://stackoverflow.com/questions/47318940/mocking-rspec-any-instance-of-method-return-value-relative-to-instances-actual", "title": "Mocking Rspec any_instance_of method return value relative to instance&#39;s actual args", "body": "<p>I'm running into an issue where I'm trying to mock out an async method in a service class, but I want the result set to be based on the inputs to the call.</p>\n\n<p>eg:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>allow_any_instance_of(Emails::EmailService)\n  .to receive(:send_many_async)\n  .and_wrap_original { |m, *args| args[1].map { |recipient| Emails::EmailResult.new(recipient.email) } }\n</code></pre>\n\n<p>The signature for this method is <code>send_many_async(email, users)</code> </p>\n\n<p>I don't think that <code>and_wrap_original</code> is behaving as I expect though, as when I print out the values for <code>m</code> and <code>args</code> I see:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>#&lt;Method: Emails::EmailService#__send_many_async_without_any_instance__(send_many_async)&gt;\n#&lt;Emails::EmailService:0x007fa5c4e1b448&gt;\n#&lt;Emails::MyEmail:0x007fa5c4e1b4e8&gt;\n</code></pre>\n\n<p>As in, where I would expect <code>arg[0]</code> to be the <code>email</code> object, and <code>arg[1]</code> to be the list of users -- instead <code>arg[0]</code> is the service I'm mocking and there is no users list at all (eg: an <code>arg[2]</code>)</p>\n\n<p>I effectively just want to confirm the method is called, and that the users are the count I expect them to be.</p>\n\n<p>Alternatively, if I could substitute the method for another on the same class that would work too (the non-async call) but I haven't been able to find a way to replace <code>:send_many_async</code> with the regular <code>:send_many</code> which is successfully mocked in another way (that I cannot apply here)</p>\n\n<p>Anyone succeed doing something like this? I was expecting <code>and_wrap_original</code> to provide what was passed into the instance's method, but clearly I am confused in this regard.</p>\n\n<p><em>Edit</em></p>\n\n<p>If anyone is wondering, here's a working test sample. It's unfortunately not working for me quite yet in my application but others may find it helpful.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class TestEmailSvc\n  def send_many_async(email, to_email_users, from_email_user: nil, send_at: nil)\n    puts 'Real one called!'\n  end\nend\n\nclass TestEmail\nend\n\nclass TestEmailUser\n  attr_reader :email\n  def initialize(email)\n    @email = email\n  end\nend\n\nclass TestEmailResult\n  attr_reader :user\n  def initialize(user)\n    @user = user\n  end\n\n  def status\n    :pending\n  end\nend\n\ndescribe 'Test Spec' do\n\n  it 'tests my mock' do\n    allow_any_instance_of(TestEmailSvc)\n      .to receive(:send_many_async)\n        .and_wrap_original { |m, _, args| args.map { |recipient| TestEmailResult.new(recipient) } }\n\n    svc = TestEmailSvc.new\n\n    users = [\n      TestEmailUser.new('email 1'),\n      TestEmailUser.new('email 2')\n    ]\n\n    results = svc.send_many_async(TestEmail.new, users)\n\n    expect(results.count).to eql 2\n  end\n\nend\n</code></pre>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "database", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "edited": false, "score": 0, "creation_date": 1510787543, "post_id": 47318762, "comment_id": 81588939, "body": "This seems to be a very simple question to answer, but I hesitate because your code confuses me. For example why is the class name for your Book model <code>Service</code> not <code>Book</code>?"}, {"owner": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "edited": false, "score": 0, "creation_date": 1510787546, "post_id": 47318762, "comment_id": 81588943, "body": "Several things: first, your class names are <code>Service</code> and <code>ServiceCategory</code> instead of <code>Book</code> and <code>BookCategory</code>.  Is this a typo?  If not, you need to define the <code>class_name</code> on your associations.  You mentioned that your <code>books</code> table has a <code>book_category_id</code> but the foreign key on your <code>ServiceCategory</code> model is <code>book_categories_id</code>.  This needs to match the name of the column in your database table.  Third, please show the code that sets <code>@book_categrories</code>.   The error you are getting is because <code>@book_categories</code> is <code>nil</code>."}, {"owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "reply_to_user": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "edited": false, "score": 0, "creation_date": 1510788073, "post_id": 47318762, "comment_id": 81589141, "body": "@TomAranda Code updated, thank you."}, {"owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "reply_to_user": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "edited": false, "score": 0, "creation_date": 1510788489, "post_id": 47318762, "comment_id": 81589285, "body": "@Toby1Kenobi, I am sorry. You right. It was my mistake. I updated the code, thank you."}, {"owner": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "edited": false, "score": 0, "creation_date": 1510789134, "post_id": 47318762, "comment_id": 81589486, "body": "I still don&#39;t see where <code>@book_categories</code> is being set.  Did you mean <code>@book.categories</code>?  Still, you do not have this relation on the <code>Book</code> model."}, {"owner": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "edited": false, "score": 0, "creation_date": 1510789719, "post_id": 47318762, "comment_id": 81589662, "body": "@AnthonyBrooks in your first paragraph you still have inconsistencies. Probably where you say &quot;my database copies <code>category.id</code> and put it in <code>book.category_id</code>&quot; you should have said &quot;my database copies <code>book_categories.id</code> and puts it in <code>book.book_categories_id</code>&quot;. Ironically this first paragraph has the correct naming conventions and your actual code gets the naming conventions all wrong."}], "answers": [{"comments": [{"owner": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "edited": false, "score": 0, "creation_date": 1510789208, "post_id": 47319149, "comment_id": 81589511, "body": "There is no indication in the question that the OP wants each book to have more than one category. Given that each book has one category the <code>has_many through</code> relationship is not appropriate."}, {"owner": {"reputation": 973, "user_id": 1693169, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b132e6176f5115b43f6a0c5446dea0c2?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/1693169/sean"}, "reply_to_user": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "edited": false, "score": 0, "creation_date": 1510811229, "post_id": 47319149, "comment_id": 81595767, "body": "I took the name <code>BookCategories</code> and implied that it was a join table.  My mistake."}], "tags": [], "owner": {"reputation": 973, "user_id": 1693169, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b132e6176f5115b43f6a0c5446dea0c2?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/1693169/sean"}, "is_accepted": false, "score": -1, "last_activity_date": 1510789015, "creation_date": 1510789015, "answer_id": 47319149, "question_id": 47318762, "link": "https://stackoverflow.com/questions/47318762/pull-data-from-multiple-tables-in-rails/47319149#47319149", "title": "Pull data from multiple tables in Rails", "body": "<p>I think you need to setup as <code>has_many through</code> relationship. This is a good place to start <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association</a></p>\n"}, {"comments": [{"owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "edited": false, "score": 0, "creation_date": 1510789414, "post_id": 47319168, "comment_id": 81589562, "body": "I am getting an error <code>undefined method book_categories</code>. Do I have to use <code>rake db:migrate</code>?"}, {"owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "edited": false, "score": 0, "creation_date": 1510789708, "post_id": 47319168, "comment_id": 81589656, "body": "Also, thank you for the advice, I will rename my table. Really appreciate."}, {"owner": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "reply_to_user": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "edited": false, "score": 0, "creation_date": 1510790687, "post_id": 47319168, "comment_id": 81589971, "body": "I&#39;ve edited my answer to show how to do some of the name fixing. You can keep the <code>book_</code> prefix on category if you want, but you really need to get the singular and plural thing right."}, {"owner": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "reply_to_user": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "edited": false, "score": 0, "creation_date": 1510790737, "post_id": 47319168, "comment_id": 81589980, "body": "Are you sure that the book table is named <code>book</code> not <code>books</code>? It really should be named <code>books</code>. Double-check that."}, {"owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "edited": false, "score": 0, "creation_date": 1510792399, "post_id": 47319168, "comment_id": 81590404, "body": "Thank you! I spent so much time to figure it out... Thank you for your help and time Toby."}, {"owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "edited": false, "score": 0, "creation_date": 1510811188, "post_id": 47319168, "comment_id": 81595752, "body": "I am sorry for being annoying. I did exactly what you told me to do (also renamed my table to <code>categories</code>). So, I can easily display <code>@book.category.id</code> and get what I want but when I change it to <code>@book.category.name</code>, I am getting an error <code>undefined method </code>name&#39; for #&lt;Book:0x007fed5283cfd8&gt;`, can you please tell me what I doing wrong? Thank you!"}, {"owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "edited": false, "score": 0, "creation_date": 1510811643, "post_id": 47319168, "comment_id": 81595902, "body": "Also, just to make it clear, in my <code>Book</code> controller, I also have <code>belongs_to :user, :foreign_key =&gt; &#39;user_id&#39;</code>."}, {"owner": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "reply_to_user": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "edited": false, "score": 0, "creation_date": 1510814079, "post_id": 47319168, "comment_id": 81596886, "body": "Sorry, I can&#39;t help further without seeing your code as it is now."}], "tags": [], "owner": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "is_accepted": true, "score": 1, "last_activity_date": 1510790923, "last_edit_date": 1510790923, "creation_date": 1510789105, "answer_id": 47319168, "question_id": 47318762, "link": "https://stackoverflow.com/questions/47318762/pull-data-from-multiple-tables-in-rails/47319168#47319168", "title": "Pull data from multiple tables in Rails", "body": "<p>First fix the naming problem you have going. I don't know how the books table got called \"book\" instead of \"books\" in the schema, but you might have to fix that first.</p>\n\n<p>Then category should be singular everywhere except the database table name. You need to make a migration to fix the foreign key and its index in the books table something like this:</p>\n\n<pre><code>class FixCategoryNaming &lt; ActiveRecord::Migration\n  def change\n    remove_column :books, :book_categories_id\n    add_reference :books, :book_category, index: true, foreign_key: true\n  end\nend\n</code></pre>\n\n<p>Then run <code>rails db:migrate</code> and check the schema looks ok</p>\n\n<p>Then in the <code>BookCategory</code> class change the line to simply</p>\n\n<pre><code>has_many :books\n</code></pre>\n\n<p>You need to add this line to your <code>Book</code> class</p>\n\n<pre><code>belongs_to :book_category\n</code></pre>\n\n<p>and change the validation for book_category to be this</p>\n\n<pre><code>validates :book_category_id, presence: true\n</code></pre>\n\n<p>Then in the view for book index you have a <code>@books</code> variable. You can get the book name and category name for each book like this:</p>\n\n<pre><code>&lt;% @books.each do |book| %&gt;\n  &lt;p&gt;&lt;%= book.book_name %&gt;&lt;/p&gt;\n  &lt;p&gt;&lt;%= book.book_categories.name %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 1, "accepted_answer_id": 47319168, "answer_count": 2, "score": 1, "last_activity_date": 1511644973, "creation_date": 1510786798, "last_edit_date": 1511644973, "question_id": 47318762, "link": "https://stackoverflow.com/questions/47318762/pull-data-from-multiple-tables-in-rails", "title": "Pull data from multiple tables in Rails", "body": "<p>I am new in Ruby on Rails and I am trying to make a book registration website. Everything works fine except category section. When a user assign a category to his book, my database copies <code>book_categories.id</code> and put it in <code>book.book_categories_id</code>. The website also have a profile page, where you can view user's book(s). My problem is to display a <code>category.name</code>, I searched a lot of similar problems but I have not found the right answer.</p>\n\n<p>Here is my book controller:</p>\n\n<pre><code>before_action :set_book, except: [:index, :new, :create]\nbefore_action :authenticate_user!, except: [:show]\n\ndef show\n  @photos = @book.photos\nend\n\ndef index\n  @books = current_user.books\nend\n\ndef new\n  @book = current_user.books.build\nend\n\ndef create\n  @book = current_user.books.build(books_params)\n  if @book.save\n    redirect_to listing_book_path(@book), notice: \"Saved.\"\n  else\n    flash[:alert] = \"Failed.\"\n    render :new\n  end\nend\n\nprivate \n  def set_book\n    @book = Book.find(params[:id])\n  end\n\n  def book_params\n    params.require(:book).permit(:book_categories_id, :book_name, :summary, :address, :price, :company_name)\n  end\n</code></pre>\n\n<p>As long as I understand, I have to allow my controller to have access to my category table but I do not know how. Also, all of my categories store in <code>seed.rb</code>.</p>\n\n<p>This is my <code>BookCategory.rb</code> model:</p>\n\n<pre><code>class BookCategory &lt; ActiveRecord::Base\n  has_many :books, :foreign_key =&gt; :book_categories_id\nend\n</code></pre>\n\n<p><code>Book.rb</code> model: </p>\n\n<pre><code>class Book &lt; ApplicationRecord\n  belongs_to :user, :foreign_key =&gt; 'user_id'\n  has_many :photos, dependent: :delete_all\n\n  validates :book_name, presence: true\n  validates :book_categories_id, presence: true\n\n  def cover_photo\n    if self.photos.length &gt; 0\n      self.photos[0].image.url\n    else\n      \"default/image-default.jpg\"\n    end\n  end\n\nend\n</code></pre>\n\n<p>My schema.rb:</p>\n\n<pre><code>create_table \"book_categories\", force: :cascade do |t|\n  t.string \"name\"\n  t.string \"subcategory\"\n  t.text \"description\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n\ncreate_table \"book\", force: :cascade do |t|\n  t.string \"book_name\"\n  t.text \"summary\"\n  t.string \"address\"\n  t.decimal \"price\", precision: 8, scale: 2\n  t.boolean \"active\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\n  t.integer \"user_id\"\n  t.float \"latitude\"\n  t.float \"longitude\"\n  t.string \"company_name\"\n  t.integer \"book_categories_id\"\n  t.index [\"book_categories_id\"], name: \"index_books_on_book_categories_id\"\nend\n</code></pre>\n\n<p>Usually, when I type <code>@book_categories.name</code>, I get an error:</p>\n\n<pre><code>undefined method `name' for nil:NilClass\n</code></pre>\n\n<p>And at the very end, it says <code>Parameters: {\"id\"=&gt;\"15\"}</code> whereas the <code>category.id</code> is different, and it passes <code>book.id</code> instead. </p>\n\n<p>What I am doing wrong?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "edited": false, "score": 0, "creation_date": 1510787067, "post_id": 47318635, "comment_id": 81588782, "body": "Maybe you don&#39;t need to use the scope.  The level filter is irrelevant now.  Just do <code>User.joins(:languages_users).where(language_id: [1,2])</code>"}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "reply_to_user": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "edited": false, "score": 0, "creation_date": 1510787203, "post_id": 47318635, "comment_id": 81588834, "body": "@jvnill thanks for the suggestions - the level needs to be there. The user can&#39;t have both languages with the same level. I&#39;m looking for a user with both languages at different levels (see the scope for exact levels for each)"}, {"owner": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "edited": false, "score": 0, "creation_date": 1510787986, "post_id": 47318635, "comment_id": 81589100, "body": "are you using Rails 5? This is done more easily in Rails 5 than in earlier versions."}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "reply_to_user": {"reputation": 3819, "user_id": 2871922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d263eb801e15c1691fc9431e29a8cf03?s=128&d=identicon&r=PG", "display_name": "Toby 1 Kenobi", "link": "https://stackoverflow.com/users/2871922/toby-1-kenobi"}, "edited": false, "score": 0, "creation_date": 1510788123, "post_id": 47318635, "comment_id": 81589163, "body": "@Toby1Kenobi yes - rails 5.0.1"}], "answers": [{"comments": [{"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1510861585, "post_id": 47319083, "comment_id": 81627842, "body": "I really like this solution and have been playing with it. When I do <code>User.seeking_proficiency_in(2).proficient_in(1)</code> it returns an empty array. When I do just <code>User.seeking_proficiency_in(2)</code> or <code>User.proficient_in(1)</code> It returns hundreds of users. Many of these users are in both arrays. Any thoughts as to why the combined query is returning an empty array? Thanks!"}, {"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "reply_to_user": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1510879877, "post_id": 47319083, "comment_id": 81635382, "body": "ahhh I think that&#39;s because of the level.  If you look at the sql, you&#39;ll see that it&#39;s trying to find languages_users records where the level &lt; 5 AND level &gt; 4 which will never be true.  trying to find a way to approach your situation."}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1510947274, "post_id": 47319083, "comment_id": 81668643, "body": "Language 1 needs to be less than level 5, AND language 2 needs to be level 5. Or the inverse can be true. Any suggestions how to pull that? Thank you!"}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1510947738, "post_id": 47319083, "comment_id": 81668906, "body": "I updated the original post with more details of the expected outcome. Thanks!"}, {"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "reply_to_user": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 1, "creation_date": 1511049010, "post_id": 47319083, "comment_id": 81697295, "body": "Sorry, I can&#39;t think of a Rails way to do this other than how you did it.  The only improvement I can think of is using ids for the intersection (use <code>pluck</code>) so you are not creating objects unnecessarily.  I&#39;ve added the sql tag for this question hoping some sql expert shed some light."}], "tags": [], "owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "is_accepted": false, "score": 3, "last_activity_date": 1510788571, "creation_date": 1510788571, "answer_id": 47319083, "question_id": 47318635, "link": "https://stackoverflow.com/questions/47318635/return-even-if-more-associations-than-scope-asks/47319083#47319083", "title": "Return even if more associations than scope asks", "body": "<p>I thought I wasn't just aware of the additional usage of <code>&amp;&amp;</code> and <code>||</code> recently added to ActiveRecord.  I think that's your issue there.</p>\n\n<p><code>@users</code> is effectively just <code>User.proficient_in(2)</code> because of how <code>&amp;&amp;</code> and <code>||</code> operators work.  See examples below</p>\n\n<pre><code>  &gt;&gt; nil &amp;&amp; true                            # nil\n  &gt;&gt; true &amp;&amp; 1                              # 1\n  &gt;&gt; [] &amp;&amp; 1                                # 1\n  &gt;&gt; User.where(id: 1) &amp;&amp; User.where(id: 2) # result will be the result of User.where(id: 2)\n</code></pre>\n\n<p>Since <code>User.where(...)</code> queries return an <code>ActiveRecord::Relation</code> object, the returned value is not falsy therefore the second part of your code (the one that comes after <code>||</code>) is never executed.</p>\n\n<p>In short, you cannot use <code>&amp;&amp;</code> and <code>||</code> to merge ActiveRecord queries.  Try the following instead</p>\n\n<pre><code> inverse = User.seeking_proficiency_in(2).proficient_in(1)\n @users = User.seeking_proficiency_in(1).proficient_in(2).or(inverse)\n</code></pre>\n"}], "owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1511048884, "creation_date": 1510786066, "last_edit_date": 1511048884, "question_id": 47318635, "link": "https://stackoverflow.com/questions/47318635/return-even-if-more-associations-than-scope-asks", "title": "Return even if more associations than scope asks", "body": "<p>I have <code>Users</code> and <code>Languages</code> tables, joined by <code>LanguagesUsers</code>. <code>LanguagesUsers</code> stores the <code>language_id</code>, <code>user_id</code>, and <code>level</code>.\n<code>Users</code> can have unlimited <code>LanguagesUsers</code>.</p>\n\n<p>I want to get all users who have any two languages. I have two scopes in my user model:</p>\n\n<pre><code>scope :seeking_proficiency_in, -&gt;(language) {\n  joins(:languages_users).where(\"level &lt; 5 and language_id = ?\", language)\n}\nscope :proficient_in, -&gt;(language) {\n  joins(:languages_users).where(\"level &gt; 4 and language_id = ?\", language)\n}\n</code></pre>\n\n<p>I want to pass two languages, and find users who have both these scopes. The query is like this:</p>\n\n<pre><code>@users =\n  (User.seeking_proficiency_in(1) &amp;&amp; User.proficient_in(2)) ||\n  (User.seeking_proficiency_in(2) &amp;&amp; User.proficient_in(1))\n</code></pre>\n\n<p>This returns all users who have both languages and the appropriate level of the languages. The issue is that <strong>user that have more than two languages are not included</strong>; only users with exactly the two languages are included.</p>\n\n<p>How can I get all users even if they have more languages than the two given?</p>\n\n<p>UPDATE \nTo give more context, this would work, but I feel there is a simple, one-two step version I am not comprehending:</p>\n\n<pre><code>learning = User.seeking_proficiency_in(1)\nfluent = User.proficient_in(2)\nmatches = learning &amp; fluent\n\nlearning = User.seeking_proficiency_in(2)\nfluent = User.proficient_in(1)\nsecond_matches = learning &amp; fluent\n\nall_matches = matches + second_matches\n</code></pre>\n"}, {"tags": ["ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 1087, "user_id": 86689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bpq2d.png?s=128&g=1", "display_name": "Neil Anderson", "link": "https://stackoverflow.com/users/86689/neil-anderson"}, "edited": false, "score": 0, "creation_date": 1510790992, "post_id": 47318575, "comment_id": 81590042, "body": "it could be, were you logged in as acmecorpapp when you ran the SQL yourself?"}], "answers": [{"comments": [{"owner": {"reputation": 1153, "user_id": 1448009, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8dacb74f712043e5f0a1143bdd83342d?s=128&d=identicon&r=PG", "display_name": "Scro", "link": "https://stackoverflow.com/users/1448009/scro"}, "edited": false, "score": 0, "creation_date": 1510843889, "post_id": 47321999, "comment_id": 81616228, "body": "ah - thank you! That seemed to work to fix the issue with <code>rake db:seed</code>. Only issue is that now there seems to be a persisting open connection, which prevents me from dropping the db: <code>acmecorp$ rake db:drop rake aborted! ActiveRecord::StatementInvalid: PG::ObjectInUse: ERROR:  cannot drop the currently open database</code>"}, {"owner": {"reputation": 307, "user_id": 5109793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36498fee1b7985307360dc86bbba25a8?s=128&d=identicon&r=PG&f=1", "display_name": "Chivorn Kouch", "link": "https://stackoverflow.com/users/5109793/chivorn-kouch"}, "reply_to_user": {"reputation": 1153, "user_id": 1448009, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8dacb74f712043e5f0a1143bdd83342d?s=128&d=identicon&r=PG", "display_name": "Scro", "link": "https://stackoverflow.com/users/1448009/scro"}, "edited": false, "score": 0, "creation_date": 1510844382, "post_id": 47321999, "comment_id": 81616641, "body": "@Scro Have you stopped your rails app?"}, {"owner": {"reputation": 1153, "user_id": 1448009, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8dacb74f712043e5f0a1143bdd83342d?s=128&d=identicon&r=PG", "display_name": "Scro", "link": "https://stackoverflow.com/users/1448009/scro"}, "edited": false, "score": 0, "creation_date": 1510851510, "post_id": 47321999, "comment_id": 81621880, "body": "I&#39;m not running a Rails app. Attempting to roll my own using only ActiveRecord, without all of the Rails framework. I&#39;m learning quite a bit about how ActiveRecord works with the database, but I&#39;m a bit flummoxed by some of these quirks. Guessing that there is some logic in the Rails configuration files etc that handles this, which I might be missing."}, {"owner": {"reputation": 1153, "user_id": 1448009, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8dacb74f712043e5f0a1143bdd83342d?s=128&d=identicon&r=PG", "display_name": "Scro", "link": "https://stackoverflow.com/users/1448009/scro"}, "edited": false, "score": 0, "creation_date": 1510854691, "post_id": 47321999, "comment_id": 81623876, "body": "Here&#39;s what I&#39;ve figured out: with <code>db_config_admin = db_config.merge({ &#39;database&#39; =&gt; &#39;postgres&#39;,&#39;schema_search_path&#39; =&gt; &#39;public&#39; })</code> I can create, drop, and migrate the db, but not run the <code>:seed</code> task. WIth <code>db_config.merge({ &#39;schema_search_path&#39; =&gt; &#39;public&#39; })</code> I can seed, but the create/drop/migrate tasks don&#39;t work..."}], "tags": [], "owner": {"reputation": 307, "user_id": 5109793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36498fee1b7985307360dc86bbba25a8?s=128&d=identicon&r=PG&f=1", "display_name": "Chivorn Kouch", "link": "https://stackoverflow.com/users/5109793/chivorn-kouch"}, "is_accepted": false, "score": 2, "last_activity_date": 1510808679, "creation_date": 1510808679, "answer_id": 47321999, "question_id": 47318575, "link": "https://stackoverflow.com/questions/47318575/ruby-postgres-activerecord-without-rails-undefined-table-error-relation/47321999#47321999", "title": "Ruby/Postgres ActiveRecord without Rails: Undefined Table ERROR: relation &quot;...&quot; does not exist", "body": "<p>Please check file <code>rakefile.rb</code>. It seems to you merge the wrong database. the database for development is <code>acmecorp_dev</code>, and you already have it in <code>db_config</code>. I think you don't have to merge <code>database</code> anymore. Try this:</p>\n\n<pre><code>require \"active_record\"\nrequire \"require_all\"\nrequire \"yaml\"\n\nnamespace :db do\n  env = 'development' || ENV['env']\n\n  db_config       = YAML::load(File.open('config/database.yml'))[env]\n  db_config_admin = db_config.merge({ 'schema_search_path' =&gt; 'public'})\n\n  ...\n\n  desc \"Seed the database\"\n    task :seed do\n    ActiveRecord::Base.establish_connection(db_config_admin)\n    require_all 'models/*.rb'\n    require_relative 'db/seeds.rb'\n end\n\n ...\n\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 307, "user_id": 5109793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36498fee1b7985307360dc86bbba25a8?s=128&d=identicon&r=PG&f=1", "display_name": "Chivorn Kouch", "link": "https://stackoverflow.com/users/5109793/chivorn-kouch"}, "edited": false, "score": 0, "creation_date": 1510894773, "post_id": 47336306, "comment_id": 81639076, "body": "Glad you have it figured out."}], "tags": [], "owner": {"reputation": 1153, "user_id": 1448009, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8dacb74f712043e5f0a1143bdd83342d?s=128&d=identicon&r=PG", "display_name": "Scro", "link": "https://stackoverflow.com/users/1448009/scro"}, "is_accepted": true, "score": 0, "last_activity_date": 1510855125, "creation_date": 1510855125, "answer_id": 47336306, "question_id": 47318575, "link": "https://stackoverflow.com/questions/47318575/ruby-postgres-activerecord-without-rails-undefined-table-error-relation/47336306#47336306", "title": "Ruby/Postgres ActiveRecord without Rails: Undefined Table ERROR: relation &quot;...&quot; does not exist", "body": "<p>Okay, figured this out, after Chivorn Kouch's suggestion above. Solution requires an additional db_config variable, and a modification to the <code>:seed</code> task.</p>\n\n<p>In the <code>rakefile.rb</code>:</p>\n\n<pre><code># rakefile.rb\nnamespace :db do\n  env = 'development' || ENV['env']\n\n  db_config       = YAML::load(File.open('config/database.yml'))[env]\n  db_config_admin = db_config.merge({ 'database' =&gt; 'postgres','schema_search_path' =&gt; 'public' })\n  # add following line to create variable for the :seed task\n  db_config_seed = db_config.merge({ 'schema_search_path' =&gt; 'public' })\n\n  ...\n\n  desc \"Seed the database\"\n  task :seed do\n    # change variable referenced in the connection line below\n    ActiveRecord::Base.establish_connection(db_config_seed)\n    require_all 'models/*.rb'\n    require_relative 'db/seeds.rb'\n    puts \"Database seeded.\"\n  end\n\n  ...\n\nend\n</code></pre>\n\n<p>With those changes, the commands all work as expected.</p>\n"}], "owner": {"reputation": 1153, "user_id": 1448009, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8dacb74f712043e5f0a1143bdd83342d?s=128&d=identicon&r=PG", "display_name": "Scro", "link": "https://stackoverflow.com/users/1448009/scro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 47336306, "answer_count": 2, "score": 1, "last_activity_date": 1510855125, "creation_date": 1510785661, "question_id": 47318575, "link": "https://stackoverflow.com/questions/47318575/ruby-postgres-activerecord-without-rails-undefined-table-error-relation", "title": "Ruby/Postgres ActiveRecord without Rails: Undefined Table ERROR: relation &quot;...&quot; does not exist", "body": "<p>Working on a small Ruby script to create and store data to a Postgres database. The app works just fine when it comes to creating and dropping the database, or running migrations. However, it fails when I attempt to run <code>rake db:seed</code>. The error message indicates that the table doesn't exist...but meanwhile if I run the same SQL script referenced in the error message, but in pgAdmin, it returns valid results. I'm wondering if there is something going on with the privileges granted to the user named in the <code>database.yml</code>, and if so, how would I address that in the script? Any help understanding this would be appreciated.</p>\n\n<p>Here is the error message I'm getting in the terminal:</p>\n\n<pre><code>acmecorp$ rake db:seed\nrake aborted!\nActiveRecord::StatementInvalid: PG::UndefinedTable: ERROR:  relation \"applications\" does not exist\nLINE 8:                WHERE a.attrelid = '\"applications\"'::regclass\n                                          ^\n:               SELECT a.attname, format_type(a.atttypid, a.atttypmod),\n                     pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod,\n                     c.collname, col_description(a.attrelid, a.attnum) AS comment\n                FROM pg_attribute a\n                LEFT JOIN pg_attrdef d ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n                LEFT JOIN pg_type t ON a.atttypid = t.oid\n                LEFT JOIN pg_collation c ON a.attcollation = c.oid AND a.attcollation &lt;&gt; t.typcollation\n               WHERE a.attrelid = '\"applications\"'::regclass\n                 AND a.attnum &gt; 0 AND NOT a.attisdropped\n               ORDER BY a.attnum\n/Users/thisguy/repositories/acmecorp/db/seeds.rb:1:in `&lt;top (required)&gt;'\n/Users/thisguy/repositories/acmecorp/rakefile.rb:30:in `require_relative'\n/Users/thisguy/repositories/acmecorp/rakefile.rb:30:in `block (2 levels) in &lt;top (required)&gt;'\n\nCaused by:\nPG::UndefinedTable: ERROR:  relation \"applications\" does not exist\nLINE 8:                WHERE a.attrelid = '\"applications\"'::regclass\n                                          ^\n/Users/thisguy/repositories/acmecorp/db/seeds.rb:1:in `&lt;top (required)&gt;'\n/Users/thisguy/repositories/acmecorp/rakefile.rb:30:in `require_relative'\n/Users/thisguy/repositories/acmecorp/rakefile.rb:30:in `block (2 levels) in &lt;top (required)&gt;'\nTasks: TOP =&gt; db:seed\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>My database.yml file:</p>\n\n<pre><code># config/database.yml\ndefault: &amp;default\n  host: 'localhost'\n  adapter: 'postgresql'\n  encoding: utf-8\n\ndevelopment:\n  &lt;&lt;: *default\n  database: 'acmecorp_dev'\n  username: 'acmecorpapp'\n</code></pre>\n\n<p>The Gemfile is pretty simple:</p>\n\n<pre><code># Gemfile\nsource 'https://rubygems.org'\n\ngem 'activerecord'\ngem 'require_all'\ngem 'pg'\n</code></pre>\n\n<p>I have a rakefile.rb to control the various tasks (edited to remove irrelevant items):</p>\n\n<pre><code># rakefile.rb\nrequire \"active_record\"\nrequire \"require_all\"\nrequire \"yaml\"\n\nnamespace :db do\n  env = 'development' || ENV['env']\n\n  db_config       = YAML::load(File.open('config/database.yml'))[env]\n  db_config_admin = db_config.merge({'database' =&gt; 'postgres', 'schema_search_path' =&gt; 'public'})\n\n  ...\n\n  desc \"Seed the database\"\n  task :seed do\n    ActiveRecord::Base.establish_connection(db_config_admin)\n    require_all 'models/*.rb'\n    require_relative 'db/seeds.rb'\n  end\n\n  ...\n\nend\n</code></pre>\n\n<p>As noted, all of the other tasks in the rakefile work without problem--it's just the <code>:seed</code> task that burps. I'm fairly confident it has something to do with the way the script is interacting with the database.</p>\n\n<p>Here is the seed file:</p>\n\n<pre><code># db/seeds.rb\nApplication.create({\n  ApplicationNumber:  1,\n  AccountNumber: 1234,\n  ApplVer:  1,\n  CreateDateTime:  \"1/2/2018\",\n  ExpirationDateTime:  \"1/5/2019\",\n  ApplicationStatus:  \"In process\",\n  ApprovedAmount:     1992.92,\n  AcceptedAmount:     92.92,\n  HomeAddressLine1:   \"1 Main Street\",\n  HomeAddressLine2:   \"\",\n  HomeAddressCity:    \"Thibodaux\",\n  HomeAddressState:   \"LA\",\n  HomeAddressZipCode: \"12345\"\n})\n</code></pre>\n\n<p>and finally, I have a simple model for the application, which the seeds.rb file references:</p>\n\n<pre><code># models/application.rb\nclass Application &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>Now the error message noted above is stating that `relation \"applications\" does not exist\"...but when I run the same SQL quoted in the message, directly in pgAdmin, here's what I get (apologies for formatting - couldn't figure out how to get it into a table efficiently):</p>\n\n<pre><code>attname|format_type|pg_get_expr|attnotnull|atttypid|atttypmod|collname|comment\nid|integer|nextval('applications_id_seq'::regclass)|t|23|-1||\nApplicationNumber|integer||f|23|-1||\nAccountNumber|integer||f|23|-1||\nApplVer|integer||f|23|-1||\nCreateDateTime|timestamp without time zone||f|1114|-1||\nExpirationDateTime|timestamp without time zone||f|1114|-1||\nApplicationStatus|character varying||f|1043|-1||\nApprovedAmount|numeric||f|1700|-1||\nAcceptedAmount|numeric||f|1700|-1||\nHomeAddressLine1|character varying||f|1043|-1||\nHomeAddressLine2|character varying||f|1043|-1||\nHomeAddressCity|character varying||f|1043|-1||\nHomeAddressState|character varying||f|1043|-1||\nHomeAddressZipCode|character varying||f|1043|-1||\nFileCreatedDate|timestamp without time zone||f|1114|-1||\ncreated_at|timestamp without time zone||t|1114|-1||\nupdated_at|timestamp without time zone||t|1114|-1||\n</code></pre>\n\n<p>So the bottom line seems to be:\n- the script is properly configured to work with PG - at least as far as creating, dropping, and migrating databases\n- the <code>rake db:seed</code> task is failing\n- the SQL reported in the error message on the command line works just fine when it is run through pgAdmin</p>\n\n<p>I'm not sure why the issue. Could it have something to do with privileges available to the <code>acmecorpapp</code> user that was assigned to the database in the <code>database.yml</code>..?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter", "rubygems"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510784513, "post_id": 47318281, "comment_id": 81587777, "body": "Do you have more than one <code>twitter.rb</code> in your <code>$LOAD_PATH</code>? It&#39;s possible you have an empty <code>twitter.rb</code> from your earlier experiments."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510784545, "post_id": 47318281, "comment_id": 81587790, "body": "Note that filenames should be all lower-case by tradition: <code>twitter_feed.rb</code> is preferable to what you have there."}, {"owner": {"reputation": 199, "user_id": 8761016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8093e5252e23c068ecc6166698601dc?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Doe", "link": "https://stackoverflow.com/users/8761016/frank-doe"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510784612, "post_id": 47318281, "comment_id": 81587815, "body": "@tadman How can I check this? Sorry, I am a beginner to the rails environment."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510784663, "post_id": 47318281, "comment_id": 81587837, "body": "You&#39;re going to have to look around and see which <code>twitter.rb</code> files you have present. The <code>find</code> command or even your Finder/Explorer can usually locate them quite easily. The gem itself will have one, plus possibly others if more than one copy of that gem is installed, such as different versions."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510784726, "post_id": 47318281, "comment_id": 81587867, "body": "You can also do <code>$LOAD_PATH.map { |p| File.expand_path(&#39;twitter.rb&#39;, p) }.select { |p| File.exist?(p) }</code> to see what turns up."}, {"owner": {"reputation": 199, "user_id": 8761016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8093e5252e23c068ecc6166698601dc?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Doe", "link": "https://stackoverflow.com/users/8761016/frank-doe"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510784918, "post_id": 47318281, "comment_id": 81587979, "body": "@tadman Running that command returned an empty array"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1510784967, "post_id": 47318281, "comment_id": 81588010, "body": "Through <code>irb</code> or through <code>rails c</code>? It should be done through the Rails console as that has all the load paths properly initialized. The ActiveSupport auto-loader might also latch on to any file called <code>twitter.rb</code> within your application, so search there as well."}, {"owner": {"reputation": 199, "user_id": 8761016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8093e5252e23c068ecc6166698601dc?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Doe", "link": "https://stackoverflow.com/users/8761016/frank-doe"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510785729, "post_id": 47318281, "comment_id": 81588316, "body": "Through <code>irb</code>. Doing so through <code>rails c</code> returns the <code>twitter.rb</code> from the gemfile:  <code>=&gt; [&quot;&#47;usr&#47;local&#47;rvm&#47;gems&#47;ruby-2.3.4&#47;gems&#47;twitter-6.2.0&#47;lib&#47;twit&zwnj;&#8203;ter.rb&quot;] </code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510785908, "post_id": 47318281, "comment_id": 81588386, "body": "Can you reproduce this problem outside of your Rails app?"}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 8761016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8093e5252e23c068ecc6166698601dc?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Doe", "link": "https://stackoverflow.com/users/8761016/frank-doe"}, "edited": false, "score": 1, "creation_date": 1510800999, "post_id": 47320651, "comment_id": 81592644, "body": "Thank you for your help and feedback!"}], "tags": [], "owner": {"reputation": 919, "user_id": 1742070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ea518131f69363dd9f9de02aa12904?s=128&d=identicon&r=PG", "display_name": "brainbag", "link": "https://stackoverflow.com/users/1742070/brainbag"}, "is_accepted": true, "score": 1, "last_activity_date": 1510799969, "creation_date": 1510799969, "answer_id": 47320651, "question_id": 47318281, "link": "https://stackoverflow.com/questions/47318281/nameerror-uninitialized-constant-twitter/47320651#47320651", "title": "NameError: Uninitialized constant Twitter", "body": "<p>It looks like you're trying to use <code>irb</code> instead of the Rails console to run your code. When you run through <code>irb</code> (or <code>pry</code>), you aren't actually loading the Rails environment, so none of the gems will be available. You can manually require them, but you still won't have access to the Rails environment. </p>\n\n<p>What you want to do instead is use <code>rails console</code> (or <code>rails c</code> for short).</p>\n\n<p>For example with irb, Twitter isn't loaded:</p>\n\n<pre><code>rails_dir \u00bb irb\n2.2.4 :001 &gt; Twitter\nNameError: uninitialized constant Twitter\n    from (irb):1\n    from /Users/bbugh/.rvm/rubies/ruby-2.2.4/bin/irb:11:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>With <code>rails c</code>, it works just fine:</p>\n\n<pre><code>rails_dir \u00bb rails c\nLoading development environment (Rails 5.0.1)\n2.2.4 :001 &gt; Twitter\n=&gt; Twitter\n</code></pre>\n\n<p>You can take all of those <code>require</code>s out of your initializer - Rails will require the gems automatically by that point. You just need to use <code>rails console</code> when you're doing console work with Rails.</p>\n"}], "owner": {"reputation": 199, "user_id": 8761016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8093e5252e23c068ecc6166698601dc?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Doe", "link": "https://stackoverflow.com/users/8761016/frank-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 47320651, "answer_count": 1, "score": 2, "last_activity_date": 1510799969, "creation_date": 1510784314, "last_edit_date": 1510798057, "question_id": 47318281, "link": "https://stackoverflow.com/questions/47318281/nameerror-uninitialized-constant-twitter", "title": "NameError: Uninitialized constant Twitter", "body": "<p>When I try to run any command that uses the Twitter API in the ruby console, I get the error <code>NameError: uninitialized constant Twitter</code>. </p>\n\n<p>I have named this <code>twitterFeed.rb</code> because I read that it should not be named <code>twitter.rb</code>. This file is placed in my <code>config/initializers</code> folder. I have ran <code>bundle install</code> already, and the line <code>gem 'twitter', '~&gt; 6.2'</code> is in my gem file. </p>\n\n<pre><code>require 'rubygems'\nrequire 'bundler/setup'\n\nrequire 'twitter'\nrequire 'json'\n\nclient = Twitter::REST::Client.new do |config|\n config.consumer_key = ENV['TWITTER_CONSUMER_KEY']\n config.consumer_secret = ENV['TWITTER_CONSUMER_SECRET']\n config.access_token = ENV['TWITTER_ACCESS_TOKEN']\n config.access_token_secret = ENV['TWITTER_ACCESS_TOKEN_SECRET']\nend\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1510783547, "post_id": 47318074, "comment_id": 81587278, "body": "without a leading comma? you could <code>string.split(%r{\\s})</code>"}, {"owner": {"reputation": 217, "user_id": 5614121, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-tQHo4e3wPag/AAAAAAAAAAI/AAAAAAAAAzE/tAyftVVFsvc/photo.jpg?sz=128", "display_name": "Elvyn Mejia", "link": "https://stackoverflow.com/users/5614121/elvyn-mejia"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1510783860, "post_id": 47318074, "comment_id": 81587451, "body": "Yup so basically for a string <code>&quot;id 10, 11&quot;</code> I only care about &quot;id 10&quot;.  After splitting I would end up with <code>[&quot;id&quot;, &quot;10&quot;]</code>"}, {"owner": {"reputation": 1230, "user_id": 3323777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b57e9b0115e6d0356bd4d7502d5cbb9?s=128&d=identicon&r=PG&f=1", "display_name": "eugene-nikolaev", "link": "https://stackoverflow.com/users/3323777/eugene-nikolaev"}, "edited": false, "score": 0, "creation_date": 1510784259, "post_id": 47318074, "comment_id": 81587642, "body": "Josh Brody, it splits on every space: [&quot;id&quot;, &quot;10,&quot;, &quot;11&quot;]"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1510784641, "post_id": 47318074, "comment_id": 81587827, "body": "What if there are two spaces after <code>,</code>? Should it split on the second space? Also, see <a href=\"https://ideone.com/XTcSsP\" rel=\"nofollow noreferrer\">ideone.com/XTcSsP</a>. Your question is too unclear. Please explain the expected output for the given example string, and why it should look like that."}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 1, "creation_date": 1510788863, "post_id": 47318074, "comment_id": 81589397, "body": "Without an idea of what you&#39;re looking to get as output, this is very confusingly worded. Also you haven&#39;t attempted to solve the problem, so I&#39;m voting to close."}], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 5614121, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-tQHo4e3wPag/AAAAAAAAAAI/AAAAAAAAAzE/tAyftVVFsvc/photo.jpg?sz=128", "display_name": "Elvyn Mejia", "link": "https://stackoverflow.com/users/5614121/elvyn-mejia"}, "edited": false, "score": 0, "creation_date": 1510784308, "post_id": 47318234, "comment_id": 81587662, "body": "what if only want <code>=&gt; [&quot;id&quot;, &quot;10&quot;]</code>"}], "tags": [], "owner": {"reputation": 1230, "user_id": 3323777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b57e9b0115e6d0356bd4d7502d5cbb9?s=128&d=identicon&r=PG&f=1", "display_name": "eugene-nikolaev", "link": "https://stackoverflow.com/users/3323777/eugene-nikolaev"}, "is_accepted": false, "score": 1, "last_activity_date": 1510784074, "creation_date": 1510784074, "answer_id": 47318234, "question_id": 47318074, "link": "https://stackoverflow.com/questions/47318074/ruby-regex-to-match-a-space-without-a-leading-comma/47318234#47318234", "title": "Ruby regex to match a space without a leading comma", "body": "<p>You need a <a href=\"https://stackoverflow.com/a/2973495/3323777\">lookbehind regex</a>:</p>\n\n<pre><code> 'id 10, 11'.split(/(?&lt;=[^,])[ ]/)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>=&gt; [\"id\", \"10, 11\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1510795483, "last_edit_date": 1510795483, "creation_date": 1510788071, "answer_id": 47319002, "question_id": 47318074, "link": "https://stackoverflow.com/questions/47318074/ruby-regex-to-match-a-space-without-a-leading-comma/47319002#47319002", "title": "Ruby regex to match a space without a leading comma", "body": "<p>You could use the regular expression</p>\n\n<pre><code>r = /(?&lt;!,) /\n</code></pre>\n\n<p>which reads, \"match one space not preceded by a space\" (<code>(?!,)</code> being a <em>negative lookbehind</em>).</p>\n\n<pre><code>\"fe, fi, fo and fum\".split r\n   #=&gt; [\"fe, fi, fo\", \"and\", \"fum\"]\n\"fe, fi,     fo\\nand fum\".split r\n   #=&gt; [\"fe, fi, \", \"\", \"\", \"\", \"fo\\nand\", \"fum\"]\n</code></pre>\n\n<p>If one wishes to break on one or more spaces not preceded by a comma, use</p>\n\n<pre><code>r = /(?&lt;!,) +/\n\"fe, fi,     fo\\nand fum\".split r\n  #=&gt; [\"fe, fi, \", \"fo\\nand\", \"fum\"]\n</code></pre>\n\n<p>To split on one or more whitespace characters not preceded by a comma, use</p>\n\n<pre><code>r = /(?&lt;!,)\\s+/\n\"fe, fi,     fo\\nand fum\".split r\n  #=&gt; [\"fe, fi, \", \"fo\", \"and\", \"fum\"]\n</code></pre>\n\n<p>It may prudent to first perform <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-lstrip\" rel=\"nofollow noreferrer\">String#lstrip</a>.</p>\n\n<pre><code>r = /(?&lt;!,)\\s+/\n\" fe, fi,     fo\\nand fum \".split r\n  #=&gt; [\"\", \"fe, fi, \", \"fo\", \"and\", \"fum\"]\n\" fe, fi,     fo\\nand fum \".lstrip.split r\n  #=&gt; [\"fe, fi, \", \"fo\", \"and\", \"fum\"]\n</code></pre>\n\n<p>Depending on requirements, one could instead take @elyvn's advice and write</p>\n\n<pre><code>r = /(?&lt;=[^,])\\s+/\n</code></pre>\n\n<p>which reads, \"match one or more whitespace characters preceded by a character other than a comma\" (<code>(?&lt;=[^,])</code> being <em>positive lookbehind</em>).</p>\n\n<pre><code>\" fe, fi,     fo\\nand fum \".split r\n  #=&gt; [\" fe, fi, \", \"fo\", \"and\", \"fum\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 1, "last_activity_date": 1510788351, "creation_date": 1510788351, "answer_id": 47319040, "question_id": 47318074, "link": "https://stackoverflow.com/questions/47318074/ruby-regex-to-match-a-space-without-a-leading-comma/47319040#47319040", "title": "Ruby regex to match a space without a leading comma", "body": "<p>No need for a regex, just split twice:</p>\n\n<pre><code>\"id 10, 11\".split(\",\").first.split #=&gt; [\"id\", \"10\"]\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 5614121, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-tQHo4e3wPag/AAAAAAAAAAI/AAAAAAAAAzE/tAyftVVFsvc/photo.jpg?sz=128", "display_name": "Elvyn Mejia", "link": "https://stackoverflow.com/users/5614121/elvyn-mejia"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1510799192, "answer_count": 3, "score": -5, "last_activity_date": 1510795483, "creation_date": 1510783454, "question_id": 47318074, "link": "https://stackoverflow.com/questions/47318074/ruby-regex-to-match-a-space-without-a-leading-comma", "closed_reason": "Needs details or clarity", "title": "Ruby regex to match a space without a leading comma", "body": "<p>How can I match a space without a leading comma?</p>\n\n<p>My use case is I would like to split a string on space without a leading comma e.g. <code>\"id 10, 11\"</code> </p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3", "aws-sdk", "bucket"], "answers": [{"comments": [{"owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "edited": false, "score": 0, "creation_date": 1510779792, "post_id": 47317103, "comment_id": 81585382, "body": "I get an error :   resp = s3.get_object(bucket:&#39;bucket-name&#39;, key:&#39;users.csv&#39;) NoMethodError: undefined method <code>get_object&#39; for #&lt;Aws::S3::Resource:0x007ff9e6a4a2a8 @client=#&lt;Aws::S3::Client&gt;&gt; \tfrom (irb):3 \tfrom &#47;Users&#47;bdisha&#47;.rvm&#47;rubies&#47;ruby-2.4.1&#47;bin&#47;irb:11:in </code>&lt;main&gt;&#39;"}, {"owner": {"reputation": 990, "user_id": 1463577, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/b5dff4a495ba3018bf1b3285ff599b30?s=128&d=identicon&r=PG", "display_name": "ExploringApple", "link": "https://stackoverflow.com/users/1463577/exploringapple"}, "reply_to_user": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "edited": false, "score": 0, "creation_date": 1510779969, "post_id": 47317103, "comment_id": 81585477, "body": "Hope you are using the v2 Ruby SDK (the aws-sdk-core gem) to download objects from Amazon S3."}, {"owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "edited": false, "score": 0, "creation_date": 1510780192, "post_id": 47317103, "comment_id": 81585587, "body": "here&#39;s the output of my gem list: \u279c   ~ gem list aws-sdk  *** LOCAL GEMS ***  aws-sdk (3.0.1, 2.9.15, 2.5.6)"}, {"owner": {"reputation": 919, "user_id": 1742070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ea518131f69363dd9f9de02aa12904?s=128&d=identicon&r=PG", "display_name": "brainbag", "link": "https://stackoverflow.com/users/1742070/brainbag"}, "reply_to_user": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "edited": false, "score": 0, "creation_date": 1510800427, "post_id": 47317103, "comment_id": 81592504, "body": "@Becks that error message says you&#39;re calling <code>get_object</code> on the <code>Resource</code> instead of the <code>Client</code>. The <code>Resource</code> API is for <a href=\"http://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/S3/Resource.html\" rel=\"nofollow noreferrer\">working with buckets</a>, which isn&#39;t what you want to do here. If you call <code>get_object</code> on the <code>Client</code> object as ExploringApple&#39;s code suggests, it should work."}], "tags": [], "owner": {"reputation": 990, "user_id": 1463577, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/b5dff4a495ba3018bf1b3285ff599b30?s=128&d=identicon&r=PG", "display_name": "ExploringApple", "link": "https://stackoverflow.com/users/1463577/exploringapple"}, "is_accepted": false, "score": 6, "last_activity_date": 1587574364, "last_edit_date": 1587574364, "creation_date": 1510779470, "answer_id": 47317103, "question_id": 47317042, "link": "https://stackoverflow.com/questions/47317042/how-to-download-the-content-of-a-file-from-s3-bucket-into-memory-with-ruby/47317103#47317103", "title": "How to download the content of a file from S3 bucket into memory with Ruby", "body": "<p>From the AWS Documentation:</p>\n\n<blockquote>\n  <p>Downloading Objects into Memory </p>\n  \n  <p>For small objects, it can be useful to get an object and have it available in your Ruby processes. If you\n  do not specify a <code>:target</code> for the download, the entire object is loaded\n  into memory into a StringIO object.</p>\n\n<pre><code>def import_from_s3 \n\n  #initiate the client\n  s3 = Aws::S3::Client.new({\n      region:            region,\n      access_key_id:     key_id,\n      secret_access_key: secret\n  })\n\n  #Get the object\n  resp = s3.get_object(bucket: bucket, key: key)\n\n resp.body\n #=&gt; #&lt;StringIO ...&gt; \n\n resp.body.read\n #=&gt; '...'\n</code></pre>\n  \n  <p>Call <code>#read</code> or <code>#string</code> on the StringIO to get the body as a String object.</p>\n</blockquote>\n\n<p>For more information see \"<a href=\"https://aws.amazon.com/blogs/developer/downloading-objects-from-amazon-s3-using-the-aws-sdk-for-ruby/\" rel=\"nofollow noreferrer\">Downloading Objects from Amazon S3 using the AWS SDK for Ruby</a>\".</p>\n"}], "owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4749, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1587574364, "creation_date": 1510779205, "last_edit_date": 1587573681, "question_id": 47317042, "link": "https://stackoverflow.com/questions/47317042/how-to-download-the-content-of-a-file-from-s3-bucket-into-memory-with-ruby", "title": "How to download the content of a file from S3 bucket into memory with Ruby", "body": "<p>I have a bucket in Amazon AWS S3 which has a file in it called <code>users.csv</code>.</p>\n\n<p>How can I load the content of this file from the S3 bucket into memory with Ruby so I can parse it?</p>\n\n<p>Here is my code: </p>\n\n<pre><code>require 'aws-sdk'\ns3 = Aws::S3::Resource.new(region: 'us-west-1')\nresp = s3.list_objects(bucket: 'bucket-name', max_keys: 1)\nresp.contents.each do |object|\n    puts #{object.value}\nend\n</code></pre>\n\n<p>When I tried this in IRB I got: </p>\n\n<pre><code>struct Aws::S3::Types::Object key=\"users.csv\", last_modified=2017-11-15 19:10:28 UTC, etag=\"\\\"9a3d50c07aa4aa6976037ce774294a26\\\"\", size=101, storage_class=\"STANDARD\", owner=struct Aws::S3::Types::Owner display_name=\"owner-name\", id=\"42093cfa4ccb23a8156cdab8500a41a10bdbf90deebb0ee8a3b340dd1e0c3622\"\n</code></pre>\n\n<p>How can I parse the content of <code>users.csv</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 3893560, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/bd7e813ec4b9991f415f36bcede77d04?s=128&d=identicon&r=PG&f=1", "display_name": "mute", "link": "https://stackoverflow.com/users/3893560/mute"}, "edited": false, "score": 0, "creation_date": 1510775332, "post_id": 47315960, "comment_id": 81582933, "body": "So &quot;to:&quot; is just the name of a parameter (to be explicit) of the &quot;get&quot; method? I recognize the second part, which is just a key-value pair for a hash."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510775467, "post_id": 47315960, "comment_id": 81583005, "body": "I don&#39;t think the <code>to</code> is optional for a <code>get</code>... I mean I don&#39;t know how Rails could guess where to map <code>&#47;dashboard</code> to some controller &amp; action, right?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510775584, "post_id": 47315960, "comment_id": 81583066, "body": "@MrYoshiji - Yeah, I was just looking at the <code>action_dispatch</code> source code &#39;cause I was feeling a little uncomfortable with my <code>optional</code> assertion. I think I&#39;ll remove that word as it feels imprecise."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1510775821, "post_id": 47315960, "comment_id": 81583203, "body": "Yeah just tested it, you cannot just use <code>get &#39;&#47;somewhere&#39;</code>, you have to pass a <code>:to</code> or a <code>:action</code> key/value (maybe others)"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1510776188, "post_id": 47315960, "comment_id": 81583375, "body": "Out of curiosity, to you get a <code>Wrong number of arguments</code> error? Or, does it barf for other reasons?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1510776677, "post_id": 47315960, "comment_id": 81583629, "body": "Yes. Both <code>to: &quot;dashboard#index&quot;</code> and <code>:as =&gt; &quot;dashboard&quot;</code> are simply key-value pairs. In general, I believe <code>key: value</code> is preferred over <code>:key =&gt; value</code>, although I find that in some instances, rails is finicky (or at least it seems finicky to me but I may be munging things up) and requires the <code>:key =&gt; value</code> format."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1510785294, "post_id": 47315960, "comment_id": 81588140, "body": "The only place I can think of that would require the <code>key =&gt; value</code> syntax would be if you want the key to be a string or any object that isn&#39;t a Symbol, so <code>SomeClass =&gt; &#39;some value&#39;</code> or <code>&#39;some string key&#39; =&gt; &#39;some value&#39;</code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1510788656, "post_id": 47315960, "comment_id": 81589333, "body": "Actually, the only place I&#39;ve <i>seemed</i> to experience any weirdness is in <code>routes.rb</code> when I do <code>only: [:index, :show, ...]</code>. It seemed like it wasn&#39;t processing the directive correctly. But, if I did <code>:only =&gt; [:index, :show, ...]</code>, all was good. Like I said, I may have mucked something up somewhere."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1510812213, "post_id": 47315960, "comment_id": 81596103, "body": "@jvillian: This makes no sense. Like almost all programming languages, Ruby does not allow libraries to change the fundamental syntax of the language. Rails <i>cannot possibly be finicky</i> about syntax, because Rais <i>cannot possibly know</i> about syntax. All the method knows is that it receives a <code>Hash</code> object as an argument. <i>How</i> that object was constructed, and which syntax was used to construct it, is something that it simply cannot possibly know. In fact, the difference between old-style and new-style symbolkey-value syntax is handled strictly by the parser, so <i>not even the interpreter</i> knows"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1510844187, "post_id": 47315960, "comment_id": 81616454, "body": "@J&#246;rgWMittag: Thank you for the very thoughtful and illuminating comment! As a self-taught programmer, it is very helpful to be reminded of the fundamentals."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 2, "last_activity_date": 1510776397, "last_edit_date": 1510776397, "creation_date": 1510774988, "answer_id": 47315960, "question_id": 47315898, "link": "https://stackoverflow.com/questions/47315898/confused-about-ruby-on-rails-routes-rb-syntax/47315960#47315960", "title": "Confused about Ruby on Rails routes.rb syntax", "body": "<p>You're very close. </p>\n\n<p>Yes, <code>get</code> is a method that is being called. In ruby, you can omit the parentheses. So, </p>\n\n<pre><code>get '/dashboard', to: 'dashboard#index', :as =&gt; 'dashboard'\n</code></pre>\n\n<p>Is the same as:</p>\n\n<pre><code>get(\"/dashboard\", to: \"dashboard#index\", :as =&gt; \"dashboard\")\n</code></pre>\n\n<p>Where <code>to:</code> and <code>:as</code> are named parameters which are received by <code>get</code> as a <code>hash</code>.</p>\n\n<p>I <em>think</em> this method is defined in <code>action_dispatch/routing/mapper.rb</code>:</p>\n\n<pre><code>module ActionDispatch\n  module Routing\n    class Mapper\n\n      module HttpHelpers\n        # Define a route that only recognizes HTTP GET.\n        # For supported arguments, see match[rdoc-ref:Base#match]\n        #\n        #   get 'bacon', to: 'food#bacon'\n        def get(*args, &amp;block)\n          map_method(:get, args, &amp;block)\n        end\n        ...\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<p>So, you can see that <code>to: \"dashboard#index\", :as =&gt; \"dashboard\"</code> are received by <code>*args</code> and the <code>splat operator</code> allows for a variable length set of arguments. </p>\n"}, {"tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": false, "score": 3, "last_activity_date": 1510775690, "creation_date": 1510775690, "answer_id": 47316155, "question_id": 47315898, "link": "https://stackoverflow.com/questions/47315898/confused-about-ruby-on-rails-routes-rb-syntax/47316155#47316155", "title": "Confused about Ruby on Rails routes.rb syntax", "body": "<p>This is a common way to allow <em>options</em> to be passed to a method. Like the following:</p>\n\n<pre><code>def do_something(subject, options = {})\n  subject.perform_something\n  subject.perform_caching if options[:cache]\n  subject.send_report unless options[:skip_reporting]\n  # etc.\nend\n</code></pre>\n\n<p>So you can call:</p>\n\n<pre><code>something(some_object)\nsomething(some_object, cache: true)\nsomething(some_object, skip_reporting: true, cache: true)\n</code></pre>\n\n<p>You can even set up defaults, like this:</p>\n\n<pre><code>def do_something_else(subject, options = {})\n  options = { cache: true, skip_reporting: false }.merge(options)\n  subject.perform_something\n  subject.perform_caching if options[:cache]\n  subject.send_report unless options[:skip_reporting]\nend\n</code></pre>\n\n<p>So that by default if no <code>cache</code> options if given, it will be <code>true</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1510816857, "creation_date": 1510816857, "answer_id": 47323793, "question_id": 47315898, "link": "https://stackoverflow.com/questions/47315898/confused-about-ruby-on-rails-routes-rb-syntax/47323793#47323793", "title": "Confused about Ruby on Rails routes.rb syntax", "body": "<pre><code>get '/dashboard', to: 'dashboard#index', :as =&gt; 'dashboard'\n</code></pre>\n\n<p>This is just a normal <em>message send</em> (what you call a \"method call\", but note that messages and methods are different things in Ruby, and the metaphor of sending a message is really important).</p>\n\n<p>In Ruby, you are allowed to leave out the parentheses around an argument list. So, this is the same as this:</p>\n\n<pre><code>get('/dashboard', to: 'dashboard#index', :as =&gt; 'dashboard')\n</code></pre>\n\n<p>You are also allowed to leave out the receiver of the message send, in which case it is implied to be <code>self</code>, so this is the same as this:</p>\n\n<pre><code>self.get('/dashboard', to: 'dashboard#index', :as =&gt; 'dashboard')\n</code></pre>\n\n<p>If the last argument to a message send is a <code>Hash</code> literal, you are allowed to leave out the curly braces, so this is the same as this:</p>\n\n<pre><code>self.get('/dashboard', {\u00a0to: 'dashboard#index', :as =&gt; 'dashboard' })\n</code></pre>\n\n<p>If the key in a <code>Hash</code> literal is a <code>Symbol</code>, you are allowed to write <code>key: value</code> instead of <code>:key =&gt; value</code>, so this is the same as this:</p>\n\n<pre><code>self.get('/dashboard', {\u00a0:to =&gt; 'dashboard#index', :as =&gt; 'dashboard' })\n</code></pre>\n\n<p>Now, doesn't that look just like a boring old message send?</p>\n\n<p>Most of these rules are there to allow you to write code that looks more natural. For example, things that <em>would</em> be keywords in other languages, are just methods in Ruby, like <code>attr_reader</code>, <code>attr_writer</code>, <code>attr_accessor</code>, <code>require</code>, <code>private</code>, <code>public</code>, <code>protected</code>, etc. It would look weird, if you were required to use parentheses and receivers there:</p>\n\n<pre><code>self.protected()\ndef foo() end\n# instead of\nprotected\ndef foo() end\n\n# or\n\nself.private(def foo() end)\n# instead of\nprivate def foo() end\n</code></pre>\n\n<p>The rule that you can leave out the curly braces around a trailing <code>Hash</code> literal was introduced, so that you could \"fake\" keyword arguments:</p>\n\n<pre><code>def route(path, options = {}) end\nroute(:index, :from =&gt; :here, :to =&gt; :there)\n</code></pre>\n\n<p>Even more so with the new-style symbol keys:</p>\n\n<pre><code>route(:index, from: :here, to: :there)\n</code></pre>\n\n<p>Note that as of Ruby 2.0, Ruby also has <em>proper</em> keyword arguments, which for backwards-compatibility look <em>exactly</em> like a trailing <code>Hash</code>:</p>\n\n<pre><code>def route(path, from:, to:, with: nil) end\nroute(:index, from: :here, to: :there) # this line same as above\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 3893560, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/bd7e813ec4b9991f415f36bcede77d04?s=128&d=identicon&r=PG&f=1", "display_name": "mute", "link": "https://stackoverflow.com/users/3893560/mute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1510816857, "creation_date": 1510774776, "question_id": 47315898, "link": "https://stackoverflow.com/questions/47315898/confused-about-ruby-on-rails-routes-rb-syntax", "title": "Confused about Ruby on Rails routes.rb syntax", "body": "<p>Suppose I had the following code in my routes.rb file. </p>\n\n<pre><code>  get '/dashboard', to: 'dashboard#index', :as =&gt; 'dashboard'\n</code></pre>\n\n<p>I know what's going on (a public url being mapped to a specific controller/view file which will process and return the request). That is not what I am confused about. </p>\n\n<p>As a Ruby beginner, I'm confused about what Ruby code convention this is. It doesn't look like the correct way to declare a variable or call a method? What exactly is going on and is this some sort of shorthand form to call a method?</p>\n\n<pre><code>get(\"/dashboard\", \"dashboard#index\", \"dashboard\")\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "inheritance", "multi-tenant"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510772997, "post_id": 47315303, "comment_id": 81581682, "body": "Can&#39;t you use a <code>default_scope</code>? even though it would only ease a symptom of a larger problem"}, {"owner": {"reputation": 1607, "user_id": 2969613, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002259638356/picture?type=large", "display_name": "workaholic_gangster911", "link": "https://stackoverflow.com/users/2969613/workaholic-gangster911"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510777962, "post_id": 47315303, "comment_id": 81584298, "body": "I&#39;m trying to switch between tables, and default_scope is only used to filter the records inside one table."}, {"owner": {"reputation": 1607, "user_id": 2969613, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002259638356/picture?type=large", "display_name": "workaholic_gangster911", "link": "https://stackoverflow.com/users/2969613/workaholic-gangster911"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510778069, "post_id": 47315303, "comment_id": 81584366, "body": "I don&#39;t have a &quot;problem&quot; per se. I&#39;m just trying to build my app under a convention that when I use Customer model, it refers to a tenant-specific table. So it will be different on each request."}], "answers": [{"tags": [], "owner": {"reputation": 1607, "user_id": 2969613, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002259638356/picture?type=large", "display_name": "workaholic_gangster911", "link": "https://stackoverflow.com/users/2969613/workaholic-gangster911"}, "is_accepted": false, "score": 0, "last_activity_date": 1510933933, "creation_date": 1510933933, "answer_id": 47354487, "question_id": 47315303, "link": "https://stackoverflow.com/questions/47315303/multitenant-rails-model-inheritance/47354487#47354487", "title": "Multitenant Rails model Inheritance", "body": "<p>I've come up with a solution! It scopes the rows by convention anywhere in the app and I'm satisfied with it:</p>\n\n<pre><code># Returns first row from \"org_#{current_user.org.id}_customers\" table\nMT::Customer.first\n\n# Returns first row from \"org_3_customers\" table\nMT::Customer.select_org(3).first\n</code></pre>\n\n<p>To Do this, first, I segregated the \"scoping\" into a class:</p>\n\n<pre><code>class MT\n\n    @@segregated_organization_models = {}\n\n    def self.init(organizations, current_org, *options)\n        organizations.each do |org|\n            options[0][:segregated_models].each do |class_object|\n                # Create new model class\n                @@segregated_organization_models[org.id] ||= {}\n\n                a = Class.new(class_object)\n                @@segregated_organization_models[org.id][class_object.to_s.to_sym] = a\n\n                # Set correct table name\n                @@segregated_organization_models[org.id][class_object.to_s.to_sym].table_name = \"org_#{org.id}_#{class_object.table_name}\"\n\n                # Set default model class to current organization's model class\n                if org.id === current_org.id\n                    self.const_set(class_object.to_s.to_sym, @@segregated_organization_models[org.id][class_object.to_s.to_sym])\n                end\n            end\n        end\n    end\nend\n</code></pre>\n\n<p>while getting rid of the RequestStore gem and model logic in favor of the controller:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n    before_filter :find_organization\n\n    private\n    # Multitenancy helpers\n\n    def find_organization\n        MT.init(Organization.all, current_user.org, \n            segregated_models: [\n                ArticleCategory, Article, CustomArticleField,\n                Customer, CustomerChange, CustomerLedgerItem\n            ]\n        )\n    end\nend\n</code></pre>\n\n<p>Model inheritance is still there:</p>\n\n<pre><code>class SegregatedMultitenantModel &lt; ActiveRecord::Base\n    self.abstract_class = true\n\n    def self.select_org(org_id)\n        MT.class_variable_get(:@@segregated_organization_models)[org_id][self.to_s.demodulize.to_sym]\n    end\nend\n\nclass Customer &lt; SegregatedMultitenantModel\n    self.abstract_class = true\n    self.table_name = \"customers\"\nend\n</code></pre>\n\n<p>Thanks a lot to an anonymous commenter who since deleted his response. Please don't delete your good responses with useful information! I have nothing to upvote. Lol.</p>\n"}], "owner": {"reputation": 1607, "user_id": 2969613, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002259638356/picture?type=large", "display_name": "workaholic_gangster911", "link": "https://stackoverflow.com/users/2969613/workaholic-gangster911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510933933, "creation_date": 1510772529, "last_edit_date": 1510783944, "question_id": 47315303, "link": "https://stackoverflow.com/questions/47315303/multitenant-rails-model-inheritance", "title": "Multitenant Rails model Inheritance", "body": "<p>My multi-tenant \"Customer\" model represents data from multiple tables in a \"org_#{current_user.org.id}_customers\" pattern (i.e. org_1_customers, org_2_customers, etc). I'm using RequestStore gem to store current_user's ORG_ID. </p>\n\n<p>So, the problem is that to access data of CURRENT organization, I have to explicitly call \"Customer.org\" (i.e. Customer.org.where(...).load). Which requires rewriting A LOT of code, and remembering to add \"org\" every time I access the data.</p>\n\n<p>MY QUESTION IS: Is there a way to make it so that I could access \"Customer.org\" by calling \"Customer\", so I would use \"Customer\" for current tenant's/org's customers, and \"Customer.select_org(7)\" for other tenant's/org's customers?</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n    before_filter :find_organization\n\n    private\n    def find_organization\n        RequestStore[:current_org] = current_user ? current_user.org : nil\n    end\nend\n\nclass SegregatedMultitenantModel &lt; ActiveRecord::Base\n    self.abstract_class = true\n\n    def self.select_org(org_id)\n        @subdomain_classes ||= {}\n        unless @subdomain_classes[org_id]\n            @subdomain_classes[org_id] ||= Class.new(self)\n            @subdomain_classes[org_id].table_name = \"org_#{org_id}_#{self.table_name}\" # This needs sanitizing, of course\n            @subdomain_classes[org_id].reset_column_information\n        end\n\n        @subdomain_classes[org_id]\n    end\n\n    def self.org\n        if RequestStore[:current_org].nil?\n            raise \"No Organization Selected For #{self.table_name}\"\n        else\n            self.select_org(RequestStore[:current_org].id)\n        end\n    end\nend\n\nclass Customer &lt; SegregatedMultitenantModel\nend\n</code></pre>\n\n<p>P.S. My application does require multiple Customer tables due to differences in table fields between tenants!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1510769508, "post_id": 47314379, "comment_id": 81579664, "body": "What exactly is inelegant and/or inefficient about the way you&#39;re doing it? How do you define &quot;most elegant and efficient&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3369563"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1510769721, "post_id": 47314379, "comment_id": 81579774, "body": "Though this works, it seems a little inefficient to me that I have to do the same type of check for both options. I would like an more efficient way of eliminating nil options. I have 2 here, but if I had more it would be a problem testing one by one."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1510770180, "post_id": 47314379, "comment_id": 81580068, "body": "It seems fine to me. If I were you, I would move on. BTW, you don&#39;t seem to ever set <code>result</code> (you do seem to set <code>test_result</code>), so <code>return option_a if result</code> will never return <code>option_a</code> and you will always return <code>option_b</code>. Unless I&#39;m missing something..."}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 3, "creation_date": 1510771543, "post_id": 47314379, "comment_id": 81580823, "body": "Working code is kinda off-topic here. This question might be a better fit in <a href=\"http://codereview.stackexchange.com\">Code Review</a>."}, {"owner": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "edited": false, "score": 0, "creation_date": 1510771706, "post_id": 47314379, "comment_id": 81580909, "body": "To be more precise in your test I would use <code>return option_b if option_a.nil? and </code>return option_a if option_b.nil?`  to check for <code>nil</code> explicitly.  There are non-nil values that are falsey."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510778768, "post_id": 47314379, "comment_id": 81584800, "body": "What sort of values do <code>option_a</code> and <code>option_b</code> get? If this is just boolean values, should be easy. In Ruby the only possibilities for logically false are literal <code>false</code> and <code>nil</code>. That last chunk of code in the method only runs if the two possible values are logically false, so it&#39;s very odd how they interact."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3369563"}, "edited": false, "score": 0, "creation_date": 1510847068, "post_id": 47314379, "comment_id": 81618670, "body": "I can guarantee that at least one of the options will be truthy, otherwise calling the test doesn&#39;t make sense in my application context. Apologies for asking the question in the wrong place, I didn&#39;t know about Code Review"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1510779355, "post_id": 47315963, "comment_id": 81585126, "body": "This doesn&#39;t work when <code>option_a</code> and <code>option_b</code> are both <code>nil</code> (or more generally, both falsy). btw, I don&#39;t see why <code>!!</code> is needed."}, {"owner": {"reputation": 383, "user_id": 2877645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z38bR.jpg?s=128&g=1", "display_name": "Bastian E.", "link": "https://stackoverflow.com/users/2877645/bastian-e"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1510870559, "post_id": 47315963, "comment_id": 81632370, "body": "You are right about both options being falsy. And the <code>!!</code> is needed only on the first parameter because the <code>^</code> can lead to errors without it: <a href=\"https://stackoverflow.com/a/1058502/2877645\">stackoverflow.com/a/1058502/2877645</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1510886659, "post_id": 47315963, "comment_id": 81637136, "body": "That&#39;s a good point about <code>!!</code>. An alternative would be <code>option_a.nil? ^ option_b.nil?</code>, which, unlike <code>!!</code>, returns the correct result when <code>option_a = &#39;cat&#39;</code> and <code>option_b = false</code> (namely, <code>false</code>)."}], "tags": [], "owner": {"reputation": 383, "user_id": 2877645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z38bR.jpg?s=128&g=1", "display_name": "Bastian E.", "link": "https://stackoverflow.com/users/2877645/bastian-e"}, "is_accepted": true, "score": 1, "last_activity_date": 1510775001, "creation_date": 1510775001, "answer_id": 47315963, "question_id": 47314379, "link": "https://stackoverflow.com/questions/47314379/most-ellegant-and-efficent-way-of-returning-non-empty-option/47315963#47315963", "title": "Most ellegant and efficent way of returning non-empty option", "body": "<p>It seems ok to me but an alternative way is to use the <code>^</code> operator like this:</p>\n\n<pre><code>...\nreturn option_a or option_b if !!option_a ^ !!option_b\n...\n</code></pre>\n\n<p>The <code>^</code> operator is an exclusive or, so it would be true only if one of the options is <code>true</code> or not <code>nil</code>.</p>\n\n<p>The problem with this is it's less idiomatic and harder to understand than the original version.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3369563"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 47315963, "answer_count": 1, "score": 0, "last_activity_date": 1510775001, "creation_date": 1510769085, "last_edit_date": 1510770131, "question_id": 47314379, "link": "https://stackoverflow.com/questions/47314379/most-ellegant-and-efficent-way-of-returning-non-empty-option", "title": "Most ellegant and efficent way of returning non-empty option", "body": "<p>I'm trying to do a method for choosing an AB test option in Rails, according to a test result. I would like to find a more efficient way of doing the first nil test:\nIf given option A is nil, return B\nIf given option B is nil, return A</p>\n\n<pre><code>module AbTestHelper\n  def ab_test_choice(ab_test_name, option_a, option_b, *args)\n      #This part\n      return option_b unless option_a\n      return option_a unless option_b\n      #This part    \n\n      check_test_enabled = \"#{ab_test_name}_enabled?\"\n      test_result = send(check_test_enabled, args) if respond_to? check_test_enabled\n      return option_a if result\n      option_b \n  end\n\n  private\n\n  def colour_enabled?(user = current_user)\n    return unless user.is_a? User\n    user.enabled_for?(:colour)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "encoding"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510778633, "post_id": 47314110, "comment_id": 81584699, "body": "What format is the input file? You probably need to do <code>File.open(self.attachment.path, encoding: &#39;ISO-8859-1&#39;).read</code> instead."}], "owner": {"reputation": 123, "user_id": 7351450, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/55599da0718129c5a87e69d9937a203d?s=128&d=identicon&r=PG&f=1", "display_name": "brandoncodes", "link": "https://stackoverflow.com/users/7351450/brandoncodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510768088, "creation_date": 1510768088, "question_id": 47314110, "link": "https://stackoverflow.com/questions/47314110/parse-csv-text-with-an-accent", "title": "Parse csv text with an accent", "body": "<p>I am reading of a CSV file and I can't seem to properly store a word with an accent on it. </p>\n\n<pre><code>csv_raw = File.read(self.attachment.path)\ncsv_text = csv_raw.encode(\"utf-8\", :invalid =&gt; :replace)\ncsv = CSV.parse(csv_text, :headers =&gt; true, :encoding =&gt; \"iso-8859-1:utf-8\")\ncsv.each do |row|\n  row\n</code></pre>\n\n<p>A value of row of the csv file I want to parse is <code>Ler\u00edas</code>. However, it is getting through as <code>Ler\ufffdas</code></p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 383, "user_id": 2778157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e43a434ae35d15f3edebc495f9865cbb?s=128&d=identicon&r=PG", "display_name": "Zubin", "link": "https://stackoverflow.com/users/2778157/zubin"}, "edited": false, "score": 1, "creation_date": 1510768729, "post_id": 47313651, "comment_id": 81579245, "body": "Are these the only two migrations in your db? No other ones with bigInt?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1510769200, "post_id": 47313651, "comment_id": 81579499, "body": "Can you please add the command you try to run and the whole error message include the stack trace (you might need to add --trace to the command to get the whole stack trace)."}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1510783735, "post_id": 47313651, "comment_id": 81587380, "body": "Try to comment out migrations code. Binary search debugging approach :)"}, {"owner": {"reputation": 135, "user_id": 4028239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GAbTC.jpg?s=128&g=1", "display_name": "vladpisanov", "link": "https://stackoverflow.com/users/4028239/vladpisanov"}, "edited": false, "score": 0, "creation_date": 1510888577, "post_id": 47313651, "comment_id": 81637664, "body": "It&#39;s strange because GET_LOCK() takes in a string, not a number. That&#39;s what it&#39;s complaining about. <code>SELECT GET_LOCK(&quot;2398406209365187035&quot;, 0)</code> would have worked. It must be an old gem causing issues. Post the stack trace so we can see where this error pops up."}], "answers": [{"tags": [], "owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "is_accepted": false, "score": 4, "last_activity_date": 1516977899, "last_edit_date": 1516977899, "creation_date": 1516977216, "answer_id": 48463445, "question_id": 47313651, "link": "https://stackoverflow.com/questions/47313651/rails-5-db-migration-error/48463445#48463445", "title": "Rails 5 DB Migration error", "body": "<p>I've ran into this issue today. Seems like MySQL/MariaDB implementation of <code>get_lock</code> has changed:</p>\n\n<p>On MariaDB 10.2:</p>\n\n<pre><code>&gt; select get_lock(1234567890, 0);\n+-------------------------+\n| get_lock(1234567890, 0) |\n+-------------------------+\n|                       1 |\n+-------------------------+\n</code></pre>\n\n<p>On MariaDB 10.3:</p>\n\n<pre><code>&gt; select get_lock(1234567890, 0);\nERROR 4079 (HY000) at line 1: Illegal parameter data type bigint for operation 'get_lock'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3969, "user_id": 1319954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba5ee0a1129129c0bb76e15c718ad1c1?s=128&d=identicon&r=PG", "display_name": "d_rail", "link": "https://stackoverflow.com/users/1319954/d-rail"}, "is_accepted": false, "score": 3, "last_activity_date": 1527803424, "creation_date": 1527803424, "answer_id": 50633295, "question_id": 47313651, "link": "https://stackoverflow.com/questions/47313651/rails-5-db-migration-error/50633295#50633295", "title": "Rails 5 DB Migration error", "body": "<p>Upgrade Rails to 5.1.6.</p>\n\n<p>Issue fixed by: <a href=\"https://github.com/rails/rails/pull/31521\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/pull/31521</a></p>\n"}], "owner": {"reputation": 511, "user_id": 4085041, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/527f912490a51d8dd0c8d8168d6a9d87?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/4085041/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1082, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1527803424, "creation_date": 1510766536, "question_id": 47313651, "link": "https://stackoverflow.com/questions/47313651/rails-5-db-migration-error", "title": "Rails 5 DB Migration error", "body": "<p>I am trying to deploy my rails app to production but I am getting an error when trying to call <code>rake db:migrate</code> the error I get is <code>ActiveRecord::StatementInvalid: Mysql2::Error: Illegal parameter data type bigint for operation 'get_lock': SELECT GET_LOCK(2398406209365187035, 0)</code> I cannot see which migration is causing this and none of my migrations have the :limit set to convert to <code>bigint</code> from <code>integer</code></p>\n\n<p>This deployed fine in staging so I am not sure where the issue lies.</p>\n\n<p>My migrations are as follows:</p>\n\n<pre><code>class CreateDatabase &lt; ActiveRecord::Migration\n  def change\n    create_table \"vuln_sets\", id: :integer, force: :cascade, options: \"ENGINE=InnoDB DEFAULT CHARSET=latin1\" do |t|\n      t.string \"vulntype\", null: false\n      t.string \"displayname\", null: false\n      t.string \"bulletinfamily\", null: false\n      t.integer \"vulncount\", default: 0, null: false\n      t.boolean \"active\", default: false, null: false\n      t.timestamp \"timestamp\", default: -&gt; { \"CURRENT_TIMESTAMP\" }, null: false\n      t.index [\"vulntype\"], name: \"vulntypeindex\", unique: true\n    end\n  end\nend\n</code></pre>\n\n<p>Second migration:</p>\n\n<pre><code>class DeviseCreateUsers &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table :users do |t|\n      ## Database authenticatable\n      t.string :email,              null: false, default: \"\"\n      t.string :encrypted_password, null: false, default: \"\"\n\n      ## Recoverable\n      t.string   :reset_password_token\n      t.datetime :reset_password_sent_at\n\n      ## Rememberable\n      t.datetime :remember_created_at\n\n      ## Trackable\n      t.integer  :sign_in_count, default: 0, null: false\n      t.datetime :current_sign_in_at\n      t.datetime :last_sign_in_at\n      t.string   :current_sign_in_ip\n      t.string   :last_sign_in_ip\n\n      ## Confirmable\n      # t.string   :confirmation_token\n      # t.datetime :confirmed_at\n      # t.datetime :confirmation_sent_at\n      # t.string   :unconfirmed_email # Only if using reconfirmable\n\n      ## Lockable\n      # t.integer  :failed_attempts, default: 0, null: false # Only if lock strategy is :failed_attempts\n      # t.string   :unlock_token # Only if unlock strategy is :email or :both\n      # t.datetime :locked_at\n\n\n      t.timestamps null: false\n    end\n\n    add_index :users, :email,                unique: true\n    add_index :users, :reset_password_token, unique: true\n    # add_index :users, :confirmation_token,   unique: true\n    # add_index :users, :unlock_token,         unique: true\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "datetime", "timezone", "timezone-offset"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1510758753, "post_id": 47310838, "comment_id": 81572300, "body": "<i>I have &quot;12:00 PM&quot; and &quot;Eastern Time (US &amp; Canada)&quot;</i> \u2013 are that two strings?"}, {"owner": {"reputation": 8066, "user_id": 4272549, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1hvwh.jpg?s=128&g=1", "display_name": "123", "link": "https://stackoverflow.com/users/4272549/123"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1510758776, "post_id": 47310838, "comment_id": 81572321, "body": "@Stefan Yes, these are two strings"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1510762691, "post_id": 47310838, "comment_id": 81575420, "body": "Where do these strings come from?"}], "answers": [{"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 0, "last_activity_date": 1510762168, "creation_date": 1510762168, "answer_id": 47312175, "question_id": 47310838, "link": "https://stackoverflow.com/questions/47310838/take-separate-time-and-timezone-strings-and-convert-into-utc/47312175#47312175", "title": "Take separate time and timezone strings, and convert into UTC", "body": "<p>If you are using Rails, or if you don't mind requiring ActiveSupport, you can use ActiveSupport::TimeZone to do this.</p>\n\n<pre><code>&gt;&gt; time_zone = \"Eastern Time (US &amp; Canada)\"\n&gt;&gt; time_without_zone = \"12:00 PM\"\n&gt;&gt; ActiveSupport::TimeZone[time_zone].parse(time_without_zone)\n#=&gt; Wed, 15 Nov 2017 12:00:00 EST -05:00\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1510764476, "post_id": 47312894, "comment_id": 81576683, "body": "This requires a stdlib <code>require &#39;datetime&#39;</code>. Also I would convert to Time aftewards with <code>to_time</code>"}], "tags": [], "owner": {"reputation": 31, "user_id": 7875277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10105533013448553/picture?type=large", "display_name": "Kevin Leahey", "link": "https://stackoverflow.com/users/7875277/kevin-leahey"}, "is_accepted": false, "score": 3, "last_activity_date": 1510764236, "creation_date": 1510764236, "answer_id": 47312894, "question_id": 47310838, "link": "https://stackoverflow.com/questions/47310838/take-separate-time-and-timezone-strings-and-convert-into-utc/47312894#47312894", "title": "Take separate time and timezone strings, and convert into UTC", "body": "<p>The DateTime::parse method may be what you are looking for.</p>\n\n<pre><code>x = DateTime.parse(\"12:00 PM Eastern Time (US &amp; Canada)\")\n</code></pre>\n\n<p>will return a result of</p>\n\n<pre><code>#&lt;DateTime: 2017-11-15T12:00:00-05:00 ((2458073j,61200s,0n),-18000s,2299161j)&gt; \n</code></pre>\n\n<p>From there, there are many ways to convert the time to UTC. For example,</p>\n\n<pre><code>utc = x.new_offset(0)\n</code></pre>\n\n<p>will return a result of</p>\n\n<pre><code>#&lt;DateTime: 2017-11-15T17:00:00+00:00 ((2458073j,61200s,0n),+0s,2299161j)&gt;\n</code></pre>\n"}], "owner": {"reputation": 8066, "user_id": 4272549, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1hvwh.jpg?s=128&g=1", "display_name": "123", "link": "https://stackoverflow.com/users/4272549/123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1510764236, "creation_date": 1510758569, "last_edit_date": 1510758915, "question_id": 47310838, "link": "https://stackoverflow.com/questions/47310838/take-separate-time-and-timezone-strings-and-convert-into-utc", "title": "Take separate time and timezone strings, and convert into UTC", "body": "<p>I know a bunch of ways to convert local times into UTC time with Ruby, but I'm not sure how to do this when the time and the zone are separate pieces of data.  If I have something like \"12:00 PM -0500\", I can easily convert this into UTC with <code>.getutc()</code>.  However, what if I have \"12:00 PM\" and \"Eastern Time (US &amp; Canada)\"?  How can I combine these two to find the UTC time?</p>\n"}, {"tags": ["ruby", "logstash"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1510757420, "post_id": 47310405, "comment_id": 81571270, "body": "What would be an example value of <code>event</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1510758584, "creation_date": 1510758584, "answer_id": 47310844, "question_id": 47310405, "link": "https://stackoverflow.com/questions/47310405/delete-fields-that-have-a-specific-substring-on-logstash/47310844#47310844", "title": "Delete fields that have a specific substring on logstash", "body": "<p>One can not modify a hash while iterating it.</p>\n\n<pre><code>event.reject! { |_, value| value =~ /substring/ }\n</code></pre>\n\n<p>The above should do.</p>\n"}], "owner": {"reputation": 183, "user_id": 5738515, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/b070eea2bafa376d2d1855156c2df2a7?s=128&d=identicon&r=PG&f=1", "display_name": "SLFl", "link": "https://stackoverflow.com/users/5738515/slfl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510758584, "creation_date": 1510757292, "question_id": 47310405, "link": "https://stackoverflow.com/questions/47310405/delete-fields-that-have-a-specific-substring-on-logstash", "title": "Delete fields that have a specific substring on logstash", "body": "<p>I want to delete the fields which the value has a specific substring.</p>\n\n<p>I have this code:</p>\n\n<pre><code>ruby {\n            code =&gt; \"\n                event.each do |key, value|\n                    if value =~ /substring/\n                        event.delete(key)\n                  end\n                end\n            \"\n          }\n</code></pre>\n\n<p>I am getting a ruby exception on tags and I don't know why.\nThanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1510757179, "post_id": 47310114, "comment_id": 81571069, "body": "What is the desired result? I&#39;m guessing you want an ActiveRecord::Relation containing 5 categories but you should clarify this as the question is abigous."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510758022, "post_id": 47310114, "comment_id": 81571752, "body": "And what you want is actually to sort the records in the database based on something like a subquery. You don&#39;t need to pluck the sums out first. What RDBMS are you using?"}, {"owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510758686, "post_id": 47310114, "comment_id": 81572244, "body": "Hi max, correct I want an ActiveRecord::Relation containing the top 5 most visited categories. I am using Postgresql."}], "answers": [{"comments": [{"owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1510762741, "post_id": 47310992, "comment_id": 81575453, "body": "Thanks max, i had to put .group(:categories.id) before .order(&#39;SUM(articles.impressions_count)&#39;) if not i will get this error: ActiveRecord::StatementInvalid: PG::GroupingError: ERROR:  column &quot;categories.id&quot; must appear in the GROUP BY clause or be used in an aggregate function"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1510763520, "post_id": 47310992, "comment_id": 81576044, "body": "Thats weird - I tested it with PG and the order does not matter. <code>.group(:id)</code> also creates <code>GROUP BY categories.id</code>. If you want to be explicit you should use <code>group(&#39;categories.id&#39;)</code> with a string and not a symbol"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1510763668, "post_id": 47310992, "comment_id": 81576129, "body": "<code>.order(...).group(:id)</code>,  <code>.group(:id).order(...)</code>, <code>.group(&#39;categories.id&#39;).order(...)</code> will give the exact same query."}, {"owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1510764102, "post_id": 47310992, "comment_id": 81576421, "body": "Oh, it was a typo on my part. i meant .group(&#39;categories.id&#39;).  Could it be because i have a has_many :categories, through: :article_categories  and has_many :articles, through: :article_categories relationship?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1510847386, "post_id": 47310992, "comment_id": 81618916, "body": "No, it works fine with an indirect association as well. <a href=\"https://github.com/maxcal/sandbox/tree/47310114\" rel=\"nofollow noreferrer\">github.com/maxcal/sandbox/tree/47310114</a>"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 3, "last_activity_date": 1510760313, "last_edit_date": 1510760313, "creation_date": 1510758991, "answer_id": 47310992, "question_id": 47310114, "link": "https://stackoverflow.com/questions/47310114/ruby-convert-an-array-or-hash-to-an-activerecord-relation/47310992#47310992", "title": "Ruby: Convert an array or hash to an activerecord relation", "body": "<p>What you want to do start from the inverse end (Category) and use an aggregate in the ORDER clause.</p>\n\n<pre><code>Category.joins(:articles)\n        .order('SUM(articles.impressions_count) DESC')\n        .group(:id)\n        .limit(5)\n</code></pre>\n\n<hr>\n\n<pre><code>irb(main):005:0&gt; Category.joins(:articles).order(\"SUM(articles.impressions_count) DESC\").group('categories.id').limit(5)\n  Category Load (1.5ms)  SELECT  \"categories\".* FROM \"categories\" INNER JOIN \"articles\" ON \"articles\".\"category_id\" = \"categories\".\"id\" GROUP BY categories.id ORDER BY SUM(articles.impressions_count) DESC LIMIT $1  [[\"LIMIT\", 5]]\n=&gt; #&lt;ActiveRecord::Relation [#&lt;Category id: 4, name: \"C#\", created_at: \"2017-11-15 15:06:32\", updated_at: \"2017-11-15 15:06:32\"&gt;, #&lt;Category id: 3, name: \"JavaScript\", created_at: \"2017-11-15 15:06:32\", updated_at: \"2017-11-15 15:06:32\"&gt;, #&lt;Category id: 1, name: \"Simula\", created_at: \"2017-11-15 15:03:37\", updated_at: \"2017-11-15 15:03:37\"&gt;, #&lt;Category id: 2, name: \"Haskell\", created_at: \"2017-11-15 15:06:32\", updated_at: \"2017-11-15 15:06:32\"&gt;]&gt;\n</code></pre>\n\n<p>And you should create a class method - not an instance method as this is basically just a scope and does not make sense to call on an instance.</p>\n\n<pre><code>class Category &lt; ApplicationRecord\n  has_many :articles\n\n  def self.order_by_article_impressions\n    self.joins(:articles)\n        .order('SUM(articles.impressions_count)')\n        .group(:id)\n  end\n\n  def self.top_5_visited\n    order_by_article_impressions.limit(5)\n  end\n\n  # Or use `scope` which is just syntactic sugar\n  scope(:top_5_visited) -&gt; { order_by_article_impressions.limit(5) }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1379, "user_id": 2101252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXPjA.jpg?s=128&g=1", "display_name": "s1mpl3", "link": "https://stackoverflow.com/users/2101252/s1mpl3"}, "is_accepted": false, "score": 0, "last_activity_date": 1510767532, "creation_date": 1510767532, "answer_id": 47313952, "question_id": 47310114, "link": "https://stackoverflow.com/questions/47310114/ruby-convert-an-array-or-hash-to-an-activerecord-relation/47313952#47313952", "title": "Ruby: Convert an array or hash to an activerecord relation", "body": "<p>Change the code to: </p>\n\n<pre><code>Category.where(id: total_count_sort.map(&amp;:last))\n</code></pre>\n"}], "owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 798, "favorite_count": 0, "accepted_answer_id": 47310992, "answer_count": 2, "score": 1, "last_activity_date": 1510767532, "creation_date": 1510756454, "last_edit_date": 1510758571, "question_id": 47310114, "link": "https://stackoverflow.com/questions/47310114/ruby-convert-an-array-or-hash-to-an-activerecord-relation", "title": "Ruby: Convert an array or hash to an activerecord relation", "body": "<p>I am trying to <strong>convert a hash to an activerecord relation</strong> but am not able to do so. I intend to use the activerecord relation to sort and then filter the Category table. The end goal is to  create an instance method to filter the top 5 visited categories, which i can then use/call in the controller. This is what i have in mind:</p>\n\n<p><strong>Category model:</strong></p>\n\n<pre><code>def top_5_visited\n        Article.joins(:categories).group('categories.name').sum(:impressions_count)\n// Add sort\n// Limit to top 5 \nend\n</code></pre>\n\n<p><strong>Category controller:</strong></p>\n\n<pre><code>@categories = Category.top_5 visited\n</code></pre>\n\n<p>A <strong>hash</strong> <code>{\"Simula\"=&gt;7, \"Haskell\"=&gt;5, \"JavaScript\"=&gt;10, \"C#\"=&gt;112}</code> will be created through the following query:</p>\n\n<pre><code>total_count = Article.joins(:categories).group('categories.name').sum(:impressions_count)\n</code></pre>\n\n<p>I have also tried to convert it to an array using sort_by method:</p>\n\n<pre><code>total_count_sorted = total_count.sort_by {|_key, value| value}\n</code></pre>\n\n<p>I have googled \"convert array to activerecord relation\" and referenced <a href=\"https://stackoverflow.com/questions/17331862/converting-an-array-of-objects-to-activerecordrelation\">this</a> post, but testing this: </p>\n\n<pre><code>Category.where(id: total_count_sort.map(&amp;:id))\n</code></pre>\n\n<p>in the rails console, brings up this error: </p>\n\n<blockquote>\n  <p>NoMethodError: undefined method id for [\"Simula\", 7]:Array</p>\n</blockquote>\n"}, {"tags": ["javascript", "angularjs", "ruby"], "comments": [{"owner": {"reputation": 4400, "user_id": 4781975, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/gWMb9.png?s=128&g=1", "display_name": "Zooly", "link": "https://stackoverflow.com/users/4781975/zooly"}, "edited": false, "score": 0, "creation_date": 1510752461, "post_id": 47308612, "comment_id": 81567577, "body": "Do you get an error in the console? Or in your backend service logs,"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510752640, "post_id": 47308612, "comment_id": 81567712, "body": "&quot;I am running api server through irb cli&quot; - what do you mean? Since this is tagged ruby-on-rails I&#180;m guessing you are using Rails. You start the rails server with the <code>bin&#47;rails server</code> command not through irb."}, {"owner": {"reputation": 1008, "user_id": 2935953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/861859e3ae2ec4572c5e6a95da09c22b?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Jha", "link": "https://stackoverflow.com/users/2935953/deepak-jha"}, "edited": false, "score": 0, "creation_date": 1510752719, "post_id": 47308612, "comment_id": 81567764, "body": "please see what console has to say about the error and I am not sure but if you see the data in the console we can think of running a digest cycle. But before that see if you have no error in the console in the scenario where you do not see any data on the page."}, {"owner": {"reputation": 402, "user_id": 7007177, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/g0oZj.jpg?s=128&g=1", "display_name": "quant", "link": "https://stackoverflow.com/users/7007177/quant"}, "edited": false, "score": 0, "creation_date": 1510752827, "post_id": 47308612, "comment_id": 81567853, "body": "I did it in Ruby but on Sinatra platform, I have removed the tag"}], "answers": [{"tags": [], "owner": {"reputation": 32323, "user_id": 2218635, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Uh7jt.jpg?s=128&g=1", "display_name": "Ramesh Rajendran", "link": "https://stackoverflow.com/users/2218635/ramesh-rajendran"}, "is_accepted": false, "score": 0, "last_activity_date": 1510753788, "creation_date": 1510753788, "answer_id": 47309151, "question_id": 47308612, "link": "https://stackoverflow.com/questions/47308612/http-get-response-blank-page/47309151#47309151", "title": "Http get response blank page", "body": "<p>use <code>success</code> callback instead of <code>then</code> see this <a href=\"https://www.peterbe.com/plog/promises-with-$http\" rel=\"nofollow noreferrer\">document</a>  </p>\n\n<pre><code>$scope.company=[];\n      $http.get(\"http://localhost:4567/api/v1/companies\")\n      /*$http.get(\"http://localhost/fake.json\")*/\n    .success(function(response) {\n        $scope.company = response.data;// response or response.data is depend your service response    \n    }).error(function(errorStatus)\n    {\n      //code\n    });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 402, "user_id": 7007177, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/g0oZj.jpg?s=128&g=1", "display_name": "quant", "link": "https://stackoverflow.com/users/7007177/quant"}, "is_accepted": true, "score": 0, "last_activity_date": 1510811397, "creation_date": 1510811397, "answer_id": 47322523, "question_id": 47308612, "link": "https://stackoverflow.com/questions/47308612/http-get-response-blank-page/47322523#47322523", "title": "Http get response blank page", "body": "<p>The problem was sinatra-access-control-allow-origin, I found the solution on: <a href=\"https://stackoverflow.com/questions/7109971/sinatra-access-control-allow-origin-for-sinatra-public-folder/47317965#47317965\">Sinatra access-control-allow-origin for sinatra public folder</a></p>\n"}], "owner": {"reputation": 402, "user_id": 7007177, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/g0oZj.jpg?s=128&g=1", "display_name": "quant", "link": "https://stackoverflow.com/users/7007177/quant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 47322523, "answer_count": 2, "score": 0, "last_activity_date": 1510811397, "creation_date": 1510752366, "last_edit_date": 1510752727, "question_id": 47308612, "link": "https://stackoverflow.com/questions/47308612/http-get-response-blank-page", "title": "Http get response blank page", "body": "<p>I am trying to create  light Angularjs app. I am running api server through irb cli and it is running on port 4567. When i run bundle exec ruby.rb I can confirm that there is data on the address: <a href=\"http://localhost:4567/api/v1/companies\" rel=\"nofollow noreferrer\">http://localhost:4567/api/v1/companies</a>:</p>\n\n<pre><code>[\n  {\"id\": \"1\",\n   \"name\": \"A\"\n  },\n  {\n    \"id\": \"2\",\n    \"name\": \"B\",\n  } \n]\n</code></pre>\n\n<p>I have tried with this code (hello.js):</p>\n\n<pre><code>var app = angular.module('myApp', []);\napp.controller('customersCtrl', function($scope, $http) {\n        $scope.company=[];\n      $http.get(\"http://localhost:4567/api/v1/companies\")\n      /*$http.get(\"http://localhost/fake.json\")*/\n    .then(function(response) {\n        $scope.company = response.data;\n\n    });\n});\n</code></pre>\n\n<p>HTML:</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Hello AngularJS&lt;/title&gt;\n        &lt;script src=\"https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"hello.js\"&gt;&lt;/script&gt;\n    &lt;/head&gt;\n\n        &lt;body&gt;\n            &lt;div ng-app=\"myApp\" ng-controller=\"customersCtrl\"&gt;\n            &lt;ul&gt;\n                    &lt;li ng-repeat=\"x in company\"&gt;\n                        {{ 'name: ' + x.name + ',  id:' + x.id }}\n                    &lt;/li&gt;\n            &lt;/ul&gt;\n            &lt;/div&gt;\n        &lt;/body&gt;\n    &lt;/html&gt;\n</code></pre>\n\n<p>The thing is, if I change the url to the \"<a href=\"http://localhost/fake.json\" rel=\"nofollow noreferrer\">http://localhost/fake.json</a>\" as commented I see the data response clear. But if I use the local web server I can not see anything. Is there some kind of permissions problem or something else.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "edited": false, "score": 0, "creation_date": 1510750086, "post_id": 47307649, "comment_id": 81565874, "body": "Maybe nokogiri? <a href=\"http://www.nokogiri.org/tutorials/searching_a_xml_html_document.html\" rel=\"nofollow noreferrer\">nokogiri.org/tutorials/searching_a_xml_html_document.html</a>"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1510751604, "post_id": 47307649, "comment_id": 81566945, "body": "How do you receive the XML before you store it?"}], "answers": [{"tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": false, "score": 0, "last_activity_date": 1510750332, "creation_date": 1510750332, "answer_id": 47307944, "question_id": 47307649, "link": "https://stackoverflow.com/questions/47307649/find-value-in-xml/47307944#47307944", "title": "Find value in XML", "body": "<p>Use regexp to find a node with <code>3d</code> text:</p>\n\n<pre><code>if request_body =~ /&lt;transaction_type&gt;.*?3d&lt;\\/transaction_type&gt;/\n</code></pre>\n\n<p>Too you can use Nokogiri to parse xml and find a node with this value but in your case, it's overhead.</p>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510750332, "creation_date": 1510749501, "last_edit_date": 1510749945, "question_id": 47307649, "link": "https://stackoverflow.com/questions/47307649/find-value-in-xml", "title": "Find value in XML", "body": "<p>I have a value in which I store XML.</p>\n\n<p>I want to search for this value into the XML:</p>\n\n<pre><code>&lt;transaction_type&gt;authorize&lt;/transaction_type&gt;\n\n&lt;transaction_type&gt;authorize3d&lt;/transaction_type&gt;\n</code></pre>\n\n<p>If there is a value \"3d\" I want to edit the XML file. If not I want to send it.</p>\n\n<pre><code>def web_request(request_body)\n\n    //Search here in request body for 3d value\n    if request_body.include? \"3d\"\n     puts \"String include '3d'\"\n    else\n     puts \"String does not include '3d'\"\n    end\n\n    .........\n    request_body\n  end\n</code></pre>\n\n<p>How I can implement this properly?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1510749554, "post_id": 47307581, "comment_id": 81565503, "body": "Side note: use two spaces for indentation."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510750668, "post_id": 47307581, "comment_id": 81566282, "body": "<code>link_to &quot;Delete&quot;, post_path(@post)</code> or just <code>link_to &quot;Delete&quot;, @post</code>   Using <code>method: :delete</code> relies on javascript (<code>jquery-ujs</code> be precise) .  If the request is being sent as GET (check the logs) then you need to check browser console for javascript errors. You can also use <code>button_to &quot;Delete&quot;, @post</code> which creates a form and does not rely on javascript."}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1510751822, "post_id": 47307581, "comment_id": 81567094, "body": "Can you post your server log, when you click that link. Also, it should be <code>post_path(@post)</code>"}, {"owner": {"reputation": 3867, "user_id": 3906189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/432b41df14bd9197f1b8601cabf49386?s=128&d=identicon&r=PG", "display_name": "siegy22", "link": "https://stackoverflow.com/users/3906189/siegy22"}, "edited": false, "score": 0, "creation_date": 1510752199, "post_id": 47307581, "comment_id": 81567381, "body": "I guess you removed <code>jquery-ujs</code> (or <code>rails-ujs</code> if rails &gt; 5) from your <code>application.js</code>. Can you check if that&#39;s there? That&#39;s the thing which handles all the link clicking HTTP method stuff."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7575338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-lxT3Ithz2jM/AAAAAAAAAAI/AAAAAAAAABo/og763ZvI6Fs/photo.jpg?sz=128", "display_name": "jpn", "link": "https://stackoverflow.com/users/7575338/jpn"}, "edited": false, "score": 0, "creation_date": 1510750056, "post_id": 47307660, "comment_id": 81565854, "body": "tried out the code but it just refreshes in the same page and doesn&#39;t delete the record."}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "reply_to_user": {"reputation": 43, "user_id": 7575338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-lxT3Ithz2jM/AAAAAAAAAAI/AAAAAAAAABo/og763ZvI6Fs/photo.jpg?sz=128", "display_name": "jpn", "link": "https://stackoverflow.com/users/7575338/jpn"}, "edited": false, "score": 0, "creation_date": 1510752156, "post_id": 47307660, "comment_id": 81567345, "body": "@NidheeshJp If you don&#39;t want page to refresh then, add <code>remote: true</code> to the <code>link_to</code>"}], "tags": [], "owner": {"reputation": 2673, "user_id": 4172728, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FQpL7.jpg?s=128&g=1", "display_name": "Gokul", "link": "https://stackoverflow.com/users/4172728/gokul"}, "is_accepted": true, "score": 1, "last_activity_date": 1510749539, "creation_date": 1510749539, "answer_id": 47307660, "question_id": 47307581, "link": "https://stackoverflow.com/questions/47307581/why-does-delete-method-is-not-working-in-ruby/47307660#47307660", "title": "Why does delete method is not working in ruby", "body": "<p><code>posts_path</code> is the path to <code>index</code> action. Change <code>posts_path</code> to <code>post_path</code> in the delete link tag to route to <code>destroy</code> action.</p>\n\n<pre><code>&lt;%= link_to \"Delete\", post_path(@post), method: :delete, data: {confirm: 'are you sure?'},:class =&gt; 'btn btn-danger' %&gt;\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7575338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-lxT3Ithz2jM/AAAAAAAAAAI/AAAAAAAAABo/og763ZvI6Fs/photo.jpg?sz=128", "display_name": "jpn", "link": "https://stackoverflow.com/users/7575338/jpn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 47307660, "answer_count": 1, "score": -2, "last_activity_date": 1510752032, "creation_date": 1510749252, "last_edit_date": 1510752032, "question_id": 47307581, "link": "https://stackoverflow.com/questions/47307581/why-does-delete-method-is-not-working-in-ruby", "title": "Why does delete method is not working in ruby", "body": "<p>The destroy method doesn't work but i get redirected to index page but record is not deleted.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UGqKI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UGqKI.png\" alt=\"enter image description here\"></a></p>\n\n<p>HTML.erb link:</p>\n\n<pre><code>&lt;%= link_to \"Delete\", posts_path(@post), method: :delete, data: {confirm: 'are you sure?'},:class =&gt; 'btn btn-danger' %&gt;\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>def destroy\n  @post = Post.find(params[:id])\n  @post.destroy\n  redirect_to posts_path\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "url"], "comments": [{"owner": {"reputation": 960, "user_id": 4109592, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7Sip6.jpg?s=128&g=1", "display_name": "Nick Schwaderer", "link": "https://stackoverflow.com/users/4109592/nick-schwaderer"}, "edited": false, "score": 0, "creation_date": 1510746123, "post_id": 47306427, "comment_id": 81563196, "body": "If I read your question right are you saying that you&#39;re working on a Rails 3 web application and that you get 404 messages with subdomain of something like: &#39;spacealiens.school.com&#39; ?"}, {"owner": {"reputation": 3048, "user_id": 2374626, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Z78U0.jpg?s=128&g=1", "display_name": "Satishakumar Awati", "link": "https://stackoverflow.com/users/2374626/satishakumar-awati"}, "edited": false, "score": 0, "creation_date": 1510746159, "post_id": 47306427, "comment_id": 81563219, "body": "can you add more details what you have already tried and add screens shots? Question is very unclear."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1510746292, "post_id": 47306427, "comment_id": 81563299, "body": "Do you have wildcard subdomains configured in your DNS and on your server? How do you handle the <code>404</code> error in your app internally (please show some code)?"}, {"owner": {"reputation": 1, "user_id": 7884418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a70bc525de0eb31e4e20a7403658fdf?s=128&d=identicon&r=PG&f=1", "display_name": "gerzson", "link": "https://stackoverflow.com/users/7884418/gerzson"}, "edited": false, "score": 0, "creation_date": 1510746401, "post_id": 47306427, "comment_id": 81563380, "body": "Schwad, yes, I got the error message, instead loading the website and the subdomain name is &quot;space&quot;."}, {"owner": {"reputation": 8028, "user_id": 18092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c64bdb2472e682117c58e4a07b8486?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/18092/fred"}, "edited": false, "score": 0, "creation_date": 1510772189, "post_id": 47306427, "comment_id": 81581176, "body": "You can load space.school.com in a browser, right?"}], "owner": {"reputation": 1, "user_id": 7884418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a70bc525de0eb31e4e20a7403658fdf?s=128&d=identicon&r=PG&f=1", "display_name": "gerzson", "link": "https://stackoverflow.com/users/7884418/gerzson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510747763, "creation_date": 1510745893, "last_edit_date": 1510747763, "question_id": 47306427, "link": "https://stackoverflow.com/questions/47306427/404-error-message-for-a-specific-word-in-subdomain", "title": "404 error message for a specific word in subdomain", "body": "<p>I am displaying different websites depending on the venue name. Etc. venue called \"badbooking\" then the url will be badbooking.school.com, but if the venue subdomain called \"space\", instead of displaying the site and the url, it gives 404 error message. Only happening with this subdomain name. </p>\n\n<p>Any idea why is this happening? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "public-activity"], "answers": [{"comments": [{"owner": {"reputation": 2301, "user_id": 4229573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e7951be77e4a473ae68428a91296b6?s=128&d=identicon&r=PG", "display_name": "Sawo Cliff", "link": "https://stackoverflow.com/users/4229573/sawo-cliff"}, "edited": false, "score": 0, "creation_date": 1510747465, "post_id": 47306611, "comment_id": 81564056, "body": "This did it. I am also having another issue with public activity and tracking posts commented on. I have this in my create.html.erb for comment &lt;%= link_to activity.trackable.post.body, activity.trackable.post %&gt; the error i&#39;m getting is undefined method `post&#39; for nil:NilClass. Comment controller create action has if @comment.save       @comment.create_activity :create, owner: current_user . Where might I be going awry with this"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 2301, "user_id": 4229573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e7951be77e4a473ae68428a91296b6?s=128&d=identicon&r=PG", "display_name": "Sawo Cliff", "link": "https://stackoverflow.com/users/4229573/sawo-cliff"}, "edited": false, "score": 1, "creation_date": 1510758357, "post_id": 47306611, "comment_id": 81572007, "body": "That sounds like a different, unrelated problem. Let&#39;s wrap up this question by accepting the answer if the error in your question is gone. And ask a new question and paste all relevant source code. Discussing further details here in the comments is very hard and doesn&#39;t make much sense."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1510746467, "creation_date": 1510746467, "answer_id": 47306611, "question_id": 47306392, "link": "https://stackoverflow.com/questions/47306392/using-public-activity-to-show-who-has-been-followed/47306611#47306611", "title": "Using Public Activity to Show who has been followed", "body": "<p>Instead of just rendering a <code>followed_id</code> you might want to render the <code>followed.name</code> instead. Change:</p>\n\n<pre><code>Followed &lt;%= activity.trackable.followed_id %&gt;\n</code></pre>\n\n<p>to something like this (replace <code>name</code> with a method that makes sense in your application):</p>\n\n<pre><code>Followed &lt;%= activity.trackable.followed.name %&gt;\n</code></pre>\n"}], "owner": {"reputation": 2301, "user_id": 4229573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e7951be77e4a473ae68428a91296b6?s=128&d=identicon&r=PG", "display_name": "Sawo Cliff", "link": "https://stackoverflow.com/users/4229573/sawo-cliff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 47306611, "answer_count": 1, "score": 0, "last_activity_date": 1510746467, "creation_date": 1510745796, "question_id": 47306392, "link": "https://stackoverflow.com/questions/47306392/using-public-activity-to-show-who-has-been-followed", "title": "Using Public Activity to Show who has been followed", "body": "<p>Im using public activity to provide notifications for activities of people followed. I want to show if a user follows another in the format of</p>\n\n<pre><code>John Doe followed Sam Smith\n</code></pre>\n\n<p>But all I can achieve so far is</p>\n\n<pre><code>John Doe followed 1\n</code></pre>\n\n<p>here is my code. Relationships controller</p>\n\n<pre><code>class RelationshipsController &lt; ApplicationController\n before_action :authenticate_user!\n\n def create\n  @user = User.find(params[:followed_id])\n  current_user.follow(@user)\n  respond_to do |format|\n    format.html { redirect_to @user }\n    format.js\n  end\n end\n\n def destroy\n  @user = Relationship.find(params[:id]).followed\n  current_user.unfollow(@user)\n  respond_to do |format|\n   format.html { redirect_to @user }\n   format.js\n  end\n end\nend\n</code></pre>\n\n<p>Relationship model</p>\n\n<pre><code>class Relationship &lt; ApplicationRecord\n include PublicActivity::Model\n  tracked owner: -&gt;(controller, model) { controller &amp;&amp; controller.current_user }\n\n  belongs_to :follower, class_name: \"User\"\n  belongs_to :followed, class_name: \"User\"\n\n  validates :follower_id, presence: true\n  validates :followed_id, presence: true\nend\n</code></pre>\n\n<p>Relationship create file inside public_activity folder</p>\n\n<pre><code>&lt;% if activity.trackable %&gt;\n  Followed &lt;%= activity.trackable.followed_id %&gt;\n&lt;% else %&gt;\n  Unfollowed a User\n &lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "function"], "comments": [{"owner": {"reputation": 7329, "user_id": 1232447, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001bb9923606697c5edf6b88955c73e8?s=128&d=identicon&r=PG&f=1", "display_name": "maximus \u30c4", "link": "https://stackoverflow.com/users/1232447/maximus-%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1510745439, "post_id": 47306225, "comment_id": 81562768, "body": "If <code>hashes</code> is array then <code>hashes.uniq</code> will do."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 7329, "user_id": 1232447, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/001bb9923606697c5edf6b88955c73e8?s=128&d=identicon&r=PG&f=1", "display_name": "maximus \u30c4", "link": "https://stackoverflow.com/users/1232447/maximus-%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1510746019, "post_id": 47306225, "comment_id": 81563128, "body": "@maximus\u30c4 Not in Ruby 1.8.6. see: <a href=\"https://stackoverflow.com/questions/47290871/ruby-1-8-6-arrayuniq-not-removing-duplicate-hashes\" title=\"ruby 1 8 6 arrayuniq not removing duplicate hashes\">stackoverflow.com/questions/47290871/&hellip;</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1510746196, "post_id": 47306225, "comment_id": 81563238, "body": "What about implementing <code>Hash#hash</code> and <code>Hash#eql?</code> so you can just use <code>uniq</code>?"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1510746559, "post_id": 47306225, "comment_id": 81563466, "body": "@Stefan that&#39;s going to be my next question! I just wondered about a neater version of the above."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1510747071, "post_id": 47306225, "comment_id": 81563809, "body": "@MaxWilliams take a look at <a href=\"https://github.com/marcandre/backports/blob/master/lib/backports/1.8.7/hash/hash.rb\" rel=\"nofollow noreferrer\"><code>backports&#47;1.8.7&#47;hash&#47;hash.rb</code></a> from Marc-Andr&#233; Lafortune&#39;s <a href=\"https://github.com/marcandre/backports\" rel=\"nofollow noreferrer\">Backports Library</a>."}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1510753376, "post_id": 47306225, "comment_id": 81568258, "body": "@Stefan ah that&#39;s brilliant, thanks"}], "answers": [{"comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510746751, "post_id": 47306440, "comment_id": 81563590, "body": "That&#39;s great, I&#39;d not seen <code>each_with_object</code> before - handy!"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510823482, "post_id": 47306440, "comment_id": 81601816, "body": "Sorry, I just took the correct status off this and gave it to @CarySwoveland since his answer (not stricly one line, but easily changed to one line) runs in a tiny fraction of the time, for large arrays.  Sorry if that&#39;s a breach of SE protocol!"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 2, "last_activity_date": 1510745924, "creation_date": 1510745924, "answer_id": 47306440, "question_id": 47306225, "link": "https://stackoverflow.com/questions/47306225/one-liner-version-of-this-function-ruby-1-8-6/47306440#47306440", "title": "One-liner version of this function? (Ruby 1.8.6)", "body": "<p>Can you use each_with_object?</p>\n\n<pre><code>hashes = [{title: 'a'}, {title: 'b'}, {title: 'c'}, {title: 'a'}]\np hashes.each_with_object([]) { |el, array| array &lt;&lt; el unless array.include? el }.size\n# 3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1510747420, "creation_date": 1510747420, "answer_id": 47306928, "question_id": 47306225, "link": "https://stackoverflow.com/questions/47306225/one-liner-version-of-this-function-ruby-1-8-6/47306928#47306928", "title": "One-liner version of this function? (Ruby 1.8.6)", "body": "<blockquote>\n<pre><code>hashes = &lt;a big list of hashes&gt;\nuniq_hashes = []\nhashes.each do |hash|\n  unless uniq_hashes.include?(hash)\n    uniq_hashes &lt;&lt; hash\n  end\nend;uniq_hashes.size\n</code></pre>\n  \n  <p>Can anyone think of a way to condense this into a one-line method?</p>\n</blockquote>\n\n<p>Easy:</p>\n\n<pre><code>hashes = &lt;a big list of hashes&gt;; uniq_hashes = []; hashes.each do |hash| unless uniq_hashes.include?(hash) then uniq_hashes &lt;&lt; hash end end;uniq_hashes.size\n</code></pre>\n\n<p>In fact, you can <em>always</em> condense <em>any</em> Ruby code into one line, since newlines are completely optional. Newlines can always be replaced with either semicolons, separator keywords, or just nothing.</p>\n"}, {"comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510823413, "post_id": 47315112, "comment_id": 81601765, "body": "Wow, I just benchmarked that with an array of 88,000 large hashes, and it&#39;s MUCH faster than the answer I marked as correct already by @Sebasti&#225;nPalma.  That&#39;s to be expected I guess since the number of ops in the <code>include?</code> approach will grow exponentially with the array size.  I&#39;ve never really used sets before, i&#39;ll look into them a bit.  thanks a lot."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1510851670, "last_edit_date": 1510851670, "creation_date": 1510771898, "answer_id": 47315112, "question_id": 47306225, "link": "https://stackoverflow.com/questions/47306225/one-liner-version-of-this-function-ruby-1-8-6/47315112#47315112", "title": "One-liner version of this function? (Ruby 1.8.6)", "body": "<p>Rather than using <code>include?</code> to check if each hash matches a previously-examined hash, one can speed things up by making use of a set. Recall that a set is implemented with a hash under the covers, which explains why lookups are so fast.</p>\n\n<pre><code>require 'set'\n\ndef uniq_hashes(arr)\n  st = Set.new\n  arr.select { |h| st.add?(h) }\nend\n\nuniq_hashes [{ a: 1, b: 2 }, { b: 2, a: 1 }, { a: 1, c: 2 }]\n  #=&gt; [{:a=&gt;1, :b=&gt;2}, {:a=&gt;1, :c=&gt;2}]\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/set/rdoc/Set.html#method-i-add-3F\" rel=\"nofollow noreferrer\">Set#add?</a>.</p>\n"}], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 47315112, "answer_count": 3, "score": 2, "last_activity_date": 1510851670, "creation_date": 1510745253, "question_id": 47306225, "link": "https://stackoverflow.com/questions/47306225/one-liner-version-of-this-function-ruby-1-8-6", "title": "One-liner version of this function? (Ruby 1.8.6)", "body": "<p>In the version of Ruby i'm using, (1.8.6 - don't ask), the Hash class doesn't define the <code>Hash#hash</code> method, which means that calling <code>uniq</code> on an array of hashes doesn't test whether the content is the same - it tests whether the objects are the same (using the default base Object#hash method).</p>\n\n<p>To get around this, I can use <code>include?</code>, like so:</p>\n\n<pre><code>hashes = &lt;a big list of hashes&gt;\nuniq_hashes = []\nhashes.each do |hash|\n  unless uniq_hashes.include?(hash)\n    uniq_hashes &lt;&lt; hash\n  end\nend;uniq_hashes.size\n</code></pre>\n\n<p>Can anyone think of a way to condense this into a one-line method?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara", "actioncable"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510752052, "post_id": 47305850, "comment_id": 81567262, "body": "I&#39;m guessing this is a bug in Puma and not in RSpec or your configuration.  You could verify this by swapping it temporarily for <a href=\"https://github.com/macournoyer/thin\" rel=\"nofollow noreferrer\">thin</a>. Create a branch in git and comment out <code>gem &#39;puma&#39;</code> and add <code>gem &#39;thin&#39;</code> in the Gemfile."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510752158, "post_id": 47305850, "comment_id": 81567349, "body": "<a href=\"https://github.com/puma/puma/commit/7cd363f7990f956334364ccdecf0b21f5fe65143\" rel=\"nofollow noreferrer\">github.com/puma/puma/commit/&hellip;</a>"}, {"owner": {"reputation": 810, "user_id": 3411140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a988d97a19a4f6a815134244e17fb24?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/3411140/andreas"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1510756137, "post_id": 47305850, "comment_id": 81570242, "body": "Thanks for the suggestion @max. I tried switching to <code>thin</code>, and the error in <code>test.log</code> is gone. However, I now get <code>Error during WebSocket handshake: &#39;Upgrade&#39; header is missing</code> (<a href=\"https://stackoverflow.com/questions/37871074/rails-5-actioncable-is-not-returning-upgrade-headers-with-status-101-upgrade-res\" title=\"rails 5 actioncable is not returning upgrade headers with status 101 upgrade res\">stackoverflow.com/questions/37871074/&hellip;</a>). I&#39;ll try to see if I can get some other server to work to isolate the problem to Puma."}, {"owner": {"reputation": 810, "user_id": 3411140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a988d97a19a4f6a815134244e17fb24?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/3411140/andreas"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510792540, "post_id": 47305850, "comment_id": 81590441, "body": "Adding <code>config.middleware.delete Rack::Lock</code> to my <code>environments&#47;test.rb</code> removes the error message from <code>test.log</code>. This is even working with <code>Puma</code>. I have no idea why though. However, the <code>connected</code>-callback in <code>window.App.cable.subscriptions.create</code> never gets called (<a href=\"https://gist.github.com/andreaslillebo/8ff8d7c022058f5ca21b2935f69a445f#file-mysubscription-js\" rel=\"nofollow noreferrer\">gist.github.com/andreaslillebo/&hellip;</a>). This is working on <code>development</code>. When using selenium with chromium, opening the network-tab when the test is running, it seems to be connected though (<a href=\"https://gist.github.com/andreaslillebo/8ff8d7c022058f5ca21b2935f69a445f\" rel=\"nofollow noreferrer\">gist.github.com/andreaslillebo/8ff8d7c022058f5ca21b2935f69a&zwnj;&#8203;445f</a>)"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1510876879, "post_id": 47305850, "comment_id": 81634616, "body": "Rack::Lock prevents multiple simultaneous requests/connections.  Rails 5.1 shouldn&#39;t be including it at all unless you&#39;ve opted out of concurrency by specifying <code>config.allow_concurrency = false</code> .  As for Puma, what output does it produce in your test run - Is it in &quot;single mode&quot; and does it state it&#39;s using multiple threads?"}, {"owner": {"reputation": 810, "user_id": 3411140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a988d97a19a4f6a815134244e17fb24?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/3411140/andreas"}, "edited": false, "score": 0, "creation_date": 1511067104, "post_id": 47305850, "comment_id": 81700202, "body": "After removing <code>config.allow_concurrency = false</code> from <code>test.rb</code>, I no longer needed <code>config.middleware.delete Rack::Lock</code>. Puma didn&#39;t output anything during startup (probably since the default server in Rails 5.1 system tests has its output silenced). Registering a custom puma server results in this output (<a href=\"https://gist.github.com/andreaslillebo/70dcc1508c083f7acb8ea2943ea81477\" rel=\"nofollow noreferrer\">gist.github.com/andreaslillebo/70dcc1508c083f7acb8ea2943ea8&zwnj;&#8203;1477</a>). It appears to be using 2 threads in cluster mode. The <code>connected</code>-callback still doesn&#39;t get called."}], "answers": [{"tags": [], "owner": {"reputation": 1166, "user_id": 6591962, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jD2Sszwl9p0/AAAAAAAAAAI/AAAAAAAAAnc/fIcnP9UYW9w/photo.jpg?sz=128", "display_name": "Andrei Kovrov", "link": "https://stackoverflow.com/users/6591962/andrei-kovrov"}, "is_accepted": false, "score": 0, "last_activity_date": 1576175829, "last_edit_date": 1576175829, "creation_date": 1576159185, "answer_id": 59306292, "question_id": 47305850, "link": "https://stackoverflow.com/questions/47305850/actioncable-raising-exception-during-rspec-system-spec/59306292#59306292", "title": "ActionCable raising exception during rspec system spec", "body": "<p>I don't know details about your test but in my case, the issue was in <code>config.log_level = :debug</code> in <code>config/environments/[env]</code>.</p>\n\n<p>Because ActionCable produces a lot of debugging information about broadcasting. For instance, if you have 100 connected clients your log file will be polluted with 100 messages for each broadcast. </p>\n\n<p>PS: I caught this error on NGINX + Passenger(6.0.4) + GKE with Stackdriver logging.</p>\n"}], "owner": {"reputation": 810, "user_id": 3411140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a988d97a19a4f6a815134244e17fb24?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/3411140/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 536, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1576175829, "creation_date": 1510744233, "question_id": 47305850, "link": "https://stackoverflow.com/questions/47305850/actioncable-raising-exception-during-rspec-system-spec", "title": "ActionCable raising exception during rspec system spec", "body": "\n\n<p>I have a problem using ActionCable with system specs using Capybara. ActionCable is working perfectly on my development server, but when testing with system specs, it is unable to connect to Websockets.</p>\n\n<p>The output from <code>/log/test.log</code> shows:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>Started GET \"/cable\" for 127.0.0.1 at 2017-11-15 18:17:04 +0900\nStarted GET \"/cable/\" [WebSocket] for 127.0.0.1 at 2017-11-15 18:17:04 +0900\nSuccessfully upgraded to WebSocket (REQUEST_METHOD: GET, HTTP_CONNECTION: Upgrade, HTTP_UPGRADE: websocket)\nWebSocket error occurred: undefined method `write_nonblock' for nil:NilClass\nWebSocket error occurred: undefined method `write_nonblock' for nil:NilClass\nWebSocket error occurred: undefined method `write_nonblock' for nil:NilClass\n</code></pre>\n\n<p>I'm using:</p>\n\n<ul>\n<li>ruby 2.4.1</li>\n<li>rails 5.1.4</li>\n<li>rspec 3.7.0</li>\n<li>capybara 2.13.0</li>\n<li>puma 3.10.0</li>\n<li>selenium-webdriver 3.6.0</li>\n</ul>\n\n<p>I have tried:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>Capybara.server = :puma\n</code></pre>\n\n<p>This made no difference (probably since system specs are already using Puma).</p>\n\n<p><strong>My attempt at debugging the issue:</strong></p>\n\n<p>Looking closer at the error, the method <code>write_nonblock</code> is called on <code>nil</code>, which happens here on line 45:</p>\n\n<p><a href=\"https://github.com/rails/rails/blob/385825fb705446a1f11e82b65ca97a50d7e67898/actioncable/lib/action_cable/connection/stream.rb#L45\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/385825fb705446a1f11e82b65ca97a50d7e67898/actioncable/lib/action_cable/connection/stream.rb#L45</a></p>\n\n<p>It seems like <code>@rack_hijack_io</code> gets set to <code>nil</code>, which likely happens in the <code>hijack_rack_socket</code> method here:</p>\n\n<p><a href=\"https://github.com/rails/rails/blob/385825fb705446a1f11e82b65ca97a50d7e67898/actioncable/lib/action_cable/connection/stream.rb#L102\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/385825fb705446a1f11e82b65ca97a50d7e67898/actioncable/lib/action_cable/connection/stream.rb#L102</a></p>\n\n<p><code>@socket_object.env[\"rack.hijack_io\"]</code> returns <code>nil</code>, so we don't have a <code>\"rack.hijack_io\"</code> key. So the error seems to be related to the Rack Hijacking API.</p>\n"}, {"tags": ["python", "ruby", "unit-testing", "rspec", "pytest"], "answers": [{"tags": [], "owner": {"reputation": 24634, "user_id": 5353461, "user_type": "registered", "accept_rate": 51, "profile_image": "https://lh4.googleusercontent.com/-kpRTzH5zyzs/AAAAAAAAAAI/AAAAAAAAAAA/ICc26Nac6mY/photo.jpg?sz=128", "display_name": "Tom Hale", "link": "https://stackoverflow.com/users/5353461/tom-hale"}, "is_accepted": false, "score": 2, "last_activity_date": 1510741170, "last_edit_date": 1510741170, "creation_date": 1510740852, "answer_id": 47304656, "question_id": 47304655, "link": "https://stackoverflow.com/questions/47304655/python-equivalent-of-ruby-rspecs-skip-and-pending/47304656#47304656", "title": "Python equivalent of ruby rspec&#39;s &quot;skip&quot; and &quot;pending&quot;", "body": "<p>Python's <a href=\"https://docs.pytest.org/en/latest/\" rel=\"nofollow noreferrer\"><code>pytest</code></a> allows:</p>\n\n<ul>\n<li><p><a href=\"https://docs.pytest.org/en/latest/skipping.html#skipping-test-functions\" rel=\"nofollow noreferrer\">Skipping test functions</a>, eg:</p>\n\n<pre><code>pytest.skip(\"unsupported configuration\")\n</code></pre></li>\n<li><p><a href=\"https://docs.pytest.org/en/latest/skipping.html#xfail-mark-test-functions-as-expected-to-fail\" rel=\"nofollow noreferrer\"><code>xfail</code> for tests which are expected to fail</a>, eg:</p>\n\n<pre><code>pytest.xfail(\"waiting for foo to be fixed\")\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 24634, "user_id": 5353461, "user_type": "registered", "accept_rate": 51, "profile_image": "https://lh4.googleusercontent.com/-kpRTzH5zyzs/AAAAAAAAAAI/AAAAAAAAAAA/ICc26Nac6mY/photo.jpg?sz=128", "display_name": "Tom Hale", "link": "https://stackoverflow.com/users/5353461/tom-hale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1510741403, "creation_date": 1510740852, "last_edit_date": 1510741403, "question_id": 47304655, "link": "https://stackoverflow.com/questions/47304655/python-equivalent-of-ruby-rspecs-skip-and-pending", "title": "Python equivalent of ruby rspec&#39;s &quot;skip&quot; and &quot;pending&quot;", "body": "<p>I'm coming from ruby to python. With ruby's rspec, I am used to using <a href=\"https://relishapp.com/rspec/rspec-core/v/3-7/docs/pending-and-skipped-examples/skip-examples\" rel=\"nofollow noreferrer\"><code>skip</code></a> and <a href=\"https://relishapp.com/rspec/rspec-core/docs/pending-and-skipped-examples/pending-examples\" rel=\"nofollow noreferrer\"><code>pending</code></a> to denote tests which should be skipped / cannot currently be executed.</p>\n\n<p>What are the equivalents in Python?</p>\n"}, {"tags": ["ruby", "multithreading"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1510744945, "post_id": 47304381, "comment_id": 81562448, "body": "The line <code>threads &lt;&lt; Thread.new do</code> initializes a thread and stores it in a variable. Why are you surprised that this step allocates memory? Why do you think there is a memory leak in your code? Why do you think something is wrong? Is there an error?"}, {"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 1, "creation_date": 1510749239, "post_id": 47304381, "comment_id": 81565244, "body": "Memory leak usually means you has increasing amount of memory taken over time. Can post here how much memory was taken after 1 minute of script working, and, let&#39;s say, after 5 minutes? Is there any difference?  PS. The code sample looks okay to me..."}, {"owner": {"reputation": 668, "user_id": 2695534, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1bd973efafb071c4842b61c54086631b?s=128&d=identicon&r=PG&f=1", "display_name": "vskubriev", "link": "https://stackoverflow.com/users/2695534/vskubriev"}, "edited": false, "score": 0, "creation_date": 1510750549, "post_id": 47304381, "comment_id": 81566198, "body": "Year, of course. Script starts at 18 Mb memory allocation, grows every few seconds, grows up to 5 gigabytes in a couple of days."}, {"owner": {"reputation": 668, "user_id": 2695534, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1bd973efafb071c4842b61c54086631b?s=128&d=identicon&r=PG&f=1", "display_name": "vskubriev", "link": "https://stackoverflow.com/users/2695534/vskubriev"}, "edited": false, "score": 0, "creation_date": 1510750901, "post_id": 47304381, "comment_id": 81566464, "body": "I can assume that the matter is inside the function ping(host, packet_size). It is strange that the objects created inside the thread, after the end of thread continue to take memory. Maybe it&#39;s not. I dont know. Is it possible to either guarantee (implement) the re-creation of threads every time for each function call? To be sure that objects generated in the thread are deleted (if I understand correctly what I&#39;m doing). As far as I understand, the thread is a separate process. The completion of the process must be accompanied by the release of memory. But I do not know how to implement this."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1510756971, "post_id": 47304381, "comment_id": 81570897, "body": "What does <code>ping(host, packet_size)</code> do? If that method does not return for some reason that could be the source of the leak."}, {"owner": {"reputation": 668, "user_id": 2695534, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1bd973efafb071c4842b61c54086631b?s=128&d=identicon&r=PG&f=1", "display_name": "vskubriev", "link": "https://stackoverflow.com/users/2695534/vskubriev"}, "edited": false, "score": 0, "creation_date": 1510818016, "post_id": 47304381, "comment_id": 81598729, "body": "Most likely I realized that the problem is inside this function. Thanks to everyone."}], "owner": {"reputation": 668, "user_id": 2695534, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1bd973efafb071c4842b61c54086631b?s=128&d=identicon&r=PG&f=1", "display_name": "vskubriev", "link": "https://stackoverflow.com/users/2695534/vskubriev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 742, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510740143, "creation_date": 1510740143, "question_id": 47304381, "link": "https://stackoverflow.com/questions/47304381/memory-leak-when-using-threads-in-ruby", "title": "Memory leak when using threads in ruby", "body": "<p>I have a script that should ping hosts in separate threads. Separate threads are used for separate specific hosts pinging, because some pings sometimes takes longer than others. And if we will wait some one ping - others timeouts gets bigger than real.</p>\n\n<p>That's code create a separate thread for each host. I just copy-pasted it from some example. I'am not sure that this code correct. Also I has memory leaks.</p>\n\n<pre><code>threads = []\n\nconfig.each do |array_item|\n  host = array_item[0]\n  packet_size = array_item[1]\n  threads &lt;&lt; Thread.new do                                                                                    \n    puts \"\\nCreating a thread for host:#{host} value:#{packet_size}\"\n    ping(host, packet_size)\n  end\nend\nthreads.each(&amp;:join)\n</code></pre>\n\n<p>Also I run into heap analyzing, but cannot understand what's wrong. I just suppose that threads are not terminates.</p>\n\n<pre><code>Analyzing Heap (Generation: 10)\n-------------------------------\n\nallocated by memory (4717121) (in bytes)\n==============================\n  3150072  /usr/lib/ruby/2.3.0/timeout.rb:81\n  1050024  ./pinger.rb:166\n</code></pre>\n\n<p><code>./pinger.rb:166</code> - is points to <code>threads &lt;&lt; Thread.new do</code></p>\n\n<p>Do I need to control threads allocation and some sort of threads closing controls ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "impressionist"], "answers": [{"tags": [], "owner": {"reputation": 645, "user_id": 589384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8957681fbb8dba72e9c710e4ddf57c83?s=128&d=identicon&r=PG", "display_name": "Peter Balaban", "link": "https://stackoverflow.com/users/589384/peter-balaban"}, "is_accepted": true, "score": 1, "last_activity_date": 1510742120, "creation_date": 1510742120, "answer_id": 47305126, "question_id": 47304361, "link": "https://stackoverflow.com/questions/47304361/rails-activerecord-query-sum-total-article-view-count-per-category/47305126#47305126", "title": "Rails ActiveRecord Query: Sum total article view count per category", "body": "<p>If I understand you correctly and <em>view count</em> is <code>impressions_count</code>, here is query that you can use:</p>\n\n<pre><code>Article.joins(:categories).group('categories.name').sum(:impressions_count)\n</code></pre>\n"}], "owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 47305126, "answer_count": 1, "score": 0, "last_activity_date": 1510742120, "creation_date": 1510740077, "question_id": 47304361, "link": "https://stackoverflow.com/questions/47304361/rails-activerecord-query-sum-total-article-view-count-per-category", "title": "Rails ActiveRecord Query: Sum total article view count per category", "body": "<p>I have articles that are able to be tagged in categories. I am struggling to create a query which will extract the sum of view count (tracked using impressionist gem) of articles within each category. </p>\n\n<p>Schema:</p>\n\n<pre><code>  create_table \"article_categories\", force: :cascade do |t|\n    t.integer \"article_id\"\n    t.integer \"category_id\"\n  end\n\n  create_table \"articles\", force: :cascade do |t|\n    t.string \"title\"\n    t.text \"description\"\n    t.bigint \"user_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer \"impressions_count\", default: 0\n  end\n\n  create_table \"categories\", force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n</code></pre>\n\n<p><strong>Article model</strong></p>\n\n<pre><code>class Article &lt; ApplicationRecord\n  is_impressionable :counter_cache =&gt; true, :unique =&gt; false\n  belongs_to :user\n  has_many :impressions, as: :impressionable\n  has_many :article_categories\n  has_many :categories, through: :article_categories\nend\n</code></pre>\n\n<p><strong>Category model</strong></p>\n\n<pre><code>class Category &lt; ApplicationRecord\n  has_many :article_categories\n  has_many :articles, through: :article_categories\nend\n</code></pre>\n\n<p><strong>ArticleCategory model</strong></p>\n\n<pre><code>class ArticleCategory &lt; ActiveRecord::Base\n  belongs_to :article\n  belongs_to :category\nend\n</code></pre>\n\n<p>Here is what i have tried so far and the errors when i test in rails console:</p>\n\n<pre><code>cat_group = Article.joins(:article_categories).group_by(&amp;:category_ids)\n// this query results in an array of articles within each category\n\n1) cat_group.sum(\"impressions_count\")\n//TypeError: no implicit conversion of Array into String\n\n2) cat_group.select(\"sum(impressions_count) AS total_count\")\n//ArgumentError: wrong number of arguments (given 1, expected 0)\n\n3) Article.joins(:article_categories).group(:category_id)\n\n//ActiveRecord::StatementInvalid: PG::GroupingError: ERROR:  column \"articles.id\" must appear in the GROUP BY clause or be used in an aggregate function\n</code></pre>\n"}, {"tags": ["ruby", "visual-c++", "yaml"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 6744502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e9abeb7f9d636c0c1f9e5c436b5d00?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Nunninger", "link": "https://stackoverflow.com/users/6744502/stefan-nunninger"}, "is_accepted": true, "score": 1, "last_activity_date": 1525608579, "creation_date": 1525608579, "answer_id": 50199516, "question_id": 47304047, "link": "https://stackoverflow.com/questions/47304047/environment-variable-in-yaml-file-for-ceedling/50199516#50199516", "title": "Environment variable in YAML file for Ceedling", "body": "<p>In your ceedling project configuration YAML file add the section \":environment:\" and define therein a variable that is derived from a windows environmental variable</p>\n\n<pre><code>:environment:\n  - foovar: \"#{ENV['FOOVAR']}\"\n</code></pre>\n\n<p>Then you can evaluate this variable in your paths like that</p>\n\n<pre><code>:arguments:\n  - /LIBPATH:#{ENV['FOOBAR']}/VC/lib/amd64\n</code></pre>\n\n<p>You can find more details here <a href=\"https://github.com/ThrowTheSwitch/Ceedling/blob/master/docs/CeedlingPacket.md\" rel=\"nofollow noreferrer\">https://github.com/ThrowTheSwitch/Ceedling/blob/master/docs/CeedlingPacket.md</a></p>\n"}], "owner": {"reputation": 14229, "user_id": 574115, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/CtK6N.png?s=128&g=1", "display_name": "Daan Timmer", "link": "https://stackoverflow.com/users/574115/daan-timmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 0, "accepted_answer_id": 50199516, "answer_count": 1, "score": 0, "last_activity_date": 1525608579, "creation_date": 1510739178, "question_id": 47304047, "link": "https://stackoverflow.com/questions/47304047/environment-variable-in-yaml-file-for-ceedling", "title": "Environment variable in YAML file for Ceedling", "body": "<p>I am setting up a <a href=\"http://www.throwtheswitch.org/ceedling/\" rel=\"nofollow noreferrer\">Ceedling</a> project and I need to configure the project to use MSVC. I've got everything working except that I don't want fixed paths in this project file as not every developer will have visual studio installed at the same location.</p>\n\n<p>I want to move the visual studio and windows kits to a system environment variable, but I can't seem to get it to work. <a href=\"https://stackoverflow.com/a/5866267/574115\">Someone suggested using <code>&lt;%= ENV['FOOVAR'] %&gt;</code></a> but that did not seem to do the trick.</p>\n\n<p>Config snippet as follows:</p>\n\n<pre><code>:tools:\n  :test_linker:\n     :executable: 'C:\\Program Files (x86)\\Microsoft Visual Studio 11.0\\VC\\bin\\amd64\\link.exe'\n     :name: 'msvc'\n     :arguments:\n        - \"${1}\"\n        - /OUT:\"${2}\"\n        - /LIBPATH:\"C:\\Program Files (x86)\\Microsoft Visual Studio 11.0\\VC\\lib\\amd64\"\n        - /LIBPATH:\"C:\\Program Files (x86)\\Windows Kits\\8.0\\Lib\\win8\\um\\x64\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1510741001, "post_id": 47303987, "comment_id": 81559889, "body": "Please, post your test &amp; the code you&#39;re testing. Generally, you should add something like <code>allow(your_double).to receive(:get)</code> in your failing test, but it depends on implementation."}, {"owner": {"reputation": 151, "user_id": 8640501, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10208698776981241/picture?type=large", "display_name": "aria", "link": "https://stackoverflow.com/users/8640501/aria"}, "reply_to_user": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1510742142, "post_id": 47303987, "comment_id": 81560621, "body": "Modified my post to include my test. Thank you."}, {"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1510748870, "post_id": 47303987, "comment_id": 81564952, "body": "Do you have any mentions of <code>RestClient</code> in the same spec file?"}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1510759295, "post_id": 47303987, "comment_id": 81572751, "body": "be careful, there is a problem with underscored models (like AdminUser which translate to a path like admin_user_path). Rails considers the underscore as a word delimiter and can&#39;t properly route. You can fix with config/initializers/inflections.rb (not sure at all if my coment is relevant though, I am not good with testing..)"}, {"owner": {"reputation": 151, "user_id": 8640501, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10208698776981241/picture?type=large", "display_name": "aria", "link": "https://stackoverflow.com/users/8640501/aria"}, "reply_to_user": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1511492025, "post_id": 47303987, "comment_id": 81886096, "body": "For some files i have mentions of RestClient multiple times but for some it&#39;s just once. @nattfodd"}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 8640501, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10208698776981241/picture?type=large", "display_name": "aria", "link": "https://stackoverflow.com/users/8640501/aria"}, "is_accepted": true, "score": 0, "last_activity_date": 1513232867, "creation_date": 1513232867, "answer_id": 47807125, "question_id": 47303987, "link": "https://stackoverflow.com/questions/47303987/double-received-unexpected-message-get-with-url-here/47807125#47807125", "title": "Double received unexpected message :get with (&quot;url_here&quot;)", "body": "<p>Looks like RestClient was being changed globally in some other test causing other tests to fail. </p>\n\n<p>One of the tests was doing:</p>\n\n<pre><code>RestClient = double\n</code></pre>\n\n<p>changing that to the following solved the issue. </p>\n\n<pre><code>let(:RestClient) { double }\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 8640501, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10208698776981241/picture?type=large", "display_name": "aria", "link": "https://stackoverflow.com/users/8640501/aria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1731, "favorite_count": 0, "accepted_answer_id": 47807125, "answer_count": 1, "score": 1, "last_activity_date": 1513232867, "creation_date": 1510739035, "last_edit_date": 1510742110, "question_id": 47303987, "link": "https://stackoverflow.com/questions/47303987/double-received-unexpected-message-get-with-url-here", "title": "Double received unexpected message :get with (&quot;url_here&quot;)", "body": "<p>Whenever i do a RestClient.get or RestClient.post the tests fail with error:</p>\n\n<blockquote>\n  <p>\"Double received unexpected message :get with (\"url_here\")\" <br>\n  and <br>\n  \"Double received unexpected message :post with (\"url_here\")\"\n  respectively.</p>\n</blockquote>\n\n<p>These tests passed earlier but now all of them give the same error. <br></p>\n\n<p>Here is how my test looks:</p>\n\n<pre><code>it 'connectivity test' do\n  config.each do|env, values|\n     response = RestClient.get values['url']\n     expect(response.code).to eq(200)\n  end\nend\n</code></pre>\n\n<p>Please do let me know if you have any fix for this situation. </p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "selenium"], "comments": [{"owner": {"reputation": 1383, "user_id": 5502607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1636ecaa1e29b149f77ad97db900f6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/5502607/marcel"}, "edited": false, "score": 0, "creation_date": 1510742775, "post_id": 47303753, "comment_id": 81561035, "body": "Why do you want to refactor it into one line if I may ask?"}], "answers": [{"comments": [{"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 483, "user_id": 7546921, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d0a78fbca7cb186577145bfcdbef7499?s=128&d=identicon&r=PG&f=1", "display_name": "Richard C", "link": "https://stackoverflow.com/users/7546921/richard-c"}, "edited": false, "score": 0, "creation_date": 1511183784, "post_id": 47330918, "comment_id": 81738768, "body": "@RichardC Welcome!"}], "tags": [], "owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "is_accepted": true, "score": 0, "last_activity_date": 1510838876, "creation_date": 1510838876, "answer_id": 47330918, "question_id": 47303753, "link": "https://stackoverflow.com/questions/47303753/simplify-move-and-maximise-screen-using-selenium-ruby/47330918#47330918", "title": "Simplify Move and Maximise screen using Selenium (Ruby)", "body": "<p>It's not possible in this place because both are returning <code>string</code> object so you can't cascade the calling like</p>\n\n<pre><code>@driver.manage.window.move_to(-1800, 1500).maximize\n</code></pre>\n\n<p>But If it's very important for you, then I will tell you a way to do this, open the window.rb file where you can return the self from move_to function as shown below</p>\n\n<pre><code>  def move_to(x, y)\n    @bridge.reposition_window Integer(x), Integer(y)\n    self\n  end\n</code></pre>\n\n<p>And then you can make a call like this</p>\n\n<pre><code>@driver.manage.window.move_to(-1800, 1500).maximize\n</code></pre>\n"}], "owner": {"reputation": 483, "user_id": 7546921, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d0a78fbca7cb186577145bfcdbef7499?s=128&d=identicon&r=PG&f=1", "display_name": "Richard C", "link": "https://stackoverflow.com/users/7546921/richard-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 47330918, "answer_count": 1, "score": 0, "last_activity_date": 1510838876, "creation_date": 1510738304, "question_id": 47303753, "link": "https://stackoverflow.com/questions/47303753/simplify-move-and-maximise-screen-using-selenium-ruby", "title": "Simplify Move and Maximise screen using Selenium (Ruby)", "body": "<p>I am running my selenium tests using a ruby Framework having recently joined a new company. As I am working on 3 screens I have added in a browser step to move the browser window to my left most screen before maximising using </p>\n\n<pre><code>@driver.manage.window.move_to(-1800, 1500)\n@driver.manage.window.maximize\n</code></pre>\n\n<p>My question very simply is, having never used Ruby before, is there a way to refactor these 2 lines into 1 I have tried various ways but always get an error. </p>\n"}, {"tags": ["ruby", "error-handling"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1510737172, "post_id": 47303329, "comment_id": 81557500, "body": "Before keep posting questions one after another, do you have any idea of accepting and/or communicating with any of the answers to your previous questions?"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 7153036, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/7e4747a3d45124fa030df5c11f223986?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Marshle", "link": "https://stackoverflow.com/users/7153036/tony-marshle"}, "edited": false, "score": 0, "creation_date": 1510738994, "post_id": 47303411, "comment_id": 81558614, "body": "So the method &quot;method&quot; threw the error message via exceptions?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 109, "user_id": 7153036, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/7e4747a3d45124fa030df5c11f223986?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Marshle", "link": "https://stackoverflow.com/users/7153036/tony-marshle"}, "edited": false, "score": 1, "creation_date": 1510740440, "post_id": 47303411, "comment_id": 81559513, "body": "I said <b>yes</b>."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1510737323, "creation_date": 1510737323, "answer_id": 47303411, "question_id": 47303329, "link": "https://stackoverflow.com/questions/47303329/did-this-method-method-throw-this-error-message/47303411#47303411", "title": "Did this method &#39;method&#39; throw this error message?", "body": "<p>Yes. The description:</p>\n\n<pre><code>in `method'\n</code></pre>\n\n<p>in the error message means exactly that.</p>\n"}], "owner": {"reputation": 109, "user_id": 7153036, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/7e4747a3d45124fa030df5c11f223986?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Marshle", "link": "https://stackoverflow.com/users/7153036/tony-marshle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1556981523, "creation_date": 1510737053, "last_edit_date": 1556981523, "question_id": 47303329, "link": "https://stackoverflow.com/questions/47303329/did-this-method-method-throw-this-error-message", "title": "Did this method &#39;method&#39; throw this error message?", "body": "<p>The ruby code</p>\n\n<pre><code>class Word &lt; Array\n   def g\n      puts \"JJ\"\n   end\nend\n\nw = Word.new([4, 6])\nputs Word.method(:g)\n</code></pre>\n\n<p>produces the following error:</p>\n\n<pre><code>main.rb:9:in `method': undefined method `g' for class `#&lt;Class:Word&gt;' (NameError)\n        from main.rb:9:in `&lt;main&gt;'\n</code></pre>\n\n<p>because <code>g</code> is an instance method for <code>Word</code>, not its class method.</p>\n\n<p>It looks like it is the method <code>method</code> that in fact threw this error message. I wouldn't be able to explain how such an error message could be produced if that were not the case.</p>\n\n<p>Is it in fact the method method that threw this error message?</p>\n\n<p>Here, we are passing the symbol <code>:g</code> to the method <code>Word.method</code>, and waiting for its execution. The ruby interpreter cannot know beforehand that it's gonna be an error, only when the method <code>method</code> checks for the existence of a function with a name similar to the symbol <code>:g</code> can it (the method) decide that an error exists. The console/interpreter cannot know about the error beforehand.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-administrate"], "answers": [{"comments": [{"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 1, "creation_date": 1510737213, "post_id": 47303196, "comment_id": 81557527, "body": "Its not the first time am using Administrate Gem. Unfortunately, I see it work well for a Monolithic app rather than Modular App. On a normal day, it does as you posted but not for a Modular App. Am having Administrate gem namespace error. Its clearly stated in my question."}, {"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1510737667, "post_id": 47303196, "comment_id": 81557788, "body": "@AfolabiOlaoluwaAkinwumi what the installer does is generating a controller right? It fails because you need to set that controller with namespace <code>admin::ApplicationController</code> inside <code>app&#47;controllers&#47;admin</code>, this is how their controller looks like <a href=\"https://github.com/thoughtbot/administrate/blob/master/app/controllers/administrate/application_controller.rb\" rel=\"nofollow noreferrer\">github.com/thoughtbot/administrate/blob/master/app/controlle&zwnj;&#8203;rs/&hellip;</a>"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 1, "creation_date": 1510755732, "post_id": 47303196, "comment_id": 81569897, "body": "Its not working. really. Better still let me ask: In a case of a Modular App, where do I install my Administrate (In the parent directory or the engine)?"}, {"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1510770302, "post_id": 47303196, "comment_id": 81580141, "body": "@AfolabiOlaoluwaAkinwumi actually the error is about namespaced models not controllers. So probably you should check something about models too... I don&#39;t know.. you need to do some research deep in what need to be done to set your app .. .do you have gem alternatives?"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 2, "creation_date": 1510782925, "post_id": 47303196, "comment_id": 81586992, "body": "Will use alternative. Can be wasting time on this. Its clear as the Warning sounds the Administrate dont support namespace."}], "tags": [], "owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "is_accepted": false, "score": -2, "last_activity_date": 1510736607, "creation_date": 1510736607, "answer_id": 47303196, "question_id": 47302812, "link": "https://stackoverflow.com/questions/47302812/administrate-gem-does-not-yet-support-namespaced-models/47303196#47303196", "title": "Administrate Gem does not yet support namespaced models", "body": "<p>Read and follow carefully the instruction, then update me</p>\n\n<blockquote>\n  <h1><a href=\"https://github.com/thoughtbot/administrate#getting-started\" rel=\"nofollow noreferrer\">What Is Administrate?</a></h1>\n  \n  <p>Administrate is a library for Rails apps that automatically generates admin dashboards. Administrate's admin dashboards give non-technical users clean interfaces that allow them to create, edit, search, and delete records for any model in the application.</p>\n  \n  <p>Administrate solves the same problem as Rails Admin and ActiveAdmin, but aims to provide a better user experience for site admins, and to be easier for developers to customize.</p>\n  \n  <p>To accomplish these goals, Administrate follows a few guiding principles:</p>\n</blockquote>\n\n<ul>\n<li>No DSLs (domain-specific languages) </li>\n<li>Support the simplest use cases,\nand let the user override defaults with standard tools such as plain\nRails controllers and views. </li>\n<li>Break up the library into core components and plugins, so each component stays small and easy to maintain. </li>\n</ul>\n\n<blockquote>\n  <h1><a href=\"https://github.com/thoughtbot/administrate#getting-started\" rel=\"nofollow noreferrer\">Getting Started</a></h1>\n  \n  <p>Administrate supports Rails from 4.2, up to 5.0 and beyond.</p>\n  \n  <p>Add Administrate to your Gemfile and re-bundle:</p>\n</blockquote>\n\n<pre><code>gem \"administrate\"\n</code></pre>\n\n<p>Then <strong>RUN <code>bundle install</code></strong> in your terminal!!!</p>\n\n<blockquote>\n  <p>The included installer will create dashboards for each model in your app, complete with routes:</p>\n</blockquote>\n\n<pre><code>$ rails generate administrate:install\n</code></pre>\n\n<blockquote>\n  <p>Restart your server, and visit <a href=\"http://localhost:3000/admin\" rel=\"nofollow noreferrer\">http://localhost:3000/admin</a> to see your new dashboard in action.</p>\n  \n  <p>For more detailed instructions or to make it work with Rails API-only applications, please go through the 'Getting Started` guide.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1529, "user_id": 426935, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5cfb21b3827fc0c9801a1cb1be3049f3?s=128&d=identicon&r=PG", "display_name": "Turgs", "link": "https://stackoverflow.com/users/426935/turgs"}, "edited": false, "score": 1, "creation_date": 1550803800, "post_id": 50565652, "comment_id": 96414131, "body": "the dashboard itself isn&#39;t to be namespaced, the questioner wants to have a dashboard for an existing namespaced model in their app"}], "tags": [], "owner": {"reputation": 6361, "user_id": 540887, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0c05d5d965d23a7a37de023f48ba51aa?s=128&d=identicon&r=PG", "display_name": "Muntasim", "link": "https://stackoverflow.com/users/540887/muntasim"}, "is_accepted": false, "score": -3, "last_activity_date": 1527569512, "last_edit_date": 1527569512, "creation_date": 1527507854, "answer_id": 50565652, "question_id": 47302812, "link": "https://stackoverflow.com/questions/47302812/administrate-gem-does-not-yet-support-namespaced-models/50565652#50565652", "title": "Administrate Gem does not yet support namespaced models", "body": "<p>It supports namespace:</p>\n\n<pre><code>rails generate administrate:install --namespace=super_admin\n</code></pre>\n\n<p>To create Dashboard with namespace:</p>\n\n<pre><code>rails generate administrate:dashboard Model --namespace=super_admin\n</code></pre>\n"}], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 690, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527569512, "creation_date": 1510735227, "last_edit_date": 1510737305, "question_id": 47302812, "link": "https://stackoverflow.com/questions/47302812/administrate-gem-does-not-yet-support-namespaced-models", "title": "Administrate Gem does not yet support namespaced models", "body": "<p>Am working on a Modular Rails Application by following TutsPlus Modular Rails App training <a href=\"https://github.com/mmuehlberger/tutsplus-modular-rails-app\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>However, after install <em>Administrate Gem</em> and running <code>rails generate administrate:install</code> to install my dashboard, I get the error as is in the image below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/AlebH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AlebH.png\" alt=\"enter image description here\"></a></p>\n\n<p>In short Administrated Gem doesn't work with a Modular Rails App. How do I solve this problem or how do I make Administrate Gem support Namespaced Models???</p>\n\n<p><strong>What I have done:</strong></p>\n\n<p>I have tried to hard code a dashboard, but wont just work with Administrate (Rails just cant fine Administrate Gem in a Modular Rails App because of that error, but works with a Monolithic Rails App).</p>\n"}, {"tags": ["ruby", "methods"], "answers": [{"comments": [{"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 1, "creation_date": 1510735064, "post_id": 47302344, "comment_id": 81556284, "body": "Just to add to this, <code>Kernel</code> is a module that provides the <code>class</code> method, however the instance methods of <code>Kernel</code> are <i>documented</i> in class <code>Object</code>: <a href=\"https://ruby-doc.org/core-2.4.2/Kernel.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.4.2/Kernel.html</a>"}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 3, "last_activity_date": 1510735193, "last_edit_date": 1510735193, "creation_date": 1510733557, "answer_id": 47302344, "question_id": 47302083, "link": "https://stackoverflow.com/questions/47302083/method-method-call-adds-extra-word-kernel-in-output/47302344#47302344", "title": "Method &#39;method&#39; call adds extra word &#39;Kernel&#39; in output", "body": "<ol>\n<li>Method <code>class</code> seems to come from <code>Kernel</code> module. It's documented in <code>Object</code> class though, as <code>Kernel</code> documentation says (<a href=\"https://ruby-doc.org/core-2.4.2/Kernel.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.4.2/Kernel.html</a>).</li>\n<li>It's because the object <code>Word</code> is of class <code>Class</code>, its superclass has nothing to do with it in this case. </li>\n</ol>\n"}], "owner": {"reputation": 109, "user_id": 7153036, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/7e4747a3d45124fa030df5c11f223986?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Marshle", "link": "https://stackoverflow.com/users/7153036/tony-marshle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 47302344, "answer_count": 1, "score": 0, "last_activity_date": 1510735314, "creation_date": 1510732586, "last_edit_date": 1510735314, "question_id": 47302083, "link": "https://stackoverflow.com/questions/47302083/method-method-call-adds-extra-word-kernel-in-output", "title": "Method &#39;method&#39; call adds extra word &#39;Kernel&#39; in output", "body": "<p>1) While a <code>Method</code> object for the following <code>g</code>:</p>\n\n<pre><code>class Word &lt; Array\n  def g\n    puts \"JJ\"\n  end\nend\n\nw = Word.new([4, 6])\n</code></pre>\n\n<p>has inspection like this,</p>\n\n<pre><code>w.method(:g) # =&gt; #&lt;Method: Word#g&gt;\n</code></pre>\n\n<p>why and how does the <code>Method</code> object for the <code>class</code> have <code>(Kernel)</code> in the inspection as below?</p>\n\n<pre><code>w.method(:class) # =&gt; #&lt;Method: Word(Kernel)#class&gt;\nWord.method(:class) # =&gt; #&lt;Method: Class(Kernel)#class&gt;\n</code></pre>\n\n<p>2) Why and how does the inspection of <code>Method</code> object for <code>method</code> have <code>Class</code> in place of <code>Word</code>'s superclass <code>Object</code> like the following?</p>\n\n<pre><code># =&gt; #&lt;Method: Object#class&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "has-scope"], "comments": [{"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "edited": false, "score": 0, "creation_date": 1510731988, "post_id": 47301899, "comment_id": 81554600, "body": "Try: <code>http:&#47;&#47;localhost:3000&#47;v1&#47;find_friends?by_industry[]=1&amp;by_ind&zwnj;&#8203;ustry[]=2</code>"}, {"owner": {"reputation": 2545, "user_id": 6200054, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gRG06.jpg?s=128&g=1", "display_name": "zshanabek", "link": "https://stackoverflow.com/users/6200054/zshanabek"}, "reply_to_user": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "edited": false, "score": 0, "creation_date": 1510734450, "post_id": 47301899, "comment_id": 81555919, "body": "Yeah. It works. But why we can&#39;t pass something like that: ?by_industry=[1,2,3]?"}, {"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 1, "creation_date": 1510735810, "post_id": 47301899, "comment_id": 81556714, "body": "That&#39;s how GET method parameters work. If you want to pass params like <code>by_industry=1,2</code>, you&#39;ll need to parse <code>&quot;1,2&quot;</code> string, and convert it into array by yourself."}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510762127, "post_id": 47308906, "comment_id": 81575033, "body": "This also matches how array parameters in the request body are done with form data encoding. While you could parse the param manually its just a waste of time imho."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1510753145, "creation_date": 1510753145, "answer_id": 47308906, "question_id": 47301899, "link": "https://stackoverflow.com/questions/47301899/how-to-correctly-write-parameter-in-url-when-scope-is-array-type/47308906#47308906", "title": "How to correctly write parameter in url when scope is array type?", "body": "<p>To pass arrays through query parameters you use the key + brackets syntax:</p>\n\n<pre><code>?foo[]=1&amp;foo[]=2\n</code></pre>\n\n<p>It's klunky and its ugly but thats how its been done since the early days of the web and this old CGI convention is used by Rack. The main advantage vs <code>foo=[1,2]</code> is that it is language agnostic and the params can be parsed out without interpreting the string (which is a security hazard).</p>\n"}], "owner": {"reputation": 2545, "user_id": 6200054, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gRG06.jpg?s=128&g=1", "display_name": "zshanabek", "link": "https://stackoverflow.com/users/6200054/zshanabek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 47308906, "answer_count": 1, "score": 1, "last_activity_date": 1510753145, "creation_date": 1510731854, "question_id": 47301899, "link": "https://stackoverflow.com/questions/47301899/how-to-correctly-write-parameter-in-url-when-scope-is-array-type", "title": "How to correctly write parameter in url when scope is array type?", "body": "<p>I created a scope and pointed it to the array type.</p>\n\n<pre><code>has_scope: by_industry,: type =&gt;: array\n</code></pre>\n\n<p>And now I want to make this scope working.</p>\n\n<p>I tried to pass parameter in url like this:</p>\n\n<pre><code>http://localhost:3000/v1/find_friends?by_industry=[1,2]\n</code></pre>\n\n<p>Does not work.</p>\n\n<p>How to correctly write parameter in url when scope is array type?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rake", "rake-task"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 4, "creation_date": 1510729078, "post_id": 47301129, "comment_id": 81553192, "body": "This way is good enough. Except for the <code>for</code>. Don&#39;t use that. Use <code>0.upto(1142) do |i|</code> instead"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1510729234, "post_id": 47301129, "comment_id": 81553270, "body": "But if you insist on the &quot;best&quot;, you&#39;ll have to specify, best in what? What do you want to optimize for?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1510731203, "post_id": 47301129, "comment_id": 81554196, "body": "you should fix your indentation. Thiss is missing an <code>end</code> for the <code>task</code> block"}, {"owner": {"reputation": 61, "user_id": 6590397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mnF1p.jpg?s=128&g=1", "display_name": "ADMAT Bandara", "link": "https://stackoverflow.com/users/6590397/admat-bandara"}, "edited": false, "score": 0, "creation_date": 1510731765, "post_id": 47301129, "comment_id": 81554473, "body": "Sometimes I am getting an error &quot;OpenURI::HTTPError &#183; 500 Internal Server Error&quot; in the log..  once I check more... It will highlight this place &quot;open(url) do |file|&quot;..  any advice or help ?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1510734860, "post_id": 47301129, "comment_id": 81556163, "body": "<code>500 Internal Server Error</code> is an error at the server. Not in your code. There isn&#39;t much you can do about that (unless the server is under your control too). You might simply ignore server errors and move on to the next or you might want to retry later."}], "owner": {"reputation": 61, "user_id": 6590397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mnF1p.jpg?s=128&g=1", "display_name": "ADMAT Bandara", "link": "https://stackoverflow.com/users/6590397/admat-bandara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510728872, "creation_date": 1510728872, "question_id": 47301129, "link": "https://stackoverflow.com/questions/47301129/what-is-the-best-way-to-load-data-from-a-url-in-rails", "title": "What is the best way to load data from a URL in rails?", "body": "<p>I am trying to get some data from a external link with using a API key. \nI am doing this a rake task and it has to be run every 2 days during a specified time.</p>\n\n<p>This is my approach.</p>\n\n<pre><code>desc \"Run scheduled load and save sign language video clips\"\ntask :load_and_save_sign_language_clips =&gt; :environment do\nputs \"Starting loading sign videos\"\n\n def load(url)\n  open(url) do |file|\n    JSON.parse(file.read)\n  end\n end\n\n for i in 0..1142\n  url = \"http://sampleurl.com?apikey=[key]&amp;page=#{i}\"\n  clips = load(url)\n  clips.each do |clip, value|\n  puts clip['id']\n end\nend\n</code></pre>\n\n<p>This will load approximately over 20000 data. </p>\n\n<p>What will be the best way to do this kind of task ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "authorize.net"], "comments": [{"owner": {"reputation": 95, "user_id": 8938996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3234293126aaa196d5c64c5afbfecf?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha Odedara", "link": "https://stackoverflow.com/users/8938996/manisha-odedara"}, "reply_to_user": {"reputation": 206971, "user_id": 250259, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/64839d31baaefafa58120e1a5a503d66?s=128&d=identicon&r=PG", "display_name": "John Conde", "link": "https://stackoverflow.com/users/250259/john-conde"}, "edited": false, "score": 0, "creation_date": 1510750408, "post_id": 47301072, "comment_id": 81566094, "body": "@JohnConde I used Authorize.Net API. <a href=\"https://developer.authorize.net/api/reference/#customer-profiles\" rel=\"nofollow noreferrer\">developer.authorize.net/api/reference/#customer-profiles</a>"}, {"owner": {"reputation": 206971, "user_id": 250259, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/64839d31baaefafa58120e1a5a503d66?s=128&d=identicon&r=PG", "display_name": "John Conde", "link": "https://stackoverflow.com/users/250259/john-conde"}, "edited": false, "score": 0, "creation_date": 1510757829, "post_id": 47301072, "comment_id": 81571610, "body": "That request is not valid. I&#39;m not sure how that code is supposed to work but it did not produce a valid request for the CIM API."}, {"owner": {"reputation": 95, "user_id": 8938996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3234293126aaa196d5c64c5afbfecf?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha Odedara", "link": "https://stackoverflow.com/users/8938996/manisha-odedara"}, "reply_to_user": {"reputation": 206971, "user_id": 250259, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/64839d31baaefafa58120e1a5a503d66?s=128&d=identicon&r=PG", "display_name": "John Conde", "link": "https://stackoverflow.com/users/250259/john-conde"}, "edited": false, "score": 0, "creation_date": 1510825789, "post_id": 47301072, "comment_id": 81603443, "body": "Thanks for your response. But same request i used in demo app and it&#39;s working."}], "owner": {"reputation": 95, "user_id": 8938996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3234293126aaa196d5c64c5afbfecf?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha Odedara", "link": "https://stackoverflow.com/users/8938996/manisha-odedara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510757790, "creation_date": 1510728627, "last_edit_date": 1510757790, "question_id": 47301072, "link": "https://stackoverflow.com/questions/47301072/authorize-net-cim-create-customer-profile-with-ruby-on-rails", "title": "Authorize.net (CIM) Create customer profile with ruby on rails", "body": "<p>Create customer payment profile using API.\nGetting error:</p>\n\n<blockquote>\n  <p><strong>E00003</strong></p>\n  \n  <p><strong>The element 'paymentProfiles' in namespace 'AnetApi/xml/v1/schema/AnetApiSchema.xsd' cannot contain text. List of\n  possible elements expected: 'customerType, billTo, payment,\n  driversLicense, taxId, defaultPaymentProfile' in namespace\n  'AnetApi/xml/v1/schema/AnetApiSchema.xsd'</strong></p>\n</blockquote>\n\n<p>Request to Authorize.net</p>\n\n<pre><code>&lt;AuthorizeNet::API::CreateCustomerProfileRequest:0x007fc91d9e48a8 @merchantAuthentication=nil, @refId=nil, @profile=#&lt;AuthorizeNet::API::CustomerProfileType:0x007fc91d9e4880 @merchantCustomerId=\"jdoe6607\", @description=\"John2 Doe\", @email=\"2686@mail.com\", @paymentProfiles=[#&lt;AuthorizeNet::API::CustomerPaymentProfileType:0x007fc91d9e4ab0 @customerType=\"individual\", @billTo=#&lt;AuthorizeNet::API::CustomerAddressType:0x007fc91d9e4c68 @firstName=\"Ellen\", @lastName=\"Johnson\", @company=\"Souveniropolis\", @address=\"14 Main Street\", @city=\"Pecan Springs\", @state=\"TX\", @zip=\"44628\", @country=\"US\", @phoneNumber=\"999-999-9999\", @faxNumber=\"999-999-9999\"&gt;, @payment=#&lt;AuthorizeNet::API::PaymentType:0x007fc91d9e4d80 @creditCard=#&lt;AuthorizeNet::API::CreditCardType:0x007fc91d9e4da8 @cardNumber=\"4111111111111111\", @expirationDate=\"2020-05\", @cardCode=\"111\", @isPaymentToken=nil, @cryptogram=nil&gt;, @bankAccount=nil, @trackData=nil, @encryptedTrackData=nil, @payPal=nil, @opaqueData=nil&gt;, @driversLicense=nil, @taxId=nil&gt;], @shipToList=[#&lt;AuthorizeNet::API::CustomerAddressType:0x007fc91d9e4a60 @firstName=\"John\", @lastName=\"Snow\", @company=\"Night's Watch, Inc.\", @address=\"Castle Black\", @city=\"The Wall\", @state=\"North Westeros\", @zip=\"99499\", @country=\"Westeros\", @phoneNumber=\"999-999-9999\", @faxNumber=\"999-999-9999\"&gt;]&gt;, @validationMode=\"liveMode\"&gt;\n</code></pre>\n\n<p>Code:<br><br></p>\n\n<pre><code>transaction = Transaction.new(api_login_id, api_transaction_key, :gateway =&gt; :sandbox)\npayment = PaymentType.new(CreditCardType.new)\npayment.creditCard.cardNumber = '4111111111111111'\npayment.creditCard.expirationDate = '2020-05'\n\nbillTo = CustomerAddressType.new\nbillTo.firstName = \"Ellen\"\nbillTo.lastName = \"Johnson\"\nbillTo.company = \"Souveniropolis\"\nbillTo.address = \"14 Main Street\"\nbillTo.city = \"Pecan Springs\"\nbillTo.state = \"TX\"\nbillTo.zip = \"44628\"\nbillTo.country = \"US\"\nbillTo.phoneNumber = \"999-999-9999\"\nbillTo.faxNumber = \"999-999-9999\"\n\npaymentProfile = CustomerPaymentProfileType.new\npaymentProfile.payment = payment\npaymentProfile.billTo = billTo\n\nshippingAddress = CustomerAddressType.new\nshippingAddress.firstName = \"John\"\nshippingAddress.lastName = \"Snow\"\nshippingAddress.company = \"Night's Watch, Inc.\"\nshippingAddress.address = \"Castle Black\"\nshippingAddress.city = \"The Wall\"\nshippingAddress.state = \"North Westeros\"\nshippingAddress.zip = \"99499\"\nshippingAddress.country = \"Westeros\"\nshippingAddress.phoneNumber = \"999-999-9999\"\nshippingAddress.faxNumber = \"999-999-9999\"\n\nrequest = CreateCustomerProfileRequest.new\nrequest.profile = CustomerProfileType.new\nrequest.profile.merchantCustomerId = 'jdoe' + rand(10000).to_s\nrequest.profile.description = 'John2 Doe'\nrequest.profile.email = rand(10000).to_s + '@mail.com'\nrequest.profile.paymentProfiles = [paymentProfile]\nrequest.profile.shipToList = [shippingAddress]    \nrequest.validationMode = ValidationModeEnum::LiveMode    \n\nresponse = transaction.create_customer_profile(request)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "irb"], "answers": [{"tags": [], "owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "is_accepted": true, "score": 3, "last_activity_date": 1510730524, "creation_date": 1510730524, "answer_id": 47301564, "question_id": 47299928, "link": "https://stackoverflow.com/questions/47299928/what-all-things-can-you-access-when-you-require-a-gem/47301564#47301564", "title": "What all things can you access when you require a gem?", "body": "<p>Thats up to the gem developer. To see how your Name- and Objectspace changed there should be many clever ways.</p>\n\n<p>I answer shortly how to find out which new Module (-Constants) there are:</p>\n\n<pre><code>  initial_modules = Module.constants\n  # -&gt; [:Object, :Module, :Class, :BasicObject, :Kernel, :NilClass, ...]\n\n  require 'rails'\n\n  Module.constants - initial_modules # all NEW constants\n  # -&gt; [:Pathname, :OpenSSL, :Digest, :SecureRandom, :Concurrent, :I18n, :CGI, :ActiveSupport, :Set, :SortedSet, :Timeout, :TimeoutError, :Logger, :LoggerSilence, :DateAndTime, :Psych, :StringScanner, :ScanError, :Date, :DateTime, :YAML, :Base64, :TSort, :Rails, :BigDecimal, :BigMath, :TZInfo, :ThreadSafe, :Threadsafe, :SynchronizedDelegator, :JSON, :OpenStruct, :Singleton, :Mutex_m, :ActionPack, :Rack, :ActionDispatch, :Mime]\n</code></pre>\n\n<p>As you see, this also comes with a lot of new stuff that is required (but not provided) by Rails, like Date, OpenSSL, etc.pp.\nActually, requirements can happen at runtime, too, such that this lists grows as you use the code.\nHope that helps a bit.</p>\n"}], "owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 47301564, "answer_count": 1, "score": 2, "last_activity_date": 1517209245, "creation_date": 1510723240, "last_edit_date": 1517209245, "question_id": 47299928, "link": "https://stackoverflow.com/questions/47299928/what-all-things-can-you-access-when-you-require-a-gem", "title": "What all things can you access when you require a gem?", "body": "<p>Let us take Rails gem for example</p>\n\n<p>Before <code>require 'rails'</code></p>\n\n<pre><code>irb(main):001:0&gt; Rails\nNameError: uninitialized constant Rails\n\nirb(main):002:0&gt; ActionPack\nNameError: uninitialized constant ActionPack\n</code></pre>\n\n<p>After <code>require 'rails'</code></p>\n\n<pre><code>irb(main):005:0&gt; require 'rails'\ntrue\nirb(main):007:0&gt; Rails.constants\n[:Railtie, :Rack, :Initializable, :Configuration, :WelcomeController, :InfoController, :VERSION, :Paths, :Info, :MailersController, :Application, :Engine]\n\nirb(main):009:0&gt; ActionPack.methods-Object.methods\n[:gem_version, :version, :initialize_copy]\n</code></pre>\n\n<p><strong>So now the ActionPack module is available in the console, what other modules or class (if any) are available and how to know about those modules?</strong></p>\n"}, {"tags": ["arrays", "ruby", "hash", "range"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1510723609, "post_id": 47299921, "comment_id": 81551063, "body": "To look up keys by <i>what</i>? Single integer?"}, {"owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1510724751, "post_id": 47299921, "comment_id": 81551408, "body": "Edited accordingly."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1510732606, "post_id": 47300054, "comment_id": 81554889, "body": "Good one, mudsie."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1510723983, "creation_date": 1510723983, "answer_id": 47300054, "question_id": 47299921, "link": "https://stackoverflow.com/questions/47299921/array-of-hashes-whose-key-is-an-array-containing-ranges/47300054#47300054", "title": "Array of hashes whose key is an array containing ranges", "body": "<p>Reasonable format to store the data would be a plain old simple hash:</p>\n\n<pre><code>input = { [3110..3220, 10200, 43680] =&gt;  'A0300',\n          [5200, 7100..8990, 9100..9900] =&gt; 'B0400',\n          [17110..18121, 20160, 2210..22290] =&gt; 'C0600' }\n</code></pre>\n\n<p>To lookup the element one might use case-equal aka triple-equal. Luckily it\u2019s implemented for integers as well:</p>\n\n<pre><code>value = 7300\nresult = input.detect { |k, _| k.any? { |r| r === value } }\nresult ? result.last : nil\n#\u21d2 \"B0400\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "edited": false, "score": 0, "creation_date": 1510724435, "post_id": 47300066, "comment_id": 81551311, "body": "Of course, a hash can contain multiple key value pairs! thanks. I had this structure originally I just seemed that there was some repetition in that multile kay value pairs referred to the same value, thus my attempt to move the keys into a single array which pointed to a single value. Why is is the longer versions above a better solution, is it that there&#39;one s less nesting level?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1510725018, "post_id": 47300066, "comment_id": 81551474, "body": "I could not disagree more. This violates DRY, but even more important that is makes it drastically hard to modify it. Reverse-lookup of the keys for the value is also becoming nuts."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1510731106, "last_edit_date": 1510731106, "creation_date": 1510724027, "answer_id": 47300066, "question_id": 47299921, "link": "https://stackoverflow.com/questions/47299921/array-of-hashes-whose-key-is-an-array-containing-ranges/47300066#47300066", "title": "Array of hashes whose key is an array containing ranges", "body": "<p>No. There is no need to separate each key-value pair into a different hash as you did. Furthermore, you are using the hash in a wrong way. A hash key-value need not be one-to-one. It is better to have something like this:</p>\n\n<pre><code>{\n  3110..3220 =&gt; 'A0300',\n  10200 =&gt; 'A0300',\n  43680 =&gt; 'A0300',\n  5200 =&gt; 'B0400',\n  7100..8990 =&gt; 'B0400',\n  9100..9900 =&gt; 'B0400',\n  17110..18121 =&gt; 'C0600',\n  20160 =&gt; 'C0600',\n  2210..22290 =&gt; 'C0600',\n}\n</code></pre>\n\n<p>But my guess is that you are actually asking a X-Y question, and my answer above is still not the best solution for you.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1510905227, "last_edit_date": 1510905227, "creation_date": 1510731476, "answer_id": 47301822, "question_id": 47299921, "link": "https://stackoverflow.com/questions/47299921/array-of-hashes-whose-key-is-an-array-containing-ranges/47301822#47301822", "title": "Array of hashes whose key is an array containing ranges", "body": "<p>If the values were hardwired, one could use a case statement.</p>\n\n<pre><code>def look_it_up(n)\n  case n\n  when 7100..8990, 9100..9900, 5200\n    'B0400'\n  when 17110..18121, 22100..22290, 20160\n    'C0600'\n  when 3110..3220, 10200, 43680\n    'A0300'\n  else\n    nil\n  end\nend\n\nlook_it_up 10200 #=&gt; \"A0300\"\nlook_it_up  9135 #=&gt; \"B0400\"\nlook_it_up 22100 #=&gt; \"C0600\"\nlook_it_up  3079 #=&gt; nil\n</code></pre>\n\n<p>Assuming <code>n</code> is somewhat uniformly distributed, I have, for reasons of efficiency, ordered the <code>when</code> clauses by decreasing numbers of numbers included, and within each <code>when</code> clause, I put the ranges first and ordered those ranges by decreasing size.</p>\n\n<p>If the values are not necessarily hardwired, one could use <code>find/detect</code>, as @mudasobwa has done.</p>\n\n<p>If many lookups were to be performed, I would suggest constructing a hash whose keys are integers.</p>\n\n<pre><code>def init_arr(*args)\n  args.each do |*a, value|\n    a.each do |e|\n      if e.is_a?(Range)\n        e.each { |n| @h[n] = value }\n      else\n        @h[e] = value\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Then for any <code>n</code>, <code>@h[n]</code> gives its value. For example,</p>\n\n<pre><code>@h = {}\ninit_arr [1..4, 8..10, 11, \"cat\"]\n  @h #=&gt; {1=&gt;\"cat\", 2=&gt;\"cat\", 3=&gt;\"cat\", 4=&gt;\"cat\", 8=&gt;\"cat\", 9=&gt;\"cat\",\n     #    10=&gt;\"cat\", 11=&gt;\"cat\"}\ninit_arr [13..14, 7, \"dog\"]\n  @h #=&gt; {1=&gt;\"cat\", 2=&gt;\"cat\", 3=&gt;\"cat\", 4=&gt;\"cat\", 8=&gt;\"cat\", 9=&gt;\"cat\",\n     #    10=&gt;\"cat\", 11=&gt;\"cat\", 13=&gt;\"dog\", 14=&gt;\"dog\", 7=&gt;\"dog\"}\n</code></pre>\n\n<p>Then (say),</p>\n\n<pre><code>@h[13]\n  #=&gt; \"dog\"\n@h[11]\n  #=&gt; \"cat\"\n@h[12]\n  #=&gt; nil\n</code></pre>\n\n<p>Naturally, this assumes <code>@h.size</code> is manageable.</p>\n\n<p>One could alternatively construct a look-up array, say <code>@arr</code>, which should be faster than using a hash (though it might consume much more memory than would a hash). <code>@arr[n]</code> would return the value for <code>n</code> or <code>nil</code> if there is no corresponding value. If some values were negative, or if the smallest <code>n</code> were quite large, one would instead write <code>@arr[n+@offset]</code>, where <code>@offset</code> is the obvious value.</p>\n"}, {"tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 0, "last_activity_date": 1510731761, "creation_date": 1510731761, "answer_id": 47301880, "question_id": 47299921, "link": "https://stackoverflow.com/questions/47299921/array-of-hashes-whose-key-is-an-array-containing-ranges/47301880#47301880", "title": "Array of hashes whose key is an array containing ranges", "body": "<p>It is pointless to use arrays and/or ranges as hash key, when you want to look up the data given a single value. The advantage of a hash is that, given a key, you can find a value quickly. In your case, you would have to traverse the hash sequentially to find the entry. In this case, it would make more sense to use an arrays of pairs, the first component describing the range and the second component describing the ID.</p>\n\n<p>If you want to use a hash, you should make a corresponding entry for each possible integer value. </p>\n\n<p>If you know that the integer values can not be higher than a certain size, you could create a sparse array, where the integer value is the index position, and the ID is the content of the array cell. This is fastest, but of course takes up some space.</p>\n"}], "owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 47300054, "answer_count": 4, "score": -1, "last_activity_date": 1510905227, "creation_date": 1510723219, "last_edit_date": 1510724722, "question_id": 47299921, "link": "https://stackoverflow.com/questions/47299921/array-of-hashes-whose-key-is-an-array-containing-ranges", "title": "Array of hashes whose key is an array containing ranges", "body": "<p>I need to map a number of IDs and ranges of IDs to single values. I would like to store the whole structure in one object.</p>\n\n<p>Is the following a sensible way to do this? What is the best way to search the keys by a single integer value to return the corresponding value?</p>\n\n<pre><code>large array = [\n   {[3110..3220, 10200, 43680] =&gt;   'A0300'},\n   {[5200, 7100..8990, 9100..9900] =&gt; 'B0400'},\n   {[17110..18121, 20160, 2210..22290] =&gt; 'C0600'}\n]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 5840, "user_id": 3404994, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/fUJmx.jpg?s=128&g=1", "display_name": "Satendra", "link": "https://stackoverflow.com/users/3404994/satendra"}, "edited": false, "score": 0, "creation_date": 1510725914, "post_id": 47299518, "comment_id": 81551791, "body": "Add your controller function from where you are rendering this form."}], "answers": [{"tags": [], "owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "is_accepted": false, "score": 1, "last_activity_date": 1510753644, "last_edit_date": 1510753644, "creation_date": 1510753343, "answer_id": 47308973, "question_id": 47299518, "link": "https://stackoverflow.com/questions/47299518/rails-accepts-nested-attributes-for-and-presence-validation/47308973#47308973", "title": "Rails - accepts_nested_attributes_for and presence validation", "body": "<p>Try to specify explicitly bi-directional associations in your User model using <code>inverse_of:</code> :</p>\n\n<pre><code>class User &lt; ApplicationRecord\n    has_many :events, foreign_key: 'created_by', inverse_of: :user, dependent: :destroy\n    accepts_nested_attributes_for :events\nend\n</code></pre>\n\n<p>And your <code>Event</code> record will be created with present foreign key pointing to <code>User</code>.</p>\n"}], "owner": {"reputation": 10453, "user_id": 872514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a42591877295d7b253af219057635ba7?s=128&d=identicon&r=PG", "display_name": "alexs333", "link": "https://stackoverflow.com/users/872514/alexs333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510753644, "creation_date": 1510721174, "question_id": 47299518, "link": "https://stackoverflow.com/questions/47299518/rails-accepts-nested-attributes-for-and-presence-validation", "title": "Rails - accepts_nested_attributes_for and presence validation", "body": "<p>In my application I have a simple relationship where a <strong>user</strong> that has many <strong>events</strong>:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_many :events, foreign_key: 'created_by', dependent: :destroy\n  accepts_nested_attributes_for :events\nend\n\n\nclass Event &lt; ApplicationRecord\n  belongs_to :user, foreign_key: 'created_by', inverse_of: :events\n  validates :created_by, presence: true\nend\n</code></pre>\n\n<p>When I am trying to create a user alongside with some events I am getting a validation error <em>\"Companies.created by can't be blank\"</em>.</p>\n\n<p>My params hash looks like that:</p>\n\n<pre><code>{\"user\"=&gt;{\"events_attributes\"=&gt;[{\"name\"=&gt;\"disney show\"}]}}\n</code></pre>\n\n<p>When I remove <code>validates :created_by, presence: true</code> everything works as expected. Any help would be appreciated!</p>\n"}, {"tags": ["javascript", "html", "ruby"], "comments": [{"owner": {"reputation": 6861, "user_id": 1594286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c31013ccab64b0efbc9b18236d80ac1?s=128&d=identicon&r=PG", "display_name": "Shadow", "link": "https://stackoverflow.com/users/1594286/shadow"}, "edited": false, "score": 0, "creation_date": 1510719604, "post_id": 47299292, "comment_id": 81549816, "body": "Just to be clear - do you have this on every page?"}, {"owner": {"reputation": 47165, "user_id": 5053002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6a9edfd2614014563162586c1b0697?s=128&d=identicon&r=PG", "display_name": "Jaromanda X", "link": "https://stackoverflow.com/users/5053002/jaromanda-x"}, "edited": false, "score": 0, "creation_date": 1510719673, "post_id": 47299292, "comment_id": 81549838, "body": "javascript on <code>page1.html</code> doesn&#39;t run on <code>page2.html</code> - all event listeners are gone!"}, {"owner": {"reputation": 37, "user_id": 7514004, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e8ce35f92802fda0725944d31c178d02?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7514004/shakespeare"}, "edited": false, "score": 0, "creation_date": 1510719791, "post_id": 47299292, "comment_id": 81549866, "body": "When I look through my chrome tools and the assets the javascript file is there. If i put a breakpoint on ready or my search function nothing the breakpoint does not work. and the html source code includes my javascript file that has this code."}, {"owner": {"reputation": 92, "user_id": 1101181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61652696b645a986c0ba5f0a452e6e3b?s=128&d=identicon&r=PG", "display_name": "Nax.S", "link": "https://stackoverflow.com/users/1101181/nax-s"}, "edited": false, "score": 0, "creation_date": 1510719965, "post_id": 47299292, "comment_id": 81549921, "body": "Are the javascript functions loaded separately  (via &lt;script src=&quot;....&quot;&gt; tags on each page) or is it coded inside each html page?"}, {"owner": {"reputation": 37, "user_id": 7514004, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e8ce35f92802fda0725944d31c178d02?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7514004/shakespeare"}, "edited": false, "score": 0, "creation_date": 1510720193, "post_id": 47299292, "comment_id": 81549987, "body": "It gets loaded in the script tags.  &lt;script src=&quot;/assets/jquery3-813eab5befefb6c6b0180297aa0383b0.js?bod&zwnj;&#8203;y=1&quot; data-turbolinks-track=&quot;true&quot;&gt;&lt;/script&gt; &lt;script src=&quot;/assets/jquery_ujs-1e756c23d7c390953250995cfaa04509.js?&zwnj;&#8203;body=1&quot; data-turbolinks-track=&quot;true&quot;&gt;&lt;/script&gt;"}, {"owner": {"reputation": 37, "user_id": 7514004, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e8ce35f92802fda0725944d31c178d02?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7514004/shakespeare"}, "edited": false, "score": 0, "creation_date": 1510720252, "post_id": 47299292, "comment_id": 81550001, "body": "&lt;script src=&quot;/assets/search-a5bd7a1975ff160c1e2989a9a077ded4.js?body&zwnj;&#8203;=1&quot; data-turbolinks-track=&quot;true&quot;&gt;&lt;/script&gt;"}, {"owner": {"reputation": 37, "user_id": 7514004, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e8ce35f92802fda0725944d31c178d02?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7514004/shakespeare"}, "edited": false, "score": 0, "creation_date": 1510720435, "post_id": 47299292, "comment_id": 81550048, "body": "What I am noticing its not loading the assets actually. Perhaps its a server side problem? Actually it&#39;s strange cause in some cases the chromes tools show the assets there. And in some not there. But even it shows it loaded them for the next page rendered still not working. But it shows the assets are loaded."}, {"owner": {"reputation": 92, "user_id": 1101181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61652696b645a986c0ba5f0a452e6e3b?s=128&d=identicon&r=PG", "display_name": "Nax.S", "link": "https://stackoverflow.com/users/1101181/nax-s"}, "edited": false, "score": 0, "creation_date": 1510720620, "post_id": 47299292, "comment_id": 81550078, "body": "Could you post a more complete version of the codes (including page1.html and page2.html) or maybe a link to test them? There could be issues with other aspects (HTML, other javascripts) so without knowing the other parts, it would likely take quite a while quite to figure things out."}, {"owner": {"reputation": 37, "user_id": 7514004, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e8ce35f92802fda0725944d31c178d02?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7514004/shakespeare"}, "edited": false, "score": 0, "creation_date": 1510721518, "post_id": 47299292, "comment_id": 81550340, "body": "let me get a heroku app going take me a while. thanks ill post back when i got it up to test"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1510722149, "post_id": 47299292, "comment_id": 81550531, "body": "You might not have disabled <a href=\"https://github.com/turbolinks/turbolinks#running-javascript-when-a-page-loads\" rel=\"nofollow noreferrer\">Turbolinks</a> in your application (it&#39;s still in your script tags), trying using <code>document.addEventListener(&quot;turbolinks:load&quot;, function() {</code> instead of <code>$(document).ready( function(){</code>"}, {"owner": {"reputation": 37, "user_id": 7514004, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e8ce35f92802fda0725944d31c178d02?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7514004/shakespeare"}, "edited": false, "score": 0, "creation_date": 1510723075, "post_id": 47299292, "comment_id": 81550866, "body": "Yes dude that worked. Yea I guess I am not sure about what exactly turbolinks does and how that effected it but that suggestion def worked. Thanks man a bunch. If you have time explain! Put it down as an answer and i&#39;ll mark it the correct one!"}], "answers": [{"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 1, "last_activity_date": 1510725044, "creation_date": 1510725044, "answer_id": 47300278, "question_id": 47299292, "link": "https://stackoverflow.com/questions/47299292/javascript-stops-working-after-i-load-another-page/47300278#47300278", "title": "JavaScript stops working after I load another page", "body": "<p>It looks like you might be using <a href=\"https://github.com/turbolinks/turbolinks\" rel=\"nofollow noreferrer\">Turbolinks</a>, from the Readme for the project:</p>\n\n<blockquote>\n  <p>When you follow a link, Turbolinks automatically fetches the page, swaps in its &lt;body&gt;, and merges its &lt;head&gt;, all without incurring the cost of a full page load.</p>\n</blockquote>\n\n<p>Since this library makes it so the page ever only loads once, normal javascript <code>window.onload</code>, <code>DOMContentLoaded</code>, and jQuery <code>ready</code> events don't function after the initial page load and you have to use</p>\n\n<pre><code>document.addEventListener(\"turbolinks:load\", function() {\n</code></pre>\n\n<p>instead of those. If you're new to turbo links, I suggest reading through that README to see what it's all about.</p>\n\n<p>I've never understood why the Rails team would put something like this in rails and enable it by default, and in every single project I've made since they made that change the first thing I do is uninstall it, and when I forgot to do so, I spend several hours later in the project wondering why my javascript is broken.</p>\n"}], "owner": {"reputation": 37, "user_id": 7514004, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e8ce35f92802fda0725944d31c178d02?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7514004/shakespeare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 47300278, "answer_count": 1, "score": 0, "last_activity_date": 1510725044, "creation_date": 1510719461, "last_edit_date": 1510720138, "question_id": 47299292, "link": "https://stackoverflow.com/questions/47299292/javascript-stops-working-after-i-load-another-page", "title": "JavaScript stops working after I load another page", "body": "<p>I am new to JavaScript and trying to see why my on event listeners are not working. I have found similar posts on stackoverflow however the solutions are not working for me.</p>\n\n<pre><code>var search = function( event ) {\n    alert(\"bobo\")\n   $.get(\"http://localhost:3000/search\", {\"search\" : $(\"#Search-Bar\").val()}, function(data, status){\n        if(status == \"success\")\n           $(\".centering.text-center\").html(data)\n    })\n}\n\nvar attachListeners = function(){\n    $(\"#Search\").on(\"click\", search)\n    $(\"#SearchIcon\").click( () =&gt; search() )\n    $(\"#Search-Bar\").keypress( event =&gt; (event.KeyCode == 13 || event.which == 13) ? search() : undefined )\n}\n\n$(document).ready( function(){ \n    attachListeners()\n})\n</code></pre>\n\n<p>My website is not a single page application. I have attached the listeners to my navigation search bar where I load a different view through the nav links and my server(ruby back end) uploads a new html page.</p>\n\n<p>On the first load I have noticed that document ready gets called and everything else works. The on and click. After I use my navigation and load a different html page my events disappear. In my html views my searchbar, searchicon, and a search text have consistent <code>id</code>'s through out. I have tried using <code>window.load()</code> and putting an onload attribute for my body <code>&lt;body onload=attachListeners()&gt;</code> but neither worked(perhaps I didn't use them properly). I also noticed that when I render the next html views my <code>docment.ready</code> does not get called. However, if I forcefully refresh the page with an F5 the listeners are active again for that one html page. What am I missing here that I don't understand?</p>\n"}, {"tags": ["ruby", "api"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1510715900, "post_id": 47298731, "comment_id": 81548957, "body": "just use <code>result.read</code> instead of <code>result.string</code>. Also, you shouldn&#39;t include your api key in the question."}, {"owner": {"reputation": 389, "user_id": 6037103, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10154597590024266/picture?type=large", "display_name": "Ugur Yilmaz", "link": "https://stackoverflow.com/users/6037103/ugur-yilmaz"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1510716113, "post_id": 47298731, "comment_id": 81549013, "body": "@maxpleaner Thanks a lot, it worked.The api key was free so I thought that was okay but you are right."}], "owner": {"reputation": 389, "user_id": 6037103, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10154597590024266/picture?type=large", "display_name": "Ugur Yilmaz", "link": "https://stackoverflow.com/users/6037103/ugur-yilmaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 398, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510715916, "creation_date": 1510715404, "last_edit_date": 1510715916, "question_id": 47298731, "link": "https://stackoverflow.com/questions/47298731/ruby-undefined-method-string-for-tempfile", "title": "ruby undefined method string for TempFile?", "body": "<p>I have been trying to use the ticketmaster api to obtain some data. However, it throws an error when I try to run the code. I do not know why the error is popping up. I do not know if it is because of the url that I gave. Open method accept the url as string so I converted to string and this url is working in postman if I try. The exact error is </p>\n\n<pre><code>C:/RailsInstaller/Ruby2.3.0/lib/ruby/2.3.0/delegate.rb:87:in `method_missing': u\nndefined method `string' for #&lt;Tempfile:0x28c2d50&gt; (NoMethodError)\n        from test.rb:20:in `connection'\n        from test.rb:47:in `&lt;main&gt;'\n</code></pre>\n\n<p>and my code is ;</p>\n\n<pre><code>require 'open-uri'\nrequire 'openssl'\nrequire 'json'\n\nclass Test\n  #silence_warnings do\n    OpenSSL::SSL::VERIFY_PEER = OpenSSL::SSL::VERIFY_NONE  #unless Rails.env.production?\n  #end\n\n  def initialize()\n    @url=\"https://app.ticketmaster.com/discovery/v2/events.json?apikey=XXXXXXXXXXXXXXXXXT&amp;city=Binghamton\" \n  end\n\n  def connection\n    puts \"url\", @url\n    result=open(@url)\n    response_status=result.status\n    #putstus\n    if(response_status[0]==\"200\")\n      @body=JSON.parse(result.string)\n      puts(\"Status is \"+ response_status[0],\"Server Message is \"+ response_status[1])\n      return @body\n    else\n      connection_error\n      puts(\"Status is \", response_status[0])\n    end\n  end\n\n  def connection_error\n    puts \"Connection error with the api\"\n  end\n\n\n  def silence_warnings\n    with_warnings(nil) { yield }\n  end\n\n  def get_content\n    raise notImplementedMethod\n  end\n\n\n\nend\n\na=Test.new\na.connection\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "activerecord"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1510717491, "post_id": 47298380, "comment_id": 81549287, "body": "Forms in HTML are not typed so user input will be strings regardless."}], "answers": [{"tags": [], "owner": {"reputation": 1626, "user_id": 3243476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bWCzo.jpg?s=128&g=1", "display_name": "Norly Canarias", "link": "https://stackoverflow.com/users/3243476/norly-canarias"}, "is_accepted": true, "score": 1, "last_activity_date": 1510716245, "creation_date": 1510716245, "answer_id": 47298831, "question_id": 47298380, "link": "https://stackoverflow.com/questions/47298380/which-takes-precedence-rails-type-casting-or-validation/47298831#47298831", "title": "Which takes precedence: Rails type casting or validation?", "body": "<p>From the <a href=\"http://guides.rubyonrails.org/active_record_validations.html\" rel=\"nofollow noreferrer\">rails docs</a> it says,</p>\n\n<blockquote>\n  <p>If you set :only_integer to true, then it will use the</p>\n  \n  <p>/\\A[+-]?\\d+\\z/</p>\n</blockquote>\n\n<p>What it(only_integer validator) does is that <strong>it validates that the format of value matches the regex above</strong> and a string value that contains only numbers like '12' is a match(returns a truthy value which is 0 and passes the validation).</p>\n\n<pre><code>2.3.1 :001 &gt; '12' =~ /\\A[+-]?\\d+\\z/\n =&gt; 0 \n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 4788699, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-jd9yIEcgjFA/AAAAAAAAAAI/AAAAAAAABhI/wCN2LgMar9k/photo.jpg?sz=128", "display_name": "October Comstock", "link": "https://stackoverflow.com/users/4788699/october-comstock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 47298831, "answer_count": 1, "score": 0, "last_activity_date": 1510736742, "creation_date": 1510712644, "last_edit_date": 1510736742, "question_id": 47298380, "link": "https://stackoverflow.com/questions/47298380/which-takes-precedence-rails-type-casting-or-validation", "title": "Which takes precedence: Rails type casting or validation?", "body": "<p>I am very curious about what this expected behavior is for Rails 4.2 and I have not been able to find an answer to my question.</p>\n\n<p>I'm adding validation to a model on all the time attributes. I want them to ONLY accept integers, not numerical strings. The data type in my schema for this attribute is an integer. I have my validation like so:</p>\n\n<pre><code>RANGE = 0..59\nvalidates :start_minute,   inclusion: { in: RANGE }, numericality: true\n</code></pre>\n\n<p>I've tried these other validations as well. I get the same result.</p>\n\n<pre><code>validates_numericality_of :start_minute, inclusion: { 0..59, only_integer: true }\n\nvalidates :start_minute, inclusion: { in: 0..59 }, numericality: { only_integer: true }\n</code></pre>\n\n<p>When I pass my params to my controller from the request spec, <code>start_minute</code> is <code>\"12\"</code>. BUT when I look at the created object, the <code>start_minute</code>  is <code>12</code>.</p>\n\n<p>According to <a href=\"https://robots.thoughtbot.com/how-rails-works-type-casting\" rel=\"nofollow noreferrer\">this article by ThoughtBot</a>:</p>\n\n<p><em>\"This is because Active Record automatically type casts all input so that it matches the database schema. Depending on the type, this may be incredibly simple, or extremely complex.\"</em></p>\n\n<p>Shouldn't the object not be able to be created? Is the typecasting taking precedence of my validation? Or is there something wrong with my validation? I appreciate any insight to this as I haven't been able to determine what is happening here. I've also created a model spec for this and I'm still able to create a new object with numerical strings.</p>\n\n<p>Thank you for any insight you can give on this. I am still learning the magic of Rails under the hood.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "rspec", "rspec-rails"], "comments": [{"owner": {"reputation": 5219, "user_id": 4724167, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/2CiEe.jpg?s=128&g=1", "display_name": "Nandu Kalidindi", "link": "https://stackoverflow.com/users/4724167/nandu-kalidindi"}, "edited": false, "score": 0, "creation_date": 1510707421, "post_id": 47297713, "comment_id": 81546921, "body": "Your params should be of the form <code>{ :user =&gt; { :username =&gt; &quot;&quot;, :password =&gt; &quot;&quot; } }</code>"}, {"owner": {"reputation": 591, "user_id": 2847290, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/vFoQu.png?s=128&g=1", "display_name": "Lucky500", "link": "https://stackoverflow.com/users/2847290/lucky500"}, "reply_to_user": {"reputation": 5219, "user_id": 4724167, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/2CiEe.jpg?s=128&g=1", "display_name": "Nandu Kalidindi", "link": "https://stackoverflow.com/users/4724167/nandu-kalidindi"}, "edited": false, "score": 0, "creation_date": 1510709013, "post_id": 47297713, "comment_id": 81547335, "body": "Thanks Nandu, where exactly would I add the parameters? is it after the get method?"}], "answers": [{"comments": [{"owner": {"reputation": 591, "user_id": 2847290, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/vFoQu.png?s=128&g=1", "display_name": "Lucky500", "link": "https://stackoverflow.com/users/2847290/lucky500"}, "edited": false, "score": 0, "creation_date": 1510710906, "post_id": 47298009, "comment_id": 81547804, "body": "Thanks Chivorn, I am getting a different error now, but I think this solution works. even with the get."}, {"owner": {"reputation": 591, "user_id": 2847290, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/vFoQu.png?s=128&g=1", "display_name": "Lucky500", "link": "https://stackoverflow.com/users/2847290/lucky500"}, "edited": false, "score": 0, "creation_date": 1510713072, "post_id": 47298009, "comment_id": 81548307, "body": "oh sorry, I don&#39;t think it&#39;s related anymore, but here:"}, {"owner": {"reputation": 591, "user_id": 2847290, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/vFoQu.png?s=128&g=1", "display_name": "Lucky500", "link": "https://stackoverflow.com/users/2847290/lucky500"}, "edited": false, "score": 0, "creation_date": 1510713078, "post_id": 47298009, "comment_id": 81548308, "body": "1) UsersController GET #create returns http success      Failure/Error: expect(response).to have_http_status(:success)        expected the response to have a success status code (2xx) but it was 302      # ./spec/controllers/users_controller_spec.rb:15:in `block (3 levels) in &lt;top (required)&gt;&#39;"}, {"owner": {"reputation": 307, "user_id": 5109793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36498fee1b7985307360dc86bbba25a8?s=128&d=identicon&r=PG&f=1", "display_name": "Chivorn Kouch", "link": "https://stackoverflow.com/users/5109793/chivorn-kouch"}, "reply_to_user": {"reputation": 591, "user_id": 2847290, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/vFoQu.png?s=128&g=1", "display_name": "Lucky500", "link": "https://stackoverflow.com/users/2847290/lucky500"}, "edited": false, "score": 1, "creation_date": 1510714183, "post_id": 47298009, "comment_id": 81548565, "body": "@Lucky500 <code>302</code> means redirection <code>found</code>. This means your code runs well and this is also what you did your controller to redirect after <code>@user</code> is created. You can change the expect response to <code>expect(response).to have_http_status(:found)</code>  or <code>expect(response).to have_http_status(:created)</code> and see if it works."}], "tags": [], "owner": {"reputation": 307, "user_id": 5109793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36498fee1b7985307360dc86bbba25a8?s=128&d=identicon&r=PG&f=1", "display_name": "Chivorn Kouch", "link": "https://stackoverflow.com/users/5109793/chivorn-kouch"}, "is_accepted": true, "score": 4, "last_activity_date": 1510709697, "creation_date": 1510709697, "answer_id": 47298009, "question_id": 47297713, "link": "https://stackoverflow.com/questions/47297713/rspec-testing-fail-strong-params/47298009#47298009", "title": "Rspec testing fail strong params", "body": "<p>Try this:</p>\n\n<pre><code>describe \"POST #create\" do\n  it \"returns http success\" do\n    post :create, params: { user: { username: \"name\", password: \"password\" } }\n    expect(response).to have_http_status(:success)\n  end\nend\n</code></pre>\n\n<p>It should be <code>post :create</code>, not <code>get :create</code></p>\n"}], "owner": {"reputation": 591, "user_id": 2847290, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/vFoQu.png?s=128&g=1", "display_name": "Lucky500", "link": "https://stackoverflow.com/users/2847290/lucky500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 47298009, "answer_count": 1, "score": 0, "last_activity_date": 1510709697, "creation_date": 1510707188, "question_id": 47297713, "link": "https://stackoverflow.com/questions/47297713/rspec-testing-fail-strong-params", "title": "Rspec testing fail strong params", "body": "<p>Trying to get this one to pass for a while, not that familiar with Rspec, tried couple answers, and no luck yet, I have these two parameters being required on my controller as follow:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def new\n    @user = User.new\n  end\n\n  def create\n    @user = User.new(user_params)\n    if @user.save\n      redirect_back fallback_location: new_user_path\n    else\n      render :new\n    end\n  end\nprivate\n  def user_params\n    params.require(:user).permit(:username, :password)\n  end\nend\n</code></pre>\n\n<p>and this is the rspec test that is giving me an issue:</p>\n\n<pre><code>  describe \"GET #create\" do\n    it \"returns http success\" do\n      get :create\n      expect(response).to have_http_status(:success)\n    end\n  end\n</code></pre>\n\n<p>here is the error that I am getting:</p>\n\n<pre><code>1) UsersController GET #create returns http success\n     Failure/Error: params.require(:user).permit(:username, :password)\n\n     ActionController::ParameterMissing:\n       param is missing or the value is empty: user\n</code></pre>\n\n<p>I am looking at the rspec documentation right now, but any help would be appreciated it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "migration", "generator"], "comments": [{"owner": {"reputation": 307, "user_id": 5109793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36498fee1b7985307360dc86bbba25a8?s=128&d=identicon&r=PG&f=1", "display_name": "Chivorn Kouch", "link": "https://stackoverflow.com/users/5109793/chivorn-kouch"}, "edited": false, "score": 1, "creation_date": 1510712807, "post_id": 47297484, "comment_id": 81548240, "body": "@Davit It seems that this is the way Rails work. Table name is plural. It seems to say that <code>data</code> is plural and <code>datum</code> is singular. So when I search for an id, it goes for <code>personal_datum_id</code>. I guess if the table name is personal_datas, it will be no error."}], "answers": [{"tags": [], "owner": {"reputation": 1087, "user_id": 86689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bpq2d.png?s=128&g=1", "display_name": "Neil Anderson", "link": "https://stackoverflow.com/users/86689/neil-anderson"}, "is_accepted": false, "score": 2, "last_activity_date": 1510710494, "creation_date": 1510710494, "answer_id": 47298121, "question_id": 47297484, "link": "https://stackoverflow.com/questions/47297484/name-convention-over-a-rails-migration-reference/47298121#47298121", "title": "Name convention over a Rails Migration reference", "body": "<p>I'm not sure why it's confused, but perhaps you can set up your inflections such that the plural of personal_data is personal_data?</p>\n\n<p>In the file: config/initializers/inflections.rb</p>\n\n<pre><code>ActiveSupport::Inflector.inflections do |inflect|\n    inflect.irregular 'personal_data', 'personal_data'\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 594, "user_id": 8934465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tzs1gobeQZ8/AAAAAAAAAAI/AAAAAAAAAOw/irKKhYM8Xj4/photo.jpg?sz=128", "display_name": "Milan Pudasaini", "link": "https://stackoverflow.com/users/8934465/milan-pudasaini"}, "is_accepted": false, "score": 1, "last_activity_date": 1510774881, "creation_date": 1510774881, "answer_id": 47315931, "question_id": 47297484, "link": "https://stackoverflow.com/questions/47297484/name-convention-over-a-rails-migration-reference/47315931#47315931", "title": "Name convention over a Rails Migration reference", "body": "<p>add <code>self.table_name = 'personal_data'</code> in your personal_data.rb model and run the migration</p>\n"}], "owner": {"reputation": 135, "user_id": 6258629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-a6zx9UaUP98/AAAAAAAAAAI/AAAAAAAAAWA/iBTQqz5vZXY/photo.jpg?sz=128", "display_name": "David Roth", "link": "https://stackoverflow.com/users/6258629/david-roth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1510774881, "creation_date": 1510705503, "last_edit_date": 1510707604, "question_id": 47297484, "link": "https://stackoverflow.com/questions/47297484/name-convention-over-a-rails-migration-reference", "title": "Name convention over a Rails Migration reference", "body": "<p>i have a problem creating a db table through rails generators.</p>\n\n<p>I named a table personal_data and works fine.</p>\n\n<pre><code>class CreatePersonalData &lt; ActiveRecord::Migration\n def change\n  create_table :personal_data do |t|\n    t.string :name\n    t.string :lastName\n    t.string :dni\n    t.string :contact\n    t.references :user, index: true, foreign_key: true\n\n    t.timestamps null: false\n  end\n end\nend\n</code></pre>\n\n<p>But i created another table with a reference to Personal Data </p>\n\n<pre><code>class CreateMerchants &lt; ActiveRecord::Migration\n def change\n  create_table :merchants do |t|\n    t.string :storeName\n    t.references :personal_data, index: true, foreign_key: true\n    t.references :category, index: true, foreign_key: true\n    t.string :webPage\n    t.string :city\n\n    t.timestamps null: false\n  end\n end\nend\n</code></pre>\n\n<p>And when a run the migration instead of seeking for personal_data_id the migrations looks for personal_datum_id and throws and exception. </p>\n\n<blockquote>\n  <p>PG::UndefinedColumn: ERROR:  no existe la columna \u00abpersonal_datum_id\u00bb referida en la llave for\u00e1nea\n  : ALTER TABLE \"merchants\" ADD CONSTRAINT \"fk_rails_e4239c30dc\"\n  FOREIGN KEY (\"personal_datum_id\")\n    REFERENCES \"personal_data\" (\"id\")</p>\n</blockquote>\n\n<p>I translate the error to English</p>\n\n<blockquote>\n  <p>column \"personal_datum_id\" referenced in foreign key constraint does not exist</p>\n</blockquote>\n"}, {"tags": ["ruby", "rvm"], "answers": [{"comments": [{"owner": {"reputation": 434, "user_id": 5340181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GAem5.jpg?s=128&g=1", "display_name": "JMess", "link": "https://stackoverflow.com/users/5340181/jmess"}, "edited": false, "score": 11, "creation_date": 1591075099, "post_id": 47298306, "comment_id": 109910181, "body": "What does this option do exactly?"}, {"owner": {"reputation": 53591, "user_id": 26510, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/25ee9a1b9f5a16feb1432882a9ef2f06?s=128&d=identicon&r=PG", "display_name": "Brad Parks", "link": "https://stackoverflow.com/users/26510/brad-parks"}, "edited": false, "score": 0, "creation_date": 1602030019, "post_id": 47298306, "comment_id": 113588933, "body": "for me, i got the mentioned error, but didnt need that particular version of Ruby, so I installed a different version, e.g. <code>rvm install 2.7</code> - note if you do <code>rvm list known</code> and choose one from the top of the list, it may work for you"}, {"owner": {"reputation": 53591, "user_id": 26510, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/25ee9a1b9f5a16feb1432882a9ef2f06?s=128&d=identicon&r=PG", "display_name": "Brad Parks", "link": "https://stackoverflow.com/users/26510/brad-parks"}, "edited": false, "score": 0, "creation_date": 1605404064, "post_id": 47298306, "comment_id": 114639672, "body": "and to make the version you installed the default, run the following: <code>rvm use 1.7 --default</code>"}, {"owner": {"reputation": 150, "user_id": 9916520, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YZrGHaYXgfA/AAAAAAAAAAI/AAAAAAAAAWI/A7PyYq-an6k/photo.jpg?sz=128", "display_name": "imran haider", "link": "https://stackoverflow.com/users/9916520/imran-haider"}, "edited": false, "score": 0, "creation_date": 1611855964, "post_id": 47298306, "comment_id": 116591532, "body": "it is the ruby version issue. change from 2.x to 2.y and all will smooth. skipping rubygems directory doesn&#39;t seem right"}], "tags": [], "owner": {"reputation": 1215, "user_id": 2824935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/dkDTX.jpg?s=128&g=1", "display_name": "garythegoat", "link": "https://stackoverflow.com/users/2824935/garythegoat"}, "is_accepted": true, "score": 15, "last_activity_date": 1510712054, "creation_date": 1510712054, "answer_id": 47298306, "question_id": 47297283, "link": "https://stackoverflow.com/questions/47297283/cannot-load-such-file-rubygems-defaults-operating-system-when-installing-ru/47298306#47298306", "title": "&quot;cannot load such file -- rubygems/defaults/operating_system&quot; when installing Ruby 2.0.0", "body": "<p>Try installing Ruby using the <code>--rubygems ignore</code> option:</p>\n\n<p><code>$ rvm install ruby-2.0.0 --rubygems ignore</code></p>\n"}, {"comments": [{"owner": {"reputation": 1188, "user_id": 1185619, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/77c2eb221c3a3dbe9a6c23fc67f94ea2?s=128&d=identicon&r=PG", "display_name": "Geoffrey H", "link": "https://stackoverflow.com/users/1185619/geoffrey-h"}, "edited": false, "score": 3, "creation_date": 1601987945, "post_id": 50074167, "comment_id": 113571687, "body": "How do you know which version of rubygems you need though ? I know my project uses <code>ruby-2.3.0</code> but I have no idea what version of rubygems it was using"}], "tags": [], "owner": {"reputation": 2747, "user_id": 2920193, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TMlNE.jpg?s=128&g=1", "display_name": "DilumN", "link": "https://stackoverflow.com/users/2920193/dilumn"}, "is_accepted": false, "score": 6, "last_activity_date": 1524901591, "creation_date": 1524901591, "answer_id": 50074167, "question_id": 47297283, "link": "https://stackoverflow.com/questions/47297283/cannot-load-such-file-rubygems-defaults-operating-system-when-installing-ru/50074167#50074167", "title": "&quot;cannot load such file -- rubygems/defaults/operating_system&quot; when installing Ruby 2.0.0", "body": "<p>Mention a specific version of <code>rubygems</code> will work too</p>\n\n<pre><code>rvm reinstall ruby-head --rubygems 2.6.11\n</code></pre>\n"}], "owner": {"reputation": 2282, "user_id": 6471170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7d911041d5a0cc0f9242fba3f8709495?s=128&d=identicon&r=PG&f=1", "display_name": "nasukkin", "link": "https://stackoverflow.com/users/6471170/nasukkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7800, "favorite_count": 3, "accepted_answer_id": 47298306, "answer_count": 2, "score": 18, "last_activity_date": 1524901591, "creation_date": 1510703998, "question_id": 47297283, "link": "https://stackoverflow.com/questions/47297283/cannot-load-such-file-rubygems-defaults-operating-system-when-installing-ru", "title": "&quot;cannot load such file -- rubygems/defaults/operating_system&quot; when installing Ruby 2.0.0", "body": "<p>I have need of Ruby 2.0.0, so I turned to RVM to help manage my ruby installations.</p>\n\n<p>However, when I do <code>rvm install ruby-2.0.0</code>, the installation ends up bombing out. </p>\n\n<pre><code>$ rvm install ruby-2.0.0\nSearching for binary rubies, this might take some time.\nNo binary rubies available for: osx/10.12/x86_64/ruby-2.0.0-p648.\nContinuing with compilation. Please read 'rvm help mount' to get more information on binary rubies.\nChecking requirements for osx.\nCertificates bundle '/usr/local/etc/openssl/cert.pem' is already up to date.\nRequirements installation successful.\nInstalling Ruby from source to: /Users/nick/.rvm/rubies/ruby-2.0.0-p648, this may take a while depending on your cpu(s)...\nruby-2.0.0-p648 - #downloading ruby-2.0.0-p648, this may take a while depending on your connection...\nruby-2.0.0-p648 - #extracting ruby-2.0.0-p648 to /Users/nick/.rvm/src/ruby-2.0.0-p648....\nruby-2.0.0-p648 - #applying patch /Users/nick/.rvm/patches/ruby/2.0.0/openssl3.patch.\nruby-2.0.0-p648 - #applying patch /Users/nick/.rvm/patches/ruby/2.0.0/update-autoconf.patch.\nruby-2.0.0-p648 - #configuring.................................................\nruby-2.0.0-p648 - #post-configuration.\nruby-2.0.0-p648 - #compiling...................................................|\nruby-2.0.0-p648 - #installing..............\nruby-2.0.0-p648 - #making binaries executable..\nruby-2.0.0-p648 - #downloading rubygems-2.7.2\nruby-2.0.0-p648 - #extracting rubygems-2.7.2.....\nruby-2.0.0-p648 - #removing old rubygems........\nruby-2.0.0-p648 - #installing rubygems-2.7.2.\nError running 'env GEM_HOME=/Users/nick/.rvm/gems/ruby-2.0.0-p648@global GEM_PATH= /Users/nick/.rvm/rubies/ruby-2.0.0-p648/bin/ruby -d /Users/nick/.rvm/src/rubygems-2.7.2/setup.rb --no-document',\nplease read /Users/nick/.rvm/log/1510703598_ruby-2.0.0-p648/rubygems.install.log\n</code></pre>\n\n<p>So, I check out the log file as instructed, and this is what I see:</p>\n\n<pre><code>[2017-11-14 15:55:25] /Users/nick/.rvm/rubies/ruby-2.0.0-p648/bin/ruby\ncurrent path: /Users/nick/.rvm/src/rubygems-2.7.2\nPATH=/usr/local/opt/coreutils/bin:/usr/local/opt/pkg-config/bin:/usr/local/opt/libtool/bin:/usr/local/opt/automake/bin:/usr/local/opt/autoconf/bin:/Users/nick/.nvm/versions/node/v8.4.0/bin:/usr/local/sbin:/usr/local/bin:/Users/nick/.gvm/vertx/current/bin:/Users/nick/.gvm/springboot/current/bin:/Users/nick/.gvm/lazybones/current/bin:/Users/nick/.gvm/jbake/current/bin:/Users/nick/.gvm/groovyserv/current/bin:/Users/nick/.gvm/groovy/current/bin:/Users/nick/.gvm/griffon/current/bin:/Users/nick/.gvm/grails/current/bin:/Users/nick/.gvm/gradle/current/bin:/Users/nick/.gvm/glide/current/bin:/Users/nick/.gvm/gaiden/current/bin:/Users/nick/.gvm/crash/current/bin:/usr/local/mongodb_2.4.5/bin:/Users/nick/.gvm/grails/current/bin:/usr/local/mysql/bin:/Library/Java/JavaVirtualMachines/jdk1.7.0_80.jdk/Contents/Home/bin:/usr/local/mongodb_2.4.5/bin:/Users/nick/.gvm/grails/current/bin:/usr/local/scala-2.12.1/bin:/usr/local/mysql/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/share/dotnet:/usr/local/git/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/Users/nick/.rvm/bin\ncommand(7): env GEM_HOME=/Users/nick/.rvm/gems/ruby-2.0.0-p648@global GEM_PATH= /Users/nick/.rvm/rubies/ruby-2.0.0-p648/bin/ruby -d /Users/nick/.rvm/src/rubygems-2.7.2/setup.rb --no-document\nException `LoadError' at /Users/nick/.rvm/rubies/ruby-2.0.0-p648/lib/ruby/2.0.0/rubygems.rb:1087 - cannot load such file -- rubygems/defaults/operating_system\nException `LoadError' at /Users/nick/.rvm/rubies/ruby-2.0.0-p648/lib/ruby/2.0.0/rubygems.rb:1096 - cannot load such file -- rubygems/defaults/ruby\nYAML safe loading is not available. Please upgrade psych to a version that supports safe loading (&gt;= 2.0).\nBundler 1.16.0 installed\nRubyGems 2.7.2 installed\nRegenerating binstubs\n</code></pre>\n\n<p>I'm not really sure what to make of this error. I've tried uninstalling 2.0.0 and installing it again, imploding &amp; reinstalling rvm, even reinstalling ruby with homebrew and doing everything from scratch, but this error persists. Any ideas?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "post", "multipartform-data"], "answers": [{"comments": [{"owner": {"reputation": 4632, "user_id": 83846, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/63d0301fd5cf100d3c291b76df0acc70?s=128&d=identicon&r=PG", "display_name": "Tom Corelis", "link": "https://stackoverflow.com/users/83846/tom-corelis"}, "edited": false, "score": 0, "creation_date": 1510788446, "post_id": 47297076, "comment_id": 81589271, "body": "Thanks you. I was hoping to avoid adding yet another dependency to this already-large project, but it looks like it&#39;s that, abandoning multipart, or writing my own support."}], "tags": [], "owner": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "is_accepted": true, "score": 2, "last_activity_date": 1510702607, "creation_date": 1510702607, "answer_id": 47297076, "question_id": 47296520, "link": "https://stackoverflow.com/questions/47296520/parsing-posted-multipart-form-data-in-rails-4-2/47297076#47297076", "title": "Parsing POSTed multipart/form-data in Rails 4.2", "body": "<p>There are a number of gems that handle this for you, as you've mentioned. The reason they exist is because</p>\n\n<ol>\n<li>There isn't anything built in to rails* simplify handling multipart form data</li>\n<li>Doing it yourself isn't easy</li>\n</ol>\n\n<p>*Rails 5.2 will <em>finally</em> introduce ActiveStorage, built-in polish for handling file uploads.</p>\n\n<p>As an aside, file uploads tie up a server process. If the file is large, this could be really painful for other users trying to access your app as they could get timed out. The general consensus is to upload your files client-side to the cloud storage provider of your choice instead of to your rails server. ActiveStorage will support this as well.</p>\n"}], "owner": {"reputation": 4632, "user_id": 83846, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/63d0301fd5cf100d3c291b76df0acc70?s=128&d=identicon&r=PG", "display_name": "Tom Corelis", "link": "https://stackoverflow.com/users/83846/tom-corelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 856, "favorite_count": 0, "accepted_answer_id": 47297076, "answer_count": 1, "score": 0, "last_activity_date": 1510702607, "creation_date": 1510699543, "question_id": 47296520, "link": "https://stackoverflow.com/questions/47296520/parsing-posted-multipart-form-data-in-rails-4-2", "title": "Parsing POSTed multipart/form-data in Rails 4.2", "body": "<p>I am trying to implement a <em>simple</em> AJAX image uploader with multiple selection support using a standard HTML <code>input</code> with <code>type=\"file\"</code>. The JS uploading code looks like:</p>\n\n<pre><code>var files = document.getElementById(\"txtFiles\").files;\nvar formData = new FormData();\n\nfor (var file = 0; file &lt; files.length; file++) {\n  formData.append(\"userimage\", files[file], name)\n}\n\n//throw up a loading bar while we're uploading\nutil.loaderShow(\"Uploading, please wait...\");\n\n$.ajax({\n\n  url: '#{upload_alert_image_url}',\n\n  data: formData,\n  processData: false,\n  contentType: 'multipart/form-data',\n  type: 'POST',\n\n  success: function() {\n    util.loaderHide();\n    alert(\"Got success!\");\n    finish_upload();\n  },\n\n  error: function(e) {\n    util.loaderHide()\n    alert(\"Upload failed: \"+e);\n  },\n\n  complete: function() {\n    util.loaderHide();\n  }\n\n})\n</code></pre>\n\n<p>On the Rails side of things, right now <code>request.body</code> is simply saved to a temporary file, and inside that temp file is the body of the request from the above JS snippet, as expected. </p>\n\n<p>What is the correct way to get at that data without having to write a multipart/form-data parser myself? Is there a function somewhere that takes this raw data and spits out some sort of hash or array with the included uploads?</p>\n\n<p>I've been Googling and searching SO and Rails docs for an hour or two trying to find an answer. There are a variety of gems that handle file uploading (most of which have way too other cruft I don't want) as well as the <code>multipart-parser</code>, and I have checked these out... but given that multipart/form-data is old and useful, I have a hard time believing there isn't in-the-box support someplace I'm not looking. <code>Rack::Middleware</code> claims to have an <code>.extract_multipart</code> class method, according to its docs, but I can't figure out how to access it.</p>\n\n<p>So... how is one supposed to receive POST'd multipart/form-data?</p>\n\n<p>Thanks</p>\n\n<p>Tom</p>\n"}, {"tags": ["ruby", "equality", "return-type"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1510715249, "post_id": 47296311, "comment_id": 81548814, "body": "I am not sure what your second question means."}], "answers": [{"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 7, "last_activity_date": 1510699752, "creation_date": 1510699752, "answer_id": 47296559, "question_id": 47296311, "link": "https://stackoverflow.com/questions/47296311/how-can-stringreverse-return-non-string-objects/47296559#47296559", "title": "How can &#39;String#reverse&#39; return non-&#39;String&#39; objects?", "body": "<p>While the documentation for <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-reverse\" rel=\"noreferrer\"><code>String#reverse</code></a> states:</p>\n\n<blockquote>\n  <p>Returns a new string with the characters from str in reverse order.</p>\n</blockquote>\n\n<p>and so you might expect a return type of <code>String</code>, if you pop open the method you can see the line</p>\n\n<pre><code>rev = rb_str_new_with_class(str, 0, RSTRING_LEN(str));\n</code></pre>\n\n<p>and that <code>rev</code> is what actually gets returned. My C is fairly rusty, but looking around the C code for ruby, that method <code>rb_str_new_with_class</code> seems to be doing exactly what it says, it creates a new instance of whatever class <code>str</code> is, in this case <code>Word</code>. So, what the documentation means when it says it returns a new string, is that it returns a new instance of whatever class this string is, which in most cases is <code>String</code>.</p>\n\n<p>So knowing that it creates a new instance of whatever class the current string is, it's easy to see how <code>w.reverse</code> ended up having a <code>magic</code> method...because <code>Word</code> gave it the method, and it is a <code>Word</code>.</p>\n\n<p>And finally, how are they equal? You don't define a new <code>==</code> method on <code>Word</code>, so it takes the parent <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-3D-3D\" rel=\"noreferrer\"><code>String#==</code></a> method, which doesn't know or care that there are instance variables and just compares the values of the string, coercing things using <code>to_str</code> if necessary and able, you could even do:</p>\n\n<pre><code>Word.new(\"level\") == \"level\" # =&gt; true\n</code></pre>\n\n<p>(Note: I'm not actually sure if <code>Word</code> gets coerced or not.)</p>\n"}], "owner": {"reputation": 109, "user_id": 7153036, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/7e4747a3d45124fa030df5c11f223986?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Marshle", "link": "https://stackoverflow.com/users/7153036/tony-marshle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510716000, "creation_date": 1510698572, "last_edit_date": 1510716000, "question_id": 47296311, "link": "https://stackoverflow.com/questions/47296311/how-can-stringreverse-return-non-string-objects", "title": "How can &#39;String#reverse&#39; return non-&#39;String&#39; objects?", "body": "<p>I have a class <code>Word</code>:</p>\n\n<pre><code>class Word &lt; String\nend\n\nw = Word.new(\"level\")\ny = w.reverse\ny.class # =&gt; Word\n</code></pre>\n\n<p>1) How is this possible? <code>Word#reverse</code> should return a <code>String</code> because it inherits <code>String#reverse</code>, which returns a <code>String</code>.</p>\n\n<p>I added this code:</p>\n\n<pre><code>class Word &lt; String\n  attr_accessor :s\n\n  def magic\n    @s = Time.now\n  end\nend\n\ny.magic\nsleep(5)\nw.magic\ny.s == w # =&gt; false\ny == w # =&gt; true\n</code></pre>\n\n<p>2) <code>w</code> and <code>y</code> are <code>Word</code>, and are equal, hence they both have the same methods, such as <code>magic</code>. Where did <code>y</code> acquire the <code>magic</code> method?</p>\n\n<p>3) How come <code>y == w</code> evaluates to <code>true</code> while <code>y.s</code> and <code>w.s</code> return unequal values?</p>\n"}, {"tags": ["ruby", "xpath", "replace", "nokogiri"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1510697080, "post_id": 47295867, "comment_id": 81543219, "body": "What&#39;s the resource trying to be scraped?, to see if there&#39;s a pattern, and when you say you want to build an array, that&#39;s a hash, or do you want to create an array of hashes?, also, as the number is 340, and the object a340, is the name also variable?"}, {"owner": {"reputation": 35, "user_id": 2326769, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/faaac1fcd71c9759b389860339756ad0?s=128&d=identicon&r=PG", "display_name": "Malcolm Isaacson", "link": "https://stackoverflow.com/users/2326769/malcolm-isaacson"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1510697448, "post_id": 47295867, "comment_id": 81543416, "body": "Here&#39;s a link to the source: <a href=\"https://www.admin.ch/opc/fr/classified-compilation/20061121/index.html\" rel=\"nofollow noreferrer\">admin.ch/opc/fr/classified-compilation/20061121/index.html</a> I&#39;m indeed aiming at an array of hashes, specifically an array or articles. The name of the object is also a variable (ie its an iteration of one article)"}], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1510699475, "post_id": 47296427, "comment_id": 81544308, "body": "Having all the data within the array, do you really need them as variables?"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 0, "last_activity_date": 1510699853, "last_edit_date": 1510699853, "creation_date": 1510699099, "answer_id": 47296427, "question_id": 47295867, "link": "https://stackoverflow.com/questions/47295867/nokogiri-replace-arbitrary-nodes/47296427#47296427", "title": "Nokogiri replace arbitrary nodes", "body": "<p>Maybe accessing to <code>'#lawcontent .collapseable h5'</code> could work:</p>\n\n<pre><code>require 'nokogiri'\nrequire 'open-uri'\n\nurl = 'https://www.admin.ch/opc/fr/classified-compilation/20061121/index.html'\ndoc = Nokogiri.HTML(open url)\narticles_hash = doc.css('#lawcontent .collapseable h5').map do |element|\n  {\n    'number' =&gt; element.css('a strong').text.sub(/\\AArt. /, ''),\n    'title'  =&gt; element.css('a:last-child').text.sub(/\\AArt. \\d+ |\\A\\d+/, '')\n  }\nend\nputs articles_hash\n\n# [\n#  {\"number\"=&gt;\"1\", \"title\"=&gt;\"Objet\"}, \n#  {\"number\"=&gt;\"2\", \"title\"=&gt;\"Causes de nature internationale\"},\n#  {\"number\"=&gt;\"3\", \"title\"=&gt;\"Organisation des tribunaux et des autorit\\u00E9s de conciliation\"},\n#  ...\n# ]\n</code></pre>\n\n<p>This iterates and gets until the article #407.</p>\n"}], "owner": {"reputation": 35, "user_id": 2326769, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/faaac1fcd71c9759b389860339756ad0?s=128&d=identicon&r=PG", "display_name": "Malcolm Isaacson", "link": "https://stackoverflow.com/users/2326769/malcolm-isaacson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 47296427, "answer_count": 1, "score": -1, "last_activity_date": 1510699853, "creation_date": 1510696477, "question_id": 47295867, "link": "https://stackoverflow.com/questions/47295867/nokogiri-replace-arbitrary-nodes", "title": "Nokogiri replace arbitrary nodes", "body": "<p>I'm trying to scrape some piece of legislation. Here's an excerpt of the code:</p>\n\n<pre><code>&lt;h5&gt;\n&lt;span class=\"expanderComparator clickable\"&gt;&amp;nbsp;&lt;/span&gt;\n&lt;span class=\"context-menu\"&gt;&amp;nbsp;&lt;/span&gt;\n&lt;a href=\"index.html#a340\"&gt;\n&lt;strong&gt;Art. 340&lt;/strong&gt;\n&lt;/a&gt;\n&lt;sup&gt;\n&lt;a href=\"#fn-#a340-1\"&gt;1&lt;/a&gt;\n&lt;/sup&gt;\n&lt;a href=\"index.html#a340\"&gt;Mesures conservatoires&lt;/a&gt;\n&lt;/h5&gt;\n</code></pre>\n\n<p>This piece of code is repeated for each article (can be above a thousand), but its structure follows essentially the same pattern.</p>\n\n<p>I'm trying to build an array as such:</p>\n\n<pre><code>a340 = { 'number' =&gt; '340', 'title' =&gt; 'Mesures conservatoires'}\n</code></pre>\n\n<p>So obviously I looked at Nokogiri, which seems to be appropriate. Here are the problems though:</p>\n\n<ul>\n<li><p>this piece <code>&lt;sup&gt;&lt;a href=\"#fn-#a340-1\"&gt;1&lt;/a&gt;&lt;/sup&gt;</code> needs to be replaced by a space (\" \") => <code>h1 = @doc.at_xpath \"//sup/a\" h1.content = \" \"</code></p></li>\n<li><p>all <code>span</code> and <code>a</code> tags need to be removed </p></li>\n<li><p>ultimately, keep only what's inside the <code>h5</code> tag (because there's other bloat as well that's not required) => <code>.css(\"h5\").text</code></p></li>\n</ul>\n\n<p>I was essentially able to reach all of the above, yet somehow I'm unable to chain them up into one logical software.</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p>Caveat: it needs to be pure ruby only, so no rails :(</p>\n"}, {"tags": ["arrays", "ruby", "sorting", "elasticsearch"], "answers": [{"tags": [], "owner": {"reputation": 4576, "user_id": 5095957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uSIvc.jpg?s=128&g=1", "display_name": "Nikolay Vasiliev", "link": "https://stackoverflow.com/users/5095957/nikolay-vasiliev"}, "is_accepted": false, "score": 1, "last_activity_date": 1510739685, "creation_date": 1510739685, "answer_id": 47304233, "question_id": 47295552, "link": "https://stackoverflow.com/questions/47295552/elasticsearch-sorting-by-array-column/47304233#47304233", "title": "Elasticsearch sorting by array column", "body": "<p>In ElasticSearch <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/array.html\" rel=\"nofollow noreferrer\">arrays of objects do not work as you would expect</a>:</p>\n\n<blockquote>\n  <p>Arrays of objects do not work as you would expect: you cannot query\n  each object independently of the other objects in the array. If you\n  need to be able to do this then you should use the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/nested.html\" rel=\"nofollow noreferrer\">nested</a> datatype\n  instead of the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/object.html\" rel=\"nofollow noreferrer\">object</a> datatype.</p>\n  \n  <p>This is explained in more detail in <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/nested.html\" rel=\"nofollow noreferrer\">Nested</a> datatype.</p>\n</blockquote>\n\n<p>It is not possible to access array elements at sort time by their indices since they are stored in a Lucene index, which allows basically only <code>set</code> operations (\"give docs that have array element = x\" or \"give docs that do not have array element = x\").</p>\n\n<p>However, by default the initial JSON document inserted into the index is stored on the disk and is available for scripting access in the field <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/1.4/mapping-source-field.html\" rel=\"nofollow noreferrer\"><code>_source</code></a>.</p>\n\n<p>You have two options:</p>\n\n<ol>\n<li>use <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/1.4/search-request-sort.html#_script_based_sorting\" rel=\"nofollow noreferrer\">script based sorting</a></li>\n<li>store value for sorting explicitly as string</li>\n</ol>\n\n<p>Let's discuss these options in a bit more detail.</p>\n\n<h3>1. Script based sorting</h3>\n\n<p>The first option is more like a hack. Let's assume you have a mapping like this:</p>\n\n<pre><code>PUT my_index\n{\n  \"mappings\": {\n    \"my_type\": {\n      \"properties\": {\n        \"my_array\": {\n          \"type\": \"integer\"\n        }\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>Then you can achieve intended behavior with a scripted sort:</p>\n\n<pre><code>POST my_index/my_type/_search\n{\n      \"sort\" : {\n        \"_script\" : {\n            \"script\" : \"String s = ''; for(int i = 0; i &lt; params._source.my_array.length; ++i) {s += params._source.my_array[i] + ','}  s\",\n            \"type\" : \"string\",\n            \"order\" : \"asc\"\n        }\n    }\n}\n</code></pre>\n\n<p>(I tested the code on ElasticSearch 5.4, I believe there should be something equivalent for the earlier versions. Please consult relevant documentation in the case you need info for earlier versions, like for <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/1.4/modules-scripting.html\" rel=\"nofollow noreferrer\">1.4</a>.)</p>\n\n<p>The output will be:</p>\n\n<pre><code>  \"hits\": {\n    \"total\": 2,\n    \"max_score\": null,\n    \"hits\": [\n      {\n        \"_index\": \"my_index\",\n        \"_type\": \"my_type\",\n        \"_id\": \"2\",\n        \"_score\": null,\n        \"_source\": {\n          \"my_array\": [\n            1,\n            32,\n            1,\n            16\n          ]\n        },\n        \"sort\": [\n          \"1,32,1,16,\"\n        ]\n      },\n      {\n        \"_index\": \"my_index\",\n        \"_type\": \"my_type\",\n        \"_id\": \"1\",\n        \"_score\": null,\n        \"_source\": {\n          \"my_array\": [\n            1,\n            32,\n            10,\n            1500\n          ]\n        },\n        \"sort\": [\n          \"1,32,10,1500,\"\n        ]\n      }\n    ]   }\n</code></pre>\n\n<p>Note that this solution will be slow and memory consuming since it will have to read <code>_source</code> for all documents under sort from disk and to load them into memory.</p>\n\n<h3>2. Denormalization</h3>\n\n<p>Storing the value for sorting explicitly as string is more like ElasticSearch approach, which favors <a href=\"https://www.elastic.co/guide/en/elasticsearch/guide/current/denormalization.html\" rel=\"nofollow noreferrer\">denormalization</a>. Here the idea would be to do the concatenation before inserting the document into the index and use robust sorting by a string field.</p>\n\n<p>Please select the solution more appropriate for your needs.</p>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 165, "user_id": 954421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2dfde0af45ff0b93a4ea0b5ecb25a754?s=128&d=identicon&r=PG", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/954421/benjamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2716, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1510739685, "creation_date": 1510695038, "question_id": 47295552, "link": "https://stackoverflow.com/questions/47295552/elasticsearch-sorting-by-array-column", "title": "Elasticsearch sorting by array column", "body": "<p>How to sort records by column with array of numbers?\nFor example:</p>\n\n<pre><code>[1, 32, 26, 16]\n[1, 32, 10, 1500]\n[1, 32, 1,  16]\n[1, 32, 2,  17]\n</code></pre>\n\n<p>The result that is to be expected:</p>\n\n<pre><code>[1, 32, 1,  16]\n[1, 32, 2,  17]\n[1, 32, 10, 1500]\n[1, 32, 26, 16]\n</code></pre>\n\n<p>Elasticsearch has sort mode option: <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/1.4/search-request-sort.html#_sort_mode_option\" rel=\"nofollow noreferrer\">https://www.elastic.co/guide/en/elasticsearch/reference/1.4/search-request-sort.html#_sort_mode_option</a>. But no one variant is not appropriated.</p>\n\n<p>Language Ruby can sort arrays of numbers' array, ruby has method <a href=\"http://ruby-doc.org/core-1.9.3/Array.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">Array.&lt;=></a>, which description says \"<em>Each object in each array is compared</em>\"</p>\n\n<p>How to do the same with elasticsearch?</p>\n\n<p>P.S. Sorry for my English</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-5", "rack"], "answers": [{"tags": [], "owner": {"reputation": 299, "user_id": 1482740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee4197d7595f157133b636fac5d0257c?s=128&d=identicon&r=PG", "display_name": "RubyMiner", "link": "https://stackoverflow.com/users/1482740/rubyminer"}, "is_accepted": false, "score": 0, "last_activity_date": 1510739147, "last_edit_date": 1510739147, "creation_date": 1510738556, "answer_id": 47303826, "question_id": 47295213, "link": "https://stackoverflow.com/questions/47295213/rack-custom-middleware-giving-error-actiondispatchhttpparametersparseerro/47303826#47303826", "title": "Rack custom middleware giving error &quot;ActionDispatch::Http::Parameters::ParseError&quot;", "body": "<p>Added a hack to set content-type as \"\" in custom middleware, which avoided  parsing on the input before forwarding the input to next component in the stack. </p>\n\n<pre><code> class CustomMiddleware   \n\n   include Encryption   \n\n   def initialize(app)\n     @app = app   end\n\n   def set_payload_params(env)\n     rack_input = env['rack.input'].read\n     @args = JSON.parse(rack_input) rescue {}   end\n\n   def call(env)\n     env['CONTENT_TYPE'] = ''\n     request = Rack::Request.new(env)\n     set_payload_params(env)\n\n     payload = @args['payload']\n\n     decrypt_params\n     status, headers, response = @app.call(env)\n     encrypt_params\n\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 596, "user_id": 5048945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iG5i7.png?s=128&g=1", "display_name": "mmike", "link": "https://stackoverflow.com/users/5048945/mmike"}, "is_accepted": false, "score": 0, "last_activity_date": 1608625610, "creation_date": 1608625610, "answer_id": 65405356, "question_id": 47295213, "link": "https://stackoverflow.com/questions/47295213/rack-custom-middleware-giving-error-actiondispatchhttpparametersparseerro/65405356#65405356", "title": "Rack custom middleware giving error &quot;ActionDispatch::Http::Parameters::ParseError&quot;", "body": "<p>This error occurs cause after params are empty after read in middleware (this is stream).</p>\n<pre><code>rack_input = env['rack.input'].read\n</code></pre>\n<p>After execute this code rack params are blank. Now you need to make</p>\n<pre><code>env['rack.input'].rewind \n</code></pre>\n<p>or</p>\n<pre><code>request.body.rewind\n</code></pre>\n<p>Now your request has params again and Rails can simply continue job.</p>\n"}], "owner": {"reputation": 299, "user_id": 1482740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee4197d7595f157133b636fac5d0257c?s=128&d=identicon&r=PG", "display_name": "RubyMiner", "link": "https://stackoverflow.com/users/1482740/rubyminer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 726, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1608625610, "creation_date": 1510693663, "question_id": 47295213, "link": "https://stackoverflow.com/questions/47295213/rack-custom-middleware-giving-error-actiondispatchhttpparametersparseerro", "title": "Rack custom middleware giving error &quot;ActionDispatch::Http::Parameters::ParseError&quot;", "body": "<p>I am writing a custom middleware for my rails app, to decrypt/encrypt parameters in a post request. I have configured the middleware in <code>'config/environments/staging.rb'</code> </p>\n\n<pre><code>config.middleware.use CustomMiddleware\n</code></pre>\n\n<p>In order to read the request params i am reading the env obj like this </p>\n\n<pre><code>rack_input = env['rack.input'].read\n</code></pre>\n\n<p>I am able to access the parameter and manipulate as needed. But when i pass over on the <code>env</code> obj to the app object which is the receiver. I am getting </p>\n\n<pre><code>\"ActionDispatch::Http::Parameters::ParseError\" \n</code></pre>\n\n<p>Full error</p>\n\n<pre><code>Error occurred while parsing request parameters.\nContents:\n\n\nF, [2017-11-15T02:13:50.230088 #24060] FATAL -- : [9aa25c7e-56e7-4894-ba30-3a01f60ae4fc]   \nF, [2017-11-15T02:13:50.230340 #24060] FATAL -- : [9aa25c7e-56e7-4894-ba30-3a01f60ae4fc] ActionDispatch::Http::Parameters::ParseError (no implicit conversion of nil into String):\nF, [2017-11-15T02:13:50.230563 #24060] FATAL -- : [9aa25c7e-56e7-4894-ba30-3a01f60ae4fc]   \nF, [2017-11-15T02:13:50.230782 #24060] FATAL -- : [9aa25c7e-56e7-4894-ba30-3a01f60ae4fc] app/middleware/custom_middleware.rb:34:in `call'\n</code></pre>\n\n<p>My code is somewhat like this </p>\n\n<pre><code>class CustomMiddleware\n  include Encryption   \n\n  def initialize(app)\n    @app = app\n  end\n\n  def set_payload_params(env)\n    rack_input = env['rack.input'].read\n    @args = JSON.parse(rack_input) rescue {}\n  end\n\n  def call(env)\n    request = Rack::Request.new(env)\n    set_payload_params(env)\n\n    payload = @args['payload']\n\n    decrypt_params\n    status, headers, response = @app.call(env)\n    encrypt_params\n\n  end\n</code></pre>\n\n<p>If i don't read the env object and hard code the parameters, there is no such parsing error. And my controller is responding with data w.r.t to hardcode parameters. </p>\n\n<p>My Rails version is 5.1.4\nMy ruby version is 2.4.2</p>\n\n<p>I have done a similar middleware in another rails app(4.2.8) which is working fine. </p>\n\n<p>Any insight on this will be of much help. Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "comments", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 2, "creation_date": 1510691563, "post_id": 47294643, "comment_id": 81540367, "body": "1) Rails 3 is way out of date. 2) Please format your post."}, {"owner": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "edited": false, "score": 0, "creation_date": 1510691914, "post_id": 47294643, "comment_id": 81540540, "body": "I agree with coreward, If this is a new app, I&#39;d recommend using Rails 5.  If you want a slightly older version, use the latest Rails 4.  BTW, the fact that your model  class inherits from <code>ApplicationRecord</code> leads me to believe you  are using Rails 5."}], "answers": [{"comments": [{"owner": {"reputation": 417, "user_id": 5409412, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c725d6d0a6211b9607d46b2f09c8cfa4?s=128&d=identicon&r=PG&f=1", "display_name": "User59", "link": "https://stackoverflow.com/users/5409412/user59"}, "edited": false, "score": 0, "creation_date": 1510692168, "post_id": 47294734, "comment_id": 81540681, "body": "It has this. I checked"}, {"owner": {"reputation": 417, "user_id": 5409412, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c725d6d0a6211b9607d46b2f09c8cfa4?s=128&d=identicon&r=PG&f=1", "display_name": "User59", "link": "https://stackoverflow.com/users/5409412/user59"}, "edited": false, "score": 0, "creation_date": 1510693318, "post_id": 47294734, "comment_id": 81541288, "body": "Doing what you suggested gives this error: wrong number of arguments (2 for 0..1)"}, {"owner": {"reputation": 221, "user_id": 5420504, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/174979efbe4f8e8e9f1579ac1c551f82?s=128&d=identicon&r=PG&f=1", "display_name": "kparekh01", "link": "https://stackoverflow.com/users/5420504/kparekh01"}, "reply_to_user": {"reputation": 417, "user_id": 5409412, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c725d6d0a6211b9607d46b2f09c8cfa4?s=128&d=identicon&r=PG&f=1", "display_name": "User59", "link": "https://stackoverflow.com/users/5409412/user59"}, "edited": false, "score": 0, "creation_date": 1510694419, "post_id": 47294734, "comment_id": 81541889, "body": "Sorry for the delay, been a bit busy.  Let me know if the edited version works.  Basically just passing in the strong comment_params to the create method."}], "tags": [], "owner": {"reputation": 221, "user_id": 5420504, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/174979efbe4f8e8e9f1579ac1c551f82?s=128&d=identicon&r=PG&f=1", "display_name": "kparekh01", "link": "https://stackoverflow.com/users/5420504/kparekh01"}, "is_accepted": false, "score": 1, "last_activity_date": 1510694327, "last_edit_date": 1510694327, "creation_date": 1510691779, "answer_id": 47294734, "question_id": 47294643, "link": "https://stackoverflow.com/questions/47294643/ruby-on-rails-unable-to-create-comments-nomethoderror/47294734#47294734", "title": "Ruby on rails - unable to create comments. NoMethodError", "body": "<p>Looks like you may be missing a <code>has_many :comments</code> association in your Forum model.  Check it out.</p>\n\n<p>Alternatively if the has_many association exits then it allows you to call 'comments' on any Forum object, not 'comment'.</p>\n\n<p>if you want to create a comment for a particular forum you can do so like this:</p>\n\n<pre><code>@comment = Comment.create(comment_params) #create a comment associated with this forum.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "is_accepted": false, "score": 0, "last_activity_date": 1510692116, "creation_date": 1510692116, "answer_id": 47294819, "question_id": 47294643, "link": "https://stackoverflow.com/questions/47294643/ruby-on-rails-unable-to-create-comments-nomethoderror/47294819#47294819", "title": "Ruby on rails - unable to create comments. NoMethodError", "body": "<p>Make sure you have a <code>comments</code> association in the <code>Forum</code> model:</p>\n\n<pre><code>class Forum &lt; ApplicationRecord\n  has_many :comments\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 307, "user_id": 5109793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36498fee1b7985307360dc86bbba25a8?s=128&d=identicon&r=PG&f=1", "display_name": "Chivorn Kouch", "link": "https://stackoverflow.com/users/5109793/chivorn-kouch"}, "edited": false, "score": 0, "creation_date": 1510712359, "post_id": 47295764, "comment_id": 81548138, "body": "There is a better way to do this. Please check my answer."}, {"owner": {"reputation": 594, "user_id": 8934465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tzs1gobeQZ8/AAAAAAAAAAI/AAAAAAAAAOw/irKKhYM8Xj4/photo.jpg?sz=128", "display_name": "Milan Pudasaini", "link": "https://stackoverflow.com/users/8934465/milan-pudasaini"}, "edited": false, "score": 0, "creation_date": 1510775656, "post_id": 47295764, "comment_id": 81583108, "body": "rather use <code>@comment = @forum.comments.new(comment_params)</code> and <code>@comment.save</code>"}], "tags": [], "owner": {"reputation": 417, "user_id": 5409412, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c725d6d0a6211b9607d46b2f09c8cfa4?s=128&d=identicon&r=PG&f=1", "display_name": "User59", "link": "https://stackoverflow.com/users/5409412/user59"}, "is_accepted": true, "score": 0, "last_activity_date": 1510696032, "creation_date": 1510696032, "answer_id": 47295764, "question_id": 47294643, "link": "https://stackoverflow.com/questions/47294643/ruby-on-rails-unable-to-create-comments-nomethoderror/47295764#47295764", "title": "Ruby on rails - unable to create comments. NoMethodError", "body": "<p>So, the problem lay in the CommentsController.</p>\n\n<p>I changed the comments controller to do this instead:</p>\n\n<pre><code>def create\n        @forum = Forum.find(params[:forum_id])\n\n        @comment = Comment.new(comment_params)\n        @comment.forum_id = @forum.id\n        @comment.save!\n\n        redirect_to forum_path(@forum)\n    end\n\n\n    private\n        def comment_params\n            params.require(:comment).permit(:body)\n        end\n</code></pre>\n\n<p>Seemed to do the trick.</p>\n\n<p>Thank you to all those who gave an answer.</p>\n"}, {"tags": [], "owner": {"reputation": 307, "user_id": 5109793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36498fee1b7985307360dc86bbba25a8?s=128&d=identicon&r=PG&f=1", "display_name": "Chivorn Kouch", "link": "https://stackoverflow.com/users/5109793/chivorn-kouch"}, "is_accepted": false, "score": 1, "last_activity_date": 1510711861, "creation_date": 1510711861, "answer_id": 47298278, "question_id": 47294643, "link": "https://stackoverflow.com/questions/47294643/ruby-on-rails-unable-to-create-comments-nomethoderror/47298278#47298278", "title": "Ruby on rails - unable to create comments. NoMethodError", "body": "<p>The problem is with this line <code>@comment = @forum.comment.create(comment_params)</code> in your CommentsController.\nIt should be <code>@comment = @forum.comments.create(comment_params)</code> . <code>comments</code> should be plural.</p>\n\n<p>Your code should be:</p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  def create\n    @forum = Forum.find(params[:forum_id])\n    @comment = @forum.comments.create(comment_params)\n    redirect_to forum_path\n  end\n\n  private\n\n  def comment_params\n    params.require(:comment).permit(:body)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 417, "user_id": 5409412, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c725d6d0a6211b9607d46b2f09c8cfa4?s=128&d=identicon&r=PG&f=1", "display_name": "User59", "link": "https://stackoverflow.com/users/5409412/user59"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 47295764, "answer_count": 4, "score": 0, "last_activity_date": 1510711861, "creation_date": 1510691397, "last_edit_date": 1510692273, "question_id": 47294643, "link": "https://stackoverflow.com/questions/47294643/ruby-on-rails-unable-to-create-comments-nomethoderror", "title": "Ruby on rails - unable to create comments. NoMethodError", "body": "<p>I am creating one of my first RoR applications - a forum. I am try to add comments to the forum, but I am getting some errors. I have Googled for similar issues but none of the seem to solve my issue. Here is my code:</p>\n\n<p>Comments Controller:</p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  def create\n    @forum = Forum.find(params[:forum_id])\n\n    if !@forum.nil?\n        puts \"Forum object is not nil\"\n    end\n\n    @comment = @forum.comment.create(comment_params)\n\n    redirect_to forum_path\n  end\n\n  private\n\n  def comment_params\n    params.require(:comment).permit(:body)\n  end\nend\n</code></pre>\n\n<p>The Forum controller is auto generated and I haven't changed in. (generated using rails generate scaffold Forum, if you still want to see it, let me know)</p>\n\n<pre><code>class Comment &lt; ApplicationRecord\n  belongs_to :forum\nend\n\nclass Forum &lt; ApplicationRecord\n  has_many :comments\n  validates :title, presence: true,\n  length: {maximum: 50}\n  validates :body, presence: true\nend\n</code></pre>\n\n<p>Below is the form for section from the show.html.erb <strong>for the forum page</strong></p>\n\n<pre><code>&lt;h2&gt;Comments&lt;/h2&gt;\n\n&lt;% @forum.comments.each do |comment| %&gt;\n&lt;p&gt;\n    &lt;%= comment.body %&gt;\n&lt;/p&gt;\n\n&lt;% end %&gt;\n\n&lt;h2&gt;Add a comment&lt;/h2&gt;\n\n&lt;%= form_for([@forum, @forum.comments.build]) do |f| %&gt;\n&lt;p&gt;\n    &lt;%= f.label :body %&gt;&lt;br/&gt;\n    &lt;%= f.text_area :body %&gt;\n&lt;/p&gt;\n&lt;p&gt;\n    &lt;%= f.submit %&gt;\n&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And this is the error from rails:</p>\n\n<pre><code>undefined method `comment' for #&lt;Forum:0x444d518&gt;\n</code></pre>\n\n<p>with the following extract:</p>\n\n<pre><code>end\n @comment = @forum.comment.create(comment_params) #highlighted\n redirect_to forum_path\nend\n</code></pre>\n"}, {"tags": ["ruby", "syntax"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1510687013, "post_id": 47293587, "comment_id": 81538015, "body": "What is <code>x</code>? Please add."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510688310, "post_id": 47293587, "comment_id": 81538664, "body": "You can inspect the <a href=\"https://stackoverflow.com/a/16629318/125816\">ruby grammar</a>, figure this out and tell us!"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 3, "creation_date": 1510693135, "post_id": 47293587, "comment_id": 81541161, "body": "@SagarPandya: It is completely irrelevant, because this question is about syntax, not semantics."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 2, "creation_date": 1510696904, "post_id": 47293587, "comment_id": 81543131, "body": "This is fascinating. Now I&#39;m trying to think of other valid syntax that breaks when you enclose it in <code>[]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4028239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GAbTC.jpg?s=128&g=1", "display_name": "vladpisanov", "link": "https://stackoverflow.com/users/4028239/vladpisanov"}, "edited": false, "score": 0, "creation_date": 1510689445, "post_id": 47293621, "comment_id": 81539284, "body": "Right, I&#39;m just using <code>puts</code> as a placeholder. It&#39;s just odd because, for example CoffeeScript has no issues with this syntax. I wonder why Ruby considers it ambiguous."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 135, "user_id": 4028239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GAbTC.jpg?s=128&g=1", "display_name": "vladpisanov", "link": "https://stackoverflow.com/users/4028239/vladpisanov"}, "edited": false, "score": 0, "creation_date": 1510694547, "post_id": 47293621, "comment_id": 81541962, "body": "It&#39;s up to the Ruby parser to make sense of this. While the <a href=\"https://en.wikipedia.org/wiki/Lexical_analysis\" rel=\"nofollow noreferrer\">lexer</a> can understand the components you&#39;re using, the <a href=\"https://en.wikipedia.org/wiki/Parsing#Computer_languages\" rel=\"nofollow noreferrer\">parser</a> can&#39;t deal with the ambiguity. It&#39;s not expecting those tokens to be in that order. Maybe you could petition the Ruby core team to fix this, but as it stands it&#39;s a consequence of how Ruby&#39;s parser is implemented."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1510696579, "post_id": 47293621, "comment_id": 81542974, "body": "This does not answer the question at all: why can&#39;t Ruby parse <code>[puts x[1]]</code>? To me it seems unambiguous, and I&#39;m very surprised by the error."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1510696909, "post_id": 47293621, "comment_id": 81543135, "body": "@Max It&#39;s a limitation of the parser. Like I said, if you want to fix it, you&#39;ll have to patch that code and get the core team to pick up on it."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1510697501, "post_id": 47293621, "comment_id": 81543437, "body": "@tadman this got me thinking, and I&#39;m pretty sure it&#39;s intentional (and well-thought-out) behavior. See my answer."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 6, "last_activity_date": 1510687039, "creation_date": 1510687039, "answer_id": 47293621, "question_id": 47293587, "link": "https://stackoverflow.com/questions/47293587/why-is-f-x1-ungrammatical-while-1-x1-is/47293621#47293621", "title": "Why is &#39;[f x[1]]&#39; ungrammatical while &#39;[1 + x[1]]&#39; is?", "body": "<p>In Ruby you can often, but not always omit the parentheses around method calls. You've found a case where you can't. Sometimes there's too much ambiguity for Ruby to understand exactly what you want and you must be more specific.</p>\n\n<p>The valid notation here is:</p>\n\n<pre><code>[puts(x[1])]\n</code></pre>\n\n<p>Though as <code>puts</code> always returns <code>nil</code>, this is really an odd thing to do.</p>\n"}, {"comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 3, "creation_date": 1510698581, "post_id": 47296077, "comment_id": 81543936, "body": "It&#39;s worth noting (maybe) that there are cases where Ruby will slap you with a syntax error if you add another element to an array, and it is indeed frustrating: <code>a = [ 2, foo: :bar] # fine</code> whereas <code>a = [ 2, foo: :bar, 3] # syntax error</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1510702026, "post_id": 47296077, "comment_id": 81545257, "body": "You can also have <code>f 2, f 3, 4</code> which is especially perplexing."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1510756718, "post_id": 47296077, "comment_id": 81570709, "body": "@SimpleLime ewww. given that example I&#39;d say Ruby also shouldn&#39;t allow omitted braces inside an array"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 9, "last_activity_date": 1510697788, "last_edit_date": 1510697788, "creation_date": 1510697428, "answer_id": 47296077, "question_id": 47293587, "link": "https://stackoverflow.com/questions/47293587/why-is-f-x1-ungrammatical-while-1-x1-is/47296077#47296077", "title": "Why is &#39;[f x[1]]&#39; ungrammatical while &#39;[1 + x[1]]&#39; is?", "body": "<p>I believe this parsing behavior is intentional--not a bug. It's an unfortunate side-effect of Ruby allowing omitted parentheses. This code is, of course, fine:</p>\n\n<pre><code>def f x, y=0\n  x + y\nend\n\nf 2    # 2\nf 2, 3 # 5\n</code></pre>\n\n<p>But what is the result of this code?</p>\n\n<pre><code>[f 2, 3]\n</code></pre>\n\n<p><code>[2,3]</code> or <code>[5]</code>? In order for the syntactical analyzer to handle this code, it would need to understand the arity of the method. But because Ruby is dynamic that cannot be determined until the method call is actually performed.</p>\n\n<p>Rather than allow the ambiguous case, which would surely result in surprising situations during runtime, the designers opted for the (still surprising, but) easily fixable error during parsing.</p>\n\n<p><strong>Note:</strong> you could still argue that in the case where it is the last element there is no ambiguity</p>\n\n<pre><code>[3, f 2]\n# should be [3, 2]\n</code></pre>\n\n<p>but I can imagine pulling my hair out if Ruby let's me write that and then slaps me with a syntax error when I add one more element to the end of the array. I can understand the decision to simply not allow omitted parentheses inside arrays.</p>\n"}], "owner": {"reputation": 135, "user_id": 4028239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GAbTC.jpg?s=128&g=1", "display_name": "vladpisanov", "link": "https://stackoverflow.com/users/4028239/vladpisanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1510715541, "creation_date": 1510686903, "last_edit_date": 1510715541, "question_id": 47293587, "link": "https://stackoverflow.com/questions/47293587/why-is-f-x1-ungrammatical-while-1-x1-is", "title": "Why is &#39;[f x[1]]&#39; ungrammatical while &#39;[1 + x[1]]&#39; is?", "body": "<p>For an Array <code>x</code>, the following are grammatical expressions:</p>\n\n<ul>\n<li><code>puts x[1]</code></li>\n<li><code>[puts(x[1])]</code></li>\n<li><code>[1 + x[1]]</code></li>\n</ul>\n\n<p>but this:</p>\n\n<ul>\n<li><code>[puts x[1]]</code></li>\n</ul>\n\n<p>fails to parse with:</p>\n\n<pre><code>syntax error, unexpected tIDENTIFIER, expecting keyword_do or '{' or '('\n</code></pre>\n\n<p>Why can't the parser figure out this syntax?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1510689772, "post_id": 47292773, "comment_id": 81539452, "body": "<code>get :authenticate(&#39;abc@gmail.com&#39;, &#39;1234567890&#39;)</code> you can pass email and password like this."}, {"owner": {"reputation": 13, "user_id": 7499476, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9a1bfe174e9f58c71be90de854939ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Akhil Reddy", "link": "https://stackoverflow.com/users/7499476/akhil-reddy"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1510720563, "post_id": 47292773, "comment_id": 81550070, "body": "@Gabbar Im getting this error  syntax error, unexpected &#39;(&#39;, expecting keyword_end         get :authenticate(&#39;ssksmk@gmail&#39;,&#39;ss&#39;)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7499476, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9a1bfe174e9f58c71be90de854939ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Akhil Reddy", "link": "https://stackoverflow.com/users/7499476/akhil-reddy"}, "edited": false, "score": 0, "creation_date": 1510720137, "post_id": 47297413, "comment_id": 81549973, "body": "HI @mariowise. I tried this and its showing me this error  ArgumentError:        unknown keywords: email, password"}, {"owner": {"reputation": 1929, "user_id": 2599875, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8df321b0acd6bc227bafe0ff4bd0ac5d?s=128&d=identicon&r=PG", "display_name": "mariowise", "link": "https://stackoverflow.com/users/2599875/mariowise"}, "reply_to_user": {"reputation": 13, "user_id": 7499476, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9a1bfe174e9f58c71be90de854939ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Akhil Reddy", "link": "https://stackoverflow.com/users/7499476/akhil-reddy"}, "edited": false, "score": 1, "creation_date": 1511032255, "post_id": 47297413, "comment_id": 81692463, "body": "And this? <code>get :show, params: { email: &#39;abc@gmail.com&#39;, password: &#39;1234567890&#39; }</code>"}], "tags": [], "owner": {"reputation": 1929, "user_id": 2599875, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8df321b0acd6bc227bafe0ff4bd0ac5d?s=128&d=identicon&r=PG", "display_name": "mariowise", "link": "https://stackoverflow.com/users/2599875/mariowise"}, "is_accepted": false, "score": 0, "last_activity_date": 1510704947, "creation_date": 1510704947, "answer_id": 47297413, "question_id": 47292773, "link": "https://stackoverflow.com/questions/47292773/how-to-pass-argument-to-a-controller-method-while-testing-with-rspec/47297413#47297413", "title": "How to pass argument to a controller method while testing with RSpec", "body": "<p>In RSpec you can pass the params as a <code>Hash</code> in the <code>get</code> method</p>\n\n<pre><code>get :show, email: 'abc@gmail.com', password: '1234567890'\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7499476, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9a1bfe174e9f58c71be90de854939ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Akhil Reddy", "link": "https://stackoverflow.com/users/7499476/akhil-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1166, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510704947, "creation_date": 1510683724, "question_id": 47292773, "link": "https://stackoverflow.com/questions/47292773/how-to-pass-argument-to-a-controller-method-while-testing-with-rspec", "title": "How to pass argument to a controller method while testing with RSpec", "body": "<p>Below are my controller methods which I am trying to test with RSpec</p>\n\n<pre><code>def login\n    authorized_user = authenticate(params[:email], params[:password])\n    if authorized_user\n      # Creating a session if the User is Authorized\n      session[:user_email] = authorized_user\n      redirect_to(controller: 'home', action: 'details')\n    else\n      flash[:invalid] = 'Invalid Username or Password'\n      redirect_to(action: 'signin')\n    end\n  end\n\ndef authenticate(email = '', password = '')\n    url = 'http://localhost:8080/getUser/' + email\n    response = RestClient.get(url)\n    resp = JSON.parse(response)\n    if resp[0]['id'] == 0\n      return false  # If no user exists return false\n    else\n      return resp[0]['email']\n    end\n  end\n</code></pre>\n\n<p>Here I am trying to mock the RestClient.get() method and return a dummy email to the login method to set the session with.\nBelow is my spec file </p>\n\n<pre><code>it \"mocks the api method checks the user with a Invalid email\" do\n      RestClient.should_receive(:get).and_return('[{\"id\":\"0\"}]')\n      get :authenticate\n      expect(response).to redirect_to '/signin'\n    end\n</code></pre>\n\n<p>But here I need to pass email and password to the authenticate method. I am facing two problems here\n1) How to pass the email and password to the authenticate method\n2) When I call the authenticate method without the arguments like above I get an error like this</p>\n\n<pre><code>Failure/Error: url = 'http://localhost:8080/getUser/' + email\n\n     TypeError:\n       no implicit conversion of nil into String\n</code></pre>\n\n<p>So how can I mock the the RestClient.get() method and return some JSON as response by calling the authenticate method with some dummy email and password?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "routes"], "comments": [{"owner": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "edited": false, "score": 0, "creation_date": 1510684005, "post_id": 47292512, "comment_id": 81536209, "body": "Your problem is with <code>user.admin_type?(:2)</code>. Does that work in the console?"}, {"owner": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "reply_to_user": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "edited": false, "score": 0, "creation_date": 1510684171, "post_id": 47292512, "comment_id": 81536300, "body": "@DanielWestendorf how should I print it in console?"}, {"owner": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "reply_to_user": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "edited": false, "score": 0, "creation_date": 1510684857, "post_id": 47292512, "comment_id": 81536728, "body": "@DanielWestendorf ??"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1510684860, "post_id": 47292512, "comment_id": 81536730, "body": "is <code>admin_type?</code> boolean field?"}, {"owner": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1510684957, "post_id": 47292512, "comment_id": 81536807, "body": "@Gabbar no it is int."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1510685021, "post_id": 47292512, "comment_id": 81536846, "body": "what is exactly name of this column in database <code>admin_type?</code> or <code>admin_type</code>"}, {"owner": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1510685049, "post_id": 47292512, "comment_id": 81536863, "body": "@Gabbar &quot;admin_type&quot;"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1510685110, "post_id": 47292512, "comment_id": 81536908, "body": "okay, lets try the solution, given below, hope it worked for syntax error."}], "answers": [{"comments": [{"owner": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "edited": false, "score": 0, "creation_date": 1510685240, "post_id": 47293107, "comment_id": 81536991, "body": "thanks for your guidance, syntax error is resolved but now it is saying &quot;Couldn&#39;t find User with &#39;id&#39;=donation_analysis&quot;"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "edited": false, "score": 0, "creation_date": 1510685370, "post_id": 47293107, "comment_id": 81537056, "body": "oops, i think routes have conflict, if you don&#39;t mind , can you share your routes"}, {"owner": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "edited": false, "score": 0, "creation_date": 1510685435, "post_id": 47293107, "comment_id": 81537098, "body": "match &#39;/admins/:id&#39;, to: &#39;admins#destroy&#39;, via: &#39;get&#39; , as: &#39;admin_destroy&#39;     resources :admins"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "edited": false, "score": 0, "creation_date": 1510685568, "post_id": 47293107, "comment_id": 81537179, "body": "okay, so basically you should write your <code>get &#39;admins&#47;donation_analysis&#39; =&gt; &#39;admins#donation_analysis&#39;</code> above this \t <code>match &#39;&#47;admins&#47;:id&#39;, to: &#39;admins#destroy&#39;, via: &#39;get&#39; , as: &#39;admin_destroy&#39; resources :admins</code>"}, {"owner": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "edited": false, "score": 0, "creation_date": 1510685857, "post_id": 47293107, "comment_id": 81537395, "body": "what you say now?"}, {"owner": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "edited": false, "score": 0, "creation_date": 1510686044, "post_id": 47293107, "comment_id": 81537522, "body": "No it is now accessing the route which it should not be."}, {"owner": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1510686266, "post_id": 47293107, "comment_id": 81537633, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/158996/discussion-between-john-and-gabbar\">continue this discussion in chat</a>."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "edited": false, "score": 0, "creation_date": 1510686271, "post_id": 47293107, "comment_id": 81537636, "body": "here <code>RouteConstraint</code> is not working, anyway we can implement this by using <code>before_action</code> callback"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 1, "last_activity_date": 1510685071, "creation_date": 1510685071, "answer_id": 47293107, "question_id": 47292512, "link": "https://stackoverflow.com/questions/47292512/restrict-different-type-of-admins-to-access-each-other-routes/47293107#47293107", "title": "Restrict different type of admins to access each other routes", "body": "<pre><code>class RouteConstraint\n  def matches?(request)\n    user = current_user(request)\n    ##render plain: user.inspect\n    user.present? &amp;&amp; user.admin_type == \"2\"\n  end\n\n  def current_user(request)\n    User.find_by_id(request.session[:user_id])\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 512, "user_id": 6950578, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/2d06a05f48e9f4b810136e8a4348c014?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/6950578/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 47293107, "answer_count": 1, "score": -1, "last_activity_date": 1510685714, "creation_date": 1510682770, "last_edit_date": 1510685714, "question_id": 47292512, "link": "https://stackoverflow.com/questions/47292512/restrict-different-type-of-admins-to-access-each-other-routes", "title": "Restrict different type of admins to access each other routes", "body": "<p>I am working on admin panel and I have different levels of admins. I have a field \"admin_type\" in the database to represent the level of the admin. The levels are 1,2,3. Now I want to implement some restrictions so that admin level 1 can't access route that is only for admin level 2.</p>\n\n<p>I have searched google a lot and found this blog post helpful <a href=\"http://bjedrocha.com/rails/2015/03/18/role-based-routing-in-rails/\" rel=\"nofollow noreferrer\">http://bjedrocha.com/rails/2015/03/18/role-based-routing-in-rails/</a>\nBut When I implemented this it is not working and giving hell of errors\nThis is the route code. I want this route only accessible by admin level 2</p>\n\n<pre><code>constraints RouteConstraint.new do\n    get 'admins/donation_analysis' =&gt; 'admins#donation_analysis'\nend\n</code></pre>\n\n<p>This is the constraint class</p>\n\n<pre><code>class RouteConstraint\n  def matches?(request)\n    user = current_user(request)\n    ##render plain: user.inspect\n    user.present? &amp;&amp; user.admin_type?(:2)\n  end\n\n  def current_user(request)\n    User.find_by_id(request.session[:user_id])\n  end\nend\n</code></pre>\n\n<p>routes are </p>\n\n<pre><code>constraints RouteConstraint.new do\n    get 'admins/donation_analysis' =&gt; 'admins#donation_analysis'\n  end\n  #get 'admins/active_account/:token' =&gt; 'admins#active_account'\n  get 'admins/link_expiry' =&gt; 'admins#link_expiry'\n  get 'admins/edit_profile' =&gt; 'admins#edit_profile'\n  post 'admins/update_profile' =&gt; 'admins#update_profile'\n  match '/admins/create_account', to: 'admins#create_account', via: 'post'\n  match '/admins/:id', to: 'admins#destroy', via: 'get' , as: 'admin_destroy'\n\n  resources :admins\n</code></pre>\n\n<p>But it is not working</p>\n\n<p><a href=\"https://i.stack.imgur.com/QKiE0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QKiE0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "answers": [{"tags": [], "owner": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "is_accepted": false, "score": 1, "last_activity_date": 1510686458, "creation_date": 1510686458, "answer_id": 47293478, "question_id": 47292508, "link": "https://stackoverflow.com/questions/47292508/how-to-add-data-into-join-table-from-form-in-rails/47293478#47293478", "title": "How to add data into join table from form in Rails?", "body": "<p>So you want to create two records here, a <code>Notification</code> record and a <code>NotificationUser</code> record. There are a number of ways to do this such as:</p>\n\n<pre><code>...\n@notification = Notification.new(notification_params)    \n\nif @notification.save\n  NotificationUser.create(user_id: USER_ID_HERE, notification_id: @notification.id) # OR NotificationUser.create(user: USER_RECORD_HERE, notification: @notification) OR @notification.users &lt;&lt; USER_RECORD_HERE\n...\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8904903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796f6f26ab3f404608cd0d44fdf787c6?s=128&d=identicon&r=PG&f=1", "display_name": "gonzalky", "link": "https://stackoverflow.com/users/8904903/gonzalky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510686458, "creation_date": 1510682752, "question_id": 47292508, "link": "https://stackoverflow.com/questions/47292508/how-to-add-data-into-join-table-from-form-in-rails", "title": "How to add data into join table from form in Rails?", "body": "<p>I have three models in my rails application. When I create a new notification how do I rewrite the notifications_controller.rb and the form in notifications/new.html.erb so that the entry gets saved to the notifications_users table? Thanks</p>\n\n<p>schema.rb</p>\n\n<pre><code>create_table \"notifications\", force: :cascade do |t|\n t.string \"title\"\n t.string \"first_name\"\n t.string \"last_name\"\n t.datetime \"date\"\n t.text \"content\"\n t.datetime \"created_at\", null: false\n t.datetime \"updated_at\", null: false\n\n end\n\ncreate_table \"notifications_users\", id: false, force: :cascade do |t|\n t.bigint \"user_id\", null: false\n t.bigint \"notification_id\", null: false\n end\n\ncreate_table \"users\", force: :cascade do |t|\n t.string \"first_name\"\n t.string \"last_name\"\n t.string \"user_type\"\n t.string \"username\"\n t.string \"password\"\n t.datetime \"created_at\", null: false\n t.datetime \"updated_at\", null: false\n t.string \"password_digest\"\n t.index [\"username\"], name: \"index_users_on_username\", unique: true\n\nend\n</code></pre>\n\n<p>new.html.erb</p>\n\n<pre><code>&lt;h1&gt;New Message&lt;/h1&gt;\n\n &lt;div class=\"row\"&gt;\n &lt;div class=\"col-md-6 col-md-offset-3\"&gt;\n\n &lt;%= form_for(@notification, url: notifications_new_path) do |f| %&gt;\n\n  &lt;%= f.label :title %&gt;\n  &lt;%= f.text_field :title, class: 'form-control' %&gt;\n\n\n  &lt;%= f.label :first_name %&gt;\n  &lt;%= f.text_field :first_name, class: 'form-control' %&gt;\n\n  &lt;%= f.label :date %&gt;\n  &lt;%= f.datetime_field :date %&gt;\n\n  &lt;%= f.label :content %&gt;\n  &lt;%= f.text_area :content, class: 'form-control' %&gt;\n\n  &lt;%= f.submit \"Create my message\", class: \"btn btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>\n\n\n<p>notifications_controller.rb</p>\n\n<pre><code>def create\n  @notification = Notification.new(notification_params)    \n\n  if @notification.save\n    flash[:success] = \"Notification created!\"\n    redirect_to @notification \n else\n   render 'new'\n end\nend\n</code></pre>\n"}, {"tags": ["html", "css", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 613, "user_id": 1306907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTPnd.jpg?s=128&g=1", "display_name": "ScoobyDrew18", "link": "https://stackoverflow.com/users/1306907/scoobydrew18"}, "edited": false, "score": 0, "creation_date": 1510683020, "post_id": 47292492, "comment_id": 81535596, "body": "Please add some sample code to demonstrate the specific issue you are having.  Following the guidelines in this article will help you get the best feedback: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8940671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b71cb22546ae43b5e355f16ce1852cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Rosero", "link": "https://stackoverflow.com/users/8940671/sebastian-rosero"}, "edited": false, "score": 0, "creation_date": 1510685386, "post_id": 47293134, "comment_id": 81537067, "body": "Thanks adding the require to the gchart helped me to load the chart and the formats are the ones i needed. I would like to see more styles that can be modified of this chart."}], "tags": [], "owner": {"reputation": 16, "user_id": 8940632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b15d48651d33a05adfd6711f5ed893?s=128&d=identicon&r=PG&f=1", "display_name": "A01701260", "link": "https://stackoverflow.com/users/8940632/a01701260"}, "is_accepted": true, "score": 0, "last_activity_date": 1510685229, "creation_date": 1510685229, "answer_id": 47293134, "question_id": 47292492, "link": "https://stackoverflow.com/questions/47292492/googlechart-as-image-tag-with-specific-format-ruby-on-rails/47293134#47293134", "title": "Googlechart as image tag with specific format ruby on rails", "body": "<p>If you installed the gem and used the command bundle install like shown below</p>\n\n<p>Gemfile:</p>\n\n<pre><code>gem \"googlecharts\", :require =&gt; \"gchart\"\n</code></pre>\n\n<p>file.html.ebr:</p>\n\n<pre><code>&lt;% require 'gchart' %&gt; \n&lt;%= image_tag(Gchart.pie \n            :size =&gt; '600x400', \n            :title =&gt; 'Title here',\n            :data =&gt; [1,4,5],\n            :legend =&gt; ['Parameter1','Parameter2','Parameter3'],\n            :bar_colors =&gt; ['2EB82E','3399FF','FF471A'],\n            :labels =&gt; [label1, label2, label3])%&gt;\n</code></pre>\n\n<p>The chart has the format of the size, title, data, legend, colors and labels that can be personalized and is painted as an image in the html.</p>\n"}], "owner": {"reputation": 3, "user_id": 8940671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b71cb22546ae43b5e355f16ce1852cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Rosero", "link": "https://stackoverflow.com/users/8940671/sebastian-rosero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 47293134, "answer_count": 1, "score": 0, "last_activity_date": 1510695768, "creation_date": 1510682710, "last_edit_date": 1510695768, "question_id": 47292492, "link": "https://stackoverflow.com/questions/47292492/googlechart-as-image-tag-with-specific-format-ruby-on-rails", "title": "Googlechart as image tag with specific format ruby on rails", "body": "<p>How do I add a image tag with a google pie chart, until now I have installed the gem but I would like to also personalize the chart, the size, colors, tags, etc. I've tried using tutorial like rail cast but it is outdated and some don't work for me.</p>\n\n<pre><code>&lt;%=image tag #googlechart %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "sass", "frontend"], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 2, "last_activity_date": 1510688225, "creation_date": 1510688225, "answer_id": 47293911, "question_id": 47292355, "link": "https://stackoverflow.com/questions/47292355/sass-installation-error/47293911#47293911", "title": "Sass installation error", "body": "<p>Install this package:</p>\n\n<pre><code>sudo apt install ruby-dev\n</code></pre>\n\n<p>The <a href=\"https://community.linuxmint.com/software/view/ruby-dev\" rel=\"nofollow noreferrer\">ruby-dev package</a> contains the missing headers. You can see that the installer is looking for the headers:</p>\n\n<pre><code>/usr/lib/ruby/include/ruby.h\n</code></pre>\n\n<p>Installing this package will install those headers. This is a common issue that comes up for new Ruby users when installing gems with native extensions. You may find that you have to install several packages to get the installation to complete. If you see similar errors when installing this gem or other gems, try searching for \"gemname native extension prerequisites\", like \"<a href=\"https://www.google.com/search?q=sass+gem+native+extension+prerequisites\" rel=\"nofollow noreferrer\">sass gem native extension prerequisites</a>\", to learn which packages should be installed before installing the gem.</p>\n"}, {"tags": [], "owner": {"reputation": 5605, "user_id": 570763, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a999be4e1553fb640132d205152fa38?s=128&d=identicon&r=PG", "display_name": "Arda", "link": "https://stackoverflow.com/users/570763/arda"}, "is_accepted": false, "score": 0, "last_activity_date": 1548291646, "creation_date": 1548291646, "answer_id": 54337955, "question_id": 47292355, "link": "https://stackoverflow.com/questions/47292355/sass-installation-error/54337955#54337955", "title": "Sass installation error", "body": "<p>I had the same issue on Ubuntu 18.04, <code>ruby-dev</code> itself didn't help, installing <code>g++</code> and <code>make</code>, as stated <a href=\"https://stackoverflow.com/a/50223278/570763\">here</a> solved my issue.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 7995542, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_cXxIS7_RqE/AAAAAAAAAAI/AAAAAAAAAJY/ukIbhLrTHC8/photo.jpg?sz=128", "display_name": "Muhammad Waqas", "link": "https://stackoverflow.com/users/7995542/muhammad-waqas"}, "is_accepted": false, "score": 1, "last_activity_date": 1598962815, "last_edit_date": 1598962815, "creation_date": 1598952141, "answer_id": 63684887, "question_id": 47292355, "link": "https://stackoverflow.com/questions/47292355/sass-installation-error/63684887#63684887", "title": "Sass installation error", "body": "<p>Try this:</p>\n<pre><code>sudo apt install ruby-full rubygems autogen autoconf libtool make\nsudo gem install sass\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7943194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BlJEN.jpg?s=128&g=1", "display_name": "kamilmichna", "link": "https://stackoverflow.com/users/7943194/kamilmichna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1263, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1598962815, "creation_date": 1510682272, "last_edit_date": 1512807512, "question_id": 47292355, "link": "https://stackoverflow.com/questions/47292355/sass-installation-error", "title": "Sass installation error", "body": "<p>I use Linux Mint and I want to install sass. I have installed ruby by \"sudo apt install ruby\" , version 2.3 and then , when I wan to install sass by \"sudo gem install sass --no-user-install\" , I have the following error: </p>\n\n<pre><code>Building native extensions. This could take a while...\nERROR:  Error installing sass:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /var/lib/gems/2.3.0/gems/ffi-1.9.18/ext/ffi_c\n/usr/bin/ruby2.3 -r ./siteconf20171114-19329-157auxp.rb extconf.rb\nmkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h\n\nextconf failed, exit code 1\n\nGem files will remain installed in /var/lib/gems/2.3.0/gems/ffi-1.9.18 for inspection.\nResults logged to /var/lib/gems/2.3.0/extensions/x86_64-linux/2.3.0/ffi-1.9.18/gem_make.out\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1510683166, "post_id": 47292335, "comment_id": 81535672, "body": "Replace the method <code>MyClass::initialize</code> with simply <code>@stuff = 1</code>. The class instance variable <code>@stuff</code> is assigned the value <code>1</code> when the class definition is parsed. I don&#39;t think the metaprogramming tag is appropriate here."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1510692882, "post_id": 47292335, "comment_id": 81541038, "body": "It&#39;s hard to figure out what you&#39;re asking if you invent your own terminology without defining it. There is no such thing as a <i>static method</i> in Ruby, nor does Ruby have constructors."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1510685406, "creation_date": 1510685406, "answer_id": 47293193, "question_id": 47292335, "link": "https://stackoverflow.com/questions/47292335/how-to-override-the-metaclass-constructor-in-ruby/47293193#47293193", "title": "How to override the metaclass constructor in Ruby", "body": "<p>There's no such thing as an explicit metaclass initializer. The class itself is \"initialized\" as it's defined, so it's perfectly valid to do this:</p>\n\n<pre><code>class MyClass\n  # Code here will be executed as the class itself is defined.\n  @stuff = 1\n\n  def self.print_stuff\n    puts @stuff\n  end\nend\n\nMyClass.print_stuff\n</code></pre>\n\n<p>Remember that <code>def</code> itself is a form of method call and defining a class in Ruby involves sending a bunch of messages (method calls) around to the proper context objects, such as the class itself as it's being defined.</p>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1510685421, "creation_date": 1510685421, "answer_id": 47293194, "question_id": 47292335, "link": "https://stackoverflow.com/questions/47292335/how-to-override-the-metaclass-constructor-in-ruby/47293194#47293194", "title": "How to override the metaclass constructor in Ruby", "body": "<p>Every chunk of code in Ruby is an expression. Even a class definition is a series of expressions: method definitions are expressions that have the side-effect of adding the method to the class.</p>\n\n<p>This is how meta-programming methods work. <code>attr_reader</code> is a private method call where the implicit <code>self</code> is the class. So, long story short, you aren't restricted inside a class body, you can put whatever code you want to run in the context of the class:</p>\n\n<pre><code>class MyClass\n  @stuff = 1\n\n  def self.print_stuff\n    puts @stuff\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1838, "user_id": 3692286, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/deAJz.jpg?s=128&g=1", "display_name": "jleeothon", "link": "https://stackoverflow.com/users/3692286/jleeothon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510745566, "creation_date": 1510682227, "last_edit_date": 1510745566, "question_id": 47292335, "link": "https://stackoverflow.com/questions/47292335/how-to-override-the-metaclass-constructor-in-ruby", "title": "How to override the metaclass constructor in Ruby", "body": "<p>I want a piece of code to run before any other static methods run, is it possible to do something in the spirit of the following?</p>\n\n<pre><code>class MyClass\n  def self.initialize\n    @stuff = 1\n  end\n  def self.print_stuff\n    puts @stuff\n  end\nend\n</code></pre>\n\n<p>My Ruby version of interest is 2.3.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 5, "creation_date": 1510682138, "post_id": 47292212, "comment_id": 81535101, "body": "You could construct a hash where the selection is a key."}, {"owner": {"reputation": 511, "user_id": 764658, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7c8750bd7fa5d08b880216dd055ca067?s=128&d=identicon&r=PG", "display_name": "Postscripter", "link": "https://stackoverflow.com/users/764658/postscripter"}, "reply_to_user": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1510682698, "post_id": 47292212, "comment_id": 81535415, "body": "@Anton do you mean like a hash of car models where keys are the car models and each has multiple values? Hash inside hashes?"}, {"owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 1, "creation_date": 1510682952, "post_id": 47292212, "comment_id": 81535548, "body": "Exactly. The value is a hash or what ever. This way you eliminate the case statement."}], "answers": [{"tags": [], "owner": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "is_accepted": false, "score": 0, "last_activity_date": 1510682037, "creation_date": 1510682037, "answer_id": 47292272, "question_id": 47292212, "link": "https://stackoverflow.com/questions/47292212/is-using-a-case-statement-in-my-ruby-on-rails-example-ok/47292272#47292272", "title": "Is using a case statement in my ruby on rails example ok?", "body": "<p>The code you're written probably works, but definitely smells and would violate the ruby style guide.</p>\n\n<p>I suggest you utilize a code analyzer, such as <a href=\"http://rubocop.readthedocs.io/en/latest/\" rel=\"nofollow noreferrer\">rubocop</a> which will enforce the ruby style guide, and help you write conforming code and avoid common pitfalls.</p>\n"}, {"comments": [{"owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 1, "creation_date": 1510691808, "post_id": 47293661, "comment_id": 81540488, "body": "May be class method in this case would be better as all instances share same CAR_INFO hash and no need to create new Car objects."}], "tags": [], "owner": {"reputation": 864, "user_id": 1285054, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/49090e67bce683fb15ee068b88beb0fa?s=128&d=identicon&r=PG", "display_name": "Aniket Schneider", "link": "https://stackoverflow.com/users/1285054/aniket-schneider"}, "is_accepted": true, "score": 2, "last_activity_date": 1510687206, "creation_date": 1510687206, "answer_id": 47293661, "question_id": 47292212, "link": "https://stackoverflow.com/questions/47292212/is-using-a-case-statement-in-my-ruby-on-rails-example-ok/47293661#47293661", "title": "Is using a case statement in my ruby on rails example ok?", "body": "<p>Big case statements are a code smell, meaning they are a hint that there may be an opportunity to improve your code.</p>\n\n<p>In this case, while your app does not have a database, you still have data. The reason why your code looks messy right now is that you have not separated that data from your program logic.</p>\n\n<p>I would recommend storing the data about each car in a hash, and then treat that hash as if it were your database.</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>class Car\n  CAR_INFO = {\n    'Mazda 3' =&gt; {\n      speed: 'fast',\n      power: 'real strong',\n      dimensions: '4X3X3'\n    },\n    'Lancer 81' =&gt; {\n      speed: 'slow',\n      power: 'real weak',\n      dimensions: '2X2X2'\n    },\n    # etc\n  }\n\n  def get_car_properties (dropdown_selection)\n    CAR_INFO.fetch(dropdown_selection, {})\n  end\nend\n\nselected_car=Car.new()\nputs selected_car.get_car_properties('Mazda 3')\n</code></pre>\n\n<p>Why is this better? For one thing, the hash is pure data. It's clear that there's no additional control logic hiding somewhere in one of the branches of your case statement. You can now tell at a glance exactly what <code>get_car_properties</code> is doing - it's looking up the selection in a data structure, and returning an empty hash if nothing is found. You may wish to move <code>CAR_INFO</code> into a separate file, or perhaps into a proper database later on - <code>get_car_properties</code> won't change much in either of those cases.</p>\n"}], "owner": {"reputation": 511, "user_id": 764658, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7c8750bd7fa5d08b880216dd055ca067?s=128&d=identicon&r=PG", "display_name": "Postscripter", "link": "https://stackoverflow.com/users/764658/postscripter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 47293661, "answer_count": 2, "score": 0, "last_activity_date": 1510687206, "creation_date": 1510681770, "question_id": 47292212, "link": "https://stackoverflow.com/questions/47292212/is-using-a-case-statement-in-my-ruby-on-rails-example-ok", "title": "Is using a case statement in my ruby on rails example ok?", "body": "<p>I have a built a little online tool using rails. The app has no database. \n(I know I should have used another simpler framework, like Sinatra for Ruby).\nSo I need to capture selected car model from the interface and use its power, speed, and dimensions properties\nIs it ok to use case statement, like the code below:</p>\n\n<pre><code>class Car\ndef get_car_properties (dropdown_selection)\n    info = {}\n    info=Hash.new{2}\n    case dropdown_selection\n        when 'Mazda 3'\n             info = { speed: 'fast', power: 'real strong', dimensions: '4X3X3'}\n        when 'Lancer 81'\n             info = { speed: 'slow', power: 'real weak', dimensions: '2X2X2'}\n         else\n             info={}\n\n    end\n    return info\nend\nend\n\nselected_car=Car.new()\nputs selected_car.get_car_properties('Mazda 3')\n</code></pre>\n\n<p>For simplifications, I have not used the exact scenario. Also note that my case statement is about 30 options big and the hash 10 symbols.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1510691039, "post_id": 47292064, "comment_id": 81540093, "body": "Look at your SQL--you&#39;re trying to pass in an array when a single value is expected, no? (Honestly I don&#39;t remember, but there&#39;s a difference between using an array of values and a single value.)"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1510691699, "post_id": 47292064, "comment_id": 81540442, "body": "No @DaveNewton, that&#39;s correct. If you give to where an array an <code>in</code> SQL is used"}, {"owner": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "edited": false, "score": 0, "creation_date": 1510691970, "post_id": 47292064, "comment_id": 81540570, "body": "Yes its generating SQL with <code>Item IN (&#39;some_item&#39;, &#39;&#39;)</code> but it doesnt return the record with <code>item = &#39;&#39; </code> :("}], "owner": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510692331, "creation_date": 1510681206, "last_edit_date": 1510692331, "question_id": 47292064, "link": "https://stackoverflow.com/questions/47292064/ruby-index-wont-return-the-result-for-second-parameter-if-same-parameter-passed", "title": "Ruby: index wont return the result for second parameter if same parameter passed twice with second parameter value blank", "body": "<p>I have following index method in controller</p>\n\n<pre><code>def index\n  if params.key?(:item)\n    @items = Item.get_items.where(item: params[:item])\n  else\n    @items = Item.get_items\nend\n</code></pre>\n\n<p>Model:</p>\n\n<pre><code>Class Item &lt; ApplicationRecord\n  has_many :item_resources, dependent: :destroy\n  has_many :resources, through: :item_resources\n\n  def self.get_items\n    includes(item_resources: {resource: :item_groups})\n      .order('item_resources.area ASC')\n  end\nend\n</code></pre>\n\n<p>Views:</p>\n\n<p>index.json.jbuilder</p>\n\n<pre><code>json.array! @items, partial: \u2018items/item\u2019, as: :item\n_item.json.jbuilder\n</code></pre>\n\n<p>_item.json.jbuilder</p>\n\n<pre><code>json.something1 item.something1\njson.item_layout do\n  json.template_key item.layout\n  json.merge! item.layout_config if item.layout_config.present?\nend\njson.something (item.item_details) do |item_detail|\n  json.partial! \u2018item_details/item_detail\u2019, item_detail: item_detail\nend\n</code></pre>\n\n<p>I am using postman for testing as follows</p>\n\n<pre><code>http://localhost:3000/items?item=some_item\nhttp://localhost:3000/items?item=some_item&amp;item=other_item\n</code></pre>\n\n<p>The above works fine</p>\n\n<pre><code>http://localhost:3000/items?item=some_item&amp;item=\n</code></pre>\n\n<p>When i try to pass item twice with second parameter value blank it wont return the result for second parameter but returns result for first parameter.</p>\n\n<p>It generates sql with <code>IN ('some_item', '')</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv"], "comments": [{"owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "edited": false, "score": 1, "creation_date": 1510681550, "post_id": 47292030, "comment_id": 81534740, "body": "Can you provide code where you actually write data to the final file?"}, {"owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1510681828, "post_id": 47292030, "comment_id": 81534910, "body": "Are you iterating somehow through the headers?"}, {"owner": {"reputation": 53, "user_id": 5586121, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-3c7Cr-4CFK4/AAAAAAAAAAI/AAAAAAAAF2E/tc72oe7kxxE/photo.jpg?sz=128", "display_name": "Ido Shapira", "link": "https://stackoverflow.com/users/5586121/ido-shapira"}, "edited": false, "score": 0, "creation_date": 1510682105, "post_id": 47292030, "comment_id": 81535076, "body": "I&#39;ve included the entire function in my post."}, {"owner": {"reputation": 53, "user_id": 5586121, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-3c7Cr-4CFK4/AAAAAAAAAAI/AAAAAAAAF2E/tc72oe7kxxE/photo.jpg?sz=128", "display_name": "Ido Shapira", "link": "https://stackoverflow.com/users/5586121/ido-shapira"}, "edited": false, "score": 0, "creation_date": 1510682118, "post_id": 47292030, "comment_id": 81535090, "body": "Not iterating through the headers."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510683564, "post_id": 47292030, "comment_id": 81535908, "body": "You need to cycle through the <code>headers</code> and set up the value for each row you want to insert"}], "answers": [{"tags": [], "owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "is_accepted": false, "score": 0, "last_activity_date": 1510691465, "creation_date": 1510691465, "answer_id": 47294664, "question_id": 47292030, "link": "https://stackoverflow.com/questions/47292030/appending-text-by-column-to-the-same-row-for-a-csv-file-on-ruby-2-4/47294664#47294664", "title": "Appending text by column to the same row for a CSV file on Ruby 2.4", "body": "<p>Based on your example it is clear that you are appending a row to the csv file per method call.<br>\nIf you want to append data to existing row (by header) you need to add some identifier and fetch by it.<br>\nYou could add entire row per method call by passing a hash to it.  </p>\n\n<pre><code>hash = {\n  header_a: 'value_a',\n  header_b: 'value_b' \n}  \n\ndef insert_info_csv(info_hash)\n headers=['header_a', 'header_b']\n file='report_test.csv'\n\n CSV.open('report_test.csv','a') do |csv|\n   row=CSV::Row.new(headers,[])\n   info_headers.each do |k,v|\n     row[k] = v\n     csv &lt;&lt; row\n   end\n end\nend\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5586121, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-3c7Cr-4CFK4/AAAAAAAAAAI/AAAAAAAAF2E/tc72oe7kxxE/photo.jpg?sz=128", "display_name": "Ido Shapira", "link": "https://stackoverflow.com/users/5586121/ido-shapira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 800, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1510691465, "creation_date": 1510681100, "last_edit_date": 1510682045, "question_id": 47292030, "link": "https://stackoverflow.com/questions/47292030/appending-text-by-column-to-the-same-row-for-a-csv-file-on-ruby-2-4", "title": "Appending text by column to the same row for a CSV file on Ruby 2.4", "body": "<p>I have a CSV file that contains headers and 1 row of data:</p>\n\n<p>I want to append data by the column name (the header) but to the same row (row number 1)</p>\n\n<p>I'm inserting each column data separately.</p>\n\n<p>So at the end, I will have a file that contains headers and 1 row of data</p>\n\n<p>for example:</p>\n\n<pre><code>header1,header2\n\ndata1,data2 \n</code></pre>\n\n<p>I'm using </p>\n\n<pre><code> def insert_info_csv(header,values)\n  headers=['1', '2', '3', '4']\n  file='report_test.csv'\n\n  CSV.open('report_test.csv','a') do |csv|\n    row=CSV::Row.new(headers,[])\n    row[header]=values (where I insert the data)\n    csv &lt;&lt; row\n  end\n  end\n</code></pre>\n\n<p>my issue is that each data is written in a different row for example:</p>\n\n<pre><code> Header1, header2\n\n data1,\n\n       ,data2\n</code></pre>\n\n<p>Thank you for the help.</p>\n"}, {"tags": ["ruby", "activerecord", "task"], "answers": [{"comments": [{"owner": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "edited": false, "score": 0, "creation_date": 1510680955, "post_id": 47291957, "comment_id": 81534398, "body": "Nope, not the case. I&#39;m doing that, as stated in the code example from the dotenv documentation."}, {"owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "reply_to_user": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "edited": false, "score": 0, "creation_date": 1510681018, "post_id": 47291957, "comment_id": 81534438, "body": "It does not work for you? What problem exactly do you have?"}, {"owner": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "edited": false, "score": 0, "creation_date": 1510681084, "post_id": 47291957, "comment_id": 81534472, "body": "Nope, it doesn&#39;t. I get <code>Database &#39;&lt;%= ENV[&#39;DB_NAME&#39;] %&gt;&#39; does not exist </code> when I run <code>rake db:drop ENV=test</code>."}, {"owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "reply_to_user": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "edited": false, "score": 0, "creation_date": 1510681162, "post_id": 47291957, "comment_id": 81534510, "body": "Then the problem is with your DB config, dotenv works as expected. It looks like your config is not processed by ERB."}, {"owner": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "edited": false, "score": 0, "creation_date": 1510681257, "post_id": 47291957, "comment_id": 81534569, "body": "Aha. I&#39;m loading my config in Rakefile like this: <code>conf = File.join root, &#39;config&#47;database.yml&#39;; DatabaseTasks.database_configuration = YAML.load(File.read(conf))</code> How can Iprocess it by erb here?"}, {"owner": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "edited": false, "score": 0, "creation_date": 1510682602, "post_id": 47291957, "comment_id": 81535369, "body": "Was it. Thanks!"}], "tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": true, "score": 1, "last_activity_date": 1510680856, "creation_date": 1510680856, "answer_id": 47291957, "question_id": 47291474, "link": "https://stackoverflow.com/questions/47291474/passing-dotenv-to-activerecord-rake-tasks-no-rails/47291957#47291957", "title": "Passing dotenv to ActiveRecord rake tasks (no Rails)", "body": "<p>I guess you should also require dotenv at your Rakefile</p>\n\n<pre><code>require 'dotenv/tasks'\nload 'active_record/railties/databases.rake'\n</code></pre>\n\n<p>So at the moment of loading your custom tasks, the dotenv will be loaded and ENV will be populated with data.</p>\n"}, {"tags": [], "owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "is_accepted": false, "score": 0, "last_activity_date": 1510681435, "creation_date": 1510681435, "answer_id": 47292120, "question_id": 47291474, "link": "https://stackoverflow.com/questions/47291474/passing-dotenv-to-activerecord-rake-tasks-no-rails/47292120#47292120", "title": "Passing dotenv to ActiveRecord rake tasks (no Rails)", "body": "<p>Along with <code>DotEnv</code> setup, make sure you run:</p>\n\n<pre><code>rake db:environment:set\n</code></pre>\n\n<p>to set the environment variables before running any commands that require <code>ENV</code>.</p>\n"}], "owner": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 47291957, "answer_count": 2, "score": 0, "last_activity_date": 1510681435, "creation_date": 1510679192, "question_id": 47291474, "link": "https://stackoverflow.com/questions/47291474/passing-dotenv-to-activerecord-rake-tasks-no-rails", "title": "Passing dotenv to ActiveRecord rake tasks (no Rails)", "body": "<p>I'm using ActiveRecords in no-Rails app and I'm trying to use <a href=\"https://github.com/bkeepers/dotenv\" rel=\"nofollow noreferrer\">dotenv</a> with ActiveRecord rake tasks.</p>\n\n<p>In the documentation of dotenv there is stated that you need to pass it to tasks like this:</p>\n\n<pre><code>require 'dotenv/tasks'\n\ntask mytask: :dotenv do\n   # things that require .env\nend\n</code></pre>\n\n<p>But I'm loading my ActiveRecord rake tasks like this in my Rakefile:</p>\n\n<pre><code>load 'active_record/railties/databases.rake'\n</code></pre>\n\n<p>How can I pass dotenv to ActiveRecord tasks?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "ruby", "uniq"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1510677879, "post_id": 47290871, "comment_id": 81532550, "body": "Ruby <code>1.8.6</code> was released more than 10 years again, 9 years ago there was the updated <code>1.8.7</code> version released and all <code>1.8.x</code> versions reached end of life more than 4 years ago. Why do you even care?"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 4, "creation_date": 1510677927, "post_id": 47290871, "comment_id": 81532582, "body": "Why does anyone care about old versions of anything?  Because they&#39;re forced to use them with legacy sites."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1510678149, "post_id": 47290871, "comment_id": 81532727, "body": "Having to work with legacy apps is one thing, but having to work with an application that uses a version that is outdated for more than 9 years. Wow, that is ridiculous..."}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1510739413, "post_id": 47290871, "comment_id": 81558861, "body": "@spickermann no argument here"}], "answers": [{"comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510678345, "post_id": 47291076, "comment_id": 81532855, "body": "Ah - yes: arr[0].eql?(arr[1]) returns false, so it looks like that&#39;s the key. thanks!"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510678570, "post_id": 47291076, "comment_id": 81532992, "body": "As a bonus question, what do you think is the neatest way to define <code>eql?</code> for Hash, to make it behave as expected?  (ie to test if the contents are  identical).  I thought I could just do <code>self == other_hash</code> but that feels like trouble for some reason..."}, {"owner": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510678774, "post_id": 47291076, "comment_id": 81533139, "body": "@MaxWilliams I&#39;d probably check that the class and length of each Hash is the same, then iterate through each key and value using <code>Hash#each_pair</code> and compare those with <code>eql?</code>. (Though I&#39;m not sure if order should matter?) You might also need to define <code>Hash#hash</code> using a similar approach."}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510679016, "post_id": 47291076, "comment_id": 81533280, "body": "Actually @Ajedi32, I think that <code>.eql?</code> isn&#39;t the key after all.  I added an extension to Hash to make the <code>eql?</code> method just do <code>self == other_hash</code>, and now I get <code>arr[0].eql?(arr[1]) =&gt; true</code>.  Great.  However, <code>uniq</code> still keeps the duplicates, making me think that <code>uniq</code> doesn&#39;t use <code>eql?</code> after all.  According to my API docs, the source for <code>uniq</code> looks like C code."}, {"owner": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510679225, "post_id": 47291076, "comment_id": 81533383, "body": "@MaxWilliams Like I said, you probably need to define <code>Hash#hash</code> too. &quot;It compares values using their <b>hash</b> and eql? methods for efficiency.&quot; I suspect it checks whether the hashes match, then if they do it checks eql? to be sure. (Probably implemented using a binary search tree or another, similar datastructure.) You may also wish to refer to Rubinius implementation of these methods, since that implementation is written in Ruby: <a href=\"https://github.com/rubinius/rubinius/blob/master/core/hash.rb#L589\" rel=\"nofollow noreferrer\">github.com/rubinius/rubinius/blob/master/core/hash.rb#L589</a>"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510736075, "post_id": 47291076, "comment_id": 81556870, "body": "ah sorry, I missed that bit.  <code>Hash#hash</code>, how confusing :)"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510743355, "post_id": 47291076, "comment_id": 81561402, "body": "I wrote a large (sorry) couple of  Edits to my post about the Hash#hash method, would you mind reading it?  I can copy (I think) Rubinius&#39; Hash#hash method, but I don&#39;t understand some of it.  My version is very slow and I don&#39;t know if that&#39;s because I&#39;ve made a mistake &quot;translating&quot; it out of Rubinius..."}, {"owner": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1510756947, "post_id": 47291076, "comment_id": 81570869, "body": "@MaxWilliams Yeah, that&#39;s pretty long. Personally I&#39;d suggest splitting that into a couple new questions; one about what the <code>^=</code> operator does, and perhaps another one on <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> about how to improve the performance of your existing code. Link them here when they&#39;re ready so I can take a look at them; this certainly seems like an interesting problem."}], "tags": [], "owner": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "is_accepted": true, "score": 2, "last_activity_date": 1510757481, "last_edit_date": 1510757481, "creation_date": 1510678062, "answer_id": 47291076, "question_id": 47290871, "link": "https://stackoverflow.com/questions/47290871/ruby-1-8-6-arrayuniq-not-removing-duplicate-hashes/47291076#47291076", "title": "Ruby 1.8.6 Array#uniq not removing duplicate hashes", "body": "<p>For efficiency reasons, <code>Array#uniq</code> does not compare values using <code>==</code> or even <code>===</code>. According to <a href=\"https://ruby-doc.org/core-2.4.2/Array.html#method-i-uniq\" rel=\"nofollow noreferrer\">the docs</a>:</p>\n\n<blockquote>\n  <p>It compares values using their hash and eql? methods for efficiency.</p>\n</blockquote>\n\n<p>(Note I linked the docs for 2.4.2 here. While the docs for 1.8.6 do not include this statement, I believe it still holds true for that version of Ruby.)</p>\n\n<p>In Ruby 1.8.6, <a href=\"https://ruby-doc.org/core-1.8.6/Hash.html\" rel=\"nofollow noreferrer\">neither <code>Hash#hash</code> nor <code>Hash#eql?</code> are implemented</a>, so they fallback to using <a href=\"https://ruby-doc.org/core-1.8.6/Object.html#method-i-hash\" rel=\"nofollow noreferrer\"><code>Object#hash</code></a> and <a href=\"https://ruby-doc.org/core-1.8.6/Object.html#method-i-eql-3F\" rel=\"nofollow noreferrer\"><code>Object#eql?</code></a>:</p>\n\n<blockquote>\n  <p>Equality\u2014At the Object level, <code>==</code> returns true only if obj and other are the same object. Typically, this method is overridden in descendent classes to provide class-specific meaning.</p>\n  \n  <p>[...]</p>\n  \n  <p>The <code>eql?</code> method returns <code>true</code> if obj and anObject have the same value. Used by Hash to test members for equality. For objects of class Object, <code>eql?</code> is synonymous with <code>==</code>.</p>\n</blockquote>\n\n<p>So according to <code>Array#uniq</code>, those two hashes are different objects, and are therefore unique.</p>\n\n<p>To fix this, you can try defining <a href=\"https://ruby-doc.org/core-2.4.2/Hash.html#method-i-hash\" rel=\"nofollow noreferrer\"><code>Hash#hash</code></a> and <a href=\"https://ruby-doc.org/core-2.4.2/Hash.html#method-i-eql-3F\" rel=\"nofollow noreferrer\"><code>Hash#eql?</code></a> yourself. The details of how to do this are left as an exercise to the reader. You may find it helpful however to refer to <a href=\"https://github.com/rubinius/rubinius/blob/master/core/hash.rb\" rel=\"nofollow noreferrer\">Rubinius's implementation of these methods</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 5219, "user_id": 4724167, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/2CiEe.jpg?s=128&g=1", "display_name": "Nandu Kalidindi", "link": "https://stackoverflow.com/users/4724167/nandu-kalidindi"}, "is_accepted": false, "score": 0, "last_activity_date": 1510678491, "creation_date": 1510678491, "answer_id": 47291222, "question_id": 47290871, "link": "https://stackoverflow.com/questions/47290871/ruby-1-8-6-arrayuniq-not-removing-duplicate-hashes/47291222#47291222", "title": "Ruby 1.8.6 Array#uniq not removing duplicate hashes", "body": "<p>How about using JSON stringify and Parsing it back like in Javascript?</p>\n\n<pre><code>require 'json'\narr.map { |x| x.to_json}.uniq.map { |x| JSON.parse(x) }\n</code></pre>\n\n<p>The json methods might not be supported in <code>1.8.6</code> please use which ever is supported.</p>\n"}], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 47291076, "answer_count": 2, "score": 3, "last_activity_date": 1510757481, "creation_date": 1510677419, "last_edit_date": 1510743243, "question_id": 47290871, "link": "https://stackoverflow.com/questions/47290871/ruby-1-8-6-arrayuniq-not-removing-duplicate-hashes", "title": "Ruby 1.8.6 Array#uniq not removing duplicate hashes", "body": "<p>I have this array, in a ruby 1.8.6 console:</p>\n\n<pre><code>arr = [{:foo =&gt; \"bar\"}, {:foo =&gt; \"bar\"}]\n</code></pre>\n\n<p>both elements are equal to each other:</p>\n\n<pre><code>arr[0] == arr[1]\n=&gt; true\n#just in case there's some \"==\" vs \"===\" oddness...\narr[0] === arr[1]\n=&gt; true \n</code></pre>\n\n<p>But, arr.uniq doesn't remove the duplicates:</p>\n\n<pre><code>arr.uniq\n=&gt; [{:foo=&gt;\"bar\"}, {:foo=&gt;\"bar\"}]\n</code></pre>\n\n<p>Can anyone tell me what's going on here?  </p>\n\n<p>EDIT:  I can write a not very clever uniqifier which uses <code>include?</code> as follows:</p>\n\n<pre><code>uniqed = []\narr.each do |hash|\n  unless uniqed.include?(hash)\n    uniqed &lt;&lt; hash\n  end\nend;false\nuniqed\n=&gt; [{:foo=&gt;\"bar\"}]\n</code></pre>\n\n<p>This produces the correct result, which makes the failure of <code>uniq</code> even more mysterious.  </p>\n\n<p>EDIT 2:  Some notes on what's going on, possibly just for my own clarity.  As @Ajedi32 points out in the comments, the failure to uniqify comes from the fact that the two elements are different objects.  Some classes define <code>eql?</code> and <code>hash</code> methods, used for comparison, to mean \"are these effectively the same thing, even if they're not the same object in memory\".  String does this for example, which is why you can define two variables to be \"foo\" and they are said to be equal to one another, even though they're not the same object.</p>\n\n<p>The Hash class <strong>doesn't</strong> do this, in Ruby 1.8.6, and so when <code>.eql?</code> and <code>.hash</code> are called on a hash object (the .hash method has nothing to do with the Hash data type - it's like the checksum kind of hash) it falls back to using the methods defined in the Object base class, which simply say \"Is it the same object in memory\".</p>\n\n<p>The <code>==</code> and <code>===</code> operators, for hash objects, already do what I want, ie to say that two hashes are the same if their contents are the same.  I've overriden <code>Hash#eql?</code> to use these, like so:</p>\n\n<pre><code>class Hash\n  def eql?(other_hash)\n    self == other_hash\n  end\nend\n</code></pre>\n\n<p>But, I'm not sure how to handle <code>Hash#hash</code>: that is, I don't know how to generate a checksum which will be the same for two hashes whose contents are the same and always different for two hashes with different contents.</p>\n\n<p>@Ajedi32 suggested I have a look at Rubinius' implentation of the <code>Hash#hash</code> method here <a href=\"https://github.com/rubinius/rubinius/blob/master/core/hash.rb#L589\" rel=\"nofollow noreferrer\">https://github.com/rubinius/rubinius/blob/master/core/hash.rb#L589</a> , and my version of Rubinius' implementation looks like this:</p>\n\n<pre><code>class Hash\n  def hash\n    result = self.size\n    self.each do |key,value|\n      result ^= key.hash \n      result ^= value.hash \n    end\n    return result\n  end\nend\n</code></pre>\n\n<p>and this does seem to work, although I don't know what the \"^=\" operator does, which makes me a bit nervous.  Also, it's very slow - about 50x as slow based on some primitive benchmarking.  This might make it too slow to use.</p>\n\n<p>EDIT 3: A bit of research has revealed that \"^\" is the Bitwise Exclusive OR operator.  When we have two inputs, an XOR returns 1 if the inputs are different (ie it returns 0 for 0,0 and 1,1 and 1 for 0,1 and 1,0).  </p>\n\n<p>So, at first I thought that means that </p>\n\n<pre><code>result ^= key.hash \n</code></pre>\n\n<p>is shorthand for </p>\n\n<pre><code>result = result ^ key.hash\n</code></pre>\n\n<p>In other words, do an XOR between the current value of result and the other thing, and then save that in result. I still don't quite get the logic of this though.  I thought that perhaps the ^ operator was something to do with pointers, because calling it on variables works while calling it on the value of the variable doesn't work:  eg</p>\n\n<pre><code>var = 1\n=&gt; 1\nvar ^= :foo\n=&gt; 14904\n1 ^= :foo\nSyntaxError: compile error\n(irb):11: syntax error, unexpected tOP_ASGN, expecting $end\n</code></pre>\n\n<p>So, it's fine with calling ^= on a variable but not the value of the variable, which made me think it's something to do with referencing/dereferencing.</p>\n\n<p>Later implementations of Ruby also have C code for the Hash#hash method, and Rubinius' implementaion seems too slow.  Bit stuck...</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe"], "comments": [{"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1510700830, "post_id": 47290427, "comment_id": 81544858, "body": "I still don&#39;t get why you want all nodes in your chef server interface for a single attribute... are you looping over it later ? How is this attribute supposed to be used ?"}, {"owner": {"reputation": 425, "user_id": 3542702, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aMGPY.jpg?s=128&g=1", "display_name": "hobbes", "link": "https://stackoverflow.com/users/3542702/hobbes"}, "reply_to_user": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1510718322, "post_id": 47290427, "comment_id": 81549460, "body": "That&#39;s just it, I don&#39;t. I don&#39;t know how to do a search without using a node index to list all the nodes, and using client as an index doesn&#39;t load any results either. This is where my inexperience comes into play. When loading a node attribute, it&#39;s typically as easy as node[&#39;hostname&#39;], but doesn&#39;t appear to be as simple when running that search query."}, {"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 1, "creation_date": 1510732123, "post_id": 47290427, "comment_id": 81554650, "body": "Just forget the search part, I&#39;ll edit my answer later in the morning, you just need the select part (probably with an exclusion of loopback interface)"}, {"owner": {"reputation": 425, "user_id": 3542702, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aMGPY.jpg?s=128&g=1", "display_name": "hobbes", "link": "https://stackoverflow.com/users/3542702/hobbes"}, "reply_to_user": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1510764173, "post_id": 47290427, "comment_id": 81576465, "body": "Thanks, I really appreciate your help. I&#39;ve been working on this for the past couple days, and unfortunately, can&#39;t get this to work yet. I&#39;ve tried similar variations to the post above, including removing the search method, which requires removal of .each as it returns as an undefined method (rightfully so, if it&#39;s no longer looping through each node). I just can&#39;t figure out the query to pull locally. From my understanding, the second half of the query gets the result I want, but the first half does not get the local node."}], "answers": [{"comments": [{"owner": {"reputation": 425, "user_id": 3542702, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aMGPY.jpg?s=128&g=1", "display_name": "hobbes", "link": "https://stackoverflow.com/users/3542702/hobbes"}, "edited": false, "score": 0, "creation_date": 1510687621, "post_id": 47290802, "comment_id": 81538305, "body": "I like the flattened version of the query that you suggested. This will be written in a recipe, so I was hoping to define the variable in the attributes, and wanted to do something like:     default[&#39;netdev&#39;] = node.search(&#39;network_interfaces_*_state:up&#39;) This won&#39;t work of course since the search method is undefined. Will the search method work for me in either the templates/attributes, or recipe directly?"}, {"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "reply_to_user": {"reputation": 425, "user_id": 3542702, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aMGPY.jpg?s=128&g=1", "display_name": "hobbes", "link": "https://stackoverflow.com/users/3542702/hobbes"}, "edited": false, "score": 1, "creation_date": 1510688795, "post_id": 47290802, "comment_id": 81538917, "body": "Yes, just use search, but you&#39;ll need to filter the interface list and probably take only the first one, but if it is for the current node there&#39;s a more straightforward way than search. You should edit your question to give more details on why you want this value and for which node"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 1, "creation_date": 1510706938, "post_id": 47290802, "comment_id": 81546791, "body": "At this point you kind of might as well just use <code>*:*</code> as the search unless you expect to have a lot of Chef nodes with no network interfaces :)"}, {"owner": {"reputation": 425, "user_id": 3542702, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aMGPY.jpg?s=128&g=1", "display_name": "hobbes", "link": "https://stackoverflow.com/users/3542702/hobbes"}, "edited": false, "score": 0, "creation_date": 1510713942, "post_id": 47290802, "comment_id": 81548513, "body": "@Tensibai I&#39;ve sat down tonight to describe in better detail the current issue I face. Your knife exec -E statement was very helpful, along with knowing that indexes can be flattened. I was able to pull out just the interface device names, but for the entire inventory, not the local host. My big issues are how to I run it for the local host where the chef-client runs, and where does it fit in the cookbook (recipe vs attributes vs template)?"}, {"owner": {"reputation": 425, "user_id": 3542702, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aMGPY.jpg?s=128&g=1", "display_name": "hobbes", "link": "https://stackoverflow.com/users/3542702/hobbes"}, "edited": false, "score": 0, "creation_date": 1510764374, "post_id": 47290802, "comment_id": 81576607, "body": "Awesome, thank you so much! I see what you&#39;ve done now in your updated query, thanks for breaking it down. Best answer, as it resolved my issues!"}], "tags": [], "owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "is_accepted": true, "score": 2, "last_activity_date": 1510737837, "last_edit_date": 1510737837, "creation_date": 1510677175, "answer_id": 47290802, "question_id": 47290427, "link": "https://stackoverflow.com/questions/47290427/chef-how-to-gather-local-network-interface-attribute-with-state-key-equal-to-up/47290802#47290802", "title": "Chef: How to gather local network.interface attribute with state key equal to up?", "body": "<p>So what you need is the first 'up' interface, assuming the loopback interface should be avoided, this should do:</p>\n\n<pre><code>template '/etc/foo.conf' do\n    ....\n    variables ({\n        netdev: node['network']['interfaces'].select { |i,j| j['state'] == 'up' &amp;&amp; i != 'lo' }.keys[0]\n    })\nend\n</code></pre>\n\n<p>The main idea is to filter the interfaces hash on the interface state and name, keep the keys and take the first one of the resulting array.</p>\n\n<hr>\n\n<p>Previous answer kept for information.</p>\n\n<p>Attributes are <a href=\"https://docs.chef.io/chef_search.html#nested-fields\" rel=\"nofollow noreferrer\">indexed and flattened</a> so you may search for just <code>state:up</code> but may find other attributes named state.</p>\n\n<p>Using the flattened version you could do:</p>\n\n<p><code>knife node search 'network_interface_*_state:up' -a network.interfaces</code> </p>\n\n<p>This is derived from the examples of nested fields in the documentation linked above.</p>\n\n<p>In case you wish to get each interface up for each node you can play with the search and a little of ruby with <code>knife exec</code> like this :</p>\n\n<pre><code> knife exec -E \"nodes.search('network_interfaces_*_state:up').each { |n| puts \\\"#{n} #{n['network']['interfaces'].select { |i,j| j['state'] == 'up' }.keys } \\\" }\"\nnode[xxxxxxx] [\"eth1\", \"eth2\", \"eth3\", \"usb0\"]\nnode[yyyyyyy] [\"docker0\"]\nnode[zzzzzzz] [\"eth1\", \"eth2\", \"eth3\", \"usb0\"]\n</code></pre>\n\n<p>The idea is to search for nodes with up interfaces and for each filtering the interfaces whose property (<code>j</code> in <code>select</code> block as they are a hash within a hash) state is up and then keep only the <code>keys</code> of the resulting filtered hash which are the interfaces with state up. (side note my examples above were done with state:down to limit the results)</p>\n"}], "owner": {"reputation": 425, "user_id": 3542702, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aMGPY.jpg?s=128&g=1", "display_name": "hobbes", "link": "https://stackoverflow.com/users/3542702/hobbes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "accepted_answer_id": 47290802, "answer_count": 1, "score": 0, "last_activity_date": 1510737837, "creation_date": 1510676125, "last_edit_date": 1510713811, "question_id": 47290427, "link": "https://stackoverflow.com/questions/47290427/chef-how-to-gather-local-network-interface-attribute-with-state-key-equal-to-up", "title": "Chef: How to gather local network.interface attribute with state key equal to up?", "body": "<p>I'm interested in gathering the key value for any network_interfaces_*_state:up attribute's running on the host with the chef-client being run on. So any network interface with a state 'up' attribute. </p>\n\n<p>I have a template containing a configuration file, in which I need to gather the active network devices, using the above chef attribute. I've tried writing a few things within the default recipe file, such as:</p>\n\n<pre><code>template '/etc/foo.conf' do\n    ....\n    variables ({\n        netdev: search(node, 'network_interfaces_*_state:up').each {r |r| puts \"#{r['network']['interfaces'].select { |i,j| j['state'] == 'up' }.keys } \" }\n    })\nend\n</code></pre>\n\n<p>So there are two things that are obviously wrong. </p>\n\n<ol>\n<li>Running this as knife exec -E \"......\" returns the interface name for state:up on all nodes. I only want it from the current node that the chef-client is being run on. </li>\n<li>chef-client is returning an undefined method 'search' for Chef::Resource::Template, tracing back to the 'netdev' variable as posted above.</li>\n</ol>\n\n<p>I'm unfamiliar with Ruby and using Chef at this level, and was really hoping that I could get help with understanding two things. How do I pull a attribute value from a local host, and how the heck can I write this into a recipe/cookbook?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1510672368, "post_id": 47288949, "comment_id": 81528739, "body": "Close parentheses for image_tag"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510673519, "post_id": 47288949, "comment_id": 81529538, "body": "Are you using Rails 5? If yes, you can use <code>user.posts.left_join(:media)</code> to ensure that the returned posts have a <code>media</code> associated. If not using Rails 5, you can manually define the join (<a href=\"https://apidock.com/rails/ActiveRecord/QueryMethods/joins\" rel=\"nofollow noreferrer\">apidock.com/rails/ActiveRecord/QueryMethods/joins</a>). And this will also solve your n+1 query problem."}], "answers": [{"comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510673607, "post_id": 47289173, "comment_id": 81529592, "body": "another option is to have a <code>else</code> block for the <code>if post.media.present?</code> and display something like <code>&quot;no media for post #{post.id}&quot;</code>"}, {"owner": {"reputation": 2301, "user_id": 4229573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e7951be77e4a473ae68428a91296b6?s=128&d=identicon&r=PG", "display_name": "Sawo Cliff", "link": "https://stackoverflow.com/users/4229573/sawo-cliff"}, "edited": false, "score": 0, "creation_date": 1510675401, "post_id": 47289173, "comment_id": 81530889, "body": "I knew this would come up. In my view I am also viewing all the users posts and i do not intend to limit those. The alternative was to create another variable to handle this but that would have me calling querying the db twice for the same resource, wouldn&#39;t it? And yes. I had tried this too"}, {"owner": {"reputation": 2301, "user_id": 4229573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e7951be77e4a473ae68428a91296b6?s=128&d=identicon&r=PG", "display_name": "Sawo Cliff", "link": "https://stackoverflow.com/users/4229573/sawo-cliff"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510675566, "post_id": 47289173, "comment_id": 81530990, "body": "@MrYoshiji, for my codes purposes, this works just fine as there are some html css code present. I wouldn&#39;t like to render them if no images are found"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510676973, "post_id": 47289173, "comment_id": 81531973, "body": "maybe a default image?"}], "tags": [], "owner": {"reputation": 1113, "user_id": 4701098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QnL4.jpg?s=128&g=1", "display_name": "Samy Kacimi", "link": "https://stackoverflow.com/users/4701098/samy-kacimi"}, "is_accepted": false, "score": 3, "last_activity_date": 1510672380, "creation_date": 1510672380, "answer_id": 47289173, "question_id": 47288949, "link": "https://stackoverflow.com/questions/47288949/limit-images-show-in-post-to-last-six/47289173#47289173", "title": "Limit images show in post to last six", "body": "<p>First of all, you should not make the calls to the db/model (with <code>limit</code>) in the views. Call it directly in the controller :\n<code>@posts = user.posts.order(created_at: :desc).limit(6)</code></p>\n\n<p>Then, I would do some debugging to be sure you have the records you want.</p>\n\n<p>Use byebug for instance and call it just after you set you <code>@posts</code> instance variable to see what it contains. Do all the posts contain a media ?</p>\n"}], "owner": {"reputation": 2301, "user_id": 4229573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e7951be77e4a473ae68428a91296b6?s=128&d=identicon&r=PG", "display_name": "Sawo Cliff", "link": "https://stackoverflow.com/users/4229573/sawo-cliff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510675734, "creation_date": 1510671743, "last_edit_date": 1510675734, "question_id": 47288949, "link": "https://stackoverflow.com/questions/47288949/limit-images-show-in-post-to-last-six", "title": "Limit images show in post to last six", "body": "<p>I have with me a set of posts created from a scaffold and images uploaded using paperclip gem. I would like to show on each users profile the last six images from the users last posts and for that I am filtering as such</p>\n\n<pre><code>&lt;% @posts.limit(6).each do |tweet| %&gt;\n  &lt;% if post.media.present? %&gt; \n    &lt;%= link_to image_tag(post.media.url(:thumb)), tweet %&gt;&lt;br&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In my controller I have the posts arranged as such</p>\n\n<pre><code>@posts = user.posts.order('created_at desc')\n</code></pre>\n\n<p>My question is. Why is it that when using the above code, NO image is displayed. On upping the count to 9, I get three images displayed, to 12 i get six images displayed and so on</p>\n\n\n"}, {"tags": ["ruby", "xml", "savon"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1510670172, "post_id": 47288203, "comment_id": 81526990, "body": "Try to add <code>attributes!: { &quot;buggy:client&quot; =&gt; { &quot;id:objecttype&quot; =&gt; &quot;something&quot; } }</code> into property hash is it is done <a href=\"https://github.com/savonrb/savon/blob/fcb56fab6024ed2eb9c71e261d72a893a12abfbf/lib/savon/header.rb#L65\" rel=\"nofollow noreferrer\">inside library</a>."}, {"owner": {"reputation": 51, "user_id": 4198075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1d8ff2fc09b93dc890f0351e714cad2?s=128&d=identicon&r=PG&f=1", "display_name": "bmes", "link": "https://stackoverflow.com/users/4198075/bmes"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1510671751, "post_id": 47288203, "comment_id": 81528323, "body": "Thanks, that did the trick! I didn&#39;t try adding attributes with &quot;buggy:client&quot;."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1510672003, "post_id": 47288203, "comment_id": 81528490, "body": "Welcome. I always grep the codebase for examples, and it always helps. All that stuff is OSS after all."}], "owner": {"reputation": 51, "user_id": 4198075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1d8ff2fc09b93dc890f0351e714cad2?s=128&d=identicon&r=PG&f=1", "display_name": "bmes", "link": "https://stackoverflow.com/users/4198075/bmes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510669685, "creation_date": 1510669685, "question_id": 47288203, "link": "https://stackoverflow.com/questions/47288203/adding-a-property-to-xml-request", "title": "Adding a property to xml request", "body": "<p>I'm using Savon Ruby gem to call a SOAP API, I have the request almost ready but one thing is bugging still. </p>\n\n<pre><code>savonclient = Savon.client(wsdl: 'test.wsdl',\nendpoint: 'http://endpoint.biz/',\n                  log: true,\n                  log_level: :debug,\n                  pretty_print_xml: true,\n                  convert_request_keys_to: :none,\n                  namespaces: { 'xmlns:buggy' =&gt; 'http://otherdomain.biz/something.xsd'},\n                  soap_header: { 'buggy:client' =&gt; {\n\"id:property1\" =&gt; 'value1',\n\"id:property2\" =&gt; 'value2'\n}\n</code></pre>\n\n<p>This produces</p>\n\n<pre><code>&lt;env:Header&gt;\n&lt;buggy:client&gt;\n  &lt;id:property1&gt;value1&lt;/id:property1&gt;\n  &lt;id:propert2&gt;value2&lt;/id:property2&gt;\n&lt;/buggy:client&gt;\n</code></pre>\n\n<p>What I need is to have property after buggy:client, like this:</p>\n\n<pre><code>&lt;buggy:client id:objecttype=\"something\"&gt;\n</code></pre>\n\n<p>I tried adding attributes hash for the soap_header, but it only creates a new attribute below .</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby", "upload", "task", "capistrano", "webdeploy"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510668587, "post_id": 47287863, "comment_id": 81525826, "body": "What did you change recently? Something related to paths, I&#39;m sure."}, {"owner": {"reputation": 411, "user_id": 4261032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/091ac94e9ac5028e8837475a3898b721?s=128&d=identicon&r=PG&f=1", "display_name": "mikmprdd", "link": "https://stackoverflow.com/users/4261032/mikmprdd"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510668599, "post_id": 47287863, "comment_id": 81525835, "body": "On my server ruby -v = ruby 2.0.0p648 (2015-12-16) [x86_64-linux]"}, {"owner": {"reputation": 411, "user_id": 4261032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/091ac94e9ac5028e8837475a3898b721?s=128&d=identicon&r=PG&f=1", "display_name": "mikmprdd", "link": "https://stackoverflow.com/users/4261032/mikmprdd"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510668644, "post_id": 47287863, "comment_id": 81525863, "body": "I do only some &quot;gem updates&quot;..."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510668831, "post_id": 47287863, "comment_id": 81526018, "body": "Did you update the capistrano itself? Guess it doesn&#39;t stringifies its pathnames anymore. Try adding <code>.to_s</code> on the pathnames."}, {"owner": {"reputation": 411, "user_id": 4261032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/091ac94e9ac5028e8837475a3898b721?s=128&d=identicon&r=PG&f=1", "display_name": "mikmprdd", "link": "https://stackoverflow.com/users/4261032/mikmprdd"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510668911, "post_id": 47287863, "comment_id": 81526062, "body": "Yep!!! It works! But until yesterday everything worked without it!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510668997, "post_id": 47287863, "comment_id": 81526121, "body": "Until yesterday you used other gems."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 411, "user_id": 4261032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/091ac94e9ac5028e8837475a3898b721?s=128&d=identicon&r=PG&f=1", "display_name": "mikmprdd", "link": "https://stackoverflow.com/users/4261032/mikmprdd"}, "edited": false, "score": 0, "creation_date": 1510669004, "post_id": 47287918, "comment_id": 81526126, "body": "Some erroneous code was working because of the bug/issue in one of gems you were using was not of the recent version. So what? It expects a string, not a pathname. Period."}, {"owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "edited": false, "score": 0, "creation_date": 1510722469, "post_id": 47287918, "comment_id": 81550645, "body": "The error is due to a bug introduced in sshkit 1.15.0 (a gem used by Capistrano). It will be fixed in a forthcoming release. In the meantime the <code>to_s</code> workaround is perfectly valid. <a href=\"https://github.com/capistrano/sshkit/issues/409\" rel=\"nofollow noreferrer\">github.com/capistrano/sshkit/issues/409</a>"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1510668681, "creation_date": 1510668681, "answer_id": 47287918, "question_id": 47287863, "link": "https://stackoverflow.com/questions/47287863/nomethoderror-undefined-method-start-with/47287918#47287918", "title": "NoMethodError: undefined method `start_with?&#39;", "body": "<pre><code>upload! fetch(:local_dist_path).to_s, fetch(:remote_dist_path), recursive: true\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>upload! fetch(:local_dist_path).to_s, fetch(:remote_dist_path).to_s, recursive: true\n</code></pre>\n\n<p>(call <code>to_s</code> on both <code>Pathname</code>s.)</p>\n"}], "owner": {"reputation": 411, "user_id": 4261032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/091ac94e9ac5028e8837475a3898b721?s=128&d=identicon&r=PG&f=1", "display_name": "mikmprdd", "link": "https://stackoverflow.com/users/4261032/mikmprdd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1407, "favorite_count": 0, "accepted_answer_id": 47287918, "answer_count": 1, "score": 1, "last_activity_date": 1510668681, "creation_date": 1510668528, "question_id": 47287863, "link": "https://stackoverflow.com/questions/47287863/nomethoderror-undefined-method-start-with", "title": "NoMethodError: undefined method `start_with?&#39;", "body": "<p>Today (I don't know why!!!!) I cannot deploy my project with capistrano.</p>\n\n<p>When I launch this task</p>\n\n<pre><code>namespace :deploy do\n\n  # Theme path\n  set :theme_path, Pathname.new('web/app/themes').join(fetch(:theme_name))\n\n  # Local Paths\n  set :local_theme_path, Pathname.new(File.dirname(__FILE__)).join('../').join(fetch(:theme_path))\n  set :local_dist_path, fetch(:local_theme_path).join('dist')\n\n  task :compile do\n    run_locally do\n      within fetch(:local_theme_path) do\n        execute \"git checkout #{fetch(:branch)}\"\n        execute :gulp, '--production'\n      end\n    end\n  end\n\n  task :copy do\n    on roles(:web) do\n\n      # Remote Paths (Lazy-load until actual deploy)\n      set :remote_dist_path, -&gt; { release_path.join(fetch(:theme_path)).join('dist') }\n\n      info \" Your local distribution path: #{fetch(:local_dist_path)} \"\n      info \" Boom!!! Your remote distribution path: #{fetch(:remote_dist_path)} \"\n      info \" Uploading files to remote \"\n      upload! fetch(:local_dist_path).to_s, fetch(:remote_dist_path), recursive: true\n    end\n  end\n\n  task assets: %w(compile copy)\nend\n</code></pre>\n\n<p>Capistrano print this error</p>\n\n<blockquote>\n  <p>(Backtrace restricted to imported tasks)</p>\n  \n  <p>cap aborted!</p>\n  \n  <p>SSHKit::Runner::ExecuteError: Exception while executing as ec2->user@*********: undefined method `start_with?' for #Pathname:0x0000*fc***a****</p>\n  \n  <p>Caused by:</p>\n  \n  <p>NoMethodError: undefined method `start_with?' for #Pathname:0x0000*fc***a****</p>\n</blockquote>\n\n<p>I try all: uninstall node, ruby, etc... ma nothing change.\nSomeone can help me?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "neo4j"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510667716, "post_id": 47287220, "comment_id": 81525179, "body": "Using <code>before :all</code> and <code>after :all</code> is a fragile construct which will cause issues when the specs are run in a random order. You want to reset the DB state before each example."}, {"owner": {"reputation": 1251, "user_id": 7882685, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/94b65eaecdd85aebae0bcbca18d4b651?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub", "link": "https://stackoverflow.com/users/7882685/jakub"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510667880, "post_id": 47287220, "comment_id": 81525309, "body": "@max could you please show me an example of what I should do? because I stuck with this thanks"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1510674182, "post_id": 47287220, "comment_id": 81529980, "body": "@jakub you want a different context for each of your test. In that case, you don&#39;t have to use the <code>before</code> block but just setup the data needed for the test at the beginning of it, like you did for the <code>updates an amendment</code> test. Tests are: setup, exercise, verify and then teardown (<a href=\"https://robots.thoughtbot.com/four-phase-test\" rel=\"nofollow noreferrer\">robots.thoughtbot.com/four-phase-test</a>). You only need to define a <code>before</code>/<code>after</code> block if you need to share data between your tests or if several of them need the same data setup"}, {"owner": {"reputation": 1251, "user_id": 7882685, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/94b65eaecdd85aebae0bcbca18d4b651?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub", "link": "https://stackoverflow.com/users/7882685/jakub"}, "edited": false, "score": 0, "creation_date": 1510736740, "post_id": 47287220, "comment_id": 81557266, "body": "Yes I understood that but still cannot figure out how to make this test to work"}], "owner": {"reputation": 1251, "user_id": 7882685, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/94b65eaecdd85aebae0bcbca18d4b651?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub", "link": "https://stackoverflow.com/users/7882685/jakub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510666499, "creation_date": 1510666499, "question_id": 47287220, "link": "https://stackoverflow.com/questions/47287220/how-to-update-an-existing-test-model-and-controller-for-neo4j-in-rails", "title": "How to update an existing test model and controller for Neo4j in Rails", "body": "<p>I have a Rails application which was migrated recently to Neo4j technology. Now I'm trying to adapt or update the existing testing files to this new technology. However, I had some difficulties and many fails. What I need is to understand the code I will share below. How to change that code to be suitable for Neo4j. I need a reference as online I could not find any good one. In the specific case I'm sharing I understood the destroy or delete is not working and also my error is that the expected result does not match.    </p>\n\n<p>This is the error I have from running rspec:</p>\n\n<pre><code>Failure/Error: expect(result).to eq(expected)\n\n       expected: {:data=&gt;[{:study_version_id=&gt;nil, :cid=&gt;\"X1\", :namespace=&gt;\"http://www.example.com\", :property=&gt;\"quest...le.com\", :property=&gt;\"enabled\", :study_value=&gt;\"true\", :default_value=&gt;\"true\", :datatype=&gt;\"boolean\"}]}\n            got: {:data=&gt;[{:amendment=&gt;{:created_at=&gt;\"2017-11-14T13:19:09.000+00:00\", :updated_at=&gt;\"2017-11-14T13:19:0...true\", :default_value=&gt;\"true\", :datatype=&gt;\"boolean\", :id=&gt;\"fa97a13f-3c2a-4391-80c0-6d61250e7367\"}}]}\n</code></pre>\n\n<p>Below my controller_spec and model_spec:</p>\n\n<pre><code>require 'rails_helper'\n\ndescribe AmendmentsController, type: :controller do\n\n  include UserAccountHelpers\n  include FileHelpers\n  include JsonHelpers\n\n  def sub_dir\n    return \"controllers\"\n  end\n\n  describe \"Edit Access\" do\n\n    before :all do\n      Amendment.delete_all\n      a = Amendment.create(cid: \"X1\", namespace:  \"http://www.example.com\", property: \"question\",\n        study_value: \"ADEF\", default_value: \"A1\", datatype: \"string\")\n      a = Amendment.create(cid: \"X1\", namespace:  \"http://www.example.com\", property: \"enabled\",\n        study_value: \"true\", default_value: \"true\", datatype: \"boolean\")\n      a = Amendment.create(cid: \"Y1\", namespace:  \"http://www.example.com\", property: \"enabled\",\n        study_value: \"false\", default_value: \"true\", datatype: \"boolean\")\n      ua_create\n    end\n\n    after :all do\n      Amendment.delete_all\n      ua_destroy\n    end\n\n    before :each do\n      login_with_edit_access\n    end\n\n    after :each do\n    end\n\n    it \"finds amendments for a given item\" do\n      request.env['HTTP_ACCEPT'] = \"application/json\"\n      get :find, {amendment: {cid: \"X1\", namespace: \"http://www.example.com\"}}\n      expect(response.content_type).to eq(\"application/json\")\n      expect(response.code).to eq(\"200\")\n      result = remove_id_and_timestamps(response)\n    #write_yaml_file(result, sub_dir, \"amendments_controller_find_1.txt\")\n      expected = read_yaml_file(sub_dir, \"amendments_controller_find_1.txt\")\n      expect(result).to eq(expected)\n    end\n\n    it \"finds amendments for a given item, none present\" do\n      request.env['HTTP_ACCEPT'] = \"application/json\"\n      get :find, {amendment: {cid: \"X11\", namespace: \"http://www.example.com\"}}\n      expect(response.content_type).to eq(\"application/json\")\n      expect(response.code).to eq(\"200\")\n    #write_text_file(response.body, sub_dir, \"amendments_controller_find_2.txt\")\n      expected = read_text_file(sub_dir, \"amendments_controller_find_2.txt\")\n      expect(response.body).to eq(expected)\n    end\n\n    it \"creates an amendment\" do\n      request.env['HTTP_ACCEPT'] = \"application/json\"\n      post :create, {amendment: {cid: \"X11\", namespace: \"http://www.example.com\", property: \"question\",\n        study_value: \"SSS\", default_value: \"AAA\", datatype: \"string\"}}\n      expect(response.content_type).to eq(\"application/json\")\n      expect(response.code).to eq(\"200\")\n    end\n\n    it \"updates an amendment\" do\n      a = Amendment.create(cid: \"X11\", namespace:  \"http://www.example.com\", property: \"question\",\n        study_value: \"ADEF\", default_value: \"A1\", datatype: \"string\")\n      request.env['HTTP_ACCEPT'] = \"application/json\"\n      put :update, {id: a.id, amendment: {property: \"question\", \n        study_value: \"SSS\", default_value: \"AAA\", datatype: \"string\"}}\n      expect(response.content_type).to eq(\"application/json\")\n      expect(response.code).to eq(\"200\")\n    #write_text_file(response.body, sub_dir, \"amendments_controller_create_1.txt\")\n      expected = read_text_file(sub_dir, \"amendments_controller_create_1.txt\")\n      expect(response.body).to eq(expected)\n    end\n\n    it \"destroys an amendment\" do\n      a = Amendment.create(cid: \"X11\", namespace:  \"http://www.example.com\", property: \"question\", \n        study_value: \"ADEF\", default_value: \"A1\", datatype: \"string\")\n      request.env['HTTP_ACCEPT'] = \"application/json\"\n      delete :destroy, {id: a.id}\n      expect(response.content_type).to eq(\"application/json\")\n      expect(response.code).to eq(\"200\")\n    end\n\n  end\n\n  describe \"Unauthorized User\" do\n\n    it \"find\" do\n      get :find\n      expect(response).to redirect_to(\"/users/sign_in\")\n    end\n\n    it \"create\" do\n      post :create\n      expect(response).to redirect_to(\"/users/sign_in\")\n    end\n\n    it 'update' do\n      put :update, {id: 1}\n      expect(response).to redirect_to(\"/users/sign_in\")\n    end\n\n    it 'destroy' do\n      delete :destroy, {id: 1}\n      expect(response).to redirect_to(\"/users/sign_in\")\n    end\n\n  end\n\nend\n\n# MODEL \nrequire 'rails_helper'\n\ndescribe Amendment do\n\n  before :each do\n    Amendment.(&amp;:destroy)\n  end\n\n  after :each do\n    Amendment.(&amp;:destroy)\n  end\n\n  it \"serializes the amendmemt as a hash\" do\n    amendment = Amendment.create(cid: \"XXX\", namespace:  \"http://ww.example.com\", property: \"question\",\n      study_value: \"ADEF\", default_value: \"A\", datatype: \"string\")\n        result = amendment.to_hash\n        expected = \n        { \n            cid: \"XXX\", \n            namespace: \"http://ww.example.com\", \n            property: \"question\", \n            study_value: \"ADEF\",\n      default_value: \"A\",\n      datatype: \"string\"\n        }\n    expect(result).to eq(expected)\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1510665050, "post_id": 47286673, "comment_id": 81523254, "body": "Rule of thumb: <b>do not use <code>return</code> in ruby save for early returns</b>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510665052, "post_id": 47286673, "comment_id": 81523255, "body": "Can you compose a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1510665132, "post_id": 47286673, "comment_id": 81523316, "body": "@mudasobwa: one could argue that <i>every</i> return is an early return. :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510665199, "post_id": 47286673, "comment_id": 81523378, "body": "@SergioTulentsev <i>\u201cearly return\u2019</i> is an idiom, like <i>\u201cfail fast\u201d</i> in <a href=\"https://stackoverflow.com/questions/tagged/erlang\">erlang</a> :)"}, {"owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1510665247, "post_id": 47286673, "comment_id": 81523419, "body": "@mudasobwa the final loop return is to quit the method before it reaches the ending <code>false</code> it was all thought beforehand, there is a reason for everything here"}, {"owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510665351, "post_id": 47286673, "comment_id": 81523499, "body": "@SergioTulentsev wait i&#39;ll work on making something simple you can try"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510667222, "post_id": 47286673, "comment_id": 81524828, "body": "@Laurent: yep, that snippet was very useful, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510667316, "post_id": 47287453, "comment_id": 81524884, "body": "Yes, this essentially repeats mudasobwa&#39;s (now deleted) answer, but with less code. Unfortunately, there seems to be no magic trick that could work here."}, {"owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "edited": false, "score": 0, "creation_date": 1510667594, "post_id": 47287453, "comment_id": 81525108, "body": "That&#39;s what I was afraid of, that&#39;s why I asked and now I&#39;ve the confirmation ... Escaping with a stop (trick) seems to be the cleanest solution ..."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1510668170, "last_edit_date": 1510668170, "creation_date": 1510667207, "answer_id": 47287453, "question_id": 47286673, "link": "https://stackoverflow.com/questions/47286673/proc-new-binding-change-and-loops-logic-abstraction/47287453#47287453", "title": "Proc.new binding change and loops logic abstraction", "body": "<p>You can't have your cake and eat it too. If you want <code>return</code> from the proc to abort the method, it must be in the method's lexical scope* (which is another way to say \"it must be defined within the same method\").</p>\n\n<p>An alternative is to have proc/lambda return a \"stop\" value, which caller will use to abort its execution.</p>\n\n<p>(Your experiments with instance_eval/instance_exec were misdirected, sadly. Those methods only change current <code>self</code>. This problem has nothing to do with current <code>self</code>, but rather current lexical scope, in which <code>return</code> is executed.)</p>\n\n<hr>\n\n<p><sup>* The error you're getting, it is caused by <code>return</code> trying to return from a method that is no longer running (<code>proc_exec</code>).</sup></p>\n"}], "owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 47287453, "answer_count": 1, "score": 2, "last_activity_date": 1510669515, "creation_date": 1510664834, "last_edit_date": 1510669515, "question_id": 47286673, "link": "https://stackoverflow.com/questions/47286673/proc-new-binding-change-and-loops-logic-abstraction", "title": "Proc.new binding change and loops logic abstraction", "body": "<p>I've two loops in two different methods which look very similar. I wanted to abstract most of their logic in a <code>Proc.new</code></p>\n\n<p><strong>This works</strong></p>\n\n<pre><code>def matches_base?\n  proc_exec = Proc.new do |subclass, breakpoint|\n    # next and return are meant to act inside the loop and quit it if needed\n    response = process_match(subclass)\n    next if response == :continue\n    return true if response == false\n\n    return response\n  end\n\n  subclasses(BASE_NAMESPACE).each do |subclass|\n    proc_exec.call(subclass)\n  end\n  false\nend\n</code></pre>\n\n<p>The obvious issue here is the <code>proc_exec</code> is defined inside the method itself, but I want to use it in another method</p>\n\n<pre><code>def matches_breakpoints?\n  breakpoints.fetch.each do |breakpoint|\n    # I want to include the proc_exec here too\n  end\n  false\nend\n</code></pre>\n\n<p>So I just tried to extract it at the class level like so</p>\n\n<p><strong>This does not work</strong></p>\n\n<pre><code>def proc_exec\n  Proc.new do |subclass, breakpoint|\n    response = process_match(subclass)\n    next if response == :continue\n    return true if response == false\n\n    return response\n  end\nend\n\ndef matches_base?\n  subclasses(BASE_NAMESPACE).each do |subclass|\n    proc_exec.call(subclass)\n  end\n  false\nend\n</code></pre>\n\n<p>Then I could have called it like <code>proc_exec.call</code> from within both instance methods. Currently it throws</p>\n\n<pre><code> LocalJumpError:\n   unexpected return\n</code></pre>\n\n<p>I tried many tricks such as <code>instance_eval</code> or <code>instance_exec</code> without success. I'm out of solution right now.</p>\n\n<hr>\n\n<p><strong>Easily executable, simplified example of what I want below.</strong></p>\n\n<pre><code>class MyLoops\n  def proc_exec\n    Proc.new do |num|\n      next if num == 1\n      # we want this `return` to act in the method context\n      # as it would do if I defined it inside a method directly\n      return if num == 4\n      puts \"Current number : #{num}\"\n    end\n  end\n\n  def method_a\n    [0,1,2].each do |num|\n      proc_exec.call(num)\n    end\n    false\n  end\n\n  def method_b\n    [3,4,5].each do |num|\n      proc_exec.call(num)\n    end\n  end\n  # this `false` below should never be reached ; that's the trick\n  false\nend\n\nloops = MyLoops.new\nloops.method_a\nloops.method_b\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "shopify"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1510668322, "post_id": 47286437, "comment_id": 81525619, "body": "As of 2.2 (untagged) UPS will no longer be a supported carrier in the active shipping gem <a href=\"https://github.com/Shopify/active_shipping/blob/master/CHANGELOG.md\" rel=\"nofollow noreferrer\">CHANGELOG</a> so this might be causing issues for you"}], "owner": {"reputation": 172, "user_id": 3990119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/26I5Y.jpg?s=128&g=1", "display_name": "Lucas Ocon", "link": "https://stackoverflow.com/users/3990119/lucas-ocon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510664010, "creation_date": 1510664010, "question_id": 47286437, "link": "https://stackoverflow.com/questions/47286437/incorrect-rates-from-api-and-ups-website-activeshipping-gem", "title": "Incorrect rates from API and UPS website ActiveShipping gem", "body": "<p>I got incorrect rates using the UPS service.\nThe issue is that I got different rates received from the gem and from the website\nI got:\nWebsite: 418.22USD for UPS Next Day Air\nActiveShipping: 485.62 for UPS Next Day Air</p>\n\n<p>From: 59101\nTo: 59452\nWight: 96 lbs\nPackages 50lbs + 46lbs</p>\n\n<p>Rates from ActiveShipping:</p>\n\n<pre><code>=&gt; {\"UPS Second Day Air\"=&gt;25350, \"UPS Next Day Air\"=&gt;48562}\n</code></pre>\n\n<p>Rates on web\n<a href=\"https://i.stack.imgur.com/Yfk7t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yfk7t.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm missing some params that can be different on web that on ActiveShipping?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "yaml", "amazon-elastic-beanstalk"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 2, "creation_date": 1510664329, "post_id": 47286357, "comment_id": 81522779, "body": "You don&#39;t need to check every file. Check &#39;/var/app/ondeck/config/database.yml&#39; only."}, {"owner": {"reputation": 13866, "user_id": 267416, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/58278233d7c0462014b63d2538c811b4?s=128&d=identicon&r=PG", "display_name": "Wazery", "link": "https://stackoverflow.com/users/267416/wazery"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1510666478, "post_id": 47286357, "comment_id": 81524319, "body": "I did, but it never got solved"}], "answers": [{"comments": [{"owner": {"reputation": 13866, "user_id": 267416, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/58278233d7c0462014b63d2538c811b4?s=128&d=identicon&r=PG", "display_name": "Wazery", "link": "https://stackoverflow.com/users/267416/wazery"}, "edited": false, "score": 0, "creation_date": 1510667620, "post_id": 47286574, "comment_id": 81525124, "body": "You are very right about writing a script on my own :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1510667175, "last_edit_date": 1510667175, "creation_date": 1510664437, "answer_id": 47286574, "question_id": 47286357, "link": "https://stackoverflow.com/questions/47286357/yaml-parsing-issue-in-rails/47286574#47286574", "title": "YAML Parsing Issue in Rails", "body": "<p>It\u2019s ruby after all: it\u2019s easier and faster to write the script rather than ask questions on SO and google for it.</p>\n\n<pre><code>Dir['*/**/*.yml'].each do |f| \n  File.write(f, File.read(f).gsub(/\\t/, '  '))\nend\n</code></pre>\n"}], "owner": {"reputation": 13866, "user_id": 267416, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/58278233d7c0462014b63d2538c811b4?s=128&d=identicon&r=PG", "display_name": "Wazery", "link": "https://stackoverflow.com/users/267416/wazery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 47286574, "answer_count": 1, "score": -1, "last_activity_date": 1510667175, "creation_date": 1510663757, "question_id": 47286357, "link": "https://stackoverflow.com/questions/47286357/yaml-parsing-issue-in-rails", "title": "YAML Parsing Issue in Rails", "body": "<p>I have an issue on Elastic Beanstalk deployment which is:</p>\n\n<pre><code>YAML syntax error occurred while parsing /var/app/ondeck/config/database.yml. Please note that YAML must be consistently indented using spaces. Tabs are not allowed. Error: (&lt;unknown&gt;): found character that cannot start any token while scanning for the next token at line 2 column 1 /var/app/ondeck/config/environment.rb:5:in `&lt;top (required)&gt;' /opt/rubies/ruby-2.4.2/bin/bundle:23:in `load' /opt/rubies/ruby-2.4.2/bin/bundle:23:in `&lt;main&gt;'\n\nCaused by: Psych::SyntaxError: (&lt;unknown&gt;): found character that cannot start any token while scanning for the next token at line 2 column 1 /var/app/ondeck/config/environment.rb:5:in `&lt;top (required)&gt;' /opt/rubies/ruby-2.4.2/bin/bundle:23:in `load' /opt/rubies/ruby-2.4.2/bin/bundle:23:in `&lt;main&gt;' Tasks: TOP =&gt; environment (See full trace by running task with --trace).\n</code></pre>\n\n<p>As what I have read, this is because YAML forbids using tabs, instead it uses spaces. </p>\n\n<p>The problem is that I manually checked every YAML file for tabs, and never found one. I think I missed something <strong>so my question is</strong>: is there any script that can go through my entire source code replacing tabs with 2 spaces in every YAML file?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1510662554, "post_id": 47285908, "comment_id": 81521565, "body": "You can simply reopen class (in this case it would be <code>String</code> class) and define the method you need. But it isn&#39;t advisable, especially for Ruby beginners."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 2, "creation_date": 1510662686, "post_id": 47285908, "comment_id": 81521649, "body": "@MarekLipka prepending a module is a preferable way since it allows to call <code>super</code> on while overwriting methods."}], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 3, "last_activity_date": 1510662925, "creation_date": 1510662925, "answer_id": 47286066, "question_id": 47285908, "link": "https://stackoverflow.com/questions/47285908/adding-custom-methods-to-standard-ruby-objects/47286066#47286066", "title": "Adding custom methods to standard ruby objects", "body": "<p>Just open the class and add the method.  You can open a class as many times as you need to.</p>\n\n<pre><code>class Fixnum\n  def lucky?\n    self == 7\n  end\nend\n\n95.lucky?\n=&gt; false\n\n7.lucky?\n=&gt; true\n</code></pre>\n\n<p>It's a useful ability and we've all done it.  Take care that your code is maintainable and that you don't break basic functionality. </p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1510663984, "post_id": 47286130, "comment_id": 81522523, "body": "This answer brings no additional value to the previously given answer by @SteveTurczyn plus the name of the method is confusing since it does not indeed add the exclamation mark to the receiver, it just returns a receiver appended with an exclamation mark."}], "tags": [], "owner": {"reputation": 66, "user_id": 2958213, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000244607580/picture?type=large", "display_name": "evngcdr", "link": "https://stackoverflow.com/users/2958213/evngcdr"}, "is_accepted": false, "score": 1, "last_activity_date": 1510663073, "creation_date": 1510663073, "answer_id": 47286130, "question_id": 47285908, "link": "https://stackoverflow.com/questions/47285908/adding-custom-methods-to-standard-ruby-objects/47286130#47286130", "title": "Adding custom methods to standard ruby objects", "body": "<pre><code>class String\n  def add_exclamation_mark\n    self + \"!\"\n  end\nend\n\n&gt; \"hello\".add_exclamation_mark\n\"hello!\"\n</code></pre>\n\n<p>That way you are adding new methods to a String class.</p>\n"}, {"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1510668357, "post_id": 47286502, "comment_id": 81525652, "body": "You could also wrap the <code>prepend</code> into a Refinement for isolation."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1510668914, "post_id": 47286502, "comment_id": 81526067, "body": "@J&#246;rgWMittag I consider <code>refinement</code>s an absolute evil and never use them, because the cat that barks here and moos there is much worse contract than the cat that meows everywhere. Refinements-related issues are incredibly hard to diagnose, locate and debug. Whether I do not need the cat to bark somewhere, I\u2019d better implement a proxy and delegate."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1510664212, "creation_date": 1510664212, "answer_id": 47286502, "question_id": 47285908, "link": "https://stackoverflow.com/questions/47285908/adding-custom-methods-to-standard-ruby-objects/47286502#47286502", "title": "Adding custom methods to standard ruby objects", "body": "<p>If you indeed feel a necessity to extend default behavior of classes you do not own (which is basically a very bad idea, one should use other ways to achieve this functionality,) you should <em>not</em> re-open classes, but <a href=\"https://ruby-doc.org/core/Module.html#method-i-prepend\" rel=\"nofollow noreferrer\"><code>Module#prepend</code></a> a module with the requested functionality instead:</p>\n\n<pre><code>String.prepend(Module.new do\n  def uppercase!\n    self.replace upcase\n  end\nend)\n\nstr = \"hello\"\nstr.uppercase!\n#\u21d2 \"HELLO\"\nstr\n#\u21d2 \"HELLO\"\n</code></pre>\n\n<p>If the method to be overwritten existed in the class, it might still be accessed with a call to <code>super</code> from inside the module method.</p>\n"}], "owner": {"reputation": 109, "user_id": 7153036, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/7e4747a3d45124fa030df5c11f223986?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Marshle", "link": "https://stackoverflow.com/users/7153036/tony-marshle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 47286066, "answer_count": 3, "score": 1, "last_activity_date": 1510664212, "creation_date": 1510662457, "question_id": 47285908, "link": "https://stackoverflow.com/questions/47285908/adding-custom-methods-to-standard-ruby-objects", "title": "Adding custom methods to standard ruby objects", "body": "<p>How can I add custom methods to standard ruby objects, such as strings and integers?</p>\n\n<p>I have seen this in, for example, rails, and the mojinizer library for ruby that can convert a romaji string into hiragana, as in</p>\n\n<pre><code>\"tsukue\".hiragana #=&gt; \"\u3064\u304f\u3048\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1510662828, "post_id": 47285787, "comment_id": 81521736, "body": "<a href=\"https://github.com/GlobalNamesArchitecture/damerau-levenshtein\" rel=\"nofollow noreferrer\">github.com/GlobalNamesArchitecture/damerau-levenshtein</a> and/or Google by \u201cDamerau-Levenstein distance\u201d and \u201cJaro-Winkler distance.\u201d"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8938603"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510663005, "post_id": 47285787, "comment_id": 81521859, "body": "@max as I said I am fairly new but I will look more into that"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510663196, "post_id": 47285787, "comment_id": 81522000, "body": "What you are looking for is something like the levenshtein distance which gives a number of the likeness betweeen two strings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8938603"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1510663399, "post_id": 47285787, "comment_id": 81522119, "body": "Not quite. I want to return feedback based on how close they are to guessing the correct random word. I dont want to use any kinds of APIs just standard Ruby features @max"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8938603"}, "edited": false, "score": 0, "creation_date": 1510664264, "post_id": 47286427, "comment_id": 81522727, "body": "Yes but close doesnt quite work @nattfodd. For instance if the word was hang and I typed in ngha then I would get   close, close, close, close"}, {"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1510664749, "post_id": 47286427, "comment_id": 81523054, "body": "So please specify - what behavior do you expect from &quot;close&quot; message to the letter?"}], "tags": [], "owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1510663986, "creation_date": 1510663986, "answer_id": 47286427, "question_id": 47285787, "link": "https://stackoverflow.com/questions/47285787/finding-letters-that-are-near-exact-or-not-in-a-user-input-string/47286427#47286427", "title": "Finding letters that are near, exact or not in a user input string", "body": "<p>Something like that:</p>\n\n<pre><code># Picking random word to guess\nword = ['open', 'real', 'hang', 'mice'].sample\n\nloop do\n  puts \"So, guess the word:\"\n\n  input_word = gets.strip\n  if word == input_word\n    puts(\"You are right, the word is: #{input_word}\")\n    break\n  end\n\n  puts \"You typed: #{input_word}\"\n\n  # Split both the word to guess and the suggested word into array of letters\n  word_in_letters  = word.split('')\n  input_in_letters = input_word.split('')\n\n  result = []\n  # Iterate over each letter in the word to guess\n  word_in_letters.each_with_index do |letter, index|\n    # Pick the corresponding letter in the entered word\n    letter_from_input = input_in_letters[index]\n\n    if letter == letter_from_input\n      result &lt;&lt; \"#{letter_from_input} - Correct\"\n      next\n    end\n\n    # Take nearby letters by nearby indexes\n    # `reject` is here to skip negative indexes\n    # ie: letter 'i' in a word \"mice\"\n    #   this will return 'm' and 'c'\n    # ie: letter 'm' in a word \"mice\"\n    #   this will return 'i'\n    letters_around =\n      [index - 1, index + 1]\n      .reject { |i| i &lt; 0 }\n      .map { |i| word_in_letters[i] }\n    if letters_around.include?(letter_from_input)\n      result &lt;&lt; \"#{letter_from_input} - Close\"\n      next\n    end\n\n    result &lt;&lt; \"#{letter_from_input} - Incorrect\"\n  end\n\n  puts result.join(\"\\n\")\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8938603"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510663986, "creation_date": 1510662127, "question_id": 47285787, "link": "https://stackoverflow.com/questions/47285787/finding-letters-that-are-near-exact-or-not-in-a-user-input-string", "title": "Finding letters that are near, exact or not in a user input string", "body": "<p>I am currently developing a small modified version of Hangman in Rails for children. The game starts by randomly generating a word from a text file and the user has to guess the word by entering a four letter word. Each word is the split by each character for example \"r\", \"e\", \"a\", \"l\" and returns a message on how they are to the word.</p>\n\n<p>Random Generated word is \"real\"</p>\n\n<p>Input \n   <code>rlax</code></p>\n\n<p>Output\n    <code>Correct, Close, Correct, Incorrect</code></p>\n\n<p>I have tried other things which I have found online but haven't worked and I am fairly new to Ruby and Rails. Hopefully someone can guide me in the right direction. </p>\n\n<p>Here is some code</p>\n\n<pre><code>def letterCheck(lookAtLetter)   \n  lookAHead = lookAtLetter =~ /[[:alpha:]]/ \nend \n\ndef displayWord         \n  $ranWordBool.each_index do |i|        \n      if($ranWordBool[i])           \n          print $ranWordArray[i]        \n          $isWin += 1                   \n      else\n          print \"_\"     \n      end               \n  end           \nend \n\ndef gameLoop            \n  turns = 10            \n  turnsLeft = 0     \n  lettersUsed = []  \n  while(turnsLeft &lt; turns)      \n     $isWin = 0                 \n     displayWord                    \n\n     if($isWin == $ranWordBool.length)          \n       system \"cls\"                         \n       puts \"1: Quit\"                           \n       puts \"The word is #{$ranWord} and You Win\"   \n       puts \"Press any key to continue\"     \n       return               \n     end            \n\n     print \"\\n\" + \"Words Used: \"            \n     lettersUsed.each_index do |looper|     \n     print \" #{lettersUsed[looper]} \"   \n     end                    \n     puts \"\\n\" + \"Turns left: #{turns - turnsLeft}\" \n\n     puts \"Enter a word\"        \n     input = gets.chomp         \n     system \"cls\"   \n\n     if(input.length != 4)  \n       puts \"Please enter 4 lettered word\"\n     elsif(letterCheck(input))  \n       if(lettersUsed.include?(input))  \n         puts \"#{input} already choosen\"    \n         elsif($ranWordArray.include?(input))\n           puts \"Close\"\n           $ranWordArray.each_index do |i|  \n             if(input == $ranWordArray[i])\n               $ranWordBool[i] = true   \n             end    \n             if($ranWordBool[i] = true)\n               puts \"Correct\"\n             else\n               puts \"Incorrect\"\n             end\n           end          \n          else\n            lettersUsed &lt;&lt; input        \n            turnsLeft += 1          \n          end                   \n          else\n            puts \"Not a letter\"     \n          end                       \n        end                         \n        puts \"You lose\"             \n        puts \"The word was #{$ranWord}\"     \n        puts \"Press any key to continue\"    \n      end           \n\n      words = []            \n      File.foreach('words.txt') do |line|       \n      words &lt;&lt; line.chomp               \n      end           \n\n      while(true)\n        $ranWord = words[rand(words.length) + 1]    \n        $ranWordArray = $ranWord.chars          \n        $ranWordBool = []                           \n        $ranWordArray.each_index do |i|             \n        $ranWordBool[i] = false         \n      end           \n\n      system \"cls\"          \n      gameLoop\n      input = gets.chomp\n      shouldQuit(input) \n    end \n</code></pre>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ajax", "twitter-bootstrap"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1510667054, "post_id": 47283762, "comment_id": 81524731, "body": "Let me know for further guidance."}], "answers": [{"tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 0, "last_activity_date": 1510666912, "creation_date": 1510666912, "answer_id": 47287350, "question_id": 47283762, "link": "https://stackoverflow.com/questions/47283762/actioncontrollerunknownformat-on-ajax-with-remote-true/47287350#47287350", "title": "ActionController::UnknownFormat on AJAX with remote true", "body": "<p>routes.rb</p>\n\n<pre><code>match '/show_modal' =&gt; 'blocked_phone_numbers#show_modal', as: 'show_modal', via: [:get, :post]\n</code></pre>\n\n<p>index.html.erb</p>\n\n<pre><code>...\n\n&lt;%= link_to show_modal_path(blocked_phone_numbers_group_id: blocked_phone_numbers_groups.id), class: 'btn btn-primary btn-xs', method: :post, :remote =&gt; true do%&gt;\n  &lt;i class='fa fa-upload'&gt;&lt;/i%&gt;\n&lt;%end%&gt; \n\n...\n\n&lt;div id=\"modalImportNumbers\"&gt;\n  &lt;%= render partial: 'show_modal' %&gt;\n&lt;/div&gt;\n\n...\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 5116594, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh4.googleusercontent.com/-Ob3rOxk9fNE/AAAAAAAAAAI/AAAAAAAAFt0/Ck6S9PpM8F8/photo.jpg?sz=128", "display_name": "Raphael Telatim", "link": "https://stackoverflow.com/users/5116594/raphael-telatim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510666912, "creation_date": 1510656531, "last_edit_date": 1510658342, "question_id": 47283762, "link": "https://stackoverflow.com/questions/47283762/actioncontrollerunknownformat-on-ajax-with-remote-true", "title": "ActionController::UnknownFormat on AJAX with remote true", "body": "<p>I'm trying to open a Bootstrap modal trough remote true calls, cause I need to passa some params to modal.</p>\n\n<p>So, I have this code:</p>\n\n<p>index.html</p>\n\n<pre><code>...\n\n&lt;%= link_to(\"&lt;i class='fa fa-upload'&gt;&lt;/i&gt;\".html_safe, {:controller =&gt; :blocked_phone_numbers, :action =&gt; :show_modal, :blocked_phone_numbers_group_id =&gt; blocked_phone_numbers_groups.id}, :class =&gt; \"btn btn-primary btn-xs\", remote: true) %&gt;\n\n...\n\n&lt;div id=\"modalImportNumbers\"&gt;\n  &lt;%= render partial: 'show_modal' %&gt;\n&lt;/div&gt;\n\n...\n</code></pre>\n\n<p>blocked_phone_numbers_controller.rb</p>\n\n<pre><code>def show_modal   @blocked_phone_numbers_group = BlockedPhoneNumbersGroup.find(params[:blocked_phone_numbers_group_id]) respond_to do |format|\n    format.js   end end\n</code></pre>\n\n<p>show_modal.js.erb</p>\n\n<pre><code>$('#modalImportNumbers').html(\"&lt;%= j render partial: 'show_modal' %&gt;\");\n$('#modalImportar').modal('show');\n</code></pre>\n\n<p>_show_modal.html.erb</p>\n\n<pre><code>&lt;div id=\"modalImportar\" class=\"modal fade\" role=\"dialog\"&gt;\n  &lt;div class=\"modal-dialog\"&gt;\n    &lt;!-- Modal content--&gt;\n    &lt;div class=\"modal-content\"&gt;\n      &lt;div class=\"modal-header\" style=\"background-color: #5a4371; color: #fff\"&gt;\n        &lt;button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"&gt;\n          &lt;span aria-hidden=\"true\"&gt;&amp;times;&lt;/span&gt;\n        &lt;/button&gt;\n        &lt;h4 class=\"modal-title\" id=\"modalLabel\"&gt;&lt;%= t(:item_7) %&gt;&lt;/h4&gt;\n      &lt;/div&gt;\n      &lt;div class=\"row\"&gt;\n        &lt;div class=\"col-xs-12 col-md-12 col-md-offset-0\"&gt;\n          &lt;div class=\"modal-body\"&gt;\n\n            &lt;%= form_tag({:action =&gt; \"import\"}, {:multipart =&gt; true}) do |form| %&gt;\n\n              ...\n\n            &lt;% end %&gt;\n\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  root 'login#index'\n\n  match ':controller(/:action(/:id))(.:format)', via: [:get, :post]\nend\n</code></pre>\n\n<p>The problem is that I keep getting this error:</p>\n\n<p>ActionController::UnknownFormat (ActionController::UnknownFormat):</p>\n\n<p>app/controllers/blocked_phone_numbers_controller.rb:25:in `show_modal'</p>\n\n<p>NameError: uninitialized constant Mime::HTML</p>\n\n<p>I have jQuery import on my application.js, so, I read about in many threads here but I cant figure out what is happening.</p>\n\n<p>Someone could help me understand this error, please?</p>\n\n<p>I'm using Rails 5.1 and Bootstrap 3.7</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "variables", "variable-assignment", "operator-keyword"], "comments": [{"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 2, "creation_date": 1510652844, "post_id": 47282375, "comment_id": 81515050, "body": "<code>if x #{z} y</code> is the same as <code>if x</code> because <code>#</code> introduces an end-of-line comment in Ruby."}, {"owner": {"reputation": 3, "user_id": 1562366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349dfb6c5d1a806f19556c342c2b9eb7?s=128&d=identicon&r=PG", "display_name": "Dheeraj Gupta", "link": "https://stackoverflow.com/users/1562366/dheeraj-gupta"}, "reply_to_user": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1510652943, "post_id": 47282375, "comment_id": 81515129, "body": "ok any way to evaluate z as operator."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1510652978, "post_id": 47282375, "comment_id": 81515154, "body": "Can you please remove the irb-prompts (the `1.9.3-p429 :091 etc) as it is of no use and only makes your code harder to read and does not allow users to work with it using only a copy/paste."}, {"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1510653048, "post_id": 47282375, "comment_id": 81515205, "body": "You can try to use <a href=\"https://ruby-doc.org/core-2.4.2/Kernel.html#method-i-eval\" rel=\"nofollow noreferrer\"><code>Kernel#eval</code></a>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1510653790, "post_id": 47282375, "comment_id": 81515731, "body": "@DheerajGupta I&#39;m curious, what are you trying to do? Why do you have the operator as a string?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1510654247, "post_id": 47282375, "comment_id": 81516038, "body": "@Stefan: implementing simple calculator / formula evaluator? &#175;\\_(\u30c4)_/&#175;"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1510655287, "post_id": 47282375, "comment_id": 81516739, "body": "Note you can only interpolate within a double-quoted string or regex."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "edited": false, "score": 0, "creation_date": 1510664462, "post_id": 47282375, "comment_id": 81522873, "body": "It might be overkill but you could try creating an <a href=\"https://stackoverflow.com/a/43429202/7324619\">infix operator</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1510653332, "post_id": 47282499, "comment_id": 81515407, "body": "Nice, though it may be prudent to recommend <code>public_send</code> instead."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1510653561, "post_id": 47282499, "comment_id": 81515563, "body": "Also worth noting that <code>x.public_send(z, y)</code> alone returns <code>true </code> so if only the boolean is required then the if-expression is not."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1510654106, "post_id": 47282499, "comment_id": 81515944, "body": "Sure, I just wanted recreate the user example"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 7, "last_activity_date": 1510654120, "last_edit_date": 1510654120, "creation_date": 1510653099, "answer_id": 47282499, "question_id": 47282375, "link": "https://stackoverflow.com/questions/47282375/if-statement-operator-as-a-variable-in-ruby/47282499#47282499", "title": "If statement operator as a variable in ruby", "body": "<p>Try this one</p>\n\n<pre><code>x = 0\ny = 1\nz = \"!=\"\n\nx.public_send(z, y)\n=&gt; true\n</code></pre>\n\n<p>The trick here is know that <code>3 &gt;= 5</code> is syntactic sugar for <code>3.&gt;=(5)</code></p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1510660395, "post_id": 47283265, "comment_id": 81520144, "body": "btw, no need to interpolate the x and y into the string. :)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1510661199, "post_id": 47283265, "comment_id": 81520688, "body": "heh... I did it that way originally, then doubted myself and &quot;corrected&quot; it. I&#39;ll revert that change :)"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 4, "last_activity_date": 1510661215, "last_edit_date": 1510661215, "creation_date": 1510655090, "answer_id": 47283265, "question_id": 47282375, "link": "https://stackoverflow.com/questions/47282375/if-statement-operator-as-a-variable-in-ruby/47283265#47283265", "title": "If statement operator as a variable in ruby", "body": "<p>To reiterate the answer above, I'd suggest using <code>send</code>.</p>\n\n<p>However, it <em>is</em> possible to write the code in your original style - you just need to <a href=\"https://ruby-doc.org/core/Kernel.html#method-i-eval\" rel=\"nofollow noreferrer\"><code>eval</code></a> (i.e. execute) it:</p>\n\n<pre><code>x = 0\ny = 1\nz = \"!=\"\n\nif eval(\"x #{z} y\")\n  puts \"True\"\nend\n</code></pre>\n\n<p>Generally speaking, the use of <code>eval</code> is strongly discouraged. It can lead to major security issues (e.g. if you're evaluating arbitrary user input!), and is quite a slow operation.</p>\n"}], "owner": {"reputation": 3, "user_id": 1562366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349dfb6c5d1a806f19556c342c2b9eb7?s=128&d=identicon&r=PG", "display_name": "Dheeraj Gupta", "link": "https://stackoverflow.com/users/1562366/dheeraj-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1510661215, "creation_date": 1510652730, "last_edit_date": 1510654917, "question_id": 47282375, "link": "https://stackoverflow.com/questions/47282375/if-statement-operator-as-a-variable-in-ruby", "title": "If statement operator as a variable in ruby", "body": "<p>I am trying to do something like this in ruby:</p>\n\n<pre><code>x = 0\ny = 1\nz = \"!=\"\n\nif x #{z} y\n  puts \"True\"\nend\n#True\n#=&gt; nil\n\nx = 1\nif x #{z} y\n  puts \"True\"\nend\n#True\n#=&gt; nil\n</code></pre>\n\n<p>Using a operator as a variable is not evaluating the expression. Any way to do this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authentication", "google-authentication"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1510653395, "post_id": 47282311, "comment_id": 81515448, "body": "Have you tried using <code>ENV</code> instead?"}], "answers": [{"tags": [], "owner": {"reputation": 746, "user_id": 7028309, "user_type": "registered", "profile_image": "https://graph.facebook.com/1188395947872769/picture?type=large", "display_name": "Aakash Gupta", "link": "https://stackoverflow.com/users/7028309/aakash-gupta"}, "is_accepted": true, "score": 4, "last_activity_date": 1588170407, "last_edit_date": 1588170407, "creation_date": 1510653922, "answer_id": 47282829, "question_id": 47282311, "link": "https://stackoverflow.com/questions/47282311/google-authentication-error-ruby-on-rails/47282829#47282829", "title": "Google Authentication error Ruby on Rails", "body": "<p>There is no <code>env</code> method available.\nInstead of this, use </p>\n\n<p><code>user = User.from_omniauth(request.env[\"omniauth.auth\"])</code> </p>\n\n<p>in your create method as <code>request.env[\"omniauth.auth\"]</code> object has the information sent by google after authentication of user to your application. </p>\n"}], "owner": {"reputation": 634, "user_id": 4788165, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/62bb9b2e30fa2f0d1b17a2353e97ecb9?s=128&d=identicon&r=PG&f=1", "display_name": "JOSEMAFUEN", "link": "https://stackoverflow.com/users/4788165/josemafuen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 47282829, "answer_count": 1, "score": 1, "last_activity_date": 1588170407, "creation_date": 1510652541, "question_id": 47282311, "link": "https://stackoverflow.com/questions/47282311/google-authentication-error-ruby-on-rails", "title": "Google Authentication error Ruby on Rails", "body": "<p>I'm trying to implement Google authentication on my Rails app but I'm having some trouble. </p>\n\n<p>Following <a href=\"https://richonrails.com/articles/google-authentication-in-ruby-on-rails/\" rel=\"nofollow noreferrer\">https://richonrails.com/articles/google-authentication-in-ruby-on-rails/</a>, I created my initializer with the keys I got from Google's developer console 'omniauth.rb'</p>\n\n<pre><code>OmniAuth.config.logger = Rails.logger\n\nRails.application.config.middleware.use OmniAuth::Builder do\n  provider :google_oauth2, '*****', '*****', {client_options: {ssl: {ca_file: Rails.root.join(\"cacert.pem\").to_s}}}\nend\n</code></pre>\n\n<p>I added some routes</p>\n\n<pre><code>  # GOOGLE AUTH\n  get 'auth/:provider/callback', to: 'sessions#create'\n  get 'auth/failure', to: redirect('/')\n  get 'signout', to: 'sessions#destroy', as: 'signout'\n</code></pre>\n\n<p>My sessions' create action</p>\n\n<pre><code>def create\n    user = User.from_omniauth(env[\"omniauth.auth\"])\n    sign_in user\n    flash[:success] = 'Logged in!'\n    redirect_to root_path\nend\n</code></pre>\n\n<p>And the <code>User.from_omniauth</code> method in user's model</p>\n\n<pre><code>def self.from_omniauth(auth)\n    where(provider: auth.provider, uid: auth.uid).first_or_initialize.tap do |user|\n      user.password = user.password_confirmation = user.password_digest =  SecureRandom.urlsafe_base64(n=6)\n      user.provider = auth.provider\n      user.uid = auth.uid\n      user.name = auth.info.name\n      user.oauth_token = auth.credentials.token\n      user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n      user.save!\n    end\n  end\n</code></pre>\n\n<p>I set a random password because I'm using also bcrypt authentication and it forces that every user has one password</p>\n\n<p>Lastly, in my view I have a button for login</p>\n\n<pre><code>= link_to \"Sign in with Google\", \"/auth/google_oauth2\", id: \"sign_in\", class: \"btn btn-primary\"\n</code></pre>\n\n<p>The problem is that it doesn't work, when I click it an error shows on sessions' create <code>user = User.from_omniauth(env[\"omniauth.auth\"])</code>:</p>\n\n<pre><code>NameError at /auth/google_oauth2/callback\nundefined local variable or method `env' for #&lt;SessionsController:0x956eb90&gt;\n</code></pre>\n\n<p>Other times it throws <code>SSL_connect SYSCALL returned=5 errno=0 state=SSLv2/v3 read server hello A (OpenSSL::SSL::SSLError)</code> in another line but I guess that's a different mistake.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1510680361, "post_id": 47282156, "comment_id": 81534041, "body": "So you want to get <code>paypal_credentials</code> hash by calling <code>customer_paypal_credentials</code>? Or if there is another field in table then <code>store_accessor :customer_paypal_credentials</code> not working?"}, {"owner": {"reputation": 917, "user_id": 7411621, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a37fcd6d889200d8721cf58a491e4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "taras", "link": "https://stackoverflow.com/users/7411621/taras"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1510735794, "post_id": 47282156, "comment_id": 81556710, "body": "@MartinZinovsky, no, I want to get <code>paypal_credentials -&gt; preapproval_key</code> by calling <code>preapproval_key</code> and to get <code>customer_paypal_credentials -&gt; preapproval_key</code> by calling, for example, <code>customer_preapproval_key</code> (if I could add prefix functionality somehow). But as I can see there is no way to do this."}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1510782248, "post_id": 47282156, "comment_id": 81586640, "body": "Did you consider to use custom getters?"}, {"owner": {"reputation": 917, "user_id": 7411621, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a37fcd6d889200d8721cf58a491e4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "taras", "link": "https://stackoverflow.com/users/7411621/taras"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1510826521, "post_id": 47282156, "comment_id": 81603993, "body": "@MartinZinovsky, there are too many keys in hstore fields:)"}], "answers": [{"tags": [], "owner": {"reputation": 17523, "user_id": 518204, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d3096adc28daa2f0b01cfbe5b90a37db?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/518204/fabio"}, "is_accepted": false, "score": 0, "last_activity_date": 1567616119, "creation_date": 1567616119, "answer_id": 57792833, "question_id": 47282156, "link": "https://stackoverflow.com/questions/47282156/multiple-store-accessors-with-identical-keys/57792833#57792833", "title": "Multiple store_accessors with identical keys", "body": "<p>This is possible in Rails 6 and above: <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Store.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/Store.html</a></p>\n\n<p>From the doc:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  store :settings, accessors: [ :color, :homepage ], coder: JSON\n  store :parent, accessors: [ :name ], coder: JSON, prefix: true\n  store :spouse, accessors: [ :name ], coder: JSON, prefix: :partner\n  store :settings, accessors: [ :two_factor_auth ], suffix: true\n  store :settings, accessors: [ :login_retry ], suffix: :config\nend\n</code></pre>\n"}], "owner": {"reputation": 917, "user_id": 7411621, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a37fcd6d889200d8721cf58a491e4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "taras", "link": "https://stackoverflow.com/users/7411621/taras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 467, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1567616119, "creation_date": 1510652122, "question_id": 47282156, "link": "https://stackoverflow.com/questions/47282156/multiple-store-accessors-with-identical-keys", "title": "Multiple store_accessors with identical keys", "body": "<p>I have model <code>Profile</code> with hstore field <code>paypal_credentials</code>:</p>\n\n<pre><code>class Profile &lt; ActiveRecord::Base\n  ...\n  store_accessor :paypal_credentials, :preapproval_key, :preapproval_url\n  ...\nend\n</code></pre>\n\n<p>Now I need to add the second hstore field named <code>customer_paypal_credentials</code> with identical keys. How can I use <code>store_accessor</code> in this way? I can't find anything about prefix/suffix functionality of <code>store_accessor</code>.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["javascript", "node.js", "ruby", "middleman", "zopfli"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1510652019, "post_id": 47280938, "comment_id": 81514451, "body": "And what if you run <code>node-zopfli</code> by hand? Does that work?"}], "owner": {"reputation": 11, "user_id": 8937425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49d412c46c966f118fdd05f15419c77?s=128&d=identicon&r=PG&f=1", "display_name": "FrontBoy", "link": "https://stackoverflow.com/users/8937425/frontboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510650951, "creation_date": 1510648164, "last_edit_date": 1510650951, "question_id": 47280938, "link": "https://stackoverflow.com/questions/47280938/run-zopfli-on-middleman-after-build", "title": "Run Zopfli on middleman after build", "body": "<p>We have a Middleman setup, and after is finishes parsing our assets, we want it to compress them using Zopfli.\nWe have tried adding a Node post-process, using the app.after_build hook, but when we run it, we get a 'run  node-zopfli from \".\"'\nThis is the code we have right now:</p>\n\n<pre><code>class MyCmd &lt; Middleman::Extension\n  def initialize(app, options_hash={}, &amp;block)\n    super\n    app.after_build do |builder|\n      builder.run 'node-zopfli';\n    end\n  end\nend\n\n::Middleman::Extensions.register(:my_cmd, MyCmd)\nactivate :my_cmd\n</code></pre>\n\n<p>We've tried looking for this error, or more information about using Zopfli, to no avail. Can someboddy help us get this right?\nThanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 60090, "user_id": 188031, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/p2YIF.jpg?s=128&g=1", "display_name": "tokland", "link": "https://stackoverflow.com/users/188031/tokland"}, "is_accepted": false, "score": 8, "last_activity_date": 1510686967, "last_edit_date": 1510686967, "creation_date": 1510648124, "answer_id": 47280926, "question_id": 47280895, "link": "https://stackoverflow.com/questions/47280895/ruby-hydrate-hash-values-from-array/47280926#47280926", "title": "Ruby : hydrate hash values from array", "body": "<pre><code>hash_with_values = hash.keys.zip(values).to_h\n</code></pre>\n\n<p>Note that in some (most?) languages, keys of hashes/maps are unordered, so that would not work. That was also the case for Ruby &lt; 1.9, but, from then on, they are guaranteed to be ordered (insertion order).</p>\n"}, {"comments": [{"owner": {"reputation": 2232, "user_id": 2595513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i1Q7t.png?s=128&g=1", "display_name": "bdavidxyz", "link": "https://stackoverflow.com/users/2595513/bdavidxyz"}, "edited": false, "score": 0, "creation_date": 1510655399, "post_id": 47282228, "comment_id": 81516827, "body": "Nice naming. transform_values is very clear about the intent."}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 4, "last_activity_date": 1510690910, "last_edit_date": 1510690910, "creation_date": 1510652322, "answer_id": 47282228, "question_id": 47280895, "link": "https://stackoverflow.com/questions/47280895/ruby-hydrate-hash-values-from-array/47282228#47282228", "title": "Ruby : hydrate hash values from array", "body": "<p>Since Ruby 2.4.0 you can do the following:</p>\n\n<pre><code>hash.transform_values.with_index { |v,i| values[i] }\n</code></pre>\n\n<p>Using <a href=\"http://ruby-doc.org/core-2.4.1/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\"><code>Hash#transform_values</code></a>, the intent is clear. Its dangerous counterpart <a href=\"http://ruby-doc.org/core-2.4.1/Hash.html#method-i-transform_values-21\" rel=\"nofollow noreferrer\"><code>Hash#transform_values!</code></a> is also available.</p>\n"}], "owner": {"reputation": 2232, "user_id": 2595513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i1Q7t.png?s=128&g=1", "display_name": "bdavidxyz", "link": "https://stackoverflow.com/users/2595513/bdavidxyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1510690910, "creation_date": 1510648007, "last_edit_date": 1510648254, "question_id": 47280895, "link": "https://stackoverflow.com/questions/47280895/ruby-hydrate-hash-values-from-array", "title": "Ruby : hydrate hash values from array", "body": "<p>Let's say I have an ruby array like this : </p>\n\n<pre><code>values = ['val_a', 'val_b',..., 'val_z'] # 26 values\n</code></pre>\n\n<p>And an hash with keys</p>\n\n<pre><code>hash = {a: nil, b: nil, ... , z: nil} # 26 keys\n</code></pre>\n\n<p>I know that the array is sorted, and I know that keys of hash are sorted, and I know both array and hash are of same size.</p>\n\n<p>How can I <strong>elegantly</strong> hydrate hash values so that I end up with</p>\n\n<pre><code>{a: 'val_a', b: 'val_b', ... , z: 'val_z'}\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "stripe-payments", "stripe.js"], "comments": [{"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1510650011, "post_id": 47279598, "comment_id": 81513165, "body": "we should solve this issue by reading together this posts <a href=\"https://stackoverflow.com/questions/8502307/chrome-18-how-to-allow-inline-scripting-with-a-content-security-policy#11672134\" title=\"chrome 18 how to allow inline scripting with a content security policy%2311672134\">stackoverflow.com/questions/8502307/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/35489518/stripe-checkout-css-content-policy-error\" title=\"stripe checkout css content policy error\">stackoverflow.com/questions/35489518/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8426, "user_id": 172651, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d9de81cb27ce70435bdc6418ef7df1c?s=128&d=identicon&r=PG", "display_name": "Evolve", "link": "https://stackoverflow.com/users/172651/evolve"}, "is_accepted": false, "score": 0, "last_activity_date": 1512008304, "creation_date": 1512008304, "answer_id": 47564856, "question_id": 47279598, "link": "https://stackoverflow.com/questions/47279598/ruby-on-rails-stripe-js-elements-causing-content-security-policy-error/47564856#47564856", "title": "Ruby on Rails: Stripe JS &amp; Elements causing Content Security Policy error", "body": "<p>I solved this today by upgrading secure_headers gem from v3 to the latest v5 and my illogical CSP errors went away.</p>\n"}], "owner": {"reputation": 3065, "user_id": 756148, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/c8B6m.jpg?s=128&g=1", "display_name": "Anders", "link": "https://stackoverflow.com/users/756148/anders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 824, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1512008304, "creation_date": 1510643106, "question_id": 47279598, "link": "https://stackoverflow.com/questions/47279598/ruby-on-rails-stripe-js-elements-causing-content-security-policy-error", "title": "Ruby on Rails: Stripe JS &amp; Elements causing Content Security Policy error", "body": "<p>I'm working on a Ruby on Rails app where I'm planning to integrate Stripe payments. I'm using the <code>stripe</code> gem. I'm planning to use Elements, as <a href=\"https://stripe.com/docs/stripe-js\" rel=\"nofollow noreferrer\">described here</a>.</p>\n\n<p>I'm including Stripe js like this:</p>\n\n<pre><code>= javascript_include_tag 'https://js.stripe.com/v3/'\n</code></pre>\n\n<p>In my <code>charges.coffee</code> file I have this:</p>\n\n<pre><code>$(document).on 'turbolinks:load', -&gt;\n  stripe = Stripe(\"&lt;%= Rails.application.secrets['STRIPE_PUBLISHABLE_KEY'] %&gt;\")\n  elements = stripe.elements()\n</code></pre>\n\n<p>When I load the app I currently get the following error in Safari:</p>\n\n<p><code>Refused to execute a script because its hash, its nonce, or 'unsafe-inline' does not appear in the script-src directive of the Content Security Policy.</code></p>\n\n<p>Any ideas on what I can do to solve this issue?</p>\n"}, {"tags": ["ruby", "chef-infra"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1510641375, "post_id": 47278865, "comment_id": 81508747, "body": "This kind of questions is an offtopic here. SO <b>is not</b> a service where people write code for you for free."}, {"owner": {"reputation": 197, "user_id": 6482719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fd504f893ebb2c5320ee288daad9a533?s=128&d=identicon&r=PG&f=1", "display_name": "hlesnt395", "link": "https://stackoverflow.com/users/6482719/hlesnt395"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1510642005, "post_id": 47278865, "comment_id": 81509025, "body": "You don&#39;t need to write code for me. simply give the hint that&#39;s it!. else skip it"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 6482719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fd504f893ebb2c5320ee288daad9a533?s=128&d=identicon&r=PG&f=1", "display_name": "hlesnt395", "link": "https://stackoverflow.com/users/6482719/hlesnt395"}, "edited": false, "score": 0, "creation_date": 1510642019, "post_id": 47279143, "comment_id": 81509034, "body": "Thanks a lot. will check and confirm you."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1510642627, "last_edit_date": 1510642627, "creation_date": 1510641402, "answer_id": 47279143, "question_id": 47278865, "link": "https://stackoverflow.com/questions/47278865/find-the-content-and-increment-value-from-ruby/47279143#47279143", "title": "Find the content and increment value from Ruby", "body": "<pre><code>*others, last = \"1.39.25.1\".split(\".\")\n[*others, last.next].join(\".\")\n# =&gt; \"1.39.25.2\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 1, "last_activity_date": 1510646807, "creation_date": 1510646807, "answer_id": 47280554, "question_id": 47278865, "link": "https://stackoverflow.com/questions/47278865/find-the-content-and-increment-value-from-ruby/47280554#47280554", "title": "Find the content and increment value from Ruby", "body": "<p>String#succ is a quick and easy way:</p>\n\n<pre><code>\"1.39.25.1\".succ  #=&gt; \"1.39.25.2\"\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 6482719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fd504f893ebb2c5320ee288daad9a533?s=128&d=identicon&r=PG&f=1", "display_name": "hlesnt395", "link": "https://stackoverflow.com/users/6482719/hlesnt395"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1510646807, "creation_date": 1510640226, "question_id": 47278865, "link": "https://stackoverflow.com/questions/47278865/find-the-content-and-increment-value-from-ruby", "title": "Find the content and increment value from Ruby", "body": "<p>I have json file which contains following peace of lines.\nI need to find and increment the last number \"1.39.25.1\" like 1.39.25.2, 1.39.25.3 so on by a ruby code.</p>\n\n<pre><code>    \"appVersion\": {\n    \"buildFlavour\": \"varation\",\n    \"customisation\": \"MY.VER.NUM\",\n    \"version\": \"1.39.25.1\"\n},\n</code></pre>\n\n<p>Please help on this</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "decimal"], "comments": [{"owner": {"reputation": 1132, "user_id": 1154044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b042060fc12ff39b4fbe94dcec7d8598?s=128&d=identicon&r=PG", "display_name": "cnnr", "link": "https://stackoverflow.com/users/1154044/cnnr"}, "edited": false, "score": 0, "creation_date": 1510639225, "post_id": 47278491, "comment_id": 81507957, "body": "Better way for critical numeric data handling is store them as <code>decimal</code> type at database level."}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 1132, "user_id": 1154044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b042060fc12ff39b4fbe94dcec7d8598?s=128&d=identicon&r=PG", "display_name": "cnnr", "link": "https://stackoverflow.com/users/1154044/cnnr"}, "edited": false, "score": 0, "creation_date": 1510639482, "post_id": 47278491, "comment_id": 81508042, "body": "I don&#39;t need to save it to db and I&#39;m not dealing with <code>ActiveRecord</code> in my case."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1510639671, "post_id": 47278491, "comment_id": 81508097, "body": "Cannot be reproduced. Gives TypeError: no implicit conversion of Hash into String."}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1510640015, "post_id": 47278491, "comment_id": 81508227, "body": "@sawa Rails version = 4.2.4 &amp; Ruby version = 2.3.0"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1510640085, "post_id": 47278491, "comment_id": 81508257, "body": "That is irrelevant."}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1510640507, "post_id": 47278491, "comment_id": 81508398, "body": "@sawa Actually I&#39;m unable to reproduce what you&#39;ve got &#39;TypeError: no implicit conversion of Hash into String&#39;"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1510640827, "post_id": 47278491, "comment_id": 81508508, "body": "It is the expected behaviour."}, {"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1510644169, "post_id": 47278491, "comment_id": 81510091, "body": "@sawa response body is possibly a string, and Moamen passing this one to JSON.parse. You are passing hash to JSON.parse so it raises TypeError."}, {"owner": {"reputation": 1743, "user_id": 4308435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vgr6X.jpg?s=128&g=1", "display_name": "Nikita Misharin", "link": "https://stackoverflow.com/users/4308435/nikita-misharin"}, "edited": false, "score": 0, "creation_date": 1510644270, "post_id": 47278491, "comment_id": 81510138, "body": "@MoamenNaanou can you please double check the response line you&#39;ve posted. You&#39;ve posted ruby hash, not json"}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 1743, "user_id": 4308435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vgr6X.jpg?s=128&g=1", "display_name": "Nikita Misharin", "link": "https://stackoverflow.com/users/4308435/nikita-misharin"}, "edited": false, "score": 0, "creation_date": 1510644656, "post_id": 47278491, "comment_id": 81510320, "body": "@NikitaMisharin and sawa thanks you are correct, In my question I&#39;m passing hash (my mistake), that was only to simplify my question, now it is updated to original response."}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1510644797, "post_id": 47278491, "comment_id": 81510386, "body": "@sawa now I know why I was unable to reproduce your error :)"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 1, "creation_date": 1510644914, "post_id": 47278491, "comment_id": 81510455, "body": "@marmeladze Exactly. I am passing exactly what the OP wrote, and reporting that result."}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1510645668, "post_id": 47278491, "comment_id": 81510862, "body": "@sawa but the issue of decimal precision is not solved"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1510645768, "post_id": 47278491, "comment_id": 81510915, "body": "Of course not. The code you claiming to be using to parse it is not even ruby code."}], "answers": [{"comments": [{"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "edited": false, "score": 0, "creation_date": 1510648953, "post_id": 47280854, "comment_id": 81512538, "body": "Your answer is very close as a temporary fix, thanks, but the result number after gsub is different number."}, {"owner": {"reputation": 1743, "user_id": 4308435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vgr6X.jpg?s=128&g=1", "display_name": "Nikita Misharin", "link": "https://stackoverflow.com/users/4308435/nikita-misharin"}, "reply_to_user": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "edited": false, "score": 0, "creation_date": 1510649242, "post_id": 47280854, "comment_id": 81512699, "body": "@MoamenNaanou Sorry, what you mean different number?"}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "edited": false, "score": 0, "creation_date": 1510649670, "post_id": 47280854, "comment_id": 81512930, "body": "I&#39;m shocked now, first time I implement your fix, I got <code>&quot;{\\&quot;price\\&quot;:\\&quot;47.9390070000\\&quot;}&quot;</code> as a value of <code>transformed_response</code> but now again I did exactly the same and I got <code>&quot;{\\&quot;price\\&quot;:\\&quot;39.7400000000000019895196601282805204391479492&zwnj;&#8203;1875\\&quot;}&quot;</code> so thanks a lot"}, {"owner": {"reputation": 1743, "user_id": 4308435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vgr6X.jpg?s=128&g=1", "display_name": "Nikita Misharin", "link": "https://stackoverflow.com/users/4308435/nikita-misharin"}, "reply_to_user": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "edited": false, "score": 0, "creation_date": 1510651081, "post_id": 47280854, "comment_id": 81513836, "body": "@MoamenNaanou I know why it didn&#39;t work the first time. I&#39;ve updated the answer, please use the updated version"}], "tags": [], "owner": {"reputation": 1743, "user_id": 4308435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vgr6X.jpg?s=128&g=1", "display_name": "Nikita Misharin", "link": "https://stackoverflow.com/users/4308435/nikita-misharin"}, "is_accepted": true, "score": 1, "last_activity_date": 1510651043, "last_edit_date": 1510651043, "creation_date": 1510647853, "answer_id": 47280854, "question_id": 47278491, "link": "https://stackoverflow.com/questions/47278491/change-default-decimal-numbers-parsing-behavior/47280854#47280854", "title": "Change default decimal numbers parsing behavior", "body": "<p>The solution is a hack really, but I couldn't find any better</p>\n\n<pre><code>response = \"{\\\"price\\\":39.74000000000000198951966012828052043914794921875}\"\ntransformed_response = response.gsub(/\\d+\\.\\d+/, '\"\\&amp;\"')\nhash = JSON.parse(transformed_response , symboize_names: true})\n</code></pre>\n\n<p>The resulting <code>hash</code> will be</p>\n\n<pre><code>{ price: \"39.74000000000000198951966012828052043914794921875\" }\n</code></pre>\n\n<p>With which you can do something like this</p>\n\n<pre><code>hash.tap { |hash| hash[:price] = BigDecimal.new(hash[:price]) } \n</code></pre>\n"}], "owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 47280854, "answer_count": 1, "score": 1, "last_activity_date": 1510651043, "creation_date": 1510638363, "last_edit_date": 1510644547, "question_id": 47278491, "link": "https://stackoverflow.com/questions/47278491/change-default-decimal-numbers-parsing-behavior", "title": "Change default decimal numbers parsing behavior", "body": "<p>I am getting the following response of a web service call:</p>\n\n<pre><code>response = \"{\\\"price\\\":39.74000000000000198951966012828052043914794921875}\"\n</code></pre>\n\n<p>Then I'm parsing it:</p>\n\n<pre><code>json = JSON.parse(response, {:symboize_names: true})\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>json = {price: 39.74}\n</code></pre>\n\n<p>Then I tried from Rails console to check if it is happening because of <code>JSON</code> library, but simply I got the following result:</p>\n\n<pre><code>&gt;&gt; data = {:price =&gt; 39.74000000000000198951966012828052043914794921875}\n{:price=&gt;39.74}\n</code></pre>\n\n<p>So it's default behavior in Rails and I need to change it (<em>on application level</em>) to always parse decimal numbers as <code>BigDecimal</code> instead of <code>float</code>.</p>\n\n<p><strong>Ruby = 2.3.0</strong></p>\n\n<p><strong>Rails = 4.2.4</strong></p>\n\n<p>Can anybody help?</p>\n"}, {"tags": ["ruby", "macos", "vim", "macos-high-sierra"], "comments": [{"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 3, "creation_date": 1510639063, "post_id": 47278449, "comment_id": 81507889, "body": "You could try changing the dyld to the new one in the Vim binary with <code>install_name_tool</code>..."}, {"owner": {"reputation": 641, "user_id": 2960993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4651f3ad6e518f8edf7f20336160c85?s=128&d=identicon&r=PG&f=1", "display_name": "user2960993", "link": "https://stackoverflow.com/users/2960993/user2960993"}, "reply_to_user": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 1, "creation_date": 1510639672, "post_id": 47278449, "comment_id": 81508098, "body": "Thank you very much. It solved my problem."}, {"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1571367153, "post_id": 47278449, "comment_id": 103225659, "body": "<a href=\"https://github.com/macvim-dev/macvim/issues/952\" rel=\"nofollow noreferrer\">github.com/macvim-dev/macvim/issues/952</a>"}], "answers": [{"comments": [{"owner": {"reputation": 371, "user_id": 3919472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb0a5acaaca46a4b7abfa1c1f628fa95?s=128&d=identicon&r=PG&f=1", "display_name": "bduhbya", "link": "https://stackoverflow.com/users/3919472/bduhbya"}, "edited": false, "score": 0, "creation_date": 1510866120, "post_id": 47291135, "comment_id": 81630154, "body": "Did the trick for me as well.  Updating from GUI as suggested in other post did not work for me.  Thanks, Bruce!"}, {"owner": {"reputation": 1499, "user_id": 209557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0741fe85201c947ecc2cf6180a1d28bc?s=128&d=identicon&r=PG", "display_name": "smileart", "link": "https://stackoverflow.com/users/209557/smileart"}, "edited": false, "score": 1, "creation_date": 1511368599, "post_id": 47291135, "comment_id": 81834266, "body": "Yep, this one helped me as well! But, I should add that I also had to run GUI Xcode app itself at least once before installing vim, since it needed to install some additional components. See: <a href=\"https://github.com/macvim-dev/macvim/issues/546\" rel=\"nofollow noreferrer\">github.com/macvim-dev/macvim/issues/546</a>"}, {"owner": {"reputation": 2532, "user_id": 809198, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f9aa79f93a3c988f32b7fa40d097c6be?s=128&d=identicon&r=PG", "display_name": "Chris Townsend", "link": "https://stackoverflow.com/users/809198/chris-townsend"}, "edited": false, "score": 3, "creation_date": 1517522621, "post_id": 47291135, "comment_id": 84141758, "body": "This works for <code>vim</code> too, if one insn&#39;t using <code>macvim</code>."}, {"owner": {"reputation": 547, "user_id": 316622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa0468abfed43c541f16addc3b9fd75?s=128&d=identicon&r=PG", "display_name": "Skrat", "link": "https://stackoverflow.com/users/316622/skrat"}, "edited": false, "score": 5, "creation_date": 1549993701, "post_id": 47291135, "comment_id": 96103320, "body": "In the entire history of the git source for <code>brew</code> I can&#39;t find mention of a <code>--purge</code> option. Did you mean <code>--force</code>?"}, {"owner": {"reputation": 1635, "user_id": 839369, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/512602658a3e6b75967b5e7be37d8344?s=128&d=identicon&r=PG", "display_name": "Bruce Edge", "link": "https://stackoverflow.com/users/839369/bruce-edge"}, "reply_to_user": {"reputation": 547, "user_id": 316622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa0468abfed43c541f16addc3b9fd75?s=128&d=identicon&r=PG", "display_name": "Skrat", "link": "https://stackoverflow.com/users/316622/skrat"}, "edited": false, "score": 0, "creation_date": 1610063270, "post_id": 47291135, "comment_id": 116021709, "body": "Um, yep, must have been. (--force) Many apologies. @skrat"}], "tags": [], "owner": {"reputation": 1635, "user_id": 839369, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/512602658a3e6b75967b5e7be37d8344?s=128&d=identicon&r=PG", "display_name": "Bruce Edge", "link": "https://stackoverflow.com/users/839369/bruce-edge"}, "is_accepted": false, "score": 32, "last_activity_date": 1513798430, "last_edit_date": 1513798430, "creation_date": 1510678253, "answer_id": 47291135, "question_id": 47278449, "link": "https://stackoverflow.com/questions/47278449/vim-ruby-mismatch-on-mac-high-sierra/47291135#47291135", "title": "vim ruby mismatch on Mac High Sierra", "body": "<p>This worked for me. YMMV\n<code>\nbrew uninstall --purge macvim\nbrew install macvim\n</code></p>\n\n<p>[amended] Regarding the <code>upgrade</code> alone option, that may work if you don't have the current version already. The <code>--purge</code> forces a removal and complete reinstall. \nAlso, the <code>build from source</code> option, while it may work, you now own your own mac-vim static snapshot and need to maintain it manually as the app evolves. \nI'd avoid building from source unless you have very specific needs.</p>\n"}, {"tags": [], "owner": {"reputation": 804, "user_id": 1096533, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ccb0209de56b400cc7f063eb0425e18f?s=128&d=identicon&r=PG", "display_name": "radical_edo", "link": "https://stackoverflow.com/users/1096533/radical-edo"}, "is_accepted": false, "score": 1, "last_activity_date": 1510844712, "creation_date": 1510844712, "answer_id": 47332975, "question_id": 47278449, "link": "https://stackoverflow.com/questions/47278449/vim-ruby-mismatch-on-mac-high-sierra/47332975#47332975", "title": "vim ruby mismatch on Mac High Sierra", "body": "<p>Tried to use <code>brew upgrade macvim</code> an error was raised and the failed. What worked for me is to open the <code>MacVim</code> in a normal window (not a iTerm or terminal) the graphic version noticed that a newer version is available and asked if I want to update. Clicked <code>yes, please</code> and done. <code>macvim</code> in terminal or iTerm works just fine (as well as the \"window\" version).</p>\n"}, {"tags": [], "owner": {"reputation": 740, "user_id": 1600444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eadbb6214ec21c520e625aaa0df08003?s=128&d=identicon&r=PG", "display_name": "Guido", "link": "https://stackoverflow.com/users/1600444/guido"}, "is_accepted": false, "score": 7, "last_activity_date": 1511430192, "creation_date": 1511430192, "answer_id": 47452205, "question_id": 47278449, "link": "https://stackoverflow.com/questions/47278449/vim-ruby-mismatch-on-mac-high-sierra/47452205#47452205", "title": "vim ruby mismatch on Mac High Sierra", "body": "<p>This worked for me:</p>\n\n<pre><code>$ brew update\n\n$ brew upgrade macvim\n</code></pre>\n\n<p>actual command output:</p>\n\n<pre><code>[bin]$ brew upgrade macvim\n==&gt; Upgrading 1 outdated package, with result:\nmacvim 8.0-142\n==&gt; Upgrading macvim --with-override-system-vim\n==&gt; Downloading https://github.com/macvim-dev/macvim/archive/snapshot-142.tar.gz\n==&gt; Downloading from https://codeload.github.com/macvim-dev/macvim/tar.gz/snapshot-142\n######################################################################## 100,0%\n==&gt; ./configure --with-features=huge --enable-multibyte --with-macarchs=x86_64 --enable-perlinterp --enable-rubyinterp --enable-tclinterp --enable-ter\n==&gt; make\n\ud83c\udf7a  /usr/local/Cellar/macvim/8.0-142: 2,147 files, 34.2MB, built in 3 minutes 15 seconds\n[bin]$ \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 738, "user_id": 3902681, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000497258931/picture?type=large", "display_name": "Adrian Grzywaczewski", "link": "https://stackoverflow.com/users/3902681/adrian-grzywaczewski"}, "is_accepted": false, "score": 3, "last_activity_date": 1521156573, "creation_date": 1521156573, "answer_id": 49310920, "question_id": 47278449, "link": "https://stackoverflow.com/questions/47278449/vim-ruby-mismatch-on-mac-high-sierra/49310920#49310920", "title": "vim ruby mismatch on Mac High Sierra", "body": "<p>What helped in my case was:</p>\n\n<pre><code>brew link --overwrite vim\n</code></pre>\n\n<p>In your case, it might be useful to use the same command for MacVim</p>\n\n<pre><code>brew link --overwrite macvim\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 658, "user_id": 1319571, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/378ae7fb79ac07ef86b35977a169ab8e?s=128&d=identicon&r=PG", "display_name": "J Ellis", "link": "https://stackoverflow.com/users/1319571/j-ellis"}, "edited": false, "score": 0, "creation_date": 1524435966, "post_id": 49450569, "comment_id": 86958453, "body": "I was in the same situation with none of the other solutions working, but the install_name_tool worked for me, thank you!"}, {"owner": {"reputation": 795, "user_id": 305945, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/NPQaK.png?s=128&g=1", "display_name": "teleme.io", "link": "https://stackoverflow.com/users/305945/teleme-io"}, "edited": false, "score": 3, "creation_date": 1532320970, "post_id": 49450569, "comment_id": 89911606, "body": "After tried, I got this error: error: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeD&zwnj;&#8203;efault.xctoolchain/u&zwnj;&#8203;sr/bin/install_name_&zwnj;&#8203;tool: input file: /usr/local/Cellar/macvim/8.0-143/MacVim.app/Contents/bin/mvi&zwnj;&#8203;m is not a Mach-O file"}, {"owner": {"reputation": 147, "user_id": 4950642, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e496cb1edb0cbde88c19c1213e3ed0be?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Chanco", "link": "https://stackoverflow.com/users/4950642/juan-chanco"}, "edited": false, "score": 3, "creation_date": 1541165756, "post_id": 49450569, "comment_id": 93133555, "body": "This worked for me, but it was a slightly different binary location. <code>install_name_tool -change &#47;System&#47;Library&#47;Frameworks&#47;Ruby.framework&#47;Versions&#47;2.0&#47;usr&#47;l&zwnj;&#8203;ib&#47;libruby.2.0.0.dyl&zwnj;&#8203;ib &#47;System&#47;Library&#47;Frameworks&#47;Ruby.framework&#47;Versions&#47;2.3&#47;usr&#47;l&zwnj;&#8203;ib&#47;libruby.2.3.0.dyl&zwnj;&#8203;ib &#47;usr&#47;local&#47;Cellar&#47;macvim&#47;8.1-151&#47;MacVim.app&#47;Contents&#47;MacOS&#47;M&zwnj;&#8203;acVim</code> and <code>install_name_tool -change &#47;System&#47;Library&#47;Frameworks&#47;Ruby.framework&#47;Versions&#47;2.0&#47;usr&#47;l&zwnj;&#8203;ib&#47;libruby.2.0.0.dyl&zwnj;&#8203;ib &#47;System&#47;Library&#47;Frameworks&#47;Ruby.framework&#47;Versions&#47;2.3&#47;usr&#47;l&zwnj;&#8203;ib&#47;libruby.2.3.0.dyl&zwnj;&#8203;ib &#47;usr&#47;local&#47;Cellar&#47;macvim&#47;8.1-151&#47;MacVim.app&#47;Contents&#47;MacOS&#47;V&zwnj;&#8203;im</code>"}, {"owner": {"reputation": 6196, "user_id": 56333, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2fa8e97737b15bdb51a9b4ddbfa624ae?s=128&d=identicon&r=PG", "display_name": "abeger", "link": "https://stackoverflow.com/users/56333/abeger"}, "edited": false, "score": 2, "creation_date": 1541171374, "post_id": 49450569, "comment_id": 93136732, "body": "Important to note that <code>&#47;usr&#47;local&#47;bin&#47;vim</code> should be replaced with whatever the error says is the referencing file. In my case, it was <code>&#47;usr&#47;local&#47;Cellar&#47;macvim&#47;8.1-151&#47;MacVim.app&#47;Contents&#47;bin&#47;..&#47;&zwnj;&#8203;MacOS&#47;Vim</code>"}], "tags": [], "owner": {"reputation": 2992, "user_id": 3094459, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/074c4766f1e394edca8557608abdb5f2?s=128&d=identicon&r=PG&f=1", "display_name": "hequn8128", "link": "https://stackoverflow.com/users/3094459/hequn8128"}, "is_accepted": false, "score": 12, "last_activity_date": 1521811037, "creation_date": 1521811037, "answer_id": 49450569, "question_id": 47278449, "link": "https://stackoverflow.com/questions/47278449/vim-ruby-mismatch-on-mac-high-sierra/49450569#49450569", "title": "vim ruby mismatch on Mac High Sierra", "body": "<pre><code>\u279c  ~ vim\ndyld: Library not loaded: /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/libruby.2.0.0.dylib\n  Referenced from: /usr/local/bin/vim\n  Reason: image not found\n</code></pre>\n\n<p>I tried brew uninstall install update... All failed. And <code>install_name_tool</code> works for me. </p>\n\n<pre><code>install_name_tool -change /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/libruby.2.0.0.dylib /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/libruby.2.3.0.dylib /usr/local/bin/vim\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 656, "user_id": 971686, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e9bebc13a3180c07230fc6563bc3764b?s=128&d=identicon&r=PG", "display_name": "Anshul", "link": "https://stackoverflow.com/users/971686/anshul"}, "edited": false, "score": 3, "creation_date": 1541407155, "post_id": 49925616, "comment_id": 93192012, "body": "This worked with a minor difference. Instead of using <code>which vim</code>, use the path indicated in error. In my case, it was <code>&#47;usr&#47;local&#47;Cellar&#47;macvim&#47;8.1-151&#47;MacVim.app&#47;Contents&#47;bin&#47;..&#47;&zwnj;&#8203;MacOS&#47;Vim</code>"}], "tags": [], "owner": {"reputation": 511, "user_id": 5501810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bb8b95bff6e8a0331f0204f2cd8db8a?s=128&d=identicon&r=PG&f=1", "display_name": "John Zhang", "link": "https://stackoverflow.com/users/5501810/john-zhang"}, "is_accepted": false, "score": 14, "last_activity_date": 1546022068, "last_edit_date": 1546022068, "creation_date": 1524154093, "answer_id": 49925616, "question_id": 47278449, "link": "https://stackoverflow.com/questions/47278449/vim-ruby-mismatch-on-mac-high-sierra/49925616#49925616", "title": "vim ruby mismatch on Mac High Sierra", "body": "<p>First find where is the right libruby path, mine is: <code>/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/libruby.2.3.0.dylib</code></p>\n\n<p>It is common that the version has changed.</p>\n\n<p>Find out where the absolute path of vim is:</p>\n\n<pre><code>$ which vim\nvim: aliased to your-path-of-vim\n</code></pre>\n\n<p>change dyld:</p>\n\n<pre><code>sudo install_name_tool -change /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/libruby.2.0.0.dylib /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/libruby.2.3.0.dylib your-path-of-vim\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 2960993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4651f3ad6e518f8edf7f20336160c85?s=128&d=identicon&r=PG&f=1", "display_name": "user2960993", "link": "https://stackoverflow.com/users/2960993/user2960993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12642, "favorite_count": 5, "answer_count": 6, "score": 32, "last_activity_date": 1546022068, "creation_date": 1510638129, "last_edit_date": 1510640069, "question_id": 47278449, "link": "https://stackoverflow.com/questions/47278449/vim-ruby-mismatch-on-mac-high-sierra", "title": "vim ruby mismatch on Mac High Sierra", "body": "<p>I recently upgraded my Mac to <strong>High Sierra</strong></p>\n\n<p>After the upgrade, Macvim (mvim) stopped working because (I assume) HighSierra upgraded ruby to 2.3, and mvim is using ruby 2.0.</p>\n\n<p>Following is the error I am getting </p>\n\n<blockquote>\n  <p>dyld: Library not loaded:\n  /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/libruby.2.0.0.dylib</p>\n</blockquote>\n\n<p>Referenced from: <code>/usr/local/Cellar/macvim/8.0-134/MacVim.app/Contents/bin/../MacOS/Vim</code></p>\n\n<p>Do I need to compile vim again or is there any way to fix this problem?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["json", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1510633629, "post_id": 47277636, "comment_id": 81506262, "body": "&quot;AM I doing something wrong?&quot;...we don&#39;t know...we&#39;ll need to see an example of JSON that you&#39;re having trouble working with and the code you&#39;re using that isn&#39;t producing the correct results."}, {"owner": {"reputation": 23, "user_id": 8354772, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y4-XSv_1I0E/AAAAAAAAAAI/AAAAAAAAAEw/iajL3T_vq74/photo.jpg?sz=128", "display_name": "sirsnow", "link": "https://stackoverflow.com/users/8354772/sirsnow"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1510633746, "post_id": 47277636, "comment_id": 81506286, "body": "@SimpleLime That&#39;s the thing. It works on many, many other areas. I&#39;ve tried it in linters, validators, and JS. The only place it doesn&#39;t work is the Ruby gem."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1510637867, "post_id": 47277636, "comment_id": 81507492, "body": "&quot;Am I doing something wrong?&quot; Please leave a CODE SAMPLE. If your question is &quot;does Ruby parse valid JSON?&quot; then the answer is yes. If you would like someone to tell you why YOUR Ruby code doesn&#39;t work, then post YOUR RUBY CODE."}, {"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1510637880, "post_id": 47277636, "comment_id": 81507500, "body": "those lines you&#39;ve put is a candidate to be ruby hash. generally json strings are passed to <code>JSON.parse</code> to transform it to a hash object. you can however convert this hash to a string  - <code>you_hash.to_json</code>, then pass the outcome to <code>JSON.parse</code>. thus you&#39;ll see there will be no errors"}, {"owner": {"reputation": 23, "user_id": 8354772, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y4-XSv_1I0E/AAAAAAAAAAI/AAAAAAAAAEw/iajL3T_vq74/photo.jpg?sz=128", "display_name": "sirsnow", "link": "https://stackoverflow.com/users/8354772/sirsnow"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1510639009, "post_id": 47277636, "comment_id": 81507863, "body": "@marmeladze I used the to_json function."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1510641810, "post_id": 47277636, "comment_id": 81508930, "body": "set that hash equal to a variable <code>x</code>, then <code>JSON.parse x.to_json</code> works fine."}, {"owner": {"reputation": 23, "user_id": 8354772, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y4-XSv_1I0E/AAAAAAAAAAI/AAAAAAAAAEw/iajL3T_vq74/photo.jpg?sz=128", "display_name": "sirsnow", "link": "https://stackoverflow.com/users/8354772/sirsnow"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1510667383, "post_id": 47277636, "comment_id": 81524934, "body": "@maxpleaner It was already set to a variable called &quot;content&quot; and that&#39;s how I used the to_json function"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 8354772, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y4-XSv_1I0E/AAAAAAAAAAI/AAAAAAAAAEw/iajL3T_vq74/photo.jpg?sz=128", "display_name": "sirsnow", "link": "https://stackoverflow.com/users/8354772/sirsnow"}, "is_accepted": false, "score": 0, "last_activity_date": 1510877223, "creation_date": 1510877223, "answer_id": 47341219, "question_id": 47277636, "link": "https://stackoverflow.com/questions/47277636/json-default-ruby-library/47341219#47341219", "title": "JSON default Ruby library", "body": "<p>I figured out the problem. Turns out, there were no code issues, but the problem lied within the file encoding itself. I had it encoded in UTF-8, like most of my other files, and the default on my text editor. I converted the file to ASCII and it worked fine. Thanks for the help, though.</p>\n"}], "owner": {"reputation": 23, "user_id": 8354772, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y4-XSv_1I0E/AAAAAAAAAAI/AAAAAAAAAEw/iajL3T_vq74/photo.jpg?sz=128", "display_name": "sirsnow", "link": "https://stackoverflow.com/users/8354772/sirsnow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1510877223, "creation_date": 1510633392, "last_edit_date": 1510639083, "question_id": 47277636, "link": "https://stackoverflow.com/questions/47277636/json-default-ruby-library", "title": "JSON default Ruby library", "body": "<p>I have a bit of JSON code I'm using to make a Ruby app work. It checks out on most linters and validators (I haven't tried one where it doesn't work.)</p>\n\n<p>The thing is, though, the Ruby library for it doesn't work. I continue trying it, with different ways and tries, but it just won't load right. It gives me an unexpected token error. I'm just very confused, because it works on the other validators I've tried. Is the gem broken, or am I doing something wrong?</p>\n\n<p>Edit: The code being used is the JSON.parse method, after a to_json method from a file.read method. The content is being read straight from a file.</p>\n\n<p>Content:</p>\n\n<pre><code>{\n\"black\":{ \"id\":10, \"title\":\"Black Room\",\n\"desc\":\"You're in a large, black room filled with cobwebs.\",\n\"around\":[20, 30], \"items\":[], \"npcs\":[] },\n\n\"grey\":{ \"id\":20, \"title\":\"Grey Room\",\n\"desc\":\"You're in a fine, grey room filled with nothing all.\",\n\"around\":[10, 20], \"items\":[], \"npcs\":[] },\n\n\"white\":{ \"id\":30, \"title\":\"White Room\",\n\"desc\":\"You're in a small, white room filled with sunlight.\",\n\"around\":[10, 30], \"items\":[], \"npcs\":[] },\n\n\"null\":{ \"id\":0, \"title\":\"Null Room\",\n\"desc\":\"You shouldn't be in here... please leave.\",\n\"around\":[10, 20, 30], \"items\":[], \"npcs\":[] }\n}\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1510652749, "post_id": 47277544, "comment_id": 81514982, "body": "Use lowercase for variable names."}], "answers": [{"tags": [], "owner": {"reputation": 312231, "user_id": 2225682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4958f4712d94ab82fe55fa471308e4b5?s=128&d=identicon&r=PG", "display_name": "falsetru", "link": "https://stackoverflow.com/users/2225682/falsetru"}, "is_accepted": true, "score": 7, "last_activity_date": 1510637918, "last_edit_date": 1510637918, "creation_date": 1510633335, "answer_id": 47277629, "question_id": 47277544, "link": "https://stackoverflow.com/questions/47277544/combine-two-arrays-in-specific-order/47277629#47277629", "title": "Combine two arrays in specific order", "body": "<p>You can use <a href=\"https://ruby-doc.org/core/Array.html#method-i-zip\" rel=\"nofollow noreferrer\"><code>Array#zip</code></a> to get <code>[[A[0], B[0]], [A[1], B[1]], ...]</code></p>\n\n<pre><code>A.zip(B)\n# =&gt; [[\"Dog\", \"John\"], [\"Cat\", \"Doe\"], [\"Bird\", \"Foo\"]]\n</code></pre>\n\n<p>Flattening it will give you what you want:</p>\n\n<pre><code>A.zip(B).flatten\n# =&gt; [\"Dog\", \"John\", \"Cat\", \"Doe\", \"Bird\", \"Foo\"]\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE</strong> alternative using <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-flat_map\" rel=\"nofollow noreferrer\"><code>Enumerable#flat_map</code></a>:</p>\n\n<pre><code>(0...A.size).map { |i| [A[i], B[i]] }\n# =&gt; [[\"Dog\", \"John\"], [\"Cat\", \"Doe\"], [\"Bird\", \"Foo\"]]\n(0...A.size).flat_map { |i| [A[i], B[i]] }\n# =&gt; [\"Dog\", \"John\", \"Cat\", \"Doe\", \"Bird\", \"Foo\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1510640060, "creation_date": 1510640060, "answer_id": 47278825, "question_id": 47277544, "link": "https://stackoverflow.com/questions/47277544/combine-two-arrays-in-specific-order/47278825#47278825", "title": "Combine two arrays in specific order", "body": "<pre><code>Array.new(2*A.size) { |i| i.even? ? A[i/2] : B[i/2] }\n  #=&gt; [\"Dog\", \"John\", \"Cat\", \"Doe\", \"Bird\", \"Foo\"]\n</code></pre>\n"}], "owner": {"reputation": 344, "user_id": 1363865, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/4mQZY.jpg?s=128&g=1", "display_name": "Juan Artau", "link": "https://stackoverflow.com/users/1363865/juan-artau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 47277629, "answer_count": 2, "score": 1, "last_activity_date": 1510640060, "creation_date": 1510632763, "last_edit_date": 1510635951, "question_id": 47277544, "link": "https://stackoverflow.com/questions/47277544/combine-two-arrays-in-specific-order", "title": "Combine two arrays in specific order", "body": "<p>I need to combine these two arrays:</p>\n\n<pre><code>A = [\"Dog\", \"Cat\", \"Bird\"]\nB = [\"John\", \"Doe\", \"Foo\"]\n</code></pre>\n\n<p>I must take the first element of the first array and then the first element of the second array, then the second element of the first array and the second element of the second array and so on. It has to be in this exact order:</p>\n\n<pre><code>[\"Dog\", \"John\", \"Cat\", \"Doe\", \"Bird\", \"Foo\"]\n</code></pre>\n"}, {"tags": ["ruby", "hash", "duplicates", "lines"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510632992, "post_id": 47277375, "comment_id": 81506098, "body": "What&#39;s not clear here is what&#39;s in that text file. Is it email addresses? If so, why isn&#39;t <code>line</code> used inside your loop? Also testing <code>== true</code> is pointless, you can just branch on that logical value to start with."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510633402, "post_id": 47277375, "comment_id": 81506210, "body": "Yes it is email addresses. And how and why would that be in the loop?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510633464, "post_id": 47277375, "comment_id": 81506224, "body": "You tell me. What code you have here really doesn&#39;t make any sense, so I&#39;m guessing it&#39;s incomplete."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510633633, "post_id": 47277375, "comment_id": 81506263, "body": "Ouch...But check the update, is that what you mean?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1510634221, "post_id": 47277375, "comment_id": 81506426, "body": "That looks better, as at least there&#39;s something going on inside the <code>if</code>, so that at least gives an idea of the intent."}, {"owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "edited": false, "score": 0, "creation_date": 1510634455, "post_id": 47277375, "comment_id": 81506489, "body": "<code>if duplicate.exists? == true</code> is the same thing as <code>if duplicate.exists?</code>. Set up your text editor with a ruby linter and it will warn you when you do redundant things like that."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510634685, "post_id": 47277375, "comment_id": 81506541, "body": "Ohh. Thank you! I shall remember this information"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510634544, "post_id": 47277709, "comment_id": 81506504, "body": "Ok. Let me fully understand this. The first box that starts with <code>def</code>defines the email addresses for future purposes. I don&#39;t know what <code>require &#39;set&#39;</code> does? And that code box should be placed after the code that puts those addresses inside the text file. Then it filters and creates it easy to take out the duplicates? I&#39;m sorry. I&#39;m completely knew to Ruby - but isn&#39;t this Ruby on Rails? Thank you for helping me by the way."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510635715, "post_id": 47277709, "comment_id": 81506819, "body": "If you&#39;re unfamiliar with Ruby as a whole it&#39;s worth getting a <a href=\"http://ruby-doc.com/docs/ProgrammingRuby/\" rel=\"nofollow noreferrer\">good reference guide</a> as a companion to guide you through your learning. <code>require &#39;set&#39;</code> imports the Set library, which is <a href=\"http://ruby-doc.org/stdlib-2.4.2/libdoc/set/rdoc/Set.html\" rel=\"nofollow noreferrer\">documented here</a>. If you&#39;re ever curious about a component of Ruby, it&#39;s probably in the docs or on RubyGems, one of those two places."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510635786, "post_id": 47277709, "comment_id": 81506840, "body": "The way you&#39;ve defined the code there takes one <code>jdoc</code> and attempts to iterate over it. I&#39;ve termed it <code>jdocs</code> here because presumably you have an array of <i>multiple</i> documents, each with that inner structure, as you hint at in the (incomplete) first bit of Ruby code with two separate <code>notification_rule</code> entries."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 1, "creation_date": 1510635877, "post_id": 47277709, "comment_id": 81506858, "body": "I see. Let me run through it again. Thank you for your resources."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636122, "post_id": 47277709, "comment_id": 81506935, "body": "I ran it and it gave me the same error <code>undefined local variable or method </code>jdocs&#39; for main:Object (NameError)` Am I doing somethign wrong?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636160, "post_id": 47277709, "comment_id": 81506954, "body": "You need <code>jdocs</code> to be an array of multiple <code>jdoc</code> structures, or you need to call that chunk of code once <i>per</i> <code>jdoc</code> you find."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636175, "post_id": 47277709, "comment_id": 81506961, "body": "Shi. I forgot to say this and would probably be important but I have a <code>numbers = File.open(&quot;Employee_Information.txt&quot;, &quot;w+&quot;)</code> and the beginning and a <code>numbers.close</code> at the end."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636196, "post_id": 47277709, "comment_id": 81506972, "body": "Aren&#39;t these hashes?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636237, "post_id": 47277709, "comment_id": 81506992, "body": "An array of hashes is a thing, and it&#39;s what you need here if you&#39;re processing more than one record. <code>numbers</code> is not relevant here, as the thing with <code>readlines</code> takes care of it. Also why is that called &quot;numbers&quot; if you&#39;re talking about email addresses? Is that actually something else?"}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636322, "post_id": 47277709, "comment_id": 81507024, "body": "Well its supposed to spit out their phone numbers but it keeps duplicating their email."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636339, "post_id": 47277709, "comment_id": 81507029, "body": "Which it does, but that duplicate thing is annoying"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636371, "post_id": 47277709, "comment_id": 81507041, "body": "Maybe you&#39;re not explaining the requirements very well. You&#39;ll need to be more specific about a) what you&#39;re working with data wise, b) your expected results, and c) how the code you have here relates to it."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636577, "post_id": 47277709, "comment_id": 81507095, "body": "OK. I&#39;ll try my best. I was given a project to retrieve certain values from different apis. I&#39;ve found those employees numbers and was tasked to get that as well. So what the file variable numbers is supposed to contain is - Their Name, Email, and Number. The code that I asked for help was supposed to delete the duplicates of the value  <code>jdoc[&quot;notification_rule&quot;][&quot;contact_method&quot;][&quot;address&quot;]</code> to make it more presentable. As you can see why - because of the two different hashes that have the same values."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636773, "post_id": 47277709, "comment_id": 81507159, "body": "If you have an array of <code>jdoc</code> documents you can use the <a href=\"https://ruby-doc.org/core-2.4.1/Array.html#method-i-uniq\" rel=\"nofollow noreferrer\"><code>uniq</code></a> function to quickly remove duplicate entries: <code>jdocs.uniq { |jdoc| jdoc[...] }</code> where <code>...</code> is the path you have there, as before. It uses that block result to do uniqueness comparisons, as in the docs."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636921, "post_id": 47277709, "comment_id": 81507204, "body": "Ok. I will try that."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510636972, "post_id": 47277709, "comment_id": 81507216, "body": "So scratch you whole plan and just <code>jdocs.uniq { |jdoc| jdoc[&quot;notification_rule&quot;][&quot;contact_method&quot;][&quot;address&quot;] }</code> do that?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510679557, "post_id": 47277709, "comment_id": 81533575, "body": "<i>If</i> <code>jdocs</code> is an array of <code>jdoc</code> structures with exactly that internal structure and you want to unique on the <code>address</code> field, then yes."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1510634016, "creation_date": 1510634016, "answer_id": 47277709, "question_id": 47277375, "link": "https://stackoverflow.com/questions/47277375/delete-duplicate-lines-ruby/47277709#47277709", "title": "Delete Duplicate Lines Ruby", "body": "<p>This code looks really confused and lacking a specific purpose. Generally Ruby that's this tangled up is on the wrong track, as with Ruby there's usually a simple way of expressing something simple, and testing for duplicated addresses is one of those things that shouldn't be hard.</p>\n\n<p>One of the biggest sources of confusion is the <em>responsibility</em> of a chunk of code. In that example you're not only trying to import data, loop over documents, clean up email addresses, and test for duplicates, but somehow facilitate printing out the results. That's a lot of things going on all at once, and they all have to work perfectly for that chunk of code to be fully operational. There's no way of getting it partially working, and no way of knowing if you're even on the right track.</p>\n\n<p>Always try and break down complex problems into a few simple stages, then chain those stages together as necessary.</p>\n\n<p>Here's how you can define a method to clean up your email addresses:</p>\n\n<pre><code>def address_scrub(address)\n  address.gsub(/\\@target.com/, '').gsub(/\\w+/, &amp;:capitalize)\nend\n</code></pre>\n\n<p>Where that can be adjusted as necessary, and presumably <em>tested</em> to ensure it's working correctly, which you can now do indepenedently of the other code.</p>\n\n<p>As for the rest, it looks like this:</p>\n\n<pre><code>require 'set'\n\n# Read in duplicated addresses from a file, clean up with chomp, using a Set\n# for fast lookups.\nduplicates = Set.new(\n  File.open(\"Employee_Information.txt\", \"r\").readlines.map(&amp;:chomp)\n)\n\n# Extract addresses from jdoc document array\nfiltered = jdocs.map do |jdoc|\n  # Convert to jdoc/address pair\n  [ jdoc, address_scrub(jdoc[\"notification_rule\"][\"contact_method\"][\"address\"]) ]\nend.reject do |jdoc, address|\n  # Remove any that are already in the duplicates list\n  duplicates.include?(address)\nend.map do |jdoc, _|\n  # Return only the document\n  jdoc\nend\n</code></pre>\n\n<p>Where that processes <code>jdocs</code>, an array of <code>jdoc</code> structures, and removes duplicates in a series of simple steps.</p>\n\n<p>With the chaining approach you can see what's happening before you add on the next \"link\", so you can work incrementally towards a solution, adjusting as you go. Any mistakes are fairly easy to catch because you're able to, at any time, inspect the intermediate products of those stages.</p>\n"}], "owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510635788, "creation_date": 1510631700, "last_edit_date": 1510635788, "question_id": 47277375, "link": "https://stackoverflow.com/questions/47277375/delete-duplicate-lines-ruby", "title": "Delete Duplicate Lines Ruby", "body": "<p>I working on a json file, I think. But Regardless, I'm working with a lot of different hashes and fetching different values and etc. This is </p>\n\n<pre><code>{\"notification_rule\"=&gt;\n  {\"id\"=&gt;\"0000000\",\n   \"contact_method\"=&gt;\n    {\"id\"=&gt;\"000000\",\n     \"address\"=&gt;\"cod.lew@gmail.com\",}\n{\"notification_rule\"=&gt;\n  {\"id\"=&gt;\"000000\"\n   \"contact_method\"=&gt;\n      {\"id\"=&gt;\"PO0JGV7\",\n       \"address\"=&gt;\"cod.lew@gmail.com\",}\n</code></pre>\n\n<p>Essential, this is the type of hash I'm currently working with. With my code:\nI wanted to stop duplicates of the same thing in the text file. Because whenever I run this code it brings both the <code>address</code> of both these hashes. And I understand why, because its looping over again, but I thought this code that I added would help resolve that issue: </p>\n\n<p><strong>Final UPDATE</strong></p>\n\n<pre><code>  if jdoc[\"notification_rule\"][\"contact_method\"][\"address\"].to_s.include?(\".com\")\n            numbers.print \"Employee Name: \"\n            numbers.puts jdoc[\"notification_rule\"][\"contact_method\"][\"address\"].gsub(/@target.com/, '').gsub(/\\w+/, &amp;:capitalize)\n            file_names = ['Employee_Information.txt']\n            file_names.each do |file_name|\n                text = File.read(file_name)\n                lines = text.split(\"\\n\")\n                new_contents = lines.uniq.join(\"\\n\")\n                File.open(file_name, \"w\") { |file| file.puts new_contents }\n            end\n        else \n            nil\n        end\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax", "controller"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 8237766, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/167fb7424d9f32420ed95d9fa7c99baf?s=128&d=identicon&r=PG&f=1", "display_name": "A.Stekl", "link": "https://stackoverflow.com/users/8237766/a-stekl"}, "edited": false, "score": 0, "creation_date": 1510626816, "post_id": 47276750, "comment_id": 81504576, "body": "I can&#39;t believe it was that easy.. Thank you sir. You saved me a lot of time. Now I just have to fix my ruby function xD"}], "tags": [], "owner": {"reputation": 2977, "user_id": 8459787, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c4efeb3c2303d4b6b22f3ccf5d149c9b?s=128&d=identicon&r=PG&f=1", "display_name": "artgb", "link": "https://stackoverflow.com/users/8459787/artgb"}, "is_accepted": true, "score": 1, "last_activity_date": 1510626636, "creation_date": 1510626636, "answer_id": 47276750, "question_id": 47276621, "link": "https://stackoverflow.com/questions/47276621/422-unprocessable-entity-post-using-rails/47276750#47276750", "title": "422 (Unprocessable Entity) POST using rails", "body": "<p>The error could cause because of the CSRF token.</p>\n\n<p>Try to add this line on top of controller.</p>\n\n<pre><code>skip_before_action :verify_authenticity_token\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 8237766, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/167fb7424d9f32420ed95d9fa7c99baf?s=128&d=identicon&r=PG&f=1", "display_name": "A.Stekl", "link": "https://stackoverflow.com/users/8237766/a-stekl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2320, "favorite_count": 0, "accepted_answer_id": 47276750, "answer_count": 1, "score": 0, "last_activity_date": 1510626636, "creation_date": 1510625670, "question_id": 47276621, "link": "https://stackoverflow.com/questions/47276621/422-unprocessable-entity-post-using-rails", "title": "422 (Unprocessable Entity) POST using rails", "body": "<p>I just started using ruby on rails a few days ago. I am trying to send data from html tags to a ruby function using ajax. </p>\n\n<p>Here is the error that I am getting:</p>\n\n<pre><code>POST http://localhost:3000/ajax/ounces 422 (Unprocessable Entity)\n</code></pre>\n\n<p>I am calling the javascript function using an html button onclick attribute:</p>\n\n<pre><code>&lt;button class=\"btn btn-primary\" style=\"width:24%;\" type=\"button\" onclick=\"ounces_fn()\"&gt;Fluid Ounces&lt;/button&gt;\n</code></pre>\n\n<p>Here is my ajax call using javascript:</p>\n\n<pre><code>&lt;script&gt;\n    function ounces_fn() {\n        var meas1 = $(\"#m1\").val().replace( /^\\D+/g, '');\n        var meas2 = $(\"#m2\").val().replace( /^\\D+/g, '');\n        var meas3 = $(\"#m3\").val().replace( /^\\D+/g, '');\n        var meas4 = $(\"#m4\").val().replace( /^\\D+/g, '');\n        $.post('/ajax/ounces', {\n             num1: meas1,\n             num2: meas2,\n             num3: meas3,\n             num4: meas4\n        }, function(data) {\n             alert(\"success!\");\n             $(\"m1\").val(data[0].result.toString() + \"oz.\");\n             $(\"m2\").val(data[1].result.toString() + \"oz.\");\n             $(\"m3\").val(data[2].result.toString() + \"oz.\");\n             $(\"m4\").val(data[3].result.toString() + \"oz.\");\n        });\n    }\n&lt;/script&gt;\n</code></pre>\n\n<p>Here is my controller:</p>\n\n<pre><code>post '/ajax/ounces' =&gt; 'welcome#ajax_ounces'\n</code></pre>\n\n<p>And here is my ruby function:</p>\n\n<pre><code>def ajax_ounces\n    numArray = [params[\"num1\"].to_f, params[\"num2\"].to_f, params[\"num3\"].to_f, params[\"num4\"].to_f]\n    returnArray = Array.new(4);\n    i = 0\n\n    while i &lt; numArray.length do\n        returnArray[i] = numArray[i] / 30\n        i += 1\n    end\n\n    respond_to do |format|\n          format.json {render :json =&gt; {:result =&gt; returnArray}}\n    end\nend\n</code></pre>\n\n<p>I checked many different sites, but I could not relate any of it to what I was working on. I appreciate any help you can give. Thank you.</p>\n"}, {"tags": ["ruby", "rspec", "coursera-api"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 1, "creation_date": 1510620833, "post_id": 47275845, "comment_id": 81503082, "body": "What does <code>test.txt</code> contain?"}, {"owner": {"reputation": 5, "user_id": 3845145, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001389942709/picture?type=large", "display_name": "Akame Brice", "link": "https://stackoverflow.com/users/3845145/akame-brice"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1511213956, "post_id": 47275845, "comment_id": 81756685, "body": "@moveson&lt;code&gt;This is a really really really cool experiment really&lt;br/&gt; Cute little experiment&lt;br/&gt; Will it work maybe it will work do you think it will it will&lt;/code&gt;"}], "answers": [{"tags": [], "owner": {"reputation": 1999, "user_id": 1116381, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7b470e79f9eb14c32bc0b8f3eb47fbd8?s=128&d=identicon&r=PG", "display_name": "Tachyons", "link": "https://stackoverflow.com/users/1116381/tachyons"}, "is_accepted": false, "score": 0, "last_activity_date": 1510622292, "creation_date": 1510622292, "answer_id": 47276167, "question_id": 47275845, "link": "https://stackoverflow.com/questions/47275845/calculates-highest-count-words-across-lines-error-in-ruby-coursera/47276167#47276167", "title": "calculates highest count words across lines error in ruby coursera", "body": "<pre><code>  words_found = solution.highest_count_words_across_lines.map(&amp;:highest_wf_words).flatten\n</code></pre>\n\n<p>Here highest_count_words_across_lines returns array of strings, you are calling the method highest_wf_words in each of those strings. But the method is actually defined in the class LineAnalyzer</p>\n\n<p>Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": true, "score": 1, "last_activity_date": 1510635104, "creation_date": 1510635104, "answer_id": 47277890, "question_id": 47275845, "link": "https://stackoverflow.com/questions/47275845/calculates-highest-count-words-across-lines-error-in-ruby-coursera/47277890#47277890", "title": "calculates highest count words across lines error in ruby coursera", "body": "<p>You have many problems. </p>\n\n<ol>\n<li><p>Your Solution#analyze_file method, you are trying to use a constant (<code>LineAnalyzer</code>) as a variable: <code>LineAnalyzer = LineAnalyzer.new(content, line)</code>. You need to change to:</p>\n\n<pre><code>line_analyzer = LineAnalyzer.new(content, line)\n@analyzers &lt;&lt; line_analyzer\n</code></pre></li>\n<li><p>Your <code>line</code> variable in the same method is always <code>nil</code>. You can fix this by replacing the first line of the method with <code>File.foreach('test.txt').with_index(1) do |content, line|</code>.</p></li>\n<li><p>Your calculation of <code>@highest_count_across_lines</code> doesn't work at all. Instead of setting it to zero and iterating as you do, just do:</p>\n\n<pre><code>@highest_count_across_lines = analyzers.map(&amp;:highest_wf_count).max\n</code></pre></li>\n</ol>\n\n<p>I'm frankly confused by the tests, and not super excited about figuring out how to make them pass. IMHO this course is teaching you non-idiomatic Ruby. But hopefully the above will get you on the right track.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10195581, "user_type": "registered", "profile_image": "https://graph.facebook.com/2046454842056166/picture?type=large", "display_name": "Parth Chugh", "link": "https://stackoverflow.com/users/10195581/parth-chugh"}, "is_accepted": false, "score": 0, "last_activity_date": 1535718542, "last_edit_date": 1535718542, "creation_date": 1535715929, "answer_id": 52114793, "question_id": 47275845, "link": "https://stackoverflow.com/questions/47275845/calculates-highest-count-words-across-lines-error-in-ruby-coursera/52114793#52114793", "title": "calculates highest count words across lines error in ruby coursera", "body": "<p>one thing is missing in that\nfor <code>@highest_count_words_across_lines</code></p>\n\n<pre><code>@highest_count_words_across_lines = @analyzers.select do |analyzer|\n   analyzer.highest_wf_count == @highest_count_across_lines\nend\n</code></pre>\n\n<p>Actually they are asking for objects and you are giving values.</p>\n"}], "owner": {"reputation": 5, "user_id": 3845145, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001389942709/picture?type=large", "display_name": "Akame Brice", "link": "https://stackoverflow.com/users/3845145/akame-brice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "accepted_answer_id": 47277890, "answer_count": 3, "score": 0, "last_activity_date": 1535718542, "creation_date": 1510619909, "question_id": 47275845, "link": "https://stackoverflow.com/questions/47275845/calculates-highest-count-words-across-lines-error-in-ruby-coursera", "title": "calculates highest count words across lines error in ruby coursera", "body": "<p>it's almost 2 weeks now I can't remove this from my head. I'm a newbie in ruby and I'm stuck with this last bit of Ruby on Rails an introduction course on coursera. It'll certainly be easy to figure out what's wrong here but I need help to finish this course in time this time around.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>#Implement all parts of this assignment within (this) module2_assignment2.rb file\r\n\r\n#Implement a class called LineAnalyzer.\r\nclass LineAnalyzer\r\n  #Implement the following read-only attributes in the LineAnalyzer class. \r\n  #* highest_wf_count - a number with maximum number of occurrences for a single word (calculated)\r\n  #* highest_wf_words - an array of words with the maximum number of occurrences (calculated)\r\n  #* content          - the string analyzed (provided)\r\n  #* line_number      - the line number analyzed (provided)\r\n\r\n  #Add the following methods in the LineAnalyzer class.\r\n  #* initialize() - taking a line of text (content) and a line number\r\n  #* calculate_word_frequency() - calculates result\r\n\r\n  #Implement the initialize() method to:\r\n  #* take in a line of text and line number\r\n  #* initialize the content and line_number attributes\r\n  #* call the calculate_word_frequency() method.\r\n\r\n  #Implement the calculate_word_frequency() method to:\r\n  #* calculate the maximum number of times a single word appears within\r\n  #  provided content and store that in the highest_wf_count attribute.\r\n  #* identify the words that were used the maximum number of times and\r\n  #  store that in the highest_wf_words attribute.\r\n\r\n    attr_accessor :highest_wf_count, :highest_wf_words, :content, :line_number\r\n\r\n\r\n    def initialize(content, line)\r\n    @content = content\r\n    @line_number = line\r\n    @highest_wf_count=0\r\n    @highest_wf_words = []\r\n    calculate_word_frequency()\r\n  end\r\n\r\n  def calculate_word_frequency()\r\n    @highest_wf_words = Hash.new\r\n    words = @content.split\r\n    words.each { |w|\r\n      if @highest_wf_words.has_key?(w)\r\n        @highest_wf_words[w] += 1\r\n      else\r\n        @highest_wf_words[w] = 1\r\n      end\r\n    }\r\n    @highest_wf_words.sort_by { |word, count| count }\r\n    @highest_wf_words.each do |key, value|\r\n      if value &gt; @highest_wf_count\r\n        @highest_wf_count = value\r\n      end\r\n    end\r\n  end\r\n\r\n  def highest_wf_count= (number)\r\n    @highest_wf_count = number\r\n  end\r\n\r\nend\r\n\r\n\r\n#  Implement a class called Solution. \r\nclass Solution\r\n\r\n  # Implement the following read-only attributes in the Solution class.\r\n  #* analyzers - an array of LineAnalyzer objects for each line in the file\r\n  #* highest_count_across_lines - a number with the maximum value for highest_wf_words attribute in the analyzers array.\r\n  #* highest_count_words_across_lines - a filtered array of LineAnalyzer objects with the highest_wf_words attribute \r\n  #  equal to the highest_count_across_lines determined previously.\r\n  \r\n  # Implement the following methods in the Solution class.\r\n  #* analyze_file() - processes 'test.txt' into an array of LineAnalyzers and stores them in analyzers.\r\n  #* calculate_line_with_highest_frequency() - determines the highest_count_across_lines and \r\n  #  highest_count_words_across_lines attribute values  \r\n  #* print_highest_word_frequency_across_lines() - prints the values of LineAnalyzer objects in \r\n  #  highest_count_words_across_lines in the specified format\r\n\r\n  \r\n  # Implement the analyze_file() method() to:\r\n  #* Read the 'test.txt' file in lines \r\n  #* Create an array of LineAnalyzers for each line in the file\r\n\r\n  # Implement the calculate_line_with_highest_frequency() method to:\r\n  #* calculate the maximum value for highest_wf_count contained by the LineAnalyzer objects in analyzers array\r\n  #  and stores this result in the highest_count_across_lines attribute.\r\n  #* identifies the LineAnalyzer objects in the analyzers array that have highest_wf_count equal to highest_count_across_lines \r\n  #  attribute value determined previously and stores them in highest_count_words_across_lines.\r\n\r\n  #Implement the print_highest_word_frequency_across_lines() method to\r\n  #* print the values of objects in highest_count_words_across_lines in the specified format\r\n\r\n  attr_reader  :analyzers, :highest_count_across_lines, :highest_count_words_across_lines\r\n\r\n  def initialize\r\n    @highest_count_across_lines = nil\r\n    @highest_count_words_across_lines = nil\r\n    @analyzers = []\r\n  end\r\n\r\n  def analyze_file()\r\n    File.foreach('test.txt') do |content, line|\r\n      LineAnalyzer = LineAnalyzer.new(content, line)\r\n      @analyzers &lt;&lt; LineAnalyzer\r\n    end\r\n  end\r\n\r\n  def calculate_line_with_highest_frequency()\r\n    @highest_count_across_lines = 0\r\n    @highest_count_words_across_lines = []\r\n    @analyzers.each do |analyzers|\r\n      if analyzers.highest_wf_words &gt; @highest_count_across_lines\r\n        @highest_count_across_lines = analyzers.highest_wf_count\r\n      end\r\n      analyzers.highest_wf_words.each do |key, value|\r\n       if analyzers.highest_count_words_across_lines &lt; value\r\n          @highest_count_words_across_lines &lt;&lt; key\r\n       end\r\n      end\r\n    end\r\n  end\r\n\r\n  def print_highest_word_frequency_across_lines()\r\n    @highest_count_words_across_lines = Array.new\r\n    puts \"The following words have the highest word frequency per line:\"\r\n  end\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I keep on having 1 fail out of 19 on rspec like this:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>LineAnalyzer\r\n  has accessor for highest_wf_count\r\n  has accessor for highest_wf_words\r\n  has accessor for content\r\n  has accessor for line_number\r\n  has method calculate_word_frequency\r\n  calls calculate_word_frequency when created\r\n  attributes and values\r\n    has attributes content and line_number\r\n    content attribute should have value \"test\"\r\n    line_number attribute should have value 1\r\n  #calculate_word_frequency\r\n    highest_wf_count value is 3\r\n    highest_wf_words will include \"really\" and \"you\"\r\n    content attribute will have value \"This is a really really really cool cool you you you\"\r\n    line_number attribute will have value 2\r\n\r\nSolution\r\n  should respond to #analyze_file\r\n  should respond to #calculate_line_with_highest_frequency\r\n  should respond to #print_highest_word_frequency_across_lines\r\n  #analyze_file\r\n    creates 3 line analyzers\r\n  #calculate_line_with_highest_frequency\r\n    calculates highest count across lines to be 4\r\n    calculates highest count words across lines to be will, it, really (FAILED - 1)\r\n\r\nFailures:\r\n\r\n  1) Solution#calculate_line_with_highest_frequency calculates highest count words across lines to be will, it, really\r\n     Failure/Error: words_found = solution.highest_count_words_across_lines.map(&amp;:highest_wf_words).flatten\r\n\r\n     NoMethodError:\r\n       undefined method `highest_wf_words' for \"This\":String\r\n     # ./spec/solution_spec.rb:38:in `map'\r\n     # ./spec/solution_spec.rb:38:in `block (3 levels) in &lt;top (required)&gt;'\r\n\r\nFinished in 0.10817 seconds (files took 0.37345 seconds to load)\r\n19 examples, 1 failure\r\n\r\nFailed examples:\r\n\r\nrspec ./spec/solution_spec.rb:31 # Solution#calculate_line_with_highest_frequency calculates highest count words across lines to be will, it, really</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>And this is the solution_spec file.\nWhere am I going astray? Please help, it ia a desperate call!</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>require_relative \"../module2_assignment\"\r\nrequire 'rspec'\r\n\r\ndescribe Solution do\r\n  subject(:solution) { Solution.new }\r\n\r\n  it { is_expected.to respond_to(:analyze_file) } \r\n  it { is_expected.to respond_to(:calculate_line_with_highest_frequency) } \r\n  it { is_expected.to respond_to(:print_highest_word_frequency_across_lines) } \r\n\r\n  context \"#analyze_file\" do\r\n    it \"creates 3 line analyzers\" do\r\n      expect(solution.analyzers.length).to eq 0 \r\n      solution.analyze_file\r\n      expect(solution.analyzers.length).to eq 3\r\n    end  \r\n  end\r\n  \r\n  context \"#calculate_line_with_highest_frequency\" do\r\n\r\n\r\n    it \"calculates highest count across lines to be 4\" do\r\n      solution.analyze_file\r\n\r\n      expect(solution.highest_count_across_lines).to be nil\r\n      \r\n      solution.calculate_line_with_highest_frequency\r\n\r\n      expect(solution.highest_count_across_lines).to be 4\r\n    end  \r\n    it \"calculates highest count words across lines to be will, it, really\" do\r\n      solution.analyze_file\r\n\r\n      expect(solution.highest_count_words_across_lines).to be nil\r\n      \r\n      solution.calculate_line_with_highest_frequency\r\n\r\n      words_found = solution.highest_count_words_across_lines.map(&amp;:highest_wf_words).flatten\r\n      expect(words_found).to match_array [\"will\", \"it\", \"really\"] \r\n    end  \r\n  end\r\n\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ubuntu"], "comments": [{"owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "edited": false, "score": 1, "creation_date": 1510618894, "post_id": 47275097, "comment_id": 81502572, "body": "Did you not just fix the problem by installing the needed packages?"}, {"owner": {"reputation": 1999, "user_id": 1116381, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7b470e79f9eb14c32bc0b8f3eb47fbd8?s=128&d=identicon&r=PG", "display_name": "Tachyons", "link": "https://stackoverflow.com/users/1116381/tachyons"}, "edited": false, "score": 0, "creation_date": 1510622536, "post_id": 47275097, "comment_id": 81503557, "body": "Duplicate ? <a href=\"https://stackoverflow.com/questions/42481130/cannot-install-rails-gem-on-ruby-2-3-1\" title=\"cannot install rails gem on ruby 2 3 1\">stackoverflow.com/questions/42481130/&hellip;</a>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1510623429, "post_id": 47275097, "comment_id": 81503781, "body": "when it says &quot;Make sure that <code>gem install nokogiri -v &#39;1.8.1&#39;</code> succeeds before bundling.&quot;, you should try that. It will show you more specific errors."}, {"owner": {"reputation": 15, "user_id": 6901497, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--q3bnOuyNg4/AAAAAAAAAAI/AAAAAAAA7eA/ETnVOtImnFQ/photo.jpg?sz=128", "display_name": "Ricardo Santamar&#237;a Porras", "link": "https://stackoverflow.com/users/6901497/ricardo-santamar%c3%ada-porras"}, "edited": false, "score": 0, "creation_date": 1510626389, "post_id": 47275097, "comment_id": 81504481, "body": "I fixed running <code>gem install bundler</code> in my server. :)"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1510637979, "post_id": 47275097, "comment_id": 81507529, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/33996523/error-installing-nokogiri-failed-to-build-gem-native-extension-libiconv-is-mi\">Error installing nokogiri: Failed to build gem native extension &amp; libiconv is missing (OSX)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "is_accepted": false, "score": 1, "last_activity_date": 1510642622, "creation_date": 1510642622, "answer_id": 47279464, "question_id": 47275097, "link": "https://stackoverflow.com/questions/47275097/nokogiri-gem-error-failed-to-build-gem-native-extension/47279464#47279464", "title": "nokogiri gem - ERROR: Failed to build gem native extension.", "body": "<p>try this :</p>\n\n<pre><code>$ sudo apt-get update \n$ sudo apt-get install libxml2-dev libxslt-dev\n$ sudo gem install nokogiri\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 976, "user_id": 2059156, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/63cd1ed57348618c6514545a8f53ece2?s=128&d=identicon&r=PG", "display_name": "John Cowan", "link": "https://stackoverflow.com/users/2059156/john-cowan"}, "is_accepted": false, "score": 0, "last_activity_date": 1606512257, "creation_date": 1606512257, "answer_id": 65043984, "question_id": 47275097, "link": "https://stackoverflow.com/questions/47275097/nokogiri-gem-error-failed-to-build-gem-native-extension/65043984#65043984", "title": "nokogiri gem - ERROR: Failed to build gem native extension.", "body": "<p>I know this is years after this thread started, but i had this same problem with nokogiri and capybara.  I'm on Ubuntu 20.04, but had the same issue on Ubuntu 18.04 - same computer.</p>\n<pre><code>sudo apt-get update\nsudo apt-get install gcc ruby-dev libxslt-dev libxml2-dev zlib1g-dev\nsudo apt-get install build-essential patch ruby-dev zlib1g-dev liblzma-dev\nsudo apt-get install libxml2-dev libxslt-dev\nsudo gem install nokogiri\nsudo gem install capybara\n</code></pre>\n<p>I tried everything I could find, but nothing seemed to work.  I'm not sure what did it, but above are the last commandline commands I tried.  Poof...  It worked finally.</p>\n"}], "owner": {"reputation": 15, "user_id": 6901497, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--q3bnOuyNg4/AAAAAAAAAAI/AAAAAAAA7eA/ETnVOtImnFQ/photo.jpg?sz=128", "display_name": "Ricardo Santamar&#237;a Porras", "link": "https://stackoverflow.com/users/6901497/ricardo-santamar%c3%ada-porras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3530, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1606512257, "creation_date": 1510614829, "question_id": 47275097, "link": "https://stackoverflow.com/questions/47275097/nokogiri-gem-error-failed-to-build-gem-native-extension", "title": "nokogiri gem - ERROR: Failed to build gem native extension.", "body": "<p>i'm trying to deploy a rails application with capistrano but i'm having some problems with nokogiri gem when is bundle installing in the server ubuntu 16.04</p>\n\n<p>The backtrace is the following:</p>\n\n<pre><code>Tasks: TOP =&gt; deploy:updated =&gt; bundler:install\n(See full trace by running task with --trace)\nThe deploy has failed with an error: Exception while executing as root@104.236.11.204: bundle exit status: 5\nbundle stdout: Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory:\n/var/www/denunciabarranquillafinal/shared/bundle/ruby/2.3.0/gems/nokogiri-1.8.1/ext/nokogiri\n/usr/local/rvm/rubies/ruby-2.3.0/bin/ruby -r ./siteconf20171113-30499-1nk84ws.rb\nextconf.rb --use-system-libraries\nCannot allocate memory - /usr/local/rvm/rubies/ruby-2.3.0/bin/ruby -r\n./siteconf20171113-30499-1nk84ws.rb extconf.rb --use-system-libraries 2&gt;&amp;1\n\nGem files will remain installed in\n/var/www/denunciabarranquillafinal/shared/bundle/ruby/2.3.0/gems/nokogiri-1.8.1\nfor inspection.\nResults logged to\n/var/www/denunciabarranquillafinal/shared/bundle/ruby/2.3.0/extensions/x86_64-linux/2.3.0/nokogiri-1.8.1/gem_make.out\n\nAn error occurred while installing nokogiri (1.8.1), and Bundler cannot\ncontinue.\nMake sure that `gem install nokogiri -v '1.8.1'` succeeds before bundling.\n\nIn Gemfile:\n  rails was resolved to 4.2.4, which depends on\n    actionmailer was resolved to 4.2.4, which depends on\n      actionpack was resolved to 4.2.4, which depends on\n        actionview was resolved to 4.2.4, which depends on\n          rails-dom-testing was resolved to 1.0.8, which depends on\n            nokogiri\nbundle stderr: Nothing written\n</code></pre>\n\n<p>I ran the command</p>\n\n<pre><code>sudo apt-get install build-essential patch ruby-dev zlib1g-dev liblzma-dev\n</code></pre>\n\n<p>in my server, and if I run \"gem install nokogiri\" the gem is installed normally.</p>\n\n<p>I hope someone can help me to fix the error.</p>\n"}, {"tags": ["ruby", "loops", "date", "require"], "comments": [{"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510613774, "post_id": 47274898, "comment_id": 81501134, "body": "I just found out that I should change the <code>.strptime</code> to <code>.iso8601</code>. Good choice?"}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510613887, "post_id": 47274898, "comment_id": 81501162, "body": "As well as change <code>.strftime</code> to <code>.iso8601</code>"}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1510616485, "post_id": 47274898, "comment_id": 81501944, "body": "Yes ISO 8601 is the format I want and is the value of the key <code>jsonUser[&quot;start&quot;]</code>. I have no idea what you mean by DateTime calling <code>next_day(7)</code> in which you asked. The only thing it is returning is the value for <code>jsonUser[&quot;start&quot;]</code> right after the name. And I&#39;m not running rails but <code>ruby 2.0.0p648 (2015-12-16 revision 53162) [universal.x86_64-darwin16]</code>"}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1510619416, "post_id": 47274898, "comment_id": 81502705, "body": "I&#39;ll update it. Give me a sec.."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1510619562, "post_id": 47274898, "comment_id": 81502739, "body": "Its updated...."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1510620139, "post_id": 47274898, "comment_id": 81502898, "body": "Why would <code>utc</code> change if <code>jsonUser[&quot;start&quot;]</code> does not change? The loop variable is <code>user</code>, not <code>jsonUser</code>. Start by <code>date = DateTime.iso8601(jsonUser[&quot;start&quot;])</code> <i>outside</i> of the loop, then <code>somefile.puts date.iso8861; date = date.next_day(7)</code> inside the loop."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510620218, "post_id": 47274898, "comment_id": 81502913, "body": "Sorry. Would I put that code at a line before <code>end</code>?"}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510620401, "post_id": 47274898, "comment_id": 81502961, "body": "Ok this is what happen Amadan. <code>undefined method iso8061 for #&lt;DateTime:0x007fba758312d8&gt; (NoMethodError)</code>"}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510620440, "post_id": 47274898, "comment_id": 81502970, "body": "I&#39;ll update it for you to see what I put"}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510620540, "post_id": 47274898, "comment_id": 81502998, "body": "I FOUND THE SOLUTION."}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510620600, "post_id": 47274898, "comment_id": 81503016, "body": "You were almost there Amadan. Instead of ending it with <code>somefile.puts date.iso8601</code> as the ending...You were supposed to take out the <code>iso8601</code>"}, {"owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "edited": false, "score": 0, "creation_date": 1510620638, "post_id": 47274898, "comment_id": 81503024, "body": "But do you know why? Is it because you already defined it in the date?"}], "owner": {"reputation": 11, "user_id": 8929793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0161d32204e7eec81971821ede81de6?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/8929793/zen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510620471, "creation_date": 1510613590, "last_edit_date": 1510620471, "question_id": 47274898, "link": "https://stackoverflow.com/questions/47274898/datetime-ruby-how-to-format-correctly", "title": "DateTime Ruby How to format correctly", "body": "<p>My project is supposed to fetch specific values from multiple hashes a put those values in a text file. Ideally what I need my code to do is to have every date for the employees be seven days apart, so the text file would look something like this:</p>\n\n<pre><code>\"Rachel Thorndike\n2017-10-09-T04:29:46-05:00\nStacie Smith\n2017-10-16-T04:29:46-05:00\"\n</code></pre>\n\n<p>What this is supposed to do is fetch employee's names and put the time of their \"handoff\" on the line under them. I looked online and found the DateTime that Ruby features but it looks like whatever I do isn't working. My code is this:</p>\n\n<pre><code>require 'date'\njsonUser[\"users\"].each do |user|\n  somefile.puts user[\"user\"][\"summary\"]\n  print 'Handoff Date + Time: '\n  parsed = DateTime.strptime(jsonUser[\"start\"], '%d-%m-%Y %H:%M')\n  utc = parsed.next_day(7).strftime('%d-%m-%Y %H:%M')\n  puts utc\nend\n</code></pre>\n\n<p>But terminal returns this code with an error <code>'strptime': invalid date (ArgumentError)</code>. Would anybody help me get this code to work the way I want to? Anything that points me to the right direction? With explanations, if it isn't too much. </p>\n\n<p>Thank you so much!</p>\n\n<p><strong>Update</strong>\nI was able to get the iso8601 to appear under their name. My new code is \nrequire 'date'</p>\n\n<pre><code>jsonUser[\"users\"].each do |user|\n somefile.puts user[\"user\"][\"summary\"]\n   print 'Handoff Date + Time: '\n   parsed = DateTime.iso8601(jsonUser[\"start\"])\n   utc = parsed.next_day(7).iso8601\n   somefile.puts utc\nend \n</code></pre>\n\n<p><strong>BUT</strong> the <code>.next_day</code> method isn't increasing by 7 days that I want too. Thought? I have only got one value that is appearing and that is going under every line. Its the value of <code>jsonUser[\"start\"]</code> + 7 days...so `2017-</p>\n\n<p>10-16T04:29:46-05:00`</p>\n\n<p>This is what <code>parse.next_day(7)</code> gives me. </p>\n\n<pre><code>\"Sr Chid\nHandoff Date + Time: 2017-10-16T04:29:46-05:00\nAsh A \nHandoff Date + Time: 2017-10-16T04:29:46-05:00\nVen D\nHandoff Date + Time: 2017-10-16T04:29:46-05:00\nAbhi S\nHandoff Date + Time: 2017-10-16T04:29:46-05:00\"\n</code></pre>\n\n<p>The value of <code>jsonUser[\"start\"]</code> is <code>2017-10-09T04:29:46-05:00</code> so the good thing is that it did increase by 7 but it only did it once. </p>\n\n<p><strong>Update for Amadan</strong></p>\n\n<pre><code>require 'date'\n  date = DateTime.iso8601(jsonUser[\"start\"])\n  jsonUser[\"users\"].each do |user|\n    if user[\"user\"][\"self\"] == nil\n      nil\n    else\n      somefile.puts user[\"user\"][\"summary\"].gsub(/\\w+/, &amp;:capitalize).gsub(/[.]/, ' ')\n      somefile.print 'Handoff Date + Time: '\n      date = date.next_day(7)\n      somefile.puts date.iso8061\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1510615334, "post_id": 47274862, "comment_id": 81501608, "body": "Probably worth noting that <code>?item=some_item&amp;item=other_item</code> is perfectly valid according to the specs whereas the &quot;this is an array, really it is&quot; <code>?item[]=some_item&amp;item[]=other_item</code> version is a convention."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1510616519, "post_id": 47274862, "comment_id": 81501951, "body": "Oh, do you mean is the same thing? I did not know"}, {"owner": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "edited": false, "score": 0, "creation_date": 1510616958, "post_id": 47274862, "comment_id": 81502062, "body": "Thanks Ursus. I tried that but i am getting an error at views mapping values are not allowed in this context at line 1 column 13. Any idea why? i added views in question"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1510617188, "post_id": 47274862, "comment_id": 81502112, "body": "Mmmm, it does not seem to have something to do with this question. Are you sure that your <code>@items</code> refer to an <code>ActiveRecord::Relation</code> object?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1510617920, "post_id": 47274862, "comment_id": 81502295, "body": "So is the exception raised in <code>index.json.jbuilder</code>?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 1, "creation_date": 1510618339, "post_id": 47274862, "comment_id": 81502435, "body": "Sorry man, I suggest you open another question, it seems something different here"}, {"owner": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "edited": false, "score": 0, "creation_date": 1510680186, "post_id": 47274862, "comment_id": 81533951, "body": "Thanks Ursus. I&#39;ll open another question"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 2, "last_activity_date": 1510613346, "creation_date": 1510613346, "answer_id": 47274862, "question_id": 47274845, "link": "https://stackoverflow.com/questions/47274845/how-to-pass-same-parameter-multiple-times-in-ruby/47274862#47274862", "title": "how to pass same parameter multiple times in ruby", "body": "<p>You mean, like an array? Try this way</p>\n\n<pre><code>http://localhost:3000/items?item[]=some_item&amp;item[]=other_item\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 47274862, "answer_count": 1, "score": 0, "last_activity_date": 1510616918, "creation_date": 1510613223, "last_edit_date": 1510616918, "question_id": 47274845, "link": "https://stackoverflow.com/questions/47274845/how-to-pass-same-parameter-multiple-times-in-ruby", "title": "how to pass same parameter multiple times in ruby", "body": "<p>I have following index method in ruby</p>\n\n<pre><code>def index\n  if params.key?(:item)\n    @items = Item.get_items.where(item: params[:item])\n  else\n    @items = Item.get_items\nend\n</code></pre>\n\n<p>I am using postman for testing as follows</p>\n\n<pre><code>http://localhost:3000/items?item=some_item\n</code></pre>\n\n<p>How can pass same param twice?</p>\n\n<p>e.g</p>\n\n<pre><code>http://localhost:3000/items?item=some_item&amp;item=other_item\n</code></pre>\n\n<p>Edit: adding views</p>\n\n<p>index.json.jbuilder</p>\n\n<pre><code>json.array! @items, partial: \u2018items/item\u2019, as: :item\n</code></pre>\n\n<p>_item.json.jbuilder</p>\n\n<pre><code>json.something1 item.something1\njson.item_layout do\n  json.template_key item.layout\n  json.merge! item.layout_config if item.layout_config.present?\nend\njson.something (item.item_details) do |item_detail|\n  json.partial! \u2018item_details/item_detail\u2019, item_detail: item_detail\nend\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "shared-libraries"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1510617866, "post_id": 47274842, "comment_id": 81502282, "body": "Just tested in every ruby I have installed, going back to 1.9.3 and I have to require BigDecimal in all of them, and don&#39;t actually remember being able to use that library without requiring it. Is there some project config file the others have that you&#39;re missing that requires it?"}, {"owner": {"reputation": 339, "user_id": 1526242, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/871f8564e9845c7e6f739471d398a4ff?s=128&d=identicon&r=PG", "display_name": "SaxSalute", "link": "https://stackoverflow.com/users/1526242/saxsalute"}, "edited": false, "score": 0, "creation_date": 1510705906, "post_id": 47274842, "comment_id": 81546510, "body": "My question is, what facility in Ruby could cause something to be imported for some but not all of the people using this code?"}], "answers": [{"tags": [], "owner": {"reputation": 1999, "user_id": 1116381, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7b470e79f9eb14c32bc0b8f3eb47fbd8?s=128&d=identicon&r=PG", "display_name": "Tachyons", "link": "https://stackoverflow.com/users/1116381/tachyons"}, "is_accepted": false, "score": 1, "last_activity_date": 1510623266, "creation_date": 1510623266, "answer_id": 47276275, "question_id": 47274842, "link": "https://stackoverflow.com/questions/47274842/ruby-no-longer-loading-bigdecimal-by-default/47276275#47276275", "title": "Ruby no longer loading BigDecimal by default", "body": "<p>You have to use require bigdecimel to use it, Probably some of the dependency gems for your app were requiring it before so that you didn't had to require them manually</p>\n"}], "owner": {"reputation": 339, "user_id": 1526242, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/871f8564e9845c7e6f739471d398a4ff?s=128&d=identicon&r=PG", "display_name": "SaxSalute", "link": "https://stackoverflow.com/users/1526242/saxsalute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510623266, "creation_date": 1510613212, "question_id": 47274842, "link": "https://stackoverflow.com/questions/47274842/ruby-no-longer-loading-bigdecimal-by-default", "title": "Ruby no longer loading BigDecimal by default", "body": "<p>After months without issue, I've begun to get an error saying that BigDecimal isn't loaded (specifically <code>uninitialized constant BigDecimal</code>). The simple solution would of course be to just add the require statement as needed, but I'm working on this project with several others and this issue is only affecting me. It's happening on both of my computers (MacOS + Arch), and I'm generally curious as to why this would suddenly start.</p>\n\n<p>I had a suspicion that it could be something to do with switching from system Ruby to RVM-managed Ruby, but switching back to system Ruby didn't remedy the issue. I've done some searching on this and haven't come up with anything.</p>\n"}, {"tags": ["ruby", "shoes", "shoes-4"], "comments": [{"owner": {"reputation": 1999, "user_id": 1116381, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7b470e79f9eb14c32bc0b8f3eb47fbd8?s=128&d=identicon&r=PG", "display_name": "Tachyons", "link": "https://stackoverflow.com/users/1116381/tachyons"}, "edited": false, "score": 0, "creation_date": 1510623359, "post_id": 47274732, "comment_id": 81503764, "body": "Can you post error message as well"}], "answers": [{"comments": [{"owner": {"reputation": 10234, "user_id": 138513, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/42b570f6f4312a872c2fc671e3ddc82b?s=128&d=identicon&r=PG", "display_name": "Trejkaz", "link": "https://stackoverflow.com/users/138513/trejkaz"}, "edited": false, "score": 0, "creation_date": 1527895077, "post_id": 47354759, "comment_id": 88314866, "body": "Kind of defeats the purpose of using SSL though, right?"}], "tags": [], "owner": {"reputation": 539, "user_id": 3693398, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100000471452957/picture?type=large", "display_name": "teddybear", "link": "https://stackoverflow.com/users/3693398/teddybear"}, "is_accepted": true, "score": 1, "last_activity_date": 1510934764, "creation_date": 1510934764, "answer_id": 47354759, "question_id": 47274732, "link": "https://stackoverflow.com/questions/47274732/does-the-shoes-gem-support-https-requests/47354759#47354759", "title": "Does the shoes gem support HTTPS requests?", "body": "<p>I figured it out. Updating the request to strip the token and setting the verify_mode to  <code>OpenSSL::SSL::VERIFY_NONE</code> fixed the problem.  </p>\n\n<pre><code>token = Base64.encode64(\"#{user}:#{pass}\").strip\nuri = URI(\"https://example.com/\")\n\nhttp = Net::HTTP.new(uri.host, uri.port)\nhttp.use_ssl = true\nhttp.verify_mode = OpenSSL::SSL::VERIFY_NONE\n\nrequest = Net::HTTP::Get.new(uri.request_uri)\nrequest[\"authorization\"] = \"Bearer #{token}\"\nrequest[\"Content-Type\"] = \"application/json\"\nresponse = http.request(request)\n\ninfo(response.body)\nresponse\n</code></pre>\n"}], "owner": {"reputation": 539, "user_id": 3693398, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100000471452957/picture?type=large", "display_name": "teddybear", "link": "https://stackoverflow.com/users/3693398/teddybear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 47354759, "answer_count": 1, "score": 1, "last_activity_date": 1510934764, "creation_date": 1510612705, "last_edit_date": 1510671581, "question_id": 47274732, "link": "https://stackoverflow.com/questions/47274732/does-the-shoes-gem-support-https-requests", "title": "Does the shoes gem support HTTPS requests?", "body": "<p>I've been looking around on how to make HTTPS requests using the Shoes GUI builder and I'm getting the <code>SSL_connnect</code> connect error and I'm unsure of what to do about it.</p>\n\n<p>I made a test app in this <a href=\"https://gist.github.com/tedma4/15e9a0591a846128db911f236a54a195\" rel=\"nofollow noreferrer\">Gist</a></p>\n\n<p>Here's the Error:</p>\n\n<pre><code>SSL_connect returned=1 errno=0 state=error: certificate verify failed\n/Applications/Shoes.app/Contents/MacOS/lib/ruby/2.2.0/net/http.rb:923:in `connect'\n/Applications/Shoes.app/Contents/MacOS/lib/ruby/2.2.0/net/http.rb:923:in `block in connect'\n/Applications/Shoes.app/Contents/MacOS/lib/ruby/2.2.0/timeout.rb:73:in `timeout'\n/Applications/Shoes.app/Contents/MacOS/lib/ruby/2.2.0/net/http.rb:923:in `connect'\n/Applications/Shoes.app/Contents/MacOS/lib/ruby/2.2.0/net/http.rb:863:in `do_start'\n/Applications/Shoes.app/Contents/MacOS/lib/ruby/2.2.0/net/http.rb:852:in `start'\n/Applications/Shoes.app/Contents/MacOS/lib/ruby/2.2.0/net/http.rb:1375:in `request'\nshoes.rb:17:in `request'\nshoes.rb:54:in `block (3 levels) in &lt;main&gt;'\n-e:1:in `call'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 3, "creation_date": 1510610250, "post_id": 47274149, "comment_id": 81499698, "body": "<code>params[:temp_file_path]</code> is a <code>String</code>. If you want to access <code>[:value]</code>, then <code>params[:temp_file_path]</code> needs to be a valid <code>Hash</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2045, "user_id": 7852682, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/846c3df5348d19c9aa28e61e35d11498?s=128&d=identicon&r=PG&f=1", "display_name": "slal", "link": "https://stackoverflow.com/users/7852682/slal"}, "is_accepted": true, "score": 0, "last_activity_date": 1510612738, "last_edit_date": 1510612738, "creation_date": 1510612425, "answer_id": 47274669, "question_id": 47274149, "link": "https://stackoverflow.com/questions/47274149/access-value-inside-params-hash/47274669#47274669", "title": "Access value inside params hash", "body": "<p>Your hash is not valid:</p>\n\n<pre><code>{\n    \"utf8\" =&gt; \"\u2713\",\n    \"authenticity_token\" =&gt; \".......\", \n    \"temp_file_path\" =&gt; { \"value\" =&gt; \"/home/utils/rails/fw_export/tmp/1510608598.csv\\\" }, \n    \"button\" =&gt; \"\"\n }\n</code></pre>\n\n<p>The above would be a valid hash.</p>\n\n<p>You can access it as: <code>params[\"temp_file_path\"][\"value\"]</code></p>\n\n<p>Also, symbolizing the keys will let you access the hash using symbols.\nSeep symbolizing symbolizes nested hashes:\n<a href=\"https://apidock.com/rails/Hash/deep_symbolize_keys\" rel=\"nofollow noreferrer\">https://apidock.com/rails/Hash/deep_symbolize_keys</a></p>\n\n<pre><code>params.deep_symbolize_keys\n</code></pre>\n\n<p>Now you can access it as: <code>params[:temp_file_path][:value]</code></p>\n"}], "owner": {"reputation": 5241, "user_id": 1016958, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/88b80a2d90163023d2c88893c6a13491?s=128&d=identicon&r=PG", "display_name": "EastsideDev", "link": "https://stackoverflow.com/users/1016958/eastsidedev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 47274669, "answer_count": 1, "score": 0, "last_activity_date": 1510618633, "creation_date": 1510609837, "last_edit_date": 1510618633, "question_id": 47274149, "link": "https://stackoverflow.com/questions/47274149/access-value-inside-params-hash", "title": "Access value inside params hash", "body": "<pre><code>Rails 5\n</code></pre>\n\n<p>I am trying to access one of the params</p>\n\n<pre><code>Parameters: {\n  \"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\".......\", \n  \"temp_file_path\"=&gt;\"{:value=&gt;\\\"/home/utils/rails/fw_export/tmp/1510608598.csv\\\"}\", \n  \"button\"=&gt;\"\"\n}\n</code></pre>\n\n<p>specifically, temp_file_path. I tried:</p>\n\n<pre><code>temp_file_path = params[:temp_file_path][:value]\n</code></pre>\n\n<p>But I am getting an error:</p>\n\n<pre><code>TypeError (no implicit conversion of Symbol into Integer):\n</code></pre>\n\n<p>How do I access the value?</p>\n\n<p>I also tried params[\"temp_file_path\"][:value]</p>\n\n<h1>Solution:</h1>\n\n<p>I was passing the temp_file_file path as part of the params, as follows (from a View):</p>\n\n<pre><code>= hidden_field_tag :temp_file_path, :value =&gt; temp_file_path\n</code></pre>\n\n<p>I changed it to:</p>\n\n<pre><code> = hidden_field_tag :temp_file_path, temp_file_path\n</code></pre>\n\n<p>and  now the value is accessible as:</p>\n\n<pre><code>params[:temp_file_path]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-maps", "geocoder"], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 7302402, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EdRp6.jpg?s=128&g=1", "display_name": "James Mureithi", "link": "https://stackoverflow.com/users/7302402/james-mureithi"}, "is_accepted": true, "score": 1, "last_activity_date": 1510677008, "creation_date": 1510677008, "answer_id": 47290747, "question_id": 47273021, "link": "https://stackoverflow.com/questions/47273021/geocoder-s-gem-near-method-not-working-on-rails-5/47290747#47290747", "title": "Geocoder,s gem near method not working on rails 5", "body": "<pre><code>t.string \"longitude\"\nt.string \"latitude\"\n</code></pre>\n\n<p>Had saved up my coordinates in the database with the string data-type which is wrong ,the coordinates should be saved with the float data attribute.This solved my problem for anyone that maybe experiencing the same problem.Its a good place to start checking.</p>\n"}], "owner": {"reputation": 27, "user_id": 7302402, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EdRp6.jpg?s=128&g=1", "display_name": "James Mureithi", "link": "https://stackoverflow.com/users/7302402/james-mureithi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 1, "accepted_answer_id": 47290747, "answer_count": 1, "score": 0, "last_activity_date": 1510677008, "creation_date": 1510604975, "last_edit_date": 1510643584, "question_id": 47273021, "link": "https://stackoverflow.com/questions/47273021/geocoder-s-gem-near-method-not-working-on-rails-5", "title": "Geocoder,s gem near method not working on rails 5", "body": "<p>Been trying to use the geocoder gem to find locations using the geocoders method near for finding certain locations near to certain points.</p>\n\n<pre><code>def index\n  @data = Datum.all\n\n   @emergency = Emergency.last\n   @data_near = Datum.near([@emergency.longitude,@emergency.latitude],100,:units =&gt; :km)\n\n  @geojson = Array.new\n\n  @data_near.each do |mapdata|\n     @geojson &lt;&lt; {\n          type: 'Feature',\n          geometry: {\n            type: 'Point',\n            coordinates: [mapdata.longitude, mapdata.latitude]\n          },\n          properties: {\n            name: mapdata.description,\n            address: mapdata.address,\n            BusType: 'hospital',\n            popupContent: \"#{mapdata.address} is a #{mapdata.description}\",\n            :'marker-color' =&gt; '#00607d',\n            :'marker-symbol' =&gt; 'circle',\n            :'marker-size' =&gt; 'medium'\n          }\n        }\n  end\n  respond_to do |format|\n     format.html\n     format.json{ render json: @geojson }\n  end\n</code></pre>\n\n<p>end</p>\n\n<p>That's the code i am trying to run,it returns an empty array even when the  locations near within the specified parameters are present. When i try to run the code directly in the rails console with real points.eg.</p>\n\n<pre><code>data = Datum.near([36.7689503,-1.381776],10,:units =&gt; :km)\n</code></pre>\n\n<p>I do not get any error generated but the output i get is less than readable or comprehensible.The output is:</p>\n\n<pre><code>Datum Load (0.3ms)  SELECT  data.*, (111.19492664455873 * ABS(data.latitude - 36.7689503) * 0.7071067811865475) + (96.29763124613503 * ABS(data.longitude - -1.381776) * 0.7071067811865475) AS distance, CASE WHEN (data.latitude &gt;= 36.7689503 AND data.longitude &gt;= -1.381776) THEN  45.0 WHEN (data.latitude &lt;  36.7689503 AND data.longitude &gt;= -1.381776) THEN 135.0 WHEN (data.latitude &lt;  36.7689503 AND data.longitude &lt;  -1.381776) THEN 225.0 WHEN (data.latitude &gt;= 36.7689503 AND data.longitude &lt;  -1.381776) THEN 315.0 END AS bearing FROM \"data\" WHERE (data.latitude BETWEEN 36.67901813940813 AND 36.85888246059187 AND data.longitude BETWEEN -1.4940430256783075 AND -1.2695089743216923) ORDER BY distance ASC LIMIT ?  [[\"LIMIT\", 11]]\n\n\n\n\n =&gt; #&lt;ActiveRecord::Relation []&gt; \n</code></pre>\n\n<p>Any help will be highly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano", "capistrano3"], "comments": [{"owner": {"reputation": 3590, "user_id": 1494245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50a2dcc33b58918f27664b7646d92b7?s=128&d=identicon&r=PG", "display_name": "Sean Huber", "link": "https://stackoverflow.com/users/1494245/sean-huber"}, "edited": false, "score": 0, "creation_date": 1510608196, "post_id": 47272382, "comment_id": 81498699, "body": "Can you post the contents of your <code>Capfile</code>?"}, {"owner": {"reputation": 687, "user_id": 3233012, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc105048929115fbad945f521cd249b2?s=128&d=identicon&r=PG", "display_name": "zPrima", "link": "https://stackoverflow.com/users/3233012/zprima"}, "reply_to_user": {"reputation": 3590, "user_id": 1494245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50a2dcc33b58918f27664b7646d92b7?s=128&d=identicon&r=PG", "display_name": "Sean Huber", "link": "https://stackoverflow.com/users/1494245/sean-huber"}, "edited": false, "score": 0, "creation_date": 1510608950, "post_id": 47272382, "comment_id": 81499059, "body": "@SeanHuber added"}], "owner": {"reputation": 687, "user_id": 3233012, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc105048929115fbad945f521cd249b2?s=128&d=identicon&r=PG", "display_name": "zPrima", "link": "https://stackoverflow.com/users/3233012/zprima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510608935, "creation_date": 1510602587, "last_edit_date": 1510608935, "question_id": 47272382, "link": "https://stackoverflow.com/questions/47272382/capistrano-deploy-http-error-503", "title": "Capistrano deploy, http error 503", "body": "<p>Using capistrano for deploying on server nginx+puma. But for some reason if i access the page too quickly, or if somebody is on the page, it gives a 503 HTTP Error page. They I usually just redeploy again and again until it works or i either kill Puma and redeploy again to see if that fixed it. I imagine there is a better way to do this? Or is my deploying process missing something?</p>\n\n<pre><code>  gem 'capistrano', '~&gt; 3.10.0', require: false\n  gem 'capistrano-rails', require: false\n  gem 'capistrano-bundler', require: false\n  gem 'capistrano-rvm', require: false\n  gem 'capistrano3-puma', '~&gt; 3.1', '&gt;= 3.1.1', require: false\n  gem 'capistrano-rails-console', require: false\n  gem 'capistrano-rake', require: false\n\n# Load DSL and set up stages\nrequire \"capistrano/setup\"\n\n# Include default deployment tasks\nrequire \"capistrano/deploy\"\n\nrequire \"capistrano/scm/git\"\ninstall_plugin Capistrano::SCM::Git\n\nrequire 'capistrano/rvm'\nrequire 'capistrano/bundler'\nrequire 'capistrano/rails/assets' # for asset handling add\nrequire 'capistrano/rails/migrations' # for running migrations\n\nrequire 'capistrano/puma'\ninstall_plugin Capistrano::Puma  # Default puma tasks\ninstall_plugin Capistrano::Puma::Workers\ninstall_plugin Capistrano::Puma::Nginx\n\nrequire 'capistrano/rails/console'\nrequire \"whenever/capistrano\"\nrequire 'capistrano/rake'\n\nDir.glob(\"lib/capistrano/tasks/*.rake\").each { |r| import r }\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1510604997, "post_id": 47271911, "comment_id": 81496979, "body": "<code>Response</code> instance variable <code>@conn</code> is never set and will always be <code>nil</code> I think this is an issue. Also right now you are trying to call <code>Response.get</code> but <code>get</code> is an instance method so maybe try initializing <code>@response</code> as <code>@response = Portal.new self, Response.new(conn,{})</code>"}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 8856886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4accabd97a988bebed57887da7b89224?s=128&d=identicon&r=PG&f=1", "display_name": "bRRRITSCOLD", "link": "https://stackoverflow.com/users/8856886/brrritscold"}, "is_accepted": true, "score": 0, "last_activity_date": 1514656812, "creation_date": 1514656812, "answer_id": 48036517, "question_id": 47271911, "link": "https://stackoverflow.com/questions/47271911/ruby-portal-new-parent-klass/48036517#48036517", "title": "Ruby portal.new parent, klass", "body": "<p>Response instance variable @conn is never set and will always be nil I think this is an issue. Also right now you are trying to call Response.get but get is an instance method so maybe try initializing @response as @response = Portal.new self, Response.new(conn,{}) </p>\n\n<p>Via:  engineersmnky Nov 13 at 20:29</p>\n"}], "owner": {"reputation": 45, "user_id": 8856886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4accabd97a988bebed57887da7b89224?s=128&d=identicon&r=PG&f=1", "display_name": "bRRRITSCOLD", "link": "https://stackoverflow.com/users/8856886/brrritscold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 48036517, "answer_count": 1, "score": 1, "last_activity_date": 1514656812, "creation_date": 1510600734, "question_id": 47271911, "link": "https://stackoverflow.com/questions/47271911/ruby-portal-new-parent-klass", "title": "Ruby portal.new parent, klass", "body": "<p>So I am simply trying to create a Client class inside a Module and then use a Portal Class inside the Client initialize method to create a Response class. I am trying yo create a way that will allow the Client class access to the Response class methods and instance_variables. Below is a rough ruby file and module/class architecture I have created to test all of this:</p>\n\n<pre><code>module Test\n    class Client\n\n        attr_accessor :response\n\n        def initialize\n            conn\n            @response = Portal.new self, Response\n        end\n\n        def conn\n            @conn = Faraday.new(:url =&gt; 'http://api.openweathermap.org') do |faraday|\n                faraday.request  :url_encoded             # form-encode POST params\n                faraday.response :logger                  # log requests to STDOUT\n                faraday.adapter  Faraday.default_adapter  # make requests with Net::HTTP\n            end\n        end\n    end\n\n    class Portal\n        def initialize parent, klass\n            @parent = parent\n            @klass = klass\n        end\n\n        def method_missing method, *args, &amp;block\n            @klass.public_send method, @parent, *args, &amp;block\n        end\n    end\n\n    class Response\n\n        attr_accessor :conn, :res\n\n        def initialize client, params\n            @client = client\n            conn\n        end\n\n        def conn\n            @conn\n        end\n\n        def get\n            @res = conn.get do |req|\n                    req.url '/data/2.5/weather'\n                    req.params['q'] = @city_country_state\n                    req.params['APPID'] = @consumer_api_key\n                    req.params['units'] = @units\n                end\n        end\n    end\nend\n</code></pre>\n\n<p>using binding.pry I \"tested\" my program and received the following with only the error occurring in the end:</p>\n\n<pre><code>[1] pry(main)&gt; new = Test::Client.new\n=&gt; #&lt;Test::Client:0x00007fbaca975540\n @conn=\n  #&lt;Faraday::Connection:0x00007fbaca975310.....&gt;\n@response=\n  #&lt;Test::Portal:0x00007fbaca96e1c8\n   @klass=Test::Response,\n   @parent=#&lt;Test::Client:0x00007fbaca975540 ...&gt;&gt;&gt;\n</code></pre>\n\n<p>After creating and seeing the Portal class creating a Test::Response class inside, I check the Test::Client @response variable:</p>\n\n<pre><code>[2] pry(main)&gt; new.response\n=&gt; #&lt;Test::Portal:0x00007fbaca96e1c8\n @klass=Test::Response,\n @parent=\n  #&lt;Test::Client:0x00007fbaca975540.....&gt;\n</code></pre>\n\n<p>Since the @response variable was set correctly and inherited correctly I move to trying and call Test::Response.get from within new = Test::Client.new:</p>\n\n<pre><code>[3] pry(main)&gt; new.response.get\nNoMethodError: undefined method `get' for Test::Response:Class\nfrom test.rb:47:in `public_send'\n</code></pre>\n\n<p>Line 47 in test.rb refers to the Test::Portal line of:</p>\n\n<p><code>@klass.public_send method, @parent, *args, &amp;block</code></p>\n\n<p>inside the <code>method_missing</code> function:</p>\n\n<pre><code>def method_missing method, *args, &amp;block\n    @klass.public_send method, @parent, *args, &amp;block\nend\n</code></pre>\n\n<p>How do I allow the created Test::Client object to use the get method inside Test::Response and set @conn using the Test::Client's @conn and conn method in the initialize method.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 26589, "user_id": 1032785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30816b3d787c2bd9d6f036318304f225?s=128&d=identicon&r=PG", "display_name": "jordanm", "link": "https://stackoverflow.com/users/1032785/jordanm"}, "edited": false, "score": 0, "creation_date": 1510599014, "post_id": 47271306, "comment_id": 81493716, "body": "No, not unless there is a way to eager load that which I am not aware of."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 26589, "user_id": 1032785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30816b3d787c2bd9d6f036318304f225?s=128&d=identicon&r=PG", "display_name": "jordanm", "link": "https://stackoverflow.com/users/1032785/jordanm"}, "edited": false, "score": 0, "creation_date": 1510599306, "post_id": 47271306, "comment_id": 81493876, "body": "Updated my answer."}, {"owner": {"reputation": 26589, "user_id": 1032785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30816b3d787c2bd9d6f036318304f225?s=128&d=identicon&r=PG", "display_name": "jordanm", "link": "https://stackoverflow.com/users/1032785/jordanm"}, "edited": false, "score": 0, "creation_date": 1510603180, "post_id": 47271306, "comment_id": 81496021, "body": "Sorry, I had tried this previously and should have included that attempt in my original question. Updated with the issue I had with it."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1510599283, "last_edit_date": 1510599283, "creation_date": 1510598321, "answer_id": 47271306, "question_id": 47271102, "link": "https://stackoverflow.com/questions/47271102/eager-loading-sibling-records-without-including-self/47271306#47271306", "title": "Eager loading sibling records without including self", "body": "<p>What about adding a scope:</p>\n\n<pre><code>has_many :other_instances,\n         source: :foo,\n         class_name: 'Foo',\n         foreign_key: 'event_id',\n         primary_key: 'event_id', \n         -&gt;(foo) { where.not(id: foo.id) }\n</code></pre>\n"}], "owner": {"reputation": 26589, "user_id": 1032785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30816b3d787c2bd9d6f036318304f225?s=128&d=identicon&r=PG", "display_name": "jordanm", "link": "https://stackoverflow.com/users/1032785/jordanm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510603167, "creation_date": 1510597615, "last_edit_date": 1510603167, "question_id": 47271102, "link": "https://stackoverflow.com/questions/47271102/eager-loading-sibling-records-without-including-self", "title": "Eager loading sibling records without including self", "body": "<p>For serialization I want to include an array of sibling records which shares a common foreign key. I currently have the following:</p>\n\n<pre><code>class Foo &lt; ActiveRecord::Base\n  has_many :other_instances,\n           source: :foo,\n           class_name: 'Foo',\n           foreign_key: 'event_id',\n           primary_key: 'event_id'\n</code></pre>\n\n<p>When used in an include, it produces the following queries:</p>\n\n<pre><code>  Foo Load (0.2ms)  SELECT  \"foo\".* FROM \"foo\" WHERE \"foo\".\"id\" = $1 LIMIT 1  [[\"id\", 21138]]\n  Foo Load (0.4ms)  SELECT \"foo\".* FROM \"foo\" WHERE \"foo\".\"event_id\" IN (11451)\n</code></pre>\n\n<p>This mostly works, but the issue is that <code>Foo.other_instances</code> includes itself. Is there any way to exclude that additional record in rails? The expected <code>includes</code> would look something like this:</p>\n\n<pre><code>  Foo Load (0.4ms)  SELECT \"foo\".* FROM \"foo\" WHERE \"foo\".\"event_id\" IN (11451) AND \"foo\".\"id\" NOT IN (21138)\n</code></pre>\n\n<p>Update:</p>\n\n<p>Attempting to make the condition instance dependent as in @spikermann's results in the following:</p>\n\n<p>Code:</p>\n\n<pre><code>has_many :other_instances,\n         source: :foo,\n         class_name: 'Foo',\n         foreign_key: 'event_id',\n         primary_key: 'event_id', \n         -&gt;(foo) { where.not(id: foo.id) }\n</code></pre>\n\n<p>Called with:</p>\n\n<pre><code>Foo.includes(:other_instances).find(21138)\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>DEPRECATION WARNING: The association scope 'other_instances' is instance dependent (the scope block takes an argument). Preloading happens before the individual instances are created. This means that there is no instance being passed to the association scope. This will most likely result in broken or incorrect behavior. Joining, Preloading and eager loading of these associations is deprecated and will be removed in the future. (called from check_preloadable! at /home/jordan/prog/knotweed/vendor/bundle/gems/activerecord-4.2.7.1/lib/active_record/reflection.rb:362)\nNoMethodError: undefined method `id' for nil:NilClass\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "has-scope"], "answers": [{"comments": [{"owner": {"reputation": 2545, "user_id": 6200054, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gRG06.jpg?s=128&g=1", "display_name": "zshanabek", "link": "https://stackoverflow.com/users/6200054/zshanabek"}, "edited": false, "score": 0, "creation_date": 1510602414, "post_id": 47271277, "comment_id": 81495595, "body": "I put scope which you suggested me. There is an error."}, {"owner": {"reputation": 2545, "user_id": 6200054, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gRG06.jpg?s=128&g=1", "display_name": "zshanabek", "link": "https://stackoverflow.com/users/6200054/zshanabek"}, "edited": false, "score": 0, "creation_date": 1510629858, "post_id": 47271277, "comment_id": 81505285, "body": "&quot;#&lt;ActiveRecord::StatementInvalid: PG::SyntaxError: ERROR:  zero-length delimited identifier at or near``"}, {"owner": {"reputation": 2545, "user_id": 6200054, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gRG06.jpg?s=128&g=1", "display_name": "zshanabek", "link": "https://stackoverflow.com/users/6200054/zshanabek"}, "edited": false, "score": 0, "creation_date": 1510631250, "post_id": 47271277, "comment_id": 81505640, "body": "I wrote last command in rails console and there is above error."}, {"owner": {"reputation": 2545, "user_id": 6200054, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gRG06.jpg?s=128&g=1", "display_name": "zshanabek", "link": "https://stackoverflow.com/users/6200054/zshanabek"}, "edited": false, "score": 2, "creation_date": 1510632247, "post_id": 47271277, "comment_id": 81505891, "body": "The error appeared because there is no primary key in IndustryUser. I added column id as primary key. and now it works. Thank you"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 1, "last_activity_date": 1510598231, "creation_date": 1510598231, "answer_id": 47271277, "question_id": 47271079, "link": "https://stackoverflow.com/questions/47271079/filter-objects-with-many-to-many-table-in-rails-using-has-scope/47271277#47271277", "title": "Filter objects with many-to-many table in Rails using has_scope", "body": "<p>I <em>think</em> it's going to be something like: </p>\n\n<pre><code>scope: by_industry, -&gt; industry {User.joins(:industry_users).where(industry_users: {id: IndustryUser.where(industry: Industry.where(id: industry))})}\n</code></pre>\n\n<p>This bit finds the correct industry:</p>\n\n<pre><code>Industry.where(id: industry)\n</code></pre>\n\n<p>This bit finds <code>IndustryUser</code> records that reference the just-found <code>Industry</code>:</p>\n\n<pre><code>IndustryUser.where(industry: Industry.where(id: industry))\n</code></pre>\n\n<p>And then you join on the found <code>industry_users</code> to find <code>User</code>s that are reference by the <code>industry_users</code>.</p>\n\n<pre><code>User.joins(:industry_users).where(industry_users: {id: IndustryUser.where(industry: Industry.where(id: industry))})\n</code></pre>\n"}], "owner": {"reputation": 2545, "user_id": 6200054, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/gRG06.jpg?s=128&g=1", "display_name": "zshanabek", "link": "https://stackoverflow.com/users/6200054/zshanabek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 47271277, "answer_count": 1, "score": 0, "last_activity_date": 1510598231, "creation_date": 1510597522, "question_id": 47271079, "link": "https://stackoverflow.com/questions/47271079/filter-objects-with-many-to-many-table-in-rails-using-has-scope", "title": "Filter objects with many-to-many table in Rails using has_scope", "body": "<p>There are two tables: User and Industry. User can relate to many industries and a lot of users belong to one Industry.</p>\n\n<p>Industry.rb</p>\n\n<pre><code>class Industry &lt;ApplicationRecord\n\u00a0\u00a0\u00a0\u00a0has_many: users,: through =&gt;: industry_users\n\u00a0\u00a0\u00a0\u00a0has_many: industry_users\nend\n</code></pre>\n\n<p>User.rb</p>\n\n<pre><code>class User &lt;ApplicationRecord\n\n\u00a0\u00a0belongs_to: specialty\n\u00a0\u00a0has_many: industries,: through =&gt;: industry_users\n\u00a0\u00a0has_many: industry_users\n\n\u00a0\u00a0scope: by_specialty, -&gt; specialty {where (: specialty_id =&gt; specialty)}\n\u00a0\u00a0scope: by_period, -&gt; started_at, ended_at {where (\"graduation_date&gt; =? AND graduation_date &lt;=?\", started_at, ended_at)}\nend\n</code></pre>\n\n<p>IndustryUser.rb</p>\n\n<p>The relationship between them is many_to_many.\nThere is a third table IndustryUser which stores two columns.</p>\n\n<pre><code>class IndustryUser &lt;ApplicationRecord\n\u00a0\u00a0\u00a0\u00a0belongs_to: user\n\u00a0\u00a0\u00a0\u00a0belongs_to: industry\nend\n</code></pre>\n\n<p>Now I'm developing an API. I use has_scope gem to filter users by parameters in get request. Above, I successfully filtered them on the specialty and the date of graduation.\nFor example, filtering on the specialty.</p>\n\n<pre><code>http://localhost:3000/v1/users?by_specialty=1\n</code></pre>\n\n<p>Filtering by the date of graduation. You should provide period of time.</p>\n\n<pre><code>http://localhost:3000/v1/users?\nby_period[started_at]=20040101&amp;by_period[ended_at]=20070101\n</code></pre>\n\n<p>I got stuck when I wanted to get users who belong to a particular industry.\nHere is an example of a get query</p>\n\n<pre><code>http://localhost:3000/v1/users?by_industry=2\n</code></pre>\n\n<p>For example. Here, I want it to render all users who are related to the second industry.\nDoes anyone know how to filter objects that relate to many-to-many relations using has_scope?</p>\n"}, {"tags": ["ruby", "rspec", "require", "before-filter"], "comments": [{"owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "edited": false, "score": 0, "creation_date": 1510604100, "post_id": 47270064, "comment_id": 81496529, "body": "I know that <code>require</code> is always executed at the top level of the Ruby script (the <code>main</code> special object) even if it is called from a deeper level or encapsulated in something. That&#39;s why you receive the error <code>undefined method &#39;before&#39; for main:Object</code>."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1510594684, "creation_date": 1510594684, "answer_id": 47270300, "question_id": 47270064, "link": "https://stackoverflow.com/questions/47270064/how-to-use-require-relative-with-an-rspec-test/47270300#47270300", "title": "How to use require_relative with an rspec test?", "body": "<p>Just add this to your <code>spec_helper.rb</code> in the <code>RSpec.configure</code> block:</p>\n\n<pre><code>RSpec.configure do |config|\n  config.before :all do\n    CONTINUE_SPEC= true\n  end\n\n  config.around :each do |example|\n    if CONTINUE_SPEC\n      CONTINUE_SPEC = false\n      example.run\n      CONTINUE_SPEC = true unless example.exception\n    else\n      example.skip\n    end\n  end\n\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 47270300, "answer_count": 1, "score": -1, "last_activity_date": 1510594684, "creation_date": 1510593833, "question_id": 47270064, "link": "https://stackoverflow.com/questions/47270064/how-to-use-require-relative-with-an-rspec-test", "title": "How to use require_relative with an rspec test?", "body": "<p>I have an rspec test, i.e. describe and an it</p>\n\n<p>I want to add <code>before :all</code> and <code>before :each</code> behavior</p>\n\n<p>I can add it by putting in the test spec file directly, i.e.</p>\n\n<pre><code>describe \"test\" do\n  before :all do\n    CONTINUE_SPEC= true\n  end\n\n  around :each do |example|\n    if CONTINUE_SPEC\n      CONTINUE_SPEC = false\n      example.run\n      CONTINUE_SPEC = true unless example.exception\n    else\n      example.skip\n    end\n  end\n  ... actual tests...\n</code></pre>\n\n<p>However I want to have it in nearly every spec so I thought I could use a <code>require_relative</code> statement to make it easy.  However when I transfer the code to a file using require_relative with</p>\n\n<pre><code>require_relative '../../support/continue_test_if_passing'\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>Failure/Error:\n  before :all do\n    CONTINUE_SPEC= true\n  end\n\nNoMethodError:\n  undefined method `before' for main:Object\n</code></pre>\n"}, {"tags": ["java", "ruby", "windows", "elasticsearch", "logstash"], "comments": [{"owner": {"reputation": 3887, "user_id": 6113627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zNUc0.jpg?s=128&g=1", "display_name": "baudsp", "link": "https://stackoverflow.com/users/6113627/baudsp"}, "edited": false, "score": 0, "creation_date": 1510656308, "post_id": 47269718, "comment_id": 81517400, "body": "On windows, you should use the logstash.bat."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7258026, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/FNlWz.jpg?s=128&g=1", "display_name": "C.J.A.", "link": "https://stackoverflow.com/users/7258026/c-j-a"}, "edited": false, "score": 0, "creation_date": 1510594543, "post_id": 47270049, "comment_id": 81491322, "body": "i&#39;ve done that and it keeps giving me this error now &quot;could not find java; set JAVA_HOME or ensure java is in PATH&quot; - JAVA is in both JAVA_HOME and PATH"}, {"owner": {"reputation": 5119, "user_id": 44355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WZ3p5.jpg?s=128&g=1", "display_name": "david a.", "link": "https://stackoverflow.com/users/44355/david-a"}, "reply_to_user": {"reputation": 35, "user_id": 7258026, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/FNlWz.jpg?s=128&g=1", "display_name": "C.J.A.", "link": "https://stackoverflow.com/users/7258026/c-j-a"}, "edited": false, "score": 0, "creation_date": 1510647185, "post_id": 47270049, "comment_id": 81511636, "body": "note: JAVA_HOME must be set to the Java installation directory. See Yuvraj Gupta&#39;s answer for an example."}], "tags": [], "owner": {"reputation": 5119, "user_id": 44355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WZ3p5.jpg?s=128&g=1", "display_name": "david a.", "link": "https://stackoverflow.com/users/44355/david-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1510593791, "creation_date": 1510593791, "answer_id": 47270049, "question_id": 47269718, "link": "https://stackoverflow.com/questions/47269718/logstash-with-windows-shows-java-error/47270049#47270049", "title": "Logstash with Windows shows JAVA error", "body": "<p>You need to set <code>JAVA_HOME</code> system variable, that needs to point to your Java installation directory. </p>\n"}, {"tags": [], "owner": {"reputation": 2289, "user_id": 3678433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C3npm.jpg?s=128&g=1", "display_name": "Yuvraj Gupta", "link": "https://stackoverflow.com/users/3678433/yuvraj-gupta"}, "is_accepted": true, "score": 0, "last_activity_date": 1510642806, "creation_date": 1510642806, "answer_id": 47279519, "question_id": 47269718, "link": "https://stackoverflow.com/questions/47269718/logstash-with-windows-shows-java-error/47279519#47279519", "title": "Logstash with Windows shows JAVA error", "body": "<p>You need to set both the Java_Home property and add in PATH property such as mentioned below:-</p>\n\n<pre><code>JAVA_HOME = C:\\Program Files\\Java\\jre1.8.0_151 \nPATH = C:\\Program Files\\Java\\jre1.8.0_151\\bin\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7258026, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/FNlWz.jpg?s=128&g=1", "display_name": "C.J.A.", "link": "https://stackoverflow.com/users/7258026/c-j-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 47279519, "answer_count": 2, "score": 0, "last_activity_date": 1510642806, "creation_date": 1510592581, "question_id": 47269718, "link": "https://stackoverflow.com/questions/47269718/logstash-with-windows-shows-java-error", "title": "Logstash with Windows shows JAVA error", "body": "<p>Logstash is giving me this error: \"Cannot find Java 1.5 or higher.\"</p>\n\n<p>The command I'm running is \"bin\\logstash -f \\mypath\\logstash-simple.conf\"</p>\n\n<p>I DO NOT have ruby installed on my windows 10 computer.\nI have JAVA my PATH. \"C:\\Program Files\\Java\\jre1.8.0_151\\bin\"</p>\n\n<p>How do I fix this issue? Do I need ruby?</p>\n"}]