[{"tags": ["ruby-on-rails", "ruby", "linux", "bash", "shell"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 5, "creation_date": 1557963770, "post_id": 56158878, "comment_id": 98946523, "body": "What is <code>cmd</code>? As a note, <code>popen3</code> will launch <code>sh</code> and <i>not</i> <code>bash</code> and <a href=\"https://ruby-doc.org/core-2.6.3/Process.html#method-c-spawn\" rel=\"nofollow noreferrer\">I&#39;m not sure it pays attention to the <code>SHELL</code> environment variable</a>. Using <code>popen3</code> with separated arguments is the way to go here, not one big shell string, as then you have more control over what happens. <code>bash -c ...</code> or <code>bash x.sh</code> may be what you want. You can also open <code>bash</code> directly and use <code>stdin</code> to supply the script by writing to it."}], "answers": [{"tags": [], "owner": {"reputation": 186, "user_id": 1911291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9d3fac042abb5ba26bf64ea0c7f756?s=128&d=identicon&r=PG", "display_name": "Stephan", "link": "https://stackoverflow.com/users/1911291/stephan"}, "is_accepted": true, "score": 5, "last_activity_date": 1585412997, "last_edit_date": 1585412997, "creation_date": 1557973105, "answer_id": 56159907, "question_id": 56158878, "link": "https://stackoverflow.com/questions/56158878/how-to-make-ruby-compatible-with-bash/56159907#56159907", "title": "How to make Ruby compatible with bash", "body": "<p>Presuming you want the shell builtin <code>pushd</code>, you'd need to explicitly call bash in your system command, as ruby doesn't reference your $SHELL variable.  Something like:</p>\n\n<pre><code>require 'open3'\nrequire 'shellwords'\nOpen3.popen3(\"bash -c #{Shellwords.escape(cmd)}\")\n\n</code></pre>\n\n<p>should do the trick.</p>\n"}], "owner": {"reputation": 1958, "user_id": 5553963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e043e536e9b6017ab7a9c38c219f7ad?s=128&d=identicon&r=PG&f=1", "display_name": "AVarf", "link": "https://stackoverflow.com/users/5553963/avarf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 56159907, "answer_count": 1, "score": 0, "last_activity_date": 1585412997, "creation_date": 1557962866, "question_id": 56158878, "link": "https://stackoverflow.com/questions/56158878/how-to-make-ruby-compatible-with-bash", "title": "How to make Ruby compatible with bash", "body": "<p>I have a ruby script that uses <code>open3</code> to run shell commands from inside the script and I am using Ubuntu 18.04 and bash.</p>\n\n<p>When I run that script it produces errors such as <code>0: sh: 2: pushd: not found</code>. I searched and one thing I found was <a href=\"https://stackoverflow.com/a/17044484/5553963\">https://stackoverflow.com/a/17044484/5553963</a> which suggested that we use <code>ENV[\"SHELL\"] = \"/bin/bash\"</code> but when I checked my environment variable I already have that:</p>\n\n<pre><code>$ printenv \"SHELL\"\n/bin/bash\n</code></pre>\n\n<p>How I can make this script working on my machine?</p>\n\n<p>The first part of that script:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'open3'\n\ndef run(i, cmd)\n    res = \"\"\n    Open3.popen3(cmd) do |stdin, stdout, stderr, thread|\n</code></pre>\n\n<p>And my ruby version: <code>ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux-gnu]</code></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 3, "creation_date": 1557977313, "post_id": 56158869, "comment_id": 98948795, "body": "What book provided that code sample, so I can be sure never to recommend it?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1557991462, "post_id": 56158869, "comment_id": 98953333, "body": "I would like to second anotherm&#39;s comment. Please, tell us what book this is, so we can warn others. This code has not worked since at least Ruby 1.8, which was released in 2003 and end-of-lifed in 2013. (In fact, I don&#39;t think this code has <i>ever</i> worked in <i>any</i> version of Ruby, and even if it <i>did</i> work, it wouldn&#39;t do what the code tries to do.)"}, {"owner": {"reputation": 33, "user_id": 2333747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de3e777bd157718d10daa48bc449fb0d?s=128&d=identicon&r=PG", "display_name": "Richard Osborne", "link": "https://stackoverflow.com/users/2333747/richard-osborne"}, "edited": false, "score": 0, "creation_date": 1558106946, "post_id": 56158869, "comment_id": 99004012, "body": "The book is &quot; The Ultimate Guide to Ruby Programming&quot;    Copyright (c) 2006-2016 Satish Talim <a href=\"http://satishtalim.com/\" rel=\"nofollow noreferrer\">satishtalim.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1557964346, "post_id": 56159050, "comment_id": 98946635, "body": "Note: Ruby is a case-sensitive language and capital letters have specific meaning in terms of syntax. Variables and method names should be lower-case letters. Capitals indicate constants of the form  <code>ClassName</code> or <code>CONSTANT_NAME</code>."}, {"owner": {"reputation": 1095, "user_id": 5004690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6LQZv.jpg?s=128&g=1", "display_name": "TamerB", "link": "https://stackoverflow.com/users/5004690/tamerb"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1557964928, "post_id": 56159050, "comment_id": 98946748, "body": "I agree that using camelcase in function is not the convention in Ruby. But it will not cause an error."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1557966657, "post_id": 56159050, "comment_id": 98947039, "body": "It&#39;s very strongly discouraged. <a href=\"https://github.com/rubocop-hq/rubocop\" rel=\"nofollow noreferrer\">Rubocop</a> will give you a citation for doing this."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1557979718, "post_id": 56159050, "comment_id": 98949288, "body": "&quot;<code>return</code> is used inside functions&quot; \u2013 This is wrong. There are no functions in Ruby. There are methods, blocks, lambda literals, modules, classes, and scripts, but no functions."}, {"owner": {"reputation": 1095, "user_id": 5004690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6LQZv.jpg?s=128&g=1", "display_name": "TamerB", "link": "https://stackoverflow.com/users/5004690/tamerb"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1558008169, "post_id": 56159050, "comment_id": 98962704, "body": "@tadman that is correct. Rubycop will give a citation. What I meant is that it will not affect the functionality of the code. Thank you for the note, I updated my answer."}, {"owner": {"reputation": 1095, "user_id": 5004690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6LQZv.jpg?s=128&g=1", "display_name": "TamerB", "link": "https://stackoverflow.com/users/5004690/tamerb"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1558008596, "post_id": 56159050, "comment_id": 98962937, "body": "@J&#246;rgWMittag . Thank you for the note. Yes Ruby has only methods, not functions. But I think everyone read my answer did understand what I&#39;m pointing at. And that&#39;s the main purpose of my answer. updated my answer though for accuracy."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1558027592, "post_id": 56159050, "comment_id": 98974008, "body": "It might seem like a little thing but your original code read like Ruby code written by someone with a Python or JavaScript accent. Expressing it in true Ruby form is especially important for educational contexts like this one. Thanks for making the fix."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558458914, "post_id": 56159050, "comment_id": 99105384, "body": "Please select the one and only answer to date if you found it helpful."}], "tags": [], "owner": {"reputation": 1095, "user_id": 5004690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6LQZv.jpg?s=128&g=1", "display_name": "TamerB", "link": "https://stackoverflow.com/users/5004690/tamerb"}, "is_accepted": false, "score": -2, "last_activity_date": 1558203364, "last_edit_date": 1558203364, "creation_date": 1557964289, "answer_id": 56159050, "question_id": 56158869, "link": "https://stackoverflow.com/questions/56158869/why-is-this-code-from-ruby-book-not-working/56159050#56159050", "title": "Why is this code from Ruby book not working?", "body": "<p><code>return</code> is used inside methods. You are using it without one.</p>\n\n<p>Try the following:</p>\n\n<pre><code>def get_my_result\n    10.times do |num|\n        square=num*num\n        return num,square\n    end\nend\n\nget_my_result()\n</code></pre>\n\n<p>Note: With this code, the loop will execute only once and return the value [0, 0]</p>\n"}, {"comments": [{"owner": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "edited": false, "score": 0, "creation_date": 1558008004, "post_id": 56159055, "comment_id": 98962617, "body": "In addition, I&#39;d say that a common use of returns is the use of a guard clause e.g. in the example here, <code>return &quot;That number is way too big!&quot; if num &gt; 100</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "edited": false, "score": 0, "creation_date": 1558027450, "post_id": 56159055, "comment_id": 98973939, "body": "@Yule That&#39;s another approach I&#39;ve seen commonly but I try and avoid what I call &quot;surprise conditions&quot;, as in trailing <code>if</code> or <code>unless</code> at the end of lines long enough you might not realize they&#39;re there due to being clipped out of the window. As a general rule anything non-trivial, beyond <code>return false if x</code>, gets the multi-line treatment so it&#39;s abundantly clear that it&#39;s a conditional <code>return</code> and the conditions are easily observed."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 3, "last_activity_date": 1557964332, "creation_date": 1557964332, "answer_id": 56159055, "question_id": 56158869, "link": "https://stackoverflow.com/questions/56158869/why-is-this-code-from-ruby-book-not-working/56159055#56159055", "title": "Why is this code from Ruby book not working?", "body": "<p>It's not clear where this is intended to be used, but you can't <code>return</code> like that inside a loop.</p>\n\n<p>The code is probably:</p>\n\n<pre><code>def squared\n  10.times do |num|\n    square = num * num\n\n    yield num, square\n  end\nend\n</code></pre>\n\n<p>Where you'd call that somehow externally:</p>\n\n<pre><code>squared do |num, square|\n  puts \"The square of #{num} is #{square}\"\nend\n</code></pre>\n\n<p>A simplified version of this code is:</p>\n\n<pre><code>def square(num)\n  return num * num\nend\n</code></pre>\n\n<p>Where here <code>return</code> is in a valid context. Ruby tends to avoid explicit <code>return</code> statements <em>unless it's intentional to avoid running the remainder of the method</em>, as in:</p>\n\n<pre><code> def square(num)\n   if (num &gt; 1000)\n     return \"That number is way too big!\"\n   end\n\n   num * num\n end\n</code></pre>\n\n<p>Here the last statement to run (<code>num * num</code>) is the <em>implicit return value</em> of the method. Many blocks work this way, even <code>if</code>, where in Ruby <code>if</code> statements return values:</p>\n\n<pre><code>choice = if (num &gt; 10)\n  \"big\"\nelse\n  \"small\"\nend\n</code></pre>\n\n<p>Where <code>choice</code> ends up being either of those two strings depending on conditions.</p>\n"}], "owner": {"reputation": 33, "user_id": 2333747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de3e777bd157718d10daa48bc449fb0d?s=128&d=identicon&r=PG", "display_name": "Richard Osborne", "link": "https://stackoverflow.com/users/2333747/richard-osborne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558203364, "creation_date": 1557962794, "last_edit_date": 1558107146, "question_id": 56158869, "link": "https://stackoverflow.com/questions/56158869/why-is-this-code-from-ruby-book-not-working", "title": "Why is this code from Ruby book not working?", "body": "<p>I copied this out of a book. \"The Ultimate Guide to Ruby Programming\" \nCopyright (c) 2006-2016 Satish Talim <a href=\"http://satishtalim.com/\" rel=\"nofollow noreferrer\">http://satishtalim.com/</a> </p>\n\n<p>Please see the code and error message. Why am I getting this error?</p>\n\n<p>I have checked my typing, re-entered the code, exited irb re-entered irb, re-entered the code, same result. What is my error?</p>\n\n<pre><code>irb(main):001:0&gt; 10.times do |num|\nirb(main):002:1*   square = num * num\nirb(main):003:1&gt;   return num, square\nirb(main):004:1&gt; end\n</code></pre>\n\n<pre><code>Traceback (most recent call last):\n        4: from C:/Ruby25-x64/bin/irb.cmd:19:in `&lt;main&gt;'\n        3: from (irb):1\n        2: from (irb):1:in `times'\n        1: from (irb):3:in `block in irb_binding'\nLocalJumpError (unexpected return)\nirb(main):005:0&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "graphql", "shopify"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3285614, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005699283880/picture?type=large", "display_name": "user3285614", "link": "https://stackoverflow.com/users/3285614/user3285614"}, "is_accepted": true, "score": 0, "last_activity_date": 1557963732, "creation_date": 1557963732, "answer_id": 56158984, "question_id": 56158839, "link": "https://stackoverflow.com/questions/56158839/how-to-use-variables-in-graphql-mutation-for-bulk-adjust-inventory/56158984#56158984", "title": "How to use variables in GraphQL mutation for bulk adjust inventory?", "body": "<p>Finally got the answer!\nThe correct query was: </p>\n\n<pre><code>BULK_ADJUST = CLIENT.parse &lt;&lt;-'GRAPHQL'\n      mutation($inventoryItemAdjustments: [InventoryAdjustItemInput!]!, $locationId: ID!) {\n        inventoryBulkAdjustQuantityAtLocation(inventoryItemAdjustments: $inventoryItemAdjustments, locationId: $locationId) {\n          inventoryLevels {\n            id\n          }\n          userErrors {\n            field\n            message\n          }\n        }\n      }\n  GRAPHQL\n</code></pre>\n\n<p>The word \"inventoryBulkAdjustQuantityAtLocation\" after the \"mutation\" keyword had to be removed.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 3285614, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005699283880/picture?type=large", "display_name": "user3285614", "link": "https://stackoverflow.com/users/3285614/user3285614"}, "edited": false, "score": 0, "creation_date": 1557996663, "post_id": 56158985, "comment_id": 98956177, "body": "Thank you for your help. I have this line in my routes.rb file : <code>ruby get &#39;home&#47;bulk_update_inventory&#39; </code>  I don&#39;t know why do I get this error knowing that the problem was the graphQL query"}], "tags": [], "owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "is_accepted": false, "score": 0, "last_activity_date": 1557963753, "creation_date": 1557963753, "answer_id": 56158985, "question_id": 56158839, "link": "https://stackoverflow.com/questions/56158839/how-to-use-variables-in-graphql-mutation-for-bulk-adjust-inventory/56158985#56158985", "title": "How to use variables in GraphQL mutation for bulk adjust inventory?", "body": "<p>check your routes file and make sure you set one up for that special path.</p>\n"}], "owner": {"reputation": 11, "user_id": 3285614, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005699283880/picture?type=large", "display_name": "user3285614", "link": "https://stackoverflow.com/users/3285614/user3285614"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 56158984, "answer_count": 2, "score": 0, "last_activity_date": 1557963753, "creation_date": 1557962550, "question_id": 56158839, "link": "https://stackoverflow.com/questions/56158839/how-to-use-variables-in-graphql-mutation-for-bulk-adjust-inventory", "title": "How to use variables in GraphQL mutation for bulk adjust inventory?", "body": "<p>I trying to bulk adjust inventory item of my Shopify product variants as explained in this article: <a href=\"https://www.shopify.com/partners/blog/multi-location_and_graphql\" rel=\"nofollow noreferrer\">https://www.shopify.com/partners/blog/multi-location_and_graphql</a></p>\n\n<p>I tried hardcoding the variants ID in the query and it worked great : </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;&lt;-'GRAPHQL'\n      mutation {\n      inventoryBulkAdjustQuantityAtLocation(\n        locationId: \"gid://shopify/Location/5537988719\",\n        inventoryItemAdjustments: [\n          {inventoryItemId: \"gid://shopify/InventoryItem/21112836292719\", availableDelta: 1},\n          {inventoryItemId: \"gid://shopify/InventoryItem/21112836325487\", availableDelta: 10}\n          ]) {\n        inventoryLevels {\n          available\n        }\n      }\n    }\n  GRAPHQL\n</code></pre>\n\n<p>Now I am trying to set the product variants ID as variables like follow:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require \"graphql/client\"\nrequire \"graphql/client/http\"\n\nclass HomeController &lt; ApplicationController\n  API_KEY       = 'XXXXXX'.freeze\n  PASSWORD      = 'XXXXXX'.freeze\n  SHARED_SECRET = 'XXXXXX'.freeze\n  SHOP_NAME     = 'xxxxxx'.freeze\n  API_VERSION   = '2019-04'.freeze\n\n  shop_url                      = \"https://#{API_KEY}:#{PASSWORD}@#{SHOP_NAME}.myshopify.com/admin\"\n  ShopifyAPI::Base.site         = shop_url\n  ShopifyAPI::Base.api_version  = API_VERSION\n  CLIENT                        = ShopifyAPI::GraphQL.new\n\n  BULK_ADJUST = CLIENT.parse &lt;&lt;-'GRAPHQL'\n      mutation inventoryBulkAdjustQuantityAtLocation($inventoryItemAdjustments: [InventoryAdjustItemInput!]!, $locationId: ID!) {\n        inventoryBulkAdjustQuantityAtLocation(inventoryItemAdjustments: $inventoryItemAdjustments, locationId: $locationId) {\n          inventoryLevels {\n            id\n          }\n          userErrors {\n            field\n            message\n          }\n        }\n      }\n  GRAPHQL\n\n  def bulk_update_inventory\n    inventoryItemAdjustments = [\n        { \"inventoryItemId\" =&gt; \"gid://shopify/InventoryItem/1234\", \"availableDelta\" =&gt; 1 },\n        { \"inventoryItemId\" =&gt; \"gid://shopify/InventoryItem/5678\", \"availableDelta\" =&gt; 10 }\n    ]\n\n    variables = {\n        \"inventoryItemAdjustments\" =&gt; inventoryItemAdjustments,\n        \"locationId\" =&gt; \"gid://shopify/Location/9012\"\n    }\n\n      result = CLIENT.query(BULK_ADJUST,\n                          variables: variables)\n    render :json =&gt; { :result =&gt; result }\n  end\n\nend\n</code></pre>\n\n<p>When I try to run the query I reach the following error: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Unknown action\n\nThe action 'bulk_update_inventory' could not be found for HomeController\n</code></pre>\n\n<p>There is anybody knows why do I have this error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "edited": false, "score": 0, "creation_date": 1557960523, "post_id": 56158031, "comment_id": 98945915, "body": "Could you include a snippet of the error log? There could be several reasons why the build could have failed and usually the error log should be having that information."}, {"owner": {"reputation": 191, "user_id": 9631893, "user_type": "registered", "profile_image": "https://graph.facebook.com/1646120938744101/picture?type=large", "display_name": "Mahdi Jaber", "link": "https://stackoverflow.com/users/9631893/mahdi-jaber"}, "reply_to_user": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "edited": false, "score": 0, "creation_date": 1557960894, "post_id": 56158031, "comment_id": 98945995, "body": "I added the error log"}, {"owner": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "edited": false, "score": 0, "creation_date": 1557961480, "post_id": 56158031, "comment_id": 98946106, "body": "As you can see in the error log, the <code>bootsnap</code> gem itself seems to be buggy. Try updating the related gem version in your <code>Gemfile</code> or removing the version to use the latest one. If that doesn&#39;t work, include your <code>Gemfile</code> too in the question. Would be better for debugging."}, {"owner": {"reputation": 191, "user_id": 9631893, "user_type": "registered", "profile_image": "https://graph.facebook.com/1646120938744101/picture?type=large", "display_name": "Mahdi Jaber", "link": "https://stackoverflow.com/users/9631893/mahdi-jaber"}, "reply_to_user": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "edited": false, "score": 0, "creation_date": 1557962524, "post_id": 56158031, "comment_id": 98946278, "body": "Yes sir, I added the GemFile as per request"}, {"owner": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "edited": false, "score": 0, "creation_date": 1557963145, "post_id": 56158031, "comment_id": 98946388, "body": "It worked for me. Can you try uninstalling the gem using <code>gem uninstall bootsnap -v &#39;1.4.4&#39;</code> and reinstalling using <code>gem install bootsnap -v &#39;1.4.4&#39;</code>"}, {"owner": {"reputation": 191, "user_id": 9631893, "user_type": "registered", "profile_image": "https://graph.facebook.com/1646120938744101/picture?type=large", "display_name": "Mahdi Jaber", "link": "https://stackoverflow.com/users/9631893/mahdi-jaber"}, "reply_to_user": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "edited": false, "score": 0, "creation_date": 1557963619, "post_id": 56158031, "comment_id": 98946500, "body": "same error nothing changed"}, {"owner": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "edited": false, "score": 0, "creation_date": 1557963757, "post_id": 56158031, "comment_id": 98946522, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/55857930/how-can-i-properly-install-bootsnap-on-windows\" title=\"how can i properly install bootsnap on windows\">stackoverflow.com/questions/55857930/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 11378443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7309052c7afed1a17f2670858200ed09?s=128&d=identicon&r=PG&f=1", "display_name": "NensiMakawana", "link": "https://stackoverflow.com/users/11378443/nensimakawana"}, "is_accepted": true, "score": 1, "last_activity_date": 1558004174, "creation_date": 1558004174, "answer_id": 56166952, "question_id": 56158031, "link": "https://stackoverflow.com/questions/56158031/unable-to-install-bootsnap-version-1-4-4/56166952#56166952", "title": "Unable to install bootsnap version 1.4.4", "body": "<p>There is problem with ruby version and bootsnap gem version.\nso upgrade your ruby version '2.3.7' or '2.4.5' as per rails 5.2.3</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9087116/which-ruby-on-rails-is-compatible-with-which-ruby-version\">Which Ruby on Rails is compatible with which Ruby version?</a></p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 6886123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtuvV.jpg?s=128&g=1", "display_name": "geniusmind", "link": "https://stackoverflow.com/users/6886123/geniusmind"}, "is_accepted": false, "score": 0, "last_activity_date": 1561321469, "last_edit_date": 1561321469, "creation_date": 1561321162, "answer_id": 56727442, "question_id": 56158031, "link": "https://stackoverflow.com/questions/56158031/unable-to-install-bootsnap-version-1-4-4/56727442#56727442", "title": "Unable to install bootsnap version 1.4.4", "body": "<p>I had exact similar problem...took me hours I couldn't figure it out. I manually changed the version to gem 'bootsnap', '>= 1.4.4', require: false, but it didn't work.</p>\n\n<p>So I solved by commenting out. This is because I figured out my application would still work without bootsnap, since it is useful for speeding up boot time by caching expensive operations. </p>\n\n<p>To do so, go to Gemfile and comment out bootsnap like this:</p>\n\n<p>#gem 'bootsnap', '>= 1.4.4', require: false</p>\n\n<p>Then go to boot.rb file in config and comment out like below:</p>\n\n<p>#require 'bootsnap/setup' # Speed up boot time by caching expensive operations.</p>\n\n<p>After that, do</p>\n\n<p>bundle install</p>\n\n<p>and then fire up my rails server as below:</p>\n\n<p>rails s</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11554694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5nvlu5_Xq5U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf9D4-sQLfkxTVwsoVsIHyn2wILOA/mo/photo.jpg?sz=128", "display_name": "cotieno", "link": "https://stackoverflow.com/users/11554694/cotieno"}, "is_accepted": false, "score": 0, "last_activity_date": 1567092675, "last_edit_date": 1567092675, "creation_date": 1567092262, "answer_id": 57713347, "question_id": 56158031, "link": "https://stackoverflow.com/questions/56158031/unable-to-install-bootsnap-version-1-4-4/57713347#57713347", "title": "Unable to install bootsnap version 1.4.4", "body": "<p>I tried what you had suggested:-</p>\n\n<p>But it did not work - My server fired up but could load my app - My patience was tested.</p>\n\n<p>Uncommented -  </p>\n\n<pre><code>require 'bootsnap/setup' # Speed up boot time by caching expensive \noperations.\n\ngem 'bootsnap', '&gt;= 1.4.4', require: false \n</code></pre>\n\n<p>and run </p>\n\n<pre><code>Bundle Install\n</code></pre>\n\n<p>Fired up my server and my App was up running in seconds </p>\n"}, {"tags": [], "owner": {"reputation": 28, "user_id": 8387200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hU3Ep.jpg?s=128&g=1", "display_name": "CJD", "link": "https://stackoverflow.com/users/8387200/cjd"}, "is_accepted": false, "score": 0, "last_activity_date": 1606676120, "creation_date": 1606676120, "answer_id": 65063882, "question_id": 56158031, "link": "https://stackoverflow.com/questions/56158031/unable-to-install-bootsnap-version-1-4-4/65063882#65063882", "title": "Unable to install bootsnap version 1.4.4", "body": "<p>This happened to me today as I was trying out Rails 6. On my local machine, I have Ruby version 2.7.0 installed, as well as Rails version 6.0.1.\nTurns out, I had <em>just</em> upgraded my Mac's OS to Catalina. The fix for me was to run in Terminal</p>\n<pre><code>xcode-select --install\n</code></pre>\n<p>I ran this in my <code>~</code> directory, not sure if this will matter as the xcode installation is most likely global.\nAfter running this, I changed back to my new Rails app directory, ran bundle and everything installed without issue, including bootsnap and pg.</p>\n<p>Hope this helps any Mac users who have recently upgraded their OS. Note, I was previously running Mojave and still needed to reinstall xcode, after having it installed already when I was running Mojave.</p>\n"}], "owner": {"reputation": 191, "user_id": 9631893, "user_type": "registered", "profile_image": "https://graph.facebook.com/1646120938744101/picture?type=large", "display_name": "Mahdi Jaber", "link": "https://stackoverflow.com/users/9631893/mahdi-jaber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2470, "favorite_count": 0, "accepted_answer_id": 56166952, "answer_count": 4, "score": 1, "last_activity_date": 1606676120, "creation_date": 1557956602, "last_edit_date": 1557962496, "question_id": 56158031, "link": "https://stackoverflow.com/questions/56158031/unable-to-install-bootsnap-version-1-4-4", "title": "Unable to install bootsnap version 1.4.4", "body": "<p>I am trying to make the server start its my first time using rails. So I am using </p>\n\n<pre><code> ruby bin\\rails server\n</code></pre>\n\n<p>It gave me:</p>\n\n<pre><code>Could not find gem 'turbolinks (~&gt; 5) x86-mingw32' in any of the gem \nsources listed in your Gemfile.\nRun `bundle install` to install missing gems.\n</code></pre>\n\n<p>When running <code>bundle install</code> \nIt gave me:</p>\n\n<pre><code>An error occurred while installing bootsnap (1.4.4), and Bundler cannot\ncontinue.\nMake sure that `gem install bootsnap -v '1.4.4' --source\n'https://rubygems.org/'` succeeds before bundling.\n</code></pre>\n\n<p>When I try the command it gives me:</p>\n\n<pre><code>Error installing bootsnap:\n    ERROR: Failed to build gem native extension.\n</code></pre>\n\n<p>This is a snippet of the error log:</p>\n\n<pre><code>Fetching bootsnap 1.4.4\nInstalling bootsnap 1.4.4 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory:\nC:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.4/ext/bootsnap\nC:/RailsInstaller/Ruby2.3.3/bin/ruby.exe -r ./siteconf20190516-15728-gz8r2f.rb\nextconf.rb\ncreating Makefile\n\ncurrent directory:\nC:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.4/ext/bootsnap\nmake \"DESTDIR=\" clean\n\ncurrent directory:\nC:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.4/ext/bootsnap\nmake \"DESTDIR=\"\ngenerating bootsnap-i386-mingw32.def\ncompiling bootsnap.c\nbootsnap.c: In function 'bs_cache_path':\nbootsnap.c:245:3: warning: unknown conversion type character 'l' in format\n[-Wformat]\nbootsnap.c:245:3: warning: too many arguments for format [-Wformat-extra-args]\nbootsnap.c: In function 'bs_rb_fetch':\nbootsnap.c:286:3: warning: ISO C90 forbids mixed declarations and code\n[-Wdeclaration-after-statement]\nbootsnap.c: In function 'fetch_cached_data':\nbootsnap.c:412:3: warning: comparison is always false due to limited range of\ndata type [-Wtype-limits]\nbootsnap.c: In function 'atomic_write_cache_file':\nbootsnap.c:484:3: warning: implicit declaration of function 'mkstemp'\n[-Wimplicit-function-declaration]\nbootsnap.c: In function 'bs_rb_fetch':\nbootsnap.c:632:13: warning: 'output_data' may be used uninitialized in this\nfunction [-Wmaybe-uninitialized]\nbootsnap.c:603:9: note: 'output_data' was declared here\nlinking shared-object bootsnap/bootsnap.so\nbootsnap.o: In function `atomic_write_cache_file':\nC:\\RailsInstaller\\Ruby2.3.3\\lib\\ruby\\gems\\2.3.0\\gems\\bootsnap-1.4.4\\ext\\bootsnap/bootsnap.c:484:\nundefined reference to `mkstemp'\ncollect2.exe: error: ld returned 1 exit status\nmake: *** [bootsnap.so] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in\nC:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.4 for\ninspection.\nResults logged to\nC:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/extensions/x86-mingw32/2.3.0/bootsnap-1.4.4/gem_make.out\n\nAn error occurred while installing bootsnap (1.4.4), and Bundler cannot\ncontinue.\nMake sure that `gem install bootsnap -v '1.4.4' --source\n'https://rubygems.org/'` succeeds before bundling.\n\nIn Gemfile:\n  bootsnap\n</code></pre>\n\n<p>The GemFile:</p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.3.3'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.2.3'\n# Use sqlite3 as the database for Active Record\ngem 'sqlite3'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.11'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\ngem 'duktape'\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2'\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 4.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use ActiveStorage variant\n# gem 'mini_magick', '~&gt; 4.8'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\n# Reduces boot times through caching; required in config/boot.rb\ngem 'bootsnap', '&gt;= 1.1.0', require: false\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\nend\n\ngroup :development do\n  # Access an interactive console on exception pages or by calling 'console' anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\nend\n\ngroup :test do\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '&gt;= 2.15'\n  gem 'selenium-webdriver'\n  # Easy installation and use of chromedriver to run system tests with Chrome\n  gem 'chromedriver-helper'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "regex", "ruby", "regex-group", "client-side-validation"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1557964148, "post_id": 56157970, "comment_id": 98946601, "body": "That&#39;s an ambitious regular expression but don&#39;t forget names like Ragnhei&#240;ur and Altu\u011f exist. This is an incomplete set of Latin letters with accents and may prove to be a frustrating impediment to your users."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": false, "score": 2, "last_activity_date": 1557960001, "creation_date": 1557960001, "answer_id": 56158545, "question_id": 56157970, "link": "https://stackoverflow.com/questions/56157970/regex-for-client-side-server-in-ruby-on-rails/56158545#56158545", "title": "RegEx for client-side server in Ruby on Rails", "body": "<p>I'm not so sure about your codes. It might be missing flags. Your expression seems to be working fine:</p>\n\n<pre><code>/^(?!.*\\.\\S)[a-zA-Z \u00e0\u00e2\u00e4\u00f4\u00e9\u00e8\u00eb\u00ea\u00ef\u00ee\u00e7\u00f9\u00fb\u00fc\u00ff\u00e6\u0153\u00c0\u00c2\u00c4\u00d4\u00c9\u00c8\u00cb\u00ca\u00cf\u00ce\u0178\u00c7\u00d9\u00db\u00dc\u00c6\u0152\u00f6\u00df\u00d6\u1e9e\u0105\u0107\u0119\u0142\u0144\u00f3\u015b\u017a\u017c\u0104\u0106\u0118\u0141\u0143\u00d3\u015a\u0179\u017b\u00ec\u00ed\u00f2\u00fa\u00cc\u00cd\u00d2\u00da\u00e1\u00f1\u00c1\u00d1 \\',.-]+$/m\n</code></pre>\n\n<h3>Ruby Test</h3>\n\n<pre><code>re = /^(?!.*\\.\\S)[a-zA-Z \u00e0\u00e2\u00e4\u00f4\u00e9\u00e8\u00eb\u00ea\u00ef\u00ee\u00e7\u00f9\u00fb\u00fc\u00ff\u00e6\u0153\u00c0\u00c2\u00c4\u00d4\u00c9\u00c8\u00cb\u00ca\u00cf\u00ce\u0178\u00c7\u00d9\u00db\u00dc\u00c6\u0152\u00f6\u00df\u00d6\u1e9e\u0105\u0107\u0119\u0142\u0144\u00f3\u015b\u017a\u017c\u0104\u0106\u0118\u0141\u0143\u00d3\u015a\u0179\u017b\u00ec\u00ed\u00f2\u00fa\u00cc\u00cd\u00d2\u00da\u00e1\u00f1\u00c1\u00d1 \\',.-]+$/m\nstr = 'abc\u00e0\u00e2\u00e4'\n\n# Print the match result\nstr.scan(re) do |match|\n    puts match.to_s\nend\n</code></pre>\n\n<h3>RegEx</h3>\n\n<p>You can modify/change your expressions in <a href=\"https://regex101.com/r/UX8nim/1/\" rel=\"nofollow noreferrer\">regex101.com</a>.</p>\n\n<h3>RegEx Circuit</h3>\n\n<p>You can also visualize your expressions in <a href=\"https://jex.im/regulex/#!flags=&amp;re=%5E(a%7Cb)*%3F%24\" rel=\"nofollow noreferrer\">jex.im</a>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1fesB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1fesB.png\" alt=\"enter image description here\"></a></p>\n\n<h3>JavaScript Demo</h3>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const regex = /^(?!.*\\.\\S)[a-zA-Z \u00e0\u00e2\u00e4\u00f4\u00e9\u00e8\u00eb\u00ea\u00ef\u00ee\u00e7\u00f9\u00fb\u00fc\u00ff\u00e6\u0153\u00c0\u00c2\u00c4\u00d4\u00c9\u00c8\u00cb\u00ca\u00cf\u00ce\u0178\u00c7\u00d9\u00db\u00dc\u00c6\u0152\u00f6\u00df\u00d6\u1e9e\u0105\u0107\u0119\u0142\u0144\u00f3\u015b\u017a\u017c\u0104\u0106\u0118\u0141\u0143\u00d3\u015a\u0179\u017b\u00ec\u00ed\u00f2\u00fa\u00cc\u00cd\u00d2\u00da\u00e1\u00f1\u00c1\u00d1 \\',.-]+$/gm;\r\nconst str = `abc\u00e0\u00e2\u00e4`;\r\nlet m;\r\n\r\nwhile ((m = regex.exec(str)) !== null) {\r\n    // This is necessary to avoid infinite loops with zero-width matches\r\n    if (m.index === regex.lastIndex) {\r\n        regex.lastIndex++;\r\n    }\r\n    \r\n    // The result can be accessed through the `m`-variable.\r\n    m.forEach((match, groupIndex) =&gt; {\r\n        console.log(`Found match, group ${groupIndex}: ${match}`);\r\n    });\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1557984350, "post_id": 56159260, "comment_id": 98950426, "body": "You might be better off using <a href=\"http://ruby-doc.org/core-2.6.3/Regexp.html#class-Regexp-label-Character+Properties\" rel=\"nofollow noreferrer\"><code>\\p{...}</code></a> instead of that explicit list of accented characters. Or just drop the restriction because any restriction will be broken in one way or another. Also <a href=\"https://www.kalzumeus.com/2010/06/17/falsehoods-programmers-believe-about-names/\" rel=\"nofollow noreferrer\">Falsehoods Programmers Believe About Names</a>. Also also, you almost always want <code>\\A</code> and <code>\\z</code> rather than <code>^</code> and <code>$</code> in Ruby. Of course, you won&#39;t get very far getting one non-trivial regex to work in regex engines."}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1558019169, "post_id": 56159260, "comment_id": 98969739, "body": "@muistooshort So this would be the new pattern? <code>\\A(?!.*\\.\\S)[\\p{L} \\&#39;,.-]+\\z</code>"}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1558021272, "post_id": 56159260, "comment_id": 98970923, "body": "If so I&#39;m getting this error <code>Invalid regular expression: &#47;\\A(?!.*\\.\\S)[\\p{L} &#39;,.-]+\\z&#47;: Invalid escape</code> in the browser"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1558023464, "post_id": 56159260, "comment_id": 98972041, "body": "<code>\\p{L}</code> looks like a good start, might want to include <code>\\p{P}</code> rather than just those four punctuations (there are names like <code>D\u2019arcy</code> and they may not want to spell it <code>D&#39;arcy</code>l). JavaScript wants you to use the <code>u</code> modifier so you&#39;d say <code>&#47;...&#47;u</code>. And down the rabbit hole we go into a nightmare of special cases and frustration. If this isn&#39;t a hard external requirement then maybe usernames should just be arbitrary strings of characters (with Unicode normalization of some sort of course). This is a surprisingly difficult topic. Also, I don&#39;t think JavaScript understands <code>\\A</code> and <code>\\z</code>."}], "tags": [], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "is_accepted": false, "score": 2, "last_activity_date": 1557966392, "creation_date": 1557966392, "answer_id": 56159260, "question_id": 56157970, "link": "https://stackoverflow.com/questions/56157970/regex-for-client-side-server-in-ruby-on-rails/56159260#56159260", "title": "RegEx for client-side server in Ruby on Rails", "body": "<p>I decided to modify the Resident model with a new constant and work from there.</p>\n\n<h3>resident.rb</h3>\n\n<pre><code>JS_NAME_FORMAT = '^(?!.*\\.\\S)[a-zA-Z \u00e0\u00e2\u00e4\u00f4\u00e9\u00e8\u00eb\u00ea\u00ef\u00ee\u00e7\u00f9\u00fb\u00fc\u00ff\u00e6\u0153\u00c0\u00c2\u00c4\u00d4\u00c9\u00c8\u00cb\u00ca\u00cf\u00ce\u0178\u00c7\u00d9\u00db\u00dc\u00c6\u0152\u00f6\u00df\u00d6\u1e9e\u0105\u0107\u0119\u0142\u0144\u00f3\u015b\u017a\u017c\u0104\u0106\u0118\u0141\u0143\u00d3\u015a\u0179\u017b\u00ec\u00ed\u00f2\u00fa\u00cc\u00cd\u00d2\u00da\u00e1\u00f1\u00c1\u00d1 \\',.-]+$'\nNAME_FORMAT = /#{JS_NAME_FORMAT}/\n</code></pre>\n\n<h3>_update.html.erb</h3>\n\n<pre><code>&lt;%= text_field_tag 'resident[last_name]', nil, class: 'form-control', placeholder: 'Last Name', required: true, maxlength: 50, pattern: Resident::JS_NAME_FORMAT, oninvalid: \"setCustomValidity('Contains unsupported characters.')\", oninput: \"setCustomValidity('')\" %&gt;\n</code></pre>\n\n<p>Doing this I still only define express in a single spot, which my primary goal.</p>\n"}], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1557981525, "creation_date": 1557956268, "last_edit_date": 1557981525, "question_id": 56157970, "link": "https://stackoverflow.com/questions/56157970/regex-for-client-side-server-in-ruby-on-rails", "title": "RegEx for client-side server in Ruby on Rails", "body": "<p>I'm doing server-side and client-side validation for names in my rails application. Currently, I have to duplicate the regular expression because the constant that works on the server is throwing an error. How can I modify the code so I don't have this duplication?</p>\n\n<h3>app/models/resident.rb</h3>\n\n<pre><code>  NAME_FORMAT = /^(?!.*\\.\\S)[a-zA-Z \u00e0\u00e2\u00e4\u00f4\u00e9\u00e8\u00eb\u00ea\u00ef\u00ee\u00e7\u00f9\u00fb\u00fc\u00ff\u00e6\u0153\u00c0\u00c2\u00c4\u00d4\u00c9\u00c8\u00cb\u00ca\u00cf\u00ce\u0178\u00c7\u00d9\u00db\u00dc\u00c6\u0152\u00f6\u00df\u00d6\u1e9e\u0105\u0107\u0119\u0142\u0144\u00f3\u015b\u017a\u017c\u0104\u0106\u0118\u0141\u0143\u00d3\u015a\u0179\u017b\u00ec\u00ed\u00f2\u00fa\u00cc\u00cd\u00d2\u00da\u00e1\u00f1\u00c1\u00d1 \\',.-]+$/\n\n  validate :name_is_acceptable, if: -&gt; { (last_name_changed? || first_name_changed?) &amp;&amp; (persisted? || !imported?) }\n  def name_is_acceptable\n    [:first_name, :last_name].each do |attr|\n      value = self.send(attr)\n      next if value.blank? || value =~ NAME_FORMAT\n\n      errors.add attr, I18n.t(:resident_name_invalid, scope: 'errors.messages')\n    end\n  end\n</code></pre>\n\n<h3>app/view/resident/_update.html.erb</h3>\n\n<pre><code>&lt;%= text_field_tag 'resident[last_name]', nil, class: 'form-control', placeholder: 'Last Name', required: true, maxlength: 50, pattern: '^(?!.*\\.\\S)[a-zA-Z \u00e0\u00e2\u00e4\u00f4\u00e9\u00e8\u00eb\u00ea\u00ef\u00ee\u00e7\u00f9\u00fb\u00fc\u00ff\u00e6\u0153\u00c0\u00c2\u00c4\u00d4\u00c9\u00c8\u00cb\u00ca\u00cf\u00ce\u0178\u00c7\u00d9\u00db\u00dc\u00c6\u0152\u00f6\u00df\u00d6\u1e9e\u0105\u0107\u0119\u0142\u0144\u00f3\u015b\u017a\u017c\u0104\u0106\u0118\u0141\u0143\u00d3\u015a\u0179\u017b\u00ec\u00ed\u00f2\u00fa\u00cc\u00cd\u00d2\u00da\u00e1\u00f1\u00c1\u00d1 \\',.-]+$', oninvalid: \"setCustomValidity('Contains unsupported characters.')\", oninput: \"setCustomValidity('')\" %&gt;\n</code></pre>\n\n<h3>error on clientside</h3>\n\n<pre><code>Pattern attribute value (?-mix:^(?!.*\\.\\S)[a-zA-Z \u00e0\u00e2\u00e4\u00f4\u00e9\u00e8\u00eb\u00ea\u00ef\u00ee\u00e7\u00f9\u00fb\u00fc\u00ff\u00e6\u0153\u00c0\u00c2\u00c4\u00d4\u00c9\u00c8\u00cb\u00ca\u00cf\u00ce\u0178\u00c7\u00d9\u00db\u00dc\u00c6\u0152\u00f6\u00df\u00d6\u1e9e\u0105\u0107\u0119\u0142\u0144\u00f3\u015b\u017a\u017c\u0104\u0106\u0118\u0141\u0143\u00d3\u015a\u0179\u017b\u00ec\u00ed\u00f2\u00fa\u00cc\u00cd\u00d2\u00da\u00e1\u00f1\u00c1\u00d1 \\',.-]+$) is not a valid regular expression: Uncaught SyntaxError: Invalid regular expression: /(?-mix:^(?!.*\\.\\S)[a-zA-Z \u00e0\u00e2\u00e4\u00f4\u00e9\u00e8\u00eb\u00ea\u00ef\u00ee\u00e7\u00f9\u00fb\u00fc\u00ff\u00e6\u0153\u00c0\u00c2\u00c4\u00d4\u00c9\u00c8\u00cb\u00ca\u00cf\u00ce\u0178\u00c7\u00d9\u00db\u00dc\u00c6\u0152\u00f6\u00df\u00d6\u1e9e\u0105\u0107\u0119\u0142\u0144\u00f3\u015b\u017a\u017c\u0104\u0106\u0118\u0141\u0143\u00d3\u015a\u0179\u017b\u00ec\u00ed\u00f2\u00fa\u00cc\u00cd\u00d2\u00da\u00e1\u00f1\u00c1\u00d1 \\',.-]+$)/: Invalid group\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1557964582, "post_id": 56157834, "comment_id": 98946684, "body": "How are you assigning to the cookie? It should be <a href=\"https://en.wikipedia.org/wiki/Percent-encoding\" rel=\"nofollow noreferrer\">URL-escaped</a> as <code>%2b</code> for you automatically, and decoded when accessing <code>cookies</code>."}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1558002360, "last_edit_date": 1558002360, "creation_date": 1558001616, "answer_id": 56166149, "question_id": 56157834, "link": "https://stackoverflow.com/questions/56157834/symbol-within-cookie-value-replaced-by-whitespace/56166149#56166149", "title": "+ symbol within cookie value replaced by whitespace", "body": "<blockquote>\n  <p>I have a cookie with a <code>+</code> symbol [\u2026] the value is correct within the cookie</p>\n</blockquote>\n\n<p>In a HTTP request / response, a <code>+</code> in a cookie value has special meaning: it represent a space.</p>\n\n<p>The server sets cookies via a HTTP header:</p>\n\n<pre><code>Set-Cookie: NAME=VALUE\n</code></pre>\n\n<p>The client sends them back in a similar way:</p>\n\n<pre><code>Cookie: NAME=VALUE\n</code></pre>\n\n<p>According to the <a href=\"https://curl.haxx.se/rfc/cookie_spec.html\" rel=\"nofollow noreferrer\">spec</a> the <code>NAME=VALUE</code> sequence must not contain semi-colon, comma and white space. To add those characters, they must be encoded. The encoding will typically be <a href=\"https://en.wikipedia.org/wiki/Percent-encoding\" rel=\"nofollow noreferrer\">percent-encoding</a> which maps the 3 excluded characters to:</p>\n\n<pre><code>require 'rack/utils'\n\nRack::Utils.escape(';') #=&gt; \"%3B\"\nRack::Utils.escape(',') #=&gt; \"%2C\"\nRack::Utils.escape(' ') #=&gt; \"+\"\n</code></pre>\n\n<p>So if your controller turns a literal <code>+</code> into space, it works as expected:</p>\n\n<pre><code>Rack::Utils.unescape('+33123456789')\n#=&gt; \" 33123456789\"\n</code></pre>\n\n<p>To correctly represent a <code>+</code>, it has to be sent as <code>%2B</code>:</p>\n\n<pre><code>Rack::Utils.escape('+33123456789')\n#=&gt; \"%2B33123456789\"\n</code></pre>\n\n<p>Decoding such value will give the expected result:</p>\n\n<pre><code>Rack::Utils.unescape('%2B33123456789')\n#=&gt; \"+33123456789\"\n</code></pre>\n\n<p>Note that Rails handles the escaping / unescaping automatically when accessing the cookies via <code>ActionController#cookies</code>.</p>\n\n<p>Maybe you set the cookie manually or outside of the <code>cookies</code> helper. Or (quite unlikely) the client isn't encoding the cookie correctly.</p>\n"}], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 56166149, "answer_count": 1, "score": 2, "last_activity_date": 1558002360, "creation_date": 1557955531, "question_id": 56157834, "link": "https://stackoverflow.com/questions/56157834/symbol-within-cookie-value-replaced-by-whitespace", "title": "+ symbol within cookie value replaced by whitespace", "body": "<p>I have a cookie with a <code>+</code> symbol. The value of the cookie is something like <code>+33123456789</code>. From my controller, if I do <code>cookies[:phoneNumber]</code>, it returns <code>33123456789</code> (note the whitespace before <code>3</code>).</p>\n\n<p>I could replace the whitespace with a <code>+</code> but the value is correct within the cookie so I prefer to find a way to directly recover the good value of the cookie.</p>\n\n<p>Why does rails removes the + symbol and how to avoid this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "named-parameters", "keyword-argument"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1557981857, "post_id": 56157747, "comment_id": 98949759, "body": "Your question is very unclear. There is no such thing as &quot;named arguments&quot; in Ruby. Are you talking about <i>keyword arguments</i>? But there are no keyword arguments in your code."}, {"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1557991046, "post_id": 56157747, "comment_id": 98953138, "body": "@J&#246;rgWMittag Can you take a look at meta:  <a href=\"https://meta.stackoverflow.com/questions/385075/shall-we-synonymize-named-parameters-and-keyword-arguments\" title=\"shall we synonymize named parameters and keyword arguments\">meta.stackoverflow.com/questions/385075/&hellip;</a> ? I think your input would be valuable there."}], "answers": [{"tags": [], "owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "is_accepted": true, "score": 3, "last_activity_date": 1557989955, "last_edit_date": 1557989955, "creation_date": 1557955164, "answer_id": 56157772, "question_id": 56157747, "link": "https://stackoverflow.com/questions/56157747/how-can-ruby-functions-with-named-arguments-get-called-with-a-hash-instead/56157772#56157772", "title": "How can Ruby functions with named arguments get called with a hash instead?", "body": "<p>Just call the method with the hash: <code>foo(hash)</code></p>\n\n<p>The bigger problem: You didn't use named parameters (or better keyword arguments) but parameters with default values. To use named parameters you must not not use <code>=</code> but <code>:</code>.</p>\n\n<pre><code>def foo(x: 'hi', y:'this is y')\n  puts x\n  puts y\nend\n\nhash = {x: 'first', y: 'second'}\nfoo(hash)\n</code></pre>\n"}], "owner": {"reputation": 9770, "user_id": 3011531, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/31da892ff616d781b2d3396c9271e040?s=128&d=identicon&r=PG&f=1", "display_name": "Some Guy", "link": "https://stackoverflow.com/users/3011531/some-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 56157772, "answer_count": 1, "score": -1, "last_activity_date": 1557989984, "creation_date": 1557955000, "last_edit_date": 1557989984, "question_id": 56157747, "link": "https://stackoverflow.com/questions/56157747/how-can-ruby-functions-with-named-arguments-get-called-with-a-hash-instead", "title": "How can Ruby functions with named arguments get called with a hash instead?", "body": "<p>I'm trying to get this foo function to output \"first\" and then \"second\" but instead it is outputting {:x=>\"first\", :y=>\"second\"} and \"this is y\".</p>\n\n<p>How can I use the hash as named arguments?</p>\n\n<pre><code>def foo(x='hi', y='this is y')\n  puts x\n  puts y\nend\n\nhash = {x: 'first', y: 'second'}\nfoo(**hash)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "session", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1557956571, "post_id": 56156962, "comment_id": 98944956, "body": "@kparek01 this was to temporarily hardcode a user to articles cause user sign up had not been created yet. Is this whats causing that to happen?"}, {"owner": {"reputation": 221, "user_id": 5420504, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/174979efbe4f8e8e9f1579ac1c551f82?s=128&d=identicon&r=PG&f=1", "display_name": "kparekh01", "link": "https://stackoverflow.com/users/5420504/kparekh01"}, "reply_to_user": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1558032822, "post_id": 56156962, "comment_id": 98976470, "body": "So that is one of your issues.  The other issue stems from your users controller and how you are trying to find the user <code>@user = User.find_by(params[:id])</code>.  When you run this code in your rails console and provide find_by a number you should receive an error <code>ArgumentError (Unsupported argument type: 1 (Integer))</code>.  So change all your find_by to find and see if you make some progress."}, {"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1558046901, "post_id": 56156962, "comment_id": 98981343, "body": "Thank you so much! I was able to fix everything."}, {"owner": {"reputation": 221, "user_id": 5420504, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/174979efbe4f8e8e9f1579ac1c551f82?s=128&d=identicon&r=PG&f=1", "display_name": "kparekh01", "link": "https://stackoverflow.com/users/5420504/kparekh01"}, "reply_to_user": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1558105514, "post_id": 56156962, "comment_id": 99003225, "body": "Glad you were able to make progress @Tony, keep plugging away."}], "tags": [], "owner": {"reputation": 221, "user_id": 5420504, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/174979efbe4f8e8e9f1579ac1c551f82?s=128&d=identicon&r=PG&f=1", "display_name": "kparekh01", "link": "https://stackoverflow.com/users/5420504/kparekh01"}, "is_accepted": true, "score": 0, "last_activity_date": 1557951241, "creation_date": 1557951241, "answer_id": 56156962, "question_id": 56156701, "link": "https://stackoverflow.com/questions/56156701/troubleshooting-user-sessions-in-rails-blog-app/56156962#56156962", "title": "Troubleshooting user sessions in Rails Blog App", "body": "<p>Why are you assigning each new article that gets created to the first user and then saving it?  <code>@article.user = User.first</code> &lt;-- referring to this line of code in your articles controller create action.</p>\n\n<pre><code>  def create\n    @article = Article.new(article_params)\n    @article.user = User.first  \n\n    if @article.save\n      flash[:success] = \"Article was successfully created\"\n      redirect_to article_path(@article)\n    else\n      render :new\n    end\n  end\n\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56156962, "answer_count": 1, "score": 0, "last_activity_date": 1558054442, "creation_date": 1557949988, "last_edit_date": 1558054442, "question_id": 56156701, "link": "https://stackoverflow.com/questions/56156701/troubleshooting-user-sessions-in-rails-blog-app", "title": "Troubleshooting user sessions in Rails Blog App", "body": "<p>I am making a blog page just for fun and I am having some trouble with user sessions.</p>\n\n<p>So here is whats going, I create a new user(User1) and everything works fine. BUT when I create an additional user(User2), every time I create an article, or click on another users show page, it redirects everything to the first user(User1). Now let's say I log out of User2 session, then I log back in as User2, it also redirects to User1 profile instead of User2. What is going on? Not sure what I missed.</p>\n\n<p>Here is the link to the github repo github.com/tonymoreno86/alpha-blog.git</p>\n\n<p>Still a sort of a newb with Rails so feel free to let me know what files I need to show.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1557949780, "post_id": 56156635, "comment_id": 98942408, "body": "1) English (seriously though looks like <a href=\"https://stackoverflow.com/questions/tagged/python\">python</a>) 2) <code>(0...lst)</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1557950073, "post_id": 56156635, "comment_id": 98942527, "body": "<code>list.length.times do |i|</code> in Ruby. This is not Ruby code though."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557951782, "post_id": 56156635, "comment_id": 98943205, "body": "As for #3 if you have already seen a number that is equal to <code>k</code> less the current number (<code>num</code>) then <code>num</code> plus that number would equal <code>k</code> just basic arithmetic."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557952373, "post_id": 56156635, "comment_id": 98943453, "body": "No, it&#39;s not Ruby, but any reader looking for an efficient Ruby solution to this problem might consider the following: <code>require &#39;set&#39;; def find_sum(arr, tot); targets = Set.new; n = arr.find do |n|; rv = targets.include?(tot-n); targets &lt;&lt; n unless rv; rv; end; n ? [n, tot-n] : nil; end</code>."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557958098, "post_id": 56156635, "comment_id": 98945362, "body": "@CarySwoveland <code>def n_sum(ar, target, n);   ar.uniq.combination(n).any?{|combi| combi.sum == target}; end</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 1, "creation_date": 1557960212, "post_id": 56156635, "comment_id": 98945853, "body": "@steenslag, yes, but for <code>n=2</code>, that&#39;s O(n^2), whereas using a set is close to O(n) since set look-ups are close to O(1)."}], "answers": [{"comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "reply_to_user": {"reputation": 13, "user_id": 11504191, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J-iYdn4T-1Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcptZRN55SJZwNlCvzo0XRNFG46EA/mo/photo.jpg?sz=128", "display_name": "Lila Liu", "link": "https://stackoverflow.com/users/11504191/lila-liu"}, "edited": false, "score": 1, "creation_date": 1559186970, "post_id": 56157253, "comment_id": 99344765, "body": "@LilaLiu, please, <a href=\"https://stackoverflow.com/help/someone-answers\">accept the answer</a> if it helped"}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": false, "score": 1, "last_activity_date": 1557952584, "creation_date": 1557952584, "answer_id": 56157253, "question_id": 56156635, "link": "https://stackoverflow.com/questions/56156635/what-language-is-this-block-of-code-in-and-how-would-i-code-this-in-ruby/56157253#56157253", "title": "What language is this block of code in? And how would I code this in Ruby?", "body": "<ol>\n<li><p>Python (with broken indentations?)</p></li>\n<li><p><code>for i in range(x)</code> is a Python way of iteration over the range from 0 to x-1. In Ruby the same can be expressed in several different ways, for example in the very similar way using for loop <code>for i in 0...x</code>, using iterator over range as <code>(0...x).each { |i| ... }</code> or even as <code>x.times { |i| ... }</code>.</p></li>\n<li><p><code>seen</code> contains numbers from the list (array) that are already checked. If <code>k - num</code> equals to any number in <code>seen</code> (let's name it <code>j</code>), then it means <code>j + num == k</code> - q.e.d. For example, let's imagine we have <code>lst = [1,3,4,7,11]</code> and <code>k = 5</code>. In this case, the algorithm will work as follows:</p>\n\n<p>step 1: <code>seen = []</code>, <code>num = 1</code>, <code>k - num = 4</code>, <code>4</code> is not in <code>seen</code> - we\nadd <code>1</code> to <code>seen</code></p>\n\n<p>step 2: <code>seen = [1]</code>, <code>num = 3</code>, <code>k - num = 2</code>, <code>2</code> is not in <code>seen</code> - we add <code>3</code> to <code>seen</code></p>\n\n<p>step 3: <code>seen = [1,3]</code>, <code>num = 4</code>, <code>k - num = 1</code>. Voila! <code>1</code> is in <code>seen</code> already and this means we can give the positive answer to the initial question: there are two elements in the source array so that their sum is equal to 5...</p></li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 11504191, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J-iYdn4T-1Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcptZRN55SJZwNlCvzo0XRNFG46EA/mo/photo.jpg?sz=128", "display_name": "Lila Liu", "link": "https://stackoverflow.com/users/11504191/lila-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557952584, "creation_date": 1557949716, "last_edit_date": 1557950024, "question_id": 56156635, "link": "https://stackoverflow.com/questions/56156635/what-language-is-this-block-of-code-in-and-how-would-i-code-this-in-ruby", "title": "What language is this block of code in? And how would I code this in Ruby?", "body": "<p>The below block of code is a solution to a problem, where you need to find two elements of an array that add up to a defined integer (k)</p>\n\n<pre><code># Solution 1:\ndef two_sum(lst, k):\nfor i in range(len(lst)):\n    for j in range(len(lst)):\n        if i != j and lst[i] + lst[j] == k:\n            return True\nreturn False\n\n# Solution 2:\ndef two_sum(lst, k):\nseen = set()\nfor num in lst:\n    if k - num in seen:\n        return True\n    seen.add(num)\nreturn False\n</code></pre>\n\n<ol>\n<li>Firstly, what language is the above in?</li>\n<li>And...how do I identify [i in range(len(lst))] in Ruby?</li>\n<li>Why do you subtract num from k as the condition in solution 2?</li>\n</ol>\n"}, {"tags": ["ruby", "rubygems", "bundler", "perl-packager"], "answers": [{"tags": [], "owner": {"reputation": 671, "user_id": 470646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b27856db49b84de81487fedbf674d7e?s=128&d=identicon&r=PG", "display_name": "Jonathon Jones", "link": "https://stackoverflow.com/users/470646/jonathon-jones"}, "is_accepted": true, "score": 3, "last_activity_date": 1557943244, "creation_date": 1557943244, "answer_id": 56155206, "question_id": 56154649, "link": "https://stackoverflow.com/questions/56154649/why-lib-pp-rb-requires-lib-pp-room-which-does-not-exist/56155206#56155206", "title": "why lib/pp.rb requires lib/pp/room which does not exist", "body": "<p>The \"pp\" gem is not required for using pretty print. That gem is related to Campfire, which does have the concept of a room. See <a href=\"https://www.rubydoc.info/gems/pp/0.1.1/Pp\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/pp/0.1.1/Pp</a></p>\n\n<p>Pretty print is available to you without requiring anything: notice if you run irb, you can immediately type</p>\n\n<pre><code>pp \"something\"\n</code></pre>\n\n<p>And it will print as you want.</p>\n"}], "owner": {"reputation": 179, "user_id": 2635665, "user_type": "registered", "profile_image": "https://graph.facebook.com/637787938/picture?type=large", "display_name": "Ivan Cenov", "link": "https://stackoverflow.com/users/2635665/ivan-cenov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 56155206, "answer_count": 1, "score": 2, "last_activity_date": 1557943244, "creation_date": 1557940930, "question_id": 56154649, "link": "https://stackoverflow.com/questions/56154649/why-lib-pp-rb-requires-lib-pp-room-which-does-not-exist", "title": "why lib/pp.rb requires lib/pp/room which does not exist", "body": "<p>I am trying to create gem using bundler. This gem requires pp gem to make 'pretty print'. I have require 'pp' at the top of the source and after that I use pp where needed. However, a runtime error occurs.</p>\n\n<p>D:/PRJ/git/smde/vendor/bundle/ruby/2.5.0/gems/pp-0.1.1/lib/pp.rb:1:in `require': cannot load such file -- pp/room (LoadError)</p>\n\n<p>There is no room file in lib/pp directory in pp gem. Why?</p>\n\n<p>What is more interestingly, pp gem works well when I start my gem scripts directly, i.e. \"ruby myscript.rb\". The lack of pp/lib/room is not essential.</p>\n"}, {"tags": ["ruby", "xpath", "nokogiri"], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 2, "last_activity_date": 1557946433, "last_edit_date": 1557946433, "creation_date": 1557941421, "answer_id": 56154772, "question_id": 56154300, "link": "https://stackoverflow.com/questions/56154300/what-is-the-difference-between-attr-value-and-notattr-value-in-xpat/56154772#56154772", "title": "What is the difference between `@attr!=&quot;value&quot;` and `not(@attr=&quot;value&quot;)` in XPath", "body": "<p>So the problem here is you are trying to use <code>!=</code> on an attribute (<code>@class</code>) that is only present on the last node. This means <code>@class</code> cannot be compared on the other nodes because it is essentially saying nothing != 'next_page'. </p>\n\n<p>Since nothing is not comparable to anything, operators (including <code>!=</code> and <code>=</code>) will always return false. </p>\n\n<p>In your <code>not</code> function you are asking if nothing = 'next_page' which is always <code>false</code> (as explained above) and thus <code>not</code> makes it <code>true</code> and the element is selected.</p>\n\n<p>You can prove this by adding a class to one of the other anchor tags and then use the <code>!=</code> version. </p>\n\n<p>Side note you can simplify the code to just use <code>xpath</code> </p>\n\n<pre><code>doc.xpath('//div[@class=\"paginate_box\"]/a[not(@class=\"next_page\")][last()]').text \n#=&gt; \"3\"\n# Or  \ndoc.xpath('//div[@class=\"paginate_box\"]/a[not(@class=\"next_page\")][last()]/text()').to_s\n#=&gt; \"3\"\n</code></pre>\n\n<p>Also if next_page anchor is always present and always last and the highest page number always precedes it then you can avoid the condition altogether: </p>\n\n<pre><code>doc.xpath('//div[@class=\"paginate_box\"]/a[position()=last()-1]').text\n#=&gt; \"3\"\n</code></pre>\n\n<p>Here we are saying find the anchor in the position right before the last one in that div. </p>\n\n<p>Alternative:</p>\n\n<pre><code>doc.xpath('//div[@class=\"paginate_box\"]/a[last()]/preceding-sibling::a[1]').text\n#=&gt; \"3\"\n</code></pre>\n\n<p>This will find the last anchor then all the anchor siblings preceding it in bottom up order and we are selecting the first one in that list.</p>\n"}], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56154772, "answer_count": 1, "score": 3, "last_activity_date": 1557946433, "creation_date": 1557939534, "question_id": 56154300, "link": "https://stackoverflow.com/questions/56154300/what-is-the-difference-between-attr-value-and-notattr-value-in-xpat", "title": "What is the difference between `@attr!=&quot;value&quot;` and `not(@attr=&quot;value&quot;)` in XPath", "body": "<p>There is a HTML like this.</p>\n\n<pre><code>&lt;div class=\"paginate_box\"&gt;\n  &lt;span class=\"disabled prev_page\"&gt;Back&lt;/span&gt;\n  &lt;span class=\"current\"&gt;1&lt;/span&gt;\n  &lt;a rel=\"next\" href=\"page2\"&gt;2&lt;/a&gt;\n  &lt;a rel=\"next\" href=\"page3\"&gt;3&lt;/a&gt;\n  &lt;a class=\"next_page\" rel=\"next\" href=\"page2\"&gt;Next&lt;/a&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>To get biggest number of the pages I wrote this.</p>\n\n<pre><code>doc = Nokogiri::HTML(html)\ndoc.xpath('//div[@class=\"paginate_box\"]/a[not(@class=\"next_page\")]').last.text\n#=&gt; \"3\"\n</code></pre>\n\n<p>At first I wrote <code>a[@class!=\"next_page\"]</code> instead of <code>a[not(@class=\"next_page\")]</code>, but it didn't match the tag. Why it doesn't match? What am I doing wrong?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557939715, "post_id": 56153747, "comment_id": 98938016, "body": "Please state the question in words, at the beginning. The question is not implied by a single example. You do not wish to keep the value of the key <code>:a</code> in <code>h[1]</code>? <code>h</code> is not the best name for an array."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557946934, "post_id": 56153747, "comment_id": 98941186, "body": "If <code>{a: 4, b: &quot;Hello&quot;, c: &quot;Test1&quot;}</code> where to exist I am assuming the output should be the same as it is now correct? Since &quot;Hello&quot; already exists in the grouping? As of right now this is unclear and unhandled and will result in <code>{a: 1, b: &quot;Hello, Hey, Hello&quot;, c: &quot;Test1&quot;}</code> because <code>uniq</code> will be comparing <code>&quot;Hello Hey&quot;</code> to <code>&quot;Hello&quot;</code>"}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557990113, "post_id": 56153747, "comment_id": 98952654, "body": "@CarySwoveland I understand your suggestion. But, this is just a way to put my question. The actual code is huge and has large number of keys in the hash"}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557990221, "post_id": 56153747, "comment_id": 98952713, "body": "@engineersmnky I don;t understand what you are trying to say. May be my question is bit unclear. But, you may try the code in an <code>irb</code> console. I don&#39;t know where you would get a value as <code>&quot;Hello Hey&quot;</code> without a <code>,</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558006029, "post_id": 56153747, "comment_id": 98961496, "body": "@Abhi sorry for the typo but the question still remains you have a uniqueness check in you code that is likely to fail almost every time. I was enquiring as to the expected output if that additional Hash existed"}], "answers": [{"tags": [], "owner": {"reputation": 5259, "user_id": 715286, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BqXXo.jpg?s=128&g=1", "display_name": "Qortex", "link": "https://stackoverflow.com/users/715286/qortex"}, "is_accepted": true, "score": 3, "last_activity_date": 1557937697, "creation_date": 1557937697, "answer_id": 56153846, "question_id": 56153747, "link": "https://stackoverflow.com/questions/56153747/merge-ruby-hash-values-with-same-key/56153846#56153846", "title": "Merge Ruby Hash values with same key", "body": "<p>I can't see a simpler version of your code. To make it fully work, you can use the first argument in the <code>merge</code> block instead of dismissing it to differentiate when you need to merge <code>a</code> and <code>b</code> or when you just use <code>a</code>. Your line becomes:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>s.merge(l) { |key, a, b| key == :a ? a : [a, b].uniq.join(\", \") }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557946704, "post_id": 56154098, "comment_id": 98941080, "body": "Worth pointing out that <code>{:a=&gt;4, :b=&gt;&quot;Hello&quot;, :c=&gt;&quot;Test1&quot;}</code> will result in <code>{:a=&gt;1, :b=&gt;&quot;Hello Hey Hello&quot;, :c=&gt;&quot;Test1&quot;}</code> because <code>uniq</code> will be comparing <code>&quot;Hello Hey&quot;</code> to <code>&quot;Hello&quot;</code> so maybe <code>h.group_by { |h| h[:c] }.transform_values {|v| v.uniq {|h| h[:b]} }.values....</code>"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1557938705, "creation_date": 1557938705, "answer_id": 56154098, "question_id": 56153747, "link": "https://stackoverflow.com/questions/56153747/merge-ruby-hash-values-with-same-key/56154098#56154098", "title": "Merge Ruby Hash values with same key", "body": "<p>Maybe you can consider this option, but I don't know if it is less complex:</p>\n\n<pre><code>h.group_by { |h| h[:c] }.values.map { |tmp| tmp[0].merge(*tmp[1..]) { |key, oldval, newval| key == :b ? [oldval, newval].join(' ') : oldval } }\n#=&gt; [{:a=&gt;1, :b=&gt;\"Hello Hey\", :c=&gt;\"Test1\"}, {:a=&gt;3, :b=&gt;\"Hi\", :c=&gt;\"Test2\"}]\n</code></pre>\n\n<p>The first part groups the hashes by <code>:c</code></p>\n\n<pre><code>h.group_by { |h| h[:c] }.values #=&gt; [[{:a=&gt;1, :b=&gt;\"Hello\", :c=&gt;\"Test1\"}, {:a=&gt;2, :b=&gt;\"Hey\", :c=&gt;\"Test1\"}], [{:a=&gt;3, :b=&gt;\"Hi\", :c=&gt;\"Test2\"}]]\n</code></pre>\n\n<p>Then it maps to merge the first elements with others using <a href=\"https://ruby-doc.org/core-2.6.2/Hash.html#method-i-merge\" rel=\"nofollow noreferrer\">Hash#merge</a></p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1557970687, "last_edit_date": 1557970687, "creation_date": 1557967535, "answer_id": 56159378, "question_id": 56153747, "link": "https://stackoverflow.com/questions/56153747/merge-ruby-hash-values-with-same-key/56159378#56159378", "title": "Merge Ruby Hash values with same key", "body": "<pre><code>h.each_with_object({}) do |g,h|\n  h.update(g[:c]=&gt;g) { |_,o,n| o.merge(b: \"#{o[:b]}, #{n[:b]}\") }\nend.values\n  #=&gt; [{:a=&gt;1, :b=&gt;\"Hello, Hey\", :c=&gt;\"Test1\"},\n  #    {:a=&gt;3, :b=&gt;\"Hi\", :c=&gt;\"Test2\"}] \n</code></pre>\n\n<p>This uses the form of <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> that employs a block (here <code>{ |_,o,n| o.merge(b: \"#{o[:b]}, #{n[:b]}\") }</code>) to determine the values of keys that are present in both hashes being merged. The first block variable holds the common key. I\u2019ve used an underscore for that variable mainly to signal to the reader that it is not used in the block calculation. See the doc for definitions of the other two block variables.</p>\n\n<p>Note that the receiver of <code>values</code> equals the following.</p>\n\n<pre><code>h.each_with_object({}) do |g,h|\n  h.update(g[:c]=&gt;g) { |_,o,n| o.merge(b: \"#{o[:b]}, #{n[:b]}\") }\nend\n  #=&gt; { \u201cTest1\u201d=&gt;{:a=&gt;1, :b=&gt;\"Hello, Hey\", :c=&gt;\"Test1\"},\n  #     \u201cTest2=&gt;{:a=&gt;3, :b=&gt;\"Hi\", :c=&gt;\"Test2\"} }\n</code></pre>\n"}], "owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 56153846, "answer_count": 3, "score": 0, "last_activity_date": 1557970687, "creation_date": 1557937305, "question_id": 56153747, "link": "https://stackoverflow.com/questions/56153747/merge-ruby-hash-values-with-same-key", "title": "Merge Ruby Hash values with same key", "body": "<p>Is this possible to achieve with selected keys:</p>\n\n<p>Eg</p>\n\n<pre><code>h = [\n  {a: 1, b: \"Hello\", c: \"Test1\"},\n  {a: 2, b: \"Hey\", c: \"Test1\"},\n  {a: 3, b: \"Hi\", c: \"Test2\"}\n]\n</code></pre>\n\n<p><strong>Expected Output</strong></p>\n\n<pre><code>[\n  {a: 1, b: \"Hello, Hey\", c: \"Test1\"}, # See here, I don't want key 'a' to be merged\n  {a: 3, b: \"Hi\", c: \"Test2\"}\n]\n</code></pre>\n\n<p><strong>My Try</strong></p>\n\n<pre><code>g = h.group_by{|k| k[:c]}.values\nOUTPUT =&gt;\n  [\n    [\n      {:a=&gt;1, :b=&gt;\"Hello\", :c=&gt;\"Test1\"},\n      {:a=&gt;2, :b=&gt;\"Hey\", :c=&gt;\"Test1\"}\n    ], [\n      {:a=&gt;3, :b=&gt;\"Hi\", :c=&gt;\"Test2\"}\n    ]\n  ]\n\ng.each do |v|\n  if v.length &gt; 1\n    c = v.reduce({}) do |s, l|\n      s.merge(l) { |_, a, b| [a, b].uniq.join(\", \") }\n    end\n  end\n\n  p c #{:a=&gt;\"1, 2\", :b=&gt;\"Hello, Hey\", :c=&gt;\"Test1\"}\nend\n</code></pre>\n\n<p>So, the output I get is</p>\n\n<pre><code>{:a=&gt;\"1, 2\", :b=&gt;\"Hello, Hey\", :c=&gt;\"Test1\"}\n</code></pre>\n\n<p>But, I needed</p>\n\n<pre><code>{a: 1, b: \"Hello, Hey\", c: \"Test1\"}\n</code></pre>\n\n<p><strong>NOTE:</strong> This is just a test array of HASH I have taken to put my question. But, the actual hash has a lots of keys. So, please don't reply with key comparison answers</p>\n\n<p><strong>I need a less complex solution</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560359072, "post_id": 56153512, "comment_id": 99713631, "body": "You got what you want so you&#39;re out-of-here, without even bothering to select an answer."}], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1557946071, "post_id": 56153687, "comment_id": 98940819, "body": "This is weirdly unidiomatic. Why do <code>Hash[:name, h[&quot;publisher_name&quot;]]</code> when you can just do <code>{ name: h[&quot;publisher_name&quot;] }</code>. Same for the following to lines where you could do <code>{ mn: h[&quot;mn&quot;], ... }</code> and <code>{ partner: partner_name, ... }</code>, respectively."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1557963572, "post_id": 56153687, "comment_id": 98946489, "body": "Lol, unidiomatic just for that? I don&#39;t think so :)"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1557971669, "post_id": 56153687, "comment_id": 98947821, "body": "No need to get defensive."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1557992391, "post_id": 56153687, "comment_id": 98953893, "body": "I don&#39;t like <code>{}</code> inside other <code>{}</code>"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1557937079, "creation_date": 1557937079, "answer_id": 56153687, "question_id": 56153512, "link": "https://stackoverflow.com/questions/56153512/merge-array-of-hashes-and-re-sort-it/56153687#56153687", "title": "Merge array of hashes and re-sort it", "body": "<p>Anything like this?</p>\n\n<pre><code>arr.group_by { |item| item[\"partner_name\"] }.\n    map do |partner_name, data| \n      publishers = data.map { |h| Hash[:name, h[\"publisher_name\"]] }\n      modules = data.map { |h| Hash[:mn, h[\"mn\"], :mid, h[\"mid\"]] }\n      Hash[:partner, partner_name, :publishers, publishers, :modules, modules] \n    end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1557946310, "post_id": 56155633, "comment_id": 98940908, "body": "Why <code>reduce</code> instead of <code>map</code> here?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1557947200, "post_id": 56155633, "comment_id": 98941298, "body": "@JordanRunning why <code>map</code> instead of <code>each_with_object({})</code>? since the desired output is a <code>Hash</code>"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557947354, "post_id": 56155633, "comment_id": 98941364, "body": "@engineersmnky That&#39;s a fair question, and one only Max can answer."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1557947718, "post_id": 56155633, "comment_id": 98941531, "body": "@JordanRunning you are right, you can use map instead of reduce. I will edit the answer."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 1, "last_activity_date": 1557947744, "last_edit_date": 1557947744, "creation_date": 1557945004, "answer_id": 56155633, "question_id": 56153512, "link": "https://stackoverflow.com/questions/56153512/merge-array-of-hashes-and-re-sort-it/56155633#56155633", "title": "Merge array of hashes and re-sort it", "body": "<p>group_by and map</p>\n\n<pre><code>result = arr.\n  group_by { |r| r[\"partner_name\"] }.\n  map do |(partner_name, records)|\n    {\n      name: partner_name,\n      publishers: records.map do |r|\n        { name: r[\"publisher_name\"] }\n      end,\n      modules: records.map do |r|\n        { mn: r[\"mn\"], mid: r[\"mid\"] }\n      end,\n    }\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1557948239, "last_edit_date": 1557948239, "creation_date": 1557947850, "answer_id": 56156266, "question_id": 56153512, "link": "https://stackoverflow.com/questions/56153512/merge-array-of-hashes-and-re-sort-it/56156266#56156266", "title": "Merge array of hashes and re-sort it", "body": "<p>Since the Hashes in the Array already appear to be scoped to a partner a simple implementation could look like: </p>\n\n<pre><code>new_h = {partner: arr.first[\"partner_name\"],publishers: [],modules: []}\narr.each_with_object(new_h) do |h, result| \n  result[:publishers] &lt;&lt; {name: h[\"publisher_name\"]}\n  result[:modules] &lt;&lt; h.slice(\"mn\",\"mid\")\nend\n</code></pre>\n\n<p>If they are not scoped as shown then just group and map the same:</p>\n\n<pre><code>arr.group_by {|h| h[\"partner_name\"]}.map do |name,values|\n  new_h = {partner: name,publishers: [],modules: []}\n  values.each_with_object(new_h) do |h, result| \n    result[:publishers] &lt;&lt; {name: h[\"publisher_name\"]}\n    result[:modules] &lt;&lt; h.slice(\"mn\",\"mid\")\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11505273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d1c9c1a5f263684864b92f2aa8c61bd?s=128&d=identicon&r=PG&f=1", "display_name": "xxx", "link": "https://stackoverflow.com/users/11505273/xxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1557948239, "creation_date": 1557936268, "last_edit_date": 1557945681, "question_id": 56153512, "link": "https://stackoverflow.com/questions/56153512/merge-array-of-hashes-and-re-sort-it", "title": "Merge array of hashes and re-sort it", "body": "<p>I have array of hashes it looks like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>arr = [\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"News - Calgary\", \"mn\"=&gt;\"\", \"mid\"=&gt;415},\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"News - Vancouver Island\", \"mn\"=&gt;\"Module 2.0 \", \"mid\"=&gt;4528},\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"News - Atlantic\", \"mn\"=&gt;\"Module 2.0 \", \"mid\"=&gt;4531},\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"News - Kitchener\", \"mn\"=&gt;\"Module 2.0 \", \"mid\"=&gt;4535},\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"News - London\", \"mn\"=&gt;\"Module 2.0 \", \"mid\"=&gt;4536},\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"News - Ottawa\", \"mn\"=&gt;\"Module 2.0 \", \"mid\"=&gt;4539},\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"News - Regina\", \"mn\"=&gt;\"Module 2.0 \", \"mid\"=&gt;4540},\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"News - Saskatoon\", \"mn\"=&gt;\"Module 2.0 \", \"mid\"=&gt;4541},\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"News - Toronto\", \"mn\"=&gt;\"Module 2.0 \", \"mid\"=&gt;4542},\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"News - Windsor\", \"mn\"=&gt;\"Module 2.0 \", \"mid\"=&gt;4544},\n  {\"partner_name\"=&gt;\"Bell\", \"publisher_name\"=&gt;\"CP24\", \"mn\"=&gt;\"Module 2.0 Platform\", \"mid\"=&gt;5413},\n]\n</code></pre>\n\n<p>i have tried to do <code>arr.group_by{|el|el['partner_name']}</code></p>\n\n<p>i want to achieve this result </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>{\n  partner:'Bell',\n  publishers: [\n    {name:'News - Vancouver Island'},\n    {name:'News - Vancouver Island'},\n    # ... and others\n  ],\n  modules:[\n    {mn: val, mid: id_val},\n    # ...\n  ],\n}\n</code></pre>\n"}, {"tags": ["ruby", "command-prompt", "text-alignment"], "comments": [{"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 2, "creation_date": 1557935628, "post_id": 56152917, "comment_id": 98936042, "body": "Please show us the code for your latest attempt and where you got stuck."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557938754, "post_id": 56152917, "comment_id": 98937585, "body": "You need to edit to define the array of elements you wish to display (e.g, &quot;Given the array <code>arr = [3, 6, 9, 4, 8, 12, 6, 12, 18]</code> I wish to...&quot;)."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1557935179, "post_id": 56153199, "comment_id": 98935804, "body": "Not <code>&#39;%-2d&#39; % n</code>?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557941442, "post_id": 56153199, "comment_id": 98938795, "body": "Or you could use String#ljust / String#rjust."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1557950119, "post_id": 56153199, "comment_id": 98942543, "body": "@Sergio, that&#39;s what I started with. Changed it to please tadman."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557950457, "post_id": 56153199, "comment_id": 98942677, "body": "@CarySwoveland: ah, I see. TIL then. :)"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1557939239, "last_edit_date": 1557939239, "creation_date": 1557935104, "answer_id": 56153199, "question_id": 56152917, "link": "https://stackoverflow.com/questions/56152917/how-can-i-make-my-multiplication-table-aligned/56153199#56153199", "title": "How can I make my multiplication-table aligned?", "body": "<pre><code>arr = [3, 6, 9, 4, 8, 12, 6, 12, 18]\nnrows = 3\n\nwidth = arr.minmax.map { |n| n.to_s.size }.max\n  #=&gt; 2\n\nputs arr.each_slice(nrows).map { |row| '| ' +\n  row.map { |n| \"%-#{width}d\" % n }.join(' | ') + ' |' }\n| 3  | 6  | 9  |\n| 4  | 8  | 12 |\n| 6  | 12 | 18 |\n</code></pre>\n\n<p>Perhaps you'd prefer to right-adjust:</p>\n\n<pre><code>puts arr.each_slice(nrows).map { |row| '| ' +\n  row.map { |n| \"%#{width}d\" % n }.join(' | ') + ' |' }\n|  3 |  6 |  9 |\n|  4 |  8 | 12 |\n|  6 | 12 | 18 |\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Kernel.html#method-i-sprintf\" rel=\"nofollow noreferrer\">Kernel#sprintf</a> for formatting directives. If it is known that all elements of <code>arr</code> are non-negative we could write:</p>\n\n<pre><code>width = arr.max.to_s.size\n  #=&gt; 2\n</code></pre>\n\n<p>If you wish to make each column as narrow as possible, adjusting right, you could do the following.</p>\n\n<pre><code>arr = [3, 6, 9, 4, -81, 12, 6, 12, 1800]\nnrows = 3\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>col_widths = nrows.times.map { |i|\n  (i..nrows*nrows-1).step(3).map { |j| arr[j].to_s.size }.max }\n  #=&gt; [1, 3, 4]\n\nputs arr.each_slice(nrows).map { |row| '| ' +\n  row.map.with_index { |n,i| \"%#{col_widths[i]}d\" % n }.join(' | ') + ' |' }\n| 3 |   6 |    9 |\n| 4 | -81 |   12 |\n| 6 |  12 | 1800 |\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11248320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f84c4a2e34d60f2184a7648781d97b9?s=128&d=identicon&r=PG&f=1", "display_name": "cassavvi", "link": "https://stackoverflow.com/users/11248320/cassavvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1557939239, "creation_date": 1557934060, "question_id": 56152917, "link": "https://stackoverflow.com/questions/56152917/how-can-i-make-my-multiplication-table-aligned", "title": "How can I make my multiplication-table aligned?", "body": "<p>Im making a program where you give 2 inputs, the amount of columns and amount of rows to a multiplikation-system. But when having bigger numbers (2 digit numbers) it makes the system unaligned.</p>\n\n<p>Theres nothing wrong with the code. All I want is something that makes the \"|\" aligned vertically.</p>\n\n<p>I want the output to be;</p>\n\n<pre><code>| 3 | 6  | 9  |\n| 4 | 8  | 12 |\n| 6 | 12 | 18 |\n</code></pre>\n\n<p>But I get the output;</p>\n\n<pre><code>| 3 | 6 | 9 |\n| 4 | 8 | 12 |\n| 6 | 12 | 18 |\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1557921938, "post_id": 56148901, "comment_id": 98927182, "body": "Let&#39;s get this straight: You have a collection of <code>@posts</code>, and each post can be in many <code>categories</code>. So what are you trying to display? A filtered list of those <code>@posts</code>; only the ones which are in category <code>1</code>? Or, for each post, the title of their &quot;first&quot; <code>category</code>? Or, the &quot;first&quot; post - if any - which is in category <code>1</code>?"}, {"owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "edited": false, "score": 0, "creation_date": 1557923708, "post_id": 56148901, "comment_id": 98928321, "body": "What is &quot;Not Working?&quot; An error? Unexpected behavior? Please describe what you want to happen, then describe what is actually happening."}, {"owner": {"reputation": 49, "user_id": 11231142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6521790d4e29e8127ca7d61600ed1e5?s=128&d=identicon&r=PG&f=1", "display_name": "albert", "link": "https://stackoverflow.com/users/11231142/albert"}, "edited": false, "score": 0, "creation_date": 1557936003, "post_id": 56148901, "comment_id": 98936274, "body": "i want the post in category id 1 to show at that section instead of all posts"}], "answers": [{"tags": [], "owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "is_accepted": false, "score": 1, "last_activity_date": 1557923641, "last_edit_date": 1557923641, "creation_date": 1557923259, "answer_id": 56149359, "question_id": 56148901, "link": "https://stackoverflow.com/questions/56148901/how-to-show-post-of-a-specific-category/56149359#56149359", "title": "How to show post of a specific category", "body": "<p>In your code:</p>\n\n<pre><code>&lt;% @posts.each do |post| %&gt;\n    &lt;h5&gt;&lt;td&gt;&lt;%=link_to post.category(1).title, post %&gt;&lt;/td&gt;&lt;/h5&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>...this part looks suspicious: <code>category(1)</code>. If post belongs_to category, try this:</p>\n\n<pre><code>post.category.title\n</code></pre>\n\n<p>If a post has_many (or has_and_belongs_to_many) categories, try this:</p>\n\n<pre><code>post.categories.first.title\n</code></pre>\n\n<p>One of those two should give you what you want. </p>\n\n<p>Beyond that, I'm not sure you're trying to link. You're linking to a post, but the linktext is the category title. So, if you have three posts in the category, \"Recipes,\" all three links will say \"Recipes.\" Are you trying to link to the post or the category? Either way, the linktext should relate to the url.  </p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 10472289, "user_type": "registered", "profile_image": "https://graph.facebook.com/1492612627483188/picture?type=large", "display_name": "Omiyera Damilola", "link": "https://stackoverflow.com/users/10472289/omiyera-damilola"}, "is_accepted": true, "score": 1, "last_activity_date": 1558171094, "creation_date": 1558171094, "answer_id": 56197603, "question_id": 56148901, "link": "https://stackoverflow.com/questions/56148901/how-to-show-post-of-a-specific-category/56197603#56197603", "title": "How to show post of a specific category", "body": "<p>if you want to show a post of a category id, this should help</p>\n\n<pre><code>&lt;% Post.where(category_id: 1).each do |post| %&gt;\n</code></pre>\n\n<p>where that 1 would be the category id</p>\n"}], "owner": {"reputation": 49, "user_id": 11231142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6521790d4e29e8127ca7d61600ed1e5?s=128&d=identicon&r=PG&f=1", "display_name": "albert", "link": "https://stackoverflow.com/users/11231142/albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56197603, "answer_count": 2, "score": -2, "last_activity_date": 1558171094, "creation_date": 1557921661, "question_id": 56148901, "link": "https://stackoverflow.com/questions/56148901/how-to-show-post-of-a-specific-category", "title": "How to show post of a specific category", "body": "<p>I am trying to show only post from a particular category id </p>\n\n<p>I have a category section and i have my relationship between categories and post working i just want to show post a specific category id instead of calling all post.</p>\n\n<p>I have tried this but it's not working.</p>\n\n<pre><code>&lt;% @posts.each do |post| %&gt;\n    &lt;h5&gt;&lt;td&gt;&lt;%=link_to post.category(1).title, post %&gt;&lt;/td&gt;&lt;/h5&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1557920011, "post_id": 56148199, "comment_id": 98925977, "body": "Could it be that the ActiveStorage blobs table is not cleaned when you run <code>Sedcard.destroy_all</code>? <a href=\"https://guides.rubyonrails.org/active_storage_overview.html#discarding-files-stored-during-system-tests\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 0, "last_activity_date": 1557921320, "creation_date": 1557921320, "answer_id": 56148796, "question_id": 56148199, "link": "https://stackoverflow.com/questions/56148199/duplicate-entries-when-trying-to-seed-image-on-activestorage/56148796#56148796", "title": "Duplicate entries when trying to seed image on ActiveStorage", "body": "<p>You need to purge the attachments.</p>\n\n<p>Try adding this snippet before destroyingthe <code>Sedcard</code>'s</p>\n\n<pre><code>Sedcard.all.each{ |s| s.photos.purge }\n</code></pre>\n\n<p>Ref: <a href=\"https://edgeguides.rubyonrails.org/active_storage_overview.html#removing-files\" rel=\"nofollow noreferrer\">https://edgeguides.rubyonrails.org/active_storage_overview.html#removing-files</a></p>\n"}, {"tags": [], "owner": {"reputation": 2038, "user_id": 2828594, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/4XNqm.jpg?s=128&g=1", "display_name": "soueuls", "link": "https://stackoverflow.com/users/2828594/soueuls"}, "is_accepted": false, "score": 1, "last_activity_date": 1557947470, "creation_date": 1557947470, "answer_id": 56156184, "question_id": 56148199, "link": "https://stackoverflow.com/questions/56148199/duplicate-entries-when-trying-to-seed-image-on-activestorage/56156184#56156184", "title": "Duplicate entries when trying to seed image on ActiveStorage", "body": "<p>I found the problem myself.</p>\n\n<p>I was using UUID as my model's primary key which is not natively compatible with ActiveStorage. Thus, I more or less followed the instructions <a href=\"https://www.wrburgess.com/posts/2018-02-03-1.html\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 2038, "user_id": 2828594, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/4XNqm.jpg?s=128&g=1", "display_name": "soueuls", "link": "https://stackoverflow.com/users/2828594/soueuls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557947470, "creation_date": 1557919413, "question_id": 56148199, "link": "https://stackoverflow.com/questions/56148199/duplicate-entries-when-trying-to-seed-image-on-activestorage", "title": "Duplicate entries when trying to seed image on ActiveStorage", "body": "<p>I am new to the Ruby on Rails ecosystem so might question might be really trivial.</p>\n\n<p>I have set up an Active Storage on one of my model</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Sedcard &lt; ApplicationRecord\n  has_many_attached :photos\nend\n</code></pre>\n\n<p>And I simply want to seed data with <code>Faker</code> in it like so:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'faker'\n\nSedcard.destroy_all\n20.times do |_i|\n  sedcard = Sedcard.create!(\n    showname: Faker::Name.female_first_name,\n    description: Faker::Lorem.paragraph(10),\n    phone: Faker::PhoneNumber.cell_phone,\n    birthdate: Faker::Date.birthday(18, 40),\n    gender: Sedcard.genders[:female],\n    is_active: Faker::Boolean.boolean\n  )\n\n  index = Faker::Number.unique.between(1, 99)\n  image = open(\"https://randomuser.me/api/portraits/women/#{index}.jpg\")\n  sedcard.photos.attach(io: image, filename: \"avatar#{index}.jpg\", content_type: 'image/png')\nend\n</code></pre>\n\n<p>The problem is that some of these records end up with multiple photos attached to them, could be 5 or 10.</p>\n\n<p>Most records are seeded well, they have only one photo associated, but the ones with multiple photos all follow the same pattern, they are all seeded with the exact same images.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "aws-sdk-ruby"], "comments": [{"owner": {"reputation": 1086, "user_id": 1327379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZrNi8.jpg?s=128&g=1", "display_name": "andreofthecape", "link": "https://stackoverflow.com/users/1327379/andreofthecape"}, "edited": false, "score": 0, "creation_date": 1557924664, "post_id": 56148139, "comment_id": 98928907, "body": "Did you restart your rails server after running bundle install?"}, {"owner": {"reputation": 743, "user_id": 9558225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ME97i.jpg?s=128&g=1", "display_name": "Neeraj Amoli", "link": "https://stackoverflow.com/users/9558225/neeraj-amoli"}, "reply_to_user": {"reputation": 1086, "user_id": 1327379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZrNi8.jpg?s=128&g=1", "display_name": "andreofthecape", "link": "https://stackoverflow.com/users/1327379/andreofthecape"}, "edited": false, "score": 0, "creation_date": 1557925272, "post_id": 56148139, "comment_id": 98929328, "body": "thanks for your response @andreofthecape ,yes i restart rails server. still getting same exception."}], "answers": [{"tags": [], "owner": {"reputation": 24753, "user_id": 489765, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bdc5163fd78b041c9d4a405204c5ad9a?s=128&d=identicon&r=PG", "display_name": "aromero", "link": "https://stackoverflow.com/users/489765/aromero"}, "is_accepted": false, "score": 0, "last_activity_date": 1557940697, "creation_date": 1557940697, "answer_id": 56154602, "question_id": 56148139, "link": "https://stackoverflow.com/questions/56148139/aws-costexplorer-api-giving-exception-using-ruby-sdk/56154602#56154602", "title": "Aws CostExplorer Api giving exception using ruby sdk", "body": "<p>You are using version 3 while your docs point to v2.</p>\n\n<p>Check <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/CostExplorer.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/CostExplorer.html</a>, specially the following</p>\n\n<blockquote>\n  <p>This module provides support for AWS Cost Explorer Service. This\n  module is available in the aws-sdk-costexplorer gem.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 743, "user_id": 9558225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ME97i.jpg?s=128&g=1", "display_name": "Neeraj Amoli", "link": "https://stackoverflow.com/users/9558225/neeraj-amoli"}, "edited": false, "score": 0, "creation_date": 1557987652, "post_id": 56161793, "comment_id": 98951607, "body": "i update these gem , now exception gone . Thanks :)"}], "tags": [], "owner": {"reputation": 111, "user_id": 8994983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a142b0b7d76f3c77ebccc5449eb4d88a?s=128&d=identicon&r=PG&f=1", "display_name": "Neha Jaggi", "link": "https://stackoverflow.com/users/8994983/neha-jaggi"}, "is_accepted": false, "score": 3, "last_activity_date": 1557986847, "creation_date": 1557986847, "answer_id": 56161793, "question_id": 56148139, "link": "https://stackoverflow.com/questions/56148139/aws-costexplorer-api-giving-exception-using-ruby-sdk/56161793#56161793", "title": "Aws CostExplorer Api giving exception using ruby sdk", "body": "<p>gems you used are not compatible with <strong>costexplorer</strong> sdk.\nuse this-</p>\n\n<ol>\n<li>gem 'aws-sigv4', '~> 1.1'</li>\n<li>gem 'aws-sdk-core', '~> 3.52', '>= 3.52.1'</li>\n<li>gem 'aws-sdk-costexplorer', '~> 1.22'</li>\n</ol>\n\n<p>Hope this will help you :)</p>\n"}], "owner": {"reputation": 743, "user_id": 9558225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ME97i.jpg?s=128&g=1", "display_name": "Neeraj Amoli", "link": "https://stackoverflow.com/users/9558225/neeraj-amoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1557986847, "creation_date": 1557919219, "last_edit_date": 1557983162, "question_id": 56148139, "link": "https://stackoverflow.com/questions/56148139/aws-costexplorer-api-giving-exception-using-ruby-sdk", "title": "Aws CostExplorer Api giving exception using ruby sdk", "body": "<p>I found this reference <a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/CostExplorer/Client.html#initialize-instance_method\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdkforruby/api/Aws/CostExplorer/Client.html#initialize-instance_method</a>   for finding cost of ec2 instance usages ,while in implementing phase i got exception.</p>\n\n<p>in gem file i used this\n               gem 'aws-sdk', '~> 3'</p>\n\n<pre><code>   cost_client = Aws::CostExplorer::Client.new(\n                 region: \"us-east-1\",\n                 access_key_id: \"XXXX\",\n                 secret_access_key: \"XXX\"\n                )\n\n   resp = cost_client.get_cost_and_usage({\n          time_period: { # required\n          start: \"2019-01-01\", # required\n          end: \"2019-05-01\", # required\n          },\n   granularity: \"DAILY\", # accepts DAILY, MONTHLY, HOURLY\n         filter: {\n         or: [\n         {\n            # recursive Expression\n         },\n        ],\n        and: [\n         {\n            # recursive Expression\n         },\n        ],\n       not: {\n           # recursive Expression\n          },\n      dimensions: {\n         key: \"AZ\", # accepts AZ, INSTANCE_TYPE, LINKED_ACCOUNT, OPERATION, PURCHASE_TYPE, REGION, SERVICE, USAGE_TYPE, USAGE_TYPE_GROUP, RECORD_TYPE, OPERATING_SYSTEM, TENANCY, SCOPE, PLATFORM, SUBSCRIPTION_ID, LEGAL_ENTITY_NAME, DEPLOYMENT_OPTION, DATABASE_ENGINE, CACHE_ENGINE, INSTANCE_TYPE_FAMILY, BILLING_ENTITY, RESERVATION_ID\n        values: [\"Value\"],\n         },\n       tags: {\n           key: \"TagKey\",\n           values: [\"Value\"],\n         },\n        },\n       metrics: [\"MetricName\"],\n       group_by: [\n         {\n           type: \"DIMENSION\", # accepts DIMENSION, TAG\n           key: \"GroupDefinitionKey\",\n         },\n       ],\n       next_page_token: \"NextPageToken\",\n    })\n</code></pre>\n\n<p>i got  this excetion NameError: uninitialized constant Aws::CostExplorer.how can i get response from this api?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "associations"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 3, "creation_date": 1557920737, "post_id": 56147676, "comment_id": 98926428, "body": "You&#180;re correct in that storing arrays in the DB is not a very good solution. It does not work with ActiveRecord associations and is poor DB design. A better idea is to actually setup a join table between users and locations which is how relational databases are meant to be used."}, {"owner": {"reputation": 13, "user_id": 11493933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02dd0e9912bb538d1bafb596c4682e4a?s=128&d=identicon&r=PG&f=1", "display_name": "vimolas", "link": "https://stackoverflow.com/users/11493933/vimolas"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1557933818, "post_id": 56147676, "comment_id": 98934997, "body": "You are right, I could simply associate users and locations, adding &#39;has_many :locations, through: :tenant&#39; to the User model. However, that would associate ALL the locations to the user, which is not what I&#39;m trying to achieve."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1557946739, "post_id": 56147676, "comment_id": 98941094, "body": "No, what I&#39;m saying is create a join model which describes the relation between users and locations and set it up as a many to many association. This kind of authorization is usually done with a system of roles - take a look at the <a href=\"https://github.com/RolifyCommunity/rolify\" rel=\"nofollow noreferrer\">rolify</a> gem if you want an example."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11493933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02dd0e9912bb538d1bafb596c4682e4a?s=128&d=identicon&r=PG&f=1", "display_name": "vimolas", "link": "https://stackoverflow.com/users/11493933/vimolas"}, "edited": false, "score": 0, "creation_date": 1557933908, "post_id": 56152366, "comment_id": 98935058, "body": "Thanks Marlin, I had forgotten the &#39;locations&#39; association in the Tenant model. I&#39;ve edited the question accordingly.  Your solution would associate ALL the locations of a certain tenant to the user, which is not what I&#39;m trying to achieve. I&#39;d like to associate only some of them."}], "tags": [], "owner": {"reputation": 8973, "user_id": 831564, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b7b5cb565edb37aac67f053f64f0324f?s=128&d=identicon&r=PG", "display_name": "Marlin Pierce", "link": "https://stackoverflow.com/users/831564/marlin-pierce"}, "is_accepted": false, "score": 0, "last_activity_date": 1557932407, "creation_date": 1557932407, "answer_id": 56152366, "question_id": 56147676, "link": "https://stackoverflow.com/questions/56147676/how-to-structure-a-has-many-association-with-a-dynamic-scope/56152366#56152366", "title": "How to structure a has_many association with a dynamic scope?", "body": "<p>First, your code is missing the <code>locations</code> association in the <code>Tenant</code> class.</p>\n\n<pre><code>class Tenant &lt; ActiveRecord::Base\n  has_many :users, dependent: :destroy\n  has_many :locations\n</code></pre>\n\n<p>Let's say the variable <code>manager</code> has a <code>User</code> record.  Then the locations it can control are:</p>\n\n<pre><code>manager.tenant.locations\n</code></pre>\n\n<p>If you want, you can shorten this with a delegate statement.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  belongs_to :tenant\n  delegate :locations, to: :tenant\n</code></pre>\n\n<p>then you can call this with</p>\n\n<pre><code>manager.locations\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1557950485, "last_edit_date": 1557950485, "creation_date": 1557948860, "answer_id": 56156473, "question_id": 56147676, "link": "https://stackoverflow.com/questions/56147676/how-to-structure-a-has-many-association-with-a-dynamic-scope/56156473#56156473", "title": "How to structure a has_many association with a dynamic scope?", "body": "<p>A common pattern used for authorization is roles:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_many :user_roles\n  has_many :roles, through: :user_roles\n\n  def add_role(name, location)\n    self.roles &lt;&lt; Role.find_or_create_by(name: name, location: location)\n  end\n\n  def has_role?(name, location)\n    self.roles.exists?(name: name, location: location)\n  end\nend\n\n# rails g model role name:string\n# make sure you add a unique index on name and location\nclass Role &lt; ApplicationRecord\n  belongs_to :location\n  has_many :user_roles\n  has_many :users, through: :user_roles\n  validates_uniqueness_of :name, scope: :location_id\nend\n\n# rails g model user_role user:references role:references\n# make sure you add a unique compound index on role_id and user_id\nclass UserRole &lt; ApplicationRecord\n  belongs_to :role\n  belongs_to :user\n  validates_uniqueness_of :user_id, scope: :role_id\nend\n\nclass Location &lt; ApplicationRecord\n  has_many :roles\n  has_many :users, through: :roles\nend\n</code></pre>\n\n<p>By making the system a bit more generic than say a controlled_locations association you can re-use it for different cases.</p>\n\n<blockquote>\n  <p>Let's say that logging in an Admin, I selected that the user with ID 1\n  (a manager) can control one location (Boston Stadium)</p>\n</blockquote>\n\n<pre><code>User.find(1)\n    .add_role(:manager, Location.find_by(name: \"Boston Stadium\"))\n</code></pre>\n\n<p>In actual MVC terms you can do this by setting up roles as a nested resource that can be CRUD'ed just like any other resource. Editing multiple roles in a single form can be done with <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html\" rel=\"nofollow noreferrer\"><code>accepts_nested_attributes</code></a> or AJAX.</p>\n\n<p>If you want to scope a query by the presence of a role then join the roles and user roles table:</p>\n\n<pre><code>Location.joins(roles: :user_roles)\n        .where(roles: { name: :manager })\n        .where(user_roles: { user_id: 1 })\n</code></pre>\n\n<p>To authenticate a single resource you would do:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protected \n  def deny_access\n    redirect_to \"your/sign_in/path\", error: 'You are not authorized.'\n  end\nend\n\nclass LocationsController &lt; ApplicationController\n  # ...\n  def update\n    @location = Location.find(params[:location_id])\n    deny_access and return unless current_user.has_role?(:manger, @location)\n    # ...\n  end\nend\n</code></pre>\n\n<p>Instead of rolling your own authorization system though I would consider using <a href=\"https://github.com/RolifyCommunity/rolify\" rel=\"nofollow noreferrer\">rolify</a> and <a href=\"https://github.com/varvet/pundit\" rel=\"nofollow noreferrer\">pundit</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 11493933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02dd0e9912bb538d1bafb596c4682e4a?s=128&d=identicon&r=PG&f=1", "display_name": "vimolas", "link": "https://stackoverflow.com/users/11493933/vimolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1557950485, "creation_date": 1557917773, "last_edit_date": 1557933608, "question_id": 56147676, "link": "https://stackoverflow.com/questions/56147676/how-to-structure-a-has-many-association-with-a-dynamic-scope", "title": "How to structure a has_many association with a dynamic scope?", "body": "<p>I have a users table in my db. A user can be either of type 'admin' or 'manager'.</p>\n\n<p>Given the models and schema below, I would like that for each instance of 'manager' user, an 'admin' user could select one, some or all the locations of the tenant that the manager belongs to in order to select which locations the manager can have control over.</p>\n\n<h2>My models</h2>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  belongs_to :tenant\n</code></pre>\n\n<pre><code>class Tenant &lt; ActiveRecord::Base\n  has_many :users, dependent: :destroy\n  has_many :locations, dependent: :destroy\n</code></pre>\n\n<pre><code>class Location &lt; ActiveRecord::Base\n  belongs_to :tenant, inverse_of: :locations\n</code></pre>\n\n<h1>I've tried two paths</h1>\n\n<p><strong>First</strong>, trying to establish a scoped has_many association between the User and the Location models. However, I can't wrap my head around structuring this scope so that an 'admin' user could select which locations the 'manager' users can control.</p>\n\n<p><strong>Second</strong>, setting up a controlled_locations attribute in the users table. Then I set up some code so that an 'admin' user can select which locations a 'manager' can control, populating its 'controlled_locations' attribute. However, what gets saved in the database (inside the controlled_locations array) is strings instead of instances of locations.</p>\n\n<h2>Here's the code that I tried for the second path:</h2>\n\n<h2>The migration</h2>\n\n<pre><code>def change\n  add_column :users, :controlled_locations, :string, array: true, default: []\nend\n</code></pre>\n\n<h2>In the view</h2>\n\n<pre><code>= f.input :controlled_locations, label: 'Select', collection: @tenant_locations, include_blank: \"Anything\", wrapper_html: { class: 'form-group' }, as: :check_boxes, include_hidden: false, input_html: {multiple: true}\n</code></pre>\n\n<h2>In the users controller (inside the update method)</h2>\n\n<pre><code>if params[\"user\"][\"controlled_locations\"]\n  params[\"user\"][\"controlled_locations\"].each do |l|\n    resource.controlled_locations &lt;&lt; Location.find(l.to_i)\n  end\n  resource.save!\nend\n</code></pre>\n\n<h1>What I expect</h1>\n\n<p>First of all, I'm not quite sure the second path that I tried is a good approach (storing arrays in the db). So my best choice would be to set up a scoped association if it's possible.</p>\n\n<p><em>In case the second path is feasible, what I would like to get is something like this. Let's say that logging in an Admin, I selected that the user with ID 1 (a manager) can control one location (Boston Stadium):</em></p>\n\n<pre><code>user = User.find(1)\nuser.controlled_locations = [#&lt;Location id: 55, name: \"Boston Stadium\", created_at: \"2018-10-03 12:45:58\", updated_at: \"2018-10-03 12:45:58\", tenant_id: 5&gt;]\n</code></pre>\n\n<p><em>Instead, what I get after trying is this:</em></p>\n\n<pre><code>user = User.find(1)\nuser.controlled_locations = [\"#&lt;Location:0x007fd2be0717a8&gt;\"]\n</code></pre>\n\n<p>Instead of instances of locations, what gets saved in the array is just plain strings.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "service-object"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 5, "last_activity_date": 1557917006, "creation_date": 1557917006, "answer_id": 56147434, "question_id": 56147317, "link": "https://stackoverflow.com/questions/56147317/rails-destroy-action-doesnt-delete/56147434#56147434", "title": "Rails destroy action doesn&#39;t delete", "body": "<p>You're creating the object but you're not calling <code>call</code>, the method that does the work</p>\n\n<pre><code>def destroy\n  UserStocksDestroyer.new(current_user, params, flash).call\n  redirect_to my_portfolio_path\nend\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56147434, "answer_count": 1, "score": 1, "last_activity_date": 1557917057, "creation_date": 1557916648, "question_id": 56147317, "link": "https://stackoverflow.com/questions/56147317/rails-destroy-action-doesnt-delete", "title": "Rails destroy action doesn&#39;t delete", "body": "<p>I want to add service objects in to my controller. However destroy action seems didn't work properly - basically it doesn't delete anything just redirect to the page without flash message.</p>\n\n<p><strong>user_stock_destroyer.rb</strong></p>\n\n<pre><code>class UserStocksDestroyer\n  def initialize(current_user, params, flash)\n    @current_user = current_user\n    @params = params[:id]\n    @flash = flash\n  end\n\n  def call\n    stock = Stock.find(params)\n    @user_stock = UserStock.where(user_id: current_user.id, stock_id: stock.id).first\n    @user_stock.destroy!\n    flash[:notice] = 'Stock successfully removed'\n  end\n\n  private\n\n  attr_reader :current_user, :params, :flash\nend\n</code></pre>\n\n<p><strong><em>user_stocks_controller.rb</em></strong></p>\n\n<pre><code>class UserStocksController &lt; ApplicationController\n  def destroy\n    UserStocksDestroyer.new(current_user, params, flash)\n    redirect_to my_portfolio_path\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1557926033, "post_id": 56147300, "comment_id": 98929822, "body": "This is called an outer join. It&#39;s a standard part of SQL syntax, and activerecord provides a method to construct such queries."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557929948, "post_id": 56147300, "comment_id": 98932484, "body": "I am not certain you will be able to eager load something that is not associated in anyway.  You can certainly query this data by using a more complex join condition but there is no railsy way that I know of to join this back to the original user for eager loading."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557957229, "post_id": 56152841, "comment_id": 98945139, "body": "<code>arel</code> can do this for you. <code>joins(WorkingBankholiday.arel_table.join(Bankholiday.arel_ta&zwnj;&#8203;ble,Arel::Nodes::Out&zwnj;&#8203;erJoin).on(WorkingBa&zwnj;&#8203;nkholiday.arel_table&zwnj;&#8203;[:bankholiday_id].eq&zwnj;&#8203;(Bankholiday.arel_ta&zwnj;&#8203;ble[:id]).and(Workin&zwnj;&#8203;gBankholiday.arel_ta&zwnj;&#8203;ble[:person_id].eq(1&zwnj;&#8203;11))).join_sources)</code>"}], "tags": [], "owner": {"reputation": 8973, "user_id": 831564, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b7b5cb565edb37aac67f053f64f0324f?s=128&d=identicon&r=PG", "display_name": "Marlin Pierce", "link": "https://stackoverflow.com/users/831564/marlin-pierce"}, "is_accepted": false, "score": 0, "last_activity_date": 1558008149, "last_edit_date": 1558008149, "creation_date": 1557933812, "answer_id": 56152841, "question_id": 56147300, "link": "https://stackoverflow.com/questions/56147300/can-i-create-an-active-record-relationship-based-on-no-matches/56152841#56152841", "title": "Can I create an Active Record relationship based on no matches", "body": "<p>What you need is an out join, and select the results where the outer join created NULLs.</p>\n\n<p>The SQL you will want is:</p>\n\n<pre><code>SELECT bankholidays.*\nFROM bankholidays\n  LEFT OUTER JOIN working_bankholidays on bankholidays.id = working_bankholidays.bankholiday_id\n  AND working_bankholidays.person_id = 111\nWHERE working_bankholidays.id is NULL\n</code></pre>\n\n<p>The problem here is that you need the condition for the <code>person_id</code> in the <strong><code>FROM</code></strong> clause.  If it is in the <code>WHERE</code> clause you will get different results.</p>\n\n<p>When it is in the FROM clause, it will use the condition to treat the <code>working_bankholidays</code> table as if it only had the rows with the matching <code>person_id</code>.  It does this before doing the outer join, so if there are no records with the matching <code>person_id</code> it will add records from the outer join, with NULL values in all the fields for the <code>working_bankholidays</code> table.</p>\n\n<p>Unfortunately, I do not know any way to do this with active record associations.  All active record associations put conditions into the <code>WHERE</code> clause, and not the <code>FROM</code> clause.</p>\n\n<p>If you change the <code>has_many_and_belongs_to_many</code> to has many through, and you do this:</p>\n\n<pre><code>class Person\n  def free_bankholidays\n    Bankholiday.left_joins(:working_bankholidays).where(working_bankholidays: {id: nil, person_id: self.id})\n  end\n</code></pre>\n\n<p>it will give you this:</p>\n\n<pre><code>SELECT bankholidays.*\nFROM bankholidays\n  JOIN working_bankholidays on bankholidays.id = working_bankholidays.bankholiday_id\nWHERE working_bankholidays.id is NULL\n  AND working_bankholidays.person_id = 111\n</code></pre>\n\n<p>which will give you different and incorrect results.</p>\n\n<p>EDIT:</p>\n\n<p>See comment by engineersmnky.  I have not tried that yet, so I am not ready to include it in my answer.</p>\n"}], "owner": {"reputation": 57, "user_id": 7605962, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212488667040495/picture?type=large", "display_name": "RobEW", "link": "https://stackoverflow.com/users/7605962/robew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558008149, "creation_date": 1557916598, "question_id": 56147300, "link": "https://stackoverflow.com/questions/56147300/can-i-create-an-active-record-relationship-based-on-no-matches", "title": "Can I create an Active Record relationship based on no matches", "body": "<p>I\u2019m trying to speed up an index page on a rails application which has a lot of n+1 queries.</p>\n\n<p>At the moment I have a method which basically reverses a relationship (finds the records not related to the current one)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Class Person &lt; ActiveRecord::Base\n    has_many_and_belongs_to_many :bankholidays, join_table: \u201cworking_bankholidays\u201d\n\n    def free_bankholidays\n        Bankholiday.where(\u201cid NOT IN (?)\u201d bankholiday_ids)\n    end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Class Bankholiday &lt; ActiveRecord::Base\n    has_many_and_belongs_to_many :persons, join_table: \u201cworking_bankholidays\u201d\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Class WorkingBankholiday &lt; ActiveRecord::Base\n    belongs_to :person\n    belongs_to :bankholiday\nend\n</code></pre>\n\n<p>The free_bankholidays method inside Person returns any Bankholidays which aren't related to the current Person. This works fine but slows things down if I'm loading an index page with multiple persons. Is there a way I can move this out to a relationship so it can be eager loaded?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading"], "comments": [{"owner": {"reputation": 690, "user_id": 2300120, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00646c6fcff5ae605c658e3d679d6a53?s=128&d=identicon&r=PG", "display_name": "aoh", "link": "https://stackoverflow.com/users/2300120/aoh"}, "edited": false, "score": 0, "creation_date": 1572918529, "post_id": 56146171, "comment_id": 103702377, "body": "Does this work for you if you have the transaction and not the advisory lock? It seems to be working for me that way even though that makes even less sense."}, {"owner": {"reputation": 217, "user_id": 769138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2034e11da60269e5f4e339574ed70983?s=128&d=identicon&r=PG", "display_name": "muxcmux", "link": "https://stackoverflow.com/users/769138/muxcmux"}, "reply_to_user": {"reputation": 690, "user_id": 2300120, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00646c6fcff5ae605c658e3d679d6a53?s=128&d=identicon&r=PG", "display_name": "aoh", "link": "https://stackoverflow.com/users/2300120/aoh"}, "edited": false, "score": 0, "creation_date": 1573034357, "post_id": 56146171, "comment_id": 103746124, "body": "I need to ensure the record doesn\u2019t get created twice, so I don\u2019t see how only wrapping in transaction without a lock will help me do that"}, {"owner": {"reputation": 690, "user_id": 2300120, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00646c6fcff5ae605c658e3d679d6a53?s=128&d=identicon&r=PG", "display_name": "aoh", "link": "https://stackoverflow.com/users/2300120/aoh"}, "edited": false, "score": 0, "creation_date": 1573057709, "post_id": 56146171, "comment_id": 103759293, "body": "I agree with you and I need to accomplish the same thing which is why I&#39;m writing a similar test and validating that the lock is in place. I would expect the test to fail without the advisory lock but it is passing w/ just a transaction and no lock.  Should check out the &quot;Transactions and Advisory Locks&quot; section of the gem&#39;s README. I also reposted this issue on the gem&#39;s github page. <a href=\"https://github.com/ClosureTree/with_advisory_lock/issues/42\" rel=\"nofollow noreferrer\">github.com/ClosureTree/with_advisory_lock/issues/42</a>"}, {"owner": {"reputation": 690, "user_id": 2300120, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00646c6fcff5ae605c658e3d679d6a53?s=128&d=identicon&r=PG", "display_name": "aoh", "link": "https://stackoverflow.com/users/2300120/aoh"}, "edited": false, "score": 0, "creation_date": 1573057782, "post_id": 56146171, "comment_id": 103759323, "body": "Also if you are planning on upgrading to Rails 6, they&#39;ve added a <code>create_or_find_by</code> to avoid race conditions <a href=\"https://sikac.hu/use-create-or-find-by-to-avoid-race-condition-in-rails-6-0-f44fca97d16b\" rel=\"nofollow noreferrer\">sikac.hu/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 769138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2034e11da60269e5f4e339574ed70983?s=128&d=identicon&r=PG", "display_name": "muxcmux", "link": "https://stackoverflow.com/users/769138/muxcmux"}, "edited": false, "score": 0, "creation_date": 1581343673, "post_id": 60121638, "comment_id": 106390061, "body": "No, I&#39;m not turning off transactional tests and I&#39;m using the <code>truncation</code> strategy for <code>DatabaseCleaner</code>. I think this actually answers my question. Hopefully other people will find it helpful too. Thanks!"}], "tags": [], "owner": {"reputation": 596, "user_id": 1032752, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/882c3ddbfd286ff010276cb96dab3db5?s=128&d=identicon&r=PG", "display_name": "user1032752", "link": "https://stackoverflow.com/users/1032752/user1032752"}, "is_accepted": true, "score": 3, "last_activity_date": 1581112678, "creation_date": 1581112678, "answer_id": 60121638, "question_id": 56146171, "link": "https://stackoverflow.com/questions/56146171/ruby-with-advisory-lock-test-with-multiple-threads-fails-intermittently/60121638#60121638", "title": "Ruby with_advisory_lock test with multiple threads fails intermittently", "body": "<p>Are you turning off transactional tests for this test case? I'm working on something similar and that proved to be important to actually simulating the concurrency.</p>\n\n<p>See <code>uses_transaction</code> <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/TestFixtures/ClassMethods.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/TestFixtures/ClassMethods.html</a></p>\n\n<p>If transactions are not turned off, Rails will wrap the entire test in a transaction and this will cause all the threads to share one DB connection. Furthermore, in Postgres a session-level advisory lock can always be re-acquired within the same session. From the docs:</p>\n\n<blockquote>\n  <p>If a session already holds a given advisory lock, additional requests\n  by it will always succeed, even if other sessions are awaiting the\n  lock; this statement is true regardless of whether the existing lock\n  hold and new request are at session level or transaction level.</p>\n</blockquote>\n\n<p>Based on that I'm suspecting that your lock is always able to be acquired and therefore the <code>.first_or_create</code> call is always executed which results in the intermittent <code>RecordNotUnique</code> exceptions.</p>\n"}], "owner": {"reputation": 217, "user_id": 769138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2034e11da60269e5f4e339574ed70983?s=128&d=identicon&r=PG", "display_name": "muxcmux", "link": "https://stackoverflow.com/users/769138/muxcmux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 1, "accepted_answer_id": 60121638, "answer_count": 1, "score": 2, "last_activity_date": 1581112678, "creation_date": 1557913156, "last_edit_date": 1559306894, "question_id": 56146171, "link": "https://stackoverflow.com/questions/56146171/ruby-with-advisory-lock-test-with-multiple-threads-fails-intermittently", "title": "Ruby with_advisory_lock test with multiple threads fails intermittently", "body": "<p>I'm using the <code>with_advisory_lock</code> gem to try and ensure that a record is created only once. Here's the <a href=\"https://github.com/ClosureTree/with_advisory_lock\" rel=\"nofollow noreferrer\">github url</a> to the gem.</p>\n\n<p>I have the following code, which sits in an operation class that I wrote to handle creating user subscriptions:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create_subscription_for user\n  subscription = UserSubscription.with_advisory_lock(\"lock_%d\" % user.id) do\n    UserSubscription.where({ user_id: user.id }).first_or_create\n  end\n\n  # do more stuff on that subscription\nend\n</code></pre>\n\n<p>and the accompanying test:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>threads = []\nuser = FactoryBot.create(:user)\n\nrand(5..10).times do\n  threads &lt;&lt; Thread.new do\n    subject.create_subscription_for(user)\n  end\nend\n\nthreads.each(&amp;:join)\n\nexpect(UserSubscription.count).to eq(1)\n</code></pre>\n\n<p>What I expect to happen:</p>\n\n<ul>\n<li>The first thread to get to the block acquires the lock and creates a record.</li>\n<li>Any other thread that gets to the block while it's being held by another thread <a href=\"https://github.com/ClosureTree/with_advisory_lock\" rel=\"nofollow noreferrer\">waits indefinitely until the lock is released</a> (as per docs)</li>\n<li>As soon as the lock is released by the first thread that created the record, another thread acquires the lock and now finds the record because it was already created by the first thread.</li>\n</ul>\n\n<p>What actually happens:</p>\n\n<ul>\n<li>The first thread to get to the block acquires the lock and creates a record.</li>\n<li>Any other thread that gets to the block while it's being held by another thread goes and executes the code in the block anyway and as a result, when running the test, it sometimes fails with a <code>ActiveRecord::RecordNotUnique</code> error (I have a unique index on the table that allows for a single <code>user_subscription</code> with the same <code>user_id</code>)</li>\n</ul>\n\n<p>What is more weird is that if I add a <code>sleep</code> for a few hundred milliseconds in my method just before the <code>find_or_create</code> method, the test never fails:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create_subscription_for user\n  subscription = UserSubscription.with_advisory_lock(\"lock_%d\" % user.id) do\n    sleep 0.2\n    UserSubscription.where({ user_id: user.id }).first_or_create\n  end\n\n  # do more stuff on that subscription\nend\n</code></pre>\n\n<p>My questions are: \"Why is adding the <code>sleep 0.2</code> making the tests always pass?\" and \"Where do I look to debug this?\"</p>\n\n<p>Thanks!</p>\n\n<p><strong>UPDATE:</strong> Tweaking the tests a little bit causes them to always fail:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>threads = []\nuser = FactoryBot.create(:user)\n\nrand(5..10).times do\n  threads &lt;&lt; Thread.new do\n    sleep\n    subject.create_subscription_for(user)\n  end\nend\n\nuntil threads.all? { |t| t.status == 'sleep' }\n  sleep 0.1\nend\n\nthreads.each(&amp;:wakeup)\nthreads.each(&amp;:join)\n\nexpect(UserSubscription.count).to eq(1)\n</code></pre>\n\n<p>I have also wrapped <code>first_or_create</code> in a transaction, which makes the test pass and everything to work as expected:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create_subscription_for user\n  subscription = UserSubscription.with_advisory_lock(\"lock_%d\" % user.id) do\n    UserSubscription.transaction do\n      UserSubscription.where({ user_id: user.id }).first_or_create\n    end\n  end\n\n  # do more stuff on that subscription\nend\n</code></pre>\n\n<p>So why is wrapping <code>first_or_create</code> in a transaction necessary to make things work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 0, "creation_date": 1557909560, "post_id": 56144089, "comment_id": 98919832, "body": "can you show the value of params[:search_customer_supplier][&#39;accounts_dealer_types.dea&zwnj;&#8203;ler_code&#39;]"}, {"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "reply_to_user": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 0, "creation_date": 1557912146, "post_id": 56144089, "comment_id": 98921338, "body": "When i checked in first checkbox. this is the value i got     ====== SUP"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1557912948, "post_id": 56145126, "comment_id": 98921801, "body": "ur opinion is correct my parameter value is a string type.How can i fixed this problem.I haven&#39;t much knowledge on programming.I&#39; new to programming"}, {"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "reply_to_user": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1557915174, "post_id": 56145126, "comment_id": 98923183, "body": "Understand your requirements then try to solve it. If you want to convert a string to array you can do so by methods provided by ruby &quot;a,b,c&quot;.split(&#39;,&#39;) = [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;]"}, {"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1557916898, "post_id": 56145126, "comment_id": 98924242, "body": "I tried that method also.But it gave me some errors.I attached those below with my answer.. @Vishal"}], "tags": [], "owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "is_accepted": true, "score": 0, "last_activity_date": 1557910057, "creation_date": 1557910057, "answer_id": 56145126, "question_id": 56144089, "link": "https://stackoverflow.com/questions/56144089/pagination-errors-in-ruby-on-rails-report/56145126#56145126", "title": "Pagination errors in ruby on rails report", "body": "<p>You are getting this error because <code>join()</code> is the method of <code>Array class</code>. But your parameter value is of string type.</p>\n\n<p>ie.</p>\n\n<pre><code>[1,2,3].join(' OR ') #=&gt; \"1 OR 2 OR 3\"\n</code></pre>\n\n<p>but</p>\n\n<pre><code>\"aasd\".join('OR') #=&gt; will throw exception which you are getting.\n</code></pre>\n\n<p>check whether your parameter value is a proper array or not</p>\n"}, {"comments": [{"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 0, "creation_date": 1557920119, "post_id": 56147380, "comment_id": 98926053, "body": "I think you are getting wrong data in your parameter. That&#39;s why your query breaks"}], "tags": [], "owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "is_accepted": false, "score": 0, "last_activity_date": 1557916809, "creation_date": 1557916809, "answer_id": 56147380, "question_id": 56144089, "link": "https://stackoverflow.com/questions/56144089/pagination-errors-in-ruby-on-rails-report/56147380#56147380", "title": "Pagination errors in ruby on rails report", "body": "<p>Then it came this error output</p>\n\n<p><a href=\"https://i.stack.imgur.com/AGB23.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/AGB23.png</a></p>\n\n<p>this project use elasticsearch to pagination also.i will attach my code below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TMSrw.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/TMSrw.png</a></p>\n"}], "owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 56145126, "answer_count": 2, "score": 0, "last_activity_date": 1557916809, "creation_date": 1557906465, "question_id": 56144089, "link": "https://stackoverflow.com/questions/56144089/pagination-errors-in-ruby-on-rails-report", "title": "Pagination errors in ruby on rails report", "body": "<p>I've recently started learning ruby-on-rails and now I've got to the point where I can create something but still not very comfortable with syntax.\nIn report view,when i paginate to the 2nd page it gives me a error.</p>\n\n<p>But paginations were corrected in yesterday.Today i edited some checkboxes using params.dig method to hold the checkbox values.those values are also need to disply in 2nd page.What's the problem with my controller</p>\n\n<p>This is my view</p>\n\n<pre><code> %br\n          .row\n            .col-md-3\n              = check_box_tag \"search_customer_supplier[accounts_dealer_types.dealer_code][]\",\"CUS\", params.dig('search_customer_supplier', 'accounts_dealer_types.dealer_code') == \"CUS\"\n              = label_tag \"Organizational Customer\"\n            .col-md-3\n              = check_box_tag \"search_customer_supplier[accounts_dealer_types.dealer_code][]\", \"SUP\", params.dig('search_customer_supplier', 'accounts_dealer_types.dealer_code') == \"SUP\"\n              = label_tag \"Organzational Supplier\"\n            .col-md-3\n              = check_box_tag \"search_customer_supplier[accounts_dealer_types.dealer_code][]\", \"INDCUS\", params.dig('search_customer_supplier', 'accounts_dealer_types.dealer_code') == \"INDCUS\"\n              = label_tag \"Individual Customer\"\n            .col-md-3\n              = check_box_tag \"search_customer_supplier[accounts_dealer_types.dealer_code][]\", \"INDSUP\", params.dig('search_customer_supplier', 'accounts_dealer_types.dealer_code') == \"INDSUP\"\n              = label_tag \"Individual Supplier\"\n</code></pre>\n\n<p>This is my controller</p>\n\n<pre><code> def customer_supplier_report\n    Organization\n    Address\n    ContactNumber\n    refined_query = \"\"\n    if params[:search].present? or params[:excel_report].present?\n\n      search_customer_supplier = params[:search_customer_supplier]\n\n      if params[:organization_children].present? and search_customer_supplier[\"id\"].present?\n        organization_id = search_customer_supplier[\"id\"]\n        organization = Organization.find(organization_id)\n        anchestor_ids = organization.anchestors.map{|o| o[:member].id }\n        search_customer_supplier[\"id\"] = \"(#{anchestor_ids.join(' OR ')})\" if anchestor_ids.any?\n      end\n\n      params[:search_customer_supplier]['accounts_dealer_types.dealer_code'] = params[:search_customer_supplier]['accounts_dealer_types.dealer_code'].join(\" OR \") if params[:search_customer_supplier]['accounts_dealer_types.dealer_code'].present?\n\n      # puts params[:search_customer_supplier]['accounts_dealer_types.dealer_code']\n\n      customer_report = params[:search_customer_supplier].map { |k, v| \"#{k}:#{v}\" if v.present? }.compact\n    else\n      customer_report = [\"accounts_dealer_types.dealer_code:(CUS OR SUP OR INDCUS OR INDSUP)\"]\n    end\n</code></pre>\n\n<p>In my browser showing me where are the error lines in controller.Those are,</p>\n\n<pre><code>params[:search_customer_supplier]['accounts_dealer_types.dealer_code'] = params[:search_customer_supplier]['accounts_dealer_types.dealer_code'].join(\" OR \") if params[:search_customer_supplier]['accounts_dealer_types.dealer_code'].present?\n</code></pre>\n\n<p>This is output errors that i got</p>\n\n<p>NoMethodError in ReportsController#customer_supplier_report</p>\n\n<p>undefined method `join' for \"CUS\":String Did you mean? JSON</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "hyperlink", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1557908246, "post_id": 56144044, "comment_id": 98919158, "body": "Did you try omit the line beginning with <code>c =</code>? Are you sure condition <code>if c.text.include? &quot;Excel&quot;</code> is true? Try <code>puts c.text</code> inside <code>if</code>"}, {"owner": {"reputation": 21, "user_id": 10792876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6646b0f273af1aebc2966e177665b7b?s=128&d=identicon&r=PG&f=1", "display_name": "space_jam23", "link": "https://stackoverflow.com/users/10792876/space-jam23"}, "reply_to_user": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1557958613, "post_id": 56144044, "comment_id": 98945495, "body": "Thanks for responding lojza! It does find it and puts the text of the td as &quot;Excel&quot;. I just don&#39;t know how to access the span or href that is also inside the td. I have tried a third .each loop and i just can&#39;t get the find_element to get href or anchor or anything. Just always says frame detached (this is all inside an iframe but I switched to it earlier successfully and don&#39;t change pages/frames again). Or it says element doesn&#39;t exist or object type nil. I can post a picture of the html with src redacted if that helps?"}, {"owner": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1558001075, "post_id": 56144044, "comment_id": 98958824, "body": "Can you add to your question peace of html code where all mentioned elements are included?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10792876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6646b0f273af1aebc2966e177665b7b?s=128&d=identicon&r=PG&f=1", "display_name": "space_jam23", "link": "https://stackoverflow.com/users/10792876/space-jam23"}, "edited": false, "score": 0, "creation_date": 1557959034, "post_id": 56151970, "comment_id": 98945602, "body": "Thank you for such a comprehensive and helpful response! I&#39;ve had a difficult time understanding the path of the // searches and what parents and ancestors are and how to use contains. I will try this out and let you know! Thanks :)"}, {"owner": {"reputation": 21, "user_id": 10792876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6646b0f273af1aebc2966e177665b7b?s=128&d=identicon&r=PG&f=1", "display_name": "space_jam23", "link": "https://stackoverflow.com/users/10792876/space-jam23"}, "edited": false, "score": 0, "creation_date": 1557959051, "post_id": 56151970, "comment_id": 98945604, "body": "Do you use watir?"}, {"owner": {"reputation": 21, "user_id": 10792876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6646b0f273af1aebc2966e177665b7b?s=128&d=identicon&r=PG&f=1", "display_name": "space_jam23", "link": "https://stackoverflow.com/users/10792876/space-jam23"}, "edited": false, "score": 0, "creation_date": 1557959615, "post_id": 56151970, "comment_id": 98945733, "body": "So I tried it and the response is one that I&#39;ve been getting before -- target frame detached, what does that mean? I switched to the iframe earlier and haven&#39;t navigated away since? Thoughts?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 21, "user_id": 10792876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6646b0f273af1aebc2966e177665b7b?s=128&d=identicon&r=PG&f=1", "display_name": "space_jam23", "link": "https://stackoverflow.com/users/10792876/space-jam23"}, "edited": false, "score": 0, "creation_date": 1558015427, "post_id": 56151970, "comment_id": 98967365, "body": "@space_jam23 honestly not certain what that means and I primarily do backend development so I am not all that familiar with selenium or watir. Since I am not sure what your target page looks like nor how you are navigating the page this is going to be difficult to assist with"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1557931133, "creation_date": 1557931133, "answer_id": 56151970, "question_id": 56144044, "link": "https://stackoverflow.com/questions/56144044/cant-click-on-href-download-link-inside-dynamically-changing-table-using-seleni/56151970#56151970", "title": "Can&#39;t click on href download link inside dynamically changing table using Selenium web-driver", "body": "<p>This XPath should get you all the way to the anchor tag (without all the extra work)</p>\n\n<p><code>\"//table//tr/td[contains(text(),'#{num}')]/../td/a[contains(text(),'Excel')]\"</code> </p>\n\n<p>What it does: </p>\n\n<ul>\n<li>Looks for any cell in a row the contains the text of your <code>num</code> variable (<code>//table//tr/td[contains(text(),'#{num}')]</code>)</li>\n<li>Then selects that row (<code>/..</code>) [parent accessor] </li>\n<li>finds the cell with an anchor tag where the text contains the word \"Excel\" (<code>/td/a[contains(text(),'Excel')]</code>)</li>\n</ul>\n\n<p>Now I don't use selenium but I am assuming that in theory the following should work:</p>\n\n<pre><code>table.find_element(:xpath, \n  \"//tr/td[contains(text(),'#{num}')]/../td/a[contains(text(),'Excel')]\").click\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10792876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6646b0f273af1aebc2966e177665b7b?s=128&d=identicon&r=PG&f=1", "display_name": "space_jam23", "link": "https://stackoverflow.com/users/10792876/space-jam23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557931133, "creation_date": 1557906277, "question_id": 56144044, "link": "https://stackoverflow.com/questions/56144044/cant-click-on-href-download-link-inside-dynamically-changing-table-using-seleni", "title": "Can&#39;t click on href download link inside dynamically changing table using Selenium web-driver", "body": "<p>I can access all of the rows I need to, and their cells. I can even access the text of the href hyperlink cell to print it. But when I try xpath or other element finding strategies to '.click', none are working. This table is in an iframe which I switch to and am able to get all the table's info (although sometimes it does complain saying no connection to page or something.)</p>\n\n<p>I have tried direct xpath, // searching whole html tree xpath and others. I even tried converting all my code to watir. Anyone know without showing all my code why this nested loop gives me the row and cell I need. But won't let me click that cell? What other methods can I use than '.text' to access values of that cell to click the anchor/href that maybe isn't xpath? Thanks!</p>\n\n<p>Same as above.</p>\n\n<pre><code># Iterate through all cells of the table\ntable.find_elements(:tag_name, \"tr\").each do |r|\n    if r.text.include? \"#{Num}\"   \n        puts \"*******************************************\"\n        puts \"cell found in table.\"\n        puts \"*******************************************\"\n        puts \"Row text:\"\n        puts r.text\n        r.find_elements(:tag_name, \"td\").each do |c|\n            puts \"c.text:\"\n            puts c.text\n            if c.text.include? \"Excel\"\n                c = c.find_element(:xpath, \"/html/body/div/table/tbody/tr[36]/td[7]/a\")\n                c.click\n            end\n        end        \n    end\nend\n</code></pre>\n\n<p>Just want to be able to access rows that have the text for the number entered and if that text exists anywhere in the row, go to the cell where the href is and click it.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "rails-activerecord"], "comments": [{"owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "edited": false, "score": 0, "creation_date": 1557900670, "post_id": 56142675, "comment_id": 98915429, "body": "So what&#39;s with the code? Is it not working?"}, {"owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 0, "creation_date": 1557901453, "post_id": 56142675, "comment_id": 98915728, "body": "are  u added relationships?"}], "answers": [{"tags": [], "owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "is_accepted": false, "score": 0, "last_activity_date": 1557900795, "creation_date": 1557900795, "answer_id": 56142743, "question_id": 56142675, "link": "https://stackoverflow.com/questions/56142675/how-can-i-filter-on-associated-objects/56142743#56142743", "title": "How can I filter on associated objects?", "body": "<p>You could try something like this.</p>\n\n<pre><code>practice.patients.includes(:appointments).where(appointments: { created_at: start_date..end_date }).group(\"patients.id\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 573, "user_id": 6761781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c46a125fbbb6589becc8816a3cf4f3?s=128&d=identicon&r=PG&f=1", "display_name": "M. Habib", "link": "https://stackoverflow.com/users/6761781/m-habib"}, "is_accepted": true, "score": 1, "last_activity_date": 1557902900, "creation_date": 1557902900, "answer_id": 56143226, "question_id": 56142675, "link": "https://stackoverflow.com/questions/56142675/how-can-i-filter-on-associated-objects/56143226#56143226", "title": "How can I filter on associated objects?", "body": "<p>You can load filtered associated objects only using <code>eager_load</code>.</p>\n\n<p>Take a look at this example</p>\n\n<pre><code>result = [YourModel].patients.eager_load(:appointments).where(\"appointments.created_at::date between :start_date and :end_date\" ,{start_date: Date.yesterday, end_date: Date.today })\n</code></pre>\n\n<p>It will load patients whose appointment is created between <em>yesterday</em> and <em>today</em> . Also it will load associated appointments in the specified date range.</p>\n\n<p>Try doing</p>\n\n<pre><code>result.first.appointments\n</code></pre>\n\n<p>I hope it helps!</p>\n"}], "owner": {"reputation": 11, "user_id": 9444929, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Muhammad Ali Hafeez", "link": "https://stackoverflow.com/users/9444929/muhammad-ali-hafeez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 56143226, "answer_count": 2, "score": 0, "last_activity_date": 1557905649, "creation_date": 1557900427, "last_edit_date": 1557905649, "question_id": 56142675, "link": "https://stackoverflow.com/questions/56142675/how-can-i-filter-on-associated-objects", "title": "How can I filter on associated objects?", "body": "<p>I want a filter on included/joined associated models.</p>\n\n<pre><code>practice.patients.joins('\n  LEFT JOIN appointments on patients.id = appointments.patient_id \n  LEFT JOIN patient_treatments on patients.id = patient_treatments.patient_id\n  LEFT JOIN invoices on patients.id = invoices.patient_id\n  LEFT JOIN prescription_values on patients.id = prescription_values.patient_id'\n  ).where('(appointments.created_at::date between :start_date and :end_date' ,{start_date: start_date, end_date: end_date })\n</code></pre>\n\n<p>I want patients with appointments in this date range.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1557902042, "post_id": 56142612, "comment_id": 98915990, "body": "my version is   ruby-2.3.8@rails_4_2_1  Sorry um new to ruby on rails"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1558432400, "post_id": 56143116, "comment_id": 99090170, "body": "But it doesn&#39;t hold only one checkbox value.when selecting two or together it doesn&#39;t hold the params"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1558432865, "post_id": 56143116, "comment_id": 99090452, "body": "I am not sure if I understand. How can <code>params[:all_address]</code> hold multiple values? How does <code>params[:all_address]</code> look like in the console?"}, {"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1558434091, "post_id": 56143116, "comment_id": 99091053, "body": "Oh um sorry,I asked regarding another problem that i already posted here..Can u go through this.  [<a href=\"https://stackoverflow.com/questions/56133786/how-to-hold-the-checkbox-params-in-rails-after-search\" title=\"how to hold the checkbox params in rails after search\">stackoverflow.com/questions/56133786/&hellip;</a> ]"}, {"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1558434146, "post_id": 56143116, "comment_id": 99091080, "body": "Can u provide me a solution for that?"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1557902455, "creation_date": 1557902455, "answer_id": 56143116, "question_id": 56142612, "link": "https://stackoverflow.com/questions/56142612/how-to-hold-the-checkbox-true-value-in-rails-after-search/56143116#56143116", "title": "How to hold the checkbox true value in rails after search", "body": "<p>Just use <code>@all_address</code> to set the <code>checked</code> attribute of <a href=\"https://apidock.com/rails/ActionView/Helpers/FormTagHelper/check_box_tag\" rel=\"nofollow noreferrer\"><code>check_box_tag</code></a></p>\n\n<pre><code> = check_box_tag \"all_address\", \"1\", @all_address\n</code></pre>\n\n<p>Note: Because the <code>checked</code> attribute is the third attribute in the list, you must provide a second attribute too. The <code>\"1\"</code> is just the default that would be used for the second argument anyway. </p>\n"}], "owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56143116, "answer_count": 1, "score": 0, "last_activity_date": 1557902455, "creation_date": 1557900117, "last_edit_date": 1557902087, "question_id": 56142612, "link": "https://stackoverflow.com/questions/56142612/how-to-hold-the-checkbox-true-value-in-rails-after-search", "title": "How to hold the checkbox true value in rails after search", "body": "<p>The search is working fine but the problem is that when i print the excel report according to the result.it is showing all the values in the database, filter is not working then Checkbox true values are gone. How to hold the 'All address' checkbox params after refreshing the page.</p>\n\n<p>This is my view</p>\n\n<pre><code>.col-md-3.small_scale_margin-top2\n  = check_box_tag \"all_address\"\n  = label_tag \"Show All Addresses\"\n</code></pre>\n\n<p>This is my controller</p>\n\n<pre><code>    if params[:search].present? or params[:excel_report].present?\n\n      search_customer_supplier = params[:search_customer_supplier]\n\n      if params[:organization_children].present? and search_customer_supplier[\"id\"].present?\n        organization_id = search_customer_supplier[\"id\"]\n        organization = Organization.find(organization_id)\n        anchestor_ids = organization.anchestors.map{|o| o[:member].id }\n        search_customer_supplier[\"id\"] = \"(#{anchestor_ids.join(' OR ')})\" if anchestor_ids.any?\n      end\n      #puts \"======================================================================\"\n      # puts params[:search_customer_supplier]['accounts_dealer_types.dealer_code']\n\n      params[:search_customer_supplier]['accounts_dealer_types.dealer_code'] = params[:search_customer_supplier]['accounts_dealer_types.dealer_code'].join(\" OR \") if params[:search_customer_supplier]['accounts_dealer_types.dealer_code'].present?\n\n      # puts params[:search_customer_supplier]['accounts_dealer_types.dealer_code']\n\n      customer_report = params[:search_customer_supplier].map { |k, v| \"#{k}:#{v}\" if v.present? }.compact\n    else\n      customer_report = [\"accounts_dealer_types.dealer_code:(CUS OR SUP OR INDCUS OR INDSUP)\"]\n    end\n\n    @all_address = params[:all_address].to_bool if params[:all_address].present?\n    refined_query += customer_report.join(\" AND \")\n    params[:query] = refined_query\n    # params[:per_page] = 500\n    @customer_reports = Organization.search(params)\n\n    puts \"=========================================================\"\n      puts @customer_reports\n    puts \"=========================================================\"\n\n    @account_managers = User.where(active: true)\n    respond_to do |format|\n      if params[:excel_report].present?\n        request.format = \"xls\"\n        format.xls { set_attachment_name \"customer_supplier_report.xls\" }\n      else\n        format.html\n      end\n    end\n\n  end\n</code></pre>\n\n<p>In my controller this is the relevant part for the checkbox</p>\n\n<pre><code>@all_address = params[:all_address].to_bool if params[:all_address].present?\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1557898882, "creation_date": 1557898882, "answer_id": 56142406, "question_id": 56141999, "link": "https://stackoverflow.com/questions/56141999/stack-level-too-deep-after-upgrading-rails/56142406#56142406", "title": "stack level too deep after upgrading rails", "body": "<p>The dynamic finder method <code>find_by_id</code> wass deprecated. Just change it to the current version:</p>\n\n<pre><code>@blocked_user = Blockuser.blocked_users.find_by(id: current_user.id)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10893549, "user_type": "registered", "profile_image": "https://graph.facebook.com/2026176397466626/picture?type=large", "display_name": "Fzn", "link": "https://stackoverflow.com/users/10893549/fzn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56142406, "answer_count": 1, "score": 0, "last_activity_date": 1557898882, "creation_date": 1557896139, "question_id": 56141999, "link": "https://stackoverflow.com/questions/56141999/stack-level-too-deep-after-upgrading-rails", "title": "stack level too deep after upgrading rails", "body": "<p>I've upgraded my rails application from 5.1.2 to 5.2.3 before upgrading the code works fine but after upgrade its gives me this \"stack level too deep\" error mostly it gives error on where i use block user Or any thing related to block user.\ncan any one help me ?</p>\n\n<p>Block user method -</p>\n\n<pre><code>def block_user\n    return false unless current_user.present?\n\n    @blocked_user = Blockuser.blocked_users.find_by_id(current_user.id)\n    if @blocked_user.present?\n      @blocked_users = @blocked_user.pluck(:blocked_by_user)\n    else\n      @blocked_users = [\"false\"]\n\n    end\n  end\n</code></pre>\n\n<p>This code have error -</p>\n\n<pre><code>def blocked_user_admin(blocked_user_id)\n    Blockuser.where(blocked_by_user: current_user.id , blocked_user: blocked_user_id)\n  end\n</code></pre>\n"}, {"tags": ["python", "ruby", "numpy"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1557897271, "post_id": 56141945, "comment_id": 98914226, "body": "I don&#39;t know Numpy, but maybe it would help if you knew the &quot;traditional&quot; names of those operations, since the Ruby names are derived from Smalltalk, where they were named for a little bit of wordplay (collect, inject, detect, select, reject): <code>select</code> is commonly called <code>filter</code>, <code>collect</code> is <code>map</code> (or <code>transform</code> in C++), <code>inject</code> is <code>reduce</code> or <code>fold</code> (some communities also call it <code>aggregate</code> or <code>accumulate</code>). Also, <code>collect</code> is a special kind of <i>catamorphism</i>. Maybe these terms will help you find what you are looking for."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1557898321, "post_id": 56141945, "comment_id": 98914549, "body": "Hmm \u2026 I just saw that <code>find</code> is called <code>extract</code> in Numpy, so it doesn&#39;t look like they use the traditional names either."}, {"owner": {"reputation": 173469, "user_id": 901925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbd70aaeb3a97d0087daf93c2be8804?s=128&d=identicon&r=PG", "display_name": "hpaulj", "link": "https://stackoverflow.com/users/901925/hpaulj"}, "edited": false, "score": 0, "creation_date": 1557899816, "post_id": 56141945, "comment_id": 98915096, "body": "Python lists and iterators (as in <code>itertools</code>) has functions along this line.  But this isn&#39;t how <code>numpy</code> works.   Iterating through a <code>numpy</code> array like this is slow.  But <code>np.bincount</code> might meet your needs."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1557905854, "post_id": 56141945, "comment_id": 98917892, "body": "The Ruby code is faster when you start with <code>min, max = data.minmax</code> and use those min and max values .<code>bin_edge = bins.times.collect{|i| min + (max - min) &#47; bins * i} &lt;&lt; max + 1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7185629, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-krfdLzWKlA8/AAAAAAAAAAI/AAAAAAAAC7w/TAh62NkPWCg/photo.jpg?sz=128", "display_name": "Compeador", "link": "https://stackoverflow.com/users/7185629/compeador"}, "edited": false, "score": 0, "creation_date": 1557973507, "post_id": 56143038, "comment_id": 98948095, "body": "thanks for the help and the interesting approaches! And I should start thinking about other non-interactive solutions as you said"}], "tags": [], "owner": {"reputation": 173469, "user_id": 901925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbd70aaeb3a97d0087daf93c2be8804?s=128&d=identicon&r=PG", "display_name": "hpaulj", "link": "https://stackoverflow.com/users/901925/hpaulj"}, "is_accepted": true, "score": 0, "last_activity_date": 1557950301, "last_edit_date": 1557950301, "creation_date": 1557902097, "answer_id": 56143038, "question_id": 56141945, "link": "https://stackoverflow.com/questions/56141945/numpy-equivalents-of-ruby-array-functions/56143038#56143038", "title": "Numpy equivalents of Ruby array functions", "body": "<p>Initially this looked like a <code>bincount</code> or <code>histogram</code>, but the output is the bins where each value fits, not the number of items per bin:</p>\n\n<pre><code>In [3]: eq_width_bin(data,3)                                                    \nOut[3]: [1, 2, 1, 0, 0, 0, 1, 1, 2, 2, 2, 1]\n</code></pre>\n\n<p>Your bins:</p>\n\n<pre><code>In [10]: np.linspace(np.min(data),np.max(data),4)                               \nOut[10]: array([ 10.,  50.,  90., 130.])\n</code></pre>\n\n<p>we can identify the bin for each value with a simple integer division:</p>\n\n<pre><code>In [12]: (data-10)//40                                                          \nOut[12]: array([1, 2, 1, 0, 0, 0, 1, 1, 2, 2, 3, 1])\n</code></pre>\n\n<p>and correct that 3 with:</p>\n\n<pre><code>In [16]: np.minimum((data-10)//40,2)                                            \nOut[16]: array([1, 2, 1, 0, 0, 0, 1, 1, 2, 2, 2, 1])\n</code></pre>\n\n<p>But that doesn't answer you question about <code>.select .collect .inject .sort_by</code>.  Off hand I'm not familiar with those (though I was a fan of <code>Squeak</code> years ago, and dabbled in <code>Ruby</code> a bit).  They sound more like iterators, such as those collected in <code>itertools</code>. </p>\n\n<p>With <code>numpy</code> we don't usually take an iterative approach.  Rather we try to look at the arrays as a whole, doing things like division and min/max for the whole thing.</p>\n\n<p>===</p>\n\n<p><code>searchsorted</code> also works for this problem:</p>\n\n<pre><code>In [19]: np.searchsorted(Out[10],data)                                              \nOut[19]: array([2, 3, 2, 1, 1, 0, 2, 2, 3, 3, 3, 2])\n\nIn [21]: np.maximum(0,np.searchsorted(Out[10],data)-1)                              \nOut[21]: array([1, 2, 1, 0, 0, 0, 1, 1, 2, 2, 2, 1])\n</code></pre>\n\n<p>A (possibly) cleaner expression of your Python loop:</p>\n\n<pre><code>def foo(i, edges):\n    for j,n in enumerate(edges):\n        if i&lt;n:\n            return j-1\n    return j-1\nIn [34]: edges = np.linspace(np.min(data),np.max(data),4).tolist()              \nIn [35]: [foo(i,edges) for i in data]                                           \nOut[35]: [1, 2, 1, 0, 0, 0, 1, 1, 2, 2, 2, 1]\n</code></pre>\n\n<p>I converted <code>edges</code> to a list, because it's faster to iterate that way.</p>\n\n<p>With <code>itertools</code>:</p>\n\n<pre><code>In [55]: [len(list(itertools.takewhile(lambda x: x&lt;i,edges)))-1 for i in data]  \nOut[55]: [1, 2, 1, 0, 0, -1, 1, 1, 2, 2, 2, 1]\n</code></pre>\n\n<p>===</p>\n\n<p>Another approach</p>\n\n<pre><code>In [45]: edges = np.linspace(np.min(data),np.max(data),4)                       \nIn [46]: data[:,None]&lt;-edges                                                    \nOut[46]: \narray([[False, False, False, False],\n       [False, False, False, False],\n       [False, False, False, False],\n       [False, False, False, False],\n       [False, False, False, False],\n       [False, False, False, False],\n       [False, False, False, False],\n       [False, False, False, False],\n       [False, False, False, False],\n       [False, False, False, False],\n       [False, False, False, False],\n       [False, False, False, False]])\nIn [47]: np.argmax(data[:,None]&lt;edges, axis=1)-1                                \nOut[47]: array([ 1,  2,  1,  0,  0,  0,  1,  1,  2,  2, -1,  1])\n</code></pre>\n\n<p>That <code>-1</code> needs cleaning (the row where there's no True).</p>\n\n<h2>edit</h2>\n\n<p>Lists have an <code>index</code> method; with that we can get an expression that's a lot like your last <code>Ruby</code> line.  Looks like list comprehension is a lot like the Ruby <code>collect</code>:</p>\n\n<pre><code>In [88]: [[i&lt;j for i in edges].index(False)-1 for j in data]                    \nOut[88]: [1, 2, 1, 0, 0, -1, 1, 1, 2, 2, 2, 1]\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7185629, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-krfdLzWKlA8/AAAAAAAAAAI/AAAAAAAAC7w/TAh62NkPWCg/photo.jpg?sz=128", "display_name": "Compeador", "link": "https://stackoverflow.com/users/7185629/compeador"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 56143038, "answer_count": 1, "score": 0, "last_activity_date": 1557950301, "creation_date": 1557895760, "last_edit_date": 1557902595, "question_id": 56141945, "link": "https://stackoverflow.com/questions/56141945/numpy-equivalents-of-ruby-array-functions", "title": "Numpy equivalents of Ruby array functions", "body": "<p>I'm working on an assignment to practice data preprocessing, equal width binning in this case, but I'm not familiar with these numpy functions, so my python code is kinda ugly:</p>\n\n<pre><code>def eq_width_bin(data, bins):\n  bin_edge = np.linspace(np.min(data), np.max(data), bins+1)\n  bin_edge[-1] += 1\n  re  = []\n  for i in data:\n    for j in bin_edge:\n      if i &lt; j:\n        re.append(int(np.argwhere(bin_edge==j))-1)\n        break\n  return re\n\ndata = np.array([80, 95, 70, 30, 20, 10, 75, 65, 98, 103, 130, 70])\nprint(\"After equal width binning:\\n{}\".format(eq_width_bin(data, 3)))\n</code></pre>\n\n<p>however in ruby I can do it with less than 10 lines (despite the fact this is kinda slow):</p>\n\n<pre><code>def eq_width_bin(data, bins)\n  bin_edge = bins.times.collect{|i| data.min + (data.max - data.min) / bins * i} &lt;&lt; data.max + 1\n  return data.collect{|i| bin_edge.index{|j| i &lt; j} - 1}\nend\ndata = [80, 95, 70, 30, 20, 10, 75, 65, 98, 103, 130, 70]\nputs \"After equal width binning:\\n#{eq_width_bin(data, 3)}\"\n</code></pre>\n\n<p>I often use <code>.select</code> <code>.collect</code> <code>.inject</code> <code>.sort_by</code> to dealing with array in ruby, so is there any numpy functions I can use to \"beautify\" my python code above? (Especially knowing that numpy's built-in functions are way much faster than doing it in pyhton)</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "appium", "appium-android", "appium-desktop"], "answers": [{"tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": true, "score": 2, "last_activity_date": 1557895740, "creation_date": 1557895740, "answer_id": 56141942, "question_id": 56141905, "link": "https://stackoverflow.com/questions/56141905/autograntpermissions-as-boolean-type-how/56141942#56141942", "title": "autoGrantPermissions as boolean type, how?", "body": "<p>Just change this:</p>\n\n<pre><code>caps[\"autoGrantPermissions\"] = \"True\"\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>caps[\"autoGrantPermissions\"] = true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11074774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DMdIIUIJb3Q/AAAAAAAAAAI/AAAAAAAAAH4/6LQH6Imw0Dg/photo.jpg?sz=128", "display_name": "Sujan Dey", "link": "https://stackoverflow.com/users/11074774/sujan-dey"}, "is_accepted": false, "score": 0, "last_activity_date": 1557904852, "last_edit_date": 1557904852, "creation_date": 1557904287, "answer_id": 56143539, "question_id": 56141905, "link": "https://stackoverflow.com/questions/56141905/autograntpermissions-as-boolean-type-how/56143539#56143539", "title": "autoGrantPermissions as boolean type, how?", "body": "<p>You are using True inside double quotations that's why it's being treated as a string, not as a boolean value. You should try changing <code>caps[\"autoGrantPermissions\"] = \"True\"</code> to <code>caps[\"autoGrantPermissions\"] = true</code>.</p>\n"}], "owner": {"reputation": 60, "user_id": 10802314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4snMgcSZjWo/AAAAAAAAAAI/AAAAAAAANxM/1lc6gCj10mc/photo.jpg?sz=128", "display_name": "holyonline", "link": "https://stackoverflow.com/users/10802314/holyonline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 56141942, "answer_count": 2, "score": 0, "last_activity_date": 1570634939, "creation_date": 1557895509, "last_edit_date": 1570634939, "question_id": 56141905, "link": "https://stackoverflow.com/questions/56141905/autograntpermissions-as-boolean-type-how", "title": "autoGrantPermissions as boolean type, how?", "body": "<p>I'm trying to let my test auto grant permissions with a caps, but always when I try that, I got a InvalidArgumentError. How can I solve this?</p>\n\n<p>What I'm trying:</p>\n\n<pre><code>require 'rubygems'\nrequire 'em/pure_ruby'\nrequire 'appium_lib'\nrequire 'eventmachine'\nrequire 'selenium-webdriver'\n\ncaps = {}\ncaps[\"app\"] = \"C:/apk/Pb_debug_4.1.19-DEBUG1-20190416T143413Z-001/Pb_debug_4.1.19-DEBUG1/Pb_debug_4.1.19-DEBUG.apk\"\ncaps[\"platformName\"] = \"Android\"\ncaps[\"platformVersion\"] = \"7.0\"\ncaps[\"deviceName\"] = \"EMULATOR29X0X6X0\"\ncaps[\"autoAcceptAlerts\"] = \"True\"\ncaps[\"newCommandTimeout\"] = \"3600\"\ncaps[\"deviceReadyTimeout\"] = \"3600\"\ncaps[\"automationName\"] = \"UiAutomator2\"\ncaps[\"autoGrantPermissions\"] = \"True\"\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>InvalidArgumentError: 'autoGrantPermissions' must be of type boolean: 'autoGrantPermissions' must be of type boolean (Selenium::WebDriver::Error::InvalidArgumentError)\nfrom     at validateCaps (C:\\appium\\resources\\app\\node_modules\\appium\\node_modules\\appium-base-driver\\lib\\basedriver\\capabilities.js:52:11)\nfrom     at validateCaps (C:\\appium\\resources\\app\\node_modules\\appium\\node_modules\\appium-base-driver\\lib\\basedriver\\capabilities.js:154:20)\nfrom     at parseCaps (C:\\appium\\resources\\app\\node_modules\\appium\\node_modules\\appium-base-driver\\lib\\basedriver\\capabilities.js:199:43)\nfrom     at AndroidUiautomator2Driver.commands.createSession (C:\\appium\\resources\\app\\node_modules\\appium\\node_modules\\appium-base-driver\\lib\\basedriver\\commands\\session.js:36:14)\nfrom     at AndroidUiautomator2Driver.createSession (C:\\appium\\resources\\app\\node_modules\\appium\\node_modules\\appium-uiautomator2-driver\\lib\\driver.js:150:43)\nfrom     at AppiumDriver.createSession (C:\\appium\\resources\\app\\node_modules\\appium\\lib\\appium.js:301:43)\nfrom     at process._tickCallback (internal/process/next_tick.js:68:7)\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.142.0/lib/selenium/webdriver/remote/response.rb:72:in `assert_ok'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.142.0/lib/selenium/webdriver/remote/response.rb:34:in `initialize'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.142.0/lib/selenium/webdriver/remote/http/common.rb:88:in `new'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.142.0/lib/selenium/webdriver/remote/http/common.rb:88:in `create_response'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.142.0/lib/selenium/webdriver/remote/http/default.rb:114:in `request'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/appium_lib_core-3.1.1/lib/appium_lib_core/common/base/http_default.rb:81:in `call'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.142.0/lib/selenium/webdriver/remote/bridge.rb:167:in `execute'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/appium_lib_core-3.1.1/lib/appium_lib_core/common/base/bridge.rb:107:in `create_session'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/appium_lib_core-3.1.1/lib/appium_lib_core/common/base/bridge.rb:47:in `handshake'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/appium_lib_core-3.1.1/lib/appium_lib_core/common/base/driver.rb:34:in `initialize'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/appium_lib_core-3.1.1/lib/appium_lib_core/driver.rb:348:in `new'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/appium_lib_core-3.1.1/lib/appium_lib_core/driver.rb:348:in `start_driver'\nfrom C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/appium_lib-10.3.1/lib/appium_lib/driver.rb:548:in `start_driver'\nfrom C:/qa/test.rb:29:in `&lt;main&gt;'\n[Finished in 4.2s with exit code 1]\n</code></pre>\n\n<p>I really don't know what to do to solve this. Thanks for your attention.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "paypal"], "comments": [{"owner": {"reputation": 374, "user_id": 7753831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hWNti.jpg?s=128&g=1", "display_name": "Navid Farjad", "link": "https://stackoverflow.com/users/7753831/navid-farjad"}, "edited": false, "score": 0, "creation_date": 1585136649, "post_id": 56141031, "comment_id": 107655538, "body": "how did you solve it?"}, {"owner": {"reputation": 515, "user_id": 8811309, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/4476b7cc4e5b6bce944fc80edc861729?s=128&d=identicon&r=PG&f=1", "display_name": "awsm sid", "link": "https://stackoverflow.com/users/8811309/awsm-sid"}, "edited": false, "score": 0, "creation_date": 1595356967, "post_id": 56141031, "comment_id": 111444984, "body": "What are you using for front end?"}], "owner": {"reputation": 5149, "user_id": 2708460, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/78fb5597f10a8f25d2a69cbf70fd6ecd?s=128&d=identicon&r=PG&f=1", "display_name": "almo", "link": "https://stackoverflow.com/users/2708460/almo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1557887693, "creation_date": 1557887693, "question_id": 56141031, "link": "https://stackoverflow.com/questions/56141031/paypal-payouts-with-ruby", "title": "PayPal Payouts with Ruby", "body": "<p>I am trying to make payouts using the PayPal API (<a href=\"https://developer.paypal.com/docs/payouts/integrate/api-integration/\" rel=\"nofollow noreferrer\">https://developer.paypal.com/docs/payouts/integrate/api-integration/</a>).</p>\n\n<p>I have my token.</p>\n\n<p>Now I am creating my body:</p>\n\n<pre><code>body = {\n         :sender_batch_header =&gt; {\n             :sender_batch_id =&gt; SecureRandom.hex(8),\n             :email_subject =&gt; 'You have a Payout!'\n         },\n         :items =&gt; [\n             {\n                 :recipient_type =&gt; 'EMAIL',\n                 :amount =&gt; {\n                     :value =&gt; '0.01',\n                     :currency =&gt; 'EUR'\n                 },\n                 :note =&gt; 'Thanks for your patronage!',\n                 :sender_item_id =&gt; '2014031400023',\n                 :receiver =&gt; 'xxx@gmail.com'\n             }\n         ]\n}\n</code></pre>\n\n<p>And make the request:</p>\n\n<pre><code>response = HTTParty.post(\"https://api.sandbox.paypal.com/v1/payments/payouts\", :headers =&gt; { \"Authorization\" =&gt; \"Bearer #{token}\"}, :body =&gt; body)\n</code></pre>\n\n<p>But all I get is a generic response</p>\n\n<blockquote>\n  <p>{\"date\":[\"Wed, 15 May 2019 02:28:21\n  GMT\"],\"server\":[\"Apache\"],\"paypal-debug-id\":[\"eacd2165b90d\",\"eacd2165b90d\"],\"connection\":[\"close\"],\"http_x_pp_az_locator\":[\"sandbox.slc\"],\"set-cookie\":[\"X-PP-SILOVER=name%3DSANDBOX3.API.1%26silo_version%3D1880%26app%3Dapiplatformproxyserv%26TIME%3D1165613916%26HTTP_X_PP_AZ_LOCATOR%3Dsandbox.slc;\n  Expires=Wed, 15 May 2019 02:58:21 GMT; domain=.paypal.com; path=/;\n  Secure; HttpOnly\",\"X-PP-SILOVER=; Expires=Thu, 01 Jan 1970 00:00:01\n  GMT\"],\"vary\":[\"Authorization\"],\"content-type\":[\"text/plain;\n  charset=ISO-8859-1\"]}</p>\n</blockquote>\n\n<p>I think there is something wrong with my body. I tried sending <code>body.to_json</code> and I also tried to use <code>:data</code> instead of <code>:body</code> but no success.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "git", "heroku", "heroku-cli"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4882710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36c70a12f901d3e60dd653cf1d988af2?s=128&d=identicon&r=PG&f=1", "display_name": "linnal86", "link": "https://stackoverflow.com/users/4882710/linnal86"}, "is_accepted": false, "score": 0, "last_activity_date": 1557887149, "creation_date": 1557887149, "answer_id": 56140986, "question_id": 56140956, "link": "https://stackoverflow.com/questions/56140956/cant-push-app-to-heroku-even-though-app-updated-to-ruby-2-5-1/56140986#56140986", "title": "can&#39;t push app to heroku, even though app updated to ruby 2.5.1", "body": "<p>Got it to work. The problem was that I hadn't successfully added and committed my changes even though I've updated my app to 2.5.1</p>\n\n<p>Have to:\ngit add -A\ngit commit -m \"random message about updating app to 2.5.1\"\ngit push heroku master</p>\n"}], "owner": {"reputation": 1, "user_id": 4882710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36c70a12f901d3e60dd653cf1d988af2?s=128&d=identicon&r=PG&f=1", "display_name": "linnal86", "link": "https://stackoverflow.com/users/4882710/linnal86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557887149, "creation_date": 1557886852, "last_edit_date": 1592644375, "question_id": 56140956, "link": "https://stackoverflow.com/questions/56140956/cant-push-app-to-heroku-even-though-app-updated-to-ruby-2-5-1", "title": "can&#39;t push app to heroku, even though app updated to ruby 2.5.1", "body": "<p>I get the following error when I do git push heroku master for my ruby app.</p>\n<pre><code>remote: -----&gt; Compiling Ruby/Rails\nremote:        Command: 'set -o pipefail; curl -L --fail --retry 5 \n--retry-delay 1 --connect-timeout 3 --max-time 30 https://s3- \nexternal-1.amazonaws.com/heroku-buildpack-ruby/heroku-18/ruby- \n2.3.8.tgz -s -o - | tar zxf - ' failed on attempt 1 of 3.\nremote:        Command: 'set -o pipefail; curl -L --fail --retry 5 \n--retry-delay 1 --connect-timeout 3 --max-time 30 https://s3- \nexternal-1.amazonaws.com/heroku-buildpack-ruby/heroku-18/ruby- \n2.3.8.tgz -s -o - | tar zxf - ' failed on attempt 2 of 3.\nremote: \nremote:  !\nremote:  !     An error occurred while installing ruby-2.3.8\nremote:  !     \nremote:  !     This version of Ruby is not available on Heroku-18. \nThe minimum supported version\nremote:  !     of Ruby on the Heroku-18 stack can found at:\nremote:  !     \nremote:  !     https://devcenter.heroku.com/articles/ruby- \nsupport#supported-runtimes\nremote:  !\nremote:  !     Push rejected, failed to compile Ruby app.\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\n</code></pre>\n<p>I've updated my ruby version and have set ruby 2.5.1 to default</p>\n<pre><code>rvm list\n=* ruby-2.5.1 [ x86_64 ]\n\n'=&gt;' - current\n'=*' - current &amp;&amp; default\n'*' - default \n</code></pre>\n<p>I am on the most recent ruby version</p>\n<blockquote>\n<p>ruby -v</p>\n<p>ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-darwin17]</p>\n</blockquote>\n<p>My gemfile is also up-to-date</p>\n<pre><code>source 'https://rubygems.org'\n\nruby '2.5.1'\ngem 'rails',        '5.1.6'\ngem 'bcrypt',       '3.1.12'\ngem 'faker',        '1.7.3'\ngem 'will_paginate', '3.1.6'\ngem 'bootstrap-will_paginate', '1.0.0'\ngem 'bootstrap-sass', '3.3.7'\ngem 'puma',         '3.9.1'\ngem 'sass-rails',   '5.0.6'\ngem 'uglifier',     '3.2.0'\ngem 'coffee-rails', '4.2.2'\ngem 'jquery-rails', '4.3.1'\ngem 'turbolinks',   '5.0.1'\ngem 'jbuilder',     '2.7.0'\n\n...\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "config", "fog"], "answers": [{"tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": false, "score": 0, "last_activity_date": 1557890272, "creation_date": 1557890272, "answer_id": 56141296, "question_id": 56140509, "link": "https://stackoverflow.com/questions/56140509/configuring-fog-to-install-in-ruby-on-rails-project/56141296#56141296", "title": "Configuring Fog to install in Ruby on Rails project", "body": "<p>Try installing xml2 development package:</p>\n\n<pre><code>apt-get install libxml2-dev\n</code></pre>\n\n<p>This should work! (You might need to re-install Ruby after that.)</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10443784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bNU2f1KqaQ/AAAAAAAAAAI/AAAAAAAADIE/xhfE5GPsqSE/photo.jpg?sz=128", "display_name": "Melanie Packer", "link": "https://stackoverflow.com/users/10443784/melanie-packer"}, "edited": false, "score": 0, "creation_date": 1558047448, "post_id": 56142629, "comment_id": 98981470, "body": "Hi Usar, I&#39;ve already added: <code>gem &#39;fog-aws&#39;</code> to my gemfile. This is why I&#39;me so confused!"}], "tags": [], "owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "is_accepted": false, "score": 2, "last_activity_date": 1557900211, "creation_date": 1557900211, "answer_id": 56142629, "question_id": 56140509, "link": "https://stackoverflow.com/questions/56140509/configuring-fog-to-install-in-ruby-on-rails-project/56142629#56142629", "title": "Configuring Fog to install in Ruby on Rails project", "body": "<p>Instead of</p>\n\n<pre><code>gem 'fog'\n</code></pre>\n\n<p>Use</p>\n\n<pre><code>gem 'fog-aws'\n</code></pre>\n\n<p>In your gem file and it should work.</p>\n"}], "owner": {"reputation": 11, "user_id": 10443784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bNU2f1KqaQ/AAAAAAAAAAI/AAAAAAAADIE/xhfE5GPsqSE/photo.jpg?sz=128", "display_name": "Melanie Packer", "link": "https://stackoverflow.com/users/10443784/melanie-packer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1557900211, "creation_date": 1557882258, "question_id": 56140509, "link": "https://stackoverflow.com/questions/56140509/configuring-fog-to-install-in-ruby-on-rails-project", "title": "Configuring Fog to install in Ruby on Rails project", "body": "<p>I'm learning ruby on rails and have had my project hosted on c9.io. In the process of migrating over to Amazon AWS Cloud9 I'm having to reinstall my gems to my project. I am getting a config error while trying to build gem native extensions. </p>\n\n<p>I'm not actually sure how to configure this gem before I enter 'gem install fog' into the command line. I've tried searching on the Fog website but I can't find the info on their page. </p>\n\n<p>The error is:</p>\n\n<pre><code>Building native extensions. This could take a while...\nERROR:  Error installing fog:\n        ERROR: Failed to build gem native extension.\n\n    current directory: /home/ubuntu/.rvm/gems/ruby-2.3.4/gems/ovirt-engine-sdk-4.3.0/ext/ovirtsdk4c\n/home/ubuntu/.rvm/rubies/ruby-2.3.4/bin/ruby -r ./siteconf20190515-17400-2yzzer.rb extconf.rb\nchecking for xml2-config... no\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=/home/ubuntu/.rvm/rubies/ruby-2.3.4/bin/$(RUBY_BASE_NAME)\n        --with-libxml2-config\n        --without-libxml2-config\n        --with-pkg-config\n        --without-pkg-config\nextconf.rb:29:in `&lt;main&gt;': The \"libxml2\" package isn't available. (RuntimeError)\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /home/ubuntu/.rvm/gems/ruby-2.3.4/extensions/x86_64-linux/2.3.0/ovirt-engine-sdk-4.3.0/mkmf.log\n\nextconf failed, exit code 1\n</code></pre>\n\n<p>The mkmf.log says:</p>\n\n<pre><code>find_executable: checking for xml2-config... -------------------- no\n\n--------------------\n\n\"pkg-config --exists libxml2\"\npackage configuration for libxml2 is not found\n</code></pre>\n\n<p>I just don't know how to translate this log message into my codebase so I can install fog and continue working on my app. </p>\n"}, {"tags": ["ruby", "scim2", "parslet"], "answers": [{"tags": [], "owner": {"reputation": 19268, "user_id": 23963, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9a5280831aec1b4b614eb1e5bf40baf?s=128&d=identicon&r=PG", "display_name": "Nigel Thorne", "link": "https://stackoverflow.com/users/23963/nigel-thorne"}, "is_accepted": true, "score": 0, "last_activity_date": 1558065440, "last_edit_date": 1558065440, "creation_date": 1557964111, "answer_id": 56159029, "question_id": 56138652, "link": "https://stackoverflow.com/questions/56138652/systemstackerror-when-parsing-scim-2-0-filter-query-using-parslet/56159029#56159029", "title": "SystemStackError: when parsing SCIM 2.0 filter query using Parslet", "body": "<p>Always consume something before you recurse.</p>\n\n<p>For example: \nDon't define a list of numbers as </p>\n\n<pre><code>NumList = NumList &gt;&gt; \",\" &gt;&gt; NumList | Number\n</code></pre>\n\n<p>Defined it as </p>\n\n<pre><code>NumList = Number &gt;&gt; (\",\" &gt;&gt; NumList).maybe\n</code></pre>\n\n<p>or even </p>\n\n<pre><code>NumList = Number &gt;&gt; (\",\" &gt;&gt; Number).repeat(0)\n</code></pre>\n\n<p>So for logican_expression...</p>\n\n<pre><code> # logExp = FILTER SP (\"and\" / \"or\") SP FILTER\n  rule(:logical_expression) do\n    filter &gt;&gt; space &gt;&gt; (and_op | or_op) &gt;&gt; space &gt;&gt; filter\n  end\n</code></pre>\n\n<p>You need the first <code>filter</code> to be something that can't be a logical_expression.</p>\n\n<pre><code>   # FILTER = attrExp / logExp / valuePath / *1\"not\" \"(\" FILTER \")\"\n  rule(:filter) do\n    logical_expression | filter_atom \n  end\n\n  rule(:filter_atom) do\n    (not_op? &gt;&gt; lparen &gt;&gt; filter &gt;&gt; rparen) | attribute_expression  | value_path \n  end\n\n  # logExp = FILTER SP (\"and\" / \"or\") SP FILTER\n  rule(:logical_expression) do\n    filter_atom &gt;&gt; space &gt;&gt; (and_op | or_op) &gt;&gt; space &gt;&gt; filter\n  end\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 309251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8d289bc1a24067f9af4f92452f4fe0?s=128&d=identicon&r=PG", "display_name": "mokha", "link": "https://stackoverflow.com/users/309251/mokha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 56159029, "answer_count": 1, "score": 0, "last_activity_date": 1558065440, "creation_date": 1557868256, "question_id": 56138652, "link": "https://stackoverflow.com/questions/56138652/systemstackerror-when-parsing-scim-2-0-filter-query-using-parslet", "title": "SystemStackError: when parsing SCIM 2.0 filter query using Parslet", "body": "<p>I am writing a SCIM 2.0 filter parser using Parslet. When I try to parse the following query, I end up with a SystemStackError.</p>\n\n<p>'title pr or userType eq \"Intern\"'</p>\n\n<p>I have converted the ABNF notation from <a href=\"https://tools.ietf.org/html/rfc7644#page-21\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc7644#page-21</a> into a Parslet parser shown in the example code.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Filter &lt; Parslet::Parser\n  root :filter\n\n  # FILTER = attrExp / logExp / valuePath / *1\"not\" \"(\" FILTER \")\"\n  rule(:filter) do\n    attribute_expression | logical_expression | value_path | not_op &gt;&gt; lparen &gt;&gt; filter &gt;&gt; rparen\n  end\n\n  # valuePath = attrPath \"[\" valFilter \"]\" ; FILTER uses sub-attributes of a parent attrPath\n  rule(:value_path) do\n    attribute_path.as(:attribute) &gt;&gt; lbracket &gt;&gt; value_filter &gt;&gt; rbracket\n  end\n\n  # valFilter = attrExp / logExp / *1\"not\" \"(\" valFilter \")\"\n  rule(:value_filter) do\n    attribute_expression | logical_expression | not_op &gt;&gt; lparen &gt;&gt; value_filter &gt;&gt; rparen\n  end\n\n  # attrExp = (attrPath SP \"pr\") / (attrPath SP compareOp SP compValue)\n  rule(:attribute_expression) do\n    (attribute_path.as(:attribute) &gt;&gt; space &gt;&gt; presence) | attribute_path.as(:attribute) &gt;&gt; space &gt;&gt; comparison_operator.as(:comparison_operator) &gt;&gt; space &gt;&gt; comparison_value.as(:comparison_value)\n  end\n\n  # logExp = FILTER SP (\"and\" / \"or\") SP FILTER\n  rule(:logical_expression) do\n    filter &gt;&gt; space &gt;&gt; (and_op | or_op) &gt;&gt; space &gt;&gt; filter\n  end\n\n  # compValue = false / null / true / number / string ; rules from JSON (RFC 7159)\n  rule(:comparison_value) do\n    falsey | null | truthy | number | string\n  end\n\n  # compareOp = \"eq\" / \"ne\" / \"co\" / \"sw\" / \"ew\" / \"gt\" / \"lt\" / \"ge\" / \"le\"\n  rule(:comparison_operator) do\n    equal | not_equal | contains | starts_with | ends_with |\n      greater_than | less_than | less_than_equals | greater_than_equals\n  end\n\n  # attrPath = [URI \":\"] ATTRNAME *1subAttr ; SCIM attribute name ; URI is SCIM \"schema\" URI\n  rule(:attribute_path) do\n    (uri &gt;&gt; colon).repeat(0, 1) &gt;&gt; attribute_name &gt;&gt; sub_attribute.repeat(0, 1)\n  end\n\n  # ATTRNAME  = ALPHA *(nameChar)\n  rule(:attribute_name) do\n    alpha &gt;&gt; name_character.repeat(0, nil)\n  end\n\n  # nameChar = \"-\" / \"_\" / DIGIT / ALPHA\n  rule(:name_character) { hyphen | underscore | digit | alpha }\n\n  # subAttr = \".\" ATTRNAME ; a sub-attribute of a complex attribute\n  rule(:sub_attribute) { dot &gt;&gt; attribute_name }\n\n  # uri = 1*ALPHA 1*(\":\" 1*ALPHA)\n  rule(:uri) do\n    # alpha.repeat(1, nil) &gt;&gt; (colon &gt;&gt; (alpha.repeat(1, nil) | version)).repeat(1, nil)\n    str('urn:ietf:params:scim:schemas:') &gt;&gt; (\n      str('core:2.0:User') |\n      str('core:2.0:Group') | (\n        str('extension') &gt;&gt;\n        colon &gt;&gt;\n        alpha.repeat(1) &gt;&gt;\n        colon &gt;&gt;\n        version &gt;&gt;\n        colon &gt;&gt;\n        alpha.repeat(1)\n      )\n    )\n  end\n  rule(:presence) { str('pr').as(:presence) }\n  rule(:and_op) { str('and').as(:and) }\n  rule(:or_op) { str('or').as(:or) }\n  rule(:not_op) { str('not').repeat(0, 1).as(:not) }\n  rule(:falsey) { str('false').as(:false) }\n  rule(:truthy) { str('true').as(:true) }\n  rule(:null) { str('null').as(:null) }\n  rule(:number) do\n    str('-').maybe &gt;&gt; (\n      str('0') | (match('[1-9]') &gt;&gt; digit.repeat)\n    ) &gt;&gt; (\n      str('.') &gt;&gt; digit.repeat(1)\n    ).maybe &gt;&gt; (\n      match('[eE]') &gt;&gt; (str('+') | str('-')).maybe &gt;&gt; digit.repeat(1)\n    ).maybe\n  end\n  rule(:equal) { str('eq') }\n  rule(:not_equal) { str('ne') }\n  rule(:contains) { str('co') }\n  rule(:starts_with) { str('sw') }\n  rule(:ends_with) { str('ew') }\n  rule(:greater_than) { str('gt') }\n  rule(:less_than) { str('lt') }\n  rule(:greater_than_equals) { str('ge') }\n  rule(:less_than_equals) { str('le') }\n  rule(:string) do\n    quote &gt;&gt; (str('\\\\') &gt;&gt; any | str('\"').absent? &gt;&gt; any).repeat &gt;&gt; quote\n  end\n  rule(:lparen) { str('(') }\n  rule(:rparen) { str(')') }\n  rule(:lbracket) { str('[') }\n  rule(:rbracket) { str(']') }\n  rule(:digit) { match('\\d') }\n  rule(:quote) { str('\"') }\n  rule(:single_quote) { str(\"'\") }\n  rule(:space) { match('\\s') }\n  rule(:alpha) { match['a-zA-Z'] }\n  rule(:dot) { str('.') }\n  rule(:colon) { str(':') }\n  rule(:hyphen) { str('-') }\n  rule(:underscore) { str('_') }\n  rule(:version) { digit &gt;&gt; dot &gt;&gt; digit }\nend\n\n</code></pre>\n\n<p>I am expecting that Parslet should be able to handle the recursion safely instead of raising a SystemStackError. The base atom sets the <code>def cached?</code> to return true by default. If I monkey patch the Atom base class to return false from the <code>cached?</code> method, then I am able to parse this query. I am not sure what I am doing wrong.</p>\n"}, {"tags": ["ruby", "performance", "metaprogramming"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 1, "creation_date": 1557868179, "post_id": 56138556, "comment_id": 98908058, "body": "You could find out by dropping in a <code>puts #{part_one}&quot;</code> to see when it gets evaluated."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1557905955, "post_id": 56138556, "comment_id": 98917946, "body": "It depends a bit where this code is defined (e.g. in initialize-method?). Could you complete your example (like, wrap it in a class)?"}, {"owner": {"reputation": 12058, "user_id": 19530, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7df52257a48ba3ad861ea1d539739e3?s=128&d=identicon&r=PG&f=1", "display_name": "MaxVT", "link": "https://stackoverflow.com/users/19530/maxvt"}, "reply_to_user": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1557930502, "post_id": 56138556, "comment_id": 98932865, "body": "@Felix, added clarification to the example - thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1557874411, "creation_date": 1557874411, "answer_id": 56139648, "question_id": 56138556, "link": "https://stackoverflow.com/questions/56138556/does-define-method-run-on-every-instantiation-of-the-class/56139648#56139648", "title": "Does `define_method` run on every instantiation of the class?", "body": "<p>Normally this code is evaluated once and once only if <em>part of a class definition</em>, as in:</p>\n\n<pre><code>class Example\n  # Code here is executed immediately in the order the statements appear\n  %w[ foo bar baz ].each do |...|\n  end\n\n  def example\n    # Code here is only run if this method is executed, and only when\n    # the method is executed.\n  end\nend\n</code></pre>\n\n<p>You can find out by using \"printf debugging\":</p>\n\n<pre><code>class Example\n  puts \"Am I being run once or a whole bunch of times?\"\n\n  %w[ foo bar baz ].each do |...|\n  end\nend\n</code></pre>\n\n<p>Where that will now blerp out some diagnostic output you can use.</p>\n\n<p>The exception to this is within the Ruby on Rails auto-loader environment for development where things in <code>app/</code> will be loaded once per request, not per process.</p>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 0, "last_activity_date": 1557887746, "creation_date": 1557887746, "answer_id": 56141036, "question_id": 56138556, "link": "https://stackoverflow.com/questions/56138556/does-define-method-run-on-every-instantiation-of-the-class/56141036#56141036", "title": "Does `define_method` run on every instantiation of the class?", "body": "<p>Methods in Ruby are always defined on modules (or classes, which are a specific kind of module), never on instances. While one can apparently define a method on an instance, e.g.</p>\n\n<pre><code>class Foo; end\nfoo = Foo.new\ndef foo.quux\n  puts \"QUUX\"\nend\nfoo.quux # =&gt; QUUX\nbar = Foo.new\nbar.quux # =&gt; QUUX\n</code></pre>\n\n<p>what this does is in fact place the method on a so-called singleton class of <code>foo</code>, which is descended from Foo. There are no methods defined on instances in Ruby. When one calls a method, it is looked up the inheritance chain.</p>\n\n<p>Your <code>define_method</code> would populate <code>self.class</code> with methods at the time it is executed; any instances of <code>self.class</code> or its descendants will have access to them from then on.</p>\n"}], "owner": {"reputation": 12058, "user_id": 19530, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7df52257a48ba3ad861ea1d539739e3?s=128&d=identicon&r=PG&f=1", "display_name": "MaxVT", "link": "https://stackoverflow.com/users/19530/maxvt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557930488, "creation_date": 1557867722, "last_edit_date": 1557930488, "question_id": 56138556, "link": "https://stackoverflow.com/questions/56138556/does-define-method-run-on-every-instantiation-of-the-class", "title": "Does `define_method` run on every instantiation of the class?", "body": "<p>When my class creates a bunch of convenience methods dynamically, like this:</p>\n\n<pre><code>class MyClass &lt; ActiveRecord::Base\n  ...\n  %w(foo bar baz).freeze.each do |part_one|\n    %w(alpha beta gamma).freeze.each do |part_two|\n      define_method \"#{part_one}_#{part_two}\" do\n        lookup_stuff(part_one, part_two)\n      end\n    end\n  end\n  ...\nend\n</code></pre>\n\n<p>Does the iteration and method creation happen for every instance of the class, or only once when the class is first parsed and the model object for this class created?</p>\n\n<p>I've a hunch that it will only happen once but I can't find anything in the documentation that confirms that.</p>\n"}, {"tags": ["ruby", "combinations", "permutation"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1557866854, "post_id": 56138307, "comment_id": 98907610, "body": "simplifies to <code>fellows = 0.upto(m -1); fellows.zip(fellows.cycle.each_cons(n)).to_h</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557867594, "post_id": 56138307, "comment_id": 98907842, "body": "I don&#39;t think you&#39;re missing anything. I suggest you delete your first sentence. Note: <code>fellows = (0..m-1).to_a</code>."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557867606, "post_id": 56138307, "comment_id": 98907848, "body": "@engineersmnky, thanks. <code>cycle</code>, I forgot it. I posted the first working code I come up with. Also, I think it should <code>reviews = fellows.shuffle!.map....</code>, bang!, to work properly"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557867700, "post_id": 56138307, "comment_id": 98907884, "body": "@iGian all depends on what the desired result is <code>shuffle!</code> will cause the keys and the values to be shuffled, where as <code>shuffle</code> will cause just the keys to shuffle. I am still unclear what the desired output even is"}, {"owner": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "edited": false, "score": 0, "creation_date": 1557873436, "post_id": 56138307, "comment_id": 98909661, "body": "That&#39;s an excellent approach. At first I wasn&#39;t 100% sure if just rotating would be compliant for every case where <code>m &lt; n</code>, looking at it from a sorted perspective made it very simple to understand. Thank you."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 2, "last_activity_date": 1557867675, "last_edit_date": 1557867675, "creation_date": 1557866507, "answer_id": 56138307, "question_id": 56137953, "link": "https://stackoverflow.com/questions/56137953/equally-distribute-array-in-pairs-combination-permutation-question/56138307#56138307", "title": "Equally distribute array in pairs, combination/permutation question", "body": "<p>Given the m number build the array of \"fellows\":</p>\n\n<pre><code>m = 10\nfellows = m.times.map{ |i| i }\n#=&gt; [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n</code></pre>\n\n<p>Then, each fellow reviews the next three:</p>\n\n<pre><code>n = 3    \nreviews = fellows.map.with_index.with_object({}) { |(f, i), h| h[f] = fellows.rotate(i)[1..n] }\n#=&gt; {0=&gt;[1, 2, 3], 1=&gt;[2, 3, 4], 2=&gt;[3, 4, 5], 3=&gt;[4, 5, 6], 4=&gt;[5, 6, 7], 5=&gt;[6, 7, 8], 6=&gt;[7, 8, 9], 7=&gt;[8, 9, 0], 8=&gt;[9, 0, 1], 9=&gt;[0, 1, 2]}\n</code></pre>\n\n<p>Maybe it is required to randomize?</p>\n\n<pre><code>reviews = fellows.shuffle!.map....\n</code></pre>\n"}], "owner": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56138307, "answer_count": 1, "score": 1, "last_activity_date": 1557867675, "creation_date": 1557864741, "last_edit_date": 1557867344, "question_id": 56137953, "link": "https://stackoverflow.com/questions/56137953/equally-distribute-array-in-pairs-combination-permutation-question", "title": "Equally distribute array in pairs, combination/permutation question", "body": "<p>I'm trying to solve a combination/permutation problem, where I have 10 people, who should review other people's ideas. Each person should review exactly 3 ideas, so for instance:\nPerson 1: Reviews 2, 3, 4\nPerson 2: Reviews 5,8, 9\nPerson 3: Reviews 9, 10, 1\n...\netc.</p>\n\n<p>The restrictions are that:</p>\n\n<ol>\n<li>10 is a dynamic number, so the solution should also be dynamic, let's call this variable <code>m</code></li>\n<li>3 is also a dynamic number, so the solution should also work for other numbers, let's call this variable <code>n</code>.</li>\n<li>The selection of subarrays (who reviews who) should be random, if the same 10 people take 2 different tests, they shouldn't be evaluating the same people over and over again.</li>\n</ol>\n\n<p>So in short: Out of a group of <code>m</code> people, each person should review exactly <code>n</code> people, and at the same time receive <code>n</code> reviews.</p>\n\n<p>I've been able to find some very useful methods in ruby, such as <code>combination</code>, which basically let's me do something like this:</p>\n\n<pre><code>[1,2,3,4,5,6,7,8,9,10].combination(2).to_a\n=&gt; [[1, 2], [1, 3], [1, 4], [1, 5], [1, 6], [1, 7], [1, 8], [1, 9], [1, 10], [2, 3], [2, 4], [2, 5], [2, 6], [2, 7], [2, 8], [2, 9], [2, 10], [3, 4], [3, 5], [3, 6], [3, 7], [3, 8], [3, 9], [3, 10], [4, 5], [4, 6], [4, 7], [4, 8], [4, 9], [4, 10], [5, 6], [5, 7], [5, 8], [5, 9], [5, 10], [6, 7], [6, 8], [6, 9], [6, 10], [7, 8], [7, 9], [7, 10], [8, 9], [8, 10], [9, 10]]\n</code></pre>\n\n<p>And I can also group it in combinations of 3 <code>(n)</code>:</p>\n\n<pre><code>irb(main):008:0&gt; [1,2,3,4,5,6,7,8,9,10].combination(3).to_a\n=&gt; [[1, 2, 3], [1, 2, 4], [1, 2, 5], [1, 2, 6], [1, 2, 7], [1, 2, 8], [1, 2, 9], [1, 2, 10], [1, 3, 4], [1, 3, 5], [1, 3, 6], [1, 3, 7], [1, 3, 8], [1, 3, 9], [1, 3, 10], [1, 4, 5], [1, 4, 6], [1, 4, 7], [1, 4, 8], [1, 4, 9], [1, 4, 10], [1, 5, 6], [1, 5, 7], [1, 5, 8], [1, 5, 9], [1, 5, 10], [1, 6, 7], [1, 6, 8], [1, 6, 9], [1, 6, 10], [1, 7, 8], [1, 7, 9], [1, 7, 10], [1, 8, 9], [1, 8, 10], [1, 9, 10], [2, 3, 4], [2, 3, 5], [2, 3, 6], [2, 3, 7], [2, 3, 8], [2, 3, 9], [2, 3, 10], [2, 4, 5], [2, 4, 6], [2, 4, 7], [2, 4, 8], [2, 4, 9], [2, 4, 10], [2, 5, 6], [2, 5, 7], [2, 5, 8], [2, 5, 9], [2, 5, 10], [2, 6, 7], [2, 6, 8], [2, 6, 9], [2, 6, 10], [2, 7, 8], [2, 7, 9], [2, 7, 10], [2, 8, 9], [2, 8, 10], [2, 9, 10], [3, 4, 5], [3, 4, 6], [3, 4, 7], [3, 4, 8], [3, 4, 9], [3, 4, 10], [3, 5, 6], [3, 5, 7], [3, 5, 8], [3, 5, 9], [3, 5, 10], [3, 6, 7], [3, 6, 8], [3, 6, 9], [3, 6, 10], [3, 7, 8], [3, 7, 9], [3, 7, 10], [3, 8, 9], [3, 8, 10], [3, 9, 10], [4, 5, 6], [4, 5, 7], [4, 5, 8], [4, 5, 9], [4, 5, 10], [4, 6, 7], [4, 6, 8], [4, 6, 9], [4, 6, 10], [4, 7, 8], [4, 7, 9], [4, 7, 10], [4, 8, 9], [4, 8, 10], [4, 9, 10], [5, 6, 7], [5, 6, 8], [5, 6, 9], [5, 6, 10], [5, 7, 8], [5, 7, 9], [5, 7, 10], [5, 8, 9], [5, 8, 10], [5, 9, 10], [6, 7, 8], [6, 7, 9], [6, 7, 10], [6, 8, 9], [6, 8, 10], [6, 9, 10], [7, 8, 9], [7, 8, 10], [7, 9, 10], [8, 9, 10]]\n</code></pre>\n\n<p>However I'm not sure how to pick out of these subarrays the exact amount so that each person receives <code>n</code> reviews out of the <code>m</code> people. Maybe there's some sort of name related to this kind of problems which I'm not familiar with.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "service-object"], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1557865438, "post_id": 56137367, "comment_id": 98907083, "body": "Indeed! Thanks a million!"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1557862186, "creation_date": 1557862186, "answer_id": 56137367, "question_id": 56137245, "link": "https://stackoverflow.com/questions/56137245/how-to-display-flash-messages-in-rails-service-object/56137367#56137367", "title": "How to display flash messages in rails service object", "body": "<p>The <code>flash</code> method is only available in the controller. When you want to set the flash in the service object then you need to pass the flash to the service object.</p>\n\n<pre><code># in the controller\ndef create\n  @user_stock = UserStocksCreator.new(current_user, params, flash).call\n  redirect_to my_portfolio_path\nend\n\n# in the service\nclass UserStocksCreator\n  def initialize(current_user, params, flash)\n    @current_user = current_user\n    @params = params[:stock_ticker]\n    @flash = flash\n  end\n\n  def call\n    # unchanged...\n  end\n\n  private\n\n  attr_accessor :current_user, :params, :flash\nend\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 56137367, "answer_count": 1, "score": 3, "last_activity_date": 1557862186, "creation_date": 1557861718, "question_id": 56137245, "link": "https://stackoverflow.com/questions/56137245/how-to-display-flash-messages-in-rails-service-object", "title": "How to display flash messages in rails service object", "body": "<p>I want to add service objects in to my controller. Is there any chance to include flash messages in to this service object?</p>\n\n<p><strong>user_stocks_controller</strong></p>\n\n<pre><code>class UserStocksController &lt; ApplicationController\n  def create\n    @user_stock = UserStocksCreator.new(current_user, params).call\n    redirect_to my_portfolio_path\n  end\nend\n</code></pre>\n\n<p>service objects <strong>user_stocks_creator</strong></p>\n\n<pre><code>class UserStocksCreator\n  def initialize(current_user, params)\n    @current_user = current_user\n    @params = params[:stock_ticker]\n  end\n\n  def call\n    stock = Stock.find_by_ticker(params)\n    if stock.blank?\n      stock = Stock.new_from_lookup(params)\n      stock.save\n    end\n    @user_stock = UserStock.create(user: current_user, stock: stock)\n    flash[:success] = \"Stock #{@user_stock.stock.name} was successfully added to portfolio\"\n  end\n\n  private\n\n  attr_accessor :current_user, :params\nend\n</code></pre>\n\n<p>With this code I have an error:</p>\n\n<blockquote>\n  <p>undefined local variable or method `flash'</p>\n</blockquote>\n"}, {"tags": ["ruby", "nginx", "thin"], "answers": [{"comments": [{"owner": {"reputation": 62, "user_id": 10230313, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBkN5WijgG0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rldRz97etd0y_Xa3rlXjJkOoQaow/mo/photo.jpg?sz=128", "display_name": "mylan atlani", "link": "https://stackoverflow.com/users/10230313/mylan-atlani"}, "edited": false, "score": 0, "creation_date": 1557920891, "post_id": 56141398, "comment_id": 98926512, "body": "thanks but same result, but i don&#39;t have access to my API or my BackAdmin. and thin log say nothing ."}], "tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": false, "score": 0, "last_activity_date": 1557891181, "creation_date": 1557891181, "answer_id": 56141398, "question_id": 56136089, "link": "https://stackoverflow.com/questions/56136089/fix-404-nginx-and-thin/56141398#56141398", "title": "Fix 404 nginx and thin?", "body": "<p>The Nginx root should end with <code>public</code> for rails project:</p>\n\n<pre><code>root     /home/ubuntu/happer-api/public;\n</code></pre>\n\n<p>Also can you try removing the initial dot from the domain name?</p>\n\n<pre><code>`server_name .example.com;`\n</code></pre>\n\n<p>And remove the other two upstream servers ending with <code>3001</code> and <code>3002</code> port. Your thin is supposed to serve only one!</p>\n"}], "owner": {"reputation": 62, "user_id": 10230313, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBkN5WijgG0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rldRz97etd0y_Xa3rlXjJkOoQaow/mo/photo.jpg?sz=128", "display_name": "mylan atlani", "link": "https://stackoverflow.com/users/10230313/mylan-atlani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557931876, "creation_date": 1557856811, "last_edit_date": 1557931876, "question_id": 56136089, "link": "https://stackoverflow.com/questions/56136089/fix-404-nginx-and-thin", "title": "Fix 404 nginx and thin?", "body": "<p>I'm currently installing my application on a ubuntu server. and I'd like to know why, when I try to access my API, nginx returns me a 404.</p>\n\n<p>I have configured thin as well as nginx but I can't find out why this doesn't work, and being new to this field I admit I don't know where to start.</p>\n\n<p>i tried to change the thin config and the nginx config but nothing work yet.</p>\n\n<p>thin config</p>\n\n<pre><code>user: www-data\ngroup: www-data\npid: tmp/pids/thin.pid\ntimeout: 30\nwait: 30\nlog: log/thin.log\nmax_conns: 1024\nrequire: []\nenvironment: production\nmax_persistent_conns: 512\nservers: 1\nthreaded: true\nno-epoll: true\naddress: 0.0.0.0\nport: 3000\ndaemonize: true\nchdir: /home/ubuntu/happer-api\ntag: happer-api\n</code></pre>\n\n<p>Nginx config</p>\n\n<pre><code>upstream myapp {\n      server 127.0.0.1:3000;\n      server 127.0.0.1:3001;\n      server 127.0.0.1:3002;\n    }\n    server {\n      listen   80;\n      server_name .example.com;\n\n      access_log /home/ubuntu/happer-api/log/access.log;\n      error_log  /home/ubuntu/happer-api/log/error.log;\n      root     /home/ubuntu/happer-api;\n      index    index.html;\n\n      location / {\n        proxy_set_header  X-Real-IP  $remote_addr;\n        proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header  Host $http_host;\n        proxy_redirect  off;\n        try_files /system/maintenance.html $uri $uri/index.html $uri.html @ruby;\n      }\n\n      location @ruby {\n        proxy_pass http://myapp;\n      }\n    }\n</code></pre>\n\n<p>I'm on EC2 Instance and i open the port with the amazon tool</p>\n\n<p>I have also active admin on my API but i can't reach it.</p>\n"}, {"tags": ["ruby", "bundler"], "comments": [{"owner": {"reputation": 10691, "user_id": 249353, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahjLp.jpg?s=128&g=1", "display_name": "Josien", "link": "https://stackoverflow.com/users/249353/josien"}, "edited": false, "score": 0, "creation_date": 1557996264, "post_id": 56135936, "comment_id": 98955975, "body": "What happens if you remove the line from your <code>Gemfile</code>, run <code>bundle install</code> and then <code>bundle clean --force</code> (this will remove any unused/old versions of gems), then add the gem again to your Gemfile and run <code>bundle install</code> again?"}, {"owner": {"reputation": 1092, "user_id": 2456552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ce9d1d147fe6f4e4488f470bf634791?s=128&d=identicon&r=PG", "display_name": "jsmartt", "link": "https://stackoverflow.com/users/2456552/jsmartt"}, "reply_to_user": {"reputation": 10691, "user_id": 249353, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahjLp.jpg?s=128&g=1", "display_name": "Josien", "link": "https://stackoverflow.com/users/249353/josien"}, "edited": false, "score": 0, "creation_date": 1558114315, "post_id": 56135936, "comment_id": 99006985, "body": "Thanks for the reply. Sadly, it still uses an old SHA. I believe it pulled it down again, but bundler is still getting the SHA first associated with the tag."}, {"owner": {"reputation": 10691, "user_id": 249353, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahjLp.jpg?s=128&g=1", "display_name": "Josien", "link": "https://stackoverflow.com/users/249353/josien"}, "edited": false, "score": 0, "creation_date": 1558178721, "post_id": 56135936, "comment_id": 99020180, "body": "Too bad :-( On the bright side, it&#39;s good to know that Bundler safeguards against this kind of retagging, as it has all kinds of potential for malicious use."}], "owner": {"reputation": 1092, "user_id": 2456552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ce9d1d147fe6f4e4488f470bf634791?s=128&d=identicon&r=PG", "display_name": "jsmartt", "link": "https://stackoverflow.com/users/2456552/jsmartt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557861684, "creation_date": 1557856089, "question_id": 56135936, "link": "https://stackoverflow.com/questions/56135936/how-to-force-bundler-to-re-fetch-tag-ref-from-github", "title": "How to force bundler to re-fetch tag ref from GitHub", "body": "<p>I have a gem that I manage, and have recently updated the ref for a tag (the SHA for the tag is now different on GitHub)</p>\n\n<p>In my Gemfile, I have:</p>\n\n<pre><code>gem 'my_gem', tag: '0.25.0', git: 'http://github.com/Example/my_gem.git'\n</code></pre>\n\n<p>However, running <code>$ bundle install</code> only uses the old SHA for that tag. How can I force it to get the latest code?</p>\n\n<p>I tried removing the path to my gem, like so:\n    $ rm -rf /usr/local/rvm/gems/ruby-2.4.5/bundler/gems/my_gem-*</p>\n\n<p>... but bundler just downloads it again.</p>\n\n<p>The only way I've been able to make this happen is by modifying the revision in my <code>Gemfile.lock</code>, but that only works on that one repo. I have multiple repos using this gem. It seems like Bundler has a database/cache mapping gem tags to revisions, but I can't find where that is.</p>\n\n<p>PS: I know re-tagging things isn't best practice.</p>\n"}, {"tags": ["ruby", "html-parsing", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1557875546, "post_id": 56136313, "comment_id": 98910136, "body": "This doesn&#39;t check for a link though."}, {"owner": {"reputation": 213, "user_id": 4518165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bde070b1e84f8b0d5d2587b85560e4bf?s=128&d=identicon&r=PG&f=1", "display_name": "castwide", "link": "https://stackoverflow.com/users/4518165/castwide"}, "reply_to_user": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1557908667, "post_id": 56136313, "comment_id": 98919385, "body": "I added a second example that explicitly checks for links."}, {"owner": {"reputation": 302, "user_id": 4588188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/pytwu.jpg?s=128&g=1", "display_name": "AJwr", "link": "https://stackoverflow.com/users/4588188/ajwr"}, "edited": false, "score": 0, "creation_date": 1557927401, "post_id": 56136313, "comment_id": 98930759, "body": "the first example accomplished what I needed \u2013 my bad for the confusion in the question"}], "tags": [], "owner": {"reputation": 213, "user_id": 4518165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bde070b1e84f8b0d5d2587b85560e4bf?s=128&d=identicon&r=PG&f=1", "display_name": "castwide", "link": "https://stackoverflow.com/users/4518165/castwide"}, "is_accepted": true, "score": 1, "last_activity_date": 1557910000, "last_edit_date": 1557910000, "creation_date": 1557857762, "answer_id": 56136313, "question_id": 56135760, "link": "https://stackoverflow.com/questions/56135760/nokogiri-only-get-list-items-with-links-first/56136313#56136313", "title": "Nokogiri only get list items with links first", "body": "<p>You can check whether the item's first child is either not text or empty text:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>list.search('li').each do |item|\n  if !item.children.first.text? || item.children.first.text.strip.empty?\n    puts item # hit?\n  end\nend\n</code></pre>\n\n<p>If you want to exclude items that don't begin with a link, you can select the first child and check its parents in the condition:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>list.search('li &gt; a:first-child').each do |item|\n  if !item.parent.children.first.text? || item.parent.children.first.text.strip.empty?\n    puts item # hit?\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 302, "user_id": 4588188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/pytwu.jpg?s=128&g=1", "display_name": "AJwr", "link": "https://stackoverflow.com/users/4588188/ajwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 56136313, "answer_count": 1, "score": 0, "last_activity_date": 1557910000, "creation_date": 1557855312, "question_id": 56135760, "link": "https://stackoverflow.com/questions/56135760/nokogiri-only-get-list-items-with-links-first", "title": "Nokogiri only get list items with links first", "body": "<p>I have a document that looks like the following:</p>\n\n<pre><code>&lt;ul&gt;\n  &lt;li&gt;\n    &lt;a href=\"/Synergies\"&gt;Link&lt;/a&gt;Content\n  &lt;/li&gt;\n  &lt;/li&gt;\n    Content &lt;a href=\"/Synergies\"&gt;Link&lt;/a&gt;\n  &lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>I would like to only obtain the list items that start with an <code>&lt;a&gt;</code> tag, i.e. the first <code>&lt;li&gt;</code> would be a hit but the second would not.</p>\n\n<p>I tried getting all list items and regex matching on the html content but it doesn't appear to be working:</p>\n\n<pre><code>list.search('li').each do |item|\n  if /^&lt;a href=\"\\/Synergies\".*$/.match(item) \n    puts link # hit?\n  end\nend\n</code></pre>\n\n<p>Any advice would be appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "actionmailer"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 2, "creation_date": 1557851615, "post_id": 56134143, "comment_id": 98900797, "body": "It looks like it might be rendering an empty default layout. Did you set a <code>config.action_mailer.preview_path</code> in your <code>application.rb</code> (or find the default value) and create a <code>foo_mailer_preview.rb</code> file (named after whatever your mailer is named?"}, {"owner": {"reputation": 21, "user_id": 10624259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de77e4c06d905e938075f6cb99a7bf1f?s=128&d=identicon&r=PG&f=1", "display_name": "fcandi", "link": "https://stackoverflow.com/users/10624259/fcandi"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1557904971, "post_id": 56134143, "comment_id": 98917381, "body": "Thanks, @JayDorsey now it is working :D"}], "owner": {"reputation": 21, "user_id": 10624259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de77e4c06d905e938075f6cb99a7bf1f?s=128&d=identicon&r=PG&f=1", "display_name": "fcandi", "link": "https://stackoverflow.com/users/10624259/fcandi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1557876094, "creation_date": 1557848420, "last_edit_date": 1557876094, "question_id": 56134143, "link": "https://stackoverflow.com/questions/56134143/email-preview-not-working-in-ruby-on-rails-actionmailer-api-mode", "title": "Email Preview not working in Ruby on Rails ActionMailer API-Mode", "body": "<p>ActionMailer works just fine in my RoR App in API-Only-Mode. BUT the preview is not working. When I open my local path\n<a href=\"http://localhost:3001/rails/mailers/\" rel=\"nofollow noreferrer\">http://localhost:3001/rails/mailers/</a></p>\n\n<p>I get an empty page. See console log below. </p>\n\n<p>What can I do to make the preview work? Maybe there is some module missing in the API-Mode? </p>\n\n<p>Rails 5.2.3, Ruby 2.6.0, Puma.</p>\n\n<pre><code>Started GET \"/rails/mailers/\" for 127.0.0.1 at 2019-05-14 17:38:35 +0200\nProcessing by Rails::MailersController#index as HTML\n  Rendering /Users/fcandi/.rbenv/versions/2.6.0/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/templates/rails/mailers/index.html.erb within layouts/application\n  Rendered /Users/fcandi/.rbenv/versions/2.6.0/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/templates/rails/mailers/index.html.erb within layouts/application (0.4ms)\nCompleted 200 OK in 3ms (Views: 1.8ms | ActiveRecord: 0.0ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1557894783, "post_id": 56141331, "comment_id": 98913551, "body": "It gave me an error  ``` undefined method `[]&#39; for nil:NilClass ```"}, {"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1557895160, "post_id": 56141331, "comment_id": 98913648, "body": "Can i use params.dig method like below to hold the value of param  ``` = label_tag &quot;Account No:&quot;    = text_field_tag &quot;search_customer_supplier[account.account_no]&quot;, params.dig(&#39;search_customer_supplier&#39;, &#39;account.account_no&#39;), class: &quot;form-control&quot;, placeholder: &quot;Account No&quot; ```"}, {"owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "reply_to_user": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1557895804, "post_id": 56141331, "comment_id": 98913807, "body": "Yes, try with <code>#dig</code>. Should be okay."}, {"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1557899070, "post_id": 56141331, "comment_id": 98914809, "body": "**params.dig(&#39;search_customer_supplier&#39;, &#39;accounts_dealer_types.dealer_code&#39;) == &quot;CUS&quot; ** It was done.Thanks a lot"}, {"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "edited": false, "score": 0, "creation_date": 1558432440, "post_id": 56141331, "comment_id": 99090194, "body": "But it doesn&#39;t hold only one checkbox value.when selecting two or together it doesn&#39;t hold the params"}], "tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": true, "score": 0, "last_activity_date": 1557890610, "creation_date": 1557890610, "answer_id": 56141331, "question_id": 56133786, "link": "https://stackoverflow.com/questions/56133786/how-to-hold-the-checkbox-params-in-rails-after-search/56141331#56141331", "title": "How to hold the checkbox params in rails after search", "body": "<p>You can use check for the submitted value on the third param:</p>\n\n<pre><code>check_box_tag 'search_customer_supplier[accounts_dealer_types.dealer_code]', 'CUS', params[:search_customer_supplier]['accounts_dealer_types.dealer_code'] == 'CUS'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "is_accepted": false, "score": 0, "last_activity_date": 1557904822, "creation_date": 1557904822, "answer_id": 56143652, "question_id": 56133786, "link": "https://stackoverflow.com/questions/56133786/how-to-hold-the-checkbox-params-in-rails-after-search/56143652#56143652", "title": "How to hold the checkbox params in rails after search", "body": "<p>After that i aroused another problem when i paginate into 2nd page.</p>\n\n<p>This is the output when it paginate to the next pages.\n <a href=\"https://i.stack.imgur.com/5MDpq.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/5MDpq.png</a></p>\n\n<p>Below i mentioned the code(in controller),i think it'd be the query that called.when paginating.</p>\n\n<pre><code> params[:search_customer_supplier]['accounts_dealer_types.dealer_code'] = params[:search_customer_supplier]['accounts_dealer_types.dealer_code'].join(\" OR \") if params[:search_customer_supplier]['accounts_dealer_types.dealer_code'].present?\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 56141331, "answer_count": 2, "score": 0, "last_activity_date": 1557904822, "creation_date": 1557847147, "question_id": 56133786, "link": "https://stackoverflow.com/questions/56133786/how-to-hold-the-checkbox-params-in-rails-after-search", "title": "How to hold the checkbox params in rails after search", "body": "<p>The search is working fine but the problem is that when i print the excel report according to the result.it is showing all the values in the database, filter is not working.Realoding all over the page, then Checkbox true values are gone. How to hold the params after refreshing the page</p>\n\n<pre><code>   .row\n            .col-md-3\n              = check_box_tag \"search_customer_supplier[accounts_dealer_types.dealer_code][]\",\"CUS\", false\n              = label_tag \"Organizational Customer\"\n            .col-md-3\n              = check_box_tag \"search_customer_supplier[accounts_dealer_types.dealer_code][]\", \"SUP\", false, class: \"first_resolution\"\n              = label_tag \"Organzational Supplier\"\n            .col-md-3\n              = check_box_tag \"search_customer_supplier[accounts_dealer_types.dealer_code][]\", \"INDCUS\", false, class: \"first_resolution\"\n              = label_tag \"Individual Customer\"\n            .col-md-3\n              = check_box_tag \"search_customer_supplier[accounts_dealer_types.dealer_code][]\", \"INDSUP\", false, class: \"first_resolution\"\n              = label_tag \"Individual Supplier\"\n</code></pre>\n\n<p>This is my controller,</p>\n\n<pre><code>    if params[:search].present? or params[:excel_report].present?\n\n      search_customer_supplier = params[:search_customer_supplier]\n      if params[:organization_children].present? and search_customer_supplier[\"id\"].present?\n        organization_id = search_customer_supplier[\"id\"]\n        organization = Organization.find(organization_id)\n        anchestor_ids = organization.anchestors.map{|o| o[:member].id }\n        search_customer_supplier[\"id\"] = \"(#{anchestor_ids.join(' OR ')})\" if anchestor_ids.any?\n      end\n      params[:search_customer_supplier]['accounts_dealer_types.dealer_code'] = params[:search_customer_supplier]['accounts_dealer_types.dealer_code'].join(\" OR \") if params[:search_customer_supplier]['accounts_dealer_types.dealer_code'].present?\n\n      @all_address = params[:all_address].to_bool if params[:all_address].present?\n      customer_report = params[:search_customer_supplier].map { |k, v| \"#{k}:#{v}\" if v.present? }.compact\n    else\n      customer_report = [\"accounts_dealer_types.dealer_code:(CUS OR SUP OR INDCUS OR INDSUP)\"]\n    end\n</code></pre>\n"}, {"tags": ["php", "ruby", "laravel", "api", "typeform"], "comments": [{"owner": {"reputation": 7631, "user_id": 886824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3bae1c33c40156bada3c41bdddec4323?s=128&d=identicon&r=PG", "display_name": "CD001", "link": "https://stackoverflow.com/users/886824/cd001"}, "edited": false, "score": 0, "creation_date": 1557847000, "post_id": 56133602, "comment_id": 98898394, "body": "It&#39;s a little hard to work out exactly what you&#39;re asking - is it that the example given, in Ruby, generates a different signature to Laravel/PHP?"}, {"owner": {"reputation": 650, "user_id": 4864628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pp9tO.jpg?s=128&g=1", "display_name": "Alex83690", "link": "https://stackoverflow.com/users/4864628/alex83690"}, "edited": false, "score": 0, "creation_date": 1557852668, "post_id": 56133602, "comment_id": 98901260, "body": "Have you tried to compare the two contents without hashing them?  Maybe there are invisible characters."}, {"owner": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "reply_to_user": {"reputation": 7631, "user_id": 886824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3bae1c33c40156bada3c41bdddec4323?s=128&d=identicon&r=PG", "display_name": "CD001", "link": "https://stackoverflow.com/users/886824/cd001"}, "edited": false, "score": 0, "creation_date": 1557879279, "post_id": 56133602, "comment_id": 98910888, "body": "@CD001 in the site of typeform have an example to create a &quot;signature&quot; to compare in request. That example is in ruby, and i wrote in php. The code is right? My problem is, in POST request send from typeform to api, the header in request &quot;typerform-signature&quot; is always different."}, {"owner": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "reply_to_user": {"reputation": 650, "user_id": 4864628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pp9tO.jpg?s=128&g=1", "display_name": "Alex83690", "link": "https://stackoverflow.com/users/4864628/alex83690"}, "edited": false, "score": 0, "creation_date": 1557879366, "post_id": 56133602, "comment_id": 98910905, "body": "@Alex83690 the typeform-signature coming in header of request, and it was already encoded. I need generate the signature to compare."}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "edited": false, "score": 0, "creation_date": 1558019364, "post_id": 56171229, "comment_id": 98969856, "body": "this is payload: <a href=\"https://paste.debian.net/1081749/\" rel=\"nofollow noreferrer\">paste.debian.net/1081749</a> and this is typeform-signature: <a href=\"http://images.devs-on.net/Image/8OsxSPVwyQgzK0GD-Region.png\" rel=\"nofollow noreferrer\">images.devs-on.net/Image/8OsxSPVwyQgzK0GD-Region.png</a>  When we generate this way you wrote and i too, alway signature is different <a href=\"http://images.devs-on.net/Image/Ek76OmKQttKhqcBE-Region.png\" rel=\"nofollow noreferrer\">images.devs-on.net/Image/Ek76OmKQttKhqcBE-Region.png</a>."}, {"owner": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "edited": false, "score": 0, "creation_date": 1558019498, "post_id": 56171229, "comment_id": 98969937, "body": "The code: <a href=\"https://paste.debian.net/1081751/\" rel=\"nofollow noreferrer\">paste.debian.net/1081751</a>"}, {"owner": {"reputation": 26, "user_id": 11471444, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6sdNCiVDy_k/AAAAAAAAAAI/AAAAAAAABNQ/Aw-WD8LgNEs/photo.jpg?sz=128", "display_name": "NordinZ", "link": "https://stackoverflow.com/users/11471444/nordinz"}, "reply_to_user": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "edited": false, "score": 0, "creation_date": 1558025761, "post_id": 56171229, "comment_id": 98973114, "body": "are you copy pasting the JSON in postman? If so, note that this won&#39;t work. I would recommend using something like Ngrok (<a href=\"https://ngrok.com/\" rel=\"nofollow noreferrer\">ngrok.com</a>) and configuring a test webhook in Typeform so you can test with the original request from Typeform."}, {"owner": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "edited": false, "score": 0, "creation_date": 1558029333, "post_id": 56171229, "comment_id": 98974809, "body": "Why postman doesn&#39;t work? I Will try your recomendation anyway."}, {"owner": {"reputation": 26, "user_id": 11471444, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6sdNCiVDy_k/AAAAAAAAAAI/AAAAAAAABNQ/Aw-WD8LgNEs/photo.jpg?sz=128", "display_name": "NordinZ", "link": "https://stackoverflow.com/users/11471444/nordinz"}, "reply_to_user": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "edited": false, "score": 0, "creation_date": 1558074630, "post_id": 56171229, "comment_id": 98987173, "body": "The format you copy / paste from the website has spaces, breaklines and so on... The original request turned into a string doesn&#39;t.  Also, make sure you turned it to string      $data = (string) $request-&gt;getContent();  In your code I can see that you don&#39;t do that."}, {"owner": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "edited": false, "score": 0, "creation_date": 1558112535, "post_id": 56171229, "comment_id": 99006260, "body": "doesnt work. Here is my function <a href=\"https://paste.debian.net/1081886/\" rel=\"nofollow noreferrer\">paste.debian.net/1081886</a>. This is request (<a href=\"http://images.devs-on.net/Image/y9aMag37fIUnyRxA-Region.png\" rel=\"nofollow noreferrer\">images.devs-on.net/Image/y9aMag37fIUnyRxA-Region.png</a>) and this is response (<a href=\"http://images.devs-on.net/Image/1GHgD0ZAV2kTcDym-Region.png\" rel=\"nofollow noreferrer\">images.devs-on.net/Image/1GHgD0ZAV2kTcDym-Region.png</a>)."}, {"owner": {"reputation": 26, "user_id": 11471444, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6sdNCiVDy_k/AAAAAAAAAAI/AAAAAAAABNQ/Aw-WD8LgNEs/photo.jpg?sz=128", "display_name": "NordinZ", "link": "https://stackoverflow.com/users/11471444/nordinz"}, "reply_to_user": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "edited": false, "score": 0, "creation_date": 1558353404, "post_id": 56171229, "comment_id": 99061404, "body": "I tested the solution again and it works. You might want to raise a ticket with our support team at support@typeform.com. Direct it to me (Nordin) and I&#39;ll help you out there."}, {"owner": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "edited": false, "score": 0, "creation_date": 1558395050, "post_id": 56171229, "comment_id": 99078611, "body": "I sent the email today, requesting the forwarding of the ticket to you."}], "tags": [], "owner": {"reputation": 26, "user_id": 11471444, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6sdNCiVDy_k/AAAAAAAAAAI/AAAAAAAABNQ/Aw-WD8LgNEs/photo.jpg?sz=128", "display_name": "NordinZ", "link": "https://stackoverflow.com/users/11471444/nordinz"}, "is_accepted": true, "score": 1, "last_activity_date": 1558017985, "creation_date": 1558017985, "answer_id": 56171229, "question_id": 56133602, "link": "https://stackoverflow.com/questions/56133602/signature-in-ruby-to-php/56171229#56171229", "title": "Signature in ruby to php", "body": "<p>Before running the code make sure that you set your secret properly with Typeform: \n<a href=\"https://i.stack.imgur.com/swVb3.png\" rel=\"nofollow noreferrer\">How to set up your webhook</a></p>\n\n<p>More info here: \n<a href=\"https://developer.typeform.com/webhooks/secure-your-webhooks/\" rel=\"nofollow noreferrer\">https://developer.typeform.com/webhooks/secure-your-webhooks/</a></p>\n\n<p>Once that's done let's jump into the code. I paste here what you need to do step by step: </p>\n\n<pre><code>&lt;?php\n\n  namespace App\\Http\\Controllers;\n  use Illuminate\\Http\\Request;\n\n  class WebhookController extends Controller\n  {\n     public function index(Request $request){\n\n     // Get your data (toString) and the typeform signature\n     $data = (string) $request-&gt;getContent();\n     $typeformSignature = $request-&gt;header('typeform-signature');        \n\n     // Set your key \n     $key = 'test'; // &lt;-- In prod I recommend adding it to the .env file and referring it here \n\n     // Run your hash\n     $hashed = hash_hmac('sha256', $data, $key, $raw_output = TRUE);\n\n     // Encode to Base64\n     $base64 = base64_encode($hashed);\n\n     // Append to string\n     $endValue = \"sha256=\". $base64;\n\n     // This bit here will output stuff to your console if you are running artisan\n     error_log($endValue);\n     error_log($request-&gt;header('typeform-signature'));\n\n     // If it's good it should praise the good Bro, otherwise you are a bad bro. :) \n     if($request-&gt;header('typeform-signature') === $endValue){\n        error_log('Well done bro!');\n     } else {\n        error_log('Sorry bro!');\n     }        \n    }  \n  }\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 11499148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4cc5b07b19858a43ddae738d9df19?s=128&d=identicon&r=PG&f=1", "display_name": "rcnespoli", "link": "https://stackoverflow.com/users/11499148/rcnespoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "closed_date": 1558516631, "accepted_answer_id": 56171229, "answer_count": 1, "score": -2, "last_activity_date": 1558017985, "creation_date": 1557846606, "last_edit_date": 1557847648, "question_id": 56133602, "link": "https://stackoverflow.com/questions/56133602/signature-in-ruby-to-php", "closed_reason": "Needs details or clarity", "title": "Signature in ruby to php", "body": "<p>I have create api to recive data of Typeform(surveys <a href=\"https://www.typeform.com/\" rel=\"nofollow noreferrer\">https://www.typeform.com/</a>). It works fine.\nBut, in secure webhooks, <a href=\"https://developer.typeform.com/webhooks/secure-your-webhooks/\" rel=\"nofollow noreferrer\">https://developer.typeform.com/webhooks/secure-your-webhooks/</a>, shows example of how create signature in ruby, to compare in request. </p>\n\n<p>In laravel i use this:</p>\n\n<pre class=\"lang-php prettyprint-override\"><code>$body = $req-&gt;getContent();\n$sig_internal = base64_encode(hash_hmac('sha256', 'testing', $body, true));\n</code></pre>\n\n<p>My \"secret\" configured in webhooks of the typeform is \"testing\".\nBut the values is different always.\nSomebody have try this?</p>\n"}, {"tags": ["ruby", "testing", "cucumber"], "comments": [{"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557846927, "post_id": 56133350, "comment_id": 98898358, "body": "Yes, you should be able to if your parent folder is <code>features</code>. What the parent folder for <code>common</code> and <code>some_other_folder</code>?"}, {"owner": {"reputation": 3, "user_id": 9204975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d198318ef0b69cdd938e07fc6b78ddc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nexus S", "link": "https://stackoverflow.com/users/9204975/nexus-s"}, "reply_to_user": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557848900, "post_id": 56133350, "comment_id": 98899470, "body": "Yes my parent folder is feature:  ``` feature | |- common |   |- step_difinitions |   |- feature_file.feature | |- Some_other_folder |   |- someother_feature.feature |   |- <b><i>Want to reuse the step_difinitions from common folder</i></b> ```"}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557848962, "post_id": 56133350, "comment_id": 98899500, "body": "So you should be able to use the step defs across the folders from your .feature files. Are you getting any error message when try to use the step def from common folder?"}, {"owner": {"reputation": 3, "user_id": 9204975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d198318ef0b69cdd938e07fc6b78ddc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nexus S", "link": "https://stackoverflow.com/users/9204975/nexus-s"}, "reply_to_user": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557850132, "post_id": 56133350, "comment_id": 98900116, "body": "I am getting ```Undefined step: &quot;stepname&quot; (Cucumber::Undefined) Error"}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557852754, "post_id": 56133350, "comment_id": 98901309, "body": "Have you tried calling the common step_def in the other step_def implementation? Something like this <code>step &#39;common method step goes here&#39;</code>?"}, {"owner": {"reputation": 3, "user_id": 9204975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d198318ef0b69cdd938e07fc6b78ddc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nexus S", "link": "https://stackoverflow.com/users/9204975/nexus-s"}, "reply_to_user": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557854763, "post_id": 56133350, "comment_id": 98902274, "body": "Yes. I have used the common steps somewhere in my features which are places in <code>common</code> folder. Now I want to create a different folder inside <code>feature</code> folder. I just tried moving my feature file in new folder but it does not go out of my new folder to search for the step def&#39;s"}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557855253, "post_id": 56133350, "comment_id": 98902483, "body": "Try to move both folder <code>common</code> and <code>other folder with step defs into </code>step_definitions` folder and see. Generally we will keep all .features under <code>features &gt; whateverFolder</code> and .rb step def files under <code>features &gt; step_definitions</code> folder."}, {"owner": {"reputation": 3, "user_id": 9204975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d198318ef0b69cdd938e07fc6b78ddc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nexus S", "link": "https://stackoverflow.com/users/9204975/nexus-s"}, "reply_to_user": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557861415, "post_id": 56133350, "comment_id": 98905364, "body": "I need to have different folders for different tasks and each have feature files. I tried moving all step definitions in to a single folder under feature-&gt;step_def. I think cucumber only tries to find step_def folder within the folder where *.feature files is placed and it will not go one step higher in hierarchy to find it!!!!"}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557861718, "post_id": 56133350, "comment_id": 98905494, "body": "What&#39;s your <code>Runner Options:</code>? it should be something like this <code>--color -r features</code>. Where <code>features</code> is the folder which holds the parent folder with all features and step def."}, {"owner": {"reputation": 3, "user_id": 9204975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d198318ef0b69cdd938e07fc6b78ddc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nexus S", "link": "https://stackoverflow.com/users/9204975/nexus-s"}, "reply_to_user": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557932633, "post_id": 56133350, "comment_id": 98934262, "body": "I am using <code>rake[&#39;feature_file_name&#39;] require=features products=product_name</code> .   I have following folders in <code>features folder</code>: common, product1, product2, product3 - each of them have feature files only  Also, I have a common step definitions folder in <code>features</code> folder: <code>step_definitions</code>  it did throw errors with undefined scenarios.!!!"}, {"owner": {"reputation": 3, "user_id": 9204975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d198318ef0b69cdd938e07fc6b78ddc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nexus S", "link": "https://stackoverflow.com/users/9204975/nexus-s"}, "reply_to_user": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1557934285, "post_id": 56133350, "comment_id": 98935285, "body": "I had a wrapper around the cucumber commands. I made a change to the wrapper to use <code>-r path_to_step_def&#39;s</code> and it works perfect! Thanks for you help @supputuri !"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 9204975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d198318ef0b69cdd938e07fc6b78ddc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nexus S", "link": "https://stackoverflow.com/users/9204975/nexus-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1557934576, "creation_date": 1557934576, "answer_id": 56153062, "question_id": 56133350, "link": "https://stackoverflow.com/questions/56133350/can-i-use-stepdefinitions-from-a-another-folder-which-is-not-under-my-current-fo/56153062#56153062", "title": "Can I use Stepdefinitions from a another folder which is not under my current folder hierarchy?", "body": "<p>I moved my <code>step_defs</code> out of common feature files folder in to the <code>features</code> folder and used </p>\n\n<p><code>-r features/step_definitions</code> while running the cucumber CLI command. </p>\n\n<p>I had a wrapper around the cucumber commands. So make sure you use <code>-r path</code> in the cucumber commands.</p>\n\n<p>Thanks to @supputuri for help!</p>\n"}, {"tags": [], "owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "is_accepted": true, "score": 0, "last_activity_date": 1557938073, "last_edit_date": 1592644375, "creation_date": 1557938073, "answer_id": 56153958, "question_id": 56133350, "link": "https://stackoverflow.com/questions/56133350/can-i-use-stepdefinitions-from-a-another-folder-which-is-not-under-my-current-fo/56153958#56153958", "title": "Can I use Stepdefinitions from a another folder which is not under my current folder hierarchy?", "body": "<p>Make sure the step definitions are under <code>features</code> folder (any where in sub-folder is also fine). Then you have to use the below command to pick-up the step-defs as part of your features execution.</p>\n<blockquote>\n<p>-r features_folder_path_goes_here</p>\n</blockquote>\n<p>If you are using the rubymine then you can go to <code>Run &gt; Edit Configuration</code> and enter the <code>Runner Options : --color -r feature_folder_path_goes_here</code> or simply you can specify <code>--color -r features</code>.</p>\n<p><a href=\"https://i.stack.imgur.com/DGefH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DGefH.png\" alt=\"enter image description here\" /></a></p>\n<p>FYI - <code>--color</code> nothing to do with this issue, it will make sure the output shows in color.</p>\n"}], "owner": {"reputation": 3, "user_id": 9204975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d198318ef0b69cdd938e07fc6b78ddc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nexus S", "link": "https://stackoverflow.com/users/9204975/nexus-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 56153958, "answer_count": 2, "score": 0, "last_activity_date": 1557938073, "creation_date": 1557845749, "question_id": 56133350, "link": "https://stackoverflow.com/questions/56133350/can-i-use-stepdefinitions-from-a-another-folder-which-is-not-under-my-current-fo", "title": "Can I use Stepdefinitions from a another folder which is not under my current folder hierarchy?", "body": "<p>I want to use existing <code>step_definitions</code> from my project in to another set of cucumber ruby tests.</p>\n\n<pre><code>Eg: \n|\n|- common\n|   |- step_difinitions\n|   |- feature_file.feature\n|\n|- Some_other_folder\n|   |- someother_feature.feature\n|   |- ***Want to reuse the step_difinitions from common folder***\n</code></pre>\n\n<p>Is this at all possible? If not is there any work around for this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 21539, "user_id": 169277, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/66e2fa2e7f25d50d67a5a6acde7a5716?s=128&d=identicon&r=PG", "display_name": "ant", "link": "https://stackoverflow.com/users/169277/ant"}, "is_accepted": true, "score": 1, "last_activity_date": 1557849763, "creation_date": 1557849763, "answer_id": 56134477, "question_id": 56133201, "link": "https://stackoverflow.com/questions/56133201/rails-5-email-interceptor-rspec-test/56134477#56134477", "title": "Rails 5 email interceptor rspec test", "body": "<p>Change your subject to :</p>\n\n<pre><code>subject do \n  ActionMailer::Base.mail(to: to, from: from, subject: 'test', body: 'test').deliver\nend\n</code></pre>\n\n<p>No template used. There are other ways too, this seems to work for the problem what is described here.</p>\n"}], "owner": {"reputation": 493, "user_id": 3616806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5e239b7b5f6e0938a4393e0a639b0aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Remember_me", "link": "https://stackoverflow.com/users/3616806/remember-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 56134477, "answer_count": 1, "score": 0, "last_activity_date": 1557849763, "creation_date": 1557845247, "question_id": 56133201, "link": "https://stackoverflow.com/questions/56133201/rails-5-email-interceptor-rspec-test", "title": "Rails 5 email interceptor rspec test", "body": "<p>I am trying to prevent accidental emails to disabled users. And I figured the best way to do it would be to register mail interceptor, and hook into <code>delivering_email</code> method per this page <a href=\"https://edgeapi.rubyonrails.org/classes/ActionMailer/Base.html\" rel=\"nofollow noreferrer\">https://edgeapi.rubyonrails.org/classes/ActionMailer/Base.html</a></p>\n\n<p>This is the code of my initializer (<code>config/initializers/email_interceptor.rb</code>) :</p>\n\n<pre><code>class EmailInterceptor\n  def self.delivering_email(message)\n    if User.where('email = ? AND disabled_at is not null', message.to).exists?\n      message.perform_deliveries = false\n    end\n  end\nend\n\nActionMailer::Base.register_interceptor(EmailInterceptor)\n</code></pre>\n\n<p>Then I'm trying to add tests to my app so I can make sure that users can register to begin with, and this is how that test looks like :</p>\n\n<pre><code>  let(:from) { 'a@foo.com' }\n  let(:to) { 'b@foo.com' }\n  subject { ActionMailer::Base.mail(to: to, from: from).deliver }\n\n  it 'sends emails to non existing users' do\n    expect { subject }.to change(ActionMailer::Base.deliveries, :count)\n  end\n</code></pre>\n\n<p>There is an error that I get :</p>\n\n<pre><code>Failure/Error: subject { ActionMailer::Base.mail(to: to, from: from).deliver }\n\n     ActionView::MissingTemplate:\n       Missing template action_mailer/base/mail with \"mailer\". Searched in:\n         * \"action_mailer/base\"\n     # ./spec/mailers/email_interceptor_spec.rb:6:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p><strong>Am I doing something wrong here?</strong> I am using rails <code>5.1.0</code> and I wonder if mailer api has changed or something.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "byebug"], "comments": [{"owner": {"reputation": 1086, "user_id": 1327379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZrNi8.jpg?s=128&g=1", "display_name": "andreofthecape", "link": "https://stackoverflow.com/users/1327379/andreofthecape"}, "edited": false, "score": 0, "creation_date": 1557845126, "post_id": 56132814, "comment_id": 98897218, "body": "Havn&#39;t used windows in years so can&#39;t help there but Windows is not the best environment for Rails (might be better now but used to have speed and compatibility issues). Mac or linux is much better. If you have enough resources on your windows machine run a VM with linux on it - will save you a lot of headache."}, {"owner": {"reputation": 377, "user_id": 11498997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X5h1W.jpg?s=128&g=1", "display_name": "Samuel Wakeman", "link": "https://stackoverflow.com/users/11498997/samuel-wakeman"}, "reply_to_user": {"reputation": 1086, "user_id": 1327379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZrNi8.jpg?s=128&g=1", "display_name": "andreofthecape", "link": "https://stackoverflow.com/users/1327379/andreofthecape"}, "edited": false, "score": 0, "creation_date": 1557845705, "post_id": 56132814, "comment_id": 98897619, "body": "any ideas on a link to find goood vm software?"}, {"owner": {"reputation": 1086, "user_id": 1327379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZrNi8.jpg?s=128&g=1", "display_name": "andreofthecape", "link": "https://stackoverflow.com/users/1327379/andreofthecape"}, "edited": false, "score": 0, "creation_date": 1557846008, "post_id": 56132814, "comment_id": 98897830, "body": "<a href=\"https://www.virtualbox.org\" rel=\"nofollow noreferrer\">Virtual box</a> You can then run the desktop edition of your favourite linux flavour (I like Ubuntu) so that it has a browser and you can use a gui text editor, otherwise you can run server version and redirect browser output to your windows host (I prefer first choice)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11499276, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9e1eb89568e27b3c50ea7d13b2847348?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/11499276/leon"}, "is_accepted": false, "score": 0, "last_activity_date": 1557846168, "creation_date": 1557846168, "answer_id": 56133468, "question_id": 56132814, "link": "https://stackoverflow.com/questions/56132814/im-trying-to-instal-ruby-on-rails-but-it-tells-me-i-havent-installed-gem-byebu/56133468#56133468", "title": "I&#39;m trying to instal ruby on rails but it tells me I haven&#39;t installed gem byebug 11.0.1 but I have it installed?", "body": "<blockquote>\n  <p>Blockquote ruby version is 2.5.5 but your gemfile specified is 2.2.6</p>\n</blockquote>\n\n<p>Go to your Gemfile and delete the ruby line. \nAfter that you can normally run the bundle install command</p>\n\n<p>And maybe the other problems: install with the new ruby version (2.5.5) the newest rails gem and after that try to install byebug and turbolink.</p>\n"}], "owner": {"reputation": 377, "user_id": 11498997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X5h1W.jpg?s=128&g=1", "display_name": "Samuel Wakeman", "link": "https://stackoverflow.com/users/11498997/samuel-wakeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557846168, "creation_date": 1557844160, "last_edit_date": 1557845668, "question_id": 56132814, "link": "https://stackoverflow.com/questions/56132814/im-trying-to-instal-ruby-on-rails-but-it-tells-me-i-havent-installed-gem-byebu", "title": "I&#39;m trying to instal ruby on rails but it tells me I haven&#39;t installed gem byebug 11.0.1 but I have it installed?", "body": "<p>I'm trying to install Ruby on Rails on a Windows 7 machine. I followed the instructions at <a href=\"http://installrails.com/\" rel=\"nofollow noreferrer\">http://installrails.com/</a>.  I tried to run server and it said to run <code>bundle install</code> to install missing <code>turbolinks</code> gem. I could not find <code>gem 'turbolinks &lt;~&gt; 5&gt; x86 -mingw32'</code> in any of the gem sources listed on your gemfile or available on this machine</p>\n\n<p>I of course tried bundle install here's the result:\n<a href=\"https://i.stack.imgur.com/wwTKX.png\" rel=\"nofollow noreferrer\">administrative powershell</a></p>\n\n<p>Note that I had to install newer version of Ruby and then do <code>gem install byebug</code> to get to this point but it's weird to me because it says</p>\n\n<blockquote>\n  <p>be sure <code>gem install byebug succeeds</code>.</p>\n</blockquote>\n\n<p>It succeeds but it still won't work :(. Any advice?</p>\n\n<p>EDIT: After trying gem install bundler and another bundle install i now get  your ruby version is 2.5.5 but your gemfile specified is 2.2.6? anyone got a work around for this ?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1557841776, "post_id": 56131960, "comment_id": 98895019, "body": "You can shorten this to <code>array.uniq {|a| a.split(&#39;,&#39;).sort.join(&#39;,&#39;) }</code>."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 1, "creation_date": 1557842516, "post_id": 56131960, "comment_id": 98895473, "body": "Why do you need the <code>join</code>? It works even without that :)"}, {"owner": {"reputation": 2694, "user_id": 3956205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aff84cfa87f92797cb54bdea6d0c20?s=128&d=identicon&r=PG", "display_name": "BTL", "link": "https://stackoverflow.com/users/3956205/btl"}, "edited": false, "score": 0, "creation_date": 1557842757, "post_id": 56131960, "comment_id": 98895629, "body": "You are right :) It was a leftover from the initial answer."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1557843109, "post_id": 56131960, "comment_id": 98895855, "body": "@Ursus the desired output in the question is a array of strings - not an array of arrays."}], "tags": [], "owner": {"reputation": 2694, "user_id": 3956205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aff84cfa87f92797cb54bdea6d0c20?s=128&d=identicon&r=PG", "display_name": "BTL", "link": "https://stackoverflow.com/users/3956205/btl"}, "is_accepted": false, "score": 5, "last_activity_date": 1557842704, "last_edit_date": 1557842704, "creation_date": 1557841426, "answer_id": 56131960, "question_id": 56131873, "link": "https://stackoverflow.com/questions/56131873/how-to-remove-duplicate-pair-values-from-given-array-in-ruby/56131960#56131960", "title": "How to remove duplicate pair values from given array in Ruby?", "body": "<p>Here is a working example :</p>\n\n<pre><code>array = ['R1,R2', 'R3,R4', 'R2,R1', 'R5,R6']\n\narray.uniq { |a| a.split(',').sort }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 613, "user_id": 2252927, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kEOQw.jpg?s=128&g=1", "display_name": "Oxfist", "link": "https://stackoverflow.com/users/2252927/oxfist"}, "edited": false, "score": 2, "creation_date": 1557842978, "post_id": 56132198, "comment_id": 98895774, "body": "I don&#39;t mean this as an insult but the solution you provided is very non-idiomatic."}], "tags": [], "owner": {"reputation": 7430, "user_id": 1838039, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/UHExc.jpg?s=128&g=1", "display_name": "Arivarasan L", "link": "https://stackoverflow.com/users/1838039/arivarasan-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1557842207, "creation_date": 1557842207, "answer_id": 56132198, "question_id": 56131873, "link": "https://stackoverflow.com/questions/56131873/how-to-remove-duplicate-pair-values-from-given-array-in-ruby/56132198#56132198", "title": "How to remove duplicate pair values from given array in Ruby?", "body": "<p>try this,</p>\n\n<pre><code>def unique(array)\n    pure = Array.new\n    for i in array\n        flag = false\n        for j in pure\n            flag = true if (j.split(\",\").sort == i.split(\",\").sort)\n        end\n        pure &lt;&lt; i unless flag\n    end\n    return pure\nend\n</code></pre>\n\n<p>reference: <a href=\"https://www.rosettacode.org/wiki/Remove_duplicate_elements#Ruby\" rel=\"nofollow noreferrer\">https://www.rosettacode.org/wiki/Remove_duplicate_elements#Ruby</a></p>\n"}, {"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 6, "last_activity_date": 1557843582, "last_edit_date": 1557843582, "creation_date": 1557842235, "answer_id": 56132206, "question_id": 56131873, "link": "https://stackoverflow.com/questions/56131873/how-to-remove-duplicate-pair-values-from-given-array-in-ruby/56132206#56132206", "title": "How to remove duplicate pair values from given array in Ruby?", "body": "<p>A solution with <code>Set</code></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'set' \n\na.uniq { |item| Set.new(item.split(\",\")) }  # =&gt; [\"R1,R2\", \"R3,R4\", \"R5,R6\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 613, "user_id": 2252927, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kEOQw.jpg?s=128&g=1", "display_name": "Oxfist", "link": "https://stackoverflow.com/users/2252927/oxfist"}, "edited": false, "score": 0, "creation_date": 1557843088, "post_id": 56132232, "comment_id": 98895844, "body": "That doesn&#39;t really solves what OP posted, since you actually modified the specification of the problem."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 613, "user_id": 2252927, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kEOQw.jpg?s=128&g=1", "display_name": "Oxfist", "link": "https://stackoverflow.com/users/2252927/oxfist"}, "edited": false, "score": 0, "creation_date": 1557843426, "post_id": 56132232, "comment_id": 98896057, "body": "@oxfist the recommendation to transform the values into actual sets is spot on though."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1557842326, "creation_date": 1557842326, "answer_id": 56132232, "question_id": 56131873, "link": "https://stackoverflow.com/questions/56131873/how-to-remove-duplicate-pair-values-from-given-array-in-ruby/56132232#56132232", "title": "How to remove duplicate pair values from given array in Ruby?", "body": "<p>If the elements of your array are \"pairs\", they should maybe be <em>actual</em> pairs and not strings, like this:</p>\n\n<pre><code>pairs = [['R1', 'R2'], ['R3', 'R4'], ['R2', 'R1'], ['R5', 'R6']]\n</code></pre>\n\n<p>And, in fact, since order doesn't seem to matter, it looks like they <em>really</em> should be sets:</p>\n\n<pre><code>require 'set'\n\nsets = [Set['R1', 'R2'], Set['R3', 'R4'], Set['R2', 'R1'], Set['R5', 'R6']]\n</code></pre>\n\n<p>If that is the case, then <code>Array#uniq</code> will simply work as expected:</p>\n\n<pre><code>sets.uniq\n#=&gt; [#&lt;Set: {\"R1\", \"R2\"}&gt;, #&lt;Set: {\"R3\", \"R4\"}&gt;, #&lt;Set: {\"R5\", \"R6\"}&gt;]\n</code></pre>\n\n<p>So, the best way would be to change the code that produces this value to return an array of two-element sets.</p>\n\n<p>If that is not possible, then you should transform the value at your system boundary when it enters the system, something like this:</p>\n\n<pre><code>sets = a.map {|el| el.split(',') }.map(&amp;Set.method(:new))\n</code></pre>\n"}], "owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 56132206, "answer_count": 4, "score": 3, "last_activity_date": 1557845285, "creation_date": 1557841144, "last_edit_date": 1557845285, "question_id": 56131873, "link": "https://stackoverflow.com/questions/56131873/how-to-remove-duplicate-pair-values-from-given-array-in-ruby", "title": "How to remove duplicate pair values from given array in Ruby?", "body": "<p>I want to remove a pair of 'duplicates' from an array of strings, where each element has the form <code>R1,R2</code>, with varying numbers. In my case, a duplicate would be <code>R2,R1</code> because it has the same elements of <code>R1,R2</code> but inverted.</p>\n\n<p>Given:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>a = ['R1,R2', 'R3,R4', 'R2,R1', 'R5,R6']\n</code></pre>\n\n<p>The resulting array should be like so:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>a = ['R1,R2', 'R3,R4', 'R5,R6']\n</code></pre>\n\n<p>How could I remove the duplicates so I would have the following?</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557839088, "post_id": 56131136, "comment_id": 98893347, "body": "Are you trying to add the value to the existing hash value for that key or make a new value for that key?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557839121, "post_id": 56131136, "comment_id": 98893370, "body": "If you&#39;tr trying to set the value then change <code>new_file[category] &lt;&lt; name </code> to <code>new_file[category] = name</code>"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557839148, "post_id": 56131136, "comment_id": 98893387, "body": "Indeed just get rid of your conditional completely if you&#39;re trying to set the value rather than add to it as both should do the same"}, {"owner": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557839149, "post_id": 56131136, "comment_id": 98893388, "body": "trying to add a value to an existing hash"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1557841371, "post_id": 56131136, "comment_id": 98894776, "body": "What is the expected output? Do you want the keys concatenated as a string as a value or should the value be an array containing all strings?"}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1557864016, "post_id": 56132057, "comment_id": 98906532, "body": "Uh, that&#39;s embarrassing. I should&#39;ve known. I probably even did, and forgot. Thanks!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1557907217, "post_id": 56132057, "comment_id": 98918629, "body": "+1 for clearing up some confusion the OP seems to have. Unfortunately, your answer doesn&#39;t address the actual problem."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1557864218, "last_edit_date": 1557864218, "creation_date": 1557841731, "answer_id": 56132057, "question_id": 56131136, "link": "https://stackoverflow.com/questions/56131136/unexpected-frozenerror-when-appending-elements-via/56132057#56132057", "title": "Unexpected FrozenError when appending elements via &lt;&lt;", "body": "<blockquote>\n  <p>How can I restructure this code so the '.each' doesn't provide frozen variables?</p>\n</blockquote>\n\n<p>Short answer: you can't.</p>\n\n<p><code>Hash#each</code> doesn't \"provide frozen variables\".</p>\n\n<p>First off, there is no such thing as a \"frozen variable\". Variables aren't frozen. Objects are. The distinction between variables and objects is <em>fundamental</em>, not just in Ruby but in any programming language (and in fact pretty much everywhere else, too). If I have a sticker with the name \"Seamus\" on it, then this sticker is not you. It is simply a label that refers to you.</p>\n\n<p>Secondly, <code>Hash#each</code> doesn't provide \"variables\". In fact, it doesn't provide anything that is not in the hash already. It simply yields the objects that are already in the hash.</p>\n\n<p>Note that, in order to avoid confusion and bugs, strings are automatically frozen when used as keys. So, you can't modify string keys. You can either make sure they are correct from the beginning, or you can create a new hash with new string keys. (You can also add the new keys to the existing hash and delete the old keys, but that is a lot of complexity for little gain.)</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1557907632, "post_id": 56132178, "comment_id": 98918852, "body": "If you have <code>new_hash = Hash.new { |h, k| h[k] = [] }</code>, i.e. a hash using an empty array as its default, your code becomes <code>hash.each { |k, v| new_hash[v] &lt;&lt; k }</code>"}], "tags": [], "owner": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "is_accepted": false, "score": 2, "last_activity_date": 1557906788, "last_edit_date": 1557906788, "creation_date": 1557842153, "answer_id": 56132178, "question_id": 56131136, "link": "https://stackoverflow.com/questions/56131136/unexpected-frozenerror-when-appending-elements-via/56132178#56132178", "title": "Unexpected FrozenError when appending elements via &lt;&lt;", "body": "<p>I needed to add the first name to an array and then that array to the hash.</p>\n\n<pre><code>new_hash = Hash.new\nhash.each do |name , category|\n  if new_hash.key?(category)\n    new_file[category] &lt;&lt; name \n  else\n    new_hash[category] = [name] # &lt;- must be an array    \n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1595883032, "creation_date": 1557838965, "last_edit_date": 1595883032, "question_id": 56131136, "link": "https://stackoverflow.com/questions/56131136/unexpected-frozenerror-when-appending-elements-via", "title": "Unexpected FrozenError when appending elements via &lt;&lt;", "body": "<p>I have a hash containing names and categories:</p>\n\n<pre><code>hash = {\n  'Dog' =&gt; 'Fauna',\n  'Rose' =&gt; 'Flora',\n  'Cat' =&gt; 'Fauna'\n}\n</code></pre>\n\n<p>and I want to reorganize it so that the names are grouped by their corresponding category:</p>\n\n<pre><code>{\n  'Fauna' =&gt; ['Dog', 'Cat'],\n  'Flora' =&gt; ['Rose']\n}\n</code></pre>\n\n<p>I am adding each names via <code>&lt;&lt;</code>:</p>\n\n<pre><code>new_hash = Hash.new\nhash.each do |name , category|\n  if new_hash.key?(category)\n    new_file[category] &lt;&lt; name \n  else\n    new_hash[category] = name\n  end    \nend\n</code></pre>\n\n<p>But I am being told that this operation is being performed on a frozen element:</p>\n\n<blockquote>\n  <p>`&lt;&lt;' :  Can\u2019t modify frozen string (FrozenError)</p>\n</blockquote>\n\n<p>I suppose this is because <code>each</code> yields frozen objects. How can I restructure this code so the '.each' doesn't provide frozen variables?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "linux", "docker", "docker-compose"], "comments": [{"owner": {"reputation": 1610, "user_id": 6482759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093bf0a6f8df3309217c5c6824065435?s=128&d=identicon&r=PG&f=1", "display_name": "bellackn", "link": "https://stackoverflow.com/users/6482759/bellackn"}, "edited": false, "score": 0, "creation_date": 1557851801, "post_id": 56130883, "comment_id": 98900897, "body": "Have you specified <code>ARG DOCKER_GROUP_ID</code> somewhere in your Dockerfile? Otherwise, the <code>--build-arg</code> flag doesn&#39;t have any effect. Also, is there any error message coming from your rails container?"}, {"owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "reply_to_user": {"reputation": 1610, "user_id": 6482759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093bf0a6f8df3309217c5c6824065435?s=128&d=identicon&r=PG&f=1", "display_name": "bellackn", "link": "https://stackoverflow.com/users/6482759/bellackn"}, "edited": false, "score": 0, "creation_date": 1557897305, "post_id": 56130883, "comment_id": 98914237, "body": "I have the ARG flag in my Dockerfile. I edited my post to show where it is"}, {"owner": {"reputation": 1610, "user_id": 6482759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093bf0a6f8df3309217c5c6824065435?s=128&d=identicon&r=PG&f=1", "display_name": "bellackn", "link": "https://stackoverflow.com/users/6482759/bellackn"}, "edited": false, "score": 0, "creation_date": 1557915206, "post_id": 56130883, "comment_id": 98923202, "body": "Ok, but you still owe us an error message. :) Or why do you think the rails server crashed? What is happening exactly and what do you want to happen?"}, {"owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "reply_to_user": {"reputation": 1610, "user_id": 6482759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093bf0a6f8df3309217c5c6824065435?s=128&d=identicon&r=PG&f=1", "display_name": "bellackn", "link": "https://stackoverflow.com/users/6482759/bellackn"}, "edited": false, "score": 0, "creation_date": 1557917507, "post_id": 56130883, "comment_id": 98924591, "body": "The problem is, that I just can&#39;t see an error message... . When I start the container with running rails it shuts down immidiatly after it booted. When I start the bash instead of puma, I can access docker and everything seems to be ok. Maybe you know a way how to access an error log?"}], "owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557897272, "creation_date": 1557838082, "last_edit_date": 1557897272, "question_id": 56130883, "link": "https://stackoverflow.com/questions/56130883/mounting-docker-socket-into-container-crashes-rails-server", "title": "Mounting docker socket into container crashes rails server", "body": "<p>We have a small inhouse app that I have to maintain. This app starts new docker containers and runs on an old ruby(2.2)/rails(4.2) version.<br>\nSince it is not possible to install this ruby version on new Ubuntu's - wrong version of libssl in the repositories and I have not found a way to install an old version and a new version in parallel - I decided that I put this app inside a docker container.  </p>\n\n<p>This works except, when I try to mount the docker socket into it the rails server crashes on startup - the app want's to access the socket during this time to display all running containers.<br>\nI already made sure that the docker group is the same for the host and the container with this:</p>\n\n<pre><code>ARG DOCKER_GROUP_ID\nUSER root\n\nRUN printf \"deb http://archive.debian.org/debian/ jessie main\\ndeb-src http://archive.debian.org/debian/ jessie main\\ndeb http://security.debian.org jessie/updates main\\ndeb-src http://security.debian.org jessie/updates main\" &gt; /etc/apt/sources.list  \nRUN echo \"deb http://apt.dockerproject.org/repo debian-jessie main\" &gt; /etc/apt/sources.list.d/docker.list\n\nRUN groupadd -g $DOCKER_GROUP_ID docker &amp;&amp; usermod -a -G docker root\n</code></pre>\n\n<p>And during build time I pass this argument:</p>\n\n<blockquote>\n  <p>docker-compose build --build-arg DOCKER_GROUP_ID=<code>getent group docker | cut -d: -f3</code></p>\n</blockquote>\n\n<p>When I connect to the container and call <code>docker info</code> I get a result and the container is still ok...  </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3002, "user_id": 976498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CSZVp.jpg?s=128&g=1", "display_name": "LHH", "link": "https://stackoverflow.com/users/976498/lhh"}, "edited": false, "score": 0, "creation_date": 1557835884, "post_id": 56130063, "comment_id": 98891324, "body": "it should be table name in order clause like supplies"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 1351923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2e90f5f2053a45b118f1ecae8c06030?s=128&d=identicon&r=PG", "display_name": "Bhimasen Rautaray", "link": "https://stackoverflow.com/users/1351923/bhimasen-rautaray"}, "edited": false, "score": 0, "creation_date": 1557836274, "post_id": 56130191, "comment_id": 98891582, "body": "I am getting this error:   PG::AmbiguousColumn: ERROR:  column reference &quot;seller_id&quot; is ambiguous LINE 1: ... ON &quot;supplies&quot;.&quot;id&quot; = &quot;stocks&quot;.&quot;supply_id&quot; WHERE (seller_id ..."}, {"owner": {"reputation": 169, "user_id": 8223967, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60f05fe9d2060200b910202b7eb21175?s=128&d=identicon&r=PG&f=1", "display_name": "Jasjeet Singh", "link": "https://stackoverflow.com/users/8223967/jasjeet-singh"}, "edited": false, "score": 1, "creation_date": 1557836344, "post_id": 56130191, "comment_id": 98891628, "body": "you must have seller_id in both tables. <code>stocks.seller_id</code> will solve your problem."}, {"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "reply_to_user": {"reputation": 155, "user_id": 1351923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2e90f5f2053a45b118f1ecae8c06030?s=128&d=identicon&r=PG", "display_name": "Bhimasen Rautaray", "link": "https://stackoverflow.com/users/1351923/bhimasen-rautaray"}, "edited": false, "score": 1, "creation_date": 1557836454, "post_id": 56130191, "comment_id": 98891698, "body": "@BhimasenRautaray use table name with column name in where clause query like   &quot;stocks.seller_id = ?&quot; this will resolve the exception"}], "tags": [], "owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "is_accepted": true, "score": 2, "last_activity_date": 1557838088, "last_edit_date": 1557838088, "creation_date": 1557835948, "answer_id": 56130191, "question_id": 56130063, "link": "https://stackoverflow.com/questions/56130063/sorting-record-of-a-model-based-on-attribute-of-associated-model-in-ruby-on-rail/56130191#56130191", "title": "sorting record of a model based on attribute of associated model in ruby on rails", "body": "<p>there just should be <code>supplies</code> instead of <code>supply</code> Try,</p>\n\n<pre><code>Stock.includes(:supply).where(\"seller_id = ? AND status = ? AND product_id = ?\", @seller_id, \"Approved\", list_item.product_id).order(\"supplies.date_received\")\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 1351923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2e90f5f2053a45b118f1ecae8c06030?s=128&d=identicon&r=PG", "display_name": "Bhimasen Rautaray", "link": "https://stackoverflow.com/users/1351923/bhimasen-rautaray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 56130191, "answer_count": 1, "score": 0, "last_activity_date": 1557838088, "creation_date": 1557835576, "last_edit_date": 1557835736, "question_id": 56130063, "link": "https://stackoverflow.com/questions/56130063/sorting-record-of-a-model-based-on-attribute-of-associated-model-in-ruby-on-rail", "title": "sorting record of a model based on attribute of associated model in ruby on rails", "body": "<p>I have a stock model and supply model and stock belongs to supply model.</p>\n\n<p>I want to sort stock records based on \"date_received\" attribute of supply model</p>\n\n<pre><code>Stock.where(\"seller_id = ? AND status = ? AND product_id = ?\", @seller_id, \"Approved\", list_item.product_id)\n</code></pre>\n\n<p>I am getting error for below:</p>\n\n<pre><code>Stock.includes(:supply).where(\"seller_id = ? AND status = ? AND product_id = ?\", @seller_id, \"Approved\", list_item.product_id).order(\"supply.date_received\")\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "export-to-csv"], "comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557834431, "post_id": 56129587, "comment_id": 98890518, "body": "what is @people? Isn&#39;t it a normal variable? I don&#39;t think that <code>to_csv</code> is a valid method..."}, {"owner": {"reputation": 85, "user_id": 8592732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8508fe8290a73a85666ae96e64165526?s=128&d=identicon&r=PG&f=1", "display_name": "js_beginner", "link": "https://stackoverflow.com/users/8592732/js-beginner"}, "reply_to_user": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557837158, "post_id": 56129587, "comment_id": 98892114, "body": "@bo-oz Hi there, yeah <code>@people</code> is a normal variable, do you have any other suggestion in order to export the <code>@people</code>&#39;s data to CSV file?"}], "answers": [{"comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1557836481, "post_id": 56129756, "comment_id": 98891712, "body": "You might want to add <code>unless people.empty?</code> when adding the keys otherwise it will fail if the array is empty."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1557839393, "post_id": 56129756, "comment_id": 98893555, "body": "fixed some bugs and followed suggestion by Kris."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557844483, "post_id": 56129756, "comment_id": 98896786, "body": "The second option skips the first person"}], "tags": [], "owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "is_accepted": true, "score": 1, "last_activity_date": 1557864868, "last_edit_date": 1557864868, "creation_date": 1557834533, "answer_id": 56129756, "question_id": 56129587, "link": "https://stackoverflow.com/questions/56129587/export-an-object-to-csv-file-currently-displaying-data-inline/56129756#56129756", "title": "export an object to csv file currently displaying data inline", "body": "<p>I think you need to write the function differently:</p>\n\n<pre><code>  def to_csv(people)\n    CSV.generate do |csv|\n      return unless people.count &gt; 0\n      csv &lt;&lt; people[0].keys\n      people.each do |person|\n        csv &lt;&lt; person.values\n      end\n    end\n  end\n</code></pre>\n\n<p>I suppose you could even do:</p>\n\n<pre><code>  def to_csv(people)\n    CSV.generate do |csv|\n      return unless people.count &gt; 0\n      csv &lt;&lt; people[0].keys\n      csv &lt;&lt; people.each.map{|item| item.values}\n    end\n  end\n</code></pre>\n\n<p>And then call it as a function:</p>\n\n<pre><code>respond_to do |format|\n   format.html\n   format.csv { \n   send_data to_csv(@people),\n   filename: \"export.csv\",\n   type: 'text/csv; charset=utf-8' \n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "is_accepted": false, "score": 0, "last_activity_date": 1557834645, "creation_date": 1557834645, "answer_id": 56129792, "question_id": 56129587, "link": "https://stackoverflow.com/questions/56129587/export-an-object-to-csv-file-currently-displaying-data-inline/56129792#56129792", "title": "export an object to csv file currently displaying data inline", "body": "<p>you Don't need to do like <code>value.attributes.values_at(*column_names)</code> just you need to do <code>value.values</code> which will give you the array of values that you want to store it in CSV.</p>\n\n<p>for example </p>\n\n<pre><code>people = [{\"id\"=&gt;1, \"name\"=&gt;\"Tom\", \"age\"=&gt;\"25\"},\n         {\"id\"=&gt;2, \"name\"=&gt;\"Marry\", \"age\"=&gt;\"27\"},\n         {\"id\"=&gt;3, \"name\"=&gt;\"Jack\", \"age\"=&gt;\"28\"}]\n\n\ndef to_csv\n    CSV.generate(headers: true) do |csv|\n      csv &lt;&lt; column_names\n      people.each do |person|\n        csv &lt;&lt; person.values\n      end\n    end\n  end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557834883, "post_id": 56129812, "comment_id": 98890784, "body": "This only works if @people is a ActiveModel object... it seems it isn&#39;t in this case."}], "tags": [], "owner": {"reputation": 121, "user_id": 10472289, "user_type": "registered", "profile_image": "https://graph.facebook.com/1492612627483188/picture?type=large", "display_name": "Omiyera Damilola", "link": "https://stackoverflow.com/users/10472289/omiyera-damilola"}, "is_accepted": false, "score": 0, "last_activity_date": 1557834740, "creation_date": 1557834740, "answer_id": 56129812, "question_id": 56129587, "link": "https://stackoverflow.com/questions/56129587/export-an-object-to-csv-file-currently-displaying-data-inline/56129812#56129812", "title": "export an object to csv file currently displaying data inline", "body": "<p>Here is how i do mine, \nin my controller i added </p>\n\n<pre><code>respond_to do |format|\n      format.html\n      format.csv { send_data @people.to_csv }\n    end\n</code></pre>\n\n<p>then </p>\n\n<pre><code>def self.to_csv(options = {})\n      CSV.generate(options) do |csv|\n        csv &lt;&lt; column_names\n        all.each do |project|\n          csv &lt;&lt; people.attributes.values_at(*column_names)\n        end\n      end\n    end\n</code></pre>\n\n<p>then dont forget to <code>require 'csv'</code> in your config/application.rb</p>\n\n<p>then you can link to your csv with something like <code>&lt;%= link_to \"CSV\", people_path(format: \"csv\") %&gt;</code></p>\n"}], "owner": {"reputation": 85, "user_id": 8592732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8508fe8290a73a85666ae96e64165526?s=128&d=identicon&r=PG&f=1", "display_name": "js_beginner", "link": "https://stackoverflow.com/users/8592732/js-beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 56129756, "answer_count": 3, "score": 0, "last_activity_date": 1557864868, "creation_date": 1557833972, "question_id": 56129587, "link": "https://stackoverflow.com/questions/56129587/export-an-object-to-csv-file-currently-displaying-data-inline", "title": "export an object to csv file currently displaying data inline", "body": "<p>I have <code>@people</code> variable contains data look exactly like:</p>\n\n<h3>What I have</h3>\n\n<pre><code>[{\"id\"=&gt;1, \"name\"=&gt;\"Tom\", \"age\"=&gt;\"25\"},\n {\"id\"=&gt;2, \"name\"=&gt;\"Marry\", \"age\"=&gt;\"27\"},\n {\"id\"=&gt;3, \"name\"=&gt;\"Jack\", \"age\"=&gt;\"28\"}] \n</code></pre>\n\n<p>and I am trying to convert the data to the CSV file, which might look like </p>\n\n<h3>What I am aiming to do</h3>\n\n<pre><code>id | name | age\n 1 | Tom  | 25\n 2 | Marry| 27\n 3 | Jack | 28\n</code></pre>\n\n<p>but my code generates a CSV file with displaying all of the data inline. For example:</p>\n\n<h3>What I get</h3>\n\n<pre><code>{\"id\"=&gt;1,\"name\"=&gt;\"Tom\",\"age\"=&gt;25},{\"id\"=&gt;2, \"name\"=&gt;\"Marry\", \n\"age\"=&gt;\"27\"},{\"id\"=&gt;3, \"name\"=&gt;\"Jack\", \"age\"=&gt;\"28\"}\n</code></pre>\n\n<h3>What I did:</h3>\n\n<p><code>to_csv</code> action look like:</p>\n\n<pre><code>  def to_csv\n    CSV.generate(option) do |csv|\n      csv &lt;&lt; column_names\n      values.each do |value|\n        csv &lt;&lt; value.attributes.values_at(*column_names)\n      end\n    end\n  end\n</code></pre>\n\n<p>I added this <code>respond_to</code> block to one of my actions: </p>\n\n<pre><code>respond_to do |format|\n   format.html\n   format.csv { \n   send_data @people.to_csv,\n   filename: \"export.csv\",\n   type: 'text/csv; charset=utf-8' \n }\n</code></pre>\n\n<p>I am getting data(e.g <code>{\"id\"=&gt;1,\"name\"=&gt;\"Tom\",\"age\"=&gt;25 ...</code>) from external so I pushed that data into <code>@people</code> variable to use. Any help would be very appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557834142, "post_id": 56129213, "comment_id": 98890366, "body": "What callback do you want to trigger making <code>c.students</code> an empty array? What are you hoping to trigger it?"}, {"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557835209, "post_id": 56129213, "comment_id": 98890973, "body": "for example &#39;after_destroy&#39; or &#39;after_commit&#39; one (On the <code>StudentCourse</code> model), I just want the workaround of making it possible. thanks for your comment @Mark"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1557836713, "post_id": 56129213, "comment_id": 98891862, "body": "What is <code>StudentCenter</code>?"}, {"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1557837267, "post_id": 56129213, "comment_id": 98892184, "body": "I&#39;m sorry it is a typo, I mean <code>StudentClass</code> model. @Kris"}, {"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "edited": false, "score": 0, "creation_date": 1557838062, "post_id": 56129213, "comment_id": 98892687, "body": "Do you really have a model named <code>Class</code>? Are you aware of the fact that you are overwriting the Ruby core <code>Class</code> class?"}, {"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "edited": false, "score": 0, "creation_date": 1557838754, "post_id": 56129213, "comment_id": 98893140, "body": "Yes of course I&#39;m aware of that, Actually this is just an example to explain my question. @medsantis"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1557844768, "post_id": 56129213, "comment_id": 98896976, "body": "Does it really &quot;perform the deletion&quot; seems more like it just disconnects the students from the class. You could add <code>dependent: :destroy</code> to the relationship which should fire <code>destroy</code>."}, {"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557856512, "post_id": 56129213, "comment_id": 98903059, "body": "I am not aiming just deletion, I&#39;m aiming the hooks aftet using the []=, could u read the question carfully please. @engineersmnky"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557858965, "post_id": 56129213, "comment_id": 98904244, "body": "Can you please read my response carefully? If you were to add <code>dependent: destroy</code> to the relationship the <code>destroy</code> hooks should fire.  What you are using here is <a href=\"https://github.com/rails/rails/blob/46b46e85c72f78e869a1b0038040849911c7e2c5/activerecord/lib/active_record/associations/collection_association.rb#L243\" rel=\"nofollow noreferrer\"><code>replace</code></a>  which calls <a href=\"https://github.com/rails/rails/blob/46b46e85c72f78e869a1b0038040849911c7e2c5/activerecord/lib/active_record/associations/collection_association.rb#L410\" rel=\"nofollow noreferrer\">replace_records</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557858979, "post_id": 56129213, "comment_id": 98904250, "body": "which calls <a href=\"https://github.com/rails/rails/blob/46b46e85c72f78e869a1b0038040849911c7e2c5/activerecord/lib/active_record/associations/collection_association.rb#L189\" rel=\"nofollow noreferrer\">delete</a> which calls <a href=\"https://github.com/rails/rails/blob/46b46e85c72f78e869a1b0038040849911c7e2c5/activerecord/lib/active_record/associations/collection_association.rb#L380\" rel=\"nofollow noreferrer\"><code>delete_or_destroy</code></a> which calls <a href=\"https://github.com/rails/rails/blob/46b46e85c72f78e869a1b0038040849911c7e2c5/activerecord/lib/active_record/associations/has_many_through_association.rb#L107\" rel=\"nofollow noreferrer\">remove_records</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557859037, "post_id": 56129213, "comment_id": 98904271, "body": "so on until you get to <a href=\"https://github.com/rails/rails/blob/46b46e85c72f78e869a1b0038040849911c7e2c5/activerecord/lib/active_record/associations/has_many_through_association.rb#L131\" rel=\"nofollow noreferrer\"><code>delete_records</code></a> which has the hook for method :destroy which will fire call backs."}, {"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557859280, "post_id": 56129213, "comment_id": 98904382, "body": "hmmmm, sounds interesting, I will give it a chance. thanks a lot @engineersmnky"}], "owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557844897, "creation_date": 1557832788, "last_edit_date": 1557844897, "question_id": 56129213, "link": "https://stackoverflow.com/questions/56129213/how-to-work-around-on-in-removing-middle-relations-rails", "title": "How to work around on []= in removing middle relations rails", "body": "<p>I will simulate my problem through the next example, Suppose I've <code>student</code>s that could be related to <code>course</code>s, and the <code>course</code> contains more than one <code>student</code>. So, It is many to many relationship between students and courses, Consider the following code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># student.rb\nclass Student &lt; ApplicationRecord\n  has_many :student_courses\n  has_many :courses, through: :student_courses\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># student_course.rb\nclass StudentCourse &lt; ApplicationRecord\n  belong_to :student\n  belong_to :course\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># course.rb\nclass Course &lt; ApplicationRecord\n  has_many :student_courses\n  has_many :students, through: :student_courses\nend\n</code></pre>\n\n<p>All the above is ok, but while I was trying to make a delete between these relation and make a callback in the middle table like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\n&gt; c = Course.first\n&gt; c.students = [] # this perform a deletion correctly but can't be triggered by a call back\n\n</code></pre>\n\n<p>make <code>students</code> and empty array delete the relation correctly but it is not triggered by a callback.\nwhile using <code>StudentCenter.where(something).destroy_all</code> will trigger <code>after_destroy</code> and so on.</p>\n\n<p>my question is, How could I use the <code>= []</code> and keep the triggering as I somehow find the manipulation on the middle table is a little bit noisy in reading the code.\nThanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "mailboxer"], "answers": [{"tags": [], "owner": {"reputation": 364, "user_id": 4136529, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wvzv6m37XJg/AAAAAAAAAAI/AAAAAAAABGI/SHiJgtNb-Fs/photo.jpg?sz=128", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/4136529/philippe-b"}, "is_accepted": true, "score": 4, "last_activity_date": 1557868598, "creation_date": 1557868598, "answer_id": 56138728, "question_id": 56128061, "link": "https://stackoverflow.com/questions/56128061/how-can-i-set-the-user-type-in-the-mailboxer-notifications-table/56138728#56138728", "title": "How can I set the user_type in the mailboxer_notifications table?", "body": "<p>In the code you proposed, you are calling <code>sender_type</code> on the array of messages, but that method exists on the <code>Mailboxer::Message</code> model. As it's a polymorphic association <a href=\"https://github.com/mailboxer/mailboxer/blob/03543e8a06dea8c9bfb52963da8abbf1157d5d21/app/models/mailboxer/notification.rb#L7\" rel=\"nofollow noreferrer\">see code of model here</a>, the <code>sender</code> of the <code>Mailboser::Message</code> will be the user that was used for creating the message (in this case <code>current_user</code>).</p>\n\n<p>So I guess what you are looking for, is to get the <code>user_type</code> of your sender for a specific message of a conversation.</p>\n\n<p>So this is can be done, by doing the following (in this example let's get the <code>user_type</code> of the user that sent the first message of a given conversation : </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>conversation.messages.first.sender.user_type\n</code></pre>\n"}], "owner": {"reputation": 299, "user_id": 9454269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0edb637e57ce3cad9745d80e6739b567?s=128&d=identicon&r=PG&f=1", "display_name": "KuroGane", "link": "https://stackoverflow.com/users/9454269/kurogane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56138728, "answer_count": 1, "score": 0, "last_activity_date": 1557868598, "creation_date": 1557828905, "question_id": 56128061, "link": "https://stackoverflow.com/questions/56128061/how-can-i-set-the-user-type-in-the-mailboxer-notifications-table", "title": "How can I set the user_type in the mailboxer_notifications table?", "body": "<p>My problem is that when users reply to each other, it's hard examine the database via SQL and differentiate between user types (so admin, and individual users). The default is just \"User\", as a string.</p>\n\n<p>When examining the mailboxer code, I know it calls the \"reply\" method in the Conversations controller. This is the relevant part of the code:</p>\n\n<pre><code>def reply\n  current_user.reply_to_conversation(conversation, message_params[:body])\n  flash[:notice] = \"Message was sent.\"\n  redirect_to conversation_path(conversation)\nend\n</code></pre>\n\n<p>From this, I wanted to do something like:</p>\n\n<pre><code>conversation.messages.sender_type = params[:custom].present? ? params[:custom] : \"Admin\"\n</code></pre>\n\n<p>But this does not work, as it says \"unknown sender type method\". I listed it that way because, based on the mail boxer gem code, messages belongs_to conversation, and the messages model is linked to the table and column value I want to change.</p>\n\n<p>This is the relevant code:\n<a href=\"https://github.com/mailboxer/mailboxer/blob/03543e8a06dea8c9bfb52963da8abbf1157d5d21/app/models/mailboxer/message.rb\" rel=\"nofollow noreferrer\">https://github.com/mailboxer/mailboxer/blob/03543e8a06dea8c9bfb52963da8abbf1157d5d21/app/models/mailboxer/message.rb</a></p>\n\n<p>Based on this, what should I modify to have it so when I reply to a user, the reply action is called, and then conversations \"calls\" messages which itself sets the sender_type to a value I want?</p>\n"}, {"tags": ["ruby", "upload", "datastore", "dragonfly-gem"], "answers": [{"tags": [], "owner": {"reputation": 1550, "user_id": 1014898, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/U3Gfi.png?s=128&g=1", "display_name": "Railsana", "link": "https://stackoverflow.com/users/1014898/railsana"}, "is_accepted": true, "score": 0, "last_activity_date": 1559114841, "last_edit_date": 1559114841, "creation_date": 1557861098, "answer_id": 56137080, "question_id": 56127944, "link": "https://stackoverflow.com/questions/56127944/can-i-customize-the-dragonfly-image-uid/56137080#56137080", "title": "Can I customize the Dragonfly image_uid?", "body": "<p>I found the possibility to add a custom path in the docs:</p>\n\n<pre><code>storage_options do |a|\n  { path: \"#{date.strftime('%Y/%m/%d')}/#{SecureRandom.hex(64)}_#{a.name}\" }\nend\n</code></pre>\n\n<p>This adds a random string of 64 characters to the filename.</p>\n"}], "owner": {"reputation": 1550, "user_id": 1014898, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/U3Gfi.png?s=128&g=1", "display_name": "Railsana", "link": "https://stackoverflow.com/users/1014898/railsana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 56137080, "answer_count": 1, "score": 0, "last_activity_date": 1559114841, "creation_date": 1557828531, "question_id": 56127944, "link": "https://stackoverflow.com/questions/56127944/can-i-customize-the-dragonfly-image-uid", "title": "Can I customize the Dragonfly image_uid?", "body": "<p>I am using Dragonfly and would like to have longer filenames (<strong>image_uid</strong>s) that cannot be \"guessed\".\nMy current filenames look like this:</p>\n\n<p><code>2019/05/14/5ep7gqqmiu_test.jpg</code></p>\n\n<p>I'd prefer a path like this:</p>\n\n<p><code>2019/05/14/5ep7gqqmiun96v661gt3bdscv305xnxwzmmtr0sknwscqlxq90_test.jpg</code></p>\n\n<p>How can I add, for example, a random string between to the filename? I couldn't find an build-in option for this.</p>\n\n<p>I tried to figure out where the job hash was created, but couldn't find the part in the GitHub repository.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oauth", "rails-api", "trello"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5040850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYvbD.jpg?s=128&g=1", "display_name": "Eduard Garcia", "link": "https://stackoverflow.com/users/5040850/eduard-garcia"}, "is_accepted": false, "score": 0, "last_activity_date": 1598445481, "last_edit_date": 1598445481, "creation_date": 1598445117, "answer_id": 63597764, "question_id": 56127577, "link": "https://stackoverflow.com/questions/56127577/where-i-can-take-correct-api-token-for-requests-to-trello-behalf-on-user-ruby-t/63597764#63597764", "title": "Where I can take correct API token for requests to Trello behalf on user (ruby-trello)", "body": "<p>What I did was implementing a session controller to request and authorize access to user's trello and then call <code>Trello::Client</code> with the authorization params inside the callback method on the controller.</p>\n<p>Check out this:<a href=\"https://gist.github.com/eddygarcas/4b52e588c90e38c9fa944dfe0cb2840d\" rel=\"nofollow noreferrer\">Trello OAuth 1.0 authorization with Ruby </a></p>\n<p>Then inside the authorization method you can call <code>Trello::Client</code> using <code>:oauth_token</code> and <code>:oauth_token_secret</code> from get_access_token call or store them both on the session object and use them anywhere.</p>\n"}], "owner": {"reputation": 119, "user_id": 8319323, "user_type": "registered", "profile_image": "https://graph.facebook.com/1344036448998167/picture?type=large", "display_name": "Anatolii Stupin", "link": "https://stackoverflow.com/users/8319323/anatolii-stupin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1598445481, "creation_date": 1557827500, "last_edit_date": 1557828261, "question_id": 56127577, "link": "https://stackoverflow.com/questions/56127577/where-i-can-take-correct-api-token-for-requests-to-trello-behalf-on-user-ruby-t", "title": "Where I can take correct API token for requests to Trello behalf on user (ruby-trello)", "body": "<p>I am using Ruby on Rails 5.2 and gems: ruby-trello, devise, omniauth-trello.</p>\n\n<p>I want to make authorized requests on behalf of Trello user same as shows here: <a href=\"https://github.com/jeremytregunna/ruby-trello#multiple-users\" rel=\"nofollow noreferrer\">https://github.com/jeremytregunna/ruby-trello#multiple-users</a></p>\n\n<p>Example from git docs:</p>\n\n<pre><code>@client_bob = Trello::Client.new(\n  :consumer_key =&gt; YOUR_CONSUMER_KEY,\n  :consumer_secret =&gt; YOUR_CONSUMER_SECRET,\n  :oauth_token =&gt; \"Bob's access token\",\n  :oauth_token_secret =&gt; \"Bob's access secret\"\n)\n</code></pre>\n\n<p>My steps:</p>\n\n<ol>\n<li>User (Bob) sign in with Trello and get his own oauth_secret and oauth_token</li>\n<li>App creates a Trello::Client for Bob using:\n\n<ul>\n<li>his own oauth data (:oauth_token, :oauth_token_secret)</li>\n<li>I got consumer_key from here: <a href=\"https://trello.com/app-key\" rel=\"nofollow noreferrer\">https://trello.com/app-key</a> (in the top of page, first block with key field)</li>\n<li>consumer_secret was taken from <a href=\"https://trello.com/app-key\" rel=\"nofollow noreferrer\">https://trello.com/app-key</a> too, but from the bottom of page, last block with key secret</li>\n</ul></li>\n</ol>\n\n<p>After this, I'm trying to get any data from Bob's trello account (boards, lists, tasks etc.) but always getting 500 error (invalid token).</p>\n\n<p>Could you explain what I'm doing wrong?\nThank you in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model", "scope"], "answers": [{"comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1557828627, "post_id": 56127604, "comment_id": 98887295, "body": "Why did you get rid of includes? Just to have less code?"}, {"owner": {"reputation": 119, "user_id": 9518688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6133f9b82c427d5078c29abd097dc2?s=128&d=identicon&r=PG", "display_name": "Maueez Ahmed", "link": "https://stackoverflow.com/users/9518688/maueez-ahmed"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1557871380, "post_id": 56127604, "comment_id": 98909108, "body": "includes eager loads the association whereas joins is for inner join. In order to use includes you have to use the references(:user). You can use join or you can use includes(:user) with references(:user) in the query"}], "tags": [], "owner": {"reputation": 119, "user_id": 9518688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6133f9b82c427d5078c29abd097dc2?s=128&d=identicon&r=PG", "display_name": "Maueez Ahmed", "link": "https://stackoverflow.com/users/9518688/maueez-ahmed"}, "is_accepted": false, "score": 0, "last_activity_date": 1557827552, "creation_date": 1557827552, "answer_id": 56127604, "question_id": 56127363, "link": "https://stackoverflow.com/questions/56127363/how-to-limit-results-through-an-association-in-rails/56127604#56127604", "title": "How to limit results through an association in rails", "body": "<p>Change it to. </p>\n\n<pre><code>Rating.joins(:user).merge(User.where.not(confirmed_at: nil))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1557828618, "post_id": 56127668, "comment_id": 98887289, "body": "Why did you get rid of includes? Just to have less code?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1557845217, "post_id": 56127668, "comment_id": 98897285, "body": "Rails &lt; 5 and using <code>includes</code> for @Ursus sake <code>Rating.includes(:user).references(:user).where(User.arel_tab&zwnj;&#8203;le[:confirmed_at].no&zwnj;&#8203;t_eq(nil))</code>"}], "tags": [], "owner": {"reputation": 309, "user_id": 6468274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7s7Rz.jpg?s=128&g=1", "display_name": "devs1993", "link": "https://stackoverflow.com/users/6468274/devs1993"}, "is_accepted": true, "score": 3, "last_activity_date": 1557827756, "creation_date": 1557827756, "answer_id": 56127668, "question_id": 56127363, "link": "https://stackoverflow.com/questions/56127363/how-to-limit-results-through-an-association-in-rails/56127668#56127668", "title": "How to limit results through an association in rails", "body": "<p>Rails 5+ syntax:</p>\n\n<pre><code>Rating.joins(:user).where.not(user: { confirmed_at: nil })\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6171605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51mKs.jpg?s=128&g=1", "display_name": "rake-write-code", "link": "https://stackoverflow.com/users/6171605/rake-write-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56127668, "answer_count": 2, "score": 0, "last_activity_date": 1557828601, "creation_date": 1557826876, "last_edit_date": 1557827366, "question_id": 56127363, "link": "https://stackoverflow.com/questions/56127363/how-to-limit-results-through-an-association-in-rails", "title": "How to limit results through an association in rails", "body": "<p>I have a rating model which belongs to a user and would like to get only the ratings whose users are confirmed.</p>\n\n<pre><code>Rating.includes(:user).merge(User.where.not(confirmed_at: nil))\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 1320, "user_id": 4531923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/749da210afda1b309680b354f019849e?s=128&d=identicon&r=PG", "display_name": "Vincent Rolea", "link": "https://stackoverflow.com/users/4531923/vincent-rolea"}, "edited": false, "score": 0, "creation_date": 1557821863, "post_id": 56125199, "comment_id": 98883600, "body": "try lauching your app in production mode on your compute <code>rails c production</code> to get more information about why your app cannot boot"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1557822051, "post_id": 56125199, "comment_id": 98883694, "body": "<code>require&#39;: cannot load such file -- thin (LoadError)</code> indicates that you are trying to load the <code>thin</code> gem in your application but that is is not in your <code>Gemfile</code> anymore. Did you try to add <code>gem &quot;thin&quot;</code> to your <code>Gemfile</code> and run <code>bundle install</code> again?"}, {"owner": {"reputation": 786, "user_id": 5081713, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/hBirq.png?s=128&g=1", "display_name": "Manny Quintanilla", "link": "https://stackoverflow.com/users/5081713/manny-quintanilla"}, "reply_to_user": {"reputation": 1320, "user_id": 4531923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/749da210afda1b309680b354f019849e?s=128&d=identicon&r=PG", "display_name": "Vincent Rolea", "link": "https://stackoverflow.com/users/4531923/vincent-rolea"}, "edited": false, "score": 0, "creation_date": 1557822420, "post_id": 56125199, "comment_id": 98883875, "body": "@VincentRolea this is the error I get:  rails c production /Users/donwydens/.rvm/gems/ruby-2.5.0/gems/railties-5.2.3/li&zwnj;&#8203;b/rails/application.&zwnj;&#8203;rb:585:in <code>validate_secret_key_base&#39;: Missing </code>secret_key_base` for &#39;production&#39; environment, set this string with <code>rails credentials:edit</code> (ArgumentError)"}, {"owner": {"reputation": 786, "user_id": 5081713, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/hBirq.png?s=128&g=1", "display_name": "Manny Quintanilla", "link": "https://stackoverflow.com/users/5081713/manny-quintanilla"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1557822713, "post_id": 56125199, "comment_id": 98884055, "body": "@spickermann I just added the gem to my Gemfile and it loaded! What exactly is the Thing Gem? Ruby Gem website does not have a home page - links to a dead link... thanks again"}, {"owner": {"reputation": 1320, "user_id": 4531923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/749da210afda1b309680b354f019849e?s=128&d=identicon&r=PG", "display_name": "Vincent Rolea", "link": "https://stackoverflow.com/users/4531923/vincent-rolea"}, "edited": false, "score": 0, "creation_date": 1557823397, "post_id": 56125199, "comment_id": 98884392, "body": "Thanks for reporting the error. This is pretty self explanatory, it looks like you don&#39;t have any rails secret key base, try having a look here: <a href=\"https://stackoverflow.com/questions/18556955/heroku-config-secret-key-base-error\" title=\"heroku config secret key base error\">stackoverflow.com/questions/18556955/&hellip;</a>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1557823643, "post_id": 56125199, "comment_id": 98884501, "body": "@ManuelQuintanilla <code>thin</code> is a webserver like <code>puma</code> many others. I wrote a proper answer because my comment seems to have solved your issue."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1557823549, "creation_date": 1557823549, "answer_id": 56126339, "question_id": 56125199, "link": "https://stackoverflow.com/questions/56125199/rails-app-herokurouter-at-error-code-h10-desc-app-crashed/56126339#56126339", "title": "RAILS APP : heroku[router]: at=error code=H10 desc=&quot;App crashed&quot;", "body": "<p>The error message </p>\n\n<pre><code>require': cannot load such file -- thin (LoadError) \n</code></pre>\n\n<p>indicates that you are trying to load the <a href=\"https://github.com/macournoyer/thin/\" rel=\"nofollow noreferrer\"><code>thin</code> gem</a> in your application but that is is not in your referenced in you <code>Gemfile</code> \u2013 Perhaps you installed it manually in your development machine or the code that raises the error runs only on the production environment. </p>\n\n<p>Just add the <code>thin</code> gem to you <code>Gemfile</code></p>\n\n<pre><code>gem 'thin'\n</code></pre>\n\n<p>run <code>bundle install</code> again and redeploy the changes to Heroku.</p>\n"}], "owner": {"reputation": 786, "user_id": 5081713, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/hBirq.png?s=128&g=1", "display_name": "Manny Quintanilla", "link": "https://stackoverflow.com/users/5081713/manny-quintanilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557823549, "creation_date": 1557819436, "question_id": 56125199, "link": "https://stackoverflow.com/questions/56125199/rails-app-herokurouter-at-error-code-h10-desc-app-crashed", "title": "RAILS APP : heroku[router]: at=error code=H10 desc=&quot;App crashed&quot;", "body": "<p>I'm trying to launch my rails app from my local computer to HEROKU. I've searched on stackoverflow but I can't seem to find information about this issue - Some say it's a profile and others say it's a package.json file. None of it actually worked - is there something I'm missing?</p>\n\n<p><strong>Gem File</strong></p>\n\n<pre><code>group :development do \n# Use sqlite3 as the database for Active Record\n  gem 'sqlite3'\nend\n\ngroup :production do\n  gem 'pg'\n  gem 'rails_12factor'\nend\n</code></pre>\n\n<p><strong>Heroku Logs --Tail</strong></p>\n\n<pre><code>2019-05-14T07:31:46.981736+00:00 heroku[web.1]: State changed from crashed to starting\n2019-05-14T07:31:50.681385+00:00 heroku[web.1]: Starting process with command `bundle exec rails server thin -p 18879 -e production`\n2019-05-14T07:31:55.137458+00:00 heroku[web.1]: State changed from starting to crashed\n2019-05-14T07:31:55.106359+00:00 heroku[web.1]: Process exited with status 1\n2019-05-14T07:31:55.019384+00:00 app[web.1]: /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:33:in `require': cannot load such file -- thin (LoadError)\n2019-05-14T07:31:55.019424+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `block in require'\n2019-05-14T07:31:55.019426+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in `load_dependency'\n2019-05-14T07:31:55.019428+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `require'\n2019-05-14T07:31:55.019438+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/handler/thin.rb:1:in `&lt;top (required)&gt;'\n2019-05-14T07:31:55.019440+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require'\n2019-05-14T07:31:55.019446+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n2019-05-14T07:31:55.019448+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in `register'\n2019-05-14T07:31:55.019450+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require_with_bootsnap_lfi'\n2019-05-14T07:31:55.019451+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'\n2019-05-14T07:31:55.019453+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `block in require'\n2019-05-14T07:31:55.019458+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in `load_dependency'\n2019-05-14T07:31:55.019460+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `require'\n2019-05-14T07:31:55.019467+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/handler.rb:20:in `const_get'\n2019-05-14T07:31:55.019469+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/handler.rb:20:in `block in get'\n2019-05-14T07:31:55.019470+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/handler.rb:20:in `each'\n2019-05-14T07:31:55.019472+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/handler.rb:20:in `inject'\n2019-05-14T07:31:55.019473+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/handler.rb:20:in `get'\n2019-05-14T07:31:55.019475+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/server.rb:301:in `server'\n2019-05-14T07:31:55.019477+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/commands/server/server_command.rb:105:in `use_puma?'\n2019-05-14T07:31:55.019482+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/commands/server/server_command.rb:76:in `print_boot_information'\n2019-05-14T07:31:55.019484+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/commands/server/server_command.rb:47:in `start'\n2019-05-14T07:31:55.019486+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/commands/server/server_command.rb:147:in `block in perform'\n2019-05-14T07:31:55.019487+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/commands/server/server_command.rb:142:in `tap'\n2019-05-14T07:31:55.019489+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/commands/server/server_command.rb:142:in `perform'\n2019-05-14T07:31:55.019490+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'\n2019-05-14T07:31:55.019492+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'\n2019-05-14T07:31:55.019494+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'\n2019-05-14T07:31:55.019495+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/command/base.rb:65:in `perform'\n2019-05-14T07:31:55.019500+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/command.rb:46:in `invoke'\n2019-05-14T07:31:55.019502+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n2019-05-14T07:31:55.019504+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require'\n2019-05-14T07:31:55.019505+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n2019-05-14T07:31:55.019507+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in `register'\n2019-05-14T07:31:55.019508+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require_with_bootsnap_lfi'\n2019-05-14T07:31:55.019510+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'\n2019-05-14T07:31:55.019512+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `block in require'\n2019-05-14T07:31:55.019513+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in `load_dependency'\n2019-05-14T07:31:55.019515+00:00 app[web.1]: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `require'\n2019-05-14T07:31:55.019522+00:00 app[web.1]: from bin/rails:9:in `&lt;main&gt;'\n2019-05-14T07:31:55.022993+00:00 app[web.1]: Exiting\n2019-05-14T07:31:56.410195+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=warm-harbor-88564.herokuapp.com request_id=5926f399-ce9e-4671-b545-de0eb7dca827 fwd=\"66.229.63.152\" dyno= connect= service= status=503 bytes= protocol=https\n2019-05-14T07:31:57.780810+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=warm-harbor-88564.herokuapp.com request_id=7b9663f4-abe7-4281-a41d-f867dc8e5aad fwd=\"66.229.63.152\" dyno= connect= service= status=503 bytes= protocol=https\n</code></pre>\n"}, {"tags": ["ruby", "libgosu"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9888189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F1qG5FTcAyc/AAAAAAAAAAI/AAAAAAAAAT4/Mfs8OtlOZEI/photo.jpg?sz=128", "display_name": "Elham Najeebullah", "link": "https://stackoverflow.com/users/9888189/elham-najeebullah"}, "edited": false, "score": 0, "creation_date": 1557824880, "post_id": 56126330, "comment_id": 98885132, "body": "How about when hover on the button and the color change without clicking the mouse?"}, {"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "reply_to_user": {"reputation": 21, "user_id": 9888189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F1qG5FTcAyc/AAAAAAAAAAI/AAAAAAAAAT4/Mfs8OtlOZEI/photo.jpg?sz=128", "display_name": "Elham Najeebullah", "link": "https://stackoverflow.com/users/9888189/elham-najeebullah"}, "edited": false, "score": 0, "creation_date": 1557836884, "post_id": 56126330, "comment_id": 98891970, "body": "@IlhamRezaie yes, if you move the <code>if statement</code> into a new method called `update, it will work during mouse over. Try it and tell me"}], "tags": [], "owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "is_accepted": true, "score": 0, "last_activity_date": 1557836957, "last_edit_date": 1557836957, "creation_date": 1557823519, "answer_id": 56126330, "question_id": 56124184, "link": "https://stackoverflow.com/questions/56124184/the-button-should-have-a-black-border-around-it-when-the-mouse-is-moved-over-it/56126330#56126330", "title": "The button should have a black border around it when the mouse is moved over it to highlight it", "body": "<p>If you want background color change on mouse over, you must move your color change code from <code>button_down</code> to a new <code>update</code> method, like this:</p>\n\n<pre><code>class DemoWindow &lt; Gosu::Window\n\n  # set up variables and attributes\n  def initialize\n    super(WIN_WIDTH, WIN_HEIGHT, false)\n    @background = Gosu::Color::WHITE\n    @button_font = Gosu::Font.new(20)\n    @info_font = Gosu::Font.new(10)\n    @locs = [60,60]\n  end\n\n  # Draw the background, the button with 'click me' text and text\n  # showing the mouse coordinates\n  def draw\n    # Draw background color\n    Gosu.draw_rect(0, 0, WIN_WIDTH, WIN_HEIGHT, @background, ZOrder::BACKGROUND, mode=:default)\n    # Draw the button\n    Gosu.draw_rect(50, 50, 100, 50, Gosu::Color::GREEN, ZOrder::TOP, mode=:default)\n    # Draw the button text\n    @button_font.draw(\"Click me\", 93, 73, ZOrder::MIDDLE, 1.0, 1.0, Gosu::Color::BLACK)\n    # Draw the mouse position information\n    @info_font.draw_markup(\"mouse_x: #{@locs[0]}\", 0, 350, ZOrder::TOP, 1.0, 1.0, Gosu::Color::BLACK)\n    @info_font.draw_markup(\"mouse_y: #{@locs[1]}\", 0, 370, ZOrder::TOP, 1.0, 1.0, Gosu::Color::BLACK)\n  end\n\n\n\n  # this is called by Gosu to see if should show the cursor (or mouse)\n  def needs_cursor?\n    true\n  end\n\n  # If the button area (rectangle) has been clicked on change the background color\n  # also store the mouse_x and mouse_y attributes that we 'inherit' from Gosu\n  # you will learn about inheritance in the OOP unit - for now just accept that\n  # these are available and filled with the latest x and y locations of the mouse click.\n\n  def mouse_over_button(mouse_x, mouse_y)\n    mouse_x.between?(50, 150) &amp;&amp; mouse_y.between?(50, 100)\n  end\n\n\n # &lt;----------- ADD THIS METHOD -----------&gt;\n    def update\n      if mouse_over_button(mouse_x, mouse_y)\n        @background = Gosu::Color::YELLOW\n      else\n        @background = Gosu::Color::WHITE\n     end\n    end\n\n\n  # Where is mouse_x and mouse_y defined\n\n  def button_down(id)\n    case id\n    when Gosu::MsLeft\n      @locs = [mouse_x, mouse_y]\n    end\n  end\nend\n\n# Lets get started!\nDemoWindow.new.show\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9888189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F1qG5FTcAyc/AAAAAAAAAAI/AAAAAAAAAT4/Mfs8OtlOZEI/photo.jpg?sz=128", "display_name": "Elham Najeebullah", "link": "https://stackoverflow.com/users/9888189/elham-najeebullah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1064, "favorite_count": 1, "accepted_answer_id": 56126330, "answer_count": 1, "score": 0, "last_activity_date": 1557836957, "creation_date": 1557815121, "last_edit_date": 1557819042, "question_id": 56124184, "link": "https://stackoverflow.com/questions/56124184/the-button-should-have-a-black-border-around-it-when-the-mouse-is-moved-over-it", "title": "The button should have a black border around it when the mouse is moved over it to highlight it", "body": "<p>The button should be highlighted when the mouse moves over it\n (i.e it should have a black border around the outside)\nThis is how border should look like when mouse is moved around it. <a href=\"https://i.stack.imgur.com/OR1qW.png\" rel=\"nofollow noreferrer\">Button</a>\nMust display a colored border that 'highlights' the button when the mouse moves over it</p>\n\n<pre><code>module ZOrder\n  BACKGROUND, MIDDLE, TOP = *0..2\nend\n\n# Global constants\nWIN_WIDTH = 640\nWIN_HEIGHT = 400\n\nclass DemoWindow &lt; Gosu::Window\n\n  # set up variables and attributes\n  def initialize\n    super(WIN_WIDTH, WIN_HEIGHT, false)\n    @background = Gosu::Color::WHITE\n    @button_font = Gosu::Font.new(20)\n    @info_font = Gosu::Font.new(10)\n    @locs = [60,60]\n  end\n\n  # Draw the background, the button with 'click me' text and text\n  # showing the mouse coordinates\n  def draw\n    # Draw background color\n    Gosu.draw_rect(0, 0, WIN_WIDTH, WIN_HEIGHT, @background, ZOrder::BACKGROUND, mode=:default)\n    # Draw the button\n    Gosu.draw_rect(50, 50, 100, 50, Gosu::Color::GREEN, ZOrder::TOP, mode=:default)\n    # Draw the button text\n    @button_font.draw(\"Click me\", 93, 73, ZOrder::MIDDLE, 1.0, 1.0, Gosu::Color::BLACK)\n    # Draw the mouse position information\n    @info_font.draw_markup(\"mouse_x: #{@locs[0]}\", 0, 350, ZOrder::TOP, 1.0, 1.0, Gosu::Color::BLACK)\n    @info_font.draw_markup(\"mouse_y: #{@locs[1]}\", 0, 370, ZOrder::TOP, 1.0, 1.0, Gosu::Color::BLACK)\n  end\n\n\n\n  # this is called by Gosu to see if should show the cursor (or mouse)\n  def needs_cursor?\n    true\n  end\n\n  # If the button area (rectangle) has been clicked on change the background color\n  # also store the mouse_x and mouse_y attributes that we 'inherit' from Gosu\n  # you will learn about inheritance in the OOP unit - for now just accept that\n  # these are available and filled with the latest x and y locations of the mouse click.\n\n  def mouse_over_button(mouse_x, mouse_y)\n    mouse_x.between?(50, 150) &amp;&amp; mouse_y.between?(50, 100)\n  end\n\n  # Where is mouse_x and mouse_y defined\n\n  def button_down(id)\n    case id\n    when Gosu::MsLeft\n      @locs = [mouse_x, mouse_y]\n      if mouse_over_button(mouse_x, mouse_y)\n        @background = Gosu::Color::YELLOW\n      else\n        @background = Gosu::Color::WHITE\n      end\n    end\n  end\nend\n\n# Lets get started!\nDemoWindow.new.show\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "minitest"], "comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557814439, "post_id": 56123947, "comment_id": 98880005, "body": "At least in RSPEC you can define groups of tests, which you can then call when running <code>bundle exec rspec</code>, I&#39;m sure Minitest has comparable functionality."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557814561, "post_id": 56123947, "comment_id": 98880047, "body": "It seems there&#39;s a separate gem that allows you to set tags... this would enable you to run only selected tests. I think this is a more perferable approach to using lists of tests in a file: <a href=\"https://stackoverflow.com/questions/51913064/ruby-how-to-use-tags-within-examples-for-minitest\" title=\"ruby how to use tags within examples for minitest\">stackoverflow.com/questions/51913064/&hellip;</a>"}, {"owner": {"reputation": 544, "user_id": 11113293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nbpx9aBwJdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkcE5ah2CHeBbTXtfTCmK0U2SoEA/mo/photo.jpg?sz=128", "display_name": "Mohsin Sethi", "link": "https://stackoverflow.com/users/11113293/mohsin-sethi"}, "reply_to_user": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557819157, "post_id": 56123947, "comment_id": 98882290, "body": "I think a file is more preferable approach as in order to run all tests all we have to do is make file empty. Searching and removing tags will add extra effort when we want to run all tests."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557825915, "post_id": 56123947, "comment_id": 98885680, "body": "Well, you could always create a bash script that loops through the file and runs the minitests for the entries."}, {"owner": {"reputation": 544, "user_id": 11113293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nbpx9aBwJdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkcE5ah2CHeBbTXtfTCmK0U2SoEA/mo/photo.jpg?sz=128", "display_name": "Mohsin Sethi", "link": "https://stackoverflow.com/users/11113293/mohsin-sethi"}, "reply_to_user": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557826391, "post_id": 56123947, "comment_id": 98885974, "body": "That will run multiple <code>RAILS_ENV=test rails test</code> which in result will have multiple outputs whereas I want a solution to run just 1 <code>RAILS_ENV=test rails test</code> so that I have 1 standard minitest output at the end e.g. passed: 123, failed: 123 and so on"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1557828310, "post_id": 56123947, "comment_id": 98887095, "body": "<code>rails test</code> accepts a list of file names or a pattern as argument. Check out <a href=\"https://github.com/rails/rails/blob/5-2-stable/railties/lib/rails/test_unit/runner.rb\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/5-2-stable/railties/lib/rails/&hellip;</a>"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557832530, "post_id": 56123947, "comment_id": 98889443, "body": "Indeed... and combine that with a bash script, et voila!"}], "answers": [{"tags": [], "owner": {"reputation": 936, "user_id": 1947079, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f92c7e88b2c02061df969af94fbeef8?s=128&d=identicon&r=PG", "display_name": "Gray Kemmey", "link": "https://stackoverflow.com/users/1947079/gray-kemmey"}, "is_accepted": false, "score": 0, "last_activity_date": 1600480878, "creation_date": 1600480878, "answer_id": 63964585, "question_id": 56123947, "link": "https://stackoverflow.com/questions/56123947/how-to-run-a-custom-list-of-minitest-tests-in-rails/63964585#63964585", "title": "How to run a custom list of minitest tests in Rails", "body": "<p>You could copy how rails is already defining their tasks like <code>test:system</code> <a href=\"https://github.com/rails/rails/blob/v6.0.3.3/railties/lib/rails/test_unit/testing.rake\" rel=\"nofollow noreferrer\">here</a>:</p>\n<pre><code>namespace :test do\n  desc &quot;Run tests from file&quot;\n  task from_file: &quot;test:prepare&quot; do\n    $: &lt;&lt; &quot;test&quot;\n\n    Rails::TestUnit::Runner.rake_run(\n      File.read(Rails.root.join(&quot;tests_to_run.txt&quot;)).lines.map(&amp;:chomp)\n    )\n  end\nend\n</code></pre>\n<pre><code>$ bundle exec rails test:from_file\n</code></pre>\n"}], "owner": {"reputation": 544, "user_id": 11113293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nbpx9aBwJdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkcE5ah2CHeBbTXtfTCmK0U2SoEA/mo/photo.jpg?sz=128", "display_name": "Mohsin Sethi", "link": "https://stackoverflow.com/users/11113293/mohsin-sethi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1600480878, "creation_date": 1557813980, "question_id": 56123947, "link": "https://stackoverflow.com/questions/56123947/how-to-run-a-custom-list-of-minitest-tests-in-rails", "title": "How to run a custom list of minitest tests in Rails", "body": "<p>Say I have a file containing name of test files to run tests from and It can contain specific test names too. If test file contains that specific test, run only that test from the file containing the test and run all tests from other test files.</p>\n\n<p>I use Codebuild to run tests for our application but Codebuild does not provide a way to run only specific tests. So I am replacing bin/rails test command on codebuild with our custom rake task. That rake task will check for a file in our system containing list of tests to run and If it finds the file it run only those tests other normal bin/rails test</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1557816214, "post_id": 56122956, "comment_id": 98880821, "body": "Why the <code>map</code>? IMO it is useless in this case and actually makes every think slower."}, {"owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1557816969, "post_id": 56122956, "comment_id": 98881215, "body": "@spickermann you&#39;re right, didn&#39;t notice it. Just copied the line @HKeys34 had and changed <code>include?</code> to <code>index</code>. Updating it..."}], "tags": [], "owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "is_accepted": true, "score": 1, "last_activity_date": 1557816977, "last_edit_date": 1557816977, "creation_date": 1557807538, "answer_id": 56122956, "question_id": 56122921, "link": "https://stackoverflow.com/questions/56122921/searching-array-for-a-value/56122956#56122956", "title": "Searching Array for a Value", "body": "<p>You're looking for <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-index\" rel=\"nofollow noreferrer\"><code>Array#index</code></a>, which returns <code>nil</code> in case the value is not part of the array.</p>\n\n<p>To return <code>-1</code> when the value is not found:</p>\n\n<pre><code>index = array.index(search_value) || -1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5644, "user_id": 9908141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/seDql.jpg?s=128&g=1", "display_name": "Imran Ahmad", "link": "https://stackoverflow.com/users/9908141/imran-ahmad"}, "is_accepted": false, "score": 2, "last_activity_date": 1557816283, "last_edit_date": 1557816283, "creation_date": 1557808094, "answer_id": 56123017, "question_id": 56122921, "link": "https://stackoverflow.com/questions/56122921/searching-array-for-a-value/56123017#56123017", "title": "Searching Array for a Value", "body": "<p>You simply can use <a href=\"http://ruby-doc.org//core-2.2.0/Array.html#method-i-index\" rel=\"nofollow noreferrer\">array.index(element)</a></p>\n\n<p>Example:</p>\n\n<pre><code>array = [1, 2, 3, 4, 5]\narray.index(5) || -1 # returns 4 (because 5 is at 4th index)\narray.index(6) || -1 # returns -1 \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 474, "user_id": 7881015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fstm8cSRSI/AAAAAAAAAAI/AAAAAAAAAd4/i75UzXckPQE/photo.jpg?sz=128", "display_name": "Ho Zong", "link": "https://stackoverflow.com/users/7881015/ho-zong"}, "edited": false, "score": 0, "creation_date": 1557811601, "post_id": 56123401, "comment_id": 98878973, "body": "You need to convert the <code>search_value</code> into Integer with <code>to_i</code>, so you can have them as int the array too."}, {"owner": {"reputation": 474, "user_id": 7881015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fstm8cSRSI/AAAAAAAAAAI/AAAAAAAAAd4/i75UzXckPQE/photo.jpg?sz=128", "display_name": "Ho Zong", "link": "https://stackoverflow.com/users/7881015/ho-zong"}, "edited": false, "score": 0, "creation_date": 1557812179, "post_id": 56123401, "comment_id": 98879147, "body": "<a href=\"https://tio.run/##KypNqvz/P7GoKLFSwVYh2lBHwUhHwTiWqzg1sSg5I74sMac0FSiRnlpSrJeckZ9boFeSH5/JlZmXkloBFAdr1APzNJC1aCrU1CjoGnIVlJYUKyi55ZfmpSgoKWgrIKsBmVQMFFNSSCwBS4KNAYv@/28EAA\" title=\"Ruby \u2013 Try It Online\" rel=\"nofollow noreferrer\">Try it online!</a>"}], "tags": [], "owner": {"reputation": 452, "user_id": 8466844, "user_type": "registered", "profile_image": "https://graph.facebook.com/479986619048559/picture?type=large", "display_name": "Nam V. Do", "link": "https://stackoverflow.com/users/8466844/nam-v-do"}, "is_accepted": false, "score": 0, "last_activity_date": 1557810788, "creation_date": 1557810788, "answer_id": 56123401, "question_id": 56122921, "link": "https://stackoverflow.com/questions/56122921/searching-array-for-a-value/56123401#56123401", "title": "Searching Array for a Value", "body": "<pre class=\"lang-rb prettyprint-override\"><code>array = [\"1\", \"2\", \"3\"]\nsearch_value = gets.chomp\nindex = array.index(search_value) || -1\nputs \"Found \" + search_value + \" at \" + index.to_s\n// Type 2\n// Expected output: Found 2 at 1\n</code></pre>\n\n<p>I don't know why <code>array = [1, 2, 3]</code> doesn't work correctly but I try <code>array = [\"1\", \"2\", \"3\"]</code> instead it works. Hope someone can explain a little bit.</p>\n"}], "owner": {"reputation": 31, "user_id": 11496221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec620776ecc41fc7be6822a6cdafc19c?s=128&d=identicon&r=PG&f=1", "display_name": "HKeys34", "link": "https://stackoverflow.com/users/11496221/hkeys34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 56122956, "answer_count": 3, "score": 0, "last_activity_date": 1557820898, "creation_date": 1557807248, "question_id": 56122921, "link": "https://stackoverflow.com/questions/56122921/searching-array-for-a-value", "title": "Searching Array for a Value", "body": "<p>I am trying to search an Array for a value, if that value is found then return that the value is found and the index at which it was found. If the value is not found then the index returned is -1</p>\n\n<pre><code>array = [1, 2, 3]\nsearch_value = gets.chomp\narray.map.include?(search_value) || -1\n\nif index != -1\nputs \"Found \" + search_value + \" at \" + index.to_s\n</code></pre>\n\n<p>The expected result is <code>Found 2 at 1</code> instead I receive <code>Found 2 at True</code>, I understand why this is happening but I don't know how to fix it</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "smtp"], "comments": [{"owner": {"reputation": 54, "user_id": 11378443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7309052c7afed1a17f2670858200ed09?s=128&d=identicon&r=PG&f=1", "display_name": "NensiMakawana", "link": "https://stackoverflow.com/users/11378443/nensimakawana"}, "edited": false, "score": 0, "creation_date": 1557830722, "post_id": 56122806, "comment_id": 98888458, "body": "Maybe help this link <a href=\"https://stackoverflow.com/questions/5998758/email-with-rails-3-and-heroku-netsmtpsyntaxerror-501-syntax-error\" title=\"email with rails 3 and heroku netsmtpsyntaxerror 501 syntax error\">stackoverflow.com/questions/5998758/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 463, "user_id": 3527552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001213035230/picture?type=large", "display_name": "Tushar Pal", "link": "https://stackoverflow.com/users/3527552/tushar-pal"}, "is_accepted": false, "score": 1, "last_activity_date": 1557812589, "creation_date": 1557812589, "answer_id": 56123694, "question_id": 56122806, "link": "https://stackoverflow.com/questions/56122806/netsmtpsyntaxerror-501-invalid-command-or-cannot-parse-from-address/56123694#56123694", "title": "Net::SMTPSyntaxError &#183; 501 Invalid command or cannot parse from address", "body": "<p>Net::SMTPSyntaxError 501 error is thrown if you have bad sender address. Sender address should be an email address. Any fake email will also do. like: abc@fakemail.com</p>\n"}], "owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1304, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557812589, "creation_date": 1557806225, "question_id": 56122806, "link": "https://stackoverflow.com/questions/56122806/netsmtpsyntaxerror-501-invalid-command-or-cannot-parse-from-address", "title": "Net::SMTPSyntaxError &#183; 501 Invalid command or cannot parse from address", "body": "<p>I have read some discussion, Q&amp;A about the error w/c is thrown if sender email is invalid, </p>\n\n<p>but I'm not sure if\nthis error <code>Net::SMTPSyntaxError \u00b7 501</code> is for both invalid email <code>from</code> &amp; <code>to</code>.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "ruby-on-rails-4", "rubygems"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557801128, "post_id": 56122191, "comment_id": 98876770, "body": "I can tell you that if you replace <code>@@</code> with single <code>@</code> this will work"}, {"owner": {"reputation": 569, "user_id": 3505472, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/b86562198f24fc96564317617d18c0f1?s=128&d=identicon&r=PG&f=1", "display_name": "Manish J", "link": "https://stackoverflow.com/users/3505472/manish-j"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557801334, "post_id": 56122191, "comment_id": 98876799, "body": "@maxpleaner- I have tried but i am getting empty string in ViewTrait module."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557801634, "post_id": 56122191, "comment_id": 98876857, "body": "Note that <code>class &lt;&lt; self; include ViewTrait; end</code> is the same as <code>extend ViewTrait</code>.  See <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-extend\" rel=\"nofollow noreferrer\">Object#extend</a>."}, {"owner": {"reputation": 569, "user_id": 3505472, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/b86562198f24fc96564317617d18c0f1?s=128&d=identicon&r=PG&f=1", "display_name": "Manish J", "link": "https://stackoverflow.com/users/3505472/manish-j"}, "edited": false, "score": 0, "creation_date": 1557802652, "post_id": 56122191, "comment_id": 98877053, "body": "@CarySwoveland- issue is accessing class variable into other module method."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1557804306, "post_id": 56122191, "comment_id": 98877354, "body": "isn&#39;t <code>@@endpoint</code> in the ViewTrait module is saying <code>self.@@endpoint</code> and in this case, wouldn&#39;t self be the ViewTrait module? If you call the correct receiver it should work?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557809038, "post_id": 56122191, "comment_id": 98878315, "body": "Yes, I know. It&#39;s usual to invoke <code>include</code> on the singleton class rather than simply using <code>extend</code>, so I thought you might not know about <code>extend</code>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1557826816, "post_id": 56122191, "comment_id": 98886231, "body": "Your question said &quot;class instance variable&quot;, but <code>@@endpoint</code> (with two &quot;at&quot; signs) is a <i>&quot;class variable&quot;</i> (I&#39;ve changed that accordingly). A <i>&quot;class <b>instance</b> variable&quot;</i> would be <code>@endpoint</code> (single &quot;at&quot; sign) in the scope of the class. You most likely want the latter anyway (or maybe a constant), because class variables have issues with inheritance."}, {"owner": {"reputation": 569, "user_id": 3505472, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/b86562198f24fc96564317617d18c0f1?s=128&d=identicon&r=PG&f=1", "display_name": "Manish J", "link": "https://stackoverflow.com/users/3505472/manish-j"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1557835616, "post_id": 56122191, "comment_id": 98891177, "body": "@Stefan - I have fixed it.Thanks for joining the discussion. and I understand what you trying to say."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557858021, "post_id": 56122191, "comment_id": 98903829, "body": "@ManishJ I just tested it and you answer <i>does</i> work but so does replacing <code>@@</code> with <code>@</code> in your original code (using a class level instance variable not a class variable)"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557858286, "post_id": 56122191, "comment_id": 98903968, "body": "I&#39;m not sure exactlly why but it seems class variables have some wierd behavior where you need to use <code>self.class_variable_get</code> in this case. Class-level instance variables behave more &#39;normally&#39; which is why I advise them, and they do function the same for your purpose i think"}], "answers": [{"tags": [], "owner": {"reputation": 569, "user_id": 3505472, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/b86562198f24fc96564317617d18c0f1?s=128&d=identicon&r=PG&f=1", "display_name": "Manish J", "link": "https://stackoverflow.com/users/3505472/manish-j"}, "is_accepted": true, "score": 0, "last_activity_date": 1557804869, "creation_date": 1557804869, "answer_id": 56122647, "question_id": 56122191, "link": "https://stackoverflow.com/questions/56122191/how-to-get-class-variable-into-module/56122647#56122647", "title": "How to get class variable into module", "body": "<p>in ViewTrait I have replaced <code>@@endpoint</code> which <code>self.class_variable_get(:@@endpoint)</code> and I can access the class Variable into the module. hope this will help others.</p>\n"}], "owner": {"reputation": 569, "user_id": 3505472, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/b86562198f24fc96564317617d18c0f1?s=128&d=identicon&r=PG&f=1", "display_name": "Manish J", "link": "https://stackoverflow.com/users/3505472/manish-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 56122647, "answer_count": 1, "score": 0, "last_activity_date": 1557826102, "creation_date": 1557800741, "last_edit_date": 1557826102, "question_id": 56122191, "link": "https://stackoverflow.com/questions/56122191/how-to-get-class-variable-into-module", "title": "How to get class variable into module", "body": "<p>I am unable to overwrite the module variable by class variable.</p>\n\n<pre><code>module Main\n  class Traks\n    @@endpoint ='/trakings'\n    class &lt;&lt; self\n      include ViewTrait\n    end\n  end \nend\n</code></pre>\n\n<p>My Trait Module </p>\n\n<pre><code>module Main\n  module ViewTrait\n    def view(id:, options: \"\")\n      Response::new(\"#{@@endpoint}/#{id}#{options}\").resource(id: id).get\n    end\n  end\nend\n</code></pre>\n\n<p>in ViewTrait I cannot access <code>@@endponint</code> which I have already defined in my Traks class. anyone can let me what I went wrong.</p>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": true, "score": 2, "last_activity_date": 1557799293, "creation_date": 1557799293, "answer_id": 56122033, "question_id": 56121980, "link": "https://stackoverflow.com/questions/56121980/array-cant-be-coerced-into-integer-typeerror/56122033#56122033", "title": "Array can&#39;t be coerced into Integer (TypeError)", "body": "<p>the input is a matrix like <code>[[11, 2, 4], [4, 5, 6], [10, 8, -12]]</code></p>\n\n<p>I guess you want to change the matrix to an array before pass to <code>left_to_right</code>. you can use <code>flatten</code></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def diagonalDifference(arr)\n    arr.each do |e|\n      p e\n    end\n    the_arr = arr.flatten\n    left_to_right(3, the_arr)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1557811936, "last_edit_date": 1557811936, "creation_date": 1557811069, "answer_id": 56123450, "question_id": 56121980, "link": "https://stackoverflow.com/questions/56121980/array-cant-be-coerced-into-integer-typeerror/56123450#56123450", "title": "Array can&#39;t be coerced into Integer (TypeError)", "body": "<p>The problem appears to be <a href=\"http://allhackerranksolutions.blogspot.com/2016/02/diagonal-difference-hacker-rank-solution.html\" rel=\"nofollow noreferrer\">this one</a>.</p>\n\n<p>One could compute the desired value as follows.</p>\n\n<pre><code>def diagonal_difference(arr)\n (arr.each_index.sum { |i| arr[i][i] - arr[i][-i-1]}).abs\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>arr = [\n  [11, 2,   4],\n  [ 4, 5,   6],\n  [10, 8, -12]\n]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>diagonal_difference(arr)\n  #=&gt; 15\n</code></pre>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "accepted_answer_id": 56122033, "answer_count": 2, "score": 0, "last_activity_date": 1557811936, "creation_date": 1557798766, "question_id": 56121980, "link": "https://stackoverflow.com/questions/56121980/array-cant-be-coerced-into-integer-typeerror", "title": "Array can&#39;t be coerced into Integer (TypeError)", "body": "<p>I was able to get this code working locally but it fails in hacker rank\nI've tried many combinations but must be missing something.\nI don't understand why <code>sum += x</code> give the array error based on the output</p>\n\n<p>I get this error:</p>\n\n<p>solution.rb:24:in `+': Array can't be coerced into Integer (TypeError)</p>\n\n<pre><code>  def diagonalDifference(arr)\n    arr.each do |e|\n      p e\n    end\n    the_arr = arr.dup\n    left_to_right(3, the_arr)\n  end\n\n  def left_to_right(the_size, the_data)\n    sum = 0\n    (0..the_size-1).each do |diagonal|\n      this_value = (the_size * diagonal) + diagonal\n      p \"v= \" + this_value.to_s\n      x = the_data[this_value]\n      p \"this_sum= \" + x.to_s\n      sum += x  # &lt;-- line 24\n    end\n    sum\n  end\n\nDebug output\n[11, 2, 4]\n[4, 5, 6]\n[10, 8, -12]\n\"v= 0\"\n\"this_sum= [[11, 2, 4], [4, 5, 6], [10, 8, -12]]\"\n\n\narr would be a value such as [1,2,3,9,8,7,-4,-5,-4]\n</code></pre>\n\n<p>Seems like the issue relates to</p>\n\n<pre><code>the_data[this_value]\n</code></pre>\n\n<p>instead of getting a value I seem to get an array perhaps ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1557829734, "post_id": 56121952, "comment_id": 98887892, "body": "You can write that query as <code>LogEntry.select(&#39;id, date, athlete_id, count(*) AS qty&#39;).group(:date, :athlete_id).having(&#39;count(*)&gt; 1&#39;)</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1557845839, "post_id": 56121952, "comment_id": 98897709, "body": "You cannot select the id to find duplicates in this fashion. This would have to be multiple queries becuase <code>id</code> will make the row unique"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557845750, "post_id": 56122976, "comment_id": 98897653, "body": "<code>id</code> will then have to be part of an aggregate function which defeats the point."}, {"owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557869176, "post_id": 56122976, "comment_id": 98908436, "body": "@engineersmnky thanks for pointing that out. I&#39;ve updated the answer accordingly."}], "tags": [], "owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "is_accepted": true, "score": 6, "last_activity_date": 1557869157, "last_edit_date": 1557869157, "creation_date": 1557807702, "answer_id": 56122976, "question_id": 56121952, "link": "https://stackoverflow.com/questions/56121952/trying-to-remove-duplicate-entries-in-database-but-getting-nil-id/56122976#56122976", "title": "trying to remove duplicate entries in database but getting nil id", "body": "<p>Updated answer after @engineersmnky's comment (thanks, missed the grouping).</p>\n\n<p>In order to remove duplicates, you'll have to get the IDs of the duplicate rows. For each duplicate, you'll want N - 1 IDs as one should be left behind.</p>\n\n<p>To get all IDs for each group that has more than one (and thus has duplicates):</p>\n\n<pre><code>SELECT array_agg(id) FROM log_entries GROUP BY date, athlete_id HAVING count(*) &gt; 1\n</code></pre>\n\n<p>Let's leave out the first ID in each group:</p>\n\n<pre><code>SELECT (array_agg(id))[2:] FROM log_entries GROUP BY date, athlete_id HAVING count(*) &gt; 1\n</code></pre>\n\n<p>Next, we need to unnest them so that we get a list of just the IDs we want to delete:</p>\n\n<pre><code>SELECT unnest((array_agg(id))[2:]) FROM log_entries GROUP BY date, athlete_id HAVING count(*) &gt; 1\n</code></pre>\n\n<p>Now, in order to load these in Rails, a simple <code>.where(..)</code> suffices where the ID is in the above constructed result set:</p>\n\n<pre><code>LogEntry.where('id IN (SELECT unnest((array_agg(id))[2:]) FROM log_entries GROUP BY date, athlete_id HAVING count(*) &gt; 1)')\n</code></pre>\n\n<hr>\n\n<p>Original answer:</p>\n\n<p>Your <code>SELECT</code> is not selecting the <code>id</code>. Add <code>id</code> to your query and it should work:</p>\n\n<pre><code>LogEntry.find_by_sql(\"SELECT id, date, athlete_id, count(*) as qty FROM log_entries GROUP BY date, athlete_id HAVING count(*)&gt; 1\")\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 895889, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/lyuGE.jpg?s=128&g=1", "display_name": "Graeme", "link": "https://stackoverflow.com/users/895889/graeme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 56122976, "answer_count": 1, "score": 0, "last_activity_date": 1557869157, "creation_date": 1557798482, "question_id": 56121952, "link": "https://stackoverflow.com/questions/56121952/trying-to-remove-duplicate-entries-in-database-but-getting-nil-id", "title": "trying to remove duplicate entries in database but getting nil id", "body": "<p>I am using a rails find_by_sql query to find duplicate entries but I am having a terrible time removing them because the query returns an array with ids listed as nil. </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>LogEntry.find_by_sql(\"SELECT date, athlete_id, count(*) as qty FROM log_entries GROUP BY date, athlete_id HAVING count(*)&gt; 1\")\n</code></pre>\n\n<p>This returns the following array:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[#&lt;LogEntry id: nil, date: \"2016-06-12\", athlete_id: 49&gt;, #&lt;LogEntry id: nil, date: \"2015-09-05\", athlete_id: nil&gt;, #&lt;LogEntry id: nil, date: \"2015-09-06\", athlete_id: nil&gt;, #&lt;LogEntry id: nil, date: \"2019-05-02\", athlete_id: nil&gt;]\n</code></pre>\n\n<p>When I try and add <code>.each(&amp;:destroy)</code> it does not manage to destroy it because as you can see the ids are listed as nil. What I don't get is how this is even possible? The entries should be able to exist in the table without ids. Is there a problem with my sql query? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "encryption", "openssl", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1557806378, "post_id": 56121913, "comment_id": 98877775, "body": "If their external service implementations are this bad, imagine how badly their internal systems are implemented... <i>shudder</i>..."}], "answers": [{"comments": [{"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 1, "creation_date": 1557799045, "post_id": 56121970, "comment_id": 98876383, "body": "I&#39;m glad it took you only 10 minutes to learn the difference between binary and hexadecimals, but I guess people will have to find out themselves, I see little point in this Q/A."}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 1, "creation_date": 1557799405, "post_id": 56121970, "comment_id": 98876451, "body": "Well we all can&#39;t be Maarten Bodewes on stack overflow. Ya gotta start somewhere."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 1, "creation_date": 1557800428, "post_id": 56121970, "comment_id": 98876630, "body": "True and I was fortunate in the sense that I did have little choice to learn about it on my trusty MSX home computer. However, I&#39;m afraid that the question won&#39;t be found. Beware that MD5 is not considered a good hashing algorithm anymore. The IV should be different if a key is reused, so you should not reuse the <code>temp_token</code>."}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 1, "creation_date": 1557800918, "post_id": 56121970, "comment_id": 98876732, "body": "It&#39;s for a payment processing API that I have no control over. I&#39;m stuck with all their outdated or bad security methodologies. I&#39;ve already found a flaw in their gem where they&#39;re using the hexidigest method, and they&#39;re not reaizing it&#39;s getting truncated (which was fixed in a newer version to raise an error)."}], "tags": [], "owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1557798669, "creation_date": 1557798669, "answer_id": 56121970, "question_id": 56121913, "link": "https://stackoverflow.com/questions/56121913/key-must-be-16-bytes-aes-128-cbc-with-md5-keyiv/56121970#56121970", "title": "&quot;key must be 16 bytes&quot; AES-128 CBC, with MD5 Key+IV", "body": "<p>The problem was I needed to use <code>Digest::MD5.digest</code> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 2180787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4fa4d522aa0342feb0e5f9d5874abb?s=128&d=identicon&r=PG", "display_name": "xofred", "link": "https://stackoverflow.com/users/2180787/xofred"}, "is_accepted": true, "score": 0, "last_activity_date": 1584505732, "creation_date": 1584505732, "answer_id": 60733559, "question_id": 56121913, "link": "https://stackoverflow.com/questions/56121913/key-must-be-16-bytes-aes-128-cbc-with-md5-keyiv/60733559#60733559", "title": "&quot;key must be 16 bytes&quot; AES-128 CBC, with MD5 Key+IV", "body": "<p>I think the root cause is <code>OpenSSL::Cipher::AES#key</code> must take a 16 bytes string as its key. </p>\n\n<pre><code>[27] pry(main)&gt; cipher = OpenSSL::Cipher::AES.new(128, :CBC)\n=&gt; #&lt;OpenSSL::Cipher::AES:0x00007f7f876f1608&gt;\n[28] pry(main)&gt; cipher.encrypt\n=&gt; #&lt;OpenSSL::Cipher::AES:0x00007f7f876f1608&gt;\n[30] pry(main)&gt; cipher.random_key.length\n=&gt; 16\n</code></pre>\n\n<p>It has nothing to do with <code>Digest::MD5.hexdigest</code></p>\n\n<pre><code>[26] pry(main)&gt; key = Digest::MD5.hexdigest('abc').first(16)\n=&gt; \"900150983cd24fb0\"\n[27] pry(main)&gt; cipher = OpenSSL::Cipher::AES.new(128, :CBC)\n=&gt; #&lt;OpenSSL::Cipher::AES:0x00007f7f876f1608&gt;\n[28] pry(main)&gt; cipher.encrypt\n=&gt; #&lt;OpenSSL::Cipher::AES:0x00007f7f876f1608&gt;\n[29] pry(main)&gt; cipher.key = key\n=&gt; \"900150983cd24fb0\"\n</code></pre>\n\n<p>Reference: <a href=\"https://ruby-doc.org/stdlib-2.4.0/libdoc/openssl/rdoc/OpenSSL/Cipher.html\" rel=\"nofollow noreferrer\">OpenSSL::Cipher</a></p>\n"}], "owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1041, "favorite_count": 1, "accepted_answer_id": 60733559, "answer_count": 2, "score": 0, "last_activity_date": 1584505732, "creation_date": 1557798109, "question_id": 56121913, "link": "https://stackoverflow.com/questions/56121913/key-must-be-16-bytes-aes-128-cbc-with-md5-keyiv", "title": "&quot;key must be 16 bytes&quot; AES-128 CBC, with MD5 Key+IV", "body": "<p>I'm interacting with an API that requires me to encrypt something with <code>AES-128</code> in <code>CBC</code> mode.</p>\n\n<p>They said for the key and the IV I need to use a 16-byte MD5 hash of a string they give me.</p>\n\n<p>I've googled for awhile and it looks like all MD5 is 16 bytes, so why does this not work?</p>\n\n<pre><code>  key = Digest::MD5.hexdigest(temp_token)\n  cipher = OpenSSL::Cipher::AES.new(128, :CBC)\n  cipher.encrypt\n  cipher.key = key # ArgumentError: key must be 16 bytes\n  cipher.iv = key # ArgumentError: iv must be 16 bytes\n\n  encrypted = cipher.update(joined_params) + cipher.final\n  Base64.urlsafe_encode64(encrypted)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "optimization"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1557793969, "post_id": 56121318, "comment_id": 98875524, "body": "can you show your products schema and the expected data format ?"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1557796850, "post_id": 56121318, "comment_id": 98876027, "body": "the whole logic of creating a hash and grouping by the <code>status</code> can be simplified to <code>@status_based_data = @q.result.group_by(&amp;:status)</code>. -- About the efficiency problem, I suggest using the DB to do the grouping"}, {"owner": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "reply_to_user": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1557802726, "post_id": 56121318, "comment_id": 98877068, "body": "@Subash this table will have IDs, name, and status that&#39;s it."}, {"owner": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1557802833, "post_id": 56121318, "comment_id": 98877083, "body": "@MrYoshiji ohh. I didn&#39;t know that about DB. so lets say i have a status of pending, complete, and cancelled, then on the DB layer it will group by itself even its nested?"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1557817790, "post_id": 56121318, "comment_id": 98881626, "body": "What is ransack and result?"}, {"owner": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "reply_to_user": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1557846531, "post_id": 56121318, "comment_id": 98898139, "body": "@MikeHeft its a gem for searching data. nothing much."}], "owner": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557792310, "creation_date": 1557792310, "question_id": 56121318, "link": "https://stackoverflow.com/questions/56121318/how-to-optimized-a-created-hash-in-ruby-on-rails", "title": "How to optimized a created hash in ruby on rails", "body": "<p>Can I have some suggestion on how to optimize my query? So I have a query on a joined table and then recreated a new hash based on their status.</p>\n\n<p>this is my controller code. </p>\n\n<pre><code>def index\n\n        # create an empty hash for dynamic data\n        @status_based_data = {}\n        # get all workorder product\n        @q = Product.ransack(params[:q])\n        # loop all workorder product\n        @q.result.each do |data|\n\n          # check status if its a key in stat_based_data\n        if !@status_based_data[data.status]\n           # if not created make that a key with a value of an empty array \n          @status_based_data[data.status] = []\n          # push whole data as a value\n          @status_based_data[data.status].push(data)\n        else\n          # if status key is created just push the data\n          @status_based_data[data.status].push(data)\n     end\n\n  end\n\nend\n\n</code></pre>\n\n<p>View code:</p>\n\n<pre><code>&lt;div&gt;\n  &lt;% @status_based_data.each do |key, value| %&gt;\n\n    &lt;h3&gt;&lt;%= key %&gt;&lt;/h3&gt;\n    &lt;table class=\"table table-bordered admin-report\"&gt;\n      &lt;thead&gt;\n        &lt;tr&gt;\n          &lt;th&gt;Status_id&lt;/th&gt;\n          &lt;th&gt;Status&lt;/th&gt;\n        &lt;/tr&gt;\n      &lt;/thead&gt;\n      &lt;tbody&gt;\n\n        &lt;% value.each do |val|%&gt;\n          &lt;tr&gt;\n            &lt;td&gt; &lt;%=val.id%&gt; &lt;/td&gt;\n            &lt;td&gt; &lt;%=val.status%&gt; &lt;/td&gt;\n          &lt;/tr&gt;\n        &lt;%end%&gt;\n\n      &lt;/tbody&gt;\n    &lt;/table&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>my view has an <code>O(n^2)</code> can you suggest another way of how I can approach this efficiently?</p>\n\n<p>thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "excon"], "answers": [{"tags": [], "owner": {"reputation": 2337, "user_id": 967276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/391f7ae8dd8c10dc323b7fbfe55b71a2?s=128&d=identicon&r=PG", "display_name": "geemus", "link": "https://stackoverflow.com/users/967276/geemus"}, "is_accepted": true, "score": 0, "last_activity_date": 1558014098, "creation_date": 1558014098, "answer_id": 56169998, "question_id": 56121175, "link": "https://stackoverflow.com/questions/56121175/how-can-i-force-close-excon-connection-when-using-chunked-request/56169998#56169998", "title": "How can I force close excon connection when using chunked request", "body": "<p>I don't believe there is a way currently to stop before the chunked response concludes. That being said, it might be possible that you could get the data you want from a head request and avoid the need for a get request?</p>\n"}], "owner": {"reputation": 25, "user_id": 3134686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979f19b181a2be72f08a886cbca4de09?s=128&d=identicon&r=PG&f=1", "display_name": "ahmed", "link": "https://stackoverflow.com/users/3134686/ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 56169998, "answer_count": 1, "score": 0, "last_activity_date": 1558014098, "creation_date": 1557790987, "question_id": 56121175, "link": "https://stackoverflow.com/questions/56121175/how-can-i-force-close-excon-connection-when-using-chunked-request", "title": "How can I force close excon connection when using chunked request", "body": "<p>I am trying to read the first chunk of each image I am requesting to get its mime type and size which I'm able to do.</p>\n\n<p>However, when I use Connection#reset it doesn't kill the connection and keeps downloading next chunks.</p>\n\n<p>I am just wondering is it possible to close the connection after getting the first chunk?</p>\n\n<p>This is my code right now</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>streamer = lambda do |chunk, _remaining_bytes, total_bytes|\n  image_format = MimeMagic.by_magic(chunk)\n  # other code\n  @connection.reset\nend\n\nExcon.defaults[:chunk_size] = 25\n@connection = Excon.new(image_url)\n@connection.get(response_block: streamer)\n\n</code></pre>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 16655, "user_id": 584440, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b5c3b0c74c564105de0415899c0d5999?s=128&d=identicon&r=PG", "display_name": "rubyprince", "link": "https://stackoverflow.com/users/584440/rubyprince"}, "is_accepted": false, "score": 1, "last_activity_date": 1557787804, "last_edit_date": 1557787804, "creation_date": 1557787183, "answer_id": 56120713, "question_id": 56120408, "link": "https://stackoverflow.com/questions/56120408/wait-for-action-to-finish-before-showing-a-modal/56120713#56120713", "title": "Wait for action to finish before showing a modal?", "body": "<p>You will need to add some js to update the partial with new session after going in the controller and also move the code to trigger the modal to the js after updation of the partial. \nAlso, you need to keep the modal div outside the 'outstanding_cars' loop so that we have only one div to update instead of one div for each car (credit to @arieljuod, noticed it only after his answer):</p>\n\n<pre><code>#index.html.erb\n&lt;% @outstanding_cars.each_with_index do |car, index| %&gt;\n  ...\n  &lt;%= button_to \"ADD FAVORITE\", {controller: 'home', action: 'new_favorite', favorite_car_id: car.id}, remote: true} %&gt;\n&lt;% end %&gt;\n\n&lt;div id='favorite_modal' class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"&gt;\n  ...\n  &lt;%= render partial: 'layouts/new' %&gt;\n&lt;/div&gt;\n\n#home_controller.rb\n  def new_favorite\n    session[:favorite_added] = false\n    session[:favourite_ids] ||= []\n    if session[:favorites_ids].length &lt; 3\n      session[:favorites_ids] &lt;&lt; params[:favorite_car_id]\n      session[:favorite_added] = true\n    end\n  end\n\n# app/views/home/new_favorite.js.erb\n$('#favorite_modal').html(\"&lt;%= j render partial: 'layouts/new' %&gt;\");\n$('#favorite_modal').modal('toggle');\n</code></pre>\n\n<p>The code <code>j</code> is an alias for <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/JavaScriptHelper.html#method-i-escape_javascript\" rel=\"nofollow noreferrer\">escape_javascript</a> which escapes quotes and other stuff from the html that rails partail return.</p>\n"}, {"comments": [{"owner": {"reputation": 1132, "user_id": 4568250, "user_type": "registered", "profile_image": "https://graph.facebook.com/1041166272565569/picture?type=large", "display_name": "Sidonai", "link": "https://stackoverflow.com/users/4568250/sidonai"}, "edited": false, "score": 0, "creation_date": 1557789687, "post_id": 56120762, "comment_id": 98874795, "body": "Works like a charm! Thank you."}], "tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": true, "score": 2, "last_activity_date": 1557787565, "creation_date": 1557787565, "answer_id": 56120762, "question_id": 56120408, "link": "https://stackoverflow.com/questions/56120408/wait-for-action-to-finish-before-showing-a-modal/56120762#56120762", "title": "Wait for action to finish before showing a modal?", "body": "<p>First of all, you are adding an element with ID 'favorite_modal' on each outstanding_cars iteration, you'll have multiple elements with the same ID which is not right.</p>\n\n<p>You should render the modal as a view of the <code>new_favorite</code> action instead of prerendering the modal on the index view.</p>\n\n<p>So, remove that <code>render 'layouts/new'</code> line and do something like:</p>\n\n<pre><code>#at views/home/new_favorite.js.erb\ndocument.body.insertAdjacentHTML('beforeend', '&lt;%= j render partial: 'layouts/new_modal' %&gt;');\n$('#favorite_modal').modal('toggle');\n</code></pre>\n\n<p>Remove the modal DIV from the loop and append the complete HTML not just the content of the modal.</p>\n\n<pre><code>#at views/layouts/_new_modal.html.erb\n&lt;div id='favorite_modal' class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"&gt;\n  &lt;%= render partial: 'layouts/new' %&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 1132, "user_id": 4568250, "user_type": "registered", "profile_image": "https://graph.facebook.com/1041166272565569/picture?type=large", "display_name": "Sidonai", "link": "https://stackoverflow.com/users/4568250/sidonai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 56120762, "answer_count": 2, "score": 0, "last_activity_date": 1557789238, "creation_date": 1557784887, "last_edit_date": 1557789238, "question_id": 56120408, "link": "https://stackoverflow.com/questions/56120408/wait-for-action-to-finish-before-showing-a-modal", "title": "Wait for action to finish before showing a modal?", "body": "<p>I'm stuck with a modal, I need my method (new_favorite) to finish executing so that within the modal I can use the session hash, but the partial is being rendered before the session object is updated. This is what i have so far.</p>\n\n<pre><code>#index.html.erb\n&lt;% @outstanding_cars.each_with_index do |car, index| %&gt;\n  ...\n  &lt;%= button_to \"ADD FAVORITE\", {controller: 'home', action: 'new_favorite', favorite_car_id: car.id}, remote: true, data: {toggle: 'modal', target: '#favorite_modal'} %&gt;\n  &lt;div id='favorite_modal' class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"&gt;\n  ...\n    &lt;%= render partial: 'layouts/new' %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n\n#home_controller.rb\n  def new_favorite\n    if !session[:favorites_ids].present?\n      session[:favorites_ids] = []\n    end\n    if session[:favorites_ids].length &lt; 3\n      session[:favorites_ids] &lt;&lt; params[:favorite_car_id]\n      session[:favorite_added]= true\n    else\n      session[:favorite_added] = false\n    end\n  end\n\n#_new.html.erb\n  &lt;div class=\"modal-dialog\" role=\"document\"&gt;\n  &lt;div class=\"modal-content\"&gt;\n    &lt;div class=\"modal-header\"&gt;\n      &lt;button title=\"Cerrar\" class=\"close\" data-dismiss=\"modal\"&gt;\n        &lt;span aria-hidden=\"true\"&gt;&amp;times;&lt;/span&gt;\n      &lt;/button&gt;\n    &lt;/div&gt;\n    &lt;div class=\"modal-body\"&gt;\n      &lt;% if session[:favorite_added] %&gt;\n        &lt;p&gt;\n          Added!\n        &lt;/p&gt;\n      &lt;% else %&gt;\n        &lt;p&gt;\n          Enough cars for now, buddy.\n        &lt;/p&gt;\n      &lt;% end %&gt;\n      &lt;div class=\"clear\"&gt;&lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "documentation"], "comments": [{"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 0, "creation_date": 1557783717, "post_id": 56120182, "comment_id": 98873472, "body": "Have you tried it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "reply_to_user": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 0, "creation_date": 1557784589, "post_id": 56120182, "comment_id": 98873715, "body": "if a = 3 It works with that, but it throws me a warning: &quot;found = in conditional, should be ==&quot; why would you warn me if the documentation tells me it&#39;s valid?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1557809293, "post_id": 56120182, "comment_id": 98878378, "body": "&quot;why would you warn me if the documentation tells me it&#39;s valid&quot; \u2013 Because not everything that is valid is a good idea. The condition part of a conditional expression is simply an expression, therefore it can contain anything an expression can contain: assignments, method definitions, class definitions, module definitions, loops, other conditional expressions. That doesn&#39;t mean it&#39;s a good idea, though."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557789752, "post_id": 56120354, "comment_id": 98874803, "body": "One might argue that the first reads more like this: <code>a = object.some_value; if a; # ...; end</code>. That makes it clear that <code>a</code> is to be assigned a value; written <code>if a = object.some_value</code>--which is done to save a line of code--has the disadvantage that the reader may feel obliged to to review the code to ensure that <code>==</code> was not intended."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557791942, "post_id": 56120354, "comment_id": 98875177, "body": "@CarySwoveland It really depends on your coding conventions. If it&#39;s the first instance of <code>a</code> then it makes it more clear it&#39;s an intentional capture. That&#39;s why using a unique variable name helps."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1557784482, "creation_date": 1557784482, "answer_id": 56120354, "question_id": 56120182, "link": "https://stackoverflow.com/questions/56120182/i-dont-understand-the-code-in-ruby-documentation-that-assigns-a-value-within-an/56120354#56120354", "title": "I don&#39;t understand the code in Ruby documentation that assigns a value within an if expression", "body": "<p>These two chunks of code are visually similar, but substantially different in intent. The first reads like this:</p>\n\n<pre><code># Run object.some_value and capture the result into a\nif a = object.some_value\n  # ...\nend\n</code></pre>\n\n<p>The second reads like this:</p>\n\n<pre><code># If a is equivalent to the result of object.some_value\nif a == object.some_value\n  # ...\nend\n</code></pre>\n\n<p>Where that's a <em>comparison</em> by virtue of <code>==</code>.</p>\n\n<p>The capture form is often employed in a variety of cases, sometimes literally <code>case</code>, like where you'd capture the result of an awkward and/or slow chunk of code:</p>\n\n<pre><code>case (name = professor.name.to_s.split(/\\s+/).last)\nwhen \"O'Reilly\", \"Berners-Lee\"\n  puts \"Prof. %s is invited to the party.\" % name\nelse\n  puts \"Prof. %s is not invited to the party.\"\nend\n</code></pre>\n\n<p>Where that <code>=</code> is a deliberate assignment so you can refer to <code>name</code> from that point forward instead of having to recompute that chunk.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 56120354, "answer_count": 1, "score": 0, "last_activity_date": 1557817135, "creation_date": 1557783418, "last_edit_date": 1557817135, "question_id": 56120182, "link": "https://stackoverflow.com/questions/56120182/i-dont-understand-the-code-in-ruby-documentation-that-assigns-a-value-within-an", "title": "I don&#39;t understand the code in Ruby documentation that assigns a value within an if expression", "body": "<p>Ruby documentation says:</p>\n\n<pre><code>if a = object.some_value #assigns a value\n  # do something to a\nend\n</code></pre>\n\n<p>But when running the above code I get a warning:</p>\n\n<pre><code>warning: found = in conditional, should be ==\n</code></pre>\n\n<p>Which implies that the example should actually be: </p>\n\n<pre><code>if a == object.some_value\n  # do something to a\nend\n</code></pre>\n\n<p>It is possible to assign a value to a variable in an <code>if</code> as shown above?</p>\n"}, {"tags": ["ruby", "sqlite", "daemon", "sqlite3-ruby", "daemons"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1557769536, "post_id": 56117221, "comment_id": 98868099, "body": "What are the permissions on the SQLite file? Is it owned by the same user that the daemon runs as?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1557770792, "post_id": 56117221, "comment_id": 98868632, "body": "How do you open the file? Are you supplying an <i>absolute path</i>?"}, {"owner": {"reputation": 31, "user_id": 7949512, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158559370645534/picture?type=large", "display_name": "FakeBenJay", "link": "https://stackoverflow.com/users/7949512/fakebenjay"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1558550927, "post_id": 56117221, "comment_id": 99142774, "body": "@muistooshort I don&#39;t know how to check the permissions, but I created both the script and the SQLite file."}, {"owner": {"reputation": 31, "user_id": 7949512, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158559370645534/picture?type=large", "display_name": "FakeBenJay", "link": "https://stackoverflow.com/users/7949512/fakebenjay"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1558551086, "post_id": 56117221, "comment_id": 99142835, "body": "@tadman It&#39;s a relative path within stateleg.rb  ``` db = SQLite3::Database.new(&#39;stateleg.db&#39;) ```  But again, when I run <code>stateleg.rb</code> in the foreground, it has no issue accessing <code>stateleg.db</code>"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1558551547, "post_id": 56117221, "comment_id": 99143014, "body": "Try using an absolute path, you never really know what the current directory for a daemon will be. You can use <code>ls -l</code> as a quick way to check the owner and permissions."}, {"owner": {"reputation": 31, "user_id": 7949512, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158559370645534/picture?type=large", "display_name": "FakeBenJay", "link": "https://stackoverflow.com/users/7949512/fakebenjay"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1558553363, "post_id": 56117221, "comment_id": 99143843, "body": "@muistooshort That did it, thank you!"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1558569388, "post_id": 56117221, "comment_id": 99148880, "body": "Thank @tadman for that one."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1558721107, "creation_date": 1558721107, "answer_id": 56297612, "question_id": 56117221, "link": "https://stackoverflow.com/questions/56117221/ruby-script-cant-open-sqlite3-file-but-only-when-running-as-a-daemon/56297612#56297612", "title": "Ruby script can&#39;t open SQLite3 file, but only when running as a Daemon", "body": "<p>When something is \"daemonized\" it's usually running in a different working directory than the one you expect. This is especially true for services that are spun up on boot, such as through <a href=\"https://en.wikipedia.org/wiki/Systemd\" rel=\"nofollow noreferrer\">systemd</a>, or on <a href=\"https://en.wikipedia.org/wiki/Cron\" rel=\"nofollow noreferrer\">cron</a>.</p>\n\n<p>In order to account for this you need to specify the full path to files you're intending to work with. These are called <em>absolute paths</em> since they're not impacted by the current working directory. <code>/a/b/c</code> is an absolute path, it starts with <code>/</code>, but <code>b/c</code> is relative. If you're in <code>/a</code> it's equivalent, but it won't work outside of that scope.</p>\n\n<p>If you know the location of that file relative to your script, you can usually do this:</p>\n\n<pre><code>Daemons.run(File.expand_path('stateleg.rb', __dir__))\n</code></pre>\n\n<p>Where <a href=\"https://www.rubydoc.info/stdlib/core/Kernel:__dir__\" rel=\"nofollow noreferrer\"><code>__dir__</code></a> is the directory in which the currently executing script file is stored.</p>\n"}], "owner": {"reputation": 31, "user_id": 7949512, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158559370645534/picture?type=large", "display_name": "FakeBenJay", "link": "https://stackoverflow.com/users/7949512/fakebenjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558721107, "creation_date": 1557768573, "question_id": 56117221, "link": "https://stackoverflow.com/questions/56117221/ruby-script-cant-open-sqlite3-file-but-only-when-running-as-a-daemon", "title": "Ruby script can&#39;t open SQLite3 file, but only when running as a Daemon", "body": "<p>I'm running a script (running on an AWS EC2 instance) that continually pulls state legislative data from an API, and persists it to a SQLite3 .db file. When I try to run the script as a daemon in the background, the process immediately stops and I'm given the following error.</p>\n\n<pre><code>stateleg.rb: process with pid 4666 started.\nTraceback (most recent call last):\n    11: from stateleg_daemon.rb:4:in `&lt;main&gt;'\n    10: from /usr/local/rvm/gems/ruby-2.5.1/gems/daemons-1.3.1/lib/daemons.rb:149:in `run'\n     9: from /usr/local/rvm/gems/ruby-2.5.1/gems/daemons-1.3.1/lib/daemons/cmdline.rb:121:in `catch_exceptions'\n     8: from /usr/local/rvm/gems/ruby-2.5.1/gems/daemons-1.3.1/lib/daemons.rb:150:in `block in run'\n     7: from /usr/local/rvm/gems/ruby-2.5.1/gems/daemons-1.3.1/lib/daemons/controller.rb:59:in `run'\n     6: from /usr/local/rvm/gems/ruby-2.5.1/gems/daemons-1.3.1/lib/daemons/application.rb:307:in `start'\n     5: from /usr/local/rvm/gems/ruby-2.5.1/gems/daemons-1.3.1/lib/daemons/application.rb:228:in `start_load'\n     4: from /usr/local/rvm/gems/ruby-2.5.1/gems/daemons-1.3.1/lib/daemons/application.rb:228:in `load'\n     3: from /home/ubuntu/stateleg.rb:8:in `&lt;top (required)&gt;'\n     2: from /home/ubuntu/stateleg.rb:8:in `new'\n     1: from /usr/local/rvm/gems/ruby-2.5.1/gems/sqlite3-1.4.1/lib/sqlite3/database.rb:89:in `initialize'\n/usr/local/rvm/gems/ruby-2.5.1/gems/sqlite3-1.4.1/lib/sqlite3/database.rb:89:in `open_v2': unable to open database file (SQLite3::CantOpenException)\n</code></pre>\n\n<p>When I try to run the script in the foreground, the script runs perfectly, and the necessary information is written to the .db file.</p>\n\n<p>How can I make this daemon open the database file? Are SQLite3 and Ruby daemons in some way incompatible? Any information at all would be tremendously helpful.</p>\n\n<p>This is the entirety of the daemon script.</p>\n\n<pre><code>require 'daemons'\n\nDaemons.run('stateleg.rb')\n</code></pre>\n"}, {"tags": ["ruby", "web-scraping", "selenium-chromedriver", "aws-serverless"], "owner": {"reputation": 11, "user_id": 5831161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fHW21.png?s=128&g=1", "display_name": "Mknychala", "link": "https://stackoverflow.com/users/5831161/mknychala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557780361, "creation_date": 1557764709, "last_edit_date": 1557780361, "question_id": 56116358, "link": "https://stackoverflow.com/questions/56116358/optimizing-ruby-code-for-webscraping-running-in-aws-lambda", "title": "Optimizing Ruby Code for Webscraping Running in AWS Lambda", "body": "<p>I am writing a simple serverless app to scrape data about available live sports events. I am using:</p>\n\n<ul>\n<li><p>serverless chrome v1.0.0-37 (<a href=\"https://github.com/adieuadieu/serverless-chrome\" rel=\"nofollow noreferrer\">https://github.com/adieuadieu/serverless-chrome</a>)</p></li>\n<li><p>chromedriver 2.37</p></li>\n<li><p>selenium-webdriver gem 3.141.0</p></li>\n<li><p>writing code in Ruby 2.5 and running it in AWS lambda.</p></li>\n</ul>\n\n<p>Here is my code:</p>\n\n<pre><code>def find_event_ids\n  visit_page\n  elements = @driver.find_elements(class: 'event').map do |event_el|\n    event_el.attribute('id')\n  end\nend\n\ndef setup_driver\n  options = Selenium::WebDriver::Chrome::Options.new(binary: ENV['BINARY_PATH'])\n  options.add_argument('--headless')\n  options.add_argument('--disable-gpu')\n  options.add_argument('--window-size=1280x1696')\n  options.add_argument('--disable-application-cache')\n  options.add_argument('--disable-infobars')\n  options.add_argument('--no-sandbox')\n  options.add_argument('--hide-scrollbars')\n  options.add_argument('--enable-logging')\n  options.add_argument('--log-level=0')\n  options.add_argument('--single-process')\n  options.add_argument('--ignore-certificate-errors')\n  options.add_argument('--homedir=/tmp')\n  @driver = Selenium::WebDriver.for :chrome, driver_path: ENV['DRIVER_PATH'], options: options\n  @driver.manage.timeouts.implicit_wait = 30\nend\n\ndef visit_page\n  @driver.navigate.to \"https://sports.williamhill.com/betting/en-gb/in-play/football\"\nend\n\ndef call_webdriver_handler(event:, context:)\n  setup_driver\n  results = find_event_ids\n  @driver&amp;.quit\n  { statusCode: 200, body: JSON.generate(results) }\nend\n</code></pre>\n\n<p>I wanted to expose an API with Amazon API Gateway. The problem is when there are many events, I always receive a timeout when calling this API.</p>\n\n<p>I have already tried:</p>\n\n<ul>\n<li><p>Changing chrome webdriver options</p></li>\n<li><p>Setting max timeouts in API Gateway</p></li>\n<li><p>Rewriting the code to return events paginated, e.g.:</p></li>\n</ul>\n\n<pre><code>  def find_event_ids(page = 1)\n    visit_page\n    elements = @driver.find_elements(class: 'event')\n    paginated_elements_data = elements[(RECORDS_PER_PAGE * (page - 1)), (RECORDS_PER_PAGE * page - 1)].map do |event_el|\n      event_el.attribute('id')\n    end\n    {\n      metadata: {\n        total_count: elements.count,\n        total_pages: (elements.count.to_f / RECORDS_PER_PAGE).ceil,\n        current_page: page,\n      },\n      data: paginated_elements_data\n    }\n  end\n</code></pre>\n\n<p>It was only slightly faster, so I guess that <code>@driver.find_elements(class: 'event')</code> is much more time consuming then <code>.map</code>.</p>\n\n<p>Is there any way to optimize my code? My goal would be able to scrape up to 100 sports events. If not, do you recommend any other tool or technology I can use to scrape live sports events with code in AWS Lambda?</p>\n"}, {"tags": ["ruby", "irb", "pry"], "answers": [{"comments": [{"owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "edited": false, "score": 0, "creation_date": 1557752083, "post_id": 56112795, "comment_id": 98859027, "body": "load &#39;prime.rb` returns true but does not seem to pick up changes"}, {"owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "edited": false, "score": 0, "creation_date": 1557752191, "post_id": 56112795, "comment_id": 98859104, "body": "wait it works with relative only, e.g. load &quot;./prime.rb&quot; even though using no filepath worked it didn&#39;t really reload but using relative it does"}, {"owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "edited": false, "score": 0, "creation_date": 1557752319, "post_id": 56112795, "comment_id": 98859183, "body": "sweet, yeah. It&#39;s odd that the load says it works (if the file doesn&#39;t exist it gives an error) but then not reloaded (the absolute, i.e. just the filename). But with the relative is says true and it really does reload"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "reply_to_user": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "edited": false, "score": 0, "creation_date": 1557752459, "post_id": 56112795, "comment_id": 98859267, "body": "@MichaelDurrant From docs <code>If the filename does not resolve to an absolute path, the file is searched for in the library directories listed in $:.</code> Maybe you have file with same name in library directories?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "edited": false, "score": 3, "creation_date": 1557753642, "post_id": 56112795, "comment_id": 98859988, "body": "@MichaelDurrant the reason <code>load &#39;prime.rb&#39;</code> did not seem to have an effect is that ruby has a standard lib class by that name <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/prime/rdoc/Prime.html\" rel=\"nofollow noreferrer\"><code>Prime</code></a> so you were actually loading this file and not your <code>prime.rb</code> file."}, {"owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1557754902, "post_id": 56112795, "comment_id": 98860765, "body": "@engineersmnky omg nice one. I thought something really odd was going on, you nailed it!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1557767915, "post_id": 56112795, "comment_id": 98867425, "body": "Nothing gets by @engineersmnky."}], "tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 7, "last_activity_date": 1557753028, "last_edit_date": 1557753028, "creation_date": 1557751963, "answer_id": 56112795, "question_id": 56112714, "link": "https://stackoverflow.com/questions/56112714/ruby-how-to-reload-a-file-with-changes-in-irb-or-pry/56112795#56112795", "title": "Ruby - how to reload a file with changes in IRB or PRY?", "body": "<p>Try <a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-load\" rel=\"noreferrer\"><code>Kernel#load</code></a> with relative path to rb file:</p>\n\n<pre><code>irb&gt; load './path/to/prime.rb'\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-require\" rel=\"noreferrer\"><code>Kernel#require</code></a> loads a source file only once, while <a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-load\" rel=\"noreferrer\"><code>Kernel#load</code></a> loads it every time you call it.</p>\n\n<p>Ref <a href=\"https://stackoverflow.com/a/4633535/4950680\">https://stackoverflow.com/a/4633535/4950680</a></p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1557764387, "post_id": 56112817, "comment_id": 98866018, "body": "Ruby on Rails has an autoloader that can do this but it also does a lot of strange things to avoid defining the constants you think you&#39;re defining, instead replacing them with similarly named anonymous classes. This means they can be thrown aside and replaced seamlessly. Doing this yourself is probably asking too much, so using <a href=\"https://rubygems.org/gems/activesupport/versions/5.0.0.1\" rel=\"nofollow noreferrer\">ActiveSupport</a> may be the way to go for a canned solution."}], "tags": [], "owner": {"reputation": 6814, "user_id": 5227053, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/30254853024c1381c7e51ca09b9341e7?s=128&d=identicon&r=PG&f=1", "display_name": "AnoE", "link": "https://stackoverflow.com/users/5227053/anoe"}, "is_accepted": false, "score": 3, "last_activity_date": 1557754988, "last_edit_date": 1557754988, "creation_date": 1557752101, "answer_id": 56112817, "question_id": 56112714, "link": "https://stackoverflow.com/questions/56112714/ruby-how-to-reload-a-file-with-changes-in-irb-or-pry/56112817#56112817", "title": "Ruby - how to reload a file with changes in IRB or PRY?", "body": "<p><code>require</code> just says that you literally \"require\" some other .rb file to be loaded. Once it is loaded, that requirement is satisfied, and further <code>require</code> calls with the same target file are ignored. This makes it save to have the same <code>require</code> call sprinkled liberately across many source files - they won't actually do anything after the first one has been executed.</p>\n\n<p>You can use <code>load</code> to force it to actually load the file - this should do exactly what you expect (<code>require</code> calls <code>load</code> after checking whether the file has already been required).</p>\n\n<p>Note that all of this is straightforward if you are in a plain-old-ruby context (i.e., calling methods or instatiating objects yourself) but can become a bit hairy if one of the \"big guns\" a.k.a. Rails is involved. Rails does a lot of magic behind the scenes to automatically require missing stuff (hence why you see so few explicit <code>require</code> calls in Rails code) - which leads to explicit <code>load</code>s in the <code>irb</code> sometimes seemingly having no effect.</p>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1670, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1557754988, "creation_date": 1557751692, "last_edit_date": 1557751965, "question_id": 56112714, "link": "https://stackoverflow.com/questions/56112714/ruby-how-to-reload-a-file-with-changes-in-irb-or-pry", "title": "Ruby - how to reload a file with changes in IRB or PRY?", "body": "<p>I go into <code>irb</code> and require a file</p>\n\n<pre><code>irb&gt; require_relative 'prime'\nirb&gt; true\n</code></pre>\n\n<p>This file contains the following code:</p>\n\n<pre><code>def is_prime? num\n  (2..num-1).each do |div_by|\n    if num % div_by == 0\n      return false\n    end \n  end \n  true\nend\n</code></pre>\n\n<p>requiring the file in irb works and I can use the method, e.g.</p>\n\n<pre><code>irb&gt; require_relative 'prime'\nirb&gt; is_prime? 10\nirb&gt; -&gt; false\n\nirb&gt; is_prime? 11\nirb&gt; -&gt; true\n</code></pre>\n\n<p>However if I modify the source file, say add <code>puts 'HHH'</code>, that does not show up unless I exit the console and re-enter and then <code>require</code> the file</p>\n\n<p>If I stay in the console and require the file again I get false as it is already loaded and I don't get the new changes</p>\n\n<p>I have tried</p>\n\n<pre><code>irb&gt; reload\n</code></pre>\n\n<p>and</p>\n\n<pre><code>irb&gt; reload!\n</code></pre>\n\n<p>but they give me </p>\n\n<pre><code>NoMethodError (undefined method `reload!' for main:Object)\n</code></pre>\n\n<p>Also I tried </p>\n\n<pre><code>irb&gt; load 'prime.rb'\nirb&gt; =&gt; true\n</code></pre>\n\n<p>but did not pick up the change</p>\n\n<p>Using PRY gave similar results</p>\n"}, {"tags": ["ruby", "http", "put", "rest-client", "net-http"], "answers": [{"comments": [{"owner": {"reputation": 6434, "user_id": 539599, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/6iB0U.jpg?s=128&g=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/539599/raphael"}, "edited": false, "score": 0, "creation_date": 1557751376, "post_id": 56112607, "comment_id": 98858643, "body": "I missed this due do idiocy (I had <code>File.read</code> and noticed only when writing up the question); I&#39;d still appreciate an answer for <code>rest-client</code> since it has the nicer interface."}], "tags": [], "owner": {"reputation": 6434, "user_id": 539599, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/6iB0U.jpg?s=128&g=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/539599/raphael"}, "is_accepted": true, "score": 0, "last_activity_date": 1557751300, "creation_date": 1557751300, "answer_id": 56112607, "question_id": 56112606, "link": "https://stackoverflow.com/questions/56112606/uploading-data-via-http-put-without-multi-part-gutter/56112607#56112607", "title": "Uploading data via HTTP PUT without multi-part gutter", "body": "<p>With <code>net/http</code>, set the request body to the file content as stream:</p>\n\n<pre><code>request.body_stream = File.open(\"#{file}\")\nrequest.content_length = File.size(\"#{file}\")\nrequest.content_type = \"text/plain\" # ?!\n</code></pre>\n\n<p>Determining the proper MIME type from the file alone is an adventure in itself.</p>\n"}], "owner": {"reputation": 6434, "user_id": 539599, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/6iB0U.jpg?s=128&g=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/539599/raphael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 56112607, "answer_count": 1, "score": 0, "last_activity_date": 1557751300, "creation_date": 1557751300, "question_id": 56112606, "link": "https://stackoverflow.com/questions/56112606/uploading-data-via-http-put-without-multi-part-gutter", "title": "Uploading data via HTTP PUT without multi-part gutter", "body": "<p>I'm trying to upload static HTML+friends content to a raw Nexus 3 repository. As far as <a href=\"https://help.sonatype.com/repomanager3/formats/raw-repositories#RawRepositories-UploadingFilestoHostedRawRepositories\" rel=\"nofollow noreferrer\">the documentation goes</a>, the only way to upload files is using HTTP PUT. Sure enough,</p>\n\n<pre><code>curl -v --user 'user:pw' --upload-file my_file.html  \\\n    http://my.nexus/repository/my-raw-repo/my_file.html\n</code></pre>\n\n<p>works as expected and the file can be accessed at <code>http://my.nexus/repository/my-raw-repo/index.html</code></p>\n\n<p>Adding this deployment to my Rake process has turned out to be hasslesome, though. Here are some things I have tried.</p>\n\n<ol>\n<li><p>With <code>net/http</code>:</p>\n\n<pre><code>require 'net/http'\nuri = URI(\"http://my.nexus/repository/my-raw-repo\")\nfile = \"index.html\"\nNet::HTTP.start(uri.host, uri.port) do |http|\n    request = Net::HTTP::Put.new \"#{repo_url}/#{file}\"\n    request.basic_auth(user, pw)\n\n    &lt;snip&gt;\n\n    response = http.request request\n    raise \"Upload failed: #{response.code} #{response.message}\\n#{response.body}\" \\\n       unless response.is_a?(Net::HTTPSuccess)\nend\n</code></pre>\n\n<p>I tried several variants for <code>&lt;snip&gt;</code>.</p>\n\n<ol>\n<li><p>Set body to file content as string:</p>\n\n<pre><code>request.body = File.read(\"#{file}\")`\n</code></pre>\n\n<p>Request completes without error but Nexus shows file size 0 bytes.</p></li>\n<li><p>Send form data to file content as stream:</p>\n\n<pre><code>request.set_form([['upload', File.open(\"#{file}\")]], 'multipart/form-data')\n</code></pre>\n\n<p>That one is kind of obvious: multi-part gutter is added which Nexus does not remove:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Iw69w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Iw69w.png\" alt=\"enter image description here\"></a></p></li>\n</ol></li>\n<li><p>With <code>rest-client</code>:</p>\n\n<pre><code>require 'rest-client'\nfile = \"index.html\"\nbegin\n    RestClient::Request.execute(\n        method: :put,\n        url: \"http://my.nexus/repository/my-raw-repo/#{file}\",\n        &lt;snip&gt;\n        user: user,\n        password: pw\n    )\nrescue RestClient::ExceptionWithResponse =&gt; e\n    raise \"Upload failed: #{e.response}\"\nend\n</code></pre>\n\n<p>And for <code>&lt;snip&gt;</code> (guessing around the less than clear documentation):</p>\n\n<ol>\n<li><code>body: File.read(\"#{file}\")</code><br>\n --> 0 bytes.</li>\n<li><code>payload: File.read(\"#{file}\")</code><br>\n --> 0 bytes.</li>\n<li><code>payload: { file: File.new(\"#{file}\") }</code><br>\n--> Multi-part gutter remains.</li>\n<li><code>payload: { multipart: false, file: File.new(\"#{file}\") }</code><br>\n--> Multi-part gutter remains.</li>\n</ol>\n\n<p>I think I tried several combination more which I don't remember, with similar results.</p></li>\n</ol>\n\n<p><em>Note bene:</em> I've left out the parts related to SSL with a self-signed certificate because that should be unrelated.</p>\n\n<p>How can I tell either library (or any other) to do PUT with data but without multi-part? Or if that's not the issue, what am I doing wrong?</p>\n\n<p>I want to use an all-Ruby solution (i.e. not delegate to system <code>curl</code>) so that the build can be (as) portable (as possible).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundler", "cloud66"], "comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557751405, "post_id": 56112550, "comment_id": 98858666, "body": "You could provide a direct link to the GIT repository, with the <code>git:</code> parameter in your Gemfile. Could be worth trying."}, {"owner": {"reputation": 3, "user_id": 8924907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf2271d9798e5ed28629b12d82745356?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8924907/sam"}, "reply_to_user": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557751487, "post_id": 56112550, "comment_id": 98858702, "body": "I tried that but the git repository is now <a href=\"https://github.com/babel/ruby-babel-transpiler\" rel=\"nofollow noreferrer\">github.com/babel/ruby-babel-transpiler</a> it seems?"}, {"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 0, "creation_date": 1557752748, "post_id": 56112550, "comment_id": 98859436, "body": "this gem is available at source rubygems see: <a href=\"https://rubygems.org/gems/babel-source/versions/5.8.35\" rel=\"nofollow noreferrer\">rubygems.org/gems/babel-source/versions/5.8.35</a>. add some more clue. add rubygems as gem source"}, {"owner": {"reputation": 3, "user_id": 8924907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf2271d9798e5ed28629b12d82745356?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8924907/sam"}, "edited": false, "score": 0, "creation_date": 1557752904, "post_id": 56112550, "comment_id": 98859540, "body": "If you click the homepage on that it takes you to the link i commented with, Which sprockets-es6 requires, Which is required by active-admin"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1557758683, "post_id": 56112550, "comment_id": 98863000, "body": "Can you please show us your Gemfile? Otherwise we can guess all day! :D"}, {"owner": {"reputation": 3, "user_id": 8924907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf2271d9798e5ed28629b12d82745356?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8924907/sam"}, "reply_to_user": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1557759328, "post_id": 56112550, "comment_id": 98863341, "body": "@BroiSatse Done :)"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1557760897, "post_id": 56112550, "comment_id": 98864249, "body": "@Sam - Is is it working lcoally? If so, my bet is on the lost internet conection on your server."}, {"owner": {"reputation": 3, "user_id": 8924907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf2271d9798e5ed28629b12d82745356?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8924907/sam"}, "reply_to_user": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1557763014, "post_id": 56112550, "comment_id": 98865392, "body": "@BroiSatse Works locally fine, I think it might be somehting to do with vendor cache..."}, {"owner": {"reputation": 316, "user_id": 2467951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5990bd17a329f12b41401d1b89a6cc8f?s=128&d=identicon&r=PG", "display_name": "Cloud66", "link": "https://stackoverflow.com/users/2467951/cloud66"}, "edited": false, "score": 0, "creation_date": 1557846274, "post_id": 56112550, "comment_id": 98898001, "body": "@Sam - yup, removing your local &quot;vendor/cache&quot; should do the trick; instead, you should be relying on your Gemfile.lock to lock down your gem versions"}], "owner": {"reputation": 3, "user_id": 8924907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf2271d9798e5ed28629b12d82745356?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8924907/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557759316, "creation_date": 1557751121, "last_edit_date": 1557759316, "question_id": 56112550, "link": "https://stackoverflow.com/questions/56112550/cant-install-gem-on-cloud66", "title": "Cant install gem on cloud66", "body": "<p>So I have an issue with cloud66 when deploying to my server, It states it cannot find gem <code>babel-source</code> </p>\n\n<p>I've looked on rubygems and it hasn't been yanked, It installs fine locally. However when running it on cloud66 i get this error</p>\n\n<pre><code>Could not find babel-source-5.8.35 in any of the sources\nIs the gem babel-source-5.8.35 available? Check if it has been yanked from your gem source (most likely RubyGems)\n</code></pre>\n\n<p>I need this gem for <code>Active-admin</code> I believe. </p>\n\n<p>Any ideas on how to fix this would be amazing!</p>\n\n<p>Edit: <code>Gemfile</code></p>\n\n<pre><code>source 'https://rubygems.org'\nruby '2.5.1'\n\n# gem 'babel-source', '~&gt; 5.8.35'\n\n# Standard Rails gems\ngem 'rails'\ngem 'sass-rails'\ngem 'uglifier'\ngem 'coffee-rails'\ngem 'jquery-rails'\ngem 'turbolinks'\ngem 'jbuilder'\ngem 'bcrypt'\ngem 'simple_form'\ngem 'bootstrap4-datetime-picker-rails'\ngem 'momentjs-rails'\ngem 'httparty'\ngem 'activerecord-import'\ngem 'dynamic_selectable'\ngem 'fuzzy-string-match'\n#Nested Forms\ngem 'cocoon'\ngem \"puma\"\n\ngem 'spawnling', '~&gt;2.1'\n\n#Image Uploader\ngem \"mini_magick\"\ngem \"fog-aws\"\ngem 'carrierwave', '~&gt; 1.0'\ngem 'aws-sdk-rails'\ngem 'figaro'\n# Necessary for Windows OS (won't install on *nix systems)\ngem 'tzinfo-data', platforms: [:mingw, :mswin]\n\n# Kaminari: https://github.com/amatsuda/kaminari\ngem 'kaminari'\n\n# Friendly_id: https://github.com/norman/friendly_id\ngem 'friendly_id'\n\n# Font-awesome: https://github.com/FortAwesome/font-awesome-sass\ngem 'font-awesome-sass'\n\n# Bootstrap 3: https://github.com/twbs/bootstrap-sass\ngem 'bootstrap', '~&gt; 4.3.1'\n\ngroup :development, :test do\n  gem 'byebug'\n  gem 'web-console'\n\n  # Spring: https://github.com/rails/spring\n  gem 'spring'\n\n  # Annotate_Models: https://github.com/ctran/annotate_models\n  gem 'annotate'\nend\n\n\n# PostgreSQL\ngem 'pg'\ngem 'watir'\ngem 'open_uri_redirections'\ngem 'mechanize'\n\n# Devise: https://github.com/plataformatec/devise\ngem 'devise'\ngem 'chart-js-rails'\ngem 'tinymce-rails'\ngem 'autoprefixer-rails'\ngem 'impressionist'\ngem 'arctic_admin'\ngem 'activeadmin', '~&gt; 2.0.0'\n\n</code></pre>\n\n<p>Sam</p>\n"}, {"tags": ["ruby", "selenium", "google-chrome", "selenium-chromedriver", "webdriver-w3c-spec"], "comments": [{"owner": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1557748898, "post_id": 56111529, "comment_id": 98857316, "body": "Do you know which command is called? Are you sure you want to run on betas? Why don&#39;t you run on <code>apt-get install -y google-chrome</code> and <code>CHROMEDRIVER_VERSION 74.0.3729.6</code> ?"}, {"owner": {"reputation": 181, "user_id": 11492553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db77467aaee3fbd61f7e6107e01470f1?s=128&d=identicon&r=PG&f=1", "display_name": "sugu", "link": "https://stackoverflow.com/users/11492553/sugu"}, "reply_to_user": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1557757304, "post_id": 56111529, "comment_id": 98862202, "body": "Hi @lojza , thanks for responding! I think you mean to use <code>apt-get install -y google-chrome-stable</code> right? I have tried this combination and error that I get is <b>This version of ChromeDriver only supports Chrome version 75 (Selenium::WebDriver::Error::SessionNotCreatedError)</b>.   Commands that are failing with new versions are: <code>wait_for expect(test).to have_test1 steps %Q{ } block</code> etc.  Is there any way to download chrome version 73 with <code>apt-get install</code>? or is it possible to disable W3C check in latest chrome version?"}, {"owner": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1557758277, "post_id": 56111529, "comment_id": 98862766, "body": "Yes, sorry. Check your version of chrome with <code>google-chrome -version</code> and then download proper version of chrome driver as described here <a href=\"http://chromedriver.chromium.org/downloads/version-selection\" rel=\"nofollow noreferrer\">chromedriver.chromium.org/downloads/version-selection</a> If you pass <code>&quot;w3c&quot;: true</code> to chromeOptions it should work, check <a href=\"https://bugs.chromium.org/p/chromedriver/issues/detail?id=1942\" rel=\"nofollow noreferrer\">bugs.chromium.org/p/chromedriver/issues/detail?id=1942</a>"}, {"owner": {"reputation": 181, "user_id": 11492553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db77467aaee3fbd61f7e6107e01470f1?s=128&d=identicon&r=PG&f=1", "display_name": "sugu", "link": "https://stackoverflow.com/users/11492553/sugu"}, "reply_to_user": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1557766721, "post_id": 56111529, "comment_id": 98866949, "body": "Thanks again lojza for quick response, I have tried multiple combinations with correct chrome driver version. But the issue is since last chrome update if I download <code>apt-get install -y google-chrome-stable</code>  <code>google-chrome --version</code> is <code>74.0.3729.131</code>  and if I download corresponding chromedriver version <code>74.0.3729.6</code> and run our tests I get <code>This version of ChromeDriver only supports Chrome version 75</code> so basically there is an issue that chromedriver <code>74.0.3729.6</code> is pointing to google-chrome 75 instead of 74."}, {"owner": {"reputation": 181, "user_id": 11492553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db77467aaee3fbd61f7e6107e01470f1?s=128&d=identicon&r=PG&f=1", "display_name": "sugu", "link": "https://stackoverflow.com/users/11492553/sugu"}, "reply_to_user": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1557766733, "post_id": 56111529, "comment_id": 98866955, "body": "Can you please tell me if there is any way to download <code>google-chrome 73</code> using <code>apt-get install</code> now as it is no longer a stable version? or for <code>google-chomre 75</code> can we disable w3c check?"}, {"owner": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1557817532, "post_id": 56111529, "comment_id": 98881494, "body": "Are you sure, you are running ChromeDriver 74? As I mention above try <code>ChromeOptions options = new ChromeOptions(); options.setCapability(&quot;w3c&quot;,true); driver = new ChromeDriver(options);</code>"}, {"owner": {"reputation": 181, "user_id": 11492553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db77467aaee3fbd61f7e6107e01470f1?s=128&d=identicon&r=PG&f=1", "display_name": "sugu", "link": "https://stackoverflow.com/users/11492553/sugu"}, "reply_to_user": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1557930744, "post_id": 56111529, "comment_id": 98933043, "body": "yup, I&#39;m sure. I was printing the version after installing it. The issue is ChromeDriver 74.0.3729.6 is expecting browser 75 version instead of 74. I have raised this bug with chromium <a href=\"https://bugs.chromium.org/p/chromedriver/issues/detail?id=2906\" rel=\"nofollow noreferrer\">bugs.chromium.org/p/chromedriver/issues/detail?id=2906</a>. The workaround, for now, it to disable w3c on the new version by setting ChromeOption &quot;w3c&quot; to false. Thanks for your quick responses lojza."}, {"owner": {"reputation": 1277, "user_id": 1331578, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/g4k9c.png?s=128&g=1", "display_name": "SkorpEN", "link": "https://stackoverflow.com/users/1331578/skorpen"}, "edited": false, "score": 0, "creation_date": 1562767541, "post_id": 56111529, "comment_id": 100481262, "body": "Which version of selenium are You using?"}], "answers": [{"comments": [{"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 1, "creation_date": 1560981088, "post_id": 56456696, "comment_id": 99919792, "body": "The question is on Ruby, not python/Java. This answer is WAY too verbose... just answer the question. He&#39;s not trying to build the watch... he just wants to know what time it is."}, {"owner": {"reputation": 34214, "user_id": 1141839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b5c46e3c79ab446329ff05949594cd?s=128&d=identicon&r=PG", "display_name": "PinnyM", "link": "https://stackoverflow.com/users/1141839/pinnym"}, "edited": false, "score": 3, "creation_date": 1561039768, "post_id": 56456696, "comment_id": 99941121, "body": "v75.0.3770.90 doesn&#39;t fix this problem because it doesn&#39;t contain the &#39;Is Displayed&#39; endpoint. The v76 update does solve the problem... but it&#39;s still in beta :/"}, {"owner": {"reputation": 114711, "user_id": 31582, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/17f2a7263e27c4c5a2093ea8d63389d4?s=128&d=identicon&r=PG", "display_name": "Gareth", "link": "https://stackoverflow.com/users/31582/gareth"}, "edited": false, "score": 12, "creation_date": 1561476862, "post_id": 56456696, "comment_id": 100072714, "body": "This was a very useful analysis and it helped me understand the underlying problem. Sometimes people <i>are</i> interested in knowing why the fix they&#39;re making works or doesn&#39;t work and this was great at tying up various threads for me."}], "tags": [], "owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "is_accepted": false, "score": 18, "last_activity_date": 1560514316, "last_edit_date": 1560514316, "creation_date": 1559722892, "answer_id": 56456696, "question_id": 56111529, "link": "https://stackoverflow.com/questions/56111529/cannot-call-non-w3c-standard-command-while-in-w3c-mode-seleniumwebdrivererr/56456696#56456696", "title": "Cannot call non W3C standard command while in W3C mode (Selenium::WebDriver::Error::UnknownCommandError) with Selenium ChromeDriver in Cucumber Ruby", "body": "<p>This error message...</p>\n\n<pre><code>unknown command: Cannot call non W3C standard command while in W3C mode (Selenium::WebDriver::Error::UnknownCommandError)\n</code></pre>\n\n<p>...implies that the <em>ChromeDriver</em> was unable to call <em>non W3C standard command</em> while in <strong>W3C mode</strong> while initiating/spawning a new <em>WebBrowser</em> i.e. <strong>Chrome Browser</strong> session.</p>\n\n<p>Here the main issue is, when <em>ChromeDriver</em>'s client requests a <strong>W3C-compliant session</strong> but the response from <em>ChromeDriver</em> does not conform to the W3C spec, and causes errors in language APIs.</p>\n\n<hr>\n\n<h2>Analysis</h2>\n\n<p>As per the discussion in <a href=\"https://bugs.chromium.org/p/chromedriver/issues/detail?id=1942\" rel=\"noreferrer\">ChromeDriver response in W3C mode is not standard compliant</a> John Chen (Owner - WebDriver for Google Chrome) <a href=\"https://bugs.chromium.org/p/chromedriver/issues/detail?id=1942#c2\" rel=\"noreferrer\">mentioned</a> that, Simon Stewart (Creator - WebDriver) had updated that:</p>\n\n<ul>\n<li><p>The new session response for a w3c session should look like:</p>\n\n<pre><code>{\n  \"value\": {\n    \"sessionId\": \"some-uuid\",\n    \"capabilities\": {\n      \"browserName\": \"chrome\",\n      ...\n    }\n  }\n}\n</code></pre></li>\n<li><p>But when starting a new session with the <strong><code>w3c</code></strong> option set to <code>true</code> in the <em>chromeOptions</em> as follows:</p>\n\n<ul>\n<li><p>Selenium/Python:</p>\n\n<pre><code>from selenium import webdriver\nopt = webdriver.ChromeOptions()\nopt.add_experimental_option('w3c', True)\ndriver = webdriver.Chrome(chrome_options=opt)\n</code></pre></li>\n<li><p>Selenium/Java:</p>\n\n<pre><code>{\n  \"sessionId\": \"af4656c27fb94485b7872e1fc616923a\",\n  \"status\": \"ok\",\n  \"value\": {\n    \"browserName\": \"chrome\",\n    ...\n  }\n}\n</code></pre></li>\n</ul></li>\n<li><p>The returned response looks like:</p>\n\n<pre><code>{\n  \"sessionId\": \"af4656c27fb94485b7872e1fc616923a\",\n  \"status\": \"ok\",\n  \"value\": {\n    \"browserName\": \"chrome\",\n    ...\n  }\n}\n</code></pre></li>\n</ul>\n\n<p>Which is neither a correctly formed response for the JSON Wire Protocol (where \"status\" would be an integer), nor a correctly formed W3C response and without a correctly formed response, the w3c compatible cannot be used.</p>\n\n<ul>\n<li>Relevant part of the spec: <a href=\"https://w3c.github.io/webdriver/webdriver-spec.html#new-session\" rel=\"noreferrer\">https://w3c.github.io/webdriver/webdriver-spec.html#new-session</a></li>\n<li>Relevant tests from spec: <a href=\"https://github.com/w3c/web-platform-tests/pull/5187\" rel=\"noreferrer\">https://github.com/w3c/web-platform-tests/pull/5187</a></li>\n<li>ChromeDriver version: 2.31.488774 (7e15618d1bf16df8bf0ecf2914ed1964a387ba0b)</li>\n<li>Chrome version: 60.0.3112.90 (Official Build) (64-bit)</li>\n</ul>\n\n<p>This <a href=\"https://chromium.googlesource.com/chromium/src.git/+/851c021e01671de4dce737ddf65efa225e4f3a98\" rel=\"noreferrer\">revision</a> and this <a href=\"https://chromium.googlesource.com/chromium/src/+/851c021e01671de4dce737ddf65efa225e4f3a98\" rel=\"noreferrer\">commit</a> addressed this issue.</p>\n\n<hr>\n\n<h2>This usecase</h2>\n\n<p>As you are using <em>ChromeDriver v75.x</em> and <em>Chrome v75.x</em> and you are still seeing the same error, you need to pass the <em>ExperimentalOption</em> <strong><code>w3c</code></strong> as <strong><code>true</code></strong> exclusively as follows:</p>\n\n<pre><code>capabilities = { \"chromeOptions\" =&gt; {'w3c' =&gt; true} }\n</code></pre>\n\n<hr>\n\n<h2>Update</h2>\n\n<p>Till <em>ChromeDriver v74.x</em>, <em>Chrome</em> and <em>ChromDriver</em> combo was running in w3c mode by default but there was bug with in the <a href=\"https://cs.chromium.org/chromium/src/chrome/test/chromedriver/server/http_handler.cc?l=955\" rel=\"noreferrer\">chromedriver/server/http_handler.cc</a>. As per the details in <a href=\"https://bugs.chromium.org/p/chromedriver/issues/detail?id=2943\" rel=\"noreferrer\">goog:chromeOptions.w3c=false doesn't work for POST request with empty body</a>:</p>\n\n<blockquote>\n  <p>Method <code>HttpHandler::HandleCommand</code> checks the value of the <code>kW3CDefault</code> constant instead of session <code>goog:chromeOptions.w3c</code> value. As a result, JSON Wire protocol support was broken, where POST requests with an empty body are allowed.\n  JSON Wire protocol will be in demand until <strong><code>displayed</code></strong> endpoint is resumed in the w3c mode. It should be noted that W3C WebDriver specification doesn't forbid the use of 'displayed' endpoint and this feature is actively used in some APIs.</p>\n</blockquote>\n\n<p>As <code>Is Element Displayed</code> command is not part of W3C spec, but is still used by some APIs, and its functionality can be difficult to replicate in those APIs. This <em>Change List</em> [<a href=\"https://chromium.googlesource.com/chromium/src.git/+/ee0eff851f71ef95cc4780c9596fcb1750720e43\" rel=\"noreferrer\">revision</a> and <a href=\"https://chromium.googlesource.com/chromium/src/+/ee0eff851f71ef95cc4780c9596fcb1750720e43\" rel=\"noreferrer\">commit</a>] re-enables this command in W3C mode to ease transition to W3C mode.</p>\n\n<p>@John have already confirmed us to expect an update to <strong>ChromeDriver v75.0</strong> tomorrow with the fix.</p>\n\n<hr>\n\n<h2>Here's the solution</h2>\n\n<p>As promised by John Chen [Owner - WebDriver for Google Chrome], <em>ChromeDriver</em> versions <strong>75.0.3770.90</strong> and <strong>76.0.3809.25</strong> have been released, and are now available at the <a href=\"https://sites.google.com/a/chromium.org/chromedriver/downloads\" rel=\"noreferrer\">ChromeDriver Downloads</a> site. These versions include the following bug fixes over the previous releases of <em>ChromeDriver</em> <strong>75</strong> and <strong>76</strong>:</p>\n\n<ul>\n<li>Fixed a bug that incorrectly rejected POST requests with empty body in OSS mode</li>\n<li>Added new endpoints for retrieving Chrome log</li>\n</ul>\n\n<p>In addition, version <strong>76.0.3809.25</strong> also includes the following change:</p>\n\n<ul>\n<li>Added endpoint for Is Displayed command in W3C mode</li>\n</ul>\n\n<hr>\n\n<h2>Snapshot</h2>\n\n<p><img src=\"https://i.stack.imgur.com/Lz7Nm.png\" alt=\"75_76\"></p>\n"}, {"comments": [{"owner": {"reputation": 348, "user_id": 9407678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cdb66cecd9ba2efd9e49acf6ce85aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Deskjokey", "link": "https://stackoverflow.com/users/9407678/deskjokey"}, "edited": false, "score": 1, "creation_date": 1559983505, "post_id": 56490226, "comment_id": 99597533, "body": "Interesting that the more popular options recommend &#39;True&#39;, whereas this option with &#39;False&#39; was the only one that worked for me."}, {"owner": {"reputation": 405, "user_id": 229573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5b79297ab0a0416f31437231526d0d?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/229573/joe"}, "edited": false, "score": 1, "creation_date": 1560096318, "post_id": 56490226, "comment_id": 99617879, "body": "Thank you, this worked a treat for me! My Capybara Chrome setup was as follows (if this helps anyone).  <code>Capybara.register_driver :headless_chrome do |app|   capabilities = Selenium::WebDriver::Remote::Capabilities.chrome(     chromeOptions: {       args: %w[headless disable-gpu],       w3c: false     }   )    Capybara::Selenium::Driver.new(     app,     browser: :chrome,     desired_capabilities: capabilities   ) end</code>  Apologies for the bad formatting of the code."}, {"owner": {"reputation": 607, "user_id": 3210927, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/9c32b2beefffc67829ebf32bba7c7ea4?s=128&d=identicon&r=PG", "display_name": "Arepo", "link": "https://stackoverflow.com/users/3210927/arepo"}, "reply_to_user": {"reputation": 405, "user_id": 229573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5b79297ab0a0416f31437231526d0d?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/229573/joe"}, "edited": false, "score": 0, "creation_date": 1560887598, "post_id": 56490226, "comment_id": 99882214, "body": "@Joe You should post that as a separate answer considering this is a Ruby-specific thread. I wouldn&#39;t have known how to implement Nh\u1eadt Linh Nguy\u1ec5n&#39;s solution without your translation!"}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1560981166, "post_id": 56490226, "comment_id": 99919818, "body": "Please don&#39;t answer ruby questions with python, it confuses readers."}, {"owner": {"reputation": 405, "user_id": 229573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5b79297ab0a0416f31437231526d0d?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/229573/joe"}, "reply_to_user": {"reputation": 607, "user_id": 3210927, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/9c32b2beefffc67829ebf32bba7c7ea4?s=128&d=identicon&r=PG", "display_name": "Arepo", "link": "https://stackoverflow.com/users/3210927/arepo"}, "edited": false, "score": 0, "creation_date": 1562612032, "post_id": 56490226, "comment_id": 100422029, "body": "@Arepo, thanks... although it looks like mahi-man already has."}], "tags": [], "owner": {"reputation": 364, "user_id": 10773911, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WUpGx-119hM/AAAAAAAAAAI/AAAAAAAAAv4/ueNf_Y-CdLI/photo.jpg?sz=128", "display_name": "Linh Nhat Nguyen", "link": "https://stackoverflow.com/users/10773911/linh-nhat-nguyen"}, "is_accepted": false, "score": 23, "last_activity_date": 1559894286, "creation_date": 1559894286, "answer_id": 56490226, "question_id": 56111529, "link": "https://stackoverflow.com/questions/56111529/cannot-call-non-w3c-standard-command-while-in-w3c-mode-seleniumwebdrivererr/56490226#56490226", "title": "Cannot call non W3C standard command while in W3C mode (Selenium::WebDriver::Error::UnknownCommandError) with Selenium ChromeDriver in Cucumber Ruby", "body": "<p>All you have to do is just to disable the W3C when initializing the webdriver</p>\n\n<pre><code>options = webdriver.ChromeOptions()\noptions.add_experimental_option('w3c', False)\ncreate_webdriver('Chrome', options=options)\n</code></pre>\n\n<p>Environment:</p>\n\n<ul>\n<li>Chrome 75  </li>\n<li>ChromeDriver 75</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 2041, "user_id": 2338327, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/10d4977e847588cb4b461de4eb9d1646?s=128&d=identicon&r=PG", "display_name": "Dave Yarwood", "link": "https://stackoverflow.com/users/2338327/dave-yarwood"}, "edited": false, "score": 0, "creation_date": 1564573648, "post_id": 56535585, "comment_id": 101074573, "body": "If you happen to be using Watir, you can do e.g. <code>Watir::Browser.new :chrome, chromeOptions: {w3c: false}</code>"}], "tags": [], "owner": {"reputation": 2871, "user_id": 4553162, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/9281f20accf9593a9f3243eb8fdfa820?s=128&d=identicon&r=PG&f=1", "display_name": "mahi-man", "link": "https://stackoverflow.com/users/4553162/mahi-man"}, "is_accepted": false, "score": 10, "last_activity_date": 1560219277, "creation_date": 1560219277, "answer_id": 56535585, "question_id": 56111529, "link": "https://stackoverflow.com/questions/56111529/cannot-call-non-w3c-standard-command-while-in-w3c-mode-seleniumwebdrivererr/56535585#56535585", "title": "Cannot call non W3C standard command while in W3C mode (Selenium::WebDriver::Error::UnknownCommandError) with Selenium ChromeDriver in Cucumber Ruby", "body": "<p>If you are getting this error using rails + rspec + capybara + selenium, the way to pass the option to disable W3C is as follows:</p>\n\n<pre><code>Capybara.register_driver :chrome do |app|\n  capabilities = Selenium::WebDriver::Remote::Capabilities.chrome(\n    chromeOptions: {'w3c' =&gt; false}\n  )\n  Capybara::Selenium::Driver.new(app, :browser =&gt; :chrome, desired_capabilities: capabilities)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 10336387, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_KF1zR6Iog0/AAAAAAAAAAI/AAAAAAAAIPQ/yzbyPbK7-ck/photo.jpg?sz=128", "display_name": "Dinh Luong", "link": "https://stackoverflow.com/users/10336387/dinh-luong"}, "is_accepted": false, "score": 1, "last_activity_date": 1561017101, "creation_date": 1561017101, "answer_id": 56681427, "question_id": 56111529, "link": "https://stackoverflow.com/questions/56111529/cannot-call-non-w3c-standard-command-while-in-w3c-mode-seleniumwebdrivererr/56681427#56681427", "title": "Cannot call non W3C standard command while in W3C mode (Selenium::WebDriver::Error::UnknownCommandError) with Selenium ChromeDriver in Cucumber Ruby", "body": "<p>Not sure what framework you're using but i have the same error after updating my browser &amp; chromedriver to latest one v75.0.3770.90. My suggestion is that looking for the session init section in your scripts and add the option to disable <code>w3c</code>. \nE.g mine before upgrading: </p>\n\n<pre><code>chrome_options = Selenium::WebDriver::Chrome::Options.new\noptions[:options] = chrome_options\nCapybara::Selenium::Driver.new(app, options)\n</code></pre>\n\n<p>after upgrading </p>\n\n<pre><code>chrome_options = Selenium::WebDriver::Chrome::Options.new\nchrome_options.add_option('w3c',false)\noptions[:options] = chrome_options\nCapybara::Selenium::Driver.new(app, options)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11728109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b245011bfd76c4e256dde941f9b2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11728109/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1562055744, "creation_date": 1562055744, "answer_id": 56848210, "question_id": 56111529, "link": "https://stackoverflow.com/questions/56111529/cannot-call-non-w3c-standard-command-while-in-w3c-mode-seleniumwebdrivererr/56848210#56848210", "title": "Cannot call non W3C standard command while in W3C mode (Selenium::WebDriver::Error::UnknownCommandError) with Selenium ChromeDriver in Cucumber Ruby", "body": "<p>Just add w3c: false in the end like in this example:</p>\n\n<pre><code>  capabilities = Selenium::WebDriver::Remote::Capabilities.chrome(chromeOptions: { args: [\"window-size=#{DEFAULT_X_RES},#{DEFAULT_Y_RES}\"], w3c: false })\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1277, "user_id": 1331578, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/g4k9c.png?s=128&g=1", "display_name": "SkorpEN", "link": "https://stackoverflow.com/users/1331578/skorpen"}, "reply_to_user": {"reputation": 83, "user_id": 6695238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/02gVt.png?s=128&g=1", "display_name": "Ziumper", "link": "https://stackoverflow.com/users/6695238/ziumper"}, "edited": false, "score": 1, "creation_date": 1564384655, "post_id": 56971310, "comment_id": 100997829, "body": "JavaScript latest - 4.0.0-alpha.4"}], "tags": [], "owner": {"reputation": 1277, "user_id": 1331578, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/g4k9c.png?s=128&g=1", "display_name": "SkorpEN", "link": "https://stackoverflow.com/users/1331578/skorpen"}, "is_accepted": false, "score": 0, "last_activity_date": 1562767446, "last_edit_date": 1562767446, "creation_date": 1562763734, "answer_id": 56971310, "question_id": 56111529, "link": "https://stackoverflow.com/questions/56111529/cannot-call-non-w3c-standard-command-while-in-w3c-mode-seleniumwebdrivererr/56971310#56971310", "title": "Cannot call non W3C standard command while in W3C mode (Selenium::WebDriver::Error::UnknownCommandError) with Selenium ChromeDriver in Cucumber Ruby", "body": "<p>In my case it was different version of selenium that not supported w3c. Decrease chromedriver to version 74.0.3729.6 make all work work. It could also be fixed by updateing selenium version to latest that support W3C. </p>\n"}, {"tags": [], "owner": {"reputation": 308, "user_id": 5033601, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VwLpT.jpg?s=128&g=1", "display_name": "Tyler Miles", "link": "https://stackoverflow.com/users/5033601/tyler-miles"}, "is_accepted": false, "score": 1, "last_activity_date": 1562817305, "creation_date": 1562817305, "answer_id": 56981428, "question_id": 56111529, "link": "https://stackoverflow.com/questions/56111529/cannot-call-non-w3c-standard-command-while-in-w3c-mode-seleniumwebdrivererr/56981428#56981428", "title": "Cannot call non W3C standard command while in W3C mode (Selenium::WebDriver::Error::UnknownCommandError) with Selenium ChromeDriver in Cucumber Ruby", "body": "<p>For my PHP friends who search the depths of the internet...<br>\nThe newest version of PHPUnit_Extensions_Selenium2TestCase</p>\n\n<p>Which is at the moment a composer constraint of </p>\n\n<pre><code>\"phpunit/phpunit-selenium\": \"&gt;=7\",\n\"phpunit/phpunit\": \"&gt;=6\" \n</code></pre>\n\n<p>Can use the following options. Note my struggle:: </p>\n\n<p><strong>'w3c' => false</strong> </p>\n\n<p>This must be a boolean and not a string. </p>\n\n<pre><code>class NavigationTest extends PHPUnit_Extensions_Selenium2TestCase\n{\n\n    public function setUp()\n    {\n        static $count;\n        $count or $count = 1 and print PHP_EOL . 'java -jar ' . dirname(__DIR__) . '/selenium-server-standalone-3.141.59.jar' . PHP_EOL;\n        self::shareSession(true);\n        $this-&gt;setDesiredCapabilities([\n            \"chromeOptions\" =&gt; [\n                'w3c' =&gt; false\n            ]\n        ]);\n        $this-&gt;setHost('localhost');\n        $this-&gt;setPort(4444);\n        $this-&gt;setBrowser('chrome');\n        $this-&gt;setBrowserUrl('http://localhost:9919/');\n        $this-&gt;prepareSession()-&gt;currentWindow()-&gt;maximize();\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 11492553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db77467aaee3fbd61f7e6107e01470f1?s=128&d=identicon&r=PG&f=1", "display_name": "sugu", "link": "https://stackoverflow.com/users/11492553/sugu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23999, "favorite_count": 9, "protected_date": 1583442728, "answer_count": 7, "score": 18, "last_activity_date": 1583438335, "creation_date": 1557747493, "last_edit_date": 1559723078, "question_id": 56111529, "link": "https://stackoverflow.com/questions/56111529/cannot-call-non-w3c-standard-command-while-in-w3c-mode-seleniumwebdrivererr", "title": "Cannot call non W3C standard command while in W3C mode (Selenium::WebDriver::Error::UnknownCommandError) with Selenium ChromeDriver in Cucumber Ruby", "body": "<p>We have Cucumber Ruby automation framework where we run few tests on Chrome headless browser in a Docker on Jenkins. A few days ago we started receiving an error \"This version of ChromeDriver only supports Chrome version 75\" this time we were using ChromeDriver 2.46 and with google-chrome-unstable browser using the following command:</p>\n\n<pre><code>#Chrome\nRUN wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -\nRUN echo \"deb http://dl.google.com/linux/chrome/deb/ stable main\" &gt;&gt; /etc/apt/sources.list.d/google.list\nRUN apt-get update -y\nRUN apt-get install -y google-chrome-unstable\nRUN apt-get install unzip\n\n# Set up Chromedriver Environment variables\nENV CHROMEDRIVER_VERSION 2.46\nENV CHROMEDRIVER_VERSION 75.0.3770.8\nENV CHROMEDRIVER_DIR /chromedriver\nRUN mkdir $CHROMEDRIVER_DIR\n# Download and install Chromedriver\nRUN wget -q --continue -P $CHROMEDRIVER_DIR \"http://chromedriver.storage.googleapis.com/$CHROMEDRIVER_VERSION/chromedriver_linux64.zip\"\nRUN unzip $CHROMEDRIVER_DIR/chromedriver* -d $CHROMEDRIVER_DIR\nENV PATH $CHROMEDRIVER_DIR:$PATH\n</code></pre>\n\n<p>I have now updated chromedriver version to <code>75.0.3770.8</code> and browser to <code>google-chrome-beta=75.0.3770.27-1</code></p>\n\n<pre><code>#Chrome\nRUN wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -\nRUN echo \"deb http://dl.google.com/linux/chrome/deb/ stable main\" &gt;&gt; /etc/apt/sources.list.d/google.list\nRUN apt-get update -y\nRUN apt-get install -y google-chrome-beta=75.0.3770.27-1\nRUN apt-get install unzip\n\n# Set up Chromedriver Environment variables\nENV CHROMEDRIVER_VERSION 75.0.3770.8\nENV CHROMEDRIVER_DIR /chromedriver\nRUN mkdir $CHROMEDRIVER_DIR\nRUN echo $CHROMEDRIVER_DIR\n# Download and install Chromedriver\nRUN wget -q --continue -P $CHROMEDRIVER_DIR \"http://chromedriver.storage.googleapis.com/$CHROMEDRIVER_VERSION/chromedriver_linux64.zip\"\nRUN unzip $CHROMEDRIVER_DIR/chromedriver* -d $CHROMEDRIVER_DIR\nENV PATH $CHROMEDRIVER_DIR:$PATH\n</code></pre>\n\n<p>And now I can see the error as:</p>\n\n<blockquote>\n  <p><strong><code>unknown command: Cannot call non W3C standard command while in W3C mode (Selenium::WebDriver::Error::UnknownCommandError)</code></strong></p>\n</blockquote>\n\n<p>Is it possible to disable W3C mode or download an older version of Chrome browser and driver that doesn't use it? I think the possibility to disable W3C check would be great.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authentication", "devise", "omniauth"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 8319323, "user_type": "registered", "profile_image": "https://graph.facebook.com/1344036448998167/picture?type=large", "display_name": "Anatolii Stupin", "link": "https://stackoverflow.com/users/8319323/anatolii-stupin"}, "edited": false, "score": 0, "creation_date": 1557756845, "post_id": 56112930, "comment_id": 98861941, "body": "You are right. After deleting omniauth.rb it works fine as I needed. This lines of code I took from <a href=\"https://github.com/joshrowley/omniauth-trello\" rel=\"nofollow noreferrer\">github.com/joshrowley/omniauth-trello</a>. Thank you!"}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": true, "score": 2, "last_activity_date": 1557752895, "last_edit_date": 1557752895, "creation_date": 1557752542, "answer_id": 56112930, "question_id": 56111492, "link": "https://stackoverflow.com/questions/56111492/callback-for-omniauth-trello-ror-cant-sign-in/56112930#56112930", "title": "Callback for Omniauth-Trello (RoR) - can&#39;t sign in", "body": "<p>The error is right there in your log:\n<code>Authentication failure! service_unavailable: Net::HTTPFatalError, 500 \"Internal Server Error\"</code></p>\n\n<p>Your callback isn't being hit because you've inserted the <code>OmniAuth::Builder</code> middleware. You could try removing that and inspecting the <code>params</code> that are sent along with the callback.</p>\n\n<p>Once you're removed the middleware you can drop a <code>byebug</code> or a <code>binding.pry</code> at the top of your callback action. Once you're in the debugger check the value of <code>request.env['omniauth.auth']</code>. That should give you some insight as to what the problem is. Hard to say more without knowing more about the environment.</p>\n"}], "owner": {"reputation": 119, "user_id": 8319323, "user_type": "registered", "profile_image": "https://graph.facebook.com/1344036448998167/picture?type=large", "display_name": "Anatolii Stupin", "link": "https://stackoverflow.com/users/8319323/anatolii-stupin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 56112930, "answer_count": 1, "score": 1, "last_activity_date": 1557752895, "creation_date": 1557747353, "question_id": 56111492, "link": "https://stackoverflow.com/questions/56111492/callback-for-omniauth-trello-ror-cant-sign-in", "title": "Callback for Omniauth-Trello (RoR) - can&#39;t sign in", "body": "<p>I am using RoR 5.2, devise and omniauth-trello gem.\nI can't sign in with Trello. \nI need to create ability to sign in without existing user with returned provider and uid: it should create user if it doesn't exist.</p>\n\n<p>I have already added in <strong>config/routes.rb:</strong></p>\n\n<pre><code>devise_for :users, controllers: { omniauth_callbacks: 'omniauth_callbacks' }\n</code></pre>\n\n<p><strong>config/initializers/devise.rb:</strong></p>\n\n<pre><code>config.omniauth :trello, \"#{Rails.application.credentials.trello[:key]}\", \"#{Rails.application.credentials.trello[:secret]}\"\n</code></pre>\n\n<p><strong>config/initializers/omniauth.rb</strong></p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n      provider :trello, Rails.application.credentials.trello[:key], Rails.application.credentials.trello[:secret],\n               app_name: \"Trello-Rooney\", scope: 'read,write,account', expiration: 'never'\nend\n</code></pre>\n\n<p><strong>app/controllers/omniauth_callbacks_controller.rb</strong></p>\n\n<pre><code>class OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController\n\n      def trello\n        @user = User.from_omniauth(request.env['omniauth.auth'])\n\n        if @user.persisted?\n          sign_in_and_redirect @user, event: :authentication\n          set_flash_message(:notice, :success, kind: 'Trello') if is_navigational_format?\n        end\n      end\n\nend\n</code></pre>\n\n<p><strong>app/models/user.rb</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable, :omniauthable, omniauth_providers: %i[trello]\n\n\n  def self.from_omniauth(auth)\n    user = User.where(provider: auth.provider, uid: auth.uid.to_s).first\n    return user if user\n\n    email = auth.info[:email]\n\n    while email.nil?\n      generated_email = \"#{SecureRandom.base58(10)}@roonyx.trello\"\n      if User.where(email: generated_email).blank?\n        email = generated_email\n      end\n    end\n\n    user = User.where(email: email).first\n\n    if user\n      user.update(provider: auth.provider, uid: auth.uid)\n    else\n      password = Devise.friendly_token[0, 12]\n      user = User.create!(email: email, password: password, password_confirmation: password, provider: auth.provider, uid: auth.uid)\n    end\n    user\n  end\n\n\nend\n</code></pre>\n\n<p>But when I am trying to sign in with Trello, I see this in console. Looks like it doesn't cause my callback. Can anyone help? Thank you in advance.</p>\n\n<pre><code>E, [2019-05-13T14:10:29.647241 #19958] ERROR -- omniauth: (trello) Authentication failure! service_unavailable: Net::HTTPFatalError, 500 \"Internal Server Error\"\n[2019-05-13 14:10:29] (pida=19958)   INFO -- : Processing by OmniauthCallbacksController#failure as HTML\n[2019-05-13 14:10:29] (pida=19958)   INFO -- :   Parameters: {\"oauth_token\"=&gt;\"47215df2b25b4fc089953da32acf0730\", \"oauth_verifier\"=&gt;\"8a0b310f2afe98d0aebbd2073efc5b54\"}\n[2019-05-13 14:10:29] (pida=19958)   INFO -- : Redirected to http://localhost:3000/users/sign_in\n[2019-05-13 14:10:29] (pida=19958)   INFO -- : Completed 302 Found in 1ms (ActiveRecord: 0.0ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes", "overloading"], "comments": [{"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 1, "creation_date": 1557745449, "post_id": 56110644, "comment_id": 98855647, "body": "instead of resources :customers use namespace :customers"}, {"owner": {"reputation": 687, "user_id": 409096, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sDacS.jpg?s=128&g=1", "display_name": "Javier Valencia", "link": "https://stackoverflow.com/users/409096/javier-valencia"}, "reply_to_user": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 0, "creation_date": 1557745502, "post_id": 56110644, "comment_id": 98855674, "body": "@vishal, customers it&#39;s a controller too."}, {"owner": {"reputation": 1659, "user_id": 5090346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HXbu3.png?s=128&g=1", "display_name": "Brainmaniac", "link": "https://stackoverflow.com/users/5090346/brainmaniac"}, "edited": false, "score": 0, "creation_date": 1557746411, "post_id": 56110644, "comment_id": 98856067, "body": "can you ssh in on the server and run: <code>rails routes -c absences</code> ? what does it say?"}, {"owner": {"reputation": 687, "user_id": 409096, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sDacS.jpg?s=128&g=1", "display_name": "Javier Valencia", "link": "https://stackoverflow.com/users/409096/javier-valencia"}, "reply_to_user": {"reputation": 1659, "user_id": 5090346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HXbu3.png?s=128&g=1", "display_name": "Brainmaniac", "link": "https://stackoverflow.com/users/5090346/brainmaniac"}, "edited": false, "score": 0, "creation_date": 1557746483, "post_id": 56110644, "comment_id": 98856108, "body": "@Brainmaniac it&#39;s the second code block."}, {"owner": {"reputation": 1659, "user_id": 5090346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HXbu3.png?s=128&g=1", "display_name": "Brainmaniac", "link": "https://stackoverflow.com/users/5090346/brainmaniac"}, "edited": false, "score": 0, "creation_date": 1557746752, "post_id": 56110644, "comment_id": 98856245, "body": "So that code block is from the server and not local where it works? If so please define where the extract is from. If I understand correctly you are happy with the outcome of the results from rails <code>routes -c absences</code> ? The problem occurs when accessing the URL in the browser in production?"}, {"owner": {"reputation": 687, "user_id": 409096, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sDacS.jpg?s=128&g=1", "display_name": "Javier Valencia", "link": "https://stackoverflow.com/users/409096/javier-valencia"}, "reply_to_user": {"reputation": 1659, "user_id": 5090346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HXbu3.png?s=128&g=1", "display_name": "Brainmaniac", "link": "https://stackoverflow.com/users/5090346/brainmaniac"}, "edited": false, "score": 0, "creation_date": 1557748187, "post_id": 56110644, "comment_id": 98856955, "body": "@Brainmaniac Then block it&#39;s &quot;rendered&quot; with the same output in all environment. Yes, the problem occurs when rails receive the request."}, {"owner": {"reputation": 687, "user_id": 409096, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sDacS.jpg?s=128&g=1", "display_name": "Javier Valencia", "link": "https://stackoverflow.com/users/409096/javier-valencia"}, "edited": false, "score": 0, "creation_date": 1557755074, "post_id": 56110644, "comment_id": 98860871, "body": "The block, sorry."}, {"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1557773047, "post_id": 56110644, "comment_id": 98869531, "body": "Try changing <code>scope module: :employee, path: :employee, as: :employee</code> to <code>namespace :employee</code>."}, {"owner": {"reputation": 1659, "user_id": 5090346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HXbu3.png?s=128&g=1", "display_name": "Brainmaniac", "link": "https://stackoverflow.com/users/5090346/brainmaniac"}, "edited": false, "score": 0, "creation_date": 1557820218, "post_id": 56110644, "comment_id": 98882816, "body": "can u post your preffered outcome of: rails routes -c absences"}], "owner": {"reputation": 687, "user_id": 409096, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sDacS.jpg?s=128&g=1", "display_name": "Javier Valencia", "link": "https://stackoverflow.com/users/409096/javier-valencia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557783728, "creation_date": 1557743954, "last_edit_date": 1557783728, "question_id": 56110644, "link": "https://stackoverflow.com/questions/56110644/rails-controllers-overriding-routes-with-namespace", "title": "Rails Controllers overriding routes with namespace", "body": "<p>I have a Rails app with routes defined with namespace;</p>\n\n<p>routes.rb:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>resources :customers do\n  resources :employees do\n    # [1] First absence controller\n    resources :absences, only: %i{ index new create } do\n      # omit verbose\n    end\n  end\nend\n\nscope module: :employee, path: :employee, as: :employee do\n  # [2] Second absence controller\n  resources :absences, only: %i{ index new create } do\n    # omit verbose\n  end\nend\n</code></pre>\n\n<p>Extract from <code>rails routes -c absences</code>:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>                            Prefix Verb URI Pattern                                                                    Controller#Action\nreported_customer_employee_absence POST /customers/:customer_id/employees/:employee_id/absences/:id/reported(.:format) absences#reported\n        customer_employee_absences GET  /customers/:customer_id/employees/:employee_id/absences(.:format)              absences#index\n                                   POST /customers/:customer_id/employees/:employee_id/absences(.:format)              absences#create\n     new_customer_employee_absence GET  /customers/:customer_id/employees/:employee_id/absences/new(.:format)          absences#new\n            avoid_employee_absence POST /employee/absences/:id/avoid(.:format)                                         employee/absences#avoid\n                 employee_absences GET  /employee/absences(.:format)                                                   employee/absences#index\n                                   POST /employee/absences(.:format)                                                   employee/absences#create\n              new_employee_absence GET  /employee/absences/new(.:format)                                               employee/absences#new\n\n</code></pre>\n\n<p>All runs as expected in development and test environment.</p>\n\n<p><strong>But in production environment</strong> the problem it's when it's invoked 'employee/absences' urls, Rails it's running the first [1] not the second [2] controller.</p>\n\n<p>My versions:</p>\n\n<pre><code> Env  | Ruby      | Rails   | Gem\n--------------------------------------\n Dev  | 2.5.1p57  | 5.2.3   | 2.7.6\n Test | 2.5.6p159 | 5.2.2.1 | 2.7.6.2\n Prod | 2.3.3p222 | 5.2.3   | 2.5.2.1\n</code></pre>\n\n<p>-- Added later --</p>\n\n<p>Maybe it's a declaration issue:</p>\n\n<p>absences_controller.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class AbsencesController &lt; ApplicationController\nend\n</code></pre>\n\n<p>employee/absences_controller.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Employee::AbsencesController &lt; Employee::ApplicationController\nend\n</code></pre>\n\n<p>How <code>employee/absence_controller.rb</code> it's the first controller in employee namespace it's having a problem or something like this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 222, "user_id": 1969191, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/05e6a7d87060d5d765deb8bbb95e804b?s=128&d=identicon&r=PG", "display_name": "user1969191", "link": "https://stackoverflow.com/users/1969191/user1969191"}, "edited": false, "score": 0, "creation_date": 1557749087, "post_id": 56110744, "comment_id": 98857422, "body": "Hi eyevan, I am still getting same error. Please find my irb output: OpenSSL::PKey::RSAError: Neither PUB key nor PRIV key: nested asn1 error \tfrom (irb):7:in <code>initialize&#39; \tfrom (irb):7:in </code>new&#39; \tfrom (irb):7 \tfrom /home/organizer/.rvm/rubies/ruby-2.3.7/bin/irb:11:in `&lt;main&gt;&#39; 2.3.7 :008 &gt;"}, {"owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "reply_to_user": {"reputation": 222, "user_id": 1969191, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/05e6a7d87060d5d765deb8bbb95e804b?s=128&d=identicon&r=PG", "display_name": "user1969191", "link": "https://stackoverflow.com/users/1969191/user1969191"}, "edited": false, "score": 0, "creation_date": 1557753076, "post_id": 56110744, "comment_id": 98859641, "body": "@user1969191please paste the code you are executing. Also please try pasting the example above into a file and running it and see if that works for you."}], "tags": [], "owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "is_accepted": false, "score": 0, "last_activity_date": 1557744264, "creation_date": 1557744264, "answer_id": 56110744, "question_id": 56110358, "link": "https://stackoverflow.com/questions/56110358/unable-to-generate-opensslpkey-object/56110744#56110744", "title": "Unable to generate OpenSSL::PKey object", "body": "<ol>\n<li>You don't need to decode base64 manually.</li>\n<li>Make sure that the key is formatted correctly: <code>BEGIN PUBLIC KEY</code> and <code>END PUBLIC KEY</code> should be on separate lines.</li>\n</ol>\n\n<p>Working example:\n</p>\n\n<pre><code>require \"openssl\"\n\nkey = \"-----BEGIN PUBLIC KEY-----\\n\" \\\n\"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAttI6ImgD74PhHWVqnrqSOmStboplyL02DB3/nc2iyDdYLzXoBIQN+NPMBPlsZlEKuKjsg5Ycfp6VjcmncM3CH9MGIr+Lmbj1HZmO/jJGJ84RPhzYOiZuElzs3seIcOtOa3BpFeqRsXJlrf1IVBKVU3erka5ACLVyrsjmp/VXMx5QjPD0qXARMGb6rDewTkyg3pGz07Y7rZgXkTl54ase+XaPegOankxdEQhVjPdrk7eSlIQS5Ni7FAcSyTOtYoPgiP7W0PolOMHvpFg96CHjc8V8xDsFdh0wbHd49WcKxiJMIfL65VUIW5aob9fw05a5FczyASa0iNtRiICy/QnCqQIDAQAB\\n\" \\\n\"-----END PUBLIC KEY-----\"\n\np OpenSSL::PKey::RSA.new(key)\n</code></pre>\n"}], "owner": {"reputation": 222, "user_id": 1969191, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/05e6a7d87060d5d765deb8bbb95e804b?s=128&d=identicon&r=PG", "display_name": "user1969191", "link": "https://stackoverflow.com/users/1969191/user1969191"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557744264, "creation_date": 1557742856, "last_edit_date": 1557743178, "question_id": 56110358, "link": "https://stackoverflow.com/questions/56110358/unable-to-generate-opensslpkey-object", "title": "Unable to generate OpenSSL::PKey object", "body": "<p>I want to generate a openSSL::Pkey using public key but i am getting the following error message \"OpenSSL::PKey::RSAError: Neither PUB key nor PRIV key: nested asn1 error\"</p>\n\n<p>This is the public key:</p>\n\n<blockquote>\n  <p>-----BEGIN PUBLIC KEY-----\n  MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAttI6ImgD74PhHWVqnrqSOmStboplyL02DB3/nc2iyDdYLzXoBIQN+NPMBPlsZlEKuKjsg5Ycfp6VjcmncM3CH9MGIr+Lmbj1HZmO/jJGJ84RPhzYOiZuElzs3seIcOtOa3BpFeqRsXJlrf1IVBKVU3erka5ACLVyrsjmp/VXMx5QjPD0qXARMGb6rDewTkyg3pGz07Y7rZgXkTl54ase+XaPegOankxdEQhVjPdrk7eSlIQS5Ni7FAcSyTOtYoPgiP7W0PolOMHvpFg96CHjc8V8xDsFdh0wbHd49WcKxiJMIfL65VUIW5aob9fw05a5FczyASa0iNtRiICy/QnCqQIDAQAB\n  -----END PUBLIC KEY-----</p>\n</blockquote>\n\n<p>This the code which is generating the error</p>\n\n<pre><code>OpenSSL::PKey::RSA.new (Base64.decode64(public_key))\n</code></pre>\n\n<p>Anyone know how to fix it and can tell whats wrong with the key. Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1557787844, "post_id": 56110153, "comment_id": 98874443, "body": "You wan&#39;t to permanently remove it or just temporarilly for that particular action? I think you are having that problem because you are asigning the objects to the association. Can you show your use case for this? maybe you can use something better like a  named scope instead of that."}], "answers": [{"comments": [{"owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "edited": false, "score": 0, "creation_date": 1557755281, "post_id": 56110368, "comment_id": 98860982, "body": "I am familiar with this approach, where I can filter out the unwanted items straight on the AR level... however, I need to fetch all statuses and then, on the Ruby level, filter out the unwanted ones..."}, {"owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "reply_to_user": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "edited": false, "score": 0, "creation_date": 1557756981, "post_id": 56110368, "comment_id": 98862035, "body": "<code>status_collection = status_collection.select { |car_stat| car_stat.keyword != &#39;USED&#39; }</code>"}, {"owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "edited": false, "score": 1, "creation_date": 1557758607, "post_id": 56110368, "comment_id": 98862951, "body": "You could go with <code>reject</code> instead of using <code>select</code> and <code>!=</code>."}], "tags": [], "owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "is_accepted": false, "score": 2, "last_activity_date": 1557780879, "last_edit_date": 1557780879, "creation_date": 1557742890, "answer_id": 56110368, "question_id": 56110153, "link": "https://stackoverflow.com/questions/56110153/how-to-remove-an-object-from-the-activerecordrelation-object/56110368#56110368", "title": "How to remove an object from the ActiveRecord::Relation object", "body": "<p><code>CarStatusDefinition.where.not(keyword: \"USED\")</code> will filter out all the CarStatusDefinition with keyword USED</p>\n"}], "owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557785700, "creation_date": 1557742082, "question_id": 56110153, "link": "https://stackoverflow.com/questions/56110153/how-to-remove-an-object-from-the-activerecordrelation-object", "title": "How to remove an object from the ActiveRecord::Relation object", "body": "<p>I am loading data from the DB and get it back in this object:</p>\n\n<pre><code>#&lt;ActiveRecord::Relation [#&lt;CarStatusDefinition id: 10, status_name: \"New Approval\", keyword: 'NEW', ...&gt;, #&lt;CarStatusDefinition id: 11, status_name: \"Used\", keyword: 'USED', ...&gt;, ...]&gt;\n</code></pre>\n\n<p>When I have this data loaded in ruby, then, in some cases, I need to remove an item in this object - specifically, the one with the keyword <strong>USED</strong>.</p>\n\n<p>I tried to do it like this:</p>\n\n<pre><code>if @record.used.blank?\n  status_collection = status_collection.reject! { |hash| hash[:keyword] == 'USED' }\nend\n</code></pre>\n\n<p>However, the item with the keyword <strong>USED</strong> (with <code>id 11</code> is still included in the final object).</p>\n\n<p>How do I remove the object with id <code>11</code> from the final hash? What am I overlooking here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557741200, "post_id": 56109855, "comment_id": 98853331, "body": "Does that mean when I do calculations involving the string there will be no escape characters present?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557741217, "post_id": 56109855, "comment_id": 98853336, "body": "There <b>aren&#39;t</b> any escape characters present."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557741257, "post_id": 56109855, "comment_id": 98853362, "body": "Try using <code>puts</code>, to print the string to the console."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557741413, "post_id": 56109855, "comment_id": 98853450, "body": "For another example, suppose you have <code>x = &quot;\\n&quot;</code>. When <i>inspecting</i> the value, you see <code>\\n</code> displayed literally. But when printing it, you see this is displayed &quot;normally&quot; (as a new line). Inspecting strings is a much more convenient way of being able to tell, unambiguously, exactly what the real value is."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1557741645, "post_id": 56109855, "comment_id": 98853607, "body": "Yup - I can see now you need some way to distinguish quote marks included in the string vs quote marks denoting the start of the string - thanks again"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1557741133, "creation_date": 1557741133, "answer_id": 56109855, "question_id": 56109668, "link": "https://stackoverflow.com/questions/56109668/accessing-string-in-database-without-adding-escape-characters/56109855#56109855", "title": "Accessing string in database without adding escape characters", "body": "<p>There aren't any escape characters.</p>\n\n<p>What you're looking at is the <em>representation</em> of the string when <em>inspected</em> on the console.</p>\n\n<p>Consider the following:</p>\n\n<pre><code>irb(main):001:0&gt; x = '\"hello\"'\n=&gt; \"\\\"hello\\\"\"\nirb(main):002:0&gt; puts x\n\"hello\"\n</code></pre>\n\n<p>The string does not contain any backslashes. But when <em>inspecting</em> it, backslashes must be present in order to distinguish \"end of string\" vs \"quotation mark, inside the string\".</p>\n"}, {"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1557741139, "creation_date": 1557741139, "answer_id": 56109857, "question_id": 56109668, "link": "https://stackoverflow.com/questions/56109668/accessing-string-in-database-without-adding-escape-characters/56109857#56109857", "title": "Accessing string in database without adding escape characters", "body": "<p>The least ugly way I can do this is:</p>\n\n<pre><code>JSON.parse(string.gsub(\"=&gt;\", \":\").gsub(\":nil,\", \":null,\"))\n</code></pre>\n\n<p>If anyone has a less ugly way please let me know</p>\n"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 56109855, "answer_count": 2, "score": 1, "last_activity_date": 1557741139, "creation_date": 1557740451, "question_id": 56109668, "link": "https://stackoverflow.com/questions/56109668/accessing-string-in-database-without-adding-escape-characters", "title": "Accessing string in database without adding escape characters", "body": "<p>I have the following:</p>\n\n<pre><code>create_table \"events\", options: \"ENGINE=InnoDB DEFAULT CHARSET=latin1\", force: :cascade do |t|\n  t.string \"meta_data\"\nend\n</code></pre>\n\n<p>When I open up Valentina Studio and look at the events table I can see one record:</p>\n\n<pre><code>ID           meta_data      \n1         {\"action\"=&gt;\"bla\"} \n</code></pre>\n\n<p>When I call <code>Event.last.meta_data</code> I receive the following string:</p>\n\n<p><code>\"{\\\"action\\\"=&gt;\\\"bla\\\"}</code></p>\n\n<p>How can I get this string value without the escape characters? I've tried deep transforming and simply gsubbing but neither of these feel like I'm doing it right..</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby", "logstash", "elk"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7797466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1959d547c36b33f8f9bc187187608b77?s=128&d=identicon&r=PG&f=1", "display_name": "dushyant nasit", "link": "https://stackoverflow.com/users/7797466/dushyant-nasit"}, "is_accepted": false, "score": 1, "last_activity_date": 1558072264, "creation_date": 1558072264, "answer_id": 56180368, "question_id": 56108952, "link": "https://stackoverflow.com/questions/56108952/failed-to-execute-action-action-logstashpipelineactioncreate-pipeline-idm/56180368#56180368", "title": "Failed to execute action :action=&gt;LogStash::PipelineAction::Create/pipeline_id:main", "body": "<p>I think you are cofiguration json format not parsing in logstash.yml file</p>\n\n<p>put simple configuration like blow</p>\n\n<pre><code>input {     \n  beats {\n    port =&gt; 5044\n }\n}\noutput {\n stdout { codec =&gt; rubydebug }  \n\n elasticsearch {\n  hosts =&gt; [\"http://ip:9200\"]\n }\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 5238110, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/twC9O.jpg?s=128&g=1", "display_name": "nimda", "link": "https://stackoverflow.com/users/5238110/nimda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1687, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558072264, "creation_date": 1557738064, "question_id": 56108952, "link": "https://stackoverflow.com/questions/56108952/failed-to-execute-action-action-logstashpipelineactioncreate-pipeline-idm", "title": "Failed to execute action :action=&gt;LogStash::PipelineAction::Create/pipeline_id:main", "body": "<p>I have installed ELK stack version 7.0.0 on my CentOS7 VM and I faced with an issue during Logstash service start:</p>\n\n<p>[ERROR] 2019-05-13 08:21:37.359 [Converge PipelineAction::Create] agent - Failed to execute action {:action=>LogStash::PipelineAction::Create/pipeline_id:main, :exception=>\"MultiJson::ParseError\", :message=>\"JrJackson::ParseError\", :backtrace=>[\"/usr/share/logstash/vendor/bundle/jruby/2.5.0/gems/multi_json-1.13.1/lib/multi_json/adapter.rb:20:in <code>load'\", \"/usr/share/logstash/vendor/bundle/jruby/2.5.0/gems/multi_json-1.13.1/lib/multi_json.rb:122:in</code>load'\", \"/usr/share/logstash/vendor/bundle/jruby/2.5.0/gems/avro-1.8.2/lib/avro/schema.rb:36:in <code>parse'\", \"/usr/share/logstash/vendor/bundle/jruby/2.5.0/gems/logstash-codec-avro-3.2.3-java/lib/logstash/codecs/avro.rb:69:in</code>register'\", \"/usr/share/logstash/logstash-core/lib/logstash/codecs/base.rb:18:in <code>initialize'\", \"org/logstash/plugins/PluginFactoryExt.java:255:in</code>plugin'\", \"org/logstash/execution/JavaBasePipelineExt.java:50:in <code>initialize'\", \"/usr/share/logstash/logstash-core/lib/logstash/java_pipeline.rb:23:in</code>initialize'\", \"/usr/share/logstash/logstash-core/lib/logstash/pipeline_action/create.rb:36:in <code>execute'\", \"/usr/share/logstash/logstash-core/lib/logstash/agent.rb:325:in</code>block in converge_state'\"]}</p>\n\n<p>Please help to figure out a way to resolve this issue. Similar installation on another Centos VM is working fine. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1557731421, "post_id": 56107203, "comment_id": 98848272, "body": "The method <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-2A\" rel=\"nofollow noreferrer\">String#*</a> in <code>&quot;2&quot; * p1</code> requires an integer for it&#39;s argument, but <code>p1</code> is an instance of <code>Point</code>. Ruby is unable to coerce <code>p1</code> into an integer."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1557731459, "post_id": 56107203, "comment_id": 98848287, "body": "What do you expect <code>&quot;2&quot; * p1</code> to return?"}, {"owner": {"reputation": 111, "user_id": 9176388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ac9bee37645845146c3876f398c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/9176388/martin"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1557731613, "post_id": 56107203, "comment_id": 98848368, "body": "@spickermann  I want it works like   2 * p1"}, {"owner": {"reputation": 111, "user_id": 9176388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ac9bee37645845146c3876f398c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/9176388/martin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557731693, "post_id": 56107203, "comment_id": 98848398, "body": "@CarySwoveland Why ruby not call coerce just like 2 * p1. how can i make it work like that? thanks"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1557735247, "post_id": 56107203, "comment_id": 98849996, "body": "You haven&#39;t answered @spickermann&#39;s question. <code>p1</code> is an instance you have defined. In doing so you set the values of two instance variables equal to <code>1</code>. Do you want <code>&quot;2&quot; * p1</code> to return <code>&#39;cat&#39;</code> or <code>324</code> or <code>[&#39;2&#39;, &#39;2&#39;]</code>? No? Then what should it return?"}, {"owner": {"reputation": 111, "user_id": 9176388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ac9bee37645845146c3876f398c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/9176388/martin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557735683, "post_id": 56107203, "comment_id": 98850198, "body": "@CarySwoveland,  I want: &quot;2&quot; * p1 #return &lt;Point: @x=2,@y=2&gt; if p1 is &lt;Point: @x=1,@y=1) and I wonder why the coerce is not tirggered like 2*p1. and how to make it triggered?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1557736040, "post_id": 56107203, "comment_id": 98850387, "body": "@Martin You <b>could</b> re-define the <code>*</code> method on <code>String</code>, but that&#39;s not a good idea. What is <code>&quot;x&quot; * &quot;y&quot;</code>? You get the same error as above, because it doesn&#39;t make any sense. <code>string * something</code> is expected to return another String; it would be very weird if that method suddenly behaved like <code>Point * Integer</code>."}, {"owner": {"reputation": 111, "user_id": 9176388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ac9bee37645845146c3876f398c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/9176388/martin"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1557736579, "post_id": 56107203, "comment_id": 98850667, "body": "@TomLord, thanks. yes, I know it&#39;s weird.  I am trying to figure out why the coerce function is not triggered if I use (String)*(Point) instead of (Integer)*(Point)? The reason is that the String has a function of (String)*(Integer)?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 5, "creation_date": 1557738861, "post_id": 56107203, "comment_id": 98851957, "body": "@Martin type coercion is not a general built-in language feature. <code>coerce</code> works for numeric operation only because those operator methods call <code>coerce</code> explicitly. <code>String</code> does not."}, {"owner": {"reputation": 111, "user_id": 9176388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ac9bee37645845146c3876f398c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/9176388/martin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1557742953, "post_id": 56107203, "comment_id": 98854341, "body": "@Stefan, Thank you very much! I understand it now. I took coercion as a general feature. Thanks!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557765785, "post_id": 56107203, "comment_id": 98866595, "body": "Here&#39;s an example of numeric coercion. The instance method <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-2A\" rel=\"nofollow noreferrer\">String#*</a> expects an argument that is a non-negative integer, such as <code>&quot;2&quot; * 3 #=&gt; &quot;222&quot;</code>. However, Ruby will allow the argument to be other types of numeric values, which it will convert to an integer. Here are some examples: <code>&quot;2&quot; * 3.0 #=&gt; &quot;222&quot;; &quot;2&quot; * 3.5 #=&gt; &quot;222&quot;; &quot;2&quot; * Rational(10,3) #=&gt; &quot;222&quot;; require &#39;bigdecimal&#39;; &quot;s&quot; * BigDecimal(3) #=&gt; &quot;sss&quot;</code>. This does not apply to all numeric types, however:  <code>&quot;2&quot; * Complex(3,5) #=&gt; RangeError (can&#39;t convert 3+5i into Integer)</code>."}, {"owner": {"reputation": 111, "user_id": 9176388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ac9bee37645845146c3876f398c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/9176388/martin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557800738, "post_id": 56107203, "comment_id": 98876701, "body": "@CarySwoveland, thanks. I had taken the coercion as a general feature before Stefan explained that to me. I was trying to make it a general feature."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1557766238, "post_id": 56116115, "comment_id": 98866776, "body": "Though not your main point (I was glad to see you use <code>send</code> in your explanation), if Martin wants <code>p1 * &quot;2&quot;</code> to return the same value as <code>p2 * 2</code> one could write <code>def * x;  p &quot;* called&quot;; n = x.to_i; @x *= n; @y *= n; end</code>, since <code>&#39;2&#39;.to_i #=&gt; 2</code> and <code>2.to_i #=&gt; 2</code>."}, {"owner": {"reputation": 111, "user_id": 9176388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ac9bee37645845146c3876f398c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/9176388/martin"}, "edited": false, "score": 0, "creation_date": 1557801001, "post_id": 56116115, "comment_id": 98876746, "body": "thanks, @tadman.Just as Cary Swoveland said. I was trying to make coercion a general feature. And I Did try to patch the String class to trigger the coerce of the Point. but I did it ugly. Does anyone have an elegant way (to Patch the String class)?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1557873653, "post_id": 56116115, "comment_id": 98909711, "body": "That&#39;s something you&#39;re really not supposed to do, so it&#39;s ugly on purpose. A feature, not a bug, of the Ruby language. You <i>can</i> do it, but they won&#39;t make it easy."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1557763692, "creation_date": 1557763692, "answer_id": 56116115, "question_id": 56107203, "link": "https://stackoverflow.com/questions/56107203/why-coerce-not-triggered-when-i-use-point/56116115#56116115", "title": "Why coerce not triggered when i use &quot;&quot;*Point", "body": "<p>The catch here is that while Ruby allows you to redefine operators for this, these are very particular about the ordering.</p>\n\n<p>Remember that this code:</p>\n\n<pre><code>point * 2\n</code></pre>\n\n<p>Ends up being understood by Ruby as:</p>\n\n<pre><code>point.send(:*, 2)\n</code></pre>\n\n<p>Which is the method you have defined that handles this particular case, <code>Point#*</code>.</p>\n\n<p>While this code:</p>\n\n<pre><code>2 * point\n</code></pre>\n\n<p>Ends up being understood as:</p>\n\n<pre><code>2.send(:*, point)\n</code></pre>\n\n<p>Where that goes off to <code>Integer#*</code> and you have no control over that. While you can patch it, that seems like an <em>extraordinarily</em> bad idea. The best thing is to document how your system works and show examples of the correct ordering.</p>\n\n<p>In Ruby the left-hand value in a binary operator basically calls the shots, the right-hand value is just a passenger.</p>\n"}], "owner": {"reputation": 111, "user_id": 9176388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ac9bee37645845146c3876f398c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/9176388/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557778782, "creation_date": 1557730899, "last_edit_date": 1557778782, "question_id": 56107203, "link": "https://stackoverflow.com/questions/56107203/why-coerce-not-triggered-when-i-use-point", "title": "Why coerce not triggered when i use &quot;&quot;*Point", "body": "<p>I am trying to figure out the <code>coerce</code> method. when I defined the <code>*</code> method and <code>coerce</code> method. <code>integer * Point</code> triggers <code>coerce</code>, but <code>\"\" * Point</code> doesn't trigger. Why?</p>\n\n<p>The error is: </p>\n\n<pre><code>coerce.rb:34:in `*': no implicit conversion of Point into Integer (TypeError)   from coerce.rb:34:in `&lt;main&gt;'\n</code></pre>\n\n<p>The code is:</p>\n\n<pre><code>class Point\n  def initialize x,y\n    @x,@y = x,y\n  end\n\n  def * x\n    p \"* called\" \n    @x *= x\n    @y *= x\n  end\n\n  def coerce other\n    p 'coerce called'\n\n    if other.is_a? String\n      p \"converted\"\n      [self, other.to_i]\n    else\n      [self,other]\n    end\n    #[3,other]\n  end\nend\n\np1= Point.new 1,1\np1*2\np p1\n2*p1\np p1\n\np p1.coerce(2)\n\np \"string test=====\"\n\"2\" * p1\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>\"* called\"\n#&lt;Point:0x00564f5de89dd0 @x=2, @y=2&gt;\n\"coerce called\"\n\"* called\"\n#&lt;Point:0x00564f5de89dd0 @x=4, @y=4&gt;\n\"coerce called\"\n[#&lt;Point:0x00564f5de89dd0 @x=4, @y=4&gt;, 2]\n\"string test=====\"\ncoerce.rb:34:in `*': no implicit conversion of Point into Integer (TypeError)\n    from coerce.rb:34:in `&lt;main&gt;'\n</code></pre>\n\n<p>Who can tell me why and how to make <code>\"2\" * p1</code> work?</p>\n"}, {"tags": ["ruby", "libgosu"], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1557739366, "post_id": 56109321, "comment_id": 98852233, "body": "It should be <code>&amp;&amp;</code> instead of <code>and</code> (which is is control flow operator)."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1557739812, "post_id": 56109321, "comment_id": 98852522, "body": "<code>mouse_x.between?(50, 150) &amp;&amp; mouse_y.between?(50, 100)</code>"}, {"owner": {"reputation": 21, "user_id": 9888189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F1qG5FTcAyc/AAAAAAAAAAI/AAAAAAAAAT4/Mfs8OtlOZEI/photo.jpg?sz=128", "display_name": "Elham Najeebullah", "link": "https://stackoverflow.com/users/9888189/elham-najeebullah"}, "edited": false, "score": 0, "creation_date": 1557740772, "post_id": 56109321, "comment_id": 98853086, "body": "Yes now it is in the correct position but the button does not display the text &#39;Click Me&#39;"}], "tags": [], "owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "is_accepted": true, "score": 1, "last_activity_date": 1557739255, "creation_date": 1557739255, "answer_id": 56109321, "question_id": 56106280, "link": "https://stackoverflow.com/questions/56106280/the-problem-is-with-the-x-and-y-position-where-the-mouse-can-be-click-outside-o/56109321#56109321", "title": "The problem is with the x and y position, where the mouse can be click outside of the button", "body": "<p>There is an error in the logic of the mouse position detect in the mouse_over_button method. The mouse is over the button region when all the criteria are met. It should read:</p>\n\n<pre><code>def mouse_over_button(mouse_x, mouse_y)\n  mouse_x &gt; 50 and mouse_x &lt; 150 and mouse_y &gt; 50 and mouse_x &lt; 100\nend\n</code></pre>\n\n<p>I also removed the redundant \"if\" construct as it was not needed.       </p>\n"}], "owner": {"reputation": 21, "user_id": 9888189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F1qG5FTcAyc/AAAAAAAAAAI/AAAAAAAAAT4/Mfs8OtlOZEI/photo.jpg?sz=128", "display_name": "Elham Najeebullah", "link": "https://stackoverflow.com/users/9888189/elham-najeebullah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 1, "accepted_answer_id": 56109321, "answer_count": 1, "score": 0, "last_activity_date": 1613643263, "creation_date": 1557725820, "last_edit_date": 1613643263, "question_id": 56106280, "link": "https://stackoverflow.com/questions/56106280/the-problem-is-with-the-x-and-y-position-where-the-mouse-can-be-click-outside-o", "title": "The problem is with the x and y position, where the mouse can be click outside of the button", "body": "<p>The goal for this program is that the mouse must be clicked on the green rectangle shape which change the window background color to yellow or back to default color and the issue is that the color can also be change from outside of the rectangle. </p>\n\n<p>The mouse click should only apply inside the rectangle. </p>\n\n<p>The problem is with the x and y position in the if else statement i guess?  </p>\n\n<p>Also the 'Click Me\u2019 text does not appear on the button .\n<a href=\"https://i.stack.imgur.com/X7ScE.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>The correct x and y position for the button is in this table, click the link.</p>\n\n<pre><code>require 'rubygems'\nrequire 'gosu'\n\n# Instructions:  This code needs to be fixed and finished!\n# The \"Click Me\" text is not appearing on the button, also\n# the mouse_y co-ordinate should be shown along with the mouse_x one\n# finally, a user has noticed the sometimes the button action occurs\n# when you click out side the button area and vice-versa.\n\n\n# determines whether a graphical widget is placed over others or not\nmodule ZOrder\n  BACKGROUND, MIDDLE, TOP = *0..2\nend\n\n# Global constants\nWIN_WIDTH = 640\nWIN_HEIGHT = 400\n\nclass DemoWindow &lt; Gosu::Window\n\n  # set up variables and attributes\n  def initialize\n    super(WIN_WIDTH, WIN_HEIGHT, false)\n    @background = Gosu::Color::WHITE\n    @button_font = Gosu::Font.new(20)\n    @info_font = Gosu::Font.new(10)\n    @locs = [60,60]\n  end\n\n\n  # Draw the background, the button with 'click me' text and text\n  # showing the mouse coordinates\n  def draw\n    # Draw background color\n    Gosu.draw_rect(0, 0, WIN_WIDTH, WIN_HEIGHT, @background, ZOrder::BACKGROUND, mode=:default)\n    # Draw the button\n    Gosu.draw_rect(50, 50, 100, 50, Gosu::Color::GREEN, ZOrder::TOP, mode=:default)\n    # Draw the button text\n    @button_font.draw(\"Click me\", 60, 60, ZOrder::MIDDLE, 1.0, 1.0, Gosu::Color::BLACK)\n    # Draw the mouse position information\n    @info_font.draw(\"mouse_x: #{@locs[0]}\", 0, 350, ZOrder::TOP, 1.0, 1.0, Gosu::Color::BLACK)\n  end\n\n  # this is called by Gosu to see if should show the cursor (or mouse)\n  def needs_cursor?\n    true\n  end\n\n  # If the button area (rectangle) has been clicked on change the background color\n  # also store the mouse_x and mouse_y attributes that we 'inherit' from Gosu\n  # you will learn about inheritance in the OOP unit - for now just accept that\n  # these are available and filled with the latest x and y locations of the mouse click.\n\n  def mouse_over_button(mouse_x, mouse_y)\n    if ((mouse_x &gt; 50 and mouse_x &lt; 150) or (mouse_y &gt; 50 and mouse_x &lt; 100))\n      true\n    else\n      false\n    end\n  end\n\n  # Where is mouse_x and mouse_y defined\n\n  def button_down(id)\n    case id\n    when Gosu::MsLeft\n      @locs = [mouse_x, mouse_y]\n      if mouse_over_button(mouse_x, mouse_y)\n        @background = Gosu::Color::YELLOW\n      else\n        @background = Gosu::Color::WHITE\n      end\n    end\n  end\nend\n\n# Lets get started!\nDemoWindow.new.show\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "apartment-gem"], "answers": [{"comments": [{"owner": {"reputation": 824, "user_id": 5610600, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Szyb3uK2uU8/AAAAAAAAAAI/AAAAAAAAAJE/XuBsiUUU61c/photo.jpg?sz=128", "display_name": "Jem Built", "link": "https://stackoverflow.com/users/5610600/jem-built"}, "edited": false, "score": 0, "creation_date": 1557728821, "post_id": 56106012, "comment_id": 98847285, "body": "when i change organizations  to organization it is removed from my form..."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "reply_to_user": {"reputation": 824, "user_id": 5610600, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Szyb3uK2uU8/AAAAAAAAAAI/AAAAAAAAAJE/XuBsiUUU61c/photo.jpg?sz=128", "display_name": "Jem Built", "link": "https://stackoverflow.com/users/5610600/jem-built"}, "edited": false, "score": 0, "creation_date": 1557731306, "post_id": 56106012, "comment_id": 98848227, "body": "You should instantiate a new organization... otherwise you won&#39;t see one in your view. Either do it in the controller, or add the instantiation to the simple_fields call. See me edited answer."}, {"owner": {"reputation": 824, "user_id": 5610600, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Szyb3uK2uU8/AAAAAAAAAAI/AAAAAAAAAJE/XuBsiUUU61c/photo.jpg?sz=128", "display_name": "Jem Built", "link": "https://stackoverflow.com/users/5610600/jem-built"}, "edited": false, "score": 0, "creation_date": 1557784740, "post_id": 56106012, "comment_id": 98873752, "body": "thank you so much but now i get ActiveModel::MissingAttributeError in Users::RegistrationsController#new can&#39;t write unknown attribute <code>user_id</code>"}, {"owner": {"reputation": 824, "user_id": 5610600, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Szyb3uK2uU8/AAAAAAAAAAI/AAAAAAAAAJE/XuBsiUUU61c/photo.jpg?sz=128", "display_name": "Jem Built", "link": "https://stackoverflow.com/users/5610600/jem-built"}, "edited": false, "score": 0, "creation_date": 1557785441, "post_id": 56106012, "comment_id": 98873904, "body": "is this possibly because I am using UUID?"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "reply_to_user": {"reputation": 824, "user_id": 5610600, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Szyb3uK2uU8/AAAAAAAAAAI/AAAAAAAAAJE/XuBsiUUU61c/photo.jpg?sz=128", "display_name": "Jem Built", "link": "https://stackoverflow.com/users/5610600/jem-built"}, "edited": false, "score": 0, "creation_date": 1557811405, "post_id": 56106012, "comment_id": 98878919, "body": "Well, that&#39;s not really a problem... but you should have named it <code>user_id</code> according to rails conventions. You need to create a migration to change the name of the column. After that it should work."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1557825984, "post_id": 56106012, "comment_id": 98885719, "body": "But is it also changed in your database? Do you still get the error afterwards?"}, {"owner": {"reputation": 824, "user_id": 5610600, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Szyb3uK2uU8/AAAAAAAAAAI/AAAAAAAAAJE/XuBsiUUU61c/photo.jpg?sz=128", "display_name": "Jem Built", "link": "https://stackoverflow.com/users/5610600/jem-built"}, "edited": false, "score": 1, "creation_date": 1557870787, "post_id": 56106012, "comment_id": 98908947, "body": "the schema is in the update? I dont know what you are referencing? I dont get an error cause I can&#39;t even see organization in the form, which has been the issue since i implemented the change. I think the issue is because I say the organization has_one :owner, class_name: &#39;User&#39;... have i referenced that incorrectly in the schema?"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1558189633, "post_id": 56106012, "comment_id": 99022795, "body": "Yes the schema is wrong, your user foreign key in the organization table, should be named user_id, it is now user. That\u2019s what I have been saying in previous comments."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1558189816, "post_id": 56106012, "comment_id": 99022846, "body": "Oh just read the update, sorry checking this on mobile... i don\u2019t really get what problem you are having? Are you able to set the organization through a Rails console? \u2018@user.organization = Organization.first\u2019"}], "tags": [], "owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "is_accepted": true, "score": 1, "last_activity_date": 1557731420, "last_edit_date": 1557731420, "creation_date": 1557723896, "answer_id": 56106012, "question_id": 56105675, "link": "https://stackoverflow.com/questions/56105675/devise-apartment-create-tenant-on-or-after-devise-user-create/56106012#56106012", "title": "Devise Apartment create tenant on or after devise user create", "body": "<p>In has_one relation you should use the singular form:</p>\n\n<pre><code>  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.simple_fields_for :organization do |o| %&gt;\n      &lt;%= o.input :name, placeholder: \"Organization Name\", warning: \"Cant Be Changed\", label: false  %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>I think the rest of your code should work as is!</p>\n\n<p><strong>Edit: how to instantiate a new org</strong></p>\n\n<p>You indicated that the form is empty, that's because there is no org instance. Do the following in your user controller:</p>\n\n<pre><code>class Users::RegistrationsController &lt; Devise::RegistrationsController\n  before_action :configure_sign_up_params, only: [:create]\n  # before_action :configure_account_update_params, only: [:update]\n\n  GET /resource/sign_up\n  def new\n    super\n    @user.organization = Organization.new\n  end\n\n  # POST /resource\n  def create\n    super\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 824, "user_id": 5610600, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Szyb3uK2uU8/AAAAAAAAAAI/AAAAAAAAAJE/XuBsiUUU61c/photo.jpg?sz=128", "display_name": "Jem Built", "link": "https://stackoverflow.com/users/5610600/jem-built"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 1, "accepted_answer_id": 56106012, "answer_count": 1, "score": 2, "last_activity_date": 1557870834, "creation_date": 1557720864, "last_edit_date": 1557870834, "question_id": 56105675, "link": "https://stackoverflow.com/questions/56105675/devise-apartment-create-tenant-on-or-after-devise-user-create", "title": "Devise Apartment create tenant on or after devise user create", "body": "<p>I have a little app that is using devise and apartment gems.</p>\n\n<p>I have User(devise) who has one organization(tenant_name). </p>\n\n<p>The organization has one :owner, class_name 'user'</p>\n\n<p>I want to use the Devise registration form to also create the tenant and assign to the admin.\nI think I have read that many tutorials on devise apartment / devise custom controllers / devise nested attributes that I have confused myself.</p>\n\n<p>Registrations form \napp/views/devise/registrations/new.html.erb</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n  &lt;div class=\"col-lg-4 col-md-6 ml-auto mr-auto\"&gt;\n    &lt;h1 class=\"text-center\"&gt;Sign Up&lt;/h1&gt;\n\n    &lt;%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %&gt;\n      &lt;%= render partial: 'devise/shared/error_messages', resource: resource %&gt;\n\n      &lt;div class=\"form-group\"&gt;\n        &lt;%= f.email_field :email, autofocus: false, class: 'form-control', placeholder: \"Email Address\" %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"form-group\"&gt;\n        &lt;%= f.simple_fields_for :organizations do |o| %&gt;\n          &lt;%= o.input :name, placeholder: \"Organization Name\", warning: \"Cant Be Changed\", label: false  %&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n\n      &lt;div class=\"form-group\"&gt;\n        &lt;%= f.password_field :password, autocomplete: \"off\", class: 'form-control', placeholder: 'Password' %&gt;\n      &lt;/div&gt;\n\n      &lt;div class=\"form-group\"&gt;\n        &lt;%= f.password_field :password_confirmation, autocomplete: \"off\", class: 'form-control', placeholder: 'Confirm Password' %&gt;\n      &lt;/div&gt;\n\n      &lt;div class=\"form-group\"&gt;\n        &lt;%= f.submit \"Sign up\", class: \"btn btn-primary btn-block btn-lg\" %&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n\n    &lt;div class=\"text-center\"&gt;\n      &lt;%= render \"devise/shared/links\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>User Model</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable\n\n  has_one :organization, dependent: :destroy\n  after_create :init_organization\n  accepts_nested_attributes_for :organization\n\n  private\n\n  def init_organization\n    self.create_organization!\n  end\n\n\n\nend\n</code></pre>\n\n<p>Organization Model</p>\n\n<pre><code>class Organization &lt; ApplicationRecord\n    has_one :owner, class_name: 'User'\n    has_many :organizations_users\n    has_many :users, through: :organizations_users\n    has_many :clients\n\n    after_create :create_tenant\n\n    def tenant_name\n      \"#{self.id}\"\n    end\n\n    private\n\n    def create_tenant\n      Apartment::Tenant.create(self.tenant_name)\n    end\nend\n</code></pre>\n\n<p>I know that I need to alter my create method on my devise controller so i generated devise custom controllers with from <a href=\"https://github.com/plataformatec/devise/wiki/Tool:-Generate-and-customize-controllers\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>rails generate devise:controllers users\n</code></pre>\n\n<p>and added the custom sanitizers </p>\n\n<pre><code>class Users::RegistrationsController &lt; Devise::RegistrationsController\n  before_action :configure_sign_up_params, only: [:create]\n  # before_action :configure_account_update_params, only: [:update]\n\n  # GET /resource/sign_up\n  # def new\n  #   super\n  # end\n\n  # POST /resource\n  def create\n    super\n  end\n\n  # GET /resource/edit\n  # def edit\n  #   super\n  # end\n\n  # PUT /resource\n  # def update\n  #   super\n  # end\n\n  # DELETE /resource\n  # def destroy\n  #   super\n  # end\n\n  # GET /resource/cancel\n  # Forces the session data which is usually expired after sign\n  # in to be expired now. This is useful if the user wants to\n  # cancel oauth signing in/up in the middle of the process,\n  # removing all OAuth session data.\n  # def cancel\n  #   super\n  # end\n\n  # protected\n\n  # If you have extra params to permit, append them to the sanitizer.\n  def configure_sign_up_params\n   devise_parameter_sanitizer.permit(:sign_up, keys: [:email, organizations: [:name]])\n  end\n\n  # If you have extra params to permit, append them to the sanitizer.\n  # def configure_account_update_params\n  #   devise_parameter_sanitizer.permit(:account_update, keys: [:attribute])\n  # end\n\n  # The path used after sign up.\n  # def after_sign_up_path_for(resource)\n  #   super(resource)\n  # end\n\n  # The path used after sign up for inactive accounts.\n  # def after_inactive_sign_up_path_for(resource)\n  #   super(resource)\n  # end\nend\n</code></pre>\n\n<p>schema</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 2019_05_12_083957) do\n\n  # These are extensions that must be enabled in order to support this database\n  enable_extension \"pgcrypto\"\n  enable_extension \"plpgsql\"\n  enable_extension \"uuid-ossp\"\n\n  create_table \"Organizations_Users\", id: false, force: :cascade do |t|\n    t.uuid \"Organization_id\", null: false\n    t.uuid \"User_id\", null: false\n  end\n\n  create_table \"clients\", id: :uuid, default: -&gt; { \"gen_random_uuid()\" }, force: :cascade do |t|\n    t.string \"name\"\n    t.uuid \"organization_id\", null: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"organization_id\"], name: \"index_clients_on_organization_id\"\n  end\n\n  create_table \"equipment\", id: :uuid, default: -&gt; { \"gen_random_uuid()\" }, force: :cascade do |t|\n    t.string \"name\"\n    t.uuid \"site_id\", null: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"site_id\"], name: \"index_equipment_on_site_id\"\n  end\n\n  create_table \"organizations\", id: :uuid, default: -&gt; { \"gen_random_uuid()\" }, force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.uuid \"user\", null: false\n  end\n\n  create_table \"sites\", id: :uuid, default: -&gt; { \"gen_random_uuid()\" }, force: :cascade do |t|\n    t.string \"name\"\n    t.uuid \"client_id\", null: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"client_id\"], name: \"index_sites_on_client_id\"\n  end\n\n  create_table \"users\", id: :uuid, default: -&gt; { \"gen_random_uuid()\" }, force: :cascade do |t|\n    t.string \"email\", default: \"\", null: false\n    t.string \"encrypted_password\", default: \"\", null: false\n    t.string \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n  end\n\n  add_foreign_key \"clients\", \"organizations\"\n  add_foreign_key \"equipment\", \"sites\"\n  add_foreign_key \"sites\", \"clients\"\nend\n</code></pre>\n\n<p>when i go through the sign up process i get unknown attribute 'organizations' for User.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I added two new migration to add reference to user on the organization, and organization to the user.</p>\n\n<p>I did this to create the association for the owner, should i have called the reference owner</p>\n\n<pre><code>class AddUserToOrganization &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_reference :organizations, :user, type: :uuid, null: false, index: true, foreign_key: true\n  end\nend\n\nclass AddOrganizationToUser &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_reference :users, :organization, type: :uuid, null: false, index: true, foreign_key: true\n  end\nend\n</code></pre>\n\n<p>My Schema now looks like so:</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 2019_05_13_223120) do\n\n  # These are extensions that must be enabled in order to support this database\n  enable_extension \"pgcrypto\"\n  enable_extension \"plpgsql\"\n  enable_extension \"uuid-ossp\"\n\n  create_table \"Organizations_Users\", id: false, force: :cascade do |t|\n    t.uuid \"Organization_id\", null: false\n    t.uuid \"User_id\", null: false\n  end\n\n  create_table \"clients\", id: :uuid, default: -&gt; { \"gen_random_uuid()\" }, force: :cascade do |t|\n    t.string \"name\"\n    t.uuid \"organization_id\", null: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"organization_id\"], name: \"index_clients_on_organization_id\"\n  end\n\n  create_table \"equipment\", id: :uuid, default: -&gt; { \"gen_random_uuid()\" }, force: :cascade do |t|\n    t.string \"name\"\n    t.uuid \"site_id\", null: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"site_id\"], name: \"index_equipment_on_site_id\"\n  end\n\n  create_table \"organizations\", id: :uuid, default: -&gt; { \"gen_random_uuid()\" }, force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.uuid \"user_id\", null: false\n    t.index [\"user_id\"], name: \"index_organizations_on_user_id\"\n  end\n\n  create_table \"sites\", id: :uuid, default: -&gt; { \"gen_random_uuid()\" }, force: :cascade do |t|\n    t.string \"name\"\n    t.uuid \"client_id\", null: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"client_id\"], name: \"index_sites_on_client_id\"\n  end\n\n  create_table \"users\", id: :uuid, default: -&gt; { \"gen_random_uuid()\" }, force: :cascade do |t|\n    t.string \"email\", default: \"\", null: false\n    t.string \"encrypted_password\", default: \"\", null: false\n    t.string \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.uuid \"organization_id\", null: false\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"organization_id\"], name: \"index_users_on_organization_id\"\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n  end\n\n  add_foreign_key \"clients\", \"organizations\"\n  add_foreign_key \"equipment\", \"sites\"\n  add_foreign_key \"organizations\", \"users\"\n  add_foreign_key \"sites\", \"clients\"\n  add_foreign_key \"users\", \"organizations\"\nend\n</code></pre>\n\n<p>I followed the direction from to change my user/ registrations controller to :</p>\n\n<pre><code>class Users::RegistrationsController &lt; Devise::RegistrationsController\n  before_action :configure_sign_up_params, only: [:create]\n  # before_action :configure_account_update_params, only: [:update]\n\n  def new\n    super\n    @organization = Organization.new\n  end\n\n  # POST /resource\n  def create\n    super\n  end\n\n  # GET /resource/edit\n  # def edit\n  #   super\n  # end\n\n  # PUT /resource\n  # def update\n  #   super\n  # end\n\n  # DELETE /resource\n  # def destroy\n  #   super\n  # end\n\n  # GET /resource/cancel\n  # Forces the session data which is usually expired after sign\n  # in to be expired now. This is useful if the user wants to\n  # cancel oauth signing in/up in the middle of the process,\n  # removing all OAuth session data.\n  # def cancel\n  #   super\n  # end\n\n  # protected\n\n  # If you have extra params to permit, append them to the sanitizer.\n  def configure_sign_up_params\n   devise_parameter_sanitizer.permit(:sign_up, keys: [:email, organizations: [:name]])\n  end\n\n  # If you have extra params to permit, append them to the sanitizer.\n  # def configure_account_update_params\n  #   devise_parameter_sanitizer.permit(:account_update, keys: [:attribute])\n  # end\n\n  # The path used after sign up.\n  # def after_sign_up_path_for(resource)\n  #   super(resource)\n  # end\n\n  # The path used after sign up for inactive accounts.\n  # def after_inactive_sign_up_path_for(resource)\n  #   super(resource)\n  # end\nend\n</code></pre>\n\n<p>and my form now</p>\n\n<pre><code>&lt;%= simple_form_for(resource, :as =&gt; resource_name, :url =&gt; session_path(resource_name), :html =&gt; {:class =&gt; 'form-horizontal' }) do |f| %&gt;\n      &lt;%= render partial: 'devise/shared/error_messages', resource: resource %&gt;\n\n        &lt;%= f.input :email, autofocus: false, class: 'form-control', placeholder: \"Email Address\", label: false  %&gt;\n        &lt;%= f.simple_fields_for :organization do |o| %&gt;\n          &lt;%= o.input :name, placeholder: \"Organization Name\", warning: \"Cant Be Changed\", label: false  %&gt;\n        &lt;% end %&gt;\n        &lt;%= f.input :password, autocomplete: \"off\", class: 'form-control', placeholder: 'Password', label: false  %&gt;\n        &lt;%= f.input :password_confirmation, autocomplete: \"off\", class: 'form-control', placeholder: 'Confirm Password', label: false  %&gt;\n        &lt;%= f.button :submit, \"Sign up\", class: \"btn btn-primary btn-block btn-lg\" %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>my problem now is that i cannot see the organization name field in the view of the form.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10524014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noRU9.jpg?s=128&g=1", "display_name": "Ernesto Jr Montejo", "link": "https://stackoverflow.com/users/10524014/ernesto-jr-montejo"}, "edited": false, "score": 0, "creation_date": 1557835377, "post_id": 56106153, "comment_id": 98891061, "body": "I kinda like the lambda alternative. But still I am grateful for the help!  Although the code has an error, it says undefined method `then&#39; ..."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 23, "user_id": 10524014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noRU9.jpg?s=128&g=1", "display_name": "Ernesto Jr Montejo", "link": "https://stackoverflow.com/users/10524014/ernesto-jr-montejo"}, "edited": false, "score": 0, "creation_date": 1557846646, "post_id": 56106153, "comment_id": 98898203, "body": "Probably because you are not running Ruby 2.6. For 2.5 use yield_self. Does the same."}, {"owner": {"reputation": 23, "user_id": 10524014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noRU9.jpg?s=128&g=1", "display_name": "Ernesto Jr Montejo", "link": "https://stackoverflow.com/users/10524014/ernesto-jr-montejo"}, "edited": false, "score": 0, "creation_date": 1557978869, "post_id": 56106153, "comment_id": 98949111, "body": "Yes the yield_self is working\u2026 However, I just notice that .size is better than .last since users could choose a duplicate/same position.   When using .last e.g instead of the last position, 4, users can choose 1. so outcome will be [1,2,3,1(4 before),2)  using .size output is [1,2,3,1,5]"}, {"owner": {"reputation": 23, "user_id": 10524014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noRU9.jpg?s=128&g=1", "display_name": "Ernesto Jr Montejo", "link": "https://stackoverflow.com/users/10524014/ernesto-jr-montejo"}, "edited": false, "score": 0, "creation_date": 1557979035, "post_id": 56106153, "comment_id": 98949145, "body": "but still it&#39;s not 100% what I wanted\u2026 output should still be [1,2,3,4(the new number)] since there is a duplicate for position 1. I guess the solution is to prevent users from choosing position and just use the last position then. Thanks!"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 23, "user_id": 10524014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noRU9.jpg?s=128&g=1", "display_name": "Ernesto Jr Montejo", "link": "https://stackoverflow.com/users/10524014/ernesto-jr-montejo"}, "edited": false, "score": 0, "creation_date": 1557983599, "post_id": 56106153, "comment_id": 98950207, "body": "@ErnestoJrMontejo, you can also use do/end for enclosing the block instead of curly brackets. This allow to use a more complex logic (up to you) written on many lines."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1557724893, "creation_date": 1557724893, "answer_id": 56106153, "question_id": 56105237, "link": "https://stackoverflow.com/questions/56105237/retrieve-database-record-another-option-value-using-options-for-select-in-ruby/56106153#56106153", "title": "Retrieve database record + another option value using options_for_select in Ruby on Rails", "body": "<p>If I get the point, fetching from Subject as <code>@position = Subject.pluck(:position)</code> you end up, for example, with:</p>\n\n<pre><code>@position = [1,2,3]\n</code></pre>\n\n<p>Then you need to append one element which value is the last incremented by one.</p>\n\n<p>For Ruby 2.6 you could try using <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-then\" rel=\"nofollow noreferrer\">Object#then</a>:</p>\n\n<pre><code>[1,2,3].then { |ary| ary &lt;&lt; ary.last + 1 } #=&gt; [1, 2, 3, 4]\n</code></pre>\n\n<p>So, in your case this should work:</p>\n\n<pre><code>@position = Subject.pluck(:position).then { |positions| positions &lt;&lt; positions.last + 1 }\n</code></pre>\n\n<p>For Ruby 2.5 use <a href=\"https://ruby-doc.org/core-2.5.5/Object.html#method-i-yield_self\" rel=\"nofollow noreferrer\">Object#yield_self</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10524014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noRU9.jpg?s=128&g=1", "display_name": "Ernesto Jr Montejo", "link": "https://stackoverflow.com/users/10524014/ernesto-jr-montejo"}, "edited": false, "score": 0, "creation_date": 1557835316, "post_id": 56110326, "comment_id": 98891026, "body": "Awesome! the lambda method is the one I most like! Thanks again!"}, {"owner": {"reputation": 36, "user_id": 11492111, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jO5duY7Hsuc/AAAAAAAAAAI/AAAAAAAAAAg/Q7ebYOPZSvg/photo.jpg?sz=128", "display_name": "Hai Red Fox", "link": "https://stackoverflow.com/users/11492111/hai-red-fox"}, "reply_to_user": {"reputation": 23, "user_id": 10524014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noRU9.jpg?s=128&g=1", "display_name": "Ernesto Jr Montejo", "link": "https://stackoverflow.com/users/10524014/ernesto-jr-montejo"}, "edited": false, "score": 0, "creation_date": 1558327810, "post_id": 56110326, "comment_id": 99049720, "body": "Glad that I helped"}], "tags": [], "owner": {"reputation": 36, "user_id": 11492111, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jO5duY7Hsuc/AAAAAAAAAAI/AAAAAAAAAAg/Q7ebYOPZSvg/photo.jpg?sz=128", "display_name": "Hai Red Fox", "link": "https://stackoverflow.com/users/11492111/hai-red-fox"}, "is_accepted": false, "score": 1, "last_activity_date": 1557767048, "last_edit_date": 1557767048, "creation_date": 1557742719, "answer_id": 56110326, "question_id": 56105237, "link": "https://stackoverflow.com/questions/56105237/retrieve-database-record-another-option-value-using-options-for-select-in-ruby/56110326#56110326", "title": "Retrieve database record + another option value using options_for_select in Ruby on Rails", "body": "<p>I think the solution of iGian above is nice. But he introduced some new methods from new versions of Ruby. If you need a solution that can be used with lower versions too (and the new as well), then try this:</p>\n\n<pre><code>Proc.new { |arr| arr &lt;&lt; arr.last + 1 }.call(Subject.pluck(:position))\n\n# or\n\nlambda { |arr| arr &lt;&lt; arr.last + 1 }.call(Subject.pluck(:position))\n</code></pre>\n\n<p>Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 10524014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noRU9.jpg?s=128&g=1", "display_name": "Ernesto Jr Montejo", "link": "https://stackoverflow.com/users/10524014/ernesto-jr-montejo"}, "is_accepted": false, "score": 0, "last_activity_date": 1558673786, "creation_date": 1558673786, "answer_id": 56286085, "question_id": 56105237, "link": "https://stackoverflow.com/questions/56105237/retrieve-database-record-another-option-value-using-options-for-select-in-ruby/56286085#56286085", "title": "Retrieve database record + another option value using options_for_select in Ruby on Rails", "body": "<p>Update: This is the correct answer, or the right way to do what I wanted. </p>\n\n<p>The codes where just complicated when in fact we can simply do like this\u2026\nIn the form view:</p>\n\n<pre><code>&lt;%= f.select :position, 1..@subject_count %&gt;\n</code></pre>\n\n<p>Then in the controller:</p>\n\n<pre><code>@subject_count = Subject.count + 1\n</code></pre>\n\n<p>This generates the DB count + 1 without retrieving any duplicate (numbers)positions\u2026\nThat's all! Quite amazing how simple it should be.</p>\n"}], "owner": {"reputation": 23, "user_id": 10524014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noRU9.jpg?s=128&g=1", "display_name": "Ernesto Jr Montejo", "link": "https://stackoverflow.com/users/10524014/ernesto-jr-montejo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1558673786, "creation_date": 1557715993, "last_edit_date": 1557716371, "question_id": 56105237, "link": "https://stackoverflow.com/questions/56105237/retrieve-database-record-another-option-value-using-options-for-select-in-ruby", "title": "Retrieve database record + another option value using options_for_select in Ruby on Rails", "body": "<p>I am studying creating a form on Ruby on Rails but I cannot seem to know how to return the values I wanted using options_for_select.</p>\n\n<p>I wanted to retrieve all position numbers + add 1 to the last number as a select option every time a user creates a new \"subject\".</p>\n\n<p>e.g. user creates a new Subject\nin the Form field, Position. The options will be 1,2,3(numbers retrieve in the database) and 4(being the new number not yet in the database)</p>\n\n<p>I successfully tried retrieving the database values and the \"other\" value separately but I could not join them to return together in the same option field.</p>\n\n<p>However, I can add them together but the instance variables are manually added one by one.</p>\n\n<p>Here's the code\u2026\nIn views and controller</p>\n\n<pre><code>&lt;%= f.select(:position, options_for_select([@position, @positionTwo.position, @position.last, @additional])) %&gt;\n\n@position = Subject.pluck(:position)\n@positionTwo = Subject.find(2)\n@additional = Subject.pluck(:position).size + 1\n</code></pre>\n\n<p>generates\noptions 1,2,3,4 but results are added manually</p>\n\n<p>I successfully tried retrieving the database values using:</p>\n\n<pre><code>&lt;%= f.select(:position, options_for_select(@position)) %&gt;\n@position = Subject.pluck(:position)\n</code></pre>\n\n<p>this generates options 1,2,3</p>\n\n<p>for the \"other\" value </p>\n\n<pre><code>&lt;%= f.select(:position, options_for_select(@additional)) %&gt;\n@additional = Subject.pluck(:position).size + 1\n</code></pre>\n\n<p>it generates option 4</p>\n\n<p><strong>What my expected behavior and result should be</strong></p>\n\n<p>options 1,2,3,4 generated dynamically</p>\n\n<p>the 1,2,3 is retrieve from the database while 4 is a dynamic number depending on the last position number in the database+1 (3+1 = 4)</p>\n"}, {"tags": ["regex", "ruby", "logging", "regex-lookarounds", "rubymine"], "comments": [{"owner": {"reputation": 1057, "user_id": 3674079, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/1m1O1.jpg?s=128&g=1", "display_name": "quangkid", "link": "https://stackoverflow.com/users/3674079/quangkid"}, "reply_to_user": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "edited": false, "score": 1, "creation_date": 1557716097, "post_id": 56104965, "comment_id": 98844477, "body": "@Emma I tried before but it not work. The default regex pattern also use those 2 chars. See the screen shot : <a href=\"https://imgur.com/UMrJ0gz\" rel=\"nofollow noreferrer\">imgur.com/UMrJ0gz</a>"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1557731972, "post_id": 56104965, "comment_id": 98848517, "body": "Try <code>^(\\w+),\\s+\\[([^\\]\\s]+)\\s+#(\\d+)]\\s+(\\w+)\\s+--\\s+(\\w+)?:\\s+(.&zwnj;&#8203;+(?:\\R(?!\\w+,\\s+\\[[^&zwnj;&#8203;\\]\\s]+\\s+#\\d+).*)*)$</code>&zwnj;&#8203;,  see <a href=\"https://regex101.com/r/rtgv26/1\" rel=\"nofollow noreferrer\">regex101.com/r/rtgv26/1</a>"}, {"owner": {"reputation": 1057, "user_id": 3674079, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/1m1O1.jpg?s=128&g=1", "display_name": "quangkid", "link": "https://stackoverflow.com/users/3674079/quangkid"}, "edited": false, "score": 1, "creation_date": 1557817595, "post_id": 56104965, "comment_id": 98881529, "body": "Thanks for your help. But it doesn&#39;t work. Have you tried it in RubyMine 2019?"}], "owner": {"reputation": 1057, "user_id": 3674079, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/1m1O1.jpg?s=128&g=1", "display_name": "quangkid", "link": "https://stackoverflow.com/users/3674079/quangkid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1557714384, "creation_date": 1557712848, "last_edit_date": 1557714384, "question_id": 56104965, "link": "https://stackoverflow.com/questions/56104965/create-custom-log-format-in-rubymine", "title": "Create custom log format in RubyMine", "body": "<p>In my Ruby program, I use <a href=\"https://github.com/ruby/logger\" rel=\"nofollow noreferrer\">logger</a> to export log to file.\nBut when I open .log file in Rubymine, it show 'log format not recognized'\n<a href=\"https://i.stack.imgur.com/GtLXs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GtLXs.png\" alt=\"enter image description here\"></a></p>\n\n<p>My log file content is :</p>\n\n<pre><code>E, [2019-05-09T11:29:09.915477 #23628] ERROR -- : quang.log: No time\nE, [2019-05-09T11:29:09.915712 #23628] ERROR -- : quang.log: /home/quang/.rbenv/versions/2.5.1/lib/ruby/2.5.0/monitor.rb:109:in `sleep'\n/home/quang/.rbenv/versions/2.5.1/lib/ruby/2.5.0/monitor.rb:109:in `wait'\n/home/quang/.rbenv/versions/2.5.1/lib/ruby/2.5.0/monitor.rb:109:in `wait'\n/home/quang/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/cassandra-driver-3.2.3/lib/cassandra/future.rb:622:in `block in get'\n/home/quang/.rbenv/versions/2.5.1/lib/ruby/2.5.0/monitor.rb:226:in `mon_synchronize'\n</code></pre>\n\n<p>I tried to add new log format like this:</p>\n\n<pre><code>^([\\w]+),\\s+\\[([^\\]\\s]+)\\s+#([^\\]]+)]\\s+(\\w+)\\s+--\\s+(\\w+)?:\\s+(.+)$\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/hsmLk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hsmLk.png\" alt=\"enter image description here\"></a></p>\n\n<p>It does match with : </p>\n\n<pre><code>E, [2019-05-09T11:29:09.915477 #23628] ERROR -- : quang.log: No time\n</code></pre>\n\n<p>But notification above doesn't disappear.</p>\n\n<p>How do I fix this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1557717683, "last_edit_date": 1557717683, "creation_date": 1557708680, "answer_id": 56104678, "question_id": 56104290, "link": "https://stackoverflow.com/questions/56104290/how-to-build-a-hash-of-directory-names-as-keys-and-file-names-as-values-in-ruby/56104678#56104678", "title": "How to build a hash of directory names as keys and file names as values in Ruby?", "body": "<p>An alternative to regexp:</p>\n\n<pre><code>output =\n    Dir.glob('*/*.json', base: 'app').\n    group_by(&amp;File::method(:dirname)).\n    transform_values { |files|\n      files.each_with_object({}) { |file, hash|\n        hash[File.basename(file)] = File.read(file)\n      }\n    }\n</code></pre>\n\n<p>Note the <code>base:</code> keyword argument to <code>File.glob</code> (or <code>Pathname.glob</code>, for that matter) which simplifies things as we don't need to remove <code>app</code>; also that for the purposes of OP's question there only needs to be one directory level, so <code>*</code> instead of <code>**</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 6830609, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe6128440e544d4e38957d5df5d9647e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex D.", "link": "https://stackoverflow.com/users/6830609/alex-d"}, "edited": false, "score": 0, "creation_date": 1557718097, "post_id": 56105127, "comment_id": 98844780, "body": "really appreciate your detailed answer, was wondering how do I set file content using <code>File.read</code> instead of empty hash as a value?"}, {"owner": {"reputation": 69, "user_id": 6830609, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe6128440e544d4e38957d5df5d9647e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex D.", "link": "https://stackoverflow.com/users/6830609/alex-d"}, "edited": false, "score": 0, "creation_date": 1557718512, "post_id": 56105127, "comment_id": 98844845, "body": "came up with this: <code>h[File.dirname(fname)].update(File.basename(fname)=&gt;File.rea&zwnj;&#8203;d(&quot;app&#47;#{fname}&quot;))</code> not quite sure it&#39;s a right way"}, {"owner": {"reputation": 69, "user_id": 6830609, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe6128440e544d4e38957d5df5d9647e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex D.", "link": "https://stackoverflow.com/users/6830609/alex-d"}, "edited": false, "score": 0, "creation_date": 1557718973, "post_id": 56105127, "comment_id": 98844927, "body": "also, how can I assign the hash output to a constant? smth like: <code>OUTPUT ||= {}; OUTPUT[File.dirname(fname)] = File.read(fname)</code> instead of creation a new hash"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 69, "user_id": 6830609, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe6128440e544d4e38957d5df5d9647e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex D.", "link": "https://stackoverflow.com/users/6830609/alex-d"}, "edited": false, "score": 1, "creation_date": 1557719742, "post_id": 56105127, "comment_id": 98845053, "body": "I believe <code>File.read(&quot;app&#47;#{fname}&quot;)</code> is correct. You could simply write <code>OUTPUT = Dir.glob...end</code>."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1557717733, "last_edit_date": 1557717733, "creation_date": 1557714713, "answer_id": 56105127, "question_id": 56104290, "link": "https://stackoverflow.com/questions/56104290/how-to-build-a-hash-of-directory-names-as-keys-and-file-names-as-values-in-ruby/56105127#56105127", "title": "How to build a hash of directory names as keys and file names as values in Ruby?", "body": "<pre><code>Dir.glob('*/*.json', base: 'app').each_with_object(Hash.new {|g,k| g[k]={}}) do |fname,h|\n  h[File.dirname(fname)].update(File.basename(fname)=&gt;{})\nend\n  #=&gt; {\"foo\"=&gt;{\"create.json\"=&gt;{}, \"update.json\"=&gt;{}},\n  #    \"bar\"=&gt;{\"update.json\"=&gt;{}, \"create.json\"=&gt;{}}}\n</code></pre>\n\n<p>@Amadan explains the use of <a href=\"http://ruby-doc.org/core-2.5.1/Dir.html#method-c-glob\" rel=\"nofollow noreferrer\">Dir#glob</a>, which is exactly as in his answer. I have employed the version of <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a> that invokes a block (here <code>{|g,k| g[k]={}}</code>) when <code>g[k]</code> is executed and the hash <code>g</code> does not have a key <code>k</code>.<sup>1.</sup> See also <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> (aka <code>merge!</code>), <a href=\"http://ruby-doc.org/core-2.5.1/File.html#method-c-dirname\" rel=\"nofollow noreferrer\">File::dirname</a> and <a href=\"http://ruby-doc.org/core-2.5.1/File.html#method-c-dirname\" rel=\"nofollow noreferrer\">File::basename</a>.</p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>a = Dir.glob('*/*.json', base: 'app')\n  #=&gt; [\"foo/create.json\", \"foo/update.json\", \"bar/update.json\", \"bar/create.json\"] \nenum = a.each_with_object(Hash.new {|g,k| g[k]={}})\n  #=&gt; #&lt;Enumerator: [\"foo/create.json\", \"foo/update.json\", \"bar/update.json\",\n  #                  \"bar/create.json\"]:each_with_object({})&gt; \n</code></pre>\n\n<p>The first value is generate by the enumerator and passed to the block, and the block variables are assigned values by the process of <a href=\"https://docs.ruby-lang.org/en/2.6.0/syntax/assignment_rdoc.html#label-Array+Decomposition\" rel=\"nofollow noreferrer\">array decomposition</a>:</p>\n\n<pre><code>fname, h = enum.next\n  #=&gt; [\"foo/create.json\", {}] \nfname\n  #=&gt; \"foo/create.json\" \nh #=&gt; {} \nd = File.dirname(fname)\n  #=&gt; \"foo\" \nb = File.basename(fname)\n  #=&gt; \"create.json\" \nh[d].update(b=&gt;{})\n  #=&gt; {\"create.json\"=&gt;{}}\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Enumerator.html#method-i-next\" rel=\"nofollow noreferrer\">Enumerator#next</a>. The next value is generated by <code>enum</code> and passed to the block, the block variables are assigned values and the block calculations are performed. (Notice that the hash being built, <code>h</code>, has been updated in the following.)</p>\n\n<pre><code>fname, h = enum.next\n  #=&gt; [\"foo/update.json\", {\"foo\"=&gt;{\"create.json\"=&gt;{}}}] \nfname\n  #=&gt; \"foo/update.json\" \nh #=&gt; {\"foo\"=&gt;{\"create.json\"=&gt;{}}} \nd = File.dirname(fname)\n  #=&gt; \"foo\" \nb = File.basename(fname)\n  #=&gt; \"update.json\" \nh[d].update(b=&gt;{})\n  #=&gt; {\"create.json\"=&gt;{}, \"update.json\"=&gt;{}} \n</code></pre>\n\n<p>Twice more.</p>\n\n<pre><code>fname, h = enum.next\n  #=&gt; [\"bar/update.json\", {\"foo\"=&gt;{\"create.json\"=&gt;{}, \"update.json\"=&gt;{}}}] \nd = File.dirname(fname)\n  #=&gt; \"bar\" \nb = File.basename(fname)\n  #=&gt; \"update.json\" \nh[d].update(b=&gt;{})\n  #=&gt; {\"update.json\"=&gt;{}} \n\nfname, h = enum.next\n  #=&gt; [\"bar/create.json\",\n  #    {\"foo\"=&gt;{\"create.json\"=&gt;{}, \"update.json\"=&gt;{}}, \"bar\"=&gt;{\"update.json\"=&gt;{}}}] \nd = File.dirname(fname)\n  #=&gt; \"bar\" \nb = File.basename(fname)\n  #=&gt; \"create.json\" \nh[d].update(b=&gt;{})\n  #=&gt; {\"update.json\"=&gt;{}, \"create.json\"=&gt;{}} \nh #=&gt; {\"foo\"=&gt;{\"create.json\"=&gt;{}, \"update.json\"=&gt;{}},\n  #    \"bar\"=&gt;{\"update.json\"=&gt;{}, \"create.json\"=&gt;{}}} \n</code></pre>\n\n<p><sup>1. This is equivalent to defining the hash as follows: <code>g = {}; g.default_proc = proc {|g,k| g[k]={}}</code>. See <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-default_proc-3D\" rel=\"nofollow noreferrer\">Hash#default_proc=</a>.</sup></p>\n"}], "owner": {"reputation": 69, "user_id": 6830609, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe6128440e544d4e38957d5df5d9647e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex D.", "link": "https://stackoverflow.com/users/6830609/alex-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 56105127, "answer_count": 2, "score": 1, "last_activity_date": 1557717733, "creation_date": 1557703882, "last_edit_date": 1557706662, "question_id": 56104290, "link": "https://stackoverflow.com/questions/56104290/how-to-build-a-hash-of-directory-names-as-keys-and-file-names-as-values-in-ruby", "title": "How to build a hash of directory names as keys and file names as values in Ruby?", "body": "<p>I have directories with files and I would like to build a hash of directory names as keys and file names as values. Example:</p>\n\n<pre><code>/app/foo/create.json\n/app/foo/update.json\n/app/bar/create.json\n/app/bar/update.json\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\n  \"foo\" =&gt; {\n    \"create.json\" =&gt; {},\n    \"update.json\" =&gt; {}\n  },\n  \"bar\" =&gt; {\n    \"create.json\" =&gt; {},\n    \"update.json\" =&gt; {}\n  }\n}\n</code></pre>\n\n<p>Currently I'd doing this:</p>\n\n<pre><code>OUTPUT ||= {}\n\nDir.glob('app', '**', '*.json')) do |file|\n  OUTPUT[File.basename(file)] = File.read(file)\nend\n</code></pre>\n\n<p>But it's not working as expected, I'm not sure how to get the parent directory name.</p>\n"}, {"tags": ["ruby", "tk"], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 4, "last_activity_date": 1557713146, "last_edit_date": 1557713146, "creation_date": 1557712473, "answer_id": 56104927, "question_id": 56104109, "link": "https://stackoverflow.com/questions/56104109/how-does-title-method-inside-tkroot-block-work-in-ruby/56104927#56104927", "title": "How does title method inside TkRoot block work in Ruby?", "body": "<p>The key to this black magic is <a href=\"https://ruby-doc.org/core/BasicObject.html#method-i-instance_eval\" rel=\"nofollow noreferrer\"><code>instance_eval</code></a>, which will evaluate the block in the context of its receiver. Normally <code>self</code> inside a block will be determined by scope; <code>instance_eval</code> will change the <code>self</code> inside its block to be whatever received the <code>instance_eval</code> message.</p>\n\n<pre><code>class Dog\n  def bark\n    puts \"Woof\"\n  end\n\n  def initialize(&amp;block)\n    instance_eval(&amp;block)\n  end\nend\n\nDog.new { bark }\n# =&gt; \"Woof\"\n</code></pre>\n\n<p>In this case, <code>instance_eval(&amp;block)</code> is the same as <code>self.instance_eval(&amp;block)</code>, which means <code>self</code> inside the block will be the <code>Dog</code> instance; then <code>bark</code> is of course <code>self.bark</code>, where <code>self</code> is the <code>Dog</code>.</p>\n\n<p>There is a school of thought that <code>instance_eval</code> is <a href=\"https://stackoverflow.com/questions/3071532/how-does-instance-eval-work-and-why-does-dhh-hate-it\">harmful</a>. I agree that it is best to limit its use to clearly delineated DSLs. I.e. it may work for TK, RSpec or Sinatra, but if you think it's cool and want to use it, it's good to think twice.</p>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56104927, "answer_count": 1, "score": 1, "last_activity_date": 1557713146, "creation_date": 1557701558, "last_edit_date": 1557702020, "question_id": 56104109, "link": "https://stackoverflow.com/questions/56104109/how-does-title-method-inside-tkroot-block-work-in-ruby", "title": "How does title method inside TkRoot block work in Ruby?", "body": "<p>I know this is a weird question. But I have been scratching my head when thinking about how a method called title is defined inside <code>TkRoot.new { title('Something') }</code></p>\n\n<p>Ok so here's a sample code:</p>\n\n<pre><code>#!/usr/bin/ruby\nrequire 'tk'\n\np defined?(title)    # =&gt; nil\nroot = TkRoot.new { p defined?(title) } # writes \"method\" to stdout.\n</code></pre>\n\n<p><a href=\"https://tkdocs.com/tutorial/firstexample.html\" rel=\"nofollow noreferrer\">Here's a link to the official guide</a></p>\n\n<p>I have looked into the source code, which seems very very messy (and perhaps filled with all the bad practices to make the code harder to read) and filled with warnings when all the warnings are on. </p>\n\n<p>My question is how the method definition works only inside the block? Can I get a small sample code here which shows how to restrict a method definition only to a block?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1557695092, "post_id": 56103236, "comment_id": 98841364, "body": "What precisely do you mean by &quot;downloading the repo&quot;? How are you pointing your Gemfile to the downloaded repo?"}, {"owner": {"reputation": 893, "user_id": 3394889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c58b23ce03f0e71522820d13404d5a?s=128&d=identicon&r=PG&f=1", "display_name": "The Wizard", "link": "https://stackoverflow.com/users/3394889/the-wizard"}, "edited": false, "score": 0, "creation_date": 1557697724, "post_id": 56103236, "comment_id": 98841914, "body": "Also, can you please paste the error backtrace that shows up when you run bundle install."}, {"owner": {"reputation": 236, "user_id": 9677360, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156287705337154/picture?type=large", "display_name": "Simon Wong", "link": "https://stackoverflow.com/users/9677360/simon-wong"}, "edited": false, "score": 0, "creation_date": 1557698598, "post_id": 56103236, "comment_id": 98842087, "body": "I press Clone -&gt; Download ZIP file. I didn\u2019t know I was supposed to point my gemfile to the downloaded repo. How could I do that?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1557700041, "post_id": 56103236, "comment_id": 98842331, "body": "In step 2, changing <code>lib&#47;surveyor&#47;version.rb</code> isn&#39;t likely to have the effect you want. What is the ultimate goal here? What is requiring <code>1.4.1.q</code>?"}, {"owner": {"reputation": 236, "user_id": 9677360, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156287705337154/picture?type=large", "display_name": "Simon Wong", "link": "https://stackoverflow.com/users/9677360/simon-wong"}, "edited": false, "score": 0, "creation_date": 1557702766, "post_id": 56103236, "comment_id": 98842760, "body": "It\u2019s an assignment where I\u2019m supposed to make a website with the surveyor gem to make some surveys. I\u2019m supposed to fork that branch from the link above."}], "answers": [{"comments": [{"owner": {"reputation": 236, "user_id": 9677360, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156287705337154/picture?type=large", "display_name": "Simon Wong", "link": "https://stackoverflow.com/users/9677360/simon-wong"}, "edited": false, "score": 0, "creation_date": 1557738228, "post_id": 56104041, "comment_id": 98851627, "body": "I&#39;ve added the first line of code (gem surveyor) into my Gemfile and ran bundle install but ran into the same error: NoMethodError: undefined method `spec&#39; for nil:NilClass Did you mean?  inspect An error occurred while installing surveyor (1.4.1.q), and Bundler cannot continue."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 236, "user_id": 9677360, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156287705337154/picture?type=large", "display_name": "Simon Wong", "link": "https://stackoverflow.com/users/9677360/simon-wong"}, "edited": false, "score": 0, "creation_date": 1557763513, "post_id": 56104041, "comment_id": 98865633, "body": "@SimonWong You&#39;ve never mentioned this error. Something else is wrong."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 1, "last_activity_date": 1557700691, "creation_date": 1557700691, "answer_id": 56104041, "question_id": 56103236, "link": "https://stackoverflow.com/questions/56103236/running-a-forked-repo/56104041#56104041", "title": "Running a forked repo", "body": "<p>To depend on a version of a gem in a Git repo, <a href=\"https://bundler.io/v2.0/guides/git.html\" rel=\"nofollow noreferrer\">tell the bundler to fetch the gem from the repo</a>. </p>\n\n<pre><code>gem 'surveyor', '~&gt; 1.4', git: 'https://github.com/scwong93/surveyor/'\n</code></pre>\n\n<p>And then run <code>bundle</code> as normal. You should see...</p>\n\n<blockquote>\n  <p>Using surveyor 1.4.1.q from <a href=\"https://github.com/scwong93/surveyor/\" rel=\"nofollow noreferrer\">https://github.com/scwong93/surveyor/</a> (at master@e253789)</p>\n</blockquote>\n\n<p>Look inside your <code>Gemfile.lock</code> and see that it has indeed found the repo version 1.4.1q by pulling it from the repo's master branch.</p>\n\n<pre><code>GIT\n  remote: https://github.com/scwong93/surveyor/\n  revision: e25378983fd465db701610eb076179c74db98c11\n  specs:\n    surveyor (1.4.1.q)\n      formtastic (~&gt; 2.2.1)\n      haml (&gt;= 4.1.0.beta.1)\n      mustache (~&gt; 0.99)\n      rabl (~&gt; 0.6)\n      rails (&gt;= 3.2)\n      sass\n      uuidtools (~&gt; 2.1)\n</code></pre>\n"}], "owner": {"reputation": 236, "user_id": 9677360, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156287705337154/picture?type=large", "display_name": "Simon Wong", "link": "https://stackoverflow.com/users/9677360/simon-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557866022, "creation_date": 1557693128, "last_edit_date": 1557866022, "question_id": 56103236, "link": "https://stackoverflow.com/questions/56103236/running-a-forked-repo", "title": "Running a forked repo", "body": "<p>I'm attempting to fork the repo and run it locally. Steps I took so far are:</p>\n\n<ol>\n<li>Download repo</li>\n<li>Change gemname gem version in <code>version.rb</code> to <code>1.4.0</code> because version is not available</li>\n<li>Uninstall and reinstall bundler to version <code>1.6.1</code></li>\n<li>Run <code>bundle install</code></li>\n<li>Get the error <code>Make sure that gem install gemname -v '1.4' succeeds before bundling.</code></li>\n<li>Run <code>gem install gemname -v '1.4'</code> and installed gem successfully</li>\n<li>Run <code>bundle install</code> and I loop back to the error on step 5</li>\n</ol>\n\n<p>I clearly have surveyor installed but yet bundler doesn't seem to recognize this. I'm a novice and very rusty on Rails.</p>\n\n<p>Thanks in advance for your help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1557694679, "post_id": 56102911, "comment_id": 98841274, "body": "The accepted answer is fine for one-offs, but if this is a common pattern, I&#39;d write either a helper or some sort of wrapper."}], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557692748, "post_id": 56102970, "comment_id": 98840788, "body": "Or simply <code>name || &#39;no name&#39;</code> in OP&#39;s case because they don&#39;t seem to be treating <code>&#39;&#39;</code> as nil .... in many cases it&#39;s safe to treat <code>&#39;&#39;</code> as nil but not always ..."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557692806, "post_id": 56102970, "comment_id": 98840802, "body": "Yes, this code (with <code>presence</code>) is doing something slightly different."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 3, "last_activity_date": 1557694576, "last_edit_date": 1557694576, "creation_date": 1557691075, "answer_id": 56102970, "question_id": 56102911, "link": "https://stackoverflow.com/questions/56102911/ruby-short-if-even-shorter/56102970#56102970", "title": "Ruby short IF even shorter?", "body": "<p>Yes, there is. Try this one</p>\n\n<pre><code>&lt;%= name.presence || 'no name' %&gt;\n</code></pre>\n\n<p>If <code>name</code> is empty this expression evaluates to <code>'no name'</code>, otherwise to the <code>name</code>'s value.</p>\n\n<p>Note that <code>presence</code> is a rails method.</p>\n\n<p>As someone pointed out, if you want to print <code>'no name'</code> only if <code>name</code> is <code>nil</code> (or <code>false</code>, even if that's probably not the case) this is enough</p>\n\n<pre><code>&lt;%= name || 'no name' %&gt;\n</code></pre>\n\n<p>otherwise, if you want to print <code>'no name'</code> even if <code>name</code> is a blank string my original answer does the trick</p>\n"}], "owner": {"reputation": 5149, "user_id": 2708460, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/78fb5597f10a8f25d2a69cbf70fd6ecd?s=128&d=identicon&r=PG&f=1", "display_name": "almo", "link": "https://stackoverflow.com/users/2708460/almo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56102970, "answer_count": 1, "score": 0, "last_activity_date": 1557694576, "creation_date": 1557690647, "question_id": 56102911, "link": "https://stackoverflow.com/questions/56102911/ruby-short-if-even-shorter", "title": "Ruby short IF even shorter?", "body": "<p>I have some code:</p>\n\n<pre><code>&lt;%= name ? name : 'no name' %&gt;\n</code></pre>\n\n<p>So it prints the name, and if there is no name it prints 'no name'.\nSince I still have to write two times the variable name I was wondering if there's an even shorter way?</p>\n\n<p>If variable, then print it, else print something else.</p>\n"}, {"tags": ["ruby-on-rails", "node.js", "ruby", "windows", "macos"], "comments": [{"owner": {"reputation": 458, "user_id": 2027188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085678fea49e413bfb66f71361c9a7fd?s=128&d=identicon&r=PG", "display_name": "adc", "link": "https://stackoverflow.com/users/2027188/adc"}, "edited": false, "score": 0, "creation_date": 1557687639, "post_id": 56102498, "comment_id": 98839545, "body": "Traveling Ruby seems somewhat viable, but possibly stale. Maybe spin up an Thin server using <code>Thin::Server.start(...)</code> passing the Rails application as an argument. Traveling Ruby mentions a caveat regarding native extensions on Windows, though, and it&#39;s unclear if Thin would be available."}, {"owner": {"reputation": 947, "user_id": 367480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DdQe5.jpg?s=128&g=1", "display_name": "Ilya Vassilevsky", "link": "https://stackoverflow.com/users/367480/ilya-vassilevsky"}, "edited": false, "score": 0, "creation_date": 1557833984, "post_id": 56102498, "comment_id": 98890274, "body": "What kind of content you need to serve from the site?"}, {"owner": {"reputation": 458, "user_id": 2027188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085678fea49e413bfb66f71361c9a7fd?s=128&d=identicon&r=PG", "display_name": "adc", "link": "https://stackoverflow.com/users/2027188/adc"}, "reply_to_user": {"reputation": 947, "user_id": 367480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DdQe5.jpg?s=128&g=1", "display_name": "Ilya Vassilevsky", "link": "https://stackoverflow.com/users/367480/ilya-vassilevsky"}, "edited": false, "score": 0, "creation_date": 1557938975, "post_id": 56102498, "comment_id": 98937694, "body": "Mostly tabular data, presenting as JSON in and out over websockets."}], "answers": [{"tags": [], "owner": {"reputation": 947, "user_id": 367480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DdQe5.jpg?s=128&g=1", "display_name": "Ilya Vassilevsky", "link": "https://stackoverflow.com/users/367480/ilya-vassilevsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1558121990, "creation_date": 1558121990, "answer_id": 56192619, "question_id": 56102498, "link": "https://stackoverflow.com/questions/56102498/how-can-i-distribute-a-standalone-packaged-rails-node-etc-server/56192619#56192619", "title": "How can I distribute a standalone packaged Rails/Node/etc Server", "body": "<p>The closest I know of (but have <em>not</em> tried myself) is a Go executable with embedded assets (with a tool like <a href=\"https://github.com/gobuffalo/packr\" rel=\"nofollow noreferrer\">Packr</a>).</p>\n"}], "owner": {"reputation": 458, "user_id": 2027188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085678fea49e413bfb66f71361c9a7fd?s=128&d=identicon&r=PG", "display_name": "adc", "link": "https://stackoverflow.com/users/2027188/adc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558121990, "creation_date": 1557687457, "question_id": 56102498, "link": "https://stackoverflow.com/questions/56102498/how-can-i-distribute-a-standalone-packaged-rails-node-etc-server", "title": "How can I distribute a standalone packaged Rails/Node/etc Server", "body": "<p>I'm researching a situation in need of a remote site server. The site changes often. It usually has very limited internet connectivity, but a solid intranet that is utilized heavily. We need to serve clients at these sites.</p>\n\n<p>Are there any modern tools available to package a traditional server stack that can be launched with a double click?</p>\n\n<p>We greatly prefer development on macOS, but will also need to target Windows 10. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching", "memcached", "rabl"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557687965, "post_id": 56102074, "comment_id": 98839633, "body": "&quot;in my rabl file&quot; - not familiar with this gem - where is this located? Is it evaluated each time the controller action runs? Otherwise <code>@cache_key</code> may be nil ... it&#39;s worth checking this."}, {"owner": {"reputation": 77, "user_id": 8048092, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh5.googleusercontent.com/-3kq0QJUBaxw/AAAAAAAAAAI/AAAAAAAAAGQ/2gB7ozjeDI4/photo.jpg?sz=128", "display_name": "shahana hamza", "link": "https://stackoverflow.com/users/8048092/shahana-hamza"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557727007, "post_id": 56102074, "comment_id": 98846618, "body": "This is the gem &#39;rabl&#39;. And by in my rabl file, i meant my view file(index.rabl). Every time the controller action runs, this value is instantiated."}, {"owner": {"reputation": 1999, "user_id": 1116381, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7b470e79f9eb14c32bc0b8f3eb47fbd8?s=128&d=identicon&r=PG", "display_name": "Tachyons", "link": "https://stackoverflow.com/users/1116381/tachyons"}, "edited": false, "score": 0, "creation_date": 1557752351, "post_id": 56102074, "comment_id": 98859196, "body": "<a href=\"https://github.com/nesquena/rabl/blob/b876c8a86a92f49a52163c061c185e6764be57ce/lib/rabl/engine.rb#L54\" rel=\"nofollow noreferrer\">github.com/nesquena/rabl/blob/&hellip;</a>"}, {"owner": {"reputation": 77, "user_id": 8048092, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh5.googleusercontent.com/-3kq0QJUBaxw/AAAAAAAAAAI/AAAAAAAAAGQ/2gB7ozjeDI4/photo.jpg?sz=128", "display_name": "shahana hamza", "link": "https://stackoverflow.com/users/8048092/shahana-hamza"}, "edited": false, "score": 0, "creation_date": 1557768123, "post_id": 56102074, "comment_id": 98867509, "body": "According to this <a href=\"https://github.com/nesquena/rabl/blob/b876c8a86a92f49a52163c061c185e6764be57ce/lib/rabl/engine.rb#L213\" rel=\"nofollow noreferrer\">github.com/nesquena/rabl/blob/&hellip;</a>, If we set <code>cache &quot;rabl&#47;spree&#47;api&#47;home&#47;v2&#47;index-en&quot; </code> then this would be my key. But I am not able to get this key from memcache."}, {"owner": {"reputation": 1086, "user_id": 1327379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZrNi8.jpg?s=128&g=1", "display_name": "andreofthecape", "link": "https://stackoverflow.com/users/1327379/andreofthecape"}, "edited": false, "score": 0, "creation_date": 1557829460, "post_id": 56102074, "comment_id": 98887754, "body": "Does this help? <a href=\"https://github.com/nesquena/rabl/wiki/Caching-in-RABL\" rel=\"nofollow noreferrer\">https://github.com/nesquena/rabl/wiki/Caching-in-RABL</a>"}], "owner": {"reputation": 77, "user_id": 8048092, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh5.googleusercontent.com/-3kq0QJUBaxw/AAAAAAAAAAI/AAAAAAAAAGQ/2gB7ozjeDI4/photo.jpg?sz=128", "display_name": "shahana hamza", "link": "https://stackoverflow.com/users/8048092/shahana-hamza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557750913, "creation_date": 1557684589, "last_edit_date": 1557727087, "question_id": 56102074, "link": "https://stackoverflow.com/questions/56102074/unable-to-find-the-cache-key-in-memcache", "title": "Unable to find the cache key in memcache", "body": "<p>I am using gem <code>rabl</code> for building my api response (<a href=\"https://github.com/nesquena/rabl\" rel=\"nofollow noreferrer\">https://github.com/nesquena/rabl</a>).</p>\n\n<p>In my controller, I have given like this</p>\n\n<pre><code>@cache_key = \"rabl/spree/api/home/v2/index-en\"\n</code></pre>\n\n<p>and in my index.rabl file, I gave,</p>\n\n<pre><code>cache @cache_key, expires_in: 15.minutes\n</code></pre>\n\n<p>I am using memcache for caching using the client Dalli and have deployed the application in heroku. Everything is working as expected. But when I am trying</p>\n\n<pre><code>Rails.cache.fetch('rabl/spree/api/home/v2/index-en')\n</code></pre>\n\n<p>I am not able to see any value. Why is it like this ? Does rabl append any value to cache key ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1557684659, "post_id": 56101849, "comment_id": 98838734, "body": "<code>@states = State.new</code> says that <code>@states</code> is a single <code>State</code>, perhaps you meant <code>@states = State.all</code>."}, {"owner": {"reputation": 329, "user_id": 4100399, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ae323315b0174bcaa8863a76883be9f1?s=128&d=identicon&r=PG&f=1", "display_name": "gbenga wale", "link": "https://stackoverflow.com/users/4100399/gbenga-wale"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1557768811, "post_id": 56101849, "comment_id": 98867825, "body": "Oh! What a silly mistake..I never see that"}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 4100399, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ae323315b0174bcaa8863a76883be9f1?s=128&d=identicon&r=PG&f=1", "display_name": "gbenga wale", "link": "https://stackoverflow.com/users/4100399/gbenga-wale"}, "edited": false, "score": 0, "creation_date": 1557768985, "post_id": 56102386, "comment_id": 98867877, "body": "Thanks for the sharing the link and for putting me through"}], "tags": [], "owner": {"reputation": 910, "user_id": 5351624, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Nqncn.jpg?s=128&g=1", "display_name": "Matheus", "link": "https://stackoverflow.com/users/5351624/matheus"}, "is_accepted": true, "score": 1, "last_activity_date": 1557686692, "creation_date": 1557686692, "answer_id": 56102386, "question_id": 56101849, "link": "https://stackoverflow.com/questions/56101849/am-unable-to-use-the-foreach-loop-in-the-template-in-ruby-on-rails/56102386#56102386", "title": "Am unable to use the foreach loop in the template in Ruby on Rails", "body": "<p>You did two mistakes:</p>\n\n<ol>\n<li><p>I don't think you want to initialize a new object of <code>State</code>, probably you want to get all states, in this case, you should use <code>State.all</code>;</p></li>\n<li><p>The way you did to set the options for the select isn't correct, take a look at the <a href=\"https://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/select\" rel=\"nofollow noreferrer\">documentation</a> (one way to pass the options for the <code>select</code> helper is <code>f.select(:state_id, @states.collect { |state| [ state.name, state.id ] })</code>).</p></li>\n</ol>\n"}], "owner": {"reputation": 329, "user_id": 4100399, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ae323315b0174bcaa8863a76883be9f1?s=128&d=identicon&r=PG&f=1", "display_name": "gbenga wale", "link": "https://stackoverflow.com/users/4100399/gbenga-wale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56102386, "answer_count": 1, "score": 0, "last_activity_date": 1557686692, "creation_date": 1557682977, "last_edit_date": 1557684520, "question_id": 56101849, "link": "https://stackoverflow.com/questions/56101849/am-unable-to-use-the-foreach-loop-in-the-template-in-ruby-on-rails", "title": "Am unable to use the foreach loop in the template in Ruby on Rails", "body": "<p>What I want to do is use the </p>\n\n<blockquote>\n  <p>erb select and the foreach loop </p>\n</blockquote>\n\n<p>to create a select menu(drop down menu) and these are what have done\nStep 1: create the State model and migrate the created ruby file with</p>\n\n<blockquote>\n  <p>rails db:migrate</p>\n</blockquote>\n\n<p>Step2: Include @state in the StaticController like</p>\n\n<pre><code>def index\n  @states = State.new\nend\n</code></pre>\n\n<p>And in the view which is the last step did this</p>\n\n<pre><code>&lt;%= f.label :state %&gt;\n &lt;% @states.each do |state| %&gt;\n &lt;%= f.select :state, (value:state.states) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And this is the error I got</p>\n\n<blockquote>\n  <p>undefined method `each' for #State id: nil, states: nil, created_at: nil, updated_at: nil</p>\n</blockquote>\n\n<p>Meanwhile in the PGAdmin(Postgre Admin), have inserted some names and I can view them in PGAdmin</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rest-client"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1557681815, "post_id": 56101610, "comment_id": 98838002, "body": "Can you elaborate in your question? get is already receiving an uri in your current code, and most probably optional params, which is nothing by now."}], "answers": [{"tags": [], "owner": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "is_accepted": false, "score": 1, "last_activity_date": 1557684568, "creation_date": 1557684568, "answer_id": 56102067, "question_id": 56101610, "link": "https://stackoverflow.com/questions/56101610/how-to-refactor-ruby-rest-client-get-method/56102067#56102067", "title": "How to refactor ruby rest-client get method", "body": "<p>rest-client already accepts a hash for params.  If you prefer a bunch of little methods on your class, you can divide out each step to a method and keep everything readable. </p>\n\n<pre><code>class GoogleTimezoneGetter\n\n  def initialize(lat:, lon:)\n    @lat = lat\n    @lon = lon\n    @time_stamp = Time.new.to_i\n  end\n\n  def response\n    response = RestClient.get gtz_url, params: { gtz_params }\n    JSON.parse(response)\n  end\n\n  def time_zone\n    response[\"timeZoneId\"]\n  end\n\n  def gtz_url\n    \"https://maps.googleapis.com/maps/api/timezone/json\"\n  end\n\n  def gtz_params\n    return {location: \"#{@lat},#{@lon}\", timestamp: @time_stamp, key: GOOGLE_TIME_ZONE_KEY }\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 5756140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae02cf50a1c30141d9d740c6e8cb62b?s=128&d=identicon&r=PG&f=1", "display_name": "Windu Risky Adiatma", "link": "https://stackoverflow.com/users/5756140/windu-risky-adiatma"}, "is_accepted": true, "score": 1, "last_activity_date": 1557757619, "last_edit_date": 1557757619, "creation_date": 1557757256, "answer_id": 56114340, "question_id": 56101610, "link": "https://stackoverflow.com/questions/56101610/how-to-refactor-ruby-rest-client-get-method/56114340#56114340", "title": "How to refactor ruby rest-client get method", "body": "<p>Have you check the <code>rest-client</code> gem <a href=\"https://github.com/rest-client/rest-client/blob/master/README.md\" rel=\"nofollow noreferrer\">readme</a>?</p>\n\n<p>They did give a specific example on this (below example quoted from the readme)</p>\n\n<pre><code>RestClient.get 'http://example.com/resource', {params: {id: 50, 'foo' =&gt; 'bar'}}\n</code></pre>\n\n<p>In your case, it should be something like this</p>\n\n<pre><code>def url\n  \"https://maps.googleapis.com/maps/api/timezone/json\"\nend\n\ndef params\n  {\n    locations: \"#{@lat},#{@lon}\",\n    timestamp: @time_stamp,\n    key: GOOGLE_TIME_ZONE_KEY\n  }\nend\n\ndef response\n  response = RestClient.get(url, params: params)\n  JSON.parse(response)\nend\n</code></pre>\n"}], "owner": {"reputation": 725, "user_id": 9774506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Falko", "link": "https://stackoverflow.com/users/9774506/falko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56114340, "answer_count": 2, "score": -1, "last_activity_date": 1557757619, "creation_date": 1557681310, "last_edit_date": 1557683047, "question_id": 56101610, "link": "https://stackoverflow.com/questions/56101610/how-to-refactor-ruby-rest-client-get-method", "title": "How to refactor ruby rest-client get method", "body": "<p>I'm using Rubys rest-client gem to make a call to Google API and want to shorten the url part.</p>\n\n<p>Current code:</p>\n\n<pre><code>class GoogleTimezoneGetter\n\n  def initialize(lat:, lon:)\n    @lat = lat\n    @lon = lon\n    @time_stamp = Time.new.to_i\n  end\n\n  def response\n    response = RestClient.get \"https://maps.googleapis.com/maps/api/timezone/json?location=#{@lat},#{@lon}&amp;timestamp=#{@time_stamp}&amp;key=#{GOOGLE_TIME_ZONE_KEY}\"\n    JSON.parse(response)\n  end\n\n  def time_zone\n    response[\"timeZoneId\"]\n  end\n\nend\n</code></pre>\n\n<p>I would like to be able to do something like:</p>\n\n<pre><code>def response\n    response = RestClient.get (uri, params) \n    JSON.parse(response)\nend \n</code></pre>\n\n<p>But I'm struggling to find out how to do so.</p>\n\n<p>To make the class a bit tidier, I'd like to break the url down into 'uri' and 'params'. I think the rest-client gem allows you to do this but I can't find specific examples.</p>\n\n<p>I want to put the\n<code>{@lat},#{@lon}&amp;timestamp=#{@time_stamp}&amp;key=#{GOOGLE_TIME_ZONE_KEY}\"</code>\nin to a 'params' method and pass that to the <code>RestClient.get</code> method.</p>\n"}, {"tags": ["ruby", "encoding", "utf-8"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1557683846, "post_id": 56101452, "comment_id": 98838514, "body": "First you should do some research and learn about encodings. The answer is basically that <code>Marshal.dump</code> gives you ASCII-8BIT encoded strings but <code>String#to_json</code> wants UTF-8. Explaining encodings would probably be too broad."}, {"owner": {"reputation": 357, "user_id": 3920497, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3484cf4578ea58143b86d453104a6dd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisCPO", "link": "https://stackoverflow.com/users/3920497/chriscpo"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1557684228, "post_id": 56101452, "comment_id": 98838606, "body": "Can you list some references?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1557684391, "post_id": 56101452, "comment_id": 98838653, "body": "Maybe start with the <a href=\"https://stackoverflow.com/tags/character-encoding/info\">character-encoding</a> tag page."}, {"owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "edited": false, "score": 0, "creation_date": 1557699377, "post_id": 56101452, "comment_id": 98842203, "body": "@ChrisCPO just curious, why would you want to convert a ruby marshaled object to json?  Seems like you would either send the result directly (as a string) or serialize to json to begin with."}, {"owner": {"reputation": 357, "user_id": 3920497, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3484cf4578ea58143b86d453104a6dd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisCPO", "link": "https://stackoverflow.com/users/3920497/chriscpo"}, "edited": false, "score": 0, "creation_date": 1559403764, "post_id": 56101452, "comment_id": 99413374, "body": "sorry went on vacation; currently using a new-ish gem &quot;fie&quot; to flush out a prototype web app that uses websockets for real-time updates, the marshal is stored in redis as json."}], "owner": {"reputation": 357, "user_id": 3920497, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3484cf4578ea58143b86d453104a6dd0?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisCPO", "link": "https://stackoverflow.com/users/3920497/chriscpo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557680098, "creation_date": 1557680098, "question_id": 56101452, "link": "https://stackoverflow.com/questions/56101452/why-are-some-ruby-integers-not-marshal-dumpable-to-json", "title": "Why are some ruby integers not Marshal dumpable to_json", "body": "<p>Running this code slightly more than half of the integers can be parsed to json. I'm looking to understand the why here, let's assume I know nothing about encoding. </p>\n\n<p>ruby 2.5.1</p>\n\n<pre><code>(1..1000).each do |i|\n  begin\n    Marshal.dump(i).to_json\n    puts i\n  rescue =&gt; e\n    puts \"#{i} #{e.message}\"\n  end\nend\n\n\n756\"\\xF4\" from ASCII-8BIT to UTF-8\n757\"\\xF5\" from ASCII-8BIT to UTF-8\n758\"\\xF6\" from ASCII-8BIT to UTF-8\n759\"\\xF7\" from ASCII-8BIT to UTF-8\n760\"\\xF8\" from ASCII-8BIT to UTF-8\n761\"\\xF9\" from ASCII-8BIT to UTF-8\n762\"\\xFA\" from ASCII-8BIT to UTF-8\n763\"\\xFB\" from ASCII-8BIT to UTF-8\n764\"\\xFC\" from ASCII-8BIT to UTF-8\n765\"\\xFD\" from ASCII-8BIT to UTF-8\n766\"\\xFE\" from ASCII-8BIT to UTF-8\n767\"\\xFF\" from ASCII-8BIT to UTF-8\n768\n769\n770\n771\n772\n773\n774\n775\n776\n777\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "methods", "self-reference"], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 10304792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390a35e9e2e8a287a260f9569e8a1483?s=128&d=identicon&r=PG&f=1", "display_name": "dsteinbr1", "link": "https://stackoverflow.com/users/10304792/dsteinbr1"}, "is_accepted": true, "score": 0, "last_activity_date": 1557803516, "creation_date": 1557803516, "answer_id": 56122490, "question_id": 56101266, "link": "https://stackoverflow.com/questions/56101266/self-referential-relationship-for-record-will-only-create-relationship-with-itse/56122490#56122490", "title": "Self-Referential Relationship for Record will only Create Relationship with Itself", "body": "<p>I found that the issue outlined above arose due to a child not being defined in the child-parent relationship between two records in the self referential relationship. by adding the following lines in the form and controller respectively I was able to define this variable and create the desired relationships.</p>\n\n<p>Form</p>\n\n<pre><code>&lt;%= hidden_field_tag :child_id, @ingref.id %&gt;\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>current_ingref = Ingref.find(params[:child_id])\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 10304792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390a35e9e2e8a287a260f9569e8a1483?s=128&d=identicon&r=PG&f=1", "display_name": "dsteinbr1", "link": "https://stackoverflow.com/users/10304792/dsteinbr1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 56122490, "answer_count": 1, "score": 0, "last_activity_date": 1557803516, "creation_date": 1557678886, "question_id": 56101266, "link": "https://stackoverflow.com/questions/56101266/self-referential-relationship-for-record-will-only-create-relationship-with-itse", "title": "Self-Referential Relationship for Record will only Create Relationship with Itself", "body": "<p>I am attempting to create a method by which a user may attach related records to an existing records similar to how a user may follow other users. However, when the method is called, a relationship can only be made between the record and itself. I have based my code on a follower/following model and I believe the issue is arising because the method is unable to differentiate between the current record and the record being selected to create a relationship with. Any ideas how this may be addressed? Relevant code is below...</p>\n\n<p>Model </p>\n\n<pre><code>    class Ingref &lt; ApplicationRecord\n        has_many :active_relationships, class_name: \"Ingrelationship\",\n                                    foreign_key: \"child_id\",\n                                    dependent: :destroy\n    has_many :passive_relationships, class_name: \"Ingrelationship\",\n                                     foreign_key: \"parent_id\",\n                                     dependent: :destroy\n    has_many :children, through: :active_relationships, source: :parent\n    has_many :parents, through: :passive_relationships, source: :child\n\n    # Follows a user.\n    def follow(other_ingref)\n        children &lt;&lt; other_ingref\n    end\n\n    # Unfollows a user.\n    def unfollow(other_ingref)\n        children.delete(other_ingref)\n    end\n\n    # Returns true if the current user is following the other user.\n    def following?(other_ingref)\n        children.include?(other_ingref)\n    end\n\nend \n</code></pre>\n\n<p>Relationship Controller</p>\n\n<pre><code>class IngrelationshipsController &lt; ApplicationController\n    before_action :set_search\n\n    def create\n        ingref = Ingref.find(params[:parent_id])\n        ingref.follow(ingref)\n        redirect_to ingref\n    end\n\n    def destroy\n        ingref = Ingrelationship.find(params[:id]).parent\n        @ingref.unfollow(ingref)\n        redirect_to ingref\n    end\nend\n</code></pre>\n\n<p>Relationship Model</p>\n\n<pre><code>class Ingrelationship &lt; ApplicationRecord\n    belongs_to :child, class_name: \"Ingref\"\n    belongs_to :parent, class_name: \"Ingref\"\nend\n</code></pre>\n\n<p>Form</p>\n\n<pre><code>&lt;% Ingref.find_each do |ingref| %&gt;\n\n        &lt;div class=\"col-md-2\"&gt;\n              &lt;div class=\"caption\"&gt;\n                &lt;h3 class=\"title\" style=\"font-size: 14px;\"&gt; &lt;%= ingref.name %&gt; &lt;/h3&gt;\n                    &lt;%= form_for(@ingref.active_relationships.build) do |f| %&gt;\n                        &lt;div&gt;&lt;%= hidden_field_tag :parent_id, ingref.id %&gt;&lt;/div&gt;\n                        &lt;%= f.submit \"Follow\" %&gt;\n                    &lt;% end %&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "bootstrap-4", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1557714110, "post_id": 56101193, "comment_id": 98844211, "body": "Try moving jquery and jquery-ui before bootstrap in you applications.js file."}, {"owner": {"reputation": 121, "user_id": 11488922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a781b6fb23434621f617efcd4d9777?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastiaanpoppen", "link": "https://stackoverflow.com/users/11488922/sebastiaanpoppen"}, "reply_to_user": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1557725364, "post_id": 56101193, "comment_id": 98846177, "body": "@hashrocket, thanks, I tried, but it makes no difference unfortunately. Also did the same for application.css.sccs. Same result"}, {"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1557749927, "post_id": 56101193, "comment_id": 98857836, "body": "Instead of $(document).ready, try $(document).on(\u2018turbolinks:load\u2019, function() {})"}, {"owner": {"reputation": 121, "user_id": 11488922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a781b6fb23434621f617efcd4d9777?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastiaanpoppen", "link": "https://stackoverflow.com/users/11488922/sebastiaanpoppen"}, "reply_to_user": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1557768494, "post_id": 56101193, "comment_id": 98867667, "body": "Hey man, thanks! This seems to partly solve the problem. The given form is rendered via turbolinks. When I call $(&#39;.selectpicker&#39;).selectpicker(); from this js file the dropdown is loaded. It doesn&#39;s however change the styling. <a href=\"https://i.imgur.com/OL987a9.png\" rel=\"nofollow noreferrer\">i.imgur.com/OL987a9.png</a>   I tried to swap around the items in my application.css.scss, but this doesn&#39;t seem to do the trick."}, {"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1557769021, "post_id": 56101193, "comment_id": 98867896, "body": "According to the docs for bootstrap-select-rails: Also, you must require at least the alert and dropdown bootstrap components. For example, if using bootstrap-sass: //= require bootstrap/alert, //= require bootstrap/dropdown. I don&#39;t see either one of these in your application.js"}, {"owner": {"reputation": 121, "user_id": 11488922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a781b6fb23434621f617efcd4d9777?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastiaanpoppen", "link": "https://stackoverflow.com/users/11488922/sebastiaanpoppen"}, "reply_to_user": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1557773642, "post_id": 56101193, "comment_id": 98869768, "body": "I added both lines earlier, but it didn&#39;t make a difference unfortunately. Thanks for the suggestion though. I&#39;ve put them back in the application.js for now and updated my post."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 11488922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a781b6fb23434621f617efcd4d9777?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastiaanpoppen", "link": "https://stackoverflow.com/users/11488922/sebastiaanpoppen"}, "is_accepted": false, "score": 0, "last_activity_date": 1557944787, "creation_date": 1557944787, "answer_id": 56155577, "question_id": 56101193, "link": "https://stackoverflow.com/questions/56101193/bootstrap-select-rails-not-working-with-bootstrap-4/56155577#56155577", "title": "bootstrap-select-rails not working with bootstrap 4", "body": "<p>I wasn't able to solve the problem via the bootstrap-select-rails or changing the order of my application.js and application.scss. I included the latest version of both the css and js file in my assets instead.This solved the problem for me.</p>\n"}], "owner": {"reputation": 121, "user_id": 11488922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a781b6fb23434621f617efcd4d9777?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastiaanpoppen", "link": "https://stackoverflow.com/users/11488922/sebastiaanpoppen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 820, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557944787, "creation_date": 1557678321, "last_edit_date": 1557773505, "question_id": 56101193, "link": "https://stackoverflow.com/questions/56101193/bootstrap-select-rails-not-working-with-bootstrap-4", "title": "bootstrap-select-rails not working with bootstrap 4", "body": "<p>I am setting up a new project with Bootstrap 4 and the bootstrap-select-rails selectpicker. The selectpicker doesn't work and can't resolve the correct styling. This is what the selectpickers should look like: <a href=\"https://developer.snapappointments.com/bootstrap-select/examples/\" rel=\"nofollow noreferrer\">https://developer.snapappointments.com/bootstrap-select/examples/</a></p>\n\n<p>Instead it servers the unstyled version like it would without the selectpicker gem included. Like in section 1 of the following page:</p>\n\n<p><a href=\"https://bootstrapbay.com/blog/useful-bootstrap-4-select-picker-for-your-forms/\" rel=\"nofollow noreferrer\">https://bootstrapbay.com/blog/useful-bootstrap-4-select-picker-for-your-forms/</a></p>\n\n<p>I think I correctly installed all the necessary dependencies (popper.js, jquery, etc.)</p>\n\n<p>I tried to use multiple versions of the bootstrap-select-rails gem and tried to include the selectpicker via the two suggested methods:</p>\n\n<p>Via js:</p>\n\n<pre><code>$(document).ready(function() {\n    $('.selectpicker').selectpicker();\n});\n</code></pre>\n\n<p>And via adding the selectpicker class to the formfield</p>\n\n<pre><code>&lt;%= f.input :use_standard_steps, label: 'Select input test', as: :select, collection: ['a','b','c'], required: false, input_html: { class: \"selectpicker\", multiple: true } %&gt;\n</code></pre>\n\n<p>Below is a copy of my gemfile:</p>\n\n<pre><code>ruby '2.5.1'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.2.2'\n# gem 'sqlite3'\ngem 'bootsnap', '&gt;= 1.1.0', require: false\ngem 'bootstrap', '~&gt; 4.1.3'\ngem 'bootstrap-select-rails', '~&gt; 1.3.0.1'\ngem 'bootstrap4-datetime-picker-rails'\ngem 'coffee-rails', '~&gt; 4.2'\ngem 'devise', '~&gt; 4.6.2'\ngem 'factory_bot_rails'\ngem 'faker', '1.9.1' # Create fake database data\ngem 'font-awesome-sass', '~&gt; 5.6.1'\ngem 'jbuilder', '~&gt; 2.5'\ngem 'jquery-rails', '~&gt; 4.3', '&gt;= 4.3.1'\ngem 'jquery-ui-rails', '~&gt; 6.0.1'\ngem 'momentjs-rails', '~&gt; 2.20.1'\ngem 'pg', '~&gt; 1.1.4'\ngem 'popper_js', '~&gt; 1.14.5'\ngem 'puma', '~&gt; 3.11'\ngem 'sass-rails', '~&gt; 5.0'\ngem 'simple_form', '~&gt; 4.1'\ngem 'turbolinks', '~&gt; 5'\ngem 'uglifier', '&gt;= 1.3.0'\ngem 'webpacker', '~&gt; 4.x'\n</code></pre>\n\n<p>A copy of my application.js</p>\n\n<pre><code>//= require rails-ujs\n//= require jquery\n//= require jquery-ui\n//= require popper\n//= require bootstrap\n//= require moment\n//= require moment/nl.js\n//= require tempusdominus-bootstrap-4.js\n//= require bootstrap-sprockets\n//= require bootstrap/alert\n//= require bootstrap/dropdown\n//= require bootstrap-select\n//= require activestorage\n//= require turbolinks\n//= require_tree .\n\n</code></pre>\n\n<p>And a copy of my application.css.scss</p>\n\n<pre><code>@import \"jquery-ui\";\n@import \"bootstrap\";\n@import 'bootstrap-select';\n@import \"tempusdominus-bootstrap-4.css\";\n@import \"custom\";\n@import \"general\";\n@import \"font-awesome-sprockets\";\n@import \"font-awesome\";\n@import url('https://fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700,800');\n@import url('https://fonts.googleapis.com/css?family=Raleway');\n</code></pre>\n\n<p>Chrome Inspect shows that the Bootstrap-selectpicker css is included in my HEAD</p>\n\n<p>Can someone point out the flaws in my setup?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1557681659, "post_id": 56100590, "comment_id": 98837968, "body": "But even if I do not put <code>;</code> it still remains. Try out this <code>variable = 1 [*1..10].each do |n,variable|        variable = 2 end  puts variable</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557684617, "post_id": 56100590, "comment_id": 98838721, "body": "The use of a semi-colon to define block local variables is evidently is not very popular as I&#39;ve <i>never</i> seen it used (and didn&#39;t know about it until now). I don&#39;t know if I&#39;d counsel others to not use it, however, as the Ruby monks decided it was a worthwhile addition."}], "tags": [], "owner": {"reputation": 7685, "user_id": 517868, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/771951f55ed37335f238e1a80dfda9cd?s=128&d=identicon&r=PG", "display_name": "Juanito Fatas", "link": "https://stackoverflow.com/users/517868/juanito-fatas"}, "is_accepted": false, "score": 1, "last_activity_date": 1557704166, "last_edit_date": 1557704166, "creation_date": 1557674000, "answer_id": 56100590, "question_id": 56100589, "link": "https://stackoverflow.com/questions/56100589/shadow-outer-variable-inside-block-in-ruby/56100590#56100590", "title": "Shadow outer variable inside block in Ruby", "body": "<p>Yes! Since Ruby 1.9, Ruby introduced block-local variables that any variable precedes with <code>;</code> will not be affected. But this is not good, please consider using another name in the block.</p>\n\n<pre><code>variable = 1\n[*1..10].each do |n; variable|\n  ...\n  variable = 2\nend\n</code></pre>\n"}], "owner": {"reputation": 7685, "user_id": 517868, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/771951f55ed37335f238e1a80dfda9cd?s=128&d=identicon&r=PG", "display_name": "Juanito Fatas", "link": "https://stackoverflow.com/users/517868/juanito-fatas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557704166, "creation_date": 1557674000, "question_id": 56100589, "link": "https://stackoverflow.com/questions/56100589/shadow-outer-variable-inside-block-in-ruby", "title": "Shadow outer variable inside block in Ruby", "body": "<p>I have:</p>\n\n<pre><code>variable = 1\n</code></pre>\n\n<p>And a block that is using the same name variable:</p>\n\n<pre><code>[*1..10].each do |n|\n  ...\n  variable = 2\nend\n</code></pre>\n\n<p>Is there a way to avoid changing the outside variable (shadow?)</p>\n"}, {"tags": ["ruby", "oop", "metaprogramming"], "answers": [{"comments": [{"owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "edited": false, "score": 0, "creation_date": 1557675689, "post_id": 56100424, "comment_id": 98836301, "body": "That&#39;s not how the word &quot;singleton&quot; is used in a Ruby context. In Ruby, a singleton method is a method applied to the Eigen class (in Ruby called the Singleton class) of an object. These methods are effectively attached to the particular instance and not the class of objects. This is reflected in the 2 methods mentioned in the title. define_singleton_method is a public method that creates a singleton method on an abject and define_method is a private method that creates a  method on a class."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1557675790, "post_id": 56100424, "comment_id": 98836331, "body": "The <i>Singleton Design Pattern</i> is only tangentially related to <i>singleton methods</i> in Ruby. In particular, the only relationship between the two is that both use the word &quot;singleton&quot; in its standard English (Latin) sense."}], "tags": [], "owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "is_accepted": false, "score": -1, "last_activity_date": 1557721170, "last_edit_date": 1557721170, "creation_date": 1557672931, "answer_id": 56100424, "question_id": 56100281, "link": "https://stackoverflow.com/questions/56100281/when-to-use-define-singleton-method-v-define-method/56100424#56100424", "title": "When to use define_singleton_method v define_method", "body": "<p>back to your question... replace the following code block</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>define_method k do\n  v\nend\n</code></pre>\n\n<p>with</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>self.class.send(:define_method, k) do\n  v\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 6312525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f960e85c67cd924bad8c53f540dd4db?s=128&d=identicon&r=PG&f=1", "display_name": "hkly", "link": "https://stackoverflow.com/users/6312525/hkly"}, "edited": false, "score": 0, "creation_date": 1588093957, "post_id": 56100951, "comment_id": 108766044, "body": "This forces you to manually set <code>attr_readers</code> for reach instance variable you need which defeats the purpose of programmatically defining a method/instance variable."}], "tags": [], "owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "is_accepted": false, "score": 0, "last_activity_date": 1557676898, "last_edit_date": 1557676898, "creation_date": 1557676399, "answer_id": 56100951, "question_id": 56100281, "link": "https://stackoverflow.com/questions/56100281/when-to-use-define-singleton-method-v-define-method/56100951#56100951", "title": "When to use define_singleton_method v define_method", "body": "<p>Its not clear what your final goal is. For example I am not sure why you would have a <code>print_french_colors</code> method if the language were anything other than french.  It seems like you basically want to read a yaml file and use that to set the value of some pre-defined attributes.</p>\n\n<p>To accomplish that, I think it would make more sense to use instance_variable_set rather than define_method.  Here is an example. </p>\n\n<p>french.yml</p>\n\n<pre><code>blue: blue\nred: rouge\n</code></pre>\n\n<hr>\n\n<pre><code>require \"yaml\"\nclass Translations\n  attr_reader :blue, :red \n  def initialize(language: \"french\")\n    data = YAML.load_file(\"#{language}.yml\")\n    data.each do |k, v| \n        if respond_to?(k)\n          instance_variable_set(\"@#{k}\",v)    \n        else \n          puts \"#{k} is not defined\"\n        end\n    end\n\n    print_french_colors\n  end\n\n  def print_french_colors\n    puts red\n    puts blue\n  end\nend\n\nt = Translations.new \nt.print_french_colors\n</code></pre>\n"}], "owner": {"reputation": 1004, "user_id": 2091331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ff378547e4b88acd5cd7b4f9b15b956?s=128&d=identicon&r=PG", "display_name": "Jbur43", "link": "https://stackoverflow.com/users/2091331/jbur43"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 950, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1557721170, "creation_date": 1557671951, "question_id": 56100281, "link": "https://stackoverflow.com/questions/56100281/when-to-use-define-singleton-method-v-define-method", "title": "When to use define_singleton_method v define_method", "body": "<p>In one answer to <a href=\"https://stackoverflow.com/questions/19368437/how-to-use-define-method-inside-initialize\">this question</a> user, mu is too short, explains that you wouldn't want an object's behavior to change too drastically on initialization, which makes sense, you should be able to reason about an object well by reading its definition and being introspective but I had this case in mind:</p>\n\n<pre><code>french_colors.yml\n\nblue: blue\nred: rouge\n...\n\n</code></pre>\n\n<pre><code>translations.rb\n\nclass Translations\n  def initialize(language: \"french\")\n    data = YAML.load_file(\"./translations/#{language}.yml\")\n    data.each do |k, v|\n      define_method k do\n        v\n      end\n    end\n\n    print_french_colors\n  end\n\n  def print_french_colors\n    puts red\n    puts blue\n  end\nend\n</code></pre>\n\n<p>When initialized, the above Errors with \n<code>#=&gt; NoMethodError: undefined method `define_method' for #&lt;C:0x2efae80&gt;</code></p>\n\n<p>Here you build all of the Translations behavior off of the file received from a translation company and want it as an instance and also want it to be dynamic based on the language file (this is all just an example)</p>\n\n<p>Would it make more sense to define and set the translations as attributes of the object in initialization instead of using define_method in initialization like this questions OP and I were trying to do? Or is it the case that the method <code>define_singleton_method</code> was written to handle situations like this specifically? </p>\n\n<p><a href=\"https://stackoverflow.com/questions/19368437/how-to-use-define-method-inside-initialize\">How to use define_method inside initialize()</a></p>\n"}, {"tags": ["ruby", "class", "module", "namespaces"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557688190, "post_id": 56100277, "comment_id": 98839697, "body": "You are right, namespacing is <i>just</i> about namespacing and doesn&#39;t give you the same behavior as inheritance"}], "answers": [{"tags": [], "owner": {"reputation": 1392, "user_id": 2922609, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/JRouJ.png?s=128&g=1", "display_name": "ivanibash", "link": "https://stackoverflow.com/users/2922609/ivanibash"}, "is_accepted": true, "score": 0, "last_activity_date": 1557728910, "creation_date": 1557728910, "answer_id": 56106807, "question_id": 56100277, "link": "https://stackoverflow.com/questions/56100277/what-are-implications-of-namespacing-classes-under-same-namespace-under-the-same/56106807#56106807", "title": "What are implications of namespacing classes under same namespace/under the same name as a module", "body": "<p>As mentioned in the comment, namespacing as described in the question is just namespacing, and so the above are completely separate modules/classes.</p>\n"}], "owner": {"reputation": 1392, "user_id": 2922609, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/JRouJ.png?s=128&g=1", "display_name": "ivanibash", "link": "https://stackoverflow.com/users/2922609/ivanibash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 56106807, "answer_count": 1, "score": 0, "last_activity_date": 1557728910, "creation_date": 1557671925, "question_id": 56100277, "link": "https://stackoverflow.com/questions/56100277/what-are-implications-of-namespacing-classes-under-same-namespace-under-the-same", "title": "What are implications of namespacing classes under same namespace/under the same name as a module", "body": "<p>As in the title. I have this:</p>\n\n<pre><code>module Car\n # stuff here\nend\n\nclass Car::SUV\n  #stuff here\nend\n\nclass Car::Hatchback\n  #stuff here\nend\n</code></pre>\n\n<p>Are there any implications at all to the fact that my classes are namespaced with my module's name? What about the fact that they are namespaced under the same name? As far as I understand no variables are shared here, and the only reason to namespace classes is to avoid name clashes?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["arrays", "ruby", "image", "pointers", "ffi"], "answers": [{"comments": [{"owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "edited": false, "score": 0, "creation_date": 1557739918, "post_id": 56104617, "comment_id": 98852578, "body": "Awesome! Thanks for pointing this out. One more thing: is it possible to use the already allocated Ruby arrays instead of allocating a <i>separate</i> pointer and dumping the arrays there as well? Currently arrays are copied twice (both at input and output), and if they are big, this can cause some significant overhead."}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "reply_to_user": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "edited": false, "score": 0, "creation_date": 1557749154, "post_id": 56104617, "comment_id": 98857459, "body": "@linkyndy I don\u2019t think that would be possible. Even though a Ruby array is backed by a C array (in MRI Ruby at least), it is an array of Ruby objects not the appropriate C type. You could possibly wrap a MemoryPointer in a class and give it a suitable API, letting you build up the C array directly and avoiding the Ruby array."}, {"owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "edited": false, "score": 0, "creation_date": 1557834844, "post_id": 56104617, "comment_id": 98890759, "body": "I understand. Seems like too much hassle, at least for now. Thanks!"}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 1, "last_activity_date": 1557707933, "creation_date": 1557707933, "answer_id": 56104617, "question_id": 56100211, "link": "https://stackoverflow.com/questions/56100211/ruby-ffi-to-call-c-function-with-array-of-arrays/56104617#56104617", "title": "Ruby FFI to call C function with array of arrays", "body": "<p>To pass the data in to the function you need to to use a <a href=\"https://www.rubydoc.info/github/ffi/ffi/FFI/MemoryPointer\" rel=\"nofollow noreferrer\"><code>MemoryPointer</code></a>, first copying the data from the Ruby arrays into it so that it is in the correct form when the C code sees it. Copying the data for a single dimensional array is fairly straightforward using one of the <code>write_array_of_*</code> methods. For a multi dimensional array it is a little trickier, you need to copy each array into the correct place int the memory managed to the <code>MemoryPointer</code>.</p>\n\n<p>Similarly for data returned by the function through a pointer you need to provide a <code>MemoryPointer</code> of the right size and then copy the data out into Ruby arrays. Again this is fairly easy for a single dimension array with the <code>read_array_of*</code> methods and is a little more work for a multi dimension array.</p>\n\n<p>Here is a simple example. Here I assume the arguments to the C function always consists of three three-element int arrays \u2013 <code>int[3][3]</code>.</p>\n\n<p>The C function:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int foo(void* bar, void* baz) {\n    // assume both arrays are [3][3]\n    int(*bar_)[3] = (int (*)[3]) bar;\n    int(*baz_)[3] = (int (*)[3]) baz;\n\n    // Highly complex processing - double each entry.\n    for (int i = 0; i&lt; 3; i++) {\n        for (int j = 0; j &lt; 3; j++) {\n            baz_[i][j] = 2 * bar_[i][j];\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Here is the Ruby code to access it:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>require 'ffi'\n\nmodule MyLibrary\n  extend FFI::Library\n  ffi_lib \"path/to/mylibrary.so\"\n\n  # Give function a different name. You might also want to make\n  # it private.\n  attach_function(:ffi_foo, :foo, [:pointer, :pointer], :int)\n\n  # Wrap the C function with a friendly method that packages\n  # and unpackages the data.\n  def self.foo(pixels)\n    # Create the MemoryPointers for input and output. They are\n    # both 9 entry (3 * 3) arrays of uint32.\n    input = FFI::MemoryPointer.new(:uint32, 9)\n    output = FFI::MemoryPointer.new(:uint32, 9)\n\n    # Copy the input data into the input MemoryPointer\n    pixels.each_with_index do |ary, idx|\n      # The offset here is in bytes. int32 is 4 bytes, each\n      # array is three elements so total is 3 * 4 = 12.\n      input.put_array_of_int32(idx * 12, ary)\n    end\n\n    # Call the C function.\n    ffi_foo(input, output)\n\n    result = []\n\n    # Copy the data back into a Ruby array.\n    3.times do |idx|\n      result &lt;&lt; output.get_array_of_int32(idx * 12, 3)\n    end\n\n    # Return the final result\n    result\n\n  end\nend\n</code></pre>\n\n<p>You can then use it like this:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>pixels = [[3, 34, 123], [32, 253, 34], [1, 1, 34]]\np MyLibrary.foo(pixels) #=&gt;[[6, 68, 246], [64, 506, 68], [2, 2, 68]]\n</code></pre>\n\n<p>Obviously you will need to adapt this to match the details of your own function. You should probably also add error checking, otherwise you could be liable to getting segfaults.</p>\n"}], "owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 56104617, "answer_count": 1, "score": 2, "last_activity_date": 1557707933, "creation_date": 1557671449, "question_id": 56100211, "link": "https://stackoverflow.com/questions/56100211/ruby-ffi-to-call-c-function-with-array-of-arrays", "title": "Ruby FFI to call C function with array of arrays", "body": "<p>I have the following C interface:</p>\n\n<pre><code>int foo(void* bar, void* baz);\n</code></pre>\n\n<p>What this does, basically, is take an array of RGB values, process them, and return a new array of RGB values.</p>\n\n<p>I wrote the following Ruby FFI wrapper for it:</p>\n\n<pre><code>module MyLibrary\n  extend FFI::Library\n  ffi_lib \"path/to/mylibrary.so\"\n  attach_function :foo, [:pointer, :pointer], :int\nend\n</code></pre>\n\n<p>However, I have not really succeeded to pass a Ruby array-of-arrays to this FFI wrapper. In Ruby, I have something like:</p>\n\n<pre><code>pixels = [[3, 34, 123], [32, 253, 34], ..., [1, 1, 34]]\nresult = [[0, 0, 0], [0, 0, 0], ..., [0, 0, 0]]\n\n# This does not work!\nMyLibrary.foo(pixels, result)\n</code></pre>\n\n<p>I've looked in the Ruby FFI docs, however I did not get how the Ruby arrays should be passed to the FFI wrapper.</p>\n"}, {"tags": ["ruby", "loops", "for-loop"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1557672881, "post_id": 56099565, "comment_id": 98835581, "body": "I cannot reproduce your problem. I get a &quot;syntax error, unexpected end-of-input&quot; for the first example, just like you would expect, since it is missing the <code>end</code> keyword for ending the <code>for</code>/<code>in</code> expression."}], "answers": [{"comments": [{"owner": {"reputation": 380, "user_id": 3838537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dbf714fa6d6114f49582dd36fd6d886?s=128&d=identicon&r=PG", "display_name": "seeker", "link": "https://stackoverflow.com/users/3838537/seeker"}, "edited": false, "score": 0, "creation_date": 1557669135, "post_id": 56099874, "comment_id": 98834637, "body": "&quot;but does not create a new variable scope&quot; - could you explain why the implication of this is that we can&#39;t use curly braces with for loop?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1557672215, "post_id": 56099874, "comment_id": 98835431, "body": "seeker, ye shall find that <code>for i in [1,2,3] do; s = &#39;cat&#39;; end; s #=&gt; &#39;cat&#39;</code> runs just fine. If <code>do; s = &#39;cat&#39;; end</code> created a new scope for <code>s</code> (as would a block), the last line (<code>s</code>) would raise an exception."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1557668846, "creation_date": 1557668846, "answer_id": 56099874, "question_id": 56099565, "link": "https://stackoverflow.com/questions/56099565/why-cant-i-use-curly-braces-with-a-for-loop-in-ruby/56099874#56099874", "title": "Why can&#39;t I use curly braces with a `for` loop in Ruby?", "body": "<p>Take a look to the documentation here: <a href=\"https://ruby-doc.org/core-2.6.2/doc/syntax/control_expressions_rdoc.html#label-for+Loop\" rel=\"nofollow noreferrer\">For loop</a>\nIt states:</p>\n\n<blockquote>\n  <p>Like while and until, the do is optional. The for loop is similar to\n  using each, <strong>but does not create a new variable scope</strong>.</p>\n</blockquote>\n\n<p>And also</p>\n\n<blockquote>\n  <p>The for loop is rarely used in modern ruby programs.</p>\n</blockquote>\n\n<p>So, be less Pythonic :) using <a href=\"https://ruby-doc.org/core-2.6.2/Enumerator.html#method-i-each\" rel=\"nofollow noreferrer\">Enumerator#each</a> instead:</p>\n\n<pre><code>a.each { |a| puts a }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 1, "creation_date": 1557692980, "post_id": 56100612, "comment_id": 98840852, "body": "Excellent explanation."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 3, "last_activity_date": 1557674202, "creation_date": 1557674202, "answer_id": 56100612, "question_id": 56099565, "link": "https://stackoverflow.com/questions/56099565/why-cant-i-use-curly-braces-with-a-for-loop-in-ruby/56100612#56100612", "title": "Why can&#39;t I use curly braces with a `for` loop in Ruby?", "body": "<blockquote>\n  <p>The <a href=\"https://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-do\" rel=\"nofollow noreferrer\">Ruby Documentation</a> says that \"<code>do/end</code> is equivalent to curly braces\"</p>\n</blockquote>\n\n<p>No, it doesn't. It says (<strong>bold</strong> emphasis mine):</p>\n\n<blockquote>\n  <p><strong>In this context</strong>, <code>do</code>/<code>end</code> is equivalent to curly braces [\u2026]</p>\n</blockquote>\n\n<p>What \"in this context\" means is defined directly before the half-sentence you quoted:</p>\n\n<blockquote>\n  <h1><code>do</code></h1>\n  \n  <p>Paired with <code>end</code>, can delimit <strong>a code block</strong></p>\n</blockquote>\n\n<p>So, \"in this context\" here refers to the context of a <em>block</em>.</p>\n\n<blockquote>\n  <p>so why is it that when I attempt to do the following I do not receive any output</p>\n</blockquote>\n\n<p>Because this is a completely different context, again quoting from the documentation you linked to:</p>\n\n<blockquote>\n  <p><code>do</code> can <strong>also</strong> (optionally) appear at the end of a <code>for</code>/<code>in</code> statement. (See <code>for</code> for an example.)</p>\n</blockquote>\n\n<p>The \"also\" in that sentence makes it very clear that this is a <em>different</em> usage of the keyword <code>do</code> that has nothing to do with the usage discussed in this section. And if you look at <a href=\"https://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-for\" rel=\"nofollow noreferrer\">the documentation of <code>for</code></a>, you can see that there is no mention of curly braces being allowed.</p>\n\n<blockquote>\n  <p>When I perform the above I receive no output (but I don't receive an error message either).</p>\n</blockquote>\n\n<p>That is not true. Your code is syntactically invalid because it is missing the <code>end</code> keyword to end the <code>for</code>/<code>in</code> expression, therefore you get a \"syntax error, unexpected end-of-input\" on line 4:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>ruby -c -e 'a = [1, 2, 3]\nfor i in a {\n  puts i\n}'\n# -e:4: syntax error, unexpected end-of-input\n</code></pre>\n\n<p>And if you add the missing <code>end</code>, you get a <code>in `&lt;main&gt;': undefined method `a' for main:Object (NoMethodError)</code> on line 2:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>ruby -e 'a = [1, 2, 3]\nfor i in a {\n  puts i\n}\nend'\n# -e:2:in `&lt;main&gt;': undefined method `a' for main:Object (NoMethodError)\n</code></pre>\n\n<p>Again, this is expected because curly braces delimit a code block, so </p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>a {\n  puts i\n}\n</code></pre>\n\n<p>is interpreted as a code block being passed to <code>a</code> and since variables cannot receive arguments, only methods can, <code>a</code> must be a method. Therefore, Ruby rightfully complains about not finding a method named <code>a</code>.</p>\n\n<p>There are three ways of delimiting the iterator expression from the loop body expression in a <code>for</code>/<code>in</code> loop (and the same applies to <code>while</code> and <code>until</code> loops, actually):</p>\n\n<ol>\n<li><p>An <em>expression separator</em>. An expression separator can either be </p>\n\n<ol>\n<li>a semicolon <code>;</code></li>\n<li>a newline</li>\n</ol></li>\n<li><p>The keyword <code>do</code></p></li>\n</ol>\n\n<p>So, the following would all be valid fixes for your code:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code># non-idiomatic\nfor i in a; puts i end\n\n# non-idiomatic\nfor i in a\nputs i end\n\n# the same but with idiomatic indentation and whitespace\nfor i in a\n  puts i\nend\n\n# idiomatic\nfor i in a do puts i end\n\n# redundant, non-idiomatic\nfor i in a do\n  puts i\nend\n</code></pre>\n\n<p>Note, that when I say \"idiomatic\" above, that is to be interpreted relative, since actually <code>for</code>/<code>in</code> loops <em>as a whole</em> are completely non-idiomatic, and you would rather do this:</p>\n\n<pre><code>a.each do |i|\n  puts i\nend\n</code></pre>\n\n<p>or maybe </p>\n\n<pre><code>a.each(&amp;method(:puts))\n</code></pre>\n\n<p>It is in general preferred to not mix I/O and data transformation, so another idiomatic solution would be to transform the data to the desired output first, then output it, like this:</p>\n\n<pre><code>puts a.join(\"\\n\")\n</code></pre>\n\n<p>Except that <a href=\"https://ruby-doc.org/core/Kernel.html#method-i-puts\" rel=\"nofollow noreferrer\"><code>Kernel#puts</code></a> will already treat <code>Array</code> arguments special and print each element on its own line (as documented at <a href=\"https://ruby-doc.org/core/IO.html#method-i-puts\" rel=\"nofollow noreferrer\"><code>IO#puts</code></a>), so the <em>real</em> correct idiomatic solution for your code would be just:</p>\n\n<pre><code>puts a\n</code></pre>\n"}], "owner": {"reputation": 380, "user_id": 3838537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dbf714fa6d6114f49582dd36fd6d886?s=128&d=identicon&r=PG", "display_name": "seeker", "link": "https://stackoverflow.com/users/3838537/seeker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 56100612, "answer_count": 2, "score": 0, "last_activity_date": 1557674202, "creation_date": 1557666613, "last_edit_date": 1557667131, "question_id": 56099565, "link": "https://stackoverflow.com/questions/56099565/why-cant-i-use-curly-braces-with-a-for-loop-in-ruby", "title": "Why can&#39;t I use curly braces with a `for` loop in Ruby?", "body": "<p>The <a href=\"https://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-do\" rel=\"nofollow noreferrer\">Ruby Documentation</a> says that \"<code>do/end</code> is equivalent to curly braces\", so why is it that when I attempt to do the following I do not receive any output:</p>\n\n<pre><code>a = [1, 2, 3]\nfor i in a {\n  puts i\n}\n</code></pre>\n\n<p>When I perform the above I receive no output (but I don't receive an error message either). However, when I do the following everything is as it should be:</p>\n\n<pre><code>a = [1, 2, 3]\nfor i in a do\n  puts i\nend\n#=&gt; 1\n#=&gt; 2 \n#=&gt; 3\n</code></pre>\n\n<p>I know this can be done more idiomatically with the <code>each</code> statement, but that's not what I'm asking. What am I not understanding here? </p>\n"}]