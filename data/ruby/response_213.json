[{"tags": ["ruby", "windows", "security", "sinatra", "exploit"], "comments": [{"owner": {"reputation": 2292, "user_id": 6051596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CDh6.jpg?s=128&g=1", "display_name": "Atmanirbhar Bharat", "link": "https://stackoverflow.com/users/6051596/atmanirbhar-bharat"}, "edited": false, "score": 0, "creation_date": 1549551761, "post_id": 54564195, "comment_id": 95950007, "body": "Well you do not expect them to give the direct commands to Hack , Do you ? I think the text does goes on to refer that by using a malicious zip archive that holds path traversal filenames it might be possible to do partial information disclosure. May be you need to do some research in this area."}, {"owner": {"reputation": 47, "user_id": 8780567, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/18b54b987e22d2ba55f505abe6ac7efb?s=128&d=identicon&r=PG&f=1", "display_name": "shplaz", "link": "https://stackoverflow.com/users/8780567/shplaz"}, "reply_to_user": {"reputation": 2292, "user_id": 6051596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CDh6.jpg?s=128&g=1", "display_name": "Atmanirbhar Bharat", "link": "https://stackoverflow.com/users/6051596/atmanirbhar-bharat"}, "edited": false, "score": 0, "creation_date": 1549554942, "post_id": 54564195, "comment_id": 95952055, "body": "Of course not; that&#39;s why I&#39;ve been trying to come up with an exploitable backslash command, as I mentioned. The listed command does not concur with the description of the CVE. However I&#39;ve had no luck.  The ZipSlip vulnerability is a way to further exploit a path-traversal vulnerability in order to create files or possibly enable RCE, this is not what I&#39;m trying to do. I&#39;m merely trying to pull files from outside the website&#39;s directory."}], "owner": {"reputation": 47, "user_id": 8780567, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/18b54b987e22d2ba55f505abe6ac7efb?s=128&d=identicon&r=PG&f=1", "display_name": "shplaz", "link": "https://stackoverflow.com/users/8780567/shplaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549496001, "creation_date": 1549496001, "question_id": 54564195, "link": "https://stackoverflow.com/questions/54564195/unable-to-reproduce-cve-2018-7212-in-sinatra", "title": "Unable to reproduce CVE-2018-7212 in Sinatra", "body": "<p>I'm trying to reproduce CVE-2018-7212, a Sinatra path traversal vulnerability, for a class demonstration. I've installed Sinatra v2.0.0rc2, conjured up a very simple Sinatra website, and have it running locally.</p>\n\n<p>I'm trying to execute this path traversal to get another file from my computer, say an image file that is two directories above my website. I can't seem to figure it out in browser or on the command line, if anyone knows how to do this and could explain it that'd be awesome!</p>\n\n<p>I've tried various combinations of periods, slashes, and backslashes in both my browser and via curl on the command line. Everything I try returns \"Bad Request\" or gives me a 404.</p>\n\n<p><a href=\"https://www.cvedetails.com/cve/CVE-2018-7212/\" rel=\"nofollow noreferrer\">CVE-2018-7212</a></p>\n\n<p><a href=\"https://github.com/sinatra/sinatra/pull/1379/files/d17aa95f5056c52daf5d7c3170fbfd831dc96381\" rel=\"nofollow noreferrer\">Sinatra Patch Code</a></p>\n\n<p><a href=\"https://snyk.io/vuln/SNYK-RUBY-SINATRA-22017\" rel=\"nofollow noreferrer\">Another listing of the CVE</a></p>\n\n<p>The example given in the third link doesn't quite make sense to me as the CVE and its patch seem to say that backslash escaping was exploitable, which would make sense for a Windows host, not forward slashes and periods. Further, this CVE only pertained to Windows hosts, and the example path given us a UNIX path. And it doesn't work, anyways.</p>\n\n<p>I'm expecting to be able to run a proper curl command to take advantage of this CVE and download a file from another directory on my computer.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "string", "search"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549495464, "post_id": 54564039, "comment_id": 95927033, "body": "With hundreds of thousands of words, and if you need to perform these queries often, it may be a good idea to build some search indexes. Trade some RAM for query performance."}, {"owner": {"reputation": 172, "user_id": 5786189, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/49541c0a9e94e83417c68b03eb915151?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/5786189/user"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549496229, "post_id": 54564039, "comment_id": 95927261, "body": "@SergioTulentsev What do you mean by search indices? They&#39;re not in a database."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1549496384, "post_id": 54564039, "comment_id": 95927312, "body": "Yes, some manually crafted data structures to facilitate searches. <i>For example</i>, &quot;here are all the words that contain letter &#39;a&#39;&quot;, &quot;here are all the words that contain letter &#39;b&#39;&quot;. Or something along these lines."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1549497832, "post_id": 54564039, "comment_id": 95927711, "body": "Example of what I&#39;m talking about. This &quot;index&quot; is super-naive and surely can be improved <b>dramatically</b>: <a href=\"https://pastecode.xyz/view/f902069f\" rel=\"nofollow noreferrer\">pastecode.xyz/view/f902069f</a>"}, {"owner": {"reputation": 172, "user_id": 5786189, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/49541c0a9e94e83417c68b03eb915151?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/5786189/user"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549505144, "post_id": 54564039, "comment_id": 95929227, "body": "@SergioTulentsev I see. Thanks for the example!"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549536878, "post_id": 54564039, "comment_id": 95941061, "body": "<code>dinosaur&quot;, &quot;dosimetry&quot;, and &quot;moist&quot;</code> is not a Ruby object. Nor is <code>&quot;dosimetry&quot;, &quot;moist&quot;</code>. In what form do you have the input, and in what form do you want the output?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549496184, "post_id": 54564166, "comment_id": 95927246, "body": "This is about 2.5x slower than <code>A.all?{|a| str.include?(a)}</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1549500878, "post_id": 54564166, "comment_id": 95928375, "body": "@Sergio, that&#39;s interesting, and I guess not surprising.  For one, <code>all?</code> short-circuits when it encounters <code>false</code>.  In your benchmark of <code>all?</code> try using <code>A = [&#39;m&#39;, &#39;s&#39;, &#39;i&#39;, &#39;o&#39;]</code>, based on <a href=\"http://pi.math.cornell.edu/~mec/2003-2004/cryptography/subs/frequencies.html\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549517773, "post_id": 54564166, "comment_id": 95931983, "body": "@Sergio, not until I finished this benchmark did I see your (superior) benchmarked linked in a comment (groan). You should post it, possibly including a couple of other methods I included above. If you do I will gladly rollback my answer to what I had before adding the benchmark."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549527888, "post_id": 54564166, "comment_id": 95935978, "body": "if you insist... :)"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1549562011, "last_edit_date": 1549562011, "creation_date": 1549495827, "answer_id": 54564166, "question_id": 54564039, "link": "https://stackoverflow.com/questions/54564039/identifying-strings-that-contain-every-char-in-a-list/54564166#54564166", "title": "Identifying strings that contain every char in a list", "body": "<pre><code>A = ['o', 'i', 's', 'm']\nwords = [\"dinosaur\", \"dosimetry\", \"moist\", \"personal\", \"since\",\n  \"including\", \"guide\", \"shop\", \"directory\", \"board\", \"location\",\n  \"change\", \"white\", \"text\", \"small\", \"emotions\", \"rating\",\n  \"rate\", \"movies\", \"government\"]\n</code></pre>\n\n<p>Here are two methods that return the words in  <code>words</code> that contain all the letters contained in <code>A</code>.</p>\n\n<p><strong>#1</strong></p>\n\n<pre><code>def select_some(words)\n  words.select { |word| A &amp; word.chars == A }\nend\n\nselect_some(words)\n  #=&gt; [\"dosimetry\", \"moist\", \"emotions\", \"movies\"] \n</code></pre>\n\n<p>The operative line could be changed to</p>\n\n<pre><code>words.select { |word| (A-str.chars).empty? }\n</code></pre>\n\n<p><strong>#2</strong></p>\n\n<pre><code>n = 1\nH = A.each_with_object({}) do |c,h|\n  h[c] = n\n  n &lt;&lt;= 1\nend\n  #=&gt; {\"s\"=&gt;1, \"i\"=&gt;2, \"o\"=&gt;4, \"m\"=&gt;8} \nN = n - 1\n  #=&gt; 15\n\ndef select_some(words)\n  words.select do |word|\n    n = 0\n    word.each_char do |c|\n      x = H[c]\n      n |= x if x\n    end\n    n == N\n  end\nend\n\nselect_some(words)\n  #=&gt; [\"dosimetry\", \"moist\", \"emotions\", \"movies\"] \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1549497201, "post_id": 54564328, "comment_id": 95927530, "body": "Despite looking scary, this is the fastest I&#39;ve tested. Maaaaybe some speed will evaporate when we have to build this regex dynamically. <a href=\"https://pastecode.xyz/view/b09590cd\" rel=\"nofollow noreferrer\">pastecode.xyz/view/b09590cd</a>"}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1549497512, "post_id": 54564328, "comment_id": 95927612, "body": "Hahaha. Contest who is faster. For now, I lead. But seriously, when there are hundeds of thousands of words, it\u2019s important"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1549497710, "post_id": 54564328, "comment_id": 95927679, "body": "The question contained the word &quot;efficient&quot;. And I am bored. So I&#39;m benchmarking :)"}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1549559385, "post_id": 54564328, "comment_id": 95954773, "body": "I was surprised, but <code>.*</code> increases the speed"}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1549559746, "post_id": 54564328, "comment_id": 95954967, "body": "I corrected my answer, now the performance has increased by 43%"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1549566548, "post_id": 54564328, "comment_id": 95958309, "body": "I couldn&#39;t believe <code>.*</code> helps, so I reran @Sergio&#39;s benchmark myself, with and without <code>.*</code>. Sure enough, I got the same result. I wonder why it helps. Readers: any ideas?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549570455, "post_id": 54564328, "comment_id": 95960083, "body": "@CarySwoveland: lemme summon a regex master buddy of mine. mrzasa any thoughts?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549573941, "post_id": 54564328, "comment_id": 95961643, "body": "I&#39;m lost with edit history and comments, could you tell me, gents, what regexes you are comparing? @SergioTulentsev"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1549574187, "post_id": 54564328, "comment_id": 95961748, "body": "@mrzasa: <code>&#47;(?=.*s)(?=.*i)(?=.*o)(?=.*m).*&#47;</code> is about 20% faster than <code>&#47;(?=.*s)(?=.*i)(?=.*o)(?=.*m)&#47;</code> (without the <code>.*</code> in the end) and we have no idea why :)"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1549579403, "post_id": 54564328, "comment_id": 95963888, "body": "Frankly, I don&#39;t know. It must be an internal optimisation inside the regex engine. You can take a look at <a href=\"https://github.com/k-takata/Onigmo/blob/master/regexec.c#L3784-L4162\" rel=\"nofollow noreferrer\">this <i>simple</i> function</a> that is called inside <code>match?</code>. Let me know if you find this out, I resigned ;-)"}], "tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 3, "last_activity_date": 1549575453, "last_edit_date": 1549575453, "creation_date": 1549497032, "answer_id": 54564328, "question_id": 54564039, "link": "https://stackoverflow.com/questions/54564039/identifying-strings-that-contain-every-char-in-a-list/54564328#54564328", "title": "Identifying strings that contain every char in a list", "body": "<p>Just for experience</p>\n\n<p>Using regex positive lookahead</p>\n\n<pre><code>words = %w(dinosaur dosimetry moist)\n\nwords.select { |word| word.match?(/(?=.*m)(?=.*s)(?=.*i)(?=.*o).*/) }\n\n#=&gt; [\"dosimetry\", \"moist\"]\n</code></pre>\n\n<p>To increase the search speed, I arranged the letters in regex in accordance with <a href=\"http://pi.math.cornell.edu/~mec/2003-2004/cryptography/subs/frequencies.html\" rel=\"nofollow noreferrer\">English Letter Frequency</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549531775, "post_id": 54569041, "comment_id": 95938016, "body": "If we use <code>letters_freq</code> with naive search index, we win another 12%."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1549562564, "post_id": 54569041, "comment_id": 95956363, "body": "Good job! Note that @mechnicov has updated his regex to <code>&#47;(?=.*s)(?=.*i)(?=.*o)(?=.*m).*&#47;</code>. <code>.*</code> at the end has no effect but he reports it improves performance (which I find bizarre). btw, if you want to avoid the need for vertical scrolling, insert some lines <code>#&lt;p&gt;&lt;&#47;p&gt;</code>. The <code>#</code> is to avoid interfering with cutting and pasting code."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549565272, "post_id": 54569041, "comment_id": 95957753, "body": "A small request: could you rerun the benchmark until my solutions are not dead last?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549565487, "post_id": 54569041, "comment_id": 95957863, "body": "@CarySwoveland I tried, but it won&#39;t budge. It&#39;s as if the benchmark reflects reality, or something. Weird!"}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1549575680, "post_id": 54569041, "comment_id": 95962466, "body": "@Sergio, I&#39;ve changed my regex in accordance with letters frequency. The speed has gone up. You can make changes to your benchmark."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1549577527, "last_edit_date": 1549577527, "creation_date": 1549527870, "answer_id": 54569041, "question_id": 54564039, "link": "https://stackoverflow.com/questions/54564039/identifying-strings-that-contain-every-char-in-a-list/54569041#54569041", "title": "Identifying strings that contain every char in a list", "body": "<p>By request, posting my comparative benchmark in a more readable/permanent form.</p>\n\n<pre><code>require 'benchmark/ips'\n\nwords = %w(dinosaur dosimetry moist personal since including guide shop directory board\n           location change white text small emotions rating rate movies government)\nletters = %w[s i o m]\nletters_freq = %w[m s i o]\n\n# set up compiled greps\nregexes = letters.map {|l| Regexp.compile(l) }\n\n# set up search index\nnaive_search_index = words.each_with_object({}) do |word, memo|\n  word.each_char do |c|\n    memo[c] ||= []\n    memo[c] &lt;&lt; word\n  end\nend\n\n\n# set up twiddle\nn = 1\nletter_flags = letters.each_with_object({}) do |c,h|\n  h[c] = n\n  n &lt;&lt;= 1\nend\nmask = n - 1\n\n\nBenchmark.ips do |x|\n  x.report('chained greps') do\n    letters.reduce(words) do |result, letter|\n      result.grep(Regexp.new(letter))\n    end\n  end\n\n  x.report('compiled greps') do\n    regexes.reduce(words) do |result, regex|\n      result.grep(regex)\n    end\n  end\n\n  x.report('include') do\n    words.select do |word|\n      letters.all?{|l| word.include?(l)}\n    end\n  end\n\n  x.report('freq include') do\n    words.select do |word|\n      letters_freq.all?{|l| word.include?(l)}\n    end\n  end\n\n  x.report(\"Cary\") do\n    words.select do |word|\n      letters &amp; word.chars == letters\n    end\n  end\n\n  x.report('twiddle (cary 2)') do\n    words.select do |word|\n      n = 0\n      word.each_char do |c|\n        x = letter_flags[c]\n        n |= x if x\n      end\n      n == mask\n    end\n  end\n\n  x.report(\"mechnicov\") do\n    words.select do |word|\n      word.match?(/(?=.*m)(?=.*s)(?=.*i)(?=.*o).*/)\n    end\n  end\n\n  x.report('freq search index') do\n    # most frequent first\n    naive_search_index.values_at(*letters_freq).reduce(:&amp;)\n  end\n\n  x.compare!\nend\n</code></pre>\n\n<p>Results</p>\n\n<pre><code>Comparison:\n   freq search index:   323531.8 i/s\n           mechnicov:   244783.9 i/s - 1.32x  slower\n        freq include:   100981.6 i/s - 3.20x  slower\n             include:    94612.7 i/s - 3.42x  slower\n      compiled greps:    54553.1 i/s - 5.93x  slower\n       chained greps:    40979.6 i/s - 7.89x  slower\n    twiddle (cary 2):    35767.6 i/s - 9.05x  slower\n                Cary:    33402.4 i/s - 9.69x  slower\n</code></pre>\n"}], "owner": {"reputation": 172, "user_id": 5786189, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/49541c0a9e94e83417c68b03eb915151?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/5786189/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 54569041, "answer_count": 3, "score": 1, "last_activity_date": 1549577527, "creation_date": 1549495111, "last_edit_date": 1549536836, "question_id": 54564039, "link": "https://stackoverflow.com/questions/54564039/identifying-strings-that-contain-every-char-in-a-list", "title": "Identifying strings that contain every char in a list", "body": "<p>I have the words <code>\"dinosaur\", \"dosimetry\", and \"moist\"</code>. I'm thinking about the case where I have hundreds of thousands of words. I want to return all words containing <code>\"s\", \"i\", \"o\", \"m\"</code> anywhere in the string. The function should return <code>\"dosimetry\", \"moist\"</code>. </p>\n\n<p>Is there an efficient way to do this, or do I have to iterate and check?</p>\n"}, {"tags": ["ruby", "rspec", "rspec3"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549493820, "post_id": 54563726, "comment_id": 95926531, "body": "Haven&#39;t heard of anything like this."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1549494039, "post_id": 54563726, "comment_id": 95926606, "body": "&quot;but I don&#39;t know what that value will be&quot; - that is a problem, indeed. Do you really <i>know</i> what&#39;s happening in your code? How can you not know what it will produce?"}, {"owner": {"reputation": 678, "user_id": 5217295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aj5ly.jpg?s=128&g=1", "display_name": "carterw485", "link": "https://stackoverflow.com/users/5217295/carterw485"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549494171, "post_id": 54563726, "comment_id": 95926655, "body": "Values may change from 25 to 26, or stay as 25 after changing a Math.floor to a Math.round. It&#39;s very tedious to go re-run my tests over and over to change 1 value at a time."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549494270, "post_id": 54563726, "comment_id": 95926684, "body": "More tedious than go through the tests and insert <code>{update: true}</code> everywhere?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549494363, "post_id": 54563726, "comment_id": 95926706, "body": "Looks like you could use some <code>aggregate_failures: true</code> too."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 4, "creation_date": 1549494464, "post_id": 54563726, "comment_id": 95926737, "body": "I don&#39;t know of this feature. And I don&#39;t think it&#39;s one I would like to have in the framework. Doing this as a one-off when first writing a spec may be useful, but only as a shortcut for manually copy+pasting a carefully selected (few?) failure messages into the expectation. Having a command like <code>spec UPDATE_EXPECTS=1</code> sounds like madness to me!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1549494681, "post_id": 54563726, "comment_id": 95926792, "body": "@TomLord: to put it mildly... :)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 4, "creation_date": 1549494703, "post_id": 54563726, "comment_id": 95926802, "body": "Digging deeper, the <a href=\"https://jestjs.io/docs/en/snapshot-testing\" rel=\"nofollow noreferrer\">tool you are describing</a> was designed for <i>UI testing</i>. In such tests, it would be totally impractical to define the actual expectation; snapshot tests are only supposed to fail if <i>something</i> changes (but you may not know/care what). What we are talking about here is <i>unit</i> tests, which is a totally different category of testing. In summary, this would be a very bad idea."}, {"owner": {"reputation": 678, "user_id": 5217295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aj5ly.jpg?s=128&g=1", "display_name": "carterw485", "link": "https://stackoverflow.com/users/5217295/carterw485"}, "edited": false, "score": 0, "creation_date": 1549494788, "post_id": 54563726, "comment_id": 95926825, "body": "I think that it could be useful when used in combination with &#39;fit&#39;s as you could carefully look over the changes."}, {"owner": {"reputation": 678, "user_id": 5217295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aj5ly.jpg?s=128&g=1", "display_name": "carterw485", "link": "https://stackoverflow.com/users/5217295/carterw485"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549494811, "post_id": 54563726, "comment_id": 95926833, "body": "aggregate_failures can definitely help speed this up. Thank you @SergioTulentsev"}], "answers": [{"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 0, "last_activity_date": 1549600906, "creation_date": 1549600906, "answer_id": 54586068, "question_id": 54563726, "link": "https://stackoverflow.com/questions/54563726/is-there-a-way-to-automatically-update-an-rspec-expectation/54586068#54586068", "title": "Is there a way to automatically update an RSpec expectation?", "body": "<p>I don't believe this type of tool exists for RSpec. The closest you could maybe come is using a <code>let</code> or an instance variable at the top of your script.</p>\n\n<pre><code>let(:subtotal) { 25.0 } # can _maybe_ only update this if logic changed\nlet(:cart) { Cart.new }\n\nbefore do\n  cart.add_item(10.0)\n  cart.add_item(15.0)\nend\n\nit do\n  expect(cart.subtotal).to eq(subtotal)\nend\n</code></pre>\n\n<p>You'd still have to manually curate the values when logic changes that would break the test assertion. There are already a number of matchers in RSpec that will let you do a looser assertion, such as <a href=\"https://relishapp.com/rspec/rspec-expectations/v/3-8/docs/built-in-matchers/be-within-matcher\" rel=\"nofollow noreferrer\">be_within</a>, but nothing to automatically fill in values for you. The <a href=\"https://relishapp.com/rspec/rspec-expectations/v/3-8/docs/built-in-matchers/include-matcher\" rel=\"nofollow noreferrer\">include</a> matcher is another powerful matcher that lets you do looser assertions.</p>\n\n<p>I feel like updating values automatically would be equivalent to testing <code>expect(x).to eq(x)</code>. I'm not sure there's much value in that kind of test for what I've typically seen RSpec used for.</p>\n\n<p>The reality is, your test should/will often fail when you make a change to your code. It's annoying that you have to go back and fix the test, but it should also reassuring that the test provided some value. I would be more alarmed if I changed code and didn't have a failing test...</p>\n"}], "owner": {"reputation": 678, "user_id": 5217295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aj5ly.jpg?s=128&g=1", "display_name": "carterw485", "link": "https://stackoverflow.com/users/5217295/carterw485"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1549600906, "creation_date": 1549493147, "question_id": 54563726, "link": "https://stackoverflow.com/questions/54563726/is-there-a-way-to-automatically-update-an-rspec-expectation", "title": "Is there a way to automatically update an RSpec expectation?", "body": "<p>I'm wondering if this feature exists in RSpec. I can't seem to find any results when looking into it.</p>\n\n<p>What I'd like to do is something that can be done in Jest tests like so:</p>\n\n<pre><code>// This is a Jest expectation\n\nexpect(foo).toMatchInlineSnapshot()\n\n// On the first execution of this code, the value of foo will fill in the expectation and result in something like this\n\nexpect(foo).toMatchInlineSnapshot('bar')\n</code></pre>\n\n<p>I'd love to be able to do this with RSpec tests.</p>\n\n<pre><code># Here's an RSpec expectation\n\nexpect(foo).to eq({ bar: 25 })\n</code></pre>\n\n<p>Say that I make a change to my code that will result in foo[:bar] having a different value, but I don't know what that value will be.</p>\n\n<p>Currently, I need to re-run my tests and see an error saying something along the lines of</p>\n\n<pre><code> Failure/Error: expect(foo).to eq({ bar: 25 })\n\n       expected: { bar: 25 }\n            got: { bar: 100 }\n</code></pre>\n\n<p>After that, I need to manually update my expectation in order for it to pass.</p>\n\n<p>Is there anyway to tell RSpec to automatically update the expected value?</p>\n\n<p>For Example:</p>\n\n<pre><code>expect(foo).to eq({ bar: 25 }, {update: true})\n</code></pre>\n\n<p>would change the code after running the test to match the correct value and result in the following code replacing the above expectation:</p>\n\n<pre><code>expect(foo).to eq({ bar: 100 })\n</code></pre>\n\n<p>Is there any existing way to accomplish this? Some command that I can run with RSpec maybe?</p>\n\n<pre><code>spec UPDATE_EXPECTS=1\n</code></pre>\n\n<p>I've seen libraries that can match based on snapshots, but haven't been able to find anything that results in the expected answer appearing inline.</p>\n\n<p>Thanks for the help</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 6934, "user_id": 692410, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7d20c86fcc483e625eb179ca2bbfa0cb?s=128&d=identicon&r=PG", "display_name": "Will Richardson", "link": "https://stackoverflow.com/users/692410/will-richardson"}, "edited": false, "score": 2, "creation_date": 1549492610, "post_id": 54563579, "comment_id": 95926108, "body": "Both <code>.strip</code> and <code>.chomp</code> work for me on 2.3.6 to remove a trailing <code>&#39;\\r&quot;</code> - can you give a bit more info in your example?"}, {"owner": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "edited": false, "score": 2, "creation_date": 1549492695, "post_id": 54563579, "comment_id": 95926128, "body": "<code>stock.chomp(&quot;\\r&quot;)</code> and <code>stock.chomp</code> both should work. What they return in your case? Have you tried <code>stock.gsub(&quot;\\r&quot;, &quot;&quot;)</code>?"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 1, "creation_date": 1549492887, "post_id": 54563579, "comment_id": 95926197, "body": "What version of Ruby, and OS are you using?"}, {"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "edited": false, "score": 0, "creation_date": 1549493428, "post_id": 54563579, "comment_id": 95926387, "body": "I just tried stock.gsub(&quot;\\r&quot;, &quot;&quot;), and it still did not work."}, {"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "edited": false, "score": 0, "creation_date": 1549493458, "post_id": 54563579, "comment_id": 95926401, "body": "I am on Ruby 2.6.0 and Mac OS 10.14"}, {"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "edited": false, "score": 0, "creation_date": 1549493471, "post_id": 54563579, "comment_id": 95926407, "body": "I will update the post to include more information"}, {"owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "edited": false, "score": 5, "creation_date": 1549493504, "post_id": 54563579, "comment_id": 95926424, "body": "Just guesswork but it might be that you try to use <code>stock.chomp</code> expecting to alter the variable itself when in fact it will just return a new one with the trailing <code>\\r</code> removed. Try using <code>stock.chomp!</code> which will change the variable in place."}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1549493868, "post_id": 54563579, "comment_id": 95926550, "body": "It feels like you didn&#39;t assign this value to your variable."}, {"owner": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "edited": false, "score": 1, "creation_date": 1549494089, "post_id": 54563579, "comment_id": 95926626, "body": "Try <code>shoe.update_column(:stockId, stock.chomp)</code>"}, {"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "edited": false, "score": 1, "creation_date": 1549494247, "post_id": 54563579, "comment_id": 95926675, "body": "The problem was I was not actually altering the variable. Thanks for the help everyone"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "edited": false, "score": 0, "creation_date": 1549525616, "post_id": 54563579, "comment_id": 95934981, "body": "@ulferts: <code>chomp!</code> will <i>not</i> alter the variable in place. It will alter the object that is referenced by the variable, which is a completely different thing. A thing and the name of the thing are not the same thing. Please, don&#39;t spread mis-information this way. The &quot;only way&quot; (modulo reflection, i.e. <code>Binding#local_variable_set</code>) to alter a variable is by assigning to it, in particular, <i>no method</i> (other than <code>Binding#local_variable_set</code>) can alter a local variable, ever."}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1549525478, "post_id": 54564175, "comment_id": 95934913, "body": "This does <i>not</i> alter the variable. This alters the object that is referenced by the variable, which is a completely different thing."}], "tags": [], "owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "is_accepted": false, "score": 0, "last_activity_date": 1549495873, "creation_date": 1549495873, "answer_id": 54564175, "question_id": 54563579, "link": "https://stackoverflow.com/questions/54563579/deleting-the-r-or-carriage-return-from-a-string-in-ruby/54564175#54564175", "title": "Deleting the &quot;\\r&quot; or carriage return from a string in Ruby", "body": "<p>I was not altering the variable, I was just returning a new one. To alter the variable I needed to use:</p>\n\n<pre><code>stock.chomp!\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549495873, "creation_date": 1549492380, "last_edit_date": 1549493925, "question_id": 54563579, "link": "https://stackoverflow.com/questions/54563579/deleting-the-r-or-carriage-return-from-a-string-in-ruby", "title": "Deleting the &quot;\\r&quot; or carriage return from a string in Ruby", "body": "<p>I am using CloudMailin to receive emails and then send the plain text to my Ruby on Rails app. To access the body of the email in plain text I use params[:plain].</p>\n\n<p>If I were to just print the relevant part of the plain text it would look like this:</p>\n\n<pre><code>Style 130690 113\nPrice $335.00\nStock # 2882524\n</code></pre>\n\n<p>I have used regex to name capture certain pieces of data:</p>\n\n<pre><code>style, price, stock = params[:plain].scan(/^(?:Style |Price \\$|Stock \\# )(.+)/).flatten\n</code></pre>\n\n<p>This works however each variable has a \"\\r\" or carriage return at the end. So, if stock is 80201943, it would appear in my database as \"80201943\\r\".</p>\n\n<p>I then try to update my database with this code:</p>\n\n<pre><code>shoe = Shoe.where(:size =&gt; \"7\").first\nshoe.update_column(:stockId, stock)\n</code></pre>\n\n<p>Then when I check my database the :stockId has a \"\\r\" at the end of it.</p>\n\n<p>I have tried doing</p>\n\n<pre><code>stock.chomp(\"\\r\")\n\nstock.chomp\n\nstock.strip\n\nstock.gsub(\"\\r\", \"\"),\n</code></pre>\n\n<p>None of these remove the \"\\r\" from the string. How can I remove it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1549490745, "creation_date": 1549490745, "answer_id": 54563290, "question_id": 54562730, "link": "https://stackoverflow.com/questions/54562730/relational-databases-and-foreign-keys/54563290#54563290", "title": "Relational databases and foreign keys", "body": "<p>Rails switched over to <code>BIGINT</code> by default in version 5.0 because <a href=\"https://m.signalvnoise.com/update-on-basecamp-3-being-stuck-in-read-only-as-of-nov-8-922am-cst/\" rel=\"nofollow noreferrer\">32-bit unsigned values can overflow and force your database read-only</a>.</p>\n\n<p>The <code>foreign_key: true</code> part has the effect of ensuring data integrity between two tables. You can't insert values that don't exist.</p>\n\n<p><code>belongs_to</code> and <code>has_many</code> establish different ends of the same relationship. These cannot necessarily be intuited from the schema itself, and it's often the case that these relationships need to be customized with options.</p>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549490745, "creation_date": 1549488108, "question_id": 54562730, "link": "https://stackoverflow.com/questions/54562730/relational-databases-and-foreign-keys", "title": "Relational databases and foreign keys", "body": "<p>I just have a couple of questions about references, foreign keys and associations in rails. Ive read documentation but still a bit confused.</p>\n\n<ol>\n<li>When you type <code>t.references :tweets</code> for example in a migration, why does this then turn into <code>bigint</code> in the schema?</li>\n<li>Is <code>foreign key :true</code> the part of the code that links the two tables?</li>\n<li>In addition to question 2, what role does <code>belongs to</code> and <code>has many</code> have in the models that differs from <code>foreign key true</code>, as i thought that the schema would be able to tell which table <code>has many</code> and <code>belongs to</code> depending on which id is in the other table.</li>\n</ol>\n"}, {"tags": ["ruby", "nokogiri", "entities"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1549485585, "post_id": 54561960, "comment_id": 95923258, "body": "If you want to avoid reopening/resaving files, why not put the <code>gsub!</code> code in the original script (<code>new_content.gsub!(...)</code>)?"}, {"owner": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1549486537, "post_id": 54561960, "comment_id": 95923680, "body": "@JordanRunning yeah that&#39;s actually what I was doing in my code (I displayed it differently in my question just to make it clearer), but I just wasn&#39;t sure if there was a better way that avoided <code>gsub</code> altogether"}], "owner": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549484600, "creation_date": 1549484600, "question_id": 54561960, "link": "https://stackoverflow.com/questions/54561960/inserting-unescaped-urls-with-nokogiri", "title": "Inserting unescaped URLs with Nokogiri", "body": "<p>I have a script that inserts URLs into existing XHTML pages. The URLs have tracking codes with ampersands, and Nokogiri automatically replaces them with the escaped version <code>&amp;amp;</code>. I understand why, but the escaped URL means that the tracking doesn't work, as the tracking code has been changed. </p>\n\n<p>I've checked out <a href=\"https://stackoverflow.com/questions/6906705/how-to-save-unescaped-in-nokogiri-xml\">How to save unescaped &amp; in nokogiri xml?</a>, <a href=\"https://stackoverflow.com/questions/8580803/how-can-i-put-a-string-with-an-ampersand-in-an-xml-file-with-nokogiri\">How can i put a string with an ampersand in an xml file with Nokogiri?</a>, and <a href=\"https://stackoverflow.com/questions/3252330/preventing-nokogiri-from-escaping-characters\">Preventing Nokogiri from escaping characters?</a>, but I'm not quite sure how using the builder or using cdata works in the context of what I'm trying to do.</p>\n\n<p>Here's a simplified version of what I am currently doing (with <code>main_link</code> being pulled from an external source):</p>\n\n<pre><code>doc = Nokogiri::XML(open(\"file.xhtml\"))\nlink = doc.css(\"a\")[0] # the actual file may contain multiple links, not just one\nmain_link = \"http://www.url.com/\"\ntag = \"?blah&amp;blah=blahblah\"\nlink[\"href\"] = main_link + tag\nnew_content = doc.to_xml\nFile.open(\"new_file.xhtml\", \"w\") { |f| f.write(new_content) }\n\n#=&gt; &lt;a href=\"http://www.url.com/?blah&amp;amp;blah=blahblah\"&gt;link&lt;/a&gt;\n</code></pre>\n\n<p>I've done this, which works:</p>\n\n<pre><code>content = File.read(\"file.xhtml\")\ncontent.gsub!(\"&amp;amp;\",\"&amp;\")\nFile.open(\"updated_file.xhtml\", 'w') { |file| file.write(content) }\n\n#=&gt; &lt;a href=\"http://www.url.com/?blah&amp;blah=blahblah\"&gt;link&lt;/a&gt;\n</code></pre>\n\n<p>but I'd like to avoid reopening/resaving files, since I'm working with a lot at one time and want to be as efficient as possible.</p>\n\n<p>Is this doable with Nokogiri? Should I be looking elsewhere to accomplish this?</p>\n"}, {"tags": ["ruby", "output", "fastlane", "capture-output"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10992790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/04IUt.jpg?s=128&g=1", "display_name": "nanci.drew", "link": "https://stackoverflow.com/users/10992790/nanci-drew"}, "edited": false, "score": 0, "creation_date": 1549487713, "post_id": 54562037, "comment_id": 95924185, "body": "I can kind of see what you&#39;re saying, but I am not directly trying to access the result of UI.messages I want to get the output of the actions which utilize those, such as scan.   Something along these lines: <code>output = scan( arg: &#39;value&#39;)</code>"}], "tags": [], "owner": {"reputation": 10562, "user_id": 445598, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4ab0af72c2e38ff2315851a2a0d82bb4?s=128&d=identicon&r=PG", "display_name": "KrauseFx", "link": "https://stackoverflow.com/users/445598/krausefx"}, "is_accepted": false, "score": 0, "last_activity_date": 1549484895, "creation_date": 1549484895, "answer_id": 54562037, "question_id": 54561644, "link": "https://stackoverflow.com/questions/54561644/is-there-currently-a-way-to-extract-the-output-of-a-fastlane-action-within-the-f/54562037#54562037", "title": "Is there currently a way to extract the output of a fastlane action within the fastlane actions?", "body": "<p>The way <em>fastlane</em> is built allows you to replace the UI layer with your own layer. You can find a sample implementation on the fastlane.ci GitHub repo <a href=\"https://github.com/fastlane/ci/blob/master/app/features/build_runner/fastlane_build_runner_helpers/fastlane_ci_output.rb\" rel=\"nofollow noreferrer\">https://github.com/fastlane/ci/blob/master/app/features/build_runner/fastlane_build_runner_helpers/fastlane_ci_output.rb</a></p>\n\n<p>The way you would then set this up is the following</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>      ci_output = FastlaneCI::FastlaneCIOutput.new(\n        each_line_block: proc do |raw_row|\n          puts \"new line here, access raw_row\"\n        end\n      )\n\n      FastlaneCore::UI.ui_object = ci_output\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1587, "user_id": 1034194, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f5f33dfc669de1ca9f587e26165840c?s=128&d=identicon&r=PG", "display_name": "Brad Pitcher", "link": "https://stackoverflow.com/users/1034194/brad-pitcher"}, "is_accepted": false, "score": 2, "last_activity_date": 1554486249, "creation_date": 1554486249, "answer_id": 55540812, "question_id": 54561644, "link": "https://stackoverflow.com/questions/54561644/is-there-currently-a-way-to-extract-the-output-of-a-fastlane-action-within-the-f/55540812#55540812", "title": "Is there currently a way to extract the output of a fastlane action within the fastlane actions?", "body": "<p>I don't know if this will help you, but I managed to capture fastlane stdout to a variable to get what I wanted (in my case to obtain the common name of the iPhone development certificate) using this simple method</p>\n\n<pre><code>def with_captured_stdout\n  original_stdout = $stdout\n  $stdout = StringIO.new\n  yield\n  $stdout.string\nensure\n  $stdout = original_stdout\nend\n\nlane :test do |options|\n  match_dev = with_captured_stdout { match(type: 'development') }\n  puts match_dev\n  @dev_index = match_dev.index('iPhone Developer')\n  ENV['DEV_CODE_SIGN_ID'] = match_dev[@dev_index..match_dev.index(')', @dev_index)]\n  # ENV['DEV_CODE_SIGN_ID'] = \"iPhone Developer: Test Name (XXXXXXXX)\"\nend\n</code></pre>\n\n<p>From <a href=\"https://stackoverflow.com/a/22777806/1034194\">https://stackoverflow.com/a/22777806/1034194</a></p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 10992790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/04IUt.jpg?s=128&g=1", "display_name": "nanci.drew", "link": "https://stackoverflow.com/users/10992790/nanci-drew"}, "is_accepted": true, "score": 1, "last_activity_date": 1580246723, "creation_date": 1580246723, "answer_id": 59957263, "question_id": 54561644, "link": "https://stackoverflow.com/questions/54561644/is-there-currently-a-way-to-extract-the-output-of-a-fastlane-action-within-the-f/59957263#59957263", "title": "Is there currently a way to extract the output of a fastlane action within the fastlane actions?", "body": "<p>I forgot to update this, but in the end I solved it as such:</p>\n\n<pre><code>module Fastlane\n  module Helper\n    class UtilHelper\n      # Redirects standard output and standard error to a file\n      # (currently only way we know how to capture fastlane ui messages)\n      def self.redirect_stdout_to_file(filename)\n        original_stdout = $stdout.clone\n        original_stderr = $stderr.clone\n        $stderr.reopen File.new(filename, 'w')\n        $stdout.reopen File.new(filename, 'w')\n        yield\n      ensure\n        $stdout.reopen original_stdout\n        $stderr.reopen original_stderr\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<p>and I utilized it like this:</p>\n\n<pre><code>temp_file = 'testlab.log'\nUtilHelper.redirect_stdout_to_file(temp_file) { upload_xctestrun() }\n</code></pre>\n\n<p>What <code>upload_xctrestrun</code> does is irrelevant, just know that it is a function from a fastlane plugin which outputs messages using the fastlane <code>UI</code> object like so:</p>\n\n<pre><code>UI.message(\"Some fastlane decorated message here\")\n</code></pre>\n\n<p>Hope this helps anyone :)</p>\n"}, {"tags": [], "owner": {"reputation": 1164, "user_id": 2073808, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/z2ZLB.png?s=128&g=1", "display_name": "Gravitoid", "link": "https://stackoverflow.com/users/2073808/gravitoid"}, "is_accepted": false, "score": 0, "last_activity_date": 1608767337, "creation_date": 1608767337, "answer_id": 65432315, "question_id": 54561644, "link": "https://stackoverflow.com/questions/54561644/is-there-currently-a-way-to-extract-the-output-of-a-fastlane-action-within-the-f/65432315#65432315", "title": "Is there currently a way to extract the output of a fastlane action within the fastlane actions?", "body": "<p>I am not sure if this is exactly the answer the OP wanted but there does seem to be a way to get the result of the action as a json string. I'm adding this here because I found this question while searching for my issue, and it wasn't readily apparent in the fastlane docs that this is possible.</p>\n<p>Inside my Fastlane file I used these actions:</p>\n<pre><code>  packageName = &quot;com.example.mine&quot;\n\n  versionName = google_play_track_release_names(\n    package_name: packageName,\n    track: &quot;production&quot;\n  )\n\n  versionCode = google_play_track_version_codes(\n    package_name: packageName,\n    track: &quot;production&quot;\n  )\n\n  UI.message &quot;Package Info: #{packageName}, #{versionName} #{versionCode}&quot;\n</code></pre>\n<p>The output looked like this</p>\n<pre><code>Package Info: com.example.mine, [&quot;4.2.0&quot;] [2027]\n</code></pre>\n<p>I also suppressed all the screen output by piping the command through grep to get just the line I wanted. (I couldn't find a parameter or option to do that either.)</p>\n<pre><code>fastlane android get_version | grep &quot;Package Info\n</code></pre>\n<p>Hopefully this helps another noobie like me!</p>\n"}], "owner": {"reputation": 45, "user_id": 10992790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/04IUt.jpg?s=128&g=1", "display_name": "nanci.drew", "link": "https://stackoverflow.com/users/10992790/nanci-drew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1870, "favorite_count": 0, "accepted_answer_id": 59957263, "answer_count": 4, "score": 2, "last_activity_date": 1608767337, "creation_date": 1549483327, "question_id": 54561644, "link": "https://stackoverflow.com/questions/54561644/is-there-currently-a-way-to-extract-the-output-of-a-fastlane-action-within-the-f", "title": "Is there currently a way to extract the output of a fastlane action within the fastlane actions?", "body": "<p>I am using a third party fastlane plugin and it contains an action that will display vital information I need to capture, such as a link.</p>\n\n<p>I am trying to find an elegant way to capture these logs within the fastlane actions, I am trying to avoid using a shell command but if it's the only way, then I suppose I have no choice.</p>\n\n<p>I need this link as it is a unique and random link that contains resources I'd like to download. </p>\n\n<p>I have tried redirecting stdout to no avail since fastlane uses their own logger (usually UI.message) and was about to submit a feature request to fastlane but figured perhaps someone else has ran into this and managed to get past it.</p>\n\n<p>Is there anyway to redirect this type of log and capture it?  </p>\n\n<p>Here is the fastlane source code around UI: <a href=\"https://github.com/fastlane/fastlane/tree/master/fastlane_core/lib/fastlane_core/ui\" rel=\"nofollow noreferrer\">https://github.com/fastlane/fastlane/tree/master/fastlane_core/lib/fastlane_core/ui</a></p>\n\n<p>And here is one of the ways I tried redirecting output: \n<a href=\"https://stackoverflow.com/questions/16309418/capturing-logger-output-inside-a-method\">Capturing logger output inside a method</a></p>\n\n<p>Any help / advice / resources would be appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "introspection"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1549485816, "post_id": 54561270, "comment_id": 95923347, "body": "If <code>obj</code> responds to the method <code>m</code> have you tried <code>obj.method(:m).owner</code>?"}, {"owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549486016, "post_id": 54561270, "comment_id": 95923453, "body": "I&#39;m not sure I follow. What is <code>obj</code> in this case? I tried <code>method(:m).owner</code> but that&#39;s what gets me <code>Rails::Controller::Testing::TemplateAssertions</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1549487029, "post_id": 54561270, "comment_id": 95923887, "body": "Is <code>process</code> is an instance method (i.e., to be <code>include</code>d in a class) or a module method, in which case it is executed by it&#39;s fully-qualified module name (e.g., <code>M1::M2:M3.process(...)</code>)? If the former (which seems unlikely given its very common name) and you knew it was an instance method of some class <code>C</code>, it&#39;s location would be given by <code>C.instance_method(:process).owner</code> (or <code>c.method(:process), where </code>c` is any instance of <code>C</code>). For example, <code>Array.instance_method(:puts).owner #=&gt; Kernel</code>.  Why do you need the class? Suppose the method were <code>size</code>. Many classes have a method <code>size</code>."}, {"owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549488821, "post_id": 54561270, "comment_id": 95924647, "body": "<code>process</code> is in fact an instance method, included at some point along the chain of inheritance, and it is not clear to me which class it is really coming from (perhaps this is the question I should be asking). When I execute <code>C.instance_method(:process).owner</code>, I get the same result as when I run <code>method(:process).owner</code>, that is, <code>Rails::Controller::Testing::TemplateAssertions</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549489280, "post_id": 54561270, "comment_id": 95924850, "body": "Try to find a class <code>C</code> (not literally &quot;C&quot;) such that <code>C.instance_methods.include?(:process) #=&gt; true</code>. Then (with <code>C</code> representing that class), <code>C.instance_methods(:process).owner</code>. You might also with to execute <code>C.instance_methods(:process).source_location</code>. See <a href=\"https://ruby-doc.org/core-2.4.1/Method.html#method-i-owner\" rel=\"nofollow noreferrer\">Method#owner</a> and [Method#source_location](<a href=\"https://ruby-doc.org/core-2.4.1/Method.html#method-i-source_location\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.4.1/Method.html&zwnj;&#8203;#method-i-source_loc&zwnj;&#8203;ation</a>."}, {"owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549489470, "post_id": 54561270, "comment_id": 95924924, "body": "I did actually use the class that contains the call to <code>process</code>, not literally C. I&#39;ll update the question to show what the context looks like."}, {"owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549489829, "post_id": 54561270, "comment_id": 95925096, "body": "@CarySwoveland see updated description please"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549490672, "post_id": 54561270, "comment_id": 95925422, "body": "As you have defined it, <code>process</code> is a method of <code>C</code> (from some class or module) not an instance method of <code>C</code>. (Note <code>self #=&gt; C</code> when <code>process</code> is executed.) So try <code>C.method(:process).owner</code>."}, {"owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549500868, "post_id": 54561270, "comment_id": 95928372, "body": "@CarySwoveland calling C.method on it gives an undefined method exception, as it is in fact an instance method."}, {"owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1549500934, "post_id": 54561270, "comment_id": 95928385, "body": "@jvillian There is documentation for it when searched as ActionDispatch::Integration::Session.process"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549501331, "post_id": 54561270, "comment_id": 95928459, "body": "If <code>class C &lt; ActionDispatch::IntegrationTest; include OtherHelper; ...; process(argA,argB,argC); end</code> executes without error (after replacing <code>...</code> with code, naturally), then <code>C.method(:process).owner</code> must return a value. Of course, if that subclass definition raises an exception all bets are off."}, {"owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549505095, "post_id": 54561270, "comment_id": 95929218, "body": "hmm @CarySwoveland it is clear your understanding of ruby is far superior to mine, but i can only relay what im seeing here, so maybe my simplified version was too simple. The code runs fine, and C.instance_method works while C.method gets an exception. To give some more context on the &quot;...&quot; This is within a Capybara minitest. So the ... consists of a capybara <code>it</code> block wrapped by a <code>context</code> block. But other than that it really does look the way Ive simplified it"}], "answers": [{"comments": [{"owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "edited": false, "score": 0, "creation_date": 1549488926, "post_id": 54562653, "comment_id": 95924692, "body": "I upvoted your answer because I think this info complements the question. However I have tried these methods: <code>.owner</code> gives me the Rails::Controller::Testing::TemplateAssertions module path. <code>.source_location</code> gives me the file but that file just has the plain method definition which is very obscure and identical to what i find when seeing the definition in Rails::Controller::Testing::TemplateAssertions."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "edited": false, "score": 1, "creation_date": 1549504157, "post_id": 54562653, "comment_id": 95929040, "body": "Thanks, yeah I just wanted to provide some debugging &amp; introspection tools. If I could describe how I know that <code>super</code> here <a href=\"https://github.com/rails/rails-controller-testing/blob/master/lib/rails/controller/testing/template_assertions.rb#L61\" rel=\"nofollow noreferrer\">github.com/rails/rails-controller-testing/blob/master/lib/ra&zwnj;&#8203;ils/&hellip;</a>, is calling <code>ActionDispatch::Integration::Session.process</code> would that answer your question?"}, {"owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "edited": false, "score": 0, "creation_date": 1549504809, "post_id": 54562653, "comment_id": 95929162, "body": "yes i think it would! if you could show me how i could go from seeing &#39;super&#39; to finding who has the super definition"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "edited": false, "score": 1, "creation_date": 1549505843, "post_id": 54562653, "comment_id": 95929364, "body": "I added some more info on debugging with pry. There&#39;s def some downsides (if multiple things include the module, it might get hit multiple times before you find the caller you need). There&#39;s also some Kernel methods that might be useful: <a href=\"https://ruby-doc.org/core-2.6.1/Kernel.html#method-i-caller\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.6.1/Kernel.html#method-i-caller</a>"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "edited": false, "score": 1, "creation_date": 1549505908, "post_id": 54562653, "comment_id": 95929375, "body": "There&#39;s a good example of using <code>caller</code> here, and other debug goodies too: <a href=\"https://www.schneems.com/2016/01/25/ruby-debugging-magic-cheat-sheet.html\" rel=\"nofollow noreferrer\">schneems.com/2016/01/25/ruby-debugging-magic-cheat-sheet.htm&zwnj;&#8203;l</a>. This (from schneems site) is probably more useful than anything else I&#39;ve posted: <code>puts method(:foo).super_method.source_location</code>"}, {"owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "edited": false, "score": 0, "creation_date": 1549507419, "post_id": 54562653, "comment_id": 95929649, "body": "I think im still missing a step. So i&#39;ve found the gem file (rack-test) by stepping into super. That brought me into a method with a different name <code>process_request</code> . I can place another pry in that file, but i&#39;m still not sure how i get from the gem file to ActionDispatch::Integration::Session. In the gem I do find that i&#39;m in a class <code>Session</code> so perhaps i&#39;m one step closer. But it is not evident to me by looking at the gem file that Session is part of <code>ActionDispatch::Integration</code>"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "edited": false, "score": 0, "creation_date": 1549544855, "post_id": 54562653, "comment_id": 95945852, "body": "It wasn&#39;t super clear to me that the two pieces of code in your question were related either; I didn&#39;t see any includes or anything when I briefly looked thru the code. You can use step to keep stepping thru the code, rather than adding another pry. Next will step you over a method, step goes into iirc. If you can describe what you&#39;re testing I might try and replicate. Is this a standard rails 5 app, with rails controller testing gem? Request spec?"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "edited": false, "score": 0, "creation_date": 1549546400, "post_id": 54562653, "comment_id": 95946746, "body": "Also, the steps I&#39;m showing will show you where super goes, not what calls the process method in the first place (just which modules and classes handle it)"}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 3, "last_activity_date": 1549505601, "last_edit_date": 1549505601, "creation_date": 1549487673, "answer_id": 54562653, "question_id": 54561270, "link": "https://stackoverflow.com/questions/54561270/how-do-i-find-the-rails-module-path-for-a-method/54562653#54562653", "title": "How do I find the Rails module path for a method", "body": "<p>There are a couple things you can use to help with introspection &amp; debugging:</p>\n\n<ul>\n<li>Installing &amp; requiring <code>pry</code>, <code>pry-byebug</code> and placing a <code>binding.pry</code> somewhere in the code will allow you to <code>step</code>/<code>next</code> thru the logic until you get to where you think you need to be</li>\n<li>Using the <code>owner</code> method as noted in the comment to your post. If you have a <code>User</code> model, you can, for example, from a console type <code>User.method(:_update_callbacks).owner</code> and see that it's from <code>ActiveRecord::Base</code></li>\n<li>You can use the <code>.source_location</code> method to see which file something is defined in. For example, from a rails console I can type <code>User.method(:_update_callbacks).source_location</code> and see that method is defined on line 819 of the <code>active_support/callbacks.rb</code> file (with the full path noted in the response)</li>\n<li>If you knew that the module was being included, but weren't able to figure out where you could also edit the gem on your local system to print where it's being included</li>\n</ul>\n\n<p>The below prints out <code>Bar</code></p>\n\n<pre><code>module Foo\n  def self.included(base)\n    puts \"including...\"\n    puts base\n    puts \"included...\"\n  end\nend\n\nclass Bar\n  include Foo\nend\n</code></pre>\n\n<p>There's probably something better/cleaner out there but these might be useful.</p>\n\n<p>More detail on using pry, per my comment below:</p>\n\n<p>Given that I've run <code>gem install pry pry-byebug</code> and have the following code sample:</p>\n\n<pre><code>require 'pry'\nrequire 'pry-byebug'\n\nmodule Foo\n  def blah\n    puts \"in Foo\"\n  end\nend\n\nclass Bar\n  include Foo\n\n  def blah\n    binding.pry\n    super\n    puts \"in Bar\"\n  end\nend\n\nx = Bar.new\nx.blah\n</code></pre>\n\n<p>When you hit the <code>binding.pry</code>, before the <code>super</code>, you can call <code>next</code> and that will step you into the new file where you can see file name and line number. You'll need to add the <code>binding.pry</code> in the actual gem file on your machine. <code>bundle open &lt;gemname&gt;</code> or <code>gem open &lt;gemname&gt;</code> should open the actual folder in your editor, and as long as you've got pry/byebug configured in your Gemfile (if using bundler) or install via <code>gem</code>, it should work.</p>\n\n<p><a href=\"https://i.stack.imgur.com/QW6vi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QW6vi.png\" alt=\"step with pry\"></a></p>\n"}], "owner": {"reputation": 4574, "user_id": 2963703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/05dbb03a093d0e76ca5b6622855cb3c4?s=128&d=identicon&r=PG&f=1", "display_name": "stackPusher", "link": "https://stackoverflow.com/users/2963703/stackpusher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1549505601, "creation_date": 1549481717, "last_edit_date": 1549489803, "question_id": 54561270, "link": "https://stackoverflow.com/questions/54561270/how-do-i-find-the-rails-module-path-for-a-method", "title": "How do I find the Rails module path for a method", "body": "<p>New to ruby/rails. In a big Rails app, I come across methods and can't find the documentation for them. For example, there is a method <code>process</code>. When I introspect and examine its ancestors, I can get to  <code>Rails::Controller::Testing::TemplateAssertions.process</code> but googling that doesn't give me any documentation about how to use the method, just the <a href=\"https://www.rubydoc.info/github/rails/rails-controller-testing/Rails/Controller/Testing/TemplateAssertions\" rel=\"nofollow noreferrer\">method's definition</a> which is very obscure. </p>\n\n<p>What I wanted to find was <code>ActionDispatch::Integration::Session.process</code> which I can then look up in <a href=\"https://api.rubyonrails.org/\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/</a> and get verbose documentation on how to use the method. I think I have trouble finding this \"original\" module path because of Rails's use of mixins. The only way I found it was by sifting through files and files of the rails repository before I found it mentioned in some comment. So my question is, is there a more deterministic way to find the origin of a method?</p>\n\n<p>EDIT: the context of this code looks kind of like this:</p>\n\n<pre><code>require 'test_helper'\nclass C &lt; ActionDispatch::IntegrationTest\n   include OtherHelper\n   ...\n   process(argA,argB,argC)\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 3, "creation_date": 1549479480, "post_id": 54560675, "comment_id": 95920594, "body": "What are you optimizing for? Minimal downtime? Fault tolerance? Readability of the migration? What is the reason for the table name change? What is the reason for the new attributes? Is the reason the same?"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1549480290, "post_id": 54560675, "comment_id": 95920964, "body": "There&#39;s a bit of complexity to this, potentially. Is this a live production system or development? Do you have pk/fk relationships? These, plus the questions @spickermann asked will dictate the best practice. You can find lots of information on other considerations when running migrations online. <a href=\"https://blog.codeship.com/rails-migrations-zero-downtime/\" rel=\"nofollow noreferrer\">blog.codeship.com/rails-migrations-zero-downtime</a>"}, {"owner": {"reputation": 103, "user_id": 10946251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUJXb.jpg?s=128&g=1", "display_name": "coda", "link": "https://stackoverflow.com/users/10946251/coda"}, "edited": false, "score": 0, "creation_date": 1549485584, "post_id": 54560675, "comment_id": 95923256, "body": "I&#39;m going for cleanest on the optimization front, and this is for development. The reason for the table change is to make better use of the table. Right now it&#39;s not being used at all, but it is being referenced in some places, so its not like I can simply delete the old table and create a new one."}], "answers": [{"tags": [], "owner": {"reputation": 94, "user_id": 11014564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RMe6UhgADZs/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOXMR3EQauiXfpXlgy5hnw-sFQqXQ/mo/photo.jpg?sz=128", "display_name": "Shobha Deepak", "link": "https://stackoverflow.com/users/11014564/shobha-deepak"}, "is_accepted": false, "score": 0, "last_activity_date": 1549576915, "creation_date": 1549576915, "answer_id": 54583012, "question_id": 54560675, "link": "https://stackoverflow.com/questions/54560675/whats-the-best-practice-for-renaming-a-table-and-adding-attributes-to-the-same/54583012#54583012", "title": "What&#39;s the best practice for renaming a table and adding attributes to the same table?", "body": "<p>Step 1: Create a new migration </p>\n\n<pre><code>$ bin/rails generate migration RenameOldTable_to_NewTable\n</code></pre>\n\n<p>Step 2: Inside the migration file, add this code.</p>\n\n<pre><code>class RenameOldTableToNewTable &lt; ActiveRecord::Migration[5.0]\n  def change\n    rename_table :old_table_name, :new_table_name\n  end\nend\n</code></pre>\n\n<p>Step 3: Run the migration</p>\n\n<pre><code>$ bundle exec rake db:migrate\n</code></pre>\n\n<p>This is a very simple way to rename a table using migration. All the attributes will remain same as old table.</p>\n"}], "owner": {"reputation": 103, "user_id": 10946251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUJXb.jpg?s=128&g=1", "display_name": "coda", "link": "https://stackoverflow.com/users/10946251/coda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549576915, "creation_date": 1549479237, "question_id": 54560675, "link": "https://stackoverflow.com/questions/54560675/whats-the-best-practice-for-renaming-a-table-and-adding-attributes-to-the-same", "title": "What&#39;s the best practice for renaming a table and adding attributes to the same table?", "body": "<p>From a best practice point of view which is better:</p>\n\n<ul>\n<li>Create a migration that changes the name of a table and adds attributes to that table in a single migration.</li>\n</ul>\n\n<p>OR </p>\n\n<ul>\n<li>Create a migration for the table change and another one for the change of attributes. </li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 285, "user_id": 11016237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIjD9.png?s=128&g=1", "display_name": "Svetlin Simonyan", "link": "https://stackoverflow.com/users/11016237/svetlin-simonyan"}, "is_accepted": false, "score": 2, "last_activity_date": 1549478908, "creation_date": 1549478908, "answer_id": 54560579, "question_id": 54559978, "link": "https://stackoverflow.com/questions/54559978/why-is-my-rails-not-running-on-new-development-environment-for-existing-project/54560579#54560579", "title": "Why is my Rails not running on new development environment for existing project/repo?", "body": "<p>The first problem is that the project specifies a Ruby version through <code>.ruby-version</code> as you noticed. You should probably install the specified version if you plan to work on that project. I see you have <code>rbenv</code> installed and depending on some local specifics you could achieve that through running <code>rbenv install 2.4.4</code> (if you have <code>ruby-build</code> installed as a plugin for <code>rbenv</code>) or <code>ruby-build 2.4.4</code> (if <code>ruby-build</code> is installed standalone). If you don't have <code>ruby-build</code> you can follow the instructions here: <a href=\"https://github.com/rbenv/ruby-build\" rel=\"nofollow noreferrer\">https://github.com/rbenv/ruby-build</a> .</p>\n\n<p>The second problem is that you don't have the <code>bundler</code> gem installed. You can fix this by running <code>gem install bundler</code> . Keep in mind that this installs the gem for the currently selected Ruby version and you have to install it for each one you are going to use with this project.</p>\n"}], "owner": {"reputation": 401, "user_id": 1562842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/257e3fc15284fa043f2b840313bd8607?s=128&d=identicon&r=PG", "display_name": "brian-welch", "link": "https://stackoverflow.com/users/1562842/brian-welch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1549478908, "creation_date": 1549476536, "question_id": 54559978, "link": "https://stackoverflow.com/questions/54559978/why-is-my-rails-not-running-on-new-development-environment-for-existing-project", "title": "Why is my Rails not running on new development environment for existing project/repo?", "body": "<p>I have just installed a Ruby development environment on a new computer to augment my other. So I am 99.9% sure I have all the I's dotted and T's crossed for software etc (ruby version, rails, homebrew... etc).</p>\n\n<p>I successfully clone the repo to my local environment.</p>\n\n<p>When I run <code>rails s</code> I get the error:</p>\n\n<pre><code>rbenv: version `2.4.4' is not installed (set by /Users/brianruby/code/brian-welch/training_repo/.ruby-version)\n</code></pre>\n\n<p>I then run from the repo directory, <code>ruby -v</code>:</p>\n\n<pre><code>rbenv: version `2.4.4' is not installed (set by /Users/brianruby/code/brian-welch/training_repo/.ruby-version)\n</code></pre>\n\n<p>Then from my home directory, <code>ruby -v</code>:</p>\n\n<pre><code>ruby 2.5.3p105 (2018-10-18 revision 65156) [x86_64-darwin17]\n</code></pre>\n\n<p>(<em>Not a clue why that command won't work within the project directory</em>)</p>\n\n<p>I then try to alter the <code>.ruby-version</code> file to match 2.5.3, as well as the <code>Gemfile</code>. I again run: <code>rails s</code>, and it yields:</p>\n\n<pre><code>Traceback (most recent call last):\n    4: from ./bin/rails:3:in `&lt;main&gt;'\n    3: from ./bin/rails:3:in `load'\n    2: from /Users/brianruby/code/brian-welch/training_repo/bin/spring:8:in `&lt;top (required)&gt;'\n    1: from /Users/brianruby/.rbenv/versions/2.5.3/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n/Users/brianruby/.rbenv/versions/2.5.3/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require': cannot load such file -- bundler (LoadError)\n</code></pre>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1549476104, "post_id": 54559850, "comment_id": 95919031, "body": "_ is known ahead of time._ what does this mean? It seems to me that you could use <code>String#scan</code> method. But please show what you have tried as well"}, {"owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "reply_to_user": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1549476967, "post_id": 54559850, "comment_id": 95919391, "body": "I mean that the substrings <code>[&quot;CODEA&quot;, &quot;CODEB&quot;, &quot;CODEB2&quot;, &quot;CODEC&quot;, ... ]</code> that will appear as keys in the final hash are available as an array before analysis of the data begins. They are not extracted from the data. I realize I could split this example string with a regular expression that looks for substrings beginning with &quot;CODE&quot;. However, I was instead hoping for a technique to apply the array of known keys to the text, rather than pattern match the text."}], "answers": [{"comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1549480893, "post_id": 54560755, "comment_id": 95921242, "body": "I always forget how useful is the splat |(k,*v) .. !"}, {"owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "edited": false, "score": 0, "creation_date": 1549645773, "post_id": 54560755, "comment_id": 95990558, "body": "I didn&#39;t know about <code>.slice_before</code> and it&#39;s super useful for this problem. Thanks so much for your answer!"}, {"owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "edited": false, "score": 0, "creation_date": 1549910331, "post_id": 54560755, "comment_id": 96066089, "body": "There is a small-enough error in this code. The resulting hash does not have values like <code>&quot;text for first item&quot;</code> but instead <code>[&quot;text&quot;, &quot;for&quot;, &quot;first&quot;, &quot;item&quot;]</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549912310, "post_id": 54560755, "comment_id": 96067006, "body": "Thanks for the heads-up. I fixed it."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1549912287, "last_edit_date": 1549912287, "creation_date": 1549479581, "answer_id": 54560755, "question_id": 54559850, "link": "https://stackoverflow.com/questions/54559850/split-a-string-delimited-by-a-list-of-substrings/54560755#54560755", "title": "Split a string delimited by a list of substrings", "body": "<p>We are given a sting and an array.</p>\n\n<pre><code>str = \"CODEA text for first item CODEB text for next item \" + \n      \"CODEB2 some more text CODEC yet more text\"\n\narr= %w|CODEC CODEB2 CODEA CODEB|\n  #=&gt; [\"CODEC\", \"CODEB2\", \"CODEA\", \"CODEB\"]     \n</code></pre>\n\n<p>This is one way to obtain the desired hash.</p>\n\n<pre><code> str.split.\n     slice_before { |word| arr.include?(word) }.\n     map { |word, *rest| [word, rest.join(' ')] }.\n     to_h\n  #=&gt; {\"CODEA\" =&gt;\"text for first item\",\n  #    \"CODEB\" =&gt;\"text for next item\",\n  #    \"CODEB2\"=&gt;\"some more text\",\n  #    \"CODEC\" =&gt;\"yet more text\"}\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-slice_before\" rel=\"nofollow noreferrer\">Enumerable#slice_before</a>.</p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>a = str.split\n  #=&gt; [\"CODEA\", \"text\", \"for\", \"first\", \"item\", \"CODEB\",\n  #    \"text\", \"for\", \"next\", \"item\", \"CODEB2\", \"some\",\n  #    \"more\", \"text\", \"CODEC\", \"yet\", \"more\", \"text\"] \nb = a.slice_before { |word| arr.include?(word) }\n  #=&gt; #&lt;Enumerator:\n  #     #&lt;Enumerator::Generator:0x00005cbdec2b5eb0&gt;:each&gt; \n</code></pre>\n\n<p>We can see the (4) elements (arrays) that will be generated by this enumerator and passed to <code>each_with_object</code> by converting it to an array.</p>\n\n<pre><code>b.to_a\n  #=&gt; [[\"CODEA\", \"text\", \"for\", \"first\", \"item\"],\n  #    [\"CODEB\", \"text\", \"for\", \"next\", \"item\"],\n  #    [\"CODEB2\", \"some\", \"more\", \"text\"],\n  #    [\"CODEC\", \"yet\", \"more\", \"text\"]] \n</code></pre>\n\n<p>Continuing,</p>\n\n<pre><code>c = b.map { |word, *rest| [word, rest.join(' ')] }\n  #=&gt; [[\"CODEA\", [\"text for first item\"]],\n  #    [\"CODEB\", [\"text for next item\"]],\n  #    [\"CODEB2\", [\"some more text\"]],\n  #    [\"CODEC\", [\"yet more text\"]]] \nc.to_h\n  #=&gt; {\"CODEA\"=&gt;\"text for first item\",\n  #    \"CODEB\"=&gt;\"text for next item\",\n  #    \"CODEB2\"=&gt;\"some more text\",\n  #    \"CODEC\"=&gt;\"yet more text\"} \n</code></pre>\n\n<p>The following is perhaps a better way of doing this.</p>\n\n<pre><code> str.split.\n     slice_before { |word| arr.include?(word) }.\n     each_with_object({}) { |(word, *rest),h|\n       h[word] = rest.join(' ') }\n</code></pre>\n\n<p>When I was a kid this might be done as follows.</p>\n\n<pre><code>last_word = ''\nstr.split.each_with_object({}) do |word,h|\n  if arr.include?(word)\n    h[word]=''\n    last_word = word\n  else\n    h[last_word] &lt;&lt; ' ' unless h[last_word].empty?\n    h[last_word] &lt;&lt; word\n  end     \nend\n</code></pre>\n\n<p><code>last_word</code> must be set to anything outside the block.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1549481003, "last_edit_date": 1549481003, "creation_date": 1549480472, "answer_id": 54560968, "question_id": 54559850, "link": "https://stackoverflow.com/questions/54559850/split-a-string-delimited-by-a-list-of-substrings/54560968#54560968", "title": "Split a string delimited by a list of substrings", "body": "<p>Another option.</p>\n\n<pre><code>string.split.reverse\n      .slice_when { |word| word.start_with? 'CODE' }\n      .map{ |(*v, k)| [k, v.reverse.join(' ')] }.to_h\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-slice_when\" rel=\"nofollow noreferrer\"><code>Enumerator#slice_when</code></a>, in this case returns this array:</p>\n\n<pre><code>[[\"text\", \"more\", \"yet\", \"CODEC\"], [\"text\", \"more\", \"some\", \"CODEB2\"], [\"item\", \"next\", \"for\", \"text\", \"CODEB\"], [\"item\", \"first\", \"for\", \"text\", \"CODEA\"]]\n</code></pre>\n\n<p>Then the array is mapped to build the required hash to get the result (I did not reversed the Hash):</p>\n\n<pre><code>#=&gt; {\"CODEC\"=&gt;\"yet more text\", \"CODEB2\"=&gt;\"some more text\", \"CODEB\"=&gt;\"text for next item\", \"CODEA\"=&gt;\"text for first item\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "is_accepted": false, "score": 3, "last_activity_date": 1549484489, "last_edit_date": 1549484489, "creation_date": 1549483630, "answer_id": 54561722, "question_id": 54559850, "link": "https://stackoverflow.com/questions/54559850/split-a-string-delimited-by-a-list-of-substrings/54561722#54561722", "title": "Split a string delimited by a list of substrings", "body": "<p>Code:</p>\n\n<pre><code>str = 'CODEA text for first item CODEB text for next item ' + \n      'CODEB2 some more text CODEC yet more text'\n\nputs Hash[str.scan(/(CODE\\S*) (.*?(?= CODE|$))/)]\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>{\"CODEA\"=&gt;\"text for first item\", \"CODEB\"=&gt;\"text for next item\", \"CODEB2\"=&gt;\"some more text\", \"CODEC\"=&gt;\"yet more text\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1549539161, "last_edit_date": 1549539161, "creation_date": 1549537818, "answer_id": 54571992, "question_id": 54559850, "link": "https://stackoverflow.com/questions/54559850/split-a-string-delimited-by-a-list-of-substrings/54571992#54571992", "title": "Split a string delimited by a list of substrings", "body": "<p>Adding parentheses to the pattern in <code>String#split</code> lets you get both the separators and the fields.</p>\n\n<pre><code>str.split(/(#{Regexp.union(*arr)})/).drop(1).each_slice(2).to_h\n# =&gt;\n# {\n#   \"CODEA\"=&gt;\" text for first item \",\n#   \"CODEB\"=&gt;\"2 somemore text \",\n#   \"CODEC\"=&gt;\" yet more text\"\n# }\n</code></pre>\n"}], "owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 54560755, "answer_count": 4, "score": 1, "last_activity_date": 1549912287, "creation_date": 1549475976, "last_edit_date": 1549537386, "question_id": 54559850, "link": "https://stackoverflow.com/questions/54559850/split-a-string-delimited-by-a-list-of-substrings", "title": "Split a string delimited by a list of substrings", "body": "<p>I have data like:</p>\n\n<pre><code>str = \"CODEA text for first item CODEB text for next item CODEB2 some\"\\\n\"more text CODEC yet more text\"\n</code></pre>\n\n<p>and a list:</p>\n\n<pre><code>arr = [\"CODEA\", \"CODEB\", \"CODEB2\", \"CODEC\", ... ]\n</code></pre>\n\n<p>I want to divide this string into a hash. The keys of the hash will be <code>CODEA</code>, <code>CODEB</code>, etc. The values of the hash will be the text that follows, until the next CODE. The output should look like this:</p>\n\n<pre><code>\"CODEA\" =&gt; \"text for first item\",\n\"CODEB\" =&gt; \"text for next item\",\n\"CODEB2\" =&gt; \"some more text\",\n\"CODEC\" =&gt; \"yet more text\"\n</code></pre>\n"}, {"tags": ["ruby", "postgresql", "activerecord", "sqlite", "sinatra"], "comments": [{"owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "edited": false, "score": 0, "creation_date": 1549493084, "post_id": 54559710, "comment_id": 95926257, "body": "I think you want <code>database.yml</code> not <code>database.yaml</code>"}, {"owner": {"reputation": 1123, "user_id": 7964557, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9W8nHaY7V4Y/AAAAAAAAAAI/AAAAAAAAAGA/aoLc6RbiiRc/photo.jpg?sz=128", "display_name": "Marcelo Fonseca", "link": "https://stackoverflow.com/users/7964557/marcelo-fonseca"}, "reply_to_user": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "edited": false, "score": 0, "creation_date": 1549567584, "post_id": 54559710, "comment_id": 95958807, "body": "@spike they&#180;re the same. You can hold YAML content in files with .yml or yaml"}, {"owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "edited": false, "score": 1, "creation_date": 1549572925, "post_id": 54559710, "comment_id": 95961205, "body": "check out <a href=\"https://github.com/janko/sinatra-activerecord/blob/0f079e6000d2b3b00c642ab9af971466e401ba90/lib/sinatra/activerecord.rb#L21\" rel=\"nofollow noreferrer\">github.com/janko/sinatra-activerecord/blob/&hellip;</a> \u2014 sinatra is looking for .yml explicitly."}, {"owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "edited": false, "score": 1, "creation_date": 1549574513, "post_id": 54559710, "comment_id": 95961912, "body": "Added an answer with that after testing it"}], "answers": [{"tags": [], "owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "is_accepted": true, "score": 1, "last_activity_date": 1549574489, "creation_date": 1549574489, "answer_id": 54582488, "question_id": 54559710, "link": "https://stackoverflow.com/questions/54559710/sinatra-app-raises-activerecordconnectionnotestablished-no-connection-pool-w/54582488#54582488", "title": "Sinatra app raises &quot;ActiveRecord::ConnectionNotEstablished: No connection pool with &#39;primary&#39; found.&quot; on db:migrate using database.yaml", "body": "<p>sinatra-activerecord looks in config/database.yml (not yaml) by default. You can change to any other path with the <code>:database_file</code> configuration option.</p>\n\n<pre><code>  set :database_file, 'config/database.yaml'\n</code></pre>\n"}], "owner": {"reputation": 1123, "user_id": 7964557, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9W8nHaY7V4Y/AAAAAAAAAAI/AAAAAAAAAGA/aoLc6RbiiRc/photo.jpg?sz=128", "display_name": "Marcelo Fonseca", "link": "https://stackoverflow.com/users/7964557/marcelo-fonseca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 824, "favorite_count": 0, "accepted_answer_id": 54582488, "answer_count": 1, "score": 0, "last_activity_date": 1549574489, "creation_date": 1549475441, "question_id": 54559710, "link": "https://stackoverflow.com/questions/54559710/sinatra-app-raises-activerecordconnectionnotestablished-no-connection-pool-w", "title": "Sinatra app raises &quot;ActiveRecord::ConnectionNotEstablished: No connection pool with &#39;primary&#39; found.&quot; on db:migrate using database.yaml", "body": "<p>I have a sinatra app and i want to configure my development, test and production databases with a <code>database.yaml</code> file. </p>\n\n<p>Adding this to my <code>app.rb</code> file and running <code>rake db:migrate</code> works just fine:</p>\n\n<pre><code>configure :development do\n    set :database, \"sqlite3:forum-service.sqlite3\"\nend\n</code></pre>\n\n<p>But i want to keep database configurations separated in a <code>database.yaml</code> file to keep a cleaner code. If i remove the code above and add the <code>config/database.yaml</code> file, as shown below, and run <code>rake db:migrate</code> i get:</p>\n\n<pre><code>rake aborted!\nActiveRecord::ConnectionNotEstablished: No connection pool with 'primary' found.\n</code></pre>\n\n<p>my config/database.yaml file</p>\n\n<pre><code>development:\n  adapter: sqlite3\n  database: db/forum_dev_sqlite3.db\n  pool: 5\n  timeout: 5000\n\ntest:\n  adapter: sqlite3\n  database: db/forum_test_sqlite3.db\n  pool: 5\n  timeout: 5000\n\nproduction:\n  adapter: sqlite3\n  database: db/forum_prod_sqlite3.db\n  pool: 5\n  timeout: 5000\n</code></pre>\n\n<p>my Rakefile</p>\n\n<pre><code>require 'sinatra'\nrequire 'sinatra/activerecord'\nrequire 'sinatra/activerecord/rake'\nrequire './app'\nrequire 'rake/testtask'\n\ntask :default do\n    puts 'type \\'rake --tasks\\' to list options.'\nend\n\nRake::TestTask.new do |t|\n    #t.pattern = \"tests/**.rb\"\n    t.libs &lt;&lt; \"test\"\n    t.test_files = FileList['tests/unittest.rb']  # test*.rb for all\n    t.verbose = true\nend\n</code></pre>\n\n<p>according to Sinatra docs <a href=\"http://recipes.sinatrarb.com/p/databases/postgresql-activerecord?#article\" rel=\"nofollow noreferrer\">sinatra/databases/postgresql-activerecord</a>  by making a <code>config/database.yaml</code> file the configurations gets automatically loaded but looks like theres something missing to make the connection possible. Maybe add something to my rakefile to read the configs?</p>\n\n<p>I've seen <a href=\"https://stackoverflow.com/questions/47401809/sinatra-activerecordconnectionnotestablished-no-connection-pool-for-activer?rq=1\">Sinatra, Puma, ActiveRecord: No connection pool with 'primary' found</a> and <a href=\"https://stackoverflow.com/questions/47401809/sinatra-activerecordconnectionnotestablished-no-connection-pool-for-activer?rq=1\">Sinatra - ActiveRecord::ConnectionNotEstablished: No connection pool for ActiveRecord::Base</a> but they do not apply for this problem.</p>\n"}, {"tags": ["ruby", "docker", "docker-compose", "bundler"], "comments": [{"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 0, "creation_date": 1549483291, "post_id": 54559097, "comment_id": 95922261, "body": "For similar scenarios, I always mount the folder in question (in your case, the gems folder) and then I work and edit the files locally with Sublime (of course, copy what is needed to the mounted volume if not already there)."}], "owner": {"reputation": 9224, "user_id": 801058, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f6b75e25a5cc42698204a58eca97c5ae?s=128&d=identicon&r=PG", "display_name": "leemour", "link": "https://stackoverflow.com/users/801058/leemour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1549473314, "creation_date": 1549473314, "question_id": 54559097, "link": "https://stackoverflow.com/questions/54559097/how-to-debug-installed-ruby-gems-inside-docker", "title": "How to debug installed Ruby gems inside Docker?", "body": "<p>I understand how to debug my app files using byebug and pry. However I often need to debug gems installed <strong>inside a container</strong> and I don't like the option of running shell inside docker, then installing smth like nano (if it's not already installed) and changing the gem files to add breakpoints. I know RubyMine solved it already. Maybe there is a way for others as well? (I'm using Sublime Text).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 1509, "user_id": 3052463, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3w2GR.jpg?s=128&g=1", "display_name": "Abundance", "link": "https://stackoverflow.com/users/3052463/abundance"}, "edited": false, "score": 0, "creation_date": 1549473185, "post_id": 54558830, "comment_id": 95917627, "body": "This is indeed very cool, but I&#39;d like to have a hard cut-off for the levels. <code>hash[0][1][2][3]</code> gives an empty hash, whereas I&#39;d like to have it give an error."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 1509, "user_id": 3052463, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3w2GR.jpg?s=128&g=1", "display_name": "Abundance", "link": "https://stackoverflow.com/users/3052463/abundance"}, "edited": false, "score": 0, "creation_date": 1549473913, "post_id": 54558830, "comment_id": 95917991, "body": "Thanks for the update @Abundance - got led astray by &quot;I&#39;d like to extend this to work to as many levels as needed&quot;. See you&#39;ve reached a nice solution though, glad you&#39;ve got it going."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1549477960, "post_id": 54558830, "comment_id": 95919835, "body": "@SRack you might be interested: I slightly extended your idea in my answer to make the length dynamically configured :)"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1549529923, "post_id": 54558830, "comment_id": 95936997, "body": "Thanks for the comment @AlekseiMatiushkin, that&#39;s a <i>great</i> answer you&#39;ve put together. Glad you dropped this in here or I might have missed it :)"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 2, "last_activity_date": 1549473661, "last_edit_date": 1549473661, "creation_date": 1549472405, "answer_id": 54558830, "question_id": 54558485, "link": "https://stackoverflow.com/questions/54558485/nested-hash-via-recursion-in-ruby/54558830#54558830", "title": "Nested Hash Via Recursion in Ruby", "body": "<p>You can use <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-i-default_proc\" rel=\"nofollow noreferrer\"><code>default_proc</code></a> for this. The best explanation is that given in the docs:</p>\n\n<blockquote>\n  <p>If Hash::new was invoked with a block, return that block, otherwise return nil.</p>\n</blockquote>\n\n<p>So in this case, each new hash key is instantiated with its parent hash's default.</p>\n\n<p>For example:</p>\n\n<pre><code>hash = Hash.new { |h, k| h[k] = Hash.new(&amp;h.default_proc) }\n</code></pre>\n\n<p>That way, every nested level will have the same default:</p>\n\n<pre><code>hash[0][1] = [1, 2, 3]\nhash[:first_level] # =&gt; {}\nhash[:first_level][:second_level] # =&gt; {}\nhash[2] # =&gt; {}\nhash # =&gt; {0=&gt;{1=&gt;[1, 2, 3]}, :first_level=&gt;{:second_level=&gt;{}}, 2=&gt;{}}\n</code></pre>\n\n<hr>\n\n<p>Edit based on comment:</p>\n\n<p>In that case, you could use something ugly, though working, like this:</p>\n\n<pre><code>hash = Hash.new { |h, k| h[k] = Hash.new { |h, k| h[k] = Hash.new { |h, k| h[k] = raise('Too Deep') } } }\nhash[1] # =&gt; {}\nhash[1][2] # =&gt; {}\nhash[1][2][3] # =&gt; RuntimeError: Too Deep\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1549481408, "post_id": 54560291, "comment_id": 95921460, "body": "Great answer. Though I&#39;m left wondering why <code>h.dup.clear</code> is needed instead of just a new empty hash?"}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1549481466, "post_id": 54560291, "comment_id": 95921497, "body": "Oh, maybe to inherit the dynamic <code>:level</code> method? Very interesting approach :D"}, {"owner": {"reputation": 1509, "user_id": 3052463, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3w2GR.jpg?s=128&g=1", "display_name": "Abundance", "link": "https://stackoverflow.com/users/3052463/abundance"}, "edited": false, "score": 0, "creation_date": 1549550454, "post_id": 54560291, "comment_id": 95949149, "body": "Can we extend this to have a default value? Ideally, I wanted this to work with an empty array as a key as well. Something like <code>h = nhash(2, [])</code> where I can do <code>h[0][1] &lt;&lt; 1</code> afterwards. Or even something like <code>h = nhash(2, 0)</code>, where I can do <code>h[0][1] += 1</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1549551598, "post_id": 54560291, "comment_id": 95949900, "body": "\u201cCan we extend [...]?\u201d\u2014Sure you can."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1549511493, "last_edit_date": 1549511493, "creation_date": 1549477809, "answer_id": 54560291, "question_id": 54558485, "link": "https://stackoverflow.com/questions/54558485/nested-hash-via-recursion-in-ruby/54560291#54560291", "title": "Nested Hash Via Recursion in Ruby", "body": "<p>Just out of curiosity:</p>\n\n<pre><code>hash =\n  Hash.new do |h, k|\n    h[k] = h.dup.clear.extend(Module.new do\n      define_method(:level, -&gt;{ h.level - 1 })\n    end).tap { |this| raise \"\ud83d\udd25\" if this.level &lt;= 0 }\n  end.extend(Module.new { define_method(:level, -&gt;{ 5 }) })\n\n#\u21d2 {}\n\nhash[\"0\"][\"1\"][\"2\"][\"3\"]\n#\u21d2\u00a0{}\nhash[\"0\"][\"1\"][\"2\"][\"3\"][\"4\"]\n#\u21d2 RuntimeError: \"\ud83d\udd25\"\n</code></pre>\n\n<hr>\n\n<p>Or, as a function:</p>\n\n<pre><code>def nhash lvl\n  Hash.new do |h, k|\n    h[k] = h.dup.clear.extend(Module.new do\n      define_method(:level, -&gt;{ h.level - 1 })\n    end).tap { |this| raise \"\ud83d\udd25\" if this.level &lt; 0 }\n  end.extend(Module.new { define_method(:level, -&gt;{ lvl }) })\nend\n</code></pre>\n\n<p>Resulting in:</p>\n\n<pre><code>\u270e h = nhash 2\n#\u21d2 {}\n\u270e h[0][1] = [1, 2, 3]\n#\u21d2 [1, 2, 3]\n\u270e h[2][0]\n#\u21d2 {}\n\u270e h[2][0][5]\n#\u21d2 RuntimeError: \ud83d\udd25\n</code></pre>\n\n<p>One might reset the default proc instead of raising if necessary.</p>\n\n<p>The only drawback of this approach, on attempt to call the level above permitted, all the intermediate empty hashes will be created. This <em>also</em> might be overcome by defining the method, accumulating the path (instead of simply returning the level,) and erasing empty parents before raising. </p>\n"}], "owner": {"reputation": 1509, "user_id": 3052463, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3w2GR.jpg?s=128&g=1", "display_name": "Abundance", "link": "https://stackoverflow.com/users/3052463/abundance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 54560291, "answer_count": 2, "score": 4, "last_activity_date": 1549511493, "creation_date": 1549471223, "last_edit_date": 1549474872, "question_id": 54558485, "link": "https://stackoverflow.com/questions/54558485/nested-hash-via-recursion-in-ruby", "title": "Nested Hash Via Recursion in Ruby", "body": "<p>I've been trying to make a nested default hash programmatically in Ruby, basically a short-hand for Ruby's :</p>\n\n<pre><code>h = Hash.new {|h,k| h[k] = Hash.new}\n</code></pre>\n\n<p>I'd like to extend this to work to as many levels as needed. I made the following function:</p>\n\n<pre><code>def nested_hash(level, default={})\n   return default if level == 0\n   return Hash.new{ |h,k| h[k] = nested_hash(level - 1, default) }\nend\n</code></pre>\n\n<p>It looks like it's working correctly but I run into the following issue when creating multiple keys</p>\n\n<pre><code>h = nested_hash(1)\nh[0][1] = [1, 2, 3] # h is {0=&gt;{1=&gt;[1, 2, 3]}}\nh[2] # should give a new Hash, but returns {1=&gt;[1, 2, 3]}\nh # {0=&gt;{1=&gt;[1, 2, 3]}, 2=&gt;{1=&gt;[1, 2, 3]}} \n</code></pre>\n\n<p>Why is the default value changing for the function and becoming the previously set value?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I've found a solution that works:</p>\n\n<pre><code>def nested_hash(level, default={})\n    return Hash.new{ |h,k| h[k] = default } if level &lt;= 1\n    Hash.new{ |h,k| h[k] = nested_hash(level - 1, default) }\nend\n</code></pre>\n\n<p>Never mind, this doesn't work either in a similar way:</p>\n\n<pre><code>h = nested_hash(1)\nh[0][1] = [1, 2, 3]\nh[2][0] # nil\nh # {0=&gt;{1=&gt;[1, 2, 3]}, 2=&gt;{1=&gt;[1, 2, 3]}}\n</code></pre>\n\n<p>I'm still confused as to why the original default was shared amongst the keys.</p>\n"}, {"tags": ["node.js", "ruby", "worker"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1549478989, "post_id": 54558328, "comment_id": 95920342, "body": "With Sidekiq for example, each worker can have multiple threads, that it fills with jobs from the queue. You can also  configure workers to read from certain queues only, and categorize the jobs as such, to prevent all workers from getting filled up with a certain long-running job type. I&#39;m not saying this is necessarily better than using a Node server, which may have more lightweight threads. But for scalability, in either case you probably will want to support horizontal scaling (multiple workers)."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1549601709, "post_id": 54558328, "comment_id": 95968943, "body": "There&#39;s too many other unknowns (your exp. w/ both languages, the infra/stack you&#39;re using, etc.) I&#39;d say worrying about the queue filling up is a premature optimization, and would say build it the best you can build it, but be prepared to rewrite it when you outgrow it. You might as well be comparing Kafka &amp; RabbitMQ alongside (just use Sidekiq if you&#39;re experienced with ruby, or a node-based tool if you&#39;re more comfortable with node). Sidekiq will be pretty easy to setup if you&#39;re deploying to Heroku"}], "owner": {"reputation": 165, "user_id": 177468, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a1247f73598357f06388e863c41aa624?s=128&d=identicon&r=PG", "display_name": "user177468", "link": "https://stackoverflow.com/users/177468/user177468"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549470682, "creation_date": 1549470682, "question_id": 54558328, "link": "https://stackoverflow.com/questions/54558328/job-processing-with-a-traditional-worker-or-using-a-node-server", "title": "Job processing with a traditional worker or using a Node server?", "body": "<p>I want to be able to process background jobs that will have multiple tasks associated with it. Tasks may consist of launching API requests (blocking operations) and manipulating and persisting responses. Some of these tasks could also have subtasks that must be executed asynchronously.</p>\n\n<p>For languages such as Ruby, I might use a worker to execute the jobs. As I understand, every time a new job comes gets to the queue, a new thread will execute it. As I mentioned before, sometimes a task could contain a series of subtasks to be executed asynchronously, so as I see it, I have two options:</p>\n\n<ul>\n<li><p>Add the substep execution to the worker queue (But a job could have easily lots of subtasks that will fill the queue fast and will block new jobs from been processed).</p></li>\n<li><p>What if I use event-driven Node server to handle a job execution? I would not need to add subtasks to a queue as a single node server could be able to handle one's job entire execution asynchronously. Is there something wrong with doing this?</p></li>\n</ul>\n\n<p>This is the first time I encounter this kind of problem and I want to know which approach is better suited to solve my issue.</p>\n"}, {"tags": ["arrays", "ruby", "sorting", "multidimensional-array"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549537966, "post_id": 54556670, "comment_id": 95941682, "body": "Please use English punctuation, not the French one, when you write in English."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11023469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8ed3c6181c127a9f173dda0d1b554ea?s=128&d=identicon&r=PG&f=1", "display_name": "Tuara", "link": "https://stackoverflow.com/users/11023469/tuara"}, "edited": false, "score": 0, "creation_date": 1549466992, "post_id": 54556880, "comment_id": 95913836, "body": "Thanks a lot, i didn&#39;t even think about that !"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 2, "last_activity_date": 1549467643, "last_edit_date": 1549467643, "creation_date": 1549466274, "answer_id": 54556880, "question_id": 54556670, "link": "https://stackoverflow.com/questions/54556670/ruby-sort-multidimensional-array-by-first-line/54556880#54556880", "title": "Ruby - Sort multidimensional array by first line", "body": "<p>You can use <code>Array#transpose</code> and <code>Enumerable#sort_by</code> to handle this like so: </p>\n\n<pre><code> arr = [ [ \"A 1\", \"A 3\", \"A 2\", \"A 4\" ],\n         [ 4, 5, 6, 7 ],\n         [ 2, 2, 2, 2 ],\n         [ 0.1, 0.2, 0.1, 0.2 ] ]\n</code></pre>\n\n<p><code>Array#transpose</code> turns rows into columns:</p>\n\n<pre><code>arr.transpose\n#=&gt; [[\"A 1\", 4, 2, 0.1],\n#    [\"A 3\", 5, 2, 0.2],\n#    [\"A 2\", 6, 2, 0.1],\n#    [\"A 4\", 7, 2, 0.2]]\n</code></pre>\n\n<p>Then we just need to sort by the first column values <code>sort_by(&amp;:first)</code>: </p>\n\n<pre><code>arr.transpose.sort_by(&amp;:first)\n#=&gt; [[\"A 1\", 4, 2, 0.1],\n#    [\"A 2\", 6, 2, 0.1],\n#    [\"A 3\", 5, 2, 0.2],\n#    [\"A 4\", 7, 2, 0.2]]\n</code></pre>\n\n<p>Then we just <code>transpose</code> back again:</p>\n\n<pre><code>arr.transpose.sort_by(&amp;:first).transpose\n#=&gt; [[\"A 1\", \"A 2\", \"A 3\", \"A 4\"],\n#    [4, 6, 5, 7],\n#    [2, 2, 2, 2],\n#    [0.1, 0.1, 0.2, 0.2]]\n</code></pre>\n\n<p>The same could be achieved by zipping the <code>Array</code>s together  like so: (but the former seems like a better choice)</p>\n\n<pre><code>arr.reduce(&amp;:zip).sort_by {|a| a.flatten!.first}.transpose\n#=&gt; [[\"A 1\", \"A 2\", \"A 3\", \"A 4\"],\n#    [4, 6, 5, 7],\n#    [2, 2, 2, 2],\n#    [0.1, 0.1, 0.2, 0.2]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1549478111, "post_id": 54557765, "comment_id": 95919893, "body": "You could make this exact concept more &quot;rubyish&quot; by replacing the first 2 lines with <code>sorted = arr.first.each_with_index.sort_by(&amp;:first).map(&amp;:last)</code> and replacing <code>arr.map { |a| order_arr.map { |x| a[x] } }</code> with  <code>arr.map { |a| a.values_at(*sorted) }</code>"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1549478625, "post_id": 54557765, "comment_id": 95920148, "body": "@engineersmnky <code>values_at</code> also works for arrays, not only hashes, very nice to know, thanks!"}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": false, "score": 0, "last_activity_date": 1549468968, "creation_date": 1549468968, "answer_id": 54557765, "question_id": 54556670, "link": "https://stackoverflow.com/questions/54556670/ruby-sort-multidimensional-array-by-first-line/54557765#54557765", "title": "Ruby - Sort multidimensional array by first line", "body": "<p>Less Ruby'ish approach:</p>\n\n<pre><code>sorted = arr.first.sort\n# =&gt; [\"A 1\", \"A 2\", \"A 3\", \"A 4\"] \norder_arr = arr.first.map { |x| sorted.index(x) }\n#  =&gt; [0, 2, 1, 3]\narr.map { |a| order_arr.map { |x| a[x] } }\n# =&gt; [[\"A 1\", \"A 2\", \"A 3\", \"A 4\"],\n#     [4, 6, 5, 7],\n#     [2, 2, 2, 2],\n#     [0.1, 0.1, 0.2, 0.2]]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11023469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8ed3c6181c127a9f173dda0d1b554ea?s=128&d=identicon&r=PG&f=1", "display_name": "Tuara", "link": "https://stackoverflow.com/users/11023469/tuara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "accepted_answer_id": 54556880, "answer_count": 2, "score": 0, "last_activity_date": 1549468968, "creation_date": 1549465645, "last_edit_date": 1549466082, "question_id": 54556670, "link": "https://stackoverflow.com/questions/54556670/ruby-sort-multidimensional-array-by-first-line", "title": "Ruby - Sort multidimensional array by first line", "body": "<p>I need to sort a multidimensional array by first line.\nThe first line (array[0][0] to array[0][n-1]) is composed of strings, I need to sort it, and the other lines to follow up...</p>\n\n<p>I already searched a lot and saw how to use the sort function to sort it by column, but didn't found out how to apply it to my problem...<br>\nI already solved my problem with a bubble sort who sort the first line, then report the change to the other lines if there's one, but I wondered if there was a better way to do it ?</p>\n\n<p>Creation of the array :\n<code>array = Array.new(4) { Array.new(var, 0) }</code></p>\n\n<p>I have something like that in it : <br></p>\n\n<pre><code>[ [ \"A 1\", \"A 3\", \"A 2\", \"A 4\" ],\n[ 4, 5, 6, 7 ],\n[ 2, 2, 2, 2 ],\n[ 0.1, 0.2, 0.1, 0.2 ] ]\n</code></pre>\n\n<p>The expected result would be as followed : <br></p>\n\n<pre><code>[ [ \"A 1\", \"A 2\", \"A 3\", \"A 4\" ],\n[ 4, 6, 5, 7 ],\n[ 2, 2, 2, 2 ],\n[ 0.1, 0.1, 0.2, 0.2 ] ]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "migration", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 187, "user_id": 5872997, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-A7X5TdH9uoc/AAAAAAAAAAI/AAAAAAAAAEM/JA2VfopILws/photo.jpg?sz=128", "display_name": "Slava Zharkov", "link": "https://stackoverflow.com/users/5872997/slava-zharkov"}, "edited": false, "score": 0, "creation_date": 1549467852, "post_id": 54556340, "comment_id": 95914423, "body": "Do you need to change only database schema? May be you need to migrate <code>step</code> column data from one table to another also?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "reply_to_user": {"reputation": 187, "user_id": 5872997, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-A7X5TdH9uoc/AAAAAAAAAAI/AAAAAAAAAEM/JA2VfopILws/photo.jpg?sz=128", "display_name": "Slava Zharkov", "link": "https://stackoverflow.com/users/5872997/slava-zharkov"}, "edited": false, "score": 0, "creation_date": 1549468222, "post_id": 54556340, "comment_id": 95914753, "body": "yes I need to migrate step column data also to ReportSheet table"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 1, "creation_date": 1549493357, "post_id": 54556340, "comment_id": 95926367, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6135600/how-do-i-move-a-column-with-contents-to-another-table-in-a-rails-migration\">How do I move a column (with contents) to another table in a Rails migration?</a>"}], "owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549464592, "creation_date": 1549464592, "question_id": 54556340, "link": "https://stackoverflow.com/questions/54556340/rails-migration-how-to-move-attribute-from-model-to-other-model", "title": "Rails migration : how to move attribute from model to other model", "body": "<p>I have a Report model that have a step_id attribute , and I want to move this attribute to ReportSheets model, is there a way to generate the migration from terminal or should I write the code by my self : </p>\n\n<pre><code>class CreateReports &lt; ActiveRecord::Migration[4.2]\n  def change\n    create_table :reports, id: :uuid do |t|\n      t.uuid     :declarant_id\n\n      t.integer  :reference\n      t.datetime :sent_at\n      t.uuid     :step_id\n\n      t.boolean  :is_archived, default: false\n      t.uuid     :updated_by_id\n      t.string   :device_id\n\n      t.timestamps null: false\n    end\n\n    add_index :reports, :reference, unique: true\n\n    add_index :reports, :declarant_id\n    add_index :reports, :device_id\n    add_index :reports, :step_id\n\n  end\nend\n\n\nclass CreateReportSheets &lt; ActiveRecord::Migration[4.2]\n  def change\n    create_table :report_sheets, id: :uuid do |t|\n      t.string  :title,        null: false\n      t.boolean :is_template,  default: false\n      t.uuid    :report_id\n      t.integer :seed_number\n      t.integer :order\n      t.hstore  :steps, array: true, default: '{}', null: false\n\n      t.uuid  :template_id\n\n      t.boolean :is_archived,   default: false\n      t.uuid    :updated_by_id\n      t.string  :device_id\n\n      t.timestamps null: false\n    end\n\n    add_index :report_sheets, :report_id\n    add_index :report_sheets, :template_id\n    add_index :report_sheets, :seed_number\n    add_index :report_sheets, :is_template\n\n    add_index :report_sheets, :is_archived\n    add_index :report_sheets, :device_id\n  end\nend\n</code></pre>\n\n<p>and in case of there is a relation between the 2 models like  add_index :reports, :step_id ? </p>\n"}, {"tags": ["regex", "ruby", "string"], "comments": [{"owner": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 0, "creation_date": 1549462655, "post_id": 54555597, "comment_id": 95911054, "body": "&quot;I need some regex&quot;: no, you don&#39;t need some regex."}, {"owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "reply_to_user": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 0, "creation_date": 1549463527, "post_id": 54555597, "comment_id": 95911619, "body": "@CasimiretHippolyte Okey, I&#39;ve updated my question.."}, {"owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "edited": false, "score": 0, "creation_date": 1549463578, "post_id": 54555597, "comment_id": 95911658, "body": "Different approach. What have you tried?"}], "answers": [{"comments": [{"owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "edited": false, "score": 0, "creation_date": 1549464630, "post_id": 54555782, "comment_id": 95912339, "body": "Thanks Vyacheslav Zharkov ! Works like a charm!"}], "tags": [], "owner": {"reputation": 187, "user_id": 5872997, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-A7X5TdH9uoc/AAAAAAAAAAI/AAAAAAAAAEM/JA2VfopILws/photo.jpg?sz=128", "display_name": "Slava Zharkov", "link": "https://stackoverflow.com/users/5872997/slava-zharkov"}, "is_accepted": false, "score": 1, "last_activity_date": 1549462893, "creation_date": 1549462893, "answer_id": 54555782, "question_id": 54555597, "link": "https://stackoverflow.com/questions/54555597/ruby-regex-replace-substring-with-hash-pattern/54555782#54555782", "title": "Ruby regex replace substring with hash pattern", "body": "<p>I think, regex is not readable solution. You can use simple <code>gsub</code> method:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>str = \"www.domain.com?person={STAY_ID}&amp;user={USER_NAME}\"\nhash = {\"{STAY_ID}\"=&gt;\"30030303\", \"{USER_NAME}\"=&gt;\"test\"}\n\nresult_str = hash.inject(str.dup) do |acc, (key, value)|\n  acc = acc.gsub(key, value)\nend\n\nresult_str # www.domain.com?person=30030303&amp;user=test\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "edited": false, "score": 0, "creation_date": 1549472779, "post_id": 54558796, "comment_id": 95917414, "body": "Nice... Do you have any idea how I can do reversible? To remove all uris that doesn&#39;t contain  at least one of those ?"}, {"owner": {"reputation": 630, "user_id": 5763672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ca5c235400320ab800200c6677574?s=128&d=identicon&r=PG", "display_name": "Sebastian Scholl", "link": "https://stackoverflow.com/users/5763672/sebastian-scholl"}, "reply_to_user": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "edited": false, "score": 0, "creation_date": 1549473453, "post_id": 54558796, "comment_id": 95917764, "body": "Just to be clear, you&#39;re saying that you&#39;d also want it to delete any unmapped variables? Like: <code>&quot;www.domain.com?person={NO_WEHRE}&quot;</code> becomes <code>&quot;www.domain.com?person=&quot;</code>"}, {"owner": {"reputation": 630, "user_id": 5763672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ca5c235400320ab800200c6677574?s=128&d=identicon&r=PG", "display_name": "Sebastian Scholl", "link": "https://stackoverflow.com/users/5763672/sebastian-scholl"}, "reply_to_user": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "edited": false, "score": 0, "creation_date": 1549479138, "post_id": 54558796, "comment_id": 95920409, "body": "No problem! Happy to help"}], "tags": [], "owner": {"reputation": 630, "user_id": 5763672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ca5c235400320ab800200c6677574?s=128&d=identicon&r=PG", "display_name": "Sebastian Scholl", "link": "https://stackoverflow.com/users/5763672/sebastian-scholl"}, "is_accepted": true, "score": 2, "last_activity_date": 1549472263, "creation_date": 1549472263, "answer_id": 54558796, "question_id": 54555597, "link": "https://stackoverflow.com/questions/54555597/ruby-regex-replace-substring-with-hash-pattern/54558796#54558796", "title": "Ruby regex replace substring with hash pattern", "body": "<p>Something great about the <code>gsub</code> method is that it can actually take a hash of mappings as the second argument, which it then uses to replace matched values. Therefore, if you regex any text between curly braces, you can do something like this.</p>\n\n<pre><code>str = \"www.domain.com?person={STAY_ID}&amp;user={USER_NAME}\"\n\nhash = {\n \"{STAY_ID}\"=&gt;\"30030303\", \n \"{USER_NAME}\"=&gt;\"test\"\n}\n\nstr.gsub(/{(.*?)}/, hash) #www.domain.com?person=30030303&amp;user=test\n</code></pre>\n\n<p>And then ya done!</p>\n"}], "owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 54558796, "answer_count": 2, "score": 1, "last_activity_date": 1549538173, "creation_date": 1549462243, "last_edit_date": 1549538173, "question_id": 54555597, "link": "https://stackoverflow.com/questions/54555597/ruby-regex-replace-substring-with-hash-pattern", "title": "Ruby regex replace substring with hash pattern", "body": "<p>I have to replace strings in a hash. I have:</p>\n\n<pre><code>hash = {\"{STAY_ID}\"=&gt;\"30030303\", \"{USER_NAME}\"=&gt;\"test\"}\n</code></pre>\n\n<p>And I have to replace it here:</p>\n\n<pre><code>str = \"www.domain.com?person={STAY_ID}&amp;user={USER_NAME}\"\n#=&gt; www.domain.com?person=30030303&amp;user=test\n</code></pre>\n\n<p>Also, it should work when there is a string with at least one match:</p>\n\n<pre><code>str = \"www.domain.com?person={STAY_ID}\"\n\n#=&gt; www.domain.com?person=30030303\n</code></pre>\n\n<p>I need some method/solution that can handle any situation like above.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1549602134, "post_id": 54555119, "comment_id": 95969027, "body": "Have you looked at <a href=\"https://github.com/kostya/eye\" rel=\"nofollow noreferrer\">github.com/kostya/eye</a> or <a href=\"https://github.com/mojombo/god\" rel=\"nofollow noreferrer\">github.com/mojombo/god</a>?"}, {"owner": {"reputation": 1377, "user_id": 3011280, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mkyAT.jpg?s=128&g=1", "display_name": "Oshan Wisumperuma", "link": "https://stackoverflow.com/users/3011280/oshan-wisumperuma"}, "edited": false, "score": 0, "creation_date": 1549682818, "post_id": 54555119, "comment_id": 96001736, "body": "your setup is not clear. whats your application server? what invokes this Thread you saying?"}], "owner": {"reputation": 1, "user_id": 10968599, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RMs2tWLVI-Y/AAAAAAAAAAI/AAAAAAAAHyE/iFr2be-ODqM/photo.jpg?sz=128", "display_name": "Efrain Camilo Hernandez Arias", "link": "https://stackoverflow.com/users/10968599/efrain-camilo-hernandez-arias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549460788, "creation_date": 1549460788, "question_id": 54555119, "link": "https://stackoverflow.com/questions/54555119/how-can-i-automatically-restart-a-thread-ruby-on-rails", "title": "How can I automatically restart a thread Ruby on Rails", "body": "<p>I am building an information synchronizer, I use a thread so that when I start the server it is executed (I use RethinkDB to listen to the changes) but when a code error occurs the thread dies, I need that when it dies it comes back and starts.</p>\n\n<p>I thought about watching the thread but I have not found a solution.</p>\n\n<p>In advance thank you very much for the help!</p>\n\n<p>I have tried with the CRONO, but it is not an automatic solution since every so often it does the verification, the idea is that everything works in real time.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "curl", "rest-client"], "answers": [{"tags": [], "owner": {"reputation": 1919, "user_id": 384689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66498e80512ef50822cceb2a2f5cba3?s=128&d=identicon&r=PG", "display_name": "claasz", "link": "https://stackoverflow.com/users/384689/claasz"}, "is_accepted": false, "score": 0, "last_activity_date": 1549472990, "creation_date": 1549472990, "answer_id": 54559003, "question_id": 54554952, "link": "https://stackoverflow.com/questions/54554952/how-to-convert-a-curl-request-to-ruby-gem-httpclient/54559003#54559003", "title": "How to convert a CURL request to Ruby Gem HTTPClient", "body": "<p>Your requests are not equivalent. I guess you are mixing <code>JSON</code>, <code>Multipart</code> and <code>x-www-form-urlencoded</code> formats here.</p>\n\n<p>RestClient supports all three formats (examples taken from <a href=\"https://github.com/rest-client/rest-client/blob/master/README.md\" rel=\"nofollow noreferrer\">https://github.com/rest-client/rest-client/blob/master/README.md</a>)</p>\n\n<pre><code># POST JSON\nRestClient.post \"http://example.com/resource\", {'x' =&gt; 1}.to_json, {content_type: :json, accept: :json}\n\n# POST Multipart\n# Usually not needed if you don't want to upload a file\nRestClient.post '/data', {:foo =&gt; 'bar', :multipart =&gt; true}\n\n# POST x-www-form-urlencoded\nRestClient.post('https://httpbin.org/post', {foo: 'bar', baz: 'qux'})\n</code></pre>\n\n<p>Looks like your curl sample uses <code>application/x-www-form-urlencoded</code>, while your Ruby sample uses <code>multipart/form-data</code>.</p>\n\n<p>For some background information, check</p>\n\n<ul>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST</a></li>\n<li><a href=\"https://dev.to/sidthesloth92/understanding-html-form-encoding-url-encoded-and-multipart-forms-3lpa\" rel=\"nofollow noreferrer\">https://dev.to/sidthesloth92/understanding-html-form-encoding-url-encoded-and-multipart-forms-3lpa</a></li>\n</ul>\n"}], "owner": {"reputation": 3821, "user_id": 1000514, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bd33755d13025ff0394a92993f23257e?s=128&d=identicon&r=PG", "display_name": "WagnerMatosUK", "link": "https://stackoverflow.com/users/1000514/wagnermatosuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1549472990, "creation_date": 1549460272, "last_edit_date": 1549461265, "question_id": 54554952, "link": "https://stackoverflow.com/questions/54554952/how-to-convert-a-curl-request-to-ruby-gem-httpclient", "title": "How to convert a CURL request to Ruby Gem HTTPClient", "body": "<p>I am trying to convert this CURL request:</p>\n\n<pre><code>curl \\\n  -F 'slideshow_spec={ \n    \"images_urls\": [ \n      \"&lt;IMAGE_URL_1&gt;\", \n      \"&lt;IMAGE_URL_2&gt;\", \n      \"&lt;IMAGE_URL_3&gt;\" \n    ], \n    \"duration_ms\": 2000, \n    \"transition_ms\": 200 \n  }' \\\n  -F 'access_token=&lt;ACCESS_TOKEN&gt;' \\\n  https://google.com\n</code></pre>\n\n<p>To a HTTPClient request but all my attempts results in 400 Bad Request. Here's what I've tried:</p>\n\n<pre><code>  payload = {\n        \"images_urls\": [\n          \"https://cdn-m2.esoftsystems.com/10100028/TAASTRUP%40DANBOLIG.DK/10106239925/160596797/BEST_FIT/1542/1024/IMG_5511.jpg\",\n          \"https://cdn-m2.esoftsystems.com/10100028/TAASTRUP%40DANBOLIG.DK/10106239925/160596797/BEST_FIT/1542/1024/IMG_5511.jpg\",\n          \"https://cdn-m2.esoftsystems.com/10100028/TAASTRUP%40DANBOLIG.DK/10106239925/160596797/BEST_FIT/1542/1024/IMG_5511.jpg\"\n        ],\n        \"duration_ms\": 2000,\n        \"transition_ms\": 200\n      }\n\n  response = RestClient.post url, {slideshow_spec: payload.to_json, multipart: true, access_token: access_token}\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "architecture"], "comments": [{"owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "edited": false, "score": 0, "creation_date": 1549461596, "post_id": 54554792, "comment_id": 95910380, "body": "Checkout <a href=\"https://github.com/plataformatec/devise/wiki/How-to-Setup-Multiple-Devise-User-Models#6-fix-cross-model-visits-fancy-name-for-users-can-visit-admins-login-and-viceversa-and-mess-up-your-auth-tokens\" rel=\"nofollow noreferrer\">wiki</a> to some idea"}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 3927582, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/0b521a3b44a8489e92a0022766dcf2d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3927582", "link": "https://stackoverflow.com/users/3927582/user3927582"}, "edited": false, "score": 0, "creation_date": 1549461464, "post_id": 54554955, "comment_id": 95910288, "body": "They are currently using 3 different devise models that are associated differently to the same tables in the database. I&#39;m using Pundit, and it has crossed my mind that I could use this by classname and allow authorisation that way? For example, if <code>current_user.class.to_s == &quot;Seat&quot;</code> then authorize. Obviously that would be in the model &amp; policy file."}], "tags": [], "owner": {"reputation": 76, "user_id": 8518329, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6ZmafDaaKVQ/AAAAAAAAAAI/AAAAAAAAAAs/x4O5h7AXstM/photo.jpg?sz=128", "display_name": "Ted Price", "link": "https://stackoverflow.com/users/8518329/ted-price"}, "is_accepted": false, "score": 0, "last_activity_date": 1549460282, "creation_date": 1549460282, "answer_id": 54554955, "question_id": 54554792, "link": "https://stackoverflow.com/questions/54554792/rails-5-multiple-devise-models-using-same-controllers-architecture/54554955#54554955", "title": "Rails 5 Multiple Devise Models using same controllers - architecture", "body": "<p>Do they all care the same underlying table? At first sight, my question would be why not use a single resource, perhaps with <code>type</code> attribute if you need to flag the client, seat or admin. Are you using CanCan, Pundit, or another community-supported authorization framework?</p>\n"}], "owner": {"reputation": 179, "user_id": 3927582, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/0b521a3b44a8489e92a0022766dcf2d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3927582", "link": "https://stackoverflow.com/users/3927582/user3927582"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549460282, "creation_date": 1549459733, "question_id": 54554792, "link": "https://stackoverflow.com/questions/54554792/rails-5-multiple-devise-models-using-same-controllers-architecture", "title": "Rails 5 Multiple Devise Models using same controllers - architecture", "body": "<p>I currently have a rails 5 app that has 3 Devise Models and hence 3 separate logins. This is working well. </p>\n\n<p>The challenge I am having is that all three models share the majority of the same resources, however with different authorisation levels. For example, one Devise model may be allowed new and create actions but not destroy etc etc. </p>\n\n<p>Currently, I have controllers namespaced within each Devise model in controllers. So, for example, controllers > admins > same_resource_controller.rb and controllers > seats > same_resource_controller.rb. These files share a lot of the same code and it's creating unnecessary maintenance that I don't feel should be there. </p>\n\n<p>So, If I was to use the controllers > same_resource_controller.rb at a top level I can foresee some fundamental issues:</p>\n\n<p><strong>Authentication</strong>, can I put a <code>authenticate_user!</code> in the controller that reads from application_controller:</p>\n\n<pre><code>def authenticate_user\n  authenticate_admin! || authenticate_seat! || authenticate_client!\nend\n</code></pre>\n\n<p><strong>current_user</strong>, is it ok to have, and use, a method like this in the <code>application_controller.rb</code>?</p>\n\n<pre><code>def current_user\n  current_admin || current_seat || current_client\nend\n</code></pre>\n\n<p>The resulting potential issue is associating records, for example when querying, current_user.another_model.yet_another_model is not the same for and Admin as it is for a Seat.</p>\n\n<p>I really like the idea of cutting down my controllers and tests and associated files by a third but I'm really unsure as to the correct architecture. </p>\n\n<p>If anyone has been through the same or has any good links (I have struggled to find articles on dealing with controllers when multiple Devise models) I would really appreciate some help! Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "digital-ocean"], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 937030, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8ecd085d5e6e3b622994b036ac3488b?s=128&d=identicon&r=PG", "display_name": "lancegoh", "link": "https://stackoverflow.com/users/937030/lancegoh"}, "edited": false, "score": 0, "creation_date": 1549548406, "post_id": 54554591, "comment_id": 95947899, "body": "Thanks for the heads up. I am thinking along the line where I have an api access from the original app and leverage another instance on heroku to process the scheduler stuff."}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1549459062, "creation_date": 1549459062, "answer_id": 54554591, "question_id": 54554281, "link": "https://stackoverflow.com/questions/54554281/ruby-on-rails-app-on-digital-ocean-scheduler-on-heroku/54554591#54554591", "title": "Ruby on Rails -&gt; App on Digital Ocean, Scheduler on Heroku", "body": "<p>The first gotcha that comes to mind is that running scheduler on Heroku isn't exactly free. Per the docs at <a href=\"https://devcenter.heroku.com/articles/scheduler\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/scheduler</a></p>\n\n<blockquote>\n  <p>While Scheduler is a free add-on, it executes scheduled jobs via one-off dynos that will count towards your monthly usage.</p>\n</blockquote>\n\n<p>So having the instance up and running may be possible on the free tier, but once you start processing jobs you'll be charged.</p>\n\n<p>I think the hardest part will be figuring out the networking between Heroku and DigitalOcean, assuming you'll need the apps to use the same database.</p>\n"}], "owner": {"reputation": 474, "user_id": 937030, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8ecd085d5e6e3b622994b036ac3488b?s=128&d=identicon&r=PG", "display_name": "lancegoh", "link": "https://stackoverflow.com/users/937030/lancegoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549459062, "creation_date": 1549458099, "question_id": 54554281, "link": "https://stackoverflow.com/questions/54554281/ruby-on-rails-app-on-digital-ocean-scheduler-on-heroku", "title": "Ruby on Rails -&gt; App on Digital Ocean, Scheduler on Heroku", "body": "<p>I am currently building an app on RoR hosted on Digital Ocean.</p>\n\n<p>I like to lighten the workload on the instance and transfer some on the crons stuff to heroku (free -tier).</p>\n\n<p>I am wondering if anyone have done something similar and if so, let me know your thoughts and gotcha.</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "web-scraping", "selenium-chromedriver", "digital-ocean"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7769473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f822d6799d8a0ed819034cacc7e94c55?s=128&d=identicon&r=PG&f=1", "display_name": "S. Pavlo", "link": "https://stackoverflow.com/users/7769473/s-pavlo"}, "edited": false, "score": 0, "creation_date": 1550065613, "post_id": 54649695, "comment_id": 96133166, "body": "Thanks for your help, Dan!"}, {"owner": {"reputation": 139, "user_id": 7285814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1da2143b0dcb7d2b33f1a9f827a7c4?s=128&d=identicon&r=PG&f=1", "display_name": "dan.brown", "link": "https://stackoverflow.com/users/7285814/dan-brown"}, "reply_to_user": {"reputation": 1, "user_id": 7769473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f822d6799d8a0ed819034cacc7e94c55?s=128&d=identicon&r=PG&f=1", "display_name": "S. Pavlo", "link": "https://stackoverflow.com/users/7769473/s-pavlo"}, "edited": false, "score": 0, "creation_date": 1550066562, "post_id": 54649695, "comment_id": 96133790, "body": "No problem, if it worked ok, please can you upvote the answer :)"}], "tags": [], "owner": {"reputation": 139, "user_id": 7285814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1da2143b0dcb7d2b33f1a9f827a7c4?s=128&d=identicon&r=PG&f=1", "display_name": "dan.brown", "link": "https://stackoverflow.com/users/7285814/dan-brown"}, "is_accepted": false, "score": 1, "last_activity_date": 1549972865, "creation_date": 1549972865, "answer_id": 54649695, "question_id": 54553739, "link": "https://stackoverflow.com/questions/54553739/how-can-i-run-selenium-webdriver-script-written-in-ruby-in-headless-mode-on-digi/54649695#54649695", "title": "How can I run selenium-webdriver script written in Ruby in headless mode on digital-ocean droplet?", "body": "<p>This is how I get Chrome to run in headless mode:</p>\n\n<pre><code>options = Selenium::WebDriver::Chrome::Options.new(args: ['headless'])\ndriver = Selenium::WebDriver.for :chrome, options: options\n</code></pre>\n\n<p>You are passing some of the args through incorrectly, headless mode should be included. You also shouldn't need <code>binary: ('/bin/chromedriver')</code> if your chromedriver.exe is added to your PATH correctly. </p>\n\n<p>So for your above example, the following should work:</p>\n\n<pre><code>    options = Selenium::WebDriver::Chrome::Options.new(args: ['headless', \n    'start-maximized','disable-gpu', 'no-sandbox', 'disable-setuid-sandbox', \n    'disable-dable-dev-shm-usage'])\n     driver = Selenium::WebDriver.for :chrome, options: options\n</code></pre>\n\n<p>Hope this helps,\nDan</p>\n"}], "owner": {"reputation": 1, "user_id": 7769473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f822d6799d8a0ed819034cacc7e94c55?s=128&d=identicon&r=PG&f=1", "display_name": "S. Pavlo", "link": "https://stackoverflow.com/users/7769473/s-pavlo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549972865, "creation_date": 1549456287, "question_id": 54553739, "link": "https://stackoverflow.com/questions/54553739/how-can-i-run-selenium-webdriver-script-written-in-ruby-in-headless-mode-on-digi", "title": "How can I run selenium-webdriver script written in Ruby in headless mode on digital-ocean droplet?", "body": "<p>I can not run ruby scripts on digital-ocean droplet. I tried running with selenium-webdriver and watir gems, but doesn't work. </p>\n\n<p>I tried running with different versions of chromedriver, changed also selenium-webdriver's gem versions, but didn't work.\nMy ruby -v: ruby 2.3.1p112\nselenium-webdriver -v: (3.141.0)\nChromedriver -v: 2.46</p>\n\n<p>require 'selenium-webdriver'</p>\n\n<p>options = Selenium::WebDriver::Chrome::Options.new(args: ['start-maximized','disable-gpu', 'no-sandbox', 'disable-setuid-sandbox', 'disable-dable-dev-shm-usage'], binary: ('/bin/chromedriver'))\noptions.headless!</p>\n\n<p>driver = Selenium::WebDriver.for(:chrome, options: options)</p>\n\n<p>Error I get:\n/usr/share/rvm/gems/ruby-2.3.1/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/response.rb:69:in `assert_ok': unknown error: Chrome failed to start: exited abnormally (Selenium::WebDriver::Error::UnknownError)\n  unknown error: DevToolsActivePort file doesn't exist)</p>\n\n<p>Thanks for attention!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "graphql", "graphql-ruby"], "comments": [{"owner": {"reputation": 172, "user_id": 5662455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0SZoL.jpg?s=128&g=1", "display_name": "Abhay Nikam", "link": "https://stackoverflow.com/users/5662455/abhay-nikam"}, "edited": false, "score": 0, "creation_date": 1553497195, "post_id": 54552749, "comment_id": 97390430, "body": "Why is the argument capitalized? Can you just keep the argument as follows:  argument :sign_in_input, Inputs::SignInInput, required: true"}], "owner": {"reputation": 1125, "user_id": 5398558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-y55QNRIiBcA/AAAAAAAAAAI/AAAAAAAAABI/HLtIr-k2f7w/photo.jpg?sz=128", "display_name": "Nadiya", "link": "https://stackoverflow.com/users/5398558/nadiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 740, "favorite_count": 1, "answer_count": 0, "score": 6, "last_activity_date": 1549452955, "creation_date": 1549452955, "question_id": 54552749, "link": "https://stackoverflow.com/questions/54552749/graphql-ruby-duplicate-type-definition-found-error", "title": "GraphQL Ruby &#39;Duplicate type definition found&#39; error", "body": "<p>I'm trying to update my mutation with variables and receive such error:</p>\n\n<blockquote>\n  <p>Duplicate type definition found for name 'SignInInput' at 'Input field\n  SignInInput.signInInput'</p>\n</blockquote>\n\n<p>My mutation code:</p>\n\n<pre><code>module Mutations\n  class SignIn &lt; BaseMutation\n    description 'User sign in'\n\n    argument :signInInput, Inputs::SignInInput, as: :sign_in_input, required: true\n\n    field :token, String, null: false\n\n    def resolve(sign_in_input:)\n      ...\n    end\n  end\nend\n</code></pre>\n\n<p>My custom input code:</p>\n\n<pre><code>module Inputs\n  class SignInInput &lt; Types::BaseInputObject\n    description \"Attributes for user sign in\"\n\n    argument :email, String, \"User email\", required: true\n    argument :password, String, \"User password\", required: true\n  end\nend\n</code></pre>\n\n<p>My query:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SL7QT.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/SL7QT.png\" alt=\"enter image description here\"></a></p>\n\n<p>What can be the reason of this weird error? I have only once defined such class.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 76, "user_id": 8518329, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6ZmafDaaKVQ/AAAAAAAAAAI/AAAAAAAAAAs/x4O5h7AXstM/photo.jpg?sz=128", "display_name": "Ted Price", "link": "https://stackoverflow.com/users/8518329/ted-price"}, "edited": false, "score": 1, "creation_date": 1549460029, "post_id": 54552490, "comment_id": 95909426, "body": "Post the entire controller. Are the <code>actuality_params</code> being used in the <code>update</code> action properly?"}, {"owner": {"reputation": 47, "user_id": 9509271, "user_type": "registered", "profile_image": "https://graph.facebook.com/594488854221095/picture?type=large", "display_name": "R&#233;my Le Dernier Bop", "link": "https://stackoverflow.com/users/9509271/r%c3%a9my-le-dernier-bop"}, "reply_to_user": {"reputation": 76, "user_id": 8518329, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6ZmafDaaKVQ/AAAAAAAAAAI/AAAAAAAAAAs/x4O5h7AXstM/photo.jpg?sz=128", "display_name": "Ted Price", "link": "https://stackoverflow.com/users/8518329/ted-price"}, "edited": false, "score": 0, "creation_date": 1549460809, "post_id": 54552490, "comment_id": 95909898, "body": "I edit my post whit my entire controller. Thanks"}, {"owner": {"reputation": 47, "user_id": 9509271, "user_type": "registered", "profile_image": "https://graph.facebook.com/594488854221095/picture?type=large", "display_name": "R&#233;my Le Dernier Bop", "link": "https://stackoverflow.com/users/9509271/r%c3%a9my-le-dernier-bop"}, "reply_to_user": {"reputation": 76, "user_id": 8518329, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6ZmafDaaKVQ/AAAAAAAAAAI/AAAAAAAAAAs/x4O5h7AXstM/photo.jpg?sz=128", "display_name": "Ted Price", "link": "https://stackoverflow.com/users/8518329/ted-price"}, "edited": false, "score": 0, "creation_date": 1549568667, "post_id": 54552490, "comment_id": 95959258, "body": "Up please! I don&#39;t find the solution yet"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1549601972, "post_id": 54552490, "comment_id": 95968999, "body": "Is that your entire controller? No <code>create</code> or <code>update</code> methods at all?"}, {"owner": {"reputation": 47, "user_id": 9509271, "user_type": "registered", "profile_image": "https://graph.facebook.com/594488854221095/picture?type=large", "display_name": "R&#233;my Le Dernier Bop", "link": "https://stackoverflow.com/users/9509271/r%c3%a9my-le-dernier-bop"}, "edited": false, "score": 0, "creation_date": 1549608733, "post_id": 54552490, "comment_id": 95971053, "body": "Sorry i make a mistake. It isn&#39;t the admin controller. I edit it in the morning"}, {"owner": {"reputation": 47, "user_id": 9509271, "user_type": "registered", "profile_image": "https://graph.facebook.com/594488854221095/picture?type=large", "display_name": "R&#233;my Le Dernier Bop", "link": "https://stackoverflow.com/users/9509271/r%c3%a9my-le-dernier-bop"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1549647374, "post_id": 54552490, "comment_id": 95991344, "body": "@JayDorsey it&#39;s ok my controller is edit with the good one. Sorry for the mistake."}, {"owner": {"reputation": 47, "user_id": 9509271, "user_type": "registered", "profile_image": "https://graph.facebook.com/594488854221095/picture?type=large", "display_name": "R&#233;my Le Dernier Bop", "link": "https://stackoverflow.com/users/9509271/r%c3%a9my-le-dernier-bop"}, "edited": false, "score": 0, "creation_date": 1549721779, "post_id": 54552490, "comment_id": 96009247, "body": "Up ! I realy don&#39;t understand where is the problem"}], "owner": {"reputation": 47, "user_id": 9509271, "user_type": "registered", "profile_image": "https://graph.facebook.com/594488854221095/picture?type=large", "display_name": "R&#233;my Le Dernier Bop", "link": "https://stackoverflow.com/users/9509271/r%c3%a9my-le-dernier-bop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1549647314, "creation_date": 1549452185, "last_edit_date": 1549647314, "question_id": 54552490, "link": "https://stackoverflow.com/questions/54552490/my-photo-field-dont-save-selection-when-i-edit-my-post", "title": "My photo field don&#39;t save selection when I edit my post", "body": "<p>The problem occurs when I edit a post in my back-office. All the belong_to table don't save the informations were saved when I create the post.</p>\n\n<p>I don't find solution on the web. I'm not an experiment dev so I don't now where I must look for.</p>\n\n<p>My upload_file :</p>\n\n<pre><code>require \"image_processing/mini_magick\"\n\nclass ImageUploader &lt; Shrine\n plugin :processing # allows hooking into promoting\n plugin :versions   # enable Shrine to handle a hash of files\n plugin :delete_raw # delete processed files after uploading\n\n process(:store) do |io, context|\n   original = io.download\n   pipeline = ImageProcessing::MiniMagick.source(original)\n\n   size_200 = pipeline.resize_to_limit!(200, 200)\n   size_300 = pipeline.resize_to_limit!(300, 300)\n\n   original.close!\n\n   { original: io, moyen: size_300, small: size_200 }\n end\nend\n</code></pre>\n\n<p>My model :</p>\n\n<pre><code>has_one :photo, as: :attachable\n  accepts_nested_attributes_for :photo\n</code></pre>\n\n<p>My controller :</p>\n\n<pre><code># frozen_string_literal: true\n\nclass Admin::ActualitiesController &lt; Admin::AdminController\n  before_action :set_actuality, only: %i[show edit update destroy]\n\n  def index\n    @actualities = Actuality.order('id DESC').page(params[:page]).per(10)\n  end\n\n  def new\n    @actuality = Actuality.new\n    @actuality.build_photo\n  end\n\n  def edit\n  end\n\n  def show; end\n\n  def create\n    @actuality = Actuality.new(actuality_params)\n\n    if @actuality.save\n      redirect_to :show, notice: ''\n    else\n      render :new, notice: ''\n    end\n  end\n\n  def update\n    if @actuality.update(actuality_params)\n      redirect_to :show, notice: ''\n    else\n      render :edit\n    end\n  end\n\n  def destroy\n    @actuality.destroy\n    redirect_to admin_actualities_path, notice: ''\n  end\n\n  private\n\n  def set_actuality\n    @actuality = Actuality.find_by(id: params[:id])\n  end\n\n  def actuality_params\n    params.require(:actuality).permit(:title, :body, :apercu, :meeting, photo_attributes: [:photo])\n  end\nend\n</code></pre>\n\n<p>And in my form :</p>\n\n<pre><code>&lt;%= f.simple_fields_for :photo do |ff| %&gt;\n    &lt;%= ff.input :photo, as: :hidden %&gt;\n    &lt;%= ff.input :photo, as: :file %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>If you have any solutions, I'm here !\nThanks !</p>\n"}, {"tags": ["ruby", "visual-studio-code", "rvm"], "answers": [{"comments": [{"owner": {"reputation": 8220, "user_id": 2771889, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c568088e59a0fe4e38016d2707f48fb4?s=128&d=identicon&r=PG&f=1", "display_name": "thisismydesign", "link": "https://stackoverflow.com/users/2771889/thisismydesign"}, "edited": false, "score": 1, "creation_date": 1592902571, "post_id": 62523631, "comment_id": 110583813, "body": "<code>&#47;bin&#47;bash cd .: No such file or directory</code> I believe that option is to pass arguments to the shell, not to run commands."}], "tags": [], "owner": {"reputation": 19, "user_id": 5391344, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DpBBzoTlZhc/AAAAAAAAAAI/AAAAAAAAB2w/MB1ah-vnROg/photo.jpg?sz=128", "display_name": "Pedro Ricardo Garcia", "link": "https://stackoverflow.com/users/5391344/pedro-ricardo-garcia"}, "is_accepted": false, "score": 0, "last_activity_date": 1592860646, "creation_date": 1592860646, "answer_id": 62523631, "question_id": 54552000, "link": "https://stackoverflow.com/questions/54552000/rvms-auto-detect-ruby-version-via-repo-files-feature-is-not-working-in-vscode-l/62523631#62523631", "title": "RVM&#39;s auto-detect Ruby version via repo files feature is not working in VSCode login shell terminal", "body": "<p>This may be a workaround..</p>\n<p>Add this in vs\n&quot;terminal.integrated.shellArgs.linux&quot;: [\n&quot;cd .&quot;\n],</p>\n"}, {"tags": [], "owner": {"reputation": 78, "user_id": 344421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7992b726ef9f7f8ed197b580b226864?s=128&d=identicon&r=PG", "display_name": "jhulford", "link": "https://stackoverflow.com/users/344421/jhulford"}, "is_accepted": false, "score": 0, "last_activity_date": 1605117255, "last_edit_date": 1605117255, "creation_date": 1605116941, "answer_id": 64791562, "question_id": 54552000, "link": "https://stackoverflow.com/questions/54552000/rvms-auto-detect-ruby-version-via-repo-files-feature-is-not-working-in-vscode-l/64791562#64791562", "title": "RVM&#39;s auto-detect Ruby version via repo files feature is not working in VSCode login shell terminal", "body": "<p>The reason this doesn't work by default is because rvm hooks the cd command in the shell to setup the ruby/gem paths for your project and there's no cd issued to the shell by the VS Code terminal opening.</p>\n<p>I was able to resolve this issue on my Linux system by adding the login setup as suggested in the question and then adding a simple <code>cd .</code> at the end of my ~/.bash_profile after the section where RVM is actually set up.</p>\n<p>Doing this results in rvm properly adjusting the paths in the VS Code terminal.</p>\n"}], "owner": {"reputation": 8220, "user_id": 2771889, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c568088e59a0fe4e38016d2707f48fb4?s=128&d=identicon&r=PG&f=1", "display_name": "thisismydesign", "link": "https://stackoverflow.com/users/2771889/thisismydesign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1605117255, "creation_date": 1549450719, "question_id": 54552000, "link": "https://stackoverflow.com/questions/54552000/rvms-auto-detect-ruby-version-via-repo-files-feature-is-not-working-in-vscode-l", "title": "RVM&#39;s auto-detect Ruby version via repo files feature is not working in VSCode login shell terminal", "body": "<p>RVM has a feature to detect and use the correct Ruby version based on e.g. a <code>.ruby-version</code> file in the repo. This requires a login shell which I have enabled in VSCode via:</p>\n\n<pre><code>\"terminal.integrated.shell.linux\": \"bash\",\n\"terminal.integrated.shellArgs.linux\": [\"--login\"],\n</code></pre>\n\n<p>However the feature isn't working by default, I have to <code>cd .</code> every time I open the terminal as if it is not a login shell.</p>\n\n<p>There's a similar issue about new tabs in a gnome shell: <a href=\"https://github.com/rvm/rvm/issues/2519\" rel=\"nofollow noreferrer\">https://github.com/rvm/rvm/issues/2519</a></p>\n\n<p>I wonder if anyone else ran into this and whether this might be an issue with VSCode or RVM?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "facebook", "facebook-graph-api"], "comments": [{"owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "edited": false, "score": 2, "creation_date": 1549451287, "post_id": 54551707, "comment_id": 95904203, "body": "Facebook is actively hostile towards this kind of use case. I&#39;m not familiar with this particular feature but when I attempted to write scripts to pull data from facebook I found they they do everything to block it so you visit the website instead."}, {"owner": {"reputation": 5091, "user_id": 10955263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8352744d1489964dc9ea418be332ed?s=128&d=identicon&r=PG&f=1", "display_name": "04FS", "link": "https://stackoverflow.com/users/10955263/04fs"}, "edited": false, "score": 1, "creation_date": 1549452064, "post_id": 54551707, "comment_id": 95904638, "body": "Scraping any Facebook web pages is not allowed without their explicit prior written permission."}], "owner": {"reputation": 145, "user_id": 9471462, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Odeth A.", "link": "https://stackoverflow.com/users/9471462/odeth-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1549455192, "creation_date": 1549449898, "question_id": 54551707, "link": "https://stackoverflow.com/questions/54551707/is-it-possible-to-capture-a-link-in-a-facebook-page-that-requires-a-login-to-be", "title": "Is it possible to capture a link in a facebook page that requires a login to be viewed?", "body": "<p>I have a candidate application link that was sent via email from facebook jobs. This link contains an html page where I could download the candidate's resume. And my goal is to scrape the data from this resume programmatically.</p>\n\n<p>But when I access this link directly, an authentication page will require me to log in to view the content of it. So I'm thinking if it is possible in some way to login via code so I could access this link and scrape the necessary pieces of information?</p>\n\n<p>Or is there some facebook restrictions or needed permissions that I should be aware of? I already have the facebook page access token where this job application is posted.</p>\n\n<p>Any help will be very much appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "chef-infra", "ruby-block"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1549456286, "post_id": 54551290, "comment_id": 95907205, "body": "Did you try double-escaping? like <code>V\\\\$DATABASE</code>?"}, {"owner": {"reputation": 159, "user_id": 4501628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c27574c3da5710cbe5bd0783b0f9765c?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4501628/ivan"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1549614367, "post_id": 54551290, "comment_id": 95973179, "body": "Yes. It gave &quot;undefined variable&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 4501628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c27574c3da5710cbe5bd0783b0f9765c?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4501628/ivan"}, "edited": false, "score": 0, "creation_date": 1549614386, "post_id": 54554656, "comment_id": 95973184, "body": "With double slash it gave &quot;undefined variable&quot;"}, {"owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "reply_to_user": {"reputation": 159, "user_id": 4501628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c27574c3da5710cbe5bd0783b0f9765c?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4501628/ivan"}, "edited": false, "score": 0, "creation_date": 1549784914, "post_id": 54554656, "comment_id": 96022214, "body": "@Ivan: do you have <code>DATABASE</code> environment variable defined?"}, {"owner": {"reputation": 159, "user_id": 4501628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c27574c3da5710cbe5bd0783b0f9765c?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4501628/ivan"}, "edited": false, "score": 0, "creation_date": 1549955927, "post_id": 54554656, "comment_id": 96080554, "body": "I checked. It is not set. I ended up echoing the sql commands to a file and running the .sql"}], "tags": [], "owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "is_accepted": false, "score": 0, "last_activity_date": 1549459249, "creation_date": 1549459249, "answer_id": 54554656, "question_id": 54551290, "link": "https://stackoverflow.com/questions/54551290/unable-to-escape-dollar-sign-in-ruby-block-chef-resource/54554656#54554656", "title": "Unable to escape dollar sign in ruby_block chef resource", "body": "<p>since the <code>command</code> is a bash command, you need to escape the <code>$</code> sign, which is being evaluated in the shell as a variable.</p>\n\n<p>append double backslash before the <code>$</code>, that is <code>\\\\$</code></p>\n"}], "owner": {"reputation": 159, "user_id": 4501628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c27574c3da5710cbe5bd0783b0f9765c?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4501628/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549523208, "creation_date": 1549448650, "last_edit_date": 1549523208, "question_id": 54551290, "link": "https://stackoverflow.com/questions/54551290/unable-to-escape-dollar-sign-in-ruby-block-chef-resource", "title": "Unable to escape dollar sign in ruby_block chef resource", "body": "<p>I'm writing a chef recipe wherein an sql command is run.</p>\n\n<pre><code>ruby_block 'SQL command' do\n  block do\n    report = open(ReportFile,'a')\n    command = %Q( ssh -o StrictHostKeyChecking=no root@#{dbHost2} 'su - #{oraSidUser} -c \"#{oracleHome}/bin/sqlplus / as sysdba &lt;&lt;EOF\nSELECT FLASHBACK_ON FROM V$DATABASE;\nEOF\"' )\n    commandObj = Mixlib::ShellOut.new(command, :timeout =&gt; 60)\n    commandObj.run_command()\n    report.puts(\"Command:#{command}\\nOutput:#{commandObj.stdout}\\nError:#{commandObj.stderr}\\nExit code:#{commandObj.exitstatus}\")\n  end\nend\n</code></pre>\n\n<p>But when I check the log, it does not run the SQL command. It runs,</p>\n\n<pre><code>SQL&gt; SELECT FLASHBACK_ON FROM V\n                         *\nERROR at line 1:\nORA-00942: table or view does not exist\n</code></pre>\n\n<p>Seems it is trying to put the value of $DATABASE. I've tried using backslash to escape $. I've used double dollar sign. I've tried putting the SQL in a variable but it still does not run the correct SQL. Is there a different way to escape the dollar sign?</p>\n\n<p>Edit:\nWith double backslash or triple backslash it fails with,</p>\n\n<pre><code>Error:DATABASE: Undefined variable.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-api"], "comments": [{"owner": {"reputation": 2470, "user_id": 1013142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd97eb9f014330c6063dfadb77bbd5de?s=128&d=identicon&r=PG", "display_name": "Sudipta Mondal", "link": "https://stackoverflow.com/users/1013142/sudipta-mondal"}, "edited": false, "score": 1, "creation_date": 1549446307, "post_id": 54550537, "comment_id": 95901163, "body": "yes, its possible."}, {"owner": {"reputation": 2470, "user_id": 1013142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd97eb9f014330c6063dfadb77bbd5de?s=128&d=identicon&r=PG", "display_name": "Sudipta Mondal", "link": "https://stackoverflow.com/users/1013142/sudipta-mondal"}, "edited": false, "score": 2, "creation_date": 1549447280, "post_id": 54550537, "comment_id": 95901708, "body": "Stack overflow is a not a free code writing service. <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask</a> and ofcourse read the answer in this question - <a href=\"https://meta.stackoverflow.com/questions/258589/breaking-down-too-broad-and-trying-to-understand-it\">Too Broad</a> to understand why your question doesn&#39;t fit in the Stack overflow eco system."}, {"owner": {"reputation": 1, "user_id": 10841777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8f7f5c0cec8401e59e017218bea2c1?s=128&d=identicon&r=PG&f=1", "display_name": "uma rajendran", "link": "https://stackoverflow.com/users/10841777/uma-rajendran"}, "reply_to_user": {"reputation": 2470, "user_id": 1013142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd97eb9f014330c6063dfadb77bbd5de?s=128&d=identicon&r=PG", "display_name": "Sudipta Mondal", "link": "https://stackoverflow.com/users/1013142/sudipta-mondal"}, "edited": false, "score": 0, "creation_date": 1549448987, "post_id": 54550537, "comment_id": 95902760, "body": "how do i connect the subscribed messages in angular to rails with actioncable? Should the channels in rails match with those in frontend?"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1549448560, "post_id": 54551007, "comment_id": 95902502, "body": "This should be a comment, not an answer."}], "tags": [], "owner": {"reputation": 674, "user_id": 1441143, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc0f204c0f4bb8a87c0294c397ce0a08?s=128&d=identicon&r=PG&f=1", "display_name": "Jakxna360", "link": "https://stackoverflow.com/users/1441143/jakxna360"}, "is_accepted": false, "score": 0, "last_activity_date": 1549447809, "creation_date": 1549447809, "answer_id": 54551007, "question_id": 54550537, "link": "https://stackoverflow.com/questions/54550537/how-to-create-chat-app-using-actioncable-in-rails-api-only-project/54551007#54551007", "title": "How to create chat app using actioncable in rails-api only project", "body": "<p>If you have a go rails account you can follow this tutorial series on how to build a chat like application. This can get you started at least:\n<a href=\"https://gorails.com/episodes/group-chat-with-actioncable-part-1\" rel=\"nofollow noreferrer\">https://gorails.com/episodes/group-chat-with-actioncable-part-1</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10841777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8f7f5c0cec8401e59e017218bea2c1?s=128&d=identicon&r=PG&f=1", "display_name": "uma rajendran", "link": "https://stackoverflow.com/users/10841777/uma-rajendran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1549451915, "creation_date": 1549446249, "last_edit_date": 1549451915, "question_id": 54550537, "link": "https://stackoverflow.com/questions/54550537/how-to-create-chat-app-using-actioncable-in-rails-api-only-project", "title": "How to create chat app using actioncable in rails-api only project", "body": "<p>I am using Front-end is Angular6 and my back-end is Rails. It is possible to create chat app with using action cable???</p>\n"}, {"tags": ["ruby", "ruby-hash"], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 3, "last_activity_date": 1549443689, "creation_date": 1549443689, "answer_id": 54549858, "question_id": 54549805, "link": "https://stackoverflow.com/questions/54549805/using-a-lambda-as-a-default-in-hashfetch-ruby/54549858#54549858", "title": "Using a lambda as a default in Hash#fetch ruby", "body": "<p>When <code>Hash#fetch</code> takes a block, the key is passed to the block. But your block created from a proc does not take any block argument. Change the definition to:</p>\n\n<pre><code>DEFAULT_BLOCK = -&gt; x { 'block executed' }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 9, "last_activity_date": 1549443974, "last_edit_date": 1549443974, "creation_date": 1549443873, "answer_id": 54549904, "question_id": 54549805, "link": "https://stackoverflow.com/questions/54549805/using-a-lambda-as-a-default-in-hashfetch-ruby/54549904#54549904", "title": "Using a lambda as a default in Hash#fetch ruby", "body": "<p>You have, you just don't see it:</p>\n\n<pre><code>WHAT_AM_I_PASSING = -&gt;(var) { var.inspect }\n\nanswers = {}\n\nanswers.fetch(:x, &amp;WHAT_AM_I_PASSING)\n# =&gt; \":x\"\n</code></pre>\n\n<p>The block of <code>Hash#fetch</code> provides an argument, the key that you haven't found. You can either accept an argument in your lambda and just ignore it, or make it a proc:</p>\n\n<pre><code>DEFAULT_BLOCK = proc { 'block executed' }\nanswers.fetch(:x, &amp;DEFAULT_BLOCK)\n# =&gt; \"block executed\" \n</code></pre>\n\n<p>The reason that a proc works, is that lambdas verify that the correct number of arguments were provided while procs don't. The <code>fetch</code> method is calling the proc/lambda with one argument (the key).</p>\n"}, {"comments": [{"owner": {"reputation": 520, "user_id": 6507755, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/IUwxM.png?s=128&g=1", "display_name": "2017kamb", "link": "https://stackoverflow.com/users/6507755/2017kamb"}, "edited": false, "score": 0, "creation_date": 1549449738, "post_id": 54551406, "comment_id": 95903240, "body": "I used it in irb of ruby version 2.6.1"}], "tags": [], "owner": {"reputation": 520, "user_id": 6507755, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/IUwxM.png?s=128&g=1", "display_name": "2017kamb", "link": "https://stackoverflow.com/users/6507755/2017kamb"}, "is_accepted": false, "score": 0, "last_activity_date": 1549449421, "last_edit_date": 1549449421, "creation_date": 1549448991, "answer_id": 54551406, "question_id": 54549805, "link": "https://stackoverflow.com/questions/54549805/using-a-lambda-as-a-default-in-hashfetch-ruby/54551406#54551406", "title": "Using a lambda as a default in Hash#fetch ruby", "body": "<pre><code>    2.6.1 :014 &gt; DEFAULT_BLOCK = -&gt; { 'block executed' }\n     =&gt; #&lt;Proc:0x00005586f6ef9e58@(irb):14 (lambda)&gt; \n    2.6.1 :015 &gt; answers = {}\n     =&gt; {} \n    2.6.1 :016 &gt; ans = answers.fetch(:x) {DEFAULT_BLOCK}\n     =&gt; #&lt;Proc:0x00005586f6ef9e58@(irb):14 (lambda)&gt; \n    2.6.1 :017 &gt; ans.call\n     =&gt; \"block executed\" \n\n    Actually we can pass default value for key so that if key not found in the hash it use this default value like,\n    my_hash = {}\n     =&gt; {} \n    2.6.1 :019 &gt; my_hash[:key1] = 'val1'\n     =&gt; \"val1\" \n    2.6.1 :020 &gt; p my_hash\n    {:key1=&gt;\"val1\"}\n     =&gt; {:key1=&gt;\"val1\"} \n    2.6.1 :022 &gt; my_hash.fetch(:key1)\n     =&gt; \"val1\" \n    2.6.1 :023 &gt; my_hash.fetch(:key2)\n    KeyError (key not found: :key2)\n    Did you mean?  :key1\n    2.6.1 :024 &gt; my_hash.fetch(:key2){'val2'}\n     =&gt; \"val2\" \n</code></pre>\n"}], "owner": {"reputation": 340, "user_id": 5342220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966284a666f7e9ec290cf4fc3785fac4?s=128&d=identicon&r=PG&f=1", "display_name": "L.T", "link": "https://stackoverflow.com/users/5342220/l-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 54549904, "answer_count": 3, "score": 7, "last_activity_date": 1549460682, "creation_date": 1549443505, "last_edit_date": 1549460682, "question_id": 54549805, "link": "https://stackoverflow.com/questions/54549805/using-a-lambda-as-a-default-in-hashfetch-ruby", "title": "Using a lambda as a default in Hash#fetch ruby", "body": "<p>I was reading through confident ruby and I was trying out how to define a reusable proc. From the examples given, I wrote this:</p>\n\n<pre><code>DEFAULT_BLOCK = -&gt; { 'block executed' }\n\nanswers = {}\n\nanswers.fetch(:x, &amp;DEFAULT_BLOCK)\n</code></pre>\n\n<p>I was expecting it to return <code>block executed</code> since <code>x</code> is not found in the Hash but instead it returned <code>wrong number of arguments (given 1, expected 0) (ArgumentError)</code>. What could the problem be? I haven't given the block an argument.</p>\n"}, {"tags": ["ruby", "variables"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 2, "creation_date": 1549440335, "post_id": 54548952, "comment_id": 95898242, "body": "It&#39;s <code>nil</code> for all of these."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1549440429, "post_id": 54548952, "comment_id": 95898276, "body": "you can&#39;t use some of them without assignment"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1549440608, "post_id": 54548952, "comment_id": 95898346, "body": "Right, you can&#39;t use class variables without initialization (you can use local variables though, e.g. <code>a = 1 if false; a</code> won&#39;t raise an error, it returns <code>nil</code> instead)."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1549441082, "post_id": 54548952, "comment_id": 95898525, "body": "Actually, the question not clear."}, {"owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "edited": false, "score": 0, "creation_date": 1549441531, "post_id": 54548952, "comment_id": 95898695, "body": "In an interview, the interviewer asked this what are the default values of ruby variables?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1550703754, "post_id": 54548952, "comment_id": 96371126, "body": "You can answer your question by successively entering, in IRB or PRY, the following: <code>$a</code>, <code>@a</code> , <code>a</code> and <code>class A; @@A; end</code>. Enter <code>B</code> to see that reference to an undefined constant raises an exception."}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549440463, "post_id": 54549042, "comment_id": 95898287, "body": "The OP is not interested in whether <code>local1</code> or <code>@@a</code> is defined. The OP wants to know the inventory of the defined variables."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1549441677, "post_id": 54549042, "comment_id": 95898744, "body": "I don&#39;t think so, vide: &#39;In an interview, the interviewer asked this what are the default values of ruby variables?&#39;"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1549441851, "post_id": 54549042, "comment_id": 95898815, "body": "@mrzasa yes, you can be little clear with scope &amp; default value for local variable with edit"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1549442354, "post_id": 54549042, "comment_id": 95899049, "body": "@ray, you mean the case described in question comment? (hoisting a var defined in a block that is never executed)"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1549445905, "post_id": 54549042, "comment_id": 95900944, "body": "@mrzasa no, it was general suggestion to make answer to elaborate better :)"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 2, "last_activity_date": 1549440404, "creation_date": 1549440404, "answer_id": 54549042, "question_id": 54548952, "link": "https://stackoverflow.com/questions/54548952/default-values-of-ruby-variables/54549042#54549042", "title": "Default values of Ruby variables", "body": "<p>You assign a local variable value at first assignment:</p>\n\n<pre><code>local = 1\nlocal1 + local # NameError: undefined local variable or method `local1' for main:Object\n</code></pre>\n\n<p>Class variables are similar, if you use them without initialization, you get an error:</p>\n\n<pre><code>class A\n  @@a\nend  \n# NameError: uninitialized class variable @@a in A\n</code></pre>\n\n<p>Class instance variables and class variables are <code>nil</code> by default:</p>\n\n<pre><code>class A\n  def self.a\n    @a\n  end  \n  def a\n    @a\n  end  \nend  \n\n&gt; A.a\n#=&gt; nil\n&gt; A.new.a\n#=&gt; nil\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1550701453, "post_id": 54553395, "comment_id": 96370318, "body": "Whether warning messages are displayed depends on the value of <a href=\"https://mislav.net/2011/06/ruby-verbose-mode/\" rel=\"nofollow noreferrer\">$VERBOSE</a>."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1549455149, "creation_date": 1549455149, "answer_id": 54553395, "question_id": 54548952, "link": "https://stackoverflow.com/questions/54548952/default-values-of-ruby-variables/54553395#54553395", "title": "Default values of Ruby variables", "body": "<p>This is trivial to test yourself:</p>\n\n<ul>\n<li><p>undefined global variables evaluate to <code>nil</code> and generate a warning:</p>\n\n<pre><code>defined? $foo\n#=&gt; nil\n\n$foo\n#=&gt; nil\n# warning: global variable `$foo' not initialized\n</code></pre></li>\n<li><p>undefined local variables <code>raise</code> a <code>NameError</code>:</p>\n\n<pre><code>defined? foo\n#=&gt; nil\n\nfoo\n# undefined local variable or method `foo' for main:Object (NameError)\n</code></pre></li>\n<li><p>defined but not initialized local variables evaluate to <code>nil</code>:</p>\n\n<pre><code>defined? foo\n#=&gt; nil\n\nif false then foo = 42 end\n\ndefined? foo\n#=&gt; 'local-variable'\n\nfoo\n#=&gt; nil\n</code></pre></li>\n<li><p>undefined instance variables evaluate to <code>nil</code> and generate a warning:</p>\n\n<pre><code>defined? @foo\n#=&gt; nil\n\n@foo\n#=&gt; nil\n# warning: instance variable `@foo' not initialized\n</code></pre></li>\n<li><p>undefined class variables <code>raise</code> a <code>NameError</code>:</p>\n\n<pre><code>defined? @@foo\n#=&gt; nil\n\n@@foo\n# uninitialized class variable @@foo (NameError)\n</code></pre></li>\n<li><p>undefined constants <code>raise</code> a <code>NameError</code>:</p>\n\n<pre><code>defined? FOO\n#=&gt; nil\n\nFOO\n# uninitialized constant FOO (NameError)\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1473, "favorite_count": 2, "answer_count": 2, "score": -2, "last_activity_date": 1549455149, "creation_date": 1549440030, "last_edit_date": 1549440259, "question_id": 54548952, "link": "https://stackoverflow.com/questions/54548952/default-values-of-ruby-variables", "title": "Default values of Ruby variables", "body": "<p>I need to know the default values of variables in ruby.</p>\n\n<pre><code>Global Variables: nil\nInstance Variables: ? \nClass Variables: ?\nLocal Variables: ?\n</code></pre>\n\n<p>I looked <a href=\"https://www.geeksforgeeks.org/ruby-types-of-variables/\" rel=\"nofollow noreferrer\">here</a>, but all I could find is that global variables have a nil value.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http-headers", "turbolinks"], "comments": [{"owner": {"reputation": 4755, "user_id": 400277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea12da4fb5d06d2e5da1c53b272f5ccd?s=128&d=identicon&r=PG", "display_name": "Nowhere man", "link": "https://stackoverflow.com/users/400277/nowhere-man"}, "edited": false, "score": 0, "creation_date": 1549456630, "post_id": 54548831, "comment_id": 95907417, "body": "You show far too few informations for anyone to be able to give you a reasonable answer. Depending on your setup, you might try to remove turbolinks to see if it comes from it. Also, is there anything not working because of this issue?"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 4755, "user_id": 400277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea12da4fb5d06d2e5da1c53b272f5ccd?s=128&d=identicon&r=PG", "display_name": "Nowhere man", "link": "https://stackoverflow.com/users/400277/nowhere-man"}, "edited": false, "score": 0, "creation_date": 1549456978, "post_id": 54548831, "comment_id": 95907625, "body": "yes I can&#39;t access webp support headers"}, {"owner": {"reputation": 4755, "user_id": 400277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea12da4fb5d06d2e5da1c53b272f5ccd?s=128&d=identicon&r=PG", "display_name": "Nowhere man", "link": "https://stackoverflow.com/users/400277/nowhere-man"}, "edited": false, "score": 0, "creation_date": 1549458709, "post_id": 54548831, "comment_id": 95908642, "body": "What is the actual action you are trying to do that fails? Are you trying to download an image, for example? What is the absence of those headers making impossible?"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 4755, "user_id": 400277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea12da4fb5d06d2e5da1c53b272f5ccd?s=128&d=identicon&r=PG", "display_name": "Nowhere man", "link": "https://stackoverflow.com/users/400277/nowhere-man"}, "edited": false, "score": 0, "creation_date": 1549458864, "post_id": 54548831, "comment_id": 95908735, "body": "No basically I am trying to check either browser supports webp image format or not...."}, {"owner": {"reputation": 4755, "user_id": 400277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea12da4fb5d06d2e5da1c53b272f5ccd?s=128&d=identicon&r=PG", "display_name": "Nowhere man", "link": "https://stackoverflow.com/users/400277/nowhere-man"}, "edited": false, "score": 0, "creation_date": 1549551684, "post_id": 54548831, "comment_id": 95949963, "body": "Try to actually serve an image and include it as an image in an HTML page. If turbolinks has an effect on requests for HTML, it should not have an effect on requests that the browser does to fetch images."}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 6184942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2838de0e52136959eb306c64d02d4a69?s=128&d=identicon&r=PG&f=1", "display_name": "luis-fdz", "link": "https://stackoverflow.com/users/6184942/luis-fdz"}, "is_accepted": false, "score": 0, "last_activity_date": 1552214285, "creation_date": 1552214285, "answer_id": 55086804, "question_id": 54548831, "link": "https://stackoverflow.com/questions/54548831/rails-request-headers-data-not-updating-without-refresh/55086804#55086804", "title": "Rails request.headers data not updating without refresh", "body": "<p>It's a turbolinks issue. By default, the turbolinks' XMLHttpRequest, only send the headers \"text/html, application/xhtml+xml\", but you can send the \"image/webp\" header by capturing the request-start event like this:</p>\n\n<pre><code>document.addEventListener(\"turbolinks:request-start\", function(event) {\n  var xhr = event.data.xhr\n  xhr.setRequestHeader(\"Accept\", \"image/webp\")\n})\n</code></pre>\n\n<p>The question is how to know from javascript whether or not the browser accepts webp images to send the \"image/webp\" header to the server.</p>\n\n<p>You can use the Modernize library or a custom function that guess if webp is available when trying to decode a small webp image like described here: <a href=\"https://developers.google.com/speed/webp/faq\" rel=\"nofollow noreferrer\">https://developers.google.com/speed/webp/faq</a>. However, these solutions add a certain overhead that precludes the benefit of the fastest load time of webp images. </p>\n\n<p>Maybe, the most efficient solution is to create a boolean cookie in the server side to store whether or not webp images are accepted. The cookie is stored with the first browser GET call to the server. In subsequent turbolinks calls you can check this cookie in your javascript code:</p>\n\n<pre><code>document.addEventListener(\"turbolinks:request-start\", function(event) {\n  browserAcceptsWebp = document.cookie.includes('webp_available=true');\n  if (browserAcceptsWebp) {\n    var xhr = event.data.xhr;\n    xhr.setRequestHeader(\"Accept\", \"image/webp\");\n  }\n});\n</code></pre>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552214285, "creation_date": 1549439361, "last_edit_date": 1549439926, "question_id": 54548831, "link": "https://stackoverflow.com/questions/54548831/rails-request-headers-data-not-updating-without-refresh", "title": "Rails request.headers data not updating without refresh", "body": "<p>When I hit site for first time, then results of <code>request.headers[HTTP_ACCEPT]</code> is <code>\"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\"</code></p>\n\n<p>but between internal links requests it shows <code>text/html, application/xhtml+xml</code>\nuntil I hard refresh the page.</p>\n\n<p>Is it due to turbolinks or any other issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "ruby-on-rails-3.2"], "comments": [{"owner": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "edited": false, "score": 0, "creation_date": 1549437139, "post_id": 54548226, "comment_id": 95896870, "body": "why do you want to do that?"}, {"owner": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "edited": false, "score": 0, "creation_date": 1549437151, "post_id": 54548226, "comment_id": 95896876, "body": "what if another user or when you deploy you might find nil values with activated_at column."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "edited": false, "score": 1, "creation_date": 1549437239, "post_id": 54548226, "comment_id": 95896910, "body": "@Nithin He set it first but now his requirement is changed or he got corrected with required logic so he want to know most elegant way to do it."}], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 2, "last_activity_date": 1549437173, "creation_date": 1549437173, "answer_id": 54548363, "question_id": 54548226, "link": "https://stackoverflow.com/questions/54548226/how-to-remove-a-script-from-a-existing-migration-file-rails/54548363#54548363", "title": "How to remove a script from a existing migration file rails", "body": "<p>You can just remove code and commit in master branch.</p>\n\n<p>For systems on which this migration is run, you can run <a href=\"http://For%20systems%20on%20which%20this%20migration%20is%20run\" rel=\"nofollow noreferrer\">rake task</a> to run whatever you want to rollback (i.e. set <code>activated_on</code> to nil). Or you can run from rails console to set it nil.</p>\n\n<p>And for new systems where you will clone and create database &amp; run migration it will not get in touch with script as you removed code. </p>\n"}, {"tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 0, "last_activity_date": 1549448213, "creation_date": 1549448213, "answer_id": 54551138, "question_id": 54548226, "link": "https://stackoverflow.com/questions/54548226/how-to-remove-a-script-from-a-existing-migration-file-rails/54551138#54551138", "title": "How to remove a script from a existing migration file rails", "body": "<p>My answer is a little more nuanced. In short you ask: can you change a migration that has already run? In general I would advice against it. In your case it also depends what has to happen with the <code>activated_at</code> field, I can imagine it would only be set once a user is \"activated\" (whatever that might mean in your application's context). So in that case: setting it to <code>updated_at</code> is wrong and would have to be \"un-set\"? Or set in a different way? So that would require a migration anyway. Or, also possible: the migration has not yet run on e.g. your production server and running the migration like this would be very hard to undo in a good way (well in this case it would be simple --set activated-at to nil again), then by all means adapt the migration, commit and upon deployment it will run a <em>better</em> migration. But ... you will have to manually restore/fix the situation on all machines the migration <em>did</em> run (your machine, your colleguaes, staging-testing platforms? ...)</p>\n\n<p>So to help with your decision-process </p>\n\n<ul>\n<li>if you work in a team, and team-mates have checked out your code and run migrations, use a new migration to fix it</li>\n<li>if you have deployed to any server (testing/staging/production) that you would otherwise have to fix, add a new migration to fix it </li>\n<li>if you have not pushed your code to <code>master</code> (all code has remained local), adapt migrations at will :P    </li>\n</ul>\n\n<p>As an aside: I have seen developers who are so eager to only have \"perfect\" code in git, they will use all options git offers to clean up code: go back in history, squash commits, and I have to admit the result is very clear. That is very tempting and understandable, but imho we loose information (how did we get here and why?). Likewise it is tempting to have clean and minimal migrations, but personally I believe there is no shame that git and your migrations \"show\" the growing understanding of the problem area. I think it is one of the reasons it is called \"developing\": building software is a very iterative process and it is continually changing, and your code (git/history) and migrations are allowed to reflect that. My apologies if this last part is too meta and subjective.</p>\n"}], "owner": {"reputation": 334, "user_id": 4762084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1223bab6d5d939bd57d7bb6ccc898bf0?s=128&d=identicon&r=PG&f=1", "display_name": "Dom", "link": "https://stackoverflow.com/users/4762084/dom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 54548363, "answer_count": 2, "score": 0, "last_activity_date": 1549448213, "creation_date": 1549436521, "last_edit_date": 1549437611, "question_id": 54548226, "link": "https://stackoverflow.com/questions/54548226/how-to-remove-a-script-from-a-existing-migration-file-rails", "title": "How to remove a script from a existing migration file rails", "body": "<p>I pulled new changes from git, in this new changes there is a migration file,</p>\n\n<pre><code>def change\n  add_column :users, :activated_at, :datetime\n  User.all.each do |user|\n   user.update(activated_at: user.updated_at)\n end    \nend\n</code></pre>\n\n<p>now normally if I want to undo a migration i.e. remove a column say activated_at I have to run another migration to do so which is fine</p>\n\n<p>but if I just want to remove the script i.e. <code>user.update(activated_at: user.updated_at)</code>, do I have to create another migration or do I just remove the script from the migration.</p>\n\n<p>note: I don't want to remove the activated_at column, I just want to remove the script</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "session", "devise"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 1, "creation_date": 1549432665, "post_id": 54547220, "comment_id": 95895209, "body": "I think <code>current_user</code> is set once for a request"}, {"owner": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "edited": false, "score": 0, "creation_date": 1549435738, "post_id": 54547220, "comment_id": 95896333, "body": "why are you trying to achieve this through a debugger?"}, {"owner": {"reputation": 1331, "user_id": 6359753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73961b0d8661795d0b3f8300b633124c?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Yang", "link": "https://stackoverflow.com/users/6359753/henry-yang"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1549492345, "post_id": 54547220, "comment_id": 95926025, "body": "@Lenin Raj Rajasekaran That&#39;s good to know, do you know if there&#39;s documentation somewhere I can look into?"}, {"owner": {"reputation": 1331, "user_id": 6359753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73961b0d8661795d0b3f8300b633124c?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Yang", "link": "https://stackoverflow.com/users/6359753/henry-yang"}, "reply_to_user": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "edited": false, "score": 0, "creation_date": 1549492394, "post_id": 54547220, "comment_id": 95926042, "body": "@Nithin I work through it step by step so I can inspect if things match my expectation"}], "answers": [{"tags": [], "owner": {"reputation": 1331, "user_id": 6359753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73961b0d8661795d0b3f8300b633124c?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Yang", "link": "https://stackoverflow.com/users/6359753/henry-yang"}, "is_accepted": true, "score": 0, "last_activity_date": 1565575875, "creation_date": 1565575875, "answer_id": 57454968, "question_id": 54547220, "link": "https://stackoverflow.com/questions/54547220/why-isnt-the-effect-of-devise-sign-in-method-immediate/57454968#57454968", "title": "Why isn&#39;t the effect of devise sign_in method immediate?", "body": "<p><a href=\"https://github.com/plataformatec/devise/blob/715192a7709a4c02127afb067e66230061b82cf2/lib/devise/controllers/sign_in_out.rb#L50\" rel=\"nofollow noreferrer\">Devise source code line 50</a> which is within the <code>sign_in</code> method says:</p>\n\n<blockquote>\n  <p># Do nothing. User already signed in and we are not forcing it.</p>\n</blockquote>\n\n<p>so I think the reason is because Devise doesn't sign in a new user if we already signed in as a user (unless we force it).</p>\n"}], "owner": {"reputation": 1331, "user_id": 6359753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73961b0d8661795d0b3f8300b633124c?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Yang", "link": "https://stackoverflow.com/users/6359753/henry-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 57454968, "answer_count": 1, "score": 1, "last_activity_date": 1565575875, "creation_date": 1549431613, "last_edit_date": 1565575185, "question_id": 54547220, "link": "https://stackoverflow.com/questions/54547220/why-isnt-the-effect-of-devise-sign-in-method-immediate", "title": "Why isn&#39;t the effect of devise sign_in method immediate?", "body": "<p>I try to sign in as other user using <code>sign_in(user)</code></p>\n\n<pre><code>(byebug) user = User.find(2)\n# return me the record of user with ID=2\n(byebug) current_user.id\n1\n(byebug) sign_in(user)\n# return me the record of user with ID=2\n(byebug) current_user.id\n1 # I expect this to be 2!!\n</code></pre>\n\n<p>Can anyone explain why?</p>\n\n<p>Note: strangely, I found a new thing called <code>session[\"warden.user.user.key\"].first.first</code> which does what I want, but it doesn't seem like the right and clean way to do.</p>\n"}, {"tags": ["ruby", "postgresql", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 2, "last_activity_date": 1549432092, "creation_date": 1549432092, "answer_id": 54547313, "question_id": 54547184, "link": "https://stackoverflow.com/questions/54547184/error-installing-pg-setting-up-postgresql-with-activerecordwithout-rails/54547313#54547313", "title": "Error installing pg - Setting up postgresql with activerecord(without rails)", "body": "<p>Install first install <code>postgreSQL</code> dev package as below,</p>\n\n<pre><code>sudo apt-get install libpq-dev\n</code></pre>\n\n<p>or try with,</p>\n\n<pre><code>gem install pg  --   --with-pg-lib=/usr/lib   \n</code></pre>\n\n<p>referring <a href=\"https://stackoverflow.com/q/3116015/10522579\">this post</a></p>\n\n<p>Then most common way to use <code>active_record</code> along with <code>postgres</code> is as below,</p>\n\n<pre><code>require 'active_record'\nrequire 'pg'\n\nActiveRecord::Base.establish_connection(\n # database schema i.e. database, encoding, username, password etc.\n)\n</code></pre>\n\n<p>Then you can define class as below,</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\nend\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10062681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e93fa197d322f71956b14516217fe561?s=128&d=identicon&r=PG&f=1", "display_name": "Kenkuts", "link": "https://stackoverflow.com/users/10062681/kenkuts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1624, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1549432150, "creation_date": 1549431408, "last_edit_date": 1549432150, "question_id": 54547184, "link": "https://stackoverflow.com/questions/54547184/error-installing-pg-setting-up-postgresql-with-activerecordwithout-rails", "title": "Error installing pg - Setting up postgresql with activerecord(without rails)", "body": "<p>Need help setting up my database application with activerecord without rails. I have followed the documentation so far and I am encountering an error in regards to installing the <code>pg gem</code>. This is inside of my environment.rb.</p>\n\n<pre><code>require 'bundler/setup'\nBundler.require(:default, ENV['SINATRA_ENV'])\nrequire 'active_record'\n\nActiveRecord::Base.establish_connection(\"postgres://localhost/development\")\nrequire_all 'app'\n</code></pre>\n\n<p>Every time I install postgres on the CLI with <code>sudo ARCHFLAGS=\"-arch x86_64\" gem install pg</code>. I get an error of:</p>\n\n<pre><code>Building native extensions. This could take a while...\nERROR:  Error installing pg:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /Users/kenkuts/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/pg-1.1.4/ext\n/Users/kenkuts/.rvm/rubies/ruby-2.5.3/bin/ruby -r ./siteconf20190206-73835-1tfhfez.rb extconf.rb\nchecking for pg_config... no\nNo pg_config... trying anyway. If building fails, please try again with\n --with-pg-config=/path/to/pg_config\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/kenkuts/.rvm/rubies/ruby-2.5.3/bin/$(RUBY_BASE_NAME)\n    --with-pg\n    --without-pg\n    --enable-windows-cross\n    --disable-windows-cross\n    --with-pg-config\n    --without-pg-config\n    --with-pg_config\n    --without-pg_config\n    --with-pg-dir\n    --without-pg-dir\n    --with-pg-include\n    --without-pg-include=${pg-dir}/include\n    --with-pg-lib\n    --without-pg-lib=${pg-dir}/lib\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /Users/kenkuts/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/extensions/x86_64-darwin-18/2.5.0/pg-1.1.4/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /Users/kenkuts/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/pg-1.1.4 for inspection.\nResults logged to /Users/kenkuts/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/extensions/x86_64-darwin-18/2.5.0/pg-1.1.4/gem_make.out\n</code></pre>\n"}, {"tags": ["html", "ruby"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1549429342, "post_id": 54546858, "comment_id": 95894189, "body": "<code>Nokogiri::HTML(snippet).text.to_i</code>, assuming your &quot;snippet&quot; is the document."}, {"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1549429452, "post_id": 54546858, "comment_id": 95894226, "body": "Well the snippet is just part of the entire HTML document. I save the document like this. html_doc = Nokogiri::HTML(params[:html]). How do I get that number from the entire HTML document?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1549429676, "post_id": 54546858, "comment_id": 95894300, "body": "Then <code>node.text.to_i</code>, where <code>node</code> is the <code>&lt;td&gt;</code> node. Without knowing the rest of the document, we can&#39;t tell you how to get to it (except trivially &quot;use <code>#at_css</code> or <code>#at_xpath</code> methods)."}, {"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1549430212, "post_id": 54546858, "comment_id": 95894470, "body": "How would I be able to figure out the exact line of code. My HTML is fairly large."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1549431121, "post_id": 54546858, "comment_id": 95894705, "body": "By identifying how that element differs from any other (in position, structure or content), then specifying an XPath or CSS selector to fetch it. I doubt it is the only element in your document with the class <code>m_7818752582546518432m_-7154585397242854273small-12</code> (or any of the listed classes), so only that is not enough to identify it. It&#39;s also probably not the only element that is vertical-aligned to <code>top</code>, or aligned to <code>left</code>. Now, if you know it&#39;s e.g. the third <code>&lt;td&gt;</code> in a <code>&lt;table&gt;</code> with a certain ID, you can start doing something about it."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1549431344, "post_id": 54546858, "comment_id": 95894775, "body": "<i>Sidenote:</i> \u201cPlease code the solution for me for free\u201d is not an allowed type of questions on SO. Please show your effort and where you got stuck. Downvoted until a question is corrected."}, {"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1549431689, "post_id": 54546858, "comment_id": 95894866, "body": "@Amadan There are a bunch of nested tables, tbodies, td, and tr. How would I go about figuring out the exact way to get the number I want. Thanks for your help."}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1549432606, "post_id": 54546858, "comment_id": 95895190, "body": "It&#39;s impossible to answer your question because nobody knows the structure of your document. @Amadan has shown you main principles"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1549437648, "post_id": 54546858, "comment_id": 95897070, "body": "I&#39;ll consider answering your question as soon as you explain to me satisfactorily how I can get to my drumming practice the fastest (without knowing where I am, where my drumming practice is, or downloading any maps of the city I live in). What I can tell you is, there&#39;s a bunch of streets, and also train lines."}], "answers": [{"tags": [], "owner": {"reputation": 520, "user_id": 6507755, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/IUwxM.png?s=128&g=1", "display_name": "2017kamb", "link": "https://stackoverflow.com/users/6507755/2017kamb"}, "is_accepted": false, "score": 0, "last_activity_date": 1549450999, "creation_date": 1549450999, "answer_id": 54552077, "question_id": 54546858, "link": "https://stackoverflow.com/questions/54546858/using-nogokiri-to-parse-html-in-ruby/54552077#54552077", "title": "Using Nogokiri to parse HTML in Ruby", "body": "<p>html file  = /home/raj/test.html</p>\n\n<pre><code>&lt;td class=\"m_7818752582546518432m_-7154585397242854273small-12 m_7818752582546518432m_-7154585397242854273large-3 m_7818752582546518432m_-7154585397242854273text-body\" style=\"border-collapse:collapse!important;color:#0a0a0a;font-family:'Roboto-Regular',sans-serif;font-size:16px;font-weight:normal;letter-spacing:0;line-height:20px;margin:0;padding:0 8px;width:129px;word-wrap:break-word\" align=\"left\" valign=\"top\"&gt;\n    2882524\n  &lt;/td&gt;\n</code></pre>\n\n<p>Tried in irb of ruby version 2.6.1 as,</p>\n\n<pre><code>2.6.1 :026 &gt; require 'nokogiri'\n =&gt; true \n2.6.1 :027 &gt; doc = Nokogiri::HTML(File.open('/home/raj/test.html'))\n =&gt; #&lt;Nokogiri::HTML::Document:0x2ac37b6e06a4 name=\"document\" children=[#&lt;Nokogiri::XML::DTD:0x2ac37b6e02a8 name=\"html\"&gt;, #&lt;Nokogiri::XML::Element:0x2ac37b703d5c name=\"html\" children=[#&lt;Nokogiri::XML::Element:0x2ac37b703a28 name=\"body\" children=[#&lt;Nokogiri::XML::Element:0x2ac37b7037e4 name=\"td\" attributes=[#&lt;Nokogiri::XML::Attr:0x2ac37b70376c name=\"class\" value=\"m_7818752582546518432m_-7154585397242854273small-12 m_7818752582546518432m_-7154585397242854273large-3 m_7818752582546518432m_-7154585397242854273text-body\"&gt;, #&lt;Nokogiri::XML::Attr:0x2ac37b703758 name=\"style\" value=\"border-collapse:collapse!important;color:#0a0a0a;font-family:'Roboto-Regular',sans-serif;font-size:16px;font-weight:normal;letter-spacing:0;line-height:20px;margin:0;padding:0 8px;width:129px;word-wrap:break-word\"&gt;, #&lt;Nokogiri::XML::Attr:0x2ac37b703744 name=\"align\" value=\"left\"&gt;, #&lt;Nokogiri::XML::Attr:0x2ac37b703730 name=\"valign\" value=\"top\"&gt;] children=[#&lt;Nokogiri::XML::Text:0x2ac37b7027b8 \"\\n    2882524\\n  \"&gt;]&gt;, #&lt;Nokogiri::XML::Text:0x2ac37b702484 \"\\n\"&gt;]&gt;]&gt;]&gt; \n\n\n2.6.1 :034 &gt; doc.text\n =&gt; \"\\n    2882524\\n  \\n\" \n2.6.1 :035 &gt; doc.text.strip\n =&gt; \"2882524\" \n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1549450999, "creation_date": 1549429115, "question_id": 54546858, "link": "https://stackoverflow.com/questions/54546858/using-nogokiri-to-parse-html-in-ruby", "title": "Using Nogokiri to parse HTML in Ruby", "body": "<p>I am trying to parse an HTML file using Nokogiri in Ruby. What would be the correct call to save the number 2882524 to a variable. Below is the HTML snippet where the number is.</p>\n\n<pre><code>&lt;td class=\"m_7818752582546518432m_-7154585397242854273small-12 m_7818752582546518432m_-7154585397242854273large-3 m_7818752582546518432m_-7154585397242854273text-body\" style=\"border-collapse:collapse!important;color:#0a0a0a;font-family:'Roboto-Regular',sans-serif;font-size:16px;font-weight:normal;letter-spacing:0;line-height:20px;margin:0;padding:0 8px;width:129px;word-wrap:break-word\" align=\"left\" valign=\"top\"&gt;\n    2882524\n  &lt;/td&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4480, "user_id": 259889, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aba1af6d6197093c880797a82e1bc2a2?s=128&d=identicon&r=PG", "display_name": "Sid", "link": "https://stackoverflow.com/users/259889/sid"}, "edited": false, "score": 0, "creation_date": 1549428951, "post_id": 54546817, "comment_id": 95894088, "body": "You may start from the <a href=\"https://www.openshot.org/cloud-api/\" rel=\"nofollow noreferrer\">openshot.org/cloud-api</a> page."}, {"owner": {"reputation": 4763, "user_id": 473923, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/VCdUV.jpg?s=128&g=1", "display_name": "David Cruwys", "link": "https://stackoverflow.com/users/473923/david-cruwys"}, "reply_to_user": {"reputation": 4480, "user_id": 259889, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aba1af6d6197093c880797a82e1bc2a2?s=128&d=identicon&r=PG", "display_name": "Sid", "link": "https://stackoverflow.com/users/259889/sid"}, "edited": false, "score": 0, "creation_date": 1549429805, "post_id": 54546817, "comment_id": 95894340, "body": "I have checked that and I can see how it would work from a remote cloud api, but I thought there was also a local library for doing local processing"}, {"owner": {"reputation": 4480, "user_id": 259889, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aba1af6d6197093c880797a82e1bc2a2?s=128&d=identicon&r=PG", "display_name": "Sid", "link": "https://stackoverflow.com/users/259889/sid"}, "edited": false, "score": 0, "creation_date": 1549432432, "post_id": 54546817, "comment_id": 95895138, "body": "They provide a downloadble editor."}, {"owner": {"reputation": 415, "user_id": 1242095, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f02337d850f466e22baf282d1303942c?s=128&d=identicon&r=PG", "display_name": "Nate L", "link": "https://stackoverflow.com/users/1242095/nate-l"}, "edited": false, "score": 1, "creation_date": 1550124939, "post_id": 54546817, "comment_id": 96156762, "body": "Same, I&#39;m looking for the python bindings. I might shop around for another video-editing library. This is a bad sign that there&#39;s so little documentation"}], "owner": {"reputation": 4763, "user_id": 473923, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/VCdUV.jpg?s=128&g=1", "display_name": "David Cruwys", "link": "https://stackoverflow.com/users/473923/david-cruwys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1549428810, "creation_date": 1549428810, "question_id": 54546817, "link": "https://stackoverflow.com/questions/54546817/how-to-use-open-shot-video-api-with-ruby", "title": "How to use Open Shot video API with ruby", "body": "<p>I have been looking at the <a href=\"https://github.com/OpenShot/libopenshot\" rel=\"nofollow noreferrer\">LibOpenShot</a> for some video creation using Rails.</p>\n\n<p>The repository states that they have bindings for Ruby, but I cannot find any reference to ruby, e.g. a Gem</p>\n\n<p>Does anyone know how to use OpenShot with Ruby?</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 3, "creation_date": 1549427490, "post_id": 54546571, "comment_id": 95893728, "body": "Unrelated, but this isn&#39;t very Ruby-like code. Hopefully your instructor isn&#39;t teaching you Ruby like it&#39;s C or older Java. In any case-debug. Step through the code. Print out values. Check your assumptions."}, {"owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1549428534, "post_id": 54546571, "comment_id": 95893992, "body": "To expand on  what @DaveNewton said. Using a while loop with a counter is pretty much never the right thing to do in ruby. Instead use <code>original_string.each</code> Look up ruby each to get an idea how it works."}, {"owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "edited": false, "score": 0, "creation_date": 1549428687, "post_id": 54546571, "comment_id": 95894041, "body": "What do you mean you are unble to concatenate? Does it give you an error? If so what error? Does it give you the wrong value? Write out what you expect to happen and what is currently happening and people will be able to help you better."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1549429597, "post_id": 54546571, "comment_id": 95894270, "body": "Your hash does not have the key <code>&quot;h&quot;</code>, so hash lookup resuls in <code>nil</code>, which can&#39;t be concatenated."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1549438755, "post_id": 54546571, "comment_id": 95897549, "body": "&quot;I hava a problem on line 24&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 19, "user_id": 10847823, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H6R2LA1hlcw/AAAAAAAAAAI/AAAAAAAAHF4/BKltrylx720/photo.jpg?sz=128", "display_name": "MercilessA", "link": "https://stackoverflow.com/users/10847823/mercilessa"}, "edited": false, "score": 0, "creation_date": 1549515867, "post_id": 54546571, "comment_id": 95931410, "body": "Sorry, I am new to posting to stack overflow. I am getting a &quot;Can&#39;t convert type nil to string (Typerror)&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1549431485, "post_id": 54546995, "comment_id": 95894811, "body": "This is good. I think one small improvement; If you add a mapping of blank =&gt; blank in the encryption hash, you can drop the if statement. I wonder if we could do a <code>map</code> vs. the <code>for</code> as well..."}, {"owner": {"reputation": 630, "user_id": 5763672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ca5c235400320ab800200c6677574?s=128&d=identicon&r=PG", "display_name": "Sebastian Scholl", "link": "https://stackoverflow.com/users/5763672/sebastian-scholl"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1549432781, "post_id": 54546995, "comment_id": 95895241, "body": "That makes sense. It would be an improvement. The issue with map would be it using up more memory. Ie... splitting the string into an array and the creating a variable for each element during the iteration. Using the for loop here is just faster."}, {"owner": {"reputation": 630, "user_id": 5763672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ca5c235400320ab800200c6677574?s=128&d=identicon&r=PG", "display_name": "Sebastian Scholl", "link": "https://stackoverflow.com/users/5763672/sebastian-scholl"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1549433154, "post_id": 54546995, "comment_id": 95895360, "body": "If someone really didn&#39;t like the for loop, I&#39;d suggest using inject/reduce instead of map."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1549447622, "post_id": 54546995, "comment_id": 95901916, "body": "<code>(0...message.length).each do |index|</code>? <code>message.each_char { |m| encrypted_message &lt;&lt; encryption_hash[m] }</code>? <code>encrypted_message = message.gsub(&#47;.&#47;) { |chr| encryption_hash[chr] }</code>?"}, {"owner": {"reputation": 19, "user_id": 10847823, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H6R2LA1hlcw/AAAAAAAAAAI/AAAAAAAAHF4/BKltrylx720/photo.jpg?sz=128", "display_name": "MercilessA", "link": "https://stackoverflow.com/users/10847823/mercilessa"}, "edited": false, "score": 0, "creation_date": 1549516044, "post_id": 54546995, "comment_id": 95931460, "body": "Thank you! I am not sure how to upvote this answer but that makes sense. I appreciate all of you for helping me find my solution!"}], "tags": [], "owner": {"reputation": 630, "user_id": 5763672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ca5c235400320ab800200c6677574?s=128&d=identicon&r=PG", "display_name": "Sebastian Scholl", "link": "https://stackoverflow.com/users/5763672/sebastian-scholl"}, "is_accepted": true, "score": 2, "last_activity_date": 1549471252, "last_edit_date": 1592644375, "creation_date": 1549429981, "answer_id": 54546995, "question_id": 54546571, "link": "https://stackoverflow.com/questions/54546571/how-to-concatenate-a-hash-value-and-a-string/54546995#54546995", "title": "How to concatenate a hash value and a string", "body": "<p>so this should help get you on the right track. I'm not 100% sure on the desired outcome of your project, however here is a quick original vs. re-write and explanation of what was happening to you.</p>\n<h3>Original (annotated)</h3>\n<pre><code>original_string = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;\ncipher_key = &quot;honeyL&quot;\nmessage_string = &quot;hEllo world&quot;\n\n# Using the delete! method is actually altering the original_string in memory. You want to use the plane delete method.\ndeleted_string = original_string.delete!(cipher_key)\n\naltered_string = cipher_key + deleted_string\n\n# This is a fair amount of code for a simple mapping\nencryption_hash = Hash.new\n\ni = 0\nwhile(i &lt; original_string.length) \n  encryption_hash [original_string[i]] = altered_string[i].to_s\n  i += 1\nend\n\nencrypted_message = &quot;&quot;\ncount = 0\n\n# Because you deleted the message characters from the original_string BEFORE creating you encryption_hash, you're getting null value on the look up.\nwhile(count &lt; message_string.length)\n  if(message_string[count] == &quot; &quot;)\n    encrypted_message &lt;&lt; message_string[count]\n  else\n    encrypted_message &lt;&lt; encryption_hash[message_string[count]] \n  end\n  count += 1\nend\n\nputs encrypted_message\n</code></pre>\n<h3>Rewrite</h3>\n<pre><code>base_str = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'\nmessage = 'hEllo world'\nkey = 'honeyL'\n\n# Using delete instead of delete!\naltered_str = key + base_str.delete(key)\n\n# Zip together characters and create hash from grouped array\nencryption_hash = Hash[base_str.chars.zip(altered_str.chars)]\nencryption_hash[' '] = ' '\n\nencrypted_message = ''\n\n# Loop through non-inclusive range concatenating encrypted values to string\nfor i in 0...message.length\n  encrypted_message &lt;&lt; encryption_hash[message[i]]\nend\n\nputs encrypted_message\n</code></pre>\n<h3>UPDATE</h3>\n<p>I went through some of the suggested iterators to see which performed best and all were relatively the same (using an 8,145,000 character message):</p>\n<pre><code>  encrypted_message = message.gsub(/./) { |chr| encryption_hash[chr] }\n  # {&quot;ruby&quot;:&quot;2.3.0&quot;,&quot;elapsed_time&quot;:3.24,&quot;garbage_collection&quot;:&quot;on&quot;,&quot;memory_used&quot;:&quot;8 MB&quot;,&quot;garbage_collection_count&quot;:456}\n\n  message.each_char { |m| encrypted_message &lt;&lt; encryption_hash[m] }\n  # {&quot;ruby&quot;:&quot;2.3.0&quot;,&quot;elapsed_time&quot;:2.06,&quot;garbage_collection&quot;:&quot;on&quot;,&quot;memory_used&quot;:&quot;8 MB&quot;,&quot;garbage_collection_count&quot;:456}\n\n  (0...message.length).each { |i| encrypted_message &lt;&lt; encryption_hash[message[i]]  }\n  # {&quot;ruby&quot;:&quot;2.3.0&quot;,&quot;elapsed_time&quot;:2.21,&quot;garbage_collection&quot;:&quot;on&quot;,&quot;memory_used&quot;:&quot;8 MB&quot;,&quot;garbage_collection_count&quot;:456}\n\n  for i in 0...message.length\n    encrypted_message &lt;&lt; encryption_hash[message[i]]\n  end\n  # {&quot;ruby&quot;:&quot;2.3.0&quot;,&quot;elapsed_time&quot;:2.21,&quot;garbage_collection&quot;:&quot;on&quot;,&quot;memory_used&quot;:&quot;8 MB&quot;,&quot;garbage_collection_count&quot;:456}\n</code></pre>\n<p>That said, I found out that <code>gsub</code> can take a hash as its second parameter for substitution mappings on matched characters. This performed right in the same ballpark.</p>\n<pre><code>  message.gsub!(/[a-zA-Z]/, encryption_hash)\n  # {&quot;ruby&quot;:&quot;2.3.0&quot;,&quot;elapsed_time&quot;:2.45,&quot;garbage_collection&quot;:&quot;on&quot;,&quot;memory_used&quot;:&quot;8 MB&quot;,&quot;garbage_collection_count&quot;:388}\n</code></pre>\n<p>At the end of the day, I think this is the best solution. The reason is that it does NOT require the original string to be pre-formatted, as well as doesn't lose any unmapped values. For example, in the original answers, any punctuation marks or numbers would be omitted and lost. With this <code>gsub</code> approach, you can only encrypt the character sets you to want to encrypt, leaving the rest unchanged.</p>\n<p>This simplifies the solution to:</p>\n<pre><code>base_str = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'\nmessage = 'hEllo world'\nkey = 'honeyL'\n\naltered_str = key + base_str.delete(key)\n\nencryption_hash = Hash[base_str.chars.zip(altered_str.chars)]\n\nmessage.gsub!(/[a-zA-Z]/, encryption_hash)\n\nputs message\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 1, "last_activity_date": 1549430907, "creation_date": 1549430907, "answer_id": 54547129, "question_id": 54546571, "link": "https://stackoverflow.com/questions/54546571/how-to-concatenate-a-hash-value-and-a-string/54547129#54547129", "title": "How to concatenate a hash value and a string", "body": "<p>You're getting the error on this line:</p>\n\n<pre><code>encrypted_message &lt;&lt; encryption_hash[message_string[count]] \n</code></pre>\n\n<p>Because <code>message_string[count]</code> returns <code>h</code> (from your <code>hEllo world</code>, but your <code>encryption_hash</code> is a Hash without an <code>h</code> key. Nor does it have <code>honeyL</code> characters in it.</p>\n\n<p>When you called <code>original_string.delete!(cipher_key)</code>, the <code>delete!</code> mutated the <code>original_string</code>, removing the 6 characters from your <code>cipher_key</code></p>\n\n<p>The reason swapping original string for message string works:</p>\n\n<pre><code>pry &gt;&gt; original_string\n=&gt; \"abcdfgijklmpqrstuvwxzABCDEFGHIJKMNOPQRSTUVWXYZ\"\npry &gt;&gt; message_string\n=&gt; \"hEllo world\"\n</code></pre>\n\n<p>In your example, <code>count</code> is 0 (you're on your first iteration), so it's looking for the 0 index of it. The 0 index of <code>original_string</code> is <code>a</code>, which IS present in your <code>encryption_hash</code>. The 0 index of <code>message_string</code> is <code>h</code>, which IS NOT present in your <code>encryption_hash</code>.</p>\n\n<p>I'm not sure what a solution might be, because I'm not sure of the desired outcome. But that's where/why it's breaking. To debug it, you can try <code>gem install pry pry-byebug</code>, then at the top of your ruby file, add:</p>\n\n<pre><code>require 'pry'\nrequire 'pry-byebug\n</code></pre>\n\n<p>Then, on a new line after your <code>else</code> statement, add <code>binding.pry</code>. Run your script and it will \"stop\" on that line. You can inspect all the variables at that point using <code>puts</code>. </p>\n\n<p>Use <code>exit</code> to quit pry, and use <code>whereami</code> to reset the view of where you were stopped in the code. You can also use <code>play -l &lt;line number&gt;</code> to evaluate a line.</p>\n\n<p><a href=\"https://i.stack.imgur.com/04TjE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/04TjE.png\" alt=\"pry example\"></a></p>\n"}], "owner": {"reputation": 19, "user_id": 10847823, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H6R2LA1hlcw/AAAAAAAAAAI/AAAAAAAAHF4/BKltrylx720/photo.jpg?sz=128", "display_name": "MercilessA", "link": "https://stackoverflow.com/users/10847823/mercilessa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "closed_date": 1549449475, "accepted_answer_id": 54546995, "answer_count": 2, "score": 0, "last_activity_date": 1549471252, "creation_date": 1549426888, "last_edit_date": 1549432240, "question_id": 54546571, "link": "https://stackoverflow.com/questions/54546571/how-to-concatenate-a-hash-value-and-a-string", "closed_reason": "Not suitable for this site", "title": "How to concatenate a hash value and a string", "body": "<p>I am trying to write my hash value into the variable as a concatenated string.</p>\n\n<pre><code>original_string = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\ncipher_key = \"honeyL\"\nmessage_string = \"hEllo world\"\n\ndeleted_string = original_string.delete!(cipher_key)\n\naltered_string = cipher_key + deleted_string\n\nencryption_hash = Hash.new\n\ni = 0\nwhile(i &lt; original_string.length) \n  encryption_hash [original_string[i]] = altered_string[i].to_s\n  i += 1\nend\n\nencrypted_message = \"\"\ncount = 0\n\nwhile(count &lt; message_string.length)\n  if(message_string[count] == \" \")\n    encrypted_message &lt;&lt; message_string[count]\n  else\n    encrypted_message &lt;&lt; encryption_hash[message_string[count]] \n  end\n  count += 1\nend\n\nputs encrypted_message\n</code></pre>\n\n<p>I have a problem on line 24, but I don't know why. If I use the <code>encryption_hash[original_string[count]]</code> instead of <code>encryption_hash[message_string[count]]</code>, then it would work. But I do not know why. Please explain.</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "edited": false, "score": 0, "creation_date": 1549422368, "post_id": 54546033, "comment_id": 95892716, "body": "Show what you have tried, and add more details, context please."}, {"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "reply_to_user": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "edited": false, "score": 0, "creation_date": 1549423052, "post_id": 54546033, "comment_id": 95892851, "body": "I just updated my post with what I tried"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 2, "creation_date": 1549423166, "post_id": 54546033, "comment_id": 95892874, "body": "If you put quotes inside the regex, it&#39;s going to match literal quotes. So it&#39;s looking for the string <code>&quot;Price $&quot;</code> (with quotes)."}, {"owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "edited": false, "score": 1, "creation_date": 1549423177, "post_id": 54546033, "comment_id": 95892877, "body": "That&#39;s not a correct regex, try search using keyword <code>regex</code> and learn something about it."}, {"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "edited": false, "score": 0, "creation_date": 1549423299, "post_id": 54546033, "comment_id": 95892899, "body": "Silvio, if I were to take out the quotes, this should work?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "edited": false, "score": 0, "creation_date": 1549441832, "post_id": 54547481, "comment_id": 95898804, "body": "Would it be possible for the 113 in the style to not be cut off?"}, {"owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "edited": false, "score": 0, "creation_date": 1549448608, "post_id": 54547481, "comment_id": 95902538, "body": "There are \\r at the end of the name captured variables. Is there a way to get rid of those?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "edited": false, "score": 0, "creation_date": 1549534970, "post_id": 54547481, "comment_id": 95939899, "body": "@Shurick You can apply <code>chomp</code> to it."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 2, "last_activity_date": 1549442405, "last_edit_date": 1549442405, "creation_date": 1549432859, "answer_id": 54547481, "question_id": 54546033, "link": "https://stackoverflow.com/questions/54546033/ruby-named-capture/54547481#54547481", "title": "Ruby Named Capture", "body": "<pre><code>style, price, stock = &lt;&lt;~_.scan(/^(?:Style |Price \\$|Stock \\# )(.+)/).flatten\nStyle 130690 113\nPrice $335.00\nStock # 932811\n_\n# =&gt; \"130690 113\", \"335.00\", \"932811\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 0, "last_activity_date": 1549434686, "creation_date": 1549434686, "answer_id": 54547841, "question_id": 54546033, "link": "https://stackoverflow.com/questions/54546033/ruby-named-capture/54547841#54547841", "title": "Ruby Named Capture", "body": "<p>The condition of the question is that this is the content of the text file. Therefore, you can try like this.</p>\n\n<pre><code>ary = File.readlines(path_to_your_file, chomp: true)\nstyle, price, stock = ary[0].sub(/Style /, ''), ary[1].sub(/Price \\$/, ''), ary[2].sub(/Stock # /, '')\n#=&gt; \"130690 113\", \"335.00\", \"932811\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1549439023, "creation_date": 1549439023, "answer_id": 54548750, "question_id": 54546033, "link": "https://stackoverflow.com/questions/54546033/ruby-named-capture/54548750#54548750", "title": "Ruby Named Capture", "body": "<p>I assume the order of the attributes of \"style\", \"price\" and \"stock\" and their associated values is not known. One may then initialise variables <code>style</code>, <code>price</code> and <code>stock</code> as follows. </p>\n\n<pre><code>str =&lt;&lt;END\nPrice $335.00\nStyle 130690 113\nStock # 932811\nEND\n  #=&gt; \"Price $335.00\\nStyle 130690 113\\nStock # 932811\\n\"\n\nstyle_r = /\\bstyle +(?=(\\d+))/i\nstr.match(style_r)\nstyle = $1.to_i\n  #=&gt; 130690\n\nprice_r = /\\bprice +\\$(?=(\\d+\\.\\d{2}))/i\nstr.match(price_r)\nprice = $1.to_f\n  #=&gt; 335.0\n\nstock_r = /\\bstock +# +(?=(\\d+))/i\nstr.match(stock_r)\nstock = $1.to_i\n  #=&gt; 932811 \n</code></pre>\n\n<p>The regular expression for <code>style</code>, <code>style_r</code> can be written in \"free spacing\" mode, which makes it self-documenting:</p>\n\n<pre><code>/\n\\b       # match a word break\nstyle    # match string\n[ ]+     # match one or more spaces\n(?=      # begin a positive lookahead\n  (\\d+)  # match one or more digits in capture group 1\n)        # end the positive lookahead\n/ix      # case-indifferent (i) and free-spacing modes\n</code></pre>\n\n<p>After the match on this regular expression the global variable <code>$1</code> is assigned the value of capture group 1.</p>\n\n<p>In free-spacing mode spaces are removed. One way of protecting them is to enclose them in a character class (<code>[ ]</code>), which is what I have done. The interpretation of <code>price_r</code> and <code>stock_r</code> is similar.</p>\n\n<p>Initialising variables in this way is not normally done. It generally would be more useful to create a hash with keys <code>:style</code>, <code>:stock</code> and <code>:price</code>:</p>\n\n<pre><code>h = {}\n\nstr.match(style_r)\nh[:style] = $1.to_i\n\nstr.match(price_r)\nh[:price] = $1.to_f\n\nstr.match(stock_r)\nh[:stock] = $1.to_i\n\nh #=&gt; {:style=&gt;130690, :price=&gt;335.0, :stock=&gt;932811} \n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10434656, "user_type": "registered", "profile_image": "https://graph.facebook.com/2181738121845540/picture?type=large", "display_name": "Shurick", "link": "https://stackoverflow.com/users/10434656/shurick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 54547481, "answer_count": 3, "score": -1, "last_activity_date": 1549442405, "creation_date": 1549422012, "last_edit_date": 1549432333, "question_id": 54546033, "link": "https://stackoverflow.com/questions/54546033/ruby-named-capture", "title": "Ruby Named Capture", "body": "<p>I have these fields in plain text file.</p>\n\n<pre><code>Style 130690 113\nPrice $335.00\nStock # 932811\n</code></pre>\n\n<p>How can I save the style number, price, and stock # in separate variables using regex and name capturing?</p>\n\n<p>I have tried this, but it did not work.</p>\n\n<pre><code>fields = params[:plain].match(/\"Price $\"(?&lt;price&gt;)/)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1549421906, "post_id": 54545990, "comment_id": 95892616, "body": "Do you use <code>set_topic</code> for setting <code>@topic</code> in your new action? the most simple reason might be that the variable hasn&#39;t be defined and hence returns nil when invoking it."}, {"owner": {"reputation": 45, "user_id": 10683298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b76501e82b016a31f1fdd33361403f6?s=128&d=identicon&r=PG&f=1", "display_name": "poponga", "link": "https://stackoverflow.com/users/10683298/poponga"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1549422407, "post_id": 54545990, "comment_id": 95892729, "body": "Thank you for helping me. Is that inside new action of PostsController?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10683298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b76501e82b016a31f1fdd33361403f6?s=128&d=identicon&r=PG&f=1", "display_name": "poponga", "link": "https://stackoverflow.com/users/10683298/poponga"}, "edited": false, "score": 1, "creation_date": 1549422815, "post_id": 54546068, "comment_id": 95892808, "body": "Thank you again. I really appreciate you, Vailisa."}], "tags": [], "owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "is_accepted": true, "score": 1, "last_activity_date": 1549422291, "creation_date": 1549422291, "answer_id": 54546068, "question_id": 54545990, "link": "https://stackoverflow.com/questions/54545990/error-message-nomethoderror-in-postsnew/54546068#54546068", "title": "Error message &quot;NoMethodError in Posts#new&quot;", "body": "<p>You need to add some changes to the controller:</p>\n\n<ul>\n<li>add <code>set_topic</code> before filter, to find <code>@topic</code> for every action</li>\n<li>change <code>set_topic</code> a bit, for some reasons you try to find topic by<br>\n<code>params[:topic_id, :title]</code>, it is invalid way to access hash value</li>\n<li>use <code>post_params</code> to build a new post</li>\n</ul>\n\n<p>Result:</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n  before_action :set_topic\n\n  def new\n    @post = Post.new\n  end\n\n  def create\n    @post = @topic.posts.build(post_params)\n    if @post.save\n      redirect_to new_topic_post_path(@topic)\n    else\n      render :new\n    end\n  end\n\n  private\n\n  def set_topic\n    @topic = Topic.find(params[:topic_id])\n  end\n\n  def post_params\n    params.require(:post).permit(:name, :body)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10683298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b76501e82b016a31f1fdd33361403f6?s=128&d=identicon&r=PG&f=1", "display_name": "poponga", "link": "https://stackoverflow.com/users/10683298/poponga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 54546068, "answer_count": 1, "score": 0, "last_activity_date": 1549422513, "creation_date": 1549421628, "last_edit_date": 1549422513, "question_id": 54545990, "link": "https://stackoverflow.com/questions/54545990/error-message-nomethoderror-in-postsnew", "title": "Error message &quot;NoMethodError in Posts#new&quot;", "body": "<p>I am making a simple bbs by Ruby on Rails, sorry in Japanese.\nI just got this error message</p>\n\n<blockquote>\n  <p>\"NoMethodError in Posts#new\"</p>\n  \n  <p>Showing /Users/igarashinobuo/portfolio/cpmybbs/app/views/posts/new.html.erb where line #7 raised:</p>\n  \n  <p>undefined method `posts' for nil:NilClass</p>\n\n<pre><code>  &lt;/div&gt;\n  &lt;div class=\"mt-10 pd-20\"&gt;\n    &lt;% @topic.posts.order(:id).each.with_index(1) do |post , idx| %&gt;\n      &lt;p&gt;\n        &lt;%= idx %&gt;\n        &lt;%= post.name %&gt;\n\n</code></pre>\n</blockquote>\n\n<p>This error happens, when I wanted to access '<a href=\"http://localhost:3002/topics/22/posts/new\" rel=\"nofollow noreferrer\">http://localhost:3002/topics/22/posts/new</a>'. \n22 is the number of post.\nNew page is for the page of micropost.</p>\n\n<pre><code># app/views/posts/new.html.erb\n&lt;div class=\"text-center bg-light font-weight-normal pt-3\"&gt;\n  &lt;a href=/topics&gt;Chatty&lt;/a&gt;\n&lt;/div&gt;\n  &lt;div class=\"text-center pb-20 mt-10\"&gt;\n  &lt;/div&gt;\n  &lt;div class=\"mt-10 pd-20\"&gt;\n    &lt;% @topic.posts.order(:id).each.with_index(1) do |post , idx| %&gt;\n      &lt;p&gt;\n        &lt;%= idx %&gt;\n        &lt;%= post.name %&gt;\n        &lt;%= post.body %&gt;\n      &lt;/p&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"newpost my-auto mb-60\"&gt;\n    &lt;h4&gt;\u65b0\u898f\u66f8\u304d\u8fbc\u307f&lt;/h4&gt;\n    &lt;%= form_for @post, url: topic_posts_path(@topic) do |f| %&gt;\n      &lt;div class=\"post_area\"&gt;\n        &lt;p&gt;&lt;%= f.text_field :name %&gt;&lt;/p&gt;\n        &lt;p&gt;&lt;%= f.label :name %&gt;&lt;/p&gt;\n        &lt;p&gt;&lt;%= f.text_field :name %&gt;&lt;/p&gt;\n        &lt;p&gt;&lt;%= f.label :body %&gt;&lt;/p&gt;\n        &lt;p&gt;&lt;%= f.text_area :body %&gt;&lt;/p&gt;\n        &lt;%= f.submit %&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n\n# posts_controller.rb\nclass PostsController &lt; ApplicationController\n  def new\n    @post = Post.new\n  end\n\n  def create\n    @post = @topic.posts.build(set_topic)\n    if @post.save\n      redirect_to new_topic_post_path(@topic)\n    else\n      render :new\n    end\n  end\n\n  private\n\n  def set_topic\n    @topic = Topic.find(params[:topic_id, :title])\n  end\n\n  def post_params\n    params.require(:post).permit(:name, :body)\n  end\nend\n\n# error log\napp/views/posts/new.html.erb:7:in `_app_views_posts_new_html_erb__4195515470978617912_70184702044840'\nStarted GET \"/topics/22/posts/new\" for ::1 at 2019-02-06 11:52:00 +0900\nProcessing by PostsController#new as HTML\n  Parameters: {\"topic_id\"=&gt;\"22\"}\n  Rendering posts/new.html.erb within layouts/application\n  Rendered posts/new.html.erb within layouts/application (3.3ms)\nCompleted 500 Internal Server Error in 11ms (ActiveRecord: 0.0ms)\n\nActionView::Template::Error (undefined method `posts' for nil:NilClass):\n    4:   &lt;div class=\"text-center pb-20 mt-10\"&gt;\n    5:   &lt;/div&gt;\n    6:   &lt;div class=\"mt-10 pd-20\"&gt;\n    7:     &lt;% @topic.posts.order(:id).each.with_index(1) do |post , idx| %&gt;\n    8:       &lt;p&gt;\n    9:         &lt;%= idx %&gt;\n   10:         &lt;%= post.name %\n</code></pre>\n\n<p>Could you help me kindly debug?</p>\n"}, {"tags": ["ruby", "package", "apk", "shoes", "shoes-4"], "answers": [{"tags": [], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "is_accepted": true, "score": 0, "last_activity_date": 1549428950, "creation_date": 1549428950, "answer_id": 54546832, "question_id": 54545913, "link": "https://stackoverflow.com/questions/54545913/is-there-a-way-to-package-a-shoes-ruby-app-into-an-apk/54546832#54546832", "title": "Is there a way to package a Shoes Ruby App into an APK?", "body": "<p>Very likely the answer is no and even if someone somehow built a way it probably won't be something you will want to use. GUI programming between desktop and mobile is very different and you will usually have to use different tools for both. The best you will get is writing a GUI using HTML/CSS/JS and using tools to get those running on mobile and desktop.</p>\n"}], "owner": {"reputation": 3, "user_id": 11020699, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NgT9ogtAuRg/AAAAAAAAAAI/AAAAAAAAAAc/kdiR0vYIzqs/photo.jpg?sz=128", "display_name": "Ali Kesserwani", "link": "https://stackoverflow.com/users/11020699/ali-kesserwani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 54546832, "answer_count": 1, "score": 0, "last_activity_date": 1549430497, "creation_date": 1549420930, "last_edit_date": 1549430497, "question_id": 54545913, "link": "https://stackoverflow.com/questions/54545913/is-there-a-way-to-package-a-shoes-ruby-app-into-an-apk", "title": "Is there a way to package a Shoes Ruby App into an APK?", "body": "<p>I am aware that I can package a Shoes Ruby app into a <strong>dmg</strong>, <strong>exe</strong>, and other Linux formats, but can I do an APK? I'm hoping to run a Shoes app on my Samsung Galaxy. Is there some gem or some long process to achieve this? Any method will do. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authorization", "pundit"], "answers": [{"comments": [{"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1549422872, "post_id": 54545793, "comment_id": 95892811, "body": "Do you mean in the policy? Is there any way to restrict access on a controller as a whole, and not have to call authorize on each action?"}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "reply_to_user": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 1, "creation_date": 1549425332, "post_id": 54545793, "comment_id": 95893286, "body": "@LeeMcAlilly I think you can use <code>before_action</code> since you need only the user"}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1549429493, "post_id": 54545793, "comment_id": 95894235, "body": "Thanks a before action did the trick for the controller, but that policy file still seems wrong. Is there not a more concise way to express that?"}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1549419822, "creation_date": 1549419822, "answer_id": 54545793, "question_id": 54545756, "link": "https://stackoverflow.com/questions/54545756/what-is-the-dry-way-to-restrict-an-entire-controller-with-pundit-in-rails/54545793#54545793", "title": "What is the DRY way to restrict an entire controller with Pundit in Rails?", "body": "<p>Use the second argument for the <code>authorize</code> method. Eg:</p>\n\n<pre><code>authorize @material, :index?\n</code></pre>\n\n<p>You can now remove all the other methods that just calls <code>index?</code></p>\n"}, {"comments": [{"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1549430061, "post_id": 54546951, "comment_id": 95894425, "body": "Thanks. That makes sense. Is there any way to make the policy class any more concise? Right now the only way I can get it to work is to explicitly list each action in the policy and declare who is able to access that action. Is there not some way to set all of them at once in the policy? I was playing around with Scope but can&#39;t get it working."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 1, "creation_date": 1549431132, "post_id": 54546951, "comment_id": 95894709, "body": "You can use something like <code>alias</code> or <code>alias_method</code>. We write our policies just as you&#39;ve written yours. It makes modifying them easier later. The scopes are a bit trickier; you have to use <code>policy_scope</code> or call the resolve method of the policy explicitly (e.g. MaterialPolicy::Scope.new(current_user, Material).resolve`. As long as you have your policy inherit from a base ApplicationPolicy following the example, or implement the same structure itself, it should &quot;just work&quot; <a href=\"https://github.com/varvet/pundit#scopes\" rel=\"nofollow noreferrer\">github.com/varvet/pundit#scopes</a>. If you&#39;re still having problems with scope drop a question with what you have"}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 1, "last_activity_date": 1549429712, "creation_date": 1549429712, "answer_id": 54546951, "question_id": 54545756, "link": "https://stackoverflow.com/questions/54545756/what-is-the-dry-way-to-restrict-an-entire-controller-with-pundit-in-rails/54546951#54546951", "title": "What is the DRY way to restrict an entire controller with Pundit in Rails?", "body": "<p>Pundit doesn't require you to be explicit, but it allows it. If the <code>index?</code> method in your policy wasn't duplicated, you'd want the ability to be explicit.</p>\n\n<p>You can start by looking at moving some of the authorization checks into the <code>set_material</code> method, that cuts down over half of the checks.</p>\n\n<p>The other half could be abstracted out into other private methods if you wanted, but I think they're fine as-is.</p>\n\n<p>You could also look at adding a before_action callback to call the authorizer based on the action name, after you've memoized <code>@material</code> via your other callback, but readability is likely to suffer.</p>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 5, "last_activity_date": 1549450561, "last_edit_date": 1549450561, "creation_date": 1549449651, "answer_id": 54551633, "question_id": 54545756, "link": "https://stackoverflow.com/questions/54545756/what-is-the-dry-way-to-restrict-an-entire-controller-with-pundit-in-rails/54551633#54551633", "title": "What is the DRY way to restrict an entire controller with Pundit in Rails?", "body": "<p>The first step is just to move the call to authorize to your callback:</p>\n\n<pre><code>def set_material\n  @material = Material.find(params[:id])\n  authorize @material\nend\n</code></pre>\n\n<p>You can also write <code>@material = authorize Material.find(params[:id])</code> if your Pundit version is up to date (previous versions returned true/false instead of the record).</p>\n\n<p>Pundit has a huge amount of flexibility in how you choose to use it. You could for example create a <a href=\"https://github.com/varvet/pundit#headless-policies\" rel=\"noreferrer\">separate headless policy</a>:</p>\n\n<pre><code>class StaffPolicy &lt; ApplicationPolicy\n  # the second argument is just a symbol (:staff) and is not actually used\n  def initialize(user, symbol)\n    @user = user\n  end\n  def access?\n    user.staff?\n  end\nend\n</code></pre>\n\n<p>And then use this in a callback to authorize the entire controller:</p>\n\n<pre><code>class MaterialsController &lt; ApplicationController\n  before_action :authorize_staff\n  # ...\n\n  def authorize_staff\n    authorize :staff, :access?\n  end\nend\n</code></pre>\n\n<p>Or you can just use inheritance or mixins to dry your policy class:</p>\n\n<pre><code>class StaffPolicy &lt; ApplicationPolicy\n  %i[ show? index? new? create? edit? update? delete? ].each do |name|\n    define_method name do\n      user.staff?\n    end\n  end\nend\n\nclass MaterialPolicy &lt; StaffPolicy\n  # this is how you would add additional restraints in a subclass\n  def show?\n    super &amp;&amp; some_other_condition\n  end\nend\n</code></pre>\n\n<p>Pundit is after all just plain old Ruby OOP.</p>\n"}], "owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "accepted_answer_id": 54551633, "answer_count": 3, "score": 4, "last_activity_date": 1549450561, "creation_date": 1549419401, "question_id": 54545756, "link": "https://stackoverflow.com/questions/54545756/what-is-the-dry-way-to-restrict-an-entire-controller-with-pundit-in-rails", "title": "What is the DRY way to restrict an entire controller with Pundit in Rails?", "body": "<p>I'm using <a href=\"https://github.com/varvet/pundit\" rel=\"nofollow noreferrer\">Pundit</a> with Rails, and I have a controller that I need to completely restrict from a specific user role. My roles are \"Staff\" and \"Consumer.\" The staff should have full access to the controller, but the consumers should have no access.</p>\n\n<p>Is there a way to do this that is more DRY than restricting each action one-by-one?</p>\n\n<p>For instance, here is my policy:</p>\n\n<pre><code>class MaterialPolicy &lt; ApplicationPolicy\n  attr_reader :user, :material\n\n  def initialize(user, material)\n    @user     = user\n    @material = material\n  end\n\n  def index?\n    user.staff?\n  end\n\n  def show?\n    index?\n  end\n\n  def new?\n    index?\n  end\n\n  def edit?\n    index?\n  end\n\n  def create?\n    index?\n  end\n\n  def update?\n    create?\n  end\n\n  def destroy?\n    update?\n  end\nend\n</code></pre>\n\n<p>And my controller:</p>\n\n<pre><code>class MaterialsController &lt; ApplicationController\n  before_action :set_material, only: [:show, :edit, :update, :destroy]\n\n  # GET /materials\n  def index\n    @materials = Material.all\n    authorize @materials\n  end\n\n  # GET /materials/1\n  def show\n    authorize @material\n  end\n\n  # GET /materials/new\n  def new\n    @material = Material.new\n    authorize @material\n  end\n\n  # GET /materials/1/edit\n  def edit\n    authorize @material\n  end\n\n  # POST /materials\n  def create\n    @material = Material.new(material_params)\n    authorize @material\n\n    respond_to do |format|\n      if @material.save\n        format.html { redirect_to @material, notice: 'Material was successfully created.' }\n      else\n        format.html { render :new }\n      end\n    end\n  end\n\n  # PATCH/PUT /materials/1\n  def update\n    authorize @material\n    respond_to do |format|\n      if @material.update(material_params)\n        format.html { redirect_to @material, notice: 'Material was successfully updated.' }\n      else\n        format.html { render :edit }\n      end\n    end\n  end\n\n  # DELETE /materials/1\n  def destroy\n    authorize @material\n    @material.destroy\n    respond_to do |format|\n      format.html { redirect_to materials_url, notice: 'Material was successfully destroyed.' }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_material\n      @material = Material.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def material_params\n      params.require(:material).permit(:name)\n    end\nend\n</code></pre>\n\n<p>Is there a way to do this that I'm not understanding, or is that how Pundit is designed, to require you to be explicit?</p>\n"}, {"tags": ["ruby", "activerecord", "orm", "relational-database", "self-referencing-table"], "comments": [{"owner": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "edited": false, "score": 3, "creation_date": 1549412843, "post_id": 54544589, "comment_id": 95890882, "body": "You need to look into Self-Referential Association. Some examples are <a href=\"https://collectiveidea.com/blog/archives/2015/07/30/bi-directional-and-self-referential-associations-in-rails\" rel=\"nofollow noreferrer\">here</a> and <a href=\"http://railscasts.com/episodes/163-self-referential-association\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1549421298, "post_id": 54544589, "comment_id": 95892505, "body": "Is there any reason you are using has_and_belongs_to over has_many =&gt; through? The latter may be a little more flexible."}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1549568527, "post_id": 54544589, "comment_id": 95959196, "body": "@BKSpurgeon groups can have many users and groups, users can have many groups, is that possible with has_many_through ? why more flexible ? Do you have an example ?"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1549573173, "post_id": 54544589, "comment_id": 95961302, "body": "you retain flexibility without (really any) corresponding cost. what if you want to add extra fields to your join table / join model? what if you want to have callbacks and validation logic in your join model in the future? you retain that additional flexibility, and for free."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1549573208, "post_id": 54544589, "comment_id": 95961314, "body": "@peter here is a link to the docs discussing this issue: <a href=\"https://guides.rubyonrails.org/association_basics.html#choosing-between-has-many-through-and-has-and-belongs-to-many\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "edited": false, "score": 0, "creation_date": 1549575661, "post_id": 54544589, "comment_id": 95962454, "body": "@AbM Thnx for the links, the thing is there is code that is executed in controllers and after creating and deleting, I would like to avoid that so that the tables are usable with plain SQL also and SRA is apparently more about bi-directional functionality and not nesting"}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1549575797, "post_id": 54544589, "comment_id": 95962511, "body": "@BKSpurgeon I see, I was going for simple, for the moment don&#39;t need any of the extra&#39;s, just want the nesting, but I&#39;m testing that approach now also, Thnx for the suggestion"}], "answers": [{"comments": [{"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1549570561, "post_id": 54545876, "comment_id": 95960127, "body": "Thanks Jake, that&#39;s a start, I&#39;v put my attemt to use this in a separate answer, feel free to modify that or yours. I will accept only solution from you or others, not my own attempts"}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "reply_to_user": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1549579281, "post_id": 54545876, "comment_id": 95963847, "body": "@peter Oh, I&#39;m sorry, I was thinking you where running Ruby with the Rails framework. I should also add that I think my solution will only work to display users if they are a part of a subgroup. They can belong to a main group but I think I was running into issues when trying to display it."}], "tags": [], "owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "is_accepted": false, "score": 2, "last_activity_date": 1549421385, "last_edit_date": 1549421385, "creation_date": 1549420625, "answer_id": 54545876, "question_id": 54544589, "link": "https://stackoverflow.com/questions/54544589/activerecord-has-and-belongs-to-many-with-nested-groups/54545876#54545876", "title": "Activerecord has_and_belongs_to_many with nested groups", "body": "<p>You can accomplish this by using a Self-Referential relation in your <code>Group</code> model. This is where records in a table may point to other records in the same table.</p>\n\n<p>Basically, the <code>parent_id</code> for main groups will be <code>NULL</code> and the sub groups will have their <code>parent_id</code> set to the column id of their parent group.</p>\n\n<p><strong>Group Model:</strong></p>\n\n<pre><code>has_many :users\n\nhas_many :sub_groups, class_name: \"Group\", foreign_key: :parent_id\nhas_many :sub_group_users, through: :sub_groups, source: :users \nbelongs_to :parent, class_name: 'Group', foreign_key: :parent_id, optional: true\n# This is a scope to load the top level groups and eager-load their users, sub-groups, and the sub-groups' users too.\nscope :top_level, -&gt; { where(parent_id: nil).includes :users, sub_groups: :users}\n</code></pre>\n\n<p><strong>Groups Controller:</strong></p>\n\n<pre><code>def show\n  @group            = Group.find(params[:id])\n  @category         = @group.parent\n  @users            = @group.users\n  @sub_group        = @group.sub_groups.first\n  unless @sub_group.nil?\n    @relatives      = @group.sub_group_users\n  end\nend\n\nprivate\n\n  def cat_params\n    params.require(:group).permit(:name, :parent_id, :sub_group)\n  end\n\n\n  def main_group\n    @group = Group.parent_id.nil?\n  end\n</code></pre>\n\n<p>In your <code>groups</code> table, add this column: <code>t.integer \"parent_id\"</code></p>\n\n<p>In your <code>users</code> table, add this column: <code>t.integer \"group_id\"</code></p>\n\n<p>You will need to add <code>:group_id</code> into your <code>user_params</code> as well (in your users controller).</p>\n\n<p><strong>User Model:</strong> <code>belongs_to :group</code></p>\n\n<p>In your groups show view:</p>\n\n<pre><code>&lt;% if @category %&gt;\n  &lt;% @users.each do |user| %&gt;\n\n  &lt;% end %&gt;\n&lt;% else %&gt;\n  &lt;% @relatives&amp;.each do |user| %&gt;\n\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1549570405, "creation_date": 1549570405, "answer_id": 54581537, "question_id": 54544589, "link": "https://stackoverflow.com/questions/54544589/activerecord-has-and-belongs-to-many-with-nested-groups/54581537#54581537", "title": "Activerecord has_and_belongs_to_many with nested groups", "body": "<p>I put my attemtp with Jake's solution here in a separate answer to keep it apart from the original and make comments and edits on this solution alone possible.\nIt is NOT my intention to accept this as an answer !\nAlso I put the entire script here so that people can test right away.\nThe solution uses only 2 tables instead of the original 3 which is good but it's not complete yet, see my remarks at the end of the code.</p>\n\n<pre><code>require 'active_record'\nrequire 'logger'\n\nActiveRecord::Base.establish_connection(\n:adapter =&gt; \"sqlite3\",\n:database  =&gt; \":memory:\"\n)\n\nActiveRecord::Schema.define do\n  create_table :users do |table|\n    table.column :name, :string\n    table.column :group_id, :integer\n  end\n  create_table :groups do |table|\n    table.column :name, :string\n    table.column :user_id, :integer\n    table.column :parent_id, :integer\n  end\nend\n\nclass User &lt; ActiveRecord::Base\n  belongs_to :group\n  has_many :groups\nend\n\nclass Group &lt; ActiveRecord::Base\n  has_many :users\n  has_many :sub_groups, class_name: \"Group\", foreign_key: :parent_id\n  has_many :sub_group_users, through: :sub_groups, source: :users \n  belongs_to :parent, class_name: 'Group', foreign_key: :parent_id, optional: true\n  # This is a scope to load the top level groups and eager-load their users, sub-groups, and the sub-groups' users too.\n  scope :top_level, -&gt; { where(parent_id: nil).includes :users, sub_groups: :users}\nend\n\npeter  = User.create(id: 1, name: 'Peter')\nthomas = User.create(id: 2, name: 'Thomas')\nerika  = User.create(id: 3, name: 'Erika')\ninf    = Group.create(id: 1, name: 'Informatics')\ndevs   = Group.create(id: 2, name: 'Devs')\nlog    = Group.create(id: 3, name: 'Logistics')\n\n# peter.groups &lt;&lt; inf # doesn't work\ndevs.users &lt;&lt; thomas\ndevs.users &lt;&lt; peter\ninf.users &lt;&lt; erika\n\n# expect inf.groups &lt;&lt; devs to work\ninf.sub_groups &lt;&lt; devs\n\n# doesn't work\np peter.groups #&lt;ActiveRecord::Associations::CollectionProxy []&gt;\n\n# only gives users added straight to the group\np inf.users #&lt;ActiveRecord::Associations::CollectionProxy [#&lt;User id: 3, name: \"Erika\", group_id: 1&gt;]&gt;\n\n# this should be added to inf.users\np inf.sub_group_users \n#&lt;ActiveRecord::Associations::CollectionProxy [#&lt;User id: 1, name: \"Peter\", group_id: 2&gt;, #&lt;User id: 2, name: \"Thomas\", group_id: 2&gt;]&gt;\n\n# works\np Group.top_level\n#&lt;ActiveRecord::Relation [#&lt;Group id: 1, name: \"Informatics\", user_id: nil, parent_id: nil&gt;]&gt;\n</code></pre>\n"}], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1549571050, "creation_date": 1549409224, "last_edit_date": 1549571050, "question_id": 54544589, "link": "https://stackoverflow.com/questions/54544589/activerecord-has-and-belongs-to-many-with-nested-groups", "title": "Activerecord has_and_belongs_to_many with nested groups", "body": "<p>I need to store groups of users in other groups, somewhat like Windows Active Directory.</p>\n\n<p>I have the following what works</p>\n\n<pre><code>ActiveRecord::Schema.define do\n  create_table :users do |table|\n    table.column :name, :string\n  end\n  create_table :groups do |table|\n    table.column :name, :string\n  end\n  create_join_table :users, :groups do |t|\n  end\nend\n\nclass User &lt; ActiveRecord::Base\n  has_and_belongs_to_many :groups\nend\n\nclass Group &lt; ActiveRecord::Base\n  has_and_belongs_to_many :users\n  # has_and_belongs_to_many :groups\nend\n\npeter  = User.create(id: 1, Name: 'Peter')\nthomas = User.create(id: 2, Name: 'Thomas')\ninf = Group.create(id: 1, Name: 'Informatics')\n\npeter.groups &lt;&lt; inf\ninf.users &lt;&lt; thomas\np User.find_by(Name: 'Peter').groups\np Group.find_by(Name: 'Informatics').users\n</code></pre>\n\n<p>But I would like to do the following also</p>\n\n<pre><code>sm = Group.create(id: 2, Name: 'System')\ninf.groups &lt;&lt; sm\n</code></pre>\n\n<p>What would be the simplest way to do so ?</p>\n"}, {"tags": ["ruby", "metasploit"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 2, "creation_date": 1549412108, "post_id": 54544576, "comment_id": 95890697, "body": "what version of Ruby do you have?"}, {"owner": {"reputation": 21, "user_id": 7240689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d41547cf3ef9b77d97e8fc104208234?s=128&d=identicon&r=PG&f=1", "display_name": "abd alfattah", "link": "https://stackoverflow.com/users/7240689/abd-alfattah"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1549490452, "post_id": 54544576, "comment_id": 95925335, "body": "ruby 2.2.6p396 (2016-11-15 revision 56800) [i386-mingw32]"}], "answers": [{"tags": [], "owner": {"reputation": 2115, "user_id": 534600, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1cd9c8984f2fdeb996130d54d62a98d9?s=128&d=identicon&r=PG", "display_name": "Arman Ortega", "link": "https://stackoverflow.com/users/534600/arman-ortega"}, "is_accepted": false, "score": 0, "last_activity_date": 1559736412, "creation_date": 1559736412, "answer_id": 56460181, "question_id": 54544576, "link": "https://stackoverflow.com/questions/54544576/geminstallerror-nokogiri-requires-ruby-version-2-7-dev-2-3-on-pentestbo/56460181#56460181", "title": "Gem::InstallError: nokogiri requires Ruby version &lt; 2.7.dev, &gt;= 2.3 on Pentestbox", "body": "<p>I also got the same error in my Windows 10 and I was able to install the nokogori successfully. Below is my Ruby environment.</p>\n\n<pre><code>RubyGems Environment:\n      - RUBYGEMS VERSION: 2.4.5\n      - RUBY VERSION: 2.2.2 (2015-04-13 patchlevel 95) [x64-mingw32]\n      - INSTALLATION DIRECTORY: C:/Ruby222-x64/lib/ruby/gems/2.2.0\n      - RUBY EXECUTABLE: C:/Ruby222-x64/bin/ruby.exe\n      - EXECUTABLE DIRECTORY: C:/Ruby222-x64/bin\n      - SYSTEM CONFIGURATION DIRECTORY: C:/ProgramData\n      - RUBYGEMS PLATFORMS:\n        - ruby\n        - x64-mingw32\n      - GEM PATHS:\n         - C:/Ruby222-x64/lib/ruby/gems/2.2.0\n</code></pre>\n\n<p>To solved the issue I just updated my Gemfile. I added this line:\n<strong>gem 'nokogiri', '~> 1.6.8'</strong></p>\n"}, {"tags": [], "owner": {"reputation": 1356, "user_id": 7624566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7804ef232e31aeb8ea02186ca4380d7?s=128&d=identicon&r=PG&f=1", "display_name": "K. B.", "link": "https://stackoverflow.com/users/7624566/k-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1589878819, "creation_date": 1589878819, "answer_id": 61887169, "question_id": 54544576, "link": "https://stackoverflow.com/questions/54544576/geminstallerror-nokogiri-requires-ruby-version-2-7-dev-2-3-on-pentestbo/61887169#61887169", "title": "Gem::InstallError: nokogiri requires Ruby version &lt; 2.7.dev, &gt;= 2.3 on Pentestbox", "body": "<p>I am using Windows 10, I installed nokogiri prerelease version in which this is fixed.</p>\n\n<pre><code>gem inst nokogiri --pre\n</code></pre>\n\n<p>Then I changed the dependency in the gemfile.lock file:</p>\n\n<pre><code>nokogiri (1.11.0.rc2-x64-mingw32)\n</code></pre>\n\n<p>Reference:<br>\n<a href=\"https://github.com/sparklemotion/nokogiri/issues/1961\" rel=\"nofollow noreferrer\">https://github.com/sparklemotion/nokogiri/issues/1961</a></p>\n"}], "owner": {"reputation": 21, "user_id": 7240689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d41547cf3ef9b77d97e8fc104208234?s=128&d=identicon&r=PG&f=1", "display_name": "abd alfattah", "link": "https://stackoverflow.com/users/7240689/abd-alfattah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1568, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1589878819, "creation_date": 1549409161, "last_edit_date": 1578502493, "question_id": 54544576, "link": "https://stackoverflow.com/questions/54544576/geminstallerror-nokogiri-requires-ruby-version-2-7-dev-2-3-on-pentestbo", "title": "Gem::InstallError: nokogiri requires Ruby version &lt; 2.7.dev, &gt;= 2.3 on Pentestbox", "body": "<p>when I try to run metasploit on pentestbox last version I get the below error </p>\n\n<blockquote>\n  <p>could not find compatible versions for gem \"activesupport\":   In snapshot (Gemfile.lock):     activesupport (= 4.2.11)    In Gemfile:     metasploit-framework x86-mingw32 was resolved to 5.0.5, which depends on       activerecord (~> 4.2.6) x86-mingw32 was resolved to 4.2.10, which depends on         activesupport (= 4.2.10) x86-mingw32      rspec-rails x86-mingw32 was resolved to 3.8.2, which depends on       railties (>= 3.0) was resolved to 4.2.11, which depends on         activesupport (= 4.2.11) x86-mingw32  Running <code>bundle update</code> will rebuild your snapshot from scratch, using only the gems in your Gemfile, which may resolve the conflict.</p>\n</blockquote>\n\n<p>I tried running the command \"bundle update\", but got this error</p>\n\n<blockquote>\n  <p>Fetching nokogiri 1.10.1 (x86-mingw32) Installing nokogiri 1.10.1 (x86-mingw32) Gem::InstallError: nokogiri requires Ruby version &lt; 2.7.dev, >= 2.3. An error occurred while installing nokogiri (1.10.1), and Bundler cannot continue. Make sure that <code>gem install nokogiri -v '1.10.1'</code> succeeds before bundling</p>\n</blockquote>\n\n<p>after that  I try run command \"bundle install\" I get same Error</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1549407322, "post_id": 54544116, "comment_id": 95889554, "body": "Do you mean an &quot;array of existing hashes&quot; and an &quot;array of accounts I need to check&quot;? :)"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1549407428, "post_id": 54544116, "comment_id": 95889586, "body": "Correct me if I&#39;m wrong, but you&#39;re trying to create the model if they don&#39;t exist, correct? Are there other attributes in <code>FbAdaccount</code>, or just the id?"}, {"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "reply_to_user": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1549407518, "post_id": 54544116, "comment_id": 95889611, "body": "@UpvoteMe I have two hashes, each have a key =&gt; value for an ID i need to match on. So hash1 can be {&quot;fb_id&quot;=&gt;&quot;123&quot;, &quot;fb_id&quot;=&gt;&quot;456&quot;, &quot;fb_id&quot;=&gt;&quot;567&quot;} and hash2 can be {&quot;fb_id&quot;=&gt;&quot;123&quot;, &quot;fb_id&quot;=&gt;&quot;456&quot;} and i need to find the fb_id that is in hash1 but not in hash2"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1549407694, "post_id": 54544116, "comment_id": 95889661, "body": "I can tell you&#39;re unfamiliar with Ruby (or maybe programming) but it&#39;s okay \u2014 that&#39;s why you&#39;re on a support forum. <code>{&quot;fb_id&quot;=&gt;&quot;123&quot;, &quot;fb_id&quot;=&gt;&quot;456&quot;, &quot;fb_id&quot;=&gt;&quot;567&quot;}</code> isn&#39;t valid code, you probably mean <code>[{&quot;fb_id&quot;=&gt;&quot;123&quot;}, {&quot;fb_id&quot;=&gt;&quot;456&quot;}, {&quot;fb_id&quot;=&gt;&quot;567&quot;}]</code>. That is an array, where each element is a hash."}, {"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "reply_to_user": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1549407828, "post_id": 54544116, "comment_id": 95889694, "body": "@UpvoteMe just an example so you can see what i am trying to do, that was just some arbitrary values i came up with, i just want to know the fastest way to match values in two different ruby hashes"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1549409043, "post_id": 54544116, "comment_id": 95889996, "body": "please join me in <a href=\"https://chat.stackoverflow.com/rooms/187958/room-for-upvote-me-and-ricks\">chat</a> so that I can explain why your sample code is invalid Ruby syntax."}], "answers": [{"comments": [{"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "edited": false, "score": 0, "creation_date": 1549409833, "post_id": 54544501, "comment_id": 95890184, "body": "Hey, i tried this and it ran a select statement for every ad account"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "reply_to_user": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "edited": false, "score": 0, "creation_date": 1549411870, "post_id": 54544501, "comment_id": 95890632, "body": "@RickS it would, because it will execute many SELECT statements, but they&#39;re all wrapped together. I&#39;ll edit the answer to illustrate."}], "tags": [], "owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "is_accepted": false, "score": 0, "last_activity_date": 1549412282, "last_edit_date": 1549412282, "creation_date": 1549408683, "answer_id": 54544501, "question_id": 54544116, "link": "https://stackoverflow.com/questions/54544116/what-is-the-fastest-way-to-compare-two-values-from-different-hashes/54544501#54544501", "title": "What is the fastest way to compare two values from different hashes?", "body": "<p>What you're looking for is <a href=\"https://apidock.com/rails/v4.0.2/ActiveRecord/Relation/find_or_create_by\" rel=\"nofollow noreferrer\"><code>find_or_create_by</code></a>. I've additionally wrapped the call in a transaction so all of this hits the database just once \u2014\u00a0in a single query.</p>\n\n<pre><code>def self.reconcileAdaccounts(ad_accounts, user_id)\n  FbAdaccount.transaction do\n    ad_accounts.each do |ad_account|\n      FbAdaccount.active\n                 .select('fb_id')\n                 .where('user_id = ?', user_id)\n                 .find_or_create_by(ad_account['account_id'])\n    end\n  end\nend\n</code></pre>\n\n<h2>Transactions</h2>\n\n<p>A transaction doesn't magically alter the query, but it wraps it together so that it either all happens together, or doesn't happen at all.</p>\n\n<p>With the following code:</p>\n\n<pre><code>numbers = (3..7).to_a\n\nEar.transaction do\n  numbers.each do |number|\n    Ear.find_or_create_by(bla: number)\n  end\nend\n</code></pre>\n\n<p>Note the <code>BEGIN</code> and <code>COMMIT</code> statements. They signify where the call starts and ends.</p>\n\n<pre><code> (0.1ms)  BEGIN\nEar Load (0.5ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 3], [\"LIMIT\", 1]]\nEar Create (0.8ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 3], [\"created_at\", \"2019-02-05 23:17:28.157989\"], [\"updated_at\", \"2019-02-05 23:17:28.157989\"]]\nEar Load (0.2ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 4], [\"LIMIT\", 1]]\nEar Create (0.2ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 4], [\"created_at\", \"2019-02-05 23:17:28.160838\"], [\"updated_at\", \"2019-02-05 23:17:28.160838\"]]\nEar Load (0.1ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 5], [\"LIMIT\", 1]]\nEar Create (0.2ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 5], [\"created_at\", \"2019-02-05 23:17:28.162241\"], [\"updated_at\", \"2019-02-05 23:17:28.162241\"]]\nEar Load (0.2ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 6], [\"LIMIT\", 1]]\nEar Create (0.2ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 6], [\"created_at\", \"2019-02-05 23:17:28.163794\"], [\"updated_at\", \"2019-02-05 23:17:28.163794\"]]\nEar Load (0.2ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 7], [\"LIMIT\", 1]]\nEar Create (0.2ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 7], [\"created_at\", \"2019-02-05 23:17:28.165589\"], [\"updated_at\", \"2019-02-05 23:17:28.165589\"]]\n (40.9ms)  COMMIT\n</code></pre>\n\n<p>Now here's the same code, just without a transaction to wrap it in:</p>\n\n<pre><code>numbers = (20..25).to_a\n\nnumbers.each do |number|\n  Ear.find_or_create_by(bla: number)\nend\n</code></pre>\n\n<p>Note the total number <code>BEGIN</code> and <code>COMMIT</code> messages:</p>\n\n<pre><code>Ear Load (249.3ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 20], [\"LIMIT\", 1]]\n(73.4ms)  BEGIN\nEar Create (48.7ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 20], [\"created_at\", \"2019-02-06 00:12:35.754374\"], [\"updated_at\", \"2019-02-06 00:12:35.754374\"]]\n(79.8ms)  COMMIT\nEar Load (0.4ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 21], [\"LIMIT\", 1]]\n(0.2ms)  BEGIN\nEar Create (77.7ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 21], [\"created_at\", \"2019-02-06 00:12:35.918461\"], [\"updated_at\", \"2019-02-06 00:12:35.918461\"]]\n(0.3ms)  COMMIT\nEar Load (0.2ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 22], [\"LIMIT\", 1]]\n(0.2ms)  BEGIN\nEar Create (2.7ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 22], [\"created_at\", \"2019-02-06 00:12:36.003822\"], [\"updated_at\", \"2019-02-06 00:12:36.003822\"]]\n(110.1ms)  COMMIT\nEar Load (0.3ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 23], [\"LIMIT\", 1]]\n(0.2ms)  BEGIN\nEar Create (0.3ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 23], [\"created_at\", \"2019-02-06 00:12:36.125187\"], [\"updated_at\", \"2019-02-06 00:12:36.125187\"]]\n(37.0ms)  COMMIT\nEar Load (0.2ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 24], [\"LIMIT\", 1]]\n(0.2ms)  BEGIN\nEar Create (0.4ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 24], [\"created_at\", \"2019-02-06 00:12:36.168414\"], [\"updated_at\", \"2019-02-06 00:12:36.168414\"]]\n(72.4ms)  COMMIT\nEar Load (0.3ms)  SELECT  \"ears\".* FROM \"ears\" WHERE \"ears\".\"bla\" = $1 LIMIT $2  [[\"bla\", 25], [\"LIMIT\", 1]]\n(1.7ms)  BEGIN\nEar Create (0.4ms)  INSERT INTO \"ears\" (\"bla\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"bla\", 25], [\"created_at\", \"2019-02-06 00:12:36.249285\"], [\"updated_at\", \"2019-02-06 00:12:36.249285\"]]\n(121.2ms)  COMMIT\n</code></pre>\n"}], "owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549412282, "creation_date": 1549406271, "question_id": 54544116, "link": "https://stackoverflow.com/questions/54544116/what-is-the-fastest-way-to-compare-two-values-from-different-hashes", "title": "What is the fastest way to compare two values from different hashes?", "body": "<p>I am trying to compare two hashes to see if the values match so i can reconcile some data.</p>\n\n<p>I have a hash of existing accounts and a hash of accounts i need to check if they exist based on the existing accounts to see if it needs to be inserted.</p>\n\n<pre><code># Reconcile Adaccounts\ndef self.reconcileAdaccounts(ad_accounts, user_id)\n\n    # These are the accounts that exist\n    existing_accounts = FbAdaccount.active\n                                    .select(\"fb_id\")\n                                    .where(\"user_id = ?\", user_id)\n                                    .as_json\n\n    ad_accounts.each do |ad_account|\n\n        if #here i would need to check if ad_account[\"account_id\"] matches one of the existing records\n\n            p \"This one already exists\"\n            p ad_account[\"account_id\"]\n        else\n\n            p \"I need to create this one\"\n            p ad_account[\"account_id\"]\n        end\n\n    end\n\nend\n</code></pre>\n\n<p>I could have nested loops but that does not seem like it would be the best solution, i also tried looking for any rails API functions that could do this but i have not found one.</p>\n\n<p>What is the most efficient way of doing this? </p>\n"}, {"tags": ["ruby", "concurrency", "jobs", "worker", "distributed-system"], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 129179, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06452361e1627500f7edafee19fadd5?s=128&d=identicon&r=PG", "display_name": "Tarek Khalil", "link": "https://stackoverflow.com/users/129179/tarek-khalil"}, "edited": false, "score": 0, "creation_date": 1549465418, "post_id": 54544041, "comment_id": 95912819, "body": "Yes, their docs statement is something I referred to in my question. You are correct that I am operating under this assumption. Though I am still unsure that sleep is the best option, for the con I pointed to in my question above. It might hard fail since I am not exactly sure how many seconds does the 3rd party API needs for processing, but according to my trials, 5 seconds sleep seemed alright. It has the potential to fail more often than the exponential backoff technique that I mentioned above."}], "tags": [], "owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "is_accepted": true, "score": 1, "last_activity_date": 1549405790, "creation_date": 1549405790, "answer_id": 54544041, "question_id": 54543488, "link": "https://stackoverflow.com/questions/54543488/is-it-a-reasonable-trade-off-to-use-sleep-in-an-asynchronous-job/54544041#54544041", "title": "Is it a reasonable trade-off to use `sleep` in an asynchronous job?", "body": "<p>The <a href=\"https://apiok.ru/en/dev/graph_api/methods/graph.user/graph.user.fileUploadUrl/get\" rel=\"nofollow noreferrer\">API docs</a> you linked to say:</p>\n\n<blockquote>\n  <p>Attention! Some time needed by a server to process an uploaded file.\n  File should be sent to a chat after a short timeout (a couple of\n  seconds)</p>\n</blockquote>\n\n<p>I would usually advise against something of this nature, but since your vendor specifically says \"timeout\", <code>sleep</code> is the best option.</p>\n"}, {"comments": [{"owner": {"reputation": 395, "user_id": 129179, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06452361e1627500f7edafee19fadd5?s=128&d=identicon&r=PG", "display_name": "Tarek Khalil", "link": "https://stackoverflow.com/users/129179/tarek-khalil"}, "edited": false, "score": 0, "creation_date": 1549465235, "post_id": 54545307, "comment_id": 95912725, "body": "Thanks! &gt; &quot;asynchronous programming should not involve any blocking tasks.&quot;  I find it hard to agree with this statement. It is a job that runs within a worker. The job invocation nature is indeed asynchronous, but the work that encompasses can be and will be naturally blocking at some point. Perhaps I misunderstood or mis-explained something in my question."}], "tags": [], "owner": {"reputation": 143, "user_id": 6817779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b99d716160ad2b388c18af43eec37b7?s=128&d=identicon&r=PG&f=1", "display_name": "kr3v", "link": "https://stackoverflow.com/users/6817779/kr3v"}, "is_accepted": false, "score": 0, "last_activity_date": 1549415040, "creation_date": 1549415040, "answer_id": 54545307, "question_id": 54543488, "link": "https://stackoverflow.com/questions/54543488/is-it-a-reasonable-trade-off-to-use-sleep-in-an-asynchronous-job/54545307#54545307", "title": "Is it a reasonable trade-off to use `sleep` in an asynchronous job?", "body": "<p>I'd try doing delayed task, as it will allow thread to continue working (so thread pool won't need to create new threads (they are quite expensive from memory side), your thread may continue doing useful job without need of context switch (which is expensive from CPU usage side), ...).</p>\n\n<p>As for purity of solution, asynchronous programming should not involve any blocking tasks (we are actually fighting against blocking using asynchronous programming), so this is one more reason to use delayed task.</p>\n\n<p>If application does not involve achieving highest performance (does Ruby performance oriented language?), so sleep may really be easiest, but not most optimal solution.</p>\n"}], "owner": {"reputation": 395, "user_id": 129179, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06452361e1627500f7edafee19fadd5?s=128&d=identicon&r=PG", "display_name": "Tarek Khalil", "link": "https://stackoverflow.com/users/129179/tarek-khalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 54544041, "answer_count": 2, "score": 0, "last_activity_date": 1549415040, "creation_date": 1549402805, "question_id": 54543488, "link": "https://stackoverflow.com/questions/54543488/is-it-a-reasonable-trade-off-to-use-sleep-in-an-asynchronous-job", "title": "Is it a reasonable trade-off to use `sleep` in an asynchronous job?", "body": "<p>Assume I have a scenario where I am processing a background job in a worker. It simply receives a URL for a file (image, video, pdf, ..) hosted on a remote CDN and the worker does its work as:</p>\n\n<ol>\n<li>Some processing on the file content in-memory</li>\n<li>Then calls a 3rd party API to retrieve <a href=\"https://apiok.ru/en/dev/graph_api/methods/graph.user/graph.user.fileUploadUrl/get\" rel=\"nofollow noreferrer\">a signed valid URL</a> for uploading the content to that same 3rd party.</li>\n<li>Uploads the content to the 3rd party API \u2013 the response contains a unique file ID</li>\n<li><a href=\"https://apiok.ru/en/dev/graph_api/methods/graph.user/graph.user.messages/post\" rel=\"nofollow noreferrer\">Sends a message to a user</a> through the 3rd party API with the unique file ID received earlier</li>\n</ol>\n\n<p>Now, the problem is between step (3) and (4). The constraint here is that the 3rd party API needs few seconds to process the file (step 3) before we actually send a message containing the file ID we just uploaded (step 4).</p>\n\n<p>One more assumption here is that I need to make sure all 4 steps execute in one go, as in, not to have any partial failure opportunities.</p>\n\n<h2>Possible approaches</h2>\n\n<ul>\n<li><p>The most naive way to go is by using <code>sleep 5</code> between step (3) and (4), it might hurt / hard fail since I am not exactly sure how many seconds does the 3rd party API needs for processing, but according to my trials, 5 seconds sleep seemed alright.</p></li>\n<li><p>I could do an in-process exponential retry for 3 (or X) times for step (3), catch an exception from the 3rd party and attempt to do step (4) when step (3) is successful \u2013 this is what I have now, it works alright.</p></li>\n<li><p>I could perhaps either use a job scheduler or a ruby concurrency library to do step (4) in a delayed fashion. I don't appreciate this path as it feels like it is favouring complexity.</p></li>\n</ul>\n\n<p>This piece of logic is built in Ruby, though the question might not be very Ruby specific and can be applicable in other languages, I would like to hear what Ruby folks think.</p>\n"}, {"tags": ["ruby", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "edited": false, "score": 0, "creation_date": 1584030035, "post_id": 54638141, "comment_id": 107317692, "body": "If you use the Class, it will pick up the worker default options. <code>&#39;class&#39; =&gt; SomeWorker</code>   When you only pass the String, you need to pass any other default options."}], "tags": [], "owner": {"reputation": 1116, "user_id": 320125, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fe196a786f766dd3de675017b445a731?s=128&d=identicon&r=PG", "display_name": "SM79", "link": "https://stackoverflow.com/users/320125/sm79"}, "is_accepted": false, "score": 0, "last_activity_date": 1549915030, "creation_date": 1549915030, "answer_id": 54638141, "question_id": 54543049, "link": "https://stackoverflow.com/questions/54543049/sidekiq-retries-exhausted-never-firing/54638141#54638141", "title": "sidekiq_retries_exhausted never firing", "body": "<p>The problem was that when adding a job via code like this:</p>\n\n<pre><code>  Sidekiq::Client.push(\n    'class' =&gt; 'SomeWorker',\n    'args' =&gt; [\n      foo: \"bar\",\n    ],\n  )\n</code></pre>\n\n<p>retries setting in the class declaration <code>sidekiq_options retry: 1</code> is omitted for some reason (bug?/ by design?). Instead <code>'retry' =&gt; 1</code> needs to be explicitly set:</p>\n\n<pre><code>  Sidekiq::Client.push(\n    'class' =&gt; 'SomeWorker',\n    'args' =&gt; [\n      foo: \"bar\",\n    ],\n    'retry' =&gt; 1\n  )\n</code></pre>\n"}], "owner": {"reputation": 1116, "user_id": 320125, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fe196a786f766dd3de675017b445a731?s=128&d=identicon&r=PG", "display_name": "SM79", "link": "https://stackoverflow.com/users/320125/sm79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 282, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549915030, "creation_date": 1549400824, "question_id": 54543049, "link": "https://stackoverflow.com/questions/54543049/sidekiq-retries-exhausted-never-firing", "title": "sidekiq_retries_exhausted never firing", "body": "<p>What might be the reason for <code>sidekiq_retries_exhausted</code> not being called? Is there some setting I am missing?</p>\n\n<p>Probably something is overriding <code>sidekiq_options retry: 1</code>, and the worker keeps retrying, but what?</p>\n\n<pre><code>class SomeWorker\n  include Sidekiq::Worker\n\n  sidekiq_options retry: 1\n\n  sidekiq_retries_exhausted do |msg|\n    # =&gt; never hit this point\n    Rails.logger.info \"tried two times, failed\"\n  end\n\n  def perform(_args)\n    raise\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1549406575, "post_id": 54542914, "comment_id": 95889325, "body": "The same way? It&#39;s not clear to me what you think the issue is."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549445088, "post_id": 54542914, "comment_id": 95900475, "body": "You&#39;re referring to current house in two different ways. One of them is wrong in this context. Take a close look at the line with the error. Then the other lines where you use current house. Can you spot the difference?"}, {"owner": {"reputation": 31, "user_id": 7132462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9543d1791ad5c02af8da3f765fd9b66c?s=128&d=identicon&r=PG&f=1", "display_name": "Kush", "link": "https://stackoverflow.com/users/7132462/kush"}, "edited": false, "score": 0, "creation_date": 1549458487, "post_id": 54542914, "comment_id": 95908485, "body": "Hi Sergio i noticed the difference made the change but still not working, getting error on the same line. I removed the @ symbol"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549459320, "post_id": 54542914, "comment_id": 95909009, "body": "@KushDMU The same error on the same line? Impossible."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7132462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9543d1791ad5c02af8da3f765fd9b66c?s=128&d=identicon&r=PG&f=1", "display_name": "Kush", "link": "https://stackoverflow.com/users/7132462/kush"}, "edited": false, "score": 0, "creation_date": 1549411165, "post_id": 54544126, "comment_id": 95890474, "body": "Thank you i tried this but still get error undefined method for tenant on this line - if @house.tenant.present?. I will take your feedback on board and also do some reading."}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "reply_to_user": {"reputation": 31, "user_id": 7132462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9543d1791ad5c02af8da3f765fd9b66c?s=128&d=identicon&r=PG&f=1", "display_name": "Kush", "link": "https://stackoverflow.com/users/7132462/kush"}, "edited": false, "score": 0, "creation_date": 1549412395, "post_id": 54544126, "comment_id": 95890773, "body": "@KushDMU can you update the question with the full error message + stack trace?"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "reply_to_user": {"reputation": 31, "user_id": 7132462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9543d1791ad5c02af8da3f765fd9b66c?s=128&d=identicon&r=PG&f=1", "display_name": "Kush", "link": "https://stackoverflow.com/users/7132462/kush"}, "edited": false, "score": 0, "creation_date": 1549459122, "post_id": 54544126, "comment_id": 95908894, "body": "@KushDMU fixed, try now."}], "tags": [], "owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "is_accepted": true, "score": 0, "last_activity_date": 1549459112, "last_edit_date": 1549459112, "creation_date": 1549406306, "answer_id": 54544126, "question_id": 54542914, "link": "https://stackoverflow.com/questions/54542914/ruby-index-page-display-even-if-nil-currently-get-undefined-error/54544126#54544126", "title": "Ruby index page display even if nil, currently get undefined error", "body": "<p>This should work:</p>\n\n<pre><code>.wrapper_with_padding\n  #houses.clearfix\n    - unless @houses.blank?\n      - @houses.each do |house|\n        %a{ href: (url_for [house])}\n          .house\n            %p.title= house.title\n            %p.postcode= 'Postcode: ' + (house.postcode)\n            %p.price= number_to_currency(house.price, :unit =&gt; \"\u00a3\") + ' per month'\n            -if house.tenant.present?\n              %p.tenant_id= house.tenant.first_name\n            -else\n              %p No Tenant Assigned\n    - else\n      %h2 Add a Property\n      %p It appears you have not added any property's\n\n    %button= link_to \"New Property\", new_house_path\n</code></pre>\n\n<p>Please note that while I haven't fixed any of the other errors, you should probably read a bit about the Haml spec.</p>\n\n<p>You don't have to do <code>%p= 'No Tenant Assigned'</code>, because <code>%p No Tenant Assigned</code> works.</p>\n"}], "owner": {"reputation": 31, "user_id": 7132462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9543d1791ad5c02af8da3f765fd9b66c?s=128&d=identicon&r=PG&f=1", "display_name": "Kush", "link": "https://stackoverflow.com/users/7132462/kush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54544126, "answer_count": 1, "score": -1, "last_activity_date": 1549459112, "creation_date": 1549400172, "last_edit_date": 1549444988, "question_id": 54542914, "link": "https://stackoverflow.com/questions/54542914/ruby-index-page-display-even-if-nil-currently-get-undefined-error", "title": "Ruby index page display even if nil, currently get undefined error", "body": "<p>Hi i am trying to get my index page for PROPERTY'S to show which tenants are in the current property.</p>\n\n<p>I have got it working on my show.html page by doing the following </p>\n\n<pre><code>    .wrapper_with_padding\n      #house.show\n        %h1= @house.title\n        %p= number_to_currency(@house.price, :unit =&gt; \"\u00a3\")\n        %p= simple_format(@house.description)\n        Occupied: #{@house.occupied}\n        %br/\n        -if @house.tenant.present?\n          Tenant: #{@house.tenant.first_name} #{@house.tenant.last_name}\n        -else\n          %p= 'No Tenant Assigned'\n</code></pre>\n\n<p>How can i adapt this same approach for my index page, this is what i have at the moment, but i get error 'tenant' undefined.</p>\n\n<pre><code>.wrapper_with_padding\n  #houses.clearfix\n    - unless @houses.blank?\n      - @houses.each do |house|\n        %a{ href: (url_for [house])}\n          .house\n            %p.title= house.title\n            %p.postcode= 'Postcode: ' + (house.postcode)\n            %p.price= number_to_currency(house.price, :unit =&gt; \"\u00a3\") + ' per month'\n            -if @house.tenant.present?\n              %p.tenant_id= @house.tenant.first_name\n            -else\n              %p No Tenant Assigned\n    - else\n      %h2 Add a Property\n      %p It appears you have not added any property's\n\n    %button= link_to \"New Property\", new_house_path\n</code></pre>\n\n<p>Here is the full stack trace </p>\n\n<pre><code>Showing C:/Sites/landlord2/app/views/houses/index.html.haml where line #10 raised:\n\nundefined method `tenant' for nil:NilClass\nRails.root: C:/Sites/landlord2\n\nApplication Trace | Framework Trace | Full Trace\napp/views/houses/index.html.haml:10:in `block in _app_views_houses_index_html_haml__260246869_75400416'\napp/views/houses/index.html.haml:4:in `_app_views_houses_index_html_haml__260246869_75400416'\n</code></pre>\n"}, {"tags": ["ruby", "postgresql", "heroku", "postgres.app"], "comments": [{"owner": {"reputation": 1934, "user_id": 10667839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ee13d3681ace95a1c13693db607f72?s=128&d=identicon&r=PG&f=1", "display_name": "clamp", "link": "https://stackoverflow.com/users/10667839/clamp"}, "edited": false, "score": 0, "creation_date": 1549491146, "post_id": 54542750, "comment_id": 95925608, "body": "Your local pg_hba.conf file is not relevant. The one on the server, you are trying to connect to is! Check the connection params of the app you are trying to run. Your local pg installation may have changed some relevant Env variables. See: <a href=\"https://www.postgresql.org/docs/11/libpq-envars.html\" rel=\"nofollow noreferrer\">libpq env variables</a>"}], "answers": [{"comments": [{"owner": {"reputation": 16900, "user_id": 597992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d265520bc3ae286b9b3e05e35812cc97?s=128&d=identicon&r=PG", "display_name": "jpw", "link": "https://stackoverflow.com/users/597992/jpw"}, "edited": false, "score": 0, "creation_date": 1549426178, "post_id": 54543492, "comment_id": 95893459, "body": "literally, the exact same code (which uses only remote heroku postgres) stopped being able to access the remote databases after I installed the postgres.app on my dev&#39;t machine for an unrelated app."}, {"owner": {"reputation": 51, "user_id": 6460010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5d4229e4f5fa39c92363474387b8e3d?s=128&d=identicon&r=PG", "display_name": "Rovel", "link": "https://stackoverflow.com/users/6460010/rovel"}, "reply_to_user": {"reputation": 16900, "user_id": 597992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d265520bc3ae286b9b3e05e35812cc97?s=128&d=identicon&r=PG", "display_name": "jpw", "link": "https://stackoverflow.com/users/597992/jpw"}, "edited": false, "score": 1, "creation_date": 1549488835, "post_id": 54543492, "comment_id": 95924653, "body": "probably your path was set to this heroku db and now points to the postgres app, does the postgres app is active and running a db server?"}, {"owner": {"reputation": 1934, "user_id": 10667839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ee13d3681ace95a1c13693db607f72?s=128&d=identicon&r=PG&f=1", "display_name": "clamp", "link": "https://stackoverflow.com/users/10667839/clamp"}, "edited": false, "score": 0, "creation_date": 1549491061, "post_id": 54543492, "comment_id": 95925572, "body": "@Rovel OP is trying to connect to a pg-database on a remote machine."}, {"owner": {"reputation": 16900, "user_id": 597992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d265520bc3ae286b9b3e05e35812cc97?s=128&d=identicon&r=PG", "display_name": "jpw", "link": "https://stackoverflow.com/users/597992/jpw"}, "edited": false, "score": 0, "creation_date": 1549560164, "post_id": 54543492, "comment_id": 95955193, "body": "@Rovel your mention of paths got me on the right track, thanks!"}], "tags": [], "owner": {"reputation": 51, "user_id": 6460010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5d4229e4f5fa39c92363474387b8e3d?s=128&d=identicon&r=PG", "display_name": "Rovel", "link": "https://stackoverflow.com/users/6460010/rovel"}, "is_accepted": false, "score": 0, "last_activity_date": 1549402819, "creation_date": 1549402819, "answer_id": 54543492, "question_id": 54542750, "link": "https://stackoverflow.com/questions/54542750/ruby-app-no-longer-able-to-access-remote-heroku-postgres-after-installing-post/54543492#54543492", "title": "Ruby app no longer able to access remote Heroku Postgres - AFTER installing Postgres.app locally", "body": "<p>It looks like your script is trying to connect somewhere that is not properly configured</p>\n\n<p>Things to check in that case:</p>\n\n<ol>\n<li><p>your database.yml or connection string, DATABASE_URL matches your localhost from postgres.app</p></li>\n<li><p>is your postgres.app is running and have a db server running (check the elephant icon on the top bar of your osx)</p></li>\n<li><p>You installed and configured properly the postgres app you need to set the path, you can check by typing psql in a new terminal window, if it runs is ok to go.</p></li>\n</ol>\n\n<blockquote>\n  <p>Configure your $PATH to use the included command line tools (optional):</p>\n</blockquote>\n\n<pre><code>sudo mkdir -p /etc/paths.d &amp;&amp;\necho /Applications/Postgres.app/Contents/Versions/latest/bin | sudo tee /etc/paths.d/postgresapp\n</code></pre>\n\n<ol start=\"4\">\n<li>post your file or part of it in the question, it helps a lot to debug :)</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 16900, "user_id": 597992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d265520bc3ae286b9b3e05e35812cc97?s=128&d=identicon&r=PG", "display_name": "jpw", "link": "https://stackoverflow.com/users/597992/jpw"}, "is_accepted": true, "score": 0, "last_activity_date": 1549560105, "creation_date": 1549560105, "answer_id": 54578899, "question_id": 54542750, "link": "https://stackoverflow.com/questions/54542750/ruby-app-no-longer-able-to-access-remote-heroku-postgres-after-installing-post/54578899#54578899", "title": "Ruby app no longer able to access remote Heroku Postgres - AFTER installing Postgres.app locally", "body": "<p>The answer turned out to be:</p>\n\n<ol>\n<li>comment out <code>pg</code> in Gemfile</li>\n<li><code>bundle install</code></li>\n<li>replace <code>pg</code></li>\n<li><code>bundle install</code></li>\n</ol>\n\n<p>I suspect when the gem <code>pg</code> is installed, it <em>dynamically</em> establishes some link to postgresql, so if you <em>move</em> postgresql (as I did when I installed Postgres.app) you need to remove the <code>pg</code> gem then re-add it.</p>\n"}], "owner": {"reputation": 16900, "user_id": 597992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d265520bc3ae286b9b3e05e35812cc97?s=128&d=identicon&r=PG", "display_name": "jpw", "link": "https://stackoverflow.com/users/597992/jpw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 54578899, "answer_count": 2, "score": 0, "last_activity_date": 1549560105, "creation_date": 1549399510, "last_edit_date": 1549401090, "question_id": 54542750, "link": "https://stackoverflow.com/questions/54542750/ruby-app-no-longer-able-to-access-remote-heroku-postgres-after-installing-post", "title": "Ruby app no longer able to access remote Heroku Postgres - AFTER installing Postgres.app locally", "body": "<p>For months now, a ruby (sinatra) app \"foo.rb\" on my dev't Mac has been using a remote Heroku-hosted Postgres database.</p>\n\n<p>The app does not use ANY local database, neither in development nor production.</p>\n\n<p>For another project, I installed Postgress.app from Heroku, first removing a very OLD version as recommended, using <code>brew remove postgresql</code></p>\n\n<p>The next time I ran foo.rb, and tried at access the (remote) database with SomeModel.count, I get the error:</p>\n\n<p><strong>PG::ConnectionBad: FATAL:  no pg_hba.conf entry for host , user , database , SSL off</strong></p>\n\n<p>I'm confused why the error shows my devt machine address when the database connection config points to a remote postgres url, and why it says SSL off.</p>\n\n<p>Any thoughts how to get rid of the error? Is there any way to see the PATH to the pg_hba.conf it is complaining about, so I can verify it contains the correct host entries?</p>\n\n<p>(I wonder if the pg gem has its own copy squirreled away somewhere.)</p>\n\n<p>The copies of pg_hba.conf that I can find (in /Library/Application Support/XXXX for both the old and new Postgress.app versions) have the correct (and unchanged) host entries. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1549435307, "post_id": 54542527, "comment_id": 95896165, "body": "I will simply suggest you to read <code>Hash</code> &amp; <code>Array</code> first because question shows you do not know it."}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 19, "user_id": 9765541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6700dc1dc9c3ee73eff0d07ecbfffe31?s=128&d=identicon&r=PG&f=1", "display_name": "Rata", "link": "https://stackoverflow.com/users/9765541/rata"}, "edited": false, "score": 2, "creation_date": 1549438705, "post_id": 54542586, "comment_id": 95897530, "body": "@Ratata: &quot;it doesn&#39;t work&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 19, "user_id": 9765541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6700dc1dc9c3ee73eff0d07ecbfffe31?s=128&d=identicon&r=PG&f=1", "display_name": "Rata", "link": "https://stackoverflow.com/users/9765541/rata"}, "edited": false, "score": 0, "creation_date": 1549457689, "post_id": 54542586, "comment_id": 95908022, "body": "Im trying to have an array with the elements pta.hex and toto.hex"}, {"owner": {"reputation": 19, "user_id": 9765541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6700dc1dc9c3ee73eff0d07ecbfffe31?s=128&d=identicon&r=PG&f=1", "display_name": "Rata", "link": "https://stackoverflow.com/users/9765541/rata"}, "edited": false, "score": 0, "creation_date": 1549544650, "post_id": 54542586, "comment_id": 95945719, "body": "@Gabbar yes it finally it was the first solution you proposed <code>my_array = [&quot;fofo&quot; =&gt; pta , &quot;toto&quot; =&gt; toto]</code>"}, {"owner": {"reputation": 4043, "user_id": 8895292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "SOS", "link": "https://stackoverflow.com/users/8895292/sos"}, "reply_to_user": {"reputation": 19, "user_id": 9765541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6700dc1dc9c3ee73eff0d07ecbfffe31?s=128&d=identicon&r=PG&f=1", "display_name": "Rata", "link": "https://stackoverflow.com/users/9765541/rata"}, "edited": false, "score": 0, "creation_date": 1549556178, "post_id": 54542586, "comment_id": 95952794, "body": "@Ratata - If the previous answer worked, feel free to ask the author to update their answer (It&#39;s likely submitting an edit like that will get rejected in the &quot;Review&quot; queue :)"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 0, "last_activity_date": 1567626672, "last_edit_date": 1567626672, "creation_date": 1549398738, "answer_id": 54542586, "question_id": 54542527, "link": "https://stackoverflow.com/questions/54542527/syntax-error-unexpected-expecting/54542586#54542586", "title": "Syntax error, unexpected &#39;}&#39;, expecting =&gt;", "body": "<p>Remove this piece of code </p>\n\n<pre><code>tab=Hash.new\npta = alpha[1]\ntoto = alpha[2]\ntab={pta.hex, toto.hex}\n</code></pre>\n\n<p>If you want an array with the elements <code>pta.hex</code> and <code>toto.hex</code>, use this:</p>\n\n<pre><code>my_array = [\"fofo\" =&gt; pta , \"toto\" =&gt; toto]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 404, "user_id": 3790990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3P9YY.png?s=128&g=1", "display_name": "elvinas", "link": "https://stackoverflow.com/users/3790990/elvinas"}, "is_accepted": false, "score": 2, "last_activity_date": 1549403677, "creation_date": 1549403677, "answer_id": 54543636, "question_id": 54542527, "link": "https://stackoverflow.com/questions/54542527/syntax-error-unexpected-expecting/54543636#54543636", "title": "Syntax error, unexpected &#39;}&#39;, expecting =&gt;", "body": "<p>Seems that you are not forming your hash correctly. So you have two options:</p>\n\n<ul>\n<li><p>Go for a <strong>Hash</strong>:</p>\n\n<p><code>tab = { key1: pta.hex, key2: toto.hex }</code></p></li>\n<li><p>Seems that you're trying to build an <strong>Array</strong>:</p>\n\n<p><code>tab = [pta.hex, toto.hex]</code></p></li>\n</ul>\n"}], "owner": {"reputation": 19, "user_id": 9765541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6700dc1dc9c3ee73eff0d07ecbfffe31?s=128&d=identicon&r=PG&f=1", "display_name": "Rata", "link": "https://stackoverflow.com/users/9765541/rata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 54542586, "answer_count": 2, "score": -4, "last_activity_date": 1567626672, "creation_date": 1549398499, "last_edit_date": 1549459904, "question_id": 54542527, "link": "https://stackoverflow.com/questions/54542527/syntax-error-unexpected-expecting", "title": "Syntax error, unexpected &#39;}&#39;, expecting =&gt;", "body": "<p>Trying to run code that contains the following lines:</p>\n\n<pre><code>tab=Hash.new\npta = alpha[1]\ntoto = alpha[2]\ntab={pta.hex, toto.hex}\n</code></pre>\n\n<p>And I got this error:</p>\n\n<pre><code>syntax error, unexpected ',', expecting =&gt;\n tab={pta.hex, pta.hex}\n</code></pre>\n\n<p>I don't think it's a space error.</p>\n"}, {"tags": ["ruby", "irb"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1549397245, "post_id": 54542126, "comment_id": 95885624, "body": "Can you be more specific about the component here that&#39;s not working as expected?"}, {"owner": {"reputation": 35, "user_id": 4557599, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZcXRr.jpg?s=128&g=1", "display_name": "CookieMonstROR-JS", "link": "https://stackoverflow.com/users/4557599/cookiemonstror-js"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1549397686, "post_id": 54542126, "comment_id": 95885828, "body": "This is working as expected if ran in terminal, ie: ruby string_fundamentals.rb. My question is, if we run just x = [(rand 2)==1, (rand 5)==3, (rand 11)==6] in ruby console it returns =&gt; [true, true, false] each &amp; every time we call x... why?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1549399979, "post_id": 54542126, "comment_id": 95886804, "body": "Rather than beginning lines that follow a newline with a period (which is fine with command-line Ruby), insert the period at the end of the line, before the newline. That tells IRB that the statement is being chained to the next line. Without the period at the end of the line, IRB (and I assume PRY), due to its interactive nature, does not realize the the line is being chained. IRB simply disregards periods that begin lines."}, {"owner": {"reputation": 35, "user_id": 4557599, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZcXRr.jpg?s=128&g=1", "display_name": "CookieMonstROR-JS", "link": "https://stackoverflow.com/users/4557599/cookiemonstror-js"}, "edited": false, "score": 0, "creation_date": 1549400119, "post_id": 54542126, "comment_id": 95886862, "body": "Thanks for your comment, but my code does not contain a semicolon after the initial interpolation string. Plus I am not doing puts in console, just x = [(rand 2)==1, (rand 5)==3, (rand 11)==6] then x, x, x etc..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549401612, "post_id": 54542126, "comment_id": 95887491, "body": "My comment has nothing to do with semicolons. Remember: when using IRB, put periods at the end, rather than beginning, of lines"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4557599, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZcXRr.jpg?s=128&g=1", "display_name": "CookieMonstROR-JS", "link": "https://stackoverflow.com/users/4557599/cookiemonstror-js"}, "edited": false, "score": 0, "creation_date": 1549400276, "post_id": 54542720, "comment_id": 95886918, "body": "Thank you very much, kind regards Michael."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549401344, "post_id": 54542720, "comment_id": 95887372, "body": "Cookie, this could be generalized to <code>def x(arr); arr.map { |a,b| rand(a) == b }; end</code>, so <code>x([[2,1],[5,3],[11,6]]) #=&gt; [true, false, false]</code>, <code>x([[2,1],[5,3],[11,6],[3,1]]) #=&gt; =&gt; [true, false, false, false]</code>,"}, {"owner": {"reputation": 35, "user_id": 4557599, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZcXRr.jpg?s=128&g=1", "display_name": "CookieMonstROR-JS", "link": "https://stackoverflow.com/users/4557599/cookiemonstror-js"}, "edited": false, "score": 0, "creation_date": 1549429643, "post_id": 54542720, "comment_id": 95894290, "body": "Cary, I loved this test approach so much I implemented the construct within a method which takes 4 standard arguments: def manipulate_string(str, arr, tru, fal) return str.strip.gsub(&#39; &#39;, &#39;&#39;).split(//).map{ |char| query = arr.map{ |t,f| rand(t)==f }; query.any? ? &quot;#{char + tru.sample}&quot; : &quot;#{char.upcase + fal.sample}&quot; }.join.chop end Thank you."}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 3, "last_activity_date": 1549399358, "creation_date": 1549399358, "answer_id": 54542720, "question_id": 54542126, "link": "https://stackoverflow.com/questions/54542126/why-does-the-array-return-a-random-boolean-during-the-enumeration-of-the-full-na/54542720#54542720", "title": "Why does the array return a random boolean during the enumeration of the full_name, but not in ruby console? irb", "body": "<pre><code>x = [(rand 2)==1, (rand 5)==3, (rand 11)==6]\n</code></pre>\n\n<p>This constructs an array with three elements and stores it in <code>x</code>. The values in that array are random, but they are determined <em>when the array is constructed</em>. Whenever you look at <code>x</code> it will always be the same three element array, because the random calls have already been made and the result has been stored in the array.</p>\n\n<p>The problem is that <code>x</code> is just a pointer to some values in memory. You can't \"call\" it. To get a different result every time, you need x to be a method</p>\n\n<pre><code>def x\n  [(rand 2)==1, (rand 5)==3, (rand 11)==6]\nend\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4557599, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZcXRr.jpg?s=128&g=1", "display_name": "CookieMonstROR-JS", "link": "https://stackoverflow.com/users/4557599/cookiemonstror-js"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 54542720, "answer_count": 1, "score": 0, "last_activity_date": 1549438140, "creation_date": 1549396784, "last_edit_date": 1549438140, "question_id": 54542126, "link": "https://stackoverflow.com/questions/54542126/why-does-the-array-return-a-random-boolean-during-the-enumeration-of-the-full-na", "title": "Why does the array return a random boolean during the enumeration of the full_name, but not in ruby console? irb", "body": "<p>Why does the array ( within the map block ) only return [true, true, false] if executed in ruby console as: x = [(rand 2)==1, (rand 5)==3, (rand 11)==6] then x, x, x?</p>\n\n<pre><code>first = \"stephanie\"\nlast = \"devenport\"\nmiddle = \"Lbp\"\n\nfull_name = \"#{first} #{middle} #{last}\"\n\nputs \"#{full_name}\\s\\s\\s\\s\\s\"\n.rstrip.gsub(' ', '').split(//)\n.map{ |char| [(rand 2)==1, (rand 5)==3, (rand 11)==6].any? ? \"#{char + ['~', '%', '^', '#'].sample}\" : \"#{char.upcase + ['-', '_'].sample}\" }.join.chop\n</code></pre>\n\n<p>run within terminal returns => S_t~e~p~h#A_n~i^E_L_b~P-d~e^v#E_n%p~o~R-T</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "file-upload", "controller", "multipartform-data"], "comments": [{"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1549406631, "post_id": 54541866, "comment_id": 95889345, "body": "Can you please post your controller logs?"}, {"owner": {"reputation": 635, "user_id": 361378, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b282fba6a3c1038876b724fe4f1d0557?s=128&d=identicon&r=PG", "display_name": "Zahra I.S", "link": "https://stackoverflow.com/users/361378/zahra-i-s"}, "reply_to_user": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1549494172, "post_id": 54541866, "comment_id": 95926656, "body": "I actually realized my mistake. It does look like it&#39;s extra header on top of actual file data but that just happens when it&#39;s sent in the format of <code>ActionDispatch::Http::UploadedFile</code>. So, I just needed to use params[:uploaded_data].tempfile to get the file :)"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1549560138, "post_id": 54541866, "comment_id": 95955182, "body": "In that case, please answer your own question and close it out :)"}], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 361378, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b282fba6a3c1038876b724fe4f1d0557?s=128&d=identicon&r=PG", "display_name": "Zahra I.S", "link": "https://stackoverflow.com/users/361378/zahra-i-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1550090457, "creation_date": 1550090457, "answer_id": 54679059, "question_id": 54541866, "link": "https://stackoverflow.com/questions/54541866/how-to-consume-multipart-form-data-via-ruby-controllers/54679059#54679059", "title": "How to consume Multipart/form-data via Ruby Controllers?", "body": "<p>I actually realized my mistake. It does look like it's extra header on top of actual file data but that just happens when it's sent in the format of ActionDispatch::Http::UploadedFile. So, I just needed to use params[:uploaded_data].tempfile to get the file :)</p>\n"}], "owner": {"reputation": 635, "user_id": 361378, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b282fba6a3c1038876b724fe4f1d0557?s=128&d=identicon&r=PG", "display_name": "Zahra I.S", "link": "https://stackoverflow.com/users/361378/zahra-i-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 0, "accepted_answer_id": 54679059, "answer_count": 1, "score": 0, "last_activity_date": 1550090457, "creation_date": 1549395595, "question_id": 54541866, "link": "https://stackoverflow.com/questions/54541866/how-to-consume-multipart-form-data-via-ruby-controllers", "title": "How to consume Multipart/form-data via Ruby Controllers?", "body": "<p>I know I'm receiving a file with <code>Content-Type</code>: <code>multipart/form-data</code> in my controller and I understand the file was uploaded with something like this:</p>\n\n<pre><code>body[:uploaded_data] = Faraday::UploadIO.new(path, mime_type, hash[:filename])\n</code></pre>\n\n<p>and the content of the file I receive is like this</p>\n\n<pre><code>    -------------RubyMultipartPost\nContent-Disposition: form-data; name=\"filename\"\n\n1_BsKbDTA9ZUVroeJ7asId4Q.png\n-------------RubyMultipartPost\nContent-Disposition: form-data; name=\"uploaded_data\"; filename=\"RackMultipart20190205-12268-1eli4dv\"\nContent-Length: 34441\nContent-Type: image/png\nContent-Transfer-Encoding: binary\n\n\u2030PNG\n\n\n IHDR\naw\u00f9\u00e9\u00a8gP\\\u00c6\u00f1\u00c7\u00e8\u0152\u00ce\u00cc_\u00fd....\n</code></pre>\n\n<p>I'm trying to parse this so that I only get the content of the <code>png</code> file and save it as an actual <code>png</code> file. </p>\n\n<p>I started by making a mock Rack env and parse it</p>\n\n<pre><code>env = Rack::MockRequest.env_for(\n        '/',\n        'CONTENT_TYPE' =&gt; request.headers['Content-Type'],\n        'CONTENT_LENGTH' =&gt; request.body.length,\n        'rack.input' =&gt; StringIO.new(request.body.read),\n    )\n    parsed_message = Rack::Multipart.parse_multipart(env)\n</code></pre>\n\n<p>and I know <code>parsed_message['uploaded_data']</code> has the second part but I still don't know how to properly parse out the 4 lines that include <code>Content-Disposition, Content-Length, Content-Type, Content-Transfer-Encoding</code> and get only the file content.</p>\n\n<p>Any ideas are appreciated!</p>\n"}, {"tags": ["javascript", "css", "ruby-on-rails", "ruby", "forms"], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 2488011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S91lB.jpg?s=128&g=1", "display_name": "Dan Hodgins", "link": "https://stackoverflow.com/users/2488011/dan-hodgins"}, "is_accepted": false, "score": 0, "last_activity_date": 1549437125, "creation_date": 1549437125, "answer_id": 54548354, "question_id": 54541221, "link": "https://stackoverflow.com/questions/54541221/submitting-form-only-working-sometimes-after-implementing-bootstrap-styles-ruby/54548354#54548354", "title": "Submitting form only working sometimes after implementing bootstrap styles ruby on rails 5", "body": "<p>Have you tried restarting your computer? </p>\n\n<p>I realize this is a very simplistic answer, but it can sometimes work wonders. </p>\n\n<p>Good luck resolving : ) </p>\n\n<p>Dan </p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 10933565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/la3ve.jpg?s=128&g=1", "display_name": "Michael Mudge", "link": "https://stackoverflow.com/users/10933565/michael-mudge"}, "is_accepted": true, "score": 0, "last_activity_date": 1549529693, "creation_date": 1549529693, "answer_id": 54569522, "question_id": 54541221, "link": "https://stackoverflow.com/questions/54541221/submitting-form-only-working-sometimes-after-implementing-bootstrap-styles-ruby/54569522#54569522", "title": "Submitting form only working sometimes after implementing bootstrap styles ruby on rails 5", "body": "<p>I think it was either bootstrap or carrierwave uploaded breaking my form. I solved the problem by deleting bootstrap from my entire app, and also deleting carrierwave and upgrading to active storage for image uploading (so much better than carrierwave) and then re implementing bootstrap. Now I\u2019m golden, thanks the response!</p>\n"}], "owner": {"reputation": 57, "user_id": 10933565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/la3ve.jpg?s=128&g=1", "display_name": "Michael Mudge", "link": "https://stackoverflow.com/users/10933565/michael-mudge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 54569522, "answer_count": 2, "score": -1, "last_activity_date": 1549529693, "creation_date": 1549392836, "last_edit_date": 1549394463, "question_id": 54541221, "link": "https://stackoverflow.com/questions/54541221/submitting-form-only-working-sometimes-after-implementing-bootstrap-styles-ruby", "title": "Submitting form only working sometimes after implementing bootstrap styles ruby on rails 5", "body": "<p>So I am trying to submit my form for a listing. I added carrierwave-aws and got my image uploader to work in the form, then after adding bootstrap styles to my form it seems to only submit <em>sometimes</em> and then other times I click the submit button and <em>nothing</em> happens. No errors in the console, no activity in the local host server. One time it works, the next it seems to freeze/break with no activity.</p>\n\n<p>My googling has led me to think maybe its something to do with turbolinks, or a missing html tag (I dont think its the missing tag).</p>\n\n<p>Here is my _form partial</p>\n\n<pre><code>&lt;div class=\"card w-75 text-left form-card\"&gt;\n  &lt;div class=\"card-body form-card-body\"&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;div class=\"col-md-6\"&gt;\n\n\n        &lt;%= form_for @listing, multipart: true do |f| %&gt;\n        &lt;% if listing.errors.any? %&gt;\n        &lt;div id=\"error_explanation\"&gt;\n          &lt;h2&gt;&lt;%= pluralize(listing.errors.count, \"error\") %&gt; prohibited this listing from being saved:&lt;/h2&gt;\n\n          &lt;ul&gt;\n            &lt;% listing.errors.full_messages.each do |message| %&gt;\n            &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n            &lt;% end %&gt;\n          &lt;/ul&gt;\n        &lt;/div&gt;\n        &lt;% end %&gt;\n\n\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :name %&gt;\n          &lt;%= f.text_field :name, placeholder: 'ex. Mission Grove Plaza', class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :street %&gt;\n          &lt;%= f.text_field :street, placeholder: 'ex. 140 Main St.', class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :suite_number %&gt;\n          &lt;%= f.text_field :suite_number, placeholder: 'ex. Suite 145', class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :city %&gt;\n          &lt;%= f.text_field :city, class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :state %&gt;\n          &lt;%= f.select :state, ['California'], :prompt =&gt; 'Select One', class: 'form-control' %&gt;\n\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :zipcode %&gt;\n          &lt;%= f.number_field :zipcode, class: 'form-control' %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n\n      &lt;div class=\"col-md-6\"&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :building_type %&gt;\n          &lt;%= f.text_field :building_type, placeholder: 'ex. Office, Retail, Industrial', class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :available_sqft %&gt;\n          &lt;%= f.number_field :available_sqft, class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :year_built %&gt;\n          &lt;%= f.number_field :year_built, class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :asking_rate %&gt;\n          &lt;%= f.number_field :asking_rate, class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :transaction_type %&gt;\n          &lt;%= f.text_field :transaction_type, placeholder: 'Lease or Sale', class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :land_size %&gt;\n          &lt;%= f.number_field :land_size, class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :market %&gt;\n          &lt;%= f.text_field :market, placeholder: 'ex. Riverside, Corona, Redlands', class: 'form-control' %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n\n            Upload main image(s) &lt;%= f.file_field :images, multiple: true, accept: \"image/jpeg, image/jpg, image/gif, image/png\" %&gt;\n\n          &lt;p&gt;&lt;em&gt;Please upload all main images at once using shift+click to select all files you want to upload.&lt;/em&gt;&lt;/p&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n\n            Upload thumb image &lt;%= f.file_field :thumb_image %&gt;\n\n          &lt;p&gt;&lt;em&gt;You can only upload one thumb image.&lt;/em&gt;&lt;/p&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n\n    &lt;/div&gt;\n\n\n      &lt;%= f.submit \"Submit\", class: 'btn btn-primary' %&gt;\n\n    &lt;% end %&gt;\n\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>here is my layout/application</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;&lt;%= @page_title %&gt;&lt;/title&gt;\n    &lt;%= csrf_meta_tags %&gt;\n    &lt;%= csp_meta_tag %&gt;\n\n    &lt;meta name=\"keywords\" content=\"&lt;%= @seo_keywords %&gt;\"/&gt;\n\n    &lt;%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n\n    &lt;link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.7.1/css/all.css\" integrity=\"sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr\" crossorigin=\"anonymous\"&gt;\n\n\n\n    &lt;%= javascript_include_tag 'https://maps.googleapis.com/maps/api/js?key='+Rails.application.credentials.google_maps_api_key %&gt;\n\n    &lt;%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %&gt;\n    &lt;%= yield(:head_tags) %&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n   &lt;%= render 'shared/nav' %&gt;\n\n    &lt;%= yield %&gt;\n\n    &lt;%= alerts %&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>here is my application.js</p>\n\n<pre><code>//= require rails-ujs\n//= require jquery3\n//= require jquery-ui\n//= require activestorage\n//= require cocoon\n//= require gritter\n//= require bootstrap-sprockets\n//= require turbolinks\n//= require_tree .\n\nfunction initMap(lat, lng) {\n    var myCoords = new google.maps.LatLng(lat, lng);\n    var mapOptions = {\n    center: myCoords,\n    zoom: 13\n    };\n    var map = new google.maps.Map(document.getElementById('map'), mapOptions);\n\n    var marker = new google.maps.Marker({\n    position: myCoords,\n    map: map\n});\n}\n</code></pre>\n\n<p>in my application.scss I have </p>\n\n<pre><code>@import \"bootstrap-sprockets\";\n@import \"bootstrap\";\n</code></pre>\n\n<p>and in my Gemfile I have </p>\n\n<pre><code>gem 'bootstrap-sass', '~&gt; 3.4.0'\ngem 'sassc-rails', '&gt;= 2.0.0'\n</code></pre>\n\n<p>also here is my listing controller</p>\n\n<pre><code>    class ListingsController &lt; ApplicationController\n      before_action :set_listing, only: [:show, :edit, :update, :destroy]\n\n      access all: [:show, :index], user: {except: [:destroy, :new, :create, :update, :edit]}, site_admin: :all\n\n\n      def index\n        search_listings\n        @page_title = \"Mudge Advisor's | Listings\"\n      end\n\n      def show\n        @page_title = @listing.street\n        @seo_keywords = @listing.set_address\n      end\n\n      def new\n        @listing = Listing.new\n      end\n\n      def edit\n      end\n\n      def create\n        @listing = Listing.new(listing_params)\n\n        respond_to do |format|\n          if @listing.save\n            format.html { redirect_to @listing, notice: 'Listing was successfully created.' }\n            format.json { render :show, status: :created, location: @listing }\n          else\n            format.html { render :new }\n            format.json { render json: @listing.errors, status: :unprocessable_entity }\n          end\n        end\n      end\n\n      def update\n        respond_to do |format|\n          if @listing.update(listing_params)\n            format.html { redirect_to @listing, notice: 'Listing was successfully updated.' }\n            format.json { render :show, status: :ok, location: @listing }\n          else\n            format.html { render :edit }\n            format.json { render json: @listing.errors, status: :unprocessable_entity }\n          end\n        end\n      end\n\n      def destroy\n        @listing.destroy\n        respond_to do |format|\n          format.html { redirect_to listings_url, notice: 'Listing was successfully destroyed.' }\n          format.json { head :no_content }\n        end\n      end\n\n      private\n\n      def set_listing\n        @listing = Listing.find(params[:id])\n      end\n\n      def listing_params\n        params.require(:listing).permit(:name,\n                                        :street,\n                                        :city,\n                                        :state,\n                                        :zipcode,\n                                        :building_type,\n                                        :available_sqft,\n                                        :year_built,\n                                        :asking_rate,\n                                        :land_size,\n                                        :market,\n                                        { images: []},\n                                        :thumb_image,\n                                        :suite_number,\n                                        :transaction_type\n                                        )\n      end\n\n      def search_listings\n        if params[:query]\n          search_words = params[:query]\n          if !params[:query].empty?\n            @listings = Listing.kinda_matching(search_words)\n          else\n            flash[:notice] = \"Search can't be empty\"\n            @listings = Listing.all\n          end\n          @listings\n        else\n        @listings = Listing.all\n        end\n      end\n    end\n\n\nand listing model\n\nclass Listing &lt; ApplicationRecord\n  validates :street,\n            :city,\n            :state,\n            :zipcode,\n            :country,\n            :building_type,\n            :asking_rate,\n            :market,\n            :transaction_type,\n                          presence: true\n\n  validates :street, uniqueness: true\n\n  mount_uploader :thumb_image, ListingUploader\n  mount_uploaders :images, ListingUploader\n\n  include PgSearch\n  pg_search_scope :kinda_matching,\n                                    :against =&gt; [:name,\n                                                :street,\n                                                :city,\n                                                :state,\n                                                :zipcode,\n                                                :building_type,\n                                                :suite_number,\n                                                :transaction_type,\n                                                :market\n                                                ],\n                                    :using =&gt; {\n                                      :tsearch =&gt; {:prefix =&gt; true}\n                                  }\n\n  geocoded_by :set_address\n  after_validation :geocode\n\n  def set_address\n    \"#{self.street}, #{self.city}, #{self.state}, #{self.zipcode.to_s}, #{self.country}\"\n  end\nend\n</code></pre>\n\n<p>here is my server </p>\n\n<pre><code>Started GET \"/listings/50/edit\" for 127.0.0.1 at 2019-02-05 19:33:57 +0100\nProcessing by ListingsController#edit as HTML\n  Parameters: {\"id\"=&gt;\"50\"}\n  Listing Load (2.9ms)  SELECT  \"listings\".* FROM \"listings\" WHERE \"listings\".\"id\" = $1 LIMIT $2  [[\"id\", 50], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/listings_controller.rb:61\n  User Load (0.3ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 13], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/concerns/current_user_concern.rb:5\n  Rendering listings/edit.html.erb within layouts/application\n  Rendered listings/_form.html.erb (13.8ms)\n  Rendered listings/edit.html.erb within layouts/application (17.0ms)\n  Rendered shared/_nav.html.erb (0.5ms)\nCompleted 200 OK in 246ms (Views: 235.7ms | ActiveRecord: 3.4ms)\n</code></pre>\n\n<p>I know it's a lot and if you're still with me thanks so much. Any help would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "automation", "continuous-integration"], "owner": {"reputation": 153, "user_id": 8720632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c6968c197a712ca96e5291468ee24a?s=128&d=identicon&r=PG&f=1", "display_name": "sai charan", "link": "https://stackoverflow.com/users/8720632/sai-charan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1549391810, "creation_date": 1549391810, "question_id": 54540944, "link": "https://stackoverflow.com/questions/54540944/rubyonrails-qa-automation-web-application", "title": "RubyonRails QA Automation Web application", "body": "<p>I have deployed a ruby on rails puma server on an Amazon box with server code that runs in the same box behind the UI. I wanted to deploy the duplicate puma server on two other Mac book instances as well so that i can control on what agent I have to run.</p>\n\n<p>Is this the right approach? \nIs it possible to dictate the Agent selection from the UI? How can i do it for my application thereby using amazon and live Mac boxes as agents?</p>\n"}, {"tags": ["arrays", "ruby", "function", "random", "hash"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10495960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3EvV.jpg?s=128&g=1", "display_name": "breycarr", "link": "https://stackoverflow.com/users/10495960/breycarr"}, "edited": false, "score": 0, "creation_date": 1549472836, "post_id": 54540265, "comment_id": 95917434, "body": "This really helped in cleaning up the code, but the output ended up providing the key values, eg:  &#39;[:A,:E,:O]&#39;  So I would then need to exchange the keys to strings"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1549388890, "creation_date": 1549388890, "answer_id": 54540265, "question_id": 54540031, "link": "https://stackoverflow.com/questions/54540031/weighted-letter-generator/54540265#54540265", "title": "Weighted Letter Generator", "body": "<p>The problem is here:</p>\n\n<pre><code>x.times {print v_choice.shuffle!.pop}\n</code></pre>\n\n<p>The above prints the value <code>x</code> times and <strong>returns the value of <code>x</code></strong>. That\u2018s how <code>Integer#times</code> works.</p>\n\n<p>Instead you need:</p>\n\n<pre><code>x.times.map { v_choice.shuffle!.pop }\n</code></pre>\n\n<p>Or, better,</p>\n\n<pre><code>v_choice.shuffle!.pop(x)\n</code></pre>\n\n<p>since <code>Array#pop</code> accepts the argument.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 10495960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3EvV.jpg?s=128&g=1", "display_name": "breycarr", "link": "https://stackoverflow.com/users/10495960/breycarr"}, "edited": false, "score": 0, "creation_date": 1549472792, "post_id": 54541175, "comment_id": 95917419, "body": "The values of vowels were a finite set of numbers, so your solution provided me with a string I can then manipulate in the remainder of the code!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1549395262, "last_edit_date": 1549395262, "creation_date": 1549392638, "answer_id": 54541175, "question_id": 54540031, "link": "https://stackoverflow.com/questions/54540031/weighted-letter-generator/54541175#54541175", "title": "Weighted Letter Generator", "body": "<p>Suppose </p>\n\n<pre><code>vowels = { A: 5, E: 8, I: 4, O: 7, U: 3, Y: 1 }\n</code></pre>\n\n<p>I understand the values of this hash are the weights of drawing the associated keys. You first construct (in a different way):</p>\n\n<pre><code>v_choice = vowels.flat_map { |k,v| [k]*v }\n  #=&gt; [:A, :A, :A, :A, :A,\n  #    :E, :E, :E, :E, :E, :E, :E, :E,\n  #    :I, :I, :I, :I,\n  #    :O, :O, :O, :O, :O, :O, :O,\n  #    :U, :U, :U,\n  #    :Y] \n</code></pre>\n\n<p>Next you perform</p>\n\n<pre><code>x.times {print v_choice.shuffle!.pop}    \n</code></pre>\n\n<p>Suppose the first shuffle produces the following:</p>\n\n<pre><code>v_choice\n  #=&gt; [:O, :O, :E, :U, :U, :O, :A, :E, :E, :E, :U, :I, :A, :I,\n  #    :E, :A, :O, :O, :E, :E, :O, :A, :I, :A, :O, :E, :I, :Y] \n</code></pre>\n\n<p>and then</p>\n\n<pre><code>print v_choice.pop\n</code></pre>\n\n<p>prints <code>\"Y\"</code>, and removes the only <code>:Y</code> from <code>v_choice</code>. Therefore, (with probability 1) <code>:Y</code> will be randomly drawn no more, contradicting the fact that it has a positive weight.</p>\n\n<p>If the values of <code>vowels</code> are not weights, but numbers in a finite collection of vowels one could simplify greatly. After computing <code>v_choice</code>, one need only write</p>\n\n<pre><code>puts v_choice.sample(x).join\n  # EOOYEIIEOI\n</code></pre>\n\n<p>or</p>\n\n<pre><code>puts v_choice.shuffle[0,x].join\n  # EOOUOEEIAE\n</code></pre>\n\n<p>Now let's assume that the values of <code>vowels</code> are indeed weights. Then we need only write</p>\n\n<pre><code>x = 10\nx.times { print v_choice.sample }\n# OAEYEUAOAO\n</code></pre>\n\n<p>If the values of <code>vowels</code> are large, <code>v_choice</code> is correspondingly large. That would affect memory requirements but not execution speed. If the memory requirement were expensive (unlikely, perhaps), one could  do the following.</p>\n\n<pre><code>tot_wts = vowels.values.sum.to_f\n  #=&gt; 28.0\ncum = 0\ncum_dist = vowels.map do |v,wt|\n  cum_wt = cum + wt/tot_wts\n  cum = cum_wt\n  [v, cum_wt]\nend\n  #=&gt; [[:A, 0.17857142857142858],\n  #    [:E, 0.4642857142857143],\n  #    [:I, 0.6071428571428572],\n  #    [:O, 0.8571428571428572],\n  #    [:U, 0.9642857142857143],\n  #    [:Y, 1.0]]\n</code></pre>\n\n<p>In case of round-off error we might set</p>\n\n<pre><code>cum_dist[-1][-1] = 1.0\n</code></pre>\n\n<p>We can then produce the weighted sample thusly.</p>\n\n<pre><code>x = 10\nx.times do\n  rn = rand\n  print cum_dist.find { |_,cum| rn &lt; cum }.first\nend\n# EAAOOEEIOA\n</code></pre>\n\n<p>Note we cannot write</p>\n\n<pre><code>print cum_dist.find { |_,cum| rand &lt; cum }.first\n</code></pre>\n\n<p>because the value returned by <code>rand</code> would be constantly changing within <code>find</code>'s block.</p>\n\n<p>This technique, the so-called \"inverse transform method\", is commonly used to generate discrete random variates in simulation models.</p>\n"}], "owner": {"reputation": 5, "user_id": 10495960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3EvV.jpg?s=128&g=1", "display_name": "breycarr", "link": "https://stackoverflow.com/users/10495960/breycarr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 54541175, "answer_count": 2, "score": 0, "last_activity_date": 1549395262, "creation_date": 1549387928, "question_id": 54540031, "link": "https://stackoverflow.com/questions/54540031/weighted-letter-generator", "title": "Weighted Letter Generator", "body": "<p>I am working on a programme that creates jumbled up groups of letters, for this, I am creating 2 weighted letter generators, one for consonants, one for vowels. </p>\n\n<p>Currently I have a weighted number generator using hashes for the weighting, and I can call the letter picking function with the number of letters I want it to return (eg. pick_vowel(3))</p>\n\n<pre><code>def pick_vowel(x)\n  vowels = { A: 15, E: 21, I: 13, O: 13, U: 5 }\n  v_choice = []\n  vowels.map {|letter, number| number.times {v_choice &lt;&lt; letter}}\n  x.times {print v_choice.shuffle!.pop}\nend\n</code></pre>\n\n<p>The idea is then to pass the resulting string to a functions which gives all possible combinations of a certain length, using the code below:</p>\n\n<pre><code>def solver(vowel)\n  puts (2..9).flat_map{|size| board.combination(size).map(&amp;:join)}\nend\n</code></pre>\n\n<p>but when I pass the string I get the following error message (in this case x = 6):</p>\n\n<pre><code>in `block in solver': undefined method `combination' for 6:Integer (NoMethodError)\n</code></pre>\n\n<p>I want to convert the output string to an array, but as far as I can tell there is an integer which appears in the output string, so the array method won't apply to it. </p>\n\n<p>How do I prevent my output from containing an integer at the end?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "haml"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7132462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9543d1791ad5c02af8da3f765fd9b66c?s=128&d=identicon&r=PG&f=1", "display_name": "Kush", "link": "https://stackoverflow.com/users/7132462/kush"}, "edited": false, "score": 0, "creation_date": 1549388301, "post_id": 54539778, "comment_id": 95881438, "body": "can i ask how to get this working on my index page? at the moment i have %p.tenant_id= @house.tenant.first_name"}, {"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "reply_to_user": {"reputation": 31, "user_id": 7132462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9543d1791ad5c02af8da3f765fd9b66c?s=128&d=identicon&r=PG&f=1", "display_name": "Kush", "link": "https://stackoverflow.com/users/7132462/kush"}, "edited": false, "score": 0, "creation_date": 1549388371, "post_id": 54539778, "comment_id": 95881463, "body": "You has the same issue on index page?"}], "tags": [], "owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "is_accepted": true, "score": 1, "last_activity_date": 1549387306, "last_edit_date": 1549387306, "creation_date": 1549386976, "answer_id": 54539778, "question_id": 54539683, "link": "https://stackoverflow.com/questions/54539683/get-text-to-display-if-value-is-blank-ruby-4-undefined-method-first-name/54539778#54539778", "title": "Get text to display if value is blank ruby 4 undefined method `first_name&#39;", "body": "<p>Hay, you can just ask <code>if @house.tenant.present?</code>, and if not display the desired text, like the following code:</p>\n\n<pre><code>.wrapper_with_padding\n #house.show\n    %h1= @house.title\n    %p= number_to_currency(@house.price, :unit =&gt; \"\u00a3\")\n    %p= simple_format(@house.description)\n    Occupied: #{@house.occupied}\n    %br/\n    -if @house.tenant.present?\n      Tenant: #{@house.tenant.first_name} #{@house.tenant.last_name}\n    -else\n      %p= 'Text to display if tenant is blank'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 630, "user_id": 5763672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ca5c235400320ab800200c6677574?s=128&d=identicon&r=PG", "display_name": "Sebastian Scholl", "link": "https://stackoverflow.com/users/5763672/sebastian-scholl"}, "is_accepted": false, "score": 1, "last_activity_date": 1549389206, "creation_date": 1549389206, "answer_id": 54540337, "question_id": 54539683, "link": "https://stackoverflow.com/questions/54539683/get-text-to-display-if-value-is-blank-ruby-4-undefined-method-first-name/54540337#54540337", "title": "Get text to display if value is blank ruby 4 undefined method `first_name&#39;", "body": "<p>Personally, I'm not a big fan of filling up the view with templating logic. </p>\n\n<p>This would probably be a good place to use a helper method.</p>\n\n<p>In your house_helper.rb file, try making a <code>current_tenant</code> method that looks something like this.</p>\n\n<pre><code>  def current_tenant(house)\n    if house.tenant \n      \"#{house.tenant.first_name} #{house.tenant.last_name}\"\n    else\n      \"Vacant\"\n    end\n  end\n</code></pre>\n\n<p>Also, something like displaying a tenant's full name may be something you're doing a lot. Thus, it may be good to add a <code>full_name</code> method on your tenant model so that you can reuse it.</p>\n\n<pre><code>  class Tenant\n    ...\n    def full_name\n      \"#{first_name} #{last_name}\"\n    end\n    ...\n  end\n</code></pre>\n\n<p>That way, you can clean up the helper method to something as simple as:</p>\n\n<pre><code>  def current_tenant(house)\n    return \"Vacant\" unless house.tenant \n\n    house.tenant.full_name\n  end\n</code></pre>\n\n<p>And your view gets cleaned up as well to:</p>\n\n<pre><code>.wrapper_with_padding\n #house.show\n    %h1= @house.title\n    %p= number_to_currency(@house.price, :unit =&gt; \"\u00a3\")\n    %p= simple_format(@house.description)\n    Occupied: #{@house.occupied}\n    %br/\n    Tenant: #{current_tenant(@house)}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7132462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9543d1791ad5c02af8da3f765fd9b66c?s=128&d=identicon&r=PG&f=1", "display_name": "Kush", "link": "https://stackoverflow.com/users/7132462/kush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 54539778, "answer_count": 2, "score": 1, "last_activity_date": 1549389206, "creation_date": 1549386630, "last_edit_date": 1549388148, "question_id": 54539683, "link": "https://stackoverflow.com/questions/54539683/get-text-to-display-if-value-is-blank-ruby-4-undefined-method-first-name", "title": "Get text to display if value is blank ruby 4 undefined method `first_name&#39;", "body": "<p>im a newbie to rails so please be paitent</p>\n\n<p>currently this is my show page for houses in my views folder</p>\n\n<pre><code>.wrapper_with_padding\n #house.show\n    %h1= @house.title\n    %p= number_to_currency(@house.price, :unit =&gt; \"\u00a3\")\n    %p= simple_format(@house.description)\n    Occupied: #{@house.occupied}\n    %br/\n    Tenant: #{@house.tenant.first_name} #{@house.tenant.last_name}\n</code></pre>\n\n<p>It displays fine when the db holds a value for tenant_id in the HOUSES model, but when the tenant id is nil for a HOUSE records i get the error below.</p>\n\n<p>Showing C:/Sites/landlord2/app/views/houses/show.html.haml where line #8 raised:</p>\n\n<p>undefined method `first_name' for nil:NilClass.</p>\n\n<p>In show is there anyway to change</p>\n\n<pre><code>Tenant: #{@house.tenant.first_name} #{@house.tenant.last_name}\n</code></pre>\n\n<p>so it can display some text if the tenant_id is blank?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "comments": [{"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 1, "creation_date": 1549385168, "post_id": 54538852, "comment_id": 95879622, "body": "How are you restarting Sidekiq? It&#39;s normally stopped/restarted &quot;gracefully&quot;, meaning it will finish all running jobs first before restarting/stopping: <a href=\"https://stackoverflow.com/questions/24446157/rails-how-to-restart-sidekiq/24446989\">reference</a> But if you CTRL+C in development, yes that will close immediately, but this is in development. If you want to make sure that the &quot;update&quot; will only commit in the DB if there are no errors (i.e. only if Sidekiq is not CTRL+C-ed in dev env in the middle of the job), then you can wrap the whole job in a <code>ProcessTime.transaction do ... end</code> block"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1549389603, "post_id": 54538852, "comment_id": 95882039, "body": "<i>Sidenote:</i> this is in any case the wrong approach, vulnerable to race conditions. One should use a messaging queue acking the messages <i>after</i> the job finishes. Another (low level) option would be a <code>Mutex</code>/<code>ConditionalVariable</code>. All other solutions will sooner or later lead to the race condition and concurrent execution of two jobs simultaneously."}, {"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "reply_to_user": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1549396870, "post_id": 54538852, "comment_id": 95885450, "body": "@Jay-ArPolidario My app is hosted on Heroku, so if i push to production or the daily server restart happens, Sidekiq restarts, today i pushed to production and it was midway through the job so it never reached the update statement"}, {"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1549397086, "post_id": 54538852, "comment_id": 95885549, "body": "@AlekseiMatiushkin Hey, thanks for the advice, could you elaborate a bit on why this is not a good approach, currently we store what the job requires in a table and the job only runs if it is currently not running, the code block is inside of a begin rescue that updates the job to not running incase code that is being executed fails. I looked up what a race condition is and its when the job would run twice at the same time, how do you think this could happen with my current implementation?  Could you give me a brief example on how you would approach this"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 1, "creation_date": 1549397775, "post_id": 54538852, "comment_id": 95885871, "body": "@RickS Oh i see, you are using Sidekiq in Heroku. Haven&#39;t used it there before, but I found out the reason why it&#39;s closing mid-way (probably your job is taking &gt; 30 seconds to run?). From <a href=\"https://github.com/mperham/sidekiq/wiki/Deployment\" rel=\"nofollow noreferrer\">this doc</a>, it says <code>&quot;Keep in mind that Heroku puts a hard limit of 30 seconds on a process restart, the -t 25 tells Sidekiq to give the jobs 25 seconds to finish before starting the &quot;force shutdown&quot; procedure&quot;</code>"}, {"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "reply_to_user": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1549398083, "post_id": 54538852, "comment_id": 95886000, "body": "@Jay-ArPolidario It is possible that it may have been running longer than the time heroku gives for the job to finish, usually this isn&#39;t an issue since most jobs just get re-queued after the server restarts, but since my code, at the end, runs an update statement to allow the job to run again, re-queuing will let the job run but once it checks if it is currently running then it will not execute any code. I am not sure if theres a way to execute code incase it gets shut down without the job executing or if i will need to change how this job works"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 1, "creation_date": 1549399416, "post_id": 54538852, "comment_id": 95886547, "body": "@RickS Looking at <a href=\"https://devcenter.heroku.com/articles/what-happens-to-ruby-apps-when-they-are-restarted\" rel=\"nofollow noreferrer\">this</a>, seems like Heroku sends a &quot;SIGTERM&quot; to the processes (presumably this also applies to the sidekiq process), because it&#39;s a &quot;SIGTERM&quot; and not a &quot;SIGKILL&quot; (unrescueable force shutdown), then I guess you could still rescue it around your <code>perform</code> method (p.s. untested), but you can try: <code>def perform; # code here...; rescue SignalException =&gt; e; ensure; process.update(...); end</code>"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 1, "creation_date": 1549399789, "post_id": 54538852, "comment_id": 95886718, "body": "@RickS although, reading further on that Heroku page: <code>After Heroku sends SIGTERM to your application, it will wait a few seconds and then send SIGKILL to force it to shut down, even if it has not finished cleaning up. In this example, the ensure block does not get called at all, the program simply exits:</code>. Therefore if your job &quot;hangs&quot;/takes a long time shutting down, then my &quot;rescue; ensure&quot; solution still not purely reliable but hopefully it&#39;s not gonna take long, because you are just doing an <code>update</code> anyway in the <code>ensure</code> block; still not 100% reliable i.e. temporary DB timeout on update"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 1, "creation_date": 1549402478, "post_id": 54538852, "comment_id": 95887906, "body": "Oops, I forgot to reraise the exception and I could no longer edit my comment above. So here: <code>def perform; # code here...; rescue SignalException =&gt; e; raise; ensure; process.update(...); end</code>"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 1, "creation_date": 1549403269, "post_id": 54538852, "comment_id": 95888246, "body": "Nevermind my code in the comments above, I found out that <code>rescue ...</code> is no longer needed, because just only <code>ensure</code> already works after testing it. See my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "edited": false, "score": 0, "creation_date": 1549397637, "post_id": 54540022, "comment_id": 95885806, "body": "Hey, according to this guide <a href=\"https://www.rubydoc.info/github/mperham/sidekiq/Sidekiq/Shutdown\" rel=\"nofollow noreferrer\">rubydoc.info/github/mperham/sidekiq/Sidekiq/Shutdown</a> it says &quot;This is needed to rollback db transactions, otherwise Ruby&#39;s Thread#kill will commit....DO NOT RESCUE THIS ERROR IN YOUR WORKERS&quot; so i don&#39;t think this is the best solution"}, {"owner": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "reply_to_user": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "edited": false, "score": 0, "creation_date": 1549398465, "post_id": 54540022, "comment_id": 95886156, "body": "but you can reraise it after handling"}], "tags": [], "owner": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1549407202, "last_edit_date": 1549407202, "creation_date": 1549387902, "answer_id": 54540022, "question_id": 54538852, "link": "https://stackoverflow.com/questions/54538852/is-there-way-to-run-code-before-sidekiq-is-restarted-in-the-middle-of-a-job/54540022#54540022", "title": "Is there way to run code before Sidekiq is restarted in the middle of a job?", "body": "<p>Handle sidekiq shutdown exception</p>\n\n<pre><code>class SomeWorker\n  include Sidekiq::Worker\n\n  sidekiq_options queue: :default\n\n  def perform(params)\n    ...\n\n  rescue Sidekiq::Shutdown\n    SomeWorker.perform_async(params)\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1551288028, "post_id": 54543991, "comment_id": 96588996, "body": "I&#39;m trying some solutions for this very problem, and this particular solution seems promising. But what I&#39;m finding is that once Sidekiq raises <code>Sidekiq::Shutdown</code> on the worker thread, it does not wait for the thread to finish before <code>exit</code>ing the process. This means with this solution, there is a race between your <code>ensure</code> block finishing and the process exiting.  I so want this solution to work, but without some kind of tweak, your <code>ensure</code> block will have to be <i>very</i> fast to have any hope of finishing. I&#39;m working through that now..."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1551296127, "post_id": 54543991, "comment_id": 96592792, "body": "@Aaron Yes. you are right and as I have said that the <code>ensure</code> block should run very fast (and that any ruby code that rescued the Interrupt (TERM signal) exception should also run very quickly). Looking at this <a href=\"https://github.com/mperham/sidekiq/wiki/Signals#term\" rel=\"nofollow noreferrer\">docs</a>, seems like the total time before Sidekiq::Shutdown is raised is after 8 seconds (because Heroku sends the SIGKILL at the 10th second). So the <code>ensure</code> block above should finish in ~2 seconds, but let&#39;s say SHOULD finish in 1 second, so that any ruby code higher in the stack can only have a chance to rescue the exception)"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1551296510, "post_id": 54543991, "comment_id": 96592968, "body": "However, the said 8 seconds limit is <code>Sidekiq</code> stuff, because what happens is (from what I understood, correct me if im wrong). <code>begin; Process.kill(&#39;TERM&#39;, Process.pid); rescue Exception; raise_sidekiq_shutdown_after_8_seconds do # then Sidekiq waits for the job to finish; end; rescue Sidekiq::Shutdown =&gt; # oh no! the job didn&#39;t finish after 8 seconds!, so me (Sidekiq) only has 2 seconds to do internal cleanup (which includes pushing back the job to the retry queue); ensure; # then finally your ensure code gets run here! and thus it should be fast! #end</code>"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1551298818, "post_id": 54543991, "comment_id": 96594025, "body": "sorry typo in the previous previous message: &quot;so that any ruby code higher in the stack can [also] have a chance to rescue the exception&quot;. Also, P.S. What I said in my comment above is not tested! I haven&#39;t seen the Sidekiq process ruby code, nor haven&#39;t done any debugging yet. But all of the above was just through my past observations and assumptions. So, I&#39;d be curious to know as well the facts, and would be interested to know more about your findings! :)"}, {"owner": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1553183573, "post_id": 54543991, "comment_id": 97298616, "body": "In my experience working through this, I&#39;m finding that we have something more like a few milliseconds for the <code>ensure</code> block to complete before the process exits. At <a href=\"https://github.com/mperham/sidekiq/blob/master/lib/sidekiq/manager.rb#L74\" rel=\"nofollow noreferrer\">github.com/mperham/sidekiq/blob/master/lib/sidekiq/&hellip;</a> we see that Sidekiq waits for the threads to finish, then raises <code>Sidekiq::Shutdown</code> in each thread via <code>Processor#kill</code>, then immediately (without waiting) goes back up the call stack where it calls <code>exit(0)</code>. So it doesn&#39;t wait 8 seconds after sending the shutdown signal - it just exits."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1553185373, "post_id": 54543991, "comment_id": 97299778, "body": "Hmmm that&#39;s interesting. <code>Sidekiq::Shutdown</code> seems to be a subclass of an <code>Interrupt</code>, so the <code>ensure</code> should still have been called in the forked-threads (of which the jobs are running and the <code>ensure</code> block is placed)), so long as the main-thread does not terminate immediately. <a href=\"https://github.com/mperham/sidekiq/wiki/Signals#term\" rel=\"nofollow noreferrer\">Sidekiq docs</a> seem to suggest though that there are still roughly around 5 seconds after the 25th second waiting time, for the cleanup to happen via <code>Sidekiq::Shutdown</code>. I&#39;m just curious though if your specific configuration has an effect to this behaviour."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1553185478, "post_id": 54543991, "comment_id": 97299853, "body": "@Aaron ...i.e. maybe your Sidekiq timeout is configured to be 29 seconds (<code>-t 29</code>), and therefore, <code>Sidekiq::Shutdown</code> only gets raised at the 29th second, and only has 1 second before <code>Heroku</code> sends the SIGKILL at the 30th second. but thanks for your detailed experience on this particular topic. Should I get the time, I&#39;ll try to recreate the scenarios as well in Heroku + Sidekiq"}, {"owner": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1554468709, "post_id": 54543991, "comment_id": 97774937, "body": "&quot;so long as the main-thread does not terminate immediately&quot; - that&#39;s the problem, the main thread is terminating (almost) immediately. At the point in sidekiq&#39;s code where the <code>ensure</code> block gets run is the same place where sidekiq goes up to the call stack and <code>exit</code>s. During that time between the timeout and when Heroku sends <code>SIGKILL</code>, Sidekiq <i>shuts itself down</i> in order to avoid getting force-killed."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1554474505, "post_id": 54543991, "comment_id": 97778727, "body": "@Aaron I just set up a heroku sample rails+sidekiq app to replicate the scenario, and yes I can confirm that you are correct that using a <code>Procfile</code>: <code>worker: bundle exec sidekiq -t 25 -c 2</code> configuration, the <code>ensure</code> block can only run for a few milliseconds, and I can see in the logs that it is the main thread terminating the busy worker thread, while the worker thread is &quot;cleaning&quot; or running the <code>ensure</code> block (I set my <code>ensure</code> block to loop forever to test this out). I thought it would be only heroku sending the SIGKILL (after the 30th second) that will eventually kill the process..."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1554474744, "post_id": 54543991, "comment_id": 97778872, "body": "but... from this test result, it&#39;s also the main-thread Sidekiq process (probably it has internal timing mechanism that tracks the forked worker threads)... that also terminates the <code>ensure</code> block (specifically speaking, the &quot;thread&quot;), probably for good reason. Maybe before Heroku literally sends the SIGKILL at the 30th second, the main-thread needs to do &quot;something else&quot;/cleanup after all of the <code>ensure</code> blocks finished, otherwise the main-thread would also just immediately be stopped by the SIGKILL while still waiting for the worker-threads to completely finish."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 0, "creation_date": 1554475433, "post_id": 54543991, "comment_id": 97779287, "body": "Unfortunately, I couldn&#39;t think of any other good solution unless probably Sidekiq has an API to handle this (of which I am not yet aware of), or that we can probably monkey-patch some of the Sidekiq code that deals with the termination of the forked worker-threads (though probably best not to). I was also thinking/looking for a way to hijack the main-thread execution by hopefully putting it into sleep first (right after the <code>ensure</code> block is called) so that the main thread won&#39;t be able to preemptively terminate the worker-thread, but... couldn&#39;t find a working solution unfortunately."}, {"owner": {"reputation": 6588, "user_id": 251543, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4WDDh.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/251543/aaron"}, "edited": false, "score": 1, "creation_date": 1555429054, "post_id": 54543991, "comment_id": 98104486, "body": "I sure will let you know! The best thing I&#39;ve been able to think of so far is to monkey-patch sidekiq to wait for the thread (at least for a few seconds) before killing the process. But that makes me nervous. Thank you for thinking this through with me!"}], "tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": true, "score": 4, "last_activity_date": 1554476155, "last_edit_date": 1592644375, "creation_date": 1549405492, "answer_id": 54543991, "question_id": 54538852, "link": "https://stackoverflow.com/questions/54538852/is-there-way-to-run-code-before-sidekiq-is-restarted-in-the-middle-of-a-job/54543991#54543991", "title": "Is there way to run code before Sidekiq is restarted in the middle of a job?", "body": "<h2>Update:</h2>\n<ul>\n<li>Thanks to @Aaron, and following our discussion (comments below), the <code>ensure</code> block (which is executed by the forked worker-threads) can only be ran for a few unguaranteed milliseconds before the main-thread forcefully terminates these worker-threads, in order for the main-thread to do some &quot;cleanup&quot; up the exception stack, in order to avoid getting SIGKILL-ed by Heroku. Therefore, make sure that your <code>ensure</code> code should be really fast!</li>\n</ul>\n<p><strong>TL;DR:</strong></p>\n<pre><code>def perform(*args)\n  # your code here\nensure\n  process.update_attributes(is_running: false, last_execution_time: Time.now)\nend\n</code></pre>\n<ul>\n<li><p>The <code>ensure</code> above is always called regardless if the method &quot;succeeded&quot; or an Exception is raised. I tested this: see this <a href=\"https://repl.it/@jrpolidario1/InconsequentialEasygoingPhp?language=ruby&amp;folderId=\" rel=\"nofollow noreferrer\">repl code</a>, and click &quot;Run&quot;</p>\n</li>\n<li><p>In other words, this is always called even on a <code>SignalException</code>, even if the signal is <code>SIGTERM</code> (gracefully shutdown signal), but <strong>ONLY EXCEPT</strong> on <code>SIGKILL</code> (force unrescueable shutdown). You can verify this behaviour by checking my <a href=\"https://repl.it/@jrpolidario1/InconsequentialEasygoingPhp?language=ruby&amp;folderId=\" rel=\"nofollow noreferrer\">repl code</a>, and then change <code>Process.kill('TERM', Process.pid)</code> to <code>Process.kill('KILL', Process.pid)</code>, and then click &quot;run&quot; again (you'll notice that the <code>puts</code> won't be called)</p>\n</li>\n<li><p>Looking at <a href=\"https://devcenter.heroku.com/articles/what-happens-to-ruby-apps-when-they-are-restarted\" rel=\"nofollow noreferrer\">Heroku docs</a>, I quote:</p>\n<blockquote>\n<p>When Heroku is going to shut down a dyno (for a restart or a new deploy, etc.), it first sends a SIGTERM signal to the processes in the dyno.</p>\n<p>After Heroku sends SIGTERM to your application, <strong>it will wait a few seconds</strong> and then send SIGKILL to force it to shut down, even if it has not finished cleaning up. In this example, the ensure block does not get called at all, the program simply exits</p>\n</blockquote>\n<p>... which means that the <code>ensure</code> block will be called because it's a <code>SIGTERM</code> and not a <code>SIGKILL</code>, only except if the shutting down takes a looong time, which may due to (some reasons I could think of ATM):</p>\n<ul>\n<li><p>Something inside your <code>perform</code> code (or any ruby code in the stack; even gems) that also rescued the <code>SignalException</code>, or even rescued the root <code>Exception</code> class because <code>SignalException</code> is a subclass of <code>Exception</code>) but takes a long time cleaning up (i.e. cleaning up <code>connections</code> to DB or something, or I/O stuff that hangs your application)</p>\n</li>\n<li><p>Or, your own <code>ensure</code> block above takes a looong time. I.E when doing the <code>process.update_attributes(...)</code>, for some reason the DB temporary hangs / network delay or timeout, then that <code>update</code> might not succeed at all! and will ran out of time, of which from my quote above, after a few seconds after the <code>SIGTERM</code>, the application will be forced to be stopped by Heroku sending a <code>SIGKILL</code>.</p>\n</li>\n</ul>\n</li>\n</ul>\n<p><em>... which all means that my solution is still not fully reliable, but should work under normal situations</em></p>\n"}], "owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 2, "accepted_answer_id": 54543991, "answer_count": 2, "score": 3, "last_activity_date": 1554476155, "creation_date": 1549384034, "question_id": 54538852, "link": "https://stackoverflow.com/questions/54538852/is-there-way-to-run-code-before-sidekiq-is-restarted-in-the-middle-of-a-job", "title": "Is there way to run code before Sidekiq is restarted in the middle of a job?", "body": "<p>I have a Sidekiq job that runs every 4 minutes.</p>\n\n<p>This job checks if the current code block is being executed before executing the code again</p>\n\n<pre><code>process = ProcessTime.where(\"name = 'ad_queue_process'\").first\n\n# Return if job is running\nreturn if process.is_running == true\n</code></pre>\n\n<p>If Sidekiq restarts midway through the code block, code that updates the status of the job never runs</p>\n\n<pre><code># Done running, update the process times and allow it to be ran again\nprocess.update_attributes(is_running: false, last_execution_time: Time.now)\n</code></pre>\n\n<p>Which leads the the Job never running unless i run an update statement to set <code>is_running = false</code></p>\n\n<p>Is there any way to execute code before Sidekiq is restarted?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "view", "controller"], "comments": [{"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 1, "creation_date": 1549387424, "post_id": 54538753, "comment_id": 95880987, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7052399/adding-hash-parameter-in-the-url-rails-routes\">Adding Hash parameter in the URL Rails Routes</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9022748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/665f7b10c09bbe6a96778886701e0760?s=128&d=identicon&r=PG&f=1", "display_name": "SaiT", "link": "https://stackoverflow.com/users/9022748/sait"}, "edited": false, "score": 0, "creation_date": 1549389094, "post_id": 54539991, "comment_id": 95881796, "body": "Thanks for the reply regarding the params[:temp1] that was a mistype it should be params[:hash] I edited that and I did not include the value for hash because I was not sure how to pass that input( params[:hash]) in to that link_tag so i just left it with &quot;?&quot; lastly, I only included a part of view there are other input tags and also a submit button which on click updates all the values correctly. However this particular input hash  is part of the form which i do not want to save but use this hash value to create an encrypted pin and save encrypted pin instead."}], "tags": [], "owner": {"reputation": 103, "user_id": 10946251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUJXb.jpg?s=128&g=1", "display_name": "coda", "link": "https://stackoverflow.com/users/10946251/coda"}, "is_accepted": false, "score": 0, "last_activity_date": 1549387797, "creation_date": 1549387797, "answer_id": 54539991, "question_id": 54538753, "link": "https://stackoverflow.com/questions/54538753/ruby-on-rails-how-to-pass-an-input-value-from-a-form-to-a-controller-in-a-link/54539991#54539991", "title": "Ruby On Rails: How to pass an Input value from a form to a controller in a link_to tag?", "body": "<p>It's hard to tell what's happening here because it appears you've only included a portion of the view, if you could edit your question, that might help shed some light on what else is happening. </p>\n\n<p>Three things that stand out to me are: </p>\n\n<ol>\n<li><p>In your view you call the input :hash, but when you attempt to get the value you get params[:temp1] not params[:hash]</p></li>\n<li><p>In the link_to you include the user, but you don't include any value for the :hash. Off the top of my head, I believe you just need to do params[:hash] to successfully get the :hash value through to the controller with the way you have it. </p></li>\n<li><p>In your view you set up a simple_form_for, but it appears that you don't use a submit to get the :hash value in the controller. If you decided to go that route, you'd just have to make sure that the form is being directed to the proper controller.</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 9022748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/665f7b10c09bbe6a96778886701e0760?s=128&d=identicon&r=PG&f=1", "display_name": "SaiT", "link": "https://stackoverflow.com/users/9022748/sait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 631, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549388187, "creation_date": 1549383744, "last_edit_date": 1549388187, "question_id": 54538753, "link": "https://stackoverflow.com/questions/54538753/ruby-on-rails-how-to-pass-an-input-value-from-a-form-to-a-controller-in-a-link", "title": "Ruby On Rails: How to pass an Input value from a form to a controller in a link_to tag?", "body": "<p>I have a form with input tag which takes a value from the user and next to that there is a link which should take that value and pass it to a method in a controller which generates an encrypted values based on that hash.</p>\n\n<p>However params[:hash] which is my input does not pass input to controller. gives NULL. Please look in to my code and let me know where I am going wrong.\nthanks</p>\n\n<pre><code>view: \n= simple_form_for(@user, :html =&gt; {:class =&gt; 'user_form'}) do |f|\n= f.input :hash, :input_html =&gt; {:class =&gt; 'span4'}\n= link_to('Click to confirm key Encryption',confirm_encrypt_path(@user,:hash=&gt;?)\n\ncontroller:\ndef confirm_encrypt\n   check = params[:hash]\n   puts check # gives null value \n   MyModel.reset_authentication_pin!(current_user.id,params[:hash])\nend\n</code></pre>\n\n<p>I Expect the puts check value should be the user entered value.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 493, "user_id": 3616806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5e239b7b5f6e0938a4393e0a639b0aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Remember_me", "link": "https://stackoverflow.com/users/3616806/remember-me"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1549388675, "post_id": 54538641, "comment_id": 95881582, "body": "@spickermann I just updated"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1549389645, "post_id": 54538641, "comment_id": 95882057, "body": "I am confused. The factory is for a <code>SuperUser</code>, but the error message says: <i>Profile</i> reason for change can&#39;t be blank. Are a profile and a super user the same thing?"}, {"owner": {"reputation": 493, "user_id": 3616806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5e239b7b5f6e0938a4393e0a639b0aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Remember_me", "link": "https://stackoverflow.com/users/3616806/remember-me"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1549392835, "post_id": 54538641, "comment_id": 95883586, "body": "yes, sorry that this is confusing @spickermann"}, {"owner": {"reputation": 813, "user_id": 1961154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6b9daa60a6856519080acddfd5f254?s=128&d=identicon&r=PG", "display_name": "intale", "link": "https://stackoverflow.com/users/1961154/intale"}, "edited": false, "score": 0, "creation_date": 1549398682, "post_id": 54538641, "comment_id": 95886247, "body": "@Remember_me, please check the logs. I believe, you will see there something like this: <code>INSERT INTO super_users () VALUES(...); UPDATE super_users SET filed = val </code> If so - please check another callbacks that may be run when record is saved. My guess is that you have another callback that updates same record in, for example, after_save callback."}, {"owner": {"reputation": 813, "user_id": 1961154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6b9daa60a6856519080acddfd5f254?s=128&d=identicon&r=PG", "display_name": "intale", "link": "https://stackoverflow.com/users/1961154/intale"}, "edited": false, "score": 0, "creation_date": 1549404048, "post_id": 54538641, "comment_id": 95888553, "body": "Forgot to mention - you should disable that validation first before trying my suggestion."}, {"owner": {"reputation": 493, "user_id": 3616806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5e239b7b5f6e0938a4393e0a639b0aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Remember_me", "link": "https://stackoverflow.com/users/3616806/remember-me"}, "reply_to_user": {"reputation": 813, "user_id": 1961154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6b9daa60a6856519080acddfd5f254?s=128&d=identicon&r=PG", "display_name": "intale", "link": "https://stackoverflow.com/users/1961154/intale"}, "edited": false, "score": 0, "creation_date": 1549537115, "post_id": 54538641, "comment_id": 95941214, "body": "you&#39;re right @intale can you post an answer. I ll accept. The update does update the object"}], "answers": [{"tags": [], "owner": {"reputation": 813, "user_id": 1961154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6b9daa60a6856519080acddfd5f254?s=128&d=identicon&r=PG", "display_name": "intale", "link": "https://stackoverflow.com/users/1961154/intale"}, "is_accepted": true, "score": 1, "last_activity_date": 1549545431, "creation_date": 1549545431, "answer_id": 54574261, "question_id": 54538641, "link": "https://stackoverflow.com/questions/54538641/rails-5-validation-on-update-fires-on-create-too/54574261#54574261", "title": "Rails 5 validation on update fires on create too", "body": "<p>A copy-paste of my comment:\nPlease check the logs. I believe, you will see there something like this: </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO super_users () VALUES(...) \nUPDATE super_users SET filed = val \n</code></pre>\n\n<p>If so - please check another callbacks that may be run when record is saved. My guess is that you have another callback that updates same record in, for example, after_save callback.\nYou should disable that validation first before trying my suggestion.</p>\n"}], "owner": {"reputation": 493, "user_id": 3616806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5e239b7b5f6e0938a4393e0a639b0aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Remember_me", "link": "https://stackoverflow.com/users/3616806/remember-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 54574261, "answer_count": 1, "score": 0, "last_activity_date": 1549545431, "creation_date": 1549383359, "last_edit_date": 1549388664, "question_id": 54538641, "link": "https://stackoverflow.com/questions/54538641/rails-5-validation-on-update-fires-on-create-too", "title": "Rails 5 validation on update fires on create too", "body": "<p>I am using factory bot gem to build my factory objects for rspec test. And I have a validation like this in my model :</p>\n\n<pre><code>validates :reason_for_change, presence: true, on: :update\n</code></pre>\n\n<p>The spec test fails because the object itself cannot be created :</p>\n\n<pre><code>Failure/Error: let(:user) { create(:super_user) }\n\n     ActiveRecord::RecordInvalid:\n       Validation failed: Profile reason for change can't be blank\n</code></pre>\n\n<p>I have also tried this:</p>\n\n<pre><code>validates :reason_for_change, presence: true, unless: :new_record?\n</code></pre>\n\n<p>Same error. This as well :</p>\n\n<pre><code>validates :reason_for_change, presence: true, if: :my_custom_method\n\ndef my_custom_method\n  !new_record?\nend\n</code></pre>\n\n<p>Same result. However when I used the last validation and put a breakpoint inside my custom method like this :</p>\n\n<pre><code>def my_custom_method\n  binding.pry\nend\n</code></pre>\n\n<p>And was manually first checking is this a <code>new_record?</code>, whenever it would evaluate to true, I would return false (manually typing). And for every false evaluated, I'd return true (manually typing).</p>\n\n<p>In this case all tests pass. What is going on here? I am using rails <code>5.0.1</code></p>\n\n<p><strong>Update 1:</strong></p>\n\n<p>Here is my super user factory :</p>\n\n<pre><code>factory :super_user do\n    transient do\n      email { nil }\n    end\n    first_name { Faker::Name.first_name }\n    last_name  { Faker::Name.last_name }\n    gender { 'male' }\n    age { Random.rand(18..40) }\n    ethnicity { '' }\n    avatar { Rack::Test::UploadedFile.new(Rails.root.join('spec/files/1.png')) }\n  end\n</code></pre>\n\n<p><strong>Also I don't think I should modify factory, just to make this work. This should work.</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 8963855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db0e3b7e44648a19f8002b8f0c68a021?s=128&d=identicon&r=PG&f=1", "display_name": "Beatrice", "link": "https://stackoverflow.com/users/8963855/beatrice"}, "is_accepted": false, "score": 0, "last_activity_date": 1549468531, "creation_date": 1549468531, "answer_id": 54557638, "question_id": 54537936, "link": "https://stackoverflow.com/questions/54537936/send-data-changes-language-issue-rails/54557638#54557638", "title": "Send_data changes language issue Rails", "body": "<p>I had to ensure libre office was reading utf-8 (changed in a drop down), then it worked. </p>\n"}], "owner": {"reputation": 48, "user_id": 8963855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db0e3b7e44648a19f8002b8f0c68a021?s=128&d=identicon&r=PG&f=1", "display_name": "Beatrice", "link": "https://stackoverflow.com/users/8963855/beatrice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549468531, "creation_date": 1549380959, "last_edit_date": 1549382920, "question_id": 54537936, "link": "https://stackoverflow.com/questions/54537936/send-data-changes-language-issue-rails", "title": "Send_data changes language issue Rails", "body": "<p>When a click on the 'View CSV' link on my site the csv downloads but the content of the csv is in Chinese instead of English. How do I ensure the language of what I'm passing through the send_data function doesn't change? Thanks for your help! </p>\n\n<p>I have the following function in my controller: </p>\n\n<pre><code>def get_data_visit\n      @csv_string = CSV.generate do |csv|\n        csv &lt;&lt; [\"row\", \"of\", \"CSV\", \"data\"]\n      end\n    send_data Iconv.conv('iso-8859-1//IGNORE', 'utf-8', @csv_string), filename: \"something.csv\"  \n    end\n</code></pre>\n\n<p>And the following function in my view:</p>\n\n<pre><code>&lt;%= link_to \"View CSV\", get_data_visit_admin_stats_path %&gt;\n</code></pre>\n\n<p>Ie. <code>[\"row\", \"of\", \"CSV\", \"data\"]</code> becomes <code>\u6f72\u2c77\u666f\u432c\u5653\u642c\u7461\u0a61</code> and I would like it to stay in English. </p>\n"}, {"tags": ["json", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 11014793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb82f16c98fd3bdacddbf6fed800a844?s=128&d=identicon&r=PG&f=1", "display_name": "mjr", "link": "https://stackoverflow.com/users/11014793/mjr"}, "reply_to_user": {"reputation": 4969, "user_id": 4592059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/96a9cbb1200973090eb787c8ccbe4829?s=128&d=identicon&r=PG&f=1", "display_name": "Geeocode", "link": "https://stackoverflow.com/users/4592059/geeocode"}, "edited": false, "score": 0, "creation_date": 1549380449, "post_id": 54537455, "comment_id": 95876900, "body": "It looks like your bundler version isn&#39;t compatible with your version of rails. You try to downgrade bundler by running: <code>gem uninstall bundler</code> then <code>gem install bundler --version &#39;1.0.0&#39;</code>. Also, is this a new project? If so, you should consider using rails 5, or at the very least rails 4."}, {"owner": {"reputation": 4969, "user_id": 4592059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/96a9cbb1200973090eb787c8ccbe4829?s=128&d=identicon&r=PG&f=1", "display_name": "Geeocode", "link": "https://stackoverflow.com/users/4592059/geeocode"}, "edited": false, "score": 0, "creation_date": 1549380840, "post_id": 54537455, "comment_id": 95877148, "body": "I tried to downgrade bundler, but then other gems complained or not even started the process. This is an old project. I will make an other update for this case for you."}, {"owner": {"reputation": 46, "user_id": 11014793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb82f16c98fd3bdacddbf6fed800a844?s=128&d=identicon&r=PG&f=1", "display_name": "mjr", "link": "https://stackoverflow.com/users/11014793/mjr"}, "reply_to_user": {"reputation": 4969, "user_id": 4592059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/96a9cbb1200973090eb787c8ccbe4829?s=128&d=identicon&r=PG&f=1", "display_name": "Geeocode", "link": "https://stackoverflow.com/users/4592059/geeocode"}, "edited": false, "score": 0, "creation_date": 1549382048, "post_id": 54537455, "comment_id": 95877829, "body": "Ok, I think you can use a more updated version of bundler. <code>gem install bundler --version &#39;1.14.6&#39;</code> and then can either uninstall your version 2 with <code>gem uninstall bundler</code> or do <code>bundle _1.14.6_ install</code> to use that version."}, {"owner": {"reputation": 4969, "user_id": 4592059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/96a9cbb1200973090eb787c8ccbe4829?s=128&d=identicon&r=PG&f=1", "display_name": "Geeocode", "link": "https://stackoverflow.com/users/4592059/geeocode"}, "edited": false, "score": 0, "creation_date": 1549385286, "post_id": 54537455, "comment_id": 95879703, "body": "Ok. Soon I will be at my place, I will try it and keep you posted."}, {"owner": {"reputation": 4969, "user_id": 4592059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/96a9cbb1200973090eb787c8ccbe4829?s=128&d=identicon&r=PG&f=1", "display_name": "Geeocode", "link": "https://stackoverflow.com/users/4592059/geeocode"}, "edited": false, "score": 0, "creation_date": 1549402917, "post_id": 54537455, "comment_id": 95888110, "body": "Sorry I was wrong, the json update didn&#39;t succeed. See the new error message during the json install in the UPDATE 3."}, {"owner": {"reputation": 46, "user_id": 11014793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb82f16c98fd3bdacddbf6fed800a844?s=128&d=identicon&r=PG&f=1", "display_name": "mjr", "link": "https://stackoverflow.com/users/11014793/mjr"}, "reply_to_user": {"reputation": 4969, "user_id": 4592059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/96a9cbb1200973090eb787c8ccbe4829?s=128&d=identicon&r=PG&f=1", "display_name": "Geeocode", "link": "https://stackoverflow.com/users/4592059/geeocode"}, "edited": false, "score": 1, "creation_date": 1549490840, "post_id": 54537455, "comment_id": 95925498, "body": "Just did some quick research, and looks like eventmachine 1.0.3 isn&#39;t compatible with ruby 2.2 and above. You might have to try upgrading to at least eventmachine 1.0.4."}, {"owner": {"reputation": 4969, "user_id": 4592059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/96a9cbb1200973090eb787c8ccbe4829?s=128&d=identicon&r=PG&f=1", "display_name": "Geeocode", "link": "https://stackoverflow.com/users/4592059/geeocode"}, "edited": false, "score": 0, "creation_date": 1549491409, "post_id": 54537455, "comment_id": 95925692, "body": "Yes, I got to it yesterday also i.e. I updated  json and eventmachine in one step. As your help drove me toward the solution, thus I accept your answer. Thank you! :)"}], "tags": [], "owner": {"reputation": 46, "user_id": 11014793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb82f16c98fd3bdacddbf6fed800a844?s=128&d=identicon&r=PG&f=1", "display_name": "mjr", "link": "https://stackoverflow.com/users/11014793/mjr"}, "is_accepted": true, "score": 3, "last_activity_date": 1549382067, "last_edit_date": 1549382067, "creation_date": 1549379485, "answer_id": 54537455, "question_id": 54536999, "link": "https://stackoverflow.com/questions/54536999/resolving-bundler-json-1-8-0-incompatibility-in-ruby/54537455#54537455", "title": "Resolving bundler - json 1.8.0. incompatibility in Ruby", "body": "<p>Try running <code>bundle update json</code> to force update the <code>json</code> gem. If that doesn't work, you can run <code>gem clean</code>, delete your <code>Gemfile.lock</code> and run everything again.</p>\n\n<p>Edit: It looks like your bundler version isn't compatible with your version of rails. You can try to downgrade bundler by running: </p>\n\n<ol>\n<li><code>gem install bundler --version '1.14.6'</code></li>\n<li><code>gem uninstall bundler --version '2.0.1'</code></li>\n</ol>\n\n<p>Also, is this a new project? If so, you should consider using rails 5. Rails 3 is close to being three major versions behind with the release of rails 6 not too far away. It would help avoid a lot of these gem issues as well.</p>\n"}], "owner": {"reputation": 4969, "user_id": 4592059, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/96a9cbb1200973090eb787c8ccbe4829?s=128&d=identicon&r=PG&f=1", "display_name": "Geeocode", "link": "https://stackoverflow.com/users/4592059/geeocode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 0, "accepted_answer_id": 54537455, "answer_count": 1, "score": 1, "last_activity_date": 1549492791, "creation_date": 1549378115, "last_edit_date": 1549492791, "question_id": 54536999, "link": "https://stackoverflow.com/questions/54536999/resolving-bundler-json-1-8-0-incompatibility-in-ruby", "title": "Resolving bundler - json 1.8.0. incompatibility in Ruby", "body": "<p>I tried <code>bundle install</code> as below, but without any success. </p>\n\n<p>I tried a lot of method which I found here and there: </p>\n\n<ul>\n<li>I tried with sudo and without, </li>\n<li>I tried bundle update, </li>\n<li>I deleted Gemfile.lock </li>\n<li>I installed manually json 1.8.6. but it only want to use 1.8.0. and quits installing the other gems, when it doesn't find that. </li>\n</ul>\n\n<p>Note, that I am relatively new at <strong>Ruby</strong>, thus it may be some straightforward solution. For example I should need explain bundle somehow to use 1.8.6., but I have no clue how to do it.</p>\n\n<pre><code>sudo bundle install\nDon't run Bundler as root. Bundler can ask for sudo if it is needed, and installing your bundle as root will break this\napplication for all non-root users on this machine.\nFetching gem metadata from https://rubygems.org/.........\nrails (3.2.14) has dependency bundler (~&gt; 1.0), which is unsatisfied by the current bundler version 2.0.1, so the dependency is being ignored\nUsing rake 10.1.0\nUsing clive 1.2.0\nUsing process_runner 0.0.2\nUsing rake-compiler 0.9.1\nUsing timers 1.1.0\nUsing celluloid 0.14.1\nUsing contextual_exceptions 0.0.2\nUsing bundler 2.0.1\nUsing methadone 1.3.0\nUsing i18n 0.6.5\nUsing multi_json 1.7.9\nUsing activesupport 3.2.14\nUsing builder 3.0.4\nUsing activemodel 3.2.14\nUsing erubis 2.7.0\nUsing journey 1.0.4\nUsing rack 1.4.5\nUsing rack-cache 1.2\nUsing rack-test 0.6.2\nUsing hike 1.2.3\nUsing tilt 1.4.1\nUsing sprockets 2.2.2\nUsing actionpack 3.2.14\nUsing mime-types 1.23\nUsing polyglot 0.3.3\nUsing treetop 1.4.14\nUsing mail 2.5.4\nUsing actionmailer 3.2.14\nUsing arel 3.0.2\nUsing tzinfo 0.3.37\nUsing activerecord 3.2.14\nUsing activeresource 3.2.14\nUsing awesome_print 1.1.0\nUsing coderay 1.0.9\nUsing better_errors 0.9.0\nUsing debug_inspector 0.0.2\nUsing binding_of_caller 0.7.2\nUsing rack-ssl 1.3.3\nFetching json 1.8.0\nInstalling json 1.8.0 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: /home/vagrant/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/json-1.8.0/ext/json/ext/generator\n/home/vagrant/.rbenv/versions/2.3.0/bin/ruby -r ./siteconf20190205-9598-qp91k4.rb extconf.rb\ncreating Makefile\n\ncurrent directory: /home/vagrant/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/json-1.8.0/ext/json/ext/generator\nmake \"DESTDIR=\" clean\n\ncurrent directory: /home/vagrant/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/json-1.8.0/ext/json/ext/generator\nmake \"DESTDIR=\"\ncompiling generator.c\nIn file included from generator.c:1:0:\n../fbuffer/fbuffer.h: In function \u2018fbuffer_to_s\u2019:\n../fbuffer/fbuffer.h:175:47: error: macro \"rb_str_new\" requires 2 arguments, but only 1 given\n     VALUE result = rb_str_new(FBUFFER_PAIR(fb));\n                                               ^\n../fbuffer/fbuffer.h:175:20: warning: initialization makes integer from pointer without a cast [-Wint-conversion]\n     VALUE result = rb_str_new(FBUFFER_PAIR(fb));\n                    ^\nMakefile:238: recipe for target 'generator.o' failed\nmake: *** [generator.o] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in /home/vagrant/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/json-1.8.0 for inspection.\nResults logged to\n/home/vagrant/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/extensions/x86_64-linux/2.3.0-static/json-1.8.0/gem_make.out\n\nAn error occurred while installing json (1.8.0), and Bundler cannot continue.\nMake sure that `gem install json -v '1.8.0' --source 'https://rubygems.org/'` succeeds before bundling.\n\nIn Gemfile:\n  blueprint-rails was resolved to 0.2.0, which depends on\n    railties was resolved to 3.2.14, which depends on\n      rdoc was resolved to 3.12.2, which depends on\n        json\nvagrant@vagrant:~/\n</code></pre>\n\n<p>Any help would be highly appreciated.</p>\n\n<p>Thank you!</p>\n\n<p><strong>UPDATE 1:</strong></p>\n\n<pre><code>bundle update json\nFetching gem metadata from https://rubygems.org/.........\nFetching gem metadata from https://rubygems.org/.\nResolving dependencies...\nBundler could not find compatible versions for gem \"bundler\":\n  In Gemfile:\n    methadone was resolved to 1.3.0, which depends on\n      bundler\n\n    rails (~&gt; 3.2) was resolved to 3.2.14, which depends on\n      bundler (~&gt; 1.0)\n\n  Current Bundler version:\n    bundler (2.0.1)\nThis Gemfile requires a different version of Bundler.\nPerhaps you need to update Bundler by running `gem install bundler`?\n\nCould not find gem 'bundler (~&gt; 1.0)', which is required by gem 'rails (~&gt; 3.2)', in any of the sources.\n</code></pre>\n\n<p><strong>UPDATE 2:</strong></p>\n\n<pre><code>gem uninstall bundler\n\nSelect gem to uninstall:\n 1. bundler-1.0.10\n 2. bundler-2.0.1\n 3. All versions\n&gt; 2\n\nYou have requested to uninstall the gem:\n    bundler-2.0.1\n\nrails-5.2.2 depends on bundler (&gt;= 1.3.0)\nrails-dom-testing-2.0.3 depends on bundler (&gt;= 1.3, development)\nIf you remove this gem, these dependencies will not be met.\nContinue with Uninstall? [yN]\n</code></pre>\n\n<p><strong>UPDATE 3:</strong></p>\n\n<pre><code>sudo bundle update json\nFetching gem metadata from https://rubygems.org/..........\nFetching version metadata from https://rubygems.org/...\nFetching dependency metadata from https://rubygems.org/..\nResolving dependencies...\nUsing rake 10.1.0\nUsing clive 1.2.0\nUsing process_runner 0.0.2\nUsing timers 1.1.0\nUsing contextual_exceptions 0.0.2\nUsing bundler 1.14.6\nUsing i18n 0.6.5\nUsing multi_json 1.7.9\nUsing builder 3.0.4\nUsing erubis 2.7.0\nUsing journey 1.0.4\nUsing rack 1.4.5\nUsing hike 1.2.3\nUsing tilt 1.4.1\nUsing mime-types 1.23\nUsing polyglot 0.3.3\nUsing arel 3.0.2\nUsing tzinfo 0.3.37\nUsing awesome_print 1.1.0\nUsing coderay 1.0.9\nUsing debug_inspector 0.0.2\nUsing json 1.8.6 (was 1.8.0)\nUsing thor 0.18.1\nUsing sass 3.2.10\nUsing callsite 0.0.11\nUsing mini_portile 0.5.1\nUsing chunky_png 1.2.8\nUsing client_side_validations 3.2.6\nUsing moped 1.4.5\nUsing origin 1.0.11\nUsing coffee-script-source 1.6.3\nUsing haml 3.1.8\nUsing fssm 0.2.10\nUsing connection_pool 1.1.0\nUsing daemon_controller 1.1.5\nUsing daemons 1.1.9\nUsing diff-lcs 1.2.4\nInstalling eventmachine 1.0.3 with native extensions\nUsing god 0.13.2\nUsing kramdown 1.1.0\nUsing metaclass 0.0.1\nUsing redis 3.0.4\nUsing require_reloader 0.2.0\nUsing rspec-core 2.14.5\nUsing rspec-mocks 2.14.3\nUsing yard 0.8.7\nUsing rake-compiler 0.9.1\nUsing celluloid 0.14.1\nUsing methadone 1.3.0\nUsing activesupport 3.2.14\nUsing execjs 1.4.0\nUsing rack-cache 1.2\nUsing rack-test 0.6.2\nUsing rack-ssl 1.3.3\nUsing rack-contrib 1.1.0\nUsing sprockets 2.2.2\nUsing treetop 1.4.14\nUsing better_errors 0.9.0\nUsing binding_of_caller 0.7.2\nUsing rdoc 3.12.2\nUsing zen-grids 1.4\nUsing nokogiri 1.6.0\nUsing oily_png 1.1.0\nUsing compass 0.12.2\nUsing passenger 4.0.10\nUsing rspec-expectations 2.14.1\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: /home/vagrant/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/eventmachine-1.0.3/ext\n/home/vagrant/.rbenv/versions/2.3.0/bin/ruby -r ./siteconf20190205-23731-qe1gp5.rb extconf.rb\nchecking for main() in -lssl... yes\nchecking for main() in -lcrypto... yes\nchecking for openssl/ssl.h... yes\nchecking for openssl/err.h... yes\nchecking for rb_trap_immediate in ruby.h,rubysig.h... no\nchecking for rb_thread_blocking_region()... no\nchecking for inotify_init() in sys/inotify.h... yes\nchecking for writev() in sys/uio.h... yes\nchecking for rb_wait_for_single_fd()... yes\nchecking for rb_enable_interrupt()... no\nchecking for rb_time_new()... yes\nchecking for sys/event.h... no\nchecking for epoll_create() in sys/epoll.h... yes\ncreating Makefile\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n                                                 ^\nMakefile:230: recipe for target 'em.o' failed\nmake: *** [em.o] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in /home/vagrant/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/eventmachine-1.0.3 for\ninspection.\nResults logged to\n/home/vagrant/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/extensions/x86_64-linux/2.3.0-static/eventmachine-1.0.3/gem_make.out\n\nAn error occurred while installing eventmachine (1.0.3), and Bundler cannot continue.\nMake sure that `gem install eventmachine -v '1.0.3'` succeeds before bundling.\n</code></pre>\n\n<p><strong>SOLUTION:</strong>\nmjr answer below is a valid solution, though downgrading Ruby solved this problem either.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1540, "user_id": 1245440, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8a2a573a8585a0e04eecd822955e9fbe?s=128&d=identicon&r=PG", "display_name": "Pramod Shinde", "link": "https://stackoverflow.com/users/1245440/pramod-shinde"}, "edited": false, "score": 1, "creation_date": 1549375592, "post_id": 54536141, "comment_id": 95873822, "body": "What is <code>Door.variants</code> returning?"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1549376081, "post_id": 54536141, "comment_id": 95874121, "body": "You are passing <code>prompt: &#39;select me&#39;</code> as an html option (check it&#39;s rendered as an attribute of the select tag), move it inside that empty <code>{}</code> where the helper options go."}, {"owner": {"reputation": 53, "user_id": 11018011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/228986613a0949045c9754dd0218f673?s=128&d=identicon&r=PG&f=1", "display_name": "Joddari", "link": "https://stackoverflow.com/users/11018011/joddari"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1549376529, "post_id": 54536141, "comment_id": 95874356, "body": "@arieljuod thx."}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1549413880, "post_id": 54536141, "comment_id": 95891100, "body": "@Joddari if you&#39;ve solved this problem, please post an answer here for the community."}], "owner": {"reputation": 53, "user_id": 11018011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/228986613a0949045c9754dd0218f673?s=128&d=identicon&r=PG&f=1", "display_name": "Joddari", "link": "https://stackoverflow.com/users/11018011/joddari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549384797, "creation_date": 1549375297, "last_edit_date": 1549384797, "question_id": 54536141, "link": "https://stackoverflow.com/questions/54536141/form-helper-of-select-renders-the-empty-option-wihout-text-in-it", "title": "Form helper of &quot;select&quot; renders the empty option wihout text in it", "body": "<p>I have this <code>select</code> helper:</p>\n\n<pre><code>= form.select(:door, options_for_select(Door.variants), {}, style: \"width: 100%\", required: true, prompt: \"select me\")\n</code></pre>\n\n<p>It renders the following HTML:</p>\n\n<pre><code>&lt;select style=\"width: 100%\" required=\"required\" prompt=\"select it\" name=\"door\" id=\"door\" class=\"error\"&gt;\n  &lt;option value=\"\"&gt;&lt;/option&gt;\n  &lt;option value=\"var1\"&gt;var1&lt;/option&gt;\n  &lt;option value=\"var2\"&gt;var2&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>But why doesn't it have the text for the empty value? How do I fix this?</p>\n"}, {"tags": ["ruby", "linux", "irb", "rclone"], "comments": [{"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1549375686, "post_id": 54536086, "comment_id": 95873878, "body": "Do you have the same error with <code>irb --simple-prompt</code> ?"}, {"owner": {"reputation": 4890, "user_id": 3751845, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4b51d8d32d17d1d0a4200f68e5941517?s=128&d=identicon&r=PG&f=1", "display_name": "NaN", "link": "https://stackoverflow.com/users/3751845/nan"}, "reply_to_user": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1549375731, "post_id": 54536086, "comment_id": 95873900, "body": "@Nifriz: Yes, makes no difference."}, {"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1549376352, "post_id": 54536086, "comment_id": 95874258, "body": "Does <code>gem</code> works? If yes, try this <code>sudo gem update --system</code>"}, {"owner": {"reputation": 4890, "user_id": 3751845, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4b51d8d32d17d1d0a4200f68e5941517?s=128&d=identicon&r=PG&f=1", "display_name": "NaN", "link": "https://stackoverflow.com/users/3751845/nan"}, "reply_to_user": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1549377704, "post_id": 54536086, "comment_id": 95875052, "body": "@Nifriz: Did the update, no difference."}, {"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1549380066, "post_id": 54536086, "comment_id": 95876618, "body": "Do you do a directory rename or creation before using <code>pwd</code> command?"}, {"owner": {"reputation": 4890, "user_id": 3751845, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4b51d8d32d17d1d0a4200f68e5941517?s=128&d=identicon&r=PG&f=1", "display_name": "NaN", "link": "https://stackoverflow.com/users/3751845/nan"}, "reply_to_user": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1549382422, "post_id": 54536086, "comment_id": 95878090, "body": "@Nifriz: No and I do not use pwd explicitely."}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 8518329, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6ZmafDaaKVQ/AAAAAAAAAAI/AAAAAAAAAAs/x4O5h7AXstM/photo.jpg?sz=128", "display_name": "Ted Price", "link": "https://stackoverflow.com/users/8518329/ted-price"}, "is_accepted": false, "score": 0, "last_activity_date": 1549377294, "creation_date": 1549377294, "answer_id": 54536722, "question_id": 54536086, "link": "https://stackoverflow.com/questions/54536086/getting-an-error-when-starting-ruby-irb-in-a-rclone-mounted-volume-on-linux/54536722#54536722", "title": "Getting an error when starting ruby irb in a rclone mounted volume on Linux", "body": "<p>Have you checked your assumptions:</p>\n\n<ul>\n<li>Do you have proper permissions for the share?</li>\n<li>Can you run <code>pwd</code> from the mounted share?</li>\n<li>Do you have a pot of coffee as well as a vile of hemlock in case things go south? </li>\n</ul>\n"}], "owner": {"reputation": 4890, "user_id": 3751845, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4b51d8d32d17d1d0a4200f68e5941517?s=128&d=identicon&r=PG&f=1", "display_name": "NaN", "link": "https://stackoverflow.com/users/3751845/nan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549377294, "creation_date": 1549375143, "last_edit_date": 1549375687, "question_id": 54536086, "link": "https://stackoverflow.com/questions/54536086/getting-an-error-when-starting-ruby-irb-in-a-rclone-mounted-volume-on-linux", "title": "Getting an error when starting ruby irb in a rclone mounted volume on Linux", "body": "<p>When I am in a mounted share on Linux I get the following error when starting a ruby program or just irb. As long as I am outside the share everything works fine. The share is a mounted by rclone. Maybe its rclone specific. For irb the error is:</p>\n\n<pre><code>/usr/local/lib/site_ruby/2.3.0/rubygems/bundler_version_finder.rb:80:in `pwd': No such file or directory - getcwd (Errno::ENOENT)\nfrom /usr/local/lib/site_ruby/2.3.0/rubygems/bundler_version_finder.rb:80:in `lockfile_contents'\nfrom /usr/local/lib/site_ruby/2.3.0/rubygems/bundler_version_finder.rb:68:in `lockfile_version'\nfrom /usr/local/lib/site_ruby/2.3.0/rubygems/bundler_version_finder.rb:22:in `bundler_version_with_reason'\nfrom /usr/local/lib/site_ruby/2.3.0/rubygems/bundler_version_finder.rb:7:in `bundler_version'\nfrom /usr/local/lib/site_ruby/2.3.0/rubygems/bundler_version_finder.rb:39:in `compatible?'\nfrom /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:1042:in `block in find_by_path'\nfrom /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:1041:in `each'\nfrom /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:1041:in `find'\nfrom /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:1041:in `find_by_path'\nfrom /usr/local/lib/site_ruby/2.3.0/rubygems.rb:212:in `try_activate'\nfrom /usr/lib/ruby/2.3.0/irb/locale.rb:150:in `block in search_file'\nfrom /usr/lib/ruby/2.3.0/irb/locale.rb:158:in `block in each_localized_path'\nfrom /usr/lib/ruby/2.3.0/irb/locale.rb:167:in `each_sublocale'\nfrom /usr/lib/ruby/2.3.0/irb/locale.rb:157:in `each_localized_path'\nfrom /usr/lib/ruby/2.3.0/irb/locale.rb:145:in `search_file'\nfrom /usr/lib/ruby/2.3.0/irb/locale.rb:124:in `find'\nfrom /usr/lib/ruby/2.3.0/irb/locale.rb:108:in `load'\nfrom /usr/lib/ruby/2.3.0/irb/locale.rb:32:in `initialize'\nfrom /usr/lib/ruby/2.3.0/irb/init.rb:113:in `new'\nfrom /usr/lib/ruby/2.3.0/irb/init.rb:113:in `init_config'\nfrom /usr/lib/ruby/2.3.0/irb/init.rb:17:in `setup'\nfrom /usr/lib/ruby/2.3.0/irb.rb:378:in `start'\nfrom /usr/bin/irb:11:in `&lt;main&gt;'\n</code></pre>\n\n<p>Does anyone know how to fix this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1549377969, "post_id": 54535582, "comment_id": 95875254, "body": "Are the classes extending the modules or are individual instances of your class extending the module?"}, {"owner": {"reputation": 374, "user_id": 5195976, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f71b0d4a72d7ebe9fa64f58b218d0bf?s=128&d=identicon&r=PG&f=1", "display_name": "mareiou", "link": "https://stackoverflow.com/users/5195976/mareiou"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1549378139, "post_id": 54535582, "comment_id": 95875370, "body": "Individual instance of the class should extend the module"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1549379048, "post_id": 54535582, "comment_id": 95875970, "body": "Given your &quot;Overall problem&quot; I would say you should have N classes and 1 module that contains the common logic rather than 1 class that contains the common logic and N modules to distinguish them dynamically at run time"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1549383981, "post_id": 54535582, "comment_id": 95878961, "body": "Calling <code>extend</code> during <code>initialize</code> is kind of an odd thing to do. Normally you&#39;d just <code>include</code> in the class itself once and once only."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549390153, "post_id": 54535582, "comment_id": 95882292, "body": "I don&#39;t know why you&#39;d want to do this. You are left with a collection of instances of <code>Example</code>, some of which respond to the instance methods in <code>Submodule1</code>; others than that respond to the instance methods of <code>Submodule2</code>. You obviously have to keep track of which group each instance is in. I would think the simplest way of doing that is to simply create subclasses of <code>Example</code>: <code>class Ex1 &lt; Example; include Submodue1</code>; end; class Ex2 &lt; Example; include Submodule2; end`."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1549383910, "post_id": 54535791, "comment_id": 95878926, "body": "<code>eval</code> technically works here, but it&#39;s kind of overkill for what is a simple dynamic programming problem."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1549389592, "post_id": 54535791, "comment_id": 95882033, "body": "Please don&#39;t link to code. If the link is broken in future your answer is kaput. btw, you don&#39;t need <code>self.</code>."}], "tags": [], "owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "is_accepted": false, "score": 0, "last_activity_date": 1549374175, "creation_date": 1549374175, "answer_id": 54535791, "question_id": 54535582, "link": "https://stackoverflow.com/questions/54535582/how-to-extend-a-module-on-a-class-dynamically/54535791#54535791", "title": "How to extend a module on a class dynamically?", "body": "<p>You are possibly on wrong way, and that forces you to find an \"ungood\" solution. <a href=\"https://repl.it/@marmeladze1/StarryBiodegradablePortablesoftware\" rel=\"nofollow noreferrer\">But here it is.</a></p>\n\n<pre><code>class Example\n  def initialize m\n    self.instance_eval(\"extend Topmodule::#{m}\")\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1549378312, "post_id": 54536623, "comment_id": 95875481, "body": "You might wish to change the <code>extend</code> argument to <code>Kernel.const_get(&quot;TopModule::#{mod}&quot;)</code> to fit the requirements a bit more."}, {"owner": {"reputation": 76, "user_id": 8518329, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6ZmafDaaKVQ/AAAAAAAAAAI/AAAAAAAAAAs/x4O5h7AXstM/photo.jpg?sz=128", "display_name": "Ted Price", "link": "https://stackoverflow.com/users/8518329/ted-price"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1549380904, "post_id": 54536623, "comment_id": 95877187, "body": "^^ Thanks, Marcin. Updated and scoped from TopModule."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1549438480, "post_id": 54536623, "comment_id": 95897434, "body": "Is the <code>self.</code> necessary?"}, {"owner": {"reputation": 76, "user_id": 8518329, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6ZmafDaaKVQ/AAAAAAAAAAI/AAAAAAAAAAs/x4O5h7AXstM/photo.jpg?sz=128", "display_name": "Ted Price", "link": "https://stackoverflow.com/users/8518329/ted-price"}, "edited": false, "score": 0, "creation_date": 1549459871, "post_id": 54536623, "comment_id": 95909343, "body": "^^ Updated Kimmo"}], "tags": [], "owner": {"reputation": 76, "user_id": 8518329, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6ZmafDaaKVQ/AAAAAAAAAAI/AAAAAAAAAAs/x4O5h7AXstM/photo.jpg?sz=128", "display_name": "Ted Price", "link": "https://stackoverflow.com/users/8518329/ted-price"}, "is_accepted": false, "score": 4, "last_activity_date": 1549459853, "last_edit_date": 1549459853, "creation_date": 1549376961, "answer_id": 54536623, "question_id": 54535582, "link": "https://stackoverflow.com/questions/54535582/how-to-extend-a-module-on-a-class-dynamically/54536623#54536623", "title": "How to extend a module on a class dynamically?", "body": "<p>Updated answer!</p>\n\n<pre><code>module TopModule\n  module SubModule1\n    def hello\n      puts \"Hello from #1\"\n    end\n  end\nend\n\nmodule TopModule\n  module SubModule2\n    def hello\n      puts \"Hello from #2\"\n    end\n  end\nend\n\nclass Example\n  def initialize(mod)\n    extend TopModule.const_get(mod)\n  end\nend\n\nExample.new(\"SubModule1\").hello\n# =&gt; Hello from #1\nExample.new(\"SubModule2\").hello\n# =&gt; Hello from #2\n</code></pre>\n"}], "owner": {"reputation": 374, "user_id": 5195976, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f71b0d4a72d7ebe9fa64f58b218d0bf?s=128&d=identicon&r=PG&f=1", "display_name": "mareiou", "link": "https://stackoverflow.com/users/5195976/mareiou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549459853, "creation_date": 1549373481, "last_edit_date": 1549374726, "question_id": 54535582, "link": "https://stackoverflow.com/questions/54535582/how-to-extend-a-module-on-a-class-dynamically", "title": "How to extend a module on a class dynamically?", "body": "<p>I currently have two classes with each extending a different module:</p>\n\n<pre><code>class Example1\n  def initialize\n    extend TopModule:SubModule1\n  end\nend\n\nclass Example2\n  def initialize\n    extend TopModule:SubModule2\n  end\nend\n</code></pre>\n\n<p>Instead of having two classes with each its own module extended, is it possible to create a single class and then extend the module at the object level?</p>\n\n<p>I have added the name of the module and passing that to the constructor of the object but complains with the code.</p>\n\n<pre><code>class Example\n  def initialize (module)\n    self.send(\"extend TopModule::#{module}\"\n  end\nend\n\nobject = Example.new('Submodule1')\n\nNoMethodError:\n  undefined method `extend TopModule::SubModule1' for #&lt;Example:0x00000000057c8198&gt;\n</code></pre>\n\n<p>Overall problem: Let's say I have N objects (they all should come from the same class BUT each object must have it's own module). What would be the best approach to have this capability?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 11709, "user_id": 9325419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JBsmO.jpg?s=128&g=1", "display_name": "jo_va", "link": "https://stackoverflow.com/users/9325419/jo-va"}, "edited": false, "score": 1, "creation_date": 1549366714, "post_id": 54533460, "comment_id": 95868530, "body": "Welcome to Stack Overflow, please make sure to format your question appropriately, it is hard to read, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1549367485, "post_id": 54533460, "comment_id": 95868958, "body": "Please check <a href=\"https://stackoverflow.com/q/54529739/10522579\">this post</a>"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1549367723, "post_id": 54533460, "comment_id": 95869079, "body": "You are using <code>ruby-2.6.0</code> (indicated in error log) for <code>rails-3</code> ?"}], "owner": {"reputation": 85, "user_id": 11017284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6C9dX.png?s=128&g=1", "display_name": "Othmane Namani", "link": "https://stackoverflow.com/users/11017284/othmane-namani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1549371283, "answer_count": 0, "score": 0, "last_activity_date": 1549367557, "creation_date": 1549366338, "last_edit_date": 1549367557, "question_id": 54533460, "link": "https://stackoverflow.com/questions/54533460/ruby-cant-loading-the-sqlite3", "closed_reason": "Duplicate", "title": "Ruby can&#39;t loading the &#39;sqlite3&#39;", "body": "<p>While loading server, got following error</p>\n\n<blockquote>\n  <p>/home/othmane/.rbenv/versions/2.6.0/lib/ruby/2.6.0/bundler/rubygems_integration.rb:408:in `block (2 levels) in replace_gem': Error loading the 'sqlite3' Active Record adapter.</p>\n</blockquote>\n"}, {"tags": ["ruby", "rubocop"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 3, "last_activity_date": 1549363292, "creation_date": 1549363292, "answer_id": 54532595, "question_id": 54532392, "link": "https://stackoverflow.com/questions/54532392/rubocop-using-wrong-version-of-ruby-fails/54532595#54532595", "title": "Rubocop using wrong version of Ruby - Fails", "body": "<p>Support for Ruby 2.5 was added to Rubocop in <a href=\"https://github.com/rubocop-hq/rubocop/blob/master/CHANGELOG.md#new-features-14\" rel=\"nofollow noreferrer\">version <code>0.52.0</code></a>. But you are using <code>0.49.1</code>.</p>\n\n<p>You need to update Rubocop to at least version <code>0.52.0</code> or even better update to the latest version (which is <code>0.63.1</code> as of today).</p>\n\n<p>Depending on your setup you simply need to run <code>bundle update rubocop</code> or you might need to specify the desired version in your <code>Gemfile</code> first.</p>\n"}], "owner": {"reputation": 1588, "user_id": 3442951, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/oqtiY.png?s=128&g=1", "display_name": "Will Taylor", "link": "https://stackoverflow.com/users/3442951/will-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1549363292, "creation_date": 1549362671, "question_id": 54532392, "link": "https://stackoverflow.com/questions/54532392/rubocop-using-wrong-version-of-ruby-fails", "title": "Rubocop using wrong version of Ruby - Fails", "body": "<p>I've re-installed RVM, Ruby and all gems using rvm implode. When I run rubocop, I receive an error that it is using 2.5 (which I did not explicitly install but seems to come with RVM's Ruby 2.5.1)</p>\n\n<p>Note the line I have highlighted with * * - this may be the issue?</p>\n\n<pre><code>$ which ruby\n/Users/Will/.rvm/rubies/ruby-2.5.1/bin/ruby\n$ rvm use 2.5.1\nUsing /Users/Will/.rvm/gems/ruby-2.5.1\n$ rubocop\nInspecting 604 files\n\n\n0 files inspected, no offenses detected\nUnknown Ruby version: 2.5\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/processed_source.rb:131:in `parser_class\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/processed_source.rb:138:in `create_parser\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/processed_source.rb:94:in `parse\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/processed_source.rb:36:in `initialize\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/processed_source.rb:17:in `new\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/processed_source.rb:17:in `from_file\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:334:in `get_processed_source\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:110:in `block in file_offenses\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:121:in `file_offense_cache\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:109:in `file_offenses\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:100:in `process_file\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:78:in `block in each_inspected_file\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:75:in `each\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:75:in `reduce\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:75:in `each_inspected_file\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:67:in `inspect_files\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/runner.rb:39:in `run\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/cli.rb:82:in `execute_runner\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/lib/rubocop/cli.rb:28:in `run\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/bin/rubocop:13:in `block in &lt;top (required)&gt;'\n*/Users/Will/.rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/benchmark.rb:308:in `realtime\u2019*\n/Users/Will/.rvm/gems/ruby-2.5.1/gems/rubocop-0.49.1/bin/rubocop:12:in `&lt;top (required)&gt;'\n/Users/Will/.rvm/gems/ruby-2.5.1/bin/rubocop:23:in `load\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/bin/rubocop:23:in `&lt;main&gt;'\n/Users/Will/.rvm/gems/ruby-2.5.1/bin/ruby_executable_hooks:24:in `eval\u2019\n/Users/Will/.rvm/gems/ruby-2.5.1/bin/ruby_executable_hooks:24:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1549361972, "post_id": 54531980, "comment_id": 95865784, "body": "See the ruby documentation: <a href=\"https://ruby-doc.org/core/Module.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">ruby-doc.org/core/Module.html#method-i-3C-3D-3E</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1549368809, "post_id": 54531980, "comment_id": 95869734, "body": "The <a href=\"https://ruby-doc.org/core-2.6.1/Module.html#method-i-3C\" rel=\"nofollow noreferrer\">docs</a> mention a nice mnemonic: <i>&quot;<code>class A &lt; B</code> implies <code>A &lt; B</code>&quot;</i>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1549380816, "post_id": 54531980, "comment_id": 95877127, "body": "Given a receiver <code>obj</code> that responds to a method <code>m</code>, <code>obj.method(:m).owner</code> will tell you where the method <code>m</code> is defined. For <code>A &lt; B</code>, <code>A.method(:&lt;).owner #=&gt; Module</code>."}], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 4, "last_activity_date": 1549363315, "last_edit_date": 1549363315, "creation_date": 1549361739, "answer_id": 54532078, "question_id": 54531980, "link": "https://stackoverflow.com/questions/54531980/what-does-it-mean-to-compare-classes-with-greater-than-and-less-than-ope/54532078#54532078", "title": "What does it mean to compare classes with greater than `&gt;` and less than `&lt;` operators?", "body": "<p>As you have found, those methods are not defined for <code>Object</code> nor for <code>Class</code>.</p>\n\n<p>In your example, they are defined in <code>Module</code>, which is the parent of <code>Class</code>. Read somewhere around <a href=\"https://ruby-doc.org/core-2.6.1/Module.html#method-i-3C\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>When you want to know in which class a method is defined, use <code>owner</code>.</p>\n\n<pre><code>String.method(:&gt;).owner # =&gt; Module\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 6, "last_activity_date": 1549361861, "creation_date": 1549361861, "answer_id": 54532122, "question_id": 54531980, "link": "https://stackoverflow.com/questions/54531980/what-does-it-mean-to-compare-classes-with-greater-than-and-less-than-ope/54532122#54532122", "title": "What does it mean to compare classes with greater than `&gt;` and less than `&lt;` operators?", "body": "<p>When class level comparison is done, it looks for hierarchy/relationship.</p>\n\n<p><code>String &gt; Object</code>  returns false because <code>Object</code> is ancestor for <code>String</code> class.</p>\n\n<p>Similar will be followed for this hierarchy <code>Object -&gt; Numeric -&gt; Integer</code></p>\n\n<p><code>String &gt; Integer</code> returns nil because both classes do not come in same hierarchy/relationship. </p>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549362922, "post_id": 54532401, "comment_id": 95866346, "body": "No, it&#39;s not. <code>Class.ancestors #=&gt; [Class, Module, Object, Kernel, BasicObject]</code>"}, {"owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549363114, "post_id": 54532401, "comment_id": 95866469, "body": "@sawa can you detail?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549363215, "post_id": 54532401, "comment_id": 95866524, "body": "Can&#39;t you see that the ancestry list does not include <code>Comparable</code>?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549363428, "post_id": 54532401, "comment_id": 95866669, "body": "Instances of a <code>Comparable</code> class are totally ordered. Modules (or classes) are partially ordered."}, {"owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549363830, "post_id": 54532401, "comment_id": 95866920, "body": "So you are saying is not about Comparable is about hierarchy? Is the last sentence in my response."}], "tags": [], "owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "is_accepted": false, "score": 0, "last_activity_date": 1549362698, "creation_date": 1549362698, "answer_id": 54532401, "question_id": 54531980, "link": "https://stackoverflow.com/questions/54531980/what-does-it-mean-to-compare-classes-with-greater-than-and-less-than-ope/54532401#54532401", "title": "What does it mean to compare classes with greater than `&gt;` and less than `&lt;` operators?", "body": "<p>The <a href=\"https://ruby-doc.org/core-2.4.2/Comparable.html\" rel=\"nofollow noreferrer\">Comparable</a> is used to compare.</p>\n\n<p>As the classes are using it or implementing the &lt;=> method, they can compares the receiver against another object, returning -1, 0, or +1 depending on whether the receiver is less than, equal to, or greater than the other object.</p>\n\n<p>But on the class level, the hierarchy is taken in consideration.</p>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 1, "last_activity_date": 1549363170, "creation_date": 1549363170, "answer_id": 54532555, "question_id": 54531980, "link": "https://stackoverflow.com/questions/54531980/what-does-it-mean-to-compare-classes-with-greater-than-and-less-than-ope/54532555#54532555", "title": "What does it mean to compare classes with greater than `&gt;` and less than `&lt;` operators?", "body": "<p>It might not be clear at first, but <code>&gt;</code> is actually a method, so you can try to get more info about it with the <a href=\"https://ruby-doc.org/core-2.6.1/Object.html#method-i-method\" rel=\"nofollow noreferrer\"><code>method</code></a> method:</p>\n\n<pre><code>String.method(:&gt;)\n# #&lt;Method: Class(Module)#&gt;&gt;\n</code></pre>\n\n<p>Which means that the method is defined in <a href=\"https://ruby-doc.org/core-2.6.1/Module.html#method-i-3E\" rel=\"nofollow noreferrer\"><code>Module</code></a> and is called on a <code>Class</code> object.</p>\n"}], "owner": {"reputation": 1247, "user_id": 2109121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/zwxKQ.jpg?s=128&g=1", "display_name": "vovan", "link": "https://stackoverflow.com/users/2109121/vovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 54532122, "answer_count": 4, "score": 4, "last_activity_date": 1549363315, "creation_date": 1549361480, "last_edit_date": 1549361908, "question_id": 54531980, "link": "https://stackoverflow.com/questions/54531980/what-does-it-mean-to-compare-classes-with-greater-than-and-less-than-ope", "title": "What does it mean to compare classes with greater than `&gt;` and less than `&lt;` operators?", "body": "<p>I have not found any description for the operators <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code> in the documentation for <code>Object</code> and <code>Class</code>.</p>\n\n<pre><code>String &gt; Object      # =&gt; false\nBasicObject &gt; Object # =&gt; true\nString &gt; Integer     # =&gt; nil\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "actioncable"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1549360222, "post_id": 54531567, "comment_id": 95864720, "body": "I think yout are looking for <a href=\"https://stackoverflow.com/a/49236556/10522579\">this post</a>"}, {"owner": {"reputation": 13, "user_id": 1934881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175bb5e815abb2feff0d19291ae54691?s=128&d=identicon&r=PG", "display_name": "got2be", "link": "https://stackoverflow.com/users/1934881/got2be"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1549361127, "post_id": 54531567, "comment_id": 95865289, "body": "@ray, yep, this can be handled on the channel&#39;s level, but I wouldn&#39;t like to mix users and devices logic in a single connection."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1554331918, "post_id": 54531567, "comment_id": 97716767, "body": "I stopped working with rails, but I imagine it&#39;s possible and you&#39;re on the right track. Other solutions would be to 1. Place your logic in a gem and import that gem in two different applications; 2. Have different modules for the user and the device logic and <code>include</code> the modules in the connection object (but not it&#39;s class) according to the login procedure; 3. Use WebSockets directly (i.e., with iodine), in which case you could use a different route (url) for each type of client (users vs. devices)."}], "owner": {"reputation": 13, "user_id": 1934881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175bb5e815abb2feff0d19291ae54691?s=128&d=identicon&r=PG", "display_name": "got2be", "link": "https://stackoverflow.com/users/1934881/got2be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549360065, "creation_date": 1549360065, "question_id": 54531567, "link": "https://stackoverflow.com/questions/54531567/is-it-possible-to-create-two-actioncable-servers-in-one-rails-application", "title": "Is it possible to create two ActionCable servers in one Rails application?", "body": "<p>Say, I need to implement some communication between users and smart devices via websockets. The user's identifying, authorization, channels, and stuff are completely different from devices' ones, but the core models and libs are the same. That's why I would mount two ActionCable connections on the single Rails app. \nSo, the code would look like this:</p>\n\n<pre><code>module ApplicationCableForUsers\n  class Connection &lt; ActionCable::Connection::Base\n    identified_by :current_user\n    ...\n  end\n\n  class SomeChannel &lt; ActionCable::Channel::Base; end\nend\n</code></pre>\n\n<pre><code>module ApplicationCableForDevices\n  class Connection &lt; ActionCable::Connection::Base\n    identified_by :current_device\n    ...\n  end\n\n  class SomeOtherChannel &lt; ActionCable::Channel::Base; end\nend\n</code></pre>\n\n<pre><code>mount ApplicationCableForUsers, to: '/ws_users'\nmount ApplicationCableForDevices, to: '/ws_devices'\n</code></pre>\n\n<p>Is something like this even possible?</p>\n"}, {"tags": ["ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1549359381, "post_id": 54531270, "comment_id": 95864209, "body": "There&#39;s also <a href=\"http://ruby-doc.org/core-2.6.1/Module.html#method-i-singleton_class-3F\" rel=\"nofollow noreferrer\"><code>singleton_class?</code></a> so a singleton class is quite aware of its special status."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1549361169, "post_id": 54531270, "comment_id": 95865303, "body": "<i>&quot;without actually typing some_object&quot;</i> \u2013 it&#39;s even worse: if <code>some_object</code> is a local variable, it&#39;s not defined in the <code>class &lt;&lt; some_object</code> block. Attempting to reference it within the block results in a <code>NameError</code>."}], "answers": [{"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1549373940, "post_id": 54531765, "comment_id": 95872874, "body": "Excellent work with the C extension. I&#39;m still hoping there&#39;s a a clean-ish plain Ruby solution, though."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 7, "last_activity_date": 1549366010, "last_edit_date": 1549366010, "creation_date": 1549360777, "answer_id": 54531765, "question_id": 54531270, "link": "https://stackoverflow.com/questions/54531270/retrieve-a-ruby-object-from-its-singleton-class/54531765#54531765", "title": "Retrieve a Ruby object from its singleton class?", "body": "<p>I'm not aware of any built-in method or keyword but you could write a method that adds a (singleton) method to an object's singleton class, returning the object itself:</p>\n\n<pre><code>class Object\n  def define_instance_accessor(method_name = :instance)\n    singleton_class.define_singleton_method(method_name, &amp;method(:itself))\n  end\nend\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>obj = Object.new              #=&gt; #&lt;Object:0x00007ff58e8742f0&gt;\nobj.define_instance_accessor\nobj.singleton_class.instance  #=&gt; #&lt;Object:0x00007ff58e8742f0&gt;\n</code></pre>\n\n<p>In your code:</p>\n\n<pre><code>class Example\n  PARENTS = []\n  PARENTS.define_instance_accessor\n  class &lt;&lt; PARENTS\n    FATHER = :father\n    MOTHER = :mother\n    instance.push(FATHER, MOTHER)\n  end\nend\n</code></pre>\n\n<hr>\n\n<p>Internally, YARV stores the object in an instance variable called <code>__attached__</code>. The instance variable doesn't have the usual <code>@</code> prefix, so it isn't visible or accessible from within Ruby.</p>\n\n<p>Here's a little C extension to expose it:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;ruby.h&gt;\n\nstatic VALUE\ninstance_accessor(VALUE klass)\n{\n    return rb_ivar_get(klass, rb_intern(\"__attached__\"));\n}\n\nvoid Init_instance_accessor()\n{\n    rb_define_method(rb_cClass, \"instance\", instance_accessor, 0);\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>irb -r ./instance_accessor\n&gt; obj = Object.new\n#=&gt; #&lt;Object:0x00007f94a11e1260&gt;\n&gt; obj.singleton_class.instance\n#=&gt; #&lt;Object:0x00007f94a11e1260&gt;\n&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 3, "creation_date": 1549362883, "post_id": 54532176, "comment_id": 95866318, "body": "@MarcinKo\u0142odziej yeah, it\u2019s \u201chow to turn all your teammates into violent enemies in 24 hours\u201d :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1549362040, "creation_date": 1549362040, "answer_id": 54532176, "question_id": 54531270, "link": "https://stackoverflow.com/questions/54531270/retrieve-a-ruby-object-from-its-singleton-class/54532176#54532176", "title": "Retrieve a Ruby object from its singleton class?", "body": "<p>Just out of curiosity (please don\u2019t use at home or school)</p>\n\n<pre><code>object = []\nclass &lt;&lt; object\n  type, id = to_s[/(?&lt;=:#&lt;).*?(?=&gt;)/].split(':')\n  ObjectSpace.each_object(Kernel.const_get(type)).find do |e|\n    e.__id__ == id.to_i(16) &gt;&gt; 1\n  end &lt;&lt; :father\nend   \n#\u21d2 [:father]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1550002747, "post_id": 54657161, "comment_id": 96107501, "body": "Good idea. It&#39;s still not completely straightforward but it goes in the right direction, and without needing C."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1550003493, "post_id": 54657161, "comment_id": 96107855, "body": "It works fine with the original example : <a href=\"https://pastebin.com/DqJh9JuB\" rel=\"nofollow noreferrer\">pastebin.com/DqJh9JuB</a> Do you have any better idea for method name?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1550005135, "post_id": 54657161, "comment_id": 96108625, "body": "For the name, how about <code>ssalc_notelgnis</code>? I&#39;m not sure you want to check if the argument is a singleton class within the method, but if you do perhaps raise an exception if it isn&#39;t. (Consider a guard clause rather than <code>if</code>: <code>raise ... unless singleton_class</code>.) Also, shouldn&#39;t that be defined in <code>Class</code> rather than <code>Module</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1550006056, "post_id": 54657161, "comment_id": 96109021, "body": "Another idea is <code>singleton_class_of_what?</code>."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1549999960, "last_edit_date": 1549999960, "creation_date": 1549998782, "answer_id": 54657161, "question_id": 54531270, "link": "https://stackoverflow.com/questions/54531270/retrieve-a-ruby-object-from-its-singleton-class/54657161#54657161", "title": "Retrieve a Ruby object from its singleton class?", "body": "<p>We can do that as follows.</p>\n\n<pre><code>def singleton_class_to_object(sc)\n  ObjectSpace.each_object(Object).find { |o|\n    (o.singleton_class == sc) rescue false }\nend\n\no = Object.new\n  #=&gt; #&lt;Object:0x00005b52e502d030&gt; \nsingleton_class_to_object(o.singleton_class)\n  #=&gt; #&lt;Object:0x00005b52e502d030&gt; \n\nclass C; end\nsingleton_class_to_object(C.singleton_class)\n  #=&gt; C\n</code></pre>\n\n<p>The in-line rescue is to deal with objects <code>o</code> that are immediate objects, having no singleton classes.</p>\n\n<p>In MRI v2.7.0,</p>\n\n<pre><code>ObjectSpace.each_object(Object).to_a.size\n  #=&gt; 35362\n</code></pre>\n\n<p>a mere pittance. </p>\n"}], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 1, "accepted_answer_id": 54531765, "answer_count": 3, "score": 4, "last_activity_date": 1549999960, "creation_date": 1549359175, "last_edit_date": 1549359497, "question_id": 54531270, "link": "https://stackoverflow.com/questions/54531270/retrieve-a-ruby-object-from-its-singleton-class", "title": "Retrieve a Ruby object from its singleton class?", "body": "<p>It is possible to access a <a href=\"https://ruby-doc.org/core-2.5.1/Object.html\" rel=\"nofollow noreferrer\">singleton class</a> from a Ruby object with:</p>\n\n<pre><code>some_object.singleton_class\n</code></pre>\n\n<p>Is it possible to do the reverse operation : access the original object when inside the singleton class?</p>\n\n<pre><code>class &lt;&lt; some_object\n  # how to reference some_object without actually typing some_object?\nend\n</code></pre>\n\n<p>I wanted to DRY this <a href=\"https://stackoverflow.com/a/54530568/6419007\">method</a>:</p>\n\n<pre><code>class Example\n  PARENTS = []\n  class &lt;&lt; PARENTS\n    FATHER = :father\n    MOTHER = :mother\n    PARENTS.push(FATHER, MOTHER)\n  end\nend\n</code></pre>\n\n<p>and tried to replace <code>PARENTS</code> inside the class with something more generic.</p>\n"}, {"tags": ["ruby", "string", "gsub"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1549358034, "post_id": 54530749, "comment_id": 95863414, "body": "Try something like <code>def remove_appellations_in_string(string, region_id)    stopwords.each do |stop|       rx = stop.name.chars.map { |c| &quot;[#{c}#{I18n.transliterate(c)}]&quot; }.join        string.gsub!(Regexp.new(rx, &#39;i&#39;), &#39; &#39;)     end         return &#39; &#39; + string + &#39; &#39;    end</code>. Here is a code snippet - <a href=\"https://ideone.com/IevjIW\" rel=\"nofollow noreferrer\">ideone.com/IevjIW</a>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1549358206, "post_id": 54530749, "comment_id": 95863523, "body": "Not sure what you mean by &quot;the indexes of the cars&quot;."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549358667, "post_id": 54530749, "comment_id": 95863787, "body": "What is <code>I18n</code>? If you are using some library, then please refer to that."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549358928, "post_id": 54530749, "comment_id": 95863956, "body": "What is <code>stopwords</code>?"}, {"owner": {"reputation": 2504, "user_id": 1041509, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nC1WT.png?s=128&g=1", "display_name": "alex.bour", "link": "https://stackoverflow.com/users/1041509/alex-bour"}, "edited": false, "score": 0, "creation_date": 1549359526, "post_id": 54530749, "comment_id": 95864294, "body": "The Wiktor answer works like a charm ! But <code>rx = I18n.transliterate(stop.name)</code> works also, with the regexp <code>string.gsub!(Regexp.new(rx, &#39;i&#39;), &#39; &#39;)</code>. SO what is the advantage of <code>rx = stop.name.chars.map { |c| &quot;[#{c}#{I18n.transliterate(c)}]&quot; }.join</code> ?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1549360175, "post_id": 54530749, "comment_id": 95864694, "body": "@alex.bour Well, I am not sure now after your latest comment. I thought stop words may contain accented letters. I can&#39;t get it why that worked as <code>&#47;vallee&#47;i</code> can&#39;t match <code>Vall&#233;e</code>, <code>&#47;vall[e&#233;][e&#233;]&#47;i</code> will."}, {"owner": {"reputation": 2504, "user_id": 1041509, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nC1WT.png?s=128&g=1", "display_name": "alex.bour", "link": "https://stackoverflow.com/users/1041509/alex-bour"}, "edited": false, "score": 0, "creation_date": 1549361449, "post_id": 54530749, "comment_id": 95865450, "body": "Yes, I confirm that the stopword may contains accented letters, that&#39;s why I used I18n.transliterate(stop). Another problem is the original string can also contains accented letters... So does the reverse is true ? Does original <code>Vall&#233;e</code> can match the stopword <code>vallee</code> AS original <code>vallee</code> can match the stopword <code>vall&#233;e</code>  ?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1549362522, "post_id": 54530749, "comment_id": 95866105, "body": "@alex.bour No, it won&#39;t. I suggest using a hash of mappings like <code>e</code> -&gt; <code>[&#233;e]</code>  and replace each char in stopword with these character classes, then build the case insensitive regex using the constructor and replace with <code>gsub</code> from the original string."}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1549364196, "post_id": 54532232, "comment_id": 95867132, "body": "Note that transliterating a string does not necessarily end up with a string of the same length."}, {"owner": {"reputation": 2504, "user_id": 1041509, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nC1WT.png?s=128&g=1", "display_name": "alex.bour", "link": "https://stackoverflow.com/users/1041509/alex-bour"}, "edited": false, "score": 0, "creation_date": 1549364205, "post_id": 54532232, "comment_id": 95867134, "body": "Hello, Yes, it&#39;s a thing like this ! Thanks SRack. I made a few changes to clarify things. <code>index_stopword_start = unaccent_string.index(unaccent_stopword)                 next if index_stopword_start.nil?                  index_stopword_end = index_stopword_start + unaccent_stopword.length                  # new string         string = string[0..(index_stopword_start - 1)] + string[index_stopword_end..-1]</code>"}, {"owner": {"reputation": 2504, "user_id": 1041509, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nC1WT.png?s=128&g=1", "display_name": "alex.bour", "link": "https://stackoverflow.com/users/1041509/alex-bour"}, "edited": false, "score": 0, "creation_date": 1549364830, "post_id": 54532232, "comment_id": 95867461, "body": "Sawa, yes I know that transliterate can be a problem with some languages. Thanks."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 2504, "user_id": 1041509, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nC1WT.png?s=128&g=1", "display_name": "alex.bour", "link": "https://stackoverflow.com/users/1041509/alex-bour"}, "edited": false, "score": 0, "creation_date": 1551431373, "post_id": 54532232, "comment_id": 96645497, "body": "Did this work as an answer @alex.bour? If so, suitable to accept it?"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 2, "last_activity_date": 1549363012, "last_edit_date": 1549363012, "creation_date": 1549362191, "answer_id": 54532232, "question_id": 54530749, "link": "https://stackoverflow.com/questions/54530749/remove-part-of-string-downcase-and-keep-the-original-upcase-in-ruby/54532232#54532232", "title": "Remove part of string (downcase) and keep the original (upcase) in Ruby", "body": "<p>This seems to work:</p>\n\n<pre><code>string = \"Ch\u00e2teau Dupont Vall\u00e9e du Rh\u00f4ne\"   \nstopword = \"vallee du rhone\"  \nindex = I18n.transliterate(string).downcase.index(I18n.transliterate(stopword).downcase)\nstring[0..(index - 1)] + string[(index + stopword.length)..-1]\n\n# =&gt; \"Ch\u00e2teau Dupont \"\n\nstopword = \"Dupont\" \nindex = I18n.transliterate(string).downcase.index(I18n.transliterate(stopword).downcase)\nstring[0..(index - 1)] + string[(index + stopword.length)..-1]\n\n# =&gt; \"Ch\u00e2teau  Vall\u00e9e du Rh\u00f4ne\"\n</code></pre>\n\n<p>It does as you've suggested - grabs the index of where the stopword matches a stripped string, and returns the text before and after this.</p>\n\n<p>Is that what you're after? Let me know how you get on with it or if you've any questions.</p>\n"}], "owner": {"reputation": 2504, "user_id": 1041509, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nC1WT.png?s=128&g=1", "display_name": "alex.bour", "link": "https://stackoverflow.com/users/1041509/alex-bour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 54532232, "answer_count": 1, "score": 2, "last_activity_date": 1549377001, "creation_date": 1549357146, "last_edit_date": 1549377001, "question_id": 54530749, "link": "https://stackoverflow.com/questions/54530749/remove-part-of-string-downcase-and-keep-the-original-upcase-in-ruby", "title": "Remove part of string (downcase) and keep the original (upcase) in Ruby", "body": "<p>I would like to remove a set of words from a ruby string, using the lowercase and unaccented version of the words, and keep the original string with the current casing and the current accents. </p>\n\n<p>For example:</p>\n\n<pre><code>string = \"Ch\u00e2teau Dupont Vall\u00e9e du Rh\u00f4ne\" \nstopwords= \"vallee du Rhone\"\n</code></pre>\n\n<p>Desired output: <code>string = \"Ch\u00e2teau Dupont\"</code></p>\n\n<p>What I can do so far is using a lowercase unaccented strings to remove the words:</p>\n\n<pre><code>string = \"chateau dupont vallee du rhone\" \nstopword = \"vallee du rhone\"\n</code></pre>\n\n<p>Example output: <code>string = \"chateau dupont\"</code> </p>\n\n<p>In fact, I want to get the original string but remove a string using the lowercase unaccented version of the words.</p>\n\n<p>My code:</p>\n\n<pre><code>def remove_appellations_in_string(string, region_id)\n   down_trans_string = I18n.transliterate(string.dup)      \n   # custom request to order by max length in name            \n   stopwords.each do |stop|\n      # downcase/unaccent stopword\n      down_trans_stop = I18n.transliterate(stop.name.downcase)\n      # remove\n      down_trans_string.gsub!(down_trans_stop, ' ')\n    end    \n    return ' ' + string + ' ' \n  end\n</code></pre>\n\n<p>I suppose I need to use a regex OR get a way to obtain the indexes of the stopwords to remove them from the original string.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1540, "user_id": 1245440, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8a2a573a8585a0e04eecd822955e9fbe?s=128&d=identicon&r=PG", "display_name": "Pramod Shinde", "link": "https://stackoverflow.com/users/1245440/pramod-shinde"}, "edited": false, "score": 0, "creation_date": 1549357163, "post_id": 54530648, "comment_id": 95862939, "body": "You need to more specific while asking such question. Improve your question so  that it is easy to understand."}, {"owner": {"reputation": 2470, "user_id": 1013142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd97eb9f014330c6063dfadb77bbd5de?s=128&d=identicon&r=PG", "display_name": "Sudipta Mondal", "link": "https://stackoverflow.com/users/1013142/sudipta-mondal"}, "edited": false, "score": 0, "creation_date": 1549357932, "post_id": 54530648, "comment_id": 95863357, "body": "run this on console <code>rake routes &gt; routes.txt</code>,  in your routes.txt check for <code>login_****</code> Paths that should give you some insight"}], "answers": [{"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1551431319, "post_id": 54532862, "comment_id": 96645461, "body": "Did this help at all @rohitjoshi?"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1549364218, "creation_date": 1549364218, "answer_id": 54532862, "question_id": 54530648, "link": "https://stackoverflow.com/questions/54530648/where-is-the-login-url-defined-nameerror-undefined-local-variable-or-method-l/54532862#54532862", "title": "Where is the login_url defined? NameError: undefined local variable or method `login_url&#39;", "body": "<p>In the tutorial, <code>login_url</code> is intended to be a URL helper defined by Rails, based on this line in <code>routes.rb</code>:</p>\n\n<pre><code>controller :sessions do\n  get  'login' =&gt; :new\nend\n</code></pre>\n\n<p>All routes have a helper generated to reach them, and you can grep this using <code>rails routes -G login</code>. In your case, this will give a line something like:</p>\n\n<pre><code>login GET   /login(.:format)     sessions#new\n</code></pre>\n\n<p>What this shows is 1) the route name and HTML method, 2) the path and 3) the <code>controller#action</code> handling it.</p>\n\n<p>In the above example, <code>login_url</code> would work, as the route name can be suffixed by either <code>_url</code> or <code>_path</code> due to the auto-generated helper.</p>\n\n<p>However, it's likely you won't see exactly this as you're having problems. You might see, for example:</p>\n\n<pre><code>sessions GET   /login(.:format)     sessions#new\n</code></pre>\n\n<p>This means you have two options:</p>\n\n<p>Use <code>sessions_url</code> in place of <code>login_url</code>.</p>\n\n<p>Or, and likely the correct solution, name your route in <code>routes.rb</code> using <code>as</code>:</p>\n\n<pre><code>controller :sessions do\n  get  'login' =&gt; :new, as: 'login'\nend\n</code></pre>\n\n<p>Do that, and your route should be renamed to <code>login</code> and therefore <code>login_url</code> be made available.</p>\n\n<p>Let me know how you get on or if you've any questions :)</p>\n"}], "owner": {"reputation": 11, "user_id": 11007320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oQ9r88o6aig/AAAAAAAAAAI/AAAAAAAAYY4/9mKKMP9xsRg/photo.jpg?sz=128", "display_name": "rohit joshi", "link": "https://stackoverflow.com/users/11007320/rohit-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566988925, "creation_date": 1549356716, "last_edit_date": 1549357544, "question_id": 54530648, "link": "https://stackoverflow.com/questions/54530648/where-is-the-login-url-defined-nameerror-undefined-local-variable-or-method-l", "title": "Where is the login_url defined? NameError: undefined local variable or method `login_url&#39;", "body": "<p>I am reading Agile Development with Rails 5 by Sam Ruby. <a href=\"https://pragprog.com/book/rails51/agile-web-development-with-rails-5-1\" rel=\"nofollow noreferrer\">https://pragprog.com/book/rails51/agile-web-development-with-rails-5-1</a></p>\n\n<p>In Chapter 14 Task I:Logging in after I use rails test, the console gives the following errors</p>\n\n<pre><code>Error:\nProductTest#test_image_url:\nNameError: undefined local variable or method `login_url' for #&lt;ProductTest:0x00000000062aadb8&gt;\nDid you mean?  login_as\n    test/test_helper.rb:10:in `login_as'\n    test/test_helper.rb:16:in `setup'\n\n\nbin/rails test test/models/product_test.rb:38\n\nE\n\nError:\nProductTest#test_product_price_must_be_positive:\nNameError: undefined local variable or method `login_url' for #&lt;ProductTest:0x0000000005b9b068&gt;\nDid you mean?  login_as\n    test/test_helper.rb:10:in `login_as'\n    test/test_helper.rb:16:in `setup'\n\n\nbin/rails test test/models/product_test.rb:15\n\nE\n\nError:\nProductTest#test_product_is_not_valid_without_a_unique_title:\nNameError: undefined local variable or method `login_url' for #&lt;ProductTest:0x0000000008349948&gt;\nDid you mean?  login_as\n    test/test_helper.rb:10:in `login_as'\n    test/test_helper.rb:16:in `setup'\n\n\nbin/rails test test/models/product_test.rb:50\n\nE\n\nError:\nProductTest#test_product_attributes_must_not_be_empty:\nNameError: undefined local variable or method `login_url' for #&lt;ProductTest:0x0000000007ff8c08&gt;\nDid you mean?  login_as\n    test/test_helper.rb:10:in `login_as'\n    test/test_helper.rb:16:in `setup'\n\n\nbin/rails test test/models/product_test.rb:6\n\n.......E\n\nError:\nUserStoriesTest#test_buying_a_product:\nActionView::Template::Error: undefined method `each' for nil:NilClass\n    app/views/store/index.html.erb:7:in `block in _app_views_store_index_html_erb__32180898452112054_53581700'\n    app/views/store/index.html.erb:6:in `_app_views_store_index_html_erb__32180898452112054_53581700'\n    test/integration/user_stories_test.rb:16:in `block in &lt;class:UserStoriesTest&gt;'\n</code></pre>\n\n<p>I tried searching for a solution online but could'nt find one. <a href=\"https://stackoverflow.com/questions/49735705/agile-web-development-rails-5-test-failures\">Agile Web Development Rails 5 test failures</a>\nThis is a similar problem with same error but I didn' understand the solution</p>\n\n<p>My test/test_helper.rb</p>\n\n<pre><code>\n    ENV['RAILS_ENV'] ||= 'test'\n    require_relative '../config/environment'\n    require 'rails/test_help'\n\n    class ActiveSupport::TestCase\n  # Setup all fixtures in test/fixtures/*.yml for all tests in alphabetical order.\n  fixtures :all\n\ndef login_as(user)\npost login_url, params: { name: user.name, password: 'secret' }\nend\ndef logout\ndelete logout_url\nend\ndef setup\nlogin_as users(:one)\nend\n\n\n  # Add more helper methods to be used by all tests here...\nend\n\n</code></pre>\n\n<p>My config/routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\nget 'admin' =&gt; 'admin#index'\n\n  controller :sessions do\n    get  'login' =&gt; :new\n    post 'login' =&gt; :create\n    delete 'logout' =&gt; :destroy\n  end\n\n  resources :users\n  resources :orders\n  resources :line_items\n  resources :carts\n  root 'store#index', as: 'store_index'\n\n  resources :products do\n    get :who_bought, on: :member\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1549356668, "post_id": 54530541, "comment_id": 95862700, "body": "People search in DB with SQL, not with AR."}], "answers": [{"comments": [{"owner": {"reputation": 340, "user_id": 1055864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0dbb98b5a3576e50b33808f3577447b2?s=128&d=identicon&r=PG", "display_name": "Vaibhav Kaushal", "link": "https://stackoverflow.com/users/1055864/vaibhav-kaushal"}, "edited": false, "score": 1, "creation_date": 1549358824, "post_id": 54530747, "comment_id": 95863888, "body": "A better version is: <code>People.where(&quot;full_name LIKE ?&quot;, &quot;&#39;%smith%&#39;&quot;)</code>"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1549365557, "post_id": 54530747, "comment_id": 95867858, "body": "Use <code>Person</code> instead of <code>People</code> as singular form for model name. +1"}], "tags": [], "owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "is_accepted": true, "score": 4, "last_activity_date": 1549365397, "last_edit_date": 1549365397, "creation_date": 1549357143, "answer_id": 54530747, "question_id": 54530541, "link": "https://stackoverflow.com/questions/54530541/active-record-search-in-ruby-for-certain-text-pattern/54530747#54530747", "title": "Active Record search in Ruby for certain text pattern", "body": "<p>You can use Sql <code>like</code> or <code>ilike</code> queries</p>\n\n<p><strong>Edit</strong> as per @Vaibhav Kaushal comment</p>\n\n<pre><code>Person.where(\"full_name LIKE ?\", \"'%smith%'\")\n</code></pre>\n\n<p>For <strong>MySQL</strong> database,</p>\n\n<pre><code>Person.where(\"full_name  RLIKE ?\", 'smith')\n</code></pre>\n\n<p>If you want to use <code>OR</code> i.e. find Person objects having full_name matching 'smith', 'roger' or 'dwane', you can use below,</p>\n\n<pre><code>Person.where(\"full_name  RLIKE ?\", 'smith | roger | dwane')\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 9444402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvFMB.jpg?s=128&g=1", "display_name": "Andrew Carbon", "link": "https://stackoverflow.com/users/9444402/andrew-carbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 54530747, "answer_count": 1, "score": 2, "last_activity_date": 1549365397, "creation_date": 1549356243, "question_id": 54530541, "link": "https://stackoverflow.com/questions/54530541/active-record-search-in-ruby-for-certain-text-pattern", "title": "Active Record search in Ruby for certain text pattern", "body": "<p>Let's say, I have class Person with a field 'full_name'. How can I find all records where this field includes pattern 'smith'?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oauth", "oauth-2.0", "net-http"], "comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1549354462, "post_id": 54529838, "comment_id": 95861677, "body": "There&#39;s a missing quote. Did you missed it while pasting in stackoverflow or in code please check"}, {"owner": {"reputation": 587, "user_id": 5505900, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/zoQra.jpg?s=128&g=1", "display_name": "Tushar H", "link": "https://stackoverflow.com/users/5505900/tushar-h"}, "reply_to_user": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1549354923, "post_id": 54529838, "comment_id": 95861872, "body": "Missed it here only, its there in code."}], "answers": [{"tags": [], "owner": {"reputation": 587, "user_id": 5505900, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/zoQra.jpg?s=128&g=1", "display_name": "Tushar H", "link": "https://stackoverflow.com/users/5505900/tushar-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1549370282, "creation_date": 1549370282, "answer_id": 54534626, "question_id": 54529838, "link": "https://stackoverflow.com/questions/54529838/ruby-oauth2-0-client-credential-type-has-unsupported-client-authentication-meth/54534626#54534626", "title": "Ruby OAuth2.0: client credential type has unsupported client authentication method", "body": "<p>OK, so finally I cleared these points.</p>\n\n<ol>\n<li><p>OAuth2 gem does make a request to OAuth server with --token_endpoint_auth_method set to 'client_secret_post'.</p></li>\n<li><p>While registering an client with OAuth server we will have to set token_endpoint_auth_method to 'client_secret_post', so that it will work.</p></li>\n</ol>\n\n<p>In my case I was using Hydra, so I used below command to create a client:</p>\n\n<pre><code>hydra clients create --endpoint &lt;OAuth server url&gt; --id CLIENT_ID --secret CLIENT_SECRET \\\n--token-endpoint-auth-method 'client_secret_post' -g client_credentials\n</code></pre>\n\n<p>Now, using these CLIENT_ID and CLIENT_SECRET with oauth2 works.</p>\n\n<p>But still one point which is unclear - can I make a request with <strong>token_endpoint_auth_method</strong> set to <strong>client_secret_basic</strong> using oauth2 gem.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 12046848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e021b9e1ad7e15bdfe6871c6e7d5a11?s=128&d=identicon&r=PG", "display_name": "mtoshi", "link": "https://stackoverflow.com/users/12046848/mtoshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1591962637, "last_edit_date": 1591962637, "creation_date": 1591962286, "answer_id": 62343605, "question_id": 54529838, "link": "https://stackoverflow.com/questions/54529838/ruby-oauth2-0-client-credential-type-has-unsupported-client-authentication-meth/62343605#62343605", "title": "Ruby OAuth2.0: client credential type has unsupported client authentication method", "body": "<p>I also encountered the same issue.</p>\n\n<p>Please add or change this client option setting in your client code.</p>\n\n<pre><code>:auth_scheme =&gt; :basic_auth\n</code></pre>\n\n<p>The default settings is below.</p>\n\n<pre><code>:auth_scheme =&gt; :request_body\n</code></pre>\n\n<p>I have excerpted a part of the OAuth2::Client code.</p>\n\n<p>Please check it.</p>\n\n<pre><code>require 'faraday'\nrequire 'logger'\n\nmodule OAuth2\n  # The OAuth2::Client class\n  class Client # rubocop:disable Metrics/ClassLength\n    attr_reader :id, :secret, :site\n    attr_accessor :options\n    attr_writer :connection\n\n    # @option opts [Symbol] :auth_scheme (:basic_auth) HTTP method to use to authorize request (:basic_auth or :request_body)\n\n    def initialize(client_id, client_secret, options = {}, &amp;block)\n      opts = options.dup\n      @id = client_id\n      @secret = client_secret\n      @site = opts.delete(:site)\n      ssl = opts.delete(:ssl)\n      @options = {:authorize_url    =&gt; '/oauth/authorize',\n                  :token_url        =&gt; '/oauth/token',\n                  :token_method     =&gt; :post,\n                  :auth_scheme      =&gt; :request_body,  # &lt;-- Here !!!\n                  :connection_opts  =&gt; {},\n                  :connection_build =&gt; block,\n                  :max_redirects    =&gt; 5,\n                  :raise_errors     =&gt; true}.merge(opts)\n      @options[:connection_opts][:ssl] = ssl if ssl\n    end\n\n</code></pre>\n\n<p>Sample snippet is here <a href=\"https://gist.github.com/mtoshi/cd74f57631805fb1b2290137f58dac9f\" rel=\"nofollow noreferrer\">https://gist.github.com/mtoshi/cd74f57631805fb1b2290137f58dac9f</a></p>\n"}], "owner": {"reputation": 587, "user_id": 5505900, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/zoQra.jpg?s=128&g=1", "display_name": "Tushar H", "link": "https://stackoverflow.com/users/5505900/tushar-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 862, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1591962637, "creation_date": 1549353191, "last_edit_date": 1549354788, "question_id": 54529838, "link": "https://stackoverflow.com/questions/54529838/ruby-oauth2-0-client-credential-type-has-unsupported-client-authentication-meth", "title": "Ruby OAuth2.0: client credential type has unsupported client authentication method", "body": "<p>I am using <a href=\"https://github.com/oauth-xx/oauth2\" rel=\"nofollow noreferrer\">OAuth2</a> gem, for making a client_credential authentication. My code is as below,</p>\n\n<pre><code>require 'oauth2'\nclient = OAuth2::Client.new(\"my_client_id\", \"my_client_secret\", :site =&gt; \"my_site_url\", :token_url =&gt; \"oauth2/token\")\nclient.client_credentials.get_token\n</code></pre>\n\n<p>When I execute above code block, it respond with below error,</p>\n\n<pre><code>OAuth2::Error (invalid_client: Client authentication failed (e.g., unknown client, no client authentication included, or unsupported authentication method))\n{\n  \"error\":\"invalid_client\",\"error_description\":\"Client authentication failed (e.g., unknown client, no client authentication included, or unsupported authentication method)\",\n  \"error_hint\":\"The OAuth 2.0 Client supports client authentication method \"client_secret_basic\", but method \"client_secret_post\" was requested. \n  You must configure the OAuth 2.0 client's \"token_endpoint_auth_method\" value to accept \"client_secret_post\".\",\"status_code\":401}\n</code></pre>\n\n<p>I checked the using 'net/http' library, and my <code>client_id</code> &amp; <code>client_secrets</code> are valid and working.</p>\n\n<p>The only problem I see is with the authentication method as said in hint of above message,</p>\n\n<pre><code>The OAuth 2.0 Client supports client authentication method \"client_secret_basic\", but method \"client_secret_post\" was requested. You must configure the OAuth 2.0 client's \"token_endpoint_auth_method\" value to accept \"client_secret_post\"\n</code></pre>\n\n<p>What I want to know is? </p>\n\n<ol>\n<li>How <code>OAuth2</code> gem decide on using client_secret_post vs client_secret_basic? I mean How can I request with client_secret_basic in OAuth2 gem?</li>\n<li>If not above then, How should I specify token_endpoint_auth_method to accpet client_secret_post?</li>\n</ol>\n"}, {"tags": ["ruby", "loops", "hash"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 2, "creation_date": 1549350898, "post_id": 54528817, "comment_id": 95860237, "body": "Is this for testing? What is <code>category_2_a_total</code>? A function call?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1549350967, "post_id": 54528817, "comment_id": 95860267, "body": "The pattern is not clear. What is the logic that gives <code>&quot;category_1&quot;</code> for <code>:category_1</code> and <code>&quot;category&quot;</code> for <code>:category_2</code>?"}, {"owner": {"reputation": 690, "user_id": 2390233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8cd867dfd775e56b1944f6f9af465bc?s=128&d=identicon&r=PG", "display_name": "ecki", "link": "https://stackoverflow.com/users/2390233/ecki"}, "edited": false, "score": 0, "creation_date": 1549351068, "post_id": 54528817, "comment_id": 95860313, "body": "Not for testing. category_2_a_total is a local variable. The intention is to pass back a lot of variables back to a parent method in a concise structure, hence the hash."}, {"owner": {"reputation": 690, "user_id": 2390233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8cd867dfd775e56b1944f6f9af465bc?s=128&d=identicon&r=PG", "display_name": "ecki", "link": "https://stackoverflow.com/users/2390233/ecki"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549351145, "post_id": 54528817, "comment_id": 95860341, "body": "@sawa, that was a typo, I will amend. It should be category 2"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1549351156, "post_id": 54528817, "comment_id": 95860345, "body": "Why do you use local variables in the first place? Wouldn&#39;t it be easier to keep their values in a hash (or that hash) right from the beginning?"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1549353953, "post_id": 54528817, "comment_id": 95861460, "body": "This is the type of question where you&#39;re doing something wrong to begin with and solving it in the way you expect feels silly."}, {"owner": {"reputation": 690, "user_id": 2390233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8cd867dfd775e56b1944f6f9af465bc?s=128&d=identicon&r=PG", "display_name": "ecki", "link": "https://stackoverflow.com/users/2390233/ecki"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1549354300, "post_id": 54528817, "comment_id": 95861607, "body": "@KimmoLehto yes it does feel silly. can you elaborate on what is wrong and what best practice may be? thanks"}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549357065, "post_id": 54530186, "comment_id": 95862896, "body": "Are you sure they are instance  variables? And if so, then the arguments should begin with <code>&quot;@...&quot;</code>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1549357247, "post_id": 54530186, "comment_id": 95862983, "body": "@sawa indeed, thank you, of course I meant <code>local_variable_get</code>."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1549357770, "post_id": 54530186, "comment_id": 95863253, "body": "Also note that since Ruby 2.6, you can pass the block to <code>to_h</code> and not need <code>map</code> right before your <code>to_h</code>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1549357226, "last_edit_date": 1549357226, "creation_date": 1549354704, "answer_id": 54530186, "question_id": 54528817, "link": "https://stackoverflow.com/questions/54528817/how-to-create-large-hash-of-hashes-with-minimal-code/54530186#54530186", "title": "How to create large hash of hashes with minimal code", "body": "<p>FWIW, the following code should do what you asked. Still, all the comments saying you are doing is wrong are indeed very correct. </p>\n\n<p><em>I am posting the snippet for educational purposes only.</em></p>\n\n<pre><code>b = binding\nhash =\n  (?a..?i).map do |key|\n    [\n      key.to_sym,\n      (1..2).map do |i|\n        [\n          :\"category_#{i}\",\n          {\n            length: b.local_variable_get(key)[\"category_#{i}\"].length,\n            amount: b.local_variable_get(\"category_#{i}_#{key}_total\"),\n            speed: b.local_variable_get(\"category_#{i}_#{key}_speed\")\n          }\n        ]\n      end.to_h\n    ]\n  end.to_h\n</code></pre>\n\n<hr>\n\n<p>The code is untested, but it should work out of the box.</p>\n"}], "owner": {"reputation": 690, "user_id": 2390233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8cd867dfd775e56b1944f6f9af465bc?s=128&d=identicon&r=PG", "display_name": "ecki", "link": "https://stackoverflow.com/users/2390233/ecki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1549357226, "creation_date": 1549348136, "last_edit_date": 1549351245, "question_id": 54528817, "link": "https://stackoverflow.com/questions/54528817/how-to-create-large-hash-of-hashes-with-minimal-code", "title": "How to create large hash of hashes with minimal code", "body": "<p>I need to create a large hash of hashes with the following format, where speed and total are local variables:</p>\n\n<pre><code>hash_1 = {\n  a: {\n    category_1: {\n      length: a[\"category_1\"].length, \n      amount: category_1_a_total,\n      speed: category_1_a_speed\n    },\n    category_2: {\n      length: a[\"category_2\"].length, \n      amount: category_2_a_total,\n      speed: category_2_a_speed\n    }\n  },\n  # ~ 10 more hashes to follow b..i\n }\n</code></pre>\n\n<p>I have the full hash template that is large and makes the code harder to read. Is there a way to iterate over each of the sub-hashes as I build <code>hash_1</code>, then pass the variables needed into each iterations of the sub-hashes? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 9653283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f3f081f3771f67f15c33996611befb?s=128&d=identicon&r=PG&f=1", "display_name": "Banjo", "link": "https://stackoverflow.com/users/9653283/banjo"}, "edited": false, "score": 0, "creation_date": 1549357167, "post_id": 54528267, "comment_id": 95862941, "body": "Unfortunatley that didnt work. I have updates the error in original post"}, {"owner": {"reputation": 81, "user_id": 9653283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f3f081f3771f67f15c33996611befb?s=128&d=identicon&r=PG&f=1", "display_name": "Banjo", "link": "https://stackoverflow.com/users/9653283/banjo"}, "edited": false, "score": 0, "creation_date": 1549410841, "post_id": 54528267, "comment_id": 95890414, "body": "Im really at a blocker point here.. Tried everything from web articles nothing is working. I wonder why well know book Agile Web Development Using Rails 5 by Sam Ruby had ever chosen SQLite as there db of choice. Nothing is there in the book regarding installation. Shame :-("}], "tags": [], "owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1549345188, "creation_date": 1549345188, "answer_id": 54528267, "question_id": 54528045, "link": "https://stackoverflow.com/questions/54528045/sqlite-error-while-creating-a-rails-project-on-windows/54528267#54528267", "title": "Sqlite error while creating a rails project on Windows", "body": "<p>As per the description mentioned in the post it seems like sqlite is not properly installed on your machine including all headers required.</p>\n\n<p>Run the below mentioned command to get it installed properly:</p>\n\n<pre><code>gem install sqlite3 --platform=ruby -- --with-sqlite3-dir=C:/path/to/sqlite3\n</code></pre>\n\n<p>Where <code>C:/path/to/sqlite3</code> is where the headers (<code>include</code>) and libs (<code>lib</code>) for sqlite3 are resided.</p>\n\n<p>Hope that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11026019, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7kNGH6erSBE/AAAAAAAAAAI/AAAAAAAAAEw/QTLuGltRl8c/photo.jpg?sz=128", "display_name": "Paul Song", "link": "https://stackoverflow.com/users/11026019/paul-song"}, "is_accepted": false, "score": 2, "last_activity_date": 1549509288, "last_edit_date": 1549509288, "creation_date": 1549504630, "answer_id": 54565230, "question_id": 54528045, "link": "https://stackoverflow.com/questions/54528045/sqlite-error-while-creating-a-rails-project-on-windows/54565230#54565230", "title": "Sqlite error while creating a rails project on Windows", "body": "<p>Point to the fork of <code>sqlite3-ruby</code> gem and use the branch last updated in 2018:</p>\n\n<pre><code>gem 'sqlite3', git: \"https://github.com/larskanis/sqlite3-ruby\", branch: \"add-gemspec\"\n</code></pre>\n\n<p>to your Gemfile. So far, it worked for me. Good luck! :)</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 9653283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f3f081f3771f67f15c33996611befb?s=128&d=identicon&r=PG&f=1", "display_name": "Banjo", "link": "https://stackoverflow.com/users/9653283/banjo"}, "is_accepted": false, "score": 3, "last_activity_date": 1553685928, "last_edit_date": 1553685928, "creation_date": 1549584724, "answer_id": 54584291, "question_id": 54528045, "link": "https://stackoverflow.com/questions/54528045/sqlite-error-while-creating-a-rails-project-on-windows/54584291#54584291", "title": "Sqlite error while creating a rails project on Windows", "body": "<p>Found a very neat fix in here</p>\n\n<p><a href=\"https://github.com/sparklemotion/sqlite3-ruby/issues/248\" rel=\"nofollow noreferrer\">https://github.com/sparklemotion/sqlite3-ruby/issues/248</a></p>\n\n<p>It seesms it is only missing a library in msys2.</p>\n\n<p><code>ridk exec pacman -S mingw-w64-x86_64-dlfcn</code></p>\n\n<p>After that, the compilation went ok.</p>\n\n<p><code>gem install sqlite3 -v 1.4.0</code></p>\n\n<p>Note:- adding a dependency on a git branch does not seem ideal.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14253550, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/eafd5f6ba68c025dfbd104eb3b6a75d7?s=128&d=identicon&r=PG", "display_name": "Harinath Reddy", "link": "https://stackoverflow.com/users/14253550/harinath-reddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1599731921, "creation_date": 1599731921, "answer_id": 63827247, "question_id": 54528045, "link": "https://stackoverflow.com/questions/54528045/sqlite-error-while-creating-a-rails-project-on-windows/63827247#63827247", "title": "Sqlite error while creating a rails project on Windows", "body": "<p>It's an simple Permission issue, follow the below steps.</p>\n<ol>\n<li>Uninstall Ruby</li>\n<li>Reinstall Ruby , *<em>while reinstalling Ruby install it under C:\\user-name*</em>  Folder.</li>\n<li>After Installing Ruby , re run gem install sqllite3 under C:\\user-name\\    Folder.\nhere user-name is user your user directory.\nExample :C:\\Users\\rose\\</li>\n</ol>\n"}], "owner": {"reputation": 81, "user_id": 9653283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f3f081f3771f67f15c33996611befb?s=128&d=identicon&r=PG&f=1", "display_name": "Banjo", "link": "https://stackoverflow.com/users/9653283/banjo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3064, "favorite_count": 1, "answer_count": 4, "score": 2, "last_activity_date": 1599731921, "creation_date": 1549343793, "last_edit_date": 1549423157, "question_id": 54528045, "link": "https://stackoverflow.com/questions/54528045/sqlite-error-while-creating-a-rails-project-on-windows", "title": "Sqlite error while creating a rails project on Windows", "body": "<p>Im a newbee to rails. \nIm trying to create a rails project</p>\n\n<p><code>rails new depot</code></p>\n\n<p>Unfortunately this is failing at the point where rails try to do geminstall of sqlite</p>\n\n<p>The error is as follows</p>\n\n<pre><code>Fetching sqlite3 1.4.0\nInstalling sqlite3 1.4.0 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory:\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/sqlite3-1.4.0/ext/sqlite3\nC:/Ruby24-x64/bin/ruby.exe -r ./siteconf20190205-19788-3qr0ge.rb extconf.rb\nchecking for sqlite3.h... no\nsqlite3.h is missing. Install SQLite3 from http://www.sqlite.org/ first.\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/Ruby24-x64/bin/$(RUBY_BASE_NAME)\n        --with-sqlcipher\n        --without-sqlcipher\n        --with-sqlite3-config\n        --without-sqlite3-config\n        --with-pkg-config\n        --without-pkg-config\n        --with-sqlcipher\n        --without-sqlcipher\n        --with-sqlite3-dir\n        --without-sqlite3-dir\n        --with-sqlite3-include\n        --without-sqlite3-include=${sqlite3-dir}/include\n        --with-sqlite3-lib\n        --without-sqlite3-lib=${sqlite3-dir}/lib\n\nTo see why this extension failed to compile, please check the mkmf.log which can\nbe found here:\n\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/extensions/x64-mingw32/2.4.0/sqlite3-1.4.0/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/sqlite3-1.4.0 for inspection.\nResults logged to\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/extensions/x64-mingw32/2.4.0/sqlite3-1.4.0/gem_make.out\n\nAn error occurred while installing sqlite3 (1.4.0), and Bundler cannot continue.\nMake sure that `gem install sqlite3 -v '1.4.0'` succeeds before bundling.\n\nIn Gemfile:\n  sqlite3\n\nC:\\Users\\rose\\railsprojects&gt;\n</code></pre>\n\n<p>I have installed (copied binaries) from SQLite Download page to my C:\\sqlite folder. \nMy OS is 64 bit so I have downloaded \"sqlite-dll-win64-x64-3260000.zip\" and \"sqlite-tools-win32-x86-3260000.zip\" (from here <a href=\"https://www.sqlite.org/download.html\" rel=\"nofollow noreferrer\">https://www.sqlite.org/download.html</a>)\nI also have the dll and header files as shown</p>\n\n<pre><code>02/12/2018  12:38 AM           504,837 shell.c\n02/12/2018  12:39 AM           490,496 sqldiff.exe\n02/12/2018  12:38 AM         7,770,073 sqlite3.c\n02/12/2018  12:26 PM             5,933 sqlite3.def\n02/12/2018  12:27 PM         1,878,528 sqlite3.dll\n02/12/2018  12:40 AM           911,360 sqlite3.exe\n02/12/2018  12:38 AM           556,318 sqlite3.h\n02/12/2018  12:38 AM            33,713 sqlite3ext.h\n02/12/2018  12:40 AM         2,003,968 sqlite3_analyzer.exe\n</code></pre>\n\n<p>Because of this error I tried to install sqlite3 with gem command\nAs my header and DLL are in directory C:\\sqlite, I used the following command on msys2 terminal</p>\n\n<pre><code>\nridk enable\nC:\\Users\\rose&gt;gem install sqlite3 --platform=ruby -- --with-sqlite3-dir=C:\\sqlite\nFetching: sqlite3-1.4.0.gem (100%)\nInstalling required msys2 packages: mingw-w64-x86_64-sqlite3\nBuilding native extensions with: '--with-sqlite3-dir=C:\\sqlite'\nThis could take a while...\nERROR:  Error installing sqlite3:\n        ERROR: Failed to build gem native extension.\n\n    current directory: C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/sqlite3-1.4.0/ext/sqlite3\nC:/Ruby25-x64/bin/ruby.exe -r ./siteconf20190205-17968-rk6pw2.rb extconf.rb --with-sqlite3-dir=C:\\sqlite\nchecking for sqlite3.h... yes\nchecking for pthread_create() in -lpthread... yes\nchecking for -ldl... no\nchecking for dlopen()... no\nmissing function dlopen\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/Ruby25-x64/bin/$(RUBY_BASE_NAME)\n        --with-sqlcipher\n        --without-sqlcipher\n        --with-sqlite3-config\n        --without-sqlite3-config\n        --with-pkg-config\n        --without-pkg-config\n        --with-sqlcipher\n        --without-sqlcipher\n        --with-sqlite3-dir\n        --with-sqlite3-include\n        --without-sqlite3-include=${sqlite3-dir}/include\n        --with-sqlite3-lib\n        --without-sqlite3-lib=${sqlite3-dir}/lib\n        --with-pthreadlib\n        --without-pthreadlib\n        --with-dllib\n        --without-dllib\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  C:/Ruby25-x64/lib/ruby/gems/2.5.0/extensions/x64-mingw32/2.5.0/sqlite3-1.4.0/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/sqlite3-1.4.0 for inspection.\nResults logged to C:/Ruby25-x64/lib/ruby/gems/2.5.0/extensions/x64-mingw32/2.5.0/sqlite3-1.4.0/gem_make.out\n\nC:\\Users\\rose&gt;\n\n</code></pre>\n\n<p>Any clue whats missing?</p>\n\n<p>The mkmf log says</p>\n\n<pre><code>\"pkg-config --exists sqlite3\"\n| pkg-config --libs sqlite3\n=&gt; \"-LC:/Ruby25-x64/msys64/mingw64/lib -lsqlite3\\n\"\n\"x86_64-w64-mingw32-gcc -o conftest.exe -IC:/Ruby25-x64/include/ruby-2.5.0/x64-mingw32 -IC:/Ruby25-x64/include/ruby-2.5.0/ruby/backward -IC:/Ruby25-x64/include/ruby-2.5.0 -I. -D_FORTIFY_SOURCE=2 -D__USE_MINGW_ANSI_STDIO=1 -DFD_SETSIZE=2048 -D_WIN32_WINNT=0x0501 -D__MINGW_USE_VC2005_COMPAT -D_FILE_OFFSET_BITS=64  -march=x86-64 -mtune=generic -O2 -pipe conftest.c  -L. -LC:/Ruby25-x64/lib -L. -pipe -s     -lx64-msvcrt-ruby250  -lgmp -lshell32 -lws2_32 -liphlpapi -limagehlp -lshlwapi  \"\nchecked program was:\n/* begin */\n1: #include \"ruby.h\"\n2: \n3: #include &lt;winsock2.h&gt;\n4: #include &lt;windows.h&gt;\n5: int main(int argc, char **argv)\n6: {\n7:   return 0;\n8: }\n/* end */\n\n\"x86_64-w64-mingw32-gcc -o conftest.exe -IC:/Ruby25-x64/include/ruby-2.5.0/x64-mingw32 -IC:/Ruby25-x64/include/ruby-2.5.0/ruby/backward -IC:/Ruby25-x64/include/ruby-2.5.0 -I. -D_FORTIFY_SOURCE=2 -D__USE_MINGW_ANSI_STDIO=1 -DFD_SETSIZE=2048 -D_WIN32_WINNT=0x0501 -D__MINGW_USE_VC2005_COMPAT -D_FILE_OFFSET_BITS=64  -march=x86-64 -mtune=generic -O2 -pipe conftest.c  -L. -LC:/Ruby25-x64/lib -L. -pipe -s     -lx64-msvcrt-ruby250 -LC:/Ruby25-x64/msys64/mingw64/lib -lsqlite3 -lgmp -lshell32 -lws2_32 -liphlpapi -limagehlp -lshlwapi  \"\nchecked program was:\n/* begin */\n1: #include \"ruby.h\"\n2: \n3: #include &lt;winsock2.h&gt;\n4: #include &lt;windows.h&gt;\n5: int main(int argc, char **argv)\n6: {\n7:   return 0;\n8: }\n/* end */\n\n| pkg-config --cflags-only-I sqlite3\n=&gt; \"-IC:/Ruby25-x64/msys64/mingw64/include\\n\"\n| pkg-config --cflags-only-other sqlite3\n=&gt; \"\\n\"\n| pkg-config --libs-only-l sqlite3\n=&gt; \"-lsqlite3\\n\"\npackage configuration for sqlite3\ncflags: \nldflags: -LC:/Ruby25-x64/msys64/mingw64/lib\nlibs: -lsqlite3\n\nfind_header: checking for sqlite3.h... -------------------- yes\n\n\"x86_64-w64-mingw32-gcc -E -IC:/Ruby25-x64/include/ruby-2.5.0/x64-mingw32 -IC:/Ruby25-x64/include/ruby-2.5.0/ruby/backward -IC:/Ruby25-x64/include/ruby-2.5.0 -I. -IC:/Ruby25-x64/msys64/mingw64/include -IC:\\sqlite/include -D_FORTIFY_SOURCE=2 -D__USE_MINGW_ANSI_STDIO=1 -DFD_SETSIZE=2048 -D_WIN32_WINNT=0x0501 -D__MINGW_USE_VC2005_COMPAT -D_FILE_OFFSET_BITS=64  -march=x86-64 -mtune=generic -O2 -pipe   conftest.c -o conftest.i\"\nchecked program was:\n/* begin */\n1: #include \"ruby.h\"\n2: \n3: #include &lt;winsock2.h&gt;\n4: #include &lt;windows.h&gt;\n5: #include &lt;sqlite3.h&gt;\n/* end */\n\n--------------------\n\nfind_library: checking for pthread_create() in -lpthread... -------------------- yes\n\n\"x86_64-w64-mingw32-gcc -o conftest.exe -IC:/Ruby25-x64/include/ruby-2.5.0/x64-mingw32 -IC:/Ruby25-x64/include/ruby-2.5.0/ruby/backward -IC:/Ruby25-x64/include/ruby-2.5.0 -I. -IC:/Ruby25-x64/msys64/mingw64/include -IC:\\sqlite/include -D_FORTIFY_SOURCE=2 -D__USE_MINGW_ANSI_STDIO=1 -DFD_SETSIZE=2048 -D_WIN32_WINNT=0x0501 -D__MINGW_USE_VC2005_COMPAT -D_FILE_OFFSET_BITS=64  -march=x86-64 -mtune=generic -O2 -pipe  conftest.c  -L. -LC:/Ruby25-x64/lib -LC:\\sqlite/lib -L. -pipe -s -LC:/Ruby25-x64/msys64/mingw64/lib     -lsqlite3 -lx64-msvcrt-ruby250 -lpthread  -lsqlite3 -lgmp -lshell32 -lws2_32 -liphlpapi -limagehlp -lshlwapi  \"\nconftest.c: In function 't':\nconftest.c:16:57: error: 'pthread_create' undeclared (first use in this function); did you mean 'rb_thread_create'?\n int t(void) { void ((*volatile p)()); p = (void ((*)()))pthread_create; return !p; }\n                                                         ^~~~~~~~~~~~~~\n                                                         rb_thread_create\nconftest.c:16:57: note: each undeclared identifier is reported only once for each function it appears in\nchecked program was:\n/* begin */\n 1: #include \"ruby.h\"\n 2: \n 3: #include &lt;winsock2.h&gt;\n 4: #include &lt;windows.h&gt;\n 5: \n 6: /*top*/\n 7: extern int t(void);\n 8: int main(int argc, char **argv)\n 9: {\n10:   if (argc &gt; 1000000) {\n11:     printf(\"%p\", &amp;t);\n12:   }\n13: \n14:   return 0;\n15: }\n16: int t(void) { void ((*volatile p)()); p = (void ((*)()))pthread_create; return !p; }\n/* end */\n\n\"x86_64-w64-mingw32-gcc -o conftest.exe -IC:/Ruby25-x64/include/ruby-2.5.0/x64-mingw32 -IC:/Ruby25-x64/include/ruby-2.5.0/ruby/backward -IC:/Ruby25-x64/include/ruby-2.5.0 -I. -IC:/Ruby25-x64/msys64/mingw64/include -IC:\\sqlite/include -D_FORTIFY_SOURCE=2 -D__USE_MINGW_ANSI_STDIO=1 -DFD_SETSIZE=2048 -D_WIN32_WINNT=0x0501 -D__MINGW_USE_VC2005_COMPAT -D_FILE_OFFSET_BITS=64  -march=x86-64 -mtune=generic -O2 -pipe  conftest.c  -L. -LC:/Ruby25-x64/lib -LC:\\sqlite/lib -L. -pipe -s -LC:/Ruby25-x64/msys64/mingw64/lib     -lsqlite3 -lx64-msvcrt-ruby250 -lpthread  -lsqlite3 -lgmp -lshell32 -lws2_32 -liphlpapi -limagehlp -lshlwapi  \"\nchecked program was:\n/* begin */\n 1: #include \"ruby.h\"\n 2: \n 3: #include &lt;winsock2.h&gt;\n 4: #include &lt;windows.h&gt;\n 5: \n 6: /*top*/\n 7: extern int t(void);\n 8: int main(int argc, char **argv)\n 9: {\n10:   if (argc &gt; 1000000) {\n11:     printf(\"%p\", &amp;t);\n12:   }\n13: \n14:   return 0;\n15: }\n16: extern void pthread_create();\n17: int t(void) { pthread_create(); return 0; }\n/* end */\n\n--------------------\n\nhave_library: checking for -ldl... -------------------- no\n\n\"x86_64-w64-mingw32-gcc -o conftest.exe -IC:/Ruby25-x64/include/ruby-2.5.0/x64-mingw32 -IC:/Ruby25-x64/include/ruby-2.5.0/ruby/backward -IC:/Ruby25-x64/include/ruby-2.5.0 -I. -IC:/Ruby25-x64/msys64/mingw64/include -IC:\\sqlite/include -D_FORTIFY_SOURCE=2 -D__USE_MINGW_ANSI_STDIO=1 -DFD_SETSIZE=2048 -D_WIN32_WINNT=0x0501 -D__MINGW_USE_VC2005_COMPAT -D_FILE_OFFSET_BITS=64  -march=x86-64 -mtune=generic -O2 -pipe  conftest.c  -L. -LC:/Ruby25-x64/lib -LC:\\sqlite/lib -L. -pipe -s -LC:/Ruby25-x64/msys64/mingw64/lib    -lpthread  -lsqlite3 -lx64-msvcrt-ruby250 -ldl -lpthread  -lsqlite3 -lgmp -lshell32 -lws2_32 -liphlpapi -limagehlp -lshlwapi  \"\nC:/Ruby25-x64/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/8.2.1/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -ldl\ncollect2.exe: error: ld returned 1 exit status\nchecked program was:\n/* begin */\n 1: #include \"ruby.h\"\n 2: \n 3: #include &lt;winsock2.h&gt;\n 4: #include &lt;windows.h&gt;\n 5: \n 6: /*top*/\n 7: extern int t(void);\n 8: int main(int argc, char **argv)\n 9: {\n10:   if (argc &gt; 1000000) {\n11:     printf(\"%p\", &amp;t);\n12:   }\n13: \n14:   return 0;\n15: }\n16: \n17: int t(void) { ; return 0; }\n/* end */\n\n--------------------\n\nhave_func: checking for dlopen()... -------------------- no\n\n\"x86_64-w64-mingw32-gcc -o conftest.exe -IC:/Ruby25-x64/include/ruby-2.5.0/x64-mingw32 -IC:/Ruby25-x64/include/ruby-2.5.0/ruby/backward -IC:/Ruby25-x64/include/ruby-2.5.0 -I. -IC:/Ruby25-x64/msys64/mingw64/include -IC:\\sqlite/include -D_FORTIFY_SOURCE=2 -D__USE_MINGW_ANSI_STDIO=1 -DFD_SETSIZE=2048 -D_WIN32_WINNT=0x0501 -D__MINGW_USE_VC2005_COMPAT -D_FILE_OFFSET_BITS=64  -march=x86-64 -mtune=generic -O2 -pipe  conftest.c  -L. -LC:/Ruby25-x64/lib -LC:\\sqlite/lib -L. -pipe -s -LC:/Ruby25-x64/msys64/mingw64/lib    -lpthread  -lsqlite3 -lx64-msvcrt-ruby250 -lpthread  -lsqlite3 -lgmp -lshell32 -lws2_32 -liphlpapi -limagehlp -lshlwapi  \"\nconftest.c: In function 't':\nconftest.c:16:57: error: 'dlopen' undeclared (first use in this function); did you mean '_lopen'?\n int t(void) { void ((*volatile p)()); p = (void ((*)()))dlopen; return !p; }\n                                                         ^~~~~~\n                                                         _lopen\nconftest.c:16:57: note: each undeclared identifier is reported only once for each function it appears in\nchecked program was:\n/* begin */\n 1: #include \"ruby.h\"\n 2: \n 3: #include &lt;winsock2.h&gt;\n 4: #include &lt;windows.h&gt;\n 5: \n 6: /*top*/\n 7: extern int t(void);\n 8: int main(int argc, char **argv)\n 9: {\n10:   if (argc &gt; 1000000) {\n11:     printf(\"%p\", &amp;t);\n12:   }\n13: \n14:   return 0;\n15: }\n16: int t(void) { void ((*volatile p)()); p = (void ((*)()))dlopen; return !p; }\n/* end */\n\n\"x86_64-w64-mingw32-gcc -o conftest.exe -IC:/Ruby25-x64/include/ruby-2.5.0/x64-mingw32 -IC:/Ruby25-x64/include/ruby-2.5.0/ruby/backward -IC:/Ruby25-x64/include/ruby-2.5.0 -I. -IC:/Ruby25-x64/msys64/mingw64/include -IC:\\sqlite/include -D_FORTIFY_SOURCE=2 -D__USE_MINGW_ANSI_STDIO=1 -DFD_SETSIZE=2048 -D_WIN32_WINNT=0x0501 -D__MINGW_USE_VC2005_COMPAT -D_FILE_OFFSET_BITS=64  -march=x86-64 -mtune=generic -O2 -pipe  conftest.c  -L. -LC:/Ruby25-x64/lib -LC:\\sqlite/lib -L. -pipe -s -LC:/Ruby25-x64/msys64/mingw64/lib    -lpthread  -lsqlite3 -lx64-msvcrt-ruby250 -lpthread  -lsqlite3 -lgmp -lshell32 -lws2_32 -liphlpapi -limagehlp -lshlwapi  \"\nC:\\Users\\Navarose\\AppData\\Local\\Temp\\ccNQH25m.o:conftest.c:(.text+0x5): undefined reference to `dlopen'\ncollect2.exe: error: ld returned 1 exit status\nchecked program was:\n/* begin */\n 1: #include \"ruby.h\"\n 2: \n 3: #include &lt;winsock2.h&gt;\n 4: #include &lt;windows.h&gt;\n 5: \n 6: /*top*/\n 7: extern int t(void);\n 8: int main(int argc, char **argv)\n 9: {\n10:   if (argc &gt; 1000000) {\n11:     printf(\"%p\", &amp;t);\n12:   }\n13: \n14:   return 0;\n15: }\n16: extern void dlopen();\n17: int t(void) { dlopen(); return 0; }\n/* end */\n\n--------------------\n\n</code></pre>\n\n<p>As a last resort I built the SQlite using mingw64\nLater tried to install the gem. And a new error which is like shostopper</p>\n\n<pre><code>gem install sqlite3 --platform=ruby -- --with-sqlite3-include=C:\\sqlite\\ --with-sqlite3-lib=C:\\sqlite\\.libs\\\n\nC:/RailsInstaller/Ruby2.3.3/bin/ruby.exe -r ./siteconf20190205-18436-ve1008.rb extconf.rb --with-sqlite3-include=C:\\sqlite\\ --with-sqlite3-lib=C:\\sqlite\\.libs\\\nchecking for sqlite3.h... yes\nchecking for pthread_create() in -lpthread... no\nchecking for main() in -ldl... no\nchecking for dlopen()... no\nmissing function dlopen\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/RailsInstaller/Ruby2.3.3/bin/$(RUBY_BASE_NAME)\n        --with-sqlcipher\n        --without-sqlcipher\n        --with-sqlite3-config\n        --without-sqlite3-config\n        --with-pkg-config\n        --without-pkg-config\n        --with-sqlcipher\n        --without-sqlcipher\n        --with-sqlite3-dir\n        --without-sqlite3-dir\n        --with-sqlite3-include=${sqlite3-dir}/include\n        --with-sqlite3-lib=${sqlite3-dir}/lib\n        --with-pthreadlib\n        --without-pthreadlib\n        --with-dllib\n        --without-dllib\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/extensions/x86-mingw32/2.3.0/sqlite3-1.4.0/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/sqlite3-1.4.0 for inspection.\nResults logged to C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/extensions/x86-mingw32/2.3.0/sqlite3-1.4.0/gem_make.out\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite"], "comments": [{"owner": {"reputation": 1858, "user_id": 7197281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c04810ea8f251cdc6e82d9f05144da?s=128&d=identicon&r=PG&f=1", "display_name": "CloC", "link": "https://stackoverflow.com/users/7197281/cloc"}, "edited": false, "score": 0, "creation_date": 1549341655, "post_id": 54527277, "comment_id": 95857421, "body": "Welcome to Stack Overflow! Please read <a href=\"https://stackoverflow.com/about\">what this site is about</a> and  &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to ask</a>&quot;  before asking a question."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1549543975, "post_id": 54527277, "comment_id": 95945306, "body": "Guessing but I think ActiveRecord only works with specific versions and with the recent release of 1.4 you get this error."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1549555441, "post_id": 54527277, "comment_id": 95952343, "body": "This also manifests as <code>Specified &#39;sqlite3&#39; for database adapter, but the gem is not loaded. Add </code>gem &#39;sqlite3&#39;` to your Gemfile (and ensure its version is at the minimum required by ActiveRecord).` if sqlite is in gemspec."}], "answers": [{"comments": [{"owner": {"reputation": 30989, "user_id": 3379653, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/f97JZ.png?s=128&g=1", "display_name": "qwerty_so", "link": "https://stackoverflow.com/users/3379653/qwerty-so"}, "edited": false, "score": 0, "creation_date": 1575746852, "post_id": 54528822, "comment_id": 104672103, "body": "Almost. I had to use the version after <i>can&#39;t activate sqlite3 (~&gt; x.x.x)</i> in the brackets in the Gemfile."}], "tags": [], "owner": {"reputation": 539, "user_id": 9006638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kV5us.jpg?s=128&g=1", "display_name": "Michael Arkhipov", "link": "https://stackoverflow.com/users/9006638/michael-arkhipov"}, "is_accepted": false, "score": 6, "last_activity_date": 1549348163, "creation_date": 1549348163, "answer_id": 54528822, "question_id": 54527277, "link": "https://stackoverflow.com/questions/54527277/cant-activate-sqlite3-1-3-6-already-activated-sqlite3-1-4-0/54528822#54528822", "title": "can&#39;t activate sqlite3 (~&gt; 1.3.6), already activated sqlite3-1.4.0", "body": "<p>Looks like sqlite3 version in the system is different from that installed in the application. In this case, you can update a gem version for your app:</p>\n\n<pre><code>bundle update sqlite3\n</code></pre>\n\n<p>Or change gem version in Gemfile:</p>\n\n<pre><code>gem 'sqlite3', '~&gt; 1.4'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 5030046, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/W4JVF.jpg?s=128&g=1", "display_name": "Jamsheed Mistri", "link": "https://stackoverflow.com/users/5030046/jamsheed-mistri"}, "edited": false, "score": 5, "creation_date": 1549497867, "post_id": 54529016, "comment_id": 95927717, "body": "Had a similar issue today as well. Spent 30 minutes trying to figure it out, this works perfectly. Thank you so much!"}, {"owner": {"reputation": 339, "user_id": 792537, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a8eb2d5a71f1a9b9d3d190d1e2db7ea?s=128&d=identicon&r=PG", "display_name": "Sergei Avanesov", "link": "https://stackoverflow.com/users/792537/sergei-avanesov"}, "edited": false, "score": 3, "creation_date": 1549546839, "post_id": 54529016, "comment_id": 95946977, "body": "It works. I assumed the problem is inside of ActiveRecord."}, {"owner": {"reputation": 79, "user_id": 5604404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cpvlt.jpg?s=128&g=1", "display_name": "domdaviesdev", "link": "https://stackoverflow.com/users/5604404/domdaviesdev"}, "edited": false, "score": 2, "creation_date": 1549838553, "post_id": 54529016, "comment_id": 96036346, "body": "This worked for me exactly as stated.  Running Rails 5.2.2 on Ubuntu 10.04"}, {"owner": {"reputation": 72617, "user_id": 8279, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d4758ccc3cc586f01e740733f3fd8b7e?s=128&d=identicon&r=PG", "display_name": "Marc-Andr&#233; Lafortune", "link": "https://stackoverflow.com/users/8279/marc-andr%c3%a9-lafortune"}, "edited": false, "score": 2, "creation_date": 1552413450, "post_id": 54529016, "comment_id": 96997427, "body": "@skalee has the perfect answer."}, {"owner": {"reputation": 99, "user_id": 7575195, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xN6Q9tMbg-Y/AAAAAAAAAAI/AAAAAAAAFis/6eoRk2QuZFU/photo.jpg?sz=128", "display_name": "LifterCoder", "link": "https://stackoverflow.com/users/7575195/liftercoder"}, "edited": false, "score": 0, "creation_date": 1553264299, "post_id": 54529016, "comment_id": 97331675, "body": "Rails already made the change to master but i guess it haven&#39;t been release? This is a huge issue where new user who want to try Rails and can&#39;t even get it up without errors."}], "tags": [], "owner": {"reputation": 961, "user_id": 8063004, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VZDR86n_bFM/AAAAAAAAAAI/AAAAAAAAAO4/rb3YNOecChM/photo.jpg?sz=128", "display_name": "Saral Karki", "link": "https://stackoverflow.com/users/8063004/saral-karki"}, "is_accepted": false, "score": 96, "last_activity_date": 1549349242, "creation_date": 1549349242, "answer_id": 54529016, "question_id": 54527277, "link": "https://stackoverflow.com/questions/54527277/cant-activate-sqlite3-1-3-6-already-activated-sqlite3-1-4-0/54529016#54529016", "title": "can&#39;t activate sqlite3 (~&gt; 1.3.6), already activated sqlite3-1.4.0", "body": "<p>I had a similar issue today. Here's what worked for me. I tried using Michael's approach but received a similar error.</p>\n\n<p>So instead, I removed the gem that I thought was giving me an error, by\n    <code>gem uninstall sqlite3 -v 1.4.0</code></p>\n\n<p>and instead, used in my gem file. \n     <code>gem 'sqlite3', '~&gt; 1.3.6'</code>\nRan the <code>bundle update</code> and it worked like a charm for me. </p>\n"}, {"comments": [{"owner": {"reputation": 2070, "user_id": 1176660, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/AkeM8.jpg?s=128&g=1", "display_name": "zevij", "link": "https://stackoverflow.com/users/1176660/zevij"}, "edited": false, "score": 2, "creation_date": 1549820104, "post_id": 54580628, "comment_id": 96031062, "body": "Worked like a charm. FYI... I am using mac (osx 10.13.2), rails 5.2.2, ruby 2.6 with all dev done in RubyMine."}, {"owner": {"reputation": 1999, "user_id": 389014, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6f3ef9f408b5ae9860dd671d2c7d23ca?s=128&d=identicon&r=PG", "display_name": "cyber_dave", "link": "https://stackoverflow.com/users/389014/cyber-dave"}, "edited": false, "score": 0, "creation_date": 1550782119, "post_id": 54580628, "comment_id": 96408268, "body": "Works great! Using Rails 5.2.2 and Ruby 2.6.1."}, {"owner": {"reputation": 368, "user_id": 2156969, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d75961f0111ee2f9606aeed1743fb69?s=128&d=identicon&r=PG", "display_name": "rudygodoy", "link": "https://stackoverflow.com/users/2156969/rudygodoy"}, "edited": false, "score": 4, "creation_date": 1552593985, "post_id": 54580628, "comment_id": 97081540, "body": "The dependency version is hardcoded in ActiveRecord&#39;s adapter for Sqlite3 for 5.2.2 as <code>gem &quot;sqlite3&quot;, &quot;~&gt; 1.3.6&quot;</code>"}, {"owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "edited": false, "score": 0, "creation_date": 1553170558, "post_id": 54580628, "comment_id": 97290141, "body": "Won&#39;t that ~&gt; 1.3 automatically make it &lt; 1.4 , so I guess could omit that &lt; 1.4 part since it&#39;s implied.  Also I don&#39;t know why you say the latest 1.3 was 1.3.11 . You posted your answer on Feb 7th and the latest 1.3 is <a href=\"https://rubygems.org/gems/sqlite3/versions/\" rel=\"nofollow noreferrer\">rubygems.org/gems/sqlite3/versions</a> . 1.3.13 which came out in Jan 2017. Long before you wrote your answer and claimed the latest was 1.3.11 So not sure why you thought it was 1.3.11 ?!  Scaly&#39;s line is a bit less superfluous and works <code>gem &#39;sqlite3&#39;, &#39;~&gt; 1.3.6&#39;</code> and <code>gem sqlite3 &#39;1.3.13&#39;</code> works , which is the latest 1.3"}], "tags": [], "owner": {"reputation": 774, "user_id": 3590866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzf8z.jpg?s=128&g=1", "display_name": "cavalcanteg", "link": "https://stackoverflow.com/users/3590866/cavalcanteg"}, "is_accepted": false, "score": 66, "last_activity_date": 1553159917, "last_edit_date": 1553159917, "creation_date": 1549566780, "answer_id": 54580628, "question_id": 54527277, "link": "https://stackoverflow.com/questions/54527277/cant-activate-sqlite3-1-3-6-already-activated-sqlite3-1-4-0/54580628#54580628", "title": "can&#39;t activate sqlite3 (~&gt; 1.3.6), already activated sqlite3-1.4.0", "body": "<p>I solved this error configuring the version of sqlite3 in the Gemfile like this:</p>\n\n<pre><code>gem 'sqlite3', '~&gt; 1.3', '&lt; 1.4'\n</code></pre>\n\n<p>It seemed that sqlite3-1.3.6 is not working fine and the sqlite3-1.4 is not supported yet, so it(the line I suggest to correct for this problem) will download the latest 1.3 version. In my case it is the sqlite3-1.3.11.</p>\n\n<p>I am using rails-5.0.0 and ruby-2.5.1 in my project.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 4103362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxRq1.jpg?s=128&g=1", "display_name": "MaKaRoN_IV", "link": "https://stackoverflow.com/users/4103362/makaron-iv"}, "edited": false, "score": 0, "creation_date": 1550433475, "post_id": 54606137, "comment_id": 96256667, "body": "Thanks! Work for me."}], "tags": [], "owner": {"reputation": 705, "user_id": 1960924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y4Fhm.jpg?s=128&g=1", "display_name": "femotizo", "link": "https://stackoverflow.com/users/1960924/femotizo"}, "is_accepted": false, "score": 13, "last_activity_date": 1549714720, "creation_date": 1549714720, "answer_id": 54606137, "question_id": 54527277, "link": "https://stackoverflow.com/questions/54527277/cant-activate-sqlite3-1-3-6-already-activated-sqlite3-1-4-0/54606137#54606137", "title": "can&#39;t activate sqlite3 (~&gt; 1.3.6), already activated sqlite3-1.4.0", "body": "<p>None of the solution worked for me, so i traced the error and located the connection adapters</p>\n\n<p>Location:</p>\n\n<pre><code>C:\\Ruby\\lib\\ruby\\gems\\2.5.0\\gems\\activerecord-5.2.2\\lib\\active_record\\connection_adapters\\\n</code></pre>\n\n<p>File:</p>\n\n<pre><code>sqlite3_adapter.rb\n</code></pre>\n\n<p>changed </p>\n\n<pre><code>gem \"sqlite3\", \"~&gt; 1.3.6\"\n</code></pre>\n\n<p>to </p>\n\n<pre><code>gem \"sqlite3\", \"~&gt; 1.4.0\"\n</code></pre>\n\n<p><strong>I refreshed my webpage and everything works!!!</strong></p>\n\n<p>My Env</p>\n\n<pre><code>Windows 10\nRuby : 2.5.3-p105\nRails: 5.2.2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2666, "user_id": 583608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7mLIJ.png?s=128&g=1", "display_name": "ToothlessRebel", "link": "https://stackoverflow.com/users/583608/toothlessrebel"}, "edited": false, "score": 0, "creation_date": 1552372913, "post_id": 54729071, "comment_id": 96972647, "body": "How might one do the second option?"}, {"owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "edited": false, "score": 0, "creation_date": 1554143315, "post_id": 54729071, "comment_id": 97635422, "body": "I guess instead of <code>gem &#39;sqlite3&#39;, &#39;~&gt; 1.3.6&#39;</code> . one may as well just specify the latest 1.3 listed <a href=\"https://rubygems.org/gems/sqlite3/versions/\" rel=\"nofollow noreferrer\">rubygems.org/gems/sqlite3/versions</a> .  So <code>gem sqlite3 &#39;1.3.13&#39;</code>?"}, {"owner": {"reputation": 10906, "user_id": 304175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e7d5228dc65a5e9079850656b33a9a86?s=128&d=identicon&r=PG", "display_name": "skalee", "link": "https://stackoverflow.com/users/304175/skalee"}, "reply_to_user": {"reputation": 2666, "user_id": 583608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7mLIJ.png?s=128&g=1", "display_name": "ToothlessRebel", "link": "https://stackoverflow.com/users/583608/toothlessrebel"}, "edited": false, "score": 0, "creation_date": 1556808601, "post_id": 54729071, "comment_id": 98561875, "body": "@ToothlessRebel <code>gem &quot;activerecord&quot;, github: &quot;rails&#47;rails&quot;, branch: &quot;5-2-stable&quot;</code>. Though you may need to install some other Rails gems from Git as well. @barlop Yes, depending on what you actually want."}], "tags": [], "owner": {"reputation": 10906, "user_id": 304175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e7d5228dc65a5e9079850656b33a9a86?s=128&d=identicon&r=PG", "display_name": "skalee", "link": "https://stackoverflow.com/users/304175/skalee"}, "is_accepted": false, "score": 33, "last_activity_date": 1550364040, "creation_date": 1550364040, "answer_id": 54729071, "question_id": 54527277, "link": "https://stackoverflow.com/questions/54527277/cant-activate-sqlite3-1-3-6-already-activated-sqlite3-1-4-0/54729071#54729071", "title": "can&#39;t activate sqlite3 (~&gt; 1.3.6), already activated sqlite3-1.4.0", "body": "<p>The problem is caused by Active Record which has version constraint on sqlite3 gem.  For example, in case of Rails 5.2.2 (latest stable release at the time I am writing this response) it is <code>~&gt; 1.3.6</code>.  However, this constraint is not specified in gemspec, but in <a href=\"https://github.com/rails/rails/blob/v5.2.2/activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb#L12\" rel=\"noreferrer\">a source file which contains the adapter class</a>.  As a consequence, Bundler is unaware of it, and installs sqlite3 gem version 1.4.0, which is conflicting.</p>\n\n<p>The good news is that <a href=\"https://github.com/rails/rails/pull/35154\" rel=\"noreferrer\">fix has been already merged</a> into master and Rails 5.2 maintenance branches (and possibly other ones), and should be included in 5.2.3.</p>\n\n<p>For now, you can do one of following:</p>\n\n<ul>\n<li>Add sqlite3 constraint to your Gemfile: <code>gem 'sqlite3', '~&gt; 1.3.6'</code></li>\n<li>Install Active Record from a branch named <code>5-2-stable</code>.</li>\n</ul>\n"}], "owner": {"reputation": 721, "user_id": 11015500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BDODZ.jpg?s=128&g=1", "display_name": "Juan Rodriguez", "link": "https://stackoverflow.com/users/11015500/juan-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19854, "favorite_count": 8, "answer_count": 5, "score": 72, "last_activity_date": 1553159917, "creation_date": 1549336396, "last_edit_date": 1550364536, "question_id": 54527277, "link": "https://stackoverflow.com/questions/54527277/cant-activate-sqlite3-1-3-6-already-activated-sqlite3-1-4-0", "title": "can&#39;t activate sqlite3 (~&gt; 1.3.6), already activated sqlite3-1.4.0", "body": "<p>I\u2019m using Ubuntu and run into to a problem when using db:migrate for ruby project. </p>\n\n<pre><code>rails aborted!\nLoadError: Error loading the 'sqlite3' Active Record adapter. Missing a gem it depends on? can't activate sqlite3 (~&gt; 1.3.6), already activated sqlite3-1.4.0. Make sure all dependencies are added to Gemfile.\n/home/juan/odin_on_rails/RailsaAPP/bin/rails:9:in `&lt;top (required)&gt;'\n/home/juan/odin_on_rails/RailsaAPP/bin/spring:15:in `&lt;top (required)&gt;'\nbin/rails:3:in `load'\nbin/rails:3:in `&lt;main&gt;'\n\nCaused by:\nGem::LoadError: can't activate sqlite3 (~&gt; 1.3.6), already activated sqlite3-1.4.0. Make sure all dependencies are added to Gemfile.\n/home/juan/odin_on_rails/RailsaAPP/bin/rails:9:in `&lt;top (required)&gt;'\n/home/juan/odin_on_rails/RailsaAPP/bin/spring:15:in `&lt;top (required)&gt;'\nbin/rails:3:in `load'\nbin/rails:3:in `&lt;main&gt;'\nTasks: TOP =&gt; db:migrate =&gt; db:load_config\n(See full trace by running task with --trace)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 196, "user_id": 3347828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/drmQg.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/3347828/will"}, "edited": false, "score": 1, "creation_date": 1549341411, "post_id": 54527187, "comment_id": 95857351, "body": "How much detail were you hoping for? Do you already have a registration process and/or authentication system in place?"}, {"owner": {"reputation": 1, "user_id": 11009402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2785aaf298486d6d529c0f0f0c441d84?s=128&d=identicon&r=PG&f=1", "display_name": "vkjbrjb", "link": "https://stackoverflow.com/users/11009402/vkjbrjb"}, "reply_to_user": {"reputation": 196, "user_id": 3347828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/drmQg.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/3347828/will"}, "edited": false, "score": 0, "creation_date": 1549343839, "post_id": 54527187, "comment_id": 95857967, "body": "Not a ton of detail is needed- I just need to be able to restrict signups to those who have invite codes."}, {"owner": {"reputation": 196, "user_id": 3347828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/drmQg.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/3347828/will"}, "edited": false, "score": 0, "creation_date": 1550104874, "post_id": 54527187, "comment_id": 96152111, "body": "Hey @vkjbrjb, did my answer end up working out for you?"}], "answers": [{"tags": [], "owner": {"reputation": 196, "user_id": 3347828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/drmQg.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/3347828/will"}, "is_accepted": false, "score": 1, "last_activity_date": 1549345918, "creation_date": 1549345918, "answer_id": 54528383, "question_id": 54527187, "link": "https://stackoverflow.com/questions/54527187/invite-keys-for-signup-no-device/54528383#54528383", "title": "Invite keys for signup (no device)", "body": "<p>Alright, let's say you have a <code>User</code> model and an <code>Invite</code> model. I would probably set the relationship up like this.</p>\n\n<pre><code># app/models/user.rb\nclass User &lt; ApplicationRecord\n  belongs_to :invite\n\n  # ...\nend\n\n# app/models/invite.rb\nclass Invite &lt; ApplicationRecord\n  has_many :users\n\n  # ...\nend\n</code></pre>\n\n<p>Next, I would create a form object to handle the combination of user sign up logic and invite code logic:</p>\n\n<pre><code># app/models/user/registration_form.rb\nclass User::RegistraionForm \n  include ActiveModel::Model\n\n  attr_accessor :name, :email, :password, :password_confirmation, :invite_code\n\n  validate :check_user\n  validate :check_invite_code\n\n  def submit\n    if valid?\n      user.invite = invite\n      return user.save\n    end\n\n    return false\n  end\n\n  private\n    def check_user\n      unless user.valid?\n        user.errors.each do |attribute, message|\n          errors.add(attribute, message)\n        end\n      end\n    end\n\n    def user\n      @user ||= User.new(name: name, email: email, password: password,\n        password_confirmation: password_confirmation)\n    end\n\n    def check_invite_code\n      unless invite.present?\n        errors.add(:base, 'You must have a valid invite code')\n      end\n    end\n\n    def invite\n      @invite ||= Invite.find_by(code: invite_code)\n    end\nend\n</code></pre>\n\n<p>This assumes that the <code>Invite</code> model has an unique attribute called <code>code</code> for each record.</p>\n\n<p>Finally, you can create a registration controller to user the newly created form object:</p>\n\n<pre><code># app/controllers/registrations_controller.rb\nclass RegistrationsController &lt; ApplicationController\n  def new\n    @registration_form = User::RegistraionForm.new\n  end\n\n  def create\n    @registration_form = User::RegistraionForm.new(registration_params)\n\n    if @registration_form.submit\n      # success! redirect or do something here\n    else\n      flash[:alert] = @registration_form.errors.full_message.to_sentence\n      render :new\n    end\n  end\n\n  private\n    def registration_params\n      params.require(:registration_form).permit(:name, :email, :password,\n        :password_confirmation, :invite_code)\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11009402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2785aaf298486d6d529c0f0f0c441d84?s=128&d=identicon&r=PG&f=1", "display_name": "vkjbrjb", "link": "https://stackoverflow.com/users/11009402/vkjbrjb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549346798, "creation_date": 1549335435, "last_edit_date": 1549346798, "question_id": 54527187, "link": "https://stackoverflow.com/questions/54527187/invite-keys-for-signup-no-device", "title": "Invite keys for signup (no device)", "body": "<p>I'm trying to create a system which, upon signup, Rails checks to see if a user has an invite code. My original idea was to make a table separate from \"users\" with a list of permitted registration tokens and have my system save the user if the invitation token is valid, with a column in the User table holding the invite key the person used to sign up. How can I implement this? </p>\n"}, {"tags": ["ruby", "constants"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1549330379, "post_id": 54526667, "comment_id": 95855431, "body": "The visibility of the constants is given by <code>Example.constants  =&gt; [:MOTHER, :PARENTS, :FATHER]</code>, <a href=\"https://www.linuxtopia.org/online_books/programming_books/ruby_tutorial/The_Ruby_Language_Scope_of_Constants_and_Variables.html\" rel=\"nofollow noreferrer\">This article</a> provides a good explanation of the scope of constants."}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1549333198, "post_id": 54526667, "comment_id": 95855940, "body": "@CarySwoveland the confusion in the question is a combination of the syntax used to declare the <code>PARENTS</code> constant, and because of a weak grasp on the scoping concepts. I suppose I should clarify this. I&#39;m actually aware of the answer to the question. However, as pointed out already in the question, we already know the constants are in the class&#39;s scope, the question is: why?"}, {"owner": {"reputation": 233982, "user_id": 49153, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/833df8cee775eea743cb1172dfcd3809?s=128&d=identicon&r=PG", "display_name": "Click Upvote", "link": "https://stackoverflow.com/users/49153/click-upvote"}, "edited": false, "score": 1, "creation_date": 1549348214, "post_id": 54526667, "comment_id": 95859227, "body": "Solution: Don&#39;t use weakly typed languages so such gotchas would be caught by the compiler before they ever crop up as a bug in production"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549349588, "post_id": 54526667, "comment_id": 95859708, "body": "Why do you think an array becomes the scope for a constant? Please cite the relevant docs that says that."}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549350993, "post_id": 54526667, "comment_id": 95860277, "body": "@sawa, please don&#39;t aggressively edit the question to the point where it&#39;s drastically different."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 233982, "user_id": 49153, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/833df8cee775eea743cb1172dfcd3809?s=128&d=identicon&r=PG", "display_name": "Click Upvote", "link": "https://stackoverflow.com/users/49153/click-upvote"}, "edited": false, "score": 1, "creation_date": 1549353064, "post_id": 54526667, "comment_id": 95861088, "body": "@ClickUpvote: Your comment doesn&#39;t seem to make much sense. Ruby is strongly typed. The question is about scope, so strong/weak typing isn&#39;t relevant anyway. Did you mean &quot;dynamic&quot;?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1549356454, "post_id": 54526667, "comment_id": 95862599, "body": "<i>&quot;By declaring the constants inside of an array, I would expect them to to be scoped inside the array. Please cite the relevant docs in your answer.&quot;</i> \u2013 could you cite the relevant docs that lead to your assumption? ;-)"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1549376383, "post_id": 54526667, "comment_id": 95874274, "body": "@Stefan, haha, good catch \u2014 I can&#39;t. This question is one I hear when people see me use this kind of declaration in my service objects, and so I tried to reproduce the confusion as much as possible in the question. I&#39;m sorry for the confusion. This Q&amp;A post was finally created after <a href=\"https://www.toptal.com/ruby-on-rails/rails-service-objects-tutorial#comment-4322654659\" rel=\"nofollow noreferrer\">this question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 2, "creation_date": 1549349672, "post_id": 54526833, "comment_id": 95859741, "body": "&quot;[T]he scope of instance variables and constants is similar&quot;--Not at all."}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1560042587, "post_id": 54526833, "comment_id": 99609290, "body": "@sawa How would you say not?"}], "tags": [], "owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "is_accepted": false, "score": 3, "last_activity_date": 1549346796, "last_edit_date": 1549346796, "creation_date": 1549331734, "answer_id": 54526833, "question_id": 54526667, "link": "https://stackoverflow.com/questions/54526667/why-are-constants-declared-inside-an-array-and-assigned-to-other-constants-acc/54526833#54526833", "title": "Why are constants declared inside an array, and assigned to other constants, accessible as Class constants in Ruby?", "body": "<p>I can understand how it can be confusing, but apart from the fact that reassigning values to constants is discouraged, in terms of scope \u2014\u00a0instance variables and constants are extremely similar.</p>\n\n<p>The visual trick in the first class declaration is where you declare the constant inside an array.</p>\n\n<p>First: understand that when you declare a constant, the returned value is your definition. E.g.</p>\n\n<pre><code>FATHER = :father\n#=&gt; :father\n</code></pre>\n\n<p>Now, let's look at the constant declaration:</p>\n\n<pre><code>PARENTS = [\n  FATHER = :father,\n  MOTHER = :mother\n]\n</code></pre>\n\n<p>For declaring <code>PARENT</code>, you could have just used:</p>\n\n<pre><code>PARENTS = [\n  :father,\n  :mother\n]\n</code></pre>\n\n<p>but you went a step further and declared a constant inside the definition as well. Now please understand that <strong>the scope of instance variables and constants is similar</strong>, it is tied to the instance it was declared in, and so <strong>declaring a constant anywhere would tie it to the instance.</strong></p>\n\n<p>By executing <code>FATHER = :father</code>, you've declared another constant, and the scope of a constant is always going to be the class it was declared in, in this case <code>Example</code>. The same is also true for <code>MOTHER = :mother</code>.</p>\n\n<p>If you're more used to instance variables \u2014\u00a0it's the same reason this works: Given the following Ruby class.</p>\n\n<pre><code>class Example\n  @parents = [\n    @father = :father,\n    @mother = :mother\n  ]\nend\n</code></pre>\n\n<p>These work as expected</p>\n\n<pre><code>&gt; Example.instance_variable_get :@parents\n#=&gt; [:father, :mother]\n&gt; Example.instance_variable_get(:@parents)[0]\n#=&gt; :father\n&gt; Example.instance_variable_get(:@parents)[1]\n#=&gt; :mother\n</code></pre>\n\n<p>But this works too.</p>\n\n<pre><code>&gt; Example.instance_variable_get :@father\n#=&gt; :father\n&gt; Example.instance_variable_get :@mother\n#=&gt; :mother\n</code></pre>\n\n<p>In fact, these three are in the Example class's scope.</p>\n\n<pre><code>&gt; Example.instance_variables\n#=&gt; [:@mother, :@parents, :@father]\n</code></pre>\n\n<p>To the point, that if I extend the class with an additional method:</p>\n\n<pre><code>class Example\n  def self.whos_your_daddy\n    @father\n  end\nend\n</code></pre>\n\n<p>It accesses the instance variables like normally.</p>\n\n<pre><code>&gt; Example.whos_your_daddy\n#=&gt; :father\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1549349904, "post_id": 54526880, "comment_id": 95859824, "body": "Your entire answer is almost just repetition of the OP&#39;s question, and adds no value. The only part that is useful is &quot;Array doesn&#39;t make new scope&quot;."}], "tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 1, "last_activity_date": 1549332252, "creation_date": 1549332252, "answer_id": 54526880, "question_id": 54526667, "link": "https://stackoverflow.com/questions/54526667/why-are-constants-declared-inside-an-array-and-assigned-to-other-constants-acc/54526880#54526880", "title": "Why are constants declared inside an array, and assigned to other constants, accessible as Class constants in Ruby?", "body": "<p>Your answer is in your question.</p>\n\n<pre><code>class Example\n  PARENTS = [\n    FATHER = :father,\n    MOTHER = :mother\n  ]\nend\n</code></pre>\n\n<p>Here 3 constants (<code>PARENTS</code>, <code>FATHER</code> and <code>MOTHER</code>). And they in one scope. Array doesn't make new scope.</p>\n\n<p>And <code>Example.constants</code> method just shows you them.</p>\n\n<p>Even if you add your method to your class it changes absolutely nothing</p>\n\n<pre><code>class Example\n  PARENTS = [\n    FATHER = :father,\n    MOTHER = :mother\n  ]\n\n  def self.whos_your_daddy\n    FATHER\n  end\nend\n\nExample.constants #=&gt; [:MOTHER, :PARENTS, :FATHER]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 1, "creation_date": 1549332816, "post_id": 54526884, "comment_id": 95855878, "body": "Thank you for taking the time to answer my question as your first one on the site, and welcome to Stack Overflow! :) There&#39;s a small bit of confusion in your answer \u2014 &quot;there can not be two CONSTANTS with the same name&quot;. At no point did I use two constants with the same name."}, {"owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "edited": false, "score": 1, "creation_date": 1549335631, "post_id": 54526884, "comment_id": 95856351, "body": "Please provide the source as well. Which book was this? What version?"}], "tags": [], "owner": {"reputation": 21, "user_id": 7650739, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bB3dX6VwSCI/AAAAAAAAAAI/AAAAAAAAJU4/-S_TLHhks40/photo.jpg?sz=128", "display_name": "misterernest", "link": "https://stackoverflow.com/users/7650739/misterernest"}, "is_accepted": false, "score": 2, "last_activity_date": 1549349784, "last_edit_date": 1549349784, "creation_date": 1549332294, "answer_id": 54526884, "question_id": 54526667, "link": "https://stackoverflow.com/questions/54526667/why-are-constants-declared-inside-an-array-and-assigned-to-other-constants-acc/54526884#54526884", "title": "Why are constants declared inside an array, and assigned to other constants, accessible as Class constants in Ruby?", "body": "<p>I found this in the ruby \u200b\u200bprogramming book, page 94:</p>\n\n<blockquote>\n  <p>Constants defined within a class or module may be accessed unadorned anywhere within the class or module. Outside the class or module, they may be accessed using the scope operator, ::, prefixed by an expression that returns the appropriate class or module object. Constants defined outside any class or module may be accessed unadorned or by using the scope operator with no prefix. Constants may not be defined in methods. Constants may be added to existing classes and modules from the outside by using the class or module name and the scope operator before the constant name.</p>\n</blockquote>\n\n<p>Conclusion, there cannot be two constants with the same name within a class, one inside the array and one outside. So you do not need the scope to access it, since the scope is the whole class.</p>\n\n<p>You will not need a constant within a constant array, since the array being constant its internal values \u200b\u200bare constant too.</p>\n"}, {"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 0, "last_activity_date": 1549353425, "creation_date": 1549353425, "answer_id": 54529890, "question_id": 54526667, "link": "https://stackoverflow.com/questions/54526667/why-are-constants-declared-inside-an-array-and-assigned-to-other-constants-acc/54529890#54529890", "title": "Why are constants declared inside an array, and assigned to other constants, accessible as Class constants in Ruby?", "body": "<p>Array definition is not a block. It does not run in Array's scope.</p>\n\n<p>It's no different from:</p>\n\n<pre><code>PARENTS = []\nPARENTS &lt;&lt; mom = :mother\n</code></pre>\n\n<p>As you can see, scope does not change:</p>\n\n<pre><code>&gt; puts self\nmain\n=&gt; nil\n&gt; array = [ puts(self.inspect) ]\nmain\n=&gt; [nil]\n</code></pre>\n\n<p>Assignment returns the assigned value:</p>\n\n<pre><code>&gt; foo = \"bar\"\n\"bar\"\n&gt; puts foo\nbar\n&gt; puts(foo = \"baz\")\nbaz\n&gt; puts foo\nbaz\n</code></pre>\n\n<p>You can't \"store\" something like <code>MOTHER = :mother</code> in an Array as it is not a value, it returns a value, which is <code>:mother</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1549357685, "last_edit_date": 1549357685, "creation_date": 1549355823, "answer_id": 54530441, "question_id": 54526667, "link": "https://stackoverflow.com/questions/54526667/why-are-constants-declared-inside-an-array-and-assigned-to-other-constants-acc/54530441#54530441", "title": "Why are constants declared inside an array, and assigned to other constants, accessible as Class constants in Ruby?", "body": "<p>A short answer could be that:</p>\n\n<ul>\n<li>Constants can only be stored inside <a href=\"https://ruby-doc.org/core-2.5.0/Module.html\" rel=\"nofollow noreferrer\">Modules</a> *. <a href=\"https://ruby-doc.org/core-2.5.0/Module.html#method-i-const_set\" rel=\"nofollow noreferrer\"><code>const_set</code></a> is defined for <a href=\"https://ruby-doc.org/core-2.5.0/Module.html\" rel=\"nofollow noreferrer\">Module</a>, not <a href=\"https://ruby-doc.org/core-2.5.1/Object.html\" rel=\"nofollow noreferrer\">Object</a>.</li>\n<li><a href=\"https://ruby-doc.org/core-2.5.0/Class.html\" rel=\"nofollow noreferrer\">Classes</a> are <a href=\"https://ruby-doc.org/core-2.5.0/Module.html\" rel=\"nofollow noreferrer\">Modules</a>.</li>\n<li>An Array instance isn't a Module.</li>\n</ul>\n\n<p>Your code is equivalent to:</p>\n\n<pre><code>class Example\n  PARENTS = [\n    Example.const_set(\"FATHER\", :father),\n    Example.const_set(\"MOTHER\", :mother)\n  ] \nend\n</code></pre>\n\n<p>with some tests:</p>\n\n<pre><code>puts Example.is_a? Module\n# true\nputs Example.is_a? Class\n# true\np Example::PARENTS\n# [:father, :mother]\np Example.constants\n# [:FATHER, :MOTHER, :PARENTS]\nputs Example::PARENTS.is_a? Module\n# false\nExample::PARENTS.const_set(\"UNCLE\", :uncle)\n# undefined method `const_set' for [:father, :mother]:Array (NoMethodError)\n</code></pre>\n\n<p><sub>*: Top-level constants (= constants defined outside a class or module) seem to be stored in <code>Object</code>.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1549357655, "post_id": 54530568, "comment_id": 95863184, "body": "I came here to modify my answer with the exact same code as yours. Do you know how to reference <code>PARENTS</code> inside the singleton class without having to actually write <code>PARENTS</code>? <code>super</code> doesn&#39;t work outside of a method definition."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1549358628, "post_id": 54530568, "comment_id": 95863762, "body": "@EricDuminil i don&#39;t think you can retrieve an object from its singleton class, although that would be an interesting addition."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1549359211, "post_id": 54530568, "comment_id": 95864120, "body": "Let&#39;s <a href=\"https://stackoverflow.com/questions/54531270/retrieve-a-ruby-object-from-its-singleton-class\">see</a>!"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 5, "last_activity_date": 1549359063, "last_edit_date": 1549359063, "creation_date": 1549356363, "answer_id": 54530568, "question_id": 54526667, "link": "https://stackoverflow.com/questions/54526667/why-are-constants-declared-inside-an-array-and-assigned-to-other-constants-acc/54530568#54530568", "title": "Why are constants declared inside an array, and assigned to other constants, accessible as Class constants in Ruby?", "body": "<blockquote>\n  <p>First, what happens when the following code is executed:</p>\n\n<pre><code>PARENTS = [\n  FATHER = :father,\n  MOTHER = :mother\n]\n</code></pre>\n</blockquote>\n\n<ul>\n<li><code>PARENTS = ...</code> attempts to set the constant <code>PARENTS</code>. But in order to do so, it has to evaluate the right-hand side of the assignment:\n\n<ul>\n<li><code>[...]</code> attempts to create an array. But in order to do so, it has to evaluate its arguments:\n\n<ul>\n<li><code>FATHER = :father</code> sets the constant <code>FATHER</code> to <code>:father</code>. The result of this assignment is <code>:father</code> which becomes the first argument.</li>\n<li><code>MOTHER = :mother</code> sets the constant <code>MOTHER</code> to <code>:mother</code>. The result of this assignment is <code>:mother</code> which becomes the second argument.</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>So in <em>chronological</em> order:</p>\n\n<ol>\n<li>The constant <code>FATHER</code> is set to <code>:father</code></li>\n<li>The constant <code>MOTHER</code> is set to <code>:mother</code></li>\n<li>An array with elements <code>:father</code> and <code>:mother</code> is created</li>\n<li>The constant <code>PARENTS</code> is set to that array</li>\n</ol>\n\n<p>Your code is equivalent to:</p>\n\n<pre><code>FATHER = :father\nMOTHER = :mother\nPARENTS = [FATHER, MOTHER]  # or [:father, :mother]\n</code></pre>\n\n<blockquote>\n  <p>By declaring the constants inside of an array, I would expect them to to be scoped inside the array. Please cite the relevant docs in your answer.</p>\n</blockquote>\n\n<p>You can use <code>Module.nesting</code> to determine the current nesting, i.e. where a constant will be defined in: (more examples in the <a href=\"http://ruby-doc.org/core-2.6/doc/syntax/modules_and_classes_rdoc.html#label-Constants\" rel=\"nofollow noreferrer\">docs</a>)</p>\n\n<pre><code>class Example\n  p outer_nesting: Module.nesting\n  PARENTS = [\n    p(inner_nesting: Module.nesting)\n  ]\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{:outer_nesting=&gt;[Example]}\n{:inner_nesting=&gt;[Example]}\n</code></pre>\n\n<p>As you can see, an array literal doesn't affect the current nesting. Constants in both locations will be defined under <code>Example</code>.</p>\n\n<p>If you really wanted to declare the constants \"inside\" the array (i.e. inside the array's singleton class), you could do some like this:</p>\n\n<pre><code>class Example\n  PARENTS = []\n  class &lt;&lt; PARENTS\n    FATHER = :father\n    MOTHER = :mother\n    PARENTS.push(FATHER, MOTHER)\n  end\nend\n\np Example.constants                          #=&gt; [:PARENTS]\np Example::PARENTS.singleton_class.constants #=&gt; [:FATHER, :MOTHER]\n</code></pre>\n\n<p>The above is just for demonstration purposes, there's no need to actually do that.</p>\n"}], "owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 54530568, "answer_count": 6, "score": 2, "last_activity_date": 1549359063, "creation_date": 1549330070, "last_edit_date": 1549351178, "question_id": 54526667, "link": "https://stackoverflow.com/questions/54526667/why-are-constants-declared-inside-an-array-and-assigned-to-other-constants-acc", "title": "Why are constants declared inside an array, and assigned to other constants, accessible as Class constants in Ruby?", "body": "<p>Given the following Ruby class</p>\n\n<pre><code>class Example\n  PARENTS = [\n    FATHER = :father,\n    MOTHER = :mother\n  ]\nend\n</code></pre>\n\n<p>These work as expected</p>\n\n<pre><code>&gt; Example::PARENTS\n#=&gt; [:father, :mother]\n&gt; Example::PARENTS[0]\n#=&gt; :father\n&gt; Example::PARENTS[1]\n#=&gt; :mother\n</code></pre>\n\n<p>However, why does this work?</p>\n\n<pre><code>&gt; Example::FATHER\n#=&gt; :father\n&gt; Example::MOTHER\n#=&gt; :mother\n</code></pre>\n\n<p>In fact, why are there three constants in the Example class's scope?</p>\n\n<pre><code>&gt; Example.constants\n#=&gt; [:MOTHER, :PARENTS, :FATHER]\n</code></pre>\n\n<p>To the point, that if I extend the class with an additional method:</p>\n\n<pre><code>class Example\n  def self.whos_your_daddy\n    FATHER\n  end\nend\n</code></pre>\n\n<p>It accesses the constant like normally.</p>\n\n<pre><code>&gt; Example.whos_your_daddy\n#=&gt; :father\n</code></pre>\n\n<p>How is this behavior possible? By declaring the constants <em>inside</em> of an array, I would expect them to to be scoped inside the array. Please cite the relevant docs in your answer.</p>\n\n<p><strong>Edit:</strong> I suppose I'll clarify, the easiest way to answer this question is to explain two things:</p>\n\n<p>First, what happens when the following code is executed:</p>\n\n<pre><code>PARENTS = [\n  FATHER = :father,\n  MOTHER = :mother\n]\n</code></pre>\n\n<p>Second, does declare a constant anywhere tie it to the scope of the class it is being declared in? Why?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 1, "creation_date": 1549330509, "post_id": 54526644, "comment_id": 95855465, "body": "Write example of your input and desired output"}, {"owner": {"reputation": 63, "user_id": 10475329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a504e2837eab0c4809a8d290e75d27?s=128&d=identicon&r=PG&f=1", "display_name": "stuckonrails", "link": "https://stackoverflow.com/users/10475329/stuckonrails"}, "reply_to_user": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1549331042, "post_id": 54526644, "comment_id": 95855565, "body": "It starts with  if(!window.runParams) { \t\twindow.runParams = {}; \t\t} \t\twindow.runParams.minPrice=&quot;440.2&quot;; \t\twindow.runParams.maxPrice=&quot;577.6&quot;;  And then I need the javascript results array further on down starting on this line  \tvar skuProducts=[{ a lot of javascript &quot;name&quot;:&quot;value&quot; pairs \t...\t \t }}]  So from that I need to strip off everything following and including ] multiline What follows after the javascript results array\tlooks like this  var GaData = {         pageType: &quot;product&quot;,         productIds: &quot;en32959852599&quot;,         totalValue: &quot;US $330.15&quot;     };"}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1549331121, "post_id": 54526644, "comment_id": 95855585, "body": "Add this data to your question"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1549350109, "post_id": 54526644, "comment_id": 95859909, "body": "This doesn&#39;t look like Ruby."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 10475329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a504e2837eab0c4809a8d290e75d27?s=128&d=identicon&r=PG&f=1", "display_name": "stuckonrails", "link": "https://stackoverflow.com/users/10475329/stuckonrails"}, "edited": false, "score": 0, "creation_date": 1549404087, "post_id": 54530672, "comment_id": 95888571, "body": "Can you please explain the regex"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "reply_to_user": {"reputation": 63, "user_id": 10475329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a504e2837eab0c4809a8d290e75d27?s=128&d=identicon&r=PG&f=1", "display_name": "stuckonrails", "link": "https://stackoverflow.com/users/10475329/stuckonrails"}, "edited": false, "score": 0, "creation_date": 1549438269, "post_id": 54530672, "comment_id": 95897325, "body": "The regexp just captures everything between <code>var skuProducts=[</code> and <code>];</code>."}], "tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 0, "last_activity_date": 1549356847, "creation_date": 1549356847, "answer_id": 54530672, "question_id": 54526644, "link": "https://stackoverflow.com/questions/54526644/gsub-all-characters-from-beginning-of-multiline-string-preceeding-specified-char/54530672#54530672", "title": "gsub all characters from beginning of multiline string preceeding specified characters", "body": "<p>Let's create your \"multiline string\" first so we can test this:</p>\n\n<pre><code>&gt; page = %(hello\\nvar skuProducts=[{\"skuAttr\":\"200007763:201336100;491:200004763#145cm\",\"skuPropIds\":\"201336100,200004763\",\"skuVal\":{\"actSkuBulkCalPrice\":\"313.64\"}}];\\nworld\\n)\n</code></pre>\n\n<p>Ok, now let's extract the data using a regular expression:</p>\n\n<pre><code>&gt; skudata = page[/var skuProducts=\\[(.+?)\\];/, 1]\n&gt; puts skudata.inspect\n{\"skuAttr\":\"200007763:201336100;491:200004763#145cm\", \"skuPropIds\":\"201336100,200004763\",\"skuVal\":{\"actSkuBulkCalPrice\":\"313.64\"}}\n</code></pre>\n\n<p>Yeah looks about right, we can probably read it in as JSON:</p>\n\n<pre><code>&gt; require 'json'\n&gt; data = JSON.load(skudata)\n&gt; puts data[\"skyPropIds\"]\n201336100,200004763\n</code></pre>\n\n<p>It works. Hurray.</p>\n"}], "owner": {"reputation": 63, "user_id": 10475329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a504e2837eab0c4809a8d290e75d27?s=128&d=identicon&r=PG&f=1", "display_name": "stuckonrails", "link": "https://stackoverflow.com/users/10475329/stuckonrails"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1549356847, "creation_date": 1549329849, "last_edit_date": 1549356497, "question_id": 54526644, "link": "https://stackoverflow.com/questions/54526644/gsub-all-characters-from-beginning-of-multiline-string-preceeding-specified-char", "title": "gsub all characters from beginning of multiline string preceeding specified characters", "body": "<p>I have a large multiline string, which is a script element from an HTML page and I want to extract some data from it.</p>\n\n<p>There's a line that has the data I need:</p>\n\n<pre><code>var skuProducts=[{\"skuAttr\":\"200007763:201336100;491:200004763#145cm\",\"skuPropIds\":\"201336100,200004763\",\"skuVal\":{\"actSkuBulkCalPrice\":\"313.64\"}}];\n</code></pre>\n\n<p>I only need the part between the first <code>[</code> and last <code>]</code>.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1549333182, "last_edit_date": 1549333182, "creation_date": 1549332647, "answer_id": 54526923, "question_id": 54526528, "link": "https://stackoverflow.com/questions/54526528/ruby-threads-within-threads/54526923#54526923", "title": "Ruby Threads within Threads", "body": "<blockquote>\n  <p>I know the above Thread will join with the main thread and the main thread will \"wait\" for this Thread to complete before it terminates the main thread.</p>\n</blockquote>\n\n<p>It only does it because you said <code>.join</code>. Ruby doesn't wait for threads; any threads unjoined by the time the program terminates are killed.</p>\n\n<blockquote>\n  <p>Does the inner thread join to the parent thread or does it join to the main thread?</p>\n</blockquote>\n\n<p>It does exactly what it is told to do: the outer thread says \"launch a thread, then join it, then end\". The main thread will wait for all that to complete because it, too, was told to <code>.join</code> the outer thread.</p>\n\n<pre><code>main  -launch-----------------------join\nouter        \\---launch-----join---/\ninner                  \\---/\n</code></pre>\n\n<p>Here's an example where the opposite happens - again, only because I explicitly told it to do so:</p>\n\n<pre><code>inner = nil\nouter = Thread.new do\n    inner = Thread.new do\n        sleep(3)\n        p \"Inner done\"\n    end\n\n    sleep(2)\n    p \"Outer done\"\nend\n\nsleep(1)\ninner.join\np \"Inner joined\"\nouter.join\np \"Outer joined\"\n\nmain  -launch----------------join---join\nouter        \\---launch-----/------/\ninner                  \\---/\n</code></pre>\n"}], "owner": {"reputation": 2205, "user_id": 591172, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/475c453e241134dd9e51fc6b1ada721e?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/591172/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549333182, "creation_date": 1549328708, "question_id": 54526528, "link": "https://stackoverflow.com/questions/54526528/ruby-threads-within-threads", "title": "Ruby Threads within Threads", "body": "<p>I have a file that is threading like so:</p>\n\n<pre><code>Thread.new do\n   # Do something\nend.join\n</code></pre>\n\n<p>My question is about sub threads.  I know the above Thread will join with the main thread and the main thread will \"wait\" for this Thread to complete before it terminates the main thread.</p>\n\n<p>However, how does this life cycle work in something like this example:</p>\n\n<pre><code>Thread.new do\n    # Do Something\n\n    Thread.new do\n        # Do something else\n    end.join\nend.join\n</code></pre>\n\n<p>Does the inner thread join to the parent thread or does it join to the main thread?  Does the outer thread \"wait\" on the inner thread and the main thread \"wait\" on the main thread?</p>\n\n<p>Thanks again!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "select", "activerecord", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 510, "user_id": 10987825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WnYnE.jpg?s=128&g=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/10987825/noah"}, "is_accepted": false, "score": 1, "last_activity_date": 1549328435, "last_edit_date": 1549328435, "creation_date": 1549328132, "answer_id": 54526475, "question_id": 54526423, "link": "https://stackoverflow.com/questions/54526423/select-always-returns-id-even-if-it-is-not-included-in-the-call/54526475#54526475", "title": "Select always returns :id even if it is not included in the call", "body": "<p>You should use <code>pluck</code> instead of <code>select</code> if you don\u2019t want to retrieve the id.</p>\n\n<pre><code>Address.pluck(:name, :region, :province)\n</code></pre>\n\n<p>That will return an array of values without the  id. I\u2019m assuming you want the column names as well in which case you can add a method to the model:</p>\n\n<pre><code>def self.pluck_to_hash(keys)\n  pluck(*keys).map{|pa| Hash[keys.zip(pa)]}\nend\n\n# use it with\nAddress.pluck_to_hash([:name, :region, :province])\n</code></pre>\n\n<p><code>pluck_to_hash</code> method from <a href=\"https://stackoverflow.com/a/27995494/10987825\">https://stackoverflow.com/a/27995494/10987825</a></p>\n"}, {"comments": [{"owner": {"reputation": 510, "user_id": 10987825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WnYnE.jpg?s=128&g=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/10987825/noah"}, "edited": false, "score": 0, "creation_date": 1549346417, "post_id": 54526668, "comment_id": 95858654, "body": "Good idea @AbM. Much simpler than my answer :-)"}, {"owner": {"reputation": 13, "user_id": 8704161, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I6wSAd9QpZc/AAAAAAAAAAI/AAAAAAAAABU/uHx0bJr-vDU/photo.jpg?sz=128", "display_name": "Manny Crisostomo", "link": "https://stackoverflow.com/users/8704161/manny-crisostomo"}, "edited": false, "score": 0, "creation_date": 1549370043, "post_id": 54526668, "comment_id": 95870476, "body": "Perfect!  I did the following:      module Response       def json_response(object, status = :ok)         render json: object, status: status, except: :id       end     end  And worked like a charm, thank you!"}], "tags": [], "owner": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "is_accepted": true, "score": 3, "last_activity_date": 1549330080, "creation_date": 1549330080, "answer_id": 54526668, "question_id": 54526423, "link": "https://stackoverflow.com/questions/54526423/select-always-returns-id-even-if-it-is-not-included-in-the-call/54526668#54526668", "title": "Select always returns :id even if it is not included in the call", "body": "<p>You can do:</p>\n\n<pre><code>render json: address.select(:name, :region, :province).to_json(except: :id)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8704161, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I6wSAd9QpZc/AAAAAAAAAAI/AAAAAAAAABU/uHx0bJr-vDU/photo.jpg?sz=128", "display_name": "Manny Crisostomo", "link": "https://stackoverflow.com/users/8704161/manny-crisostomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 54526668, "answer_count": 2, "score": 1, "last_activity_date": 1549330080, "creation_date": 1549327779, "question_id": 54526423, "link": "https://stackoverflow.com/questions/54526423/select-always-returns-id-even-if-it-is-not-included-in-the-call", "title": "Select always returns :id even if it is not included in the call", "body": "<p>I'm using <code>.select</code> to choose which field I want to return, I'm specifying all fields except <code>:id, :created_at and :updated_at</code>, anyways it still returns the <code>\"id\": null</code>.</p>\n\n<p>I'm building an API with Ruby on Rails 5, as usual the fields :id, :created_at and :updated_at are created after running the migration, where <code>:id</code> is the primary key.</p>\n\n<p>When I use <code>address.select(:name, :region, :province)</code></p>\n\n<p>I get:</p>\n\n<pre><code>[\n{\n    \"id\": null,\n    \"name\": \"Lorem Ipsum\",\n    \"region\": \"some text\",\n    \"province\": \"some more text\"\n},\n{\n    \"id\": null,\n    \"name\": \"Lorem Ipsum 1\",\n    \"region\": \"some text 1\",\n    \"province\": \"some more text 1\"\n}\n]\n</code></pre>\n\n<p>But what I'm expecting is:</p>\n\n<pre><code>[\n{\n    \"name\": \"Lorem Ipsum\",\n    \"region\": \"some text\",\n    \"province\": \"some more text\"\n},\n{\n    \"name\": \"Lorem Ipsum 1\",\n    \"region\": \"some text 1\",\n    \"province\": \"some more text 1\"\n}\n]\n</code></pre>\n\n<p>Hope my explanation was enough.</p>\n"}, {"tags": ["ruby", "jekyll", "uglifier"], "answers": [{"comments": [{"owner": {"reputation": 969, "user_id": 326242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cde28dc376b1403cf4de6cbebc80e5?s=128&d=identicon&r=PG", "display_name": "Andrew Koster", "link": "https://stackoverflow.com/users/326242/andrew-koster"}, "reply_to_user": {"reputation": 8803, "user_id": 3867406, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2953c91f637b80205241c00c3e215b9a?s=128&d=identicon&r=PG&f=1", "display_name": "ted", "link": "https://stackoverflow.com/users/3867406/ted"}, "edited": false, "score": 0, "creation_date": 1566405975, "post_id": 57579281, "comment_id": 101649370, "body": "I mean, my site went from &quot;not building or starting&quot; to &quot;building and starting and running just fine&quot;, so it seems like a solution to me."}, {"owner": {"reputation": 969, "user_id": 326242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cde28dc376b1403cf4de6cbebc80e5?s=128&d=identicon&r=PG", "display_name": "Andrew Koster", "link": "https://stackoverflow.com/users/326242/andrew-koster"}, "reply_to_user": {"reputation": 8803, "user_id": 3867406, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2953c91f637b80205241c00c3e215b9a?s=128&d=identicon&r=PG&f=1", "display_name": "ted", "link": "https://stackoverflow.com/users/3867406/ted"}, "edited": false, "score": 0, "creation_date": 1566406104, "post_id": 57579281, "comment_id": 101649403, "body": "Maybe I&#39;ll want to add Javascript minification/obfuscation back into the project, as an optimization, when I&#39;m almost ready to ship. But for now, it&#39;s a premature optimization that was breaking my site, and apparently yours."}], "tags": [], "owner": {"reputation": 969, "user_id": 326242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cde28dc376b1403cf4de6cbebc80e5?s=128&d=identicon&r=PG", "display_name": "Andrew Koster", "link": "https://stackoverflow.com/users/326242/andrew-koster"}, "is_accepted": false, "score": -1, "last_activity_date": 1566324146, "creation_date": 1566324146, "answer_id": 57579281, "question_id": 54525842, "link": "https://stackoverflow.com/questions/54525842/es6-uglifier-with-jekyll-uglifiererror-unexpected-token-keyword-const/57579281#57579281", "title": "ES6 + Uglifier with Jekyll: Uglifier::Error: Unexpected token: keyword (const)", "body": "<p>Get rid of Uglifier. It doesn't support ES6, or at least it doesn't with the configuration that ships with Rails.</p>\n"}, {"tags": [], "owner": {"reputation": 307, "user_id": 422833, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4b98f8858d95b632a7be7e773deeee77?s=128&d=identicon&r=PG", "display_name": "andi", "link": "https://stackoverflow.com/users/422833/andi"}, "is_accepted": false, "score": 0, "last_activity_date": 1566805946, "creation_date": 1566805946, "answer_id": 57653810, "question_id": 54525842, "link": "https://stackoverflow.com/questions/54525842/es6-uglifier-with-jekyll-uglifiererror-unexpected-token-keyword-const/57653810#57653810", "title": "ES6 + Uglifier with Jekyll: Uglifier::Error: Unexpected token: keyword (const)", "body": "<p>Try this one in your <code>_config.yml</code>: <a href=\"https://github.com/dart-lang/site-www/issues/502#issuecomment-365955221\" rel=\"nofollow noreferrer\">https://github.com/dart-lang/site-www/issues/502#issuecomment-365955221</a></p>\n\n<pre><code>  assets:\n    ...\n    external:\n      uglifier:\n        harmony: true\n</code></pre>\n"}], "owner": {"reputation": 8803, "user_id": 3867406, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2953c91f637b80205241c00c3e215b9a?s=128&d=identicon&r=PG&f=1", "display_name": "ted", "link": "https://stackoverflow.com/users/3867406/ted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 632, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1566805946, "creation_date": 1549323019, "question_id": 54525842, "link": "https://stackoverflow.com/questions/54525842/es6-uglifier-with-jekyll-uglifiererror-unexpected-token-keyword-const", "title": "ES6 + Uglifier with Jekyll: Uglifier::Error: Unexpected token: keyword (const)", "body": "<p>Here is the complete error:</p>\n\n<pre><code>Liquid Exception: Unexpected token: keyword (const). To use ES6 syntax, harmony mode must be enabled with Uglifier.new(:harmony =&gt; true). in /_layouts/base.html\n</code></pre>\n\n<p>I found online that the solution should be to use:</p>\n\n<pre><code>Uglifier.compile(js, harmony: true)\n</code></pre>\n\n<p>in a <code>production.rb</code> file, which I don't have since I'm using Jekyll and all I can set is in <code>config.yml</code>:</p>\n\n<pre><code>...\nassets:\n  js_compressor: uglifier\n...\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri"], "comments": [{"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1549327361, "post_id": 54525699, "comment_id": 95854923, "body": "What code did you try? How did you set <code>xml</code>? Now it looks with syntax errors."}, {"owner": {"reputation": 455, "user_id": 5438045, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb60547b3150b54bf3b0210bf1e31314?s=128&d=identicon&r=PG&f=1", "display_name": "Pear", "link": "https://stackoverflow.com/users/5438045/pear"}, "reply_to_user": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1549328295, "post_id": 54525699, "comment_id": 95855085, "body": "i passed in xml through a curl command, and I did verify that the xml is correct. the functions I tried are in the question"}], "answers": [{"tags": [], "owner": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1549326535, "last_edit_date": 1549326535, "creation_date": 1549326289, "answer_id": 54526253, "question_id": 54525699, "link": "https://stackoverflow.com/questions/54525699/nokogiri-not-parsing-xml-string-correctly/54526253#54526253", "title": "Nokogiri not parsing XML string correctly", "body": "<p>It works:</p>\n\n<pre><code>doc = Nokogiri::XML ('&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;document xmlns=\"somexmlns\"&gt;&lt;tag&gt; some data &lt;/tag&gt;&lt;/document&gt;')\n =&gt; #&lt;Nokogiri::XML::Document:0x3fda1d0c9dd8 name=\"document\" children=[#&lt;Nokogiri::XML::Element:0x3fda1d0c9b1c name=\"document\" namespace=#&lt;Nokogiri::XML::Namespace:0x3fda1d0c9acc href=\"somexmlns\"&gt; children=[#&lt;Nokogiri::XML::Element:0x3fda1d0c9770 name=\"tag\" namespace=#&lt;Nokogiri::XML::Namespace:0x3fda1d0c9acc href=\"somexmlns\"&gt; children=[#&lt;Nokogiri::XML::Text:0x3fda1d0c93ec \" some data \"&gt;]&gt;]&gt;]&gt; \n\ndoc.children.text\n =&gt; \" some data \" \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 0, "last_activity_date": 1549329189, "creation_date": 1549329189, "answer_id": 54526577, "question_id": 54525699, "link": "https://stackoverflow.com/questions/54525699/nokogiri-not-parsing-xml-string-correctly/54526577#54526577", "title": "Nokogiri not parsing XML string correctly", "body": "<p>It's all about quotes. Why don't you use them?</p>\n\n<p>Unfortunately, the quotation from <a href=\"https://www.w3.org/TR/2008/REC-xml-20081126/\" rel=\"nofollow noreferrer\">the standard</a> is inserted incorrectly (because of quotes), so I wrote it down as a code.</p>\n\n<pre><code># To allow attribute values to contain both single and double quotes, the apostrophe or single-quote character (') may be represented as \" &amp;apos; \", and the double-quote character (\") as \" &amp;quot; \".\n</code></pre>\n\n<p>Look:</p>\n\n<pre><code>xml = &lt;&lt;-BADXML\n&lt;?xml version=1.0 encoding=UTF-8 standalone=yes?&gt;\n&lt;Document xmlns=somexmlns&gt;\n&lt;tag&gt; some data &lt;/tag&gt;\n&lt;/Document&gt;\nBADXML\n\ndoc = Nokogiri::XML(xml)\nputs doc\n\n# &lt;?xml version=\"1.0\"?&gt;\n# &lt;Document/&gt;\n</code></pre>\n\n<pre><code>xml = &lt;&lt;-GOODXML\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;Document xmlns=\"somexmlns\"&gt;\n&lt;tag&gt; some data &lt;/tag&gt;\n&lt;/Document&gt;\nGOODXML\n\ndoc = Nokogiri::XML(xml)\nputs doc\n\n# &lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n# &lt;Document xmlns=\"somexmlns\"&gt;\n# &lt;tag&gt; some data &lt;/tag&gt;\n# &lt;/Document&gt;\n</code></pre>\n\n<p>Also it's better to use lowercase letters like <code>&lt;document&gt;&lt;/document&gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1549330313, "post_id": 54526648, "comment_id": 95855421, "body": "In any case, use quotes for XML attributes. I have reproduced your error, look at answer"}], "tags": [], "owner": {"reputation": 455, "user_id": 5438045, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb60547b3150b54bf3b0210bf1e31314?s=128&d=identicon&r=PG&f=1", "display_name": "Pear", "link": "https://stackoverflow.com/users/5438045/pear"}, "is_accepted": false, "score": 0, "last_activity_date": 1549329877, "creation_date": 1549329877, "answer_id": 54526648, "question_id": 54525699, "link": "https://stackoverflow.com/questions/54525699/nokogiri-not-parsing-xml-string-correctly/54526648#54526648", "title": "Nokogiri not parsing XML string correctly", "body": "<p>Turns out that I forgot to set the data type as <code>text/xml</code> in curl.</p>\n"}], "owner": {"reputation": 455, "user_id": 5438045, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb60547b3150b54bf3b0210bf1e31314?s=128&d=identicon&r=PG&f=1", "display_name": "Pear", "link": "https://stackoverflow.com/users/5438045/pear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1549329877, "creation_date": 1549322006, "last_edit_date": 1549329843, "question_id": 54525699, "link": "https://stackoverflow.com/questions/54525699/nokogiri-not-parsing-xml-string-correctly", "title": "Nokogiri not parsing XML string correctly", "body": "<p>EDIT: the xml is parsed through a <code>curl</code> command. It is not initialized like the example\nI have an XML string    </p>\n\n<pre><code>xml = &lt;?xml version=1.0 encoding=UTF-8 standalone=yes?&gt;\n      &lt;Document xmlns=somexmlns&gt;\n            &lt;tag&gt; some data &lt;/tag&gt;\n     &lt;/Document&gt;\n</code></pre>\n\n<p>When I try to parse with Nokogiri, (I tried all 3)<br>\n<code>Nokogiri::XML(xml)</code><br>\n<code>Nokogiri::XML.parse(xml)</code>\n<code>Nokogiri::XML.parse(xml).remove_namespaces!</code><br>\nI get</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Document/&gt;\n</code></pre>\n\n<p>I know I can remove the <code>xmlnx</code> tag before parsing it with Nokogiri, but I would like to know why this is happening and how I can resolve it without modifying the XML itself.</p>\n"}, {"tags": ["mysql", "ruby", "ruby-on-rails-3", "activerecord"], "comments": [{"owner": {"reputation": 21589, "user_id": 4875631, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Goodbye StackExchange", "link": "https://stackoverflow.com/users/4875631/goodbye-stackexchange"}, "edited": false, "score": 0, "creation_date": 1549321622, "post_id": 54525618, "comment_id": 95853573, "body": "<code>flowlog</code> != <code>flowlogs</code>"}, {"owner": {"reputation": 37, "user_id": 10461041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3NIzT2ffSxc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVPCZKNVr0M5zHg_oUmBYmhwQNLAg/mo/photo.jpg?sz=128", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/10461041/abhishek"}, "reply_to_user": {"reputation": 21589, "user_id": 4875631, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Goodbye StackExchange", "link": "https://stackoverflow.com/users/4875631/goodbye-stackexchange"}, "edited": false, "score": 0, "creation_date": 1549321846, "post_id": 54525618, "comment_id": 95853635, "body": "I have tried both flowlog and flowlogs to test, nothing worked @FrankerZ"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1549322483, "post_id": 54525618, "comment_id": 95853821, "body": "Can you post your schema.rb? Also, can you retry your commands with <code>save!</code> instead of <code>save</code> and see if an error is raised? And your db:migrate command hasn&#39;t shown any errors?"}, {"owner": {"reputation": 37, "user_id": 10461041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3NIzT2ffSxc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVPCZKNVr0M5zHg_oUmBYmhwQNLAg/mo/photo.jpg?sz=128", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/10461041/abhishek"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1549323430, "post_id": 54525618, "comment_id": 95854055, "body": "I have shared the schema.rb for your understanding, can you please help me out now @JayDorsey"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1549333262, "post_id": 54525618, "comment_id": 95855949, "body": "@MasettyAbhishek take a look at this answer: <a href=\"https://stackoverflow.com/a/19937578/2892779\">stackoverflow.com/a/19937578/2892779</a> The issue might be caused because you&#39;ve pluralized the flowlogs model, but the table it&#39;s looking for is <code>flowlog</code>. On Rails3, idk what mixing the two up will do but newer versions of rails are pretty good about automatically pluralizing/singularizing the model &amp; table name for you. AFAIK, the recommended way is singular Model name, creates a pluralized table name.  I&#39;d probably make sure your model is singular Flowlog (flowlog.rb) and see if that fixes it"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1549333303, "post_id": 54525618, "comment_id": 95855955, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19937286/getting-table-doesnt-exist-error-but-the-table-does-exist-activerecordstate\">Getting Table doesn&#39;t exist error, but the table does exist (ActiveRecord::StatementInvalid Mysql2::Error: Table doesn&#39;t exist)</a>"}], "owner": {"reputation": 37, "user_id": 10461041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3NIzT2ffSxc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVPCZKNVr0M5zHg_oUmBYmhwQNLAg/mo/photo.jpg?sz=128", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/10461041/abhishek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549323151, "creation_date": 1549321521, "last_edit_date": 1549323151, "question_id": 54525618, "link": "https://stackoverflow.com/questions/54525618/i-have-created-a-table-in-rails-using-the-migration-file-but-i-am-not-able-to-a", "title": "I have created a table in rails using the migration file. But I am not able to access the table in the rails console", "body": "<p>I have created a table called as Flowlogs in the rails application using the migration file. I've also fed the data to that table in the rails console. All of a sudden when I try to manually feed the data in the rails console then I get the error.</p>\n\n<p>I've created a table named \"flowlogs\" and there are two columns in the table with the names vpc_id and flowlog_id.\n    I've logged into the rails console and gave a=Flowlogs.new() and then a.vpc_id=\"1234\" and a.flowlog_id=\"a1234\" and finally gave a.save. This has successfully worked and I have cross-checked using by using the command Flowlogs.all. It has shown the output. But after sometime when I logged into the console and gave Flowlogs.all, then it kept throwing the errors.</p>\n\n<p>Most importantly when I logged into the mysql console and checked there is a table with the data with I fed manually in the rails console</p>\n\n<p>My database name is fusion.</p>\n\n<pre><code>    Flowlog Load (1.4ms)  SELECT `flowlog`.* FROM `flowlog`\n    Hirb Error: Mysql2::Error: Table 'fusion.flowlog' doesn't exist: SELECT `flowlog`.* FROM `flowlog`\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/mysql2-0.4.10/lib/mysql2/client.rb:120:in `_query'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/mysql2-0.4.10/lib/mysql2/client.rb:120:in `block in query'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/mysql2-0.4.10/lib/mysql2/client.rb:119:in `handle_interrupt'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/mysql2-0.4.10/lib/mysql2/client.rb:119:in `query'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:305:in `block in execute'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/connection_adapters/abstract_adapter.rb:472:in `block in log'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.6/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/connection_adapters/abstract_adapter.rb:466:in `log'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:305:in `execute'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:231:in `execute'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:235:in `exec_query'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/connection_adapters/abstract/database_statements.rb:356:in `select'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/connection_adapters/abstract/database_statements.rb:32:in `select_all'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/connection_adapters/abstract/query_cache.rb:70:in `select_all'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/querying.rb:39:in `find_by_sql'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/relation.rb:639:in `exec_queries'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/relation.rb:515:in `load'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/relation.rb:243:in `to_a'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activerecord-4.2.6/lib/active_record/relation/delegation.rb:46:in `to_ary'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/hirb-0.7.3/lib/hirb/formatter.rb:88:in `Array'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/hirb-0.7.3/lib/hirb/formatter.rb:88:in `determine_output_class'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/hirb-0.7.3/lib/hirb/formatter.rb:53:in `format_output'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/hirb-0.7.3/lib/hirb/view.rb:205:in `render_output'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/hirb-0.7.3/lib/hirb/view.rb:123:in `view_output'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/hirb-0.7.3/lib/hirb/view.rb:201:in `view_or_page_output'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/hirb-0.7.3/lib/hirb/view.rb:187:in `output_value'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb.rb:490:in `block (2 levels) in eval_input'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb.rb:623:in `signal_status'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb.rb:486:in `block in eval_input'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb/ruby-lex.rb:246:in `block (2 levels) in each_top_level_statement'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb/ruby-lex.rb:232:in `loop'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb/ruby-lex.rb:232:in `block in each_top_level_statement'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb/ruby-lex.rb:231:in `catch'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb/ruby-lex.rb:231:in `each_top_level_statement'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb.rb:485:in `eval_input'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb.rb:395:in `block in start'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb.rb:394:in `catch'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/irb.rb:394:in `start'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/railties-4.2.6/lib/rails/commands/console.rb:110:in `start'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/railties-4.2.6/lib/rails/commands/console.rb:9:in `start'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:68:in `console'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:39:in `run_command!'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/railties-4.2.6/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.6/lib/active_support/dependencies.rb:274:in `require'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.6/lib/active_support/dependencies.rb:274:in `block in require'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.6/lib/active_support/dependencies.rb:240:in `load_dependency'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.6/lib/active_support/dependencies.rb:274:in `require'\n        /Users/masettya/fusion_app/bin/rails:9:in `&lt;top (required)&gt;'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.6/lib/active_support/dependencies.rb:268:in `load'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.6/lib/active_support/dependencies.rb:268:in `block in load'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.6/lib/active_support/dependencies.rb:240:in `load_dependency'\n        /Users/masettya/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.6/lib/active_support/dependencies.rb:268:in `load'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n        /Users/masettya/.rvm/rubies/ruby-2.3.1/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n        -e:1:in `&lt;main&gt;'\n</code></pre>\n\n<p>This is my migration file</p>\n\n<pre><code>    class CreateFlowlogs &lt; ActiveRecord::Migration\n      def change\n        create_table :flowlogs do |t|\n            t.string :account_name\n            t.string :region\n            t.string :vpc_id\n            t.string :flowlog_id\n            t.boolean :status\n        end\n      end\n    end\n</code></pre>\n\n<p>This is the schema.rb file   </p>\n\n<pre><code>create_table \"account_master\", force: :cascade do |t|\n    t.string \"name\",         limit: 52,               null: false\n    t.string \"alias_name\",   limit: 52,               null: false\n    t.string \"owner\",        limit: 26,               null: false\n    t.string \"mail_contact\", limit: 100\n    t.string \"dl_email\",     limit: 50\n    t.string \"root_user\",    limit: 32,               null: false\n    t.string \"team\",         limit: 32\n    t.string \"contact_no\",   limit: 15\n    t.string \"email\",        limit: 50\n    t.string \"del_flg\",      limit: 1,   default: \"\", null: false\n    t.date   \"created_on\",                            null: false\n    t.string \"created_by\",   limit: 50\n    t.date   \"modified_on\"\n    t.string \"modified_by\",  limit: 50\n    t.string \"account_type\", limit: 50\n    t.string \"ssl_account\",  limit: 20\n  end\n\n  create_table \"admin_authentication_users\", force: :cascade do |t|\n    t.string   \"email\",              limit: 255,   default: \"\",    null: false\n    t.string   \"encrypted_password\", limit: 255,   default: \"\",    null: false\n    t.integer  \"sign_in_count\",      limit: 4,     default: 0,     null: false\n    t.datetime \"current_sign_in_at\"\n    t.datetime \"last_sign_in_at\"\n    t.string   \"current_sign_in_ip\", limit: 255\n    t.string   \"last_sign_in_ip\",    limit: 255\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\n    t.string   \"uid\",                limit: 255\n    t.text     \"all_details\",        limit: 65535\n    t.string   \"otp_secret_key\",     limit: 255\n    t.boolean  \"qr_not_required\",                  default: false, null: false\n    t.boolean  \"active\",                           default: false, null: false\n    t.boolean  \"deleted\",                          default: false, null: false\n  end\n\n  add_index \"admin_authentication_users\", [\"email\"], name: \"index_admin_authentication_users_on_email\", unique: true, using: :btree\n\n  create_table \"employee_shift\", force: :cascade do |t|\n    t.string   \"emp_id\",       limit: 30\n    t.string   \"session\",      limit: 50\n    t.string   \"created_by\",   limit: 100\n    t.datetime \"created_on\"\n    t.date     \"session_date\"\n    t.string   \"emp_name\",     limit: 200\n    t.string   \"updated_by\",   limit: 200\n    t.datetime \"updated_on\"\n  end\n\n  create_table \"flowlogs\", force: :cascade do |t|\n    t.string  \"account_name\", limit: 255\n    t.string  \"region\",       limit: 255\n    t.string  \"vpc_id\",       limit: 255\n    t.string  \"flowlog_id\",   limit: 255\n    t.boolean \"status\"\n  end\n\n  create_table \"tests\", force: :cascade do |t|\n    t.string \"function\",    limit: 255\n    t.string \"description\", limit: 255\n  end\n\n  create_table \"updates\", primary_key: \"reference_id\", force: :cascade do |t|\n    t.string   \"created_by\",    limit: 200,   default: \"\", null: false\n    t.datetime \"created_on\",                               null: false\n    t.string   \"subject\",       limit: 2000,  default: \"\", null: false\n    t.text     \"body_content\",  limit: 65535,              null: false\n    t.string   \"status\",        limit: 20,    default: \"\", null: false\n    t.string   \"creted_by_id\",  limit: 100,   default: \"\", null: false\n    t.string   \"account\",       limit: 100,   default: \"\", null: false\n    t.string   \"archive_by\",    limit: 200\n    t.datetime \"archive_on\"\n    t.string   \"archive_by_id\", limit: 200\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "graphql"], "answers": [{"tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": true, "score": 7, "last_activity_date": 1549334946, "creation_date": 1549334946, "answer_id": 54527133, "question_id": 54525442, "link": "https://stackoverflow.com/questions/54525442/cant-write-unknown-attribute-client-mutation-id/54527133#54527133", "title": "can&#39;t write unknown attribute `client_mutation_id`", "body": "<p>The <a href=\"https://facebook.github.io/relay/graphql/mutations.htm\" rel=\"noreferrer\">Relay Input Object Mutations Specification</a> lays down some requirements on what mutation inputs and outputs look like, and <a href=\"https://graphql-ruby.org/mutations/mutation_classes\" rel=\"noreferrer\">graphql-ruby can generate some of this boilerplate for you</a>.  In particular, you don't directly specify the <code>type</code> of the mutation response; graphql-ruby generates a \"payload\" type for you, and you have to specify the <code>field</code>s that go into it.</p>\n\n<p>That is, I think it should work to say:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Mutations::CreatePost &lt; Mutations::BaseMutation\n    argument :title, String, required: true\n    argument :body, String, required: true\n\n    field :post, Types::PostType, null: false\n\n    def resolve(title: nil, body: nil)\n        post = Post.create!(title: title, body: body)\n        { post: post }\n    end\nend\n</code></pre>\n\n<p><a href=\"https://graphql-ruby.org/api-doc/1.8.13/GraphQL/Schema/RelayClassicMutation\" rel=\"noreferrer\">The API docs</a> note (emphasis from original):</p>\n\n<blockquote>\n  <p>An argument called <code>clientMutationId</code> is <em>always</em> added, but it\u2019s not passed to the resolve method. The value is re-inserted to the response. (It\u2019s for client libraries to manage optimistic updates.)</p>\n</blockquote>\n\n<p>So when your original version tries to return the model object directly, graphql-ruby tries to set <code>#client_mutation_id</code> on it, and that results in the error you're getting.</p>\n"}], "owner": {"reputation": 113, "user_id": 6888969, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ad17c6acb0d182f7576fd0dbb030177b?s=128&d=identicon&r=PG&f=1", "display_name": "AbUndZu", "link": "https://stackoverflow.com/users/6888969/abundzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 1, "accepted_answer_id": 54527133, "answer_count": 1, "score": 3, "last_activity_date": 1549334946, "creation_date": 1549320252, "question_id": 54525442, "link": "https://stackoverflow.com/questions/54525442/cant-write-unknown-attribute-client-mutation-id", "title": "can&#39;t write unknown attribute `client_mutation_id`", "body": "<p>I'm trying to write my first mutation in Graphql with RoR. It seems like this:</p>\n\n<p>app/graphql/mutations/create_post.rb</p>\n\n<pre><code>module Mutations\n    class CreatePost &lt; Mutations::BaseMutation\n        argument :title, String, required: true\n        argument :body, String, required: true\n\n        type Types::PostType\n\n        def resolve(title: nil, body: nil)\n            Post.create!(title: title, body: body)\n        end\n    end\nend\n</code></pre>\n\n<p>But every time I make request using Graphiql (like this:)</p>\n\n<pre><code>mutation createPost {\n  createPost(input:{\n    title:\"dupa\",\n    body:\"dupa\"\n  }) {\n    id\n  }\n}\n</code></pre>\n\n<p>The post gets saved in database, but I recive an error</p>\n\n<pre><code>\"error\": {\n    \"message\": \"can't write unknown attribute `client_mutation_id`\" [...]\n</code></pre>\n\n<p>instead of requested id\nHow can I solve this problem?\nthis is my</p>\n\n<p>app/graphql/mutations/base_mutation.rb</p>\n\n<pre><code>module Mutations\n    class BaseMutation &lt; GraphQL::Schema::RelayClassicMutation\n    end\nend\n</code></pre>\n\n<p>app/graphql/types/mutation_type.rb</p>\n\n<pre><code>module Types\n  class MutationType &lt; Types::BaseObject\n    field :create_post, mutation: Mutations::CreatePost\n  end\nend\n</code></pre>\n\n<p>github link if it can help: <a href=\"https://github.com/giraffecms/GiraffeCMS-backend-rails/tree/blog/app/graphql\" rel=\"nofollow noreferrer\">https://github.com/giraffecms/GiraffeCMS-backend-rails/tree/blog/app/graphql</a></p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 374, "user_id": 5195976, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f71b0d4a72d7ebe9fa64f58b218d0bf?s=128&d=identicon&r=PG&f=1", "display_name": "mareiou", "link": "https://stackoverflow.com/users/5195976/mareiou"}, "edited": false, "score": 0, "creation_date": 1549321963, "post_id": 54525581, "comment_id": 95853678, "body": "Why does the <code>instance_variable_set</code> function has to be called inside <code>initialize</code> method instead of being executed right after <code>attr_reader name.to_sym</code> ?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 374, "user_id": 5195976, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f71b0d4a72d7ebe9fa64f58b218d0bf?s=128&d=identicon&r=PG&f=1", "display_name": "mareiou", "link": "https://stackoverflow.com/users/5195976/mareiou"}, "edited": false, "score": 0, "creation_date": 1549326217, "post_id": 54525581, "comment_id": 95854688, "body": "Because <code>attr_reader</code> is called at the class level. The instance variable must be set at the instance level."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1549321272, "creation_date": 1549321272, "answer_id": 54525581, "question_id": 54525358, "link": "https://stackoverflow.com/questions/54525358/how-to-create-attr-reader-to-a-class-dynamically/54525581#54525581", "title": "How to create attr_reader to a class dynamically", "body": "<p>You can define BaseClass like so:</p>\n\n<pre><code>class Component; end\n\nclass BaseClass\n  @@components = []\n  def initialize\n    @@components.each do |attr|\n      instance_variable_set(\"@#{attr}\", Component.new)\n    end\n  end\n  def self.create_component(name:)\n    attr_reader name.to_sym\n    @@components &lt;&lt; name\n  end\nend\n\nclass ChildClass &lt; BaseClass\n  create_component :name =&gt; \"ball\"\n  create_component :name =&gt; \"baseball\"\nend\n\nobject = ChildClass.new\n\nobject.ball\n# =&gt; #&lt;Component:0x00007fa62fbdf3f8&gt;\n\nobject.baseball\n# =&gt; #&lt;Component:0x00007fa62fbdf3a8&gt;\n</code></pre>\n\n<p>Basically you do three things:</p>\n\n<ol>\n<li>Create a class-level instance variable <code>@@components</code> which stores a list of the custom <code>attr_reader</code> names</li>\n<li>Inside <code>create_component</code>, call <code>attr_reader</code> to create the method and also add it to the <code>@@components</code> list</li>\n<li>Inside <code>initialize</code>, set initial values for each of the <code>@@components</code> (you can also give custom values for these using <code>initialize</code> arguments if you like).</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1549327315, "last_edit_date": 1549327315, "creation_date": 1549323314, "answer_id": 54525874, "question_id": 54525358, "link": "https://stackoverflow.com/questions/54525358/how-to-create-attr-reader-to-a-class-dynamically/54525874#54525874", "title": "How to create attr_reader to a class dynamically", "body": "<p>You could do that as follows.</p>\n\n<pre><code>class Component\nend\n\nclass BaseClass\n  def create_component(name)\n    self.class.send(:attr_accessor, name)\n    instance_variable_set(\"@#{name}\", Component.new)\n  end\nend\n\nclass ChildClass &lt; BaseClass\nend\n\nc = ChildClass.new\nc.create_component \"ball\"\n  #=&gt; #&lt;Component:0x000056f36c73c2e0&gt; \nc.create_component\"baseball\"\n  #=&gt; #&lt;Component:0x000056f36c7533f0&gt;\nc.methods &amp; [:ball, :baseball]\n  #=&gt; [:ball, :baseball] \nc.instance_variables\n  #=&gt; [:@ball, :@baseball] \nc.ball\n  #=&gt; #&lt;Component:0x000056f36c73c2e0&gt; \nc.baseball\n  #=&gt; #&lt;Component:0x00005602be1eb560&gt; \nc.ball = 1\nc.ball\n  #=&gt; 1 \n</code></pre>\n\n<p>Note that</p>\n\n<pre><code>self.class.send(:attr_accessor, name)\n</code></pre>\n\n<p>could be replaced with</p>\n\n<pre><code>self.class.class_eval { attr_accessor name.to_sym }\n</code></pre>\n\n<p>That the instance variables are being added to an instance of a child class of <code>BaseClass</code> is of no matter. It would be essentially the same question if they were to be added to an instance of <code>BaseClass</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 0, "last_activity_date": 1549357879, "creation_date": 1549357879, "answer_id": 54530927, "question_id": 54525358, "link": "https://stackoverflow.com/questions/54525358/how-to-create-attr-reader-to-a-class-dynamically/54530927#54530927", "title": "How to create attr_reader to a class dynamically", "body": "<p>This creates an instance method, such as:</p>\n\n<pre><code>def baseball\n  @baseball ||= Component.new\nend\n</code></pre>\n\n<p>For the <code>baseball=</code> it just uses regular <code>attr_writer</code>:</p>\n\n<pre><code>class Component\nend\n\nclass BaseClass\n  def self.create_component(name:)\n    class_eval &lt;&lt;~EOB\n      attr_writer :#{name}\n      def #{name}\n        @#{name} ||= Component.new\n      end\n    EOB\n  end\nend\n\nclass ChildClass &lt; BaseClass\n  create_component name: \"ball\"\n  create_component name: \"baseball\"\nend\n</code></pre>\n\n<p>This seems to work:</p>\n\n<pre><code>&gt; c = ChildClass.new\n&gt; c.ball\n=&gt; #&lt;Component:0x00007f8b270cfa58&gt;\n&gt; c.baseball\n=&gt; #&lt;Component:0x00007f8b270dbdd0&gt;\n</code></pre>\n"}], "owner": {"reputation": 374, "user_id": 5195976, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f71b0d4a72d7ebe9fa64f58b218d0bf?s=128&d=identicon&r=PG&f=1", "display_name": "mareiou", "link": "https://stackoverflow.com/users/5195976/mareiou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1549357879, "creation_date": 1549319809, "question_id": 54525358, "link": "https://stackoverflow.com/questions/54525358/how-to-create-attr-reader-to-a-class-dynamically", "title": "How to create attr_reader to a class dynamically", "body": "<p>How do I create an attribute on an object dynamically and assign an object to its value?\nI have the following code:</p>\n\n<pre><code>class Component\n  def initialize\n  end    \nend\n\nclass BaseClass\n  def initialize\n  end\n\n  # define class methods\n  def self.create_component(**args)\n    # create attr_accessor with name \"ball\"\n    # set ball = Component.new\n  end\nend\n\nclass ChildClass &lt; BaseClass\n\n  create_component :name =&gt; \"ball\"\n  create_component :name =&gt; \"baseball\"\n  def initialize\n  end\nend\n</code></pre>\n\n<p>My goal is that when the ChildClass calls \"create_component\" method, this should create an attribute with the name provided in :name parameter and instantiate a \"Component\" object to this attribute.</p>\n\n<pre><code>object = ChildClass.new\nobject.ball #=&gt; to return object reference (Component class 1)\nobject.baseball #=&gt; to return object reference (Component class 2)\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "edited": false, "score": 0, "creation_date": 1549316290, "post_id": 54524586, "comment_id": 95851808, "body": "Why doesn&#39;t that first link help? It seems to be doing exactly what you want"}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 1, "creation_date": 1549318190, "post_id": 54524586, "comment_id": 95852554, "body": "For right answer, can you provide example of how you are going to consume those arrays. Because there is a possibility that you don&#39;t need those names at all"}, {"owner": {"reputation": 3455, "user_id": 9837259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49b32d19ef111a744aa6aee5cb5bf35?s=128&d=identicon&r=PG&f=1", "display_name": "Magofoco", "link": "https://stackoverflow.com/users/9837259/magofoco"}, "edited": false, "score": 0, "creation_date": 1549322129, "post_id": 54524586, "comment_id": 95853724, "body": "I added the information you requires. Many thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 3455, "user_id": 9837259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49b32d19ef111a744aa6aee5cb5bf35?s=128&d=identicon&r=PG&f=1", "display_name": "Magofoco", "link": "https://stackoverflow.com/users/9837259/magofoco"}, "edited": false, "score": 0, "creation_date": 1549322289, "post_id": 54524722, "comment_id": 95853775, "body": "I get the following error message: <code>undefined method </code>[]=&#39; for 854007252925858582:Integer (NoMethodError) Did you mean?  []&#180;"}, {"owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "reply_to_user": {"reputation": 3455, "user_id": 9837259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49b32d19ef111a744aa6aee5cb5bf35?s=128&d=identicon&r=PG&f=1", "display_name": "Magofoco", "link": "https://stackoverflow.com/users/9837259/magofoco"}, "edited": false, "score": 0, "creation_date": 1549326454, "post_id": 54524722, "comment_id": 95854740, "body": "@FBSO I updated my answer. That should work. You weren&#39;t declaring your hash."}, {"owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "reply_to_user": {"reputation": 3455, "user_id": 9837259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49b32d19ef111a744aa6aee5cb5bf35?s=128&d=identicon&r=PG&f=1", "display_name": "Magofoco", "link": "https://stackoverflow.com/users/9837259/magofoco"}, "edited": false, "score": 0, "creation_date": 1549327791, "post_id": 54524722, "comment_id": 95854998, "body": "@FBSO I updated my answer again. I recommend using <code>.pluck</code> you can get all the answers from each of the replies for each question. I think my answer should get you exactly what you want."}], "tags": [], "owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "is_accepted": false, "score": 0, "last_activity_date": 1549380630, "last_edit_date": 1549380630, "creation_date": 1549316499, "answer_id": 54524722, "question_id": 54524586, "link": "https://stackoverflow.com/questions/54524586/ruby-dynamically-name-for-an-array-for-a-controller/54524722#54524722", "title": "Ruby dynamically name for an array for a controller", "body": "<p>As per the first link you have in your question I think that is the best way to do it and would look something like this.</p>\n\n<pre><code>hash = Hash.new\n28.times do |counter|\n  hash[:\"all_questions_#{counter + 1}\"] = @replies.pluck(:\"question_#{counter + 1}\").map(&amp;:to_i)\nend\n</code></pre>\n\n<p>You'd end up with a hash whose keys match with the naming convention you want and the values be the arrays filled with the the question values from each of the @replies. When you want to get a specific array from the hash you can do</p>\n\n<pre><code> hash[:all_questions_1] # returns [1, -1, 0, ....]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3455, "user_id": 9837259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49b32d19ef111a744aa6aee5cb5bf35?s=128&d=identicon&r=PG&f=1", "display_name": "Magofoco", "link": "https://stackoverflow.com/users/9837259/magofoco"}, "edited": false, "score": 0, "creation_date": 1549322248, "post_id": 54524984, "comment_id": 95853766, "body": "Many thanks. I had to add more information on the why I need 28 array, therefore I change my question."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 3455, "user_id": 9837259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49b32d19ef111a744aa6aee5cb5bf35?s=128&d=identicon&r=PG&f=1", "display_name": "Magofoco", "link": "https://stackoverflow.com/users/9837259/magofoco"}, "edited": false, "score": 1, "creation_date": 1549326384, "post_id": 54524984, "comment_id": 95854726, "body": "@FBSO you should give up on the idea of dynamic variable names. There is no reason to do this, instead of using some sort of proper dynamic indexing  (hashes or arrays)"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 1, "last_activity_date": 1549317802, "creation_date": 1549317802, "answer_id": 54524984, "question_id": 54524586, "link": "https://stackoverflow.com/questions/54524586/ruby-dynamically-name-for-an-array-for-a-controller/54524984#54524984", "title": "Ruby dynamically name for an array for a controller", "body": "<p>Using dynamic variables is something I have never ever found a need for. You should find another data structure to store them (for example, an array of arrays).</p>\n\n<p>For example,</p>\n\n<pre><code>all_questions_arrays = 28.times.map { |i| [i] }\n\nprint all_questions_arrays[20]\n# =&gt; [20]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3455, "user_id": 9837259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49b32d19ef111a744aa6aee5cb5bf35?s=128&d=identicon&r=PG&f=1", "display_name": "Magofoco", "link": "https://stackoverflow.com/users/9837259/magofoco"}, "edited": false, "score": 0, "creation_date": 1549322205, "post_id": 54525034, "comment_id": 95853751, "body": "Thanks for your answer. I changed my question a bit, but indeed your reply was helpful."}], "tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": false, "score": 1, "last_activity_date": 1549318029, "creation_date": 1549318029, "answer_id": 54525034, "question_id": 54524586, "link": "https://stackoverflow.com/questions/54524586/ruby-dynamically-name-for-an-array-for-a-controller/54525034#54525034", "title": "Ruby dynamically name for an array for a controller", "body": "<p>You can create dynamically 28 instance variables like this:</p>\n\n<pre><code>1.upto(28){ |i| instance_variable_set(\"@all_questions_#{i}\", [])}\n</code></pre>\n\n<p>Access to one of 28 variables through <code>@</code> sign. Ex. <code>@all_questions_3</code></p>\n"}], "owner": {"reputation": 3455, "user_id": 9837259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49b32d19ef111a744aa6aee5cb5bf35?s=128&d=identicon&r=PG&f=1", "display_name": "Magofoco", "link": "https://stackoverflow.com/users/9837259/magofoco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "closed_date": 1549375116, "answer_count": 3, "score": 1, "last_activity_date": 1549380630, "creation_date": 1549315854, "last_edit_date": 1549322112, "question_id": 54524586, "link": "https://stackoverflow.com/questions/54524586/ruby-dynamically-name-for-an-array-for-a-controller", "closed_reason": "Duplicate", "title": "Ruby dynamically name for an array for a controller", "body": "<p>I have to create 28 arrays named the following:</p>\n\n<pre><code>all_questions_1 = []\nall_questions_2 = []\n...\nall_questions_28 = []\n</code></pre>\n\n<p>I do not want to create them manually so I am trying to figure out how to do so dynamically with a lot of failed attempts.</p>\n\n<p>I checked the previous questions with little success.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/14595136/ruby-dynamically-naming-arrays\">Ruby dynamically naming arrays</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/16419767/ruby-dynamic-variable-name\">Ruby dynamic variable name</a></p>\n\n<p><strong>After reading the comment I added this additional explanation on the why I asked this question</strong></p>\n\n<p>What I am trying to solve is a problem I have inside a Ruby_on_Rails <code>controller</code> for an custom action called <code>replies</code></p>\n\n<p>The action is the following:</p>\n\n<pre><code>def replies\n    @project = Project.find(params[:project_id])\n    @paper = Paper.find(params[:paper_id])\n    @replies = Question.where(\"project_id = ? AND paper_id = ?\", params[:project_id], params[:paper_id])\nend\n</code></pre>\n\n<p><code>@replies</code> gives back a long object containing all the replies on each paper contained in a project.\nTherefore, one paper can be answered by multiple users. Each paper is inside a project. Each project contains several papers.\n(The user can answer all the 28 questions with: NA, NO, MAYBE, YES which I translated to \"-1\", \"0\", \"0.5\", \"1\")</p>\n\n<p>This is what the object <code>@replies</code> gives me back.\n<a href=\"https://i.stack.imgur.com/qht6q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qht6q.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now, once I have that. I have to map all the 28 replies/questions. I want to do the following.</p>\n\n<pre><code>@replies.map do |reply|\n  all_question_1 &lt;&lt; reply.question_1.to_i\nend\n</code></pre>\n\n<p>And I want to do it 28 times (there are 28 questions), that is why I need 28 arrays. I am doing it because I want the possible answers which are strings <code>\"-1\", \"0\", \"0.5\", \"1\"</code> to be changed into numbers <code>-1, 0, 0,5, 1</code></p>\n\n<p>Once dode that, I want to count for each question (all_question_1, all_question_2... all_question_28) how many questions with -1 or 0 or 0.5 or 1 are contained.</p>\n\n<p><strong>TO SUM UP:</strong></p>\n\n<p>I need to build the following code 28 times changing the name_of_array_[NUMBER] from 1 to 28:</p>\n\n<pre><code>all_question_1 = []\n\n@replies.map do |reply|\n  all_question_1 &lt;&lt; reply.question_1.to_i\nend\n\nna_question_1 = all_question_1.count(-1)\nno_question_1 = all_question_1.count(0)\nmaybe_question_1 = all_question_1.count(0.5)\nyes_question_1 = all_question_1.count(1)\n\nlen_question_1 = all_question_1.length\n</code></pre>\n\n<p>I do not want to do it manually, so I was wondering if there is a way to dynamically change the _NUMBER from 1 to 28.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "puma", "puma-dev"], "answers": [{"tags": [], "owner": {"reputation": 285, "user_id": 11016237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIjD9.png?s=128&g=1", "display_name": "Svetlin Simonyan", "link": "https://stackoverflow.com/users/11016237/svetlin-simonyan"}, "is_accepted": true, "score": 4, "last_activity_date": 1549356907, "creation_date": 1549356907, "answer_id": 54530689, "question_id": 54524573, "link": "https://stackoverflow.com/questions/54524573/puma-workers-vs-separate-ec2-instances/54530689#54530689", "title": "puma workers vs separate ec2 instances", "body": "<p>In the context of Puma workers and threads are both used to achieve concurrency so that Puma can process requests without always waiting for the previous requests to be finished. A good configuration will need to find a good balance between the amount of workers and threads and several aspects of the deployed application need to be taken into consideration:</p>\n\n<ul>\n<li><p>Workers:</p>\n\n<ul>\n<li>Have bigger memory overhead since each forked process needs its own memory (this is mitigated on Linux due to (<a href=\"https://en.wikipedia.org/wiki/Copy-on-write\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Copy-on-write</a>) but is still a factor)</li>\n<li>Allow for parallelism when multiple cores are available. This is mostly a concern when processing requests is computationally heavy - which is something to avoid - if a request needs to perform some heavy computation it's a good idea to move it a background job using a library like (<a href=\"https://github.com/mperham/sidekiq\" rel=\"nofollow noreferrer\">https://github.com/mperham/sidekiq</a>)</li>\n<li>Can't be used on JRuby since it does not support forking</li>\n</ul></li>\n<li><p>Threads </p>\n\n<ul>\n<li>The configured amount of threads will be run for each worker process - meaning if you have <code>workers x</code> and <code>threads y</code> then you are getting a total of <code>x * y</code> request processing threads </li>\n<li>Share memory so they have smaller memory footprint (even though there are gotchas here as well: (<a href=\"https://www.speedshop.co/2017/12/04/malloc-doubles-ruby-memory.html\" rel=\"nofollow noreferrer\">https://www.speedshop.co/2017/12/04/malloc-doubles-ruby-memory.html</a>)</li>\n<li>On MRI, which is the default Ruby implementation, threads do not allow for executing Ruby code in parallel due to the GIL  - this should not be a big concern as the GIL is not locked during waiting on IO which is where a lot of the execution time will be spent - accessing the database, communicating with APIs, etc.</li>\n<li>On JRUBY threads can achieve parallelism.</li>\n<li>Can't be used if you app is not threadsafe. Rails is threadsafe itself but you don't have guarantees for any 3d party code the app depends on or the app code itself. If the app is not threadsafe the answer here is easy - don't use threads (meaning configure min and max threads to 1). Lacking threadsafety is a situation where multi worker configuration makes sense even on a single core instance.</li>\n<li>For any amount of threads you need to make sure there are enough database connections in the connection pool. This typically means setting the Rails connection pool size to the number of threads you run in a worker process.</li>\n</ul></li>\n</ul>\n\n<p>Comparing multiple workers to deploying to multiple EC2 instances misses a part of the picture: when using Puma with multiple workers there's a master Puma process that listens on a port and routes each request to an available worker process. When you have multiple EC2 instances then you need to take care of load balancing between them in some way - in the case of AWS that could be ELB or ALB. Deploying to multiple instances and load balancing are the right way to deploy any serious web application any way but that should not stop you utilizing instance resources better through workers and threads.</p>\n\n<p>I'd suggest experimenting with the configuration of workers and threads and starting at setting workers to the number of cores and threads to 10 - then make adjustments if you encounter problems with memory usage or under utilization of resources.</p>\n"}], "owner": {"reputation": 1086, "user_id": 4496764, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/882d84bff0cabaa9bb380fbd8df87921?s=128&d=identicon&r=PG&f=1", "display_name": "itwarilal", "link": "https://stackoverflow.com/users/4496764/itwarilal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 54530689, "answer_count": 1, "score": 1, "last_activity_date": 1549487578, "creation_date": 1549315791, "last_edit_date": 1549487578, "question_id": 54524573, "link": "https://stackoverflow.com/questions/54524573/puma-workers-vs-separate-ec2-instances", "title": "puma workers vs separate ec2 instances", "body": "<p>I am coming from Java/Tomcat stack and total newbie to RoR stack. I am trying to understand some of the concepts around puma configuration. I have read <a href=\"https://devcenter.heroku.com/articles/deploying-rails-applications-with-the-puma-web-server\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://github.com/puma/puma\" rel=\"nofollow noreferrer\">this</a> but I am still unclear on workers terminology.</p>\n\n<p>I understand that workers result in child process running puma. So essentially that allows you achieve parallelism, when using multi-core instance. But you can also do the same by launching as many ec2 single core instances?</p>\n\n<p>Also, would it ever make sense to set workers > 0, if the instance is not multi-core.</p>\n\n<p>Any info here would immensely help me. Thanks!</p>\n"}, {"tags": ["ruby", "jekyll", "jekyll-extensions"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 3277733, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9ab69e00c7a6725ffd222e95887b454f?s=128&d=identicon&r=PG&f=1", "display_name": "user3277733", "link": "https://stackoverflow.com/users/3277733/user3277733"}, "edited": false, "score": 0, "creation_date": 1550162438, "post_id": 54586728, "comment_id": 96177792, "body": "Doesn&#39;t google consider www.mywebsite.com/index.html and www.mywebsite.com different pages and indexes them twice?  I am using github pages and jekyll, so there is no htaccess."}, {"owner": {"reputation": 331, "user_id": 1781075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5f595604ec57c0c6e57d3564cbdbf99?s=128&d=identicon&r=PG", "display_name": "Arthur", "link": "https://stackoverflow.com/users/1781075/arthur"}, "reply_to_user": {"reputation": 115, "user_id": 3277733, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9ab69e00c7a6725ffd222e95887b454f?s=128&d=identicon&r=PG&f=1", "display_name": "user3277733", "link": "https://stackoverflow.com/users/3277733/user3277733"}, "edited": false, "score": 0, "creation_date": 1550243450, "post_id": 54586728, "comment_id": 96209777, "body": "I doubt Google indexes twice, but I can&#39;t be sure. I&#39;ve edited my answer to include an option for using Netlify as a workaround with GitHub Pages."}, {"owner": {"reputation": 115, "user_id": 3277733, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9ab69e00c7a6725ffd222e95887b454f?s=128&d=identicon&r=PG&f=1", "display_name": "user3277733", "link": "https://stackoverflow.com/users/3277733/user3277733"}, "edited": false, "score": 0, "creation_date": 1551296706, "post_id": 54586728, "comment_id": 96593058, "body": "Thanks. I&#39;m currently using Jekyll with Github pages, but I can&#39;t seem to get the redirect-from plugin to work on my homepage, it only works on sub pages. Enabling it for the homepage seems to send it in a loop where its trying to forward to itself non-stop. I also tried to use Cloudflare but that doesn&#39;t seem to do anything either."}, {"owner": {"reputation": 331, "user_id": 1781075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5f595604ec57c0c6e57d3564cbdbf99?s=128&d=identicon&r=PG", "display_name": "Arthur", "link": "https://stackoverflow.com/users/1781075/arthur"}, "reply_to_user": {"reputation": 115, "user_id": 3277733, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9ab69e00c7a6725ffd222e95887b454f?s=128&d=identicon&r=PG&f=1", "display_name": "user3277733", "link": "https://stackoverflow.com/users/3277733/user3277733"}, "edited": false, "score": 0, "creation_date": 1551456018, "post_id": 54586728, "comment_id": 96659234, "body": "Have you tried the Netlify option as described in my answer? As I explained, you don&#39;t need a redirect, you need a URL rewrite, which is a different thing and does not actually redirect the page."}, {"owner": {"reputation": 115, "user_id": 3277733, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9ab69e00c7a6725ffd222e95887b454f?s=128&d=identicon&r=PG&f=1", "display_name": "user3277733", "link": "https://stackoverflow.com/users/3277733/user3277733"}, "edited": false, "score": 0, "creation_date": 1551804552, "post_id": 54586728, "comment_id": 96770542, "body": "I am working on that now actually. Had to get rid of my cloudflare because that was messing with the DNS settings. Thanks for the suggestion!"}], "tags": [], "owner": {"reputation": 331, "user_id": 1781075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5f595604ec57c0c6e57d3564cbdbf99?s=128&d=identicon&r=PG", "display_name": "Arthur", "link": "https://stackoverflow.com/users/1781075/arthur"}, "is_accepted": false, "score": 0, "last_activity_date": 1550243389, "last_edit_date": 1550243389, "creation_date": 1549605331, "answer_id": 54586728, "question_id": 54524368, "link": "https://stackoverflow.com/questions/54524368/how-do-i-set-a-redirect-for-my-root-index-html-in-jekyll/54586728#54586728", "title": "How do I set a redirect for my root index.html in jekyll?", "body": "<p>You don't need a redirect, because <code>www.mywebsite.com/index.html</code> and <code>www.mywebsite.com</code> are the same page. (The browser just shows the <code>index</code> file by default if you go to <code>www.mywebsite.com</code>.)</p>\n\n<p>You need the browser to rewrite the URL, while remaining on the same page. You need to do this on the webserver.</p>\n\n<p><strong>.htaccess</strong></p>\n\n<p>If your site is on an Apache server and you have access to the server, you can use an <code>.htaccess</code> file to <a href=\"http://httpd.apache.org/docs/current/mod/mod_rewrite.html\" rel=\"nofollow noreferrer\">rewrite the URL</a> from <code>www.mywebsite.com/index.html</code> to <code>www.mywebsite.com</code>.</p>\n\n<p>There are online .htaccess generators <a href=\"http://www.visiospark.com/mod-rewrite-rule-generator/\" rel=\"nofollow noreferrer\">like this one</a> that help get the syntax right.</p>\n\n<p>There are similar methods for <a href=\"https://www.nginx.com/blog/creating-nginx-rewrite-rules/\" rel=\"nofollow noreferrer\">rewriting URLs on nginx</a> webservers.</p>\n\n<p><strong>GitHub Pages</strong></p>\n\n<p>If you're on a service like GitHub Pages, you can't use .htaccess. A free workaround is to use Netlify to deploy your site, because you can set up <a href=\"https://www.netlify.com/docs/redirects/\" rel=\"nofollow noreferrer\">redirects on Netlify</a>. Create a free account on Netlify and add a new site from GitHub there.</p>\n\n<p>In the root of your repo, create a <code>netlify.toml</code> file containing this:</p>\n\n<pre><code># Redirect /index.html to /\n[[redirects]]\n  from = \"/index.html\"\n  to = \"/\"\n</code></pre>\n\n<p>Netlify will now handle that redirect.</p>\n"}], "owner": {"reputation": 115, "user_id": 3277733, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9ab69e00c7a6725ffd222e95887b454f?s=128&d=identicon&r=PG&f=1", "display_name": "user3277733", "link": "https://stackoverflow.com/users/3277733/user3277733"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 733, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550243389, "creation_date": 1549314704, "question_id": 54524368, "link": "https://stackoverflow.com/questions/54524368/how-do-i-set-a-redirect-for-my-root-index-html-in-jekyll", "title": "How do I set a redirect for my root index.html in jekyll?", "body": "<p>I have jekyll-redirect-from plugin, but it only really works for pages that aren't my root homepage.</p>\n\n<p>For example, if a user types in www.mywebsite.com/index.html I want it to redirect and display the URL as www.mywebsite.com</p>\n\n<p>Everything I can find about this is focused on blog posts and other pages than the index. Has anyone had this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "yaml", "erb", "fixtures"], "comments": [{"owner": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "edited": false, "score": 0, "creation_date": 1549315250, "post_id": 54524289, "comment_id": 95851382, "body": "but where do you reference to other?"}, {"owner": {"reputation": 523, "user_id": 145725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4d069f8600380502924bf168a7e51c3?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/145725/matthew"}, "reply_to_user": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "edited": false, "score": 0, "creation_date": 1549674431, "post_id": 54524289, "comment_id": 96000597, "body": "I repeat (reference) &quot;location&quot; and &quot;number&quot; In the URL"}], "owner": {"reputation": 523, "user_id": 145725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4d069f8600380502924bf168a7e51c3?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/145725/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1549314180, "creation_date": 1549314180, "question_id": 54524289, "link": "https://stackoverflow.com/questions/54524289/how-can-i-reference-another-field-in-a-yaml-fixture-possibly-using-erb", "title": "How can I reference another field in a YAML fixture (possibly using ERB)?", "body": "<p>I'm creating YAML fixtures for a Rails app and the values of several keys are linked. Is there a way to dynamically set these values based on a previous value?</p>\n\n<p>I've looked into using YAML anchors and references but from what I understand they only work for whole nodes (example 2 below).</p>\n\n<p>I checked the <a href=\"https://api.rubyonrails.org/v2.3.8/classes/Fixtures.html\" rel=\"nofollow noreferrer\">Fixtures documentation</a> but it seems like I can only reference a fixture ID (with <code>Fixtures.identify(:reginald)</code>), not a specific value.</p>\n\n<p>I assumed ERB would be the way to go but I can't figure out how to reference the other YAML values from Ruby. To make it work I had to create a block and pass in variables (example 3 below).</p>\n\n<pre><code># events.yml\n\n# Example 1 - what I currently have. It works but there is a fair bit of repetition for ~25 entries\nevent1:\n  location: paris\n  number: 34\n  date: 2005-05-21\n  url: \"http://www.example.com/paris/subfolder/events?eventNumber=34\n\n# Example 2 - I was hoping to be able to reference previous values by key... anchors would work if they could be interpolated somehow:\nevent2:\n  location: &amp;location london\n  number: &amp;number 17\n  date: 2008-02-09\n  url: \"http://www.example.com/{{*location}}/subfolder/events?eventNumber={{*number}}\n\n# Example 3 - This is the best I could come up with but I don't think it's an improvement to have ~25 of these blocks\n&lt;% ['paris', 46].map do |location, number| %&gt;\nevent3:\n  location: &lt;%= location %&gt;\n  number: &lt;%= number %&gt;\n  date: 2005-08-13\n  url: \"http://www.example.com/&lt;%= location %&gt;/subfolder/events?eventNumber=&lt;%= number %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Are there any other approaches I'm missing?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "edited": false, "score": 0, "creation_date": 1549313263, "post_id": 54523594, "comment_id": 95850617, "body": "It&#39;s difficult to help without knowing what gem you&#39;re using, and what error you&#39;re getting. But assuming you&#39;re using <a href=\"https://github.com/net-ssh/net-sftp/tree/master/lib/net/sftp\" rel=\"nofollow noreferrer\">github.com/net-ssh/net-sftp/tree/master/lib/net/sftp</a> it looks like <code>upload</code> is not a defined function, and you&#39;ll need to use <code>upload!</code>"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 10917688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XVQsYFDBdDs/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYKX1eim-sHpmsAahasEDgMLegwuQ/mo/photo.jpg?sz=128", "display_name": "Julie Rain", "link": "https://stackoverflow.com/users/10917688/julie-rain"}, "is_accepted": false, "score": 1, "last_activity_date": 1549379141, "creation_date": 1549379141, "answer_id": 54537344, "question_id": 54523594, "link": "https://stackoverflow.com/questions/54523594/upload-files-from-local-directory-to-sftp-using-ruby/54537344#54537344", "title": "Upload files from local directory to SFTP using Ruby", "body": "<p>Thank you Kennycoc!  That upload! was definitely helpful.  Also, sftp.close() should be deleted for sftp.  The SFTP connection automatically close. This is needed for FTP I found out, but not for SFTP.</p>\n\n<p>Thanks!</p>\n\n<p>Finalized Version:</p>\n\n<pre><code>files = Dir.entries(outdir)\nNet::SFTP.start(hostname, username, :password=&gt;password) do |sftp|\nfor filename in files\n     #puts files\n      puts \"Browsing files...\" \n      puts \"File: #{filename}\" \n     #puts new_filename\n\n####### replacing , for | ########\n\n     if /#{uid}_test_[0-9]{8}_[0-9]{8}.txt$/ =~ filename\n     file = \"#{outdir}\\\\#{filename}\"\n     puts \"SFTPing #{file}\"\n     sftp.upload!(file) \n     puts \"SFTP Complete for file #{file}\"\n     puts \"Cleanup\"\n     puts \"Deleting #{file}.\"\n     File.delete(file)\n     puts \"Files were deleted.\" \n     end\nend\n#puts \"Closing SFTP connection...\" \n#sftp.close()\nputs \"SFTP connection closed.\"\nend\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10917688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XVQsYFDBdDs/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYKX1eim-sHpmsAahasEDgMLegwuQ/mo/photo.jpg?sz=128", "display_name": "Julie Rain", "link": "https://stackoverflow.com/users/10917688/julie-rain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 776, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549379141, "creation_date": 1549310840, "question_id": 54523594, "link": "https://stackoverflow.com/questions/54523594/upload-files-from-local-directory-to-sftp-using-ruby", "title": "Upload files from local directory to SFTP using Ruby", "body": "<p>For some reason SFTP upload in Ruby (copy files from local directory to SFTP server) doesn't seem to work. I'm currently using Ruby 2.5.3. I would really appreciate any ideas :</p>\n\n<p>My code below: </p>\n\n<pre><code>require 'net/ssh'\nrequire 'net/sftp'\n\nserver = 'sftp.secure.net'\nusername = '123456'\npassword = \"Mypassword*\"\nuid = '123456'\n\nfiles = Dir.entries(outdir)\nNet::SFTP.start(server, username, :password=&gt;password) do |sftp|\n  for filename in files\n     #puts files\n      puts \"Browsing files...\" \n      puts \"File: #{filename}\" \n     #puts new_filename\n\n####### replacing , for | ########\n\n     if /#{uid}_test_[0-9]{8}_[0-9]{8}.txt$/ =~ filename\n     file = \"#{outdir}\\\\#{filename}\"\n     puts \"SFTPing #{file}\"\n     sftp.upload(file) \n     puts \"SFTP Complete for file #{file}\"\n     puts \"Cleanup\"\n     puts \"Deleting #{file}.\"\n     File.delete(file)\n     puts \"Files were deleted.\" \n     end\n  end\nputs \"Closing SFTP connection...\" \nsftp.close\nputs \"SFTP connection closed.\"\nend\n</code></pre>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "raty"], "comments": [{"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1549359890, "post_id": 54523430, "comment_id": 95864524, "body": "I think it might be caused by your using id #start-rating. Since ids are supposed to be unique on the page, Raty only finds the first one."}, {"owner": {"reputation": 105, "user_id": 9912665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3WVb.jpg?s=128&g=1", "display_name": "Kowa JiaLiang", "link": "https://stackoverflow.com/users/9912665/kowa-jialiang"}, "reply_to_user": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1549367796, "post_id": 54523430, "comment_id": 95869126, "body": "Hi @EJ2015 i noticed that too, you have any ways recommend?"}, {"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1549401311, "post_id": 54523430, "comment_id": 95887354, "body": "Why not use class instead? You can use JQuery <code>.children()</code> method to find the correct target: <code>$(this).children(&quot;.rating_start&quot;).first()</code>"}], "owner": {"reputation": 105, "user_id": 9912665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3WVb.jpg?s=128&g=1", "display_name": "Kowa JiaLiang", "link": "https://stackoverflow.com/users/9912665/kowa-jialiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549358708, "creation_date": 1549310117, "last_edit_date": 1549358708, "question_id": 54523430, "link": "https://stackoverflow.com/questions/54523430/rails-5-star-rating-jquery-plugin-raty-only-showing-star-in-first-form-in-table", "title": "Rails 5 Star Rating jQuery Plugin Raty only showing star in first form in table", "body": "<p>Hi guys I'm using Star Rating jQuery Plugin Raty to do some review / rating things. For now I'm having a list of data that need to be review, and then the ways to review would be in a boostrap modal box. But however, the rating star are only appearing in the first form of my list, and the star won't show up for the rest of the form. The second form's star will be shown only after the first form's is review and submitted. Example are pictures below.</p>\n\n<p>This is the first form of the list. The stars are showing and able to give rating.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hOUCb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hOUCb.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then following second form in the list, the stars are disappearing from the form, it will be shown only the first form are reviews and submitted.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XX1cE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XX1cE.jpg\" alt=\"enter image description here\"></a> </p>\n\n<p>And below are the final result. But currently I'm able to rating one by one from the top, i wish that i could rating randomly.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nX1M7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nX1M7.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Below are my codes for rendering the list in table and modal box.</p>\n\n<pre><code>&lt;% @appointment.approve_applicants.each_with_index do |applicant, index| %&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;%= index + 1 %&gt;&lt;/td&gt;\n&lt;td&gt;&lt;%= link_to applicant.user.fullname, applicant.user %&gt;&lt;/td&gt;\n&lt;td&gt;&lt;%= link_to \"Reviews\", applicant.build_review, \"data-toggle\" =&gt; \"modal\", \"data-target\" =&gt; \"#detail#{applicant.id}\" %&gt;&lt;/td&gt;\n&lt;td&gt;&lt;/td&gt;\n\n&lt;!--Modal--&gt;\n&lt;div class=\"modal fade\" id=\"detail&lt;%= applicant.id %&gt;\" role=\"dialog\"&gt;\n  &lt;div class=\"modal-dialog\"&gt;\n    &lt;!--Modal content--&gt;\n    &lt;div class=\"modal-content\"&gt;\n      &lt;div class=\"modal-header\"&gt;\n        &lt;button type=\"button\" class=\"close close_book_detail\" data-dismiss=\"modal\"&gt;&amp;times;&lt;/button&gt;\n        &lt;%= form_for(Review.new) do |f| %&gt;\n          &lt;%= render 'shared/error_messages', object: f.object %&gt;\n          Rating for user &lt;%= applicant.user.fullname %&gt;\n          &lt;div class=\"form-group row\"&gt;\n            &lt;%= f.label :rating, class: 'col-sm-2 form-control-label' %&gt;\n            &lt;div class=\"col-sm-6\" id='star-rating'&gt;\n              &lt;%=hidden_field_tag \"review[rating]\", '', id: \"rating_star\" %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n          &lt;%= f.label :comment %&gt;\n          &lt;%= f.text_area :comment, placeholder: \"Please enter comment here.\" %&gt;\n          &lt;%= f.submit \"Save changes\", class: \"btn btn-primary\" %&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Then below are the javascripts for the jQuery rating stars plugin.</p>\n\n<pre><code>&lt;script&gt;\n$('#star-rating').raty({\n    path: '/assets',\n    target     : '#rating_star',\n    targetType : 'score',\n    targetKeep : true\n});\n&lt;/script&gt;\n\n&lt;script&gt;\n$('.star-rating-show').raty({\n    path: '/assets/',\n    readOnly: true,\n    score: function() {\n        return $(this).attr('data-score');\n    }\n});\n&lt;/script&gt;\n</code></pre>\n\n<p>Thank you in advance for helping me!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "edited": false, "score": 0, "creation_date": 1549312379, "post_id": 54523825, "comment_id": 95850286, "body": "I&#39;m receiving  <b>Comment Create (2.0ms)  INSERT INTO &quot;comments&quot; (&quot;commentable_id&quot;, &quot;commentable_type&quot;, &quot;body&quot;, &quot;user_id&quot;, &quot;lft&quot;, &quot;rgt&quot;, &quot;created_at&quot;, &quot;updated_at&quot;) VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING &quot;id&quot;  [[&quot;commentable_id&quot;, 3], [&quot;commentable_type&quot;, &quot;Post&quot;], [&quot;body&quot;, &quot;Ok Try again!&quot;], [&quot;user_id&quot;, 3], [&quot;lft&quot;, 23], [&quot;rgt&quot;, 24],    NoMethodError (undefined method `primary_key&#39; for Integer:Class):</b>"}, {"owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "edited": false, "score": 0, "creation_date": 1549313927, "post_id": 54523825, "comment_id": 95850854, "body": "I still receive the same error <b>NoMethodError (undefined method `primary_key&#39; for String:Class):</b> I believe its coming from <b>[notifiable: @comment...]</b>"}, {"owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "edited": false, "score": 0, "creation_date": 1549313971, "post_id": 54523825, "comment_id": 95850872, "body": "This notification works without issue. <b>Notification.create(recipient: user, actor: current_user, action: &quot;followed you&quot;, notifiable: current_user.follow(user))</b>"}], "tags": [], "owner": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1549340599, "last_edit_date": 1549340599, "creation_date": 1549311872, "answer_id": 54523825, "question_id": 54523384, "link": "https://stackoverflow.com/questions/54523384/why-am-i-receiving-activerecordassociationtypemismatch-while-passing-the-user/54523825#54523825", "title": "Why am I receiving ActiveRecord::AssociationTypeMismatch while passing the User object to the Notification model?", "body": "<p>Use</p>\n\n<pre><code>Notification.create(recipient: @comment.commentable.user, actor_id: current_user.id, action: \"commented on your Career Insight\", notifiable: @comment.user, content: @comment.body.truncate(50).to_s)\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549382061, "creation_date": 1549309922, "last_edit_date": 1549382061, "question_id": 54523384, "link": "https://stackoverflow.com/questions/54523384/why-am-i-receiving-activerecordassociationtypemismatch-while-passing-the-user", "title": "Why am I receiving ActiveRecord::AssociationTypeMismatch while passing the User object to the Notification model?", "body": "<p>When I pass the comment object with parameters to the Notification.create() object, I receive ActiveRecord::AssociationTypeMismatch for User. Its stating that I passed in an instance of Integer (which is possibly the user id) instead of the User object itself. I don't know how I should approach getting the user object from the comment object and passing it to the recipient column. I'm using the gem called <strong>acts_as_commentable_with_threading</strong>. How can pass the correct instance of the User object to the Notification? </p>\n\n<p>I tried to retrieve the user by chaining through comment.commentable.user. Which returned the target User. But, for some reason, its stating that I cannot use the object since its a type of Integer and not User. The error is below.</p>\n\n<pre><code>Comment Load (1.0ms)  SELECT  \"comments\".* FROM \"comments\" WHERE \"comments\".\"id\" = $1 LIMIT $2 FOR UPDATE  [[\"id\", 16], [\"LIMIT\", 1]]\n  Comment Create (2.0ms)  INSERT INTO \"comments\" (\"commentable_id\", \"commentable_type\", \"body\", \"user_id\", \"lft\", \"rgt\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING \"id\"  [[\"commentable_id\", 3], [\"commentable_type\", \"Post\"], [\"body\", \"Damn\"], [\"user_id\", 2], [\"lft\", 21], [\"rgt\", 22], [\"created_at\", \"2019-02-04 18:23:47.285528\"], [\"updated_at\", \"2019-02-04 18:23:47.285528\"]]\n   (1.0ms)  COMMIT\nRedirected to http://127.0.0.1:3000/posts/qQ7JeRcQxGXg\n  User Load (1.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT $2  [[\"id\", 3], [\"LIMIT\", 1]]\nCompleted 500 Internal Server Error in 6196ms (ActiveRecord: 1466.1ms)\n\n\n\nActiveRecord::AssociationTypeMismatch (User(#211252000) expected, got 2 which is an instance of Integer(#3523260)):\n\napp/controllers/comments_controller.rb:17:in `create'\nProcessing by ExceptionHandler::ExceptionsController#show as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"KnLViXrCG/67gbUFTQjFMq6eIt7AKvjG4dRgD0JSoPOCOfHqU0n0lVB9l3+lyAc0B+G3mgZ6dv8cG0v9LTvPuw==\", \"comment\"=&gt;{\"commentable_id\"=&gt;\"3\", \"commentable_type\"=&gt;\"Post\", \"body\"=&gt;\"Damn\"}, \"commit\"=&gt;\"Comment\"}\nCompleted 500 Internal Server Error in 285ms (ActiveRecord: 0.0ms)\n</code></pre>\n\n<p><strong>comments_controller.rb</strong></p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  before_action :authenticate_user!\n\n  def create\n    commentable = commentable_type.constantize.find(commentable_id)\n    @comment = Comment.build_from(commentable, current_user.id, body)\n\n    respond_to do |format|\n      if @comment.save\n        make_child_comment\n        format.html {redirect_back(fallback_location: post_path(@comment))}\n        format.js\n      else\n        format.html {render :action =&gt; :new}\n      end\n    end\n    Notification.create(recipient: @comment.commentable.user, actor: current_user.id, action: \"commented on your Post\", notifiable: @comment.commentable.id, content: @comment.body.truncate(50).to_s)\n#GenericCommentNotificationJob.perform_later(@comment.commentable.user, current_user.id, @comment, body)\n  end\n\n  def destroy\n    @comment = Comment.find_by_id params[:id]\n\n    respond_to do |format|\n      if @comment.destroy\n        format.html {redirect_to @comment.commentable}\n      else\n        format.html {redirect_to @comment.commentable, notice: t('error')}\n      end\n    end\n  end\n\n  private\n\n  def comment_params\n    params.require(:comment).permit(:body, :commentable_id, :commentable_type, :comment_id)\n  end\n\n  def commentable_type\n    comment_params[:commentable_type]\n  end\n\n  def commentable_id\n    comment_params[:commentable_id]\n  end\n\n  def comment_id\n    comment_params[:comment_id]\n  end\n\n  def body\n    comment_params[:body]\n  end\n\n  def make_child_comment\n    return \"\" if comment_id.blank?\n\n    parent_comment = Comment.find(comment_id)\n    @comment.move_to_child_of(parent_comment)\n  end\nend\n</code></pre>\n\n<p><strong>comments schema</strong></p>\n\n<pre><code>  create_table \"comments\", force: :cascade do |t|\n    t.integer \"commentable_id\"\n    t.string \"commentable_type\"\n    t.string \"title\"\n    t.text \"body\"\n    t.string \"subject\"\n    t.integer \"user_id\", null: false\n    t.integer \"parent_id\"\n    t.integer \"lft\"\n    t.integer \"rgt\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.bigint \"post_id\"\n    t.index [\"post_id\"], name: \"index_comments_on_post_id\"\n    t.index [\"commentable_id\", \"commentable_type\"], name: \"index_comments_on_commentable_id_and_commentable_type\"\n    t.index [\"user_id\"], name: \"index_comments_on_user_id\"\n  end\n</code></pre>\n\n<p><strong>comment.rb</strong></p>\n\n<pre><code>class Comment &lt; ActiveRecord::Base\n  acts_as_nested_set :scope =&gt; [:commentable_id, :commentable_type]\n  validates :body, :presence =&gt; true\n  validates :user, :presence =&gt; true\n\n  # NOTE: install the acts_as_votable plugin if you\n  # want user to like on the quality of comments.\n  acts_as_votable\n\n  belongs_to :commentable, :polymorphic =&gt; true\n\n  # NOTE: Comments belong to a user\n  belongs_to :user\n\n  # Helper class method that allows you to build a comments\n  # by passing a commentable object, a user_id, and comments text\n  # example in readme\n  def self.build_from(obj, user_id, comment)\n    new \\\n      :commentable =&gt; obj,\n      :body =&gt; comment,\n      :user_id =&gt; user_id\n  end\n\n  #helper method to check if a comments has children\n  def has_children?\n    self.children.any?\n  end\n\n  # Helper class method to lookup all comments assigned\n  # to all commentable types for a given user.\n  scope :find_comments_by_user, lambda {|user|\n    where(:user_id =&gt; user.id).order('created_at DESC')\n  }\n\n  # Helper class method to look up all comments for\n  # commentable class name and commentable id.\n  scope :find_comments_for_commentable, lambda {|commentable_str, commentable_id|\n    where(:commentable_type =&gt; commentable_str.to_s, :commentable_id =&gt; commentable_id).order('created_at DESC')\n  }\n\n  # Helper class method to look up a commentable object\n  # given the commentable class name and id\n  def self.find_commentable(commentable_str, commentable_id)\n    commentable_str.constantize.find(commentable_id)\n  end\nend\n</code></pre>\n\n<p><strong>notification.rb</strong></p>\n\n<pre><code>class Notification &lt; ApplicationRecord\n  belongs_to :recipient, class_name: \"User\"\n  belongs_to :actor, class_name: \"User\"\n  belongs_to :notifiable, polymorphic: true\n  scope :unread, -&gt; {where(read_at: nil)}\nend\n</code></pre>\n\n<p><strong>notification schema</strong></p>\n\n<pre><code>  create_table \"notifications\", force: :cascade do |t|\n    t.integer \"recipient_id\"\n    t.integer \"actor_id\"\n    t.datetime \"read_at\"\n    t.string \"action\"\n    t.integer \"notifiable_id\"\n    t.string \"notifiable_type\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.string \"content\"\n  end\n</code></pre>\n\n<p><strong>Actual Results</strong>: When a user tries to create a comment, the notification fails to create itself, due to an active record type mismatch for the user object.</p>\n\n<p><strong>Expected Results</strong>: A user creates a comment, and then the notification is created after comment has successfully committed.</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 1, "last_activity_date": 1549313095, "creation_date": 1549313095, "answer_id": 54524051, "question_id": 54523304, "link": "https://stackoverflow.com/questions/54523304/how-to-load-environment-variables-to-ruby-app-spec-using-rspec-and-env/54524051#54524051", "title": "How to load environment variables to ruby app spec using Rspec and .env", "body": "<p>In your test helper file, you can add:</p>\n\n<pre><code>require 'dotenv'\nDotenv.load('.env.test.local')\n</code></pre>\n\n<p>This is on the <a href=\"https://github.com/bkeepers/dotenv\" rel=\"nofollow noreferrer\">dotenv readme</a></p>\n"}, {"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 2, "last_activity_date": 1549354795, "creation_date": 1549354795, "answer_id": 54530205, "question_id": 54523304, "link": "https://stackoverflow.com/questions/54523304/how-to-load-environment-variables-to-ruby-app-spec-using-rspec-and-env/54530205#54530205", "title": "How to load environment variables to ruby app spec using Rspec and .env", "body": "<p>Instead of using <code>dotenv</code> for this, you could stub <code>ENV</code> keys in your tests:</p>\n\n<pre><code>describe Foo do\n  before do\n    allow(ENV).to receive(:[]).with('BOX_ID').and_return(\"1234\")\n  end\n\n  it 'flips the environment variable value' do\n    expect(subject.flip).to eq '4321'\n  end\nend\n</code></pre>\n\n<p>Or even stub the whole <code>ENV</code>:</p>\n\n<pre><code>describe Foo do\n  let(:env) do\n     { 'BOX_ID' =&gt; '1234' }\n  end\n\n  before do\n    stub_const(\"ENV\", env)\n  end\n\n  it 'flips the environment variable value' do\n    expect(subject.flip).to eq '4321'\n  end\nend\n</code></pre>\n\n<p>I find this more reliable and easier to maintain than a separate file.</p>\n"}], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 0, "accepted_answer_id": 54524051, "answer_count": 2, "score": 0, "last_activity_date": 1549354795, "creation_date": 1549309586, "last_edit_date": 1549354415, "question_id": 54523304, "link": "https://stackoverflow.com/questions/54523304/how-to-load-environment-variables-to-ruby-app-spec-using-rspec-and-env", "title": "How to load environment variables to ruby app spec using Rspec and .env", "body": "<p>I'm currently working on writing tests for a Ruby class. The class makes use of environment variables.</p>\n\n<p>When I run the <code>spec</code> with <code>rspec spec/box_api.rb</code> I get the following error:</p>\n\n<pre><code>Failures:\n\n  1) BoxApi#client success Create Boxr::Client object\n     Failure/Error: subject { BoxApi.new }\n\n     KeyError:\n       key not found: \"BOX_USER_ID\"\n     # ./src/clients/box_api.rb:8:in `fetch'\n     # ./src/clients/box_api.rb:8:in `initialize'\n     # ./spec/box_api.rb:14:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>It's not reading the environment variable.</p>\n\n<p>I tried creating the <code>.env.test.local</code> file within spec folder without success. I'm using <code>dotenv</code> gem:</p>\n\n<pre><code># Manage environment with .env file\ngem 'dotenv', '~&gt; 2.1.1'\n</code></pre>\n\n<p>How can I go about using the environment variables in test?</p>\n"}, {"tags": ["ruby", "junit", "cucumber", "allure"], "answers": [{"tags": [], "owner": {"reputation": 932, "user_id": 4284320, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jr3QDDvs_7Y/AAAAAAAAAAI/AAAAAAAAADE/-pfSnZJDTHQ/photo.jpg?sz=128", "display_name": "Sawyer Merchant", "link": "https://stackoverflow.com/users/4284320/sawyer-merchant"}, "is_accepted": false, "score": 0, "last_activity_date": 1549920783, "creation_date": 1549920783, "answer_id": 54639489, "question_id": 54523155, "link": "https://stackoverflow.com/questions/54523155/handle-flaky-tests-when-outputting-junit-from-ruby-cucumber-retry-breaking-the/54639489#54639489", "title": "Handle flaky tests when outputting junit from ruby cucumber (retry breaking the pipeline)", "body": "<p>My quick and dirty patch for now is to patch the jUnit formatter to only increment the failure count like below. This only works for a single retry. When I have more time, I will see if there is a variable that can be checked to know if there are retries remaining for a test case.</p>\n\n<pre><code>def build_testcase(result, scenario_designation, output, test_case)\n  duration = Cucumber::Formatter::ResultBuilder.new(result).test_case_duration\n  @current_feature_data[:time] += duration\n  classname = @current_feature_data[:feature].name\n  name = scenario_designation\n\n  @current_feature_data[:builder].testcase(:classname =&gt; classname, :name =&gt; name, :time =&gt; format('%.6f', duration)) do\n    if !result.passed? &amp;&amp; result.ok?(@config.strict)\n      @current_feature_data[:builder].skipped\n      @current_feature_data[:skipped] += 1\n    elsif !result.passed? &amp;&amp; !same_feature_as_previous_test_case?(test_case.feature)\n      status = result.to_sym\n      exception = get_backtrace_object(result)\n      @current_feature_data[:builder].failure(:message =&gt; \"#{status} #{name}\", :type =&gt; status) do\n        @current_feature_data[:builder].cdata! output\n        @current_feature_data[:builder].cdata!(format_exception(exception)) if exception\n      end\n      @current_feature_data[:failures] += 1 \n    end\n    @current_feature_data[:builder].tag!('system-out') do\n      @current_feature_data[:builder].cdata! strip_control_chars(@interceptedout.buffer_string)\n    end\n    @current_feature_data[:builder].tag!('system-err') do\n      @current_feature_data[:builder].cdata! strip_control_chars(@interceptederr.buffer_string)\n    end\n  end\n  @current_feature_data[:tests] += 1\nend\n</code></pre>\n"}], "owner": {"reputation": 932, "user_id": 4284320, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jr3QDDvs_7Y/AAAAAAAAAAI/AAAAAAAAADE/-pfSnZJDTHQ/photo.jpg?sz=128", "display_name": "Sawyer Merchant", "link": "https://stackoverflow.com/users/4284320/sawyer-merchant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549920783, "creation_date": 1549308974, "last_edit_date": 1549459281, "question_id": 54523155, "link": "https://stackoverflow.com/questions/54523155/handle-flaky-tests-when-outputting-junit-from-ruby-cucumber-retry-breaking-the", "title": "Handle flaky tests when outputting junit from ruby cucumber (retry breaking the pipeline)", "body": "<p>I am outputting cucumber test results with two format flags:</p>\n\n<p>--format junit<br>\n--format AllureCucumber::Formatter</p>\n\n<p>The first is for CICD stage gates (100% passing tests in one environment triggers deployment to the next). The second is to output html dashboards.</p>\n\n<p>I am additionally using the flag: <code>--retry 2</code> because a couple of my tests are flaky (may fail once, but pass the second time around).</p>\n\n<p>The Allure format handles reties gracefully. The problem is that the junit formatted xml handles flaky tests as failures.</p>\n\n<p>Is there a workaround to tell xml to register 0 failures if all tests eventually pass?</p>\n\n<p>I have found reference to this issue <a href=\"https://github.com/cucumber/cucumber-ruby/issues/1333\" rel=\"nofollow noreferrer\">here</a>.<br>\nLooking at <a href=\"https://stackoverflow.com/questions/39538400/how-do-you-label-flaky-tests-using-junit\">this thread</a>, <a href=\"https://stackoverflow.com/questions/37918522/rerun-flaky-junit-test-in-case-they-failed\">this thread</a>, and the jUnit docs, I don't think that retries/flaky get accounted for and I may need to patch the ruby-cucumber gem's formatter to just ignore the first failure when outputting jUnit.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "if-statement"], "comments": [{"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1549308217, "post_id": 54522924, "comment_id": 95848470, "body": "@user.groups.lenght &gt; 1 is the answer"}, {"owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 1, "creation_date": 1549308609, "post_id": 54522924, "comment_id": 95848647, "body": "While the logic is indeed a little bit off, there seems to be another issue going on here, because the error is not what I&#39;d expect for that statement... Why is ` 1` being parsed as an identifier, and not a numeric literal?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1549313351, "post_id": 54522924, "comment_id": 95850654, "body": "@Kick, that would raise a no-method exception."}], "answers": [{"tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 3, "last_activity_date": 1549308905, "last_edit_date": 1549308905, "creation_date": 1549308338, "answer_id": 54523016, "question_id": 54522924, "link": "https://stackoverflow.com/questions/54522924/if-x-or-y-condition-in-rails/54523016#54523016", "title": "If X or Y condition in rails", "body": "<pre><code>&lt;%=  \"d\u00e9bat\".pluralize(@user.groups.length) %&gt;\n</code></pre>\n\n<p><a href=\"https://apidock.com/rails/ActionView/Helpers/TextHelper/pluralize\" rel=\"nofollow noreferrer\"> pluralize</a> Returns the plural form of the word in the string with respect of <code>count</code> optional parameter</p>\n\n<blockquote>\n<pre><code>  'd\u00e9bat'.pluralize            # =&gt; \"d\u00e9bats\"\n  'd\u00e9bat'.pluralize(1)         # =&gt; \"d\u00e9bat\"\n  'd\u00e9bat'.pluralize(2)         # =&gt; \"d\u00e9bats\"\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1549309218, "post_id": 54523020, "comment_id": 95848922, "body": "I fail to see how <code>&gt; 1</code> is equal to the originally intended check."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1549309266, "post_id": 54523020, "comment_id": 95848946, "body": "The equivalent condition is <code>&lt; 2</code>, not <code>&gt; 1</code> unless you swap the contents"}, {"owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1549309409, "post_id": 54523020, "comment_id": 95849005, "body": "While this fixes the logic bug, it doesn&#39;t explain why an exception was raised. Any idea why ruby was trying to parse ` 1` as a variable/method and not a numeric literal?"}], "tags": [], "owner": {"reputation": 122, "user_id": 5728516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9468569deef006e5423a42d4c31859?s=128&d=identicon&r=PG&f=1", "display_name": "Chandra Sekhar", "link": "https://stackoverflow.com/users/5728516/chandra-sekhar"}, "is_accepted": false, "score": -1, "last_activity_date": 1549310265, "last_edit_date": 1549310265, "creation_date": 1549308373, "answer_id": 54523020, "question_id": 54522924, "link": "https://stackoverflow.com/questions/54522924/if-x-or-y-condition-in-rails/54523020#54523020", "title": "If X or Y condition in rails", "body": "<p>The OR operator needs to be used as below:</p>\n\n<pre><code>&lt;% if @user.groups.length == 0 || @user.groups.length == 1 %&gt;\n   &lt;p&gt; d\u00e9bat&lt;/p&gt;&lt;% else %&gt;&lt;p&gt; d\u00e9bats&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Alternatively, you can use this way for checking the same condition</p>\n\n<pre><code>&lt;% if @user.groups.length &lt; 2 %&gt;\n   &lt;p&gt; d\u00e9bat&lt;/p&gt;&lt;% else %&gt;&lt;p&gt; d\u00e9bats&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 318, "user_id": 8398293, "user_type": "registered", "profile_image": "https://graph.facebook.com/732236736985262/picture?type=large", "display_name": "Pierre Laburthe", "link": "https://stackoverflow.com/users/8398293/pierre-laburthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 54523016, "answer_count": 2, "score": -2, "last_activity_date": 1549310265, "creation_date": 1549308012, "question_id": 54522924, "link": "https://stackoverflow.com/questions/54522924/if-x-or-y-condition-in-rails", "title": "If X or Y condition in rails", "body": "<p>I am beginning with rails and I'm trying to create an if condition. </p>\n\n<p>I want to add a S to a word if its length is greater than 1. </p>\n\n<pre><code>&lt;% if @user.groups.length == 0 ||\u00a01 %&gt;\n   &lt;p&gt; d\u00e9bat&lt;/p&gt;&lt;% else %&gt;&lt;p&gt; d\u00e9bats&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here is the result : \nundefined local variable or method ` 1' for #&lt;#:0x00007ffbb1c47048></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "openssl"], "owner": {"reputation": 2718, "user_id": 1490262, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/afc8915df9cbb5c119ea0057d17fabd2?s=128&d=identicon&r=PG", "display_name": "Peter P.", "link": "https://stackoverflow.com/users/1490262/peter-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 387, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1549298801, "creation_date": 1549298801, "question_id": 54520681, "link": "https://stackoverflow.com/questions/54520681/openssl-is-erroring-in-rails-but-not-ruby", "title": "OpenSSL is erroring in Rails but not Ruby", "body": "<p>When trying to connect via SSL in Rails, we get the error: </p>\n\n<pre><code>OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=error: certificate verify failed (unable to get local issuer certificate)\n</code></pre>\n\n<p>There are a number of other StackOverflow articles that cover the same error but the symptom that we are experiencing is quite different. </p>\n\n<p>When we issue a test command in Ruby, it works, but when we issue the same command booted into a Rails environment, we get the above error. </p>\n\n<p>Here is sample with output (as recommended by bundler.io: <a href=\"https://bundler.io/v1.16/guides/rubygems_tls_ssl_troubleshooting_guide.html#troubleshooting-certificate-errors\" rel=\"nofollow noreferrer\">https://bundler.io/v1.16/guides/rubygems_tls_ssl_troubleshooting_guide.html#troubleshooting-certificate-errors</a>) </p>\n\n<p>ruby:</p>\n\n<pre><code>oot@376dd015bcee:/usr/src/app# ruby -ropen-uri -e 'eval open(\"https://git.io/vQhWq\").read'\nHere's your Ruby and OpenSSL environment:\n\nRuby:           2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux]\nRubyGems:       2.7.7\nBundler:        1.16.6\nCompiled with:  OpenSSL 1.1.0f  25 May 2017\nLoaded version: OpenSSL 1.1.0f  25 May 2017\nSSL_CERT_FILE:  /usr/lib/ssl/cert.pem\nSSL_CERT_DIR:   /usr/lib/ssl/certs\n\nWith that out of the way, let's see if you can connect to rubygems.org...\n\nBundler connection to rubygems.org:       success \u2705\nRubyGems connection to rubygems.org:      success \u2705\nRuby net/http connection to rubygems.org: success \u2705\n\nHooray! This Ruby can connect to rubygems.org. You are all set to use Bundler and RubyGems. \ud83d\udc4c\n(eval):136: warning: constant OpenSSL::SSL::SSLContext::METHODS is deprecated\n</code></pre>\n\n<p>rails:</p>\n\n<pre><code>root@376dd015bcee:/usr/src/app# RAILS_ENV=production bundle exec rails r 'eval open(\"https://git.io/vQhWq\").read'\nDEPRECATION WARNING: alias_method_chain is deprecated. Please, use Module#prepend instead. From module, you can access the original method using super. (called from require at /usr/local/lib/ruby/gems/2.5.0/gems/bundler-1.16.6/lib/bundler/runtime.rb:81)\nno value for ELK DNS -\nExpected string default value for '--serializer'; got true (boolean)\nHere's your Ruby and OpenSSL environment:\n\nRuby:           2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux]\nRubyGems:       2.7.7\nBundler:        1.16.6\nCompiled with:  OpenSSL 1.1.0f  25 May 2017\nLoaded version: OpenSSL 1.1.0f  25 May 2017\nSSL_CERT_FILE:  /usr/lib/ssl/cert.pem\nSSL_CERT_DIR:   /usr/lib/ssl/certs\n\nWith that out of the way, let's see if you can connect to rubygems.org...\n\nBundler connection to rubygems.org:       success \u2705\nRubyGems connection to rubygems.org:      success \u2705\nRuby net/http connection to rubygems.org: failed  \u274c\n\nUnfortunately, this Ruby can't connect to rubygems.org. \ud83d\ude21\nYour Ruby can't connect to rubygems.org because you are missing the certificate files OpenSSL needs to verify you are connecting to the genuine rubygems.org servers.\n</code></pre>\n\n<p>A couple of other points:</p>\n\n<ol>\n<li>This is a standard ruby docker container with Amazon Linux AMI</li>\n<li>The SSL_CERT_FILE <code>/usr/lib/ssl/cert.pem</code> does not exist, however, SSL_CERT_DIR does exist and has all the requisite certs in it. </li>\n</ol>\n\n<p>Why would this work for Ruby but not for Rails?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1549298860, "post_id": 54520530, "comment_id": 95844129, "body": "What did you try? You probably need a recursive method."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1549307215, "post_id": 54520530, "comment_id": 95847980, "body": "I have no dispute with your choice of answer that you checkmarked (I upvoted it, and would have have given something similar had it not already been posted) but in future you may wish to wait awhile (at least  a couple of hours, I would suggest) before making that decision. Quick selections may discourage other answers and  sometimes are followed by the posting of clearly superior answers or comments that show the selected answer is incorrect. There&#39;s no rush to select an answer!"}], "answers": [{"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 2, "creation_date": 1549301202, "post_id": 54521079, "comment_id": 95845267, "body": "I had just put together <i>such</i> a similar answer, even down to the comment after the <code>else</code> :) Have a +1."}, {"owner": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1549301432, "post_id": 54521079, "comment_id": 95845380, "body": "@SRack, it&#39;s really best way to get result :) Thank you!"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 2, "creation_date": 1549301980, "post_id": 54521079, "comment_id": 95845610, "body": "For the benefit of @mareiou, the only difference I had was to replace both <code>each</code> with <code>flat_map</code> and remove the <code>puts</code>, in order to return an array of the strings if that&#39;s desired."}, {"owner": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1549302533, "post_id": 54521079, "comment_id": 95845897, "body": "@engineersmnky, Is it possible hashes nested in Array in this data source?"}], "tags": [], "owner": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "is_accepted": true, "score": 5, "last_activity_date": 1549363201, "last_edit_date": 1549363201, "creation_date": 1549300261, "answer_id": 54521079, "question_id": 54520530, "link": "https://stackoverflow.com/questions/54520530/ruby-how-to-unroll-a-hash-table-and-concatenate-its-values/54521079#54521079", "title": "Ruby how to unroll a hash table and concatenate its values", "body": "<p>This method should work best way:</p>\n\n<pre><code>def print_hash(hash_node, prev_string=nil)\n  if hash_node.class == Array\n    hash_node.each {|element| puts \"#{prev_string}#{element}\"}\n  else # it is an inner hash\n    hash_node.each do |key, value|\n      print_hash(value, \"#{prev_string}#{key}/\")\n    end\n  end\nend\n\nprint_hash(content_as_a_hash)\n</code></pre>\n\n<p>Test run:</p>\n\n<pre><code>content_as_a_hash = {:first_directory=&gt;{:component1=&gt;[\"component1.c\", \"component1.h\"], :component2=&gt;{:component2_A=&gt;{:src=&gt;[\"component2_A.c\"], :inc=&gt;[\"component2_A.h\"]}}}}\n\nprint_hash(content_as_a_hash)    \n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>first_directory/component1/component1.c\nfirst_directory/component1/component1.h\nfirst_directory/component2/component2_A/src/component2_A.c\nfirst_directory/component2/component2_A/inc/component2_A.h\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1549307476, "last_edit_date": 1549307476, "creation_date": 1549306407, "answer_id": 54522566, "question_id": 54520530, "link": "https://stackoverflow.com/questions/54520530/ruby-how-to-unroll-a-hash-table-and-concatenate-its-values/54522566#54522566", "title": "Ruby how to unroll a hash table and concatenate its values", "body": "<p>As the YAML string uses indentation to indicate structure, you could obtain the desired result by operating on the string directly, employing a stack.</p>\n\n<pre><code>arr=&lt;&lt;_.lines\n:first_directory:\n :component1:\n  - component1.c\n  - component1.h\n :component2:\n  :component2_A:\n   :src:\n    - component2_A.c\n   :inc:\n    - component2_A.h\n_\n  #=&gt; [\":first_directory:\\n\",\n  #    \" :component1:\\n\",\n  #    \"  - component1.c\\n\",\n  #    \"  - component1.h\\n\",\n  #    \" :component2:\\n\",\n  #    \"  :component2_A:\\n\",\n  #    \"   :src:\\n\",\n  #    \"    - component2_A.c\\n\",\n  #    \"   :inc:\\n\",\n  #    \"    - component2_A.h\\n\"] \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>def rollup(stack)\n  stack.transpose.last.join('/')\nend\n\nstack = []\n\narr.each_with_object([]) do |line,arr|\n  indent = line =~ /\\S/\n  line.gsub!(/[:\\s-]/, '')\n  if stack.any? &amp;&amp; indent &lt;= stack.last.first\n    arr &lt;&lt; rollup(stack)\n    stack.select! { |ind,_| ind &lt; indent }\n  end\n  stack &lt;&lt; [indent, line]\nend &lt;&lt; rollup(stack)\n  #=&gt; [\"first_directory/component1/component1.c\", \n  #    \"first_directory/component1/component1.h\", \n  #    \"first_directory/component2/component2_A/src/component2_A.c\", \n  #    \"first_directory/component2/component2_A/inc/component2_A.h\"] \n</code></pre>\n"}], "owner": {"reputation": 374, "user_id": 5195976, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f71b0d4a72d7ebe9fa64f58b218d0bf?s=128&d=identicon&r=PG&f=1", "display_name": "mareiou", "link": "https://stackoverflow.com/users/5195976/mareiou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 54521079, "answer_count": 2, "score": 3, "last_activity_date": 1549363201, "creation_date": 1549298243, "question_id": 54520530, "link": "https://stackoverflow.com/questions/54520530/ruby-how-to-unroll-a-hash-table-and-concatenate-its-values", "title": "Ruby how to unroll a hash table and concatenate its values", "body": "<p>I have the following table in a yaml format:</p>\n\n<pre><code>:first_directory:\n :component1:\n  - component1.c\n  - component1.h\n :component2:\n  :component2_A:\n   :src:\n    - component2_A.c\n   :inc:\n    - component2_A.h\n</code></pre>\n\n<p>When I print the content of the hash I get:</p>\n\n<pre><code>{:first_directory=&gt;{:component1=&gt;[\"component1.c\", \"component1.h\"], :component2=&gt;{:component2_A=&gt;{:src=&gt;[\"component2_A.c\"], :inc=&gt;[\"component2_A.h\"]}}}}\n</code></pre>\n\n<p>Now I want to be able to create strings to concatenate all the possible values of a hash hierarchy and split it using a character. What I would like to generate are strings that look like this:</p>\n\n<pre><code>first_directory/component1/component1.c\nfirst_directory/component1/component1.h\nfirst_directory/component2/component2_A/src/component2_A.c\nfirst_directory/component2/component2_A/inc/component2_A.h\n</code></pre>\n\n<p>What would be the cleanest and best way to achieve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "gcc", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 2854941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de1f1486d4fc7a632dc7a56db053bbbd?s=128&d=identicon&r=PG&f=1", "display_name": "E L Rayle", "link": "https://stackoverflow.com/users/2854941/e-l-rayle"}, "is_accepted": true, "score": 1, "last_activity_date": 1549298000, "creation_date": 1549298000, "answer_id": 54520460, "question_id": 54520459, "link": "https://stackoverflow.com/questions/54520459/sassc-bundler-error-gemextbuilderror-error-failed-to-build-gem-native-ext/54520460#54520460", "title": "sassc bundler error: Gem::Ext::BuildError: ERROR: Failed to build gem native extension", "body": "<p>Required an update to gcc.  I tried to update using Homebrew and got permission errors in <code>/usr/local</code>.</p>\n\n<p>Solution:</p>\n\n<pre><code>$ sudo chown -R $(whoami) $(brew --prefix)/*\n$ brew upgrade gcc\n$ bundle install\n</code></pre>\n\n<p>Reference: <a href=\"https://github.com/Homebrew/brew/issues/3228\" rel=\"nofollow noreferrer\">https://github.com/Homebrew/brew/issues/3228</a></p>\n"}], "owner": {"reputation": 821, "user_id": 2854941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de1f1486d4fc7a632dc7a56db053bbbd?s=128&d=identicon&r=PG&f=1", "display_name": "E L Rayle", "link": "https://stackoverflow.com/users/2854941/e-l-rayle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2012, "favorite_count": 0, "accepted_answer_id": 54520460, "answer_count": 1, "score": 0, "last_activity_date": 1549298000, "creation_date": 1549298000, "question_id": 54520459, "link": "https://stackoverflow.com/questions/54520459/sassc-bundler-error-gemextbuilderror-error-failed-to-build-gem-native-ext", "title": "sassc bundler error: Gem::Ext::BuildError: ERROR: Failed to build gem native extension", "body": "<p>Systems: </p>\n\n<ul>\n<li>OS: Mac High Sierra (10.13.6) </li>\n<li>Ruby: 2.5.3 </li>\n<li>Rails: 5.1.6 </li>\n<li>Bundler: 1.16.4</li>\n</ul>\n\n<p>Running <code>bundle install</code> for a Rails app that includes a dependency on sassc 2.0.0 with native extensions gets a compile error.</p>\n\n<pre><code>Installing sassc 2.0.0 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: ~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/gems/sassc-2.0.0/ext\n~/.rvm/rubies/ruby-2.5.3/bin/ruby -rrubygems ~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/gems/rake-12.3.2/exe/rake\nRUBYARCHDIR=~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/extensions/x86_64-darwin-17/2.5.0/sassc-2.0.0\nRUBYLIBDIR=~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/extensions/x86_64-darwin-17/2.5.0/sassc-2.0.0\ncd libsass\nmake lib/libsass.so\nmkdir lib\n/usr/bin/clang -Wall -O2 -I ~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/gems/sassc-2.0.0/ext/libsass/include -stdlib=libc++ -fPIC -fPIC -c -o src/cencode.o src/cencode.c\nsrc/cencode.c:50:5: warning: declaration does not declare anything [-Wmissing-declarations]\n                                __attribute__ ((fallthrough));\n                                ^\nsrc/cencode.c:64:5: warning: declaration does not declare anything [-Wmissing-declarations]\n                                __attribute__ ((fallthrough));\n                                ^\n2 warnings generated.\nc++ -Wall -O2 -std=c++0x -I ~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/gems/sassc-2.0.0/ext/libsass/include -stdlib=libc++ -fPIC -fPIC -c -o src/ast.o src/ast.cpp\nc++: warning: couldn't understand kern.osversion '17.7.0\nc++: error: unrecognized command line option '-stdlib=libc++'\nmake: *** [src/ast.o] Error 1\nrake aborted!\nCommand failed with status (2): [make lib/libsass.so...]\n~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/gems/sassc-2.0.0/lib/tasks/libsass.rb:31:in `block (2 levels) in &lt;top (required)&gt;'\n~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/gems/sassc-2.0.0/lib/tasks/libsass.rb:13:in `block (3 levels) in &lt;top (required)&gt;'\n~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/gems/sassc-2.0.0/lib/tasks/libsass.rb:12:in `block (2 levels) in &lt;top (required)&gt;'\n~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/gems/rake-12.3.2/exe/rake:27:in `&lt;main&gt;'\nTasks: TOP =&gt; lib/libsass.so\n(See full trace by running task with --trace)\n\nrake failed, exit code 1\n\nGem files will remain installed in ~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/gems/sassc-2.0.0 for inspection.\nResults logged to ~/.rvm/gems/ruby-2.5.3@hyrax-app-on-wings-2019-02-01-SDC/extensions/x86_64-darwin-17/2.5.0/sassc-2.0.0/gem_make.out\n\nAn error occurred while installing sassc (2.0.0), and Bundler cannot continue.\nMake sure that `gem install sassc -v '2.0.0' --source 'https://rubygems.org/'` succeeds before bundling.\n</code></pre>\n\n<p><strong>Research on How to Resolve</strong></p>\n\n<p><em>Tried - based on recommendations in github sassc</em></p>\n\n<p>Ultimately, this recommended compiling separate from bundler and resolve any compile errors before trying bundler again. Following the instructions in the last ref (build-on-darwin), I was able to build directly, but still getting the same compiler error using bundler.</p>\n\n<p>Refs: </p>\n\n<ul>\n<li><a href=\"https://github.com/sass/sassc/issues/246\" rel=\"nofollow noreferrer\">https://github.com/sass/sassc/issues/246</a> leads to...</li>\n<li><a href=\"https://github.com/sass/sassc-ruby/issues/101\" rel=\"nofollow noreferrer\">https://github.com/sass/sassc-ruby/issues/101</a> leads to...</li>\n<li><a href=\"https://github.com/sass/libsass/blob/master/docs/build.md\" rel=\"nofollow noreferrer\">https://github.com/sass/libsass/blob/master/docs/build.md</a> leads to...</li>\n<li><a href=\"https://github.com/sass/libsass/blob/master/docs/build-on-darwin.md\" rel=\"nofollow noreferrer\">https://github.com/sass/libsass/blob/master/docs/build-on-darwin.md</a></li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3.2"], "comments": [{"owner": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "edited": false, "score": 0, "creation_date": 1549297309, "post_id": 54519935, "comment_id": 95843252, "body": "it says: multipart body is broken. Do you use stable HTTP client?"}, {"owner": {"reputation": 319, "user_id": 1425787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4d2f9358d7d0fe5368ed46cbfad20d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Wiggin", "link": "https://stackoverflow.com/users/1425787/wiggin"}, "reply_to_user": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "edited": false, "score": 0, "creation_date": 1549358948, "post_id": 54519935, "comment_id": 95863970, "body": "Yes, I didn&#39;t change anything. The only thing I did was update the gem version. Maybe it is causing trouble?. Also, I found out that this problem does not affect the users currently using the application. That part is really bothering me."}, {"owner": {"reputation": 319, "user_id": 1425787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4d2f9358d7d0fe5368ed46cbfad20d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Wiggin", "link": "https://stackoverflow.com/users/1425787/wiggin"}, "reply_to_user": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "edited": false, "score": 0, "creation_date": 1549361752, "post_id": 54519935, "comment_id": 95865648, "body": "I just tried in firefox and everything works fine. Is it something browser-related?"}, {"owner": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "edited": false, "score": 0, "creation_date": 1549361799, "post_id": 54519935, "comment_id": 95865677, "body": "maybe, or broken plugins"}, {"owner": {"reputation": 319, "user_id": 1425787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4d2f9358d7d0fe5368ed46cbfad20d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Wiggin", "link": "https://stackoverflow.com/users/1425787/wiggin"}, "reply_to_user": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "edited": false, "score": 0, "creation_date": 1549362778, "post_id": 54519935, "comment_id": 95866237, "body": "I reverted to the commit before I updated my gems, forced an install of the gems. Still getting the error."}, {"owner": {"reputation": 319, "user_id": 1425787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4d2f9358d7d0fe5368ed46cbfad20d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Wiggin", "link": "https://stackoverflow.com/users/1425787/wiggin"}, "reply_to_user": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "edited": false, "score": 0, "creation_date": 1549377299, "post_id": 54519935, "comment_id": 95874806, "body": "I also reinstalled chrome since it&#39;s the only browser where I can see the error. Solved nothing."}, {"owner": {"reputation": 4948, "user_id": 1025520, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f9f78456abe7adce324b230d947696e4?s=128&d=identicon&r=PG", "display_name": "NeverBe", "link": "https://stackoverflow.com/users/1025520/neverbe"}, "edited": false, "score": 0, "creation_date": 1549377407, "post_id": 54519935, "comment_id": 95874882, "body": "upgrade to the latest rails release? 3.22.x ?"}], "answers": [{"tags": [], "owner": {"reputation": 319, "user_id": 1425787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4d2f9358d7d0fe5368ed46cbfad20d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Wiggin", "link": "https://stackoverflow.com/users/1425787/wiggin"}, "is_accepted": true, "score": 0, "last_activity_date": 1549438833, "creation_date": 1549438833, "answer_id": 54548711, "question_id": 54519935, "link": "https://stackoverflow.com/questions/54519935/rails-eof-error-when-creating-updating-a-record/54548711#54548711", "title": "Rails: EOF Error when creating/updating a record", "body": "<p>The issue can be found <a href=\"https://github.com/rack/rack/issues/903\" rel=\"nofollow noreferrer\">here</a>: </p>\n\n<p>In the issue there are many suggestions that solve the problem. The one it worked for me was this one: </p>\n\n<pre><code>module Rack\n  module Multipart\n    class &lt;&lt; self\n      alias_method :original_parse_multipart, :parse_multipart\n      def parse_multipart(env)\n        begin\n          original_parse_multipart(env)\n        rescue EOFError =&gt; e \n          nil\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I do not like it very much because it only ignores the problem, and does not point to the source of the error.</p>\n"}], "owner": {"reputation": 319, "user_id": 1425787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4d2f9358d7d0fe5368ed46cbfad20d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Wiggin", "link": "https://stackoverflow.com/users/1425787/wiggin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 54548711, "answer_count": 1, "score": 0, "last_activity_date": 1549438833, "creation_date": 1549296231, "question_id": 54519935, "link": "https://stackoverflow.com/questions/54519935/rails-eof-error-when-creating-updating-a-record", "title": "Rails: EOF Error when creating/updating a record", "body": "<p>I recently stumbled upon a problem with my rails application. \nI am using ruby 2.1.0 with Rails 3.2.7 (I know) and recently, when I create/update ANY record of ANY model, I get the <code>EOFError - bad content body:\n</code> error in my application. Everything seems to work at database level, because if I reload, the changes can bee seen (if I create a new record it displays in the list view and if I update a record the changes are reflected).</p>\n\n<p>Here is the trace of the rails server:</p>\n\n<pre><code>EOFError - bad content body:\n  (gem) rack-1.4.7/lib/rack/multipart/parser.rb:83:in `block in fast_forward_to_first_boundary'\n  (gem) rack-1.4.7/lib/rack/multipart/parser.rb:81:in `fast_forward_to_first_boundary'\n  (gem) rack-1.4.7/lib/rack/multipart/parser.rb:17:in `parse'\n  (gem) rack-1.4.7/lib/rack/multipart.rb:25:in `parse_multipart'\n  (gem) rack-1.4.7/lib/rack/request.rb:336:in `parse_multipart'\n  (gem) rack-1.4.7/lib/rack/request.rb:201:in `POST'\n  (gem) actionpack-3.2.7/lib/action_dispatch/http/request.rb:231:in `POST'\n  (gem) actionpack-3.2.7/lib/action_dispatch/http/parameters.rb:10:in `parameters'\n  (gem) actionpack-3.2.7/lib/action_dispatch/http/filter_parameters.rb:33:in `filtered_parameters'\n  (gem) actionpack-3.2.7/lib/action_controller/metal/instrumentation.rb:21:in `process_action'\n  (gem) actionpack-3.2.7/lib/action_controller/metal/params_wrapper.rb:207:in `process_action'\n  (gem) activerecord-3.2.7/lib/active_record/railties/controller_runtime.rb:18:in `process_action'\n  (gem) actionpack-3.2.7/lib/abstract_controller/base.rb:121:in `process'\n  (gem) actionpack-3.2.7/lib/abstract_controller/rendering.rb:45:in `process'\n  (gem) actionpack-3.2.7/lib/action_controller/metal.rb:203:in `dispatch'\n  (gem) actionpack-3.2.7/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\n  (gem) actionpack-3.2.7/lib/action_controller/metal.rb:246:in `block in action'\n  (gem) actionpack-3.2.7/lib/action_dispatch/routing/route_set.rb:73:in `dispatch'\n  (gem) actionpack-3.2.7/lib/action_dispatch/routing/route_set.rb:36:in `call'\n  (gem) journey-1.0.4/lib/journey/router.rb:68:in `block in call'\n  (gem) journey-1.0.4/lib/journey/router.rb:56:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/routing/route_set.rb:600:in `call'\n  (gem) omniauth-1.4.2/lib/omniauth/strategy.rb:186:in `call!'\n  (gem) omniauth-1.4.2/lib/omniauth/strategy.rb:164:in `call'\n  (gem) warden-1.2.1/lib/warden/manager.rb:35:in `block in call'\n  (gem) warden-1.2.1/lib/warden/manager.rb:34:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\n  (gem) rack-1.4.7/lib/rack/etag.rb:23:in `call'\n  (gem) rack-1.4.7/lib/rack/conditionalget.rb:25:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/head.rb:14:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/params_parser.rb:21:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/flash.rb:242:in `call'\n  (gem) rack-1.4.7/lib/rack/session/abstract/id.rb:210:in `context'\n  (gem) rack-1.4.7/lib/rack/session/abstract/id.rb:205:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/cookies.rb:338:in `call'\n  (gem) activerecord-3.2.7/lib/active_record/query_cache.rb:64:in `call'\n  (gem) activerecord-3.2.7/lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\n  (gem) activesupport-3.2.7/lib/active_support/callbacks.rb:405:in `_run__451408873423695737__call__1903216192202827668__callbacks'\n  (gem) activesupport-3.2.7/lib/active_support/callbacks.rb:405:in `__run_callback'\n  (gem) activesupport-3.2.7/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\n  (gem) activesupport-3.2.7/lib/active_support/callbacks.rb:81:in `run_callbacks'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/callbacks.rb:27:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\n  (gem) better_errors-0.7.2/lib/better_errors/middleware.rb:84:in `protected_app_call'\n  (gem) better_errors-0.7.2/lib/better_errors/middleware.rb:79:in `better_errors_call'\n  (gem) better_errors-0.7.2/lib/better_errors/middleware.rb:56:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n  (gem) railties-3.2.7/lib/rails/rack/logger.rb:26:in `call_app'\n  (gem) railties-3.2.7/lib/rails/rack/logger.rb:16:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/request_id.rb:22:in `call'\n  (gem) rack-1.4.7/lib/rack/methodoverride.rb:21:in `call'\n  (gem) rack-1.4.7/lib/rack/runtime.rb:17:in `call'\n  (gem) activesupport-3.2.7/lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n  (gem) rack-1.4.7/lib/rack/lock.rb:15:in `call'\n  (gem) actionpack-3.2.7/lib/action_dispatch/middleware/static.rb:62:in `call'\n  /home/oscar/.asdf/installs/ruby/2.1.0/lib/ruby/gems/2.1.0/bundler/gems/raven-ruby-16a463b59142/lib/raven/integrations/rack.rb:54:in `call'\n  (gem) railties-3.2.7/lib/rails/engine.rb:479:in `call'\n  (gem) railties-3.2.7/lib/rails/application.rb:220:in `call'\n  (gem) rack-1.4.7/lib/rack/content_length.rb:14:in `call'\n  (gem) railties-3.2.7/lib/rails/rack/log_tailer.rb:17:in `call'\n  (gem) thin-1.4.1/lib/thin/connection.rb:80:in `block in pre_process'\n  (gem) thin-1.4.1/lib/thin/connection.rb:78:in `pre_process'\n  (gem) thin-1.4.1/lib/thin/connection.rb:53:in `process'\n  (gem) thin-1.4.1/lib/thin/connection.rb:38:in `receive_data'\n  (gem) eventmachine-1.0.9.1/lib/eventmachine.rb:193:in `run'\n  (gem) thin-1.4.1/lib/thin/backends/base.rb:63:in `start'\n  (gem) thin-1.4.1/lib/thin/server.rb:159:in `start'\n  (gem) rack-1.4.7/lib/rack/handler/thin.rb:13:in `run'\n  (gem) rack-1.4.7/lib/rack/server.rb:268:in `start'\n  (gem) railties-3.2.7/lib/rails/commands/server.rb:70:in `start'\n  (gem) railties-3.2.7/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n  (gem) railties-3.2.7/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n  script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Did anyone had a problem like this?</p>\n"}]