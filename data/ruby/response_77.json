[{"tags": ["ruby-on-rails", "c", "ruby", "windows"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1467247000, "post_id": 38111894, "comment_id": 63657936, "body": "see <a href=\"http://stackoverflow.com/questions/32751824/how-do-i-install-byebug-for-ruby-on-windows\">how-do-i-install-byebug-for-ruby-on-windows</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12705, "user_id": 483040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ux8AH.jpg?s=128&g=1", "display_name": "jaydel", "link": "https://stackoverflow.com/users/483040/jaydel"}, "is_accepted": false, "score": 0, "last_activity_date": 1467290198, "last_edit_date": 1495540348, "creation_date": 1467290198, "answer_id": 38123314, "question_id": 38111894, "link": "https://stackoverflow.com/questions/38111894/error-message-make-sure-that-gem-install-debug-inspector-v-0-0-2-succeeds/38123314#38123314", "title": "Error message: Make sure that `gem install debug_inspector -v &#39;0.0.2&#39;` succeeds before bundling", "body": "<p>When you see the message:</p>\n\n<pre><code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n</code></pre>\n\n<p>it is likely that the native extensions cannot be built because some missing system library issue, or even your version of the Ruby/DevKit.</p>\n\n<p>I am unfamiliar with Ruby on Windows, having made the switch to OSX when I first started working with Rails.</p>\n\n<p>In your case I found a similar <a href=\"https://stackoverflow.com/questions/26601184/gemextbuilderror-error-failed-to-build-gem-native-extension-bcrypt-ruby\">question</a> that <em>might</em> help you. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6529934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 410, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467290198, "creation_date": 1467244385, "question_id": 38111894, "link": "https://stackoverflow.com/questions/38111894/error-message-make-sure-that-gem-install-debug-inspector-v-0-0-2-succeeds", "title": "Error message: Make sure that `gem install debug_inspector -v &#39;0.0.2&#39;` succeeds before bundling", "body": "<p>I am new to programming, and I have begun the process of installing Ruby on Rails. I have just tried creating my first project. \n  However I am getting the message in the title whenever I try to bundle install in my project. I am using Windows.</p>\n\n<p><strong>When i attempt bundle install</strong></p>\n\n<pre><code>Installing byebug 9.0.5 with native extensions\n\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: C:/Ruby23/lib/ruby/gems/2.3.0/gems/byebug-9.0.5/ext/byebug\nC:/Ruby23/bin/ruby.exe -r ./siteconf20160630-6484-1le1k81.rb extconf.rb\ncreating Makefile\n\ncurrent directory: C:/Ruby23/lib/ruby/gems/2.3.0/gems/byebug-9.0.5/ext/byebug\nmake \"DESTDIR=\" clean\n\ncurrent directory: C:/Ruby23/lib/ruby/gems/2.3.0/gems/byebug-9.0.5/ext/byebug\nmake \"DESTDIR=\"\ngenerating byebug-i386-mingw32.def\ncompiling breakpoint.c\nIn file included from c:/Ruby23/include/ruby-2.3.0/ruby.h:33:0,\n                 from byebug.h:4,\n                 from breakpoint.c:1:\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:124:14: error: size of array 'ruby_check_sizeof_voidp' is negative\nIn file included from c:/Ruby23/include/ruby-2.3.0/ruby.h:33:0,\n                 from byebug.h:4,\n                 from breakpoint.c:1:\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_obj_freeze_inline':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1353:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1354:2: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1355:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1355:27: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_data_object_get':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1393:13: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_data_object_make':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1407:5: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_data_typed_object_make':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1414:5: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_num2char_inline':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:41: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:41: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:41: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1581:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1581:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1581:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_class_of':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1942:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_type':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1959:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nIn file included from c:/Ruby23/include/ruby-2.3.0/ruby.h:33:0,\n                 from byebug.h:4,\n                 from breakpoint.c:1:\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_clone_setup':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1990:56: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1991:33: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1992:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1992:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_dup_setup':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1998:42: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1999:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1999:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_array_len':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2005:13: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2006:2: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2006:24: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_array_const_ptr':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2020:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2020:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2020:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_struct_len':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2027:13: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2028:2: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2028:26: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_struct_const_ptr':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2034:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2034:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2034:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c: In function 'filename_cmp_impl':\nbreakpoint.c:288:11: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:288:11: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:288:11: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:292:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:292:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:292:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c: In function 'find_breakpoint_by_pos':\nbreakpoint.c:458:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:458:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:458:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nmake: *** [breakpoint.o] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in C:/Ruby23/lib/ruby/gems/2.3.0/gems/byebug-9.0.5 for inspection.\nResults logged to C:/Ruby23/lib/ruby/gems/2.3.0/extensions/x86-mingw32/2.3.0/byebug-9.0.5/gem_make.out\nUsing coffee-script-source 1.10.0\nUsing execjs 2.7.0\nUsing thor 0.19.1\nUsing concurrent-ruby 1.0.2\nUsing multi_json 1.12.1\nUsing mysql2 0.4.4\nUsing sass 3.4.22\nUsing tilt 2.0.5\nUsing rdoc 4.2.2\nUsing tzinfo 1.2.2\nUsing nokogiri 1.6.8\nUsing rack-test 0.6.3\nUsing mime-types 3.1\nAn error occurred while installing debug_inspector (0.0.2), and Bundler cannot\ncontinue.\nMake sure that `gem install debug_inspector -v '0.0.2'` succeeds before\nbundling.\n</code></pre>\n\n<p><strong>When i attempt installing debug_inspector</strong></p>\n\n<pre><code>C:\\Users\\User\\Documents\\Sites&gt;gem install debug_inspector\nTemporarily enhancing PATH to include DevKit...\nBuilding native extensions.  This could take a while...\nERROR:  Error installing debug_inspector:\n    ERROR: Failed to build gem native extension.\n</code></pre>\n\n<p>Sorry if I made any mistakes posting this. Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 12705, "user_id": 483040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ux8AH.jpg?s=128&g=1", "display_name": "jaydel", "link": "https://stackoverflow.com/users/483040/jaydel"}, "edited": false, "score": 0, "creation_date": 1467290292, "post_id": 38113089, "comment_id": 63678086, "body": "exactly. to put it more succintly, class methods must be stubbed against the class, not the instance."}, {"owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "edited": false, "score": 0, "creation_date": 1467302221, "post_id": 38113089, "comment_id": 63687419, "body": "Excellent thank you!  That makes sense (also appreciate taking the time to run the test!)."}], "tags": [], "owner": {"reputation": 2278, "user_id": 2244501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231d8805a81cf94c09ff60cdba6e4029?s=128&d=identicon&r=PG", "display_name": "retgoat", "link": "https://stackoverflow.com/users/2244501/retgoat"}, "is_accepted": true, "score": 2, "last_activity_date": 1467254387, "creation_date": 1467254387, "answer_id": 38113089, "question_id": 38111880, "link": "https://stackoverflow.com/questions/38111880/how-to-stub-non-activerecord-models-in-rails/38113089#38113089", "title": "How to Stub Non-ActiveRecord Models in Rails?", "body": "<p>I think you shouldn't double your model. Following example works for me:</p>\n\n<pre><code>class Thing\n  class &lt;&lt; self\n    def do_stuff(param)\n      result1 = method_one(param)\n      result2 = method_two(result1)\n    end\n\n    def method_one(param)\n      param[:foo]\n    end\n\n    def method_two(result1)\n      # transformation\n      result1\n    end\n  end\nend\n\n# thing_spec.rb\nrequire 'rails_helper'\n\nRSpec.describe Thing, type: :model do\n  let!(:param) { {foo: \"bar\"} }\n\n  describe '#do_stuff' do\n    it 'should do stuff' do\n      expect(Thing).to receive(:method_one).with(param)\n      Thing.do_stuff param\n    end\n  end\nend\n</code></pre>\n\n<p>Test result</p>\n\n<pre><code>[retgoat@iMac-Roman ~/workspace/tapp]$ be rspec spec/models/thing_spec.rb\nDEPRECATION WARNING: The configuration option `config.serve_static_assets` has been renamed to `config.serve_static_files` to clarify its role (it merely enables serving everything in the `public` folder and is unrelated to the asset pipeline). The `serve_static_assets` alias will be removed in Rails 5.0. Please migrate your configuration files accordingly. (called from block in &lt;top (required)&gt; at /Users/retgoat/workspace/tapp/config/environments/test.rb:16)\n.\n\nFinished in 0.0069 seconds (files took 1.78 seconds to load)\n1 example, 0 failures\n</code></pre>\n"}], "owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 38113089, "answer_count": 1, "score": 0, "last_activity_date": 1467254387, "creation_date": 1467244312, "question_id": 38111880, "link": "https://stackoverflow.com/questions/38111880/how-to-stub-non-activerecord-models-in-rails", "title": "How to Stub Non-ActiveRecord Models in Rails?", "body": "<p>I have a model like this:</p>\n\n<pre><code>class Thing\n  class &lt;&lt; self\n    def do_stuff(param)\n      result1 = method_one(param)   \n      result2 = method_two(result1)\n    end\n\n    def method_one(param)\n      # tranformation\n    end \n\n    def method_two(result1)\n      # transformation\n    end\n  end\nend\n</code></pre>\n\n<p>How can I test that <code>do_stuff</code> is properly executing the methods of <code>method_one</code> and <code>method_two</code> with the right arguments?  I have tried mock_model / mock_class but those don't make any sense to me. I have read the documentation but I'm still having a hard time making sense of it. </p>\n\n<p>My test looks like this:</p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe Thing, type: :model do\n  let!(:param) { create(:param) }\n\n  describe '#do_stuff' do\n    thing = double('thing')\n    expect(thing).to receive(:method_one).with param\n    thing.do_stuff param\n  end\nend\n</code></pre>\n\n<p>Why does this not work? \nThe error I receive is that thing received an unexpected message param.  But it was quite expected and that was the test.  Where am I going wrong? </p>\n"}, {"tags": ["ruby", "json", "testing", "sinatra", "erb"], "comments": [{"owner": {"reputation": 4370, "user_id": 465082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab74528b8223851cd7b546beec220fdc?s=128&d=identicon&r=PG", "display_name": "Kashyap", "link": "https://stackoverflow.com/users/465082/kashyap"}, "edited": false, "score": 0, "creation_date": 1467278953, "post_id": 38111709, "comment_id": 63670259, "body": "Can you provide the error backtrace when you run the specs?"}, {"owner": {"reputation": 781, "user_id": 2750478, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/db3f32fbc9f8de3052199d04c48f7200?s=128&d=identicon&r=PG&f=1", "display_name": "Xirux Nefer", "link": "https://stackoverflow.com/users/2750478/xirux-nefer"}, "reply_to_user": {"reputation": 4370, "user_id": 465082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab74528b8223851cd7b546beec220fdc?s=128&d=identicon&r=PG", "display_name": "Kashyap", "link": "https://stackoverflow.com/users/465082/kashyap"}, "edited": false, "score": 0, "creation_date": 1467281161, "post_id": 38111709, "comment_id": 63671922, "body": "@Kashyap Sorry my bad. I have updated the question with the error messages I got."}, {"owner": {"reputation": 4370, "user_id": 465082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab74528b8223851cd7b546beec220fdc?s=128&d=identicon&r=PG", "display_name": "Kashyap", "link": "https://stackoverflow.com/users/465082/kashyap"}, "edited": false, "score": 0, "creation_date": 1467283573, "post_id": 38111709, "comment_id": 63673526, "body": "The first test failure you&#39;re seeing is because the server encountered a 500 Internal error, and is unable to send back any of the expected data. Can you check the logs and see what happened? Second error seems to be some issue with JSON parsing?"}], "answers": [{"comments": [{"owner": {"reputation": 781, "user_id": 2750478, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/db3f32fbc9f8de3052199d04c48f7200?s=128&d=identicon&r=PG&f=1", "display_name": "Xirux Nefer", "link": "https://stackoverflow.com/users/2750478/xirux-nefer"}, "edited": false, "score": 0, "creation_date": 1467288151, "post_id": 38121121, "comment_id": 63676519, "body": "Yes, I am requiring the <code>sinatra-contrib</code> gem. For the second error I have tried with <code>request.content_type.each</code> as well. I have updated my question at the bottom."}], "tags": [], "owner": {"reputation": 4370, "user_id": 465082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab74528b8223851cd7b546beec220fdc?s=128&d=identicon&r=PG", "display_name": "Kashyap", "link": "https://stackoverflow.com/users/465082/kashyap"}, "is_accepted": false, "score": 0, "last_activity_date": 1467284260, "creation_date": 1467284260, "answer_id": 38121121, "question_id": 38111709, "link": "https://stackoverflow.com/questions/38111709/in-sinatra-how-to-test-a-route-that-can-return-both-html-and-json/38121121#38121121", "title": "In Sinatra, how to test a route that can return both html and json?", "body": "<p>The first test failure is because of an error that's happening in the application, so you need to check the logs to see what's triggering it. (Are you loading Sinatra-Contrib's RespondWith module since <code>respond_to</code> is not a method provided by Sinatra).</p>\n\n<p>The second example's error is because of mismatch of header expectations between the test and the application. In the app, you're using <code>request.accept.each</code> which iterates over the <code>Accept</code> headers that the request sent to your app, which by default is '<em>/</em>', but the test sends the header of <code>Content-Type</code> which won't trigger the conditional case statement.</p>\n"}, {"tags": [], "owner": {"reputation": 781, "user_id": 2750478, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/db3f32fbc9f8de3052199d04c48f7200?s=128&d=identicon&r=PG&f=1", "display_name": "Xirux Nefer", "link": "https://stackoverflow.com/users/2750478/xirux-nefer"}, "is_accepted": true, "score": 0, "last_activity_date": 1467316966, "creation_date": 1467316966, "answer_id": 38132280, "question_id": 38111709, "link": "https://stackoverflow.com/questions/38111709/in-sinatra-how-to-test-a-route-that-can-return-both-html-and-json/38132280#38132280", "title": "In Sinatra, how to test a route that can return both html and json?", "body": "<p>I found the error. The problem was in the headers as I suspected. I was not sending them correctly. </p>\n\n<p>According to <a href=\"http://www.sinatrarb.com/testing.html#racktests-mock-request-methods\" rel=\"nofollow\">the docs</a>, this is the signature of the HTTP methods when used in tests:</p>\n\n<pre><code>get '/path', params={}, rack_env={}\n</code></pre>\n\n<p>So my test didn't work, because the third argument is <a href=\"http://www.rubydoc.info/github/rack/rack/master/file/SPEC\" rel=\"nofollow\">a rack environment variable</a> and I was passing the headers there:</p>\n\n<pre><code>h = {'Content-Type' =&gt; 'text/html'}\npost \"/join\", \"data\" =&gt; '{\"name\": \"Jon\"}', \"headers\" =&gt; h\n</code></pre>\n\n<p>Instead, I have to add each header separately calling <code>header(header_name, header_value)</code> before calling the method. So now my JSON tests look like this:</p>\n\n<pre><code>  it \"welcomes the player\" do\n    header \"Accept\", \"application/json\"\n    post \"/join\", {\"name\" =&gt; \"Jon\"}\n    response = {status: Messages::JOIN_SUCCESS}\n    expect_response_to_eq(response)\n  end\n</code></pre>\n\n<p>and my view tests look like this:</p>\n\n<pre><code>  it \"renders the join page\" do\n    header \"Accept\", \"text/html\"\n    post \"/join\", {\"name\" =&gt; \"Jon\"}\n    expect(last_response).to be_ok\n    expect(last_response.body).to include(Messages::JOIN_TITLE)\n  end\n</code></pre>\n\n<p>And my production code in <strong>main.rb</strong> works:</p>\n\n<pre><code>  post \"/join\", :provides =&gt; ['html', 'json'] do\n    response  = helper.join_response(params)\n    @title    = Messages::JOIN_TITLE\n    @r_status = response[:status]\n\n    request.accept.each do |type|\n      case type.to_s\n      when 'text/html'\n        halt erb :join\n      when 'application/json'\n        halt response.to_json\n      end\n    end\n    error 406\n  end\n</code></pre>\n\n<p>If I print the headers I get:</p>\n\n<pre><code>p headers  \n{\"Content-Type\"=&gt;\"application/json\"}        # for JSON\n{\"Content-Type\"=&gt;\"text/html;charset=utf-8\"} # for the views\n{\"Content-Type\"=&gt;\"text/html;charset=utf-8\"} # in the browser\n</code></pre>\n\n<p>And if I print them from the request, I get:</p>\n\n<pre><code>p request.accept\n# for JSON:\n[#&lt;Sinatra::Request::AcceptEntry:0x007fcf973ff480 @entry=\"application/json\", @type=\"application/json\", @params={}, @q=1.0&gt;]\n# for the views:\n[#&lt;Sinatra::Request::AcceptEntry:0x007f5791fe29d8 @entry=\"text/html\", @type=\"text/html\", @params={}, @q=1.0&gt;]\n# in the browser:\n&lt;Sinatra::Request::AcceptEntry:0x007f2fd5a0ee50 @entry=\"text/html\", @type=\"text/html\", @params={}, @q=1.0&gt;\n</code></pre>\n"}], "owner": {"reputation": 781, "user_id": 2750478, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/db3f32fbc9f8de3052199d04c48f7200?s=128&d=identicon&r=PG&f=1", "display_name": "Xirux Nefer", "link": "https://stackoverflow.com/users/2750478/xirux-nefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1142, "favorite_count": 0, "accepted_answer_id": 38132280, "answer_count": 2, "score": 1, "last_activity_date": 1467316966, "creation_date": 1467243020, "last_edit_date": 1467293432, "question_id": 38111709, "link": "https://stackoverflow.com/questions/38111709/in-sinatra-how-to-test-a-route-that-can-return-both-html-and-json", "title": "In Sinatra, how to test a route that can return both html and json?", "body": "<p>I am still new to Sinatra and I have built my app all based in json, with no views. Now I would like to have the same behaviour but rendering the results on a view. When I was just returning json, my tests all worked. Now I am trying to introduce the erb templates in the routes, and my tests crash, and the variables in the route method don't get passed to the view either.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Here is the code of the tests:</p>\n\n<p><strong>main_spec.rb:</strong></p>\n\n<pre><code>describe \"when a player joins the game\" do\n\n  it \"welcomes the player\" do\n    post \"/join\", \"data\" =&gt; '{\"name\": \"Jon\"}'\n    response = {status: Messages::JOIN_SUCCESS}\n    expect_response_to_eq(response)\n  end\n\n  it \"sends an error message if no name is sent\" do\n    post \"/join\", \"data\" =&gt; '{}'\n    response = {status: Messages::JOIN_FAILURE}\n    expect_response_to_eq(response)\n  end\n\n  it \"sends an error message if player could not join the game\" do\n    fill_the_game\n    post \"/join\", \"data\" =&gt; '{\"name\": \"Jon\"}'\n    response = {status: Messages::JOIN_FAILURE}\n    expect_response_to_eq(response)\n  end\n\n  it \"returns an empty response if no data is sent\" do\n    post \"/join\"\n    expect_response_to_eq({})\n  end\n\n  def expect_response_to_eq(response)\n    expect(last_response).to be_ok\n    expect(JSON.parse(last_response.body, symbolize_names: true)).to eq(response)\n  end\n\n  def fill_the_game\n    server.join_game(\"Jane\")\n    server.join_game(\"Joe\")\n    server.join_game(\"Moe\")\n    server.join_game(\"May\")\n  end\n\nend\n</code></pre>\n\n<p>where <code>Messages</code> is a module that contains string messages for the game.</p>\n\n<p>The controller method I am trying to test initially looked like this, it just returned the response in json format:</p>\n\n<p><strong>main.rb</strong></p>\n\n<pre><code>post \"/join\" do\n  response = helper.join_response(params)\n  @title   = Messages::JOIN_TITLE\n  response.to_json\nend\n</code></pre>\n\n<p>The helper is a class where I extracted all the business logic so that the controller only has to deal with HTTP requests. I use dependency injection to pass the helper to the main controller, so that it is easier to test.</p>\n\n<p>So up to here, if I run the tests, they are green. But now I want to render the results of the response in the views through erb, while still returning the json. So I added a test like this:</p>\n\n<p><strong>main_spec.rb:</strong></p>\n\n<pre><code>  it \"renders the join page\" do\n    h = {'Content-Type' =&gt; 'text/html'}\n    post \"/join\", \"data\" =&gt; '{\"name\": \"Jon\"}', \"headers\" =&gt; h\n    expect(last_response).to be_ok\n    expect(last_response.body).to include(Messages::JOIN_TITLE)\n  end\n</code></pre>\n\n<p>And then modified the join router to make the test pass (I'm requiring <code>sinatra-contrib</code> for this):</p>\n\n<p><strong>main.rb:</strong></p>\n\n<pre><code>post \"/join\", :provides =&gt; ['html', 'json'] do\n  response  = helper.join_response(params)\n  @title    = Messages::JOIN_TITLE\n  @r_status = response[:status]\n\n  respond_to do |format|\n    format.html { erb :join }\n    format.json { response.to_json }\n  end\n\n  response.to_json\nend\n</code></pre>\n\n<p>This broke all my tests with the message:</p>\n\n<pre><code>Failure/Error: expect(last_response).to be_ok\n       expected `#&lt;Rack::MockResponse:0x007f89e9a941e0...` \n       # ommited this part due to space constrains\n       `...@body=[\"&lt;h1&gt;Internal Server Error&lt;/h1&gt;\"]&gt;.ok?` to return true, got false\n</code></pre>\n\n<p>So I tried something else:</p>\n\n<p><strong>main.rb:</strong></p>\n\n<pre><code>post \"/join\", :provides =&gt; ['html', 'json'] do\n  response  = helper.join_response(params)\n  @title    = Messages::JOIN_TITLE\n  @r_status = response[:status]\n\n  request.accept.each do |type|\n    case type.to_s\n    when 'text/html'\n      halt erb :join\n    when 'text/json'\n      halt response.to_json\n    end\n  end\n\nend\n</code></pre>\n\n<p>Broke everything as well with a different message:</p>\n\n<pre><code>Failure/Error: expect(JSON.parse(last_response.body, symbolize_names: true)).to eq(response)\n\nJSON::ParserError:\n  784: unexpected token at '*/*'\n</code></pre>\n\n<p>If I add a line at the end, <code>response.to_json</code>, just before closing the method, my tests pass except for the last line of the test for the view,  <code>expect(last_response.body).to include(Messages::JOIN_TITLE)</code>. Indeed when I load the page in a browser,  the <code>@title</code> seems to be sent to the page but not the <code>@r_status</code> for some reason. In the erb view, I have <code>&lt;p&gt;&lt;%= @r_status %&gt;&lt;/p&gt;</code>, so it should show up. The title is rendered in the layout erb, as <code>&lt;h1&gt;&lt;%= @title %&gt;&lt;/h1&gt;</code>.</p>\n\n<p>I have printed the value of <code>@r_status</code> and it is correct, but if I print stuff from inside the <code>when</code> blocks, it's like it never hits those.</p>\n\n<p>What is it that I am doing wrong?\nWhy is the @r_status not rendered in the view and why aren't the <code>when</code> blocks hit? How can I make the controller return both html or json and most importantly, how can I test that?</p>\n\n<h2>Update:</h2>\n\n<p>I have updated the first test to send the specific headers:</p>\n\n<pre><code>it \"welcomes the player\" do\n  h = {\"Content-Type\" =&gt; \"application/json\", \"Accept\" =&gt; \"application/json\"}\n  post \"/join\", \"data\" =&gt; '{\"name\": \"Jon\"}', \"headers\" =&gt; h\n  response = {status: Messages::JOIN_SUCCESS}\n  expect_response_to_eq(response)\nend\n</code></pre>\n\n<p>And the I run just that test</p>\n\n<pre><code>$ rspec spec/main_spec.rb:20\n</code></pre>\n\n<p>When I print the request info from the controller, this is what I get:</p>\n\n<pre><code>p request.content_type\napplication/x-www-form-urlencoded\n\np request.accept\n[#&lt;Sinatra::Request::AcceptEntry:0x007f86de1566b8 @entry=\"*/*\", @type=\"*/*\", @params={}, @q=1.0&gt;]\n\np params\n{\"data\"=&gt;\"{\\\"name\\\": \\\"Jon\\\"}\", \"headers\"=&gt;{\"Content-Type\"=&gt;\"application/json\", \"Accept\"=&gt;\"application/json\"}}\n</code></pre>\n\n<p>Seems like it is not taking my headers... so when I do <code>request.accept.each do |type| case type.to_s</code> it returns <code>*/*</code> which doesn't match neither html nor json, and that's why it never run the code inside the <code>when</code> statements. Should I manually redirect to erb or json in the route method using my params? How can I do that?</p>\n"}, {"tags": ["ruby", "rake", "jruby", "war", "warbler"], "answers": [{"tags": [], "owner": {"reputation": 6788, "user_id": 454312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jNMNF.jpg?s=128&g=1", "display_name": "kares", "link": "https://stackoverflow.com/users/454312/kares"}, "is_accepted": true, "score": 0, "last_activity_date": 1467376862, "creation_date": 1467376862, "answer_id": 38145726, "question_id": 38111592, "link": "https://stackoverflow.com/questions/38111592/how-to-run-rake-tasks-with-warbler-with-cp-option/38145726#38145726", "title": "How to run rake tasks with warbler with -cp option", "body": "<p><code>java -jar</code> does look for the main-class in the specified archive</p>\n\n<p><code>java -cp</code> does only add a .jar to class-path </p>\n\n<p>... it doesn't know what main-class to run you will need to set it manually</p>\n\n<p>e.g. <code>java -cp app.war WarMain -S ...</code></p>\n"}], "owner": {"reputation": 919, "user_id": 3000837, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3472b0427faa049a99f78f985e3bdd9b?s=128&d=identicon&r=PG&f=1", "display_name": "streetsoldier", "link": "https://stackoverflow.com/users/3000837/streetsoldier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 38145726, "answer_count": 1, "score": 0, "last_activity_date": 1467376862, "creation_date": 1467242220, "last_edit_date": 1467242674, "question_id": 38111592, "link": "https://stackoverflow.com/questions/38111592/how-to-run-rake-tasks-with-warbler-with-cp-option", "title": "How to run rake tasks with warbler with -cp option", "body": "<p>I have a jruby app that is being packaged into a war file. I am trying to run a rake task from my app. I know warbler gives a -S option to run rake tasks.</p>\n\n<p>When I run the following command, everything runs fine:</p>\n\n<pre><code>java -jar /path/to/war/file/app.war -S rake namespace:start_task\n</code></pre>\n\n<p>But when I try to run the same command with a -cp option as follows. I get an error.</p>\n\n<pre><code>java -cp /path/to/war/file/app.war -S rake namespace:start_task\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Unrecognized option: -S\nError: Could not create the Java Virtual Machine.\nError: A fatal exception has occurred. Program will exit.\n</code></pre>\n\n<p>I am using a gem that has hard coded the -cp option to invoke execute the war file. I am wondering if there is a way to invoke a rake task in warbler using the -cp option.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-drive-api", "omniauth"], "comments": [{"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1467241841, "post_id": 38111436, "comment_id": 63656580, "body": "Have you visited this page? <a href=\"https://developers.google.com/identity/protocols/OAuth2WebServer#example\" rel=\"nofollow noreferrer\">developers.google.com/identity/protocols/&hellip;</a>"}, {"owner": {"reputation": 97172, "user_id": 149080, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/685eca46bfebf9233cc276b415a74ddb?s=128&d=identicon&r=PG", "display_name": "AnApprentice", "link": "https://stackoverflow.com/users/149080/anapprentice"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1467246532, "post_id": 38111436, "comment_id": 63657839, "body": "Thanks for sharing. I tried that example but get the error <code>No client_secrets.json filename supplied and&#47;or could not be found in search path.</code>. I&#39;m not seeing where to specify config.json?"}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1467248072, "post_id": 38111436, "comment_id": 63658180, "body": "You must create this client_secrets.json. I believe there is a model of it somewhere in Google documentation. Let me do some research here."}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1467248118, "post_id": 38111436, "comment_id": 63658191, "body": "Here it is! <a href=\"https://developers.google.com/api-client-library/ruby/guide/aaa_client_secrets\" rel=\"nofollow noreferrer\">developers.google.com/api-client-library/ruby/guide/&hellip;</a>"}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1467248138, "post_id": 38111436, "comment_id": 63658197, "body": "Have you created an authorization to your app there at Google?"}, {"owner": {"reputation": 97172, "user_id": 149080, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/685eca46bfebf9233cc276b415a74ddb?s=128&d=identicon&r=PG", "display_name": "AnApprentice", "link": "https://stackoverflow.com/users/149080/anapprentice"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1467252964, "post_id": 38111436, "comment_id": 63659239, "body": "yes done all that, sadly still stuck"}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1467253897, "post_id": 38111436, "comment_id": 63659461, "body": "Strange. I always used it smoothly. Could you post the code you used to get this token?"}, {"owner": {"reputation": 97172, "user_id": 149080, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/685eca46bfebf9233cc276b415a74ddb?s=128&d=identicon&r=PG", "display_name": "AnApprentice", "link": "https://stackoverflow.com/users/149080/anapprentice"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1467257658, "post_id": 38111436, "comment_id": 63660332, "body": "I just updated the q with the omniauth callback code I&#39;m using to store the google tokens. Does that help?"}, {"owner": {"reputation": 97172, "user_id": 149080, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/685eca46bfebf9233cc276b415a74ddb?s=128&d=identicon&r=PG", "display_name": "AnApprentice", "link": "https://stackoverflow.com/users/149080/anapprentice"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1467257692, "post_id": 38111436, "comment_id": 63660339, "body": "Thanks for mentioning you&#39;ve been able to use this smoothly. Do you have a code snippet that&#39;s working for your in ruby/rails that you could share?"}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1467261508, "post_id": 38111436, "comment_id": 63661334, "body": "I&#39;m at home now, but tomorrow morning I may post some code when at work."}, {"owner": {"reputation": 97172, "user_id": 149080, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/685eca46bfebf9233cc276b415a74ddb?s=128&d=identicon&r=PG", "display_name": "AnApprentice", "link": "https://stackoverflow.com/users/149080/anapprentice"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1467299907, "post_id": 38111436, "comment_id": 63685700, "body": "Thanks, I was finally able to get it to work.. I&#39;ll post below"}], "answers": [{"tags": [], "owner": {"reputation": 97172, "user_id": 149080, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/685eca46bfebf9233cc276b415a74ddb?s=128&d=identicon&r=PG", "display_name": "AnApprentice", "link": "https://stackoverflow.com/users/149080/anapprentice"}, "is_accepted": false, "score": 3, "last_activity_date": 1467300039, "creation_date": 1467300039, "answer_id": 38127349, "question_id": 38111436, "link": "https://stackoverflow.com/questions/38111436/how-to-handle-the-grant-type-error-with-the-google-drive-gem/38127349#38127349", "title": "How to handle the grant_type error with the google_drive gem?", "body": "<p>Working solution to access google drive api without requiring a config.json. This solution uses the refresh token obtained from the google auth 2 omniauth strategy:</p>\n\n<pre><code>  require 'google/apis/drive_v2'\n    auth = Signet::OAuth2::Client.new(\n      token_credential_uri: 'https://accounts.google.com/o/oauth2/token',\n      client_id:            \"XXX-XXX\",\n      client_secret:        \"XXX\",\n      refresh_token:        self.refresh_token # Get this from the omniauth strategy. \n    )\n\n    auth.fetch_access_token!\n\n    x = Google::Apis::DriveV2\n    drive = x::DriveService.new\n    drive.authorization = auth\n\nfiles = drive.list_files\n</code></pre>\n\n<p>This took me .5 day. I hope it helps someone else out there! :)</p>\n"}], "owner": {"reputation": 97172, "user_id": 149080, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/685eca46bfebf9233cc276b415a74ddb?s=128&d=identicon&r=PG", "display_name": "AnApprentice", "link": "https://stackoverflow.com/users/149080/anapprentice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1589907788, "creation_date": 1467241329, "last_edit_date": 1589907788, "question_id": 38111436, "link": "https://stackoverflow.com/questions/38111436/how-to-handle-the-grant-type-error-with-the-google-drive-gem", "title": "How to handle the grant_type error with the google_drive gem?", "body": "<p>I'm trying to use the Ruby gem 'google_drive'. Before using that gem, I'm obtaining the user's token via the gem omniauth-google-oauth2.</p>\n\n<p>When I try to use google_drive as follows:</p>\n\n<pre><code>  def google_oauth2(current_user)\n\n    session = GoogleDrive.login_with_oauth(self.token)\n\n    # Gets list of remote files.\n    session.files.each do |file|\n      p file.title\n    end\n  end \n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Sending HTTP get https://www.googleapis.com/drive/v3/files?fields=%2A\nCaught error Authorization failed.  Server message:\n{\n \"error\": \"invalid_request\",\n \"error_description\": \"Required parameter is missing: grant_type\"\n}\nError - #&lt;Signet::AuthorizationError: Authorization failed.  Server message:\n{\n \"error\": \"invalid_request\",\n \"error_description\": \"Required parameter is missing: grant_type\"\n}&gt;\n\nCompleted 500 Internal Server Error in 128ms (ActiveRecord: 0.4ms)\n</code></pre>\n\n<p>How can I resolve this?</p>\n\n<h2>Update</h2>\n\n<p>Omniauth code being used to store the google oauth 2 tokens:</p>\n\n<pre><code>  def google_oauth2\n    auth_hash = request.env['omniauth.auth']\n\n    @authentication = Authentication.find_or_create_by(\n                                            user_id: current_user.id,\n                                            provider: auth_hash[\"provider\"],\n                                            uid: auth_hash[\"uid\"]\n                                          )\n    @authentication.update_attributes(\n                                      :token =&gt; auth_hash['credentials']['token'],\n                                      :refresh_token =&gt; auth_hash['credentials']['refresh_token'],\n                                      :provider_description =&gt; auth_hash[\"info\"].email\n                                    )\n\n    flash[:notice] = \"google_oauth2 authed.\"\n    redirect_to '/'\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "omniauth", "google-api-ruby-client"], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1580839473, "post_id": 50793014, "comment_id": 106227182, "body": "And would I put this module in the helper folder? I suppose Rails magic will allow for use of these module anywhere?"}], "tags": [], "owner": {"reputation": 2513, "user_id": 1280753, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/JL2ZV.gif?s=128&g=1", "display_name": "Quv", "link": "https://stackoverflow.com/users/1280753/quv"}, "is_accepted": false, "score": 4, "last_activity_date": 1528707488, "last_edit_date": 1528707488, "creation_date": 1528704292, "answer_id": 50793014, "question_id": 38111151, "link": "https://stackoverflow.com/questions/38111151/how-to-authorize-the-google-api-ruby-client/50793014#50793014", "title": "How to authorize the google-api-ruby-client?", "body": "<p>I too was stuck. IMO Google should have more elaborated in their documents, especially since all we had to do was just adding one request header... </p>\n\n<p>Anyway, here is one example.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#\n# Note I don't think we always have to define a class with such a conflict-prone name. \n# An anonymous class defined before every single API call should be also fine.\n#\nmodule Google\n  class AccessToken\n    attr_reader :token\n    def initialize(token)\n      @token = token\n    end\n\n    def apply!(headers)\n      headers['Authorization'] = \"Bearer #{@token}\"\n    end\n  end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Drive = Google::Apis::DriveV2\ndrive = Drive::DriveService.new\ndrive.authorization = Google::AccessToken.new your_token\n</code></pre>\n\n<p>Reference: <a href=\"https://github.com/google/google-api-ruby-client/issues/296\" rel=\"nofollow noreferrer\">https://github.com/google/google-api-ruby-client/issues/296</a></p>\n"}, {"tags": [], "owner": {"reputation": 658, "user_id": 1392282, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXgG4.jpg?s=128&g=1", "display_name": "Nuno Silva", "link": "https://stackoverflow.com/users/1392282/nuno-silva"}, "is_accepted": false, "score": 1, "last_activity_date": 1530012661, "creation_date": 1530012661, "answer_id": 51041855, "question_id": 38111151, "link": "https://stackoverflow.com/questions/38111151/how-to-authorize-the-google-api-ruby-client/51041855#51041855", "title": "How to authorize the google-api-ruby-client?", "body": "<p>Similarly to other answers I followed this approach, where the model storing the auth and refresh tokens is used, abstracting API interactions from that logic.</p>\n\n<pre><code># Manages access tokens for users when using Google APIs\n#\n# Usage:\n# require 'google/apis/gmail_v1'\n# Gmail = Google::Apis::GmailV1 # Alias the module\n# service = Gmail::GmailService.new\n# service.authorization = GoogleOauth2Authorization.new user\n# service.list_user_messages(user.email)\n#\n# See also:\n# https://github.com/google/google-api-ruby-client/issues/296\nclass GoogleOauth2Authorization\n  attr_reader :user\n\n  def initialize(user)\n    @user = user\n  end\n\n  def apply!(headers)\n    headers['Authorization'] = \"Bearer #{token}\"\n  end\n\n  def token\n    refresh! if user.provider_token_expires_at.past?\n    user.provider_access_token\n  end\n\n  private\n\n  def refresh!\n    new_token = oauth_access_token(\n      user.provider_access_token,\n      user.provider_refresh_token\n    ).refresh!\n    if new_token.present?\n      user.update(\n        provider_access_token: new_token.token,\n        provider_token_expires_at: Time.zone.at(new_token.expires_at),\n        provider_refresh_token: new_token.refresh_token\n      )\n    end\n    user\n  end\n\n  def oauth_access_token(access_token, refresh_token)\n    OAuth2::AccessToken.new(\n      oauth_strategy.client,\n      access_token,\n      refresh_token: refresh_token\n    )\n  end\n\n  def oauth_strategy\n    OmniAuth::Strategies::GoogleOauth2.new(\n      nil,\n      Rails.application.credentials.oauth[:google_id],\n      Rails.application.credentials.oauth[:google_secret]\n    )\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 97172, "user_id": 149080, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/685eca46bfebf9233cc276b415a74ddb?s=128&d=identicon&r=PG", "display_name": "AnApprentice", "link": "https://stackoverflow.com/users/149080/anapprentice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2186, "favorite_count": 1, "answer_count": 2, "score": 7, "last_activity_date": 1588814639, "creation_date": 1467239709, "last_edit_date": 1588814639, "question_id": 38111151, "link": "https://stackoverflow.com/questions/38111151/how-to-authorize-the-google-api-ruby-client", "title": "How to authorize the google-api-ruby-client?", "body": "<p>I'm working to get the google-api-ruby-client gem working following the basic usage example here: Basic usage</p>\n\n<pre><code>require 'google/apis/drive_v2'\n\nDrive = Google::Apis::DriveV2 # Alias the module\ndrive = Drive::DriveService.new\ndrive.authorization = ... # See Googleauth or Signet libraries\n\n# Search for files in Drive (first page only)\nfiles = drive.list_files(q: \"title contains 'finances'\")\nfiles.items.each do |file|\n  puts file.title\nend\n</code></pre>\n\n<p>Where I'm stuck is <code>drive.authorization</code>. I have an authorized token already for the user via the gem omniauth-google-oauth2. How do I use that token with google-api-ruby-client?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467240975, "post_id": 38111131, "comment_id": 63656265, "body": "<code>update_all</code> executes a database query. (1) your <code>t</code> is never in the database, so it won&#39;t be affected. Use <code>FactoryGirl.create</code> instead of build. (2) the thread instance stored in <code>t</code> keeps its state in-memory. It won&#39;t be affected by the changes in the database. Try using <code>...to change(t.reload.updated_at)</code> instead."}, {"owner": {"reputation": 149, "user_id": 2966334, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b95236d0d84ab81af28d6f97cb028bb0?s=128&d=identicon&r=PG&f=1", "display_name": "octopushugs", "link": "https://stackoverflow.com/users/2966334/octopushugs"}, "reply_to_user": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467243852, "post_id": 38111131, "comment_id": 63657173, "body": "@Raffael That worked perfectly! I had a feeling it was because t wasn&#39;t, in fact, in the database, but am still new enough at rspec that I hand no idea whether it mattered or not. Thanks!"}], "owner": {"reputation": 149, "user_id": 2966334, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b95236d0d84ab81af28d6f97cb028bb0?s=128&d=identicon&r=PG&f=1", "display_name": "octopushugs", "link": "https://stackoverflow.com/users/2966334/octopushugs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467243456, "creation_date": 1467239577, "last_edit_date": 1467243456, "question_id": 38111131, "link": "https://stackoverflow.com/questions/38111131/how-do-i-test-a-model-method-that-changes-a-separate-model", "title": "How do I test a model method that changes a separate model?", "body": "<p>I'm just starting to learn rspec and am having some trouble figuring out how to test a particular model method. Basically, I have a Thread model that users can reply to. Whenever a reply to that thread is saved, this method is run to update the <code>updated_at</code> column of the Thread.</p>\n\n<pre><code>def update_thread_timestamp\n  Thread.where(id: thread_id).update_all(\"updated_at\" =&gt; Time.now)\nend\n</code></pre>\n\n<p>Here's my rspec test for that method:</p>\n\n<pre><code>it \"#update_thread_timestamp updates the parent thread's updated_at column\" do\n  t = Factory.build(:thread, updated_at: nil)\n  new_comment = Factory.build(:comment, thread_id: t.id)\n  expect{new_comment.update_thread_timestamp}.to change{t.updated_at}\nend\n</code></pre>\n\n<p>The problem here is that whenever I run the test it fails, with this:\n<code>result should have changed, but is still nil</code>. Does rspec have an issue with direct DB calls? I'm at a loss on this one.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "edited": false, "score": 1, "creation_date": 1467239566, "post_id": 38111071, "comment_id": 63655787, "body": "I get a similar error message with <code>it { is_expected.to change { ModelName.count } }</code> - <code>expected result to have changed, but was not given a block</code>"}], "tags": [], "owner": {"reputation": 9845, "user_id": 119822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/wnqih.jpg?s=128&g=1", "display_name": "Andy Waite", "link": "https://stackoverflow.com/users/119822/andy-waite"}, "is_accepted": false, "score": 0, "last_activity_date": 1467239217, "creation_date": 1467239217, "answer_id": 38111071, "question_id": 38111019, "link": "https://stackoverflow.com/questions/38111019/rspec-awkward-syntax-to-test-change-count/38111071#38111071", "title": "rspec awkward syntax to test change count", "body": "<p>As the error message suggests, you need to pass a block, e.g.:</p>\n\n<p><code>\nit { is_expected.to change { ModelName.count } }\n</code></p>\n"}], "owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467239217, "creation_date": 1467238919, "question_id": 38111019, "link": "https://stackoverflow.com/questions/38111019/rspec-awkward-syntax-to-test-change-count", "title": "rspec awkward syntax to test change count", "body": "<p>I have an rspec test that looks like this:</p>\n\n<pre><code>describe 'on DELETE to :destroy' do\n  before do\n    expect { delete :destroy, id: 6 }.to change(ModelName, :count)\n  end\n\n  it { is_expected.to respond_with :success }\n  it { is_expected.to render_template :destroy }\nend\n</code></pre>\n\n<p>I find it awkward having the test on change count inside the <code>before</code> block, and I don't need to run it twice. I'm hoping to find a syntax something like this instead:</p>\n\n<pre><code>describe 'on DELETE to :destroy' do\n  before do\n    delete :destroy, id: 6\n  end\n\n  it { is_expected.to respond_with :success }\n  it { is_expected.to render_template :destroy }\n  it { is_expected.to change(ModelName, :count) }\nend\n</code></pre>\n\n<p>However the third test gives me the following error: </p>\n\n<pre><code>expected #count to have changed, but was not given a block\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "tdd"], "comments": [{"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467239116, "post_id": 38110920, "comment_id": 63655632, "body": "Maybe the problem is that you stub away the call to <code>redirect_to</code> and then the request ends up getting neither a render nor a redirect. Try <code>receive(:redirect_to).and_call_original</code>."}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467239324, "post_id": 38110920, "comment_id": 63655710, "body": "@Raffael I solved this by the setup below, thoughts?"}], "answers": [{"comments": [{"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467239782, "post_id": 38111086, "comment_id": 63655870, "body": "You are now more strongly decoupling the test for the private method from a concrete controller method. This makes the test more concise. If this private method is used a lot throughout your application, then I love the new approach. Otherwise one might ask whether the added complexity is worth it."}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467239840, "post_id": 38111086, "comment_id": 63655885, "body": "yep, it is used all over which is why I wanted to hit it hard :) thank you for your feedback"}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467239885, "post_id": 38111086, "comment_id": 63655901, "body": "If you do test that way, do it for all examples. I.e. change <code>it &#39;verified&#39;</code> to invoke <code>get &#39;fake&#39;</code>, too, and show that you expect <code>&quot;TESTME&quot;</code> to be rendered."}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467240234, "post_id": 38111086, "comment_id": 63656007, "body": "Another approach would be to test the return value of the private method and then rely on the framework&#39;s behaviour to disrupt your request based on the return value. The approach you chose serves better as documentation, thoug."}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467259613, "post_id": 38111086, "comment_id": 63660814, "body": "thank you so much for your help! would you have thoughts on <a href=\"http://stackoverflow.com/questions/38085404/rails-4-oauth-model-concern-test-coverage-stubs\" title=\"rails 4 oauth model concern test coverage stubs\">stackoverflow.com/questions/38085404/&hellip;</a> by chance?"}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467294900, "post_id": 38111086, "comment_id": 63681522, "body": "Glad it worked out for you :) Please accept and upvote my answer."}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467302516, "post_id": 38111086, "comment_id": 63687629, "body": "there is only one answer on this question, and since I posted it I can not accept it until tomorrow."}], "tags": [], "owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "is_accepted": true, "score": 2, "last_activity_date": 1467239288, "creation_date": 1467239288, "answer_id": 38111086, "question_id": 38110920, "link": "https://stackoverflow.com/questions/38110920/getting-a-delegation-error-in-the-api-controller-test-module-in-rspec/38111086#38111086", "title": "Getting a delegation error in the API controller test module in Rspec", "body": "<p>If anyone is working on a similar issue writing controller specs, here is how I solved this based on these 2 guides: <a href=\"http://codegur.com/22603728/test-user-authentication-with-rspec\" rel=\"nofollow\">http://codegur.com/22603728/test-user-authentication-with-rspec</a> and <a href=\"https://gayleforce.wordpress.com/2012/12/01/testing-rails-before_filter-method/\" rel=\"nofollow\">https://gayleforce.wordpress.com/2012/12/01/testing-rails-before_filter-method/</a>.</p>\n\n<pre><code>describe Api::ApiController, type: :controller do\n  describe '#validate_api_request' do\n    controller(Api::ApiController) do\n      before_filter :validate_api_request\n      def fake\n        render text:  'TESTME'\n      end\n    end\n\n    before do\n      routes.draw { get 'fake', to: 'api/api#fake' }\n    end\n\n    it 'verified' do\n      allow_any_instance_of(described_class).to receive(:api_request_verified?).and_return(true)\n      expect(subject.send(:validate_api_request)).to be_nil\n    end\n\n    it 'unverified' do\n      allow_any_instance_of(described_class).to receive(:api_request_verified?).and_return(false)\n      get 'fake'\n      expect(response.status).to be(401)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3337, "favorite_count": 1, "accepted_answer_id": 38111086, "answer_count": 1, "score": 3, "last_activity_date": 1520386321, "creation_date": 1467238398, "last_edit_date": 1520386321, "question_id": 38110920, "link": "https://stackoverflow.com/questions/38110920/getting-a-delegation-error-in-the-api-controller-test-module-in-rspec", "title": "Getting a delegation error in the API controller test module in Rspec", "body": "<p>I am writing a controller spec to verify this private method and I get the error <code>Module::DelegationError: ActionController::RackDelegation</code> but I am lost as how to fix this.  The best example I have found has been <a href=\"http://owowthathurts.blogspot.com/2013/08/rspec-response-delegation-error-fix.html\" rel=\"nofollow noreferrer\">http://owowthathurts.blogspot.com/2013/08/rspec-response-delegation-error-fix.html</a>.</p>\n\n<p>How can I get the <code>unverified</code> spec to pass? I want to make sure the 401 is returned.</p>\n\n<p><strong>Method</strong></p>\n\n<pre><code>def validate_api_request\n  return four_oh_one unless api_request_verified?(request)\nend\n</code></pre>\n\n<p><strong>Current Spec</strong></p>\n\n<pre><code>describe Api::ApiController, type: :controller do\n  describe '#validate_api_request' do\n    it 'verified' do\n      allow_any_instance_of(described_class).to receive(:api_request_verified?).and_return(true)\n      expect(subject.send(:validate_api_request)).to be_nil\n    end\n\n    it 'unverified' do\n      allow_any_instance_of(described_class).to receive(:api_request_verified?).and_return(false)\n      allow(controller).to receive(:redirect_to)\n      binding.pry\n    end\n  end\nend\n</code></pre>\n\n<p>I'm using Rails 4.</p>\n"}, {"tags": ["ruby", "amazon-s3", "rspec", "rspec-mocks"], "comments": [{"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467238584, "post_id": 38110813, "comment_id": 63655441, "body": "Your code is not invoking <code>put_object</code> on <code>Aws::S3::Client</code> but on an instance thereof. Tell your spies to stop interrogating the poor class and let them unravel the uploader instance&#39;s <code>@s3</code> instance variable instead ;)"}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467238781, "post_id": 38110813, "comment_id": 63655510, "body": "You&#39;d probably want to mock the whole <code>Aws::S3::Client</code> service \u2013 unless you want to establish a connection to their servers for each run of each test."}, {"owner": {"reputation": 452, "user_id": 702383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0FIFS.jpg?s=128&g=1", "display_name": "RCA", "link": "https://stackoverflow.com/users/702383/rca"}, "reply_to_user": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467294473, "post_id": 38110813, "comment_id": 63681184, "body": "@Raffael Thanks! I was thinking that might be the issue, but then was wondering if it would count that it was acting on an instance of the class... oof, my brain is in knots. FWIW, I&#39;m using AWS&#39;s built-in mocking."}], "answers": [{"tags": [], "owner": {"reputation": 452, "user_id": 702383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0FIFS.jpg?s=128&g=1", "display_name": "RCA", "link": "https://stackoverflow.com/users/702383/rca"}, "is_accepted": false, "score": 0, "last_activity_date": 1467299395, "creation_date": 1467299395, "answer_id": 38127108, "question_id": 38110813, "link": "https://stackoverflow.com/questions/38110813/rspec-spies-work-differently-on-two-different-classes/38127108#38127108", "title": "RSpec spies work differently on two different classes", "body": "<p>I ended up mocking out s3 for this particular test.</p>\n\n<pre><code>    it \"sends data to s3\" do\n      test_key = 'test_key'\n      bucket = 'test_bucket'\n      fake_s3 = instance_double(Aws::S3::Client)\n      allow(Aws::S3::Client).to receive(:new).and_return(fake_s3)\n      allow(fake_s3).to receive(:put_object)\n\n      uploader.upload_file(test_key, 'file_path', record=true)\n      expect(fake_s3).to have_received(:put_object).with(\n        {bucket: bucket, key: test_key, body: 'text'})\n    end\n</code></pre>\n"}], "owner": {"reputation": 452, "user_id": 702383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0FIFS.jpg?s=128&g=1", "display_name": "RCA", "link": "https://stackoverflow.com/users/702383/rca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467299395, "creation_date": 1467237803, "question_id": 38110813, "link": "https://stackoverflow.com/questions/38110813/rspec-spies-work-differently-on-two-different-classes", "title": "RSpec spies work differently on two different classes", "body": "<p>I have a class <code>Uploader</code> which takes a file and uploads it to S3. I'm trying to test that <code>@s3</code> is actually receiving a file body when <code>upload_file</code> is called. When I test that <code>File</code> is getting messages sent, the test passes. However, trying to spy on <code>Aws::S3::Client</code> does not work.</p>\n\n<pre><code>class Uploader\n  def initialize(tmp_dir_name, bucket)\n    @base_tmp_dir = tmp_dir_name\n    @s3 = Aws::S3::Client.new(region: 'us-east-1')\n    @bucket = bucket\n    @uploaded_assets = []\n  end\n\n  def upload_file(key, file_path)\n    file = File.new(file_path)\n    @s3.put_object(bucket: @bucket, key: key.to_s, body: file.read)\n  end\nend\n\nRSpec.describe Uploader do\n  let(:bucket) { 'test_bucket' }\n  let(:base_temp_dir) { 'test_temp_dir' }\n  let(:uploader) { Uploader.new(base_temp_dir, bucket) }\n\n  describe \"#upload_file\" do\n    let(:file) { double('file') }\n    before { allow(File).to receive(:new) { file } }\n    before { allow(file).to receive(:read).and_return('text') }\n    before { allow(Aws::S3::Client).to receive(:put_object) }\n\n    it \"uses one file\" do\n      uploader.upload_file('test_key', 'file_path')\n      expect(File).to have_received(:new).with('file_path')\n    end\n\n    it \"sends data to s3\" do\n      uploader.upload_file('test_key', 'file_path')\n      expect(Aws::S3::Client).to have_received(:put_object)\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "file", "text"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user970470"}, "edited": false, "score": 0, "creation_date": 1467235193, "post_id": 38110156, "comment_id": 63653973, "body": "File.open(&quot;text.txt&quot;): are you sure, that your program is in the same folder than your text.txt? if not try a hardcoded path like &quot;c:\\tmp\\text.txt&quot;"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1467236497, "post_id": 38110156, "comment_id": 63654555, "body": "Please use whitespace more effectively in your code. Break things into logical blocks. This is a readability thing and your future self will thank you. Also read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1467236722, "post_id": 38110156, "comment_id": 63654659, "body": "Instead of <code>File.open(&quot;text.txt&quot;).each do |line|</code> then reading line by line, use <code>File.foreach(...)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1467245399, "post_id": 38110183, "comment_id": 63657578, "body": "The thing to remember with Ruby is it will only look in the current directory for files unless you specify otherwise. Putting it on the desktop doesn&#39;t make it magically accessible, in fact it complicates things since that path is a lot longer than in the directory where your script is, or something relative to that."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1467246122, "post_id": 38110183, "comment_id": 63657757, "body": "This will only work if the directory the code is in also accidentally happens to be the current working directory. The problem is that the OP is looking for the file in the current working directory, not that he is looking next to the code."}, {"owner": {"reputation": 31, "user_id": 6499926, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-GK1_Scdxrco/AAAAAAAAAAI/AAAAAAAAAAw/0l3DWfso9Lg/photo.jpg?sz=128", "display_name": "Paul Duca", "link": "https://stackoverflow.com/users/6499926/paul-duca"}, "edited": false, "score": 0, "creation_date": 1467251782, "post_id": 38110183, "comment_id": 63658997, "body": "Question, is there a way to change the current directory I&#39;m looking for the file in? sorry new to comp sci"}, {"owner": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "reply_to_user": {"reputation": 31, "user_id": 6499926, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-GK1_Scdxrco/AAAAAAAAAAI/AAAAAAAAAAw/0l3DWfso9Lg/photo.jpg?sz=128", "display_name": "Paul Duca", "link": "https://stackoverflow.com/users/6499926/paul-duca"}, "edited": false, "score": 0, "creation_date": 1467292142, "post_id": 38110183, "comment_id": 63679409, "body": "@PaulDuca Yeah. You can hard code the path ex &quot;c:\\temp\\text.txt&quot;, Or use rubys <code>__FILE__</code> thingy to program a relative path ex:  <code>File.dirname(__FILE__) + &quot;\\temp\\text.txt&quot;</code> which will look for file in folder temp in the scripts executing directory"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 31, "user_id": 6499926, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-GK1_Scdxrco/AAAAAAAAAAI/AAAAAAAAAAw/0l3DWfso9Lg/photo.jpg?sz=128", "display_name": "Paul Duca", "link": "https://stackoverflow.com/users/6499926/paul-duca"}, "edited": false, "score": 0, "creation_date": 1467324180, "post_id": 38110183, "comment_id": 63699007, "body": "@PaulDuca: This doesn&#39;t really have anything to do with computer science at all. Changing a directory is basic computer usage 101. In all current mainstream operating systems, the command to do so is called or at least aliased to <code>cd</code>. Alternatively, you can do it from within Ruby, the methods are called <code>chdir</code> and <code>cd</code>."}], "tags": [], "owner": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "is_accepted": true, "score": 2, "last_activity_date": 1467234952, "creation_date": 1467234952, "answer_id": 38110183, "question_id": 38110156, "link": "https://stackoverflow.com/questions/38110156/program-cant-find-a-file-even-though-the-file-is-on-my-computer/38110183#38110183", "title": "Program can&#39;t find a file even though the file is on my computer", "body": "<p>Put your code and file into the same directory</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 5389354, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-x6d72FTHp9k/AAAAAAAAAAI/AAAAAAAAAyk/4jsBB7L5l4Q/photo.jpg?sz=128", "display_name": "srinivas kulkarni", "link": "https://stackoverflow.com/users/5389354/srinivas-kulkarni"}, "is_accepted": false, "score": 0, "last_activity_date": 1467235873, "creation_date": 1467235873, "answer_id": 38110380, "question_id": 38110156, "link": "https://stackoverflow.com/questions/38110156/program-cant-find-a-file-even-though-the-file-is-on-my-computer/38110380#38110380", "title": "Program can&#39;t find a file even though the file is on my computer", "body": "<p>Try providing absolute path to the file. Instead of just the file name.</p>\n\n<p>If windows then use double back-slash (\"\\\\\")</p>\n"}], "owner": {"reputation": 31, "user_id": 6499926, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-GK1_Scdxrco/AAAAAAAAAAI/AAAAAAAAAAw/0l3DWfso9Lg/photo.jpg?sz=128", "display_name": "Paul Duca", "link": "https://stackoverflow.com/users/6499926/paul-duca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 38110183, "answer_count": 2, "score": -1, "last_activity_date": 1467235873, "creation_date": 1467234835, "question_id": 38110156, "link": "https://stackoverflow.com/questions/38110156/program-cant-find-a-file-even-though-the-file-is-on-my-computer", "title": "Program can&#39;t find a file even though the file is on my computer", "body": "<p>I have \"text.txt\" saved to my desktop, I have tried moving around where it is and re-saving it as well as renaming it. Yet it still comes back telling it cann't find text.txt. Not sure why? is it the code or the way I am saving it?</p>\n\n<pre><code>   #Set line_count to 0, giving a varible for # of lines\n    line_count = 0\n    #Setting varible text to an empty string, this is where we will collect the text \n    text = ''\n    #Open the file, the each method will send EACH part of the object through the block, every time it sends a line line_count will go up 1\n    #Then add each line to the variable text, now you have saved all your text in one place\n    File.open(\"text.txt\").each do |line|\n      line_count += 1\n      text &lt;&lt; line\n    end \n    puts \"Lines: #{line_count}\"\n    #split up text where there are spaces to determine word count\n    word_count = text.split.length\n    puts \"Words: #{word_count}\"\n    #takes the amount of charaters in the string text - stores it in a variable - then prints it to the console\n    char_count = text.length\n    puts \"Character count: #{char_count}\"\n    #store the string's lengeth without the spaces using a REGEX then print to the console\n    nospace_count = text.gsub(/\\s+/,'').length \n    puts \"Character count without spaces: #{nospace_count}\"\n    puts \"Number of spaces: #{char_count - nospace_count}\"\n    #use REGEX to count the number of sentences save to var\n    sentence_count = text.split(/\\.|\\?|!/).length\n    puts \"Sentences: #{sentence_count}\"\n    #count paragraphs using regular expression and store them in a var\n    para_count = text.split(/\\n\\n/).length\n    puts \"Paragraphs: #{para_count}\"\n    puts \"Sentences per paragraph: #{sentence_count / para_count}\"\n    puts \"Words per sentence: #{word_count/sentence_count}\"\n    stopwords = %w{the a by on for of are with just but and to the my i has in}\n    words = text.scan(/\\w+/)\n    keywords = words.select {|word| !stopwords.include?(word)}\n    puts \"Keywords: #{keywords.length}\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "koala", "koala-gem"], "comments": [{"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467238009, "post_id": 38110147, "comment_id": 63655193, "body": "What does the statement <code>Mutex.ancestors</code> return on both your development and production environments?"}, {"owner": {"reputation": 1, "user_id": 6530482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79411679e367319bfce1811e017cfdb0?s=128&d=identicon&r=PG&f=1", "display_name": "Nonato", "link": "https://stackoverflow.com/users/6530482/nonato"}, "reply_to_user": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467292620, "post_id": 38110147, "comment_id": 63679763, "body": "Hello, thanks for your attention, Mutext.ancestors return this (on production and development):  <code>[Mutex, Object, PP::ObjectMixin, Socket::Constants, ActiveSupport::Dependencies::Loadable, JSON::Ext::Generator::GeneratorMethods::Object, Kernel, BasicObject]</code>"}, {"owner": {"reputation": 1, "user_id": 6530482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79411679e367319bfce1811e017cfdb0?s=128&d=identicon&r=PG&f=1", "display_name": "Nonato", "link": "https://stackoverflow.com/users/6530482/nonato"}, "reply_to_user": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467292912, "post_id": 38110147, "comment_id": 63679973, "body": "this problem seems to be intermittent. Sometimes gives this error, at other times works as it should work."}], "owner": {"reputation": 1, "user_id": 6530482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79411679e367319bfce1811e017cfdb0?s=128&d=identicon&r=PG&f=1", "display_name": "Nonato", "link": "https://stackoverflow.com/users/6530482/nonato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467234811, "creation_date": 1467234811, "question_id": 38110147, "link": "https://stackoverflow.com/questions/38110147/error-when-initialize-koala-gem-undefined-method-synchronize-for-nilnilclas", "title": "Error when initialize Koala Gem - undefined method `synchronize&#39; for nil:NilClass", "body": "<p>I'm using koala version 2.3.0 + omniauth-facebook 3.0.0</p>\n\n<p>I'm trying to do this:</p>\n\n<p><strong>user_facebook_api = Koala::Facebook::API.new(user_facebook_token)\nuser_facebook_api.get_object(\"me\")</strong></p>\n\n<p>When I try this in the console, it returns my profile correctly.</p>\n\n<p>But on the server, it returns this exception</p>\n\n<p><strong>NoMethodError Exception: undefined method `synchronize' for nil:NilClass</strong></p>\n\n<hr>\n\n<p>Does anyone know what could be wrong</p>\n\n<p>Full Trace of Server bellow</p>\n\n<p>Already, thanks</p>\n\n<hr>\n\n<p>Full Trace of Server</p>\n\n<p>/home/nonato/.rvm/rubies/ruby-2.0.0-p643/lib/ruby/2.0.0/singleton.rb:139:in <code>instance'\nmulti_json (1.11.2) lib/multi_json/adapter.rb:21:in</code>load'\nmulti_json (1.11.2) lib/multi_json.rb:119:in <code>load'\nkoala (2.3.0) lib/koala/api.rb:89:in</code>api'\nkoala (2.3.0) lib/koala/api/graph_api.rb:527:in <code>graph_call'\nkoala (2.3.0) lib/koala/api/graph_api.rb:116:in</code>get_connection'\napp/controllers/facebook_integrations_controller.rb:86:in `load_facebook_pages'</p>\n"}, {"tags": ["ruby", "google-apps-script"], "comments": [{"owner": {"reputation": 858, "user_id": 1875195, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3ed18248b30a2d90cf49ea9393097425?s=128&d=identicon&r=PG", "display_name": "user1875195", "link": "https://stackoverflow.com/users/1875195/user1875195"}, "edited": false, "score": 0, "creation_date": 1467238541, "post_id": 38109682, "comment_id": 63655416, "body": "The error is in your script, as the error message says. You&#39;re trying to call <code>getId()</code> on <code>folder</code>, but <code>folder</code> is undefined when you try and call it."}, {"owner": {"reputation": 49, "user_id": 5231685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rGmSE4zfMUs/AAAAAAAAAAI/AAAAAAAAAk4/ew9AZacQOEc/photo.jpg?sz=128", "display_name": "Walter Mercado", "link": "https://stackoverflow.com/users/5231685/walter-mercado"}, "reply_to_user": {"reputation": 858, "user_id": 1875195, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3ed18248b30a2d90cf49ea9393097425?s=128&d=identicon&r=PG", "display_name": "user1875195", "link": "https://stackoverflow.com/users/1875195/user1875195"}, "edited": false, "score": 0, "creation_date": 1467240446, "post_id": 38109682, "comment_id": 63656084, "body": "Yes but it happens because the script cannot receive the name of the folder(environment) If I modified the script to use  function createSpreadsheet() {    environment = &quot;something&quot;;   timestamp = &quot;something&quot;; ....}  Using this it woked but I need to send the paramters from ruby"}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 5231685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rGmSE4zfMUs/AAAAAAAAAAI/AAAAAAAAAk4/ew9AZacQOEc/photo.jpg?sz=128", "display_name": "Walter Mercado", "link": "https://stackoverflow.com/users/5231685/walter-mercado"}, "is_accepted": false, "score": 0, "last_activity_date": 1467285803, "creation_date": 1467285803, "answer_id": 38121690, "question_id": 38109682, "link": "https://stackoverflow.com/questions/38109682/how-to-pass-parameters-in-ruby-for-google-app-script/38121690#38121690", "title": "How to pass Parameters in Ruby for Google App Script", "body": "<p>It was my fault I forgot publishing my last change in the script </p>\n"}], "owner": {"reputation": 49, "user_id": 5231685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rGmSE4zfMUs/AAAAAAAAAAI/AAAAAAAAAk4/ew9AZacQOEc/photo.jpg?sz=128", "display_name": "Walter Mercado", "link": "https://stackoverflow.com/users/5231685/walter-mercado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1467285803, "creation_date": 1467232936, "question_id": 38109682, "link": "https://stackoverflow.com/questions/38109682/how-to-pass-parameters-in-ruby-for-google-app-script", "title": "How to pass Parameters in Ruby for Google App Script", "body": "<p>I have the following script in Google Apps:</p>\n\n<pre><code>function createSpreadsheet(environment, timestamp) { \n  Logger.log(environment);\n  var folders = DriveApp.getFoldersByName(environment); \n  while (folders.hasNext()) {\n   var folder = folders.next();\n  }  \n\n  var testName = timestamp + \".test_\" + environment;\n  Logger.log(testName);\n\n  var file = {\n    \"title\": testName,\n    \"mimeType\": \"application/vnd.google-apps.spreadsheet\",\n    \"parents\": [\n      {\n        \"id\": folder.getId()\n      }\n    ] \n  };\n\n  Drive.Files.insert(file);\n  var allFiles = folder.getFilesByName(testName);\n  var files = {};\n  while (allFiles.hasNext()) {\n   var file = allFiles.next();\n   return file.getId();\n  } \n\n}\n</code></pre>\n\n<p>and from Ruby code I am performing the following call</p>\n\n<pre><code>request = Google::Apis::ScriptV1::ExecutionRequest.new\n    request.function = 'createSpreadsheet'\n    request.parameters = [environment.to_s ,timestamp.to_s ]\n</code></pre>\n\n<p>But it is not working and I get error during the execution of the script:</p>\n\n<pre><code>Script error message: Cannot call method \"getId\" of undefined.\n</code></pre>\n\n<p>What I am doing wrong ? that parameters are a simple strings </p>\n\n<p>Thanks a lot </p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 1, "creation_date": 1467233123, "post_id": 38109479, "comment_id": 63652963, "body": "Why are you doing this, i.e., what&#39;s the use context?  Might there not be a better way to achieve your end goal?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1467235134, "post_id": 38109479, "comment_id": 63653950, "body": "You asked this question more than 40 minutes ago. There are no answers and just one comment. That means nobody understands your question. In your first example, you delete <code>:a</code>, which is at index 1, even though <code>index =  2</code>. What is the rule that leads you to do that? I thought maybe you were deleting the element at <code>index - 1</code>. In the second example, however, when <code>index = 1</code> I expected <code>:b</code> to be deleted, since it is at index <code>index - 1 #=&gt; 0</code>, but no, it&#39;s <code>:a</code> , which is at index 1, that&#39;s deleted. Please edit your question to clarify."}, {"owner": {"reputation": 37, "user_id": 1672700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fbe1fde302a8e725214dc7098c56270?s=128&d=identicon&r=PG", "display_name": "Ian James", "link": "https://stackoverflow.com/users/1672700/ian-james"}, "reply_to_user": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 1, "creation_date": 1467236304, "post_id": 38109479, "comment_id": 63654467, "body": "@pjs: I have a list of players in a game, with an index that keeps track of the current player. Players may have multiple turns, so they&#39;re in the array multiple times. This algorithm is intended to be run when a player exits the game. I&#39;m completely open to refactoring the representation if a better one is presented."}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467237314, "post_id": 38109479, "comment_id": 63654904, "body": "Technically, for this to be a well posed question you should show what you tried so far. I prefer helping you over doing your job. But hey, I&#39;m up for a riddle :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1467249398, "post_id": 38109479, "comment_id": 63658457, "body": "You have remarked about weakness of the code you posted, but are silent on the most important point: does it work? If it does, that should allow readers to figure out the question if they can&#39;t otherwise. I suggest you edit to clarify that."}], "answers": [{"comments": [{"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467237542, "post_id": 38110718, "comment_id": 63655005, "body": "Note that this does not modify the <code>old_array</code> in-place. Let me know if you prefer in-place."}, {"owner": {"reputation": 37, "user_id": 1672700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fbe1fde302a8e725214dc7098c56270?s=128&d=identicon&r=PG", "display_name": "Ian James", "link": "https://stackoverflow.com/users/1672700/ian-james"}, "edited": false, "score": 0, "creation_date": 1467309168, "post_id": 38110718, "comment_id": 63691417, "body": "This looks good. I just replaced the old array and index when done. My original attempt was in-place and it looked pretty ugly."}], "tags": [], "owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "is_accepted": true, "score": 1, "last_activity_date": 1467237332, "creation_date": 1467237332, "answer_id": 38110718, "question_id": 38109479, "link": "https://stackoverflow.com/questions/38109479/delete-an-item-from-array-preserving-indexes/38110718#38110718", "title": "Delete an item from array preserving indexes", "body": "<p>The new index is equal to the number of elements in the old array that</p>\n\n<ul>\n<li>are placed in front of the old index</li>\n<li>will remain in the array</li>\n</ul>\n\n<p>You can count these on the go while constructing the new array like so:</p>\n\n<pre><code>def delete_and_follow(old_array, old_index, unwanted)\n  new_array, new_index = [], 0\n  old_array.each.with_index do |item, idx|\n    unless item == unwanted\n      new_array &lt;&lt; item\n      new_index += 1 if idx &lt; old_index\n    end\n  end\n  new_index = 0 if new_index &gt;= new_array.length\n  [new_array, new_index]\nend\n</code></pre>\n\n<p>Or do the same with less code (though a bit more cryptic):</p>\n\n<pre><code>def delete_and_follow(old_array, old_index, unwanted)\n  new_index = old_array.take(old_index).count{ |item| item != unwanted }\n  new_array = old_array - [unwanted]\n  [new_array, new_index % new_array.length]\nend\n</code></pre>\n\n<p>HTH!</p>\n"}], "owner": {"reputation": 37, "user_id": 1672700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fbe1fde302a8e725214dc7098c56270?s=128&d=identicon&r=PG", "display_name": "Ian James", "link": "https://stackoverflow.com/users/1672700/ian-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 38110718, "answer_count": 1, "score": 2, "last_activity_date": 1467241148, "creation_date": 1467232151, "last_edit_date": 1467241148, "question_id": 38109479, "link": "https://stackoverflow.com/questions/38109479/delete-an-item-from-array-preserving-indexes", "title": "Delete an item from array preserving indexes", "body": "<p>There is an array of objects, many of which appear in the array several times. There is an index to a specific location of one item. I want to delete one object from the array at all locations, while maintaining the index. An index to the deleted item should move to the next available item, and if there is none then it should wrap back around to the beginning of the array.</p>\n\n<p>I don't think I'm explaining it very well, so here's a simple example:</p>\n\n<pre><code>array = [:b, :a, :b]\nindex = 2\n</code></pre>\n\n<p>Now delete <code>:a</code> from the array, and the index should now be 1, since the second <code>:b</code> is now at index 1.</p>\n\n<p>Let's say an index points to the deleted object, it should move to the next available object. So if indexes had been 1 it would not change since it would now point to <code>:b</code> which immediately followed <code>:a</code>.</p>\n\n<p>Here's a wraparound example:</p>\n\n<pre><code>array = [:b, :a]\nindex = 1\n</code></pre>\n\n<p>If you delete <code>:a</code> then the index should wrap around to the next available index, or 0.</p>\n\n<p>Seems simple, but there are much more complicated edge cases. Here's the most complex example I could think of:</p>\n\n<pre><code>array = [:a, :a, :b, :a, :c, :b, :a]\n</code></pre>\n\n<p>After deleting ':a', the resulting array is <code>[:b, :c, :b]</code>. From all possible starting indexes (0 to 6) they should change to 0, 0, 0, 1, 1, 2, 0.</p>\n\n<p>Assume there is more than one object in the array, so it never becomes empty after deletion.</p>\n\n<p>(Edit)</p>\n\n<p>Thanks to @Raffael for informing me that I should include what I've tried so far. Here was my first attempt:</p>\n\n<ul>\n<li><code>@items</code> is the array.</li>\n<li><code>@current_item_index</code> is the index that needs to be adjusted.</li>\n<li><code>item</code> is the item being deleted.</li>\n</ul>\n\n<p>The code:</p>\n\n<pre><code>indexes = @items.each_index.each_with_object([]) do |i, memo|\n  memo &lt;&lt; i if @items[i] == item\nend\n\nindexes.reverse.each do |i|\n  @items.delete_at(i)\n  @current_item_index -= 1 if i &lt; @current_item_index\n  @current_item_index = 0 unless @current_item_index &lt; @items.size\nend\n</code></pre>\n\n<p>It just didn't seem very \"Ruby\" (not clear nor concise). Also doesn't seem very performant, as it runs through the list twice -- not to mention all those <code>delete_at</code> calls which can't be good.</p>\n"}, {"tags": ["html", "css", "ruby-on-rails", "ruby", "twitter-bootstrap"], "comments": [{"owner": {"reputation": 8244, "user_id": 3258604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qSe35.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/3258604/max"}, "edited": false, "score": 3, "creation_date": 1467231201, "post_id": 38109051, "comment_id": 63651990, "body": "<code>progress</code> class appears in Bootstrap, use another class like <code>custom-progress</code>."}], "owner": {"reputation": 83, "user_id": 6415738, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/080Rq.png?s=128&g=1", "display_name": "Akamaru", "link": "https://stackoverflow.com/users/6415738/akamaru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467231381, "creation_date": 1467230466, "last_edit_date": 1467231381, "question_id": 38109051, "link": "https://stackoverflow.com/questions/38109051/css-progress-bar-not-displaying-properly", "title": "CSS progress bar not displaying properly", "body": "<p>I'm trying to create a quiz using CSS and HTML in Rails but I can't get the progress bar working. It's using bootstrap but I'm wondering if its the css or bootstrap that's making it not work as intended. When I put my code into jsfiddle it works fine, and displays as circles, but when I try it in rails its just one fixed progress bar.</p>\n\n<p>CSS</p>\n\n<pre><code>@import \"bootstrap-sprockets\";\n@import \"bootstrap\";\n@import \"bootstrap/theme\";\n\n/*Progress Rec Quiz styling */\n\n#myQuiz .progress  {\n  width: 550px;\n  position: absolute;\n  top: 160px;\n  left: 40px;\n}\n\n#myQuiz .progress div {\n  position: relative;\n  display: inline-block;\n  width: 30px;\n  height: 30px;\n  margin-right: 30px;\n  border-radius: 50%;\n  background-color: rgba(255,255,255,.2);\n  transition: background-color 1s;\n  left: 40px;\n}\n</code></pre>\n\n<p>HTML</p>\n\n<pre><code>&lt;div id=\"myQuiz\"&gt;\n  &lt;h1&gt;Test your knowledge &lt;span&gt;Loser&lt;/span&gt;&lt;/h1&gt;\n  &lt;div class=\"progress\"&gt;\n    &lt;div class=\"on\" &gt;&lt;/div&gt;\n    &lt;div class=\"on\" &gt;&lt;/div&gt;\n    &lt;div class=\"on\" &gt;&lt;/div&gt;\n    &lt;div class=\"on\" &gt;&lt;/div&gt;\n    &lt;div class=\"on\" &gt;&lt;/div&gt;\n    &lt;div class=\"on\" &gt;&lt;/div&gt;\n    &lt;div class=\"on\" &gt;&lt;/div&gt;\n    &lt;div class=\"on\" &gt;&lt;/div&gt;\n    &lt;div class=\"on\" &gt;&lt;/div&gt;\n    &lt;div class=\"on\" &gt;&lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 1367812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a6526ffc4ad9a84f6ff47696eb90724?s=128&d=identicon&r=PG", "display_name": "MRFS", "link": "https://stackoverflow.com/users/1367812/mrfs"}, "is_accepted": false, "score": 0, "last_activity_date": 1487703186, "creation_date": 1487703186, "answer_id": 42375640, "question_id": 38108727, "link": "https://stackoverflow.com/questions/38108727/how-to-export-data-as-a-xes-file-in-rails/42375640#42375640", "title": "How to export data as a XES file in rails?", "body": "<p>A simple method would be imported in Disco and by using this tool, exported in XES format ( I always use this method). \nIf you don't access to Disco another solution would be used ProM software. There is a plugin for this platform for converting CSV file to XES format ( developed by F. Mannhardt).</p>\n"}], "owner": {"reputation": 307, "user_id": 5038430, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/5204453ba2cc1073bdf30b1fa68030e9?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro", "link": "https://stackoverflow.com/users/5038430/leandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521389990, "creation_date": 1467229353, "question_id": 38108727, "link": "https://stackoverflow.com/questions/38108727/how-to-export-data-as-a-xes-file-in-rails", "title": "How to export data as a XES file in rails?", "body": "<p>I am working on a application that allows users upload and edit CSV files containing process activity logs. \nI am not storing the data in the database. \nSo far the user can download the data as a new .csv file. </p>\n\n<p>Now I want to convert that data into a XES file (this a special XML format used mainly for process mining in tools such as ProM framework).</p>\n\n<p>I couldn't find any hint on how to do that. \nI wonder if there's a rails gem or something.</p>\n\n<p>Thanks in advance</p>\n\n<p>ps.: <a href=\"https://github.com/llevvi/pesquisa-iff\" rel=\"nofollow\">here</a> is the project code. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1467238022, "last_edit_date": 1467238022, "creation_date": 1467231879, "answer_id": 38109411, "question_id": 38108704, "link": "https://stackoverflow.com/questions/38108704/activerrecordquerymethods-where-spawn-object-comes-from/38109411#38109411", "title": "ActiverRecord::QueryMethods Where spawn object comes from?", "body": "<p>The following <code>module</code>s are all included in <code>ActiveRecord::Relation</code>: (rails/activerecord/lib/active_record/relation.rb)</p>\n\n<ul>\n<li>FinderMethods</li>\n<li>Calculations</li>\n<li>SpawnMethods</li>\n<li>QueryMethods  </li>\n<li>Batches </li>\n<li>Explain </li>\n<li>Delegation </li>\n</ul>\n\n<p>This is what allows you you to continually chain these methods together as they will always return an <code>ActiveRecord::Relation</code> object.</p>\n\n<p>So both your guesses are correct. When a <code>ActiveRecord::Relation</code> is returned it will use the <code>SpawnMethods</code> definition and when a <code>ActiveRecord::Associations::CollectionProxy</code> is returned it will use the <code>scope</code> definition aliased as <code>spawn</code>. </p>\n\n<p>See the <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L18\" rel=\"nofollow\"><code>ActiveRecord::Relation</code> Code</a> for more details.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4069050"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1467238022, "creation_date": 1467229262, "last_edit_date": 1592644375, "question_id": 38108704, "link": "https://stackoverflow.com/questions/38108704/activerrecordquerymethods-where-spawn-object-comes-from", "title": "ActiverRecord::QueryMethods Where spawn object comes from?", "body": "<p>I am reading Rails source code of ActiverRecord::QueryMethods to understand how   SQL of eager_load created.</p>\n<p>I have gotten a question. Where is <code>spawn</code> object comes from? Moreover, I would like to ask how do <code>eager_load</code>, <code>includes</code>, <code>preload</code> work.</p>\n<h1>ActiveRecord::QueryMethods</h1>\n<h3>rails/activerecord/lib/active_record/relation/query_methods.rb</h3>\n<pre><code>module ActiveRecord\n  module QueryMethods\n    extend ActiveSupport::Concern\n    class WhereChain\n\n    #leave out some codes\n\n     def eager_load(*args)\n       check_if_method_has_arguments!(&quot;eager_load&quot;, args)\n       spawn.eager_load!(*args)\n       \n       #-----------------\n        Where spawn object comes from?\n       #-----------------\n     end\n  end\nend\n</code></pre>\n<p>It seems spawn_methods file does something but I can not find require file</p>\n<h1>My guess 1 : ActiveRecord::SpawnMethods</h1>\n<h3>rails/activerecord/lib/active_record/relation/spawn_methods.rb</h3>\n<pre><code>module ActiveRecord\n  module SpawnMethods\n    def spawn #:nodoc:\n      clone\n    end\n  end\nend\n</code></pre>\n<h1>My guess 2 : ActiveRecord::Associations</h1>\n<h3>rails/activerecord/lib/active_record/associations/collection_proxy.rb</h3>\n<pre><code>module ActiveRecord\n  module Associations\n    class CollectionProxy &lt; Relation\n\n      def scope\n        @association.scope\n      end\n      alias spawn scope\n    end\n  end\nend\n</code></pre>\n<p>**If you have any advise to read code effectively, please give me some. I will appreciate it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "is_accepted": true, "score": 2, "last_activity_date": 1467229852, "last_edit_date": 1495542398, "creation_date": 1467229852, "answer_id": 38108881, "question_id": 38108700, "link": "https://stackoverflow.com/questions/38108700/capybara-find-anchor-element-by-data-attribute/38108881#38108881", "title": "Capybara find anchor element by data attribute", "body": "<p>Figured it out.  I needed to specify the css selector for the data attribute.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5324415/select-elements-by-data-attribute-in-css\">This question shows the syntax</a> for a css selector by data attribute.  I then just had to apply that to the capybara <code>find</code> method like so:    </p>\n\n<pre><code>find(\u2018a[data-delete-association-field-name=\"item[item_orders_attributes][0][_destroy]\"]\u2019).click\n</code></pre>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "accepted_answer_id": 38108881, "answer_count": 1, "score": 1, "last_activity_date": 1467229852, "creation_date": 1467229249, "last_edit_date": 1495535337, "question_id": 38108700, "link": "https://stackoverflow.com/questions/38108700/capybara-find-anchor-element-by-data-attribute", "title": "Capybara find anchor element by data attribute", "body": "<p>With <a href=\"https://rubygems.org/gems/capybara\" rel=\"nofollow noreferrer\">capybara</a> I am trying to find an anchor element by its data attribute so that I can click it.  This anchor element is dynamic so the easiest way for me to grab it is by its data attribute.</p>\n\n<p>I did look at the Capybara docs on the <a href=\"http://www.rubydoc.info/github/jnicklas/capybara/master/Capybara/Node/Finders#find-instance_method\" rel=\"nofollow noreferrer\">find method</a>, and <a href=\"https://stackoverflow.com/questions/34092985/find-elements-by-data-attributes\">this similar question's suggestion</a> was not working out for me.  I am either making a syntax error or I am missing something.</p>\n\n<p>Within my anchor tag here is my data attribute:</p>\n\n<pre><code>data-delete-association-field-name=\u201citem[item_orders_attributes][0][_destroy]\"\n</code></pre>\n\n<p>So with Capybara I am ultimately trying to find the anchor tag with that data attribute and then click it.  Here is my current implementation which is not working:</p>\n\n<pre><code>find(\u2018a[data-delete-association-field-name=item[item_orders_attributes][0][_destroy]]\u2019).click\n</code></pre>\n"}, {"tags": ["ruby", "puppet", "facter"], "comments": [{"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1467243134, "post_id": 38108560, "comment_id": 63656991, "body": "Is this Facter 2 or Facter 3? Facter 3 was rewritten in c++11. Also, this is not what Facter was meant to do (it is for collecting server information). You may want to consider another tool."}, {"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "reply_to_user": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1467289617, "post_id": 38108560, "comment_id": 63677592, "body": "@MattSchuchard What tool do you recommend?"}], "answers": [{"comments": [{"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1467243203, "post_id": 38108871, "comment_id": 63657012, "body": "You are retrieving information via http/apache so <code>open-uri</code> is necessary here."}, {"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "reply_to_user": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1467279086, "post_id": 38108871, "comment_id": 63670337, "body": "But why did no issue occur when puppet3 was used?"}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1467283200, "post_id": 38108871, "comment_id": 63673273, "body": "Probably you were using Facter 2 and it was requiring/including <code>open-uri</code> higher up, and you are now using Facter 3 and it is not because of the rewrite."}, {"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "reply_to_user": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1467289583, "post_id": 38108871, "comment_id": 63677567, "body": "@MattSchuchard <code>&#47;opt&#47;puppetlabs&#47;bin&#47;facter --version: 3.2.0</code>"}, {"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "reply_to_user": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1467289679, "post_id": 38108871, "comment_id": 63677644, "body": "@MattSchuchard Could you post your explanation and suggested workaround as an answer?"}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1467299660, "post_id": 38108871, "comment_id": 63685504, "body": "You answered it already, so maybe just edit your answer to include something about the change in included gems inside Facter once the http code changed from ruby to c++11."}], "tags": [], "owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "is_accepted": true, "score": 0, "last_activity_date": 1467229824, "creation_date": 1467229824, "answer_id": 38108871, "question_id": 38108560, "link": "https://stackoverflow.com/questions/38108560/why-could-rb-sysopen-not-be-found-anymore-by-the-custom-fact-since-the-upgrade/38108871#38108871", "title": "Why could `rb_sysopen` not be found anymore by the custom fact since the upgrade to Puppet4?", "body": "<p><strong>Concise</strong></p>\n\n<p>I will include <code>require 'open-uri'</code> in both facts, but I do not understand why this is required since the upgrade to Puppet4</p>\n\n<p><strong>Verbose</strong></p>\n\n<p>Once <code>require 'open-uri'</code> is included in one of the custom facts the issue is solved.</p>\n\n<pre><code># returns latest gitversion, e.g. 2.8.2\nFacter.add(\"latest_gitversion\") do\n  setcode do\nrequire 'open-uri'\n\n    url=\"https://git-scm.com/downloads\"\n\n    file = open(\"#{url}\")\n    contents = file.read()\n\n    match = contents.match(/RelNotes.*((\\d\\.){2}\\d)/)\n    match[1]\n  end\nend\n</code></pre>\n\n<p>As soon as the <code>require 'open-uri'</code> has been commented out, the issue occurs again:</p>\n\n<pre><code>Error: Facter: error while resolving custom fact \"latest_gitversion\": No such file or directory @ rb_sysopen - https://git-scm.com/downloads\nError: Facter: error while resolving custom fact \"latest_packerversion\": No such file or directory @ rb_sysopen - https://www.packer.io/downloads.html\n</code></pre>\n\n<p>At the moment it is unclear what is causing the issue.</p>\n"}], "owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 38108871, "answer_count": 1, "score": 1, "last_activity_date": 1467257587, "creation_date": 1467228758, "last_edit_date": 1467257587, "question_id": 38108560, "link": "https://stackoverflow.com/questions/38108560/why-could-rb-sysopen-not-be-found-anymore-by-the-custom-fact-since-the-upgrade", "title": "Why could `rb_sysopen` not be found anymore by the custom fact since the upgrade to Puppet4?", "body": "<p>The following <a href=\"https://github.com/030/puppet-packer/blob/master/lib/facter/latest_packerversion.rb\" rel=\"nofollow\">custom fact</a>:</p>\n\n<pre><code># returns latest packerversion, e.g. 0.10.1\nFacter.add(\"latest_packerversion\") do\n  setcode do\n    url=\"https://www.packer.io/downloads.html\"\n\n    file = open(\"#{url}\")\n    contents = file.read()\n\n    match = contents.match(/Latest\\sversion:\\s(.*)&lt;/)\n    match[1]\n  end\nend\n</code></pre>\n\n<p>worked using puppet <code>3.6.2</code>, but since the upgrade to <code>4.5.2</code> the <a href=\"https://github.com/030/puppet-packer/issues/4\" rel=\"nofollow\">following issue</a> occurs:</p>\n\n<pre><code>Error: Facter: error while resolving custom fact \"latest_packerversion\":\nNo such file or directory @ rb_sysopen - https://www.packer.io/downloads.html\n</code></pre>\n\n<p><strong>Analysis</strong></p>\n\n<ul>\n<li>It seems that the <code>rb_sysopen</code> could not be found anymore for some reason (<code>No such file or directory @ rb_sysopen</code>) since the upgrade to Puppet 4.</li>\n<li>Puppet4 seems to use an embedded ruby version instead of the one installed on the host (Puppet3): </li>\n</ul>\n\n<blockquote>\n  <p><a href=\"https://docs.puppet.com/puppet/4.0/reference/release_notes.html#all-in-one-packaging\" rel=\"nofollow\">Puppet 4, both Facter 2.4 and CFacter 0.4, the latest Hiera and\n  Mcollective, as well Ruby 2.1.5, OpenSSL 1.0.0r, and our gem\n  dependencies.</a></p>\n</blockquote>\n\n<ul>\n<li>Does <code>rb_sysopen</code> not exist in Ruby 2.1.5? No evidence was found.</li>\n<li>Perhaps a change related to facts have occurred that could cause the issue? Nothing related was found <a href=\"https://docs.puppet.com/puppet/4.0/reference/release_notes.html#puppet-4.0-release-notes\" rel=\"nofollow\">in the release notes</a>.</li>\n</ul>\n\n<p><strong>Question</strong></p>\n\n<p>Why could <code>rb_sysopen</code> not be found anymore by the custom fact since the upgrade to Puppet4?</p>\n"}, {"tags": ["html", "ruby", "regex", "replace"], "comments": [{"owner": {"reputation": 1473, "user_id": 3841431, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4b711dfcaa497d4fea7ca03e198b16f?s=128&d=identicon&r=PG&f=1", "display_name": "wpcarro", "link": "https://stackoverflow.com/users/3841431/wpcarro"}, "edited": false, "score": 0, "creation_date": 1467229859, "post_id": 38108556, "comment_id": 63651307, "body": "So if I understand this correctly, you&#39;re trying to do 2 things with regex? One of which is remove the <code>&lt;span&gt;...&lt;&#47;span&gt;</code>s containing YouTube embeds? And the second is to capture the IDs of those YouTube embeds?"}, {"owner": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "reply_to_user": {"reputation": 1473, "user_id": 3841431, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4b711dfcaa497d4fea7ca03e198b16f?s=128&d=identicon&r=PG&f=1", "display_name": "wpcarro", "link": "https://stackoverflow.com/users/3841431/wpcarro"}, "edited": false, "score": 0, "creation_date": 1467230011, "post_id": 38108556, "comment_id": 63651378, "body": "@wcarroll that is correct. Doing the two operations separately is fine. I would like to match the IDs of the embeds and for each ID I find, replace the YouTube embed and it&#39;s container with custom HTML I generate. My current RegEx finds the beginning of the first embed (<code>&lt;span&gt;</code>) and matches with the end of the second embed (<code>&lt;&#47;span&gt;</code>) which is not what I want, obviously."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1467230768, "post_id": 38108556, "comment_id": 63651764, "body": "It&#39;s strongly recommended you use a parser rather than regular expressions when working with HTML or XML. See <a href=\"http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags?rq=1\" title=\"regex match open tags except xhtml self contained tags\">stackoverflow.com/questions/1732348/&hellip;</a> for a historical discussion. The defacto parser for Ruby is <a href=\"http://www.nokogiri.org\" rel=\"nofollow noreferrer\">Nokogiri</a>. Nokogiri makes it easy to find particular nodes, extract information, and modify the DOM without using <code>sub</code> or <code>gsub</code>."}, {"owner": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1467231240, "post_id": 38108556, "comment_id": 63652011, "body": "@theTinMan that definitely makes sense rather than using <code>gsub</code>. Thanks for this reminder."}], "answers": [{"comments": [{"owner": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "edited": false, "score": 0, "creation_date": 1467231014, "post_id": 38109056, "comment_id": 63651888, "body": "Fantastic, thank you so much for this. The first regex seems to work wonderfully for my purpose, though the second one doesn&#39;t seem to work with the example I&#39;ve posted. I did alter it to <code>&lt;span.+?&gt;\\s*&lt;iframe.+?&gt;.*?&lt;\\&#47;iframe&gt;\\s*&lt;\\&#47;span&gt;</code> to account for the <code>&lt;span&gt;</code> attributes, but it still does not seem to be working."}, {"owner": {"reputation": 1473, "user_id": 3841431, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4b711dfcaa497d4fea7ca03e198b16f?s=128&d=identicon&r=PG&f=1", "display_name": "wpcarro", "link": "https://stackoverflow.com/users/3841431/wpcarro"}, "reply_to_user": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "edited": false, "score": 0, "creation_date": 1467231151, "post_id": 38109056, "comment_id": 63651958, "body": "Let me take another look."}, {"owner": {"reputation": 1473, "user_id": 3841431, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4b711dfcaa497d4fea7ca03e198b16f?s=128&d=identicon&r=PG&f=1", "display_name": "wpcarro", "link": "https://stackoverflow.com/users/3841431/wpcarro"}, "reply_to_user": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "edited": false, "score": 1, "creation_date": 1467231246, "post_id": 38109056, "comment_id": 63652017, "body": "How about this? <code>&lt;span.*?&gt;\\s*&lt;iframe.+?&gt;.*?&lt;\\&#47;iframe&gt;\\s*&lt;\\&#47;span&gt;</code> I&#39;ll edit my answer if this works for you. Make sure the flags are set to <code>g</code> and <code>s</code>. This is working here. <a href=\"https://regex101.com/r/nF0bQ6/1\" rel=\"nofollow noreferrer\">regex101.com/r/nF0bQ6/1</a> Do you have additional content for which this fails?"}, {"owner": {"reputation": 1473, "user_id": 3841431, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4b711dfcaa497d4fea7ca03e198b16f?s=128&d=identicon&r=PG&f=1", "display_name": "wpcarro", "link": "https://stackoverflow.com/users/3841431/wpcarro"}, "reply_to_user": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "edited": false, "score": 0, "creation_date": 1467231427, "post_id": 38109056, "comment_id": 63652111, "body": "Great. I&#39;ll edit my response and then can you mark it as correct?"}], "tags": [], "owner": {"reputation": 1473, "user_id": 3841431, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4b711dfcaa497d4fea7ca03e198b16f?s=128&d=identicon&r=PG&f=1", "display_name": "wpcarro", "link": "https://stackoverflow.com/users/3841431/wpcarro"}, "is_accepted": false, "score": 1, "last_activity_date": 1467231463, "last_edit_date": 1467231463, "creation_date": 1467230498, "answer_id": 38109056, "question_id": 38108556, "link": "https://stackoverflow.com/questions/38108556/regex-to-find-url-parameters-in-html-ruby/38109056#38109056", "title": "Regex to find URL parameters in HTML (Ruby)", "body": "<p>To grab the YouTube IDs, I think the best way would be to use look-arounds. The following should work.</p>\n\n<pre><code>(?&lt;=embed\\/)(.+?)(?=\\?)\n</code></pre>\n\n<p>Here's a <a href=\"https://regex101.com/r/wL1sI4/1\" rel=\"nofollow\">link to a demonstration</a> on regex101.com</p>\n\n<p>Turn on the \"global\" flag so that the regex engine doesn't stop after finding the first match. This regex uses a look-behind, <code>(?&lt;=embed\\/)</code>; followed by a capturing group that matches wildcard characters in a non-greedy fashion, <code>(.+?)</code>; followed by a look-ahead that asserts a literal question mark, <code>(?=\\?)</code>.</p>\n\n<p>This should suffice in grabbing the video IDs.</p>\n\n<p>As for replacing the HTML, here's a regex that will match the <code>&lt;span&gt;...&lt;/span&gt;</code> blocks:</p>\n\n<pre><code>&lt;span.*?&gt;\\s*&lt;iframe.+?&gt;.*?&lt;\\/iframe&gt;\\s*&lt;\\/span&gt;\n</code></pre>\n\n<p>For this to work, apply the <code>s</code> flag to the regex engine so that <code>.</code> wildcard characters can match <code>\\/n</code> newline characters. Also apply the <code>g</code> flag for the same reasons mentioned previously.</p>\n\n<p>NOTE: this will capture any <code>&lt;span&gt;</code> groups that have <code>&lt;iframe&gt;</code>s as direct children. Depending on the content with which you are working, you may need to add more specificity to the regex to scan the attributes on those <code>&lt;iframe&gt;</code>s. For the content you provided to this question, however, it appears to work.</p>\n\n<p>Let me know if you'd like any clarification or additional functionality.</p>\n\n<p>Here's a <a href=\"https://regex101.com/r/jB2qH0/1\" rel=\"nofollow\">link to a demonstration</a> on regex101.com.</p>\n"}, {"comments": [{"owner": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "edited": false, "score": 0, "creation_date": 1467232789, "post_id": 38109464, "comment_id": 63652785, "body": "I may have to use a mashup of both methods, I only want to pull <code>&lt;span&gt;</code> nodes that have embedded YouTube videos within them."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "edited": false, "score": 1, "creation_date": 1467232971, "post_id": 38109464, "comment_id": 63652884, "body": "No, it&#39;s possible to do without complex regex, using Nokogiri and URI. Read  about CSS selectors and how to search inside parameters, or learn about XPath. Those have been discussed many times here on SO, and on the internet."}, {"owner": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "edited": false, "score": 0, "creation_date": 1467238760, "post_id": 38109464, "comment_id": 63655494, "body": "Okay, you were definitely correct. Just got this working really elegantly and simply using Nokogiri. Thanks a lot!"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "edited": false, "score": 1, "creation_date": 1467242765, "post_id": 38109464, "comment_id": 63656875, "body": "I&#39;m glad it helped. The benefits for using a parser don&#39;t really kick in until you&#39;ve written several scrapers or spiders and see how easy it is to root around in the DOM, or you&#39;re parsing XML or manipulating it. Regex break so easily, especially with tiny changes to the HTML or XML, and having to support a fragile solution is enough to make anyone scream."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 2, "last_activity_date": 1467232469, "last_edit_date": 1467232469, "creation_date": 1467232064, "answer_id": 38109464, "question_id": 38108556, "link": "https://stackoverflow.com/questions/38108556/regex-to-find-url-parameters-in-html-ruby/38109464#38109464", "title": "Regex to find URL parameters in HTML (Ruby)", "body": "<p>Don't use regular expressions for this. There are existing tools to make it much easier:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::HTML(&lt;&lt;EOT)\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;body&gt;\n    &lt;table&gt;\n      &lt;tr&gt;\n        &lt;td&gt;\n          &lt;span&gt;\n            &lt;iframe src=\"//cdn.embedly.com/widgets/media.html?src=https://www.youtube.com/embed/e7zCqsjK1Vg?feature=oembed&amp;amp;url=http://www.youtube.com/watch?v=e7zCqsjK1Vg&amp;amp;image=https://i.ytimg.com/vi/e7zCqsjK1Vg/hqdefault.jpg&amp;amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;amp;type=text/html&amp;amp;schema=youtube\" width=\"600\" height=\"338\" scrolling=\"no\" frameborder=\"0\" allowfullscreen=\"\" style=\"box-sizing: content-box; max-width: 100%; border: 0px;\" fr-original-style=\"box-sizing: content-box; max-width: 100%; border: 0px;\" fr-original-class=\"embedly-embed\"&gt;&lt;/iframe&gt;\n          &lt;/span&gt;\n          &lt;span&gt;\n            &lt;iframe src=\"//cdn.embedly.com/widgets/media.html?src=https://www.youtube.com/embed/skLz87ixE48?feature=oembed&amp;amp;url=http://www.youtube.com/watch?v=skLz87ixE48&amp;amp;image=https://i.ytimg.com/vi/skLz87ixE48/hqdefault.jpg&amp;amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;amp;type=text/html&amp;amp;schema=youtube\" width=\"600\" height=\"338\" scrolling=\"no\" frameborder=\"0\" allowfullscreen=\"\" style=\"box-sizing: content-box; max-width: 100%; border: 0px;\" fr-original-style=\"box-sizing: content-box; max-width: 100%; border: 0px;\" fr-original-class=\"embedly-embed\"&gt;&lt;/iframe&gt;\n          &lt;/span&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\nEOT\n</code></pre>\n\n<p>At this point it's easy to <code>search</code> for the <code>&lt;span&gt;</code> tags. Here's the first one:</p>\n\n<pre><code>doc.search('span').first.to_html\n# =&gt; \"&lt;span&gt;\\n            &lt;iframe src=\\\"//cdn.embedly.com/widgets/media.html?src=https://www.youtube.com/embed/e7zCqsjK1Vg?feature=oembed&amp;amp;url=http://www.youtube.com/watch?v=e7zCqsjK1Vg&amp;amp;image=https://i.ytimg.com/vi/e7zCqsjK1Vg/hqdefault.jpg&amp;amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;amp;type=text/html&amp;amp;schema=youtube\\\" width=\\\"600\\\" height=\\\"338\\\" scrolling=\\\"no\\\" frameborder=\\\"0\\\" allowfullscreen=\\\"\\\" style=\\\"box-sizing: content-box; max-width: 100%; border: 0px;\\\" fr-original-style=\\\"box-sizing: content-box; max-width: 100%; border: 0px;\\\" fr-original-class=\\\"embedly-embed\\\"&gt;&lt;/iframe&gt;\\n          &lt;/span&gt;\"\n</code></pre>\n\n<p><code>last</code> or regular array indexing could be used to find specific instances if necessary.</p>\n\n<p>Instead of using <code>search</code> and <code>first</code>, we can use <code>at</code> instead, which already does them internally:</p>\n\n<pre><code>doc.at('span').to_html\n# =&gt; \"&lt;span&gt;\\n            &lt;iframe src=\\\"//cdn.embedly.com/widgets/media.html?src=https://www.youtube.com/embed/e7zCqsjK1Vg?feature=oembed&amp;amp;url=http://www.youtube.com/watch?v=e7zCqsjK1Vg&amp;amp;image=https://i.ytimg.com/vi/e7zCqsjK1Vg/hqdefault.jpg&amp;amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;amp;type=text/html&amp;amp;schema=youtube\\\" width=\\\"600\\\" height=\\\"338\\\" scrolling=\\\"no\\\" frameborder=\\\"0\\\" allowfullscreen=\\\"\\\" style=\\\"box-sizing: content-box; max-width: 100%; border: 0px;\\\" fr-original-style=\\\"box-sizing: content-box; max-width: 100%; border: 0px;\\\" fr-original-class=\\\"embedly-embed\\\"&gt;&lt;/iframe&gt;\\n          &lt;/span&gt;\"\n</code></pre>\n\n<p>We can dig into a node to grab its parameters:</p>\n\n<pre><code>doc.at('iframe')['src']\n# =&gt; \"//cdn.embedly.com/widgets/media.html?src=https://www.youtube.com/embed/e7zCqsjK1Vg?feature=oembed&amp;url=http://www.youtube.com/watch?v=e7zCqsjK1Vg&amp;image=https://i.ytimg.com/vi/e7zCqsjK1Vg/hqdefault.jpg&amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;type=text/html&amp;schema=youtube\"\n</code></pre>\n\n<p>Once you have a URL, we have tools for manipulating them too:</p>\n\n<pre><code>require 'uri'\niframe = doc.at('iframe')\nuri = URI.parse('http:' + iframe['src'])\n</code></pre>\n\n<p>We can extract the query:</p>\n\n<pre><code>uri.query # =&gt; \"src=https://www.youtube.com/embed/e7zCqsjK1Vg?feature=oembed&amp;url=http://www.youtube.com/watch?v=e7zCqsjK1Vg&amp;image=https://i.ytimg.com/vi/e7zCqsjK1Vg/hqdefault.jpg&amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;type=text/html&amp;schema=youtube\"\n</code></pre>\n\n<p>We can parse it into a hash, making it easy to pick it apart:</p>\n\n<pre><code>URI::decode_www_form(uri.query).to_h['src']\n# =&gt; \"https://www.youtube.com/embed/e7zCqsjK1Vg?feature=oembed\"\n</code></pre>\n\n<p>... or modify it:</p>\n\n<pre><code>query = URI::decode_www_form(uri.query).to_h\nquery['src'] = 'http://example.com'\n\nuri.query = URI::encode_www_form(query)\n\nuri.to_s\n# =&gt; \"http://cdn.embedly.com/widgets/media.html?src=http%3A%2F%2Fexample.com&amp;url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3De7zCqsjK1Vg&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2Fe7zCqsjK1Vg%2Fhqdefault.jpg&amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;type=text%2Fhtml&amp;schema=youtube\"\n</code></pre>\n\n<p>Once you're there, it's easy to modify the HTML if necessary:</p>\n\n<pre><code>iframe['src'] = uri.to_s\niframe.to_html\n# =&gt; \"&lt;iframe src=\\\"http://cdn.embedly.com/widgets/media.html?src=http%3A%2F%2Fexample.com&amp;amp;url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3De7zCqsjK1Vg&amp;amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2Fe7zCqsjK1Vg%2Fhqdefault.jpg&amp;amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;amp;type=text%2Fhtml&amp;amp;schema=youtube\\\" width=\\\"600\\\" height=\\\"338\\\" scrolling=\\\"no\\\" frameborder=\\\"0\\\" allowfullscreen=\\\"\\\" style=\\\"box-sizing: content-box; max-width: 100%; border: 0px;\\\" fr-original-style=\\\"box-sizing: content-box; max-width: 100%; border: 0px;\\\" fr-original-class=\\\"embedly-embed\\\"&gt;&lt;/iframe&gt;\"\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>doc.to_html\n# =&gt; \"&lt;!DOCTYPE html&gt;\\n&lt;html&gt;\\n  &lt;body&gt;\\n    &lt;table&gt;\\n      &lt;tr&gt;\\n        &lt;td&gt;\\n          &lt;span&gt;\\n            &lt;iframe src=\\\"http://cdn.embedly.com/widgets/media.html?src=http%3A%2F%2Fexample.com&amp;amp;url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3De7zCqsjK1Vg&amp;amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2Fe7zCqsjK1Vg%2Fhqdefault.jpg&amp;amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;amp;type=text%2Fhtml&amp;amp;schema=youtube\\\" width=\\\"600\\\" height=\\\"338\\\" scrolling=\\\"no\\\" frameborder=\\\"0\\\" allowfullscreen=\\\"\\\" style=\\\"box-sizing: content-box; max-width: 100%; border: 0px;\\\" fr-original-style=\\\"box-sizing: content-box; max-width: 100%; border: 0px;\\\" fr-original-class=\\\"embedly-embed\\\"&gt;&lt;/iframe&gt;\\n          &lt;/span&gt;\\n          &lt;span&gt;\\n            &lt;iframe src=\\\"//cdn.embedly.com/widgets/media.html?src=https://www.youtube.com/embed/skLz87ixE48?feature=oembed&amp;amp;url=http://www.youtube.com/watch?v=skLz87ixE48&amp;amp;image=https://i.ytimg.com/vi/skLz87ixE48/hqdefault.jpg&amp;amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;amp;type=text/html&amp;amp;schema=youtube\\\" width=\\\"600\\\" height=\\\"338\\\" scrolling=\\\"no\\\" frameborder=\\\"0\\\" allowfullscreen=\\\"\\\" style=\\\"box-sizing: content-box; max-width: 100%; border: 0px;\\\" fr-original-style=\\\"box-sizing: content-box; max-width: 100%; border: 0px;\\\" fr-original-class=\\\"embedly-embed\\\"&gt;&lt;/iframe&gt;\\n          &lt;/span&gt;\\n        &lt;/td&gt;\\n      &lt;/tr&gt;\\n    &lt;/table&gt;\\n  &lt;/body&gt;\\n&lt;/html&gt;\\n\"\n</code></pre>\n\n<p>This isn't exactly an example of how to solve the problem you're asking about, instead it's a reminder that there are existing well-tested wheels based on the specs and we should use them.</p>\n"}], "owner": {"reputation": 650, "user_id": 3308071, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1249110048/picture?type=large", "display_name": "tommybond", "link": "https://stackoverflow.com/users/3308071/tommybond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 38109464, "answer_count": 2, "score": 0, "last_activity_date": 1467232469, "creation_date": 1467228750, "question_id": 38108556, "link": "https://stackoverflow.com/questions/38108556/regex-to-find-url-parameters-in-html-ruby", "title": "Regex to find URL parameters in HTML (Ruby)", "body": "<p>I am attempting to replace embedded YouTube videos with thumbnails in dynamically created email templates. I am attempting to find each YouTube ID from each embedded URL, then replace the entire block with custom HTML. I have it working if there is only one embedded video with the following RegEx: </p>\n\n<pre><code>&lt;span contenteditable=\"false\" draggable=\"true\" fr-original-class=\"fr-video\\sfr-dvb\\sfr-draggable\"\\s.*\\ssrc=\"[a-z:]*?\\/\\/w{3}?.?youtube.com\\/embed\\/([a-zA-Z\\d\\-]*).*&lt;\\/iframe&gt;&lt;\\/span&gt;\n</code></pre>\n\n<p>The problem is, if there is more than one video, it will only find the ID from the last video. I feel like I may be over-complicating this. </p>\n\n<p>Note that the attributes of the span that the embedded video is in will always be the same (<code>contenteditable=\"false\" draggable=\"true\" fr-original-class=\"fr-video</code>). </p>\n\n<p>A sample email template is below, the above RegEx only pulls the second ID from this, not the first. I would like to pull both.</p>\n\n<p>This is being done in Ruby.</p>\n\n<p>EDIT: I realize the RegEx I am using is probably overkill but I need a complex RegEx for the <code>gsub</code> replace so that I only replace the video and it's container, not anything surrounding it.</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta content='text/html; charset=UTF-8' http-equiv='Content-Type'&gt;\n  &lt;/head&gt;\n  &lt;body style='margin: 0px; font-family: Helvetica Neue,Helvetica,Arial,sans-serif; font-size: 18px;'&gt;\n    &lt;table border='0' cellpadding='0' cellspacing='0' style='font-family: Helvetica Neue,Helvetica,Arial,sans-serif; width: 600px;' width='600'&gt;\n      &lt;tr&gt;\n        &lt;td&gt;\n          FooBar\n          &lt;br&gt;\n          &lt;br&gt;\n          &lt;span contenteditable=\"false\" draggable=\"true\" fr-original-class=\"fr-video fr-dvb fr-draggable\" fr-original-style=\"-webkit-user-select: none;\" style=\"-webkit-user-select: none; text-align: center; position: relative; display: block; clear: both;\"&gt;\n            &lt;iframe src=\"//cdn.embedly.com/widgets/media.html?src=https://www.youtube.com/embed/e7zCqsjK1Vg?feature=oembed&amp;amp;url=http://www.youtube.com/watch?v=e7zCqsjK1Vg&amp;amp;image=https://i.ytimg.com/vi/e7zCqsjK1Vg/hqdefault.jpg&amp;amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;amp;type=text/html&amp;amp;schema=youtube\" width=\"600\" height=\"338\" scrolling=\"no\" frameborder=\"0\" allowfullscreen=\"\" style=\"box-sizing: content-box; max-width: 100%; border: 0px;\" fr-original-style=\"box-sizing: content-box; max-width: 100%; border: 0px;\" fr-original-class=\"embedly-embed\"&gt;&lt;/iframe&gt;\n          &lt;/span&gt;\n          &lt;br&gt;\n          Foo Bar\n          &lt;br&gt;\n          &lt;br&gt;\n          &lt;span contenteditable=\"false\" draggable=\"true\" fr-original-class=\"fr-video fr-dvb fr-draggable\" fr-original-style=\"-webkit-user-select: none;\" style=\"-webkit-user-select: none; text-align: center; position: relative; display: block; clear: both;\"&gt;\n            &lt;iframe src=\"//cdn.embedly.com/widgets/media.html?src=https://www.youtube.com/embed/skLz87ixE48?feature=oembed&amp;amp;url=http://www.youtube.com/watch?v=skLz87ixE48&amp;amp;image=https://i.ytimg.com/vi/skLz87ixE48/hqdefault.jpg&amp;amp;key=2aa3c4d5f3de4f5b9120b660ad850dc9&amp;amp;type=text/html&amp;amp;schema=youtube\" width=\"600\" height=\"338\" scrolling=\"no\" frameborder=\"0\" allowfullscreen=\"\" style=\"box-sizing: content-box; max-width: 100%; border: 0px;\" fr-original-style=\"box-sizing: content-box; max-width: 100%; border: 0px;\" fr-original-class=\"embedly-embed\"&gt;&lt;/iframe&gt;\n          &lt;/span&gt;\n          &lt;br&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr style='font-family: Helvetica Neue,Helvetica,Arial,sans-serif; font-size: 12px; color: #656565; text-align: center;'&gt;\n        &lt;td style='padding: 10px 0px;'&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["ruby", "chef-infra"], "comments": [{"owner": {"reputation": 914, "user_id": 2115680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/j2Fk3.jpg?s=128&g=1", "display_name": "Marc-Andre", "link": "https://stackoverflow.com/users/2115680/marc-andre"}, "edited": false, "score": 0, "creation_date": 1467228645, "post_id": 38107809, "comment_id": 63650714, "body": "Your post would be more readable if you could use markdown to format code and information."}, {"owner": {"reputation": 41, "user_id": 6529949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e897fc66a4c8b906c5dd327ae4ba498?s=128&d=identicon&r=PG&f=1", "display_name": "SKK", "link": "https://stackoverflow.com/users/6529949/skk"}, "reply_to_user": {"reputation": 914, "user_id": 2115680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/j2Fk3.jpg?s=128&g=1", "display_name": "Marc-Andre", "link": "https://stackoverflow.com/users/2115680/marc-andre"}, "edited": false, "score": 0, "creation_date": 1467229300, "post_id": 38107809, "comment_id": 63651037, "body": "sorry, I will try to format it better. my first post here. thanks."}, {"owner": {"reputation": 914, "user_id": 2115680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/j2Fk3.jpg?s=128&g=1", "display_name": "Marc-Andre", "link": "https://stackoverflow.com/users/2115680/marc-andre"}, "edited": false, "score": 0, "creation_date": 1467229382, "post_id": 38107809, "comment_id": 63651076, "body": "No problem, we all need to start somewhere and learn new things!"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6529949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e897fc66a4c8b906c5dd327ae4ba498?s=128&d=identicon&r=PG&f=1", "display_name": "SKK", "link": "https://stackoverflow.com/users/6529949/skk"}, "is_accepted": false, "score": 0, "last_activity_date": 1467323993, "last_edit_date": 1467323993, "creation_date": 1467244008, "answer_id": 38111838, "question_id": 38107809, "link": "https://stackoverflow.com/questions/38107809/chef-template-issues-stale-variables/38111838#38111838", "title": "Chef template issues, stale variables", "body": "<p>I think I was able to fix this. It was due to my node configs being corrupted. I should have mentioned I was using chef-zero.  It turns out the node config is saved back to a json file inside <code>nodes</code> directory even for chef-zero and so no matter how many times I deleted my local-mode caches inside <code>~/.chef</code> and my installation directories, the stale values kept coming back. Thanks to <a href=\"https://gitter.im/\" rel=\"nofollow\">gitter</a> chat room, someone gave me a gentle reminder to check the node's configs. That took care of the issue and I am seeing my expected output now. Thanks!</p>\n"}], "owner": {"reputation": 41, "user_id": 6529949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e897fc66a4c8b906c5dd327ae4ba498?s=128&d=identicon&r=PG&f=1", "display_name": "SKK", "link": "https://stackoverflow.com/users/6529949/skk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1467327221, "creation_date": 1467226072, "last_edit_date": 1467327221, "question_id": 38107809, "link": "https://stackoverflow.com/questions/38107809/chef-template-issues-stale-variables", "title": "Chef template issues, stale variables", "body": "<p>I am seeing a weird issue when running my chef cookbook, it almost looks like there is some stale variable names being used in between runs even after modifying the json env file. Please see below for more details. I have pasted excerpts from my template, and environment files. Also showed the desired output and the current weird output that I am seeing. It may be something with my ruby loops (excuse my ruby, noob here) but I have checked it multiple times and don't see any issue with the construct. </p>\n\n<p>Any help appreciated... have been messing with this for almost 24 hours now, in the interest of being productive I am reaching out to others.</p>\n\n<p>This is my first post here and I am not allowed to post more than 2 links in the content. I had to remove the 'http' and 'https' from my sample output and rename my domain names to bypass.</p>\n\n<p><strong>Template:</strong>  </p>\n\n<pre><code>gatewaymappings: |  \n  {  \n    &lt;% @gatewaymappings.each_with_index do |mapping, index| %&gt;      \n       \"&lt;%= mapping.incomingFQDN %&gt;\" : \"&lt;%= mapping.upstreamProtocol %&gt;://&lt;%= mapping.upstreamFQDN %&gt;  \n          &lt;% if (mapping.upstreamPort.length &gt; 0) %&gt;  \n            :&lt;%= mapping.upstreamPort %&gt;\"  \n         &lt;% end %&gt;  \n          &lt;% if (index+1 != @gatewaymappings.count) %&gt;  \n            ,  \n         &lt;% end %&gt;  \n   &lt;% end %&gt;  \n  }\n</code></pre>\n\n<p><strong>Chef template variables:</strong><br>\n<code>:gatewaymappings =&gt; node[app_name]['gatewaymappings']</code></p>\n\n<p><strong>Sample JSON:</strong>    </p>\n\n<pre><code>\"gatewaymappings\": [  \n  {  \n    \"incomingFQDN\": \"host1\",  \n    \"upstreamProtocol\": \"http\",  \n    \"upstreamFQDN\": \"upstream1\",  \n    \"upstreamPort\": \"8000\"  \n  },  \n  {  \n    \"incomingFQDN\": \"host2\",  \n    \"upstreamProtocol\": \"https\",  \n    \"upstreamFQDN\": \"upstream2\",  \n    \"upstreamPort\": \"8001\"  \n  }  \n]  \n</code></pre>\n\n<p><strong>Desired output: (inside yml file)</strong>    </p>\n\n<pre><code> gatewaymappings: |  \n  {  \n      \"host1\" : \"upstream1:8000\",  \n      \"host2\" : \"upstream2:8001\"  \n  }  \n</code></pre>\n\n<p><strong>Current output:</strong><br>\n(The first element is from a previous sample env run which doesnt even exist in my current sample json, I tried clearing cache etc, but it still keep showing up)    </p>\n\n<pre><code>gatewaymappings: |  \n  {  \n      \"localhost\" : \"upstream\",  \n      \"host1\" : \"upstream1:8000\",  \n      \"host2\" : \"upstream2:8001\",  \n      \"host1\" : \"upstream1:8000\",  \n      \"host2\" : \"upstream2:8001\"  \n  }  \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "json"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1467232827, "post_id": 38107661, "comment_id": 63652809, "body": "Welcome to Stack Overflow. Don&#39;t use an image to represent data that acts as input to your code. We can&#39;t reuse that and have to type it in, which immediately turns off potential help for you. Also, the link can rot then break, leaving your question making no sense. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; including the linked pages, and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1467236582, "post_id": 38107661, "comment_id": 63654593, "body": "@the Tin Man has explained why you should not post images of code. I downvoted your question because you have seen his comment but elected to ignore his advice. You should do as he suggests even though you have selected an answer, as many SO members may read your question in future.  Also, please remove the dashes and assign a variable to the hash (e.g., <code>hash = {...}</code>), so that readers can both cut and paste and refer to the variable without having to define it. I will remove my downvote it you edit."}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 1569540, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7bc6fd8ed3a49dc4b03d4ab0d43de2c7?s=128&d=identicon&r=PG", "display_name": "Julinho da Adelaide", "link": "https://stackoverflow.com/users/1569540/julinho-da-adelaide"}, "edited": false, "score": 0, "creation_date": 1467226198, "post_id": 38107720, "comment_id": 63649320, "body": "Thanks Jordan. It really worked. And then I dont need to make any change to get the active phone since the current phone will be always on 0 level. Thanks again."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 3, "last_activity_date": 1467225744, "creation_date": 1467225744, "answer_id": 38107720, "question_id": 38107661, "link": "https://stackoverflow.com/questions/38107661/ruby-json-access-to-nested-element-with-key/38107720#38107720", "title": "Ruby Json access to nested element with key", "body": "<p>From the looks of things, <code>person_id</code> is a hash with the string keys <code>\"name\"</code>, <code>\"email\"</code>, and <code>\"phone\"</code>. The value with the key <code>\"phone\"</code> is an array, each element of which is a hash with the keys <code>\"label\"</code>, <code>\"value\"</code>, and <code>\"primary\"</code>. In that case what you want is this:</p>\n\n<pre><code>phone_array = person_id[\"phone\"]\n# =&gt; [ { \"label\" =&gt; \"Work\", ... }, ... ]\n\nfirst_phone = phone_array[0]\n# =&gt; { \"label\" =&gt; \"Work\", ... }\n\nfirst_phone_value = first_phone[\"value\"]\n# =&gt; \"+0109135008\"\n</code></pre>\n\n<p>Of course, you're looking for a way to do this in one line, which looks like this:</p>\n\n<pre><code>person_id[\"phone\"][0][\"value\"]\n# =&gt; \"+0109135008\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 3, "last_activity_date": 1467226807, "creation_date": 1467226807, "answer_id": 38108030, "question_id": 38107661, "link": "https://stackoverflow.com/questions/38107661/ruby-json-access-to-nested-element-with-key/38108030#38108030", "title": "Ruby Json access to nested element with key", "body": "<p>The only problem with your code was that you tried to use a dot-method accessor <code>.phone</code> when you should have used hash-key accessor <code>[\"phone\"]</code>.</p>\n\n<p>This is an understandable mistake. It'd work in Javascript.</p>\n\n<p>It's actually not difficult to add this functionality. Ruby has the <code>OpenStruct</code> class which is a Hash-like object that automatically adds dot-method accessors. You'll just need to <code>require ostruct</code>, which is part of the standard lib.</p>\n\n<p>You can tell <code>JSON.parse</code> to automatically convert all Hashes to OpenStructs (<a href=\"https://coderwall.com/p/74rajw/convert-a-complex-nested-hash-to-an-object\" rel=\"nofollow\">source</a>):</p>\n\n<pre><code>object = JSON.parse(json, object_class: OpenStruct)\n</code></pre>\n\n<p>Or you can use the <a href=\"https://github.com/aetherknight/recursive-open-struct\" rel=\"nofollow\">recursive-open-struct</a> gem:</p>\n\n<pre><code>RecursiveOpenStruct.new(nested_hash)\n</code></pre>\n"}], "owner": {"reputation": 316, "user_id": 1569540, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7bc6fd8ed3a49dc4b03d4ab0d43de2c7?s=128&d=identicon&r=PG", "display_name": "Julinho da Adelaide", "link": "https://stackoverflow.com/users/1569540/julinho-da-adelaide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2185, "favorite_count": 1, "accepted_answer_id": 38108030, "answer_count": 2, "score": 1, "last_activity_date": 1467226807, "creation_date": 1467225536, "last_edit_date": 1495540738, "question_id": 38107661, "link": "https://stackoverflow.com/questions/38107661/ruby-json-access-to-nested-element-with-key", "title": "Ruby Json access to nested element with key", "body": "<p>I'm trying to retrieve one value from a nested <code>JSON</code> with key.</p>\n\n<p>My <code>JSON</code> structure is below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vLY61.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vLY61.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If I try:</p>\n\n<pre><code>puts person_id[\"name\"]\n</code></pre>\n\n<p>It does work fine, but then if I try to get the phone value as:</p>\n\n<pre><code>person_id.phone[0].[\"value\"]\n</code></pre>\n\n<p>It doesn't work.</p>\n\n<p>How can I properly access the <code>phone value</code>? Especially when <code>primary</code> field is <code>true</code>?</p>\n\n<p>I tried <a href=\"https://stackoverflow.com/questions/22132623/ruby-iterate-over-parsed-json\">this</a> but no succcess. Thanks in advance.</p>\n"}, {"tags": ["ruby", "recursion", "methods"], "comments": [{"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1467225756, "post_id": 38107642, "comment_id": 63649040, "body": "What&#39;s <code>reverse_append</code>?"}, {"owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "reply_to_user": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1467225795, "post_id": 38107642, "comment_id": 63649062, "body": "sorry, typo. i fixed it."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1467226042, "creation_date": 1467226042, "answer_id": 38107798, "question_id": 38107642, "link": "https://stackoverflow.com/questions/38107642/recursive-method-in-ruby/38107798#38107798", "title": "recursive method in ruby", "body": "<p><code>return</code> returns from the current method, not from all recursive calls. That said, after first <code>return</code> the control flow goes to the line, next to call to <code>append</code>. For the <code>n=2</code> the backtrace will be as follows:</p>\n\n<pre><code>main \u21d2 append                     # n = 2\nmain \u21d2 append \u21d2 append            # n = 1\nmain \u21d2 append \u21d2 append \u21d2 append   # n = 0, return to:\nmain \u21d2 append \u21d2 append            # here n = 1, continue execution till end\nmain \u21d2 append                     # here n = 2, continue execution till end\nmain                              # the topmost recursion level returned to main\n</code></pre>\n"}], "owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1467226512, "accepted_answer_id": 38107798, "answer_count": 1, "score": -2, "last_activity_date": 1467226042, "creation_date": 1467225480, "last_edit_date": 1467225780, "question_id": 38107642, "link": "https://stackoverflow.com/questions/38107642/recursive-method-in-ruby", "closed_reason": "Duplicate", "title": "recursive method in ruby", "body": "<pre><code>def append(arr, n)  \n    return arr if n &lt; 0 \n    puts \"n1: #{n}, #{arr}\"\n    append(arr, n-1)\n    puts \"n2: #{n}, #{arr}\"\n    arr &lt;&lt; n\n    puts \"n3: #{n}, #{arr}\"\n    arr\nend \n\nappend([],4) #=&gt; [0, 1, 2, 3, 4]\n</code></pre>\n\n<p>I can't seem to understand this recursive method. It produces an array from 0 up to n.</p>\n\n<p>I added a few puts to see how the arr and n acted.</p>\n\n<pre><code>n1: 4, []\nn1: 3, []\nn1: 2, []\nn1: 1, []\nn1: 0, []\nn2: 0, []\nn3: 0, [0]\nn2: 1, [0]\nn3: 1, [0, 1]\nn2: 2, [0, 1]\nn3: 2, [0, 1, 2]\nn2: 3, [0, 1, 2]\nn3: 3, [0, 1, 2, 3]\nn2: 4, [0, 1, 2, 3]\nn3: 4, [0, 1, 2, 3, 4]\n</code></pre>\n\n<p>I understand how n counts down to -1, and then the arr is returned. What is confusing me is where the counting up occurs. It seems to me that when <code>append(arr, -1)</code> is called, the arr is returned and the loop will stop and all I get is []. So why does the method continues to run after the return is called? And where does the counting up occur? </p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1467225088, "post_id": 38107464, "comment_id": 63648633, "body": "I think you&#39;re using the wrong backslash? <code>\\ </code> instead of <code>&#47;</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1467225132, "post_id": 38107464, "comment_id": 63648666, "body": "@maxpleaner Note \u201cI am on Windows 10.\u201d"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1467225155, "post_id": 38107464, "comment_id": 63648676, "body": "Sorry yeah i see that"}, {"owner": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 1, "creation_date": 1467225156, "post_id": 38107464, "comment_id": 63648677, "body": "The gemspec has a syntax error, you have not closed quotes on homepage line - is that the same in your project?"}, {"owner": {"reputation": 2023, "user_id": 2402929, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wd4f2.jpg?s=128&g=1", "display_name": "xtrinch", "link": "https://stackoverflow.com/users/2402929/xtrinch"}, "reply_to_user": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 0, "creation_date": 1467225227, "post_id": 38107464, "comment_id": 63648721, "body": "@neilslater No sorry that&#39;s just an error created with copying, will edit original post"}, {"owner": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1467225248, "post_id": 38107464, "comment_id": 63648738, "body": "@mudasobwa: I think Ruby could well handle that differently though, and very simple to do <code>gem push hola_username-0.0.0.gem</code> instead, which should work (the <code>.&#47;</code> for file in current path is not required) so worth a try."}, {"owner": {"reputation": 2023, "user_id": 2402929, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wd4f2.jpg?s=128&g=1", "display_name": "xtrinch", "link": "https://stackoverflow.com/users/2402929/xtrinch"}, "reply_to_user": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 0, "creation_date": 1467225824, "post_id": 38107464, "comment_id": 63649080, "body": "@NeilSlater gem push hola_username-0.0.0.gem returns the exact same error"}, {"owner": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 1, "creation_date": 1467226274, "post_id": 38107464, "comment_id": 63649366, "body": "Following your edit, is it possible when you signed up at <code>https:&#47;&#47;rubygems.org&#47;sign_up</code> that you used non-ASCII characters in your username or password that would be different depending on which character encoding was in play?"}, {"owner": {"reputation": 2023, "user_id": 2402929, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wd4f2.jpg?s=128&g=1", "display_name": "xtrinch", "link": "https://stackoverflow.com/users/2402929/xtrinch"}, "reply_to_user": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 0, "creation_date": 1467226487, "post_id": 38107464, "comment_id": 63649495, "body": "@NeilSlater I have not used any non-ascii characters."}], "answers": [{"tags": [], "owner": {"reputation": 2023, "user_id": 2402929, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wd4f2.jpg?s=128&g=1", "display_name": "xtrinch", "link": "https://stackoverflow.com/users/2402929/xtrinch"}, "is_accepted": true, "score": 1, "last_activity_date": 1467228307, "creation_date": 1467228307, "answer_id": 38108434, "question_id": 38107464, "link": "https://stackoverflow.com/questions/38107464/sample-hola-rubygem-push-error-on-windows/38108434#38108434", "title": "Sample &#39;&#39;Hola&#39;&quot; Rubygem push error on windows", "body": "<p>My credentials file in .gem folder was encoded with UCS2 - Little Endian and converting it to UTF without BOM did the trick.</p>\n\n<p>Although I have absolutey no idea why..</p>\n"}], "owner": {"reputation": 2023, "user_id": 2402929, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wd4f2.jpg?s=128&g=1", "display_name": "xtrinch", "link": "https://stackoverflow.com/users/2402929/xtrinch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 38108434, "answer_count": 1, "score": 1, "last_activity_date": 1467228307, "creation_date": 1467224907, "last_edit_date": 1467226867, "question_id": 38107464, "link": "https://stackoverflow.com/questions/38107464/sample-hola-rubygem-push-error-on-windows", "title": "Sample &#39;&#39;Hola&#39;&quot; Rubygem push error on windows", "body": "<p>I am following the very basic tutorial found here: <a href=\"http://guides.rubygems.org/make-your-own-gem/\" rel=\"nofollow\">http://guides.rubygems.org/make-your-own-gem/</a></p>\n\n<p><strong>hola_username.rb:</strong></p>\n\n<pre><code>class Hola\n  def self.hi\n    puts \"Hello world!\"\n  end\nend\n</code></pre>\n\n<p><strong>hola_username.gemspec:</strong></p>\n\n<pre><code>Gem::Specification.new do |s|\n  s.name        = 'hola_username'\n  s.version     = '0.0.0'\n  s.date        = '2010-04-28'\n  s.summary     = \"Hola!\"\n  s.description = \"A simple hello world gem\"\n  s.authors     = [\"Surname Lastname\"]\n  s.email       = 'me.me@gmail.com'\n  s.files       = [\"lib/hola_username.rb\"]\n  s.homepage    =\n    'http://rubygems.org/gems/hola_username'\n  s.license       = 'MIT'\nend\n</code></pre>\n\n<p>That really is all there is to the project.</p>\n\n<p>I can build my gem with</p>\n\n<pre><code>gem build .\\hola_username.gemspec\n</code></pre>\n\n<p>I have also tested it by importing and executing the hi function of the Hola class and it works:</p>\n\n<pre><code>PS E:\\hola_username&gt; gem install .\\hola_username-0.0.0.gem\nSuccessfully installed hola_username-0.0.0\nParsing documentation for hola_username-0.0.0\nDone installing documentation for hola_username after 0 seconds\n1 gem installed\n</code></pre>\n\n<p>&amp;</p>\n\n<pre><code>irb(main):001:0&gt; require 'hola_username'\n=&gt; true\nirb(main):002:0&gt; Hola.hi\nHello world!\n=&gt; nil\nirb(main):003:0&gt;\n</code></pre>\n\n<p>But when I try to </p>\n\n<pre><code>gem push .\\hola_username-0.0.0.gem\n</code></pre>\n\n<p>I get:</p>\n\n<blockquote>\n  <p>ERROR:  While executing gem ... (Psych::SyntaxError)\n      (): control characters are not allowed at line 1 column 1</p>\n</blockquote>\n\n<p>Any ideas?</p>\n\n<p><em>Edit: I am on a windows 10 machine using ruby 2.0.0p598</em></p>\n\n<p><strong>Edit v01: <em>Anything</em> I put after gem push will result in the above error, doesn't seem to be a problem with the sample rubygem.</strong></p>\n\n<p><strong>Edit v02: My credentials file that was generated in the .gem folder however stars with hex characters: fffe2d002d00.. Which might be the ones causing trouble?</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 12705, "user_id": 483040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ux8AH.jpg?s=128&g=1", "display_name": "jaydel", "link": "https://stackoverflow.com/users/483040/jaydel"}, "edited": false, "score": 0, "creation_date": 1467226821, "post_id": 38107434, "comment_id": 63649704, "body": "why aren&#39;t your classes extending ActiveRecord::Base?"}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "reply_to_user": {"reputation": 12705, "user_id": 483040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ux8AH.jpg?s=128&g=1", "display_name": "jaydel", "link": "https://stackoverflow.com/users/483040/jaydel"}, "edited": false, "score": 0, "creation_date": 1467227052, "post_id": 38107434, "comment_id": 63649847, "body": "@jaydel they are extending ActiveRecord::Base. Updated question to clarify that."}, {"owner": {"reputation": 12705, "user_id": 483040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ux8AH.jpg?s=128&g=1", "display_name": "jaydel", "link": "https://stackoverflow.com/users/483040/jaydel"}, "edited": false, "score": 1, "creation_date": 1467230084, "post_id": 38107434, "comment_id": 63651420, "body": "another questions, why the custom validator? <code>validates :name, presence: true</code> ?"}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "reply_to_user": {"reputation": 12705, "user_id": 483040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ux8AH.jpg?s=128&g=1", "display_name": "jaydel", "link": "https://stackoverflow.com/users/483040/jaydel"}, "edited": false, "score": 0, "creation_date": 1467231021, "post_id": 38107434, "comment_id": 63651894, "body": "@jaydel because I want to customize the errors object. I want it to do this: errors[&quot;task[task_category_attributes][id]&quot;] &lt;&lt; &quot;must be present&quot;. The reason is because of the way I render errors on the page. I check if there are errors for each field based on the errors object:  form.object.errors[attr].present?"}, {"owner": {"reputation": 12705, "user_id": 483040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ux8AH.jpg?s=128&g=1", "display_name": "jaydel", "link": "https://stackoverflow.com/users/483040/jaydel"}, "edited": false, "score": 0, "creation_date": 1467231598, "post_id": 38107434, "comment_id": 63652222, "body": "okay, that makes sense. just trying to get enough context to try and be helpful, not a pain in the arse"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467234250, "creation_date": 1467224791, "last_edit_date": 1467234250, "question_id": 38107434, "link": "https://stackoverflow.com/questions/38107434/rails-custom-validation-with-association-and-nested-attributes", "title": "Rails custom validation with association and nested attributes", "body": "<p>A <code>TaskCategory</code> has many <code>Tasks</code>. When a user creates a task, he creates a task category associated with the task in the same form:</p>\n\n<pre><code>&lt;%= form_for @task, remote: true, html: { class: 'form' } do |f| %&gt;\n    ...\n    &lt;%= f.fields_for :task_category, f.object.build_task_category do |task_category_builder| %&gt;\n      &lt;%= validate_select_field task_category_builder, :task_category, nil, {required:true} do %&gt;\n        &lt;%= task_category_builder.select :id, TaskCategory.all.collect {|task_category| [ task_category.name, task_category.id ] }, {include_blank: true}, { class: \"form-control\" } %&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The <code>validate_select_field</code> helper, configures styling for the form control, but also checks if the object contains any errors:</p>\n\n<pre><code>def validate_select_field(form, attr, label, options={})\n  ...\n  container_class += \" has-error has-feedback\" if form.object &amp;&amp; form.object.errors[attr].present?\n  ...\nend\n</code></pre>\n\n<p>Therefore, I need to specialize the error object to match the name of the attribute. In <code>TaskCategory</code>, I add a customized error:</p>\n\n<pre><code>class Task &lt; ActiveRecord::Base\n  belongs_to :task_category\n\n  accepts_nested_attributes_for :task_category\n\n  validates :task_category, presence: true\nend\n\nclass TaskCategory &lt; ActiveRecord::Base\n  has_many :tasks\n\n  validate name_present\n\n  private\n\n  def name_present\n    unless self.name.present?\n      errors[\"task[task_category_attributes][id]\"] &lt;&lt; \"must be present\"\n    end\n  end \nend\n</code></pre>\n\n<p>However, when I add the name_present method, the <code>f.fields_for :task_category</code> call above fails with the following exception:</p>\n\n<pre><code>NameError - uninitialized constant Task::TaskCategory:\n</code></pre>\n\n<p>Why does this error happen and how can I customized my association error?   </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "devise-invitable"], "comments": [{"owner": {"reputation": 1883, "user_id": 799858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9930600ff08875bf9a79bcbd9b8faf2d?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/799858/luke"}, "edited": false, "score": 0, "creation_date": 1467227974, "post_id": 38107220, "comment_id": 63650360, "body": "Is &#39;devise/invitations&#39; your own home-spun controller?"}, {"owner": {"reputation": 345, "user_id": 4655626, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/f22b14a6edc9f62203c1aa06ff312d42?s=128&d=identicon&r=PG&f=1", "display_name": "rubyist", "link": "https://stackoverflow.com/users/4655626/rubyist"}, "reply_to_user": {"reputation": 1883, "user_id": 799858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9930600ff08875bf9a79bcbd9b8faf2d?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/799858/luke"}, "edited": false, "score": 0, "creation_date": 1467229229, "post_id": 38107220, "comment_id": 63651001, "body": "It&#39;s not, I don&#39;t have a home-spun controller for this. I followed the setup instructions for DeviseInvitable and there are views that have been generated by the generators btw. but can&#39;t see any controller code I can debug."}], "owner": {"reputation": 345, "user_id": 4655626, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/f22b14a6edc9f62203c1aa06ff312d42?s=128&d=identicon&r=PG&f=1", "display_name": "rubyist", "link": "https://stackoverflow.com/users/4655626/rubyist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467224094, "creation_date": 1467224094, "question_id": 38107220, "link": "https://stackoverflow.com/questions/38107220/unable-to-route-to-new-user-invitation-page", "title": "Unable to route to new_user_invitation page", "body": "<p>I'm having an issue with Devise invitable. </p>\n\n<p>When I try to view the new invite page I get redirected to the users/sign_in page and get this in the console window:</p>\n\n<pre><code>Processing by Devise::InvitationsController#new as HTML\nCompleted 401 Unauthorized in 11ms (ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>In my routes.rb file, I have this for the controllers setting:</p>\n\n<pre><code>devise_for :users, :controllers =&gt; { :invitations =&gt; 'devise/invitations' }\n</code></pre>\n\n<p>Any idea on how I can fix this so I can view the new user invitation page?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 3998510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb6c11b5785e71f9a3b09b29e92de94?s=128&d=identicon&r=PG&f=1", "display_name": "Ty Shaikh", "link": "https://stackoverflow.com/users/3998510/ty-shaikh"}, "is_accepted": false, "score": 0, "last_activity_date": 1467224193, "creation_date": 1467224193, "answer_id": 38107255, "question_id": 38107107, "link": "https://stackoverflow.com/questions/38107107/rails-authorize-editor-and-correct-user/38107255#38107255", "title": "Rails Authorize Editor and Correct User", "body": "<p>I have an app that has some similar logic. Here is what my controller code would look like. Some of the private methods can be abstracted to the ApplicationController.</p>\n\n<pre><code>before_action :require_user, only: [:new, :create, :edit, :update, :destroy]\nbefore_action :require_creator, only: [:edit, :update, :destroy]\n\nprivate\n\n  def require_user\n    access_denied unless logged_in?\n  end\n\n  def logged_in?\n    !!current_user\n  end\n\n  def current_user\n    @current_user ||= User.find(session[:user_id]) if session[:user_id]\n  end\n\n  def access_denied\n    redirect_to root_path\n  end\n\n  def require_creator\n    access_denied unless logged_in? and (current_user == @blog.user || current_user.admin?)\n  end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 1636937, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0983ad334d3e7cf73d0dc13126c0944f?s=128&d=identicon&r=PG", "display_name": "user1636937", "link": "https://stackoverflow.com/users/1636937/user1636937"}, "edited": false, "score": 0, "creation_date": 1467225093, "post_id": 38107257, "comment_id": 63648636, "body": "I just tried that and my admin wasn&#39;t granted permission... I did change your suggestion of :correct_user? to :correct_user because I didn&#39;t have a method correct_user?"}, {"owner": {"reputation": 1722, "user_id": 1480946, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e87530abcbb61636ac0b5197e3848b8b?s=128&d=identicon&r=PG", "display_name": "Jake Smith", "link": "https://stackoverflow.com/users/1480946/jake-smith"}, "reply_to_user": {"reputation": 55, "user_id": 1636937, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0983ad334d3e7cf73d0dc13126c0944f?s=128&d=identicon&r=PG", "display_name": "user1636937", "link": "https://stackoverflow.com/users/1636937/user1636937"}, "edited": false, "score": 0, "creation_date": 1467225289, "post_id": 38107257, "comment_id": 63648768, "body": "Are you sure that your <code>admin?</code> method works then?  Or is your user really defined as <code>admin?</code>?  If you are using <code>byebug</code> in your Gemfile, could you please put the following line: <code>debugger</code> into the beginning of <code>can_edit_blog?</code> and then head to your console, enter <code>current_user.admin?</code> into the byebug console input, hit enter, and see if it returns true or false?"}, {"owner": {"reputation": 55, "user_id": 1636937, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0983ad334d3e7cf73d0dc13126c0944f?s=128&d=identicon&r=PG", "display_name": "user1636937", "link": "https://stackoverflow.com/users/1636937/user1636937"}, "edited": false, "score": 1, "creation_date": 1467225535, "post_id": 38107257, "comment_id": 63648912, "body": "it returns true... by logic it should work. I just tinkered with your suggestion and it works now. Thanks for all the help!"}, {"owner": {"reputation": 1722, "user_id": 1480946, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e87530abcbb61636ac0b5197e3848b8b?s=128&d=identicon&r=PG", "display_name": "Jake Smith", "link": "https://stackoverflow.com/users/1480946/jake-smith"}, "reply_to_user": {"reputation": 55, "user_id": 1636937, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0983ad334d3e7cf73d0dc13126c0944f?s=128&d=identicon&r=PG", "display_name": "user1636937", "link": "https://stackoverflow.com/users/1636937/user1636937"}, "edited": false, "score": 0, "creation_date": 1467226167, "post_id": 38107257, "comment_id": 63649298, "body": "I wonder if mine wasn&#39;t working because of the <code>@blog.nil?</code> check.  Is <code>@blog</code> supposed to be <code>nil</code> when you are an admin?"}, {"owner": {"reputation": 55, "user_id": 1636937, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0983ad334d3e7cf73d0dc13126c0944f?s=128&d=identicon&r=PG", "display_name": "user1636937", "link": "https://stackoverflow.com/users/1636937/user1636937"}, "edited": false, "score": 0, "creation_date": 1467233738, "post_id": 38107257, "comment_id": 63653281, "body": "Good point.. I haven&#39;t checked. I&#39;ll keep that in mind as I continue. Thanks again!"}, {"owner": {"reputation": 1722, "user_id": 1480946, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e87530abcbb61636ac0b5197e3848b8b?s=128&d=identicon&r=PG", "display_name": "Jake Smith", "link": "https://stackoverflow.com/users/1480946/jake-smith"}, "reply_to_user": {"reputation": 55, "user_id": 1636937, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0983ad334d3e7cf73d0dc13126c0944f?s=128&d=identicon&r=PG", "display_name": "user1636937", "link": "https://stackoverflow.com/users/1636937/user1636937"}, "edited": false, "score": 0, "creation_date": 1467243486, "post_id": 38107257, "comment_id": 63657085, "body": "Good luck!  And keep having fun!"}], "tags": [], "owner": {"reputation": 1722, "user_id": 1480946, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e87530abcbb61636ac0b5197e3848b8b?s=128&d=identicon&r=PG", "display_name": "Jake Smith", "link": "https://stackoverflow.com/users/1480946/jake-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1467226051, "last_edit_date": 1467226051, "creation_date": 1467224200, "answer_id": 38107257, "question_id": 38107107, "link": "https://stackoverflow.com/questions/38107107/rails-authorize-editor-and-correct-user/38107257#38107257", "title": "Rails Authorize Editor and Correct User", "body": "<p>You don't want to call <code>can_edit_blog</code> in the <code>:only</code> option of the <code>before_action</code> calling <code>correct_user</code>.  You want to call <code>can_edit_blog?</code> in <code>correct_user</code>:</p>\n\n<pre><code>before_action :correct_user?, only: [:edit, :update, :delete]\n\n...\n\nprivate\n\n  def can_edit_blog?\n    current_user.admin? || current_user.editor?\n  end\n\n  def correct_user\n    @blog = current_user.blogs.find_by(id: params[:id])\n    if @blog.nil? or not can_edit_blog?\n      redirect_to root_url \n    end\n  end\n</code></pre>\n\n<h1>OP's solution is correct, mine is not, refer to their updated question</h1>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 1636937, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0983ad334d3e7cf73d0dc13126c0944f?s=128&d=identicon&r=PG", "display_name": "user1636937", "link": "https://stackoverflow.com/users/1636937/user1636937"}, "is_accepted": false, "score": 1, "last_activity_date": 1467225470, "creation_date": 1467225470, "answer_id": 38107638, "question_id": 38107107, "link": "https://stackoverflow.com/questions/38107107/rails-authorize-editor-and-correct-user/38107638#38107638", "title": "Rails Authorize Editor and Correct User", "body": "<pre><code>    before_action :require_creator, only: [:edit, :update, :destroy]\n\n    ...\n\n    def can_edit_blog?\n        current_user.admin? || current_user.editor?\n    end\n\n    def require_creator\n        @blog = Blog.find(params[:id])\n        redirect_to root_url unless (current_user == @blog.user || can_edit_blog?)\n    end\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 1636937, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0983ad334d3e7cf73d0dc13126c0944f?s=128&d=identicon&r=PG", "display_name": "user1636937", "link": "https://stackoverflow.com/users/1636937/user1636937"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1467226051, "creation_date": 1467223710, "question_id": 38107107, "link": "https://stackoverflow.com/questions/38107107/rails-authorize-editor-and-correct-user", "title": "Rails Authorize Editor and Correct User", "body": "<p>I want to have correct users, admins, and editors be able to edit, update, and delete a blog.</p>\n\n<p>I have this in my Blogs controller:</p>\n\n<pre><code>before_action :require_user, only: [:new, :create, :edit, :update, :destroy]\nbefore_action :correct_user, only: [:edit, :update, :destroy, :can_edit_blog?]\n</code></pre>\n\n<p>and this in under private:</p>\n\n<pre><code>    def can_edit_blog?\n      true if ((current_user.admin? || current_user.editor?) || correct_user)\n    end\n\n    def correct_user\n      @blog = current_user.blogs.find_by(id: params[:id])\n      redirect_to root_url if @blog.nil?\n    end\n</code></pre>\n\n<p>Right now it only allows the correct user, but not the admin or editors. I've tried using another before_action :admin_user, but that didn't seem to work.</p>\n"}, {"tags": ["ruby", "gsub"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1467223300, "post_id": 38106926, "comment_id": 63647534, "body": "Is your goal to replace native ruby syntax to use parentheses instead of square brackets to declare arrays in the first place?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1467233844, "post_id": 38106926, "comment_id": 63653343, "body": "When asking about a problem with your code, it helps if you show the desired output. See &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;."}, {"owner": {"reputation": 105, "user_id": 3971029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/626880890/picture?type=large", "display_name": "Hendrik Kleine", "link": "https://stackoverflow.com/users/3971029/hendrik-kleine"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1467266926, "post_id": 38106926, "comment_id": 63663242, "body": "Got it, thanks @theTinMan"}], "answers": [{"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 2, "last_activity_date": 1467223567, "creation_date": 1467223567, "answer_id": 38107065, "question_id": 38106926, "link": "https://stackoverflow.com/questions/38106926/ruby-use-gsub-within-string-interpolation/38107065#38107065", "title": "Ruby use gsub within string interpolation", "body": "<p>Assuming that you want to change the string representation of the input[1] array:</p>\n\n<pre><code>puts \"Some words #{Lookup1[input[2]].inspect.tr(\"[]\", \"()\")} some more words\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 3971029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/626880890/picture?type=large", "display_name": "Hendrik Kleine", "link": "https://stackoverflow.com/users/3971029/hendrik-kleine"}, "edited": false, "score": 1, "creation_date": 1467224047, "post_id": 38107183, "comment_id": 63647984, "body": "Perfect! Thanks Gagan"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1467224308, "post_id": 38107183, "comment_id": 63648190, "body": "This answer is by all means worse than the one given by @steenslag."}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1467225450, "post_id": 38107183, "comment_id": 63648855, "body": "@mudasobwa :agree, it&#39;s better to use <code>tr</code> then use <code>gsub</code> multiple time, but in OP&#39;s post he tried to use <code>gsub</code> and fail to get his required output, so I saw the solution his way, what mistake he was doing."}], "tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": true, "score": 1, "last_activity_date": 1467223964, "creation_date": 1467223964, "answer_id": 38107183, "question_id": 38106926, "link": "https://stackoverflow.com/questions/38106926/ruby-use-gsub-within-string-interpolation/38107183#38107183", "title": "Ruby use gsub within string interpolation", "body": "<pre><code>&gt; puts \"Some words #{input[2].to_s.gsub('[','(').gsub(']', ')')} some more words\"\n#=&gt; Some words (\"Accounting\", \"Customer Relations\") some more words\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 3971029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/626880890/picture?type=large", "display_name": "Hendrik Kleine", "link": "https://stackoverflow.com/users/3971029/hendrik-kleine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 38107183, "answer_count": 2, "score": 0, "last_activity_date": 1467223964, "creation_date": 1467223105, "question_id": 38106926, "link": "https://stackoverflow.com/questions/38106926/ruby-use-gsub-within-string-interpolation", "title": "Ruby use gsub within string interpolation", "body": "<p>I'm trying to use gsub within a string interpolation</p>\n\n<pre><code>puts \"Some words #{Lookup1[input[2]].gsub(\"[\", \"(\")} some more words\"\n</code></pre>\n\n<p>The input array looks like this:</p>\n\n<pre><code>input = [0,22,[\"Accounting\",\"Customer Relations\"],nil,nil,nil,nil]\n</code></pre>\n\n<p>My goal is to replace [] with ()</p>\n\n<p>Thanks </p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "cucumber", "watir-webdriver"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1467225166, "post_id": 38106852, "comment_id": 63648682, "body": "Isn&#39;t the point of automated testing to find unexpected errors? You could <code>rescue</code> the exceptions in the step definitions, but that&#39;s not standard BDD.  Here&#39;s an example that might help: <a href=\"http://stackoverflow.com/questions/26761624/how-to-make-cucumber-test-continue-running-scenarios-when-rspec-expectationnotme\" title=\"how to make cucumber test continue running scenarios when rspec expectationnotme\">stackoverflow.com/questions/26761624/&hellip;</a>"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1467228095, "post_id": 38106852, "comment_id": 63650425, "body": "It might help if you can give an example. Usually an error prevents you from completing the rest of the scenario, so it is unclear what you are trying to resume. The one scenario I can see wanting to continue is if you have a series of assertions in the same scenario (but I&#39;m not sure if that is considered an unexpected error)."}, {"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "edited": false, "score": 0, "creation_date": 1467275441, "post_id": 38106852, "comment_id": 63667932, "body": "ok.. for example.. I don&#39;t know at which point the application throws a pop-up. Now, i want to do something which can close the pop-up and resume the execution."}, {"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1467276426, "post_id": 38106852, "comment_id": 63668550, "body": "@orde -&gt; I&#39;ve the exceptions handled for few cases in step definitions. But  I can&#39;t write a begin rescue block for each code to handle the unexpected scenarios."}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1467291264, "post_id": 38106852, "comment_id": 63678799, "body": "@yudi2312, when you say the popup can occur at any point, do you literally mean at any point or randomly when a user takes an action (like after clicking a link)? I ask because, Watir-Webdriver has a couple of different mechanisms for performing additional actions before/after an action. Which one would be useful would depend on exactly when the dialog can occur."}, {"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1467291429, "post_id": 38106852, "comment_id": 63678923, "body": "@Justin -&gt; Yes I mean randomly and maybe also more than 1 pop-ups. I&#39;ve a step build to take care of all the pop-ups at a particular instance. But  not sure how to execute it whenever I want to recover the execution."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "edited": false, "score": 0, "creation_date": 1467285970, "post_id": 38119134, "comment_id": 63675064, "body": "but this will be executed whenever the step is called right ? This is not what i want. I wan&#39;t to write this code at one place and let cucumber execute it whenever there is a alert in ui and continue with the execution after closing it."}, {"owner": {"reputation": 442, "user_id": 2968467, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/8SPLe.jpg?s=128&g=1", "display_name": "Stipe", "link": "https://stackoverflow.com/users/2968467/stipe"}, "reply_to_user": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "edited": false, "score": 0, "creation_date": 1467287005, "post_id": 38119134, "comment_id": 63675817, "body": "Yes, this will be executed whenever this step is called. So you need to set this step on a place where you expect alert/error/popup to appear."}, {"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "edited": false, "score": 0, "creation_date": 1467289472, "post_id": 38119134, "comment_id": 63677470, "body": "yeah... This will work only when we know where the error message can occur but not in case of unexpected alerts."}, {"owner": {"reputation": 442, "user_id": 2968467, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/8SPLe.jpg?s=128&g=1", "display_name": "Stipe", "link": "https://stackoverflow.com/users/2968467/stipe"}, "reply_to_user": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "edited": false, "score": 0, "creation_date": 1467290921, "post_id": 38119134, "comment_id": 63678535, "body": "Why would anyone want to run automated tests and skip (not catch) unexpected error, I&#39;m not getting the point of that goal?"}, {"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "edited": false, "score": 0, "creation_date": 1467291490, "post_id": 38119134, "comment_id": 63678961, "body": "Application throws pop-ups when the user performs an action and some back-end data is missing for the customer the automation suite is running. That pop-up will not impact the flow of the test case."}], "tags": [], "owner": {"reputation": 442, "user_id": 2968467, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/8SPLe.jpg?s=128&g=1", "display_name": "Stipe", "link": "https://stackoverflow.com/users/2968467/stipe"}, "is_accepted": false, "score": 0, "last_activity_date": 1467279183, "creation_date": 1467279183, "answer_id": 38119134, "question_id": 38106852, "link": "https://stackoverflow.com/questions/38106852/continue-execution-in-cucumber-in-case-of-any-errors/38119134#38119134", "title": "Continue execution in Cucumber in case of any errors", "body": "<p>You could get your goal by accepting any alert that pops up on the <code>screen</code>. </p>\n\n<p>You can do this in following steps: </p>\n\n<pre><code>Given(/^I should see the error message and accept it$/) do\n  def alert_accept\n    end\nend\n</code></pre>\n\n<hr>\n\n<p>So whenever there is a popup it will accept it and continue forward. </p>\n\n<p>You can find this step as well here: </p>\n\n<p><a href=\"https://github.com/ModusCreateOrg/cucumber-watir/blob/appium/features/step_definitions/appium_steps.rb\" rel=\"nofollow\">https://github.com/ModusCreateOrg/cucumber-watir/blob/appium/features/step_definitions/appium_steps.rb</a></p>\n"}, {"comments": [{"owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "edited": false, "score": 0, "creation_date": 1467296272, "post_id": 38125341, "comment_id": 63682703, "body": "This looks interesting Justin. Let me try this piece. Thanks a lot for this reply."}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 2, "last_activity_date": 1467295077, "creation_date": 1467295077, "answer_id": 38125341, "question_id": 38106852, "link": "https://stackoverflow.com/questions/38106852/continue-execution-in-cucumber-in-case-of-any-errors/38125341#38125341", "title": "Continue execution in Cucumber in case of any errors", "body": "<p>Given that the alerts can be opened at any time, the best option may be to use an <code>AbstractEventListener</code>. This allows you to perform actions before (or after) Selenium interacts with the browser. This means that you could call your alert closing code right before each interaction.</p>\n\n<p>The sample event listener would be defined like:</p>\n\n<pre><code>class AlertListener &lt; Selenium::WebDriver::Support::AbstractEventListener\n  def close_alerts(driver)\n    # Assuming you want to handle the dialogs using Watir code instead of Selenium,\n    # convert the Selenium::WebDriver to a Watir::Browser\n    browser = Watir::Browser.new(driver)\n\n    # Run whatever code you have for handling the dialog instances\n    browser.alert.ok if browser.alert.exists?\n  end\n\n  def before_change_value_of(element, driver)\n    close_alerts(driver)\n  end\n\n  def before_click(element, driver)\n    close_alerts(driver)\n  end\n\n  def before_close(driver)\n    close_alerts(driver)\n  end\n\n  def before_execute_script(script, driver)\n    close_alerts(driver)\n  end\n\n  def before_find(by, what, driver)\n    close_alerts(driver)\n  end\n\n  def before_navigate_back(driver)\n    close_alerts(driver)\n  end\n\n  def before_navigate_forward(driver)\n    close_alerts(driver)\n  end\n\n  def before_navigate_to(url, driver)\n    close_alerts(driver)\n  end\n\n  def before_quit(driver)\n    close_alerts(driver)\n  end    \nend\n</code></pre>\n\n<p>Note that you would replace the <code>close_alerts</code> method with whatever code you have already written for handling the alerts. The event listener is Selenium, which means you need to either write Selenium code or convert the element/driver to Watir (which is what is done in the example).</p>\n\n<p>Once you have the listener created, you need to pass it to the browser during initialization:</p>\n\n<pre><code>listener = AlertListener.new\nbrowser = Watir::Browser.new :chrome, :listener =&gt; listener\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 2695818, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71321de399d47802a3bc1636d4addc64?s=128&d=identicon&r=PG&f=1", "display_name": "yudi2312", "link": "https://stackoverflow.com/users/2695818/yudi2312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 914, "favorite_count": 1, "accepted_answer_id": 38125341, "answer_count": 2, "score": 1, "last_activity_date": 1467295077, "creation_date": 1467222856, "last_edit_date": 1467275706, "question_id": 38106852, "link": "https://stackoverflow.com/questions/38106852/continue-execution-in-cucumber-in-case-of-any-errors", "title": "Continue execution in Cucumber in case of any errors", "body": "<p>I'm building an automation suite using Ruby/Selenium-WebDriver/Cucumber. What I want to achieve is to resume the cucumber scenario in case of any unexpected errors. </p>\n\n<p>For e.g. Unexpected pop-ups</p>\n\n<p>I might get a modal dialog at any point in the application. I want my code to close the pop-ups whenever the exception occurs and resume the execution. </p>\n\n<p>The point of doing this is, the automation suite will run for multiple days on multiple systems. There won't be any kind of monitoring except logs and output reports. I don't want these unwanted exception to hamper the execution.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 12705, "user_id": 483040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ux8AH.jpg?s=128&g=1", "display_name": "jaydel", "link": "https://stackoverflow.com/users/483040/jaydel"}, "edited": false, "score": 1, "creation_date": 1467226352, "post_id": 38106805, "comment_id": 63649425, "body": "long variable names are more descriptive and given that nearly every modern code editor has name completion there&#39;s no pain in working with the long names."}], "tags": [], "owner": {"reputation": 845, "user_id": 5646801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d133162c0a6c4b45ad559f5a86f8f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii K", "link": "https://stackoverflow.com/users/5646801/sergii-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1467222702, "creation_date": 1467222702, "answer_id": 38106805, "question_id": 38106611, "link": "https://stackoverflow.com/questions/38106611/how-can-i-intersection-two-activerecord-relation-objects-by-rails/38106805#38106805", "title": "How can i intersection two ActiveRecord Relation objects by rails?", "body": "<p>As far as I understand, you need to query DB for <code>CarInsuranceObject</code>'s of specified <code>CarInsuranceType</code> and <code>CarModel</code>.\nWhy not to simplify all this stuff:</p>\n\n<pre><code>car_insurance_type_id = params[:car_insurance_type_id] || 1\ncar_insurance_objects_private = car_model_search.car_insurance_objects.where(car_insurance_type_id: car_insurance_type_id)\n</code></pre>\n\n<p>Btw, there is really long names for variables.</p>\n"}], "owner": {"reputation": 2531, "user_id": 3403614, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100000333971017/picture?type=large", "display_name": "Varis Darasirikul", "link": "https://stackoverflow.com/users/3403614/varis-darasirikul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 38106805, "answer_count": 1, "score": 1, "last_activity_date": 1467222702, "creation_date": 1467221983, "question_id": 38106611, "link": "https://stackoverflow.com/questions/38106611/how-can-i-intersection-two-activerecord-relation-objects-by-rails", "title": "How can i intersection two ActiveRecord Relation objects by rails?", "body": "<p>I need to find the intersection result of two ActiveRecord Relation objects.\nThis is my Controller</p>\n\n<pre><code>if params.has_key?(:car_insurance_type_id)\n  car_insurance_type = CarInsuranceType.find_by(id: params[:car_insurance_type_id])\nelse\n  car_insurance_type = CarInsuranceType.find_by(id: 1)\nend\n\n@breadcrumb_title = car_insurance_type.title\n\ncar_insurance_objects_private = car_insurance_type.car_insurance_objects\n\nif params.has_key?(:car_model_id)\n  car_model_search = CarModel.find_by(id: params[:car_model_id])\n\n  if car_model_search\n    car_insurance_objects_from_model = car_model_search.car_insurance_objects\n  end\n\nend\n\ncar_insurance_objects_private = car_insurance_objects_private &amp; car_insurance_objects_from_model\n</code></pre>\n\n<p>But \"&amp;\" method didn't work for ActiveRecord object</p>\n\n<p>This is my model</p>\n\n<pre><code>class CarInsuranceType &lt; ActiveRecord::Base\n\n  has_many :car_insurance_objects ,dependent: :destroy\n\nend\n\nclass CarInsuranceObject &lt; ActiveRecord::Base\n\n  belongs_to :insurance_company\n  belongs_to :car_insurance_type\n  has_and_belongs_to_many :car_models\n\nend\n\nclass CarModel &lt; ActiveRecord::Base\n\n  belongs_to :car_brand\n  has_and_belongs_to_many :car_insurance_objects ,dependent: :destroy\n\nend\n</code></pre>\n\n<p>So how can i find the intersection result between two CarInsuranceObject that one belongs_to car_insurance_type and another one that has_and_belongs_to_many car_models?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "recursion", "stack"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1467221693, "post_id": 38106497, "comment_id": 63646548, "body": "I can&#39;t really think of a practical application for this knowledge, but I am curious..."}], "answers": [{"tags": [], "owner": {"reputation": 921, "user_id": 4276844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f448f2372792762904abfe0dd26366ce?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/4276844/cam"}, "is_accepted": false, "score": 2, "last_activity_date": 1467222452, "last_edit_date": 1495540354, "creation_date": 1467222124, "answer_id": 38106654, "question_id": 38106497, "link": "https://stackoverflow.com/questions/38106497/is-it-possible-to-create-systemstackerror-stack-level-too-deep-errors-without/38106654#38106654", "title": "Is it possible to create &quot;SystemStackError: stack level too deep&quot; errors without recursion?", "body": "<p>It does actually reach its maximum stack limit...  </p>\n\n<pre><code>def do_it x=1\n  puts \"Do it #{x}\"\n  do_it x+1\nend\ndo_it\n</code></pre>\n\n<p>Here's a reasonable explanation of Ruby's stack limitations: <a href=\"https://stackoverflow.com/questions/242617\">How to increase stack size for a ruby app. Recursive app getting: Stack level too deep (SystemStackError)</a></p>\n\n<hr>\n\n<h3>Summary of Ruby stack details</h3>\n\n<p>courtesy @gregspurrier:</p>\n\n<ul>\n<li>v1.8.x used C stack</li>\n<li>v1.9.x used virtual memory with its own stack</li>\n<li>v2.0.0 this VM limit can be set via <code>RUBY_THREAD_VM_STACK_SIZE</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1467222199, "creation_date": 1467222199, "answer_id": 38106677, "question_id": 38106497, "link": "https://stackoverflow.com/questions/38106497/is-it-possible-to-create-systemstackerror-stack-level-too-deep-errors-without/38106677#38106677", "title": "Is it possible to create &quot;SystemStackError: stack level too deep&quot; errors without recursion?", "body": "<p>It actually runs out of space on the stack.\nEvery method invocation needs some space on the stack. You could have code like this:</p>\n\n<pre><code>def method_1\n  method_2\nend\ndef method_2\n  method_3\nend\n...\n...\ndef method_123456\n  method_123457\nend\n\nmethod_1\n</code></pre>\n\n<p>There is no recursion involved but still it will run out of stack space at some point.</p>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 3, "last_activity_date": 1467222869, "last_edit_date": 1467222869, "creation_date": 1467222508, "answer_id": 38106753, "question_id": 38106497, "link": "https://stackoverflow.com/questions/38106497/is-it-possible-to-create-systemstackerror-stack-level-too-deep-errors-without/38106753#38106753", "title": "Is it possible to create &quot;SystemStackError: stack level too deep&quot; errors without recursion?", "body": "<blockquote>\n  <p>In this example, does it detect the certainty of running out of stack or does it actually run out of stack?</p>\n</blockquote>\n\n<p>It actually runs out of stack. It is, in fact, impossible to \"detect the certainty of running out of stack\" in the general case because of the <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow\">halting problem</a>, one of the core problems in computer science.</p>\n\n<blockquote>\n  <p>Is it possible to produce this error without using recursion?</p>\n</blockquote>\n\n<p>Sure. Just define a lot of methods, each of which calls the next:</p>\n\n<pre><code>20000.times do |n|\n  define_method :\"foo_#{n}\" do\n    puts \"Called #{__method__}\"\n    send :\"foo_#{n+1}\"\n  end\nend\n\nfoo_0\n# -&gt; Called foo_0\n# -&gt; Called foo_1\n# -&gt; Called foo_2\n# -&gt; Called foo_3\n# ...\n# -&gt; Called foo_4931\n# -&gt; SystemStackError: stack level too deep\n</code></pre>\n"}], "owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 38106753, "answer_count": 3, "score": 1, "last_activity_date": 1467222869, "creation_date": 1467221601, "last_edit_date": 1467221963, "question_id": 38106497, "link": "https://stackoverflow.com/questions/38106497/is-it-possible-to-create-systemstackerror-stack-level-too-deep-errors-without", "title": "Is it possible to create &quot;SystemStackError: stack level too deep&quot; errors without recursion?", "body": "<p>Consider the following irb interaction:</p>\n\n<pre><code>2.1.1 :001 &gt; def do_it\n2.1.1 :002?&gt;   do_it\n2.1.1 :003?&gt; end\n =&gt; :do_it \n2.1.1 :004 &gt; do_it\nSystemStackError: stack level too deep\n</code></pre>\n\n<p>In this example, does it detect the certainty of running out of stack or does it actually run out of stack? Is it possible to produce this error without using recursion?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "loops", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 2224, "user_id": 4269732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/swGs5.jpg?s=128&g=1", "display_name": "Qaisar Nadeem", "link": "https://stackoverflow.com/users/4269732/qaisar-nadeem"}, "edited": false, "score": 0, "creation_date": 1467222227, "post_id": 38106321, "comment_id": 63646852, "body": "First of all your question is not so explanatory. How do you expect to return multiple records while querying on ID (primary key) ?"}, {"owner": {"reputation": 2224, "user_id": 4269732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/swGs5.jpg?s=128&g=1", "display_name": "Qaisar Nadeem", "link": "https://stackoverflow.com/users/4269732/qaisar-nadeem"}, "edited": false, "score": 1, "creation_date": 1467222331, "post_id": 38106321, "comment_id": 63646916, "body": "Let me tell you what I understood from your question.  So you saying you have an array of values (after string spliting)  And you have multiple Model objects (after querying) and you want each value to be set for model in same order , right ?"}, {"owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "reply_to_user": {"reputation": 2224, "user_id": 4269732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/swGs5.jpg?s=128&g=1", "display_name": "Qaisar Nadeem", "link": "https://stackoverflow.com/users/4269732/qaisar-nadeem"}, "edited": false, "score": 0, "creation_date": 1467222344, "post_id": 38106321, "comment_id": 63646926, "body": "@QaisarNadeem Thanks for that. Post updated."}, {"owner": {"reputation": 2224, "user_id": 4269732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/swGs5.jpg?s=128&g=1", "display_name": "Qaisar Nadeem", "link": "https://stackoverflow.com/users/4269732/qaisar-nadeem"}, "edited": false, "score": 0, "creation_date": 1467222425, "post_id": 38106321, "comment_id": 63646977, "body": "okay lemme right an answer"}], "answers": [{"comments": [{"owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "edited": false, "score": 0, "creation_date": 1467222858, "post_id": 38106813, "comment_id": 63647258, "body": "What is <code>&amp;.tap</code>? Rails 5 method?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "edited": false, "score": 0, "creation_date": 1467223326, "post_id": 38106813, "comment_id": 63647550, "body": "<a href=\"http://ruby-doc.org/core-2.3.1/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">tap</a> is in Ruby core since 1.9. It&#39;s not an essential method to use. I think it&#39;s benefit is mostly stylistic, adding readability. The <code>&amp;.</code> is the safe navigation operator which I linked to."}, {"owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "edited": false, "score": 0, "creation_date": 1467223883, "post_id": 38106813, "comment_id": 63647881, "body": "I had to accept Qaisar&#39;s answer as it&#39;s more clear to me. However. none of you answer worked. I&#39;ve tried many times. The last code never updated the table column. First got a syntax error here: <code>foo&amp;.update(file_file_name: a)</code>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "edited": false, "score": 1, "creation_date": 1467223960, "post_id": 38106813, "comment_id": 63647938, "body": "Because you&#39;re not using Ruby 2.3. You can remove the <code>&amp;</code> and it will work."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 1, "last_activity_date": 1467224133, "last_edit_date": 1467224133, "creation_date": 1467222734, "answer_id": 38106813, "question_id": 38106321, "link": "https://stackoverflow.com/questions/38106321/update-each-array-object-value-in-rails/38106813#38106813", "title": "Update Each Array-Object Value in Rails", "body": "<p>First of all, using <code>Foo.where(id:1).update_all</code> to update a single record may work, but is non-idiomatic. It's better to use <code>Foo.find_by(id: 1).update</code>. For getting single records, I prefer to use <code>find_by</code> instead of <code>find</code> because it returns <code>nil</code> instead of raising NotFound errors, but that's a personal preference.</p>\n\n<p>Second, the way you're using <code>update_all(bar: a)</code> is giving you unexpected results. In a <code>map</code> block, the returned value becomes part of the resulting array. <code>update_all</code> doesn't return the record which were changed. It returns an integer showing the count of records which were changed. Similarly, <code>update</code> doesn't return the record. It returns <code>true</code> or false` depending on if the validations passed.</p>\n\n<p>Tying together these concepts, the following code can be written:</p>\n\n<pre><code>str = \"abc---def\"    \nstr.split('---').map do |a|\n foo = Foo.find_by(id:1)\n foo&amp;.update(bar: a)\n foo\nend\n\n# note that you could instead write `foo.update(bar: a)` if you\n# don't want to use the safe navigation operator\n</code></pre>\n\n<p>Or another way to write it which does the same thing:</p>\n\n<pre><code>str = \"abc---def\"\nstr.split('---').map do |a|\n Foo.find_by(id:1)&amp;.tap { |foo| foo.update(bar: a) }\nend\n</code></pre>\n\n<p>Note that in these examples I'm using the <a href=\"http://mitrev.net/ruby/2015/11/13/the-operator-in-ruby/\" rel=\"nofollow\">safe navigation operator</a> which is in Ruby versions newer than <code>2.3</code>. It helps prevent <code>NoMethodError</code> on nil objects, but isn't really necessary. </p>\n"}, {"tags": [], "owner": {"reputation": 2224, "user_id": 4269732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/swGs5.jpg?s=128&g=1", "display_name": "Qaisar Nadeem", "link": "https://stackoverflow.com/users/4269732/qaisar-nadeem"}, "is_accepted": true, "score": 2, "last_activity_date": 1467224178, "last_edit_date": 1467224178, "creation_date": 1467222912, "answer_id": 38106871, "question_id": 38106321, "link": "https://stackoverflow.com/questions/38106321/update-each-array-object-value-in-rails/38106871#38106871", "title": "Update Each Array-Object Value in Rails", "body": "<p>First of all let's get started from some basics. </p>\n\n<p>You want to update multiple rows and want to set different value for each row. So it cannot be done in single query like you are doing. So you need to loop through the <code>Foo</code> objects and set each one separately. </p>\n\n<p>So let's assume</p>\n\n<pre><code>str = \"abc---def---ghi---jkl\"\ntokens = str.split('---') \nfoos_to_update = Foo.where(product_id: 1) #Let's assume it will return 4 or lesser records. (otherwise you need to tell what do you wanna do if it returns more then `tokens`)\nfoos_to_update.each_with_index {|foo,i| foo.update(bar: tokens[i])}\n</code></pre>\n\n<p>The last line is looping through returned objects and setting the <code>bar</code> value for each object.</p>\n"}], "owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2775, "favorite_count": 0, "accepted_answer_id": 38106871, "answer_count": 2, "score": 0, "last_activity_date": 1467224178, "creation_date": 1467221020, "last_edit_date": 1467222321, "question_id": 38106321, "link": "https://stackoverflow.com/questions/38106321/update-each-array-object-value-in-rails", "title": "Update Each Array-Object Value in Rails", "body": "<p>Basically I want to update each table column for a Model in Rails 5.</p>\n\n<pre><code>str = \"abc---def\"\n\nstr.split('---').map do |a|\n Foo.where(product_id:1).update_all(bar: a)\nend\n</code></pre>\n\n<p><strong>Old object would be like:</strong></p>\n\n<pre><code>[\n [0] { product_id: 1,\n       ...,\n       bar: \"xxx\",\n       ...\n     },\n [1] { product_id: 1,\n       ...,\n       bar: \"xxx\",\n       ...\n     }\n\n]\n</code></pre>\n\n<p><strong>New should be like:</strong></p>\n\n<pre><code>[\n [0] { product_id: 1,\n       ...,\n       bar: \"abc\",\n       ...\n     },\n [1] { product_id: 1,\n       ...,\n       bar: \"def\",\n       ...\n     }\n\n]\n</code></pre>\n\n<p>But what I got is <code>bar: \"def\"</code> for each. Is there a clean method in rails to achieve what I want? <code>update_attributes</code> gives an error.</p>\n\n<p>Is the title name correct?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rufus-scheduler"], "comments": [{"owner": {"reputation": 4143, "user_id": 168839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00f571db651544b0a58c99c79c34d3e2?s=128&d=identicon&r=PG", "display_name": "Christopher Davies", "link": "https://stackoverflow.com/users/168839/christopher-davies"}, "edited": false, "score": 1, "creation_date": 1467220451, "post_id": 38105983, "comment_id": 63645805, "body": "Hm. I&#39;m not familiar with Rufus, but I&#39;ve done lots of scheduling. You might look at doing an interval job instead. From Rufus&#39; documentation: <code>Whereas &quot;every&quot; jobs are like &quot;every 10 minutes, do this&quot;, interval jobs are like &quot;do that, then wait for 10 minutes, then do that again, and so on&quot;</code> Basically, if you schedule one of those, it will wait for that to complete, then schedule again in 1m (or whatever your interval is)."}], "answers": [{"tags": [], "owner": {"reputation": 1883, "user_id": 799858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9930600ff08875bf9a79bcbd9b8faf2d?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/799858/luke"}, "is_accepted": false, "score": 0, "last_activity_date": 1467226187, "creation_date": 1467226187, "answer_id": 38107843, "question_id": 38105983, "link": "https://stackoverflow.com/questions/38105983/rufus-scheduler-concurrency/38107843#38107843", "title": "rufus-scheduler concurrency", "body": "<p>You can add a file lock check for your tasks. There is a gem that makes it really easy: <a href=\"https://github.com/cph/single_file\" rel=\"nofollow\">https://github.com/cph/single_file</a>.</p>\n\n<p>Basically, you can wrap your task in a SingleFile block and the first task will put a lock on the temp file. When it schedules to run again, if the previous task still has a lock placed on the file (it's not done running), the task won't run that time.</p>\n\n<pre><code>include SingleFile\n\nscheduler.every '1m' do\n  with_file_lock(\"/tmp/magic_is_happening.lock\") do\n    MagicClass.poof!\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "is_accepted": false, "score": 0, "last_activity_date": 1467235668, "creation_date": 1467235668, "answer_id": 38110332, "question_id": 38105983, "link": "https://stackoverflow.com/questions/38105983/rufus-scheduler-concurrency/38110332#38110332", "title": "rufus-scheduler concurrency", "body": "<p>Christopher Davies' response in form of a comment is very good. He points to \"interval\" jobs.</p>\n\n<p><a href=\"https://github.com/jmettraux/rufus-scheduler#in-at-every-interval-cron\" rel=\"nofollow\">https://github.com/jmettraux/rufus-scheduler#in-at-every-interval-cron</a></p>\n\n<p>You could thus do</p>\n\n<pre><code>scheduler.interval '1m' do\n  # ...\nend\n</code></pre>\n\n<p>to let rufus-scheduler run your block with 1 minute between each run.</p>\n\n<p>If you dig further down the documentation, there is another technique exposed:</p>\n\n<p><a href=\"https://github.com/jmettraux/rufus-scheduler#overlap--false\" rel=\"nofollow\">https://github.com/jmettraux/rufus-scheduler#overlap--false</a></p>\n\n<pre><code>scheduler.every '1m', overlap: false do\n  # ...\nend\n</code></pre>\n\n<p>The scheduler will check every minute. If the block is not yet running, it will run it, if it is running it won't trigger, it will come back a minute later and check again.</p>\n\n<p>Pick the technique that fits your needs.</p>\n"}], "owner": {"reputation": 9, "user_id": 2085130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd12f70aaa7c3d49698cf24f0e2a0660?s=128&d=identicon&r=PG", "display_name": "Atsuki", "link": "https://stackoverflow.com/users/2085130/atsuki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1467235705, "creation_date": 1467219910, "last_edit_date": 1467235705, "question_id": 38105983, "link": "https://stackoverflow.com/questions/38105983/rufus-scheduler-concurrency", "title": "rufus-scheduler concurrency", "body": "<p>I'm running a ruby on rails application that needs to perform a certain task every one minute:</p>\n\n<pre><code>scheduler.every '1m' do\n   .....\nend\n</code></pre>\n\n<p>But sometimes, the job takes longer than 1 minute to complete the work. What is happening is that before he finished, Rufus starts a new job, which \"kills\" the earlier job before it is over.\nIs there any way to Rufus expect the job finish before starting the next one?</p>\n\n<p>Ps.: Still in development, so I'm using Webrick</p>\n"}, {"tags": ["ruby", "ldap", "ldap-query", "novell"], "comments": [{"owner": {"reputation": 1615, "user_id": 3441151, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f69b346c716e2adb7616f7052886cb7d?s=128&d=identicon&r=PG&f=1", "display_name": "user3441151", "link": "https://stackoverflow.com/users/3441151/user3441151"}, "edited": false, "score": 0, "creation_date": 1467805081, "post_id": 38105649, "comment_id": 63868166, "body": "your port is &quot;686&quot;. I think this should be 636(for ssl) or 389."}], "answers": [{"tags": [], "owner": {"reputation": 9067, "user_id": 88122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/U0pg3.png?s=128&g=1", "display_name": "jwilleke", "link": "https://stackoverflow.com/users/88122/jwilleke"}, "is_accepted": true, "score": 1, "last_activity_date": 1467293003, "creation_date": 1467293003, "answer_id": 38124471, "question_id": 38105649, "link": "https://stackoverflow.com/questions/38105649/ruby-ldap-query-novell-edirectory/38124471#38124471", "title": "Ruby LDAP Query Novell eDirectory", "body": "<p>You are NOT making a conenction to \"172.21.45.60\" on port 686.</p>\n\n<p>I would suggest you try to initially make connections in plain text when testing. </p>\n\n<p>So start REALLY SIMPLE:</p>\n\n<pre><code>require 'rubygems'\nrequire 'net/ldap'\n\nldap = Net::LDAP.new :host =&gt; server_ip_address,\n     :port =&gt; 389,\n     :auth =&gt; {\n           :method =&gt; :simple,\n           :username =&gt; \"cn=manager,dc=example,dc=com\",\n           :password =&gt; \"opensesame\"\n     }\n\nfilter = Net::LDAP::Filter.eq( \"cn\", \"George*\" )\ntreebase = \"dc=example,dc=com\"\n\nldap.search( :base =&gt; treebase, :filter =&gt; filter ) do |entry|\n  puts \"DN: #{entry.dn}\"\n  entry.each do |attribute, values|\n    puts \"   #{attribute}:\"\n    values.each do |value|\n      puts \"      ---&gt;#{value}\"\n    end\n  end\nend\n</code></pre>\n\n<p>Once that works, then add TLS.</p>\n\n<p>As I see the <a href=\"http://www.rubydoc.info/github/ruby-ldap/ruby-net-ldap/Net/LDAP:encryption\" rel=\"nofollow\">Ruby documentation</a> (I am not Ruby Expert), is shows the example:</p>\n\n<pre><code>{\n  :method =&gt; :start_tls,\n  :tls_options =&gt; { :ca_file =&gt; \"/etc/cafile.pem\", :ssl_version =&gt; \"TLSv1_1\" }\n}\n</code></pre>\n\n<p>-jim</p>\n"}], "owner": {"reputation": 89, "user_id": 1846233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf63d1007aa804f61a31924b5f6e20f?s=128&d=identicon&r=PG", "display_name": "safernandez666", "link": "https://stackoverflow.com/users/1846233/safernandez666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 38124471, "answer_count": 1, "score": 1, "last_activity_date": 1467293003, "creation_date": 1467218848, "last_edit_date": 1467223432, "question_id": 38105649, "link": "https://stackoverflow.com/questions/38105649/ruby-ldap-query-novell-edirectory", "title": "Ruby LDAP Query Novell eDirectory", "body": "<p>I want to connect to Novell eDirectory with Ruby, but I have TimeOut on 'open_connection'.</p>\n\n<p>What do you think?</p>\n\n<pre><code>require 'net/ldap' \n\n    ldap = Net::LDAP.new :host =&gt; \"172.21.45.60\",\n         :port =&gt; 686,\n         :encrytion =&gt; :simple_tls,\n         :auth =&gt; {\n               :method =&gt; :simple,\n               :username =&gt; \"cn=XXX,ou=XXX,ou=XXX,o=XXX\",\n               :password =&gt; \"XXX\"\n         }\n\n    filter = Net::LDAP::Filter.eq(\"cn\", \"paul*\")\n    treebase = \"ou=XXX,ou=XXX,o=XXX\"\n    attrs = [\"mail\", \"cn\", \"sn\", \"objectclass\", \"loginTime\"]\n\n    ldap.search(:base =&gt; treebase, :filter =&gt; filter, :attributes =&gt; attrs) do |entry|\n      puts \"DN: #{entry.dn}\"\n      entry.each do |attribute, values|\n        puts \"   #{attribute}:\"\n        values.each do |value|\n          puts \"      ---&gt;#{value}\"\n        end\n      end\n    end\n\n    p ldap.get_operation_result\n</code></pre>\n\n<p><strong>Error</strong></p>\n\n<pre><code>C:/Ruby23/lib/ruby/gems/2.3.0/gems/net-ldap-0.14.0/lib/net/ldap/connection.rb:63 :in `open_connection': Se produjo un error durante el intento de conexi\u00ben ya que la parte conectada no respondi\u00be adecuadamente tras un periodo de tiempo, o bien se produjo un error en la conexi\u00ben establecida ya que el host conectado no ha p odido responder. - user specified timeout (Net::LDAP::Error)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1467219748, "post_id": 38105529, "comment_id": 63645363, "body": "<code>full-name</code> is an invalid method name. What is your question?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4802674, "user_type": "registered", "profile_image": "https://graph.facebook.com/786342211473855/picture?type=large", "display_name": "Chenzi Wang", "link": "https://stackoverflow.com/users/4802674/chenzi-wang"}, "edited": false, "score": 0, "creation_date": 1467218742, "post_id": 38105576, "comment_id": 63644740, "body": "So is that means string+string in invalid?"}, {"owner": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "reply_to_user": {"reputation": 39, "user_id": 4802674, "user_type": "registered", "profile_image": "https://graph.facebook.com/786342211473855/picture?type=large", "display_name": "Chenzi Wang", "link": "https://stackoverflow.com/users/4802674/chenzi-wang"}, "edited": false, "score": 0, "creation_date": 1467218799, "post_id": 38105576, "comment_id": 63644765, "body": "No, that means <code>nil</code> + string is invalid."}], "tags": [], "owner": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "is_accepted": false, "score": 4, "last_activity_date": 1467219171, "last_edit_date": 1467219171, "creation_date": 1467218647, "answer_id": 38105576, "question_id": 38105529, "link": "https://stackoverflow.com/questions/38105529/undefined-method-for-nilnilclass-in-rails/38105576#38105576", "title": "undefined method `+&#39; for nil:NilClass in Rails", "body": "<p>Your <code>first_name</code> attribute contains <code>nil</code>.</p>\n\n<p>Since <code>NilClass</code> does not implement <code>+</code> method, it raises an error. One way to handle that would be to cast values to string:</p>\n\n<pre><code>first_name.to_s + \" \" + last_name.to_s\n</code></pre>\n\n<p>But the better, idiomatic way is to use string interpolation:</p>\n\n<pre><code>def full_name\n  \"#{first_name} #{last_name}\"\nend\n</code></pre>\n\n<p>To see the actual value that is contained in a variable you could use</p>\n\n<pre><code>puts first_name\n</code></pre>\n\n<p>But, since the <code>nil</code> value would become an empty string when printed, it would look the same as <code>\"\"</code>, a blank string. To see if the value is actually <code>nil</code> when printing, you can use</p>\n\n<pre><code>puts first_name.nil?\n# =&gt; true\n</code></pre>\n\n<p>or</p>\n\n<pre><code>puts first_name.class\n# =&gt; NilClass\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3662, "user_id": 179438, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9bd9a8a0dbba9f6aa56b78304f231f1a?s=128&d=identicon&r=PG", "display_name": "Alessandro De Simone", "link": "https://stackoverflow.com/users/179438/alessandro-de-simone"}, "is_accepted": false, "score": 1, "last_activity_date": 1467219560, "creation_date": 1467219560, "answer_id": 38105877, "question_id": 38105529, "link": "https://stackoverflow.com/questions/38105529/undefined-method-for-nilnilclass-in-rails/38105877#38105877", "title": "undefined method `+&#39; for nil:NilClass in Rails", "body": "<p>Your code is right, just you have one (or more) record with empty value in first_name (and/or empty last_name).\nAs Nic explained Ruby does not have automatic cast from nil to string, but I suppouse you want to some value for those fields, so I suggest you to use a proper validation for them:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  validates :first_name, :last_name, presence: true\nend\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4802674, "user_type": "registered", "profile_image": "https://graph.facebook.com/786342211473855/picture?type=large", "display_name": "Chenzi Wang", "link": "https://stackoverflow.com/users/4802674/chenzi-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1467219657, "creation_date": 1467218484, "last_edit_date": 1467219657, "question_id": 38105529, "link": "https://stackoverflow.com/questions/38105529/undefined-method-for-nilnilclass-in-rails", "title": "undefined method `+&#39; for nil:NilClass in Rails", "body": "<p>In my <code>user.rb</code> file under <code>models</code>, I defined a method <code>full-name</code>, and called this method in my views. It raises this error that I do not know how to solve.</p>\n\n<pre><code>NoMethodError in Statuses#index\nShowing app/views/layouts/application.html.erb where line #24 raised:\nundefined method `+' for nil:NilClass\nExtracted source (around line #10):\n\ndef full_name\n  first_name + \" \" + last_name\nend\n</code></pre>\n\n<p>Rails.root:</p>\n\n<pre><code>Application Trace | Framework Trace | Full Trace\napp/models/user.rb:10:in `full_name'\napp/views/layouts/application.html.erb:24:in `_app_views_layouts_application_html_erb__1801360389632919652_70105866374460'\n&lt;li&gt;\n  &lt;%= link_to current_user.full_name, edit_user_registration_path %&gt;\n&lt;/li&gt;\n</code></pre>\n"}, {"tags": ["android", "ruby-on-rails", "ruby", "ruby-on-rails-4", "login"], "comments": [{"owner": {"reputation": 1378, "user_id": 111291, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3dad48bacc0948b7fa6eb2ac64864e66?s=128&d=identicon&r=PG", "display_name": "Darren Cato", "link": "https://stackoverflow.com/users/111291/darren-cato"}, "edited": false, "score": 0, "creation_date": 1508278589, "post_id": 38104834, "comment_id": 80546974, "body": "did you ever figure this out? care to share the solution?"}], "owner": {"reputation": 860, "user_id": 4750070, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e8307d32c79a04fd8f5e36d25832dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Alberto Alegria", "link": "https://stackoverflow.com/users/4750070/alberto-alegria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1467216311, "creation_date": 1467216311, "question_id": 38104834, "link": "https://stackoverflow.com/questions/38104834/login-using-rails-backend-and-google-omniauth", "title": "Login using Rails backend and Google Omniauth", "body": "<p>I want to building an Android-Web App, so I started with the login. I know how to login to google using the gem omniauth-google-oauth2 and google apis in rails, also I know how to login to google using google apis on android. My question is, there is a way to register my login from an android app to my rails app?</p>\n\n<p>For example, If I enter to\n<code>localhost:3000/login</code> \nand I'm not logged, rails must render my login view (Something like \"Login with Google\"), but If I login from my android app, rails should redirect me to my welcome page.</p>\n\n<p>I've been reading and only found either how to login to google using android or rails. The best info I found so far is <a href=\"https://github.com/elcurator/android-google-plus-omniauth-tutorial\" rel=\"nofollow\">this</a>, the only problem is that only register my login, it doesn't redirect me to another page.</p>\n\n<p>I think my main problem is rails. I've got some experience developing in android, but I'm kinda new in rails.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "bundler", "jruby"], "comments": [{"owner": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "edited": false, "score": 0, "creation_date": 1467218138, "post_id": 38104648, "comment_id": 63644415, "body": "What is in the <code>C:&#47;jruby-9.1.2.0&#47;lib&#47;ruby&#47;gems&#47;shared&#47;extensions&#47;universal-j&zwnj;&#8203;ava-1.8&#47;2.3.0&#47;pg-0.1&zwnj;&#8203;8.4&#47;gem_make.out</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 5216554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f61b70924c1b61aa32e4536f11639d85?s=128&d=identicon&r=PG&f=1", "display_name": "Graeme Campbell", "link": "https://stackoverflow.com/users/5216554/graeme-campbell"}, "is_accepted": false, "score": 0, "last_activity_date": 1482273213, "creation_date": 1482273213, "answer_id": 41252284, "question_id": 38104648, "link": "https://stackoverflow.com/questions/38104648/error-when-installing-postgressql-in-windows-c-extensions-are-not-supported/41252284#41252284", "title": "Error when installing postgresSQL in Windows &quot;C extensions are not supported&quot;", "body": "<p>You need to install the ruby devkit so that your ruby compiler can deal with native C code.\nCheck out the instructions on how to do so here:\n<a href=\"https://github.com/oneclick/rubyinstaller/wiki/Development-Kit\" rel=\"nofollow noreferrer\">https://github.com/oneclick/rubyinstaller/wiki/Development-Kit</a></p>\n\n<p>Once you've installed it, make sure that your windows PATH environmental variable includes a link to the bin folder in your newly created devkit directory. (P.S. Make sure there are no spaces in the path to the directory).</p>\n"}], "owner": {"reputation": 31, "user_id": 4598374, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Chyk2J3F0m4/AAAAAAAAAAI/AAAAAAAAACc/dtfZWgoN1bI/photo.jpg?sz=128", "display_name": "guilloh", "link": "https://stackoverflow.com/users/4598374/guilloh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1482273213, "creation_date": 1467215868, "last_edit_date": 1467226999, "question_id": 38104648, "link": "https://stackoverflow.com/questions/38104648/error-when-installing-postgressql-in-windows-c-extensions-are-not-supported", "title": "Error when installing postgresSQL in Windows &quot;C extensions are not supported&quot;", "body": "<p>I've been trying to <code>gem install pg</code> on many different ways I've found on the internet and none work. They all give the same error.</p>\n\n<p>What I've tried :</p>\n\n<pre><code>gem install pg -- --with-pg-dir=C:\\Program Files (x86)\\PostgreSQL\\9.3:\n\ngem install pg -- --with-pg-dir=C:\\Program Files\\PostgreSQL\\9.5:\n\ngem install pg\n</code></pre>\n\n<p>Using <code>bundle install</code> after editing the Gemfile.</p>\n\n<p>Every single time I get this error:</p>\n\n<pre><code>C:\\laragon\\www\\ruby\\Car-X&gt;gem install pg Building native extensions.  This could take a while... C:/jruby-9.1.2.0/lib/ruby/stdlib/rubygems/ext/ext_conf_builder.rb:56: warning: Tempfile#unlink or delete called on open file; ignoring ERROR:  Error installing pg:\n        ERROR: Failed to build gem native extension.\n\n    current directory: C:/jruby-9.1.2.0/lib/ruby/gems/shared/gems/pg-0.18.4/ext C:/jruby-9.1.2.0/bin/jruby.exe -r ./siteconf20160629-8568-1ou7emz.rb extconf.rb NotImplementedError: C extensions are not supported\n    &lt;top&gt; at C:/jruby-9.1.2.0/lib/ruby/stdlib/mkmf.rb:1   require at org/jruby/RubyKernel.java:944    (root) at C:/jruby-9.1.2.0/lib/ruby/stdlib/rubygems/core_ext/kernel_require.rb:1\n    &lt;top&gt; at extconf.rb:2\n\nextconf failed, exit code 1\n\nGem files will remain installed in C:/jruby-9.1.2.0/lib/ruby/gems/shared/gems/pg-0.18.4 for inspection. Results logged to C:/jruby-9.1.2.0/lib/ruby/gems/shared/extensions/universal-java-1.8/2.3.0/pg-0.18.4/gem_make.out\n</code></pre>\n\n<p>Any help would be apreciated. </p>\n"}, {"tags": ["ruby", "recursion"], "comments": [{"owner": {"reputation": 2341, "user_id": 6047960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a37bc0cc9fe7dd8dda91e4f4de592ae?s=128&d=identicon&r=PG&f=1", "display_name": "Karen B", "link": "https://stackoverflow.com/users/6047960/karen-b"}, "edited": false, "score": 0, "creation_date": 1467215930, "post_id": 38104408, "comment_id": 63642975, "body": "The best way to picture what a recursive function is doing is often to add some output for each iteration.  Try adding <code>puts arr.inspect</code> right above the last <code>arr</code> line in the method and run."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1467216972, "post_id": 38104408, "comment_id": 63643689, "body": "Where do you think it counts up?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1467217100, "post_id": 38104408, "comment_id": 63643776, "body": "Please be careful asking &quot;explain it to me&quot; questions. Wide-open, &quot;explain all the code to me&quot; questions are too broad and don&#39;t show any research/effort into understanding the code. &quot;explain one particular line&quot;, after researching and explaining how the research didn&#39;t help, is much less broad and more likely to be on-topic. I didn&#39;t down vote or vote to close because it is a small code chunk."}], "answers": [{"tags": [], "owner": {"reputation": 4945, "user_id": 1561929, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/42466d208f3eb0adedc4cebdba1970f8?s=128&d=identicon&r=PG", "display_name": "Alex Harris", "link": "https://stackoverflow.com/users/1561929/alex-harris"}, "is_accepted": false, "score": 2, "last_activity_date": 1467215260, "creation_date": 1467215260, "answer_id": 38104448, "question_id": 38104408, "link": "https://stackoverflow.com/questions/38104408/ruby-recursive-method/38104448#38104448", "title": "Ruby: recursive method", "body": "<p>Well step through the code with the supplied parameters. The first step is to check if n &lt; 0 which its not. If it isn't 0 reverse append with [], 3 and appends the that array the number and then returns the array.</p>\n\n<p>So it takes the array, adds 4 to it after it has gone through the step of dealing with <code>[], 3</code>, <code>[], 2</code>, <code>[],1</code> and <code>[], 0</code>. So the first call that will succeed is just returning the array when it gets below 0, next is 0 gets appended, then one, then 2, then 3 and lastly the original call with 4 gets added <code>arr &lt;&lt; n</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "edited": false, "score": 1, "creation_date": 1467239298, "post_id": 38104621, "comment_id": 63655703, "body": "@13aal I think the biggest conceptual difficulty that people have when learning about recursive functions for the first time is simply in going through an example, line by line, and tracking what actually happens. So yes, my answer is perhaps a little over the top; but I hope it will encourage readers to step through the code like this too, in order to understand the basic concept."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 8, "last_activity_date": 1467215763, "creation_date": 1467215763, "answer_id": 38104621, "question_id": 38104408, "link": "https://stackoverflow.com/questions/38104408/ruby-recursive-method/38104621#38104621", "title": "Ruby: recursive method", "body": "<ol>\n<li>The method <code>reverse_append([],4)</code> is called</li>\n<li>Since <code>4 &gt;= 0</code>, the <code>return</code> statement does not get called.</li>\n<li>The method <code>reverse_append([],3)</code> is called.</li>\n<li>Since <code>3 &gt;= 0</code>, the <code>return</code> statement does not get called.</li>\n<li>The method <code>reverse_append([],2)</code> is called.</li>\n<li>Since <code>2 &gt;= 0</code>, the <code>return</code> statement does not get called.</li>\n<li>The method <code>reverse_append([],1)</code> is called.</li>\n<li>Since <code>1 &gt;= 0</code>, the <code>return</code> statement does not get called.</li>\n<li>The method <code>reverse_append([],0)</code> is called.</li>\n<li>Since <code>0 &gt;= 0</code>, the <code>return</code> statement does not get called.</li>\n<li>The method <code>reverse_append([],-1)</code> is called.</li>\n<li><strong>Since <code>-1 &lt; 0</code>, the array (<code>[]</code>) is returned.</strong></li>\n<li>We pop up one level in our call stack, to where <code>n = 0</code> and <code>arr = []</code>.</li>\n<li><code>arr &lt;&lt; n</code> and <code>arr</code> is returned, so now <code>arr = [0]</code>.</li>\n<li>We pop up one level in our call stack, to where <code>n = 1</code> and <code>arr = [0]</code>.</li>\n<li><code>arr &lt;&lt; n</code> and <code>arr</code> is returned, so now <code>arr = [0, 1]</code>.</li>\n<li>We pop up one level in our call stack, to where <code>n = 2</code> and <code>arr = [0, 1]</code>.</li>\n<li><code>arr &lt;&lt; n</code> and <code>arr</code> is returned, so now <code>arr = [0, 1, 2]</code>.</li>\n<li>We pop up one level in our call stack, to where <code>n = 3</code> and <code>arr = [0, 1, 2]</code>.</li>\n<li><code>arr &lt;&lt; n</code> and <code>arr</code> is returned, so now <code>arr = [0, 1, 2, 3]</code>.</li>\n<li>We pop up one level in our call stack, to where <code>n = 4</code> and <code>arr = [0, 1, 2, 3]</code>.</li>\n<li><code>arr &lt;&lt; n</code> and <code>arr</code> is returned, so now <code>arr = [0, 1, 2, 3, 4]</code>.</li>\n<li>Finally, the \"top-level\" method returns, and we have our final result.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 2, "last_activity_date": 1467216758, "creation_date": 1467216758, "answer_id": 38104996, "question_id": 38104408, "link": "https://stackoverflow.com/questions/38104408/ruby-recursive-method/38104996#38104996", "title": "Ruby: recursive method", "body": "<p>There's a nice tool you can add to many editors called \"<a href=\"https://github.com/JoshCheek/seeing_is_believing\" rel=\"nofollow\">Seeing Is Believing</a>\", which lets you see what is happening as code runs:</p>\n\n<pre><code>def reverse_append(arr, n)  \n  return arr if n &lt; 0 # =&gt; false, false, false, false, true\n  reverse_append(arr, n-1) # =&gt; [], [0], [0, 1], [0, 1, 2]\n  arr &lt;&lt; n # =&gt; [0], [0, 1], [0, 1, 2], [0, 1, 2, 3]\n  arr # =&gt; [0], [0, 1], [0, 1, 2], [0, 1, 2, 3]\nend \n\nreverse_append([], 3) # =&gt; [0, 1, 2, 3]\n</code></pre>\n\n<p>However, with a name like \"reverse_append\" it seems like you should see a result that is descending in values:</p>\n\n<pre><code>def reverse_append(arr, n)  \n  return arr if n &lt; 0 # =&gt; false, false, false, false, true\n  reverse_append(arr, n-1) # =&gt; [], [0], [1, 0], [2, 1, 0]\n  arr.unshift n # =&gt; [0], [1, 0], [2, 1, 0], [3, 2, 1, 0]\n  arr # =&gt; [0], [1, 0], [2, 1, 0], [3, 2, 1, 0]\nend \n\nreverse_append([], 3) # =&gt; [3, 2, 1, 0]\n</code></pre>\n\n<p>In either case, there are a lot of easier ways to generate such an array without relying on recursion:</p>\n\n<pre><code>[*0..3] # =&gt; [0, 1, 2, 3]\n(0..3).to_a # =&gt; [0, 1, 2, 3]\n\n[*0..3].reverse # =&gt; [3, 2, 1, 0]\n(0..3).to_a.reverse # =&gt; [3, 2, 1, 0]\n</code></pre>\n"}], "owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 1, "accepted_answer_id": 38104621, "answer_count": 3, "score": -1, "last_activity_date": 1467220618, "creation_date": 1467215156, "last_edit_date": 1467220618, "question_id": 38104408, "link": "https://stackoverflow.com/questions/38104408/ruby-recursive-method", "title": "Ruby: recursive method", "body": "<pre><code>def reverse_append(arr, n)  \n    return arr if n &lt; 0 \n    reverse_append(arr, n-1)\n    arr &lt;&lt; n\n    arr\nend \n\nreverse_append([],4) #=&gt; [0, 1, 2, 3, 4]\n</code></pre>\n\n<p>I can't seem to understand this recursive method. It produces an array from 0 up to n.</p>\n\n<p>Can someone explain this to me? </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1467214563, "post_id": 38104139, "comment_id": 63641974, "body": "Cool. And what is your question so far?"}, {"owner": {"reputation": 1618, "user_id": 1791856, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f123ff5b9de91e4b6a2fc52f2e28daa5?s=128&d=identicon&r=PG", "display_name": "Alex Moore-Niemi", "link": "https://stackoverflow.com/users/1791856/alex-moore-niemi"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1467214753, "post_id": 38104139, "comment_id": 63642095, "body": "i can rephrase, if that helps? i wondered if there was a way to do it without writing my own function, or if there is a best way to write the function"}], "answers": [{"comments": [{"owner": {"reputation": 914, "user_id": 2115680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/j2Fk3.jpg?s=128&g=1", "display_name": "Marc-Andre", "link": "https://stackoverflow.com/users/2115680/marc-andre"}, "edited": false, "score": 0, "creation_date": 1467215101, "post_id": 38104177, "comment_id": 63642334, "body": "Come chat here <a href=\"http://chat.stackexchange.com/rooms/8595/the-2nd-monitor\">chat.stackexchange.com/rooms/8595/the-2nd-monitor</a> . I think we can work out something"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1467215108, "post_id": 38104177, "comment_id": 63642342, "body": "Just compare the quality of the questions."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1467218440, "post_id": 38104177, "comment_id": 63644590, "body": "Just as a FYI, deleting questions to preserve reputation isn&#39;t the best solution. Instead, fix the question so it&#39;s a better one. Think of it this way, questions are owned by the SO community once you ask them. We&#39;ll delete them if necessary."}, {"owner": {"reputation": 1618, "user_id": 1791856, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f123ff5b9de91e4b6a2fc52f2e28daa5?s=128&d=identicon&r=PG", "display_name": "Alex Moore-Niemi", "link": "https://stackoverflow.com/users/1791856/alex-moore-niemi"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1560969680, "post_id": 38104177, "comment_id": 99915318, "body": "@SergioTulentsev ah, i thought it was more correct to put my potential solution in the Answer spot than the Question. i&#39;ll do better next time."}], "tags": [], "owner": {"reputation": 1618, "user_id": 1791856, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f123ff5b9de91e4b6a2fc52f2e28daa5?s=128&d=identicon&r=PG", "display_name": "Alex Moore-Niemi", "link": "https://stackoverflow.com/users/1791856/alex-moore-niemi"}, "is_accepted": true, "score": -1, "last_activity_date": 1467214587, "creation_date": 1467214587, "answer_id": 38104177, "question_id": 38104139, "link": "https://stackoverflow.com/questions/38104139/what-is-the-ruby-equivalent-of-haskells-scanl/38104177#38104177", "title": "What is the Ruby equivalent of Haskell&#39;s scanl?", "body": "<p>Probably a nicer version could be written, but this is what I came up with:</p>\n\n<pre><code>require 'spec_helper'\n\nclass Array\n  def scanl accumulator, &amp;block\n    results = [accumulator] + self\n    results.each_with_index do |e, i|\n      results[i] = block.call(accumulator, e)\n      accumulator = results[i]\n    end\n    results\n  end\nend\n\ndescribe \"#scanl\" do\n  it 'is similar to foldl, but returns a list of successive reduced values from the left' do\n    # example from http://learnyouahaskell.com/higher-order-functions\n    expect([3, 5, 2, 1].scanl(0, &amp;:+)).to eq([0,3,8,10,11])\n  end\nend\n</code></pre>\n\n<p>I considered changing <code>scanl</code> to take just a method name like <code>:+</code> instead of a block to be more like <code>reduce</code>. Thoughts?</p>\n"}, {"comments": [{"owner": {"reputation": 1618, "user_id": 1791856, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f123ff5b9de91e4b6a2fc52f2e28daa5?s=128&d=identicon&r=PG", "display_name": "Alex Moore-Niemi", "link": "https://stackoverflow.com/users/1791856/alex-moore-niemi"}, "edited": false, "score": 0, "creation_date": 1467215797, "post_id": 38104567, "comment_id": 63642875, "body": "nice i had a feeling i could piggy-back on reduce somehow. do you have to do the <code>is_a?(Proc)</code> check? i&#39;d figure it&#39;d be a no-op if it was already a proc and thus safe"}, {"owner": {"reputation": 1618, "user_id": 1791856, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f123ff5b9de91e4b6a2fc52f2e28daa5?s=128&d=identicon&r=PG", "display_name": "Alex Moore-Niemi", "link": "https://stackoverflow.com/users/1791856/alex-moore-niemi"}, "edited": false, "score": 1, "creation_date": 1467215991, "post_id": 38104567, "comment_id": 63643016, "body": "yeah i mean that you can just run <code>.to_proc</code> always, if it is a proc, no-op, if it isn&#39;t, then you made it a proc, no?"}, {"owner": {"reputation": 1618, "user_id": 1791856, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f123ff5b9de91e4b6a2fc52f2e28daa5?s=128&d=identicon&r=PG", "display_name": "Alex Moore-Niemi", "link": "https://stackoverflow.com/users/1791856/alex-moore-niemi"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1467216375, "post_id": 38104567, "comment_id": 63643257, "body": "although it is less concise, i think i prefer my version for the reason @SergioTulentsev points out. though the <code>to_proc</code> bit is helpful"}, {"owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1467232188, "post_id": 38104567, "comment_id": 63652488, "body": "@SergioTulentsev I updated my answer and replaced <code>Array#+</code> by <code>Array#push</code>."}, {"owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "reply_to_user": {"reputation": 1618, "user_id": 1791856, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f123ff5b9de91e4b6a2fc52f2e28daa5?s=128&d=identicon&r=PG", "display_name": "Alex Moore-Niemi", "link": "https://stackoverflow.com/users/1791856/alex-moore-niemi"}, "edited": false, "score": 0, "creation_date": 1467232420, "post_id": 38104567, "comment_id": 63652593, "body": "@AlexMoore-Niemi You are rigth with <code>to_proc</code> call. The condition don&#39;t changes the behavoir. The condition makes the intention clearer, maybe. ;-)"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1467244759, "post_id": 38104567, "comment_id": 63657416, "body": "&quot;nice i had a feeling i could piggy-back on reduce somehow&quot; \u2013 That&#39;s a pretty boring feeling, since <code>reduce</code> is general ;-) IOW: it can do <i>everything</i> a loop can do, and so you can <i>always</i> piggy-back on it. There&#39;s a proof sketch in Haskell on the Wikipedia page for <code>Fold</code>, if you&#39;re interested. The gist is this: a collection can be either empty or not. The two arguments to <code>reduce</code> (the initial and the block) tell it what to do with an empty collection and what to do with a not-empty collection. Since you have all cases covered, there is nothing <code>reduce</code> can&#39;t do. I once re-wrote all of \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1467244783, "post_id": 38104567, "comment_id": 63657420, "body": "<code>Enumerable</code> using <code>inject</code> instead of <code>each</code>, just for fun."}], "tags": [], "owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "is_accepted": false, "score": 1, "last_activity_date": 1467232012, "last_edit_date": 1467232012, "creation_date": 1467215617, "answer_id": 38104567, "question_id": 38104139, "link": "https://stackoverflow.com/questions/38104139/what-is-the-ruby-equivalent-of-haskells-scanl/38104567#38104567", "title": "What is the Ruby equivalent of Haskell&#39;s scanl?", "body": "<p>You can use <code>reduce()</code> and implement it by yourself.</p>\n\n<pre><code>def scanl(op, init, range)\n  op = op.to_proc unless op.is_a?(Proc)\n  range.reduce([init]) { |a, e| a.push(op.call(a.last,e)) }\nend\n\np scanl(lambda { |a, b| a + b }, 0, 1..10)\n#=&gt; [0, 1, 3, 6, 10, 15, 21, 28, 36, 45, 55]\np scanl(:+, 0, 1..10)\n#=&gt; [0, 1, 3, 6, 10, 15, 21, 28, 36, 45, 55]\n</code></pre>\n\n<p>Alternatively you can use <code>map()</code> and put the initial element in front of the array.</p>\n\n<pre><code>def scanl(op, init, range)                             \n  op = op.to_proc unless op.is_a?(Proc)                \n  acc = init                                           \n  range.map { |e| acc = op.call(acc, e) }.unshift(init)\nend                                                 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4605, "user_id": 1067339, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/3479b6831ccaa6263ed5ca7dab3ba972?s=128&d=identicon&r=PG", "display_name": "Qqwy", "link": "https://stackoverflow.com/users/1067339/qqwy"}, "is_accepted": false, "score": 0, "last_activity_date": 1560969616, "creation_date": 1560969616, "answer_id": 56673965, "question_id": 38104139, "link": "https://stackoverflow.com/questions/38104139/what-is-the-ruby-equivalent-of-haskells-scanl/56673965#56673965", "title": "What is the Ruby equivalent of Haskell&#39;s scanl?", "body": "<p>In Ruby 2.0, where the <code>Enumerator</code> class exists, we can build a nicer implementation that works properly with infinite ranges:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def scanl(elem, &amp;op)\n  Enumerator.new do |yielder|\n    acc = elem\n    loop do\n      yielder &lt;&lt; acc\n      acc = op.call(acc)\n    end\n  end.lazy\nend\n</code></pre>\n\n<p>And use it like so:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>scanl(1, &amp;:next).take(10)                                                                                                                                                                                                                                     \n#=&gt; #&lt;Enumerator::Lazy: ...&gt;\nscanl(1, &amp;:next).take(10).force                                                                                                                                                                                                                                     \n#=&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nfib = scanl([0,1]) {|x, y| [y, x + y]}.map(&amp;:first)\nfib.take(10).force\n#=&gt; [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]\n</code></pre>\n"}], "owner": {"reputation": 1618, "user_id": 1791856, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f123ff5b9de91e4b6a2fc52f2e28daa5?s=128&d=identicon&r=PG", "display_name": "Alex Moore-Niemi", "link": "https://stackoverflow.com/users/1791856/alex-moore-niemi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 38104177, "answer_count": 3, "score": 3, "last_activity_date": 1560969616, "creation_date": 1467214470, "last_edit_date": 1495542151, "question_id": 38104139, "link": "https://stackoverflow.com/questions/38104139/what-is-the-ruby-equivalent-of-haskells-scanl", "title": "What is the Ruby equivalent of Haskell&#39;s scanl?", "body": "<p><a href=\"https://stackoverflow.com/questions/14423794/equivalent-of-haskell-scanl-in-python\">This question</a> presents a version of Haskell's <code>scanl</code> in Python, but is there a Ruby version of this function?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "comments": [{"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1467214230, "post_id": 38103707, "comment_id": 63641754, "body": "Can you post the full controller code please."}, {"owner": {"reputation": 438, "user_id": 4903634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a1f8f4d9bda0ced27257e548c1cbdcc?s=128&d=identicon&r=PG&f=1", "display_name": "Artem Ankudovich", "link": "https://stackoverflow.com/users/4903634/artem-ankudovich"}, "edited": false, "score": 0, "creation_date": 1467215085, "post_id": 38103707, "comment_id": 63642321, "body": "Are you definitely passing the selected value to controller?"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1467215181, "post_id": 38103707, "comment_id": 63642405, "body": "pretty large file - any specific part of the file? And Passing the value how? Is there something I need to add to the controller so it recognizes the value?"}, {"owner": {"reputation": 438, "user_id": 4903634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a1f8f4d9bda0ced27257e548c1cbdcc?s=128&d=identicon&r=PG&f=1", "display_name": "Artem Ankudovich", "link": "https://stackoverflow.com/users/4903634/artem-ankudovich"}, "edited": false, "score": 0, "creation_date": 1467215690, "post_id": 38103707, "comment_id": 63642805, "body": "yes are you using scaffolds? if so there is record_params at the bottom you need to add the value you are taking in from the form."}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1467215869, "post_id": 38103707, "comment_id": 63642923, "body": "Ahhh wow ... ok sorry about this but I am trying to access it in the model. My bad ... same idea though?"}, {"owner": {"reputation": 438, "user_id": 4903634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a1f8f4d9bda0ced27257e548c1cbdcc?s=128&d=identicon&r=PG&f=1", "display_name": "Artem Ankudovich", "link": "https://stackoverflow.com/users/4903634/artem-ankudovich"}, "edited": false, "score": 0, "creation_date": 1467216080, "post_id": 38103707, "comment_id": 63643069, "body": "I would pass it to a controller method and from there call the model function with the value as a parameter"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1467216535, "post_id": 38103707, "comment_id": 63643365, "body": "I was able to get it registering in my controller within the update method. How would I then call it in my model?"}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "edited": false, "score": 0, "creation_date": 1467218971, "post_id": 38103707, "comment_id": 63644891, "body": "Can you see the value of <code>yessir</code> getting passed in the terminal where rails server is running?"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1467219675, "post_id": 38103707, "comment_id": 63645319, "body": "yea that&#39;s where I&#39;m seeing it, used a puts method"}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1467223508, "post_id": 38103707, "comment_id": 63647658, "body": "If you&#39;re using a form_for then you need to access the :yessir attribute inside the nested form object.  If your form_for object is say something like @event then you would access the param by doing:   a = params[:event][:yessir]"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1467223670, "post_id": 38103707, "comment_id": 63647752, "body": "ok, for some reason the select_tag needs a name of event[teardown_time] ... so would a = params[:event][:teardown_time] work - Just tested it, params[:event][:teardown_time] worked, duh! Still getting used to ruby syntax"}, {"owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "edited": false, "score": 0, "creation_date": 1467223976, "post_id": 38103707, "comment_id": 63647947, "body": "So how could I then access that variable in my model"}, {"owner": {"reputation": 438, "user_id": 4903634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a1f8f4d9bda0ced27257e548c1cbdcc?s=128&d=identicon&r=PG&f=1", "display_name": "Artem Ankudovich", "link": "https://stackoverflow.com/users/4903634/artem-ankudovich"}, "edited": false, "score": 0, "creation_date": 1467271944, "post_id": 38103707, "comment_id": 63665859, "body": "you can pass it as a parameter to a function where you would like to use it function(yessir)"}], "owner": {"reputation": 53, "user_id": 5651198, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae29d521ffcc15777a13bb50fbca9b22?s=128&d=identicon&r=PG&f=1", "display_name": "Cummings.P", "link": "https://stackoverflow.com/users/5651198/cummings-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467221749, "creation_date": 1467213378, "last_edit_date": 1467221749, "question_id": 38103707, "link": "https://stackoverflow.com/questions/38103707/accessing-value-of-select-tag-in-controller", "title": "Accessing value of select_tag in Controller", "body": "<p>I am having trouble accessing a value of select_tag in my controller. I have the following select_tag in my view:</p>\n\n<pre><code>= select_tag \"yessir\", options_for_select([ [\"No Teardown Time\",\"0\"],[\"15 Minutes\", \"15\"], [\"30 Minutes\", \"30\"], [\"45 Minutes\", \"45\"], [\"60 Minutes\", \"60\"], [\"75 Minutes\", \"75\"], [\"90 Minutes\",\"90\"], [\"105 Minutes\", \"105\"],[\"120 Minutes\",\"120\"]], @event.teardown_time), {:prompt =&gt; 'Teardown Time'}\n</code></pre>\n\n<p>And I try to access it in my controller like such: </p>\n\n<pre><code>a = params[\"yessir\"]\n</code></pre>\n\n<p>I have also tried</p>\n\n<pre><code>a = params[:yessir]\n</code></pre>\n\n<p>But in either case I keep on getting undefined local variable or method `params' for #. Any suggestions? Cheers~</p>\n\n<p>On another note, how would I obtain the value if the select_tag had the following name:</p>\n\n<pre><code>= select_tag 'event[teardown_time]'\n</code></pre>\n\n<p>I tried params['event[teardown_time'], but it did not work - no error but value is not being obtained. Cheers~</p>\n"}, {"tags": ["python", "ruby", "constructor"], "comments": [{"owner": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 4, "creation_date": 1467213284, "post_id": 38103606, "comment_id": 63641035, "body": "You can&#39;t call the class while you&#39;re still in the middle of defining it. You can do that and assign to a class property <i>after</i> the class has been defined. In fact, I&#39;d suggest you make those <i>types</i> a <i>module</i> property instead of a class property, that would seem to make more sense to me. A class having instances of itself as properties is a bit weird."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1467213578, "post_id": 38103606, "comment_id": 63641258, "body": "You do realise that unlike python, ruby is not white-space sensitive, right? You must finish each method definition/class definition explicitly with <code>end</code>. Indentation is irrelevant. So, your &quot;ruby code&quot; isn&#39;t valid. Also, have a look through one of the many ruby <a href=\"https://github.com/styleguide/ruby/coding-style\" rel=\"nofollow noreferrer\">style guides</a> for pointers; the ruby community is pretty consistent in how code is written."}, {"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 1, "creation_date": 1467213583, "post_id": 38103606, "comment_id": 63641260, "body": "You can just do it afterwards: <code>PortableType.TYPES = [...]</code>, Python doesn&#39;t stop you adding new attributes. But it&#39;s not a very idiomatic approach."}, {"owner": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "reply_to_user": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 0, "creation_date": 1467214022, "post_id": 38103606, "comment_id": 63641595, "body": "thank you @deceze!"}, {"owner": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1467214033, "post_id": 38103606, "comment_id": 63641602, "body": "@Tom Lord I just forgot the end, I edited my post. I am aware that ruby is not white-space sensitive."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1467243140, "post_id": 38103606, "comment_id": 63656993, "body": "By the way, within a class definition body, <code>self</code> is the class, and since <code>self</code> is the implicit receiver, you can just say <code>Int8 = new(:int8, &#39;Integer8&#39;)</code>. Also, <code>initialize</code> is <code>private</code> by default, and everything else is <code>public</code> by default, so you can just get rid of the calls to <code>public</code> and <code>private</code>. Lastly, indentation in Ruby is 2 spaces, not 5. That has nothing to do with your question, of course, but it will make your Ruby code much more idiomatic."}], "owner": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467226548, "creation_date": 1467213105, "last_edit_date": 1467226548, "question_id": 38103606, "link": "https://stackoverflow.com/questions/38103606/call-constructor-within-class-definition", "title": "Call constructor within class definition", "body": "<p>I have this code in Ruby that I wanted to translate to Python.</p>\n\n<pre><code>class PortableType\n     private\n     def initialize(name, long_name)\n          @name = name\n          @long_name = long_name\n     end\n\n     public\n     Int8 = PortableType.new(:int8, \"Integer8\")\n     Int16 = PortableType.new(:int16, \"Integer16\")\n\n     TYPES = [Int8, Int16]\nend\n</code></pre>\n\n<p>I wrote this:</p>\n\n<pre><code>class PortableType:\n     def __init__(self, name, long_name):\n          self.name = name\n          self.long_name = long_name\n\n     global_TYPES = [PortableType(\"int8\", \"Integer8\"), PortableType(\"int16\", \"Integer16\")]\n</code></pre>\n\n<p>But it doesn't work, <code>PortableType</code> is an \"<strong>undefined variable</strong>\". It appears that I can't call the class constructor within the same class. Is there a way to do what I want in Python?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1467217379, "post_id": 38103549, "comment_id": 63643962, "body": "@CarySwoveland Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1467213463, "post_id": 38103596, "comment_id": 63641173, "body": "Um...maybe I was stuck on something wrong, I was trying to say why I can call a instance method without a valid instance?"}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1467213817, "post_id": 38103596, "comment_id": 63641431, "body": "ok, I see. Thanks. It&#39;s a silly question, I didn&#39;t know a nil instance can still call method, I thought it will be error or something."}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1467214113, "post_id": 38103596, "comment_id": 63641670, "body": "I think  <code>z.hungry?</code> should return <code>true</code> not nil."}, {"owner": {"reputation": 744, "user_id": 2322409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/09f7675181cd7a326128252ea31db31b?s=128&d=identicon&r=PG", "display_name": "user2322409", "link": "https://stackoverflow.com/users/2322409/user2322409"}, "reply_to_user": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1467214297, "post_id": 38103596, "comment_id": 63641796, "body": "@CodaChang fix typo"}], "tags": [], "owner": {"reputation": 744, "user_id": 2322409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/09f7675181cd7a326128252ea31db31b?s=128&d=identicon&r=PG", "display_name": "user2322409", "link": "https://stackoverflow.com/users/2322409/user2322409"}, "is_accepted": true, "score": 0, "last_activity_date": 1467214282, "last_edit_date": 1467214282, "creation_date": 1467213074, "answer_id": 38103596, "question_id": 38103549, "link": "https://stackoverflow.com/questions/38103549/rails-instance-validate/38103596#38103596", "title": "Rails instance validate", "body": "<p>because your <code>hungry?</code> method always returns <code>true</code></p>\n\n<p><code>be_truthy  # passes if obj is truthy (not nil or false)</code> even if your \nobject is nil it's returns true  </p>\n\n<p><a href=\"https://www.relishapp.com/rspec/rspec-expectations/docs/built-in-matchers/be-matchers\" rel=\"nofollow\">be_truthy</a></p>\n\n<p><code>z = Zombie.create</code> -  It will not be created because of validation</p>\n\n<pre><code>z.hungry? =&gt; true \n</code></pre>\n\n<p>so your test passed</p>\n"}, {"comments": [{"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1467214331, "post_id": 38103934, "comment_id": 63641822, "body": "Thanks for your explain, it&#39;s really helpful."}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1467218295, "post_id": 38103934, "comment_id": 63644508, "body": "It seems <code>be_invalid</code>, not <code>not_be_valid</code>"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1467226336, "last_edit_date": 1467226336, "creation_date": 1467213965, "answer_id": 38103934, "question_id": 38103549, "link": "https://stackoverflow.com/questions/38103549/rails-instance-validate/38103934#38103934", "title": "Rails instance validate", "body": "<p><code>hungry?</code> will always return <code>true</code>, therefore your expectation always passes. </p>\n\n<p>That your instance is invalid doesn't mean that the instance is not valid Ruby. It is still a fully functional instance. The <code>valid?</code> method returns <code>false</code>, because the values of this instance are not valid to <em>you</em>, since you defined that it is not valid to <em>you</em> without a name.</p>\n\n<p>From Ruby's point of view it is still a valid <code>Zombie</code> instance.</p>\n\n<p>Btw since you just started to learn RSpec. You use the old RSpec syntax, you might want to learn the new syntax instead which would look like this:</p>\n\n<pre><code>describe Zombie do\n  context 'without a name' do\n    subject(:zombie) { Zombie.new }\n\n    it 'is not valid' do\n      expect(zombie).to_not be_valid\n    end\n\n    it 'is hungry' do\n      expect(zombie).to be_hungry\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 38103596, "answer_count": 2, "score": 0, "last_activity_date": 1467226336, "creation_date": 1467212953, "last_edit_date": 1467217357, "question_id": 38103549, "link": "https://stackoverflow.com/questions/38103549/rails-instance-validate", "title": "Rails instance validate", "body": "<p>I was trying to practice <code>Rspec</code>, but seems I was confused about some rails part.</p>\n\n<p>Here is <strong>Zombie.rb</strong></p>\n\n<pre><code>class Zombie &lt; ActiveRecord::Base\n    validates :name, presence: true\n    has_many :tweets\n    def hungry?\n        true\n    end\nend\n</code></pre>\n\n<p>It seems when I create a Zombie instance, it will check the <code>name</code> attribute.\nSo, I wrote these <code>Rspec</code> code.</p>\n\n<pre><code>it 'should not be hungry after eating' do \n        @zombie = Zombie.create \n        @zombie.should_not be_valid\n        @zombie.hungry?.should be_truthy\n    end\n</code></pre>\n\n<p>Why it will pass? If the <code>@zombie</code> is not valid, why <code>@zombie.hungry?</code> will still return <code>true</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "linux", "capistrano"], "comments": [{"owner": {"reputation": 161, "user_id": 3464942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b7789f9d2b3ef8e7a16368807d14c1?s=128&d=identicon&r=PG&f=1", "display_name": "Fara Importanta", "link": "https://stackoverflow.com/users/3464942/fara-importanta"}, "edited": false, "score": 0, "creation_date": 1467271410, "post_id": 38103471, "comment_id": 63665525, "body": "You need to take into account the fact that each package manager has its own syntax / options for checking that a package is installed or not."}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 161, "user_id": 3464942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b7789f9d2b3ef8e7a16368807d14c1?s=128&d=identicon&r=PG&f=1", "display_name": "Fara Importanta", "link": "https://stackoverflow.com/users/3464942/fara-importanta"}, "edited": false, "score": 0, "creation_date": 1467273631, "post_id": 38103471, "comment_id": 63666845, "body": "Yes, but luckily the <code>install</code> command is idempotent on all managers."}], "owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467259030, "creation_date": 1467212758, "last_edit_date": 1492086984, "question_id": 38103471, "link": "https://stackoverflow.com/questions/38103471/verify-that-an-os-package-is-installed", "title": "verify that an OS package is installed", "body": "<p>I need to verify that an OS package is installed after deploying using capistrano (it's a rails project, in case it matters). I'd like to support the major linux distros and OS X. Fortunately, the name of the package is the same on all platforms.</p>\n\n<p>I've thought adding a capistrano task, something like (untested code):</p>\n\n<pre><code>%w(yum apt-get brew).each do |manager|\n  path = `which #{manager}`.chomp\n  if path &amp;&amp; path.size &gt; 0\n    `#{path} install -y #{PKG}`\n    return\n  end\nend\n</code></pre>\n\n<p>Inspired by <a href=\"https://unix.stackexchange.com/q/46081/52730\">this question</a>.</p>\n\n<p>Is there a better way?\nI've thought checking <code>uname</code>, but it doesn't always have the distro, just \"Linux\". I also thought using <code>lsb_release</code> or listing files in <code>/etc/*-release</code>, but not all distros support it (e.g. centos).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1467212221, "post_id": 38103004, "comment_id": 63640272, "body": "Try deleting <code>Gemfile.lock</code> and doing <code>bundle install</code> again."}, {"owner": {"reputation": 653, "user_id": 4230699, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/0VBXh.gif?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/4230699/jonathan"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1467213389, "post_id": 38103004, "comment_id": 63641120, "body": "Didn&#39;t work :( still comes up with the same errors as above"}], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 6125536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77be9fabae9cd5b0d2e2b51e8e493b15?s=128&d=identicon&r=PG", "display_name": "Priyank Gupta", "link": "https://stackoverflow.com/users/6125536/priyank-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1467747981, "creation_date": 1467747981, "answer_id": 38211522, "question_id": 38103004, "link": "https://stackoverflow.com/questions/38103004/could-not-find-compatible-versions-for-gem-spree-core/38211522#38211522", "title": "Could not find compatible versions for gem &quot;spree_core&quot;", "body": "<p>You same versions for all 3 extensions/gems.\nEither, (for Spree 3.1.x)</p>\n\n<pre><code>gem 'spree', '~&gt; 3.1.0'\ngem 'spree_gateway', '~&gt; 3.1.0'\ngem 'spree_auth_devise', '~&gt; 3.1.0'\n</code></pre>\n\n<p>Or, (for Spree 3.0.x)</p>\n\n<pre><code>gem 'spree', '~&gt; 3.0.0'\ngem 'spree_gateway', '~&gt; 3.0.0'\ngem 'spree_auth_devise', '~&gt; 3.0.0'\n</code></pre>\n"}], "owner": {"reputation": 653, "user_id": 4230699, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/0VBXh.gif?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/4230699/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1467747981, "creation_date": 1467211556, "question_id": 38103004, "link": "https://stackoverflow.com/questions/38103004/could-not-find-compatible-versions-for-gem-spree-core", "title": "Could not find compatible versions for gem &quot;spree_core&quot;", "body": "<p>I've just ran through the 'Getting Started' guide from Spree commerce and I've hit an error while following it.</p>\n\n<p>I've run the following commands:</p>\n\n<pre><code>gem install spree_cmd\nbundle install\n</code></pre>\n\n<p>Then I get hit with the following errors in the console</p>\n\n<pre><code>Bundler could not find compatible versions for gem \"spree_core\":\n  In Gemfile:\n    spree_auth_devise (~&gt; 3.0.0) was resolved to 3.0.5, which depends on\n      spree_core (~&gt; 3.0.0)\n\n    spree (~&gt; 3.1.0) was resolved to 3.1.0, which depends on\n      spree_backend (= 3.1.0) was resolved to 3.1.0, which depends on\n        spree_core (= 3.1.0)\n\n    spree (~&gt; 3.1.0) was resolved to 3.1.0, which depends on\n      spree_backend (= 3.1.0) was resolved to 3.1.0, which depends on\n        spree_core (= 3.1.0)\n\n    spree (~&gt; 3.1.0) was resolved to 3.1.0, which depends on\n      spree_backend (= 3.1.0) was resolved to 3.1.0, which depends on\n        spree_core (= 3.1.0)\n\n    spree (~&gt; 3.1.0) was resolved to 3.1.0, which depends on\n      spree_backend (= 3.1.0) was resolved to 3.1.0, which depends on\n        spree_core (= 3.1.0)\n\n    spree (~&gt; 3.1.0) was resolved to 3.1.0, which depends on\n      spree_backend (= 3.1.0) was resolved to 3.1.0, which depends on\n        spree_core (= 3.1.0)\n</code></pre>\n\n<p>Which looks like it all checks out - but it seems to be failing to bundle install. </p>\n\n<p><strong>My Gemfile</strong></p>\n\n<pre><code>gem 'spree', '~&gt; 3.1.0'\ngem 'spree_gateway', '~&gt; 3.0.0'\ngem 'spree_auth_devise', '~&gt; 3.0.0'\n</code></pre>\n\n<p>Any help would be brilliant</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "edited": false, "score": 0, "creation_date": 1467214624, "post_id": 38103057, "comment_id": 63642005, "body": "Thanks! helped alot"}], "tags": [], "owner": {"reputation": 5940, "user_id": 1558430, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/F7RJl.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/1558430/brian"}, "is_accepted": true, "score": 4, "last_activity_date": 1467211698, "creation_date": 1467211698, "answer_id": 38103057, "question_id": 38102890, "link": "https://stackoverflow.com/questions/38102890/class-inheritance-in-ruby/38103057#38103057", "title": "Class inheritance in Ruby", "body": "<p>The behaviour is introduced by assignment expressions, not inheritance. When you type:</p>\n\n<pre><code>@number = n, @id = i , @phone = ph, @adress =ad\n</code></pre>\n\n<p>What really means is</p>\n\n<ul>\n<li>Assign <code>ad</code> to <code>@address</code></li>\n<li>Assign <code>ph</code> to <code>@phone</code></li>\n<li>Assign <code>i</code> to <code>@id</code></li>\n<li>Assign [<code>n</code>, the result of assigning <code>i</code> to <code>id</code>, which is <code>i</code>, the result of assigning <code>ph</code> to <code>phone</code>, which is <code>ph</code>, the result of assigning <code>ad</code> to <code>address</code>, which is <code>ad</code>] to <code>number</code>, which is a list.</li>\n</ul>\n\n<p>So, the fix that problem, you will need to assign the properties individually, like so.</p>\n\n<pre><code>@number = n\n@id = i \n@phone = ph\n@adress = ad\n</code></pre>\n\n<p>Edit: you can also be smart and do a <a href=\"https://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Operators#1._Assignment\" rel=\"nofollow\">destructured assignment</a>, like so...</p>\n\n<pre><code>@number , @id , @phone , @adress = [n, i, ph, ad]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 3, "last_activity_date": 1467211811, "creation_date": 1467211811, "answer_id": 38103100, "question_id": 38102890, "link": "https://stackoverflow.com/questions/38102890/class-inheritance-in-ruby/38103100#38103100", "title": "Class inheritance in Ruby", "body": "<blockquote>\n  <p>Why is number being returned as an array?</p>\n</blockquote>\n\n<p>You assign multiple values to <code>@number</code> in your <code>Employee#initialize</code> method. The way Ruby represents multiple values is as an <code>Array</code>.</p>\n\n<p>IOW:</p>\n\n<pre><code>foo = 1, 2, 3\n# =&gt; [1, 2, 3]\n</code></pre>\n"}], "owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 38103057, "answer_count": 2, "score": -3, "last_activity_date": 1467211858, "creation_date": 1467211275, "last_edit_date": 1467211811, "question_id": 38102890, "link": "https://stackoverflow.com/questions/38102890/class-inheritance-in-ruby", "title": "Class inheritance in Ruby", "body": "<p>Why are numbers being returned as an array?</p>\n\n<pre><code>class Employee\n  def initialize(n,i,ph,ad)\n    @number = n, @id = i , @phone = ph, @adress =ad\n  end\nend\nclass Getemploy &lt; Employee\n  def get_data\n    return \"The employee number is : #{@number} with id : #{@id} with phone #{@phone} with adress: #{@adress}\"\n  end\nend\n\nputs Getemploy.new(\"1\",\"2\",\"3\",\"4\").get_data\n# =&gt; The employee number is : [\"1\", \"2\", \"3\", \"4\"] with id : 2 with phone 3 with adress: 4\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "authentication", "devise"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5851336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b8168bb38e2163a6adab19a0325083a?s=128&d=identicon&r=PG&f=1", "display_name": "redasus", "link": "https://stackoverflow.com/users/5851336/redasus"}, "edited": false, "score": 0, "creation_date": 1467216161, "post_id": 38103986, "comment_id": 63643117, "body": "Awesome explanation. Thanks mate :)"}, {"owner": {"reputation": 873, "user_id": 1581718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/evhC6.jpg?s=128&g=1", "display_name": "Pavel Bulanov", "link": "https://stackoverflow.com/users/1581718/pavel-bulanov"}, "reply_to_user": {"reputation": 15, "user_id": 5851336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b8168bb38e2163a6adab19a0325083a?s=128&d=identicon&r=PG&f=1", "display_name": "redasus", "link": "https://stackoverflow.com/users/5851336/redasus"}, "edited": false, "score": 0, "creation_date": 1467234574, "post_id": 38103986, "comment_id": 63653695, "body": "Added some notes on the initializers concept, just as I researched it anyways."}, {"owner": {"reputation": 873, "user_id": 1581718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/evhC6.jpg?s=128&g=1", "display_name": "Pavel Bulanov", "link": "https://stackoverflow.com/users/1581718/pavel-bulanov"}, "reply_to_user": {"reputation": 15, "user_id": 5851336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b8168bb38e2163a6adab19a0325083a?s=128&d=identicon&r=PG&f=1", "display_name": "redasus", "link": "https://stackoverflow.com/users/5851336/redasus"}, "edited": false, "score": 0, "creation_date": 1467282606, "post_id": 38103986, "comment_id": 63672870, "body": "Updated further. Rails functioning isn&#39;t straightforward, by no means."}], "tags": [], "owner": {"reputation": 873, "user_id": 1581718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/evhC6.jpg?s=128&g=1", "display_name": "Pavel Bulanov", "link": "https://stackoverflow.com/users/1581718/pavel-bulanov"}, "is_accepted": true, "score": 3, "last_activity_date": 1467282460, "last_edit_date": 1467282460, "creation_date": 1467214102, "answer_id": 38103986, "question_id": 38102857, "link": "https://stackoverflow.com/questions/38102857/devise-sign-in-resource-works-even-without-importing-module/38103986#38103986", "title": "Devise sign_in resource works even without importing module", "body": "<p><strong>Basic answer</strong> - the module Devise::Controllers::Helpers (which includes Devise::Controllers::SignInOut that you discovered) is automatically included in ApplicationController by one of the Devise initializer named \"devise.url_helpers\". Initializer is included by adding Devise gem, and its content is run during rails Application startup.</p>\n\n<p><strong>Going deeper</strong></p>\n\n<p>Devise is a Rails Engine - you can check <a href=\"http://guides.rubyonrails.org/engines.html\" rel=\"nofollow\">this</a> article for brief review.</p>\n\n<blockquote>\n  <p>Engines can be considered miniature applications that provide\n  functionality to their host applications. A Rails application is\n  actually just a \"supercharged\" engine, with the Rails::Application\n  class inheriting a lot of its behavior from Rails::Engine.</p>\n  \n  <p>...</p>\n  \n  <p>Engines are also closely related to <em>plugins</em>.</p>\n</blockquote>\n\n<p>Then, you will find the following call at rails.rb of Devise (this <code>rails.rb</code> is required by gem root devise.rb file - see below) <a href=\"https://github.com/plataformatec/devise/blob/4924dd68ae952a427d08c43e7afb2dc8045efbc0/lib/devise/rails.rb#L18\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>   initializer \"devise.url_helpers\" do\n      Devise.include_helpers(Devise::Controllers)\n   end\n</code></pre>\n\n<p>To state, <code>initializer</code> here is <em>not</em> a method definition, but actual calling a class method with string name parameter and block parameter. It's executed on class load (i.e. as a result of loading a class by <code>require</code>). Same time, passed block serves as parameter to this call, and in this particular case is saved to be executed later - see below explanation of initializers.</p>\n\n<p><em>Side note</em> on engines (in fact railtie) <strong>initializer concept</strong></p>\n\n<p>Initializer is a concept by one of the Rails basic class Railtie. Concept is described <a href=\"https://github.com/rails/rails/blob/52ce6ece8c8f74064bb64e0a0b1ddd83092718e1/railties/lib/rails/railtie.rb\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>Initializers - To add an initialization step from your Railtie to Rails boot process, you just need to create an initializer block:      </p>\n</blockquote>\n\n<pre><code>  #   class MyRailtie &lt; Rails::Railtie\n  #     initializer \"my_railtie.configure_rails_initialization\" do\n  #       # some initialization behavior\n  #     end\n  #   end\n</code></pre>\n\n<p>The implementation of initializers logic is part of <code>Initilizable</code> <a href=\"https://github.com/rails/rails/blob/52ce6ece8c8f74064bb64e0a0b1ddd83092718e1/railties/lib/rails/initializable.rb#L82\" rel=\"nofollow\">module</a> which is <a href=\"https://github.com/rails/rails/blob/52ce6ece8c8f74064bb64e0a0b1ddd83092718e1/railties/lib/rails/railtie.rb#L117\" rel=\"nofollow\">included</a> into Railtie class. Specific initializer class method basically adds passed block to class initializers array <a href=\"https://github.com/rails/rails/blob/52ce6ece8c8f74064bb64e0a0b1ddd83092718e1/railties/lib/rails/initializable.rb#L82\" rel=\"nofollow\">source</a>:</p>\n\n<pre><code>  def initializer(name, opts = {}, &amp;blk)\n    ...\n    initializers &lt;&lt; Initializer.new(name, nil, opts, &amp;blk)\n  end\n</code></pre>\n\n<p>It's not executed immediately. It's run by executing <code>run</code> method on initializers in specific order by <code>run_initializers</code> call, which is also part of <code>Initializable</code> <a href=\"https://github.com/rails/rails/blob/52ce6ece8c8f74064bb64e0a0b1ddd83092718e1/railties/lib/rails/initializable.rb#L52\" rel=\"nofollow\">module</a>. This method is available for rails Application with inherits from Engine (which includes <code>Initializable</code> module).</p>\n\n<pre><code>def run_initializers(group=:default, *args)\n  return if instance_variable_defined?(:@ran)\n  initializers.tsort_each do |initializer|\n    initializer.run(*args) if initializer.belongs_to?(group)\n  end\n  @ran = true\nend\n</code></pre>\n\n<p>This <code>run_initializers</code> method is triggered by <code>initialize!</code> call (see below a bit later) of the Application.</p>\n\n<p>Side note on <strong>collecting all initializers</strong> by Rails Application.</p>\n\n<p>Meanwhile, <code>initializers</code> here is an overloaded <a href=\"https://github.com/rails/rails/blob/52ce6ece8c8f74064bb64e0a0b1ddd83092718e1/railties/lib/rails/application.rb#L358\" rel=\"nofollow\">method</a> in Application class:</p>\n\n<pre><code>def initializers #:nodoc:\n  Bootstrap.initializers_for(self) +\n  railties_initializers(super) +\n  Finisher.initializers_for(self)\nend\n</code></pre>\n\n<p>This method will load all initializers of the application for further ordering and running.\nInside, <code>railties_initializers</code> will call <code>ordered_railties</code>, which will use <code>railties</code> getter of Engine class (which Application is inherited from). This getter is the <a href=\"https://github.com/rails/rails/blob/52ce6ece8c8f74064bb64e0a0b1ddd83092718e1/railties/lib/rails/engine.rb#L481\" rel=\"nofollow\">following</a></p>\n\n<pre><code>def railties\n  @railties ||= Railties.new\nend\n</code></pre>\n\n<p><code>Railties</code> (plural) service class is different from <code>Railtie</code>. It actually just collects all <a href=\"https://github.com/rails/rails/blob/52ce6ece8c8f74064bb64e0a0b1ddd83092718e1/railties/lib/rails/engine/railties.rb\" rel=\"nofollow\">railties</a> by looking at all subclasses of both Engine and Railtie classes.</p>\n\n<pre><code> def initialize\n    @_all ||= ::Rails::Railtie.subclasses.map(&amp;:instance) +\n      ::Rails::Engine.subclasses.map(&amp;:instance)\n  end\n</code></pre>\n\n<p>Finally, <code>subclasses</code> is a method from extension of Ruby base Class, which Rails <a href=\"https://github.com/rails/rails/blob/89e2f7e722e06f900bdb1c14db33073c90d7cdea/activesupport/lib/active_support/core_ext/class/subclasses.rb\" rel=\"nofollow\">extend</a> for its convenience</p>\n\n<pre><code>  def subclasses\n    subclasses, chain = [], descendants\n    chain.each do |k|\n      subclasses &lt;&lt; k unless chain.any? { |c| c &gt; k }\n    end\n    subclasses\n  end\nend\n</code></pre>\n\n<p>Back to <strong>running initialiers</strong> by Application. As mentioned above, <code>run_initializers</code> is called by <code>initialize!</code> <a href=\"https://github.com/rails/rails/blob/52ce6ece8c8f74064bb64e0a0b1ddd83092718e1/railties/lib/rails/application.rb#L351\" rel=\"nofollow\">call</a> of the Application class:</p>\n\n<pre><code>   def initialize!(group=:default) #:nodoc:\n      raise \"Application has been already initialized.\" if @initialized\n      run_initializers(group, self)\n      @initialized = true\n      self\n    end\n</code></pre>\n\n<p>Which for the Rails app is triggered by <code>Rails.application.initialize!</code> call in <code>environment.rb</code> file - see <a href=\"https://github.com/rails/rails/blob/52ce6ece8c8f74064bb64e0a0b1ddd83092718e1/railties/lib/rails/generators/rails/app/templates/config/environment.rb\" rel=\"nofollow\">generator source</a></p>\n\n<p>How those initializers got added to the running queue? This happens by adding Devise gem (e.g. by Bundle.require), which loads <a href=\"https://github.com/plataformatec/devise/blob/e01fdba557f0da3c9a528011edee5b4e0989722d/lib/devise.rb\" rel=\"nofollow\">lib/devise.rb</a> gem root file, and which has following <a href=\"https://github.com/plataformatec/devise/blob/e01fdba557f0da3c9a528011edee5b4e0989722d/lib/devise.rb#L491\" rel=\"nofollow\">require</a> at the very bottom:</p>\n\n<pre><code>require 'devise/rails'\n</code></pre>\n\n<p>As this loads Devise class, it will be discovered by Railties class by looking at subclasses for Engine.</p>\n\n<p><strong>Back</strong> to Devise devise.url_helpers initializer\nIf you look at <code>include_helpers</code> call, this is what it <a href=\"https://github.com/plataformatec/devise/blob/master/lib/devise.rb#L433\" rel=\"nofollow\">does</a>:</p>\n\n<pre><code> def self.include_helpers(scope)\n    ActiveSupport.on_load(:action_controller) do\n      include scope::Helpers if defined?(scope::Helpers)\n      include scope::UrlHelpers\n    end\n\n    ActiveSupport.on_load(:action_view) do\n      include scope::UrlHelpers\n    end\n  end\n</code></pre>\n\n<p>ActiveSupport on_load call is a Rails feature to lazy_load components. <a href=\"https://github.com/rails/rails/blob/39b8b8fdbf6c175a64f07198ff1c950e33c72cd0/activesupport/lib/active_support/lazy_load_hooks.rb#L26\" rel=\"nofollow\">source</a>:</p>\n\n<blockquote>\n  <p># lazy_load_hooks allows Rails to lazily load a lot of components\n  and thus   # making the app boot faster.</p>\n</blockquote>\n\n<p>In this case, those include commands for controller will be executed when controller is loaded, but not on server start. Check <a href=\"https://simonecarletti.com/blog/2011/04/understanding-ruby-and-rails-lazy-load-hooks/\" rel=\"nofollow\">this</a> or any other articles on the concept.</p>\n\n<p>And this is the place where that lazy block is run - <a href=\"https://github.com/rails/rails/blob/58a221278897a66bf8b9c909389da40ac2c5e534/actionpack/lib/action_controller/base.rb#L263\" rel=\"nofollow\">source</a>:</p>\n\n<pre><code>module ActionController\n  # Action Controllers are the core of a web request in \\Rails. They are made up of one or more actions that are executed\n  # on request and then either it renders a template or redirects to another action. An action is defined as a public method\n  # on the controller, which will automatically be made accessible to the web-server through \\Rails Routes.\n  #\n  # By default, only the ApplicationController in a \\Rails application inherits from &lt;tt&gt;ActionController::Base&lt;/tt&gt;. All other\n  # controllers in turn inherit from ApplicationController. This gives you one class to configure things such as\n  # request forgery protection and filtering of sensitive request parameters.\n ...\n  class Base &lt; Metal\n    ...\n    ActiveSupport.run_load_hooks(:action_controller, self)\n  end\nend\n</code></pre>\n\n<p>BTW, your ApplicationController generated by Rails is inherited from ActionController::Base</p>\n"}], "owner": {"reputation": 15, "user_id": 5851336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b8168bb38e2163a6adab19a0325083a?s=128&d=identicon&r=PG&f=1", "display_name": "redasus", "link": "https://stackoverflow.com/users/5851336/redasus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 38103986, "answer_count": 1, "score": 1, "last_activity_date": 1467282460, "creation_date": 1467211184, "question_id": 38102857, "link": "https://stackoverflow.com/questions/38102857/devise-sign-in-resource-works-even-without-importing-module", "title": "Devise sign_in resource works even without importing module", "body": "<p>So, I was customizing devise in a custom sign up page which required me to <strong>sign_in</strong> a user after creating the account along with some other operations. After creating the resource I did</p>\n\n<pre><code>sign_in resource if resource.active_for_authentication?\n</code></pre>\n\n<p>and it signs in the user. My controller inherits the \n    ApplicationController\nand I haven't included any modules like this </p>\n\n<pre><code>include Devise::Controllers::SignInOut\n</code></pre>\n\n<p>How did rails know about the</p>\n\n<pre><code>sign_in\n</code></pre>\n\n<p>method</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "edited": false, "score": 1, "creation_date": 1467213958, "post_id": 38102820, "comment_id": 63641546, "body": "Not a duplicate. This question ask how to pick the 3 highest amount group names and the other question ask how to select one name based on number of occurrences and highest amount"}, {"owner": {"reputation": 886, "user_id": 1383086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ffd6f9b2eb2f6a432ad8476ba68370?s=128&d=identicon&r=PG", "display_name": "dquimper", "link": "https://stackoverflow.com/users/1383086/dquimper"}, "edited": false, "score": 0, "creation_date": 1467215307, "post_id": 38102820, "comment_id": 63642521, "body": "Try to brake your problems into smaller steps. It not necessary to do it all on one line."}, {"owner": {"reputation": 886, "user_id": 1383086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ffd6f9b2eb2f6a432ad8476ba68370?s=128&d=identicon&r=PG", "display_name": "dquimper", "link": "https://stackoverflow.com/users/1383086/dquimper"}, "edited": false, "score": 1, "creation_date": 1467215595, "post_id": 38102820, "comment_id": 63642747, "body": "I can make a full answer here because the question was closed. So I made a GIst: <a href=\"https://gist.github.com/dquimper/4a4770a89a0d8997c74c810d0262bf32\" rel=\"nofollow noreferrer\">gist.github.com/dquimper/4a4770a89a0d8997c74c810d0262bf32</a>"}, {"owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "reply_to_user": {"reputation": 886, "user_id": 1383086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ffd6f9b2eb2f6a432ad8476ba68370?s=128&d=identicon&r=PG", "display_name": "dquimper", "link": "https://stackoverflow.com/users/1383086/dquimper"}, "edited": false, "score": 0, "creation_date": 1467217998, "post_id": 38102820, "comment_id": 63644336, "body": "Thanks worked like a charm! @dquimper"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1467218366, "post_id": 38102820, "comment_id": 63644549, "body": "I&#39;ve voted to reopen because I do not consider this a duplicate of the earlier question, for the two reasons given by @SupremeA."}], "answers": [{"tags": [], "owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "is_accepted": false, "score": 0, "last_activity_date": 1467226526, "last_edit_date": 1467226526, "creation_date": 1467226173, "answer_id": 38107836, "question_id": 38102820, "link": "https://stackoverflow.com/questions/38102820/ruby-select-top-3-groups-by-amount/38107836#38107836", "title": "Ruby select top 3 groups by amount", "body": "<p>Assuming the amounts are always the same within each group(big assumption):</p>\n\n<pre><code>@transactions.group_by { |t| t[\"name\"] }.\nsort_by { |_, v| v.first.first.last.abs }.\ntake(3).\nmap(&amp;:first)\n =&gt; [\"HOUSE\", \"BOAT\", \"CAR\"] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1883, "user_id": 799858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9930600ff08875bf9a79bcbd9b8faf2d?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/799858/luke"}, "is_accepted": true, "score": 2, "last_activity_date": 1467227641, "last_edit_date": 1467227641, "creation_date": 1467227054, "answer_id": 38108108, "question_id": 38102820, "link": "https://stackoverflow.com/questions/38102820/ruby-select-top-3-groups-by-amount/38108108#38108108", "title": "Ruby select top 3 groups by amount", "body": "<p>You can build a hash of the types (names), and sum the values as you go along with:</p>\n\n<pre><code>@transactions.each_with_object(Hash.new(0)) do |obj, hash|\n  hash[obj[\"name\"]] += obj[\"amount\"].abs\nend\n</code></pre>\n\n<p>Then you can add some moar magic to the end of that, or break it up into more lines (recommended for readability):</p>\n\n<pre><code>@transactions.each_with_object(Hash.new(0)) do |obj, hash|\n  hash[obj[\"name\"]] += obj[\"amount\"].abs\nend.sort_by(&amp;:last).map(&amp;:first).last(3).reverse\n</code></pre>\n\n<p>Basically, that's sorting by values (which turns your new hash to an array of tuples), then mapping the first value of each tuple (the name), then taking the top 3.</p>\n\n<h3>Edit</h3>\n\n<p>I didn't notice the negatives, so I summed while taking the absolute value of the amounts, then the sort_by sorts from smallest to largest, so take the <em>last</em> three and reverse to give you largest to smallest order.</p>\n\n<p>It's a little complicated in a small block like that, I'd suggest breaking it up.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1467267074, "creation_date": 1467267074, "answer_id": 38115190, "question_id": 38102820, "link": "https://stackoverflow.com/questions/38102820/ruby-select-top-3-groups-by-amount/38115190#38115190", "title": "Ruby select top 3 groups by amount", "body": "<pre><code>def doit(trans, top_nbr)\n  trans.each_with_object(Hash.new(0)) { |g,h| h[g[\"name\"]] += g[\"amount\"] }.\n    min_by(top_nbr, &amp;:last).map(&amp;:first)\nend\n\ndoit(@transactions, 3)\n  #=&gt; [\"PLANE\", \"CAR\", \"BOAT\"]\n\ndoit(@transactions, 99)\n  #=&gt; [\"PLANE\", \"CAR\", \"BOAT\", \"HOUSE\"]\n</code></pre>\n\n<p>Since only a few keys are to be returned, if the array of hashes is large, it's faster to use <a href=\"http://ruby-doc.org/core-2.2.0/Enumerable.html#method-i-min_by\" rel=\"nofollow\">Enumerable#min_by</a> than to sort the entire array. <code>min_by</code> was allowed to have an optional parameter in Ruby v2.2. (same for <code>Enumerable</code>'s <code>max_by</code>, <code>min</code> and <code>max</code>).</p>\n"}], "owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 38108108, "answer_count": 3, "score": 1, "last_activity_date": 1467267074, "creation_date": 1467211087, "last_edit_date": 1467214682, "question_id": 38102820, "link": "https://stackoverflow.com/questions/38102820/ruby-select-top-3-groups-by-amount", "title": "Ruby select top 3 groups by amount", "body": "<p>I have an array and I need to group the array by name and then sum up the total for each group and then select the top 3 with highest amount per groups.</p>\n\n<p>Here is my sample array</p>\n\n<pre><code>@transactions =\n [{\"amount\"=&gt;-3000, \"name\"=&gt;\"CAR\"},\n {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n {\"amount\"=&gt;-125, \"name\"=&gt;\"HOUSE\" },\n {\"amount\"=&gt;-125, \"name\"=&gt;\"HOUSE\" },\n {\"amount\"=&gt;-125, \"name\"=&gt;\"HOUSE\" },\n {\"amount\"=&gt;-125, \"name\"=&gt;\"HOUSE\" },\n {\"amount\"=&gt;-6000, \"name\"=&gt;\"PLANE\" }]\n</code></pre>\n\n<p>The response should be:</p>\n\n<pre><code>[PLANE, CAR, BOAT]\n</code></pre>\n\n<p>I currently have this but it does not work:</p>\n\n<pre><code>transactions.group_by { |trans| trans.fetch('name') }.map do |amount, transactions|\n      [amount, transactions.map { |t| t[:amount] }.sum.abs.round(2)].select(3)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form"], "comments": [{"owner": {"reputation": 867, "user_id": 4563235, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/M7Zcp.jpg?s=128&g=1", "display_name": "hypern", "link": "https://stackoverflow.com/users/4563235/hypern"}, "edited": false, "score": 1, "creation_date": 1467211136, "post_id": 38102730, "comment_id": 63639413, "body": "Is mailing_date nil in this instance?"}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 0, "last_activity_date": 1467211928, "last_edit_date": 1495535334, "creation_date": 1467211597, "answer_id": 38103022, "question_id": 38102730, "link": "https://stackoverflow.com/questions/38102730/conflicting-view-logic/38103022#38103022", "title": "Conflicting View Logic", "body": "<p>It seems your issue is that <code>unit.mailing_date</code> is <code>nil</code>, for newly-built records.</p>\n\n<p>One solution would be to <a href=\"https://stackoverflow.com/questions/1550688/how-do-i-create-a-default-value-for-attributes-in-rails-activerecords-model\">define a default value for <code>mailing_date</code></a>, either at the database level or in your application. For example, you could do something like:</p>\n\n<pre><code>class Unit &lt; ActiveRecord::Base\n  # ....\n  after_initialize :set_default_mailing_date\n\n  private\n  def set_default_mailing_date\n    self.mailing_date ||= Date.today\n  end\nend\n</code></pre>\n\n<p>Or alternatively, you could leave the <code>mailing_date</code> as <code>nil</code> and handle this gracefully in the view:</p>\n\n<pre><code>&lt;td&gt;&lt;%= unit.mailing_date.try!(:strftime, '%m/%d/%y') %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>If you are using ruby version <code>2.3+</code>, then I would advise using the <a href=\"https://www.ruby-lang.org/en/news/2015/12/25/ruby-2-3-0-released/\" rel=\"nofollow noreferrer\">built-in safe navigation operator</a>, rather than <code>ActiveSupport</code>'s <code>try!</code> method:</p>\n\n<pre><code>&lt;td&gt;&lt;%= unit.mailing_date&amp;.strftime('%m/%d/%y') %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>Finally, if you went with the above choice to leave the <code>mailing_date</code> as <code>nil</code>, then perhaps you'd like to display some default value in its place - for example:</p>\n\n<pre><code>&lt;td&gt;&lt;%= unit.mailing_date&amp;.strftime('%m/%d/%y') || 'Not set' %&gt;&lt;/td&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "is_accepted": false, "score": 0, "last_activity_date": 1467212167, "creation_date": 1467212167, "answer_id": 38103237, "question_id": 38102730, "link": "https://stackoverflow.com/questions/38102730/conflicting-view-logic/38103237#38103237", "title": "Conflicting View Logic", "body": "<p>As an alternative, I assume you don't want the new unit bound to the form being rendered which is what is causing the error.</p>\n\n<p>You could do</p>\n\n<pre><code>@units = @student.units.reject(&amp;:new_record?)\n</code></pre>\n\n<p>To remove the newly built unit from the collection</p>\n"}], "owner": {"reputation": 25, "user_id": 4971103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf76690a111e3ff1123de7336f63e715?s=128&d=identicon&r=PG", "display_name": "Will Sheehan", "link": "https://stackoverflow.com/users/4971103/will-sheehan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 38103022, "answer_count": 2, "score": 0, "last_activity_date": 1467212167, "creation_date": 1467210812, "question_id": 38102730, "link": "https://stackoverflow.com/questions/38102730/conflicting-view-logic", "title": "Conflicting View Logic", "body": "<p>I have a show page where I need to both show the student's units and create a unit for them. However an error is being incurred when trying to do both.</p>\n\n<p>In my controller</p>\n\n<pre><code>def show\n  @student = Student.find(params[:id])\n  @unit = @student.units.build\n  @units = @student.units\nend\n</code></pre>\n\n<p>In my view</p>\n\n<pre><code>&lt;%= simple_form_for @unit, url: student_units_path(@student) %&gt;\n  # form...\n&lt;% end %&gt;\n\n&lt;% @units.each do |unit| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= unit.course %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= unit.mailing_date.strftime('%m/%d/%y') %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The unit.course call works and any call that is only the first child of unit, however when I call a second method on unit I get this error:</p>\n\n<pre><code>undefined method `strftime' for nil:NilClass\n</code></pre>\n\n<p>despite knowing that the unit exists, hence the first call working </p>\n"}, {"tags": ["ruby", "rubygems", "require"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1467210725, "post_id": 38102647, "comment_id": 63639132, "body": "are <code>stack.rb</code> and <code>stacklike.rb</code> in the same directory?"}, {"owner": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1467210908, "post_id": 38102647, "comment_id": 63639267, "body": "@sagarpandya82 yes, both files are in the same directory"}, {"owner": {"reputation": 4557, "user_id": 1847280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4124a0c3fbe08db2e0021e3e09b76e7f?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Anfilofyev", "link": "https://stackoverflow.com/users/1847280/yevgeniy-anfilofyev"}, "edited": false, "score": 0, "creation_date": 1467211283, "post_id": 38102647, "comment_id": 63639548, "body": "so, remove <code>ruby</code> and <code>gem</code> from /usr/bin"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1467212393, "post_id": 38102647, "comment_id": 63640421, "body": "Are you by any chance doing this inside irb?"}, {"owner": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "edited": false, "score": 0, "creation_date": 1467214224, "post_id": 38102647, "comment_id": 63641747, "body": "Use <code>require_relative &#39;stacklike&#39;</code>"}, {"owner": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "reply_to_user": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "edited": false, "score": 0, "creation_date": 1467221085, "post_id": 38102647, "comment_id": 63646192, "body": "@13aal I tried, but no success as mentioned above."}, {"owner": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "reply_to_user": {"reputation": 4557, "user_id": 1847280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4124a0c3fbe08db2e0021e3e09b76e7f?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Anfilofyev", "link": "https://stackoverflow.com/users/1847280/yevgeniy-anfilofyev"}, "edited": false, "score": 0, "creation_date": 1467221201, "post_id": 38102647, "comment_id": 63646254, "body": "@YevgeniyAnfilofyev I removed both yet, I still get the same load error."}, {"owner": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1467221214, "post_id": 38102647, "comment_id": 63646267, "body": "@Kris no, not in irb"}, {"owner": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "edited": false, "score": 0, "creation_date": 1467222034, "post_id": 38102647, "comment_id": 63646746, "body": "@user1234 You have rvm installed?"}, {"owner": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "edited": false, "score": 0, "creation_date": 1467222136, "post_id": 38102647, "comment_id": 63646801, "body": "@user1234 see edit on my answer, reinstall Ruby and it will work."}, {"owner": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "reply_to_user": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "edited": false, "score": 0, "creation_date": 1467222437, "post_id": 38102647, "comment_id": 63646990, "body": "@13aal yes, I also ran rvm requirements to update, but still, same load error. rvm rubies outputted: current &amp; default =* ruby-2.2.0 [ x86_64 ]"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "edited": false, "score": 1, "creation_date": 1467222505, "post_id": 38105067, "comment_id": 63647044, "body": "will try this out, apparently using rvm 1.26.10"}, {"owner": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "edited": false, "score": 0, "creation_date": 1467222825, "post_id": 38105067, "comment_id": 63647237, "body": "Ok, so after <code>rvm install ruby 2.3.0</code>, I got a new loaderror, looks like it changed from line 54 to line 55. Will show new error in edit 3 of OP."}, {"owner": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "reply_to_user": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "edited": false, "score": 0, "creation_date": 1467222896, "post_id": 38105067, "comment_id": 63647278, "body": "@user1234 Well the good news is we&#39;re getting farther down the lines.. lol"}, {"owner": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "edited": false, "score": 1, "creation_date": 1467223240, "post_id": 38105067, "comment_id": 63647491, "body": "<i>spongebob voice</i> 1 eternity later"}, {"owner": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "reply_to_user": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "edited": false, "score": 0, "creation_date": 1467223345, "post_id": 38105067, "comment_id": 63647560, "body": "@user1234 Yeah we can be friends, go ahead and try to uninstall ruby completely. After it&#39;s uninstalled reinstall the latest version, and try again, you could also attempt <code>require &#39;rubygems&#39;</code>; <code>require_relative &#39;&#47;full&#47;path&#47;to&#47;the&#47;file&#39;</code> Go ahead and do the later first"}, {"owner": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "edited": false, "score": 0, "creation_date": 1467224342, "post_id": 38105067, "comment_id": 63648209, "body": "no success on the latter... how do you suggest I completely uninstall? And does the <code>which -a ruby</code> path matter?"}, {"owner": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "reply_to_user": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "edited": false, "score": 0, "creation_date": 1467225230, "post_id": 38105067, "comment_id": 63648724, "body": "<code>which -a ruby</code> does matter, it should be <code>usr&#47;local&#47;bin&#47;ruby</code> or <code>usr&#47;bin&#47;ruby</code> You could try to compile Ruby yourself and see what happens"}], "tags": [], "owner": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "is_accepted": false, "score": 0, "last_activity_date": 1467222115, "last_edit_date": 1495541684, "creation_date": 1467216955, "answer_id": 38105067, "question_id": 38102647, "link": "https://stackoverflow.com/questions/38102647/kernel-require-rb54in-require-loaderror-from-book-well-grounded-rubyist/38105067#38105067", "title": "kernel_require.rb:54:in &#39;require&#39; (LoadError) from book Well Grounded Rubyist", "body": "<p>Here's the problem, you're using <code>require</code> instead of <code>require_relative</code> to understand the difference see <a href=\"https://stackoverflow.com/questions/3672586/what-is-the-difference-between-require-relative-and-require-in-ruby\">this</a>. The easiest way to remember this is how I was taught <code>require</code> is for gems and libraries, <code>require_relative</code> is for files.</p>\n\n<p>I also have some critique on your work if you don't mind:</p>\n\n<pre><code>require_relative \"stacklike\"\n\nclass Stack\n  include Stacklike #&lt;= Initiate the module\nend\n\nSTACK_INFO = Stack.new #&lt;= Turn the non-descriptive 's' into a more descriptive constant STACK_INFO\n\ndef add_info #&lt;= Create a method to add more information to the stack\n  STACK_INFO.add_to_stack(\"item one\")\n  STACK_INFO.add_to_stack(\"item two\")\n  STACK_INFO.add_to_stack(\"item three\")\nend  \n\ndef objects_in_stack? #&lt;= Create a method for the information that's inside of the stack\n  puts \"Objects currently on the stack: \"\n  puts STACK_INFO.stack\nend\n\ndef taken? #&lt;= Create a method for what's taken from the stack\n  taken = STACK_INFO.take_from_stack\n  puts \"Removed this object: \\e[31m#{taken}\\e[0m\" #&lt;= Makes colored console output \nend\n\nadd_info\nputs objects_in_stack?\nputs taken?\nputs objects_in_stack?\n\nmodule Stacklike\n  #&lt;= Spaces are important in Ruby, mostly because it makes Ruby readable.\n  def stack\n    @stack ||= []\n  end\n\n  def add_to_stack(obj)\n    stack.push(obj)\n  end\n\n  def take_from_stack\n    stack.pop\n  end\n\nend\n</code></pre>\n\n<p>This is very basic and you could go as far as having the information from the stack be given as an argument variable, you could also prompt the user for the information, etc. The concept of Ruby is OOP, the concept of OOP is making a system where everything works together successfully. That's my understanding of it anyways. I hope this answers your question and then some.</p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>You could also try installing the latest version of ruby, if you have rvm installed do <code>rvm install ruby 2.3.0</code>. This will install the latest version and allow you to run Ruby.</p>\n"}], "owner": {"reputation": 11, "user_id": 5150298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df3b5bdb984aa2e4df49ad5f5bd2caa?s=128&d=identicon&r=PG&f=1", "display_name": "user1234", "link": "https://stackoverflow.com/users/5150298/user1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1504, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467236158, "creation_date": 1467210586, "last_edit_date": 1467236158, "question_id": 38102647, "link": "https://stackoverflow.com/questions/38102647/kernel-require-rb54in-require-loaderror-from-book-well-grounded-rubyist", "title": "kernel_require.rb:54:in &#39;require&#39; (LoadError) from book Well Grounded Rubyist", "body": "<p>I am currently reading about modules in the \"Well Grounded Rubyist\" book by David Black. As I follow along to an exercise, I stumble upon an error when trying to run the following code:</p>\n\n<pre><code># stacklike.rb \nmodule Stacklike\n  def stack\n    @stack ||= []\n  end\n  def add_to_stack(obj)\n    stack.push(obj)\n  end\n  def take_from_stack\n    stack.pop\n  end\nend\n\n# stack.rb\nrequire \"stacklike\"\nclass Stack\n  include Stacklike\nend\n\ns = Stack.new\ns.add_to_stack(\"item one\")\ns.add_to_stack(\"item two\")\ns.add_to_stack(\"item three\")\n\nputs \"Objects currently on the stack: \"\nputs s.stack\n\ntaken = s.take_from_stack\nputs \"Removed this object: \"\nputs taken\n\nputs \"Now on stack: \"\nputs s.stack\n</code></pre>\n\n<p>And when I run the program, <code>$ ruby stack.rb</code>, I get the following error:</p>\n\n<p><code>/Users/myName/.rvm/rubies/ruby-2.2.0/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in 'require': cannot load such file -- stacklike (LoadError)\n    from /Users/myName/.rvm/rubies/ruby-2.2.0/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in 'require'\n    from stack.rb:2:in '&lt;main&gt;'</code></p>\n\n<p>So after spending some time on stackoverflow and having a similar problem to this user - <a href=\"https://stackoverflow.com/questions/36610991/the-require-method-in-modules-mix-ins\">The #require method in modules mix-ins</a> - I tried changing: <code>require \"stacklike\"</code> to <code>require \"./stacklike\"</code>, but that didn't work, so I tried these:</p>\n\n<pre><code>require_relative \"stacklike\"\nrequire \"***I put the absolute path to the file here***\"\n</code></pre>\n\n<p>but no success. Then, I looked here:\n<a href=\"https://stackoverflow.com/questions/2896485/no-such-file-to-load-rubygems-loaderror\">no such file to load -- rubygems (LoadError)</a>, And it seems that I have two ruby versions...\nI ran: <code>$ which -a ruby</code>, and got the following output:</p>\n\n<pre><code>/Users/myName/.rvm/rubies/ruby-2.2.0/bin/ruby\n/usr/bin/ruby\n</code></pre>\n\n<p>I think rubygems &amp; the two ruby versions are affecting the path lookup/load locations when using \"require\". Now I am wondering whether I must delete one version or if I need both. I am running OS X Yosemite (10.10.2), and when I run <code>ruby -v</code>, I get: <code>ruby 2.2.0p0 (2014-12-25 revision 49005) [x86_64-darwin14]</code></p>\n\n<p>Do I need both versions? If I need to delete one ruby version, which one should I delete and how? I tried being as thorough as possible, let me know what other information to supply. </p>\n\n<p>Edit 1: Yes, both files (stack.rb, stacklike.rb) are in the same directory</p>\n\n<p>Edit 2: I tried using require_relative \"stacklike\", but it doesn't work either. I also tried removing gem &amp; ruby from usr/bin, but no success there either - I still get the same load error.</p>\n\n<p>Edit 3: After running <code>rvm install ruby 2.3.0</code>, I received the following output load error when running <code>ruby stack.rb</code>:</p>\n\n<pre><code>`/Users/myName/.rvm/rubies/ruby-2.3.0/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- stacklike (LoadError)\nfrom /Users/myName/.rvm/rubies/ruby-2.3.0/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\nfrom stack.rb:2:in `&lt;main&gt;'`\n</code></pre>\n\n<p>I changed stack.rb line 2 to: <code>require_relative 'stacklike'</code></p>\n\n<p>Edit 4:<br>\nI ran <code>rvm implode</code> then <code>brew install ruby</code>. Now I get the same error but from a different path /usr/local/Cellar/ruby/2.3.1/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb\u200c\u200b:55:in require': cannot load such file -- stacklike (LoadError) from /usr/local/Cellar/ruby/2.3.1/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:\u200c\u200b55:in require' from stack.rb:2:in ' </p>\n\n<p>(now I'm missing <code>rvm</code> but at least <code>which -a ruby</code> outputs <code>usr/local/bin/ruby</code>)</p>\n\n<p>Edit 5 (FINAL EDIT): I just reinstalled ruby, created a new directory &amp; files, and now it somehow works... cheers &amp; thanks to all for your help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "workflow", "rails-migrations"], "comments": [{"owner": {"reputation": 2503, "user_id": 942986, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tR28w.jpg?s=128&g=1", "display_name": "fabriciofreitag", "link": "https://stackoverflow.com/users/942986/fabriciofreitag"}, "edited": false, "score": 0, "creation_date": 1467209243, "post_id": 38101585, "comment_id": 63637961, "body": "please post some code and the actual exception, also, what&#39;s the reason for not putting the migrations in the right sequence?"}, {"owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "reply_to_user": {"reputation": 2503, "user_id": 942986, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tR28w.jpg?s=128&g=1", "display_name": "fabriciofreitag", "link": "https://stackoverflow.com/users/942986/fabriciofreitag"}, "edited": false, "score": 0, "creation_date": 1467210747, "post_id": 38101585, "comment_id": 63639149, "body": "@onionfeelings , because the earlier migrations i.e. Ref1 and Ref2 are already in production and being run since many months now. This is a migration which is going now due to added requirements. The issue would not come in production as only fresh migrations will be run. But, if someone forks the code and runs in dev env, the migrations would break(which i want to avoid)"}, {"owner": {"reputation": 2503, "user_id": 942986, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tR28w.jpg?s=128&g=1", "display_name": "fabriciofreitag", "link": "https://stackoverflow.com/users/942986/fabriciofreitag"}, "edited": false, "score": 0, "creation_date": 1467211215, "post_id": 38101585, "comment_id": 63639484, "body": "can you post your code? theoretically if you do: add_column :table_x, :status_id, :integer you shouldn&#39;t have any problems, and still rails will handle the associations correctly since you&#39;re following conventions"}, {"owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "reply_to_user": {"reputation": 2503, "user_id": 942986, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tR28w.jpg?s=128&g=1", "display_name": "fabriciofreitag", "link": "https://stackoverflow.com/users/942986/fabriciofreitag"}, "edited": false, "score": 0, "creation_date": 1467214444, "post_id": 38101585, "comment_id": 63641902, "body": "@onionfeelings, i have posted the code being used in this for your reference."}, {"owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "reply_to_user": {"reputation": 2503, "user_id": 942986, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tR28w.jpg?s=128&g=1", "display_name": "fabriciofreitag", "link": "https://stackoverflow.com/users/942986/fabriciofreitag"}, "edited": false, "score": 0, "creation_date": 1467360163, "post_id": 38101585, "comment_id": 63710371, "body": "@onionfeelings i have posted the solution. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "edited": false, "score": 0, "creation_date": 1467290928, "post_id": 38119546, "comment_id": 63678545, "body": "Thanks for the solutions, and indeed they are hacks, but even if i do any of the above solutions or as said, deploy in chunks, i might get away from production or other existing dev deployment but the issue which will still be encountered is: &gt; if someone forks my repo to build the project, the migrations on his system will still break, for the same reason."}, {"owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "edited": false, "score": 0, "creation_date": 1467360187, "post_id": 38119546, "comment_id": 63710386, "body": "i have posted the solution. Thanks for the valuable inputs @StanBrajewski"}, {"owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "reply_to_user": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "edited": false, "score": 0, "creation_date": 1467362821, "post_id": 38119546, "comment_id": 63711836, "body": "@kattybilly when user clones the new repo and start the project he should not start with migrations but create a new DB from db/schema.rb - it&#39;s said in the Rails docs <a href=\"http://edgeguides.rubyonrails.org/active_record_migrations.html#schema-dumping-and-you\" rel=\"nofollow noreferrer\">edgeguides.rubyonrails.org/&hellip;</a> &quot;There is no need (and it is error prone) to deploy a new instance of an app by replaying the entire migration history. It is much simpler and faster to just load into the database a description of the current schema.&quot;"}], "tags": [], "owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "is_accepted": false, "score": 1, "last_activity_date": 1467280140, "creation_date": 1467280140, "answer_id": 38119546, "question_id": 38101585, "link": "https://stackoverflow.com/questions/38101585/ruby-workflow-issue-during-migration/38119546#38119546", "title": "Ruby Workflow Issue During Migration", "body": "<p>This is a pain, as your models need to be consistent for migrations. I don't know any auto solutions for this. </p>\n\n<p>Theoreticaly the best way would be to have model code versions binded with migrations. But I don't know any system that allows this. </p>\n\n<p>Every time I do big models refactoring i experience this problem. Possible  solutions to this situation.</p>\n\n<ol>\n<li><p>Run migrations on production manually to assure consitent state between migrations and models</p></li>\n<li><p>Temporarily comment out workflow code in model to run blocking migration, then deploy, then uncomment workflow code and move on with deploy and next migrations</p></li>\n<li><p>Version migrations and model changes on branches, so they are consistent. Deploy to production and run migration by chunks</p></li>\n<li><p>Include temp workarounds in the model code, and remove them from source after migrations on production are deployed.</p></li>\n<li><p>Monkey-patch model in migration code for backwards compatibility. In your situation this would be to dynamically remove 'workflow' from model code, which might be hard, and then run migration</p></li>\n</ol>\n\n<p>All solutions are some kind of dirty hacks, but it's not easy to have migrations and model code versioned. The best way would be to deploy in chunks or if need to deploy all at once use some temp code in model and remove it after deploy on production.</p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "edited": false, "score": 0, "creation_date": 1467293222, "post_id": 38123985, "comment_id": 63680195, "body": "So what this does is: - Before migrations run, initializes the Rails app, without the Workflow as it gets bypassed in the <code>if condition(which you mentioned)</code> - And then, <b>Migration#2</b> migration works fine and succeeds, but when <b>Migration#3</b> runs, it doesn&#39;t do anything with code: <code>X_MODEL_STATES::ACTIVE</code> as the loaded model is not the one with the new column, plus the Workflow is still somehow controlling the Model(despite <code>if{condition}</code>)."}, {"owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "edited": false, "score": 0, "creation_date": 1467293234, "post_id": 38123985, "comment_id": 63680209, "body": "After all executed migrations, observation is: All <code>X Model</code> entries have <code>:status = nil</code> despite this change suggested by you and despite the <b>Migration#3</b> containing the initialization of <code>:status</code> to value <code>X_MODEL_STATES::ACTIVE</code> which is <code>1</code>"}], "tags": [], "owner": {"reputation": 51, "user_id": 5341806, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gm6QwgF3A3g/AAAAAAAAAAI/AAAAAAAAAXg/yCpFu9CqJZU/photo.jpg?sz=128", "display_name": "007sumit", "link": "https://stackoverflow.com/users/5341806/007sumit"}, "is_accepted": false, "score": 2, "last_activity_date": 1467291836, "creation_date": 1467291836, "answer_id": 38123985, "question_id": 38101585, "link": "https://stackoverflow.com/questions/38101585/ruby-workflow-issue-during-migration/38123985#38123985", "title": "Ruby Workflow Issue During Migration", "body": "<p>You can wrap up your workflow code by a check for column_name.</p>\n\n<pre><code>if self.attribute_names.include?('status')\n  include Workflow\n  workflow_column :status\n  workflow do\n    ...\n  end\nend\n</code></pre>\n\n<p>This will result in running workflow code only after 'AddStatusToTable' migration ran successfully.</p>\n"}, {"comments": [{"owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "edited": false, "score": 1, "creation_date": 1467362603, "post_id": 38140154, "comment_id": 63711719, "body": "Great you made it. That&#39;s still a temp code hack, because you don&#39;t want your model to have all those ifs on all those attributes forever :-)"}, {"owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "edited": false, "score": 0, "creation_date": 1467363041, "post_id": 38140154, "comment_id": 63711957, "body": "you should accept someone&#39;s answer, I vote for @007sumit as you just copied his answer to yours code and made a new answer. You used 007sumit code as solution, so please do accept 007sumit answer. That&#39;s how SO works."}, {"owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "reply_to_user": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "edited": false, "score": 0, "creation_date": 1467373916, "post_id": 38140154, "comment_id": 63718970, "body": "So that isn&#39;t a complete answer. It didn&#39;t fix it entirely. the answer is combination of @007sumit &#39;s answer and the answer provided in the post: <a href=\"http://stackoverflow.com/questions/200813/how-do-i-force-activerecord-to-reload-a-class\" title=\"how do i force activerecord to reload a class\">stackoverflow.com/questions/200813/&hellip;</a> . Hence i added the correct answer, which is combination of the two. M happy to accept anyone&#39;s answer but they are incomplete, hence not correct to accept. Though upvoted the usable ones."}, {"owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "edited": false, "score": 1, "creation_date": 1467374672, "post_id": 38140154, "comment_id": 63719455, "body": "right, I&#39;ve missed the point 3. and  reset_column_information usage. greets"}, {"owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "reply_to_user": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "edited": false, "score": 0, "creation_date": 1467376769, "post_id": 38140154, "comment_id": 63720820, "body": "Thanks for the inputs though :) , you can upvote the last answer."}], "tags": [], "owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "is_accepted": true, "score": 0, "last_activity_date": 1467361814, "last_edit_date": 1467361814, "creation_date": 1467360135, "answer_id": 38140154, "question_id": 38101585, "link": "https://stackoverflow.com/questions/38101585/ruby-workflow-issue-during-migration/38140154#38140154", "title": "Ruby Workflow Issue During Migration", "body": "<p><strong>THANKS ALL</strong>\nI found the solution to this, and i am posting it here. The problems to issue here were:</p>\n\n<ul>\n<li>Add <code>:status</code> field to <code>ActiveRecord Model X</code> without commenting out Workflow Code and not let Workflow disallow creation of an instance in <code>Table X</code> during migration.</li>\n<li>Secondly, add an if condition to it as specified by @007sumit.</li>\n<li>Thirdly, to be able to reload Model in migration with the updated column_information of <code>Model X</code></li>\n</ul>\n\n<p>Writing whole code solution here:</p>\n\n<pre><code>  class BaseModel &lt; ActiveRecord::Base\n      #\n      # Workflow to define states of Role\n      #\n      # Initial State =&gt; Active\n      #\n      # # State Diagram::\n      #   Active  --soft_delete--&gt; Deleted\n      #   Deleted\n      #\n      # * activate, soft_delete are the event which triggers the state transition\n      #\n\n      # if condition to add workflow only if :status field is added\n      if self.attribute_names.include?('status')\n        include Workflow\n        workflow_column :status\n        workflow do\n          state :active, X_MODEL_STATES::ACTIVE do\n            event :soft_delete, transitions_to: :deleted\n          end\n          state :deleted, X_MODEL_STATES::DELETED\n\n        end\n      end\n\n      def trigger_event(event)\n        ...\n      end\n  end\n\n  class X_MODEL_STATES\n    ...\n  end\n\n  class X_MODEL_EVENTS\n    ...\n  end\n\n# Migrations(posting Up functions only - in correct sequence)\n#--------------------------------------------------\n\n#1st: Migration - This is already existing migration\nCreateX &lt; ActiveRecord::Migration\n  def up\n    create_table :xs do |t|\n      t.string :name\n      t.timestamps null: false\n    end\n  end\nend\n\n#2nd: Migration - This is already existing migration\nCreateInitialX &lt; ActiveRecord::Migration\n  def up\n    X.create({:name =&gt; 'Kartik'})\n  end\nend\n\n#3rd: Migration - This is a new migration to add status field and \n# modify status value in existing entries in X Model\nAddStatusToX &lt; ActiveRecord::Migration\n  def up\n    add_column :xs, :status, :integer\n\n    # This resets Model Class before executing this migration and \n    # Workflow is identified from the if condition specified which was \n    # being skipped previously without this line as Model Class is  \n    # loaded only once before all migrations run.\n    # Thanks to post: http://stackoverflow.com/questions/200813/how-do-i-force-activerecord-to-reload-a-class\n\n    x.reset_column_information\n    x.all.each do |x_instance|\n      x.status = X_MODEL_STATES::ACTIVE\n      x.save!\n    end\n  end\nend\n</code></pre>\n\n<p>@stan-brajewski Now, this code can go in one deployment.\nThanks all for inputs :)</p>\n"}], "owner": {"reputation": 117, "user_id": 2011046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6653fc137cd93a11b1f4e81edad109b?s=128&d=identicon&r=PG", "display_name": "kattybilly", "link": "https://stackoverflow.com/users/2011046/kattybilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 38140154, "answer_count": 3, "score": 1, "last_activity_date": 1467361814, "creation_date": 1467208136, "last_edit_date": 1467292811, "question_id": 38101585, "link": "https://stackoverflow.com/questions/38101585/ruby-workflow-issue-during-migration", "title": "Ruby Workflow Issue During Migration", "body": "<p>I am using Ruby Workflow in my ActiveRecords using Gem: <a href=\"https://github.com/geekq/workflow\" rel=\"nofollow\">Workflow</a></p>\n\n<p><strong>Existing Running Code contains:</strong></p>\n\n<ul>\n<li>I am having an ActiveRecord: X</li>\n<li>I am having two Migrations already:\n\n<ul>\n<li><strong>(Ref1)</strong> CreateX migration (which creates table X)</li>\n<li><strong>(Ref2)</strong> CreateInitialEntryInX migration (which creates one entry in table X)</li>\n</ul></li>\n</ul>\n\n<p><strong>New Changes:</strong></p>\n\n<ul>\n<li>Now I wanted to add workflow in ActiveRecord X, hence I did:\n\n<ul>\n<li><strong>(Ref3)</strong> I added the workflow code in ActiveRecord Model X (mentioning :status as my workflow field)</li>\n<li><strong>(Ref4)</strong> AddStatusFieldToX migration (which adds :status field in table X)</li>\n</ul></li>\n</ul>\n\n<p>Now when I run rake db:migrate after the changes, the <strong>(Ref2)</strong> breaks cos Migration looks for :status field as it is mentioned in ActiveRecord Model in the Workflow section, but :status field has not been added yet as migration <strong>(Ref4)</strong> has not executed yet.</p>\n\n<p>Hence, all the builds fail when all migrations are run in sequence, Any solution to this?\nI do not want to resequence any of the migration or edit any old existing migrations.</p>\n\n<p>My Model looks like:</p>\n\n<pre><code>  class BaseModel &lt; ActiveRecord::Base\n      #\n      # Workflow to define states of Role\n      #\n      # Initial State =&gt; Active\n      #\n      # # State Diagram::\n      #   Active  --soft_delete--&gt; Deleted\n      #   Deleted\n      #\n      # * activate, soft_delete are the event which triggers the state transition\n      #\n      include Workflow\n      workflow_column :status\n      workflow do\n        state :active, X_MODEL_STATES::ACTIVE do\n          event :soft_delete, transitions_to: :deleted\n        end\n        state :deleted, X_MODEL_STATES::DELETED\n\n        on_transition do |from, to, event, *event_args|\n          self.update_attribute(:status, to)\n        end\n      end\n\n      def trigger_event(event)\n        begin\n          case event.to_i\n            when X_MODEL_EVENTS::ACTIVATE\n              self.activate!\n            when X_MODEL_EVENTS::SOFT_DELETE\n              self.soft_delete!\n          end\n        rescue ....\n      end\n  end\n\n  class X_MODEL_STATES\n    ACTIVE      = 1\n    DELETED     = 2\n  end\n\n  class X_MODEL_EVENTS\n    ACTIVATE      = 1\n    SOFT_DELETE   = 2\n  end\n\n# Migrations(posting Up functions only - in correct sequence)\n#--------------------------------------------------\n\n#1st: Migration - This is already existing migration\nCreateX &lt; ActiveRecord::Migration\n  def up\n    create_table :xs do |t|\n      t.string :name\n      t.timestamps null: false\n    end\n  end\nend\n\n#2nd: Migration - This is already existing migration\nCreateInitialX &lt; ActiveRecord::Migration\n  def up\n    X.create({:name =&gt; 'Kartik'})\n  end\nend\n\n#3rd: Migration - This is a new migration\nAddStatusToX &lt; ActiveRecord::Migration\n  def up\n    add_column :xs, :status, :integer\n    x.all.each do |x_instance|\n      x.status = X_MODEL_STATES::ACTIVE\n      x.save!\n    end\n  end\nend\n</code></pre>\n\n<p>So, when <strong>Migration#2</strong> runs, it tries to find :status field to write is with initial value of <code>X_MODEL_STATES::ACTIVE</code> as it is mentioned in Active Record Model files workflow as: <code>workflow_column :status</code> and does not find the field as <strong>Migration#3</strong> is yet to execute.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara"], "comments": [{"owner": {"reputation": 2131, "user_id": 3475678, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/230e565cac4491b28134bb92bfc28a70?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/3475678/aleksey"}, "edited": false, "score": 0, "creation_date": 1467209342, "post_id": 38101315, "comment_id": 63638045, "body": "Does this button work when you click it manually in browser? Are you sure button within <code>&lt;form&gt;&lt;&#47;form&gt;</code>?"}, {"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "reply_to_user": {"reputation": 2131, "user_id": 3475678, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/230e565cac4491b28134bb92bfc28a70?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/3475678/aleksey"}, "edited": false, "score": 0, "creation_date": 1467210211, "post_id": 38101315, "comment_id": 63638748, "body": "@Aleksey thank you for your response.  I did update my question to include the code for the submit buttons in case that helps.  The buttons are within the form.  Within development mode, I can click the buttons manually in the browser and it works.  However: within my specs when I put a <code>binding.pry</code> in: Clicking the button does not work."}, {"owner": {"reputation": 2131, "user_id": 3475678, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/230e565cac4491b28134bb92bfc28a70?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/3475678/aleksey"}, "edited": false, "score": 0, "creation_date": 1467210628, "post_id": 38101315, "comment_id": 63639062, "body": "And what about button id? What is <code>&quot;update_#{dom_id(item)}_btn&quot;</code> is exaclty equal to?"}, {"owner": {"reputation": 2131, "user_id": 3475678, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/230e565cac4491b28134bb92bfc28a70?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/3475678/aleksey"}, "edited": false, "score": 0, "creation_date": 1467210696, "post_id": 38101315, "comment_id": 63639109, "body": "Maybe try to use <code>click_button(button_id)</code>"}, {"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "reply_to_user": {"reputation": 2131, "user_id": 3475678, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/230e565cac4491b28134bb92bfc28a70?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/3475678/aleksey"}, "edited": false, "score": 0, "creation_date": 1467210966, "post_id": 38101315, "comment_id": 63639297, "body": "@Aleksey ahh, ok.  So I was manually testing in Safari.  Capybara tests in firefox.  Turns out the button DOES NOT work in firefox but it does work in safari.  Do you perhaps know why this is?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1467213549, "post_id": 38101315, "comment_id": 63641236, "body": "@Neil do you have any form validation attributes on any of the fields in the form? Also open the inspector in FF and make sure the buttons are actually in the form (different browsers make different parsing decisions if the HTML happens to be invalid), since a form cannot be a child of table or tr elements. You can also check the browser console for JS errors."}, {"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1467214645, "post_id": 38101315, "comment_id": 63642018, "body": "Thanks @TomWalpole , You said forms cannot be children of tr elements?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1467214865, "post_id": 38101315, "comment_id": 63642163, "body": "@Neil Correct -  the only valid children of tr elements are td and th elements -  <a href=\"https://www.w3.org/TR/html5/tabular-data.html#the-tr-element\" rel=\"nofollow noreferrer\">w3.org/TR/html5/tabular-data.html#the-tr-element</a>.  If you don&#39;t need IE compatibility you can put a form=&quot;some_name&quot; attribute on the inputs and buttons you want to be part of the same form - if you do need IE compatibility then you will need to rearrange how your form works (for instance 1 form around the whole table and then decide which record to update based on the button used to submit) -- or do your layout without using tables"}, {"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1467215125, "post_id": 38101315, "comment_id": 63642356, "body": "@TomWalpole thanks, I&#39;ll look into this."}], "answers": [{"comments": [{"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "edited": false, "score": 0, "creation_date": 1467217236, "post_id": 38105135, "comment_id": 63643877, "body": "That was in fact the issue: putting a form inside a tr.  What I did was I removed the table completely and just used bootstrap&#39;s responsive grid to simulate a table and styled it to look like a table.  That way I could have multiple forms and it all worked as expected.  Looks like Firefox is not as forgiving as Safari in this situation."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1467217148, "creation_date": 1467217148, "answer_id": 38105135, "question_id": 38101315, "link": "https://stackoverflow.com/questions/38101315/multiple-rails-forms-on-same-page-clicking-submit-button-per-form-always-works/38105135#38105135", "title": "Multiple rails forms on same page: clicking submit button per form always works in safari, sometimes works in firefox", "body": "<p>Based on responses to comments on the OQ, it appears you have form elements wrapping your td elements inside a tr.  That is invalid HTML since a form element is not a valid child of a tr, and different browsers may/do interpret markup like that differently.  If you don't need IE compatibility then you can use the HTML5 form attribute to tie form elements outside a form back to the form you want them associated with, however if you do need IE compatibility you'll need to look at other solutions such as not using table/tr/td elements but possibly styling other types of elements with 'display: table/table-row/etc` or one form wrapping the whole table and determining which element to update based on the button clicked. </p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 38105135, "answer_count": 1, "score": 0, "last_activity_date": 1467217148, "creation_date": 1467207513, "last_edit_date": 1467212797, "question_id": 38101315, "link": "https://stackoverflow.com/questions/38101315/multiple-rails-forms-on-same-page-clicking-submit-button-per-form-always-works", "title": "Multiple rails forms on same page: clicking submit button per form always works in safari, sometimes works in firefox", "body": "<p>On an index page I have a table with a bunch of listed items.  Each <code>&lt;tr&gt;&lt;/tr&gt;</code> within the table's <code>&lt;tbody&gt;</code>not only lists each item, but also allows you to </p>\n\n<ul>\n<li><code>update</code> that item</li>\n<li>click <code>edit</code> to take you to the edit screen for that item</li>\n</ul>\n\n<p>Here is a picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YLVgN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YLVgN.png\" alt=\"Showing table\"></a></p>\n\n<p>Within development in safari: I can successfully update each listed item and it all works just fine.  However: when running my feature spec with capybara and selenium-webkit (which uses firefox): </p>\n\n<ul>\n<li>It appears that capybara finds the submit button ok and even clicks it</li>\n<li>But then nothing happens.  For some reason the form appears to not be submitting when that update button is clicked. </li>\n</ul>\n\n<p>To make things even more strange: in development mode while testing with firefox, clicking the update button works sometimes.  Sometimes it doesn't work and I have to refresh the page, and then it works.</p>\n\n<p>I tried putting a <code>binding.pry</code> in right before clicking the <code>Update abc</code> button in order to manually click the button at that step. I noticed that clicking the button manually was not submitting the form either.</p>\n\n<p>Here is my relevant spec:</p>\n\n<pre><code>scenario \"within the index page\", js: true do\n  select 'some selection', from 'item_1_jazz'\n  select '12345', from 'item_1_something'\n  # I attempted putting a binding.pry here, and noticed that clicking the update button still wasn't submitting the form\n  find(\"#update_some_item_1_btn\").click\n\n  expect(page).to have_content 'The item was successfully updated.'\nend\n</code></pre>\n\n<p><strong>Update</strong> Here are my buttons within the form:</p>\n\n<pre><code>&lt;td class=\"btn-group\"&gt;\n  &lt;%= f.submit 'Update abc', class: \"btn btn-success btn-sm\", id: \"update_#{dom_id(item)}_btn\" %&gt;\n  &lt;%= link_to edit_item_path(item), class: \"btn btn-info btn-sm\" do %&gt;\n    &lt;i class=\"fa fa-pencil\"&gt;&lt;/i&gt; Edit\n  &lt;% end %&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p><strong>Question:</strong> In firefox: Capybara appears to find the submit button just fine and even click it. But why isn't Capybara able to submit the form within Firefox? Also: why in development mode with firefox does the button only work sometimes?  It appears something is stopping the form form from submitting.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-places-api"], "comments": [{"owner": {"reputation": 686, "user_id": 403464, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c478e26990c0fbb97fc11f2c5760f971?s=128&d=identicon&r=PG", "display_name": "Joeyjoejoe", "link": "https://stackoverflow.com/users/403464/joeyjoejoe"}, "edited": false, "score": 0, "creation_date": 1467206765, "post_id": 38100520, "comment_id": 63635747, "body": "You should look at the content of params[:lat], params[:long] and params[:radius]. One or more of them may be wrong type or nil."}, {"owner": {"reputation": 1842, "user_id": 2151881, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/bx2eT.jpg?s=128&g=1", "display_name": "Stefan Ciprian Hotoleanu", "link": "https://stackoverflow.com/users/2151881/stefan-ciprian-hotoleanu"}, "reply_to_user": {"reputation": 686, "user_id": 403464, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c478e26990c0fbb97fc11f2c5760f971?s=128&d=identicon&r=PG", "display_name": "Joeyjoejoe", "link": "https://stackoverflow.com/users/403464/joeyjoejoe"}, "edited": false, "score": 0, "creation_date": 1467206885, "post_id": 38100520, "comment_id": 63635845, "body": "Thank you for your help ! The codes executes okau until the following line: next_spots = @client.spots_by_pagetoken(next_page_token). I can get the results and next_page_token, but somehow spots_by_pagetoken(next_page_token) fails."}, {"owner": {"reputation": 686, "user_id": 403464, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c478e26990c0fbb97fc11f2c5760f971?s=128&d=identicon&r=PG", "display_name": "Joeyjoejoe", "link": "https://stackoverflow.com/users/403464/joeyjoejoe"}, "edited": false, "score": 0, "creation_date": 1467207477, "post_id": 38100520, "comment_id": 63636380, "body": "What s the output of &quot;puts next_page_token&quot;?"}, {"owner": {"reputation": 1842, "user_id": 2151881, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/bx2eT.jpg?s=128&g=1", "display_name": "Stefan Ciprian Hotoleanu", "link": "https://stackoverflow.com/users/2151881/stefan-ciprian-hotoleanu"}, "reply_to_user": {"reputation": 686, "user_id": 403464, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c478e26990c0fbb97fc11f2c5760f971?s=128&d=identicon&r=PG", "display_name": "Joeyjoejoe", "link": "https://stackoverflow.com/users/403464/joeyjoejoe"}, "edited": false, "score": 0, "creation_date": 1467207647, "post_id": 38100520, "comment_id": 63636528, "body": "It is something like: CoQC8wAAAMa-UPK2AUTrpuNKpwxHzsbyVBFVHmqlW9T8KRvMrJ020V4Lv_bf&zwnj;&#8203;XX6k2EzCrviga7lpBZdZ&zwnj;&#8203;xFWivA_ki8GUp9d9DxoG&zwnj;&#8203;q1dfkiXFRz57Pb0Ndumx&zwnj;&#8203;VQRQ76KZuDPdFmNKAYlK&zwnj;&#8203;Frc724VlfoSOqCExH4xQ&zwnj;&#8203;QDf4AMaR4KkEDeg-qA0F&zwnj;&#8203;g5O3hOTjpKDvJJomunOq&zwnj;&#8203;_-ZFg_DUxRl_pU-oYEA_&zwnj;&#8203;JgHLgldhmTWijkEge4G_&zwnj;&#8203;iPrdn2tm1rYwLb9QTx2j&zwnj;&#8203;TK-JKkMt1PBAY6BlkSTB&zwnj;&#8203;J9RwAzAdHKVU6a69dS_N&zwnj;&#8203;pw_wCLP793l_KPzV35zZ&zwnj;&#8203;Fc7WnKRpszebIpgTUf9p&zwnj;&#8203;1pTKd7mmvZYSEHxsKfUW&zwnj;&#8203;DJZWDhnK8FqbQeEaFI6-&zwnj;&#8203;ju-6FY-V66SihOQbkfHY&zwnj;&#8203;x8Wd"}, {"owner": {"reputation": 686, "user_id": 403464, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c478e26990c0fbb97fc11f2c5760f971?s=128&d=identicon&r=PG", "display_name": "Joeyjoejoe", "link": "https://stackoverflow.com/users/403464/joeyjoejoe"}, "edited": false, "score": 0, "creation_date": 1467207947, "post_id": 38100520, "comment_id": 63636807, "body": "Try to edit your client definition like this:   @client = GooglePlaces::Client.new(&#39;api_key_XXXXX&#39;, {:lat =&gt; params[:lat], :lng =&gt; params[:long], :radius =&gt; params[:radius]})"}, {"owner": {"reputation": 1842, "user_id": 2151881, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/bx2eT.jpg?s=128&g=1", "display_name": "Stefan Ciprian Hotoleanu", "link": "https://stackoverflow.com/users/2151881/stefan-ciprian-hotoleanu"}, "reply_to_user": {"reputation": 686, "user_id": 403464, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c478e26990c0fbb97fc11f2c5760f971?s=128&d=identicon&r=PG", "display_name": "Joeyjoejoe", "link": "https://stackoverflow.com/users/403464/joeyjoejoe"}, "edited": false, "score": 0, "creation_date": 1467208136, "post_id": 38100520, "comment_id": 63636963, "body": "I believe @client.spots expects for arguments as well. I get this error: ArgumentError (wrong number of arguments (0 for 2..3)):   app/controllers/api/v1/pins_controller.rb:80:in `pins_in_area&#39;. Where line 80 is: @results = @client.spots"}, {"owner": {"reputation": 1842, "user_id": 2151881, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/bx2eT.jpg?s=128&g=1", "display_name": "Stefan Ciprian Hotoleanu", "link": "https://stackoverflow.com/users/2151881/stefan-ciprian-hotoleanu"}, "reply_to_user": {"reputation": 686, "user_id": 403464, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c478e26990c0fbb97fc11f2c5760f971?s=128&d=identicon&r=PG", "display_name": "Joeyjoejoe", "link": "https://stackoverflow.com/users/403464/joeyjoejoe"}, "edited": false, "score": 0, "creation_date": 1467208421, "post_id": 38100520, "comment_id": 63637201, "body": "I checked the definition of spots_by_pagetoken which is depends on:     def self.list_by_pagetoken(pagetoken, api_key, options = {})       exclude = options.delete(:exclude) || []       exclude = [exclude] unless exclude.is_a?(Array)        options = {           :pagetoken =&gt; pagetoken,           :key =&gt; api_key       }        request(:spots_by_pagetoken, false, exclude, options)     end. Not sure what&#39;s wrong :D"}, {"owner": {"reputation": 686, "user_id": 403464, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c478e26990c0fbb97fc11f2c5760f971?s=128&d=identicon&r=PG", "display_name": "Joeyjoejoe", "link": "https://stackoverflow.com/users/403464/joeyjoejoe"}, "edited": false, "score": 0, "creation_date": 1467209410, "post_id": 38100520, "comment_id": 63638101, "body": "There&#39;s a similar bug describe here and a potential solution (in the first post at top).  Try adding the &quot;multipage: true&quot; somewhere. I can&#39;t do much :s  <a href=\"https://github.com/qpowell/google_places/issues/70\" rel=\"nofollow noreferrer\">github.com/qpowell/google_places/issues/70</a>"}], "owner": {"reputation": 1842, "user_id": 2151881, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/bx2eT.jpg?s=128&g=1", "display_name": "Stefan Ciprian Hotoleanu", "link": "https://stackoverflow.com/users/2151881/stefan-ciprian-hotoleanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467206005, "creation_date": 1467205660, "last_edit_date": 1467206005, "question_id": 38100520, "link": "https://stackoverflow.com/questions/38100520/google-places-gem-error", "title": "Google Places gem error", "body": "<p>I am trying to use the next page token from the first page results that are retrieved by the call to the Google Places, using the following code: </p>\n\n<pre><code>   def pins_in_area\n            @client = GooglePlaces::Client.new('api_key_XXXXX')\n            @results = @client.spots(params[:lat], params[:long], :radius =&gt; params[:radius])\n            puts @results\n            next_page_token = @results.last.nextpagetoken\n            puts next_page_token #spots_by_pagetoken\n            next_spots = @client.spots_by_pagetoken(next_page_token)\n            puts next_spots\n</code></pre>\n\n<p>...\n        end</p>\n\n<p>But, I encounter the following error, not sure why:</p>\n\n<pre><code>Completed 500 Internal Server Error in 258ms (ActiveRecord: 0.0ms)\n\nGooglePlaces::InvalidRequestError (GooglePlaces::InvalidRequestError):\n  app/controllers/api/v1/pins_controller.rb:89:in `pins_in_area'\n\n\n  Rendered /usr/local/rvm/gems/ruby-2.2.1/gems/actionpack-4.2.4/lib/action_dispatch/middleware/templates/rescues/_source.erb (13.1ms)\n  Rendered /usr/local/rvm/gems/ruby-2.2.1/gems/actionpack-4.2.4/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (35.1ms)\n  Rendered /usr/local/rvm/gems/ruby-2.2.1/gems/actionpack-4.2.4/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (2.0ms)\n  Rendered /usr/local/rvm/gems/ruby-2.2.1/gems/actionpack-4.2.4/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (101.1ms)\n</code></pre>\n"}, {"tags": ["ruby", "windows"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5303394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sXtEL.png?s=128&g=1", "display_name": "jonashermann", "link": "https://stackoverflow.com/users/5303394/jonashermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1467214611, "creation_date": 1467214611, "answer_id": 38104190, "question_id": 38100135, "link": "https://stackoverflow.com/questions/38100135/fixing-a-bug-when-running-rest-client/38104190#38104190", "title": "Fixing a bug when running rest-client", "body": "<p>To fix this error(I recommend to those working on theodinproject using windows 7)</p>\n\n<p>just do this</p>\n\n<ol>\n<li>gem uninstall ffi</li>\n<li>gem install ffi --platform=ruby</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 5303394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sXtEL.png?s=128&g=1", "display_name": "jonashermann", "link": "https://stackoverflow.com/users/5303394/jonashermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467214611, "creation_date": 1467204664, "last_edit_date": 1467204936, "question_id": 38100135, "link": "https://stackoverflow.com/questions/38100135/fixing-a-bug-when-running-rest-client", "title": "Fixing a bug when running rest-client", "body": "<p>I'm trying to require <code>rest-client</code> on Windows, but I do encounter this error:</p>\n\n<blockquote>\n  <p>cannot load file --ffi</p>\n</blockquote>\n\n<p>How to hack needed files to make <code>rest-client</code> executable, so that I can perform some requests?</p>\n\n<p>Thanks so much for solution.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1467215237, "post_id": 38100085, "comment_id": 63642457, "body": "Can you clarify something for us? All of your amounts are negative, so the sum for <code>&quot;BOAT&quot;</code> is -1,800 and the sum for <code>&quot;HOUSE&quot;</code> is -500, meaning the latter is greater than the former. Do you want the sum with the greatest absolute value, or the greatest sum of all absolute values? (Those will be the same if all values are negative, but different if some are positive and some are negative, i.e. |-10| + |5| \u2260 |-10 + 5|.)"}], "answers": [{"tags": [], "owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "is_accepted": false, "score": 2, "last_activity_date": 1467209060, "last_edit_date": 1467209060, "creation_date": 1467205846, "answer_id": 38100615, "question_id": 38100085, "link": "https://stackoverflow.com/questions/38100085/ruby-select-a-grouped-array-with-multiple-conditions/38100615#38100615", "title": "Ruby: Select a grouped array with multiple conditions", "body": "<pre><code>@transactions.group_by { |h| h['name'] }\n             .map { |k, v| [k, v.inject(0) { |acc, cur| acc + cur['amount'] }] }\n             .max_by(&amp;:last).first\n</code></pre>\n\n<p>when you want a single value from <code>Enumerable</code>, you probably need <code>reduce</code> or <code>inject</code>.</p>\n\n<hr>\n\n<p>See documentation on <a href=\"http://ruby-doc.org/core-2.3.1/Enumerable.html#method-i-inject\" rel=\"nofollow\"><code>Enumerable#inject</code></a> for further info.</p>\n"}, {"tags": [], "owner": {"reputation": 845, "user_id": 5646801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d133162c0a6c4b45ad559f5a86f8f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii K", "link": "https://stackoverflow.com/users/5646801/sergii-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1467207715, "last_edit_date": 1467207715, "creation_date": 1467206922, "answer_id": 38101049, "question_id": 38100085, "link": "https://stackoverflow.com/questions/38100085/ruby-select-a-grouped-array-with-multiple-conditions/38101049#38101049", "title": "Ruby: Select a grouped array with multiple conditions", "body": "<p>First step. Select \"duplicated\" transactions:</p>\n\n<pre><code>selected = @transactions.group_by { |el| el['name'] }\n                        .select{ |k, v| v.size &gt; 1 }\n</code></pre>\n\n<p>Second step. Find name of product with maximum amount (in that case with minimum, due to negative number):</p>\n\n<pre><code>selected.each_with_object({}) { |(k, v), obj| obj[k] = v.map { |a| a['amount'] }.sum }\n        .min_by { |k, v| v }.first\n</code></pre>\n\n<p>Update:</p>\n\n<pre><code>@transactions.group_by { |el| el['name'] }\n             .each_with_object({}) { |(k, v), obj| obj[k] = v.map { |a| a['amount'] }.sum if v.size &gt; 1 }\n             .min_by { |k, v| v }.first\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1467208826, "creation_date": 1467208826, "answer_id": 38101912, "question_id": 38100085, "link": "https://stackoverflow.com/questions/38100085/ruby-select-a-grouped-array-with-multiple-conditions/38101912#38101912", "title": "Ruby: Select a grouped array with multiple conditions", "body": "<p>Just out of curiosity:</p>\n\n<pre><code>[*transactions.each_with_object(\n     Hash.new { |h, k| h[k] = {count: 0, total: 0} }\n  ) do |h, memo|\n    memo[h['name']].tap do |ct|\n      ct[:count] += 1\n      ct[:total] -= h['amount']\n    end\n  end.reject { |_, v| v[:count] == 1 }\n     .sort_by { |_, v| v[:total] }].to_h\n#\u21d2 {\n#   \"BOAT\" =&gt; {\n#    :count =&gt; 3,\n#    :total =&gt; 1800\n#  },\n#  \"HOUSE\" =&gt; {\n#    :count =&gt; 4,\n#    :total =&gt; 500\n#  }\n# }\n</code></pre>\n\n<p>One might call <code>first</code> on result now, or use <code>max_by</code> instead of <code>sort_by</code> to retrieve just one max element.</p>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 1, "last_activity_date": 1467218136, "last_edit_date": 1467218136, "creation_date": 1467216707, "answer_id": 38104979, "question_id": 38100085, "link": "https://stackoverflow.com/questions/38100085/ruby-select-a-grouped-array-with-multiple-conditions/38104979#38104979", "title": "Ruby: Select a grouped array with multiple conditions", "body": "<p>There are a lot of good answers here. I'd like to add that you can eliminate a lot of iteration by combining operations.</p>\n\n<p>For example, rather than calculating the sums for each group in a second step, you can do that inside your <code>group_by</code> block:</p>\n\n<pre><code>sums = Hash.new(0)\n\ngroups = transactions.group_by do |t|\n  sums[t[\"name\"]] += t[\"amount\"]\n  t[\"name\"]\nend\n\np groups\n# =&gt; { \"CAR\" =&gt; [ { \"amount\" =&gt; -3000, \"name\" =&gt; \"CAR\" } ],\n#      \"BOAT\" =&gt; [ ... ],\n#      \"HOUSE\" =&gt; [ ... ] }\n\np sums\n# =&gt; { \"CAR\" =&gt; -3000, \"BOAT\" =&gt; -1800, \"HOUSE\" =&gt; -500 }\n</code></pre>\n\n<p>Next instead of doing <code>groups.select</code> to eliminate groups with only one member and then <code>min_by</code> to get the final result, combine the former into the latter:</p>\n\n<pre><code>result = groups.min_by do |k,g|\n  g.size &gt; 1 ? sums[k] : Float::INFINITY\nend\n\np result[1]\n# =&gt; [ { \"amount\" =&gt; -600, \"name\" =&gt; \"BOAT\" },\n#      { \"amount\" =&gt; -600, \"name\" =&gt; \"BOAT\" },\n#      { \"amount\" =&gt; -600, \"name\" =&gt; \"BOAT\" } ]\n</code></pre>\n\n<p>Because <em>everything</em> is smaller than <code>Float::INFINITY</code>, those groups with only one member will never be selected (unless every group has only one member).</p>\n\n<p>And so...</p>\n\n<h2>Solution 1</h2>\n\n<p>Putting it all together:</p>\n\n<pre><code>sums = Hash.new(0)\n\nresult =\n  transactions.group_by {|t|\n    sums[t[\"name\"]] += t[\"amount\"]\n    t[\"name\"]\n  }.min_by {|k,g| g.size &gt; 1 ? sums[k] : Float::INFINITY }[1]\n\np result\n# =&gt; [ { \"amount\" =&gt; -600, \"name\" =&gt; \"BOAT\" },\n#      { \"amount\" =&gt; -600, \"name\" =&gt; \"BOAT\" },\n#      { \"amount\" =&gt; -600, \"name\" =&gt; \"BOAT\" } ]\n</code></pre>\n\n<h2>Solution 2</h2>\n\n<p>You could also combine all of this into a single <code>reduce</code> and iterate over the data only once, but it's not very Rubyish:</p>\n\n<pre><code>sums = Hash.new(0)\ngroups = Hash.new {|h,k| h[k] = [] }\nmin_sum = Float::INFINITY\n\nresult = transactions.reduce do |min_group, t|\n  name = t[\"name\"]\n  sum = sums[name] += t[\"amount\"]\n  (group = groups[name]) &lt;&lt; t\n\n  if group.size &gt; 1 &amp;&amp; sum &lt; min_sum\n    min_sum, min_group = sum, group\n  end\n  min_group\nend\n</code></pre>\n\n<p>Note that you could move all of those outside variable declarations into, say, an array passed to <code>reduce</code> (instead of <code>nil</code>), but it would impact readability a lot.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1467230802, "last_edit_date": 1467230802, "creation_date": 1467217825, "answer_id": 38105330, "question_id": 38100085, "link": "https://stackoverflow.com/questions/38100085/ruby-select-a-grouped-array-with-multiple-conditions/38105330#38105330", "title": "Ruby: Select a grouped array with multiple conditions", "body": "<p>Here's an approach that creates an array of hashes rather than selecting hashes from the given array.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def doit(transactions)\n  name, arr = transactions.each_with_object(Hash.new { |h,k| h[k]=[] }) { |g,h|\n    h[g[\"name\"]] &lt;&lt; g[\"amount\"] }.\n    reject { |_,v| v.size == 1 }.\n    min_by { |_,v| v.reduce(:+) }\n    name ? arr.map { |v| { \"amount\"=&gt;v, \"name\"=&gt;name } } : []\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>doit(@transactions)\n  #=&gt; [{\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n  #    {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n  #    {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"}] \n\ndoit([{\"amount\"=&gt;-3000, \"name\"=&gt;\"CAR\"}, {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n      {\"amount\"=&gt;-125, \"name\"=&gt;\"HOUSE\"}])  \n      #=&gt; []\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<pre><code>The steps for the first example are as follows.\n\na = @transactions.each_with_object(Hash.new { |h,k| h[k]=[] }) { |g,h|\n  h[g[\"name\"]] &lt;&lt; g[\"amount\"] }\n  #=&gt; {\"CAR\"=&gt;[-3000], \"BOAT\"=&gt;[-600, -600, -600], \"HOUSE\"=&gt;[-125, -125, -125, -125]} \nb = a.reject { |_,v| v.size == 1 }\n  #=&gt; {\"BOAT\"=&gt;[-600, -600, -600], \"HOUSE\"=&gt;[-125, -125, -125, -125]} \nname, arr = b.min_by { |_,v| v.reduce(:+) }\n  #=&gt; [\"BOAT\", [-600, -600, -600]] \narr\n  #=&gt; [-600, -600, -600] \nname\n  #=&gt; \"BOAT\" \narr.map { |v| { \"amount\"=&gt;v, \"name\"=&gt;name } }\n  #=&gt; [{\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n  #    {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n  #    {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"}] \n</code></pre>\n\n<p>The expression</p>\n\n<pre><code>h = Hash.new { |h,k| h[k]=[] }\n  #=&gt; {}\n</code></pre>\n\n<p>creates an empty hash with a default given by the block. Suppose we write</p>\n\n<pre><code>h[:dogs] += [\"Saffi\"]\n  #=&gt; [\"Saffi\"] \n</code></pre>\n\n<p>Ruby first expands this to</p>\n\n<pre><code>h[:dogs] = h[:dogs] + [\"Saffi\"]\n</code></pre>\n\n<p>Since <code>h</code> does not have a key <code>:dogs</code> (<code>h</code> is empty), the default is invoked for <code>h[:dogs]</code> on the right side of the equality, so the expression becomes</p>\n\n<pre><code>h[:dogs] = [] + [\"Saffi\"]\n  #=&gt; [\"Saffi\"]\n</code></pre>\n\n<p>Now</p>\n\n<pre><code>h #=&gt; {:dogs=&gt;[\"Saffi\"]} \n</code></pre>\n\n<p>The expression</p>\n\n<pre><code>h[:dogs] &lt;&lt; \"Saffi\"\n  #=&gt; [\"Saffi\"] \nh #=&gt; {:dogs=&gt;[\"Saffi\"]}\n</code></pre>\n\n<p>is similar, in that <code>h[:dogs]</code> is set to <code>[]</code> before <code>\"Saffi\"</code> is appended to the empty array <code>h[:dogs]</code>. Now if we write</p>\n\n<pre><code>h[:dogs] &lt;&lt; \"Nina\"\n  #=&gt; [\"Saffi\", \"Nina\"]\nh #=&gt; {:dogs=&gt;[\"Saffi\", \"Nina\"]}\n</code></pre>\n\n<p>the default block is not invoked since <code>h</code> now has a key <code>:dog</code>. </p>\n\n<p>Another way of writing this is as follows.</p>\n\n<pre><code>def doit(transactions)\n  name, arr = transactions.each_with_object({}) { |g,h|\n    (h[g[\"name\"]] ||= []) &lt;&lt; g[\"amount\"] }.\n    reject { |_,v| v.size == 1 }.\n    min_by { |_,v| v.reduce(:+) }\n    name ? arr.map { |v| { \"amount\"=&gt;v, \"name\"=&gt;name } } : []\nend\n</code></pre>\n\n<p>if <code>h</code> does not have a key <code>g[\"name\"]</code> (in which case <code>h[g[\"name\"]] #=&gt; nil</code>), this sets <code>h[g[\"name\"]]</code> to <code>[]</code> before <code>g[\"amount\"]</code> is appended.</p>\n"}], "owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 981, "favorite_count": 1, "accepted_answer_id": 38104979, "answer_count": 5, "score": -1, "last_activity_date": 1467230802, "creation_date": 1467204590, "question_id": 38100085, "link": "https://stackoverflow.com/questions/38100085/ruby-select-a-grouped-array-with-multiple-conditions", "title": "Ruby: Select a grouped array with multiple conditions", "body": "<p>I have an array of transactions. I need to group the transactions by name and then select the group with the highest amount &amp; more than 1 instance. </p>\n\n<p>For example, if I have 1 transaction named \"car\" with an amount of $3000, and 3 transactions with \"boat\" totaling $1800, and 4 transactions with \"house\" totaling $500, the method will select boat because it is the highest amount group with multiple transactions.</p>\n\n<pre><code>@transactions =\n [{\"amount\"=&gt;-3000, \"name\"=&gt;\"CAR\"},\n  {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n  {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n  {\"amount\"=&gt;-600, \"name\"=&gt;\"BOAT\"},\n  {\"amount\"=&gt;-125, \"name\"=&gt;\"HOUSE\" },\n  {\"amount\"=&gt;-125, \"name\"=&gt;\"HOUSE\" },\n  {\"amount\"=&gt;-125, \"name\"=&gt;\"HOUSE\" },\n  {\"amount\"=&gt;-125, \"name\"=&gt;\"HOUSE\" }]\n</code></pre>\n\n<p>Right now I have this but it selects based on length of name.</p>\n\n<pre><code>@transactions.group_by {|h| h['name'] }.max_by {|k, v| v.length }.first\n</code></pre>\n\n<p>How can I group, then sum, then select by highest amount in a group with multiple transactions.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6779, "user_id": 1691223, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/c2AsP.jpg?s=128&g=1", "display_name": "Shravan40", "link": "https://stackoverflow.com/users/1691223/shravan40"}, "edited": false, "score": 0, "creation_date": 1467204650, "post_id": 38100027, "comment_id": 63634199, "body": "How about converting it by yourself ? <code>K=10^3</code>, <code>M=10^6</code> and so on. If there is no suffix just print the number else multiply it by equivalent value and print it."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1467205341, "post_id": 38100027, "comment_id": 63634702, "body": "<code>2,000,000</code> is not a valid ruby <code>Numeric</code>."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1467206348, "post_id": 38100433, "comment_id": 63635441, "body": "<code>elem = elem.gsub(&#39;$&#39;,&#39;&#39;)</code> :: yeah, there are no currencies in the world save for USD."}], "tags": [], "owner": {"reputation": 2797, "user_id": 3392317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6hfb5.jpg?s=128&g=1", "display_name": "Subhash Chandra", "link": "https://stackoverflow.com/users/3392317/subhash-chandra"}, "is_accepted": false, "score": 0, "last_activity_date": 1467209427, "last_edit_date": 1495541865, "creation_date": 1467205446, "answer_id": 38100433, "question_id": 38100027, "link": "https://stackoverflow.com/questions/38100027/how-to-convert-human-readable-number-to-actual-number-in-ruby/38100433#38100433", "title": "How to convert human readable number to actual number in Ruby?", "body": "<p>Try something like this if you have an array of human readable numbers than</p>\n\n<pre><code>array.map do |elem|\n    elem = elem.gsub('$','')\n    if elem.include? 'B'\n        elem.to_f * 1000000000\n    elsif elem.include? 'M'\n        elem.to_f * 1000000\n    elsif elem.include? 'K'\n        elem.to_f * 1000\n    else\n        elem.to_f\n    end\nend\n</code></pre>\n\n<p>Have a look here as well, you will find many Numbers Helpers</p>\n\n<p><a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html\" rel=\"nofollow noreferrer\">NumberHelper Rails. </a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/24620018/how-can-i-convert-a-human-readable-number-to-a-computer-readable-number-in-ruby\">Ruby Array human readable to actual</a></p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1467207554, "last_edit_date": 1467207554, "creation_date": 1467207226, "answer_id": 38101197, "question_id": 38100027, "link": "https://stackoverflow.com/questions/38100027/how-to-convert-human-readable-number-to-actual-number-in-ruby/38101197#38101197", "title": "How to convert human readable number to actual number in Ruby?", "body": "<pre><code>test = {\n  '1K' =&gt; 1000,\n  '2M' =&gt; 2000000,\n  '2.2K' =&gt; 2200,\n  '1,500' =&gt; 1500,\n  '50' =&gt; 50, \n  '5.5M' =&gt; 5500000\n}\n\nclass String\n  def human_readable_to_i\n    multiplier = {'K' =&gt; 1_000, 'M' =&gt; 1_000_000}[self.upcase[/[KM](?=\\z)/]] || 1\n    value = self.gsub(/[^\\d.]/, '')\n    case value.count('.')\n    when 0 then value.to_i\n    when 1 then value.to_f\n    else 0\n    end * multiplier\n  end \nend\n\ntest.each { |k, v| raise \"Test failed\" unless k.human_readable_to_i == v  }\n</code></pre>\n"}], "owner": {"reputation": 17608, "user_id": 661624, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/347231f8387561ef324e25b48b96ba16?s=128&d=identicon&r=PG&f=1", "display_name": "Henley Chiu", "link": "https://stackoverflow.com/users/661624/henley-chiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 38101197, "answer_count": 2, "score": 0, "last_activity_date": 1467209427, "creation_date": 1467204469, "last_edit_date": 1467205317, "question_id": 38100027, "link": "https://stackoverflow.com/questions/38100027/how-to-convert-human-readable-number-to-actual-number-in-ruby", "title": "How to convert human readable number to actual number in Ruby?", "body": "<p>Is there a simple Rails/Ruby helper function to help you convert human readable numbers to actual numbers?</p>\n\n<p>Such as:</p>\n\n<pre><code>1K =&gt; 1000\n\n2M =&gt; 2,000,000\n\n2.2K =&gt; 2200\n\n1,500 =&gt; 1500\n\n50 =&gt; 50\n\n5.5M =&gt; 5500000\n</code></pre>\n"}, {"tags": ["ruby", "shell", "email"], "owner": {"reputation": 31, "user_id": 6517553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b96acfebb31f8911b46f8d6ff0d5c7?s=128&d=identicon&r=PG&f=1", "display_name": "Agnieszka Walewska", "link": "https://stackoverflow.com/users/6517553/agnieszka-walewska"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467203772, "creation_date": 1467203772, "question_id": 38099750, "link": "https://stackoverflow.com/questions/38099750/sending-mail-using-mailx-shell-command-in-ruby", "title": "Sending mail using mailx shell command in Ruby", "body": "<p>I need some help with my ruby script. I have code like this:</p>\n\n<pre><code>#!/usr/bin/ruby\n\nrequire 'rubygems'\nrequire 'json'\nrequire 'date'\n\nsystem 'curl https://xxx/yyy/zzz --cacert xxx.pem --cert xxx.pem --key xxx.pem &gt;&gt; hosts.txt'\n\ndocument = JSON.load File.new(\"hosts.txt\")\nfile = JSON.load File.new(\"admins.txt\")\nnew_file = File.open(\"newfile.txt\", \"w\")\npersonal_data = file['admins'].group_by { |e| e.delete('name') }\n\ndupa = []\ndocument['results'].map do |h|\n  dupa &lt;&lt; h.merge(personal_data[h['name']].first) if personal_data[h['name']]\nend\n\n#puts dupa\ndupa.each do |a|\n  if a[\"global_status_label\"] != \"OK\"\n\n       last_report = a[\"last_report\"].to_s\n       last_report = last_report[0..9]\n       date_last_report = Date.parse last_report\n       current_Date = Date.today\n       difference_dates = (current_Date - date_last_report).to_i\n                if difference_dates &gt; 5\n                        new_file.puts \"#{a['name']}\\t #{difference_dates}\"\n                end\n    end\nend\nnew_file.close\n</code></pre>\n\n<p>Everything works fine, but I need to send mail with some informations using only shell command mailx/mail. I know how to execute shell commands in Ruby and if I wanted to send only a mail it would not be a problem, but doing thay way I have to create new file with data <code>new_file.puts \"#{a['name']}\\t #{difference_dates}\"</code> and then send this in email. Is there any possibility to put data like a['name'] or difference_dates or anything elese to the text of email? I think abou something like that:</p>\n\n<pre><code>system 'echo \"Your server a['name'] is not responding since difference_dates, fix it!\" |mailx -s \"Warning\" anything@anything.com' \n</code></pre>\n\n<p>is it possible and correct?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "grape", "grape-api"], "comments": [{"owner": {"reputation": 878, "user_id": 1371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e53a0b9b6d630e7201cfd8997aa14f?s=128&d=identicon&r=PG", "display_name": "Marlon", "link": "https://stackoverflow.com/users/1371320/marlon"}, "edited": false, "score": 1, "creation_date": 1467205752, "post_id": 38098329, "comment_id": 63635011, "body": "Be more specific. It&#39;s not clear what you really want to do. Do you want to handle multiple routes in a single method?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6324692"}, "reply_to_user": {"reputation": 878, "user_id": 1371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e53a0b9b6d630e7201cfd8997aa14f?s=128&d=identicon&r=PG", "display_name": "Marlon", "link": "https://stackoverflow.com/users/1371320/marlon"}, "edited": false, "score": 0, "creation_date": 1467207618, "post_id": 38098329, "comment_id": 63636494, "body": "@Marlon, I don&#39;t know how to explain that even more simple."}, {"owner": {"reputation": 878, "user_id": 1371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e53a0b9b6d630e7201cfd8997aa14f?s=128&d=identicon&r=PG", "display_name": "Marlon", "link": "https://stackoverflow.com/users/1371320/marlon"}, "edited": false, "score": 0, "creation_date": 1467208944, "post_id": 38098329, "comment_id": 63637697, "body": "Give us an example. Add in your question the code you&#39;ve written and that isn&#39;t working. Or add a code illustrating what you want to do."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6324692"}, "reply_to_user": {"reputation": 878, "user_id": 1371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e53a0b9b6d630e7201cfd8997aa14f?s=128&d=identicon&r=PG", "display_name": "Marlon", "link": "https://stackoverflow.com/users/1371320/marlon"}, "edited": false, "score": 0, "creation_date": 1467209270, "post_id": 38098329, "comment_id": 63637988, "body": "@Marlon, I don&#39;t think it&#39;s needed."}, {"owner": {"reputation": 878, "user_id": 1371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e53a0b9b6d630e7201cfd8997aa14f?s=128&d=identicon&r=PG", "display_name": "Marlon", "link": "https://stackoverflow.com/users/1371320/marlon"}, "edited": false, "score": 0, "creation_date": 1467209972, "post_id": 38098329, "comment_id": 63638557, "body": "Okay. It&#39;s up to you. The way you stated your question, I can&#39;t understand your needs, therefore I&#39;m unable to help you."}], "answers": [{"tags": [], "owner": {"reputation": 878, "user_id": 1371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e53a0b9b6d630e7201cfd8997aa14f?s=128&d=identicon&r=PG", "display_name": "Marlon", "link": "https://stackoverflow.com/users/1371320/marlon"}, "is_accepted": false, "score": 1, "last_activity_date": 1467294509, "creation_date": 1467294509, "answer_id": 38125073, "question_id": 38098329, "link": "https://stackoverflow.com/questions/38098329/a-route-for-grape-either-a-specific-string-or-an-of-array-of-string/38125073#38125073", "title": "A route for Grape: either a specific string or an of array of string", "body": "<p>A parameter must be declared only once in the <strong>params</strong> block. If you declare it twice then only one will be used by Grape. In your case, there're two options to solve your problem.</p>\n\n<p>First option: declare two parameters and define them as mutually exclusive. It means that the user will be able to inform only one of them.</p>\n\n<pre><code>params do\n  requires :status1, type: Symbol, values: [:status1]\n  requires :status2, type: Array[String]\n  mutually_exclusive :status1, :status2\nend\n</code></pre>\n\n<p>Second option: declare only one parameter and set its type to <strong>Object</strong>. In the method's body, check if it's an Array or a String. If it's a String, verify if it has the correct values.</p>\n\n<pre><code>params do\n  requires :status, type: Object\nend\nget 'testing' do\n    if params[:status].class.name.eql? \"Array\" then\n    elsif params[:status].class.name.eql? \"String\" then\n    end\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6324692"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467294509, "creation_date": 1467199948, "last_edit_date": 1467215503, "question_id": 38098329, "link": "https://stackoverflow.com/questions/38098329/a-route-for-grape-either-a-specific-string-or-an-of-array-of-string", "title": "A route for Grape: either a specific string or an of array of string", "body": "<p>I want to create a route for the Grape gem so that a route accepts either an array of strings or a single string with a specific pre-defined value. From the documentation it's not clear how to do that. </p>\n\n<p>Your suggestions? </p>\n\n<p>UPDATE:</p>\n\n<p>I want <code>status</code> to be passed either a single value <code>status1</code> or as a array where values can be arbitrary and unknown. I combine these? </p>\n\n<pre><code>params do\n  requires :status, type: Symbol, values: [:status1]\n  requires :status, type: Array[String]\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq", "capistrano3"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1467198911, "post_id": 38097910, "comment_id": 63630125, "body": "Rails console you run yourself, in an interactive shell? And sidekiq is launched at startup by a supervisor/init process? Most likely, it doesn&#39;t load that bashfile, because its session is not interactive. If you start sidekiq yourself, does it work then?"}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1467199668, "post_id": 38097910, "comment_id": 63630640, "body": "Use the files under config/initailizers as per your requirement or contants.rb can be referred to place and fetch the values"}], "owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467198738, "creation_date": 1467198738, "question_id": 38097910, "link": "https://stackoverflow.com/questions/38097910/access-environment-variables-in-production-rb-in-rails", "title": "Access Environment Variables in production.rb in rails", "body": "<p>I want to access the environment variables in production.rb , so I have created a .bashfile &amp; write the variable like export key = value.\nI am able to get those variables in rails console but sidekiq is not taking them for sending mails , I am using capistrano for deployment.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "edited": false, "score": 2, "creation_date": 1467197869, "post_id": 38097393, "comment_id": 63629467, "body": "What do you mean by <code>object with a name</code>? Using <code>send</code> you can send messages to objects, not create them. Also, objects do not have a name, then can have an attribute called <code>name</code> if you define it which you don&#39;t seem to do. Please give more details on what you&#39;re trying to achieve."}, {"owner": {"reputation": 1810, "user_id": 1301840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ad9bbcb458c0923c2946f85b6b98107b?s=128&d=identicon&r=PG&f=1", "display_name": "lusketeer", "link": "https://stackoverflow.com/users/1301840/lusketeer"}, "edited": false, "score": 2, "creation_date": 1467198184, "post_id": 38097393, "comment_id": 63629665, "body": "why do you wanna do this? if I understand you correctly, you want to be able to <a href=\"http://stackoverflow.com/questions/4963678/dynamically-set-local-variables-in-ruby\">dynamically set local variables</a>, but as the post suggested, using a hash should be good"}, {"owner": {"reputation": 123, "user_id": 2539864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5d2aa53f2931fcd8c317d7bae714fc?s=128&d=identicon&r=PG&f=1", "display_name": "KD100", "link": "https://stackoverflow.com/users/2539864/kd100"}, "edited": false, "score": 0, "creation_date": 1467198412, "post_id": 38097393, "comment_id": 63629812, "body": "in my actual code, I have an array of hashes. Each hash has a name and a list of keywords. I want to loop through the array of hashes, match the hash&#39;s keywords to strings in a larger text, then save the sentences of those matches to a new array with the hash&#39;s name."}, {"owner": {"reputation": 7389, "user_id": 2235594, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4MssP.jpg?s=128&g=1", "display_name": "davegson", "link": "https://stackoverflow.com/users/2235594/davegson"}, "edited": false, "score": 0, "creation_date": 1467198520, "post_id": 38097393, "comment_id": 63629877, "body": "what do you need the variables for? it makes no sense to dynamically set variables, since you are limited to hardcoding the rest. The hash seems to fit all your needs"}, {"owner": {"reputation": 7389, "user_id": 2235594, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4MssP.jpg?s=128&g=1", "display_name": "davegson", "link": "https://stackoverflow.com/users/2235594/davegson"}, "edited": false, "score": 0, "creation_date": 1467198618, "post_id": 38097393, "comment_id": 63629940, "body": "Based off your last comment, why not create a new hash with the keyword matches?"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1467198705, "post_id": 38097393, "comment_id": 63629988, "body": "What&#39;s wrong with <code>map</code>-ping the original array, getting an array in result?"}, {"owner": {"reputation": 123, "user_id": 2539864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5d2aa53f2931fcd8c317d7bae714fc?s=128&d=identicon&r=PG&f=1", "display_name": "KD100", "link": "https://stackoverflow.com/users/2539864/kd100"}, "edited": false, "score": 0, "creation_date": 1467201943, "post_id": 38097393, "comment_id": 63632310, "body": "Created a hash with the matches and works brilliantly! Thanks for y&#39;alls help"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 2539864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5d2aa53f2931fcd8c317d7bae714fc?s=128&d=identicon&r=PG&f=1", "display_name": "KD100", "link": "https://stackoverflow.com/users/2539864/kd100"}, "edited": false, "score": 0, "creation_date": 1467201867, "post_id": 38097977, "comment_id": 63632246, "body": "Yes! Created a hash and works perfectly now. Thanks a lot!"}], "tags": [], "owner": {"reputation": 106, "user_id": 3581152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jiajf.jpg?s=128&g=1", "display_name": "soundrussian", "link": "https://stackoverflow.com/users/3581152/soundrussian"}, "is_accepted": true, "score": 0, "last_activity_date": 1467198923, "creation_date": 1467198923, "answer_id": 38097977, "question_id": 38097393, "link": "https://stackoverflow.com/questions/38097393/ruby-how-to-access-object-created-by-send-without-name/38097977#38097977", "title": "Ruby: How to access object created by send without name?", "body": "<p>Why not create a <code>Hash</code> to keep the data you need?</p>\n\n\n\n<pre class=\"lang-rb prettyprint-override\"><code>array = [\"a\", \"b\", \"c\"]\ndata = {}\narray.each do |x|\n  key = x + '_data'\n  data[key] ||= []\n  data[key] &lt;&lt; \"foo\"\nend\n</code></pre>\n\n<p>Also, note <code>data[key] ||= []</code> trick. It means \"look into <code>data[key]</code>. If it is <code>nil</code>, initialize it with empty array\". It is idiomatic way to initialize something once.</p>\n\n<p>You can declare <code>data</code> as <code>Hash.new([])</code>. Then you won't need <code>data[key] ||= []</code> at all, because <code>Hash.new([])</code> will create a hash that returns an empty array if the value associated with the given key has not been set.</p>\n\n<p>This is much more flexible than using <a href=\"http://php.net/manual/en/language.variables.variable.php\" rel=\"nofollow\">variable variables from PHP</a></p>\n\n<p>But if you REALLY need something like this, you can do the following:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>array = [\"a\", \"b\", \"c\"]\narray.each do |x|\n  instance_variable_set '@' + x + '_data', []\n  instance_variable_get('@' + x + '_data') &lt;&lt; \"foo\"\nend\n\np @a_data # [\"foo\"]\n</code></pre>\n\n<p>Here we create an instance variable in the context of current object instance. Its name MUST begin with <code>@</code>.</p>\n"}], "owner": {"reputation": 123, "user_id": 2539864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5d2aa53f2931fcd8c317d7bae714fc?s=128&d=identicon&r=PG&f=1", "display_name": "KD100", "link": "https://stackoverflow.com/users/2539864/kd100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "closed_date": 1467200645, "accepted_answer_id": 38097977, "answer_count": 1, "score": -1, "last_activity_date": 1467199641, "creation_date": 1467197326, "last_edit_date": 1467199641, "question_id": 38097393, "link": "https://stackoverflow.com/questions/38097393/ruby-how-to-access-object-created-by-send-without-name", "closed_reason": "Duplicate", "title": "Ruby: How to access object created by send without name?", "body": "<p>What I'm trying to do in Ruby is to create an object with a name that comes from a string (in an array for instance). Then I want to use that object in further code.</p>\n\n<p>So, for example:</p>\n\n<pre><code>array = [\"a\", \"b\", \"c\"]\narray.each do |x|\n   send x + '_data'\n   x + '_data' = []\n   x + '_data' &lt;&lt; \"foo\"\nend\n</code></pre>\n\n<p>The above, of course, does not work.</p>\n\n<p>I've racked my brain, the docs, and SO all morning on this. Your help is appreciated!</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks! </p>\n\n<p>Cheers,\nKyle</p>\n\n<p><strong><em>EDIT for clarity:</em></strong></p>\n\n<p>Ok, my understanding of <code>send</code> was incorrect.</p>\n\n<p>For each string in the array, I want to create an array. </p>\n\n<p>So the loop above would create three arrays: <code>a_data</code>,<code>b_data</code>,<code>c_data</code></p>\n\n<p>Then, I want to populate each array with \"foo\".</p>\n\n<p>So <code>a_data[0] =&gt; \"foo\"</code></p>\n\n<p>Thanks!</p>\n\n<p><strong><em>Double edit:</em></strong></p>\n\n<p>Here's my slightly altered actual code with fuller explanation of what I'm doing:</p>\n\n<p>I have a big json file of thousands of tweets (not just the text, but the full json from twitter api).</p>\n\n<p>I then have an array of hashes based with topics and associated keywords -- e.g. \"cooking\" -> \"utensils\", \"oven\", \"microwave\".</p>\n\n<p>I want to loop through the array of topic hashes and see if any of the topic keywords match words in the tweet text. </p>\n\n<p>If there's a match, I want to add that tweet to a new array. </p>\n\n<pre><code># topics is an array of hashes. Each hash contains title and list of keywords    \n    topics.each do |topic|\n    # create an array with the topic's name to store matches\n          (topic[:title] + '_tweets') = []\n          topic[:keywords].each do |kw|\n            # loop through array of hashes (parsed json) to check for keyword matches in strings\n            tweets.each do |tweet|\n              text = tweet[\"text\"]\n# if string contains keyword, add to the topic's array\n              if text.include? kw\n               (topic[:title] + '_tweets') &lt;&lt; tweet\n              end\n            end\n          end\n</code></pre>\n\n<p>Thanks for y'all's help guys!</p>\n"}, {"tags": ["ruby", "postgresql", "sockets", "tcp", "sequel"], "answers": [{"comments": [{"owner": {"reputation": 1070, "user_id": 2963716, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/818579164/picture?type=large", "display_name": "Acacia", "link": "https://stackoverflow.com/users/2963716/acacia"}, "edited": false, "score": 0, "creation_date": 1467211794, "post_id": 38098404, "comment_id": 63639987, "body": "You were right about disconnect after the return statement. Thanks"}], "tags": [], "owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "is_accepted": true, "score": 1, "last_activity_date": 1467200131, "creation_date": 1467200131, "answer_id": 38098404, "question_id": 38097012, "link": "https://stackoverflow.com/questions/38097012/ruby-tcp-server-errorpgconnectionbad-fatal-remaining-connection-slots-are/38098404#38098404", "title": "Ruby TCP server - ERROR:PG::ConnectionBad: FATAL: remaining connection slots are reserved for non-replication superuser connections", "body": "<p>The idea to connect to DB every time you want to create a record is not the best approach. Think about changing it to some Connection Pool.</p>\n\n<p>But if you still want to connect every time, try to use the block form of connect, which will assure connection is closed after block finishes.</p>\n\n<p>Also there was no close/disconnect in your code, maybe you put it after <code>return</code> call (which means it was not executed)</p>\n\n<p>Try something like this:</p>\n\n<pre><code>response = nil\nSequel.connect('postgres://xxxxx:xxxxxxxxxx@127.0.0.1:xxxxx/xxxxxxxxx',:max_connections =&gt; 100) do |conn| # requires pg\n  transactions = conn.from(:transactions)\n  if transactions.insert(serial_number: card_serial, balance_before: balance_before, amount: transaction_amount, balance_after: balance_after, transaction_time: time, terminal_number: terminal_number, terminal_type: terminal_type, created_at: Time.now, updated_at: Time.now)\n    response = {message: \"TT01000080\", status: \"SUCCESS\" }\n  else\n    response = {message: \"\", status: \"FAILED\" }\n  end\nend\nreturn response\n</code></pre>\n"}], "owner": {"reputation": 1070, "user_id": 2963716, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/818579164/picture?type=large", "display_name": "Acacia", "link": "https://stackoverflow.com/users/2963716/acacia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 38098404, "answer_count": 1, "score": 1, "last_activity_date": 1467200131, "creation_date": 1467196315, "question_id": 38097012, "link": "https://stackoverflow.com/questions/38097012/ruby-tcp-server-errorpgconnectionbad-fatal-remaining-connection-slots-are", "title": "Ruby TCP server - ERROR:PG::ConnectionBad: FATAL: remaining connection slots are reserved for non-replication superuser connections", "body": "<p>I have written a tcp server that receives packets from a terminal device. The TCP server interprets the data and saves it in the database using postgres.</p>\n\n<p>The tcp server is multi-threaded. A sample of the code of the moment i open the db connection and save data looks like this;</p>\n\n<pre><code>conn = Sequel.connect('postgres://xxxxx:xxxxxxxxxx@127.0.0.1:xxxxx/xxxxxxxxx',:max_connections =&gt; 100) # requires pg\ntransactions = conn.from(:transactions)\nif transactions.insert(serial_number: card_serial, balance_before: balance_before, amount: transaction_amount, balance_after: balance_after, transaction_time: time, terminal_number: terminal_number, terminal_type: terminal_type, created_at: Time.now, updated_at: Time.now)\n  response = {message: \"TT01000080\", status: \"SUCCESS\" }\n  return response\nelse\n  response = {message: \"\", status: \"FAILED\" }\n  return response\nend\n</code></pre>\n\n<p>After a few packets, the db creates an error like this;\n<strong><em><code>ERROR:PG::ConnectionBad: FATAL:  remaining connection slots are reserved for non-replication superuser connections</code></em></strong></p>\n\n<p>Even adding the line <strong><code>conn.disconnect</code></strong> does not help the issue.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "is_accepted": false, "score": 1, "last_activity_date": 1467196758, "last_edit_date": 1467196758, "creation_date": 1467196354, "answer_id": 38097026, "question_id": 38096835, "link": "https://stackoverflow.com/questions/38096835/how-to-copy-move-files-from-ubuntu-to-windows-machine-using-ruby/38097026#38097026", "title": "How to copy/move files from ubuntu to windows machine using ruby", "body": "<p>If you dont have any third-party server software installed on your Windows machine, your best bet is samba. You can pre-setup the samba shares on your windows machine, connect to them from ubuntu and then use them from your ruby code as they would be local files and directories.</p>\n\n<pre><code>FileUtils.cp 'eval.c', 'eval.c.org'\n</code></pre>\n\n<p><a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/fileutils/rdoc/FileUtils.html#method-c-copy\" rel=\"nofollow\">Example from Ruby docs</a>.</p>\n\n<p>If you want to manage samba connections from ruby, one gem that might help is <a href=\"https://github.com/johnae/sambal\" rel=\"nofollow\">sambal</a>.</p>\n\n<p>If you are willing to install software to your Windows machine, follow the advice of @Mark and install WinSCP. This will bring much more secured transport which you will be able to use with a little help of <a href=\"https://github.com/net-ssh/net-scp\" rel=\"nofollow\">net-scp gem</a>.</p>\n\n<pre><code>Net::SCP.upload!(\"remote.host.com\", \"username\",\n  \"/local/path\", \"/remote/path\",\n  :ssh =&gt; { :password =&gt; \"password\" })\n\n# download a file from a remote server\nNet::SCP.download!(\"remote.host.com\", \"username\",\n  \"/remote/path\", \"/local/path\",\n  :ssh =&gt; { :password =&gt; \"password\" })\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 6526444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d92b3d248a47d89a468b12827e610eb?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/6526444/mark"}, "is_accepted": false, "score": 2, "last_activity_date": 1467196363, "last_edit_date": 1592644375, "creation_date": 1467196363, "answer_id": 38097031, "question_id": 38096835, "link": "https://stackoverflow.com/questions/38096835/how-to-copy-move-files-from-ubuntu-to-windows-machine-using-ruby/38097031#38097031", "title": "How to copy/move files from ubuntu to windows machine using ruby", "body": "<p>I would suggest that you get an application called <a href=\"https://winscp.net/eng/index.php\" rel=\"nofollow noreferrer\">WinSCP</a> installed on your Windows server. This is free and very easy to use.</p>\n<p>It is like an FTP application, using your Linux username and password (along with the SSH port). This way, all future copies between these OS'es will be easy.</p>\n"}], "owner": {"reputation": 476, "user_id": 3265018, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/44fdc79b5bd971ee83c566ddcaba9bf2?s=128&d=identicon&r=PG&f=1", "display_name": "VDN", "link": "https://stackoverflow.com/users/3265018/vdn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "closed_date": 1467203231, "answer_count": 2, "score": 0, "last_activity_date": 1467196758, "creation_date": 1467195801, "question_id": 38096835, "link": "https://stackoverflow.com/questions/38096835/how-to-copy-move-files-from-ubuntu-to-windows-machine-using-ruby", "closed_reason": "Not suitable for this site", "title": "How to copy/move files from ubuntu to windows machine using ruby", "body": "<p>I have one requirement copy/move the files from ubuntu machine to windows machine.</p>\n\n<p>Can anybody assist on this?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6459473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/35623b62c00b337f23a93ba6af8c65c0?s=128&d=identicon&r=PG&f=1", "display_name": "peterateftawfik", "link": "https://stackoverflow.com/users/6459473/peterateftawfik"}, "edited": false, "score": 0, "creation_date": 1467207558, "post_id": 38096903, "comment_id": 63636442, "body": "the problem now that it insert a new row in the cars table and then add it to the join table, but what i need is to select a car and select a list and just add the two ids in the join table"}, {"owner": {"reputation": 1364, "user_id": 5737512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nfjfF.jpg?s=128&g=1", "display_name": "Kaushlendra Tomar", "link": "https://stackoverflow.com/users/5737512/kaushlendra-tomar"}, "reply_to_user": {"reputation": 49, "user_id": 6459473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/35623b62c00b337f23a93ba6af8c65c0?s=128&d=identicon&r=PG&f=1", "display_name": "peterateftawfik", "link": "https://stackoverflow.com/users/6459473/peterateftawfik"}, "edited": false, "score": 0, "creation_date": 1467210684, "post_id": 38096903, "comment_id": 63639101, "body": "first you find car with help of car id and then find the list with the help of list id then assign val like this"}], "tags": [], "owner": {"reputation": 1364, "user_id": 5737512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nfjfF.jpg?s=128&g=1", "display_name": "Kaushlendra Tomar", "link": "https://stackoverflow.com/users/5737512/kaushlendra-tomar"}, "is_accepted": false, "score": 0, "last_activity_date": 1467195993, "creation_date": 1467195993, "answer_id": 38096903, "question_id": 38096635, "link": "https://stackoverflow.com/questions/38096635/how-can-i-insert-data-into-a-join-table-with-a-many-to-many-relation-using-a-rai/38096903#38096903", "title": "How can I Insert Data Into a Join Table with a Many to Many Relation Using a Rails Controller Page", "body": "<p>You should use this in your cad controller:</p>\n\n<pre><code>lists = List.where(id:params[:lists])\n@cars.assign_attributes({lists: lists})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 4971103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf76690a111e3ff1123de7336f63e715?s=128&d=identicon&r=PG", "display_name": "Will Sheehan", "link": "https://stackoverflow.com/users/4971103/will-sheehan"}, "is_accepted": false, "score": 1, "last_activity_date": 1467204162, "creation_date": 1467204162, "answer_id": 38099917, "question_id": 38096635, "link": "https://stackoverflow.com/questions/38096635/how-can-i-insert-data-into-a-join-table-with-a-many-to-many-relation-using-a-rai/38099917#38099917", "title": "How can I Insert Data Into a Join Table with a Many to Many Relation Using a Rails Controller Page", "body": "<p>With any has_many relationship you can add a record with &lt;&lt;</p>\n\n<pre><code>@car.lists &lt;&lt; @list\n@list.cars &lt;&lt; @car\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6459473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/35623b62c00b337f23a93ba6af8c65c0?s=128&d=identicon&r=PG&f=1", "display_name": "peterateftawfik", "link": "https://stackoverflow.com/users/6459473/peterateftawfik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467204605, "creation_date": 1467195244, "last_edit_date": 1467204605, "question_id": 38096635, "link": "https://stackoverflow.com/questions/38096635/how-can-i-insert-data-into-a-join-table-with-a-many-to-many-relation-using-a-rai", "title": "How can I Insert Data Into a Join Table with a Many to Many Relation Using a Rails Controller Page", "body": "<p>Given: 2 Tables, Lists, and Cars, which have many to many relations.</p>\n\n<p>I want to append it with data from console. Finding and reading it from the browser works, but how can I add and append through the rails controller page?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "searchkick"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 6142020, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207910851551970/picture?type=large", "display_name": "Dimitris Saltaferis", "link": "https://stackoverflow.com/users/6142020/dimitris-saltaferis"}, "is_accepted": false, "score": 1, "last_activity_date": 1472032697, "creation_date": 1472032697, "answer_id": 39120080, "question_id": 38096589, "link": "https://stackoverflow.com/questions/38096589/elasticsearch-searchkick-multiple-aggs-with-options-in-same-query/39120080#39120080", "title": "ElasticSearch SearchKick multiple aggs with options in same query", "body": "<p>For those that are looking for the answer:</p>\n\n<blockquote>\n  <p>you can do:</p>\n  \n  <p><code>products = Product.search \"chuck taylor\", aggs: \n                {product_type: {}, size: {where: {color: \"brandy\"}}}</code></p>\n</blockquote>\n\n<p><a href=\"https://github.com/ankane/searchkick/issues/689\" rel=\"nofollow\">https://github.com/ankane/searchkick/issues/689</a></p>\n"}], "owner": {"reputation": 2195, "user_id": 1051849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/34e899fe8264a48cd991fccb24c06bf3?s=128&d=identicon&r=PG&f=1", "display_name": "user1051849", "link": "https://stackoverflow.com/users/1051849/user1051849"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 687, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1472032697, "creation_date": 1467195116, "question_id": 38096589, "link": "https://stackoverflow.com/questions/38096589/elasticsearch-searchkick-multiple-aggs-with-options-in-same-query", "title": "ElasticSearch SearchKick multiple aggs with options in same query", "body": "<p>In the SearchKick documentation there a two ways/styles of requesting Aggs that are mentioned.</p>\n\n<p>For simple (multiple) Agg requests:</p>\n\n<pre><code>products = Product.search \"chuck taylor\", aggs: [:product_type, :gender, :brand]\n</code></pre>\n\n<p>And for Agg requests with options:</p>\n\n<pre><code>Product.search \"wingtips\", aggs: {size: {where: {color: \"brandy\"}}}\n</code></pre>\n\n<p>My question is - how do we go about declaring multiple aggs with options? We've tried various combinations of the two without success... </p>\n\n<p>For example - this doesn't work...</p>\n\n<pre><code>products = Product.search \"chuck taylor\", aggs: [:product_type, {size: {where: {color: \"brandy\"}}}]\n</code></pre>\n\n<p>Is it a ruby formatting problem? or is it a limitation in the gem?</p>\n\n<p>Thanks guys!</p>\n"}, {"tags": ["ruby", "faraday"], "owner": {"reputation": 3308, "user_id": 20962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/045605bea15f3745e8aa97de3b238b94?s=128&d=identicon&r=PG", "display_name": "Nicolai", "link": "https://stackoverflow.com/users/20962/nicolai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1523968140, "creation_date": 1467194979, "question_id": 38096535, "link": "https://stackoverflow.com/questions/38096535/why-cant-i-change-the-session-timeout-for-patron-when-using-faraday-in-ruby", "title": "Why cant I change the session timeout for Patron when using Faraday in Ruby?", "body": "<p>I am trying to change the connection timeouts for HTTP requests done with Faraday using Patron as the adapter.</p>\n\n<p>I try to change the timeout using the default_connections_options in my program as follows:</p>\n\n<pre><code>Faraday.default_connection_options.request.timeout = 10\n</code></pre>\n\n<p>The problem is that I still experience 5000 ms (Patron default) timeouts when making requests. </p>\n\n<pre><code>/Users/finihoge/.rvm/gems/ruby-1.9.3-p374/gems/patron-0.6.5/lib/patron/session.rb:321:in `handle_request': Operation timed out after 5003 milliseconds with 0 bytes received (Faraday::TimeoutError)\nfrom /Users/finihoge/.rvm/gems/ruby-1.9.3-p374/gems/patron-0.6.5/lib/patron/session.rb:321:in `request'\nfrom /Users/finihoge/.rvm/gems/ruby-1.9.3-p374/gems/faraday-0.9.2/lib/faraday/adapter/patron.rb:33:in `call'\nfrom /Users/finihoge/.rvm/gems/ruby-1.9.3-p374/gems/faraday-0.9.2/lib/faraday/request/url_encoded.rb:15:in `call'\nfrom /Users/finihoge/.rvm/gems/ruby-1.9.3-p374/gems/faraday-0.9.2/lib/faraday/rack_builder.rb:139:in `build_response'\nfrom /Users/finihoge/.rvm/gems/ruby-1.9.3-p374/gems/faraday-0.9.2/lib/faraday/connection.rb:377:in `run_request'\nfrom /Users/finihoge/.rvm/gems/ruby-1.9.3-p374/gems/faraday-0.9.2/lib/faraday/connection.rb:140:in `get'\n</code></pre>\n\n<p>Does anyone know what I am doing wrong, or how I can change the default session timeouts in Patron when I am using it as an adapter in Faraday?</p>\n"}, {"tags": ["ruby", "rubygems", "odbc", "dbd"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1467196184, "post_id": 38096206, "comment_id": 63628391, "body": "There is no such thing as <code>dbd&#47;odbc</code>? Where did you find documentation that you need to do that? It&#39;s a driver for the DBI library as far as I understand. You don&#39;t require it. It loads when you <code>connect</code> with DBI."}, {"owner": {"reputation": 13, "user_id": 3102411, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/422f27499ccc830fdff047d83e240c83?s=128&d=identicon&r=PG&f=1", "display_name": "tamtam", "link": "https://stackoverflow.com/users/3102411/tamtam"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1467196559, "post_id": 38096206, "comment_id": 63628611, "body": "I&#39;ve installed a gem named dbd-odbc so there is."}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1467206408, "post_id": 38096206, "comment_id": 63635478, "body": "Yes the gem is named dbd-odbc, but it only installs it as a driver for DBI. You don&#39;t need to <code>require</code> it. Ruby loads it when you <code>DBI.connect</code>. See here for example: <a href=\"http://anthonylewis.com/2011/03/08/exploring-odbc-with-ruby-dbi/\" rel=\"nofollow noreferrer\">anthonylewis.com/2011/03/08/exploring-odbc-with-ruby-dbi</a>"}], "owner": {"reputation": 13, "user_id": 3102411, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/422f27499ccc830fdff047d83e240c83?s=128&d=identicon&r=PG&f=1", "display_name": "tamtam", "link": "https://stackoverflow.com/users/3102411/tamtam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467194160, "creation_date": 1467194160, "question_id": 38096206, "link": "https://stackoverflow.com/questions/38096206/dbd-odbc-ruby-gem-require-cannot-require", "title": "dbd-ODBC ruby gem require cannot require", "body": "<p>I have a script in Ruby, it's simple just for checking do the requires work. I've got a problem with one gem: dbd/ODBC. When I run the script I get error message. Version of Ruby is 2.3.\nHere is the script:</p>\n\n<pre><code>begin\n\nrequire \"dbi\"\nrequire 'dbd/ODBC'\n\n  puts 'This will run.'\nrescue LoadError =&gt; e\n  puts \"This will not run #{e.backtrace.inspect}\"\n\nend\n</code></pre>\n\n<p>Here is the output with the error:</p>\n\n<p>This will not run [\"C:/Ruby23-x64/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/ker\nnel_require.rb:55:in <code>require'\", \"C:/Ruby23-x64/lib/ruby/site_ruby/2.3.0/rubygem\ns/core_ext/kernel_require.rb:55:in</code>require'\", \"C:/Ruby23-x64/lib/ruby/gems/2.3.\n0/gems/dbd-odbc-0.2.5/lib/dbd/ODBC.rb:34:in <code>&lt;top (required)&gt;'\", \"C:/Ruby23-x64/\nlib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:133:in</code>require'\",\n\"C:/Ruby23-x64/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:133:\nin <code>rescue in require'\", \"C:/Ruby23-x64/lib/ruby/site_ruby/2.3.0/rubygems/core_e\nxt/kernel_require.rb:40:in</code>require'\", \"D:/MyDoc/Scripts/check.rb:7:in `'\"]</p>\n\n<p>I have tried with require_relative and I have installed the gem. </p>\n"}, {"tags": ["ruby", "selenium", "capybara"], "comments": [{"owner": {"reputation": 46893, "user_id": 4549554, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/Vxi1i.jpg?s=128&g=1", "display_name": "Andersson", "link": "https://stackoverflow.com/users/4549554/andersson"}, "edited": false, "score": 0, "creation_date": 1467198625, "post_id": 38095934, "comment_id": 63629944, "body": "what exception do you get?"}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 1, "creation_date": 1467206472, "post_id": 38095934, "comment_id": 63635522, "body": "Selenium is designed to NOT interact with hidden elements since users can&#39;t do the same. Why is the element hidden? How would a user get access to this element? Follow what a user would do to unhide the element and interact with it."}, {"owner": {"reputation": 666, "user_id": 896262, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/6kr03.png?s=128&g=1", "display_name": "Rahul Vig", "link": "https://stackoverflow.com/users/896262/rahul-vig"}, "edited": false, "score": 0, "creation_date": 1487430637, "post_id": 38095934, "comment_id": 71787027, "body": "Did you try using - page.execute_script(&#39;$(&lt;element&gt;).click()&#39;)"}], "owner": {"reputation": 3, "user_id": 6279668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1e6a899bbe5263cd60a6701811c762e?s=128&d=identicon&r=PG&f=1", "display_name": "Nammy", "link": "https://stackoverflow.com/users/6279668/nammy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467200836, "creation_date": 1467193485, "last_edit_date": 1467200836, "question_id": 38095934, "link": "https://stackoverflow.com/questions/38095934/how-to-select-the-hidden-radio-button-using-ruby-capybara", "title": "How to select the hidden radio button using ruby capybara", "body": "<pre><code>&lt;tr&gt;\n&lt;td&gt;\n    &lt;div align=\"right\"&gt;\n        &lt;font size=\"2\" face=\"Arial, Helvetica, sans-serif\" color=\"red\"/&gt;\n        &lt;font size=\"2\" face=\"Arial, Helvetica, sans-serif\" color=\"#004891\"&gt;Material type :&lt;/font&gt;\n    &lt;/div&gt;\n&lt;/td&gt;\n&lt;td&gt;\n    &lt;input type=\"radio\" onclick=\"radioInsert='01'\" name=\"rdInsertType\"/&gt;\n    &lt;font size=\"2\" face=\"Arial, Helvetica, sans-serif\" color=\"#004891\"&gt;\n        Promotion                                                                                                                \n        &lt;input type=\"radio\" onclick=\"radioInsert='02'\" name=\"rdInsertType\"/&gt;\n        Important Notice  \n    &lt;/font&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>\n</p>\n\n<p>I have tried the following code : </p>\n\n<pre><code>Capybara.ignore_hidden_elements = false\n\nsession.find(:xpath, \".//*[@name = rdInsertType]\", :match =&gt; :first).click\n</code></pre>\n\n<p>and </p>\n\n<pre><code>session.execute_script(\"('input').show()\")\n\nsession.choose('Promotion', visible: false) \n</code></pre>\n\n<p>but no use. Any suggestion is highly appreciated.\nThanks in Advance</p>\n"}, {"tags": ["ruby", "redirect", "get", "mechanize"], "comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1467233270, "post_id": 38095619, "comment_id": 63653030, "body": "Are you running a proxy on localhost:3000? Fiddler and Charles both use 8888 by default and that&#39;s a good way to see your requests."}], "answers": [{"tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": false, "score": 0, "last_activity_date": 1467197595, "creation_date": 1467197595, "answer_id": 38097497, "question_id": 38095619, "link": "https://stackoverflow.com/questions/38095619/can-we-see-the-request-being-sent-with-mechanise-gem/38097497#38097497", "title": "Can we see the request being sent with mechanise gem?", "body": "<blockquote>\n  <p>If I do not set the redirection limit , I get connection refused:\n  localhost:3000 (Net::HTTP::Persistent::Error)</p>\n</blockquote>\n\n<p>I can duplicate that error if there is no server listening on the port specified in the ruby program.  To cure that error, you need to start a server that listens on port 3000, e.g. <a href=\"http://nc110.sourceforge.net\" rel=\"nofollow\">netcat</a>.</p>\n\n<p>Here's a simple netcat command:</p>\n\n<pre><code>$ nc -l 3000\n</code></pre>\n\n<p>That tells netcat(nc) to listen(-l) on port 3000.  Then if I run the following ruby program in another terminal window:</p>\n\n<pre><code>require 'mechanize'\n\nagent = Mechanize.new\n\ncookie = Mechanize::Cookie.new(\"hello\", \"world\")\ncookie.domain = \"localhost\"\ncookie.path = \"/\"\nagent.cookie_jar.add(cookie)\n\nagent.request_headers = {'Content-Type' =&gt; \"application/json\"}\n\npage = agent.get(\"http://localhost:3000/get_page\")\n</code></pre>\n\n<p>The netcat window displays:</p>\n\n<pre><code>GET /get_page HTTP/1.1\nAccept-Encoding: gzip,deflate,identity\nAccept: */*\nUser-Agent: Mechanize/2.7.4 Ruby/2.3.0p0 (http://github.com/sparklemotion/mechanize/)\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nAccept-Language: en-us,en;q=0.5\nCookie: hello=world\nHost: localhost:3000\nContent-Type: application/json\nConnection: keep-alive\nKeep-Alive: 300\n</code></pre>\n\n<p>There are lots of netcat recipes for doing all kinds of things on google.</p>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "is_accepted": false, "score": 6, "last_activity_date": 1467198655, "creation_date": 1467198655, "answer_id": 38097876, "question_id": 38095619, "link": "https://stackoverflow.com/questions/38095619/can-we-see-the-request-being-sent-with-mechanise-gem/38097876#38097876", "title": "Can we see the request being sent with mechanise gem?", "body": "<p>Just setup logger for agent to get the request/response debug.</p>\n\n<pre><code>require 'mechanize'\nrequire 'logger'\n\nagent = Mechanize.new\nagent.log = Logger.new(STDERR)\nagent.get('http://google.com/')\n</code></pre>\n\n<p>running this code will produce:</p>\n\n<pre>\n\n$ bundle exec ruby ./mech.rb\nI, [2016-06-29T13:14:07.019088 #26165]  INFO -- : Net::HTTP::Get: /\nD, [2016-06-29T13:14:07.019211 #26165] DEBUG -- : request-header: accept-encoding => gzip,deflate,identity\nD, [2016-06-29T13:14:07.019247 #26165] DEBUG -- : request-header: accept => */*\nD, [2016-06-29T13:14:07.019281 #26165] DEBUG -- : request-header: user-agent => Mechanize/2.7.4 Ruby/2.1.5p273 (http://github.com/sparklemotion/mechanize/)\nD, [2016-06-29T13:14:07.019324 #26165] DEBUG -- : request-header: accept-charset => ISO-8859-1,utf-8;q=0.7,*;q=0.7\nD, [2016-06-29T13:14:07.019365 #26165] DEBUG -- : request-header: accept-language => en-us,en;q=0.5\nD, [2016-06-29T13:14:07.019399 #26165] DEBUG -- : request-header: host => google.com\nI, [2016-06-29T13:14:07.056163 #26165]  INFO -- : status: Net::HTTPMovedPermanently 1.1 301 Moved Permanently\nD, [2016-06-29T13:14:07.056255 #26165] DEBUG -- : response-header: location => http://www.google.com/\nD, [2016-06-29T13:14:07.056289 #26165] DEBUG -- : response-header: content-type => text/html; charset=UTF-8\nD, [2016-06-29T13:14:07.056320 #26165] DEBUG -- : response-header: date => Wed, 29 Jun 2016 11:14:07 GMT\nD, [2016-06-29T13:14:07.056352 #26165] DEBUG -- : response-header: expires => Fri, 29 Jul 2016 11:14:07 GMT\nD, [2016-06-29T13:14:07.056386 #26165] DEBUG -- : response-header: cache-control => public, max-age=2592000\nD, [2016-06-29T13:14:07.056456 #26165] DEBUG -- : response-header: server => gws\nD, [2016-06-29T13:14:07.056505 #26165] DEBUG -- : response-header: content-length => 219\nD, [2016-06-29T13:14:07.056536 #26165] DEBUG -- : response-header: x-xss-protection => 1; mode=block\nD, [2016-06-29T13:14:07.056568 #26165] DEBUG -- : response-header: x-frame-options => SAMEORIGIN\nD, [2016-06-29T13:14:07.056706 #26165] DEBUG -- : Read 219 bytes (219 total)\nI, [2016-06-29T13:14:07.057585 #26165]  INFO -- : follow redirect to: http://www.google.com/\nI, [2016-06-29T13:14:07.058406 #26165]  INFO -- : Net::HTTP::Get: /\nD, [2016-06-29T13:14:07.058454 #26165] DEBUG -- : request-header: accept-encoding => gzip,deflate,identity\nD, [2016-06-29T13:14:07.058483 #26165] DEBUG -- : request-header: accept => */*\nD, [2016-06-29T13:14:07.058511 #26165] DEBUG -- : request-header: user-agent => Mechanize/2.7.4 Ruby/2.1.5p273 (http://github.com/sparklemotion/mechanize/)\nD, [2016-06-29T13:14:07.058540 #26165] DEBUG -- : request-header: accept-charset => ISO-8859-1,utf-8;q=0.7,*;q=0.7\n...\n</pre>\n"}], "owner": {"reputation": 1245, "user_id": 2243534, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8yiGS.jpg?s=128&g=1", "display_name": "Aks..", "link": "https://stackoverflow.com/users/2243534/aks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1528, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1467198655, "creation_date": 1467192632, "question_id": 38095619, "link": "https://stackoverflow.com/questions/38095619/can-we-see-the-request-being-sent-with-mechanise-gem", "title": "Can we see the request being sent with mechanise gem?", "body": "<p>I am trying to build a GET request with mechanize gem and I keep getting a redirects error. Firstly I want to know if there's a way of seeing the actual request being sent after its built with different params?</p>\n\n<pre><code>@agent.verify_mode = OpenSSL::SSL::VERIFY_NONE\ncookie = Mechanize::Cookie.new('xyz_session', @tokenid)\ncookie.domain = \".mydomain.com\"\ncookie.path = \"/\"\n@agent.cookie_jar &lt;&lt; cookie\n@agent.redirection_limit=0\nputs @agent.cookies\nbody = {}.to_json\n#@agent.set_proxy(\"localhost\",3000)\n@agent.request_headers = {'Content-Type' =&gt; \"application/json\"}\n       @agent.get(\"https://access.test.api.mydomain.com/oidc/v1/user/authorise?response_type=code&amp;redirect_uri=http://localhost&amp;client_id=testclient1&amp;service=AccountSignInService&amp;state=any-state\") \n       expect(response.code).to eql(302), \"Authorization Code couldn't be received\"\n</code></pre>\n\n<p>I keep getting <code>Redirect limit of 0 reached (Mechanize::RedirectLimitReachedError)</code></p>\n\n<p>If I do not set the redirection limit , I get <code>connection refused: localhost:3000 (Net::HTTP::Persistent::Error)</code></p>\n\n<p>Hence I want to first check if my request is being sent the way I want it to be...</p>\n"}, {"tags": ["ruby", "xml", "xpath", "nokogiri", "mechanize"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1467192103, "post_id": 38095176, "comment_id": 63625542, "body": "<code>doc.at(&#39;Search&#47;Locations&#39;)</code> and <code>doc.at(&#39;Duration&#39;)</code> both work for me. What exactly you fail to retrieve with <code>at</code>?"}, {"owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1467194750, "post_id": 38095176, "comment_id": 63627444, "body": "Interesting... I&#39;m searching &quot;//Duration&quot; and getting nothing.. but you&#39;re correct &quot;Duration&quot; works."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1467233945, "post_id": 38095176, "comment_id": 63653385, "body": "Are you using Mechanize to parse XML? It&#39;s designed to work with HTML, if you are, just use Nokogiri by itself. Also, please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. We need the smallest example of the XML input that demonstrates the problem, plus your minimum code that demonstrates the problem and your expected output."}, {"owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "edited": false, "score": 0, "creation_date": 1467299614, "post_id": 38095176, "comment_id": 63685485, "body": "Yes, I&#39;m using mechanize to parse XML. I&#39;m also using it to parse HTML where the structures and the outputs are similar. I could of course write a completely separate process for XML but it seemed that the two should have been straightforward enough. As it happens I found a solution that didn&#39;t require a ton of duplicated code and utilised Mechanize for both."}], "answers": [{"tags": [], "owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "is_accepted": true, "score": 0, "last_activity_date": 1467195833, "creation_date": 1467195833, "answer_id": 38096842, "question_id": 38095176, "link": "https://stackoverflow.com/questions/38095176/mechanize-nokogiri-failing-to-parse-xml-with-xpath/38096842#38096842", "title": "Mechanize / Nokogiri failing to parse XML with xpath", "body": "<p>Seems like running </p>\n\n<pre><code>xml.remove_namespaces!\n</code></pre>\n\n<p>fixes the issue and allows search of the document using // style xpath variables. </p>\n\n<p>I suspect there's a better solution than that out there. </p>\n"}, {"comments": [{"owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "edited": false, "score": 0, "creation_date": 1467887028, "post_id": 38193791, "comment_id": 63907058, "body": "Unfortunately I&#39;m doing things that are a little more complicated than css can deal with (the above is just a simplified example)."}], "tags": [], "owner": {"reputation": 1, "user_id": 1366485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35058ceddfe2e1f597f3bc0024b77774?s=128&d=identicon&r=PG", "display_name": "Andrew Long", "link": "https://stackoverflow.com/users/1366485/andrew-long"}, "is_accepted": false, "score": 0, "last_activity_date": 1467679712, "creation_date": 1467679712, "answer_id": 38193791, "question_id": 38095176, "link": "https://stackoverflow.com/questions/38095176/mechanize-nokogiri-failing-to-parse-xml-with-xpath/38193791#38193791", "title": "Mechanize / Nokogiri failing to parse XML with xpath", "body": "<p>I personally prefer the .css option:</p>\n\n<pre><code>xml.css(\"Duration\")\n</code></pre>\n\n<p>One could also use:</p>\n\n<pre><code>xml.at_css(\"Duration\")\n</code></pre>\n\n<p>More information can be found here: <a href=\"http://www.nokogiri.org/tutorials/searching_a_xml_html_document.html\" rel=\"nofollow\">http://www.nokogiri.org/tutorials/searching_a_xml_html_document.html</a></p>\n"}], "owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 38096842, "answer_count": 2, "score": 0, "last_activity_date": 1467679712, "creation_date": 1467191632, "last_edit_date": 1467194782, "question_id": 38095176, "link": "https://stackoverflow.com/questions/38095176/mechanize-nokogiri-failing-to-parse-xml-with-xpath", "title": "Mechanize / Nokogiri failing to parse XML with xpath", "body": "<p>I receive an xml file from an API. \nI'm trying to parse it with Mechanize which receives it as an XML file. \nUnderlying that is Nokogiri. \nWhatever I do I can't seem to get it to return anything with any xpath variables. \nIt seems to recognise the xml file fine i.e it comes in as Mechanize::XmlFile and shows the elements if I use Nokogiri.</p>\n\n<p>I can run. </p>\n\n<pre><code>xml.at(\"/\")\n</code></pre>\n\n<p>and get a response, but any other .at or .search I run returns nil.\ne.g.</p>\n\n<pre><code>xml.at(\"//Duration\")\n</code></pre>\n\n<p>An example response is below. </p>\n\n<pre><code>@body =\n\"&lt;JobSearchResults xmlns:i=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns=\\\"http://schemas.aspiremediagroup.net/jobboard/1.0/Beta\\\"&gt;&lt;Duration&gt;P0DT0H0M0.328S&lt;/Duration&gt;&lt;JobCount&gt;0&lt;/JobCount&gt;&lt;JobIDs /&gt;&lt;Jobs /&gt;&lt;PageCount&gt;0&lt;/PageCount&gt;&lt;PageNo&gt;0&lt;/PageNo&gt;&lt;PageSize&gt;20&lt;/PageSize&gt;&lt;ProximityStats i:nil=\\\"true\\\" /&gt;&lt;RoleSuggestions&gt;&lt;String&gt;ADDING&lt;/String&gt;&lt;/RoleSuggestions&gt;&lt;Search&gt;&lt;AccountGroupIDs i:nil=\\\"true\\\" /&gt;&lt;AccountIDs i:nil=\\\"true\\\" /&gt;&lt;ExcludeUnknownSalaries&gt;false&lt;/ExcludeUnknownSalaries&gt;&lt;Industries i:nil=\\\"true\\\" /&gt;&lt;JobIDsOnly&gt;false&lt;/JobIDsOnly&gt;&lt;JobTypes&gt;&lt;ID&gt;Any&lt;/ID&gt;&lt;/JobTypes&gt;&lt;Locations&gt;&lt;Location&gt;&lt;Country&gt;GBR&lt;/Country&gt;&lt;ID i:nil=\\\"true\\\" /&gt;&lt;Latitude i:nil=\\\"true\\\" /&gt;&lt;Longitude i:nil=\\\"true\\\" /&gt;&lt;ParentLocation i:nil=\\\"true\\\" /&gt;&lt;Text i:nil=\\\"true\\\" /&gt;&lt;/Location&gt;&lt;/Locations&gt;&lt;MaxAge i:nil=\\\"true\\\" /&gt;&lt;MaxDistance&gt;25&lt;/MaxDistance&gt;&lt;Page&gt;1&lt;/Page&gt;&lt;PageSize&gt;20&lt;/PageSize&gt;&lt;Role&gt;adgqeg&lt;/Role&gt;&lt;Salaries i:nil=\\\"true\\\" /&gt;&lt;Skills i:nil=\\\"true\\\" /&gt;&lt;SortOrder&gt;OVERALL_SCORE_DESC&lt;/SortOrder&gt;&lt;/Search&gt;&lt;SkillsSuggestions&gt;&lt;String i:nil=\\\"true\\\" /&gt;&lt;/SkillsSuggestions&gt;&lt;Started&gt;2016-06-29T08:53:18.2215898Z&lt;/Started&gt;&lt;ThisPageSize&gt;0&lt;/ThisPageSize&gt;&lt;/JobSearchResults&gt;\"\n</code></pre>\n\n<p>Any ideas why that's not working?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mechanize", "httparty"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1467217298, "post_id": 38094990, "comment_id": 63643904, "body": "You should create a server certificate with the proper names. For that, see <a href=\"http://stackoverflow.com/a/27931596/608639\">How to create a self-signed certificate with openssl?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1467217204, "post_id": 38098638, "comment_id": 63643856, "body": "Very bad advice; see <a href=\"http://crypto.stanford.edu/~dabo/pubs/abstracts/ssl-client-bugs.html\" rel=\"nofollow noreferrer\">The most dangerous code in the world: validating SSL certificates in non-browser software</a>. Perhaps the OP should create a certificate with the proper names. For that, see <a href=\"http://stackoverflow.com/a/27931596/608639\">How to create a self-signed certificate with openssl?</a>"}, {"owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1467226818, "post_id": 38098638, "comment_id": 63649698, "body": "@jww Yeah, sure. But the OP asked for workaround for Mechanize and HTTParty.  I&#39;ve provided the workaround. Those are workarounds not super-clear-extra-beaty solutions. Sometimes the problem is on the server side (not the client), and you can only do workarounds. That&#39;s not the reason for downvote, as I&#39;ve provided what the op asked for. I hope you get my point of view. OP wanted to set VERIFY_NONE. I&#39;ve answered. So please do remove downvote."}, {"owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1467229246, "post_id": 38098638, "comment_id": 63651010, "body": "@jww You can&#39;t create a certificate when you don&#39;t own the server. Looks like OP is scraping a lot, that&#39;s how I understand OP&#39;s question. For me your comment about creating the cert is not relevant the OPs problem. Downvoting too, as the question is: I don&#39;t own the server. There&#39;s SSL problem. I want to get the page! Even every browser does allow You to choose &#39;Visit the website!&#39; when there&#39;s problem with the certificate. You just get the warning, but it&#39;s still possible to get the page with wrong cert."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1467229817, "post_id": 38098638, "comment_id": 63651288, "body": "If its the case the he does not control the server, then he should end the current connection, and fallback to a new connection using Anonymous Diffie-Hellman. It also saves bytes on the wire since the server certificate is not needed for ADH and EC-ADH."}, {"owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1467229936, "post_id": 38098638, "comment_id": 63651341, "body": "@jww so post the answer for the OP so he can complete his task. I don&#39;t know how to use your technique. Can you provide the Mechanize and/or HTTParty solution to fetch the page with bad cert? You downvoted so please provide better solution. If you don&#39;t have the better solution so why do you downvote?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1467230221, "post_id": 38098638, "comment_id": 63651486, "body": "I&#39;m not going near this with an answer. The correct solution is to fix the server certificate. Plus, I&#39;m not sure we can answer it as-is because of all the fake information."}, {"owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1467276114, "post_id": 38098638, "comment_id": 63668332, "body": "@jww Ah, I see. You don&#39;t have working solution (OP asked for workaround) but you have a lot to say and of course you&#39;re right with your opinion, even if you don&#39;t have a solution for OP. I suggest you read the question carefully again (OP needs workaround)."}, {"owner": {"reputation": 1605, "user_id": 1413388, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/658c9476fcc0f26dde65dfd5edfe1f93?s=128&d=identicon&r=PG", "display_name": "Cjoerg", "link": "https://stackoverflow.com/users/1413388/cjoerg"}, "edited": false, "score": 0, "creation_date": 1467303092, "post_id": 38098638, "comment_id": 63687976, "body": "I have upvoted the answer, because it does address the question. It&#39;s clearly not a viable solution to fix someone elses server. Before mark the answer, could you maybe check if the mechanize method is correct. It returns <code>undefined method </code>http&#39; for #&lt;Mechanize:0x007fd711907e38&gt;`."}, {"owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "edited": false, "score": 0, "creation_date": 1467363650, "post_id": 38098638, "comment_id": 63712340, "body": "yes, it should be  just agent.verify_mode = OpenSSL::SSL::VERIFY_NONE - i will correct the answer"}], "tags": [], "owner": {"reputation": 412, "user_id": 6098343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb469f68efbafe39d98531c0f608624?s=128&d=identicon&r=PG&f=1", "display_name": "Stan Brajewski", "link": "https://stackoverflow.com/users/6098343/stan-brajewski"}, "is_accepted": true, "score": 4, "last_activity_date": 1467363665, "last_edit_date": 1495542336, "creation_date": 1467200868, "answer_id": 38098638, "question_id": 38094990, "link": "https://stackoverflow.com/questions/38094990/hostname-does-not-match-the-server-certificate-error-in-mechanize-and-httparty/38098638#38098638", "title": "&quot;Hostname does not match the server certificate&quot; error in Mechanize and HTTParty", "body": "<p>For Mechanize this should set verify SSL to none</p>\n\n<pre><code>agent = Mechanize.new\nagent.verify_mode = OpenSSL::SSL::VERIFY_NONE\n</code></pre>\n\n<p>For HTTParty there's <code>verify:</code> option\nSee this so question <a href=\"https://stackoverflow.com/questions/20955177/how-do-i-make-httparty-ignore-ssl\">How do I make HTTParty ignore SSL?</a></p>\n\n<p>If you want to set it generally, use this dirty trick:</p>\n\n<pre><code>OpenSSL::SSL::VERIFY_PEER = OpenSSL::SSL::VERIFY_NONE\n</code></pre>\n"}], "owner": {"reputation": 1605, "user_id": 1413388, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/658c9476fcc0f26dde65dfd5edfe1f93?s=128&d=identicon&r=PG", "display_name": "Cjoerg", "link": "https://stackoverflow.com/users/1413388/cjoerg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2306, "favorite_count": 0, "accepted_answer_id": 38098638, "answer_count": 1, "score": 3, "last_activity_date": 1467363665, "creation_date": 1467191152, "last_edit_date": 1467217052, "question_id": 38094990, "link": "https://stackoverflow.com/questions/38094990/hostname-does-not-match-the-server-certificate-error-in-mechanize-and-httparty", "title": "&quot;Hostname does not match the server certificate&quot; error in Mechanize and HTTParty", "body": "<p>Occationally, when I visit a website with <code>HTTParty</code> or <code>Mechanize</code>, I get this error:</p>\n\n<pre><code>hostname \"www.example.com\" does not match the server certificate\n</code></pre>\n\n<p>I can see that <a href=\"https://stackoverflow.com/questions/4505795/rails-3-opensslsslsslerror-hostname-was-not-match-with-the-server-certific\">there is a workaround</a> if you use the <code>open</code> method, but I'm not sure how to leverage that the above gems.</p>\n\n<p>Stacktrace for <code>Mechanize</code>:</p>\n\n<pre><code>agent = Mechanize.new\nagent.read_timeout              = 180\nagent.open_timeout              = 180\nagent.user_agent_alias          = 'Mac Safari'\nagent.redirect_ok               = :all\nagent.follow_meta_refresh       = :anywhere\nagent.follow_meta_refresh_self  = true\nagent.get(\"https://some-domain.com\")\n/home/me/.rbenv/versions/2.2.2/lib/ruby/2.2.0/openssl/ssl.rb:232:in `post_connection_check'\n/home/me/.rbenv/versions/2.2.2/lib/ruby/2.2.0/net/http.rb:925:in `connect'\n/home/me/.rbenv/versions/2.2.2/lib/ruby/2.2.0/net/http.rb:863:in `do_start'\n/home/me/.rbenv/versions/2.2.2/lib/ruby/2.2.0/net/http.rb:858:in `start'\n/home/me/applications/myapp/shared/bundle/ruby/2.2.0/gems/net-http-persistent-2.9.4/lib/net/http/persistent.rb:700:in `start'\n/home/me/applications/myapp/shared/bundle/ruby/2.2.0/gems/net-http-persistent-2.9.4/lib/net/http/persistent.rb:965:in `reset'\n/home/me/applications/myapp/shared/bundle/ruby/2.2.0/gems/net-http-persistent-2.9.4/lib/net/http/persistent.rb:628:in `connection_for'\n/home/me/applications/myapp/shared/bundle/ruby/2.2.0/gems/net-http-persistent-2.9.4/lib/net/http/persistent.rb:994:in `request'\n/home/me/applications/myapp/shared/bundle/ruby/2.2.0/gems/mechanize-2.7.4/lib/mechanize/http/agent.rb:267:in `fetch'\n/home/me/applications/myapp/shared/bundle/ruby/2.2.0/gems/mechanize-2.7.4/lib/mechanize.rb:464:in `get'\n</code></pre>\n\n<p>Stacktrace for <code>HTTParty</code>:</p>\n\n<pre><code>HTTParty.get(\"https://some-domain.com\")\n/home/me/.rbenv/versions/2.2.2/lib/ruby/2.2.0/openssl/ssl.rb:232:in `post_connection_check'\n/home/me/.rbenv/versions/2.2.2/lib/ruby/2.2.0/net/http.rb:925:in `connect'\n/home/me/.rbenv/versions/2.2.2/lib/ruby/2.2.0/net/http.rb:863:in `do_start'\n/home/me/.rbenv/versions/2.2.2/lib/ruby/2.2.0/net/http.rb:852:in `start'\n/home/me/.rbenv/versions/2.2.2/lib/ruby/2.2.0/net/http.rb:1375:in `request'\n/home/me/applications/myapp/shared/bundle/ruby/2.2.0/gems/httparty-0.13.7/lib/httparty/request.rb:117:in `perform'\n/home/me/applications/myapp/shared/bundle/ruby/2.2.0/gems/httparty-0.13.7/lib/httparty.rb:545:in `perform_request'\n/home/me/applications/myapp/shared/bundle/ruby/2.2.0/gems/httparty-0.13.7/lib/httparty.rb:476:in `get'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium", "cucumber", "capybara"], "comments": [{"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1467199124, "post_id": 38093791, "comment_id": 63630260, "body": "In test_steps you are saying when you are on Google to go to google?  That would redirect all day."}], "answers": [{"comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1467208084, "post_id": 38099776, "comment_id": 63636911, "body": "The only part of this &quot;fix&quot; that made a difference is setting of default_driver.  In your initial try you could have just set <code>Capybara.default_driver  = :selenium_chrome</code> and it would have done the same thing.  The reason for this is that the normal default driver (rack_test) doesn&#39;t support external urls, and the default setup requires to tag scenarios with @javascript if you want them to use the javascript_driver."}, {"owner": {"reputation": 1049, "user_id": 5353193, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b427991caffbc88cf5dccfb942f061a2?s=128&d=identicon&r=PG", "display_name": "Francois", "link": "https://stackoverflow.com/users/5353193/francois"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1467637408, "post_id": 38099776, "comment_id": 63796514, "body": "Thank you for this answer, the difference between <code>Capybara.current_driver = :selenium_chrome</code> and <code>Capybara.default_driver = :selenium_chrome</code> is a bit blury to me but it works now."}], "tags": [], "owner": {"reputation": 1049, "user_id": 5353193, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b427991caffbc88cf5dccfb942f061a2?s=128&d=identicon&r=PG", "display_name": "Francois", "link": "https://stackoverflow.com/users/5353193/francois"}, "is_accepted": true, "score": 1, "last_activity_date": 1467203806, "creation_date": 1467203806, "answer_id": 38099776, "question_id": 38093791, "link": "https://stackoverflow.com/questions/38093791/capybarainfiniteredirecterror-on-visithttp-google-com/38099776#38099776", "title": "Capybara::InfiniteRedirectError on visit(&#39;http://google.com&#39;)", "body": "<p>I fixed it thanks to this post: <a href=\"https://gist.github.com/pranav7/0f377b91a8b2cafe71bd\" rel=\"nofollow\">https://gist.github.com/pranav7/0f377b91a8b2cafe71bd</a></p>\n\n<p>I needed to put this in <strong>features/support/env.rb</strong></p>\n\n<pre><code>require 'cucumber/rails'\nrequire 'capybara/cucumber'\n\nCapybara.register_driver :chrome do |app|\n  client = Selenium::WebDriver::Remote::Http::Default.new\n  client.timeout = 120\n  Capybara::Selenium::Driver.new(app, :browser =&gt; :chrome, :http_client =&gt; client)\nend\n\nCapybara.default_driver = :chrome\n</code></pre>\n"}], "owner": {"reputation": 1049, "user_id": 5353193, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b427991caffbc88cf5dccfb942f061a2?s=128&d=identicon&r=PG", "display_name": "Francois", "link": "https://stackoverflow.com/users/5353193/francois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 38099776, "answer_count": 1, "score": 1, "last_activity_date": 1467203806, "creation_date": 1467187601, "last_edit_date": 1467188184, "question_id": 38093791, "link": "https://stackoverflow.com/questions/38093791/capybarainfiniteredirecterror-on-visithttp-google-com", "title": "Capybara::InfiniteRedirectError on visit(&#39;http://google.com&#39;)", "body": "<p>My goal is to use cucumber + capybara that run in a displayed browser with selenium (chromedriver).</p>\n\n<p><strong>Gemfile</strong></p>\n\n<pre><code>group :test do\n  gem 'cucumber-rails'\n  gem 'database_cleaner'\n  gem 'selenium-webdriver'\n  gem 'rspec-rails'#, '~&gt; 3.3.2'\nend\n</code></pre>\n\n<p><strong>features/support/env.rb</strong></p>\n\n<pre><code>require 'cucumber/rails'\nrequire 'selenium-webdriver'    # Setup selenium-drivers for capybara\n\nCapybara.register_driver :selenium_chrome do |app|\n  Capybara::Selenium::Driver.new(app, :browser =&gt; :chrome)\nend\n\nCapybara.current_driver = :selenium_chrome\n</code></pre>\n\n<p><strong>test.feature</strong></p>\n\n<pre><code>Feature: Google\n  Scenario: When I go to google, I am supposed to be on google\n  Given I am on google\n</code></pre>\n\n<p><strong>test_steps.rb</strong></p>\n\n<pre><code>Given(/^I am on google$/) do\n  visit('http://google.com')\nend\n</code></pre>\n\n<p>When I run <strong>cucumber</strong>, it ends up in error</p>\n\n<blockquote>\n  <p>redirected more than 5 times, check for infinite redirects.\n  (Capybara::InfiniteRedirectError)</p>\n</blockquote>\n\n<p>It doesn't even open the browser...What am I doing wrong?</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["ruby", "bigdecimal"], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1467333785, "post_id": 38094019, "comment_id": 63701722, "body": "Whoa, that is <i>indeed</i> surprising."}], "tags": [], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "is_accepted": true, "score": 4, "last_activity_date": 1467188293, "creation_date": 1467188293, "answer_id": 38094019, "question_id": 38093567, "link": "https://stackoverflow.com/questions/38093567/some-bigdecimal-fail-to-calculate-with-operator/38094019#38094019", "title": "Some BigDecimal fail to calculate with ** operator", "body": "<p>I understand now what I have misunderstood.</p>\n\n<p>I thought <code>-2.0 ** 0.3</code> is same as <code>(-2.0) ** 0.3</code>, but it is same as <code>-(2.0 ** 0.3)</code>.</p>\n\n<p>I didn't know that <code>**</code> is stronger than <code>-</code>.</p>\n"}], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 38094019, "answer_count": 1, "score": 1, "last_activity_date": 1467188293, "creation_date": 1467186915, "question_id": 38093567, "link": "https://stackoverflow.com/questions/38093567/some-bigdecimal-fail-to-calculate-with-operator", "title": "Some BigDecimal fail to calculate with ** operator", "body": "<p>When I use <code>**</code> operator with negative <code>BigDecimal</code> and decimal <code>BigDecimal</code>, that fails with <code>Zero or negative argument</code> error.</p>\n\n<p>I checked some similar values like this:</p>\n\n<pre><code>-2 ** '0.3'.to_d\n# =&gt; -1.23114441\n2 ** '0.3'.to_d\n# =&gt; 1.23114441\n2 ** '0.3'.to_d\n# =&gt; 1.23114441\n-2 ** '0.3'.to_d\n# =&gt; -1.23114441\n2.to_d ** '0.3'.to_d\n# =&gt; 1.23114441\n-2.to_d ** '0.3'.to_d\n# =&gt; Math::DomainError: Zero or negative argument for log\nfrom (pry):111:in `**'\n2.to_d ** 3.to_d\n# =&gt; 8.0\n-2.to_d ** 3.to_d\n# =&gt; -8.0\n</code></pre>\n\n<p>Why is this error happens and how can I fix it?</p>\n"}, {"tags": ["ruby", "ssh", "rsa"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6324692"}, "edited": false, "score": 0, "creation_date": 1467199769, "post_id": 38093105, "comment_id": 63630719, "body": "but where in the documentation does it mention that?"}, {"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1467199973, "post_id": 38093105, "comment_id": 63630846, "body": "<a href=\"http://www.rubydoc.info/github/net-ssh/net-ssh/Net/SSH\" rel=\"nofollow noreferrer\">rubydoc.info/github/net-ssh/net-ssh/Net/SSH</a> says &quot;keys =&gt; an array of file names of private keys to use for publickey and hostbased authentication&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1170868"}, "edited": false, "score": 0, "creation_date": 1560219512, "post_id": 38093105, "comment_id": 99653933, "body": "Or you need to ensure ssh-agent is running if there is a password on the key. =\\"}], "tags": [], "owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "is_accepted": true, "score": 0, "last_activity_date": 1467185523, "creation_date": 1467185523, "answer_id": 38093105, "question_id": 38091973, "link": "https://stackoverflow.com/questions/38091973/authentication-by-key-in-ruby-via-ssh-could-not-parse-pkey-no-start-line/38093105#38093105", "title": "Authentication by key in Ruby via ssh: Could not parse PKey: no start line", "body": "<p>You need to provide the path to the private key when connecting to a host, not the public key. </p>\n"}, {"tags": [], "owner": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "is_accepted": false, "score": 0, "last_activity_date": 1539768554, "creation_date": 1539768554, "answer_id": 52851550, "question_id": 38091973, "link": "https://stackoverflow.com/questions/38091973/authentication-by-key-in-ruby-via-ssh-could-not-parse-pkey-no-start-line/52851550#52851550", "title": "Authentication by key in Ruby via ssh: Could not parse PKey: no start line", "body": "<p>Try change \"~/.ssh/id_rsa.pub\" to \"~/.ssh/id_rsa\" in your code. It should help.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6324692"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2808, "favorite_count": 0, "accepted_answer_id": 38093105, "answer_count": 2, "score": 0, "last_activity_date": 1539768554, "creation_date": 1467182018, "last_edit_date": 1467182473, "question_id": 38091973, "link": "https://stackoverflow.com/questions/38091973/authentication-by-key-in-ruby-via-ssh-could-not-parse-pkey-no-start-line", "title": "Authentication by key in Ruby via ssh: Could not parse PKey: no start line", "body": "<p>I'm trying to connect to a server with ssh using an ssh key. The logs me an error and it also asks me for the password which I shouldn't be asked for because I'm using the key authen-ion and my intention is get rid of having to enter the password:</p>\n\n<pre><code> ERROR -- net.ssh.authentication.key_manager[2b02154b7610]: could not load private key file `/home/me/.ssh/id_rsa.pub': ArgumentError (Could not parse PKey: no start line)\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Net::SSH.start(ip_item, \"root\", host_key: \"ssh-rsa\", keys: [\"~/.ssh/id_rsa.pub\"], verbose: :debug) do |ssh|\n</code></pre>\n\n<p>Is that a bug? Why does it say \"private\"? </p>\n\n<p>The key exists.</p>\n\n<p>I'm able to connect to the server via the terminal without a password and it's added to the list of the known hosts of the server properly since I'm able to connect to it.</p>\n\n<p>Also <code>cat  ~/.ssh/authorized_keys</code> on the server shows my public key.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1656, "user_id": 6138119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YzV7y.jpg?s=128&g=1", "display_name": "Pravesh Khatri", "link": "https://stackoverflow.com/users/6138119/pravesh-khatri"}, "edited": false, "score": 0, "creation_date": 1467182971, "post_id": 38091665, "comment_id": 63619752, "body": "I think it must be a form object, so you must use <code>f.collection_select</code>"}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 0, "last_activity_date": 1467182936, "creation_date": 1467182936, "answer_id": 38092262, "question_id": 38091665, "link": "https://stackoverflow.com/questions/38091665/collection-select-not-passing-values-into-insert/38092262#38092262", "title": "Collection_select not passing values into insert", "body": "<p>This line</p>\n\n<pre><code>&lt;%= collection_select(:learner, :learner_id, Client.all, :company_id, :name, prompt: true) %&gt;\n</code></pre>\n\n<p>tells Rails to send the selected value to the server in <code>params[:learner][:learner_id]</code>. When you want to use that value as the <code>client_id</code> you should change that line to:</p>\n\n<pre><code>&lt;%= collection_select(:learner, :company_id, Client.all, :company_id, :name, prompt: true) %&gt; \n</code></pre>\n\n<p>Or use the FormBuilder version that is a bit shorter:</p>\n\n<pre><code>&lt;%= f.collection_select(:company_id, Client.all, :company_id, :name, prompt: true) %&gt; \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6199575"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 38092262, "answer_count": 1, "score": 0, "last_activity_date": 1467183059, "creation_date": 1467180843, "last_edit_date": 1467180980, "question_id": 38091665, "link": "https://stackoverflow.com/questions/38091665/collection-select-not-passing-values-into-insert", "title": "Collection_select not passing values into insert", "body": "<p>I am having a problem saving data from a dropdown \nBelow I have the fields on form  and logs that go with it </p>\n\n<p>This set works fine as you can see by the log inserts</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;%= f.label :company_id %&gt;&lt;br&gt;\n    &lt;%= f.number_field :company_id %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>Log file </p>\n\n<pre><code>INSERT INTO \"learners\"\n (\"learner_id\",  \"company_id\", \"id_type\", \"id_number\", \"first_name\", \"last_name\", \"middle_names\", \"title\", \"equity\", \"gender\", \"date_of_birth\", \"created_at\", \"updated_at\") \nVALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  \n[[\"learner_id\", 1], [\"company_id\", 1], [\"id_type\", \"Book\"], [\"id_number\", 33], [\"first_name\", \"Jack\"], [\"last_name\", \"Pillay\"], [\"middle_names\", \"\"], [\"title\", \"Mr\"],\n [\"equity\", \"Black\"], [\"gender\", \"Male\"], [\"date_of_birth\", \"2016-06-28\"], \n[\"created_at\", \"2016-06-28 19:16:41.969037\"], [\"updated_at\", \"2016-06-28 19:16:41.969037\"]]\n</code></pre>\n\n<p>Dropdown works but no values are being passed </p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;%= f.label :company_id %&gt;&lt;br&gt;\n    &lt;%= collection_select(:learner, :learner_id, Client.all, :company_id, :name, prompt: true) %&gt; \n  &lt;/div&gt;\n</code></pre>\n\n<p>Log File - See missing company_id</p>\n\n<pre><code>INSERT INTO \"learners\"\n (\"learner_id\", \"id_type\", \"id_number\", \"first_name\", \"last_name\", \"middle_names\", \"title\", \"equity\", \"gender\", \"date_of_birth\", \"created_at\", \"updated_at\") \nVALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  \n[[\"learner_id\", 1], [\"id_type\", \"Book\"], [\"id_number\", 33], [\"first_name\", \"Jack\"], [\"last_name\", \"Pillay\"], [\"middle_names\", \"\"], [\"title\", \"Mr\"],\n [\"equity\", \"Black\"], [\"gender\", \"Male\"], [\"date_of_birth\", \"2016-06-28\"], \n[\"created_at\", \"2016-06-28 19:16:41.969037\"], [\"updated_at\", \"2016-06-28 19:16:41.969037\"]]\n</code></pre>\n\n<p>Learners controller</p>\n\n<pre><code>class LearnersController &lt; ApplicationController\n  before_action :set_learner, only: [:show, :edit, :update, :destroy]\n\n  # GET /learners\n  # GET /learners.json\n  def index\n    @learners = Learner.all\n  end\n\n  # GET /learners/1\n  # GET /learners/1.json\n  def show\n  end\n\n  # GET /learners/new\n  def new\n    @learner = Learner.new\n    @clients = Client.all\n    respond_to do |format|\n      format.html # new.html.erb\n      format.xml  { render :xml =&gt; @learner }\n    end\n  end\n\n  # GET /learners/1/edit\n  def edit\n  end\n\n  # POST /learners\n  # POST /learners.json\n  def create\n    @learner = Learner.new(learner_params)\n\n    respond_to do |format|\n      if @learner.save\n        format.html { redirect_to @learner, notice: 'Learner was successfully created.' }\n        format.json { render :show, status: :created, location: @learner }\n      else\n        format.html { render :new }\n        format.json { render json: @learner.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /learners/1\n  # PATCH/PUT /learners/1.json\n  def update\n    respond_to do |format|\n      if @learner.update(learner_params)\n        format.html { redirect_to @learner, notice: 'Learner was successfully updated.' }\n        format.json { render :show, status: :ok, location: @learner }\n      else\n        format.html { render :edit }\n        format.json { render json: @learner.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /learners/1\n  # DELETE /learners/1.json\n  def destroy\n    @learner.destroy\n    respond_to do |format|\n      format.html { redirect_to learners_url, notice: 'Learner was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_learner\n      @learner = Learner.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def learner_params\n      params.require(:learner).permit(:learner_id, :company_id, :id_type, :id_number, :date_of_birth, :first_name, :last_name, :middle_names, :title, :equity, :gender)\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "linux", "notifications"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1467180203, "post_id": 38091486, "comment_id": 63618375, "body": "Do you expect <code>notify-send</code> executed on server side ruby <i>to show notifications on client computers</i>?!"}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1467180278, "post_id": 38091486, "comment_id": 63618408, "body": "Yes. It should run on server side and notifications should send to related client systems."}, {"owner": {"reputation": 2278, "user_id": 2244501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231d8805a81cf94c09ff60cdba6e4029?s=128&d=identicon&r=PG", "display_name": "retgoat", "link": "https://stackoverflow.com/users/2244501/retgoat"}, "edited": false, "score": 0, "creation_date": 1467180543, "post_id": 38091486, "comment_id": 63618526, "body": "It&#39;s impossible. You should use websockets for it. Just the first link in google: <a href=\"https://pusher.com/tutorials/realtime-notifications\" rel=\"nofollow noreferrer\">pusher.com/tutorials/realtime-notifications</a>"}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "edited": false, "score": 0, "creation_date": 1467181036, "post_id": 38091486, "comment_id": 63618765, "body": "I have tried this task using other gems but it didn&#39;t work. I asked this to know whether we can customize this command or not?"}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "edited": false, "score": 0, "creation_date": 1467181073, "post_id": 38091486, "comment_id": 63618780, "body": "Please check <a href=\"http://stackoverflow.com/questions/38053647/rails-4-notifyor-gem-is-not-sending-any-notifications\" title=\"rails 4 notifyor gem is not sending any notifications\">stackoverflow.com/questions/38053647/&hellip;</a>"}], "owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467180123, "creation_date": 1467180123, "question_id": 38091486, "link": "https://stackoverflow.com/questions/38091486/rails-4-send-desktop-notifications-using-notify-send-command", "title": "Rails 4 - Send desktop notifications using &#39;notify-send&#39; command", "body": "<p>In rails 4 project, I am trying to send desktop notifications using <code>notify-send</code> command. This command will send notification to only current system, how can I send to other system by using it? Also please explain on what basis we can get other system's information so that we can mention that it in <code>notify-send</code> command.</p>\n\n<p>I have written a rake task so that it will check continuously and send notifications.\nRight now I am using below command for testing in localhost,</p>\n\n<pre><code>system \"notify-send 'Title' 'Message' -t 2000\"\n</code></pre>\n\n<p>Please help me to solve this issue and it should works in all environments.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "edited": false, "score": 1, "creation_date": 1467177866, "post_id": 38090916, "comment_id": 63617404, "body": "Please add some code which you have tried."}], "answers": [{"tags": [], "owner": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1467177902, "creation_date": 1467177902, "answer_id": 38091005, "question_id": 38090916, "link": "https://stackoverflow.com/questions/38090916/ruby-routing-when-passing-a-parameter-to-controller/38091005#38091005", "title": "Ruby routing when passing a parameter to controller", "body": "<p>To delete an item in rails, it is usually done this way</p>\n\n<p>The URL would be:</p>\n\n<pre><code>:url =&gt; /boats/:boat_id/images/:id, :method =&gt; :delete\n</code></pre>\n\n<p>This is called in a view like so</p>\n\n<pre><code>= link_to \"delete\", boat_image_path(boat, image), :method =&gt; :delete\n</code></pre>\n\n<p>And it would be handled by the <code>destroy</code> action in the images controller.</p>\n\n<p>Restful routes will reuse the same url and change the method - in the boat image example, you can use :get, :patch, or :delete to view, update, or delete, respectively.  </p>\n\n<p>This is probably enough to get you going.  Routes are a major part of rails - both in generating urls in views and matching requests to the controller#actions. Take some time to get familiar with rails routes and restful concepts.</p>\n"}, {"tags": [], "owner": {"reputation": 516, "user_id": 2779976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SiQtD.jpg?s=128&g=1", "display_name": "Awais Shafqat", "link": "https://stackoverflow.com/users/2779976/awais-shafqat"}, "is_accepted": false, "score": 0, "last_activity_date": 1467178130, "creation_date": 1467178130, "answer_id": 38091050, "question_id": 38090916, "link": "https://stackoverflow.com/questions/38090916/ruby-routing-when-passing-a-parameter-to-controller/38091050#38091050", "title": "Ruby routing when passing a parameter to controller", "body": "<p>ok. So this is easy. You can add the route like this </p>\n\n<pre><code>get  '/boats/:id/destroy_image' =&gt; 'boats#destroy_image'\n</code></pre>\n\n<p>You can simply send that extra id in params.</p>\n"}, {"tags": [], "owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "is_accepted": false, "score": 0, "last_activity_date": 1467179453, "creation_date": 1467179453, "answer_id": 38091340, "question_id": 38090916, "link": "https://stackoverflow.com/questions/38090916/ruby-routing-when-passing-a-parameter-to-controller/38091340#38091340", "title": "Ruby routing when passing a parameter to controller", "body": "<p>If you use the rails nested resources following the naming convention,</p>\n\n<pre><code>resources :boats do\n  resources :images\nend\n\n&lt;%= link_to 'Delete Image', [@boat, @image], confirm: 'Are you sure?', method: :delete %&gt;\n</code></pre>\n\n<p>This requests to the <strong>images controller</strong> by the rails way. sending the boat_id and the image id.</p>\n\n<p>But, if you want to explicitly route that to the boats controller,</p>\n\n<p>add a route in the boats controller as,</p>\n\n<pre><code>delete '/boats/:id' =&gt; 'boats#destroy_image', as: :destroy_image(image.id)\n</code></pre>\n\n<p>send the <strong>image_id</strong> through params,</p>\n\n<p>then in the controller,</p>\n\n<pre><code>class BoatsController &lt; ApplicationController\n\n\n    def destroy_image\n        @image = Image.find(params[:id])\n        @boat = @image.boat //do anything you want with the boat object\n\n        if @image.destroy\n        else\n            // *** ***//\n        end\n\n        respond_to do |format|\n            format.html { redirect_to list_tasks_path(@task) }\n            format.json { head :ok }\n        end\n    end\n\nend \n</code></pre>\n\n<p>So, the route you have mentioned takes you to the destroy_image action in the boats controller, even if the route dos not contain image_id as query string, but we are sending it through params. That's the power of rails.</p>\n"}], "owner": {"reputation": 3, "user_id": 5781522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50936a148d7b3ab6323106e845efdd65?s=128&d=identicon&r=PG&f=1", "display_name": "RebeccaWhite", "link": "https://stackoverflow.com/users/5781522/rebeccawhite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1467179453, "creation_date": 1467177522, "question_id": 38090916, "link": "https://stackoverflow.com/questions/38090916/ruby-routing-when-passing-a-parameter-to-controller", "title": "Ruby routing when passing a parameter to controller", "body": "<p>In my view, I am passing a parameter to a method in my controller.</p>\n\n<p>The path looks like this:\n    <code>/boats/:id/destroy_image?image_id=#</code></p>\n\n<p>I've read the Routing from Outside In guide, and it only skirts over this type of option briefly and haven't been able to figure out how to route this to the <code>boats#destroy_image</code> method properly.</p>\n\n<p>Could someone please shed some light?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "postgresql", "ruby-on-rails-4", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 516, "user_id": 2779976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SiQtD.jpg?s=128&g=1", "display_name": "Awais Shafqat", "link": "https://stackoverflow.com/users/2779976/awais-shafqat"}, "is_accepted": false, "score": 4, "last_activity_date": 1467190549, "last_edit_date": 1467190549, "creation_date": 1467178882, "answer_id": 38091216, "question_id": 38090853, "link": "https://stackoverflow.com/questions/38090853/ordering-of-relation-based-on-associated-table-in-rails4/38091216#38091216", "title": "Ordering of relation based on associated table in rails4", "body": "<p>You can do it like this.</p>\n\n<pre><code> Student.joins(:marks).select('id, sum(marks.point) as total_marks').group('students.id').order('total_marks desc')\n</code></pre>\n\n<p>If you are still unable to run it please modify it or let me know.In place of id in select you can select any column(s).  </p>\n"}, {"comments": [{"owner": {"reputation": 387, "user_id": 310812, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31ac6ede293e13f34f749271f026cbcd?s=128&d=identicon&r=PG", "display_name": "jissy", "link": "https://stackoverflow.com/users/310812/jissy"}, "edited": false, "score": 0, "creation_date": 1467188110, "post_id": 38091288, "comment_id": 63622906, "body": "A small change gave me the result:Student.joins(:marks).select(&#39;students.*, SUM(marks.point) AS total_point&#39;).group(&#39;students.id&#39;).order(&#39;total_point DESC&#39;)    .                        Thanks"}], "tags": [], "owner": {"reputation": 845, "user_id": 5646801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d133162c0a6c4b45ad559f5a86f8f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii K", "link": "https://stackoverflow.com/users/5646801/sergii-k"}, "is_accepted": true, "score": 6, "last_activity_date": 1467179200, "creation_date": 1467179200, "answer_id": 38091288, "question_id": 38090853, "link": "https://stackoverflow.com/questions/38090853/ordering-of-relation-based-on-associated-table-in-rails4/38091288#38091288", "title": "Ordering of relation based on associated table in rails4", "body": "<p>This should do the trick:</p>\n\n<pre><code>Student.joins(:marks).select('students.*, SUM(marks.point) AS total_point').group(:id).order('total_point DESC')\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 310812, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31ac6ede293e13f34f749271f026cbcd?s=128&d=identicon&r=PG", "display_name": "jissy", "link": "https://stackoverflow.com/users/310812/jissy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 38091288, "answer_count": 2, "score": 3, "last_activity_date": 1467190549, "creation_date": 1467177143, "question_id": 38090853, "link": "https://stackoverflow.com/questions/38090853/ordering-of-relation-based-on-associated-table-in-rails4", "title": "Ordering of relation based on associated table in rails4", "body": "<p>I have 2 models as below:</p>\n\n<pre><code>class Student &lt; ActiveRecord::Base  \n  has_many :marks\nend\n\nclass Mark &lt; ActiveRecord::Base  \n  belongs_to :student\nend\n</code></pre>\n\n<p><code>point</code> is a field in marks table. For each student there are many entries in the marks table.</p>\n\n<p>I need to get a list of students based on the order of highest total points.</p>\n\n<p>I tried as below:</p>\n\n<pre><code>@students = Student.all.collect{|p| [p,p.marks.pluck(:point).sum]}\n@students.sort_by { |h| h[1] }.reverse!\n</code></pre>\n\n<p>But it will return 2 items in each array, one the object and next the total points.</p>\n\n<p>Is there a better solution please.</p>\n\n<p>Thanks,</p>\n\n<p>Jissy</p>\n"}, {"tags": ["ruby", "binary", "integer", "type-conversion"], "comments": [{"owner": {"reputation": 46515, "user_id": 5647260, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oByMV.jpg?s=128&g=1", "display_name": "Andrew Li", "link": "https://stackoverflow.com/users/5647260/andrew-li"}, "edited": false, "score": 0, "creation_date": 1467176706, "post_id": 38090739, "comment_id": 63617020, "body": "You can just invert the bits of a positive number to get it&#39;s opposite"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1467176769, "post_id": 38090739, "comment_id": 63617037, "body": "Please ask one question per post."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1467176882, "post_id": 38090739, "comment_id": 63617068, "body": "Also, please clarify the rules of conversion; currently I can\u2019t think of any giving <code>11111111111101</code> for <code>-3</code>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1467183284, "post_id": 38090739, "comment_id": 63619933, "body": "@mudasobwa that&#39;s <i>two&#39;s complement</i>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1467183741, "post_id": 38090739, "comment_id": 63620198, "body": "@Stefan ...on systems where long int is 32-bit, yes."}], "answers": [{"comments": [{"owner": {"reputation": 1196, "user_id": 5089079, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3d4362396438d6d4e49428743c8ced47?s=128&d=identicon&r=PG", "display_name": "Noby Fujioka", "link": "https://stackoverflow.com/users/5089079/noby-fujioka"}, "edited": false, "score": 0, "creation_date": 1467178179, "post_id": 38090822, "comment_id": 63617525, "body": "Great, it works!  but what does pack(&#39;L&#39;) and unpack(&#39;L&#39;)[0] do in this case?"}, {"owner": {"reputation": 312231, "user_id": 2225682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4958f4712d94ab82fe55fa471308e4b5?s=128&d=identicon&r=PG", "display_name": "falsetru", "link": "https://stackoverflow.com/users/2225682/falsetru"}, "reply_to_user": {"reputation": 1196, "user_id": 5089079, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3d4362396438d6d4e49428743c8ced47?s=128&d=identicon&r=PG", "display_name": "Noby Fujioka", "link": "https://stackoverflow.com/users/5089079/noby-fujioka"}, "edited": false, "score": 0, "creation_date": 1467178374, "post_id": 38090822, "comment_id": 63617602, "body": "@NobyFujioka, Check the <a href=\"http://ruby-doc.org/core/Array.html#method-i-pack\" rel=\"nofollow noreferrer\">documentation for <code>Array#pack</code></a> or <a href=\"http://ruby-doc.org/core/String.html#method-i-unpack\" rel=\"nofollow noreferrer\"><code>String#unpack</code></a>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1467179451, "post_id": 38090822, "comment_id": 63618033, "body": "It worth to mention that the above will produce the result of length 32 on 64bit arch only."}, {"owner": {"reputation": 312231, "user_id": 2225682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4958f4712d94ab82fe55fa471308e4b5?s=128&d=identicon&r=PG", "display_name": "falsetru", "link": "https://stackoverflow.com/users/2225682/falsetru"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1467182927, "post_id": 38090822, "comment_id": 63619726, "body": "@mudasobwa, According to the documentation, <code>L</code> stands for <code>32-bit unsigned, native endian (uint32_t)</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1467183663, "post_id": 38090822, "comment_id": 63620154, "body": "Oh, indeed, I messed things up. I meant that probably the requested value of length 32 is OK for 64bit only. Anyway."}], "tags": [], "owner": {"reputation": 312231, "user_id": 2225682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4958f4712d94ab82fe55fa471308e4b5?s=128&d=identicon&r=PG", "display_name": "falsetru", "link": "https://stackoverflow.com/users/2225682/falsetru"}, "is_accepted": false, "score": 9, "last_activity_date": 1467176928, "creation_date": 1467176928, "answer_id": 38090822, "question_id": 38090739, "link": "https://stackoverflow.com/questions/38090739/how-to-convert-negative-integers-to-binary-in-ruby/38090822#38090822", "title": "How to convert negative integers to binary in Ruby", "body": "<p>Packing then unpacking will convert <code>-3</code> to <code>4294967293</code> (2<sup>32</sup> - 3):</p>\n\n<pre><code>[-3].pack('L').unpack('L')\n=&gt; [4294967293]\n</code></pre>\n\n<hr>\n\n<pre><code>sprintf('%b', [-3].pack('L').unpack('L')[0])\n# =&gt; \"11111111111111111111111111111101\"\n\nsprintf('%b', [3].pack('L').unpack('L')[0])\n# =&gt; \"11\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 1, "last_activity_date": 1467199683, "creation_date": 1467199683, "answer_id": 38098225, "question_id": 38090739, "link": "https://stackoverflow.com/questions/38090739/how-to-convert-negative-integers-to-binary-in-ruby/38098225#38098225", "title": "How to convert negative integers to binary in Ruby", "body": "<p>Try:</p>\n\n<pre><code>&gt; 32.downto(0).map { |n| -3[n] }.join\n#=&gt; \"111111111111111111111111111111101\n</code></pre>\n\n<p><strong>Note:</strong> This applies to negative number's only.</p>\n"}], "owner": {"reputation": 1196, "user_id": 5089079, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3d4362396438d6d4e49428743c8ced47?s=128&d=identicon&r=PG", "display_name": "Noby Fujioka", "link": "https://stackoverflow.com/users/5089079/noby-fujioka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1467199683, "creation_date": 1467176388, "last_edit_date": 1467185022, "question_id": 38090739, "link": "https://stackoverflow.com/questions/38090739/how-to-convert-negative-integers-to-binary-in-ruby", "title": "How to convert negative integers to binary in Ruby", "body": "<p>Question 1: I cannot find a way to convert negative integers to binary in the following way. I am supposed to convert it like this.</p>\n\n<pre><code>-3 =&gt; \"11111111111111111111111111111101\"\n</code></pre>\n\n<p>I tried below:</p>\n\n<pre><code>sprintf('%b', -3) =&gt; \"..101\" # .. appears and does not show 111111 bit.\n\n-3.to_s(2) =&gt; \"-11\" # This just adds - to the binary of the positive integer 3.\n</code></pre>\n\n<p>Question 2: Interestingly, if I use online converter, it tells me that binary of -3 is \"00101101 00110011\".</p>\n\n<p>What is the difference between <code>\"11111111111111111111111111111101\"</code> and <code>\"00101101 00110011\"</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 3710, "user_id": 6523193, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/V6rGA.jpg?s=128&g=1", "display_name": "Luka Kerr", "link": "https://stackoverflow.com/users/6523193/luka-kerr"}, "edited": false, "score": 0, "creation_date": 1467177197, "post_id": 38090789, "comment_id": 63617164, "body": "That worked great, although is there any way to only select number 3 and 4 inside the take() method?"}, {"owner": {"reputation": 10683, "user_id": 52317, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/b3da0ca2685a59740d157b22aec70935?s=128&d=identicon&r=PG", "display_name": "Uzbekjon", "link": "https://stackoverflow.com/users/52317/uzbekjon"}, "reply_to_user": {"reputation": 3710, "user_id": 6523193, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/V6rGA.jpg?s=128&g=1", "display_name": "Luka Kerr", "link": "https://stackoverflow.com/users/6523193/luka-kerr"}, "edited": false, "score": 0, "creation_date": 1467178425, "post_id": 38090789, "comment_id": 63617618, "body": "Use <code>offset()</code> method. <code>limit(2).offset(2)</code>."}], "tags": [], "owner": {"reputation": 10683, "user_id": 52317, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/b3da0ca2685a59740d157b22aec70935?s=128&d=identicon&r=PG", "display_name": "Uzbekjon", "link": "https://stackoverflow.com/users/52317/uzbekjon"}, "is_accepted": true, "score": 0, "last_activity_date": 1467176720, "creation_date": 1467176720, "answer_id": 38090789, "question_id": 38090732, "link": "https://stackoverflow.com/questions/38090732/ruby-on-rails-changing-hyperlinks-to-table-columns/38090789#38090789", "title": "Ruby on rails - Changing hyperlinks to table columns", "body": "<p>Use <code>take()</code> or <code>limit()</code> methods to limit how many items you want to get:</p>\n\n<pre><code>&lt;ul&gt;\n    &lt;% Category.take(2).each do |category| %&gt;\n    &lt;li&gt;&lt;%= link_to category.name, items_path(category: category.name) %&gt;&lt;/li&gt;\n    &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 2870282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXh8Y.jpg?s=128&g=1", "display_name": "Sapna Prajapati", "link": "https://stackoverflow.com/users/2870282/sapna-prajapati"}, "is_accepted": false, "score": 0, "last_activity_date": 1467265719, "last_edit_date": 1467265719, "creation_date": 1467188601, "answer_id": 38094106, "question_id": 38090732, "link": "https://stackoverflow.com/questions/38090732/ruby-on-rails-changing-hyperlinks-to-table-columns/38094106#38094106", "title": "Ruby on rails - Changing hyperlinks to table columns", "body": "<p>With respect to your question \"can link to two columns in the \"Categories\" table?\" - Please find my comment as: </p>\n\n<p>SQL Approach:</p>\n\n<blockquote>\n  <p>SELECT CONCAT('', \"name\", \"title\") AS \"name\" FROM categories;</p>\n</blockquote>\n\n<p>Rails Approach: &lt;%= link_to \"#{category.name} #{category.title}\", items_path(category: category.name) %></p>\n"}], "owner": {"reputation": 3710, "user_id": 6523193, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/V6rGA.jpg?s=128&g=1", "display_name": "Luka Kerr", "link": "https://stackoverflow.com/users/6523193/luka-kerr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 38090789, "answer_count": 2, "score": 1, "last_activity_date": 1469184546, "creation_date": 1467176341, "last_edit_date": 1469184546, "question_id": 38090732, "link": "https://stackoverflow.com/questions/38090732/ruby-on-rails-changing-hyperlinks-to-table-columns", "title": "Ruby on rails - Changing hyperlinks to table columns", "body": "<p>I've made a list with hyper links to columns in a table called \"Categories\", there are 5 categories and the first set of code below makes hyperlinks to all 5.</p>\n\n<p>I want to make a dropdown menu, but only show two of the categories, instead of all 5. Currently, i'm just using a href to the url, but is there some other way I can link to two columns in the \"Categories\" table?</p>\n\n<p>Links:</p>\n\n<pre><code>&lt;ul&gt;\n    &lt;% Category.all.each do |category| %&gt;\n    &lt;li&gt;&lt;%= link_to category.name, items_path(category: category.name) %&gt;&lt;/li&gt;\n    &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>Dropdown Menu:</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;div class=\"dropdown\"&gt;\n    &lt;button class=\"btn btn-primary dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\"&gt;Canon\n    &lt;span class=\"caret\"&gt;&lt;/span&gt;&lt;/button&gt;\n    &lt;ul class=\"dropdown-menu\"&gt;\n        &lt;li&gt;&lt;a href=\"http://localhost:3000/items?category=Canon+Camera\"&gt;Canon Cameras&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=\"http://localhost:3000/items?category=Canon+Lens\"&gt;Canon Lenses&lt;/a&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rackup"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1489195791, "post_id": 38090165, "comment_id": 72580008, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/35545361/rails-the-system-cannot-find-the-path-specified\" title=\"rails the system cannot find the path specified\">stackoverflow.com/questions/35545361/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10683, "user_id": 52317, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/b3da0ca2685a59740d157b22aec70935?s=128&d=identicon&r=PG", "display_name": "Uzbekjon", "link": "https://stackoverflow.com/users/52317/uzbekjon"}, "is_accepted": false, "score": 0, "last_activity_date": 1467178858, "creation_date": 1467178858, "answer_id": 38091210, "question_id": 38090165, "link": "https://stackoverflow.com/questions/38090165/rackup-command-not-working-on-windows-7/38091210#38091210", "title": "Rackup command not working on windows 7", "body": "<p>Windows can't find <code>rackup</code> command. Add it to your <code>PATH</code> environment variable and it should resolve the problem.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6396032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c112be4cd83de07f0c86ef9cd2ee4b5b?s=128&d=identicon&r=PG&f=1", "display_name": "morapost", "link": "https://stackoverflow.com/users/6396032/morapost"}, "is_accepted": false, "score": 0, "last_activity_date": 1467203941, "creation_date": 1467203941, "answer_id": 38099841, "question_id": 38090165, "link": "https://stackoverflow.com/questions/38090165/rackup-command-not-working-on-windows-7/38099841#38099841", "title": "Rackup command not working on windows 7", "body": "<p>Thanks Uzbekjon!! I resolved the issue by modifying the path in C:\\RailsInstaller\\Ruby2.2.0\\bin rackup.bat file. The path was wrongly mentioned in the file.Once I updated the correct location of rackup path, the issue is resolved.</p>\n"}, {"tags": [], "owner": {"reputation": 173, "user_id": 7122628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JOdtW.png?s=128&g=1", "display_name": "Jefhunt", "link": "https://stackoverflow.com/users/7122628/jefhunt"}, "is_accepted": false, "score": 1, "last_activity_date": 1489178505, "last_edit_date": 1489178505, "creation_date": 1489177765, "answer_id": 42727183, "question_id": 38090165, "link": "https://stackoverflow.com/questions/38090165/rackup-command-not-working-on-windows-7/42727183#42727183", "title": "Rackup command not working on windows 7", "body": "<p>You should to do this</p>\n\n<ol>\n<li><code>gem install rack</code></li>\n<li>then run <code>rackup</code></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 6396032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c112be4cd83de07f0c86ef9cd2ee4b5b?s=128&d=identicon&r=PG&f=1", "display_name": "morapost", "link": "https://stackoverflow.com/users/6396032/morapost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1489178505, "creation_date": 1467172993, "last_edit_date": 1467178543, "question_id": 38090165, "link": "https://stackoverflow.com/questions/38090165/rackup-command-not-working-on-windows-7", "title": "Rackup command not working on windows 7", "body": "<p>I am trying to build a online chat using <code>private_pub</code> and <code>thin</code>. I have installed the gem and trying to boot thin client using below command.</p>\n\n<pre><code>rackup private_pub.ru -s thin -E production\n</code></pre>\n\n<p>and I am getting below error:</p>\n\n<pre><code>The system cannot find the path specified.\n</code></pre>\n\n<p>Even <code>rackup --help</code> shows the same error. Anything to add in environment variables or <code>config.ru</code> file. Kindly help!</p>\n\n<p>My platform is Windows 7 32-bit.</p>\n"}, {"tags": ["arrays", "ruby", "hash", "substring"], "comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1467172533, "post_id": 38090053, "comment_id": 63615788, "body": "Look at <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-each\" rel=\"nofollow noreferrer\"><code>Array#each</code></a> and <a href=\"http://ruby-doc.org/core-2.2.0/Hash.html#method-i-5B-5D\" rel=\"nofollow noreferrer\"><code>Hash#[]</code></a> methods and you should have a solution"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1467173182, "post_id": 38090053, "comment_id": 63615933, "body": "You may want <code>hash.values_at(*substrings)</code>. See <a href=\"http://ruby-doc.org/core-2.2.0/Hash.html#method-i-values_at\" rel=\"nofollow noreferrer\">Hash#values_at</a>. If <code>hash = { &quot;a&quot;=&gt; 1, &quot;b&quot;=&gt; 2, &quot;c&quot;=&gt; 3 }</code> and <code>str = [&quot;b&quot;, &quot;a&quot;]</code> then <code>hash.values_at(*str) #=&gt; [2, 1]</code>. Here <code>hash.values_at(*str) = hash.values_at(*[&quot;b&quot;, &quot;a&quot;] = hash.values_at(&quot;b&quot;, &quot;a&quot;)</code>. btw, Ruby does not have a concept of &quot;substrings&quot;; only &quot;strings&quot;. You may of course refer to a &quot;substring&quot; in the context of a particular string to explain what you would like to do."}, {"owner": {"reputation": 1, "user_id": 5725792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kM8tI.jpg?s=128&g=1", "display_name": "lissaluck", "link": "https://stackoverflow.com/users/5725792/lissaluck"}, "edited": false, "score": 0, "creation_date": 1467173612, "post_id": 38090053, "comment_id": 63616054, "body": "Cary, That looks to be exactly what I was looking for. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 639, "user_id": 1956964, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0jQ4l.png?s=128&g=1", "display_name": "dr. strange", "link": "https://stackoverflow.com/users/1956964/dr-strange"}, "is_accepted": false, "score": -1, "last_activity_date": 1467173462, "creation_date": 1467173462, "answer_id": 38090225, "question_id": 38090053, "link": "https://stackoverflow.com/questions/38090053/ruby-array-to-look-up-hash-values/38090225#38090225", "title": "Ruby array to look up hash values", "body": "<pre><code>substrings = [\"sub1\", \"sub2\", \"sub3\"]\nhash = {\"sub1\"=&gt;\"string1\", \"sub2\"=&gt;\"string2\", \"sub3\"=&gt;\"string3\"}\n</code></pre>\n\n<blockquote>\n  <p>if you want to print value of each element in substrings</p>\n</blockquote>\n\n<pre><code>substrings.each do |str|\n    p \"value of #{str} is #{hash[str]}\"  if hash.has_key?(str)\nend\n\n#output\n\"value of sub1 is string1\"\n\"value of sub2 is string2\"\n\"value of sub3 is string3\"\n</code></pre>\n\n<blockquote>\n  <p>if you want to print value for specific given substrings</p>\n</blockquote>\n\n<pre><code>def find_value(str,hash)    \n    \"value of #{str} is #{hash[str]}\"  if hash.has_key?(str)\nend\n\np find_value(\"sub1\",hash)\n\n#Output\n\"value of sub1 is string1\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5725792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kM8tI.jpg?s=128&g=1", "display_name": "lissaluck", "link": "https://stackoverflow.com/users/5725792/lissaluck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467174514, "creation_date": 1467172156, "last_edit_date": 1467174514, "question_id": 38090053, "link": "https://stackoverflow.com/questions/38090053/ruby-array-to-look-up-hash-values", "title": "Ruby array to look up hash values", "body": "<p>I'm still new to this, so bear with me. I have an array of substrings and a hash that holds substrings and strings.</p>\n\n<pre><code>substrings = [\"sub1\", \"sub2\", \"sub3\",...etc.]\nhash = {\"sub1\"=&gt;\"string1\", \"sub2\"=&gt;\"string2\", \"sub3\"=&gt;\"string3\"...}\n</code></pre>\n\n<p>For example, a hash value might be <code>\"ount\"=&gt;\"country\"</code>. And I'd like to look it up by pulling <code>\"ount\"</code> from my array, and then outputting <code>\"country\"</code> as the value of the <code>\"ount\"</code> key. I want to do this for every substring in the array.</p>\n\n<p>Each substring has exactly one string. Both lists are alphabetical, so stopping when it's found and moving to the next is okay. I can find a count of the items, but would rather do it as an iteration so it's reusable code, if that makes sense.</p>\n"}, {"tags": ["ruby", "websocket", "eventmachine"], "answers": [{"comments": [{"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471334421, "post_id": 38090050, "comment_id": 65292916, "body": "I&#39;m curious and I hope it&#39;s okay that I ask: why not use an existing websocket framework (i.e. Faye / ActionCable / Plezi)? and why use EM Websockets instead of a Rack server that supports websockets such as Iodine? I&#39;m the author of Iodine and Plezi and I&#39;m asking to better understand potential users before the release of the new versions (they&#39;re on GitHub)."}, {"owner": {"reputation": 4262, "user_id": 1843663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/59fdc868797104789106d0f637568198?s=128&d=identicon&r=PG", "display_name": "Richard_G", "link": "https://stackoverflow.com/users/1843663/richard-g"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471350811, "post_id": 38090050, "comment_id": 65303181, "body": "@Myst No problem!  Actually, I am using the faye-websocket-ruby gem that uses eventmachine.  I am also using Redis PubSub.  As a whole, the application is highly specialized so out-of-the-box solutions don&#39;t really suit it.  I did build an ActionCable app to try it, but the clients are Python-based micro systems that it didn&#39;t support.  I looked at Plezi and Iodine, but didn&#39;t choose to go there.  After ActionCable, I realized I wanted lower-level control closer to native.  Certainly appreciate your work!"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471353549, "post_id": 38090050, "comment_id": 65305181, "body": "Thank you for taking the time. I think I understand your reasoning. I hope the new Iodine (which is written in C) and Plezi (features were removed rather then added) would make scalable and lower level implementations easier."}], "tags": [], "owner": {"reputation": 4262, "user_id": 1843663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/59fdc868797104789106d0f637568198?s=128&d=identicon&r=PG", "display_name": "Richard_G", "link": "https://stackoverflow.com/users/1843663/richard-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1491182980, "last_edit_date": 1495540462, "creation_date": 1467172121, "answer_id": 38090050, "question_id": 38089995, "link": "https://stackoverflow.com/questions/38089995/debugging-websocket-1006/38090050#38090050", "title": "Debugging websocket 1006", "body": "<p>Went back to basic Ruby and inserted this code at the server's \"on close\" event:</p>\n\n<pre><code>if @debug\n puts \"MyserverBackend&gt;&gt; Close entered. Last error:#{$!.class}:#{$!.to_s};Module:#{$0};\"\n $@.each { |backtrace| puts backtrace }\n exit\nend\n</code></pre>\n\n<p>This identifies where the failure is occurring and enhances debugging.  For example, when I forced the error by issuing \"xputs\" instead of \"puts\" in the \"on message\" event, I now receive this clear information:</p>\n\n<pre><code>MyserverBackend&gt;&gt; Close entered.  Last error:NoMethodError:undefined method `xputs' for #&lt;Myserver::MyserverBackend:0x4c9b2e8&gt;;Module:.../ruby/bin/rackup;Line:2;\n.../projects/myserver/middlewares/myserver_backend.rb:45:in `block (2 levels) in call'\n.../projects/myserver/middlewares/myserver_backend.rb:43:in `each'\n.../projects/myserver/middlewares/myserver_backend.rb:43:in `block in call'\n...\n</code></pre>\n\n<p>Before this, my client would just terminate with a 1006 and the server would give me no notice at all of what had happened.  Hope this helps someone else debug those nasty, ubiquitous 1006 errors.</p>\n\n<p>ADDED OPTION:\nI found another option.  I execute this method as the very first statement of each WS method such as open/message/close/error.  It is related to EventMachine, running under the covers within faye-websocket.  I found it <a href=\"https://stackoverflow.com/questions/7628232/how-to-catch-top-level-failures-on-an-eventmachine-server\">here</a>.</p>\n\n<pre><code>def catch_error\n  EventMachine.error_handler do |e|\n    puts \"Catch_error: #{caller[0]}: Last error:#{$!.class}:#{$!.to_s}; Module:#{$0}; Line:#{$.}; Error raised during event loop: Error:#{e.message}\" #.red\n    raise\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 4262, "user_id": 1843663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/59fdc868797104789106d0f637568198?s=128&d=identicon&r=PG", "display_name": "Richard_G", "link": "https://stackoverflow.com/users/1843663/richard-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 780, "favorite_count": 0, "accepted_answer_id": 38090050, "answer_count": 1, "score": 3, "last_activity_date": 1491182980, "creation_date": 1467171717, "last_edit_date": 1467172202, "question_id": 38089995, "link": "https://stackoverflow.com/questions/38089995/debugging-websocket-1006", "title": "Debugging websocket 1006", "body": "<p>I'm building a server based on <a href=\"https://github.com/heroku-examples/ruby-websockets-chat-demo\" rel=\"nofollow\">ruby-websockets-chat-demo</a> but have extended it to support one-to-one client/server communications across isolated channels.  I have the base server working fine at this point, but I need to continue to develop and extend upon it.</p>\n\n<p>My issue is that, anytime an error occurs within the server, a close with a 1006 is thrown to the client and it simply terminates without any clue as to what happened.  This makes sense in production, I assume, but it causes havoc with development.  </p>\n\n<p>I've tried setting my own rescues and traps, but they seem to be just ignored.  Using RubyMine, I can set breakpoints and walk through the code to find where it broke and then identify the issue, but that is a real pain.</p>\n\n<p>I don't know what is trapping the errors, whether it is faye-websocket, eventmachine, or something else, really.  Because it is caught and handled silently, it's very hard to discover.  </p>\n\n<p>Is there someway to disable this trap?  Or, what is the best way to debug issues within a faye-websocket based client and server?  Search as I might, I haven't been able to find that information.  Probably just haven't yet hit upon the appropriate search criteria.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 1214, "user_id": 2507567, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae46f1011962d615214aeef23306619c?s=128&d=identicon&r=PG", "display_name": "Rom&#225;rio", "link": "https://stackoverflow.com/users/2507567/rom%c3%a1rio"}, "is_accepted": true, "score": 7, "last_activity_date": 1467171017, "creation_date": 1467171017, "answer_id": 38089901, "question_id": 38089900, "link": "https://stackoverflow.com/questions/38089900/how-to-check-if-a-datetimes-date-is-equal-to-some-specific-date/38089901#38089901", "title": "How to check If a DateTime&#39;s date is equal to some specific Date", "body": "<p>When formulating the question, I figured <code>DateTime</code> should have a method to get its date part alone. I looked for it then I found <a href=\"http://ruby-doc.org/stdlib-2.3.0/libdoc/date/rdoc/DateTime.html#method-i-to_date\"><code>DateTime#to_date</code></a>:</p>\n\n<pre><code>d == dt.to_date  # =&gt; true\n</code></pre>\n\n<p>Should as well just post the answer, since I found no straightforward results for this on Google.</p>\n"}], "owner": {"reputation": 1214, "user_id": 2507567, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae46f1011962d615214aeef23306619c?s=128&d=identicon&r=PG", "display_name": "Rom&#225;rio", "link": "https://stackoverflow.com/users/2507567/rom%c3%a1rio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2292, "favorite_count": 0, "accepted_answer_id": 38089901, "answer_count": 1, "score": 3, "last_activity_date": 1467171017, "creation_date": 1467171017, "question_id": 38089900, "link": "https://stackoverflow.com/questions/38089900/how-to-check-if-a-datetimes-date-is-equal-to-some-specific-date", "title": "How to check If a DateTime&#39;s date is equal to some specific Date", "body": "<p>It's possible to compare <code>DateTime</code>s and <code>Date</code>s directly:</p>\n\n<pre><code>d = Date.new(2016, 6, 27)\ndt = DateTime.new(2016, 6, 22, 10, 12, 11)\n\nd &gt; dt   # =&gt; true\nd &lt;= dt  # =&gt; false\n</code></pre>\n\n<p>However, using the <code>==</code> operator to check if a <code>DateTime</code>s date is the same as some <code>Date</code> always returns false, even when they have the same date:</p>\n\n<pre><code>d = Date.new(2016, 6, 27)\ndt = DateTime.new(2016, 6, 27, 10, 20, 59)\nd == dt  # =&gt; false\nd &gt;= dt  # =&gt; false\nd &lt; dt   # =&gt; true\n</code></pre>\n\n<p>I supposed, in this case, <code>d</code> will be coerced into the equivalent of <code>DateTime.new(2016, 6, 27, 0, 0, 0)</code>, which would explain <code>d &lt; dt</code> being true.</p>\n\n<p>So, how can I check if <code>dt</code> has the same date as <code>d</code>?</p>\n"}, {"tags": ["ruby", "math"], "answers": [{"comments": [{"owner": {"reputation": 921, "user_id": 4276844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f448f2372792762904abfe0dd26366ce?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/4276844/cam"}, "edited": false, "score": 0, "creation_date": 1467172373, "post_id": 38089846, "comment_id": 63615750, "body": "Correct. For thoroughness, the complete formula for <code>C(40,20)</code> = <code>n! &#47; ((n-k)! * k!)</code> = <code>40! &#47; ((40-20)! * 20! )</code> = <code>40! &#47; (20! * 20!)</code>"}], "tags": [], "owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "is_accepted": false, "score": 3, "last_activity_date": 1467170634, "creation_date": 1467170634, "answer_id": 38089846, "question_id": 38089798, "link": "https://stackoverflow.com/questions/38089798/ruby-injection-of-factorial/38089846#38089846", "title": "Ruby Injection of factorial", "body": "<p>The formula is incorrect, you are using <code>40! / 2 * 20!</code>, whle it should be <code>40! / (20! * 20!)</code>.</p>\n\n<pre><code>(1..40).inject(:*) / ((1..20).inject(:*) ** 2)\n# =&gt; 137846528820\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6073798, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5cdccbc1fd5542c8a34c415f2629fa7?s=128&d=identicon&r=PG&f=1", "display_name": "paulsus", "link": "https://stackoverflow.com/users/6073798/paulsus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467583938, "creation_date": 1467170333, "last_edit_date": 1467583938, "question_id": 38089798, "link": "https://stackoverflow.com/questions/38089798/ruby-injection-of-factorial", "title": "Ruby Injection of factorial", "body": "<pre><code>(1..40).inject(:*) / (2*(1..20).inject(:*))\n</code></pre>\n\n<p>I should get the answer <code>137846528820</code> instead of <code>167683548393178540705382400000</code></p>\n\n<p>Could someone help me why my number is extremely large?\nI was looking for C(40,20)</p>\n"}, {"tags": ["ruby-on-rails", "angularjs", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 4065183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-b8k8kCoPP5I/AAAAAAAAAAI/AAAAAAAAAA8/mC5iBeaNP5A/photo.jpg?sz=128", "display_name": "leo277", "link": "https://stackoverflow.com/users/4065183/leo277"}, "edited": false, "score": 1, "creation_date": 1467264549, "post_id": 38089457, "comment_id": 63662285, "body": "I managed to do it. I just upload the csv file and store the rows as an array. Then I pass that variable to angularcontroller. When I submit the form, I just loop the variable with the coupon code, and do multiple transaction. The key is to edit the coupon model to allow rails to create multiple times."}], "tags": [], "owner": {"reputation": 1222, "user_id": 1777840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7fOBm.jpg?s=128&g=1", "display_name": "Kenny Chan", "link": "https://stackoverflow.com/users/1777840/kenny-chan"}, "is_accepted": false, "score": 0, "last_activity_date": 1467167997, "creation_date": 1467167997, "answer_id": 38089457, "question_id": 38089392, "link": "https://stackoverflow.com/questions/38089392/ruby-on-rails-angularjs-create-multiple-models-from-direct-upload/38089457#38089457", "title": "Ruby on rails AngularJS - create multiple models from direct upload", "body": "<p>Hmm, how I would approach this problem would be to have the user upload an csv file with 1 column and multiple rows of coupon. Using carrierwave to upload the file and parse the csv file. After parsing it, you should have an array of coupon and you can just input them into the database.</p>\n\n<p>A good reference for your problem would be <a href=\"http://railscasts.com/episodes/396-importing-csv-and-excel?view=comments\" rel=\"nofollow\">http://railscasts.com/episodes/396-importing-csv-and-excel</a></p>\n"}], "owner": {"reputation": 401, "user_id": 4065183, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-b8k8kCoPP5I/AAAAAAAAAAI/AAAAAAAAAA8/mC5iBeaNP5A/photo.jpg?sz=128", "display_name": "leo277", "link": "https://stackoverflow.com/users/4065183/leo277"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467167997, "creation_date": 1467167610, "question_id": 38089392, "link": "https://stackoverflow.com/questions/38089392/ruby-on-rails-angularjs-create-multiple-models-from-direct-upload", "title": "Ruby on rails AngularJS - create multiple models from direct upload", "body": "<p>I recently am given a task by upper management to implement a mass upload coupon task. The goal is to allow users to upload an list of coupon codes (excel or csv), and subsequently giving these coupons codes attributes such as start date, expiry, quantity and so on. </p>\n\n<p>I have already implemented a form to input these attributes. The current implementation method I am doing is as follows:</p>\n\n<p>1.I upload a list of coupon codes (eg: 333245454dfee) and I do not write them directly to the database, instead I converted them to string and display on a page for the user to view. (done)</p>\n\n<p>2.from that view page, there is a form with all the attributes. The user can then input these attributes. (done)</p>\n\n<p>3.The user can create all of these coupons codes with the attributes set. </p>\n\n<p>However, I am stuck now because I am unsure of how to mass create multiple codes and attach all the attributes to them. Right now, I can only create one coupon at a time. </p>\n\n<p>So, to summarize, I would like to ask is it possible to </p>\n\n<ol>\n<li>have a field that contains all the codes I have uploaded</li>\n<li>I have others fields for different attributes</li>\n<li>how to create all the codes I have uploaded as separate models. </li>\n</ol>\n\n<p>I do not need the codes, I would like to hear what approach there are. I am thinking of creating a variable to store these coupons codes first, then loop them. But I have no idea how to do all of that by pressing one single button.</p>\n\n<p>Thanks in advance.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "jenkins", "rubygems"], "comments": [{"owner": {"reputation": 2707, "user_id": 1540290, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02f9d39d23f7ce35ec2cc4332ac1dafc?s=128&d=identicon&r=PG", "display_name": "Lukasz Muzyka", "link": "https://stackoverflow.com/users/1540290/lukasz-muzyka"}, "edited": false, "score": 0, "creation_date": 1467164065, "post_id": 38088794, "comment_id": 63613828, "body": "you should probably look in jRuby implementation that you can run on JVM. Otherwise rails apps are not packaged as java apps, but rather ran by a web server like Unicorn or Passenger"}, {"owner": {"reputation": 247, "user_id": 1842633, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a26d35bce293e18b978f2cad5c257a6b?s=128&d=identicon&r=PG", "display_name": "user1842633", "link": "https://stackoverflow.com/users/1842633/user1842633"}, "reply_to_user": {"reputation": 2707, "user_id": 1540290, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02f9d39d23f7ce35ec2cc4332ac1dafc?s=128&d=identicon&r=PG", "display_name": "Lukasz Muzyka", "link": "https://stackoverflow.com/users/1540290/lukasz-muzyka"}, "edited": false, "score": 0, "creation_date": 1467164687, "post_id": 38088794, "comment_id": 63613968, "body": "I think you might have misunderstood me. I&#39;m not trying to package my ruby app as a Java app. I simply made the comparison to Java apps and Jar files so that people would understand the kind of file I&#39;m trying to package the ruby application as and ask if there is a ruby equivalent of a Jar file."}], "answers": [{"comments": [{"owner": {"reputation": 247, "user_id": 1842633, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a26d35bce293e18b978f2cad5c257a6b?s=128&d=identicon&r=PG", "display_name": "user1842633", "link": "https://stackoverflow.com/users/1842633/user1842633"}, "edited": false, "score": 0, "creation_date": 1467165274, "post_id": 38088950, "comment_id": 63614105, "body": "Thanks for the article! I do have some questions though. I am looking through the article and it shows them using a Ruby on Rails application. Did they package the rails application as a gem or did they start using it immediately without packaging the file. Also how would I use this dockerized application in conjunction with Jenkins? If you recall the end goal was to run this ruby application from a Jenkins job. How would I run a dockerized app in Jenkins?"}, {"owner": {"reputation": 1680, "user_id": 194932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93bba200ad6c7c64e8ec07b44e254ac?s=128&d=identicon&r=PG", "display_name": "Raphael", "link": "https://stackoverflow.com/users/194932/raphael"}, "reply_to_user": {"reputation": 247, "user_id": 1842633, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a26d35bce293e18b978f2cad5c257a6b?s=128&d=identicon&r=PG", "display_name": "user1842633", "link": "https://stackoverflow.com/users/1842633/user1842633"}, "edited": false, "score": 1, "creation_date": 1467165678, "post_id": 38088950, "comment_id": 63614221, "body": "In a development environment you can use the embed server in the rails gem by using <code>rails server</code> but in production you should build a docker image which is going to be executed by the docker container. The docker container is a manager of virtualized processes.    Jenkins has a plugin that provides docker support. <a href=\"https://wiki.jenkins-ci.org/display/JENKINS/Docker+build+step+plugin\" rel=\"nofollow noreferrer\">wiki.jenkins-ci.org/display/JENKINS/Docker+build+step+plugin</a>"}], "tags": [], "owner": {"reputation": 1680, "user_id": 194932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93bba200ad6c7c64e8ec07b44e254ac?s=128&d=identicon&r=PG", "display_name": "Raphael", "link": "https://stackoverflow.com/users/194932/raphael"}, "is_accepted": true, "score": 5, "last_activity_date": 1467201995, "last_edit_date": 1467201995, "creation_date": 1467164627, "answer_id": 38088950, "question_id": 38088794, "link": "https://stackoverflow.com/questions/38088794/what-is-the-best-way-to-package-a-ruby-on-rails-application/38088950#38088950", "title": "What is the best way to package a Ruby on Rails Application?", "body": "<p>Unlike Java applications that have packaging as a first class citizen(be it a jar or a war) this concept isn't baked in most development environments. </p>\n\n<p>That's why there a big push towards docker, it allows you to insulate your app(and gem dependencies) and plug it into the production environment much like dropping a war into a container. </p>\n\n<p>Here's an article about dockerizing a Rails app:\n<a href=\"https://semaphoreci.com/community/tutorials/dockerizing-a-ruby-on-rails-application\" rel=\"nofollow\">https://semaphoreci.com/community/tutorials/dockerizing-a-ruby-on-rails-application</a></p>\n"}], "owner": {"reputation": 247, "user_id": 1842633, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a26d35bce293e18b978f2cad5c257a6b?s=128&d=identicon&r=PG", "display_name": "user1842633", "link": "https://stackoverflow.com/users/1842633/user1842633"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2446, "favorite_count": 4, "accepted_answer_id": 38088950, "answer_count": 1, "score": 5, "last_activity_date": 1467201995, "creation_date": 1467163385, "question_id": 38088794, "link": "https://stackoverflow.com/questions/38088794/what-is-the-best-way-to-package-a-ruby-on-rails-application", "title": "What is the best way to package a Ruby on Rails Application?", "body": "<p>So I have created a ruby on rails application that functions as a basic calculator. Now I want to package this application up, upload to github, download onto Jenkins, and create a Jenkins job that will run this ruby application. </p>\n\n<p>Normally if this was a Java Application, you would package it as a jar file and then run the jar file. What would I package this Ruby application as? </p>\n\n<p>I thought about packaging this application as a Ruby Gem, but aren't Ruby Gems mainly for when you want to use your ruby app inside of another ruby application? I want to run this app as a stand alone application.</p>\n\n<p>Even if I were to package the Ruby on Rails app as a Ruby Gem, how would I run the gem as a stand alone gem? What would be the command to run it as such from the command line?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rspec-rails", "relation"], "comments": [{"owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "edited": false, "score": 0, "creation_date": 1467161018, "post_id": 38088482, "comment_id": 63613153, "body": "What is your <code>visible_to</code> method supposed to return. From your test, it looks like it is supposed to return an array with something in it. Hence when you take out the <code>[]</code>, returning an object, it fails."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 4708669, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/86e927af287dc805419ce303842a7191?s=128&d=identicon&r=PG&f=1", "display_name": "davefogo", "link": "https://stackoverflow.com/users/4708669/davefogo"}, "edited": false, "score": 0, "creation_date": 1467161794, "post_id": 38088574, "comment_id": 63613316, "body": "Even if its a single object inside of the collection it does not count as a single object?"}, {"owner": {"reputation": 855, "user_id": 882250, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0be5fe83370dcb3de42bbddcd69dc888?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/882250/jonathan"}, "reply_to_user": {"reputation": 103, "user_id": 4708669, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/86e927af287dc805419ce303842a7191?s=128&d=identicon&r=PG&f=1", "display_name": "davefogo", "link": "https://stackoverflow.com/users/4708669/davefogo"}, "edited": false, "score": 1, "creation_date": 1467161929, "post_id": 38088574, "comment_id": 63613348, "body": "Nope. Think of it like this: A parking garage with a single car inside of it is not equivalent to a single car."}, {"owner": {"reputation": 20735, "user_id": 307106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a13e655e637138f8d571cec3f9cea76?s=128&d=identicon&r=PG", "display_name": "jrochkind", "link": "https://stackoverflow.com/users/307106/jrochkind"}, "edited": false, "score": 0, "creation_date": 1467166734, "post_id": 38088574, "comment_id": 63614467, "body": "you could also do <code>expect(Topic.visible_to(nil).first).to eq(@public_topic)</code>"}], "tags": [], "owner": {"reputation": 855, "user_id": 882250, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0be5fe83370dcb3de42bbddcd69dc888?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/882250/jonathan"}, "is_accepted": true, "score": 1, "last_activity_date": 1467161567, "creation_date": 1467161567, "answer_id": 38088574, "question_id": 38088482, "link": "https://stackoverflow.com/questions/38088482/understanding-activerecordrelations-with-rspec-example/38088574#38088574", "title": "Understanding ActiveRecord::Relations with RSpec example", "body": "<p>It is hard to say without seeing the implementation of <code>visible_to</code>.</p>\n\n<p>From the first example, it looks like that method returns an <code>ActiveRecord::Relation</code> object. That is going to represent a collection of objects and not a single object.</p>\n\n<p>So, in essence, it comes down to:</p>\n\n<pre><code>object != [object]\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4708669, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/86e927af287dc805419ce303842a7191?s=128&d=identicon&r=PG&f=1", "display_name": "davefogo", "link": "https://stackoverflow.com/users/4708669/davefogo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 38088574, "answer_count": 1, "score": 0, "last_activity_date": 1467161647, "creation_date": 1467160850, "last_edit_date": 1467161647, "question_id": 38088482, "link": "https://stackoverflow.com/questions/38088482/understanding-activerecordrelations-with-rspec-example", "title": "Understanding ActiveRecord::Relations with RSpec example", "body": "<p>I have the following ROR RSpec test:</p>\n\n<p>Keep in mind that the test does pass as is in the code below. The method is correctly defined and does what is intended. The question is why when I modify and remove the [] around the @public_topic in the second example the test fails?  </p>\n\n<pre><code>describe \"scopes\" do\n    before do\n      @public_topic = Topic.create!(name: RandomData.random_sentence, description: RandomData.random_paragraph)\n      @private_topic = Topic.create!(name: RandomData.random_sentence, description: RandomData.random_paragraph, public: false)\n    end\n\n    describe \"visible_to(user)\" do\n      it \"returns all topics if user is present\" do\n          user = User.new\n          expect(Topic.visible_to(user)).to eq(Topic.all)\n      end\n      it \"returns only public topics if user is nil\" do\n        expect(Topic.visible_to(nil)).to eq([@public_topic])\n      end\n    end\n  end\n</code></pre>\n\n<p><strong>update</strong></p>\n\n<pre><code>scope :visible_to, -&gt; { where(public: true) }\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1467160135, "post_id": 38088383, "comment_id": 63612918, "body": "<a href=\"https://c9.io/\" rel=\"nofollow noreferrer\">Cloud9</a> \u2014 Please delete this question as it is off-topic for Stack Overflow."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1467160448, "post_id": 38088383, "comment_id": 63613002, "body": "Welcome to Stack Overflow. I&#39;d recommend reading &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the pages it links to, and <a href=\"http://meta.stackoverflow.com/q/261592/128421\">meta.stackoverflow.com/q/261592/128421</a>. Your question is very broad."}], "answers": [{"tags": [], "owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "is_accepted": false, "score": 0, "last_activity_date": 1467163444, "creation_date": 1467163444, "answer_id": 38088804, "question_id": 38088383, "link": "https://stackoverflow.com/questions/38088383/use-heroku-as-dev-environment/38088804#38088804", "title": "use heroku as dev environment", "body": "<p>Heroku is set up to use git for updating the site remotely. You can use windows but you will need to install Rails and Ruby. I don't think there is a solution for you involving just Heroku. Maybe Digital Ocean since you get a full on operating system and then update to Heroku from there if need be.</p>\n"}], "owner": {"reputation": 27, "user_id": 6450453, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7c5afaa9c65aab642de5557a64688a6f?s=128&d=identicon&r=PG&f=1", "display_name": "name name", "link": "https://stackoverflow.com/users/6450453/name-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1467163444, "creation_date": 1467159990, "question_id": 38088383, "link": "https://stackoverflow.com/questions/38088383/use-heroku-as-dev-environment", "title": "use heroku as dev environment", "body": "<p>I have one problem, I have now laptop and I have no opportunity to install ubuntu.\nLet's say that laptop is not mine, I am somewhere out of the city, and the owner is quite paranoid about installing something else besides windows.\nAnd I can't use virtual machine, cause I get strange errors conneted to laptop hardware.\nBut I need to programm some website, actually I need to programm some kind of forum.\nSo I want to use some forum gem.\nBut the thing is that I tried to install rails and get it running on windows and gave up cause it's  really a pain\nSo is there some way to programm everthing remotely  deploying to heroku?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1467161017, "post_id": 38088235, "comment_id": 63613152, "body": "Good or bad? There is no good or bad. Use <code>*</code> when you want to gather parameters to a method into a single variable, or to explode an array into its constituent elements, perhaps as parameters to a method. See <a href=\"http://stackoverflow.com/q/918449/128421\">stackoverflow.com/q/918449/128421</a>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1467161860, "post_id": 38088235, "comment_id": 63613334, "body": "This is a good question, but perhaps not for SO, as it is open-ended and cannot be answered objectively."}, {"owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "edited": false, "score": 0, "creation_date": 1467161999, "post_id": 38088235, "comment_id": 63613369, "body": "ok ill take a look at the link. thanks"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1467162803, "post_id": 38088670, "comment_id": 63613561, "body": "How does #2 differ from <code>super</code> without arguments? Another would be <code>[*[1,2], *[3,4]] #=&gt; [1, 2, 3, 4]</code>."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1467170725, "post_id": 38088670, "comment_id": 63615370, "body": "In this particular example, the <code>save</code> method in ActiveRecord is called under-the-hood by a number of other methods. I&#39;m not aware of what arguments they&#39;re passing. So to make sure that whatever arguments they&#39;re providing don&#39;t get ignored, I use <code>super(*args)</code>. super won&#39;t magically pass arguments when it&#39;s invoked, they have to be manually specified."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1467172098, "post_id": 38088670, "comment_id": 63615690, "body": "I don&#39;t know Rails. In pure Ruby <code>super</code> without an argument passes all arguments and, if there is one, a block. Does Rails override that behaviour?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1467173348, "post_id": 38088670, "comment_id": 63615983, "body": "I&#39;m talking about Ruby, I suppose I could be mistaken. Anyway, it doesn&#39;t break anything."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1467173964, "post_id": 38088670, "comment_id": 63616130, "body": "No, nothing is broken (unless a block needs to be passed), but the application is not a good example of the use of a splat, considering that the same can be done by invoking <code>super</code> with no parens and no arguments, which is the customary way of doing that."}, {"owner": {"reputation": 1392, "user_id": 2922609, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/JRouJ.png?s=128&g=1", "display_name": "ivanibash", "link": "https://stackoverflow.com/users/2922609/ivanibash"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1506897871, "post_id": 38088670, "comment_id": 79989266, "body": "@CarySwoveland I think max example was about being able to add arguments to the existing method without breaking existing functionality. So say <code>save</code> method originally takes 1 argument and there is a bunch of save(&#39;me&#39;) calls in your code. Then you decide that you sometimes want to call it with two arguments - <code>save(&#39;me&#39;, &#39;plz&#39;)</code>. Monkeypatching the method with the splat operator would allow you to do this without throwing an error for calls with one argument."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 1, "last_activity_date": 1467170919, "last_edit_date": 1467170919, "creation_date": 1467162299, "answer_id": 38088670, "question_id": 38088235, "link": "https://stackoverflow.com/questions/38088235/examples-of-using-splat-operator/38088670#38088670", "title": "Examples of using splat operator *", "body": "<p>I can show you a few examples of how it's used.</p>\n\n<p>Say you have a method which takes a few arguments</p>\n\n<pre><code>def foo(a,b,c)\n</code></pre>\n\n<p>And you want to call this method, provide the values for arguments using an array. You can write:</p>\n\n<pre><code>foo(*[1,2,3])\n</code></pre>\n\n<p>Another situation is you want to monkey patch a record but don't want to break the original functionality. For example, overwriting <code>save</code> in a rails model:</p>\n\n<pre><code>def save(*args)\n  # do something custom here\n  super(*args)\nend\n</code></pre>\n\n<p>This is to say \"I don't care about the arguments to this function, but I want to make sure they are all passed to the <code>super</code> call. \" </p>\n"}], "owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 38088670, "answer_count": 1, "score": 0, "last_activity_date": 1467170919, "creation_date": 1467158934, "question_id": 38088235, "link": "https://stackoverflow.com/questions/38088235/examples-of-using-splat-operator", "title": "Examples of using splat operator *", "body": "<p>After reading through documentation, and reading some examples, I'm still not satisfied with exactly the <strong>exact</strong> usage of the splat operator <code>*</code>. When is it good to use? When is it bad to use? I can find some uses of it online on documentation, but I can't seem to find any simple examples illustrating what good or bad it can cause. Thanks'</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "database-design", "ruby-on-rails-4.2"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1467162393, "post_id": 38088102, "comment_id": 63613454, "body": "You&#39;re probably taking the right approach but just need to debug. Try using byebug"}, {"owner": {"reputation": 11166, "user_id": 847116, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YLb4A.gif?s=128&g=1", "display_name": "jamesc", "link": "https://stackoverflow.com/users/847116/jamesc"}, "edited": false, "score": 0, "creation_date": 1467170549, "post_id": 38088102, "comment_id": 63615327, "body": "Look closely at the log files to see what the actual params are being passed into the create action of the song controller. Check that they meet the expectations of the class rather than your expectations. Try copying and pasting the params hash into a rails console session and use them to create a song, using logger.debug statements in the song model to see what happens. Your db structure is sound and your associations look fine to me"}, {"owner": {"reputation": 755, "user_id": 3475344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oGi4O.jpg?s=128&g=1", "display_name": "MulleOne", "link": "https://stackoverflow.com/users/3475344/mulleone"}, "edited": false, "score": 0, "creation_date": 1467211771, "post_id": 38088102, "comment_id": 63639969, "body": "@jamesaw tried but now i am getting this error:  <b>ActiveRecord::HasManyThroughCantAssociateThroughHasOneOrMany&zwnj;&#8203;Reflection in SongsController#create Cannot modify association &#39;Song#performers&#39; because the source reflection class &#39;Performer&#39; is associated to &#39;Performance&#39; via :has_many.</b>"}, {"owner": {"reputation": 755, "user_id": 3475344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oGi4O.jpg?s=128&g=1", "display_name": "MulleOne", "link": "https://stackoverflow.com/users/3475344/mulleone"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1467212186, "post_id": 38088102, "comment_id": 63640250, "body": "@maxpleaner will try that, although after this error, i&#39;m suspecting some kind of misfit somewhere in the associations."}], "owner": {"reputation": 755, "user_id": 3475344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oGi4O.jpg?s=128&g=1", "display_name": "MulleOne", "link": "https://stackoverflow.com/users/3475344/mulleone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467157989, "creation_date": 1467157989, "question_id": 38088102, "link": "https://stackoverflow.com/questions/38088102/rails-activerecord-slightly-complex-association", "title": "Rails ActiveRecord &#39;slightly&#39; complex Association", "body": "<p>I would like to structure a music web-application's database to use the following structure. </p>\n\n<p><strong>Song(Attributes: name, year, etc(any other relevant attributes))</strong></p>\n\n<ul>\n<li>has many <strong>Performances</strong></li>\n<li>has many <strong>Performers</strong> (through <strong>Performances</strong>)</li>\n<li>has many <strong>Artists</strong> (through <strong>Performers</strong>)</li>\n</ul>\n\n<p><strong>Performance(Foreign key:Song_id, Attributes: enum version: [:official, :remix, :cover])</strong></p>\n\n<ul>\n<li>belongs to <strong>Song</strong></li>\n<li>has many <strong>Performers</strong></li>\n<li>has many <strong>Artists</strong> (through <strong>Performers</strong>)</li>\n</ul>\n\n<p><strong>Performers (Foreign keys: Performance_id, Artist_id, Attributes: enum role: [:main_artist, :collaborating_artist, :featuring_artist, :versus ])</strong></p>\n\n<ul>\n<li>has one <strong>Song</strong> (through <strong>Performers</strong>)</li>\n<li>belongs to <strong>Performances</strong></li>\n<li>belongs to <strong>Artist</strong></li>\n</ul>\n\n<p><strong>Artist(Attributes: name, DOB, etc.(any other relevant attributes))</strong></p>\n\n<ul>\n<li>has many <strong>Performers</strong></li>\n<li>has many <strong>Performances</strong> (through <strong>Performers</strong>)</li>\n<li>has many <strong>Songs</strong> (through <strong>Performances</strong>)</li>\n</ul>\n\n<p>So that upon saving a Song, i can have all the rest of the other tables populated too, that is via the associations, however, so far i had the following implementations:</p>\n\n<p>Song model:</p>\n\n<pre><code>    class Song &lt; ActiveRecord::Base\n\n        #Added to make the db more logical and ended up complicated\n        has_many :performances\n        has_many :performers, :through =&gt; :performances\n        has_many :artists, :through =&gt; :performers\n\n        accepts_nested_attributes_for :artists, allow_destroy: true\n        accepts_nested_attributes_for :performers, allow_destroy: true\n        accepts_nested_attributes_for :performances, allow_destroy: true\n\n        validates :name, :presence =&gt; true, uniqueness: true\n        validates :year, :presence =&gt; true\n    end\n</code></pre>\n\n<p>Performance model:</p>\n\n<pre><code>   class Performance &lt; ActiveRecord::Base\n      enum version: [:official, :remix, :cover]\n\n      belongs_to :song\n      has_many :performers\n      has_many :artists, :through =&gt; :performers\n    end\n</code></pre>\n\n<p>Performer model:</p>\n\n<pre><code>   class Performer &lt; ActiveRecord::Base\n      enum role: [:main_artist, :collaborating_artist, :featuring_artist, :versus]\n\n      belongs_to :artist\n      belongs_to :performance\n      has_one :song, :through =&gt; :performers #this upsets the back hairs!\n    end\n</code></pre>\n\n<p>Artist model:</p>\n\n<pre><code>    class Artist &lt; ActiveRecord::Base\n\n        #Added to make the db more logical and ended up complicated\n        has_many :performers\n        has_many :performances, :through =&gt; :performers\n        has_many :songs, :through =&gt; :performances\n\n        validates :name, :presence =&gt; true, uniqueness: true\n    end\n</code></pre>\n\n<p>Song controller</p>\n\n<pre><code>class SongsController &lt; ApplicationController\n    before_action :find_song, only: [:show, :edit, :update, :destroy]\n\n    def index\n     ...\n    end\n\n    def new\n       @song = Song.new\n       @song.performers.build\n       @song.performances.build\n       @genres = Genre.all #.map{|c| [ c.name, c.id ] }\n       @countries = Country.all.map{|c| [ c.name, c.id ] }\n    end\n\n   def create\n      @song = Song.new(song_params)\n      if @song.save\n        redirect_to @song, notice: 'Successfully added a song.'\n      else\n        render 'new'\n      end\n   end\n\n   def show\n      ...\n   end\n\n   def update\n      if @song.update(song_params)\n         redirect_to @song, notice: 'Successfully updated the song.'\n      else\n         render 'edit', notice: 'Unable to save the changes'\n      end\n   end\n\n   def edit\n      ... \n   end\n\n   def destroy\n      ...\n   end\n\n   private \n\n   def song_params\n       params.require(:song).permit(:name, :year, artists_attributes: [ :id, :name, :DOB], performances_attributes: [:id, :version, :song_id], performers_attributes: [:id, :performance_id, :artist_id]) \n\n   end\n\n   def find_song\n      @song = Song.find(params[:id])\n   end\nend\n</code></pre>\n\n<p>new.html.erb</p>\n\n<pre><code>    &lt;div class=\"content\"&gt;\n        &lt;%= form_for @song, html: { multipart: true } do |f| %&gt;\n\n            &lt;% if @song.errors.any? %&gt;\n                &lt;div&gt;\n                    &lt;%= @song.errors.count %&gt;\n                    Prevented this song from saving\n                    &lt;ul&gt;\n                        &lt;% @song.errors.full_messages.each do |msg| %&gt;\n                            &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n                        &lt;% end %&gt;\n                    &lt;/ul&gt;\n                &lt;/div&gt;\n            &lt;% end %&gt;\n\n            &lt;div class=\"field\"&gt;\n                &lt;%= f.label :name %&gt;&lt;br&gt;\n                &lt;%= f.text_field :name, class: \"input-field\"  %&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"song-version\"&gt;\n                &lt;div class=\"field\"&gt;\n                    &lt;%= f.fields_for :performances do |performances_for_form| %&gt;\n                        &lt;%= render 'performances_fields', f: performances_for_form %&gt;\n                    &lt;% end %&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"performers-fields\"&gt;\n                &lt;h2&gt;Artist(s)&lt;/h2&gt;\n                &lt;div class=\"field\"&gt;\n                    &lt;%= f.fields_for :performers do |performers_for_form| %&gt;\n                        &lt;%= render 'performers_fields', f: performers_for_form %&gt;\n                    &lt;% end %&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n\n            &lt;div class\"btn\"&gt;\n                &lt;%= f.submit %&gt; \n            &lt;/div&gt;\n\n        &lt;% end %&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>Performance partial</p>\n\n<pre><code>    &lt;fieldset&gt;\n        &lt;div class=\"field\"&gt;\n          &lt;%= f.label :version %&gt;\n          &lt;%= f.select :version, Performance.versions.keys %&gt;\n        &lt;/div&gt;\n    &lt;/fieldset&gt;\n</code></pre>\n\n<p>Performer partial </p>\n\n<pre><code>    &lt;fieldset&gt;  \n        &lt;h2&gt;Artists Details&lt;/h2&gt;\n        &lt;div class=\"field\"&gt;\n            &lt;%= f.fields_for :artists do |artists_for_form| %&gt;\n                &lt;%= render 'artist_fields', f: artists_for_form %&gt;\n            &lt;% end %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"field\"&gt;\n          &lt;%= f.label :artists_role %&gt;\n          &lt;%= f.select :role, Performer.roles.keys %&gt;\n        &lt;/div&gt;\n    &lt;/fieldset&gt;\n</code></pre>\n\n<p>Artist partial</p>\n\n<pre><code>    &lt;fieldset&gt;\n        &lt;div class=\"field\"&gt;\n          &lt;%= f.label :name %&gt;\n          &lt;%= f.text_field :name %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"field\"&gt;\n          &lt;%= f.label :DOB %&gt;\n          &lt;%= f.datetime_select :DOB, :ampm =&gt; true, :minute_step =&gt; 15 %&gt;\n        &lt;/div&gt;\n    &lt;/fieldset&gt;\n</code></pre>\n\n<p>When I fill out all the data on the form, upon saving, only the <strong>Song's attributes</strong> and <strong>Performances attributes</strong> are saved to the database, while the <strong>Performers &amp; Artists</strong> are never saved, neither is the connection established, my questions are:</p>\n\n<ul>\n<li>Is this structure logically correct? If not what is it that is being incorrectly done. </li>\n<li>Is the <code>new, create methods</code> of <code>songs_controller</code> wrongly implemented and thus, the reason for not being able to save the data appropriately?</li>\n<li>What right and or best practices could be employed developing this type of web-application with this kind of database structure?</li>\n<li>Or is there any other better or succinct database structure that would better be followed rather than this?</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "slim-lang"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1467154922, "post_id": 38087544, "comment_id": 63611583, "body": "Please take the time to use proper grammar, including capitalization. Stack Overflow isn&#39;t a discussion forum. Instead, you&#39;re helping write an online reference book, where grammar and spelling counts. &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages go over this."}], "answers": [{"tags": [], "owner": {"reputation": 543, "user_id": 3401812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cmFxE.jpg?s=128&g=1", "display_name": "whb", "link": "https://stackoverflow.com/users/3401812/whb"}, "is_accepted": false, "score": 1, "last_activity_date": 1467155152, "creation_date": 1467155152, "answer_id": 38087668, "question_id": 38087544, "link": "https://stackoverflow.com/questions/38087544/slim-lang-engine-line-break/38087668#38087668", "title": "slim-lang engine line break", "body": "<p>Found it. The answer is the simplest. Just put <code>\\</code> at the end of the line.</p>\n\n<pre><code>= link_to 'New Issue', { :controller =&gt; \"issues\", action: 'new'}, \\\n  class: 'btn btn-success right'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "is_accepted": true, "score": 0, "last_activity_date": 1467811043, "creation_date": 1467811043, "answer_id": 38225059, "question_id": 38087544, "link": "https://stackoverflow.com/questions/38087544/slim-lang-engine-line-break/38225059#38225059", "title": "slim-lang engine line break", "body": "<p>You can actually do it without the backslash and keep the code looking a little cleaner. You just have to make sure your first argument is on the same line as <code>link_to</code>. Like so:</p>\n\n<pre><code>= link_to 'New Issue',\n          { :controller =&gt; \"issues\", action: 'new'},\n          class: 'btn btnsuccess right'\n</code></pre>\n"}], "owner": {"reputation": 543, "user_id": 3401812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cmFxE.jpg?s=128&g=1", "display_name": "whb", "link": "https://stackoverflow.com/users/3401812/whb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "accepted_answer_id": 38225059, "answer_count": 2, "score": 1, "last_activity_date": 1467811043, "creation_date": 1467154430, "last_edit_date": 1467154844, "question_id": 38087544, "link": "https://stackoverflow.com/questions/38087544/slim-lang-engine-line-break", "title": "slim-lang engine line break", "body": "<p>I want to use a new-line for each attribute to prettify the code: </p>\n\n<pre><code>&lt;%= link_to(\n           'New Issue', \n           { :controller =&gt; \"issues\", action: 'new'}, \n           class: 'btn btnsuccess right') %&gt;\n</code></pre>\n\n<p>and I want to do it in slim like:</p>\n\n<pre><code>= link_to (\n   'New Issue', \n    { :controller =&gt; \"issues\", action: 'new'}, \n    class: 'btn btnsuccess right')\n</code></pre>\n\n<p>with new-lines.</p>\n\n<p>Obviously I am missing something.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 1810, "user_id": 1301840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ad9bbcb458c0923c2946f85b6b98107b?s=128&d=identicon&r=PG&f=1", "display_name": "lusketeer", "link": "https://stackoverflow.com/users/1301840/lusketeer"}, "edited": false, "score": 0, "creation_date": 1467154044, "post_id": 38087458, "comment_id": 63611291, "body": "it returns the number of updated records, in this case, it&#39;s 0, so there are no records match your <code>where</code> condition"}, {"owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "reply_to_user": {"reputation": 1810, "user_id": 1301840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ad9bbcb458c0923c2946f85b6b98107b?s=128&d=identicon&r=PG&f=1", "display_name": "lusketeer", "link": "https://stackoverflow.com/users/1301840/lusketeer"}, "edited": false, "score": 0, "creation_date": 1467154172, "post_id": 38087458, "comment_id": 63611336, "body": "Yes, but I am looking to get a list of updated IDs, not only their numbers."}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467154227, "post_id": 38087458, "comment_id": 63611355, "body": "Do you want to know which records did NOT have that color before?"}, {"owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "edited": false, "score": 0, "creation_date": 1467154366, "post_id": 38087458, "comment_id": 63611402, "body": "I want to know for which records was the color set/updated."}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1467154442, "post_id": 38087458, "comment_id": 63611425, "body": "Let me ask differently: Should the list include records whose color was already the target color?"}], "answers": [{"tags": [], "owner": {"reputation": 1810, "user_id": 1301840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ad9bbcb458c0923c2946f85b6b98107b?s=128&d=identicon&r=PG&f=1", "display_name": "lusketeer", "link": "https://stackoverflow.com/users/1301840/lusketeer"}, "is_accepted": false, "score": 1, "last_activity_date": 1467154375, "creation_date": 1467154375, "answer_id": 38087533, "question_id": 38087458, "link": "https://stackoverflow.com/questions/38087458/rails-how-to-get-id-of-currently-updated-records-with-using-update-all/38087533#38087533", "title": "Rails - how to get ID of currently updated records (with using &quot;update_all&quot;)?", "body": "<p>Well, <code>update_all</code> returns the number of records that are updated.</p>\n\n<p>For your situation, what comes to mind is to simply store the ids somewhere first.</p>\n\n<pre><code>car_services = CarService.where(\"a = ? AND b = ?\", a, b) \ncar_services.update_all(color: color)\nupdated_ids = care_services.map(&amp;:id)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38790, "user_id": 665240, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/32fc08ee80cf129f6b1e8593eccb9a03?s=128&d=identicon&r=PG", "display_name": "Carl Zulauf", "link": "https://stackoverflow.com/users/665240/carl-zulauf"}, "is_accepted": false, "score": 0, "last_activity_date": 1467154996, "creation_date": 1467154996, "answer_id": 38087652, "question_id": 38087458, "link": "https://stackoverflow.com/questions/38087458/rails-how-to-get-id-of-currently-updated-records-with-using-update-all/38087652#38087652", "title": "Rails - how to get ID of currently updated records (with using &quot;update_all&quot;)?", "body": "<p><code>update_all</code> returns the number of records that were updated, so you can't get the ids \"with using <code>update_all</code>\", but you can get them from the same scope.</p>\n\n<pre><code>services = CarService.where(\"a = ? AND b = ?\", a, b)\nids = services.pluck(:id) # efficiently grab just the ids\nservices.update_all(color: color) # reuse the scope to update the records\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "is_accepted": false, "score": 0, "last_activity_date": 1467155018, "creation_date": 1467155018, "answer_id": 38087657, "question_id": 38087458, "link": "https://stackoverflow.com/questions/38087458/rails-how-to-get-id-of-currently-updated-records-with-using-update-all/38087657#38087657", "title": "Rails - how to get ID of currently updated records (with using &quot;update_all&quot;)?", "body": "<pre><code>services_to_change = CarService.where(\"a = ? AND b = ? AND color &lt;&gt; ?\", a, b, color)\nservices_to_change.update_all(color: color)\nids_of_changed_services = services_to_change.pluck(:id)\n</code></pre>\n"}], "owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1287, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1467155018, "creation_date": 1467153866, "question_id": 38087458, "link": "https://stackoverflow.com/questions/38087458/rails-how-to-get-id-of-currently-updated-records-with-using-update-all", "title": "Rails - how to get ID of currently updated records (with using &quot;update_all&quot;)?", "body": "<p>I am updating some record, like this:</p>\n\n<pre><code>CarService.where(\"a = ? AND b = ?\", a, b).update_all(color: color)\n</code></pre>\n\n<p>How do I get the IDs of records that has been updated from the query above?</p>\n\n<pre><code>updated = CarService.where(\"a = ? AND b = ?\", a, b).update_all(color: color)\n</code></pre>\n\n<p>returns only <code>0</code>.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 0, "creation_date": 1467153752, "post_id": 38087406, "comment_id": 63611181, "body": "Please explain what you mean by &quot;it is not right&quot;. <a href=\"https://stackoverflow.com/posts/38087406/edit\">Edit</a> that information into your question."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1467153830, "post_id": 38087406, "comment_id": 63611205, "body": "Give us an array sample and then desired output."}, {"owner": {"reputation": 1299, "user_id": 2923846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e45ca52b59ce69b3844c6e8b09f278c?s=128&d=identicon&r=PG", "display_name": "lwassink", "link": "https://stackoverflow.com/users/2923846/lwassink"}, "edited": false, "score": 0, "creation_date": 1467154250, "post_id": 38087406, "comment_id": 63611367, "body": "I see a few problems. <code>find_all</code> takes a block, not an argument, so you want <code>find_all { ... }</code> not <code>findall (...)</code>. Also, your opening <code>{</code> is never closed. Are you able to run this code? If not, try to post a version that at least can run even if it doesn&#39;t do exactly what you want."}, {"owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "edited": false, "score": 0, "creation_date": 1467154506, "post_id": 38087406, "comment_id": 63611446, "body": "Ok I updated the code and added a sample array"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1467158635, "post_id": 38087406, "comment_id": 63612527, "body": "You need a <code>{</code> before <code>&quot;amount&quot;=&gt;300.80</code>. Always test."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1467162142, "post_id": 38087855, "comment_id": 63613403, "body": "I believe <code>||</code> should be <code>&amp;&amp;</code>. The OP&#39;s penultimate paragraph is quite clear."}], "tags": [], "owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "is_accepted": false, "score": 0, "last_activity_date": 1467162488, "last_edit_date": 1467162488, "creation_date": 1467156295, "answer_id": 38087855, "question_id": 38087406, "link": "https://stackoverflow.com/questions/38087406/enumerablefind-all-with-exceptions-ruby/38087855#38087855", "title": "Enumerable#find_all with exceptions Ruby", "body": "<p>I believe this will do the trick:</p>\n\n<pre><code>negative_transactions = @transactions.find_all do |trans| \n  trans[\"amount\"] &lt; 0 &amp;&amp; (trans[\"category\"] != [\"BENEFITS\"] &amp;&amp; trans[\"category_id\"] != \"2106381\")\nend\n\nputs negative_transactions\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3566, "user_id": 5026139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fbf86a3072e85746a0dde45665322890?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/5026139/damon"}, "is_accepted": false, "score": 2, "last_activity_date": 1467156369, "creation_date": 1467156369, "answer_id": 38087866, "question_id": 38087406, "link": "https://stackoverflow.com/questions/38087406/enumerablefind-all-with-exceptions-ruby/38087866#38087866", "title": "Enumerable#find_all with exceptions Ruby", "body": "<p>It's still a little unclear about what you're exactly trying to accomplish here, but based on what I understand you want to:</p>\n\n<p>1) include all transactions with a negative <code>amount</code>\n2) exclude all transaction with a specified <code>category_id</code>\n3) exclude all transactions with a specefied <code>category</code></p>\n\n<p>To do this, you can do the following:</p>\n\n<pre><code>@transactions.find_all do |t|\n  t['amount'] &lt; 0 &amp;&amp;\n  t['category_id'] != '2106381' &amp;&amp;\n  t['category'] != [\"BENEFITS\"]\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1467160571, "post_id": 38087883, "comment_id": 63613036, "body": "For some, it may read better without the negation and parenthesis and to have two <code>&amp;&amp;</code>s rather than one <code>&amp;&amp;</code> and one <code>||</code>: <code>t[&quot;amount&quot;] &lt; 0 &amp;&amp; t[&quot;category_id&quot;] != &quot;2106381&quot; &amp;&amp; t[&quot;category&quot;] != &quot;Benefits&quot;</code>. Your #2 may offend sensibilities because it requires two passes."}, {"owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "edited": false, "score": 0, "creation_date": 1467162575, "post_id": 38087883, "comment_id": 63613508, "body": "Thanks! Worked like a charm!"}, {"owner": {"reputation": 2906, "user_id": 1076207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54676eedfb0abdbfbf501a05e273bc83?s=128&d=identicon&r=PG", "display_name": "SoAwesomeMan", "link": "https://stackoverflow.com/users/1076207/soawesomeman"}, "edited": false, "score": 1, "creation_date": 1467167259, "post_id": 38087883, "comment_id": 63614581, "body": "<code>@transactions.select(&amp;:negative?)</code> will only work for Ruby 2.3+, see: <a href=\"https://github.com/ruby/ruby/blob/3a48e12/numeric.c#L4196-L4197\" rel=\"nofollow noreferrer\">github.com/ruby/ruby/blob/3a48e12/numeric.c#L4196-L4197</a>"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 2906, "user_id": 1076207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54676eedfb0abdbfbf501a05e273bc83?s=128&d=identicon&r=PG", "display_name": "SoAwesomeMan", "link": "https://stackoverflow.com/users/1076207/soawesomeman"}, "edited": false, "score": 1, "creation_date": 1467167671, "post_id": 38087883, "comment_id": 63614694, "body": "@SoAwesomeMan <code>select(&amp;:negative?)</code> didn&#39;t work anyway, for reasons that in hindsight should have been obvious. I&#39;ve updated my answer. @CarySwoveland I tend to prefer affirmative expressions over negative ones, but in this case being able to drop the parentheses is a readability win, so \ud83d\udc4d\ud83c\udffb."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 4, "last_activity_date": 1467167303, "last_edit_date": 1467167303, "creation_date": 1467156472, "answer_id": 38087883, "question_id": 38087406, "link": "https://stackoverflow.com/questions/38087406/enumerablefind-all-with-exceptions-ruby/38087883#38087883", "title": "Enumerable#find_all with exceptions Ruby", "body": "<p>Your question isn't especially clear, but I suspect this does what you want:</p>\n\n<pre><code>@transactions.select do |t|\n  t[\"amount\"] &lt; 0 &amp;&amp;\n    t[\"category_id\"] != \"2106381\" &amp;&amp;\n    t[\"category\"] != \"Benefits\"\nend\n</code></pre>\n\n<p>Alternatively, this is a bit more declarative (but slightly less efficient):</p>\n\n<pre><code>@transactions.select {|t| t[\"amount\"] &lt; 0 }\n  .reject {|t| t[\"category_id\"] == \"2106381\" || t[\"category\"] == \"Benefits\" }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2906, "user_id": 1076207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54676eedfb0abdbfbf501a05e273bc83?s=128&d=identicon&r=PG", "display_name": "SoAwesomeMan", "link": "https://stackoverflow.com/users/1076207/soawesomeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1467159459, "creation_date": 1467159459, "answer_id": 38088306, "question_id": 38087406, "link": "https://stackoverflow.com/questions/38087406/enumerablefind-all-with-exceptions-ruby/38088306#38088306", "title": "Enumerable#find_all with exceptions Ruby", "body": "<p>The solution below provides three different scenarios for <code>\"amount\"</code> and formats <code>\"categories\"</code> to downcase.</p>\n\n<pre><code>require 'pp' # require pretty_print\n\n@transactions = [\n  {\"amount\"=&gt;-20, \"name\"=&gt;\"DEPOSIT\", \"category\"=&gt; [\"BENEFITS\"],\"category_id\"=&gt;\"21007000\"},\n  {\"amount\"=&gt;-0.8, \"name\"=&gt;\"XFER\", \"category\"=&gt;[\"Transfer\", \"Credit\"], \"category_id\"=&gt;\"2106381\"},\n  {\"amount\"=&gt;-20, \"name\"=&gt;\"DEPOSIT\", \"category\"=&gt;[\"Transfer\", \"Deposit\"], \"category_id\"=&gt;\"21007000\"},\n  {\"amount\"=&gt;-1, \"name\"=&gt;\"XFER\", \"category\"=&gt;[\"Transfer\", \"Credit\"], \"category_id\"=&gt;\"21005000\"},\n  {\"amount\"=&gt;300.80, \"name\"=&gt;\"XFER\", \"category\"=&gt;\"Food\", \"category_id\"=&gt;\"2106381\"}\n]\n\n# Enumerable#find_all\n# see: http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-find_all\nitems = @transactions.find_all do |t|\n\n  # 1) amount is less than zero\n  t.fetch('amount') &lt; 0 &amp;&amp; \n\n  # 2) amount is less than zero or zero\n  #t.fetch('amount') &lt;= 0 &amp;&amp; \n\n  # 3) Ruby 2.3 use core method: Numeric#negative?\n  # see: http://ruby-doc.org/core-2.3.0/Numeric.html#method-i-negative-3F\n  # see: https://github.com/ruby/ruby/blob/3a48e12/numeric.c#L4196-L4197\n  # via: http://stackoverflow.com/a/34146626\n  #t.fetch('amount').negative? &amp;&amp;\n\n  t.fetch('category_id') != '2106381' &amp;&amp;\n\n  # category is array so map and downcase before Array#include?\n  # see: http://ruby-doc.org/core-2.2.3/Array.html#method-i-map\n  # see: http://ruby-doc.org/core-2.2.3/Array.html#method-i-include-3F\n  !(t.fetch('category').map {|c| c.downcase}.include?(\"benefits\"))\nend\n\npp items\n# [{\"amount\"=&gt;-20,\n#  \"name\"=&gt;\"DEPOSIT\",\n#  \"category\"=&gt;[\"Transfer\", \"Deposit\"],\n#  \"category_id\"=&gt;\"21007000\"},\n# {\"amount\"=&gt;-1,\n#  \"name\"=&gt;\"XFER\",\n#  \"category\"=&gt;[\"Transfer\", \"Credit\"],\n#  \"category_id\"=&gt;\"21005000\"}]\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 1, "accepted_answer_id": 38087883, "answer_count": 4, "score": 2, "last_activity_date": 1467167303, "creation_date": 1467153564, "last_edit_date": 1467164560, "question_id": 38087406, "link": "https://stackoverflow.com/questions/38087406/enumerablefind-all-with-exceptions-ruby", "title": "Enumerable#find_all with exceptions Ruby", "body": "<p>I am trying to find all of the amounts that are negative in an array excluding objects that are in certain categories. Here is a sample of the array.</p>\n\n<pre><code>@transactions =\n  [{\"amount\"=&gt;-20, \"name\"=&gt;\"DEPOSIT\", \"category\"=&gt;[\"BENEFITS\"], \"category_id\"=&gt;\"21007000\"},\n   {\"amount\"=&gt;-0.8, \"name\"=&gt;\"XFER\", \"category\"=&gt;[\"Transfer\", \"Credit\"], \"category_id\"=&gt;\"2106381\"},\n   {\"amount\"=&gt;-20, \"name\"=&gt;\"DEPOSIT\", \"category\"=&gt;[\"Transfer\", \"Deposit\"],\n\"category_id\"=&gt;\"21007000\"},\n   {\"amount\"=&gt;-1, \"name\"=&gt;\"XFER\", \"category\"=&gt;[\"Transfer\", \"Credit\"],\n\"category_id\"=&gt;\"21005000\"},\n   {\"amount\"=&gt;300.80, \"name\"=&gt;\"XFER\", \"category\"=&gt;\"Food\", \"category_id\"=&gt;\"2106381\"}]\n</code></pre>\n\n<p>So far I have something like this but the syntax is wrong and it does not work. i am not even sure I can use a \"condition\" on a find_all block.</p>\n\n<pre><code>items = @transactions.find_all ( { |t| t.fetch('amount') != t.fetch('amount').abs, :conditions =&gt; [ t.fetch('category_id') == '2106381' || t.fetch('category') == [\"Benefits\"] != ?, any? ]})\n</code></pre>\n\n<p>So find all the objects with a negative number for amount and exclude the objects from that list that have the following category id or category name.</p>\n\n<p>With an output of only the objects that are negative and dont have the benefits name or category id \"2106381\"</p>\n"}, {"tags": ["ruby", "testing", "minitest"], "comments": [{"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 0, "creation_date": 1467154100, "post_id": 38087388, "comment_id": 63611315, "body": "Have you tried using just <code>Minitest::Reporters.use!</code>"}, {"owner": {"reputation": 549, "user_id": 990637, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/60525ed0c7b5fbf8502e12cd7a1cc2a4?s=128&d=identicon&r=PG", "display_name": "seane", "link": "https://stackoverflow.com/users/990637/seane"}, "reply_to_user": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 0, "creation_date": 1467316758, "post_id": 38087388, "comment_id": 63695569, "body": "@QPaysTaxes Yes, I have tried that as well. Still no change :/"}, {"owner": {"reputation": 893, "user_id": 914411, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9b060c560dbd06cebeed7c8746709661?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/914411/jeff"}, "edited": false, "score": 0, "creation_date": 1512643685, "post_id": 38087388, "comment_id": 82345622, "body": "you shoud use: <code>Minitest::Reporters.use! [Minitest::Reporters::SpecReporter.new]</code> to get the output you&#39;re looking for"}], "owner": {"reputation": 549, "user_id": 990637, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/60525ed0c7b5fbf8502e12cd7a1cc2a4?s=128&d=identicon&r=PG", "display_name": "seane", "link": "https://stackoverflow.com/users/990637/seane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467153401, "creation_date": 1467153401, "question_id": 38087388, "link": "https://stackoverflow.com/questions/38087388/minitest-reporters-does-not-change-minitest-output-style", "title": "minitest-reporters does not change minitest output style", "body": "<p>I have been trying to use the <a href=\"https://github.com/kern/minitest-reporters\" rel=\"nofollow noreferrer\"><code>minitest-reporters</code></a> gem to alter the output style of Ruby's builtin <code>minitest</code> testing library. However, it does not actually change the output.</p>\n\n<p>It should be noted that I am not using Rails or Rake, but I didn't think that would make a difference. I am simply trying to test a Ruby command-line program that I have written.</p>\n\n<p>Here's a dumb little test case (let's call it <code>dumbtest.rb</code>) that I was trying out:</p>\n\n<pre><code>require 'minitest/autorun'\nrequire 'minitest/reporters'\n\nMinitest::Reporters.use! [Minitest::Reporters::DefaultReporter.new(:color =&gt; true), Minitest::Reporters::SpecReporter.new]\n\ndescribe \"MiniTest demo\" do\n  describe \"when asked about the number 2\" do\n    it \"should be equal to the number 2\" do  \n      2.must_equal 2\n    end \n  end \nend\n</code></pre>\n\n<p>When I run the test, it just produces the default <code>minitest</code> output (i.e. colorless, no descriptions of passing tests, etc.):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ ruby -Ilib:test dumbtest.rb \nRun options: --seed 48983\n\n# Running:\n\n.\n\nFinished in 0.001356s, 737.6595 runs/s, 737.6595 assertions/s.\n\n1 runs, 1 assertions, 0 failures, 0 errors, 0 skips\n</code></pre>\n\n<p>With <code>minitest-reporters</code> enabled, I expect the output to look something more like this (i.e. list both passing and failing tests as opposed to just failing, the word <code>PASS</code> is colored green, the final summary is color-coded, etc.):</p>\n\n<p><a href=\"https://i.stack.imgur.com/Txvw5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Txvw5.png\" alt=\"enter image description here\"></a></p>\n\n<p>There are no runtime errors. It's just not working for me. Any idea why?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 16196, "user_id": 752527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e4c2e460e91d6368255ccec79e1763b?s=128&d=identicon&r=PG", "display_name": "Hanlet Esca&#241;o", "link": "https://stackoverflow.com/users/752527/hanlet-esca%c3%b1o"}, "edited": false, "score": 0, "creation_date": 1467152011, "post_id": 38087120, "comment_id": 63610532, "body": "Do you get any errors?"}, {"owner": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "edited": false, "score": 2, "creation_date": 1467152028, "post_id": 38087120, "comment_id": 63610538, "body": "For a start...Ruby isn&#39;t Python...also, you&#39;re subtracting a total age from the current <i>year</i> which is never going to be correct.  I&#39;m very confused as to what it is you&#39;re attempting to accomplish since you&#39;re <i>asking</i> the user&#39;s age to begin with!  Did you mean to ask them what year they were born in instead?"}, {"owner": {"reputation": 46515, "user_id": 5647260, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oByMV.jpg?s=128&g=1", "display_name": "Andrew Li", "link": "https://stackoverflow.com/users/5647260/andrew-li"}, "edited": false, "score": 2, "creation_date": 1467152169, "post_id": 38087120, "comment_id": 63610586, "body": "What&#39;s Phyton? Never heard of it"}, {"owner": {"reputation": 9, "user_id": 6525621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXlDo.png?s=128&g=1", "display_name": "Jesse Carter", "link": "https://stackoverflow.com/users/6525621/jesse-carter"}, "reply_to_user": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "edited": false, "score": 0, "creation_date": 1467152525, "post_id": 38087120, "comment_id": 63610737, "body": "@Makoto That&#39;s it, I explained bad in fact, I&#39;m spanish. I wanted to substract the user&#39;s age to the current year to get when was he/she born. But it closes so fast that I don&#39;t have time to read the message."}], "answers": [{"comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 1, "creation_date": 1467152486, "post_id": 38087208, "comment_id": 63610713, "body": "This doesn&#39;t work.  You want <code>gets.chomp.to_i</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1467155618, "post_id": 38087208, "comment_id": 63611776, "body": "When answering, please explain why the code is useful and why it fixes the problem. The goal is to help the person asking to understand so they don&#39;t make the same mistakes in the future."}], "tags": [], "owner": {"reputation": 2594, "user_id": 2628223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dbHga.jpg?s=128&g=1", "display_name": "BigRon", "link": "https://stackoverflow.com/users/2628223/bigron"}, "is_accepted": false, "score": 0, "last_activity_date": 1467153035, "last_edit_date": 1467153035, "creation_date": 1467152309, "answer_id": 38087208, "question_id": 38087120, "link": "https://stackoverflow.com/questions/38087120/whats-the-issue-in-this-code/38087208#38087208", "title": "What&#39;s the issue in this code?", "body": "<pre><code>puts \"We're in 2016\"\nputs \"How old are you\" \nin1 = gets.chomp.to_i\nin2 = 2016 \nout = (in2 - in1) \nputs out\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 6525621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXlDo.png?s=128&g=1", "display_name": "Jesse Carter", "link": "https://stackoverflow.com/users/6525621/jesse-carter"}, "edited": false, "score": 0, "creation_date": 1467152867, "post_id": 38087240, "comment_id": 63610865, "body": "thanks man, that helped but, what does .to_i method do?"}, {"owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "reply_to_user": {"reputation": 9, "user_id": 6525621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXlDo.png?s=128&g=1", "display_name": "Jesse Carter", "link": "https://stackoverflow.com/users/6525621/jesse-carter"}, "edited": false, "score": 0, "creation_date": 1467152985, "post_id": 38087240, "comment_id": 63610903, "body": "No problem, the .to_i means &quot;to integer&quot; I am changing your string into an integer so you can subtract values. Check out this documentation and for all other ruby related stuff. <a href=\"http://ruby-doc.org/core-2.3.1/String.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.3.1/String.html</a>"}, {"owner": {"reputation": 9, "user_id": 6525621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXlDo.png?s=128&g=1", "display_name": "Jesse Carter", "link": "https://stackoverflow.com/users/6525621/jesse-carter"}, "edited": false, "score": 0, "creation_date": 1467153172, "post_id": 38087240, "comment_id": 63610978, "body": "Thanks again, that helped. Maybe for future programs. :D"}], "tags": [], "owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "is_accepted": false, "score": 1, "last_activity_date": 1467152481, "creation_date": 1467152481, "answer_id": 38087240, "question_id": 38087120, "link": "https://stackoverflow.com/questions/38087120/whats-the-issue-in-this-code/38087240#38087240", "title": "What&#39;s the issue in this code?", "body": "<p>For the correct code, this is how it should be. Whether this is the result you want is another matter.</p>\n\n<pre><code> puts \"We're in 2016\"\n puts \"How old are you\"\n in1 = gets.chomp\n in2 = 2016\n out = (in2 - in1.to_i)\n print out\n</code></pre>\n\n<p>For starters, if you want to learn python then just go ahead and learn python. Ruby like other languages have their own way of doing things so writing Ruby in a Python like way just doesn't make sense at all. For returning the age of a user all you need to do is this:</p>\n\n<pre><code>puts \"We're in 2016\"\nputs \"How old are you\"\nin1 = gets.chomp\nprint in1\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6525621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXlDo.png?s=128&g=1", "display_name": "Jesse Carter", "link": "https://stackoverflow.com/users/6525621/jesse-carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1468843207, "answer_count": 2, "score": -4, "last_activity_date": 1467153035, "creation_date": 1467151855, "last_edit_date": 1467152711, "question_id": 38087120, "link": "https://stackoverflow.com/questions/38087120/whats-the-issue-in-this-code", "closed_reason": "Not suitable for this site", "title": "What&#39;s the issue in this code?", "body": "<p>I'm trying to get the year in which the user was born. This is my current code:</p>\n\n<pre><code>puts \"We're in 2016\"\nputs \"How old are you\"\nin1 = gets.chomp\nin2 = 2016\nout = (in2 - in1)\nprint out\ngets()  \n</code></pre>\n\n<p>I'm trying to do this like in Python. Can someone tell me what the issue is?</p>\n"}, {"tags": ["ruby", "json"], "answers": [{"tags": [], "owner": {"reputation": 38790, "user_id": 665240, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/32fc08ee80cf129f6b1e8593eccb9a03?s=128&d=identicon&r=PG", "display_name": "Carl Zulauf", "link": "https://stackoverflow.com/users/665240/carl-zulauf"}, "is_accepted": false, "score": 0, "last_activity_date": 1467156195, "creation_date": 1467156195, "answer_id": 38087840, "question_id": 38087029, "link": "https://stackoverflow.com/questions/38087029/ruby-json-parse-non-integer-numbers-as-strings-or-bigdecimal/38087840#38087840", "title": "Ruby JSON parse non-integer numbers as strings (or BigDecimal)", "body": "<p>In theory JSON as a container could hold highly precise numbers, but in practice one end is generally limited to IEEE 754 double precision floating point numbers as that is what JavaScript itself is limited to. Any precision loss will already be incurred if the values are encoded in JavaScript or almost any JSON implementation.</p>\n\n<p>Hence, converting to <code>BigDecimal</code> from the parsed <code>Float</code> will almost always result in no additional loss of precision:</p>\n\n<pre><code>data = JSON.parse(\"[1.025]\")\n# Float can't represent decimal values precisely, so `round` fails\ndata.first.round(2) # =&gt; 1.02\n# Converting to big decimal improves the precision of future operations\nBigDecimal.new(data.first.to_s).round(2).to_s # =&gt; \"1.03\"\n</code></pre>\n\n<p>You are much better off transporting your highly precise values as strings.</p>\n\n<p>Lastly, if you really need to ruby libraries can always be monkey patched to behave how you want.</p>\n"}], "owner": {"reputation": 24753, "user_id": 489765, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bdc5163fd78b041c9d4a405204c5ad9a?s=128&d=identicon&r=PG", "display_name": "aromero", "link": "https://stackoverflow.com/users/489765/aromero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1063, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467156195, "creation_date": 1467151393, "last_edit_date": 1467151740, "question_id": 38087029, "link": "https://stackoverflow.com/questions/38087029/ruby-json-parse-non-integer-numbers-as-strings-or-bigdecimal", "title": "Ruby JSON parse non-integer numbers as strings (or BigDecimal)", "body": "<p>Is there any way to tell the default ruby JSON library to parse non-integer numeric values as string (or BigDecimal?) instead of floats?</p>\n\n<p>ie <code>JSON.parse('{\"foo\": 123.45}')['foo'].class</code> outputs <code>Float</code>, which may lead to precision issues. </p>\n\n<p>PD: the oj library supports loading these values as BigDecimals.</p>\n\n<p>PD2: seems there isn't: <a href=\"https://github.com/flori/json/blob/76f41a84e2bace20c3076aba53887537e37dfdb2/lib/json/pure/parser.rb#L196\" rel=\"nofollow\">https://github.com/flori/json/blob/76f41a84e2bace20c3076aba53887537e37dfdb2/lib/json/pure/parser.rb#L196</a></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1467150971, "post_id": 38086622, "comment_id": 63610143, "body": "What happens you request a non-live IP? Does it just hang or does it throw a error?"}, {"owner": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1467151888, "post_id": 38086622, "comment_id": 63610490, "body": "It just hangs. I was hoping it&#39;d throw an error so I can catch it and ignore it but that&#39;s not the case"}], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "edited": false, "score": 0, "creation_date": 1467156765, "post_id": 38087134, "comment_id": 63612071, "body": "That makes sense but quick question: if I have <a href=\"https://IP\" rel=\"nofollow noreferrer\">IP</a> or <a href=\"http://ip\" rel=\"nofollow noreferrer\">ip</a> in my list would that still work? Or should I just change it IP and assign it a uri.port value ?"}, {"owner": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "edited": false, "score": 0, "creation_date": 1467156857, "post_id": 38087134, "comment_id": 63612103, "body": "I get an error for URI::InvalidURIError with or without the http(s) behind the IP for an IP like 1.1.1.1 (not a real IP)"}, {"owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "reply_to_user": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "edited": false, "score": 0, "creation_date": 1467181659, "post_id": 38087134, "comment_id": 63619076, "body": "@user3610137I update my answer to respond to your question. You don&#39;t need to specify a port with <code>URI.parse</code> method, but it needs <code>http:&#47;&#47;</code> or <code>https:&#47;&#47;</code> before the address. Really strange your errror <code>URI::InvalidURIError</code>, Do you have pass the address to <code>URI.parse</code> as a string?"}, {"owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "reply_to_user": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "edited": false, "score": 0, "creation_date": 1467632397, "post_id": 38087134, "comment_id": 63793411, "body": "@user3610137 did you solve the problem? I was not able to reproduce your errors, did you look the update of the answer?"}, {"owner": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "edited": false, "score": 0, "creation_date": 1467744275, "post_id": 38087134, "comment_id": 63844920, "body": "I&#39;m still getting the following with just 1.1.1.1 when I run your 2nd code snippet : ruby-2.2.2/lib/ruby/2.2.0/uri/rfc3986_parser.rb:66:in `split&#39;: bad URI(is not URI?): {:http=&gt;//} (URI::InvalidURIError)"}, {"owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "reply_to_user": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "edited": false, "score": 0, "creation_date": 1467751344, "post_id": 38087134, "comment_id": 63848783, "body": "@user3610137 mmh strange. From the error message it seems you are not passing <code>1.1.1.1</code>, but <code>&#47;&#47;</code> as address to URI. See this line of code <a href=\"https://github.com/ruby/ruby/blob/ruby_2_2/lib/uri/rfc3986_parser.rb#L66\" rel=\"nofollow noreferrer\">github.com/ruby/ruby/blob/ruby_2_2/lib/uri/&hellip;</a>  Could you share the file with addresses or part of these? Maybe is a problem of encoding or similar."}, {"owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "reply_to_user": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "edited": false, "score": 0, "creation_date": 1467755984, "post_id": 38087134, "comment_id": 63850781, "body": "@user3610137 I was able to reproduce your problem :) you need to encode the uri. I&#39;ve just update the answer (the 2nd snippet), let me know if it works for you"}, {"owner": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "edited": false, "score": 0, "creation_date": 1467838476, "post_id": 38087134, "comment_id": 63888792, "body": "Is &quot;execution expired&quot; being thrown out if it&#39;s unresponsive?"}, {"owner": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "edited": false, "score": 0, "creation_date": 1467838567, "post_id": 38087134, "comment_id": 63888842, "body": "ah I see. That&#39;s from `    rescue Timeout::Error, URI::Error, SocketError =&gt; e       puts e`"}], "tags": [], "owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "is_accepted": true, "score": 2, "last_activity_date": 1467755894, "last_edit_date": 1467755894, "creation_date": 1467151900, "answer_id": 38087134, "question_id": 38086622, "link": "https://stackoverflow.com/questions/38086622/skipping-unresponsive-host-using-net-http/38087134#38087134", "title": "Skipping unresponsive host using net/http", "body": "<p>You could simply wrap your request in <code>begin/rescue</code> block like this: </p>\n\n<pre><code>  File.open(\"internalcorpIPs\", \"r\") do |f|\n    f.each_line do |line|\n      puts line\n      begin\n        # strip and encode uri from the file\n        uri = URI.parse(URI.encode(line.strip))\n        res = Net::HTTP.get_response(uri)\n        getCode = res.code\n      rescue Timeout::Error =&gt; e\n        puts e\n        false\n      end\n    end\n  end\n</code></pre>\n\n<p>But you will wait for 60 seconds at least before going in timeout, so I suggest to decrease the timeout. Furthermore, you could introduce an additional guard clause to check if the uri contains the scheme <code>http://</code> or <code>https://</code>, otherwise raise an exception (or something else).</p>\n\n<pre><code>require 'net/http'\n\nFile.open(\"internalcorpIPs\", \"r\") do |f|\n  f.each do |line|\n    puts line\n\n    begin\n      # strip and encode uri from the file\n      uri = URI.parse(URI.encode(line.strip))\n\n      # if uri misses the schema (http:// or https://) -&gt; raise error\n      raise URI::Error, \"uri #{uri} miss the scheme\" unless uri.scheme\n\n      http = Net::HTTP.new(uri.host, uri.port)\n      http.open_timeout = 2 # seconds\n      http.read_timeout = 2 # seconds\n\n      http.start do |conn|\n         response = conn.request_get(path = '/')\n         puts response.code\n      end\n    rescue Timeout::Error, URI::Error, SocketError =&gt; e\n      puts e\n      false\n    end\n  end\nend\n</code></pre>\n\n<p>Additional notes:</p>\n\n<p><strong>Open Timeout</strong></p>\n\n<blockquote>\n  <p>Number of seconds to wait for the connection to open. Any number may be used, including Floats for fractional seconds. If the HTTP object cannot open a connection in this many seconds, it raises a Net::OpenTimeout exception. The default value is 60 seconds.</p>\n</blockquote>\n\n<p><strong>Read Timeout</strong></p>\n\n<blockquote>\n  <p>Number of seconds to wait for one block to be read (via one read(2) call). Any number may be used, including Floats for fractional seconds. If the HTTP object cannot read data in this many seconds, it raises a Net::ReadTimeout exception. The default value is 60 seconds.</p>\n</blockquote>\n\n<p><strong>URI Scheme</strong></p>\n\n<p>Difference between generic uri (<code>URI::Generic</code>) and http uri (<code>URI::HTTP</code>).</p>\n\n<pre><code> uri = URI.parse('1.1.1.1')\n =&gt; #&lt;URI::Generic 1.1.1.1&gt; \n uri.scheme\n =&gt; nil \n uri.host\n =&gt; nil \n uri.port\n =&gt; nil \n uri.path\n =&gt; \"1.1.1.1\" \n\n uri = URI.parse('http://1.1.1.1')\n =&gt; #&lt;URI::HTTP http://1.1.1.1&gt; \n uri.scheme\n =&gt; \"http\" \n uri.host\n =&gt; \"1.1.1.1\" \n uri.port\n =&gt; 80 \n uri.path\n =&gt; \"\" \n</code></pre>\n\n<p>references: </p>\n\n<ul>\n<li><a href=\"http://ruby-doc.org/stdlib-2.3.1/libdoc/net/http/rdoc/Net/HTTP.html\" rel=\"nofollow\"><code>Net::HTTP</code> Api</a></li>\n<li><a href=\"http://ruby-doc.org/stdlib-2.1.1/libdoc/uri/rdoc/URI.html\" rel=\"nofollow\"><code>URI</code> Module</a></li>\n</ul>\n\n<p>hope it helps!</p>\n\n<h3>UPDATE</h3>\n\n<p><a href=\"http://ruby-doc.org/stdlib-2.1.0/libdoc/uri/rdoc/URI/Parser.html#method-i-parse\" rel=\"nofollow\"><code>URI.parse</code></a> accepts a string as argument and automatically set the port if not specified:</p>\n\n<pre><code>\u276f irb\n2.2.0 :001 &gt; require 'net/http'\n =&gt; true \n2.2.0 :002 &gt; uri = URI.parse('http://1.1.1.1')\n =&gt; #&lt;URI::HTTP http://1.1.1.1&gt; \n2.2.0 :003 &gt; uri.host\n =&gt; \"1.1.1.1\" \n2.2.0 :004 &gt; uri.port\n =&gt; 80 \n2.2.0 :005 &gt; uri2 = URI.parse('http://mydomain')\n =&gt; #&lt;URI::HTTP http://mydomain&gt; \n2.2.0 :006 &gt; uri2.host\n =&gt; \"mydomain\" \n2.2.0 :007 &gt; uri2.port\n =&gt; 80 \n2.2.0 :008 &gt; uri3 = URI.parse('https://mydomain')\n =&gt; #&lt;URI::HTTPS https://mydomain&gt; \n2.2.0 :009 &gt; uri3.host\n =&gt; \"mydomain\" \n2.2.0 :010 &gt; uri3.port\n =&gt; 443 \n</code></pre>\n"}], "owner": {"reputation": 255, "user_id": 3610137, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/de66072482fa86fef2dabdb8eb8cb371?s=128&d=identicon&r=PG&f=1", "display_name": "user3610137", "link": "https://stackoverflow.com/users/3610137/user3610137"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 38087134, "answer_count": 1, "score": 0, "last_activity_date": 1467755894, "creation_date": 1467149361, "question_id": 38086622, "link": "https://stackoverflow.com/questions/38086622/skipping-unresponsive-host-using-net-http", "title": "Skipping unresponsive host using net/http", "body": "<p>I am using net/http to send a bunch of request to some internal IP addresses. </p>\n\n<p>Here's a snippet of the code:</p>\n\n<pre><code>  File.open(\"internalcorpIPs\", \"r\") do |f|\n    f.each_line do |line|\n      puts line\n      res = Net::HTTP.get_response(URI.parse(line))\n      getCode = res.code\n    end\n  end\n</code></pre>\n\n<p>I'm strictly just making a request to <a href=\"http://IP\">http://IP</a> and <a href=\"https://IP\">https://IP</a> but it seems like this method only works if every single IP/line address is live. How do I skip IP addresses with no webserver (or 80/443 ports)? </p>\n\n<p>Is it possible to make it read the line, and move on to the next if no response code was returned?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "is_accepted": true, "score": 2, "last_activity_date": 1467149637, "creation_date": 1467149637, "answer_id": 38086682, "question_id": 38086397, "link": "https://stackoverflow.com/questions/38086397/controller-test-with-stub-using-rails-4-and-rspec-3-4/38086682#38086682", "title": "Controller test with stub using Rails 4 and Rspec 3.4", "body": "<p>Something like this should work:</p>\n\n<pre><code>allow(IntegrationProvider).to receive_message_chain(:new, :proxy_to, :find_by).and_return(yourproviderobjecthere)\n</code></pre>\n"}], "owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 38086682, "answer_count": 1, "score": 0, "last_activity_date": 1516702774, "creation_date": 1467148432, "last_edit_date": 1516702774, "question_id": 38086397, "link": "https://stackoverflow.com/questions/38086397/controller-test-with-stub-using-rails-4-and-rspec-3-4", "title": "Controller test with stub using Rails 4 and Rspec 3.4", "body": "<p>In my controller I have the following method:</p>\n\n<pre><code>  def set_provider\n    @provider = Provider.find_by(id: params[:id])\n    return @provider unless @provider.active\n    @provider = IntegrationProvider.new(@provider.slug).proxy_to.find_by(id: params[:id])\n  end\n</code></pre>\n\n<p>Which I am trying cover with the following test:</p>\n\n<pre><code>context 'active' do\n  before do\n    @provider = FactoryGirl.create(:provider, :active)\n    get :show, id: @provider.id\n  end\n\n  it '200' do\n    expect(response.status).to be(200)\n  end\n\n  it 'assigns @provider' do\n    expect(assigns(:provider)).to eq(@provider)\n  end\nend\n</code></pre>\n\n<p>The IntegrationProvider class is basically a child model of the Provider model. Since these can be dynamic, and I am using FactoryGirl I am thinking a stub would work best here.  In the code base the slugs correspond to folders so I do not want to test that other class in this controller class. I will save that for my lib class tests.  </p>\n\n<p><strong>Question</strong></p>\n\n<p>How would you stub that IntegrationsProvider class so it returns the Provider model?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 1, "creation_date": 1467153918, "post_id": 38086328, "comment_id": 63611250, "body": "Can you check your third example (<code>Foo.const_get(&#39;Foo::Foo&#39;)</code>)? I get just <code>Foo</code>, not <code>Foo::Foo</code>."}, {"owner": {"reputation": 1321, "user_id": 1025695, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8980c65a94bb9a9a5526d464791b7644?s=128&d=identicon&r=PG", "display_name": "Huliax", "link": "https://stackoverflow.com/users/1025695/huliax"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1467198486, "post_id": 38086328, "comment_id": 63629856, "body": "@matt You are correct, it does just return <code>Foo</code>.  Edited original question."}, {"owner": {"reputation": 544, "user_id": 2252982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a01a7d5f98e57c8f65e21d0768c2a0?s=128&d=identicon&r=PG&f=1", "display_name": "Spandan Singh", "link": "https://stackoverflow.com/users/2252982/spandan-singh"}, "edited": false, "score": 0, "creation_date": 1575914006, "post_id": 38086328, "comment_id": 104717990, "body": "@Huliax Is there a way to get the object instance if both the module and the nested module name is same, just like Foo:Foo"}], "answers": [{"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 23, "last_activity_date": 1467154624, "creation_date": 1467154624, "answer_id": 38087580, "question_id": 38086328, "link": "https://stackoverflow.com/questions/38086328/how-does-rubys-objectconst-get-actually-work/38087580#38087580", "title": "How does Ruby&#39;s Object#const_get actually work?", "body": "<p><a href=\"http://ruby-doc.org/core-2.3.1/Module.html#method-i-const_get\" rel=\"noreferrer\">The docs say</a>:</p>\n\n<blockquote>\n  <p>This method will recursively look up constant names if a namespaced class name is provided.</p>\n</blockquote>\n\n<p>So <code>Foo.const_get('Foo::Bar')</code> is basically the same as <code>Foo.const_get('Foo').const_get('Bar')</code>. Using this interpretation your results make sense.</p>\n\n<p>Your third example:</p>\n\n<pre><code>Foo.const_get('Foo::Foo')\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>Foo.const_get('Foo').const_get('Foo')\n</code></pre>\n\n<p>The first <code>const_get</code> looks at constants defined within the top level <code>Foo</code> (the module), and finds the nested class. So the whole thing effectively becomes:</p>\n\n<pre><code>Foo::Foo.const_get('Foo')\n</code></pre>\n\n<p>The second call then looks at the class, first looking the any contained constants (finding none) and then looking in its ancestors. <code>Object</code> is an ancestor, and has the top level <code>Foo</code> module as a constant, so this is found and returned.</p>\n\n<p>This also explains the alternation when adding extra <code>::Foo</code>s. The alternation is between <code>const_get</code> on the top level module finding the nested class, and on the nested class looking up the inheritance chain and finding the top level module.</p>\n\n<p>The fourth example, <code>Foo.const_get('Foo::Bar')</code>, which raises an exception, can also be explained. It is equivalent to</p>\n\n<pre><code>Foo.const_get('Foo').const_get('Bar')\n</code></pre>\n\n<p>The first part, <code>Foo.const_get('Foo')</code> is the same as the case above, evaluating to <code>Foo::Foo</code>, so the whole thing now effectively becomes:</p>\n\n<pre><code>Foo::Foo.const_get('Bar')\n</code></pre>\n\n<p>Now the nested <code>Foo</code> class doesn\u2019t contain a <code>Bar</code> constant, and looking up the inheritance chain, neither does <code>Object</code>, so the result is a <code>NameError</code>.</p>\n"}], "owner": {"reputation": 1321, "user_id": 1025695, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8980c65a94bb9a9a5526d464791b7644?s=128&d=identicon&r=PG", "display_name": "Huliax", "link": "https://stackoverflow.com/users/1025695/huliax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6751, "favorite_count": 3, "accepted_answer_id": 38087580, "answer_count": 1, "score": 17, "last_activity_date": 1467198610, "creation_date": 1467148152, "last_edit_date": 1467198610, "question_id": 38086328, "link": "https://stackoverflow.com/questions/38086328/how-does-rubys-objectconst-get-actually-work", "title": "How does Ruby&#39;s Object#const_get actually work?", "body": "<p>I have recently discovered that Ruby (2.2.1) has some \"interesting\" behavior.</p>\n\n<pre><code>module Foo\n  class Foo\n  end\n  class Bar\n  end\nend\n\nFoo.const_get('Foo') #=&gt; Foo::Foo\nFoo.const_get('Bar') #=&gt; Foo::Bar\nFoo.const_get('Foo::Foo') #=&gt; Foo\nFoo.const_get('Foo::Bar') #=&gt; NameError: uninitialized constant Foo::Foo::Bar\nFoo.const_get('Foo::Foo::Bar') #=&gt; Foo::Bar\nFoo.const_get('Foo::Foo::Foo::Bar') #=&gt; NameError: uninitialized constant Foo::Foo::Bar\nFoo.const_get('Foo::Foo::Foo::Foo::Bar') #=&gt; Foo::Bar\nFoo.const_get('Foo::Foo::Foo') #=&gt; Foo::Foo\nFoo.const_get('Foo::Foo::Foo::Foo') #=&gt; Foo\nFoo.const_get('Foo::Foo::Foo::Foo::Foo') #=&gt; Foo::Foo\nFoo.const_get('Foo::Foo::Foo::Foo::Foo::Foo') #=&gt; Foo\n</code></pre>\n\n<p>This is a bit surprising.  My understanding has been that <code>const_get</code> first looks for a constant in the receiver's collection of constants and then looks at Object's constants.  OK, fine. Why then does the fourth <code>Foo#const_get</code> above fail and the third one doesn't? </p>\n\n<p>I'm also curious as to why calling <code>Foo#const_get</code> alternates between the module and class depending on how many <code>::Foo</code>s you add.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano", "rvm-capistrano", "multi-configuration"], "answers": [{"tags": [], "owner": {"reputation": 479, "user_id": 1123850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/COCt2.png?s=128&g=1", "display_name": "Sofia Bravo", "link": "https://stackoverflow.com/users/1123850/sofia-bravo"}, "is_accepted": true, "score": 0, "last_activity_date": 1467152250, "creation_date": 1467152250, "answer_id": 38087193, "question_id": 38085591, "link": "https://stackoverflow.com/questions/38085591/why-is-capistrano-multiconfig-not-working/38087193#38087193", "title": "Why is capistrano multiconfig not working?", "body": "<p>It was a bug with capistrano-multiconfig v3.0.9, now fixed in v3.0.10</p>\n"}], "owner": {"reputation": 479, "user_id": 1123850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/COCt2.png?s=128&g=1", "display_name": "Sofia Bravo", "link": "https://stackoverflow.com/users/1123850/sofia-bravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 38087193, "answer_count": 1, "score": 2, "last_activity_date": 1467152250, "creation_date": 1467145269, "last_edit_date": 1467146361, "question_id": 38085591, "link": "https://stackoverflow.com/questions/38085591/why-is-capistrano-multiconfig-not-working", "title": "Why is capistrano multiconfig not working?", "body": "<p>I had a working capistrano setup for my app but I installed the multiconfig gem so that I could deploy to two different servers using capistrano. Running </p>\n\n<p><code>cap primary:production deploy</code> </p>\n\n<p>works perfectly, but when I run <code>rails s</code> I get this error:</p>\n\n<pre><code>rails s \n\n/home/sofia/.rvm/gems/ruby-2.2.2@big/gems/capistrano-multiconfig-3.0.9/lib/capistrano/multiconfig.rb:3:in `&lt;top (required)&gt;': uninitialized constant Capistrano::DSL (NameError)\n    from /home/sofia/.rvm/gems/ruby-2.2.2@big/gems/bundler-1.12.5/lib/bundler/runtime.rb:100:in `require'\n    from /home/sofia/.rvm/gems/ruby-2.2.2@big/gems/bundler-1.12.5/lib/bundler/runtime.rb:100:in `rescue in block in require'\n    ...\n</code></pre>\n\n<p>This is the directories inside my <code>config/</code> folder:</p>\n\n<pre><code>deploy\ndeploy/secondary\ndeploy/secondary/production.rb.example\ndeploy/secondary/production.rb\ndeploy/staging.rb\ndeploy/primary\ndeploy/primary/production.rb.example\ndeploy/primary/production.rb\n</code></pre>\n\n<p>This is my capfile</p>\n\n<pre><code># Load DSL and set up stages\n# require 'capistrano/setup'# The README says to remove this line\n                            # and leaving it on does not change anything anyway\n\nrequire 'capistrano/multiconfig'\n\n\n# Include default deployment tasks\nrequire 'capistrano/deploy'\n\nrequire 'capistrano/rvm'\nrequire 'capistrano/bundler'\nrequire 'capistrano/rails/assets'\nrequire 'capistrano/rails/migrations'\nrequire 'capistrano/passenger'\nrequire \"whenever/capistrano\"\n\n\n# Load custom tasks from `lib/capistrano/tasks` if you have any defined\nDir.glob('lib/capistrano/tasks/*.rake').each { |r| import r }\n</code></pre>\n\n<p>This is my Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rest-client'\n\ngem 'yui-compressor'\ngem 'pg'\ngem 'react-rails', '~&gt; 1.5.0'\n\ngem \"paperclip\", \"~&gt; 4.3\"\n\ngem 'aws-sdk-rails'\n\ngem 'whenever', :require =&gt; false\ngem 'tod'\n\n...\n\ngroup :development, :test do\n  gem 'byebug'\nend\n\ngroup :development do\n  gem 'capistrano'\n  gem 'capistrano-bundler'\n  gem 'capistrano-passenger', '&gt;= 0.1.1'\n  gem 'capistrano-rails'\n  gem 'capistrano-rvm'\n  # Allows us to specify a separate configuration for each application/service\n  gem \"capistrano-multiconfig\"\n\n\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; in views\n  gem 'railroady'\n  gem 'web-console', '~&gt; 2.0'\n  gem 'letter_opener'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "coffeescript", "mongoid5"], "comments": [{"owner": {"reputation": 4688, "user_id": 2116518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwt8F.jpg?s=128&g=1", "display_name": "Nic Nilov", "link": "https://stackoverflow.com/users/2116518/nic-nilov"}, "edited": false, "score": 1, "creation_date": 1467144722, "post_id": 38085389, "comment_id": 63607213, "body": "One option is using <a href=\"https://www.devbridge.com/sourcery/components/jquery-autocomplete/\" rel=\"nofollow noreferrer\">jQuery Autocomplete control</a>."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1467154241, "post_id": 38085389, "comment_id": 63611361, "body": "With a word list that short it probably makes sense to do it on the client-side, i.e. send the entire word list to the browser on page load (versus doing an Ajax request on every keystroke) and then use a component like <a href=\"https://twitter.github.io/typeahead.js/\" rel=\"nofollow noreferrer\">typeahead.js</a> (or the jQuery plugin Nic mentioned) to handle the user interaction."}, {"owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1467154666, "post_id": 38085389, "comment_id": 63611492, "body": "@Jordan even if it has to get the wordlist by going thru an array of objects and pulling the &quot;name&quot; characteristic from each object in the array?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1467155072, "post_id": 38085389, "comment_id": 63611632, "body": "It&#39;s hard to say without knowing the details of your implementation. You&#39;re going to have to do that work at some point, whether it&#39;s up-front on the server, up-front on the client, or partially on the server upon each keypress. I suggest doing whatever&#39;s simplest now and optimizing later if you run into performance problems. (typeahead.js, for its part, ought to work either way, as will many other such components.)"}, {"owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "edited": false, "score": 0, "creation_date": 1467155873, "post_id": 38085389, "comment_id": 63611837, "body": "ok I think I will create the list in the action before loading the page, thanks for the advice."}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "edited": false, "score": 0, "creation_date": 1467155944, "post_id": 38085667, "comment_id": 63611851, "body": "Thanks I will give it a try!"}], "tags": [], "owner": {"reputation": 1827, "user_id": 1362329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRckP.jpg?s=128&g=1", "display_name": "neydroid", "link": "https://stackoverflow.com/users/1362329/neydroid"}, "is_accepted": true, "score": 1, "last_activity_date": 1467145556, "creation_date": 1467145556, "answer_id": 38085667, "question_id": 38085389, "link": "https://stackoverflow.com/questions/38085389/finding-name-variations-from-large-list-ruby/38085667#38085667", "title": "Finding name variations from large list Ruby", "body": "<p>If you want to do it in ruby you could use a fuzzy match algorithm, like the one used in this gem <a href=\"https://github.com/seamusabshere/fuzzy_match\" rel=\"nofollow\">https://github.com/seamusabshere/fuzzy_match</a> check the example:</p>\n\n<pre><code>&gt;&gt; FuzzyMatch.new(['seamus', 'andy', 'ben']).find('Shamus')\n=&gt; \"seamus\"\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 3877058, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/100001362273089/picture?type=large", "display_name": "SupremeA", "link": "https://stackoverflow.com/users/3877058/supremea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 38085667, "answer_count": 1, "score": 1, "last_activity_date": 1467145556, "creation_date": 1467144571, "question_id": 38085389, "link": "https://stackoverflow.com/questions/38085389/finding-name-variations-from-large-list-ruby", "title": "Finding name variations from large list Ruby", "body": "<p>I have a large list of words maybe 300-600 words and I want to make it so that as my user begins typing in a word the app suggest words that it found from my specific list that are close to the spelling that person is giving. Kind of like auto-complete but the list of words is dynamic and specific to that user. Any gems or techniques suggestions on how I can accomplish this?</p>\n"}]