[{"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "devise"], "comments": [{"owner": {"reputation": 1723, "user_id": 4735914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d998392dbbbd8061d2ef13ea60955633?s=128&d=identicon&r=PG&f=1", "display_name": "jdgray", "link": "https://stackoverflow.com/users/4735914/jdgray"}, "edited": false, "score": 0, "creation_date": 1513819956, "post_id": 47915834, "comment_id": 82801406, "body": "See if this helps: <a href=\"https://stackoverflow.com/questions/531393/how-to-detect-server-side-whether-cookies-are-disabled\" title=\"how to detect server side whether cookies are disabled\">stackoverflow.com/questions/531393/&hellip;</a>"}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 1723, "user_id": 4735914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d998392dbbbd8061d2ef13ea60955633?s=128&d=identicon&r=PG&f=1", "display_name": "jdgray", "link": "https://stackoverflow.com/users/4735914/jdgray"}, "edited": false, "score": 0, "creation_date": 1513843122, "post_id": 47915834, "comment_id": 82808267, "body": "Thanks but the SO link you provide is really general http-request and javascript. My question was how to deal with this issue within the context of the Rails framework and Devise specifically."}], "answers": [{"comments": [{"owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "reply_to_user": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "edited": false, "score": 0, "creation_date": 1514988937, "post_id": 48040260, "comment_id": 83132085, "body": "I am glad I can help :)"}], "tags": [], "owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "is_accepted": true, "score": 1, "last_activity_date": 1514698033, "creation_date": 1514698033, "answer_id": 48040260, "question_id": 47915834, "link": "https://stackoverflow.com/questions/47915834/rails-4-2-devise-display-specific-message-to-users-if-cookies-are-disabled/48040260#48040260", "title": "Rails 4.2 / Devise - Display specific message to users if cookies are disabled", "body": "<p>I have not found a way to do this in rails but there is a simple way to do it with JS. You can use Javascript to accomplish this.</p>\n\n<p><strong>Library:</strong></p>\n\n<pre><code># make sure to incclude this file in app/assets/javascripts/application.js.coffee\n#app/assets/javascripts/cookie.js.coffee\ncreateCookie = (name, value, days) -&gt;\n  expires = undefined\n  if days\n    date = new Date\n    date.setTime date.getTime() + days * 24 * 60 * 60 * 1000\n    expires = '; expires=' + date.toGMTString()\n  else\n    expires = ''\n  document.cookie = name + '=' + value + expires + '; path=/'\n  return\n\nreadCookie = (name) -&gt;\n  nameEQ = name + '='\n  ca = document.cookie.split(';')\n  i = 0\n  while i &lt; ca.length\n    c = ca[i]\n    while c.charAt(0) == ' '\n      c = c.substring(1, c.length)\n    if c.indexOf(nameEQ) == 0\n      return c.substring(nameEQ.length, c.length)\n    i++\n  null\n\neraseCookie = (name) -&gt;\n  createCookie name, '', -1\n  return\n\nareCookiesEnabled = -&gt;\n  r = false\n  createCookie 'testing', 'Hello', 1\n  if readCookie('testing') != null\n    r = true\n    eraseCookie 'testing'\n  r\n</code></pre>\n\n<p><strong>Code to run:</strong></p>\n\n<pre class=\"lang-js prettyprint-override\"><code>alert(areCookiesEnabled());\n</code></pre>\n\n<blockquote>\n  <p>This only works if Javascript is enabled!</p>\n</blockquote>\n"}], "owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 48040260, "answer_count": 1, "score": 0, "last_activity_date": 1514711589, "creation_date": 1513812836, "last_edit_date": 1514711589, "question_id": 47915834, "link": "https://stackoverflow.com/questions/47915834/rails-4-2-devise-display-specific-message-to-users-if-cookies-are-disabled", "title": "Rails 4.2 / Devise - Display specific message to users if cookies are disabled", "body": "<p>On my ruby on rails 4.2 app, I am using Devise to authenticate (sign in and sign up) users. Let's take an example: when a user signs ups, for example, he's automatically redirected to the homepage as a signed-in user.</p>\n\n<p>I need to provide for the case of users who would have cookies (and other Web storage) blocked or deactivated.</p>\n\n<p>Today, if it is the case and cookies are blocked, when he signs up on my sign-up page, he will still be redirected to the homepage but he won't be signed-in: devise fails to work.</p>\n\n<p>How can Rails identify server-side that cookies are disabled so that I can show a nice message to the user after he submits the signup/in form such as \"please activate cookies to proceed\".</p>\n\n<p>I would like a clean solution that integrates well with Devise (vs some front end detection that need to be passed from javascript to the server and seems like a \"dirty\" hack :-).</p>\n\n<p>Note: This is the strategy used by Google by the way even if for them it takes place in a 2-step form.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1513806484, "post_id": 47914716, "comment_id": 82797639, "body": "Please expand on what &quot;it didn&#39;t work&quot; means."}, {"owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "reply_to_user": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1513806674, "post_id": 47914716, "comment_id": 82797717, "body": "Sorry for being less descriptive, I mean it passed, and gave no errors Except when you check Product.find(this_product).cover_image it&#39;s nil still"}], "answers": [{"comments": [{"owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "edited": false, "score": 0, "creation_date": 1513899200, "post_id": 47915647, "comment_id": 82837521, "body": "I already did that before even posing as a temporary solution, Actually i wanted to apply this to :cover_image to keep everything in one place, So until a better solution comes, i&#39;ll stick with my current way which is same as your  Thanks btw for your effort :)"}], "tags": [], "owner": {"reputation": 16077, "user_id": 319702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Rb5G2.jpg?s=128&g=1", "display_name": "sameera207", "link": "https://stackoverflow.com/users/319702/sameera207"}, "is_accepted": false, "score": 0, "last_activity_date": 1515327685, "last_edit_date": 1515327685, "creation_date": 1513811392, "answer_id": 47915647, "question_id": 47914716, "link": "https://stackoverflow.com/questions/47914716/how-can-i-add-a-url-to-my-cover-image-on-rails-4-using-carrierware/47915647#47915647", "title": "How can i add a url to my cover_image on rails 4 using carrierware", "body": "<p>If you need a custom url for some Products and others you are happy with the uploaded image url, here's what I would do. (I recommend leaving the <code>cover_image_url</code> as it is and create a separate column for custom url)</p>\n\n<p>1 - Create a separate column called <code>custom_url</code> (leave the <code>cover_image_url</code>)</p>\n\n<p>2 - remove <code>attr_accessor :cover_image_url</code> and leave it as it was (because it overrides the up loader functionality) </p>\n\n<p>3 - Update the product model to have a method to return url</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  # ... other code   \n\n  def image_url\n    # return custom_url if it has one, or the standard url\n    # you can change this logic as you want\n    custom_url || cover_image_url\n  end\nend\n</code></pre>\n\n<p>4 - Now, instead of calling  <code>p.cover_image_url</code> I'll call <code>p.image_url</code></p>\n\n<pre><code>p = Product.last\np.image_url\n</code></pre>\n"}], "owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515327685, "creation_date": 1513805870, "question_id": 47914716, "link": "https://stackoverflow.com/questions/47914716/how-can-i-add-a-url-to-my-cover-image-on-rails-4-using-carrierware", "title": "How can i add a url to my cover_image on rails 4 using carrierware", "body": "<p>To be specific, Let's say i have model called Products and it has a column called :cover_image which holds the picture</p>\n\n<p>I have mounted the uploader and everything works fine</p>\n\n<p>Except that for now i want to add a custom url to a new product or existing one</p>\n\n<p>for example</p>\n\n<p>I want to do like this</p>\n\n<pre><code>p = Product.last\np.cover_image = \"something\"\n</code></pre>\n\n<p>it didn't work</p>\n\n<p>I added</p>\n\n<pre><code>attr_accessor :cover_image_url\n</code></pre>\n\n<p>and now i'm able to do</p>\n\n<pre><code>p.cover_image_url = \"something\"\n</code></pre>\n\n<p>once i do</p>\n\n<pre><code>p.save\n</code></pre>\n\n<p>it acts like everything went fine</p>\n\n<p>except the cover_image column still empty</p>\n\n<p>how can i populate it with a link manually ?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 1, "creation_date": 1513805154, "post_id": 47914534, "comment_id": 82797097, "body": "Because they are different languages with different functions for matching regular expressions..."}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 1, "creation_date": 1513805583, "post_id": 47914534, "comment_id": 82797308, "body": "Is there a reason why you&#39;re not just splitting on spaces \u2013 <code>text.split(&#39; &#39;)</code> \u2013 since that&#39;s what you&#39;re effectively doing with your regex? Or even just a simpler regex, like <code>text.split(&#47;\\.?\\s+&#47;)</code>?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1513851704, "post_id": 47914534, "comment_id": 82813129, "body": "Ruby and ECMAScript are two completely different languages that have nothing to do with each other. You simply <i>cannot</i> expect that you can just copy&amp;paste code back and forth between two completely different programming languages. That is just unreasonable."}], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1513805601, "last_edit_date": 1513805601, "creation_date": 1513805215, "answer_id": 47914590, "question_id": 47914534, "link": "https://stackoverflow.com/questions/47914534/why-regex-works-in-javascript-but-dont-work-in-ruby/47914590#47914590", "title": "Why regex works in javascript, but don&#39;t work in ruby?", "body": "<p>The reason is that <code>str.match(/regex/g)</code> in JS does not keep captured substrings, see <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/match\" rel=\"nofollow noreferrer\">MDN <code>String#match()</code> reference</a>:</p>\n\n<blockquote>\n  <p>If the regular expression includes the <code>g</code> flag, the method returns an <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array\" rel=\"nofollow noreferrer\"><code>Array</code></a> containing all matched substrings rather than match objects. Captured groups are not returned. </p>\n</blockquote>\n\n<p>In Ruby, you have to modify the pattern to remove redundant capturing groups and turn capturing ones into non-capturing (that is, replace unescaped <code>(</code> with <code>(?:</code>) because otherwise, only the <em>captured</em> substrings will get output by the <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-scan\" rel=\"nofollow noreferrer\"><code>String#scan</code></a> method:</p>\n\n<blockquote>\n  <p>If the pattern contains no groups, each individual result consists of the matched string, $&amp;. <strong>If the pattern contains groups, each individual result is itself an array containing one entry per group.</strong></p>\n</blockquote>\n\n<p>Use</p>\n\n<pre><code>text = 'http://www.site.info www.escola.ninja.br google.com.ag'\nputs text.scan(/(?:http:\\/\\/)?(?:www\\.)?\\w+\\.\\w{2,}(?:\\.\\w{2,})?/)\n</code></pre>\n\n<p>Output of the <a href=\"https://ideone.com/bTGbDS\" rel=\"nofollow noreferrer\">demo</a>:</p>\n\n<pre><code>http://www.site.info\nwww.escola.ninja.br\ngoogle.com.ag\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 4, "last_activity_date": 1513805404, "creation_date": 1513805404, "answer_id": 47914626, "question_id": 47914534, "link": "https://stackoverflow.com/questions/47914534/why-regex-works-in-javascript-but-dont-work-in-ruby/47914626#47914626", "title": "Why regex works in javascript, but don&#39;t work in ruby?", "body": "<p>Because according to the <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-scan\" rel=\"nofollow noreferrer\">Ruby <code>String#scan</code> method</a>:</p>\n\n<blockquote>\n  <p>If the pattern contains groups, each individual result is itself an array containing one entry per group.</p>\n</blockquote>\n\n<p>So you can simply modify the expression so that the groups are non-capturing by converting <code>(...)</code> to <code>(?:...)</code>, resulting in the following expression</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>text.scan(/(?:http:\\/\\/)?(?:(?:www\\.)?\\w+\\.\\w{2,}(?:\\.\\w{2,})?)/)\n# =&gt; [\"http://www.site.info\", \"www.escola.ninja.br\", \"google.com.ag\"]\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 2402677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5a376f40c947fb8676e3b7dadded3f?s=128&d=identicon&r=PG", "display_name": "Igor Oliveira Antonio", "link": "https://stackoverflow.com/users/2402677/igor-oliveira-antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 47914590, "answer_count": 2, "score": 3, "last_activity_date": 1513805601, "creation_date": 1513804907, "last_edit_date": 1513805061, "question_id": 47914534, "link": "https://stackoverflow.com/questions/47914534/why-regex-works-in-javascript-but-dont-work-in-ruby", "title": "Why regex works in javascript, but don&#39;t work in ruby?", "body": "<pre><code>text = 'http://www.site.info www.escola.ninja.br google.com.ag'\n</code></pre>\n\n<p>expression: <code>(http:\\/\\/)?((www\\.)?\\w+\\.\\w{2,}(\\.\\w{2,})?)</code></p>\n\n<p>In Javascript, this expression works, returning:</p>\n\n<pre><code>[\"http://www.site.info\", \"www.escola.ninja.br\", \"google.com.ag\"]\n</code></pre>\n\n<p>Why it's not working in ruby?</p>\n\n<p>For example:</p>\n\n<ol>\n<li><p>using the Match method:</p>\n\n<pre><code>p text.match(/(http:\\/\\/)?(www\\.)?\\w+\\.\\w{2,}(\\.\\w{2})?/)\n#&lt;MatchData \"http://www.site.info\" 1:\"http://\" 2:\"www.\" 3:nil&gt;\n</code></pre></li>\n<li><p>using the Scan method:</p>\n\n<pre><code>p text.scan(/(http:\\/\\/)?(www\\.)?\\w+\\.\\w{2,}(\\.\\w{2})?/)\n[[\"http://\", \"www.\", nil], [nil, \"www.\", \".br\"], [nil, nil, \".ag\"]]\n</code></pre></li>\n</ol>\n\n<p>How can I return the following array instead?</p>\n\n<pre><code>[\"http://www.site.info\", \"www.escola.ninja.br\", \"google.com.ag\"]\n</code></pre>\n"}, {"tags": ["ruby", "push-notification", "padrino"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1513813164, "post_id": 47914427, "comment_id": 82799791, "body": "You sure you are using right token for right project? <a href=\"https://codedump.io/share/wdirXzlaIuaY/1/firebase-mismatchsenderid-when-authorization-key-is-my-server-key\" rel=\"nofollow noreferrer\">check_out_this_answer</a> And you checked out <a href=\"https://stackoverflow.com/questions/37863106/fcm-getting-mismatchsenderid\">this SO question</a>?"}, {"owner": {"reputation": 1384, "user_id": 1726450, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/20469258fb2d81db8009ed6f2de6a5fe?s=128&d=identicon&r=PG", "display_name": "Dylanthepiguy", "link": "https://stackoverflow.com/users/1726450/dylanthepiguy"}, "edited": false, "score": 0, "creation_date": 1516318051, "post_id": 47914427, "comment_id": 83649625, "body": "Did you find anything in the last month?"}, {"owner": {"reputation": 182, "user_id": 6425718, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FyVD2-IBdhg/AAAAAAAAAAI/AAAAAAAAAI0/YKu3JsXztMs/photo.jpg?sz=128", "display_name": "Humayun Naseer", "link": "https://stackoverflow.com/users/6425718/humayun-naseer"}, "edited": false, "score": 0, "creation_date": 1610630552, "post_id": 47914427, "comment_id": 116196926, "body": "hi do you find the solution"}], "answers": [{"tags": [], "owner": {"reputation": 182, "user_id": 6425718, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FyVD2-IBdhg/AAAAAAAAAAI/AAAAAAAAAI0/YKu3JsXztMs/photo.jpg?sz=128", "display_name": "Humayun Naseer", "link": "https://stackoverflow.com/users/6425718/humayun-naseer"}, "is_accepted": false, "score": 0, "last_activity_date": 1610695307, "creation_date": 1610695307, "answer_id": 65731964, "question_id": 47914427, "link": "https://stackoverflow.com/questions/47914427/mismatchsenderid-in-push-notification-with-ruby/65731964#65731964", "title": "MismatchSenderId in push notification with Ruby", "body": "<p>I was going through the same issue recently.\nIn my case, I was not using the correct Server-ID because we have to use the Server-Id from the project where our app has been registered.</p>\n<p>You can check this in <a href=\"http://alphatech.technology/Howto-Entry-srk/Google-Services-Json-bek/\" rel=\"nofollow noreferrer\">Google-services.json</a></p>\n<p>secondly please ensure that you allowed and added your App to your Firebase project.</p>\n<p>I find the best reason explanation <a href=\"https://codedump.io/share/wdirXzlaIuaY/1/firebase-mismatchsenderid-when-authorization-key-is-my-server-key\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 2985, "user_id": 7122343, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/nDdak.png?s=128&g=1", "display_name": "Nomura Nori", "link": "https://stackoverflow.com/users/7122343/nomura-nori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1610695307, "creation_date": 1513804372, "question_id": 47914427, "link": "https://stackoverflow.com/questions/47914427/mismatchsenderid-in-push-notification-with-ruby", "title": "MismatchSenderId in push notification with Ruby", "body": "<p>I am building a backend with Ruby (padrino framework) and would like to send push notification.\nI used this gem for push notification.</p>\n\n<p><a href=\"https://github.com/spacialdb/fcm\" rel=\"nofollow noreferrer\">https://github.com/spacialdb/fcm</a></p>\n\n<p>I used server key from firebase console could setting.\nThis is code what I have used.</p>\n\n<pre><code>fcm = FCM.new(settings.fcm_serverkey)\nregistration_ids= [settings.test_key] \noptions = {data: {score: \"123\"}, collapse_key: \"updated_score\"}\nresponse = fcm.send(registration_ids, options)\n</code></pre>\n\n<p>And this is error what I got.</p>\n\n<pre><code>{:body=&gt;\"{\\\"multicast_id\\\":8815634661444747749,\\\"success\\\":0,\\\"failure\\\":1,\\\"canonical_ids\\\":0,\\\"results\\\":[{\\\"error\\\":\\\"MismatchSenderId\\\"}]}\", :headers=&gt;{\"content-type\"=&gt;[\"application/json; charset=UTF-8\"], \"date\"=&gt;[\"Wed, 20 Dec 2017 21:05:04 GMT\"], \"expires\"=&gt;[\"Wed, 20 Dec 2017 21:05:04 GMT\"], \"cache-control\"=&gt;[\"private, max-age=0\"], \"x-content-type-options\"=&gt;[\"nosniff\"], \"x-frame-options\"=&gt;[\"SAMEORIGIN\"], \"x-xss-protection\"=&gt;[\"1; mode=block\"], \"server\"=&gt;[\"GSE\"], \"alt-svc\"=&gt;[\"hq=\\\":443\\\"; ma=2592000; quic=51303431; quic=51303339; quic=51303338; quic=51303337; quic=51303335,quic=\\\":443\\\"; ma=2592000; v=\\\"41,39,38,37,35\\\"\"], \"accept-ranges\"=&gt;[\"none\"], \"vary\"=&gt;[\"Accept-Encoding\"], \"connection\"=&gt;[\"close\"]}, :status_code=&gt;200, :response=&gt;\"success\", :canonical_ids=&gt;[], :not_registered_ids=&gt;[]}\n</code></pre>\n\n<p>What the important thing is \"MismatchSenderId\" from error log.\nI can't find param for senderID in github guide.\nThey only mentioned about serverkey.\nAny advice will be big help for me.\nThanks</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 2373, "user_id": 5360672, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UPhrY.jpg?s=128&g=1", "display_name": "Jonathan Laliberte", "link": "https://stackoverflow.com/users/5360672/jonathan-laliberte"}, "edited": false, "score": 1, "creation_date": 1513799205, "post_id": 47913315, "comment_id": 82794381, "body": "Show what you have tried"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8714564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a537d062960bda20fb93fc3011ba1b5?s=128&d=identicon&r=PG&f=1", "display_name": "syed zaidi", "link": "https://stackoverflow.com/users/8714564/syed-zaidi"}, "edited": false, "score": 0, "creation_date": 1513799290, "post_id": 47913361, "comment_id": 82794417, "body": "The thing is I still want it all to be inside one array, not just print the individual arrays inside of the main array line by line."}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 2, "last_activity_date": 1513799443, "last_edit_date": 1513799443, "creation_date": 1513799198, "answer_id": 47913361, "question_id": 47913315, "link": "https://stackoverflow.com/questions/47913315/given-the-following-array-how-do-i-print-it-out-on-multiple-lines/47913361#47913361", "title": "Given the following array, how do I print it out on multiple lines", "body": "<pre><code>array = [[1, 2, 3], [8, 9, 4], [7, 6, 5]]\nputs array.to_s.gsub('],',\"],\\n\")\n\n#[[1, 2, 3],\n# [8, 9, 4],\n# [7, 6, 5]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 8714564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a537d062960bda20fb93fc3011ba1b5?s=128&d=identicon&r=PG&f=1", "display_name": "syed zaidi", "link": "https://stackoverflow.com/users/8714564/syed-zaidi"}, "edited": false, "score": 0, "creation_date": 1513799430, "post_id": 47913374, "comment_id": 82794494, "body": "It&#39;s close, but the thing is, it is now printing three separate arrays, is there anyway I can print it inside one array, but the individual arrays line by line?"}, {"owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "reply_to_user": {"reputation": 77, "user_id": 8714564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a537d062960bda20fb93fc3011ba1b5?s=128&d=identicon&r=PG&f=1", "display_name": "syed zaidi", "link": "https://stackoverflow.com/users/8714564/syed-zaidi"}, "edited": false, "score": 0, "creation_date": 1513800644, "post_id": 47913374, "comment_id": 82795014, "body": "Looks like @sagarpandya has updated his answer to handle wrapping the output in a single array."}], "tags": [], "owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "is_accepted": false, "score": 2, "last_activity_date": 1513799252, "creation_date": 1513799252, "answer_id": 47913374, "question_id": 47913315, "link": "https://stackoverflow.com/questions/47913315/given-the-following-array-how-do-i-print-it-out-on-multiple-lines/47913374#47913374", "title": "Given the following array, how do I print it out on multiple lines", "body": "<p>Try printing the mapped result of <code>#inspect</code> on <code>array</code>, like so:</p>\n\n<pre><code>puts array.map(&amp;:inspect)\n\n# [1, 2, 3]\n# [8, 9, 4]\n# [7, 6, 5]\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"comments": [{"owner": {"reputation": 880, "user_id": 3334690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b1a9715a46ee28e3151148688c0149f9?s=128&d=identicon&r=PG&f=1", "display_name": "user3334690", "link": "https://stackoverflow.com/users/3334690/user3334690"}, "edited": false, "score": 0, "creation_date": 1513807089, "post_id": 47913412, "comment_id": 82797882, "body": "This is pretty close to what I usually end up doing whenever I want to display an array of arrays in my console like this.  I usually end up with something like <code>puts array.map{|a| a*&quot;, &quot;}</code>"}], "tags": [], "owner": {"reputation": 36, "user_id": 9123624, "user_type": "registered", "profile_image": "https://graph.facebook.com/1594958857227572/picture?type=large", "display_name": "Robin Klimonow", "link": "https://stackoverflow.com/users/9123624/robin-klimonow"}, "is_accepted": false, "score": 2, "last_activity_date": 1513799428, "creation_date": 1513799428, "answer_id": 47913412, "question_id": 47913315, "link": "https://stackoverflow.com/questions/47913315/given-the-following-array-how-do-i-print-it-out-on-multiple-lines/47913412#47913412", "title": "Given the following array, how do I print it out on multiple lines", "body": "<p>The following should work:</p>\n\n<pre><code>   array.each do |sub|\n     puts sub.join(\", \")\n   end\n</code></pre>\n\n<p>However, this will not include the [] characters, but will look like this:</p>\n\n<pre><code>1, 2, 3\n8, 9, 4\n7, 6, 5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": false, "score": 2, "last_activity_date": 1513800259, "last_edit_date": 1513800259, "creation_date": 1513799958, "answer_id": 47913529, "question_id": 47913315, "link": "https://stackoverflow.com/questions/47913315/given-the-following-array-how-do-i-print-it-out-on-multiple-lines/47913529#47913529", "title": "Given the following array, how do I print it out on multiple lines", "body": "<p>Just for fun - you can redefine <code>inspect</code> method like:</p>\n\n<pre><code>def array.inspect\n  map(&amp;:to_s).join(\"\\n\")\nend\np array\n# [1, 2, 3]\n# [8, 9, 4]\n# [7, 6, 5]\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8714564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a537d062960bda20fb93fc3011ba1b5?s=128&d=identicon&r=PG&f=1", "display_name": "syed zaidi", "link": "https://stackoverflow.com/users/8714564/syed-zaidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1513800259, "creation_date": 1513798986, "question_id": 47913315, "link": "https://stackoverflow.com/questions/47913315/given-the-following-array-how-do-i-print-it-out-on-multiple-lines", "title": "Given the following array, how do I print it out on multiple lines", "body": "<pre><code>array = [[1, 2, 3], [8, 9, 4], [7, 6, 5]]\n</code></pre>\n\n<p>I keep getting it in a single line, how can I print it out in the terminal so each array is on its own individual line like so:</p>\n\n<pre><code>[[1, 2, 3], \n [8, 9, 4], \n [7, 6, 5]]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "sqlite3-ruby"], "comments": [{"owner": {"reputation": 1410, "user_id": 1507845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9daba84d2a161462310fe5a0eb3ab53c?s=128&d=identicon&r=PG", "display_name": "XML Slayer", "link": "https://stackoverflow.com/users/1507845/xml-slayer"}, "edited": false, "score": 2, "creation_date": 1513798612, "post_id": 47912999, "comment_id": 82794128, "body": "Defining a column using <code>t.belongs_to</code> will automatically create an index for you. And yes, that is a generally a good idea for database performance."}, {"owner": {"reputation": 1439, "user_id": 2993674, "user_type": "registered", "accept_rate": 6, "profile_image": "https://i.stack.imgur.com/TRxII.jpg?s=128&g=1", "display_name": "rld", "link": "https://stackoverflow.com/users/2993674/rld"}, "reply_to_user": {"reputation": 1410, "user_id": 1507845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9daba84d2a161462310fe5a0eb3ab53c?s=128&d=identicon&r=PG", "display_name": "XML Slayer", "link": "https://stackoverflow.com/users/1507845/xml-slayer"}, "edited": false, "score": 0, "creation_date": 1513799740, "post_id": 47912999, "comment_id": 82794610, "body": "Nice, thank&#39;s for reply XML Slayer!"}], "answers": [{"tags": [], "owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "is_accepted": true, "score": 1, "last_activity_date": 1513799460, "creation_date": 1513799460, "answer_id": 47913420, "question_id": 47912999, "link": "https://stackoverflow.com/questions/47912999/creating-a-table-categorization-with-has-many-through-for-categories-and-posts/47913420#47913420", "title": "Creating a table categorization with has_many :through for categories and posts", "body": "<p>Yes, that multi-column index that you've defined at the bottom:</p>\n\n<pre><code>add_index :categorizations, [:product_id, :category_id], unique: true\n</code></pre>\n\n<p>is valid. <em>But</em> it's also unnecessary and likely less performant than the single column indexes that you have individually defined on <code>product_id</code> and <code>category_id</code>.</p>\n"}], "owner": {"reputation": 1439, "user_id": 2993674, "user_type": "registered", "accept_rate": 6, "profile_image": "https://i.stack.imgur.com/TRxII.jpg?s=128&g=1", "display_name": "rld", "link": "https://stackoverflow.com/users/2993674/rld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 47913420, "answer_count": 1, "score": 1, "last_activity_date": 1513799460, "creation_date": 1513797604, "question_id": 47912999, "link": "https://stackoverflow.com/questions/47912999/creating-a-table-categorization-with-has-many-through-for-categories-and-posts", "title": "Creating a table categorization with has_many :through for categories and posts", "body": "<p>Hey guys I'm doing a has_many :through association in ruby on rails.\nAnd I want some help if it's ok with my example.\nSo I pretend to do categories for Posts. \nSupposing I already have builded the class post.\nSo for create the database for categories I pretend to do like these:</p>\n\n<pre><code>class CreateCategories &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table :categories do |t|\n      t.string :name\n      t.timestamps\n    end\n  end\n\n  def change\n    create_table :categorizations do |t|\n      t.belongs_to :post, index: true\n      t.belongs_to :category, index: true\n      t.integer :position\n\n      t.timestamps\n    end\n\n    add_index :categorizations, [:product_id, :category_id], unique: true\n  end\nend\n</code></pre>\n\n<p>It's ok these index's for boost the database?</p>\n"}, {"tags": ["ruby", "url", "gsub"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5244092, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/85dc8164b8fbf6a6c99e4a0912af1799?s=128&d=identicon&r=PG&f=1", "display_name": "alexnewby", "link": "https://stackoverflow.com/users/5244092/alexnewby"}, "edited": false, "score": 0, "creation_date": 1513797381, "post_id": 47912894, "comment_id": 82793542, "body": "That worked! I&#39;m going to have to study that regex line..."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 3, "creation_date": 1513797782, "post_id": 47912894, "comment_id": 82793725, "body": "could be a lot less complicated with the <code>URI</code> module and <code>host</code>"}, {"owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "edited": false, "score": 0, "creation_date": 1513797909, "post_id": 47912894, "comment_id": 82793783, "body": "<code>URI.parse(&quot;https:&#47;&#47;www.twitter.com&#47;sdfaskj...&quot;).host</code> returns <code>www.twitter.com</code> not <code>twitter</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1513809825, "post_id": 47912894, "comment_id": 82798860, "body": "@AlexKojin and doesn&#39;t that look easier to parse? Also what about other subdomains and tlds?"}, {"owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1513827980, "post_id": 47912894, "comment_id": 82803195, "body": "@engineersmnky it&#39;s solution for this spec not for all cases. It works and took 2 minutes to write and check this."}], "tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": false, "score": 1, "last_activity_date": 1513797149, "creation_date": 1513797149, "answer_id": 47912894, "question_id": 47912766, "link": "https://stackoverflow.com/questions/47912766/remove-all-but-the-website-name-from-url-in-ruby/47912894#47912894", "title": "Remove all but the website name from URL in Ruby", "body": "<p>You can use this <code>gsub</code> regexp :</p>\n\n<p><code>gsub(/http(s)?:\\/\\/(www.)?|.(com|net|co.uk|us)+.*/, '')</code></p>\n\n<p>Output:</p>\n\n<pre><code>list = [\"https://twitter.com/sdfaskj...\", \"https://www.linkedin.com/asdkfjasd...\", \"http://google.com/asdfjasdj...\"] \n\nlist.map { |u| u.gsub(/http(s)?:\\/\\/(www.)?|.(com|net|co.uk|us)+.*/, '') }\n =&gt; [\"twitter\", \"linkedin\", \"google\"] \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1513804302, "post_id": 47913612, "comment_id": 82796717, "body": "Personally I&#39;d ditch the gem and do <code>host.split(?.)[-2]</code>. The domain name spec is pretty stable."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 3, "creation_date": 1513838844, "post_id": 47913612, "comment_id": 82806280, "body": "@Max <code>split(?.)[-2]</code> doesn&#39;t reliably return the most important part of the domain, for example, for valid domains like <code>www.google.com.au</code> or <code>www.amazon.co.uk</code> it would return <code>com</code> or <code>co</code>. Whereas the <code>PublicSuffix</code> gem would return <code>google</code> and <code>amazon</code>."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 5, "last_activity_date": 1513800444, "last_edit_date": 1513800444, "creation_date": 1513800308, "answer_id": 47913612, "question_id": 47912766, "link": "https://stackoverflow.com/questions/47912766/remove-all-but-the-website-name-from-url-in-ruby/47913612#47913612", "title": "Remove all but the website name from URL in Ruby", "body": "<p>I would consider a combination of <code>URI.parse</code> to get the hostname from the URL and the <a href=\"https://github.com/weppos/publicsuffix-ruby\" rel=\"noreferrer\"><code>PublicSuffix</code></a> gem to get the second level domain:</p>\n\n<pre><code>require 'public_suffix'\nrequire 'uri'\n\nurl  = 'https://www.linkedin.com/asdkfjasd'\nhost = URI.parse(url).host                 # =&gt; 'www.linkedin.com'\nPublicSuffix.parse(host).sld               # =&gt; 'linkedin'\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5244092, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/85dc8164b8fbf6a6c99e4a0912af1799?s=128&d=identicon&r=PG&f=1", "display_name": "alexnewby", "link": "https://stackoverflow.com/users/5244092/alexnewby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "closed_date": 1513816931, "answer_count": 2, "score": 1, "last_activity_date": 1513800444, "creation_date": 1513796587, "question_id": 47912766, "link": "https://stackoverflow.com/questions/47912766/remove-all-but-the-website-name-from-url-in-ruby", "closed_reason": "Duplicate", "title": "Remove all but the website name from URL in Ruby", "body": "<p>Im a iterating through a list of URLs. The urls come in different formats like:</p>\n\n<pre><code>https://twitter.com/sdfaskj... \nhttps://www.linkedin.com/asdkfjasd...\nhttp://google.com/asdfjasdj...\n</code></pre>\n\n<p>etc. </p>\n\n<p>I would like to use Gsub or something similar to erase everything but the name of the website, to get only \"twitter\", \"linkedin\", and \"google\", respectively.</p>\n\n<p>In my head, ideally I would like something like a .gsub that can check for multiple possibilities (url.gsub(\"https:// or <a href=\"https://www\" rel=\"nofollow noreferrer\">https://www</a>. or http:// etc.\", \"\") and replace them when found with nothing \"\". Also it needs to delete everything after the name, so \".com/wkadslflj...\" </p>\n\n<pre><code>attributes.css(\"a\").each do |attribute|\n  attribute_url = attribute[\"href\"]\n  attribute_scrape = attribute_url.gsub(\"https://\", \"\")\n  binding.pry\nend\n</code></pre>\n"}, {"tags": ["ruby", "timestamp", "vertica"], "answers": [{"comments": [{"owner": {"reputation": 2610, "user_id": 120991, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/19772641f8c50f5b1c134b47131f0528?s=128&d=identicon&r=PG", "display_name": "twneale", "link": "https://stackoverflow.com/users/120991/twneale"}, "edited": false, "score": 0, "creation_date": 1513878394, "post_id": 47912807, "comment_id": 82828928, "body": "Thanks! This is exactly what I needed!"}], "tags": [], "owner": {"reputation": 6615, "user_id": 1303868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bc2ad4c62572ad8df0b54d91e17617f?s=128&d=identicon&r=PG", "display_name": "ficuscr", "link": "https://stackoverflow.com/users/1303868/ficuscr"}, "is_accepted": true, "score": 3, "last_activity_date": 1513804858, "last_edit_date": 1513804858, "creation_date": 1513796768, "answer_id": 47912807, "question_id": 47912537, "link": "https://stackoverflow.com/questions/47912537/how-to-parse-timestamps-given-as-64-bit-integer-in-little-endian-format-with-rub/47912807#47912807", "title": "How to parse timestamps given as 64-bit integer in little-endian format with Ruby?", "body": "<p>Not really sure what endianness would have to do with anything here. You've got an integer already.</p>\n\n<p>So Epoch is Jan 01, 2000? Basically you just need to account for diff between epochs, 1969-12-31 and theirs...</p>\n\n<pre><code>epoch = Time.new(2000, 1, 1)\n\nepochOffset = epoch.to_i - Time.at(0).to_i;\n\nts = Time.at((566455347898055 / 1000000) + epochOffset)\n\nprint ts.strftime \"%Y-%m-%d %H:%M:%S %z\";\n\n&gt; 2017-12-13 04:42:27 +0000\n</code></pre>\n"}], "owner": {"reputation": 2610, "user_id": 120991, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/19772641f8c50f5b1c134b47131f0528?s=128&d=identicon&r=PG", "display_name": "twneale", "link": "https://stackoverflow.com/users/120991/twneale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 47912807, "answer_count": 1, "score": 3, "last_activity_date": 1513804858, "creation_date": 1513795699, "last_edit_date": 1513797485, "question_id": 47912537, "link": "https://stackoverflow.com/questions/47912537/how-to-parse-timestamps-given-as-64-bit-integer-in-little-endian-format-with-rub", "title": "How to parse timestamps given as 64-bit integer in little-endian format with Ruby?", "body": "<p>I'm curious how to parse these weird timestamps in Ruby:</p>\n\n<pre><code>566455139129676\n566455199011666\n566455199892825\n566455259010949\n566455319010859\n566455335000847\n566455336000936\n566455336127533\n566455347898055\n</code></pre>\n\n<p>Here's what I know about the format of these timestamps:</p>\n\n<blockquote>\n  <p>The value is a 64-bit integer in little-endian format containing the\n  number of microseconds since Julian day: Jan 01 2000 00:00:00 in the\n  UTC timezone.</p>\n</blockquote>\n\n<p>For the curious, these are Vertica's internal representation of timestamps: <a href=\"https://my.vertica.com/docs/9.0.x/HTML/index.htm#Authoring/AdministratorsGuide/BinaryFilesAppendix/ColumnDefinitions.htm\" rel=\"nofollow noreferrer\">https://my.vertica.com/docs/9.0.x/HTML/index.htm#Authoring/AdministratorsGuide/BinaryFilesAppendix/ColumnDefinitions.htm</a></p>\n\n<p>Any help would be most appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "session", "vue.js", "vuejs2"], "comments": [{"owner": {"reputation": 6367, "user_id": 4451732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UQN4l.jpg?s=128&g=1", "display_name": "Franklin Yu", "link": "https://stackoverflow.com/users/4451732/franklin-yu"}, "edited": false, "score": 0, "creation_date": 1513803393, "post_id": 47911757, "comment_id": 82796318, "body": "Don&#39;t know any easy way, but it might be possible to proxy the Vue.js request to the Webpack origin, for example with <code>rails-reverse-proxy</code>. Didn&#39;t try myself, though."}], "answers": [{"comments": [{"owner": {"reputation": 4313, "user_id": 1177198, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4ea56c658e69eef33b6557b20c7a19ab?s=128&d=identicon&r=PG", "display_name": "bigtunacan", "link": "https://stackoverflow.com/users/1177198/bigtunacan"}, "edited": false, "score": 0, "creation_date": 1529955393, "post_id": 48345070, "comment_id": 89053648, "body": "We are using Webpack and the vue-cli for it&#39;s build process and are not utilizing the Webpacker gem."}], "tags": [], "owner": {"reputation": 359, "user_id": 3518266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NHTHc.jpg?s=128&g=1", "display_name": "Torsten", "link": "https://stackoverflow.com/users/3518266/torsten"}, "is_accepted": false, "score": -1, "last_activity_date": 1516377888, "creation_date": 1516377888, "answer_id": 48345070, "question_id": 47911757, "link": "https://stackoverflow.com/questions/47911757/how-to-share-a-session-between-vue-js-dev-and-rails-4-backend/48345070#48345070", "title": "How to share a session between Vue.js dev and Rails 4 backend?", "body": "<p>Get rid of webpacker, if you at all can. Vue can be used <a href=\"https://vuejs.org/v2/guide/installation.html\" rel=\"nofollow noreferrer\">from cdn</a> quite fine.\nWhen the vue app is instantiated in the rails template, data can be passed really easily with <code>#{@model.to_json}</code>. </p>\n\n<p>Vue components can be written using x-template syntax, either in rails templates or asset pipeline.</p>\n"}, {"tags": [], "owner": {"reputation": 4313, "user_id": 1177198, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4ea56c658e69eef33b6557b20c7a19ab?s=128&d=identicon&r=PG", "display_name": "bigtunacan", "link": "https://stackoverflow.com/users/1177198/bigtunacan"}, "is_accepted": true, "score": 0, "last_activity_date": 1529955801, "creation_date": 1529955801, "answer_id": 51030819, "question_id": 47911757, "link": "https://stackoverflow.com/questions/47911757/how-to-share-a-session-between-vue-js-dev-and-rails-4-backend/51030819#51030819", "title": "How to share a session between Vue.js dev and Rails 4 backend?", "body": "<p>There is an option in called proxyTable in the file <code>config/index.js</code>.</p>\n\n<p>We were able to set the webpack root to proxy through the local Rails server by setting this option as <code>proxyTable: {\"/\": \"http://localhost:3000\"}</code></p>\n\n<p>3000 is the default port for a Rails dev server, but you may need to change this if you are running on a different port.</p>\n"}], "owner": {"reputation": 4313, "user_id": 1177198, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4ea56c658e69eef33b6557b20c7a19ab?s=128&d=identicon&r=PG", "display_name": "bigtunacan", "link": "https://stackoverflow.com/users/1177198/bigtunacan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 51030819, "answer_count": 2, "score": 1, "last_activity_date": 1529955801, "creation_date": 1513792339, "question_id": 47911757, "link": "https://stackoverflow.com/questions/47911757/how-to-share-a-session-between-vue-js-dev-and-rails-4-backend", "title": "How to share a session between Vue.js dev and Rails 4 backend?", "body": "<p>I'm working with a Vue.js cli application that is co-exists with a Rails 4.2 backend.</p>\n\n<p>The goal here is to use the existing sessions.  When I compile the Vue.js application for production mode I can run the Rails server in development mode and the Vue app is served from correctly from the <code>public</code> directory and sessions work since they are being served on the same domain.</p>\n\n<p>Trying to develop and debug like this is very difficult as you have to compile the Vue app for production after any change to test it and this also then makes it impossible to leverage the Vue Devtools for debugging purposes.</p>\n\n<p>If I serve the Vue application in dev mode this is via webpack so then the Vue application and the Rails application are served separately and are thus now on separate domains which leads to no session sharing, having to try to deal with CORS, etc...</p>\n"}, {"tags": ["ruby", "rubygems", "bundle"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 2, "creation_date": 1513792955, "post_id": 47911655, "comment_id": 82791448, "body": "What do you have in <code>&#47;opt&#47;app-root&#47;src&#47;gems</code>?  The <code>gem</code> file itself or the unpacked folder?  Per the Bundler documentation, these must be the unpacked/extracted library.  <a href=\"http://bundler.io/v1.5/gemfile.html\" rel=\"nofollow noreferrer\">bundler.io/v1.5/gemfile.html</a>"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1513869574, "post_id": 47911655, "comment_id": 82824118, "body": "You could also run your own gem server in <code>&#47;opt&#47;app-root&#47;src&#47;gems</code>: <code>gem server</code>, then configure bundler to look there. I&#39;m not sure how to do that but this page might help: <a href=\"http://bundler.io/v1.16/bundle_config.html\" rel=\"nofollow noreferrer\">bundler.io/v1.16/bundle_config.html</a>"}, {"owner": {"reputation": 118, "user_id": 2799018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49551f8f808661e4706660c6c2069c9b?s=128&d=identicon&r=PG", "display_name": "deanpullen", "link": "https://stackoverflow.com/users/2799018/deanpullen"}, "edited": false, "score": 0, "creation_date": 1514372328, "post_id": 47911655, "comment_id": 82950115, "body": "Thanks Joe - I simply failed to rtfm - completely missed the point they need to be extracted!"}, {"owner": {"reputation": 118, "user_id": 2799018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49551f8f808661e4706660c6c2069c9b?s=128&d=identicon&r=PG", "display_name": "deanpullen", "link": "https://stackoverflow.com/users/2799018/deanpullen"}, "edited": false, "score": 0, "creation_date": 1514377611, "post_id": 47911655, "comment_id": 82952528, "body": "Actually, this worked for rack - rackup works and appears here once installed by bundle: /opt/app-root/src/ruby/bundle/ruby/2.4.0/bin/rackup  But puma isn&#39;t touched - rackup is the only binary installed."}, {"owner": {"reputation": 118, "user_id": 2799018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49551f8f808661e4706660c6c2069c9b?s=128&d=identicon&r=PG", "display_name": "deanpullen", "link": "https://stackoverflow.com/users/2799018/deanpullen"}, "edited": false, "score": 0, "creation_date": 1514378791, "post_id": 47911655, "comment_id": 82953040, "body": "Additionally neither rack or puma exist when I list gems (gem list). Both install fine if I use gem install, but I need to use bundle."}, {"owner": {"reputation": 118, "user_id": 2799018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49551f8f808661e4706660c6c2069c9b?s=128&d=identicon&r=PG", "display_name": "deanpullen", "link": "https://stackoverflow.com/users/2799018/deanpullen"}, "edited": false, "score": 0, "creation_date": 1514379717, "post_id": 47911655, "comment_id": 82953451, "body": "Ok this works for puma, by adding the full extracted gem path (although I don&#39;t understand why rack worked either way!)   gem &#39;rack&#39;, &#39;=2.0.3&#39;, :path =&gt; &quot;/opt/app-root/src/gems/rack-2.0.3&quot; gem &#39;puma&#39;, &#39;=3.10.0&#39;, :path =&gt; &quot;/opt/app-root/src/gems/puma-3.10.0&quot;"}], "owner": {"reputation": 118, "user_id": 2799018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49551f8f808661e4706660c6c2069c9b?s=128&d=identicon&r=PG", "display_name": "deanpullen", "link": "https://stackoverflow.com/users/2799018/deanpullen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513797599, "creation_date": 1513791884, "last_edit_date": 1513797599, "question_id": 47911655, "link": "https://stackoverflow.com/questions/47911655/ruby-bundler-not-installing-gems", "title": "ruby bundler not installing gems", "body": "<p>I'm trying my first Ruby app - unfortunately due to constraints in our deployment environment, it doesn't have access to external ruby gems. Thus I package them locally to install via bundler. </p>\n\n<p>Here's my Gemfile:</p>\n\n<pre><code>gem 'rack', '=2.0.3', :path =&gt; \"/opt/app-root/src/gems\"\ngem 'puma', '=3.10.0', :path =&gt; \"/opt/app-root/src/gems\"\n</code></pre>\n\n<p>My gems are present in /opt/app-root/src/gems and when I run <code>bundle install --local --path ./bundle --deployment</code> the output is so:</p>\n\n<pre><code>Using puma 3.10.0 from source at `/opt/app-root/src/gems`\nUsing rack 2.0.3 from source at `/opt/app-root/src/gems`\nUsing bundler 1.13.7\nBundle complete! 2 Gemfile dependencies, 3 gems now installed.\nBundled gems are installed into ./bundle.\n</code></pre>\n\n<p>Yet using gem list shows them not present (nor do any expected commands work, e.g. bundle exec rackup).</p>\n\n<p>The ./bundle directory has nothing in it other than this empty directory structure:\n    /opt/app-root/src/ruby/bundle/ruby/2.4.0</p>\n\n<p>Can anyone help, what am I missing here?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx", "debian", "passenger"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9123760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a39693dab2f87ca8aae66c6bc754a06?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/9123760/steve"}, "edited": false, "score": 1, "creation_date": 1514033214, "post_id": 47941678, "comment_id": 82874545, "body": "sure, i did run all the commands as su. also with your last suggestion with the -fy option, I get the same error msg.."}], "tags": [], "owner": {"reputation": 174, "user_id": 5406581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b943f556e4eb5c3710beb4477abec779?s=128&d=identicon&r=PG&f=1", "display_name": "RoRFan", "link": "https://stackoverflow.com/users/5406581/rorfan"}, "is_accepted": false, "score": 0, "last_activity_date": 1513947268, "last_edit_date": 1513947268, "creation_date": 1513946181, "answer_id": 47941678, "question_id": 47911180, "link": "https://stackoverflow.com/questions/47911180/installation-passenger-module-for-nginx-failed/47941678#47941678", "title": "installation passenger module for nginx failed", "body": "<p>Did you try to run this command</p>\n\n<blockquote>\n  <p>apt-get install -y libnginx-mod-http-passenger</p>\n</blockquote>\n\n<p>with sudo ?</p>\n\n<p>Also try to run </p>\n\n<blockquote>\n  <p>sudo apt-get autoclean </p>\n</blockquote>\n\n<p>which will remove packages that can't be downloaded</p>\n\n<p>and afterwards the below command which will use the -f flag</p>\n\n<blockquote>\n  <p>sudo apt-get install -fy libnginx-mod-http-passenger</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 3675656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5cd079086d0750b26544c499a90c48b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3675656/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1541776791, "creation_date": 1541776791, "answer_id": 53228497, "question_id": 47911180, "link": "https://stackoverflow.com/questions/47911180/installation-passenger-module-for-nginx-failed/53228497#53228497", "title": "installation passenger module for nginx failed", "body": "<p>Old question but answer may interest someone ;)</p>\n\n<p>As far as I understand <code>libnginx-mod-http-passenger</code>, it forces the version of <code>nginx</code> to use (here  <strong>= 1.10.3-1+deb9u1</strong>), but you have the <strong>1.12.2</strong> installed (either compiled or using <em>backports</em>).</p>\n\n<p>You then need to donwgrade nginx (using <em>stable</em> rep for exemple) in order to be able to use the precompiled module. Else you can <a href=\"https://www.phusionpassenger.com/library/deploy/standalone/reverse_proxy.html\" rel=\"nofollow noreferrer\">put passenger behind a nginx reverse proxy</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 9123760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a39693dab2f87ca8aae66c6bc754a06?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/9123760/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1541776791, "creation_date": 1513790004, "last_edit_date": 1513793346, "question_id": 47911180, "link": "https://stackoverflow.com/questions/47911180/installation-passenger-module-for-nginx-failed", "title": "installation passenger module for nginx failed", "body": "<p>I want to add Passenger support do my debian9/nginx server.</p>\n\n<p>I've installed ruby and rails via apt.</p>\n\n<p><code>apt-get install -y libnginx-mod-http-passenger</code> leads to this error msg:</p>\n\n<pre><code> *The following packages have unmet dependencies:\n     libnginx-mod-http-passenger : Depends: nginx-common (= 1.10.3-1+deb9u1) but 1.12.2-1~dotdeb+8.1 is to be installed\n    E: Unable to correct problems, you have held broken packages.*\n\nmy config: \n    uname -r ==&gt; 4.9.0-4-amd64\n    cat /etc/debian_version ==&gt; 9.3\n\nnginx -V ==&gt; \n    nginx version: nginx/1.12.2\n    built with OpenSSL 1.0.1t  3 May 2016\n    TLS SNI support enabled\n    configure arguments: --with-cc-opt='-g -O2 -fstack-protector-strong        -Wformat -Werror=format-security -D_FORTIFY_SOURCE=2' --with-ld-opt='-Wl,-z,relro -Wl,-z,now' --prefix=/usr/share/nginx --conf-path=/etc/nginx/nginx.conf --http-log-path=/var/log/nginx/access.log --error-log-path=/var/log/nginx/error.log --lock-path=/var/lock/nginx.lock --pid-path=/run/nginx.pid --modules-path=/usr/lib/nginx/modules --http-client-body-temp-path=/var/lib/nginx/body --http-fastcgi-temp-path=/var/lib/nginx/fastcgi --http-proxy-temp-path=/var/lib/nginx/proxy --http-scgi-temp-path=/var/lib/nginx/scgi --http-uwsgi-temp-path=/var/lib/nginx/uwsgi --with-debug --with-pcre-jit --with-http_ssl_module --with-http_stub_status_module --with-http_realip_module --with-http_auth_request_module --with-http_v2_module --with-http_dav_module --with-file-aio --with-threads --with-http_addition_module --with-http_geoip_module=dynamic --with-http_gunzip_module --with-http_gzip_static_module --with-http_image_filter_module=dynamic --with-http_secure_link_module --with-http_sub_module --with-http_xslt_module=dynamic --with-stream=dynamic --with-stream_realip_module --with-stream_geoip_module --with-stream_ssl_module --with-stream_ssl_preread_module --with-mail=dynamic --with-mail_ssl_module --add-dynamic-module=/usr/src/builddir/debian/modules/nginx-auth-pam --add-module=/usr/src/builddir/debian/modules/nginx-dav-ext-module --add-module=/usr/src/builddir/debian/modules/nginx-echo --add-module=/usr/src/builddir/debian/modules/nginx-upstream-fair --add-module=/usr/src/builddir/debian/modules/ngx_http_substitutions_filter_module --add-module=/usr/src/builddir/debian/modules/nginx-cache-purge\n\n\nruby -v ==&gt; ruby 2.3.3p222 (2016-11-21) [x86_64-linux-gnu]\nrails -v ==&gt; Rails 4.2.7.1\n</code></pre>\n\n<p>So far I have followed the official tutorial, <a href=\"https://www.phusionpassenger.com/library/install/nginx/install/oss/stretch/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["ruby", "cookies", "web", "sinatra"], "answers": [{"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1513818070, "creation_date": 1513818070, "answer_id": 47916464, "question_id": 47910888, "link": "https://stackoverflow.com/questions/47910888/sinatra-a-part-of-a-cookie-is-missing/47916464#47916464", "title": "Sinatra - A part of a cookie is missing", "body": "<p>You need to set the value of :as like this</p>\n\n<pre><code>require 'sinatra'\nrequire \"sinatra/cookies\"\nenable :sessions\n\nget '/' do\n  response.set_cookie(:as, {value: \"fabiopavan\", expires: (Time.now + 3600)})\n  cookies # to check the contents of your cookies in the browser\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9123708, "user_type": "registered", "profile_image": "https://graph.facebook.com/751830711676384/picture?type=large", "display_name": "F&#225;bio Pavan", "link": "https://stackoverflow.com/users/9123708/f%c3%a1bio-pavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 47916464, "answer_count": 1, "score": 1, "last_activity_date": 1513818070, "creation_date": 1513788859, "last_edit_date": 1513789668, "question_id": 47910888, "link": "https://stackoverflow.com/questions/47910888/sinatra-a-part-of-a-cookie-is-missing", "title": "Sinatra - A part of a cookie is missing", "body": "<p>I'm using the framework <strong>Sinatra</strong> and I created a cookie with two variables: a username and an expire time, as follows:</p>\n\n<pre><code>logged = response.set_cookie(:login, :as =&gt; \"fabiopavan\", \n:expires =&gt; Time.now + 3600)\nputs logged\n</code></pre>\n\n<p>The cookie is shown like this:</p>\n\n<pre><code>logged=; expires=Wed, 20 Dec 2017 17:47:29 -0000\n</code></pre>\n\n<p>The problem is that the first variable, <code>:as</code>, doesn't appear.</p>\n\n<p>I also tried to add a third variable in the cookie, but it just returned the expiring time, again.</p>\n"}, {"tags": ["ruby", "if-statement", "chef-infra"], "answers": [{"comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1513791931, "post_id": 47910982, "comment_id": 82790892, "body": "The <code>if</code> statement can be extracted from the <code>case</code>. Then you only need one."}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 1, "last_activity_date": 1513789173, "creation_date": 1513789173, "answer_id": 47910982, "question_id": 47910765, "link": "https://stackoverflow.com/questions/47910765/ruby-chef-if-else-statement/47910982#47910982", "title": "Ruby/chef: IF ELSE statement", "body": "<p>The <code>=</code> operator is always an assignment operator, even in an if statement. Thus, your statement</p>\n\n<pre><code>if CREATE_OID_SCHEMA = \"true\" then\n</code></pre>\n\n<p>always assigns the string <code>\"true\"</code> to the <code>CREATE_OID_SCHEMA</code> constant (and outputs a warning at that). Since the string <code>\"true\"</code> is also truethy, the if statement will always match.</p>\n\n<p>Going forward, you probably want to update your code as follows:</p>\n\n<pre><code>case node['fmw']['shortname']\nwhen /oid1/\n  is_second_oid_install = \"false\"\n  configure_ovd_component = \"true\"\n  create_oid_schema = \"true\"\n\n  if create_oid_schema == \"true\"\n    use_existing_schema = \"false\"\n  else\n    use_existing_schema = \"true\"\n  end\nwhen /oid2/\n  is_second_oid_install = \"true\"\n  configure_ovd_component = \"false\"\n  create_oid_schema = \"false\"\n\n  if create_oid_schema == \"true\"\n    use_existing_schema = \"false\"\n  else\n    use_existing_schema = \"true\"\n  end\nend\n</code></pre>\n\n<p>In the code above, I have performed the following changes:</p>\n\n<ul>\n<li>In the if statement, I use the comparison operator <code>==</code> instead of the assignment operator <code>=</code>.</li>\n<li>variables in Ruby should always start with a lower-case letter and use <code>snake_case</code>. Bare words starting with an upper-case letter are considered constants in Ruby which should only be assigned once.</li>\n<li>The <code>then</code> keyword should usually not be used. Use newlines instead.</li>\n</ul>\n\n<p>When further updating your code, you should use real boolean values (<code>true</code> and <code>false</code>) instead of strings containing the word. That way, you can shorten your comparisons and better reflect your intentions. Generally, all values but <code>false</code> and <code>nil</code> are truethy in Ruby (and thus match in an if statement). This includes all strings, numbers, regular expressions, ...</p>\n"}], "owner": {"reputation": 715, "user_id": 6928292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/a0nBD.jpg?s=128&g=1", "display_name": "aphexlog", "link": "https://stackoverflow.com/users/6928292/aphexlog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9521, "favorite_count": 2, "accepted_answer_id": 47910982, "answer_count": 1, "score": 0, "last_activity_date": 1513789173, "creation_date": 1513788337, "question_id": 47910765, "link": "https://stackoverflow.com/questions/47910765/ruby-chef-if-else-statement", "title": "Ruby/chef: IF ELSE statement", "body": "<p>Trying to set template variable {USE_EXISTING_SCHEMA} to = true or false based on whether or not {CREATE_OID_SCHEMA} is = to true.\nshould I be using == or = when specifying the IF condition of {CREATE_OID_SCHEMA}?       </p>\n\n<pre><code>case node['fmw']['shortname']\n      when /oid1/\n        IS_SECOND_OID_INSTALL = \"false\"\n        CONFIGURE_OVD_COMPONENT = \"true\"\n        CREATE_OID_SCHEMA = \"true\"\n          if CREATE_OID_SCHEMA = \"true\" then\n            USE_EXISTING_SCHEMA = \"false\"\n          else USE_EXISTING_SCHEMA = \"true\"\n      when /oid2/\n        IS_SECOND_OID_INSTALL = \"true\"\n        CONFIGURE_OVD_COMPONENT = \"false\"\n        CREATE_OID_SCHEMA = \"false\"\n          if CREATE_OID_SCHEMA = \"true\" then\n            USE_EXISTING_SCHEMA = \"false\"\n          else USE_EXISTING_SCHEMA = \"true\"\n    end\n</code></pre>\n"}, {"tags": ["ruby", "capybara", "site-prism"], "answers": [{"comments": [{"owner": {"reputation": 1783, "user_id": 1155105, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b77026528b6e4cf1e73b7679a9c1fa1?s=128&d=identicon&r=PG", "display_name": "mickael", "link": "https://stackoverflow.com/users/1155105/mickael"}, "edited": false, "score": 0, "creation_date": 1513963369, "post_id": 47912411, "comment_id": 82860065, "body": "Thanks Thomas. I was researching how to use that <code>execute_script</code> method. Talking to developers now because it seems I cannot just call that JS function directly from the console or the automation.   I&#39;ll have to have another look in the New Year with them, as we&#39;re still not sure how this could be triggered."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1513795072, "creation_date": 1513795072, "answer_id": 47912411, "question_id": 47910756, "link": "https://stackoverflow.com/questions/47910756/how-to-attach-a-file-with-capybara-siteprism-ruby-when-theres-no-input-element/47912411#47912411", "title": "How to attach a file with Capybara/SitePrism/Ruby when there&#39;s no input element when the page loads?", "body": "<p>If there really is no <code>input</code> element on the page (double check because it's unlikely if knockout.js is being used for it), and it gets added when the use clicks the upload button via JS then there is no \"clean\" way to test that with Capybara.  The only way would be to figure out exactly what JS is being called, by the button press, and use <code>execute_script</code> to call the JS methods necessary to create the correct <code>input</code> element on the page and then attach to that. </p>\n"}], "owner": {"reputation": 1783, "user_id": 1155105, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b77026528b6e4cf1e73b7679a9c1fa1?s=128&d=identicon&r=PG", "display_name": "mickael", "link": "https://stackoverflow.com/users/1155105/mickael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513795072, "creation_date": 1513788302, "question_id": 47910756, "link": "https://stackoverflow.com/questions/47910756/how-to-attach-a-file-with-capybara-siteprism-ruby-when-theres-no-input-element", "title": "How to attach a file with Capybara/SitePrism/Ruby when there&#39;s no input element when the page loads?", "body": "<p>I'm using a test framework with Ruby, Capybara and SitePrism mainly and up until now I was using the 'attach_file(input_element, File.path)' method successfully.</p>\n\n<p>I've now moved to a different project and they've got this page where there's an 'Upload button' but there's no 'input' element whatsoever in the page on first load (checking the source code, there's not hidden element either, ie, 'input' doesn't appear in the page at all). What's happening then it's that when an user clicks on the 'Upload' button, a windows pop-out appears where they can select their file and when they select that one, there seems to be some javascript going on (I saw something to do with knockout.js, although not 100% sure if that's what's being invoked), and at that point, the code creates a totally new 'input' element in the page, which was not there originally.</p>\n\n<p>Do you know if there's a way to automate these journeys? or does the issue sound familiar so that I could research what I could do from my end?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby", "tomcat", "deployment", "chef-infra"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 3, "last_activity_date": 1513796996, "creation_date": 1513796996, "answer_id": 47912871, "question_id": 47910685, "link": "https://stackoverflow.com/questions/47910685/how-to-write-a-chef-recipe-to-copy-a-file-if-that-source-file-exists-only-if-gu/47912871#47912871", "title": "How to write a Chef recipe to copy a file if that source file exists? only_if guard not working", "body": "<p>Any code in the resource block defaults to being run at compile time. Guards run at converge time. You can fix this by making it <code>content lazy { File.open(\"#{class_path}/corp.properties\").read }</code> to force the file read to happen at converge time instead. See <a href=\"https://coderanger.net/two-pass/\" rel=\"nofollow noreferrer\">https://coderanger.net/two-pass/</a> for more info.</p>\n"}], "owner": {"reputation": 908, "user_id": 2465569, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ad25815b5f80a5f54a4badabf942b65f?s=128&d=identicon&r=PG", "display_name": "Shammoo", "link": "https://stackoverflow.com/users/2465569/shammoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 1, "accepted_answer_id": 47912871, "answer_count": 1, "score": 1, "last_activity_date": 1513796996, "creation_date": 1513788021, "question_id": 47910685, "link": "https://stackoverflow.com/questions/47910685/how-to-write-a-chef-recipe-to-copy-a-file-if-that-source-file-exists-only-if-gu", "title": "How to write a Chef recipe to copy a file if that source file exists? only_if guard not working", "body": "<p>I'm currently working on a simple script to handle properties files during a Chef deployment. I'm executing the following code with <code>chef-apply script.rb</code></p>\n\n<pre><code>class_path = '/var/lib/tomcat/webapps/ROOT/WEB-INF/classes'\nfile '/home/corp/working/corp.properties' do\n  owner 'root'\n  group 'root'\n  mode 0644\n  p File.exist?(\"#{class_path}\")\n  content File.open(\"#{class_path}/corp.properties\").read\n  action :create_if_missing\n  only_if { File.exist?(\"#{class_path}/corp.properties\") }\nend\n</code></pre>\n\n<p>But it runs with the error</p>\n\n<pre><code>false\n[2017-12-20T11:37:40-05:00] FATAL: Stacktrace dumped to /home/corp/.chef/cache/chef-stacktrace.out\n[2017-12-20T11:37:40-05:00] FATAL: Stacktrace dumped to /home/corp/.chef/cache/chef-stacktrace.out\n[2017-12-20T11:37:40-05:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report\n[2017-12-20T11:37:40-05:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report\n[2017-12-20T11:37:40-05:00] FATAL: Errno::ENOENT: No such file or directory @ rb_sysopen - /var/lib/tomcat/webapps/ROOT/WEB-INF/classes/corp.properties\n[2017-12-20T11:37:40-05:00] FATAL: Errno::ENOENT: No such file or directory @ rb_sysopen - /var/lib/tomcat/webapps/ROOT/WEB-INF/classes/corp.properties\n</code></pre>\n\n<p>As you can see, even though the <code>File.exist?</code> call is returning false, the File.open is being executed regardless of the guard.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 5856809, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-01sM-dejRWU/AAAAAAAAAAI/AAAAAAAAACE/FNXYyY6pjJo/photo.jpg?sz=128", "display_name": "Ankur Pohekar", "link": "https://stackoverflow.com/users/5856809/ankur-pohekar"}, "is_accepted": false, "score": 0, "last_activity_date": 1513788688, "creation_date": 1513788688, "answer_id": 47910849, "question_id": 47910625, "link": "https://stackoverflow.com/questions/47910625/ruby-on-rails-write-all-500-errors-to-log-file/47910849#47910849", "title": "Ruby on Rails - write all 500 errors to log file", "body": "<p>you can create your custom log file using</p>\n\n<pre><code>Logger.new(\"#{Rails.root}/log/my.log\")\n</code></pre>\n\n<p>and write 500 errors in this custom log file</p>\n"}, {"comments": [{"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1513790223, "post_id": 47910868, "comment_id": 82790013, "body": "I just tested this and it&#39;s essentially the functionality that I need. However, when a error is thrown, this is preventing Rails from handling errors like it normally does (redirecting to a 500 page, etc)."}], "tags": [], "owner": {"reputation": 1660, "user_id": 4051942, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/bCeCe.png?s=128&g=1", "display_name": "Marcelo Ribeiro", "link": "https://stackoverflow.com/users/4051942/marcelo-ribeiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1513788777, "creation_date": 1513788777, "answer_id": 47910868, "question_id": 47910625, "link": "https://stackoverflow.com/questions/47910625/ruby-on-rails-write-all-500-errors-to-log-file/47910868#47910868", "title": "Ruby on Rails - write all 500 errors to log file", "body": "<p>You can try the exception handling in the controller</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  rescue_from Exception, :with =&gt; :log_exception\n\n  def log_exception(exception)\n    File.open(Rails.root.join('logs', 'errors.log'), 'a+') do |f|\n      f.write(exception.stacktrace)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1513788777, "creation_date": 1513787829, "question_id": 47910625, "link": "https://stackoverflow.com/questions/47910625/ruby-on-rails-write-all-500-errors-to-log-file", "title": "Ruby on Rails - write all 500 errors to log file", "body": "<p>I would like to write all 500 errors (and their backtraces) on my site to a separate log file than my development.log or production.log file. How can this be achieved?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["node.js", "ruby", "daemon"], "comments": [{"owner": {"reputation": 12074, "user_id": 1985406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f441bc8d508101ba0a1eac95d6cd52c6?s=128&d=identicon&r=PG", "display_name": "Jordan Kasper", "link": "https://stackoverflow.com/users/1985406/jordan-kasper"}, "edited": false, "score": 0, "creation_date": 1513787191, "post_id": 47910125, "comment_id": 82788385, "body": "You could set up the Node process to run a server and accept input on a given port. Then just make net requests from Ruby to Node"}, {"owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "reply_to_user": {"reputation": 12074, "user_id": 1985406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f441bc8d508101ba0a1eac95d6cd52c6?s=128&d=identicon&r=PG", "display_name": "Jordan Kasper", "link": "https://stackoverflow.com/users/1985406/jordan-kasper"}, "edited": false, "score": 0, "creation_date": 1513790697, "post_id": 47910125, "comment_id": 82790256, "body": "The overhead of an HTTP request is pretty high"}, {"owner": {"reputation": 12074, "user_id": 1985406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f441bc8d508101ba0a1eac95d6cd52c6?s=128&d=identicon&r=PG", "display_name": "Jordan Kasper", "link": "https://stackoverflow.com/users/1985406/jordan-kasper"}, "edited": false, "score": 1, "creation_date": 1513790894, "post_id": 47910125, "comment_id": 82790359, "body": "No doubt... just a thought if you get no other ways to do so (I&#39;m not a Ruby person). You could actually go below HTTP though, make it a straight TCP request using the <a href=\"https://nodejs.org/api/net.html\" rel=\"nofollow noreferrer\">Net API</a>"}, {"owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "reply_to_user": {"reputation": 12074, "user_id": 1985406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f441bc8d508101ba0a1eac95d6cd52c6?s=128&d=identicon&r=PG", "display_name": "Jordan Kasper", "link": "https://stackoverflow.com/users/1985406/jordan-kasper"}, "edited": false, "score": 0, "creation_date": 1513790951, "post_id": 47910125, "comment_id": 82790390, "body": "could be a solution, thanks for the suggestion"}, {"owner": {"reputation": 6367, "user_id": 4451732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UQN4l.jpg?s=128&g=1", "display_name": "Franklin Yu", "link": "https://stackoverflow.com/users/4451732/franklin-yu"}, "edited": false, "score": 0, "creation_date": 1513803964, "post_id": 47910125, "comment_id": 82796583, "body": "If the request is so frequent that even local HTTP has significant overhead, try Unix domain socket."}], "answers": [{"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1513805407, "creation_date": 1513805407, "answer_id": 47914627, "question_id": 47910125, "link": "https://stackoverflow.com/questions/47910125/is-it-possible-to-attach-to-a-running-background-process-with-ruby/47914627#47914627", "title": "Is it possible to attach to a running background process with ruby?", "body": "<p>In general there is no way to attach to a running process's IO streams unless it was set up to do so initially. It is easy if, for example, the process was set up to read from a <a href=\"https://stackoverflow.com/questions/5374255/how-to-write-data-to-existing-processs-stdin-from-external-process\">pipe</a>: just have Ruby write to that pipe like any other file (this is what the Open3 lib does).</p>\n\n<p>For a daemon usually there are more proper ways to interact with it than hijacking its input with a pipe, though it depends on the particular daemon you are running and how it is being managed by the OS. For example, <a href=\"https://en.wikipedia.org/wiki/Unix_domain_socket\" rel=\"nofollow noreferrer\">sockets</a> are a popular way to communicate to a running process on *nix systems.</p>\n"}], "owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513805407, "creation_date": 1513785952, "question_id": 47910125, "link": "https://stackoverflow.com/questions/47910125/is-it-possible-to-attach-to-a-running-background-process-with-ruby", "title": "Is it possible to attach to a running background process with ruby?", "body": "<p>I have a nodejs daemon running on my server, I would like to give him some input on stdin and read it stdout from a Rails controller, is it possible with Ruby?</p>\n\n<p>I am looking at <code>Open3</code> but it seems to give me only the chance to spawn a new process.</p>\n\n<p>I need the keep the nodejs process running because the starting overhead is too high to be called at every request.</p>\n"}, {"tags": ["ruby", "strftime"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1513784843, "post_id": 47909644, "comment_id": 82786931, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15735591/rails-undefined-method-strftime-for-2013-03-06string\">Rails undefined method `strftime&#39; for &quot;2013-03-06&quot;:String</a>"}], "answers": [{"comments": [{"owner": {"reputation": 238, "user_id": 7991273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5f38074d32a6ff690ba29876cac40729?s=128&d=identicon&r=PG&f=1", "display_name": "raquela", "link": "https://stackoverflow.com/users/7991273/raquela"}, "edited": false, "score": 0, "creation_date": 1513785327, "post_id": 47909800, "comment_id": 82787285, "body": "Changing the line to DateTime.strptime(time_op, &quot;%Y%m%d%H%M&quot;).pop.andand does not help. It gives me &quot;`strptime&#39;: no implicit conversion of Array into String (TypeError)&quot;.  What is to_time in your example?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 238, "user_id": 7991273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5f38074d32a6ff690ba29876cac40729?s=128&d=identicon&r=PG&f=1", "display_name": "raquela", "link": "https://stackoverflow.com/users/7991273/raquela"}, "edited": false, "score": 0, "creation_date": 1513789195, "post_id": 47909800, "comment_id": 82789467, "body": "Updated. I misplaced  <code>pop</code>."}, {"owner": {"reputation": 238, "user_id": 7991273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5f38074d32a6ff690ba29876cac40729?s=128&d=identicon&r=PG&f=1", "display_name": "raquela", "link": "https://stackoverflow.com/users/7991273/raquela"}, "edited": false, "score": 0, "creation_date": 1513845135, "post_id": 47909800, "comment_id": 82809262, "body": "It works with: ruby code.rb --time 201712121100. But as sometimes I want to still execute it for current time by ruby code.rb it gives me &quot;`strptime&#39;: no implicit conversion of nil into String (TypeError)&quot;. Why this is happening?"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1513789185, "last_edit_date": 1513789185, "creation_date": 1513784817, "answer_id": 47909800, "question_id": 47909644, "link": "https://stackoverflow.com/questions/47909644/taking-a-specific-time-from-command-line-is-not-working/47909800#47909800", "title": "Taking a specific time from command line is not working", "body": "<p>The issue is here:</p>\n\n<pre><code>time_op.pop.andand\n</code></pre>\n\n<p><code>time_op</code> taken from the command line is a string, and you need a <code>Time</code> instance. The get it, use <a href=\"https://ruby-doc.org/stdlib-2.4.2/libdoc/date/rdoc/DateTime.html#method-c-strptime\" rel=\"nofollow noreferrer\"><code>DateTime#strptime</code></a>:</p>\n\n<pre><code>DateTime.strptime(time_op.pop, \"%Y%m%d%H%M\").to_time.andand\n</code></pre>\n"}], "owner": {"reputation": 238, "user_id": 7991273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5f38074d32a6ff690ba29876cac40729?s=128&d=identicon&r=PG&f=1", "display_name": "raquela", "link": "https://stackoverflow.com/users/7991273/raquela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 47909800, "answer_count": 1, "score": 0, "last_activity_date": 1513789185, "creation_date": 1513784324, "last_edit_date": 1513785813, "question_id": 47909644, "link": "https://stackoverflow.com/questions/47909644/taking-a-specific-time-from-command-line-is-not-working", "title": "Taking a specific time from command line is not working", "body": "<p>I have a program, which calculate many things. While I run the code by ruby code.rb everything is okay. The problem starts, when I want to run it by command line with additional option: ruby code.rb --time 201712121100. </p>\n\n<p>The piece of problematic code is below:</p>\n\n<pre><code>include Options #here I have some options to choose, like --time\n\ndef calculate_p(time, mode)\n   if mode\n      calculator = calc1\n   else\n      calculator = calc2\n   end\n   calculate_t(time, calculator)\n end\n\ndef calculate_t(time, calculator)\n   date_ymd = time.strftime(\"%Y%m%d\")\n   time_hm  = time.strftime(\"%H%M\")\n\n   calculator\n     .with(date_ymd, time_hm)\n   .run do |result|\n      if result.ok?\n         result.stdout.pop.split.first\n      else\n        msgw(\"Program returned with errors.\", :error)\n        msgw(\"stdout: %s; stderr: %s\" % [result.stdout, result.stderr], :error)\n        false\n      end\n    end\n end\n\ntime  = Options.get('--time')\n           .andand do |time_op|\n              msgw('Taking time from command line arguments') do\n                time_op.pop.andand\n              end\n            end || msgw('Calculating time for now.') do\n              Time.now.utc\n            end || abort\ncalc=calculate_p(time, mode)\n</code></pre>\n\n<p><code>msgw</code> is just define to print messages.</p>\n\n<p><code>mode</code> takes <code>true</code> or <code>false</code> values.</p>\n\n<p>I received an error:</p>\n\n<blockquote>\n  <p>\"<code>calculate_t</code>: undefined method <code>strftime</code> for <code>\"201712121100\":String</code> (<code>NoMethodError</code>)\"</p>\n</blockquote>\n\n<p>What am I doing wrong? Why using <code>Time.now.utc</code> is working while giving a specific time is not?</p>\n\n<p>I also checked the solutions from here <a href=\"https://stackoverflow.com/questions/15735591/rails-undefined-method-strftime-for-2013-03-06string\">Rails undefined method `strftime&#39; for &quot;2013-03-06&quot;:String</a>\nand Date.parse() gives the same error.</p>\n"}, {"tags": ["ruby", "debugging"], "answers": [{"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1513787984, "post_id": 47909504, "comment_id": 82788826, "body": "How would you use the gem for the example given by the OP?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1513794657, "post_id": 47909504, "comment_id": 82792246, "body": "That&#39;s an excellent update which gives any reader a taster of what the gem can do. Nice (Winter Bash) hairstyle too, suits you:)"}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1513796664, "post_id": 47909504, "comment_id": 82793192, "body": "@SagarPandya It&#39;s a source of extra warmth for the quickly approaching winter. :-D"}], "tags": [], "owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "is_accepted": false, "score": 1, "last_activity_date": 1513790657, "last_edit_date": 1513790657, "creation_date": 1513783912, "answer_id": 47909504, "question_id": 47909365, "link": "https://stackoverflow.com/questions/47909365/how-can-i-debug-a-ruby-method-and-see-the-value-of-my-local-variables-changing/47909504#47909504", "title": "How can I debug a Ruby method and see the value of my local variables changing?", "body": "<p>You can accomplish this with the <a href=\"https://github.com/deivid-rodriguez/byebug\" rel=\"nofollow noreferrer\">byebug</a> gem.</p>\n\n<p>You can either add breakpoints anywhere in your code by simply inserting a <code>byebug</code> line, or you can run the entire script in debug mode by invoking your script like so:</p>\n\n<pre><code>byebug something-awesome.rb\n</code></pre>\n\n<p>When you enter debug mode, you can step through your code one line at a time using the <code>step</code> command.</p>\n\n<p>Here's an example of what this process would look like:</p>\n\n<pre><code>[1, 10] in /Desktop/something-awesome.rb\n=&gt;  1: def count(n)\n    2:   x = 3\n    3:   y = 5\n    4:\n    5:   n += x\n    6:   n -= y\n    7:\n    8:   puts n\n    9: end\n   10:\n(byebug) step\n\n[2, 11] in /Desktop/something-awesome.rb\n    2:   x = 3\n    3:   y = 5\n    4:\n    5:   n += x\n    6:   n -= y\n    7:\n    8:   puts n\n    9: end\n   10:\n=&gt; 11: count(3)\n(byebug) step\n\n[1, 10] in /Desktop/something-awesome.rb\n    1: def count(n)\n=&gt;  2:   x = 3\n    3:   y = 5\n    4:\n    5:   n += x\n    6:   n -= y\n    7:\n    8:   puts n\n    9: end\n   10:\n(byebug) step\n\n[1, 10] in /Desktop/something-awesome.rb\n    1: def count(n)\n    2:   x = 3\n=&gt;  3:   y = 5\n    4:\n    5:   n += x\n    6:   n -= y\n    7:\n    8:   puts n\n    9: end\n   10:\n(byebug) x\n3\n</code></pre>\n\n<p>Notice that after I've stepped past line 2 (at the bottom of the console output), I can now type <code>x</code> to see what the value of <code>x</code> is at this point in the code.</p>\n\n<p>For a list of all available commands, check out the <a href=\"https://github.com/deivid-rodriguez/byebug#byebugs-commands\" rel=\"nofollow noreferrer\">commands section</a> of the Byebug docs.</p>\n"}, {"tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1513784197, "creation_date": 1513784197, "answer_id": 47909600, "question_id": 47909365, "link": "https://stackoverflow.com/questions/47909365/how-can-i-debug-a-ruby-method-and-see-the-value-of-my-local-variables-changing/47909600#47909600", "title": "How can I debug a Ruby method and see the value of my local variables changing?", "body": "<p>I absolutely love the <a href=\"https://github.com/pry/pry\" rel=\"nofollow noreferrer\">pry</a> gem. </p>\n\n<p>It's an awesome and powerful interface that allows you to change directory through instances and classes (i.e. <code>cd User.first</code>), list methods (<code>ls</code>) and even interact with the shell (<code>shell-mode; .pwd</code>) - all by dropping a simple <code>binding.pry</code> from wherever you want it to kick in.</p>\n\n<p>Also worth noting that Ruby 2.5 is coming with <code>binding.irb</code> shipping - I've not taken a look at it yet, but that'll be the native equivalent and hopefully remove the need for third party gems.</p>\n"}], "owner": {"reputation": 77, "user_id": 8714564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a537d062960bda20fb93fc3011ba1b5?s=128&d=identicon&r=PG&f=1", "display_name": "syed zaidi", "link": "https://stackoverflow.com/users/8714564/syed-zaidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513797505, "creation_date": 1513783475, "last_edit_date": 1513797505, "question_id": 47909365, "link": "https://stackoverflow.com/questions/47909365/how-can-i-debug-a-ruby-method-and-see-the-value-of-my-local-variables-changing", "title": "How can I debug a Ruby method and see the value of my local variables changing?", "body": "<p>Take for example the following method, and then the calling of the method:</p>\n\n<pre><code>def count(n)\n  x=3\n  y=5\n\n  n+=x\n  n-=y\n\n  puts n\nend\n\ncount(3)\n</code></pre>\n\n<p>I was wondering if there is anyway that when I go to run this script in my terminal, when it gets to the count(3) line where the method is actually being called, rather than simply output \"n\", is there anyway I can step through the method line by line with a window where I can see my local variables (n, x and y) so that I can see the value of \"n\" changing as the method executes before that final value is outputted to my terminal.</p>\n"}, {"tags": ["ruby", "passenger", "jruby"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8270045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3b5381c9cf2d1ed00169b6b381267?s=128&d=identicon&r=PG&f=1", "display_name": "makmik", "link": "https://stackoverflow.com/users/8270045/makmik"}, "is_accepted": false, "score": 0, "last_activity_date": 1514973134, "creation_date": 1514973134, "answer_id": 48074940, "question_id": 47907588, "link": "https://stackoverflow.com/questions/47907588/phusion-passenger-standalone-how-to-pass-a-command-line-flag-to-ruby/48074940#48074940", "title": "Phusion Passenger Standalone: How to pass a command line flag to ruby?", "body": "<p>I found that you can set an environment variable, which also applies to the instantiated passenger server:</p>\n\n<pre><code>env JRUBY_OPTS=--1.8 ruby -S passenger start\n</code></pre>\n\n<p>works like a charm.\nSee the <a href=\"https://github.com/jruby/jruby/wiki/FAQs\" rel=\"nofollow noreferrer\">JRuby FAQ</a> for further details.</p>\n"}], "owner": {"reputation": 11, "user_id": 8270045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3b5381c9cf2d1ed00169b6b381267?s=128&d=identicon&r=PG&f=1", "display_name": "makmik", "link": "https://stackoverflow.com/users/8270045/makmik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514973134, "creation_date": 1513777943, "question_id": 47907588, "link": "https://stackoverflow.com/questions/47907588/phusion-passenger-standalone-how-to-pass-a-command-line-flag-to-ruby", "title": "Phusion Passenger Standalone: How to pass a command line flag to ruby?", "body": "<p>As part of a performance analysis, I'd like to run my rails app with several different rubies. All of them have the gem <code>passenger</code> (v5) installed and are able to run <code>passenger start</code>.</p>\n\n<p>The question: How can I pass a flag (like <code>--1.8</code>) to my ruby interpreter? I'm using the version manager <code>rbenv</code>, but when I'm running\n<code>\nruby --1.8 -S passenger start\n</code></p>\n\n<p>using the interpreter <code>jruby-1.7.27</code>, the flag is non-persistant i.e. jruby does not run in the 1.8 compatibility mode.</p>\n"}, {"tags": ["ruby", "nokogiri", "screen-scraping", "scrape"], "comments": [{"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1513776766, "post_id": 47906742, "comment_id": 82781458, "body": "what is your question?"}, {"owner": {"reputation": 1848, "user_id": 4089357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628dc1c999e767d7aff0e988631a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/4089357/abdullah"}, "edited": false, "score": 0, "creation_date": 1513777661, "post_id": 47906742, "comment_id": 82782041, "body": "Please share <code>url</code> or html document sample"}, {"owner": {"reputation": 41, "user_id": 5244092, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/85dc8164b8fbf6a6c99e4a0912af1799?s=128&d=identicon&r=PG&f=1", "display_name": "alexnewby", "link": "https://stackoverflow.com/users/5244092/alexnewby"}, "edited": false, "score": 0, "creation_date": 1513778625, "post_id": 47906742, "comment_id": 82782694, "body": "I am trying to get the href value of the student-card class containers."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5244092, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/85dc8164b8fbf6a6c99e4a0912af1799?s=128&d=identicon&r=PG&f=1", "display_name": "alexnewby", "link": "https://stackoverflow.com/users/5244092/alexnewby"}, "edited": false, "score": 0, "creation_date": 1513780354, "post_id": 47908128, "comment_id": 82783819, "body": "Only thing, I&#39;m getting an error for the href: no implicit conversion of String into Integer. Wonder what gives?"}, {"owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "reply_to_user": {"reputation": 41, "user_id": 5244092, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/85dc8164b8fbf6a6c99e4a0912af1799?s=128&d=identicon&r=PG&f=1", "display_name": "alexnewby", "link": "https://stackoverflow.com/users/5244092/alexnewby"}, "edited": false, "score": 0, "creation_date": 1513780643, "post_id": 47908128, "comment_id": 82784025, "body": "Sorry about that. When you use the <code>css</code> method, it returns a <code>Nokogiri::XML::NodeSet</code>. You want to get the href from the <code>Nokogiri::XML::Element</code> inside the NodeSet. In your example, <code>student_card.css(&quot;a&quot;).first[&quot;href&quot;]</code> should return the href."}], "tags": [], "owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "is_accepted": true, "score": 2, "last_activity_date": 1513780560, "last_edit_date": 1513780560, "creation_date": 1513779779, "answer_id": 47908128, "question_id": 47906742, "link": "https://stackoverflow.com/questions/47906742/scraping-the-href-value-of-anchor-in-ruby/47908128#47908128", "title": "Scraping the href value of anchor in Ruby", "body": "<p>Once you get an anchor tag in Nokogiri, you can get the href like this:</p>\n\n<pre><code>anchor[\"href\"]\n</code></pre>\n\n<p>So in your example, you could get the href by doing the following:</p>\n\n<pre><code>student_card = doc.css(\".student-card\").first\nhref = student_card.css(\"a\").first[\"href\"]\n</code></pre>\n\n<p>If you wanted to collect all of the href values at once, you could do something like this:</p>\n\n<pre><code>hrefs = doc.css(\".student-card a\").map { |anchor| anchor[\"href\"] }\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5244092, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/85dc8164b8fbf6a6c99e4a0912af1799?s=128&d=identicon&r=PG&f=1", "display_name": "alexnewby", "link": "https://stackoverflow.com/users/5244092/alexnewby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1581, "favorite_count": 0, "accepted_answer_id": 47908128, "answer_count": 1, "score": 0, "last_activity_date": 1513780560, "creation_date": 1513775079, "last_edit_date": 1513779018, "question_id": 47906742, "link": "https://stackoverflow.com/questions/47906742/scraping-the-href-value-of-anchor-in-ruby", "title": "Scraping the href value of anchor in Ruby", "body": "<p>Working on this project where I have to scrape a \"website,\" which is just a an html file in one of the local folders. Anyway, I've been trying to scrape down to the href value (a url) of the anchor tag for each <em>student</em> object. I am also scraping for other things, so ignore the rest. Here is what I have so far:</p>\n\n<pre><code>def self.scrape_index_page(index_url) #responsible for scraping the index page that lists all of the students\n    #return an array of hashes in which each hash represents one student.\n    html = index_url\n    doc = Nokogiri::HTML(open(html))\n    # doc.css(\".student-name\").first.text\n    # doc.css(\".student-location\").first.text\n    #student_card = doc.css(\".student-card\").first\n    #student_card.css(\"a\").text\nend\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/mHK1y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mHK1y.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is one of the student profiles. They are all the same, so I'm just interested in scraping the href url value. </p>\n\n<pre><code>&lt;div class=\"student-card\" id=\"eric-chu-card\"&gt;\n   &lt;a href=\"students/eric-chu.html\"&gt;\n      &lt;div class=\"view-profile-div\"&gt;\n         &lt;h3 class=\"view-profile-text\"&gt;View Profile&lt;/h3&gt;\n      &lt;/div&gt;\n      &lt;div class=\"card-text-container\"&gt;\n         &lt;h4 class=\"student-name\"&gt;Eric Chu&lt;/h4&gt;\n         &lt;p class=\"student-location\"&gt;Glenelg, MD&lt;/p&gt;\n      &lt;/div&gt;\n   &lt;/a&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>thanks for your help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "uuid", "secure-random"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1513775046, "post_id": 47906621, "comment_id": 82780342, "body": "Indeed, this should be near-impossible. But we probably won&#39;t be able to tell what went wrong on your machine. Btw, now you know you should create a unique index on that uuid field."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513775316, "post_id": 47906621, "comment_id": 82780507, "body": "What does <code>Array.new(10**6) { SecureRandom.uuid }.uniq.size</code> on that machine tell you?"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513775456, "post_id": 47906621, "comment_id": 82780601, "body": "And what Ruby version are you using?"}, {"owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513775867, "post_id": 47906621, "comment_id": 82780861, "body": "I am using Ruby 2.3.3p222, and running that gives me <code>1000000</code> @StefanPochmann, @Sergio, that is the first thing I mentioned to them. I am just assisting in trying to come up with a reason as to what is happening."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513776108, "post_id": 47906621, "comment_id": 82781026, "body": "Is maybe some <i>other</i> code <i>later on</i> changing the values?"}, {"owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "edited": false, "score": 0, "creation_date": 1513776338, "post_id": 47906621, "comment_id": 82781180, "body": "So directly after generating these links, we fire a message to RabbitMQ that is picked up by an external system, that system then hits our API and grabs the record, it&#39;s also the external system that raised the red flag that had us do some investigation only to find out that the 18 records also sit this side, the DateTime stamps suggest they all where generated with the rake task."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 3, "creation_date": 1513776486, "post_id": 47906621, "comment_id": 82781272, "body": "Note that the first entry&#39;s <code>updated_at</code> is the same as its <code>created_at</code>, but all others got updated 12 days later (all during the same decisecond). Maybe that &quot;update&quot; somehow copied that first entry&#39;s guid to those other entries?"}, {"owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "edited": false, "score": 1, "creation_date": 1513776555, "post_id": 47906621, "comment_id": 82781311, "body": "I am going to suggest we just drop the table and drop the table in the external system, add a unique constraint on the <code>guid</code> column and re-run the rake task to re-generate the <code>uuid</code> and send the whole bunch through the bus to the other system. This just made me feel uncomfortable."}, {"owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 1, "creation_date": 1513776656, "post_id": 47906621, "comment_id": 82781390, "body": "@StefanPochmann you legend! thanks that is a great clue, I didn&#39;t even notice that disparity. There must be something else in this system that is writing to this table."}], "owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 631, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513774654, "creation_date": 1513774654, "question_id": 47906621, "link": "https://stackoverflow.com/questions/47906621/ruby-securerandom-generating-same-result", "title": "Ruby SecureRandom generating same result", "body": "<p>Have a task that generates a <code>uuid</code> for each user, we use this as a external reference code. I created a rake task to create a <code>PromoLink</code> which generates a  <code>uuid</code> for each user using rubys SecureRandom class:</p>\n\n<pre><code>ActiveRecord::Base.transaction do\n  User.each { |user_id| PromoLink.create(user_id: user_id, guid: SecureRandom.uuid)}\nend\n</code></pre>\n\n<p>This seemed to work only when doing some reconnaissance a few weeks later I noticed there are 18 records that have the same <code>uuid</code>, the really tricky bit is that they were not all found to be next to each other, there is some that are duplicates but 1000's of user_id's later. as you will see some <code>created_at</code> dates are a good 6.6 seconds from each other. Any Idea how this could happen, I thought that the chances of a <code>SecureRandom.uuid</code> generating a duplicate was near-impossible, so 18 duplicates seem really unfathomable.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5FPFt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5FPFt.png\" alt=\"uuid-madness\"></a></p>\n"}, {"tags": ["ruby", "ldap", "openldap", "ldap-query"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 7264802, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9619647177653103cccb62e579a2cadc?s=128&d=identicon&r=PG&f=1", "display_name": "Praneetha", "link": "https://stackoverflow.com/users/7264802/praneetha"}, "edited": false, "score": 1, "creation_date": 1514132027, "post_id": 47937746, "comment_id": 82893519, "body": "I have given access control in my slapd.conf file and yet I get insufficient access rights. My access control is :                                                         `  access to *          by * read`"}], "tags": [], "owner": {"reputation": 4178, "user_id": 738708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7d0f23ff8919a2720a7845ba1d4e5a?s=128&d=identicon&r=PG", "display_name": "Ludovic Poitou", "link": "https://stackoverflow.com/users/738708/ludovic-poitou"}, "is_accepted": true, "score": 0, "last_activity_date": 1513929168, "creation_date": 1513929168, "answer_id": 47937746, "question_id": 47906465, "link": "https://stackoverflow.com/questions/47906465/insufficient-access-rights-in-ldap/47937746#47937746", "title": "Insufficient access rights in ldap", "body": "<p>Insufficient Access Rights means that the LDAP server has been configured to restrict who can access what. It's not a Bind (Authentication) error. You might want to check with the LDAP server administrator for the details.</p>\n"}], "owner": {"reputation": 171, "user_id": 7264802, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9619647177653103cccb62e579a2cadc?s=128&d=identicon&r=PG&f=1", "display_name": "Praneetha", "link": "https://stackoverflow.com/users/7264802/praneetha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1251, "favorite_count": 0, "accepted_answer_id": 47937746, "answer_count": 1, "score": 3, "last_activity_date": 1513929168, "creation_date": 1513774141, "last_edit_date": 1513775732, "question_id": 47906465, "link": "https://stackoverflow.com/questions/47906465/insufficient-access-rights-in-ldap", "title": "Insufficient access rights in ldap", "body": "<p>I get insufficient access rights when trying to bind to an LDAP server using existing user_dn and userPassword even if the userPassword is incorrect. And I get invalid credentials if I put incorrect user_dn. </p>\n\n<p>Why am I getting those errors? and what is the meaning of those errors? How should I fix them? </p>\n\n<p>This is the code I used for binding </p>\n\n<pre><code>require 'net/ldap'\ncon = Net::LDAP.new\ncon.host = 'localhost'\ncon.port = 389\ncon.auth 'cn=user,dc=example,dc=com', 'user'\n\nif con.bind\n  # authentication succeeded\n  puts 'success'\n  puts con.get_operation_result\nelse\n  # authentication failed\n  puts 'fail'\n  puts con.get_operation_result\n # p con.get_operation_result\nend\n</code></pre>\n\n<p>Thanks in advance   </p>\n"}, {"tags": ["ruby", "file-permissions", "cp"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8719073, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b3f830a405b767be257f877f7711fa7?s=128&d=identicon&r=PG", "display_name": "thraizz", "link": "https://stackoverflow.com/users/8719073/thraizz"}, "is_accepted": true, "score": 0, "last_activity_date": 1513777133, "creation_date": 1513777133, "answer_id": 47907351, "question_id": 47906129, "link": "https://stackoverflow.com/questions/47906129/ruby-cp-ignores-access-permissions-if-not-pointing-to-specific-file/47907351#47907351", "title": "ruby cp ignores access permissions if not pointing to specific file", "body": "<p>I solved it myself, with <code>cp_r</code> you can add the preserve option which keeps permissions as-is.</p>\n\n<p>The line <code>cp_r Dir[lib/\"directory/defaultconfigs/*\"], etc/\"directory\", :preserve =&gt; true</code> works for me.</p>\n"}], "owner": {"reputation": 21, "user_id": 8719073, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b3f830a405b767be257f877f7711fa7?s=128&d=identicon&r=PG", "display_name": "thraizz", "link": "https://stackoverflow.com/users/8719073/thraizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 47907351, "answer_count": 1, "score": 0, "last_activity_date": 1513777133, "creation_date": 1513773035, "question_id": 47906129, "link": "https://stackoverflow.com/questions/47906129/ruby-cp-ignores-access-permissions-if-not-pointing-to-specific-file", "title": "ruby cp ignores access permissions if not pointing to specific file", "body": "<p>I have following code:</p>\n\n<pre><code>def post_install\n\n  cp Dir[lib/\"directory/defaultconfigs/*\"], etc/\"directory\"\n</code></pre>\n\n<p>While the snippet above ignores the access permissions,</p>\n\n<pre><code>cp Dir[lib/\"directory/defaultconfigs/testfile.d\"], etc/\"directory\"\n</code></pre>\n\n<p>does not ignore it.\nHow do I get the first command to copy all files including their permissions?</p>\n"}, {"tags": ["ruby", "api", "bitcoin", "kraken.com"], "comments": [{"owner": {"reputation": 57, "user_id": 7646117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e08f4345f97cbdd3c7c2ce56f2c687c?s=128&d=identicon&r=PG&f=1", "display_name": "gvdh", "link": "https://stackoverflow.com/users/7646117/gvdh"}, "edited": false, "score": 0, "creation_date": 1513782626, "post_id": 47905752, "comment_id": 82785440, "body": "I just tried with BCH as an asset and it works. I think it comes from kraken but why do they consider XBT as an invalid asset ??"}, {"owner": {"reputation": 5786, "user_id": 5127888, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/0AoRZ.png?s=128&g=1", "display_name": "p0k8h", "link": "https://stackoverflow.com/users/5127888/p0k8h"}, "edited": false, "score": 0, "creation_date": 1521096214, "post_id": 47905752, "comment_id": 85588518, "body": "try <code>XXBT</code> as asset"}], "answers": [{"tags": [], "owner": {"reputation": 6426, "user_id": 4471715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af5026f58744339680af12b163aad259?s=128&d=identicon&r=PG&f=1", "display_name": "A STEFANI", "link": "https://stackoverflow.com/users/4471715/a-stefani"}, "is_accepted": false, "score": 0, "last_activity_date": 1529933173, "creation_date": 1529933173, "answer_id": 51024615, "question_id": 47905752, "link": "https://stackoverflow.com/questions/47905752/kraken-api-withdrawal-issue-invalid-asset/51024615#51024615", "title": "Kraken Api, withdrawal issue &quot;Invalid asset&quot;", "body": "<p><code>asset</code> need to be specified as <strong>lowercase</strong>, so you may try with </p>\n\n<pre><code>@kraken = KrakenClient.load\n\ndef withdraw_order_kraken\n  params = {\n    asset:'xbt',\n    key:'Bitstamp',\n    amount: 0.005\n  }\n  @kraken.private.withdraw(params)\nend\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7646117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e08f4345f97cbdd3c7c2ce56f2c687c?s=128&d=identicon&r=PG&f=1", "display_name": "gvdh", "link": "https://stackoverflow.com/users/7646117/gvdh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 401, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529933173, "creation_date": 1513771701, "last_edit_date": 1513782318, "question_id": 47905752, "link": "https://stackoverflow.com/questions/47905752/kraken-api-withdrawal-issue-invalid-asset", "title": "Kraken Api, withdrawal issue &quot;Invalid asset&quot;", "body": "<p>I'm trying to make a withdraw from my Kraken account to another platform, but i always get this error response:</p>\n\n<blockquote>\n  <p>EFunding:Invalid asset (KrakenClient::ErrorResponse)</p>\n</blockquote>\n\n<p>Using this code:</p>\n\n<pre><code>@kraken = KrakenClient.load\n\ndef withdraw_order_kraken\n  params = {\n    asset:'XBT',\n    key:'Bitstamp',\n    amount: 0.005\n  }\n  @kraken.private.withdraw(params)\nend\n</code></pre>\n\n<p>Any idea what am i doing wrong? </p>\n\n<p>I can do any others actions, public or private (even buy or sell). I tried XXBT/XBT/BTC/Bitcoin and i do have 0.005 BTC available on this account. </p>\n\n<p>The error message is not in the Kraken's API docs.</p>\n"}, {"tags": ["ruby", "redmine", "redmine-plugins"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1513788487, "post_id": 47905670, "comment_id": 82789111, "body": "When pasting log output, please don&#39;t paste it as a quotation but use code formatting instead (paste them with 4 spaces at the start of each line). The way you have pasted it here, the logs are about unreadable since all line-breaks were removed."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9062837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-otPfKrkK1pA/AAAAAAAAAAI/AAAAAAAAAFk/V9ebU9oh5eg/photo.jpg?sz=128", "display_name": "Animated cartoon", "link": "https://stackoverflow.com/users/9062837/animated-cartoon"}, "edited": false, "score": 0, "creation_date": 1513793377, "post_id": 47910781, "comment_id": 82791650, "body": "Now I tried RedmineUP&#39;s agile plugin. issued the same error("}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "reply_to_user": {"reputation": 1, "user_id": 9062837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-otPfKrkK1pA/AAAAAAAAAAI/AAAAAAAAAFk/V9ebU9oh5eg/photo.jpg?sz=128", "display_name": "Animated cartoon", "link": "https://stackoverflow.com/users/9062837/animated-cartoon"}, "edited": false, "score": 0, "creation_date": 1513804897, "post_id": 47910781, "comment_id": 82796974, "body": "You also need to remove the AgileDwarf plugin."}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": false, "score": 0, "last_activity_date": 1513788409, "creation_date": 1513788409, "answer_id": 47910781, "question_id": 47905670, "link": "https://stackoverflow.com/questions/47905670/uninitialized-constant-applicationhelpergravatarhelper-when-installing-agiledw/47910781#47910781", "title": "uninitialized constant ApplicationHelper::GravatarHelper when installing AgileDwarf plugin on Redmine 3.3", "body": "<p>The <a href=\"https://github.com/iRessources/AgileDwarf\" rel=\"nofollow noreferrer\">AgileDwarf plugin</a> seems to be unmaintained since about 5 years. Judging from the <a href=\"https://github.com/iRessources/AgileDwarf/issues\" rel=\"nofollow noreferrer\">various filled issues</a> on the project, it appears the plugin is not compatible with Redmine 3.x. There appear to be multiple issues in all layers of the plugin preventing its use in current Redmine versions.</p>\n\n<p>You might be able to find a fork of the plugin where someone provides support for Redmine 3.x.</p>\n\n<p>Alternatively (and this is probably the better option going forward), you could find a different plugin for agile issue management, e.g. <a href=\"https://www.redmineup.com/pages/plugins/agile\" rel=\"nofollow noreferrer\">RedmineUP's agile plugin</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9062837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-otPfKrkK1pA/AAAAAAAAAAI/AAAAAAAAAFk/V9ebU9oh5eg/photo.jpg?sz=128", "display_name": "Animated cartoon", "link": "https://stackoverflow.com/users/9062837/animated-cartoon"}, "is_accepted": true, "score": 0, "last_activity_date": 1513859803, "creation_date": 1513859803, "answer_id": 47925162, "question_id": 47905670, "link": "https://stackoverflow.com/questions/47905670/uninitialized-constant-applicationhelpergravatarhelper-when-installing-agiledw/47925162#47925162", "title": "uninitialized constant ApplicationHelper::GravatarHelper when installing AgileDwarf plugin on Redmine 3.3", "body": "<p>I realized my mistake, just need create folder <code>plugins</code> in <code>usr/share/redmine/</code> and deploy they here. If deploy plugins in /<code>usr/share/redmine/lib/plugins</code> this returns an error.</p>\n"}], "owner": {"reputation": 1, "user_id": 9062837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-otPfKrkK1pA/AAAAAAAAAAI/AAAAAAAAAFk/V9ebU9oh5eg/photo.jpg?sz=128", "display_name": "Animated cartoon", "link": "https://stackoverflow.com/users/9062837/animated-cartoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 47925162, "answer_count": 2, "score": 0, "last_activity_date": 1513859803, "creation_date": 1513771426, "last_edit_date": 1513788559, "question_id": 47905670, "link": "https://stackoverflow.com/questions/47905670/uninitialized-constant-applicationhelpergravatarhelper-when-installing-agiledw", "title": "uninitialized constant ApplicationHelper::GravatarHelper when installing AgileDwarf plugin on Redmine 3.3", "body": "<p>I'm clone plugin in <code>/usr/share/redmine/lib/plugins</code> from <code>git clone</code> <a href=\"https://github.com/iRessources/AgileDwarf\" rel=\"nofollow noreferrer\">https://github.com/iRessources/AgileDwarf</a> . When i execute in directory <code>/usr/share/redmine</code> <code>bundle install --without development test --no-deployment</code> Output: </p>\n\n<blockquote>\n  <p>Don't run Bundler as root. Bundler can ask for sudo if it is needed,\n  and installing your bundle as root will break this application for all\n  non-root users on this machine. Using rake 10.5.0 Using i18n 0.7.0\n  Using json 2.0.1 Using minitest 5.9.0 Using thread_safe 0.3.5 Using\n  builder 3.2.2 Using erubis 2.7.0 Using nokogiri 1.6.8.1 Using rack\n  1.6.4 Using mime-types 2.6.1 Using arel 6.0.3 Using addressable 2.4.0 Using coderay 1.1.1 Using concurrent-ruby 1.0.0 Using htmlentities\n  4.3.3 Using thor 0.19.1 Using mimemagic 0.3.0 Using net-ldap 0.12.1 Using pg 0.18.4 Using ruby-openid 2.7.0 Using bundler 1.13.6 Using\n  rbpdf-font 1.19.0 Using redcarpet 3.3.4 Using request_store 1.3.0\n  Using rmagick 2.16.0 Using tzinfo 1.2.2 Using loofah 2.0.3 Using\n  rack-test 0.6.3 Using mail 2.6.4 Using css_parser 1.3.6 Using\n  sprockets 3.7.0 Using rack-openid 1.4.2 Using rbpdf 1.19.0 Using\n  activesupport 4.2.7.1 Using rails-html-sanitizer 1.0.3 Using roadie\n  3.1.1 Using rails-deprecated_sanitizer 1.0.3 Using globalid 0.3.6 Using activemodel 4.2.7.1 Using rails-dom-testing 1.0.6 Using\n  activejob 4.2.7.1 Using activerecord 4.2.7.1 Using\n  protected_attributes 1.1.3 Using actionview 4.2.7.1 Using actionpack\n  4.2.7.1 Using actionmailer 4.2.7.1 Using actionpack-action_caching 1.1.1 Using actionpack-xml_parser 1.0.2 Using railties 4.2.7.1 Using sprockets-rails 2.3.2 Using jquery-rails 4.2.1 Using roadie-rails\n  1.1.0 Using rails 4.2.7.1 Bundle complete! 23 Gemfile dependencies, 53 gems now installed. Gems in the groups development and test were not\n  installed. Use <code>bundle show [gemname]</code> to see where a bundled gem is\n  installed.</p>\n</blockquote>\n\n<p>Next <code>bundle exec rake redmine:plugins NAME=AgileDwarf RAILS_ENV=production</code>. Output </p>\n\n<blockquote>\n  <p>rake aborted! NameError: uninitialized constant\n  ApplicationHelper::GravatarHelper\n  /usr/share/redmine/app/helpers/application_helper.rb:26:in\n  <code>&lt;module:ApplicationHelper&gt;'\n  /usr/share/redmine/app/helpers/application_helper.rb:23:in</code>'\n  /usr/share/redmine/lib/redmine/hook/view_listener.rb:34:in\n  <code>&lt;class:ViewListener&gt;'\n  /usr/share/redmine/lib/redmine/hook/view_listener.rb:22:in\n  </code>'\n  /usr/share/redmine/lib/redmine/hook/view_listener.rb:19:in\n  <code>&lt;module:Redmine&gt;'\n  /usr/share/redmine/lib/redmine/hook/view_listener.rb:18:in</code>' /usr/share/redmine/lib/redmine.rb:66:in <code>&lt;top\n  (required)&gt;' /usr/share/redmine/lib/plugins/AgileDwarf/init.rb:1:in\n  </code>block in '\n  /usr/share/redmine/config/initializers/00-core_plugins.rb:12:in <code>eval'\n  /usr/share/redmine/config/initializers/00-core_plugins.rb:12:in</code>block\n  in '\n  /usr/share/redmine/config/initializers/00-core_plugins.rb:2:in <code>each'\n  /usr/share/redmine/config/initializers/00-core_plugins.rb:2:in</code>' /usr/share/redmine/config/environment.rb:14:in <code>&lt;top\n  (required)&gt;' /usr/share/redmine/lib/tasks/redmine.rake:52:in</code>block (2\n  levels) in ' Tasks: TOP => redmine:plugins:migrate =>\n  environment (See full trace by running task with --trace)</p>\n</blockquote>\n\n<p>When i'm restart apache2. And on the site wrote an error: </p>\n\n<blockquote>\n  <p>We're sorry, but something went wrong.</p>\n  \n  <p>We've been notified about this issue and we'll take a look at it\n  shortly. Information for the administrator of this website</p>\n  \n  <p>The Phusion Passenger application server encountered an error while\n  starting your web application. Because you are running this web\n  application in staging or production mode, the details of the error\n  have been omitted from this web page for security reasons.</p>\n  \n  <p>Please read the Passenger log file to find the details of the error.</p>\n  \n  <p>Alternatively, you can turn on the \"friendly error pages\" feature (see\n  below), which will make Phusion Passenger show many details about the\n  error right in the browser.</p>\n  \n  <p>To turn on friendly error pages:</p>\n</blockquote>\n\n<p>Redmine version: </p>\n\n<blockquote>\n  <p>Environment:   Redmine version                3.3.1.stable   Ruby\n  version                   2.3.3-p222 (2016-11-21) [x86_64-linux-gnu]<br>\n  Rails version                  4.2.7.1   Environment<br>\n  production   Database adapter               PostgreSQL SCM:   Git<br>\n  2.11.0   Filesystem                      Redmine plugins:   no plugin installed</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "omniauth"], "comments": [{"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1513771950, "post_id": 47905428, "comment_id": 82778282, "body": "Thank you for a try but that&#39;s not fix,  tried nothing and didnt do any change there, the code is there the same for few months also in tutorial there are no user.save."}], "answers": [{"tags": [], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "is_accepted": true, "score": 0, "last_activity_date": 1513776785, "creation_date": 1513776785, "answer_id": 47907244, "question_id": 47905428, "link": "https://stackoverflow.com/questions/47905428/rails-devise-omniauth-new-user-registration-url/47907244#47907244", "title": "Rails Devise Omniauth new_user_registration_url", "body": "<p>I found the reason in user.rb  model I had one association belongs_to:somemodel and that I was put there for testing some model relations.</p>\n\n<p>So commenting this line I am logged in by facebook!</p>\n"}], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 47907244, "answer_count": 1, "score": 0, "last_activity_date": 1513776785, "creation_date": 1513770638, "question_id": 47905428, "link": "https://stackoverflow.com/questions/47905428/rails-devise-omniauth-new-user-registration-url", "title": "Rails Devise Omniauth new_user_registration_url", "body": "<p>I had implemented devise gem and omniauth-facebook before few months into my app and everything was worked as usual, until now when I deleted my fb user from db.\nNow I am trying to sign in again as nonexisting user and all the time I am redirected to Devise Sign Up form.</p>\n\n<p>So I cant log in/ register my FB user into my app.</p>\n\n<p>What can cause this type of problem?</p>\n\n<p>routes.rb</p>\n\n<pre><code>  devise_for :users, :controllers =&gt; { :omniauth_callbacks =&gt; \"users/omniauth_callbacks\" }\n</code></pre>\n\n<p>omniouth_callback_controller.rb</p>\n\n<pre><code>class Users::OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController\n  def facebook\n    # You need to implement the method below in your model (e.g. app/models/user.rb)\n    @user = User.from_omniauth(request.env[\"omniauth.auth\"])\n\n    if @user.persisted?\n      sign_in_and_redirect @user, :event =&gt; :authentication #this will throw if @user is not activated\n      set_flash_message(:notice, :success, :kind =&gt; \"Facebook\") if is_navigational_format?\n    else\n      session[\"devise.facebook_data\"] = request.env[\"omniauth.auth\"]\n      redirect_to new_user_registration_url\n    end\n  end\n\n  def failure\n    redirect_to root_path\n  end\nend\n</code></pre>\n\n<p>user.rb model</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable, :omniauthable, :omniauth_providers =&gt; [:facebook]\n\n  def self.new_with_session(params, session)\n    super.tap do |user|\n      if data = session[\"devise.facebook_data\"] &amp;&amp; session[\"devise.facebook_data\"][\"extra\"][\"raw_info\"]\n        user.email = data[\"email\"] if user.email.blank?\n      end\n    end\n  end\n\n\n  def self.from_omniauth(auth)\n    where(provider: auth.provider, uid: auth.uid).first_or_create do |user|\n      user.email = auth.info.email\n      user.password = Devise.friendly_token[0,20]\n      user.name = auth.info.name   # assuming the user model has a name\n      user.image = auth.info.image # assuming the user model has an image\n    end\n  end\n</code></pre>\n\n<p>rails routes</p>\n\n<pre><code>     new_user_session GET      /users/sign_in(.:format)                 devise/sessions#new\n                    user_session POST     /users/sign_in(.:format)                 devise/sessions#create\n            destroy_user_session DELETE   /users/sign_out(.:format)                devise/sessions#destroy\nuser_facebook_omniauth_authorize GET|POST /users/auth/facebook(.:format)           users/omniauth_callbacks#passthru\n user_facebook_omniauth_callback GET|POST /users/auth/facebook/callback(.:format)  users/omniauth_callbacks#facebook\n               new_user_password GET      /users/password/new(.:format)            devise/passwords#new\n              edit_user_password GET      /users/password/edit(.:format)           devise/passwords#edit\n                   user_password PATCH    /users/password(.:format)                devise/passwords#update\n                                 PUT      /users/password(.:format)                devise/passwords#update\n                                 POST     /users/password(.:format)                devise/passwords#create\n        cancel_user_registration GET      /users/cancel(.:format)                  devise/registrations#cancel\n           new_user_registration GET      /users/sign_up(.:format)                 devise/registrations#new\n          edit_user_registration GET      /users/edit(.:format)                    devise/registrations#edit\n               user_registration PATCH    /users(.:format)                         devise/registrations#update\n                                 PUT      /users(.:format)                         devise/registrations#update\n                                 DELETE   /users(.:format)                         devise/registrations#destroy\n                                 POST     /users(.:format)                         devise/registrations#create\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 336, "user_id": 7068523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8ebdf5ca5c8079eb081ae92a7fcafc?s=128&d=identicon&r=PG", "display_name": "Miquel Al. Vicens", "link": "https://stackoverflow.com/users/7068523/miquel-al-vicens"}, "edited": false, "score": 0, "creation_date": 1513769926, "post_id": 47905171, "comment_id": 82776987, "body": "Please, tag Ruby too."}], "answers": [{"comments": [{"owner": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "edited": false, "score": 0, "creation_date": 1513770475, "post_id": 47905346, "comment_id": 82777339, "body": "In the <b>RideLaterRequest</b> model ?"}, {"owner": {"reputation": 346, "user_id": 9030790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4037273fba75800aa1dd6e249a9d9817?s=128&d=identicon&r=PG&f=1", "display_name": "lg86", "link": "https://stackoverflow.com/users/9030790/lg86"}, "reply_to_user": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "edited": false, "score": 0, "creation_date": 1513770559, "post_id": 47905346, "comment_id": 82777395, "body": "Yes, @user3576036 as you are entering data in these model from view"}], "tags": [], "owner": {"reputation": 346, "user_id": 9030790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4037273fba75800aa1dd6e249a9d9817?s=128&d=identicon&r=PG&f=1", "display_name": "lg86", "link": "https://stackoverflow.com/users/9030790/lg86"}, "is_accepted": true, "score": 2, "last_activity_date": 1513772264, "last_edit_date": 1513772264, "creation_date": 1513770387, "answer_id": 47905346, "question_id": 47905171, "link": "https://stackoverflow.com/questions/47905171/how-to-update-three-similar-fields-on-different-tables-with-same-data/47905346#47905346", "title": "How to update three similar fields on different tables with same data?", "body": "<p>You can use after_save callback to save Commuter data like these in RideLaterRequest model</p>\n\n<pre><code>    after_save { |ride_later_request_data|\n      Commuter.create(\n        phone_number: ride_later_request_data.phone_number,\n        first_name: ride_later_request_data.customer_name,\n        email: ride_later_request_data.email\n      )\n   }\n</code></pre>\n\n<p>Or you can crate a method like these</p>\n\n<pre><code>    after_save :save_commuter_data\n\n    private\n\n    def save_commuter_data\n      Commuter.create( \n        phone_number: self.phone_number, \n        first_name: self.customer_name, \n        email: self.email \n      )\n   end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 311, "user_id": 3948506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d528c41d82cb9c9d263f554a61d7fa7?s=128&d=identicon&r=PG&f=1", "display_name": "Kshitij", "link": "https://stackoverflow.com/users/3948506/kshitij"}, "is_accepted": false, "score": 1, "last_activity_date": 1513772023, "creation_date": 1513772023, "answer_id": 47905845, "question_id": 47905171, "link": "https://stackoverflow.com/questions/47905171/how-to-update-three-similar-fields-on-different-tables-with-same-data/47905845#47905845", "title": "How to update three similar fields on different tables with same data?", "body": "<p>You can use <a href=\"http://guides.rubyonrails.org/active_record_callbacks.html\" rel=\"nofollow noreferrer\">Active Record Callbacks</a> like <code>after_save</code>/ <code>after_create</code>.</p>\n\n<p>In model RideLaterRequest,</p>\n\n<p><code>after_save :copy_data_to_commuter</code></p>\n\n<p><code>private</code></p>\n\n<p><code>def copy_data_to_commuter\n  Commuter.create( phone_number: self.phone_number, first_name: self.customer_name, email: self.email )\nend</code></p>\n\n<p>Here <code>self.phone_number</code> gives the value from the object of <code>RideLaterRequest</code> class which is being saved. You can also use <code>phone_number</code> directly instead of <code>self.phone_number</code>   </p>\n"}], "owner": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 47905346, "answer_count": 2, "score": 0, "last_activity_date": 1513772264, "creation_date": 1513769857, "last_edit_date": 1513769991, "question_id": 47905171, "link": "https://stackoverflow.com/questions/47905171/how-to-update-three-similar-fields-on-different-tables-with-same-data", "title": "How to update three similar fields on different tables with same data?", "body": "<p>I have two models <strong>Commuter</strong> and <strong>RideLaterRequest</strong></p>\n\n<p><strong>RideLaterRequest</strong> table looks as follows.</p>\n\n<pre><code>create_table \"ride_later_requests\", force: :cascade do |t|\n   t.string   \"customer_name\"\n   t.string   \"phone_number\"\n   t.string   \"email\"\nend\n</code></pre>\n\n<p>These columns are getting created from a view file where user enters these details and get created by a controller action.</p>\n\n<pre><code>def complete_booking_request\n   #create a record of name, phone_number,email on RideLaterRequest\nend\n</code></pre>\n\n<p><strong>view</strong></p>\n\n<pre><code>&lt;%= bootstrap_form_for @ride_later_request ,url: bookings_complete_booking_request_path, id: \"get_otp_form\", method: :post, remote:true do |f| %&gt;\n\n      &lt;%= f.text_field :customer_name, hide_label:true, placeholder: 'Name', class:'form-control'%&gt;\n      &lt;%= f.email_field :email,hide_label:true, placeholder: 'Email', class:'form-control' %&gt;\n      &lt;%= f.telephone_field :phone_number, hide_label:true, placeholder: 'Mobile', class:'form-control'%&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>Now I have another model <strong>Commuter</strong> with similar fields.</p>\n\n<pre><code> create_table \"commuters\", force: :cascade do |t|\n         t.string   \"phone_number\"\n         t.string   \"first_name\"\n         t.string   \"email\"\n  end\n</code></pre>\n\n<p>Currently there is no option to create a commuter data from template. The fields in both the tables are supposed to carry same data. Seems like earlier developer just generated the table and went off.  How can I can update the phone,email, name from the <strong>RideLaterRequest</strong> to <strong>Commuter</strong> table at the time of creation itself? </p>\n"}, {"tags": ["ruby", "xml"], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 1, "creation_date": 1513847498, "post_id": 47909096, "comment_id": 82810499, "body": "Hey thanks a lot. All  of what you said is right and helped me lot. In the second example it has to be node.text instead of node.string since ox::Element only has a #text method. Concerning the &quot;docs&quot; of Ox. For a newbie like me who is learning ruby and rails for two months now with no prior background in computer Science it is very hard to read the Ox documentation. For Instance how did you come up with the mode: :hash argument. i studied the load method all day yesterday before posting here and it said:  :mode (:object|:generic|:limited) \u2014 format expected"}, {"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 0, "creation_date": 1513847709, "post_id": 47909096, "comment_id": 82810625, "body": "I wonder how did You know that You can use :hash as a mode. Answering that would really help me to not get stuck with reading docs like the Ox one for days and still not having a clue what i can do with it."}, {"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 0, "creation_date": 1513847820, "post_id": 47909096, "comment_id": 82810688, "body": "The next problem i have o solve with the OX gem is to turn the resulting hash back into an xml. Do you have any idea how I could do that?"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 0, "creation_date": 1513967101, "post_id": 47909096, "comment_id": 82861322, "body": "Thanks for the feedback, glad I could help :) I&#39;m away for Christmas for a bit now - I seem to recall seeing the docs referencing accepting the &#39;:[]&#39; method, which led me to believe it would work as a hash. For your second problem, I&#39;d suggest creating another question (if you haven&#39;t already), but it might be worth looking at the Savin gem, which is a diamond when it comes to working with XML!"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 1, "last_activity_date": 1513966809, "last_edit_date": 1513966809, "creation_date": 1513782686, "answer_id": 47909096, "question_id": 47904666, "link": "https://stackoverflow.com/questions/47904666/create-a-ruby-hash-out-of-an-xml-string-with-the-ox-gem/47909096#47909096", "title": "Create a Ruby Hash out of an xml string with the &#39;ox&#39; gem", "body": "<p>The docs suggest you can use the following:</p>\n\n<pre><code>require 'ox'\n\nxml = %{\n&lt;top name=\"sample\"&gt;\n  &lt;middle name=\"second\"&gt;\n    &lt;bottom name=\"third\"&gt;Rock bottom&lt;/bottom&gt;\n  &lt;/middle&gt;\n&lt;/top&gt;\n}\n\nputs Ox.load(xml, mode: :hash)\nputs Ox.load(xml, mode: :hash_no_attrs)\n\n#{:top=&gt;[{:name=&gt;\"sample\"}, {:middle=&gt;[{:name=&gt;\"second\"}, {:bottom=&gt;[{:name=&gt;\"third\"}, \"Rock bottom\"]}]}]}\n#{:top=&gt;{:middle=&gt;{:bottom=&gt;\"Rock bottom\"}}}\n</code></pre>\n\n<p>I'm not sure that's exactly what you're looking for though.</p>\n\n<p>Otherwise, it really depends on the methods available on the <code>Ox::Element</code> instances in the array. </p>\n\n<p>From <a href=\"http://www.rubydoc.info/github/ohler55/ox/Ox/Element\" rel=\"nofollow noreferrer\">the docs</a>, it looks like there are two handy methods here: you can use <code>[]</code> and <code>text</code>.</p>\n\n<p>Therefore, I'd use <a href=\"https://apidock.com/ruby/Enumerable/reduce\" rel=\"nofollow noreferrer\">reduce</a> to coerce the array into the hash format you're looking for, using something like the following:</p>\n\n<pre><code>ox_nodes = [#&lt;Ox::Element:0x00007f80d985a668 @value=\"payee\", @attributes={}, @nodes=[\"starbucks\"]&gt;, #&lt;Ox::Element:0x00007f80d9839198 @value=\"amount\", @attributes={}, @nodes=[\"5.75\"]&gt;, #&lt;Ox::Element:0x00007f80d9028788 @value=\"date\", @attributes={}, @nodes=[\"2017-06-10\"]&gt;]\n\nox_nodes.reduce({}) do |hash, node|\n  hash[node['@value']] = node.text\n  hash\nend\n</code></pre>\n\n<p>I'm not sure whether <code>node['@value']</code> will work, so you might need to experiment with that - otherwise perhaps <code>node.instance_variable_get('@value')</code> would do it.</p>\n\n<p><a href=\"http://www.rubydoc.info/github/ohler55/ox/Ox/Element#text-instance_method\" rel=\"nofollow noreferrer\">node.text</a> does the following, which sounds about right:</p>\n\n<blockquote>\n  <p>Returns the first String in the elements nodes array or nil if there is no String node.</p>\n</blockquote>\n\n<p>N.B. I prefer to tidy the <code>reduce</code> block a little using <code>tap</code>, something like the following:</p>\n\n<pre><code>ox_nodes.reduce({}) do |hash, node|\n  hash.tap { |h| h[node['@value']] = node.text } \nend\n</code></pre>\n\n<p>Hope that helps - let me know how you get on!</p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1513850622, "creation_date": 1513850622, "answer_id": 47922438, "question_id": 47904666, "link": "https://stackoverflow.com/questions/47904666/create-a-ruby-hash-out-of-an-xml-string-with-the-ox-gem/47922438#47922438", "title": "Create a Ruby Hash out of an xml string with the &#39;ox&#39; gem", "body": "<p>I found the answer to the question in my last comment by myself:</p>\n\n<pre><code>def create_xml(expense)\n    Ox.default_options=({:with_xml =&gt; false})\n    doc = Ox::Document.new(:version =&gt; '1.0')\n    expense.each do |key, value|\n        e = Ox::Element.new(key)\n        e &lt;&lt; value\n        doc &lt;&lt; e\n    end\n    Ox.dump(doc)\nend\n</code></pre>\n\n<p>The next question would be how can i transform the value of the amount key from a string to an integer befopre saving it to the database </p>\n"}], "owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 1, "accepted_answer_id": 47909096, "answer_count": 2, "score": 1, "last_activity_date": 1544120849, "creation_date": 1513768237, "question_id": 47904666, "link": "https://stackoverflow.com/questions/47904666/create-a-ruby-hash-out-of-an-xml-string-with-the-ox-gem", "title": "Create a Ruby Hash out of an xml string with the &#39;ox&#39; gem", "body": "<p>I am currently trying to create a hash out of an xml documen, with the help of the ox gem</p>\n\n<p>Input xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;expense&gt;\n  &lt;payee&gt;starbucks&lt;/payee&gt;\n  &lt;amount&gt;5.75&lt;/amount&gt;\n  &lt;date&gt;2017-06-10&lt;/date&gt;\n&lt;/expense&gt; \n</code></pre>\n\n<p>with the following ruby/ox code:</p>\n\n<pre><code>doc = Ox.parse(xml)\nplist = doc.root.nodes\n</code></pre>\n\n<p>I get the following output:</p>\n\n<pre><code>=&gt; [#&lt;Ox::Element:0x00007f80d985a668 @value=\"payee\", @attributes={}, @nodes=[\"starbucks\"]&gt;, #&lt;Ox::Element:0x00007f80d9839198 @value=\"amount\", @attributes={}, @nodes=[\"5.75\"]&gt;, #&lt;Ox::Element:0x00007f80d9028788 @value=\"date\", @attributes={}, @nodes=[\"2017-06-10\"]&gt;]\n</code></pre>\n\n<p>The output I want is a hash in the format:</p>\n\n<pre><code>{'payee'  =&gt; 'Starbucks',\n'amount' =&gt; 5.75,\n'date'   =&gt; '2017-06-10'}\n</code></pre>\n\n<p>to save in my sqllite database. <br>How can I transform the objects array into a hash like above. \n<br>Any help is highly appreciated.</p>\n"}, {"tags": ["javascript", "css", "ruby-on-rails", "ruby", "sirtrevor"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1513767371, "post_id": 47903562, "comment_id": 82775447, "body": "Try getting the resource using the <code>asset_path</code> helper <code>&lt;%= asset_path &#39;sir-trevor-icons&#39; %&gt;</code>"}, {"owner": {"reputation": 385, "user_id": 884846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1c4efb669f358a87a29baf621aca8b22?s=128&d=identicon&r=PG", "display_name": "Anthony Wood", "link": "https://stackoverflow.com/users/884846/anthony-wood"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1513784355, "post_id": 47903562, "comment_id": 82786597, "body": "Thanks, I think this is one part of the problem. Still not working though"}], "answers": [{"comments": [{"owner": {"reputation": 385, "user_id": 884846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1c4efb669f358a87a29baf621aca8b22?s=128&d=identicon&r=PG", "display_name": "Anthony Wood", "link": "https://stackoverflow.com/users/884846/anthony-wood"}, "edited": false, "score": 0, "creation_date": 1513779479, "post_id": 47904427, "comment_id": 82783240, "body": "Ok, So now I am able to view the icons if I use the following code &lt;svg class=&quot;icon gr-menu&quot;&gt;           &lt;use xlink:href=&quot;&lt;%= asset_path(&#39;sir-trevor-icons&#39;) %&gt;#quote&quot;&gt;&lt;/use&gt;         &lt;/svg&gt;. I assume this means that my Pre-compilation is working as expected, but the sir-trevor text area is still not working as desired"}, {"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "reply_to_user": {"reputation": 385, "user_id": 884846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1c4efb669f358a87a29baf621aca8b22?s=128&d=identicon&r=PG", "display_name": "Anthony Wood", "link": "https://stackoverflow.com/users/884846/anthony-wood"}, "edited": false, "score": 0, "creation_date": 1513786111, "post_id": 47904427, "comment_id": 82787772, "body": "What do you mean with &quot;sir-trevor text area is still not working as desired&quot;? What do you expect and what does it happen instead?"}, {"owner": {"reputation": 385, "user_id": 884846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1c4efb669f358a87a29baf621aca8b22?s=128&d=identicon&r=PG", "display_name": "Anthony Wood", "link": "https://stackoverflow.com/users/884846/anthony-wood"}, "edited": false, "score": 0, "creation_date": 1513786938, "post_id": 47904427, "comment_id": 82788242, "body": "I expect the output in the example linked in the OP. But I get functionally working, without correct styles (visually almost like plain text) applied. Each Block Type just has text links that you can click and the block will be added. It is not using the icons provided in the SVG. That said the CSS is loading ( I see styles applied in the DOM inspector) but the SVG elements in the linked example above are not being generated"}, {"owner": {"reputation": 385, "user_id": 884846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1c4efb669f358a87a29baf621aca8b22?s=128&d=identicon&r=PG", "display_name": "Anthony Wood", "link": "https://stackoverflow.com/users/884846/anthony-wood"}, "edited": false, "score": 0, "creation_date": 1513787457, "post_id": 47904427, "comment_id": 82788534, "body": "I&#39;m wondering now if there is a clash between some of my gems, or maybe some sort of version issue..."}, {"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "reply_to_user": {"reputation": 385, "user_id": 884846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1c4efb669f358a87a29baf621aca8b22?s=128&d=identicon&r=PG", "display_name": "Anthony Wood", "link": "https://stackoverflow.com/users/884846/anthony-wood"}, "edited": false, "score": 0, "creation_date": 1513798084, "post_id": 47904427, "comment_id": 82793872, "body": "If you check the Network tab on your browser Developer Tools you should see a 404 related to Sir Trevor SVG not found. That&#39;s a good start."}, {"owner": {"reputation": 385, "user_id": 884846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1c4efb669f358a87a29baf621aca8b22?s=128&d=identicon&r=PG", "display_name": "Anthony Wood", "link": "https://stackoverflow.com/users/884846/anthony-wood"}, "edited": false, "score": 0, "creation_date": 1513818816, "post_id": 47904427, "comment_id": 82801153, "body": "I have tried in two scenarios 1. With purely the code for Sir trevor. The SVG does not appear in the Networks Tab AND 2. With an additional SVG element on the page (same code as comment #1 above). Response Status Code is 200 OK and Content Type image/svg+xml. Response and Preview are both empty"}, {"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "reply_to_user": {"reputation": 385, "user_id": 884846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1c4efb669f358a87a29baf621aca8b22?s=128&d=identicon&r=PG", "display_name": "Anthony Wood", "link": "https://stackoverflow.com/users/884846/anthony-wood"}, "edited": false, "score": 0, "creation_date": 1513863422, "post_id": 47904427, "comment_id": 82820064, "body": "No clue. Anyway, this was my Sir Trevor initializer file: <a href=\"https://gist.github.com/mdesantis/2c737cbd738c9acf3828618b3f3b4304\" rel=\"nofollow noreferrer\">gist.github.com/mdesantis/2c737cbd738c9acf3828618b3f3b4304</a> You could check if it helps"}, {"owner": {"reputation": 385, "user_id": 884846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1c4efb669f358a87a29baf621aca8b22?s=128&d=identicon&r=PG", "display_name": "Anthony Wood", "link": "https://stackoverflow.com/users/884846/anthony-wood"}, "edited": false, "score": 0, "creation_date": 1513919303, "post_id": 47904427, "comment_id": 82841536, "body": "Still no luck... I&#39;ve tried to take my mind out of the problem for a while and get stuck back in there later..."}], "tags": [], "owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "is_accepted": false, "score": 1, "last_activity_date": 1513768138, "last_edit_date": 1513768138, "creation_date": 1513767395, "answer_id": 47904427, "question_id": 47903562, "link": "https://stackoverflow.com/questions/47903562/styling-for-sir-trevor-css-not-displaying-correctly-ruby-on-rails-app/47904427#47904427", "title": "Styling for Sir Trevor CSS not displaying correctly Ruby On Rails App", "body": "<p>You need to add Sir Trevor assets to Rails assets. Inside <code>config/initializers/assets.rb</code>:</p>\n\n<pre><code>Rails.application.config.assets.precompile += %w(\n  sir-trevor/build/sir-trevor-icons.svg\n)\n</code></pre>\n\n<p>The path could vary depending on Sir Trevor installation method, I installed it with <code>yarn</code> without using the gem at all. Anyway just locate the right path on your installation.</p>\n"}], "owner": {"reputation": 385, "user_id": 884846, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1c4efb669f358a87a29baf621aca8b22?s=128&d=identicon&r=PG", "display_name": "Anthony Wood", "link": "https://stackoverflow.com/users/884846/anthony-wood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513784495, "creation_date": 1513764788, "last_edit_date": 1513784495, "question_id": 47903562, "link": "https://stackoverflow.com/questions/47903562/styling-for-sir-trevor-css-not-displaying-correctly-ruby-on-rails-app", "title": "Styling for Sir Trevor CSS not displaying correctly Ruby On Rails App", "body": "<p>I'm trying to implement an online text editor that allows people to create and write blogs. I saw that SirTrevor has a really slick UI and I'm really keen on using it.</p>\n\n<p>I've managed to get it working technically based <a href=\"https://github.com/madebymany/sir-trevor-rails\" rel=\"nofollow noreferrer\">on these instructions</a>, but the UI is simply not there; Everything is simply in text, no icons or anything. I'm looking to get something similar to the <a href=\"http://madebymany.github.io/sir-trevor-js/example.html\" rel=\"nofollow noreferrer\">example</a> listed on their website. I've installed the Ruby on Rails Gem, and used Bower Install to get the files I need in my Vendor/Assets folder. Both the CSS and JS files appear to be loading (I can see their rules).</p>\n\n<p>When I compare the source code of the provided example with mine, I do not have any SVG elements, and I'm wondering if there is something extra I need to do here</p>\n\n<p>My code is as follows:</p>\n\n<p><strong>blogs.coffee:</strong></p>\n\n<pre><code>SirTrevor.setDefaults({\n    iconUrl: '/assets/images/sir-trevor-icons.svg'\n})\neditor = new SirTrevor.Editor({\n    el: $('.sir-trevor-area'),\n    defaultType: 'Text'\n});\n</code></pre>\n\n<p>The documentation advises us to use <code>document.querySelector(\"...\")</code> instead of jQuery, but that renders even worse results - just a plain text area</p>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code>&lt;%= form.text_area :main_body, {:class=&gt;\"sir-trevor-area\"}%&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "enums", "simple-form"], "comments": [{"owner": {"reputation": 3299, "user_id": 1749638, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cERvr.jpg?s=128&g=1", "display_name": "coderhs", "link": "https://stackoverflow.com/users/1749638/coderhs"}, "edited": false, "score": 1, "creation_date": 1513763957, "post_id": 47903135, "comment_id": 82773180, "body": "Can you try. <code>collection: Song.categories.keys</code>?"}, {"owner": {"reputation": 2821, "user_id": 734861, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/898cac257f853f8bf0a1a84a67d88c40?s=128&d=identicon&r=PG", "display_name": "kofhearts", "link": "https://stackoverflow.com/users/734861/kofhearts"}, "reply_to_user": {"reputation": 3299, "user_id": 1749638, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cERvr.jpg?s=128&g=1", "display_name": "coderhs", "link": "https://stackoverflow.com/users/1749638/coderhs"}, "edited": false, "score": 0, "creation_date": 1513764103, "post_id": 47903135, "comment_id": 82773273, "body": "thanks that did it. put it in answer and i will accept it."}], "answers": [{"tags": [], "owner": {"reputation": 3299, "user_id": 1749638, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cERvr.jpg?s=128&g=1", "display_name": "coderhs", "link": "https://stackoverflow.com/users/1749638/coderhs"}, "is_accepted": true, "score": 8, "last_activity_date": 1513764264, "creation_date": 1513764264, "answer_id": 47903396, "question_id": 47903135, "link": "https://stackoverflow.com/questions/47903135/how-do-you-make-enums-work-with-simple-form/47903396#47903396", "title": "how do you make enums work with simple_form?", "body": "<p>You need to pass the keys to the collection instead of the enum.</p>\n\n<p><code>= f.input :category, collection: Song.categories.keys</code></p>\n"}], "owner": {"reputation": 2821, "user_id": 734861, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/898cac257f853f8bf0a1a84a67d88c40?s=128&d=identicon&r=PG", "display_name": "kofhearts", "link": "https://stackoverflow.com/users/734861/kofhearts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 0, "accepted_answer_id": 47903396, "answer_count": 1, "score": 2, "last_activity_date": 1513764264, "creation_date": 1513763519, "question_id": 47903135, "link": "https://stackoverflow.com/questions/47903135/how-do-you-make-enums-work-with-simple-form", "title": "how do you make enums work with simple_form?", "body": "<p>Please consider the following model</p>\n\n<pre><code>  class Song &lt; ActiveRecord::Base\n\n      enum category: [:english, :french]\n\n      enum file_type: [:mp3, :video]\n\n      enum mood: [:sad, :happy]\n    end\n</code></pre>\n\n<p>I have a form</p>\n\n<pre><code>= simple_form_for(@song) do |f|\n\n  = f.input :name\n  = f.input :category, collection: Song.categories\n  = f.input :file_type, collection: Song.file_types\n  = f.input :mood, collection: Song.moods\n</code></pre>\n\n<p>Here is the problem is when i edit the form then the selected value is nil i.e the select box doesnt select the value that was set instead it selects blank. So i am wondering in the view is there a way to show the saved enum value?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql", "ruby", "parameters", "ruby-on-rails-4.2"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1513763346, "post_id": 47903054, "comment_id": 82772795, "body": "May be it doesn&#39;t work with <code>order</code>."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 4, "last_activity_date": 1513763631, "creation_date": 1513763631, "answer_id": 47903174, "question_id": 47903054, "link": "https://stackoverflow.com/questions/47903054/rails-order-parameterized-query/47903174#47903174", "title": "rails order parameterized query", "body": "<p><code>order</code> doesn't sanitize attributes when they are provided in a list like <code>where</code> does.</p>\n\n<p>But is accepts as hash like this:</p>\n\n<pre><code>order(sort_column =&gt; sort_direction)\n</code></pre>\n\n<p>See the <a href=\"http://guides.rubyonrails.org/active_record_querying.html#ordering\" rel=\"nofollow noreferrer\">Rails Guides About Ordering</a>.</p>\n"}], "owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513767990, "creation_date": 1513763216, "last_edit_date": 1513767990, "question_id": 47903054, "link": "https://stackoverflow.com/questions/47903054/rails-order-parameterized-query", "title": "rails order parameterized query", "body": "<p>I know that order is not safe, so I want to refactor this code:</p>\n\n<pre><code>@tasks = @search.result.joins(user_application_status: {student_application: [student_profile: :student]})\n                       .order(sort_column + ' ' + sort_direction).page(params[:page])\n</code></pre>\n\n<p><code>sort_column</code> is reading from params directly and would be something like <code>user_application_tasks.name</code> and <code>sort_direction</code> would return somethig like <code>asc</code>, I tried refactoring it to:</p>\n\n<pre><code>.order(\"? ?\", sort_column, sort_direction).page(page_params)\n</code></pre>\n\n<p>but I am getting an error</p>\n\n<pre><code>ActiveRecord::StatementInvalid - PG::SyntaxError: ERROR:  syntax error at or near \",\"\nLINE 1: ...HERE (application_statuses.id = 137)  ORDER BY ? ?, user_app...\n</code></pre>\n\n<p>I have done this sort of thing before with where statements like</p>\n\n<pre><code>Thing.where(\"state = ?\" ,params[:state])\n</code></pre>\n\n<p>Is there some special syntax I am omitting? </p>\n\n<p><strong>EDIT:</strong> </p>\n\n<p>The thing I am most worried about is someone being able to inject sql here and do something harmful, as @spickermann mentioned order doesn't sanitize the data so </p>\n\n<pre><code>Thing.order(\"name; drop table users;\")\n</code></pre>\n\n<p>will result in the users table being destroyed.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4.2", "nested-routes"], "answers": [{"tags": [], "owner": {"reputation": 1079, "user_id": 3550170, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Pu9Na.png?s=128&g=1", "display_name": "Snake", "link": "https://stackoverflow.com/users/3550170/snake"}, "is_accepted": false, "score": 0, "last_activity_date": 1513762780, "creation_date": 1513762780, "answer_id": 47902922, "question_id": 47902835, "link": "https://stackoverflow.com/questions/47902835/how-to-have-a-namespace-with-action-in-rails/47902922#47902922", "title": "How to have a namespace with action in rails?", "body": "<p>If you want the router to match the analytics/users path first you need to put the namespace before the resource : </p>\n\n<pre><code>namespace :analytics do\n  resources :users, only: [:show, :index]\nend\nresources :analytics\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 467, "user_id": 6003939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9fP_gxi1pEA/AAAAAAAAAAI/AAAAAAAAAC4/L9NDDYQE22s/photo.jpg?sz=128", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/6003939/vivek-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1513763118, "creation_date": 1513763118, "answer_id": 47903027, "question_id": 47902835, "link": "https://stackoverflow.com/questions/47902835/how-to-have-a-namespace-with-action-in-rails/47903027#47903027", "title": "How to have a namespace with action in rails?", "body": "<p>Please check the routes that are going to generate with</p>\n\n<pre><code>localhost:3000/rails/info/routes\n</code></pre>\n\n<p>Then must be users_controller must be namespace with inside the controller/analytics/users_controller.rb</p>\n\n<pre><code>class Analytics::UsersControllers &lt; ApplicationController\nend\n</code></pre>\n\n<p>And the path for UserController action should be</p>\n\n<pre><code>analytics_users_path &amp; analytics_users_path(user_id)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1513770440, "post_id": 47905055, "comment_id": 82777311, "body": "The route <code>&quot;&#47;users&#47;analytics&quot;</code> is unconventional. Its pretty rare that you display the nested records for an entire collection but if you really want to do it this is how."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1513770307, "last_edit_date": 1513770307, "creation_date": 1513769533, "answer_id": 47905055, "question_id": 47902835, "link": "https://stackoverflow.com/questions/47902835/how-to-have-a-namespace-with-action-in-rails/47905055#47905055", "title": "How to have a namespace with action in rails?", "body": "<p>Routes have priority in the order they are defined. So if you want <code>/analytics/users</code> to be handled by users#index you need to define that route first.</p>\n\n<pre><code>namespace :analytics do\n  get 'users', to: \"users#index\"\nend\n\nresources :analytics\n</code></pre>\n\n<p>You also don't seem to understand how <a href=\"http://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\">nested routes</a> work. Using resources to define nested routes would give <code>analytics/:analytic_id/users</code> as the index. </p>\n\n<pre><code>resources :analytics, only: [] do\n  resources :users, only: [:index]\n end\n</code></pre>\n\n<hr>\n\n<pre><code>        Prefix Verb URI Pattern                             Controller#Action\nanalytic_users GET  /analytics/:analytic_id/users(.:format) users#index\n</code></pre>\n\n<p>But this is not a very restful way to setup the routes in the first place. I would suggest:</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  namespace :users do\n    get :analytics, to: 'analytics#all'\n  end\n\n  resources :users, only: [] do\n    resources :analytics, module: :users, only: [:index]\n  end\nend\n</code></pre>\n\n<p>Which would give the following routes:</p>\n\n<pre><code>         Prefix Verb URI Pattern                         Controller#Action\nusers_analytics GET  /users/analytics(.:format)          users/analytics#all\n user_analytics GET  /users/:user_id/analytics(.:format) users/analytics#index\n</code></pre>\n\n<p>The main difference here is that the routes clearly communicate that the resource being represented is analytics that belong to a user or the collection.</p>\n\n<p>Using the <code>module</code> option sends the \"nested\" routes to <code>Users::AnalyticsController</code> and is a very good way to differentiate between different contexts. </p>\n\n<pre><code>class Users::AnalyticsController\n  # Display all analytics for all users\n  # GET /users/analytics\n  def all\n    @users = User.all\n    @analytics = Analytic.where(user: @users)\n  end\n\n  # Display all analytics for a user\n  # GET /users/:user_id/analytics\n  def index\n    @user = User.includes(:analytics).find(params[:user_id])\n    @analytics = @user.analytics\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 8063484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iUOgW-DTEyQ/AAAAAAAAAAI/AAAAAAAAAe8/7jawThRy18I/photo.jpg?sz=128", "display_name": "coderGuy", "link": "https://stackoverflow.com/users/8063484/coderguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1513770307, "creation_date": 1513762562, "question_id": 47902835, "link": "https://stackoverflow.com/questions/47902835/how-to-have-a-namespace-with-action-in-rails", "title": "How to have a namespace with action in rails?", "body": "<p>Below I have given the code of routes.rb:</p>\n\n<pre><code>  resources :analytics\n\n  namespace :analytics do\n    resources :users, only: [:show, :index]\n  end\n</code></pre>\n\n<p>Here, I am having an analytics_controller.rb inside the controllers folder and one Analytics folder inside the Controllers folder which is containing this users_controller.rb</p>\n\n<p>So whenever I want to go to <a href=\"http://localhost:3005/analytics/users\" rel=\"nofollow noreferrer\">http://localhost:3005/analytics/users</a> to access the users_controller's index, it just sends me to analytics_controller's show action as it take the \"users\" as an :id in the above url.</p>\n\n<p>What should I do? I want to keep both, all the actions of analytics_controller and also the actions of users_controller.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 388, "user_id": 1387799, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b250470a8ae1d4877c15b0254f9b84be?s=128&d=identicon&r=PG", "display_name": "Devin", "link": "https://stackoverflow.com/users/1387799/devin"}, "edited": false, "score": 1, "creation_date": 1513761196, "post_id": 47902363, "comment_id": 82771457, "body": "You can&#39;t parse HTML with Regex. <a href=\"https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags\" title=\"regex match open tags except xhtml self contained tags\">stackoverflow.com/questions/1732348/&hellip;</a>"}, {"owner": {"reputation": 11092, "user_id": 8794221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e2de0a8497383ad1889e87d91adc91?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/8794221/allan"}, "edited": false, "score": 0, "creation_date": 1513761333, "post_id": 47902363, "comment_id": 82771531, "body": "use a DOM parser"}, {"owner": {"reputation": 376, "user_id": 5690546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YQ5PT.jpg?s=128&g=1", "display_name": "karthik selvaraj", "link": "https://stackoverflow.com/users/5690546/karthik-selvaraj"}, "edited": false, "score": 0, "creation_date": 1513763321, "post_id": 47902363, "comment_id": 82772775, "body": "please provide the rule you want to achieve in this searching text"}, {"owner": {"reputation": 401, "user_id": 7156757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8768142e36048bf7d98b346110611ebc?s=128&d=identicon&r=PG&f=1", "display_name": "O.Vykhor", "link": "https://stackoverflow.com/users/7156757/o-vykhor"}, "reply_to_user": {"reputation": 376, "user_id": 5690546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YQ5PT.jpg?s=128&g=1", "display_name": "karthik selvaraj", "link": "https://stackoverflow.com/users/5690546/karthik-selvaraj"}, "edited": false, "score": 0, "creation_date": 1513763570, "post_id": 47902363, "comment_id": 82772939, "body": "@karthikselvaraj I just to want to match text providing in question by regex providing in question, but i don&#39;t know why without g flag regex has match and with g flag not"}, {"owner": {"reputation": 376, "user_id": 5690546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YQ5PT.jpg?s=128&g=1", "display_name": "karthik selvaraj", "link": "https://stackoverflow.com/users/5690546/karthik-selvaraj"}, "edited": false, "score": 0, "creation_date": 1513764120, "post_id": 47902363, "comment_id": 82773290, "body": "@Oleksii - Sorry, what is meant by g flag. I could&#39;t understand"}, {"owner": {"reputation": 401, "user_id": 7156757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8768142e36048bf7d98b346110611ebc?s=128&d=identicon&r=PG&f=1", "display_name": "O.Vykhor", "link": "https://stackoverflow.com/users/7156757/o-vykhor"}, "reply_to_user": {"reputation": 376, "user_id": 5690546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YQ5PT.jpg?s=128&g=1", "display_name": "karthik selvaraj", "link": "https://stackoverflow.com/users/5690546/karthik-selvaraj"}, "edited": false, "score": 0, "creation_date": 1513764227, "post_id": 47902363, "comment_id": 82773362, "body": "@karthikselvaraj - This mean <code>&#47;g</code> global searching, but i don&#39;t understand why not global searching has one match but global searching not."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1513767149, "post_id": 47902363, "comment_id": 82775277, "body": "@Oleksii Ruby regex does not use <code>g</code> flag. You need to use <code>String#scan(Regexp)</code> and make sure to use non-capturing groups, replace all <code>(</code> with <code>(?:</code>."}, {"owner": {"reputation": 401, "user_id": 7156757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8768142e36048bf7d98b346110611ebc?s=128&d=identicon&r=PG&f=1", "display_name": "O.Vykhor", "link": "https://stackoverflow.com/users/7156757/o-vykhor"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1513767586, "post_id": 47902363, "comment_id": 82775577, "body": "@WiktorStribi\u017cew - why i should use non-capturing group? I want to use some value from searching text later."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1513767900, "post_id": 47902363, "comment_id": 82775777, "body": "ok, then just use <code>scan</code>."}, {"owner": {"reputation": 401, "user_id": 7156757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8768142e36048bf7d98b346110611ebc?s=128&d=identicon&r=PG&f=1", "display_name": "O.Vykhor", "link": "https://stackoverflow.com/users/7156757/o-vykhor"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1513769195, "post_id": 47902363, "comment_id": 82776527, "body": "@WiktorStribi\u017cew thanks"}], "owner": {"reputation": 401, "user_id": 7156757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8768142e36048bf7d98b346110611ebc?s=128&d=identicon&r=PG&f=1", "display_name": "O.Vykhor", "link": "https://stackoverflow.com/users/7156757/o-vykhor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "closed_date": 1513769958, "answer_count": 0, "score": 0, "last_activity_date": 1513761047, "creation_date": 1513761047, "question_id": 47902363, "link": "https://stackoverflow.com/questions/47902363/regular-expression-dont-match-with-g-flag", "closed_reason": "Duplicate", "title": "Regular expression don&#39;t match with g flag", "body": "<p>please help me, i don't know what wrong with this regular expression.\n<code>&lt;div&gt;\\s*&lt;strong&gt;\\s*\u0426\u0456\u043d\u0430[\\s[:alpha:]\\,\\.]*:\\s*&lt;\\/strong&gt;\\s*(\\d+[\\s\\d]*.\\d*)\\s*\u0433\u0440\u043d[\\s[:alpha:]\\,\\.]*&lt;\\/div&gt;</code>\nWithout g flag i have 1 match, but with g flag <code>no matches</code>\nBelow part of searching text</p>\n\n<pre><code>&lt;div&gt;&lt;strong&gt;\u0426\u0456\u043d\u0430 \u043f\u0440\u043e\u0434\u0430\u0436\u0443:&lt;/strong&gt; 5 734 600.00 \u0413\u0420\u041d&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "edited": false, "score": 0, "creation_date": 1513856400, "post_id": 47902110, "comment_id": 82815858, "body": "Thanks. This turned out to be helpful."}], "tags": [], "owner": {"reputation": 1660, "user_id": 4051942, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/bCeCe.png?s=128&g=1", "display_name": "Marcelo Ribeiro", "link": "https://stackoverflow.com/users/4051942/marcelo-ribeiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1513760202, "creation_date": 1513760202, "answer_id": 47902110, "question_id": 47901985, "link": "https://stackoverflow.com/questions/47901985/how-to-best-work-with-bulk-data-json-render-in-rails/47902110#47902110", "title": "How to best work with bulk data json render in rails?", "body": "<p>This would work, yes. Ideally, you would create a new record, called EventSeries or something, and have all the logic to create the event instances inside EventSeries.</p>\n\n<p>You would end up with something like </p>\n\n<pre><code>post \"/event_series.json\", params: {start_date: some_date, end_date: some_date}\n</code></pre>\n\n<p>Then, a event_series_controller where:</p>\n\n<pre><code>def create\n  @event_series = EventSeries.new(event_series_params)\n  if @event_series.save\n     render json: @event_series\n  end\nend\n</code></pre>\n\n<p>And then, inside EventSeries class:</p>\n\n<pre><code>has_many :events\n\nbefore_create :prepare_events\n\ndef prepare_events\n  (start_date..end_date).each do |day|\n    ... code to manage events creation ...\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513760202, "creation_date": 1513759712, "question_id": 47901985, "link": "https://stackoverflow.com/questions/47901985/how-to-best-work-with-bulk-data-json-render-in-rails", "title": "How to best work with bulk data json render in rails?", "body": "<p>I have a create method that redirects to host_calendar_path. But what could be the best way so that I could render json response with rv_date instead of single rv_date.</p>\n\n<pre><code>  def create\n    start_date = Date.parse(rv_date_params[:start_date])\n    end_date = Date.parse(rv_date_params[:end_date])\n\n    (start_date..end_date).each do |day|\n      rv_date = RvDate.where(rv_id: rv_date_params[:rv_id], start_date: day)\n      if rv_date.present?\n        rv_date.update_all(price: rv_date_params[:price], status: rv_date_params[:status])\n      else\n        rv_date = RvDate.create(rv_id: rv_date_params[:rv_id], start_date: day, end_date: day, price: rv_date_params[:price], status: rv_date_params[:status])\n      end\n    end\n    redirect_to host_calendar_path(rv_id: rv_date_params[:rv_id])\n\n  end\n</code></pre>\n\n<p>Is storing those to array and sending rv_date as array a good solution?\nEg:</p>\n\n<pre><code> def create\n    start_date = Date.parse(rv_date_params[:start_date])\n    end_date = Date.parse(rv_date_params[:end_date])\n    rv_dates = []\n\n    (start_date..end_date).each do |day|\n      @rv_date = RvDate.where(rv_id: rv_date_params[:rv_id], start_date: day)\n      if @rv_date.present?\n        @rv_date.update_all(price: rv_date_params[:price], status: rv_date_params[:status])\n      else\n        @rv_date = RvDate.create(rv_id: rv_date_params[:rv_id], start_date: day, end_date: day, price: rv_date_params[:price], status: rv_date_params[:status])\n      end\n      rv_dates &lt;&lt; @rv_date\n    end\n    # redirect_to host_calendar_path(rv_id: rv_date_params[:rv_id])\n    render json: rv_dates: rv_dates\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 1, "creation_date": 1513759219, "post_id": 47901734, "comment_id": 82770339, "body": "logs_data[[143184, 11467]]"}, {"owner": {"reputation": 346, "user_id": 9030790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4037273fba75800aa1dd6e249a9d9817?s=128&d=identicon&r=PG&f=1", "display_name": "lg86", "link": "https://stackoverflow.com/users/9030790/lg86"}, "edited": false, "score": 0, "creation_date": 1513759762, "post_id": 47901734, "comment_id": 82770659, "body": "variable name is &#39;logs_data&#39; not &#39;logs&#39; so use &#39;logs_data[[143184, 11467]]&#39;"}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "reply_to_user": {"reputation": 346, "user_id": 9030790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4037273fba75800aa1dd6e249a9d9817?s=128&d=identicon&r=PG&f=1", "display_name": "lg86", "link": "https://stackoverflow.com/users/9030790/lg86"}, "edited": false, "score": 0, "creation_date": 1513759947, "post_id": 47901734, "comment_id": 82770743, "body": "@lg86 Edit, Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1513760003, "post_id": 47901871, "comment_id": 82770779, "body": "Thanks, it works"}], "tags": [], "owner": {"reputation": 43225, "user_id": 297087, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/17b3a5816f0647e9b0f7c49d60f93e7b?s=128&d=identicon&r=PG", "display_name": "Salil", "link": "https://stackoverflow.com/users/297087/salil"}, "is_accepted": true, "score": 0, "last_activity_date": 1513759578, "last_edit_date": 1513759578, "creation_date": 1513759272, "answer_id": 47901871, "question_id": 47901734, "link": "https://stackoverflow.com/questions/47901734/get-value-from-hash-with-two-keys/47901871#47901871", "title": "Get value from hash with two keys", "body": "<pre><code>2.4.2 :027 &gt; logs_data.keys\n =&gt; [[143184, 11467], [143184, 11471]] \n</code></pre>\n\n<p>your key is <code>[143184, 11467]</code> so you have to do <code>hash[key]</code> like following</p>\n\n<pre><code>2.4.2 :028 &gt; logs_data[[143184, 11467]]\n =&gt; {:finished=&gt;true, :created_at=&gt; 2017-11-09 09:38:11 UTC} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1820, "user_id": 5830835, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/29a99125813cee34a6ecfe0d0e432eb1?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy Von Heiss ", "link": "https://stackoverflow.com/users/5830835/timmy-von-heiss"}, "is_accepted": false, "score": 0, "last_activity_date": 1513759274, "creation_date": 1513759274, "answer_id": 47901872, "question_id": 47901734, "link": "https://stackoverflow.com/questions/47901734/get-value-from-hash-with-two-keys/47901872#47901872", "title": "Get value from hash with two keys", "body": "<p>You need two sets of brackets logs_data[[ key ]]</p>\n\n<p>In ruby you can also do logs_data.keys or logs_data.values</p>\n"}], "owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "closed_date": 1513794656, "accepted_answer_id": 47901871, "answer_count": 2, "score": -3, "last_activity_date": 1513759927, "creation_date": 1513758711, "last_edit_date": 1513759927, "question_id": 47901734, "link": "https://stackoverflow.com/questions/47901734/get-value-from-hash-with-two-keys", "closed_reason": "Needs details or clarity", "title": "Get value from hash with two keys", "body": "<p>I have a <code>hash</code> whose keys are an array of two elements like this:</p>\n\n<pre><code>logs_data = \n{\n    [ 143184, 11467 ] =&gt; {\n          :finished =&gt; true,\n        :created_at =&gt; 2017-11-09 09:38:11 UTC\n    },\n    [ 143184, 11471 ] =&gt; {\n          :finished =&gt; true,\n        :created_at =&gt; 2017-12-20 07:21:02 UTC\n    }\n}\n</code></pre>\n\n<p>I don't know how to get the value from a key. I tried this way:</p>\n\n<pre><code>logs_data[143184, 11467]\n#=&gt; ArgumentError: wrong number of arguments (given 2, expected 1)\n</code></pre>\n\n<p>but it failed.</p>\n"}, {"tags": ["arrays", "ruby", "string"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1513757328, "post_id": 47901385, "comment_id": 82769348, "body": "Put them in an array and use <code>ary.compact.join(&#39;, &#39;)</code>. Compact removes the missing items, join glues the rest together with the specified delimiter."}], "answers": [{"comments": [{"owner": {"reputation": 776, "user_id": 3404788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2552fcfb7f6aa5bd565d56c74d0a7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Saadia", "link": "https://stackoverflow.com/users/3404788/saadia"}, "edited": false, "score": 0, "creation_date": 1513758042, "post_id": 47901487, "comment_id": 82769705, "body": "Many thanks, this works if any of the <code>address_</code> is <code>nil</code> but not in case if it is empty, in case of empty i still see extra commas"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 776, "user_id": 3404788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2552fcfb7f6aa5bd565d56c74d0a7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Saadia", "link": "https://stackoverflow.com/users/3404788/saadia"}, "edited": false, "score": 0, "creation_date": 1513758434, "post_id": 47901487, "comment_id": 82769912, "body": "Ok, attached is a revised solution, converts all elements to strings but then strips out all empty strings."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1513758411, "last_edit_date": 1513758411, "creation_date": 1513757627, "answer_id": 47901487, "question_id": 47901385, "link": "https://stackoverflow.com/questions/47901385/combine-multiple-variables-into-a-single-string-and-add-comma/47901487#47901487", "title": "Combine multiple variables into a single string and add comma", "body": "<pre><code>address_1 = '226'\naddress_2 = 'Virginia Ave'\naddress_city = 'Trenton'\naddress_state = 'NJ'\naddress_country = 'US'\naddress_postal_code = '08610'\n\n[\"#{address_1} #{address_2}\", address_city, address_state, address_country, address_postal_code].map{|line| line.to_s.strip}.select{|line| !line.empty?}.join(', ')\n</code></pre>\n\n<p>This puts all the address elements in an array, maps to change all lines to a stripped string, and then selects lines that are not empty, and then joins using a comma and space.</p>\n\n<p>The first element is address_1 and address 2 combined so as to avoid a comma after house number.</p>\n"}, {"comments": [{"owner": {"reputation": 776, "user_id": 3404788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2552fcfb7f6aa5bd565d56c74d0a7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Saadia", "link": "https://stackoverflow.com/users/3404788/saadia"}, "edited": false, "score": 0, "creation_date": 1513758033, "post_id": 47901496, "comment_id": 82769699, "body": "this works if any of the <code>address_</code> is <code>nil</code> but not in case if it is empty, in case of empty i still see extra commas"}], "tags": [], "owner": {"reputation": 499, "user_id": 4829617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5c44A.png?s=128&g=1", "display_name": "Dhurba Baral", "link": "https://stackoverflow.com/users/4829617/dhurba-baral"}, "is_accepted": false, "score": 1, "last_activity_date": 1513758457, "last_edit_date": 1513758457, "creation_date": 1513757656, "answer_id": 47901496, "question_id": 47901385, "link": "https://stackoverflow.com/questions/47901385/combine-multiple-variables-into-a-single-string-and-add-comma/47901496#47901496", "title": "Combine multiple variables into a single string and add comma", "body": "<p>Try this using array compact. This may solve your problem.</p>\n\n<pre><code>address_arr = [address_1, address_2, address_city, address_state, address_country, address_postal_code]\nno_empty_address = address_arr.reject{ |c| c.empty? }\nno_empty_address.compact.join(', ')\n</code></pre>\n"}], "owner": {"reputation": 776, "user_id": 3404788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2552fcfb7f6aa5bd565d56c74d0a7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Saadia", "link": "https://stackoverflow.com/users/3404788/saadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 47901487, "answer_count": 2, "score": 1, "last_activity_date": 1513759079, "creation_date": 1513757171, "last_edit_date": 1513759079, "question_id": 47901385, "link": "https://stackoverflow.com/questions/47901385/combine-multiple-variables-into-a-single-string-and-add-comma", "title": "Combine multiple variables into a single string and add comma", "body": "<p>I have multiple strings:</p>\n\n<pre><code>address_1 = '226'\naddress_2 = 'Virginia Ave'\naddress_city = 'Trenton'\naddress_state = 'NJ'\naddress_country = 'US'\naddress_postal_code = '08610'\n</code></pre>\n\n<p>I am trying to combine them into a single string, separated from one another with comma, as follows:</p>\n\n<pre><code>\"226 Virginia Ave, Trenton, NJ, 08610, US\"\n</code></pre>\n\n<p>How can I combine my variables in a string, separate them using a comma, and in case any of the variable is missing, then do not display the extra comma?</p>\n\n<p>I did this:</p>\n\n<pre><code>(address_1.to_s + ' ' + address_2.to_s + ' ' + address_city.to_s + ' ' + address_state.to_s + ' ' + address_postal_code.to_s + ' '  + address_country.to_s).squish\n</code></pre>\n\n<p>This gives output like this:</p>\n\n<pre><code>\"226 Virginia Ave Trenton NJ 08610 US\"\n</code></pre>\n\n<p>This happens because I am adding space <code>+ ' ' +</code>. If I do <code>+ ', ' +</code>, in case any of the <code>address_</code> is <code>nil</code> or empty, it still displays the extra <code>,</code>, and the address ends up looking like this:</p>\n\n<pre><code>\"226 Virginia Ave, , , 08610, US\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "factory-bot"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1513753571, "post_id": 47900385, "comment_id": 82767444, "body": "<code>Factory.create</code> or <code>FactoryBot.create</code>?"}, {"owner": {"reputation": 13, "user_id": 8217653, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fbfdd3ecda9614365f88ab867b4f86ef?s=128&d=identicon&r=PG", "display_name": "user8217653", "link": "https://stackoverflow.com/users/8217653/user8217653"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1513753744, "post_id": 47900385, "comment_id": 82767539, "body": "@JagdeepSingh fixed"}], "answers": [{"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1513753769, "creation_date": 1513753769, "answer_id": 47900552, "question_id": 47900385, "link": "https://stackoverflow.com/questions/47900385/creating-multiple-different-factories-using-the-same-create-method/47900552#47900552", "title": "Creating multiple different factories using the same create method", "body": "<p>I believe you want to create objects using different factories here i.e. when you say <code>Factory.create</code>, you mean <code>FactoryBot.create</code>.</p>\n\n<p>Unfortunately, i couldn't find any direct command to accomplish such thing. Here is something using a <code>Hash</code> and a loop.</p>\n\n<pre><code>factories_and_traits = { factory_1: [trait_1_factory_1, trait_2_factory_1],\n                         factory_2: [trait_1_factory_2] }\n\nfactories_and_traits.each do |factory, traits|\n  FactoryBot.create(factory, *traits)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8217653, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fbfdd3ecda9614365f88ab867b4f86ef?s=128&d=identicon&r=PG", "display_name": "user8217653", "link": "https://stackoverflow.com/users/8217653/user8217653"}, "edited": false, "score": 0, "creation_date": 1513755158, "post_id": 47900687, "comment_id": 82768240, "body": "why the * in *factory"}, {"owner": {"reputation": 367, "user_id": 7852372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ukz2Q.jpg?s=128&g=1", "display_name": "rhunal", "link": "https://stackoverflow.com/users/7852372/rhunal"}, "reply_to_user": {"reputation": 13, "user_id": 8217653, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fbfdd3ecda9614365f88ab867b4f86ef?s=128&d=identicon&r=PG", "display_name": "user8217653", "link": "https://stackoverflow.com/users/8217653/user8217653"}, "edited": false, "score": 0, "creation_date": 1513796286, "post_id": 47900687, "comment_id": 82792993, "body": "<code>*</code> is to retrieve the elements from an array. As we need only elements to be passed to the <code>FactoryBot.create()</code> than <code>array</code>"}], "tags": [], "owner": {"reputation": 367, "user_id": 7852372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ukz2Q.jpg?s=128&g=1", "display_name": "rhunal", "link": "https://stackoverflow.com/users/7852372/rhunal"}, "is_accepted": true, "score": 0, "last_activity_date": 1513754289, "creation_date": 1513754289, "answer_id": 47900687, "question_id": 47900385, "link": "https://stackoverflow.com/questions/47900385/creating-multiple-different-factories-using-the-same-create-method/47900687#47900687", "title": "Creating multiple different factories using the same create method", "body": "<p>No, it is not possbile to create factory_1 and factory_2 from the same command.</p>\n\n<p>Here, 'factory1' is the <code>Model</code> or <code>class</code> whose objects are created.</p>\n\n<p><code>FactoryBot.create(:factory1)</code></p>\n\n<p>If you are doing it for making spec DRY, then rather than doing as above, you can do as below :</p>\n\n<pre><code>[\n  [:factory_1, traits_1_factory_1],\n  [:factory_2, traits_1_factory2]\n].each do |factory|\n  FactoryBot.create(*factory)\nend\n</code></pre>\n\n<p>Store multiple <code>factories</code> in <code>array</code> and iterate it.</p>\n"}], "owner": {"reputation": 13, "user_id": 8217653, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fbfdd3ecda9614365f88ab867b4f86ef?s=128&d=identicon&r=PG", "display_name": "user8217653", "link": "https://stackoverflow.com/users/8217653/user8217653"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 47900687, "answer_count": 2, "score": 0, "last_activity_date": 1513754289, "creation_date": 1513753060, "last_edit_date": 1513753724, "question_id": 47900385, "link": "https://stackoverflow.com/questions/47900385/creating-multiple-different-factories-using-the-same-create-method", "title": "Creating multiple different factories using the same create method", "body": "<p>So I have different factories: factory_1, factory_2\nThey have different traits trait_1_factory_1, trait_2_factory_1 etc</p>\n\n<p>Is possbile to create factory_1 and factory_2 with specific trairs from the same command, like:</p>\n\n<blockquote>\n  <p>FactoryBot.create(\n  :factory_1, traits_1_factory_1,\n  :factory_2,\n  :factory_2, traits_1_factory2\n  )</p>\n</blockquote>\n\n<p>I tried different combinations of () {} [] but doesn't seem to work for me? Is this possbile?\nIs this the only solution\nFactory.create(:factory_1, traits_1_factory_1)\nFactory.create etc.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1513750479, "post_id": 47899734, "comment_id": 82766143, "body": "what is <code>add each j in array</code> ? Is this actual statement?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1513754130, "post_id": 47899734, "comment_id": 82767730, "body": "No, I won&#39;t. ....."}, {"owner": {"reputation": 1, "user_id": 9121212, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155703767670236/picture?type=large", "display_name": "Eric", "link": "https://stackoverflow.com/users/9121212/eric"}, "edited": false, "score": 0, "creation_date": 1513794749, "post_id": 47899734, "comment_id": 82792286, "body": "I was trying to add up the values that will be shoveled to array store = [] because that will give me the answer. I am just curious how to go about printing out the sum of what is in store = []. Thank you for your help. Please keep going lol if possible"}, {"owner": {"reputation": 1, "user_id": 9121212, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155703767670236/picture?type=large", "display_name": "Eric", "link": "https://stackoverflow.com/users/9121212/eric"}, "edited": false, "score": 0, "creation_date": 1513795045, "post_id": 47899734, "comment_id": 82792432, "body": "in addition, the first end goes with def, the second goes with while loop and the third goes with what?"}], "answers": [{"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1513750664, "creation_date": 1513750664, "answer_id": 47899853, "question_id": 47899734, "link": "https://stackoverflow.com/questions/47899734/how-can-i-make-this-code-work-error-message-being-received/47899853#47899853", "title": "how can I make this code work-error message being received", "body": "<p>Reason for this error</p>\n\n<pre><code>syntax error, unexpected tIDENTIFIER, expecting keyword_do or '{' or '(' add each j in array ^ (repl):32: syntax error, unexpected keyword_end, expecting end-of-input\n</code></pre>\n\n<p>is because you are missing <code>do</code> after <code>store.each</code></p>\n\n<pre><code>def factorial(n)\n  a = 1\n  store = []\n  result = n - a\n\n  while a &lt;= (n-1) \n    j = n * result\n    store &lt;&lt; j\n    a += 1\n    store.each do |j|\n      # Not sure what are you trying to do here\n      add each j in array\n    end\n  end\nend\n</code></pre>\n\n<p>Also you were missing an <code>end</code> at the end.</p>\n\n<p>NOTE: This code will not give the expected output still. Fix your logic first.</p>\n"}], "owner": {"reputation": 1, "user_id": 9121212, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155703767670236/picture?type=large", "display_name": "Eric", "link": "https://stackoverflow.com/users/9121212/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1513752271, "creation_date": 1513750049, "last_edit_date": 1513752271, "question_id": 47899734, "link": "https://stackoverflow.com/questions/47899734/how-can-i-make-this-code-work-error-message-being-received", "title": "how can I make this code work-error message being received", "body": "<p>Write a method that takes an integer <code>n</code> in; it should return\n<code>n*(n-1)*(n-2)*...*2*1</code>. Assume <code>n &gt;= 0</code>.\nAs a special case, <code>factorial(0) == 1</code>.\nDifficulty: easy.</p>\n\n<pre><code>def factorial(n)\n  a = 1\n  store = []\n  result = n - a\n\n  while a &lt;= (n-1) \n    j = n * result\n    store &lt;&lt; j\n    a += 1\n    store.each |j|\n      add each j in array\n    end\n  end\n</code></pre>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]\n      (repl):17: syntax error, unexpected tIDENTIFIER, expecting keyword_do or '{' or '('\n      add each j in array\n              ^ (repl):32: syntax error, unexpected keyword_end, expecting end-of-input</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch", "elasticsearch-rails"], "answers": [{"comments": [{"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1513746353, "post_id": 47899056, "comment_id": 82764817, "body": "Just tried this and no luck. The weird thing is that I have this code working on a different project. All I did was copy/paste it over to a new project and change the field names and it doesn&#39;t work."}, {"owner": {"reputation": 1660, "user_id": 4051942, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/bCeCe.png?s=128&g=1", "display_name": "Marcelo Ribeiro", "link": "https://stackoverflow.com/users/4051942/marcelo-ribeiro"}, "reply_to_user": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1513747150, "post_id": 47899056, "comment_id": 82765024, "body": "I added my working sample, maybe it will help. Again, no settings for the index/schema."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1513747447, "post_id": 47899056, "comment_id": 82765121, "body": "Completely uninstalled/reinstalled ES, removed the settings for the index, restarted Rails and ES servers, changed query to your code example and still getting 0 results. The curl works fine still. All of this should be working."}], "tags": [], "owner": {"reputation": 1660, "user_id": 4051942, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/bCeCe.png?s=128&g=1", "display_name": "Marcelo Ribeiro", "link": "https://stackoverflow.com/users/4051942/marcelo-ribeiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1513747084, "last_edit_date": 1513747084, "creation_date": 1513745998, "answer_id": 47899056, "question_id": 47898943, "link": "https://stackoverflow.com/questions/47898943/elasticsearch-rails-multi-match-query-not-working/47899056#47899056", "title": "Elasticsearch-rails Multi Match Query Not Working", "body": "<p>This happened to me once and it had to do with the fact I was trying to declare the index with the wrong data type (keyword in this case). I think you don't need to declare your index like that, since what you need seems pretty standard.</p>\n\n<p>Try removing the entire <code>settings</code> block, then delete your index </p>\n\n<pre><code>Model.__elasticsearch__.delete_index!\n</code></pre>\n\n<p>recreate your index</p>\n\n<pre><code>Model.__elasticsearch__.create_index!\n</code></pre>\n\n<p>index your elements</p>\n\n<pre><code>instance.__elasticsearch__.index_document\n</code></pre>\n\n<p>and search</p>\n\n<p>Here is a sample multisearch that worked for me:</p>\n\n<pre><code>  def as_indexed_json(options={})\n    h = {\n      \"id\" =&gt; id,\n      \"author_name\" =&gt; author_name,\n      \"author_email\" =&gt; author_email,\n      \"content_title\" =&gt; content_title,\n      \"content\" =&gt; content,\n      \"circle_name\" =&gt; circle_name.downcase,\n      \"updated_at\" =&gt; updated_at.to_i\n    }\n  end\n</code></pre>\n\n<p>then search:</p>\n\n<pre><code>  search_params = {\n    query: {\n      multi_match: {\n        query: query.downcase,\n        fields: [\"author_name\", \"author_email\", \"content_title\", \"content\", \"circle_name\"]\n      }\n    },\n    sort: [\n      { updated_at: {order: \"desc\"}},\n      \"_score\"\n    ],\n  }\n\n  Post.__elasticsearch__.search(search_params).results\n</code></pre>\n\n<p>Maybe it will help</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 723, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513747084, "creation_date": 1513745195, "question_id": 47898943, "link": "https://stackoverflow.com/questions/47898943/elasticsearch-rails-multi-match-query-not-working", "title": "Elasticsearch-rails Multi Match Query Not Working", "body": "<p>I'm about sick of ES. Nothing ever works. With that said here is my next issue with ES. </p>\n\n<p>I'm using the elasticsearch-rails gem. </p>\n\n<p>When I run a curl command I can query with a multi_match and get the expected results like this:</p>\n\n<pre><code>curl -XGET 'localhost:9200/_search?pretty' -H 'Content-Type: application/json' -d'\n{\n  \"query\": {\n    \"multi_match\" : {\n      \"query\":    \"NY\", \n      \"fields\": [ \"street\", \"state\" ] \n    }\n  }\n}\n'\n{\n  \"took\" : 6,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"skipped\" : 0,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 2,\n    \"max_score\" : 0.47000363,\n    \"hits\" : [\n      {\n        \"_index\" : \"addresses\",\n        \"_type\" : \"address\",\n        \"_id\" : \"1\",\n        \"_score\" : 0.47000363,\n        \"_source\" : {\n          \"street\" : \"Somewhere Else Rd\",\n          \"city\" : \"Somewhere\",\n           \"state\" : \"NY\",\n          \"zip\" : \"88329\"\n        }\n      },\n      {\n        \"_index\" : \"addresses\",\n        \"_type\" : \"address\",\n        \"_id\" : \"2\",\n        \"_score\" : 0.47000363,\n        \"_source\" : {\n          \"street\" : \"Somewhere Drive\",\n          \"city\" : \"Somewhere\",\n          \"state\" : \"NY\",\n          \"zip\" : \"42293\"\n        }\n      }\n    ]\n  }\n} \n</code></pre>\n\n<p>With the ruby code that does the same thing, I get 0 results. I don't get it. </p>\n\n<p>Address Model:</p>\n\n<pre><code>settings index: { number_of_shards: 1 } do\n  mappings dynamic: 'false' do\n    indexes :street, analyzer: 'keyword'\n    indexes :city, analyzer: 'keyword'\n    indexes :state, analyzer: 'keyword' \n    indexes :zip, analyzer: 'keyword'\n  end\nend\n\ndef as_indexed_json(options={})\n    as_json(\n        only: [:street, :city, :state, :zip]\n    )\n end\n</code></pre>\n\n<p>Controller Action:</p>\n\n<pre><code> def search\n    Address.all.import force: true\n    @addresses = Address.all\n    puts @addresses.size\n\n     @addresses = Address.search(\n           query: { \n             multi_match: {\n                 query: \"NY\",\n                 fields: ['street', 'state']\n             }\n          }\n          )\n          puts @addresses.size\nend\n</code></pre>\n\n<p>The only reason I am reindexing every time I call the search function is for debug purposes only. Here is the console output.</p>\n\n<pre><code>Started GET \"/addresses/search?q=1\" for 75.65.92.24 at 2017-12-20 04:35:02 +0000\nCannot render console from 75.65.92.24! Allowed networks: 127.0.0.1, ::1, \n127.0.0.0/127.255.255.255\nProcessing by AddressesController#search as */*\n  Parameters: {\"q\"=&gt;\"1\"}\n  Address Load (0.2ms)  SELECT  \"addresses\".* FROM \"addresses\" ORDER BY \n\"addresses\".\"id\" ASC LIMIT ?  [[\"LIMIT\", 1000]]\n  CACHE Address Load (0.0ms)  SELECT  \"addresses\".* FROM \"addresses\" ORDER \nBY \"addresses\".\"id\" ASC LIMIT ?  [[\"LIMIT\", 1000]]\n   (0.2ms)  SELECT COUNT(*) FROM \"addresses\"\n3\n0\n  Rendering addresses/search.js.erb\n  Rendered collection of addresses/_address.html.erb [0 times] (0.0ms)\n  Rendered addresses/search.js.erb (4.0ms)\nCompleted 200 OK in 334ms (Views: 8.8ms | ActiveRecord: 1.4ms)\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1513891585, "post_id": 47898887, "comment_id": 82834949, "body": "If my answer was useful, please accept is as the correct answer by clicking the grey checkmark to the left of the answer."}], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1561471890, "post_id": 47899358, "comment_id": 100069733, "body": "This is a great solution, but a few notes: 1. Your class doesn&#39;t have any instance methods or instance variables. Did you mean to make it a module? 2. There&#39;s really no reason to have <code>pairs</code> at all when you can create a Hash directly. 3. Don&#39;t forget about <a href=\"https://ruby-doc.org/core-2.6.3/Numeric.html#method-i-divmod\" rel=\"nofollow noreferrer\"><code>Numeric#divmod</code></a>, which combines integer division and modulo into one. <a href=\"https://repl.it/@jrunning/TragicGrotesqueKernel\" rel=\"nofollow noreferrer\">repl.it/@jrunning/TragicGrotesqueKernel</a>"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1561497034, "post_id": 47899358, "comment_id": 100081359, "body": "@JordanRunning Thanks for the great suggestions. All good points."}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 3, "last_activity_date": 1513747763, "creation_date": 1513747763, "answer_id": 47899358, "question_id": 47898887, "link": "https://stackoverflow.com/questions/47898887/ruby-make-hash-dynamically-by-currency-change/47899358#47899358", "title": "ruby: make hash dynamically by currency change", "body": "<p>Let's do this the Ruby way. We'll avoid for/next/while looping, and instead we'll create a starting Hash and iterate over it to produce a resulting Hash:</p>\n\n<pre><code>class Change\n  COIN_VALUES = {quarter: 25, dime: 10, nickel: 5, penny: 1}\n\n  def self.change_for(cents)\n    pairs = COIN_VALUES.map do |coin, value|\n      number_of_coins = cents / value\n      cents = cents % value\n      [coin, number_of_coins]\n    end\n    pairs.to_h\n  end\nend\n\n&gt;&gt; Change.change_for(44)\n#&gt; {:quarter=&gt;1, :dime=&gt;1, :nickel=&gt;1, :penny=&gt;4}\n&gt;&gt; Change.change_for(116)\n#&gt; {:quarter=&gt;4, :dime=&gt;1, :nickel=&gt;1, :penny=&gt;1}\n&gt;&gt; Change.change_for(77)\n#&gt; {:quarter=&gt;3, :dime=&gt;0, :nickel=&gt;0, :penny=&gt;2}\n</code></pre>\n\n<p>Let's walk through the logic step by step:</p>\n\n<p>First, we define a constant, as indicated by the variable name (<code>COIN_VALUES</code>) in all caps.</p>\n\n<p>Next, we're going to iterate over that constant using <code>Enumerable#map</code>. This will allow us to address each key/value pair individually, perform operations on them, and return an Array from those operations.</p>\n\n<p>The <code>cents</code> variable stores the number of remaining cents. We use integer division to get the highest integer representing the number of coins for the current coin, then take the modulo to determine how many cents remain after performing that operation. </p>\n\n<p>When we're done, we have an Array of two-element Arrays, which we store in <code>pairs</code>. If <code>cents</code> is given as 44, it will look like this:</p>\n\n<pre><code>[[:quarter, 1], [:dime, 1], [:nickel, 1], [:penny, 4]]\n</code></pre>\n\n<p>By returning <code>pairs.to_h</code> we convert <code>pairs</code> into a Hash:</p>\n\n<pre><code>{quarter: 1, dime: 1, nickel: 1, penny: 4}\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 5620807, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c760cfacf1be68d224839f67fd12d010?s=128&d=identicon&r=PG&f=1", "display_name": "SB    D", "link": "https://stackoverflow.com/users/5620807/sb-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1561380796, "creation_date": 1513744836, "last_edit_date": 1561380796, "question_id": 47898887, "link": "https://stackoverflow.com/questions/47898887/ruby-make-hash-dynamically-by-currency-change", "title": "ruby: make hash dynamically by currency change", "body": "<p>tell us a way to make change for that amount of money. Some examples:</p>\n\n<pre><code>&gt; chafor(25)\n{qa: 1}\n\n&gt; chanfor(41)\n{qua: 1, dim: 1, nick: 1, pen: 1}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "therubyracer", "libv8"], "owner": {"reputation": 808, "user_id": 2219557, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/fc899d27ddee39e6d2d2790aef4f54c3?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar M", "link": "https://stackoverflow.com/users/2219557/arun-kumar-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1513743866, "creation_date": 1513743866, "question_id": 47898760, "link": "https://stackoverflow.com/questions/47898760/therubyracer-incompatible-library-version", "title": "therubyracer incompatible library version", "body": "<p>My application is running on <strong>ubuntu 16.04</strong> with <strong>ruby 2.1.4p265</strong> and <strong>rails 4.2.2</strong>. I get the following error </p>\n\n<pre><code>incompatible library version - /home/aktivlearnadmin/.rvm/gems/ruby-2.1.4/gems/therubyracer-0.12.2/lib/v8/init.so (LoadError)\n/home/aktivlearnadmin/.rvm/gems/ruby-2.1.4/gems/therubyracer-0.12.2/lib/v8.rb:4:in `require'\n/home/aktivlearnadmin/.rvm/gems/ruby-2.1.4/gems/therubyracer-0.12.2/lib/v8.rb:4:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>This error doesn't happen in ubuntu 14.04. Any solution to fix it?</p>\n"}, {"tags": ["ruby", "binary", "byte", "binaries"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1513741063, "post_id": 47898369, "comment_id": 82763608, "body": "I don&#39;t know Ruby, but my guess would be that it&#39;s calculating the zeros needed for left-padding the value to a length that is 8 digits (e.g., <code>10001</code> to <code>00010001</code> so that the inverted value is correct (<code>10001000</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "is_accepted": false, "score": 1, "last_activity_date": 1513741342, "creation_date": 1513741342, "answer_id": 47898459, "question_id": 47898369, "link": "https://stackoverflow.com/questions/47898369/why-does-conversion-of-binary-to-decimal-involve-the-number-8/47898459#47898459", "title": "Why does conversion of binary to decimal involve the number &#39;8&#39;?", "body": "<p>When str is \"47\", binary will be assigned \"111101\".</p>\n\n<pre><code>  binary = str.to_i.to_s(2).reverse\n</code></pre>\n\n<p>Normally, you represent binary values as 8 characters or 8 bits. At this point, you can't simply convert your binary string back to an integer. \"111101\" is 61 in binary.</p>\n\n<p>Instead, you need to pad \"111101\" with zeroes until it has 8 bits. That's what the following code does.</p>\n\n<pre><code>  dig += 8 until dig &gt;= binary.length\n  binary += '0' until binary.length == dig\n</code></pre>\n\n<p>Once you have 8 bits, you can convert it back to an integer.</p>\n"}], "owner": {"reputation": 9, "user_id": 8903392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dffae2bd53edd230d30a96aa199ed0?s=128&d=identicon&r=PG&f=1", "display_name": "Iris", "link": "https://stackoverflow.com/users/8903392/iris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513754356, "creation_date": 1513740509, "last_edit_date": 1513754356, "question_id": 47898369, "link": "https://stackoverflow.com/questions/47898369/why-does-conversion-of-binary-to-decimal-involve-the-number-8", "title": "Why does conversion of binary to decimal involve the number &#39;8&#39;?", "body": "<p>I am looking at the solution for the following coding challenge on Coderbyte:</p>\n\n<blockquote>\n  <p>Using the Ruby language, have the function <code>BinaryReversal(str)</code> take the <code>str</code> parameter being passed, which will be a positive integer, take its binary representation, reverse that string of bits, and then finally return the new reversed string in decimal form. For example: if <code>str</code> is <code>\"47\"</code> then the binary version of this integer is <code>00101111</code>. Your program should reverse this binary string which then becomes: <code>11110100</code> and then finally return the decimal version of this string, which is <code>244</code>.</p>\n</blockquote>\n\n<p>The solution is:</p>\n\n<pre><code>def BinaryReversal(str, dig = 8)\n  binary = str.to_i.to_s(2).reverse\n  dig += 8 until dig &gt;= binary.length\n  binary += '0' until binary.length == dig\n  binary.to_i(2)\nend\n</code></pre>\n\n<p>I don't understand why the binary needs to have <code>0</code>s added onto it until it's length is equal to <code>dig</code>. In fact, I don't understand the role of <code>dig</code> at all.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv"], "answers": [{"tags": [], "owner": {"reputation": 1761, "user_id": 3741320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10222536/picture?type=large", "display_name": "James Milani", "link": "https://stackoverflow.com/users/3741320/james-milani"}, "is_accepted": true, "score": 0, "last_activity_date": 1513734120, "last_edit_date": 1513734120, "creation_date": 1513731023, "answer_id": 47897331, "question_id": 47897125, "link": "https://stackoverflow.com/questions/47897125/ruby-on-rails-5-server-side-csv-validation-error/47897331#47897331", "title": "ruby on rails 5 server-side CSV validation ERROR", "body": "<p>You'll want to use the <code>ActionDispatch::Http::UploadedFile#tempfile</code> method.</p>\n\n<p>Documented <a href=\"http://www.rubydoc.info/docs/rails/4.1.7/ActionDispatch%2FHttp%2FUploadedFile:tempfile\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>So you can call it like this:</p>\n\n<p><code>File.read(file.tempfile, encoding: 'utf-8')</code></p>\n\n<p>That will allow the object to transform to an actual file as opposed to an <code>ActionDispatch</code> object.</p>\n\n<p>See this SO Article: <a href=\"https://stackoverflow.com/questions/12589973/reading-in-file-contents-rails\">Reading in file contents rails</a></p>\n"}], "owner": {"reputation": 141, "user_id": 7731733, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4326673ebb8b37ec113a5b7d17afce92?s=128&d=identicon&r=PG&f=1", "display_name": "homior", "link": "https://stackoverflow.com/users/7731733/homior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 47897331, "answer_count": 1, "score": 0, "last_activity_date": 1513734120, "creation_date": 1513729412, "question_id": 47897125, "link": "https://stackoverflow.com/questions/47897125/ruby-on-rails-5-server-side-csv-validation-error", "title": "ruby on rails 5 server-side CSV validation ERROR", "body": "<p>In my lib/csv_validation.rb file I got my validate method:</p>\n\n<pre><code>def self.validate(file, delimiter, columns)\n  return false unless File.exist?(file)\n  content = File.read(file, encoding: 'utf-8')\n  return false unless content.valid_encoding?\n  content.each_line do |line|\n    return false if line.count(delimiter) &lt; columns - 1\n  end\n  true\nend\n</code></pre>\n\n<p>when I send a CSV file via ajax post request I get the following error:</p>\n\n<pre><code>Started POST \"/students/import\" for 127.0.0.1 at 2017-12-20 01:03:43 +0100\nProcessing by StudentsController#import as */*\nParameters: {\"file\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x007fd0a228ca38 @tempfile=#&lt;Tempfile:/tmp/RackMultipart20171220-4516-or6qi3.csv&gt;, @original_filename=\"students_fail.csv\", @content_type=\"text/csv\", @headers=\"Content-Disposition: form-data; name=\\\"file\\\"; filename=\\\"students_fail.csv\\\"\\r\\nContent-Type: text/csv\\r\\n\"&gt;}\nCompleted 500 Internal Server Error in 19ms (ActiveRecord: 0.0ms)\n\n\n\nTypeError (can't convert ActionDispatch::Http::UploadedFile to IO (ActionDispatch::Http::UploadedFile#to_io gives Tempfile)):\n\napp/models/student.rb:114:in `exist?'\napp/models/student.rb:114:in `import'\napp/controllers/students_controller.rb:50:in `import'\nRendering /var/lib/gems/2.4.0/gems/actionpack-5.0.6/lib/action_dispatch/middleware/templates/rescues/diagnostics.text.erb\nRendering /var/lib/gems/2.4.0/gems/actionpack-5.0.6/lib/action_dispatch/middleware/templates/rescues/_source.text.erb\nRendered /var/lib/gems/2.4.0/gems/actionpack-5.0.6/lib/action_dispatch/middleware/templates/rescues/_source.text.erb (0.4ms)\nRendering /var/lib/gems/2.4.0/gems/actionpack-5.0.6/lib/action_dispatch/middleware/templates/rescues/_trace.text.erb\nRendered /var/lib/gems/2.4.0/gems/actionpack-5.0.6/lib/action_dispatch/middleware/templates/rescues/_trace.text.erb (0.4ms)\nRendering /var/lib/gems/2.4.0/gems/actionpack-5.0.6/lib/action_dispatch/middleware/templates/rescues/_request_and_response.text.erb\nRendered /var/lib/gems/2.4.0/gems/actionpack-5.0.6/lib/action_dispatch/middleware/templates/rescues/_request_and_response.text.erb (0.6ms)\nRendered /var/lib/gems/2.4.0/gems/actionpack-5.0.6/lib/action_dispatch/middleware/templates/rescues/diagnostics.text.erb (14.4ms)\nDEPRECATION WARNING: Accessing mime types via constants is deprecated. Please change `Mime::HTML` to `Mime[:html]`. (called from acceptable_content_type? at /var/lib/gems/2.4.0/gems/web-console-2.3.0/lib/web_console/middleware.rb:58)\n</code></pre>\n\n<p>I was searching for <code>can't convert ActionDispatch::Http::UploadedFile to IO</code> but I just find something like <code>can't convert ActionDispatch::Http::UploadedFile into String</code>.</p>\n\n<p>I am not sure how to handle this error or where I can find someone with the same problem.</p>\n\n<p>sorry for my bad english and thx for help.</p>\n"}, {"tags": ["ruby", "hanami"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1513732101, "post_id": 47896591, "comment_id": 82761680, "body": "What browser are you seeing this in?  Some browsers will render alternate content depending on the response.  Hanami will likewise render its own views for non-success codes - <a href=\"https://github.com/hanami/hanami/blob/master/lib/hanami/views/default.rb#L10\" rel=\"nofollow noreferrer\">github.com/hanami/hanami/blob/master/lib/hanami/views/&hellip;</a>"}, {"owner": {"reputation": 5824, "user_id": 781743, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d19aed08825cbb3a52289ce9d5613035?s=128&d=identicon&r=PG", "display_name": "graywolf", "link": "https://stackoverflow.com/users/781743/graywolf"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1513763679, "post_id": 47896591, "comment_id": 82773006, "body": "@Joe so failed login should return 200? :-O that sounds... weird. The action (login attempt) obviously failed, so getting back 200 doesn&#39;t seem correct; anyway regardless of it being good idea or not, I&#39;m still having hard time believing it&#39;s just not possible to do :/"}, {"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1513769647, "post_id": 47896591, "comment_id": 82776832, "body": "Duh. I was reading question wrong."}], "answers": [{"tags": [], "owner": {"reputation": 5824, "user_id": 781743, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d19aed08825cbb3a52289ce9d5613035?s=128&d=identicon&r=PG", "display_name": "graywolf", "link": "https://stackoverflow.com/users/781743/graywolf"}, "is_accepted": true, "score": 1, "last_activity_date": 1513817701, "creation_date": 1513817701, "answer_id": 47916417, "question_id": 47896591, "link": "https://stackoverflow.com/questions/47896591/setting-http-status-but-keep-normal-view/47916417#47916417", "title": "Setting http status but keep normal view?", "body": "<p>Not possible to do at the moment, see <a href=\"https://github.com/hanami/hanami/issues/874\" rel=\"nofollow noreferrer\">https://github.com/hanami/hanami/issues/874</a> for workaround.</p>\n"}], "owner": {"reputation": 5824, "user_id": 781743, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d19aed08825cbb3a52289ce9d5613035?s=128&d=identicon&r=PG", "display_name": "graywolf", "link": "https://stackoverflow.com/users/781743/graywolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 47916417, "answer_count": 1, "score": 1, "last_activity_date": 1513817701, "creation_date": 1513725441, "question_id": 47896591, "link": "https://stackoverflow.com/questions/47896591/setting-http-status-but-keep-normal-view", "title": "Setting http status but keep normal view?", "body": "<p>How can I set different http status but keep normal view? Currently I have these two lines in my action</p>\n\n<pre><code>self.status = 403\nself.body = Web::Views::Login::Form.render(exposures)\n</code></pre>\n\n<p>However my problems is that I get complete different page, just gray page with big rectangle in the middle with with HTML text of <code>self.body</code> (escaped, so I see the actual source code, not the page).</p>\n\n<p>So, how can I set reponse code while keeping regular view processing (== displaying <code>self.body</code>)?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "reactjs", "integration"], "comments": [{"owner": {"reputation": 1209, "user_id": 6938822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10105418757997339/picture?type=large", "display_name": "Max", "link": "https://stackoverflow.com/users/6938822/max"}, "edited": false, "score": 0, "creation_date": 1513723050, "post_id": 47896053, "comment_id": 82759243, "body": "You probably want to bundle the JS in the asset pipeline. There are tutorials  on how to do this."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1513724157, "post_id": 47896053, "comment_id": 82759636, "body": "Set this up in your routes. The root path should deliver the client-side app. The rest can be the API."}], "answers": [{"tags": [], "owner": {"reputation": 545, "user_id": 7146589, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f3b4cadf837952a1fbc16191d22c2bf?s=128&d=identicon&r=PG&f=1", "display_name": "iceveda06", "link": "https://stackoverflow.com/users/7146589/iceveda06"}, "is_accepted": false, "score": 0, "last_activity_date": 1513724861, "creation_date": 1513724861, "answer_id": 47896508, "question_id": 47896053, "link": "https://stackoverflow.com/questions/47896053/rails-controller-to-return-a-whole-react-app/47896508#47896508", "title": "Rails controller to return a whole react app", "body": "<p>I can't give you a direct write up of how to connect them, it would be a bit lengthy but here is a link that can get you on your way:</p>\n\n<ol>\n<li>This link talks about 'create-react-app' which is what you did to create your react application and Rails API.</li>\n</ol>\n\n<p><a href=\"https://www.fullstackreact.com/articles/how-to-get-create-react-app-to-work-with-your-rails-api/\" rel=\"nofollow noreferrer\">https://www.fullstackreact.com/articles/how-to-get-create-react-app-to-work-with-your-rails-api/</a></p>\n\n<p>In general, all you do is create 'Rails API' application and render json with your controllers and use React fetch/axios to connect to the your Rails API</p>\n"}, {"tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": true, "score": 2, "last_activity_date": 1513808397, "last_edit_date": 1513808397, "creation_date": 1513778326, "answer_id": 47907698, "question_id": 47896053, "link": "https://stackoverflow.com/questions/47896053/rails-controller-to-return-a-whole-react-app/47907698#47907698", "title": "Rails controller to return a whole react app", "body": "<p>Not very experienced on this matter, but if it would help, this is what I did in my recent project:</p>\n\n<ul>\n<li><p>Use / integrate <a href=\"https://github.com/rails/webpacker\" rel=\"nofollow noreferrer\">webpacker gem</a> into your Rails project</p></li>\n<li><p><strong>app/config/routes.rb</strong>:</p>\n\n<pre><code># all JSON requests goes here\nscope constraints: -&gt; (request) { request.format == :json } do\n  # all of your Rails API routes goes here\nend\n\n# all HTML requests goes here,\n# as your react-router should already be able to handle this\nscope constraints: -&gt; (request) { request.format == :html } do\n  # this matches ALL paths to bootstrapper action\n  match '*path', to: 'application#bootstrapper'\nend\n\nroot 'application#boostrapper'\n</code></pre></li>\n<li><p><strong>app/controllers/application_controller.rb</strong>:</p>\n\n<pre><code>def bootstrapper\n  render template: 'layouts/bootstrapper'\nend\n</code></pre></li>\n<li><p><strong>app/views/layouts/bootstrapper.html.erb</strong></p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n  &lt;head&gt;\n    &lt;!-- YOUR USUAL &lt;head&gt; HERE --&gt;\n    &lt;%= stylesheet_link_tag    \"application\" %&gt;\n    &lt;%= javascript_include_tag \"application\" %&gt;\n    &lt;%= csrf_meta_tags %&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;!-- DONT NEED THE &lt;%= yield %&gt; HERE --&gt;\n    &lt;%= javascript_pack_tag 'your_react_pack' %&gt;\n    &lt;%= stylesheet_pack_tag 'your_react_pack' %&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre></li>\n<li><p>Finally configure your <strong>app/javascript/packs/your_react_pack.js</strong> (This is the entry-point of your React files, and so you'll <code>import</code> your React app here) See <a href=\"https://github.com/rails/webpacker\" rel=\"nofollow noreferrer\">webpacker</a> for details</p></li>\n</ul>\n\n<h2>Bonus</h2>\n\n<ul>\n<li>Cross-Site Request Forgery (CSRF) protection is a must! In Rails 5 (or perhaps 4 as well?) you can simply use <code>Rails.csrfToken()</code> to get the token in JS, and pass it as a <code>'X-CSRF-Token'</code> header when submitting JSON requests to your Rails app. Make sure you have <code>//= require rails-ujs</code> in your <strong>app/assets/javascripts/application.js</strong> for you to be able to use <code>Rails.csrfToken()</code></li>\n</ul>\n"}], "owner": {"reputation": 152, "user_id": 1992662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/85734d3ef37a5deb314ca66ea611294a?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Anwer", "link": "https://stackoverflow.com/users/1992662/mohamed-anwer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 47907698, "answer_count": 2, "score": 0, "last_activity_date": 1513808397, "creation_date": 1513722143, "question_id": 47896053, "link": "https://stackoverflow.com/questions/47896053/rails-controller-to-return-a-whole-react-app", "title": "Rails controller to return a whole react app", "body": "<p>I have a Rails API application and a separate standalone React application.</p>\n\n<p>I want to create a controller that returns this whole app to the end user and let the react app consume the API from the dedicated controllers, instead of creating two servers.</p>\n\n<p>How can I do this neatly?</p>\n\n<p>The react app tree is:</p>\n\n<ul>\n<li>public\n\n<ul>\n<li>favicon.ico</li>\n<li>index.html</li>\n<li>manifest.json</li>\n</ul></li>\n<li>src\n\n<ul>\n<li>Assets/</li>\n<li>Componenets/</li>\n<li>Views/</li>\n<li>App.css</li>\n<li>App.js</li>\n<li>index.css</li>\n<li>index.js</li>\n<li>registerServiceWorkder.js</li>\n</ul></li>\n<li>README</li>\n<li>package.josn</li>\n<li>package-lock.json</li>\n</ul>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-3", "activerecord"], "comments": [{"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "edited": false, "score": 0, "creation_date": 1513728673, "post_id": 47895760, "comment_id": 82760844, "body": "I hardly see a way to optimize this query. You shouldn&#39;t get scared by a 7 lines SQL query with 4 trivial joins and 1 group on a primary key column. SQL is not Ruby."}, {"owner": {"reputation": 149, "user_id": 2966334, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b95236d0d84ab81af28d6f97cb028bb0?s=128&d=identicon&r=PG&f=1", "display_name": "octopushugs", "link": "https://stackoverflow.com/users/2966334/octopushugs"}, "edited": false, "score": 0, "creation_date": 1513733635, "post_id": 47895760, "comment_id": 82762060, "body": "I&#39;m not sure about the SQL but you can certainly reduce the amount of ruby you&#39;re writing by using multi-level joins similar to this: <code>Simulation.joins(user_simulations: :user)</code>, which should join the user_simulation and the user records if available. We probably can&#39;t get any more specific without seeing what your models look like though."}, {"owner": {"reputation": 630, "user_id": 5763672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ca5c235400320ab800200c6677574?s=128&d=identicon&r=PG", "display_name": "Sebastian Scholl", "link": "https://stackoverflow.com/users/5763672/sebastian-scholl"}, "edited": false, "score": 0, "creation_date": 1513784284, "post_id": 47895760, "comment_id": 82786548, "body": "Thanks guys, here are the models to help show what&#39;s happening a bit more. I just included the models."}], "answers": [{"tags": [], "owner": {"reputation": 1660, "user_id": 4051942, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/bCeCe.png?s=128&g=1", "display_name": "Marcelo Ribeiro", "link": "https://stackoverflow.com/users/4051942/marcelo-ribeiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1513741727, "creation_date": 1513741727, "answer_id": 47898509, "question_id": 47895760, "link": "https://stackoverflow.com/questions/47895760/how-do-i-shorten-a-triple-joins-activerecord-query-with-a-has-many-through-relat/47898509#47898509", "title": "How do I shorten a triple Joins ActiveRecord Query with a has_many through relations?", "body": "<p>What about this?</p>\n\n<pre><code>scope :from_user, lambda{|user|\n  joins('left join user_simulations us ON (us.simulation_id = simulations.id)').\n  joins('left join group_simulations gs ON (gs.simulation_id = simulations.id)').\n  where(\"us.user_id = ? OR gs.group_id IN (?)\",\n        user.id,\n        UserGroup.select(\"group_id\").where(user_id: user.id))}\n</code></pre>\n\n<p>Simulation.from_user(user).to_sql:</p>\n\n<pre><code>\"SELECT `simulations`.* FROM `simulations` \nleft join user_simulations us ON (us.simulation_id = simulations.id)\nleft join group_simulations gs ON (gs.simulation_id = simulations.id) \nWHERE (us.user_id = 1 OR gs.group_id IN (\n  SELECT `user_groups`.`group_id` FROM `user_groups` \n  WHERE `user_groups`.`user_id` = 1))\" \n</code></pre>\n"}], "owner": {"reputation": 630, "user_id": 5763672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ca5c235400320ab800200c6677574?s=128&d=identicon&r=PG", "display_name": "Sebastian Scholl", "link": "https://stackoverflow.com/users/5763672/sebastian-scholl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513784503, "creation_date": 1513720595, "last_edit_date": 1513784503, "question_id": 47895760, "link": "https://stackoverflow.com/questions/47895760/how-do-i-shorten-a-triple-joins-activerecord-query-with-a-has-many-through-relat", "title": "How do I shorten a triple Joins ActiveRecord Query with a has_many through relations?", "body": "<p>I'm trying to clean up a very long <code>ActiveRecord</code> query. The one I have is working, though it hurts to look at it. Here's what is happening.</p>\n\n<p>1) <code>User</code> has_many <code>Simulations</code> through <code>UserSimulations</code> (and vice versa).</p>\n\n<p>2) <code>User</code> has_many <code>Groups</code> through <code>UserGroups</code> (and vice versa).</p>\n\n<p>3) <code>Group</code> has_many <code>Simulations</code> through <code>SimulationGroups</code> (and vice versa).</p>\n\n<p>What ends up happening here is that a user can be associated to a <code>Simulation</code> in two ways, either directly through the has_many to has_many relationship, or indirectly through a <code>Group</code> that the user belongs to.</p>\n\n<p>I've been able to gather all the <code>Simulations</code> a User has access to in a single query, and it looks like this. I have access to the <code>current_user</code> object where the query needs to be called.</p>\n\n<pre><code># Define Queries\nuser_sim_join = \"LEFT JOIN user_simulations ON user_simulations.simulation_id = simulations.id\"\nuser_grp_join = \"LEFT JOIN user_groups ON user_groups.group_id = groups.id\"\nwhere_clause  = [\"user_groups.user_id = :user_id OR user_simulations.user_id = :user_id\", { user_id: user.id }]\n\n# Run Query\nSimulation.joins(user_sim_join, :groups, user_grp_join).where(where_clause).group('simulations.id') \n\n#=&gt; Simulation Load (1.1ms)  SELECT \"simulations\".* FROM \"simulations\" \n         INNER JOIN \"simulation_groups\" ON \"simulation_groups\".\"simulation_id\" = \"simulations\".\"id\" \n         INNER JOIN \"groups\" ON \"groups\".\"id\" = \"simulation_groups\".\"group_id\" \n         LEFT JOIN user_simulations ON user_simulations.simulation_id = simulations.id \n         LEFT JOIN user_groups ON user_groups.group_id = groups.id \n         WHERE (user_groups.user_id = 2 OR user_simulations.user_id = 2) \n         GROUP BY simulations.id\n</code></pre>\n\n<p>I'm happy that it's working but would like to clean it up as to be more concise (not 4 lines of code to build a single query).</p>\n\n<h3>UPDATE</h3>\n\n<p>Here are the models involved.</p>\n\n<p>Simulation.rb</p>\n\n<pre><code>class Simulation &lt; ApplicationRecord\n  # Associations\n  belongs_to :company\n\n  has_many :simulation_groups\n  has_many :user_simulations\n  has_many :objection_responses\n\n  has_many :groups, through: :simulation_groups\n  has_many :users, through: :user_simulations\n\n  has_many :reports, as: :reportable\n  has_many :objections, as: :objectionable\n\n  # Validations\nend\n</code></pre>\n\n<p>Group.rb</p>\n\n<pre><code>class Group &lt; ApplicationRecord\n  belongs_to :company\n  has_many :simulation_groups\n  has_many :simulations, through: :simulation_groups\n  has_many :user_groups\n  has_many :users, through: :user_groups\n  has_many :minigame_groups\n  has_many :minigames, through: :minigame_groups\n  has_many :reports, through: :users\n\n  # Validations\nend\n</code></pre>\n\n<p>User.rb</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Associations\n  belongs_to :company\n\n  has_one  :avatar\n  has_many :reports\n  has_many :events\n  has_many :training_sessions\n  has_many :user_groups\n  has_many :groups, through: :user_groups\n  has_many :objection_responses\n  has_many :user_simulations\n  has_many :simulations, through: :user_simulations\n  has_many :minigame_users\n  has_many :minigames, through: :minigame_users\n\n  # Validations\nend\n</code></pre>\n"}, {"tags": ["ruby", "version", "project", "rbenv"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1513716666, "post_id": 47894930, "comment_id": 82756669, "body": "can you try <code>rbenv local 2.3.0 &amp;&amp; cd ~ &amp;&amp; cd - &amp;&amp; bundle install</code>.  I thought <code>rbenv local</code> just sets your .ruby-version file accordingly"}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1513719288, "post_id": 47894930, "comment_id": 82757774, "body": "@Anthony, WHen I ran that command, it revealed that ruby 2.3 wasn&#39;t even installed on my system.  Addressing that did indeed solve the problem I described in my question."}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1513719364, "post_id": 47894930, "comment_id": 82757804, "body": "cool - I will write up a quick answer if that works for you?"}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1513719578, "post_id": 47894930, "comment_id": 82757894, "body": "@Anthony, Go for it!"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1513724937, "post_id": 47895560, "comment_id": 82759871, "body": "<code>rbenv local VERSION</code> usually picks it up immediately."}], "tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 5, "last_activity_date": 1513719473, "creation_date": 1513719473, "answer_id": 47895560, "question_id": 47894930, "link": "https://stackoverflow.com/questions/47894930/how-do-i-switch-my-ruby-version-for-a-single-project-only/47895560#47895560", "title": "How do I switch my Ruby version for a single project only?", "body": "<p><a href=\"https://github.com/rbenv/rbenv#rbenv-local\" rel=\"noreferrer\">rbenv local</a> only sets a <code>.ruby-version</code> file in your current directory, it doesn't also load that version for you.  You'll need to set it and then <code>cd .. &amp;&amp; cd -</code> to have the rbenv shim pick up that version.</p>\n"}, {"tags": [], "owner": {"reputation": 326, "user_id": 3013354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad9dbf3df6d9dc0944bb224014a3bc2b?s=128&d=identicon&r=PG", "display_name": "nekogami", "link": "https://stackoverflow.com/users/3013354/nekogami"}, "is_accepted": false, "score": 0, "last_activity_date": 1513734879, "creation_date": 1513734879, "answer_id": 47897740, "question_id": 47894930, "link": "https://stackoverflow.com/questions/47894930/how-do-i-switch-my-ruby-version-for-a-single-project-only/47897740#47897740", "title": "How do I switch my Ruby version for a single project only?", "body": "<p>If you have a gemfile you can also add\nruby '2.3.1'\ninside it to tell your system to use that ruby version.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 14698397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8pY7J.png?s=128&g=1", "display_name": "Kaiizer", "link": "https://stackoverflow.com/users/14698397/kaiizer"}, "is_accepted": false, "score": 0, "last_activity_date": 1608730932, "last_edit_date": 1608730932, "creation_date": 1608730577, "answer_id": 65425170, "question_id": 47894930, "link": "https://stackoverflow.com/questions/47894930/how-do-i-switch-my-ruby-version-for-a-single-project-only/65425170#65425170", "title": "How do I switch my Ruby version for a single project only?", "body": "<h2><strong>This is the best solution for a linux or WSL distribution</strong></h2>\n<p>Check first what the versions you can download</p>\n<pre><code>rbenv install -l\n</code></pre>\n<p>then install it with</p>\n<pre><code>rbenv install 2.6.6\n</code></pre>\n<p>now you have installed a version to check all version you have:</p>\n<pre><code>rbenv versions \n</code></pre>\n<p>then to use it you can set it locally in a specific project:</p>\n<pre><code>rbenv local 2.6.6\n</code></pre>\n<p>or globally</p>\n<pre><code>rbenv global 2.6.6\n</code></pre>\n<p>After the installation you could create a projet with <code>rails new</code> ==&gt; automaticaly set with ruby global</p>\n<p>If the project are alwready created, there 2 ways</p>\n<ul>\n<li>Manually modify:\n<code>.ruby-version</code> to your global version</li>\n<li><strong>or</strong> run in folder of the projet <code>rbenv local 2.6.6</code></li>\n</ul>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3067, "favorite_count": 0, "accepted_answer_id": 47895560, "answer_count": 3, "score": 3, "last_activity_date": 1608730932, "creation_date": 1513716375, "question_id": 47894930, "link": "https://stackoverflow.com/questions/47894930/how-do-i-switch-my-ruby-version-for-a-single-project-only", "title": "How do I switch my Ruby version for a single project only?", "body": "<p>I was reading that rbenv can be used to switch the Ruby environment for a single project only.  I have Ruby 2.4 installed on my system, but I'd like to use version 2.3 for a specific project only.  I thought using \"rbenv local\" would heal the pain but it does not ...</p>\n\n<pre><code>localhost:myproject davea$ rbenv local 2.3.0\nlocalhost:myproject davea$ bundle install\nYour Ruby version is 2.4.0, but your Gemfile specified 2.3.0\nlocalhost:myproject davea$ ruby -v\nruby 2.4.0p0 (2016-12-24 revision 57164) [x86_64-darwin16]\n</code></pre>\n\n<p>How do I use Ruby 2.3 for this project only?  </p>\n"}, {"tags": ["mysql", "ruby", "date", "mysql2"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1513716321, "post_id": 47894616, "comment_id": 82756527, "body": "it&#39;s not raising an error but it&#39;s just not giving results?  can you show us a few rows from <code>rotadates</code>?  Also is <code>fulldate</code> a string or a date type in mysql2?"}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 9119335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f0063bd0556fdfd1f626f75b47d56e21?s=128&d=identicon&r=PG&f=1", "display_name": "busfender", "link": "https://stackoverflow.com/users/9119335/busfender"}, "is_accepted": false, "score": 0, "last_activity_date": 1514056993, "creation_date": 1514056993, "answer_id": 47955318, "question_id": 47894616, "link": "https://stackoverflow.com/questions/47894616/why-does-passing-one-date-query-via-mysql2-from-ruby-work-but-another-not/47955318#47955318", "title": "Why does passing one date query via Mysql2 from Ruby work but another not?", "body": "<p>I have no idea why but when I pass this in IRB it does not seem to work whereas in Aptana console it does.</p>\n"}], "owner": {"reputation": 35, "user_id": 9119335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f0063bd0556fdfd1f626f75b47d56e21?s=128&d=identicon&r=PG&f=1", "display_name": "busfender", "link": "https://stackoverflow.com/users/9119335/busfender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514056993, "creation_date": 1513714882, "last_edit_date": 1513760205, "question_id": 47894616, "link": "https://stackoverflow.com/questions/47894616/why-does-passing-one-date-query-via-mysql2-from-ruby-work-but-another-not", "title": "Why does passing one date query via Mysql2 from Ruby work but another not?", "body": "<p>EDITED for clarity and added info:</p>\n\n<p>Total newbie to Ruby coding (and coding in general) so please be gentle.</p>\n\n<p>I have a MySQL database, and I want to pull out some data from one of the tables, a column of which is labelled \"fulldate\".</p>\n\n<p>The following code works to pull out all rows after a certain date.</p>\n\n<pre><code>start_date = Date.new(2018, 1, 2)\nend_date  = Date.new(2018, 1, 12)\n\nclw_check = client.query('SELECT * FROM rotadates WHERE fulldate &gt;\"#{start_date}\"')\nclw_check.each do |row| puts row[\"fulldate\"] end\n</code></pre>\n\n<p>Then the output is a list of dates from each row.</p>\n\n<p>However, when I change to </p>\n\n<pre><code>clw_check = client.query('SELECT * FROM rotadates WHERE fulldate &lt;\"#{end_date}\"')\nclw_check.each do |row| puts row[\"fulldate\"] end\n</code></pre>\n\n<p>then this produces</p>\n\n<pre><code>=&gt; []\n</code></pre>\n\n<p>If I put the date instead of the #{} expression, then I get a list of dates with both less than and greater than expressions.</p>\n\n<p>I have searched StackOverflow and the net in general, but cannot for the life of me work out why it works with the first expression the second.</p>\n\n<p>A check on whether start_date and end_date are dates or strings says they are dates, and the MySQL column is also a date with identical yyyy-mm-dd format.</p>\n\n<p>Example of rows from MySQL table:</p>\n\n<h2>rotadates</h2>\n\n<p>| idDate | fulldate | year | month | day | quarter | week | dayOfWeek | weekend | clw |<br>\n| 20180102 | 2018-01-02 | 2018 | 1 | 2 | 1 | 1 | 2 | 0 | 1 |<br>\n| 20180103 | 2018-01-03 | 2018 | 1 | 3 | 1 | 1 | 3 | 0 | 1 |<br>\n| 20180104 | 2018-01-04 | 2018 | 1 | 4 | 1 | 1 | 4 | 0 | 1 |<br>\n| 20180105 | 2018-01-05 | 2018 | 1 | 5 | 1 | 1 | 5 | 0 | 1 |<br>\n| 20180106 | 2018-01-06 | 2018 | 1 | 6 | 1 | 1 | 6 | 1 | 1 |  </p>\n"}, {"tags": ["java", "ruby", "equivalent"], "comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513712386, "post_id": 47893757, "comment_id": 82754752, "body": "What do you want this for?"}, {"owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1522880498, "post_id": 47893757, "comment_id": 86332389, "body": "How can the answer have two upvotes, and the question one downvote?"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513712873, "post_id": 47894026, "comment_id": 82755007, "body": "@StefanPochmann Ah, so it&#39;s just coincidental it uses the same system as Windows."}, {"owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "edited": false, "score": 0, "creation_date": 1513713176, "post_id": 47894026, "comment_id": 82755143, "body": "Thanks! Before I mark this as answered, can you clear two questions up below: So if I wanted to minimize BigNum usage, and keep my times in int, I have to keep them before 2116, 02, 20 correct? Question 1. Not sure if this includes the daytime hours on the 20th of February, 2116 or not (is 11:59:59 on February 19th the limit). Question 2. Also, can I tell if time is using an int or BigNum? .class returns Time, and .to_i seems to work on times greater then the above limit."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 4, "creation_date": 1513717068, "post_id": 47894026, "comment_id": 82756835, "body": "<code>Integer</code> used to be either a <code>Fixnum</code> or a <code>Bignum</code>; since Ruby 2.4 it&#39;s just <code>Integer</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 4, "creation_date": 1513721588, "post_id": 47894026, "comment_id": 82758701, "body": "I&#39;m not sure what the concern is here. Why would you have trouble keeping times below that value? This sounds like a data validation problem more than a Ruby implementation one. Unless you&#39;re dealing with millions of time objects per second the overhead of bignum is really hard to measure. You&#39;re more likely going to have problems serializing these to a database. For example, MySQL supports the range  1000CE through 9999CE. Postgres is different, it&#39;s 4713BCE to 5874897CE. You&#39;ll need to clamp to the weakest link in the chain which, given Ruby&#39;s implementation, is not Ruby."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 6, "last_activity_date": 1513712425, "last_edit_date": 1513712425, "creation_date": 1513712036, "answer_id": 47894026, "question_id": 47893757, "link": "https://stackoverflow.com/questions/47893757/ruby-get-maximum-integer-size-value/47894026#47894026", "title": "Ruby get maximum integer size value", "body": "<p>There's no maximum any more for integers, they automatically shift to \"bignum\" representation:</p>\n\n<pre><code>1 &lt;&lt; 64\n# =&gt; 18446744073709551616\n(1 &lt;&lt; 64) + 1\n# =&gt; 18446744073709551617\n</code></pre>\n\n<p>There's really no limit other than memory:</p>\n\n<pre><code>1 &lt;&lt; (1 &lt;&lt; 16)\n# =&gt; 20035299304...(thousands of digits)...05719156736\n</code></pre>\n\n<p>As for Time, it's similarly unbounded so now you can express times well after the heat death of the universe if you really want to:</p>\n\n<pre><code>Time.at(1&lt;&lt;128)\n# =&gt; 10783118943836478994022445751222-08-06 04:04:16 -0400\n</code></pre>\n\n<p>This used to be limited to the usual +/- 2.1 billion range, subject to the <a href=\"https://en.wikipedia.org/wiki/Year_2038_problem\" rel=\"noreferrer\">2038 problem</a> but that hasn't been the case since Ruby ~1.9. I'm not sure where 2116 factors in except from a Windows perspective.</p>\n\n<p>If you want to know the max/min that can be represented in a \"native\" integer then that's platform dependent. 32-bit and 64-bit binaries will have different limits.</p>\n"}], "owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5423, "favorite_count": 1, "accepted_answer_id": 47894026, "answer_count": 1, "score": 3, "last_activity_date": 1513712425, "creation_date": 1513710915, "last_edit_date": 1513711207, "question_id": 47893757, "link": "https://stackoverflow.com/questions/47893757/ruby-get-maximum-integer-size-value", "title": "Ruby get maximum integer size value", "body": "<p>What is the Ruby equivalent for Java's <code>Integer.MAX_VALUE?</code>. Hopefully native.</p>\n\n<p>Runner Up: If no equivalent, I need to set this for a Time object, so instead of hardcoding the maximum date for an integer 2116-02-20, is there a system constant that would work for this?</p>\n"}, {"tags": ["ruby", "mechanize"], "answers": [{"tags": [], "owner": {"reputation": 1848, "user_id": 4089357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628dc1c999e767d7aff0e988631a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/4089357/abdullah"}, "is_accepted": true, "score": 1, "last_activity_date": 1513739750, "last_edit_date": 1513739750, "creation_date": 1513712428, "answer_id": 47894107, "question_id": 47893599, "link": "https://stackoverflow.com/questions/47893599/mechanize-how-to-download-a-spreadsheet/47894107#47894107", "title": "Mechanize: How to download a spreadsheet", "body": "<p>Try this</p>\n\n<pre><code>agent = Mechanize.new\nagent.pluggable_parser.default = Mechanize::Download\nurl = \"https://philjobs.org/jobQuery/execute?fromSavedquery=&amp;email=&amp;jobQuery.name=&amp;format=csv&amp;id=&amp;view=On+screen+-+simple&amp;typesToggler=Any+job+type&amp;_jobTypes=&amp;_jobTypes=&amp;_jobTypes=&amp;_jobTypes=&amp;_jobTypes=&amp;_jobTypes=&amp;_jobTypes=&amp;_jobTypes=&amp;tenureTypesToggler=Any+contract+type&amp;_tenureTypes=&amp;_tenureTypes=&amp;_tenureTypes=&amp;_tenureTypes=&amp;jobQuery.locationConstraint=NONE&amp;jobQuery.institution.id=&amp;jobQuery.institution.name=&amp;jobQuery.institution.deleted=false&amp;jobQuery.distance=50.0&amp;jobQuery.city.id=&amp;autonamejobQuerycity=&amp;jobQuery.country=&amp;jobQuery.region=&amp;topicListToggler=Any+AOS&amp;aocListToggler=Any+AOC&amp;jobQuery.keywords=&amp;moreOptions=&amp;jobQuery.orderBy=Creation+time&amp;searchFromDatePicker=&amp;jobQuery.fromDate=date.struct&amp;jobQuery.fromDate_day=&amp;jobQuery.fromDate_month=&amp;jobQuery.fromDate_year=&amp;searchToDatePicker=&amp;jobQuery.toDate=date.struct&amp;jobQuery.toDate_day=&amp;jobQuery.toDate_month=&amp;jobQuery.toDate_year=&amp;_withExpired=\"\n\nagent.get(url).save('stackoverflow.csv')\n</code></pre>\n\n<p>When you click <strong>Download spreadsheet</strong> link, it submits the form using javascript as <code>get</code> method. The above <code>url</code> is is generated using all the input fields (params) of form.</p>\n"}], "owner": {"reputation": 797, "user_id": 5591109, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5vjA1.png?s=128&g=1", "display_name": "Metaphysiker", "link": "https://stackoverflow.com/users/5591109/metaphysiker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 47894107, "answer_count": 1, "score": 0, "last_activity_date": 1513739750, "creation_date": 1513710200, "question_id": 47893599, "link": "https://stackoverflow.com/questions/47893599/mechanize-how-to-download-a-spreadsheet", "title": "Mechanize: How to download a spreadsheet", "body": "<p>I'm using Mechanize by sparklemotion (<a href=\"https://github.com/sparklemotion/mechanize\" rel=\"nofollow noreferrer\">https://github.com/sparklemotion/mechanize</a>).</p>\n\n<p>There is a site, called <a href=\"https://philjobs.org/\" rel=\"nofollow noreferrer\">https://philjobs.org/</a>. There, you can download a spreadsheet by clicking on a link. </p>\n\n<p>I'm trying to automate the download of the spreadsheet. Here is what I have right now:</p>\n\n<pre><code>require 'rubygems'\nrequire 'mechanize'\n\nagent = Mechanize.new\n\nagent.pluggable_parser.default = Mechanize::Download\n\npage = agent.get('https://philjobs.org')\n\nagent.page.link_with(:text =&gt; 'Download spreadsheet').click.save\n</code></pre>\n\n<p>Instead of saving the spreadsheet, it saves the html. How can I save the spreadsheet instead?</p>\n"}, {"tags": ["ruby", "capistrano3"], "comments": [{"owner": {"reputation": 2465, "user_id": 3042016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6kVHc.jpg?s=128&g=1", "display_name": "will_in_wi", "link": "https://stackoverflow.com/users/3042016/will-in-wi"}, "edited": false, "score": 0, "creation_date": 1513731166, "post_id": 47893321, "comment_id": 82761463, "body": "Where is your first code sample located in the project? I&#39;d probably wrap the hiera deployment code in a module so that you have a global class constant instead of a pile of globals."}, {"owner": {"reputation": 1, "user_id": 3116300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbec387f4d16aad86b04e0dd719f101b?s=128&d=identicon&r=PG&f=1", "display_name": "user3116300", "link": "https://stackoverflow.com/users/3116300/user3116300"}, "reply_to_user": {"reputation": 2465, "user_id": 3042016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6kVHc.jpg?s=128&g=1", "display_name": "will_in_wi", "link": "https://stackoverflow.com/users/3042016/will-in-wi"}, "edited": false, "score": 0, "creation_date": 1513748501, "post_id": 47893321, "comment_id": 82765456, "body": "My first code sample is located right at the beginning of the script. I do not undestand why when using binding the variables are not accessable in the tasks."}], "owner": {"reputation": 1, "user_id": 3116300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbec387f4d16aad86b04e0dd719f101b?s=128&d=identicon&r=PG&f=1", "display_name": "user3116300", "link": "https://stackoverflow.com/users/3116300/user3116300"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513725695, "creation_date": 1513709048, "last_edit_date": 1513725695, "question_id": 47893321, "link": "https://stackoverflow.com/questions/47893321/capistrano-3-ruby-variable-scope", "title": "capistrano 3 (ruby) variable scope", "body": "<p>I have some problems with a capistrano 3 script regarding the scope of variables. I read the variables from hiera like this:</p>\n\n<pre><code>deployment = hiera(\"deployment\")\ndeployment.each_pair{|k,v|\n   binding.eval(\"#{k}='#{v}'\")\n}\n</code></pre>\n\n<p>My hiera file looks like this:</p>\n\n<pre><code>---\ndeployment:\n  webserver_group: 'www-data'\n  app_config_environment: 'prod'\n  application: 'site_manager'\n  translator_deploymentLockPath: '/tmp/translation_lockfile.lock'\n</code></pre>\n\n<p>If I try to access the variables in a task I receive an error message like this:</p>\n\n<blockquote>\n  <p>Exception while executing on host xxxx: undefined local variable or\n  method `translator_deploymentLockPath' for</p>\n  \n  <h1></h1>\n</blockquote>\n\n<p>Here is how a task looks like:</p>\n\n<pre><code>desc \"creates a new lockfile\"\ntask :create_lock do\n   on roles(:app), in: :parallel do\n     execute :touch, \"#{translator_deploymentLockPath}\"\n   end\n end\n</code></pre>\n\n<p>If I declare the variables global (like this: <code>binding.eval(\"$#{k}='#{v}'\")</code> ) I can read them in the tasks using <code>$translator_deploymentLockPath</code> instead of <code>#{translator_deploymentLockPath}</code> but this is not a solution for me because I have a lot of code to modify.</p>\n\n<p>What am I missing? How can I read the variables from hiera (using eyaml backend) and declare them so I can use them in my tasks?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "backgroundworker", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 1069, "user_id": 986711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/8ERmO.jpg?s=128&g=1", "display_name": "MingMan", "link": "https://stackoverflow.com/users/986711/mingman"}, "edited": false, "score": 0, "creation_date": 1513714702, "post_id": 47894314, "comment_id": 82755771, "body": "Seems pretty straightforward but both those options yield 0 results in the loop.  I was just printing the jids instead of deleting.  I know its the same sidekiq instance because all the &#39;new&#39; jobs show up in the logs and the sidekiq queue, but these &#39;old&#39; ones only show up in the logs - not the sidekiq queue"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "reply_to_user": {"reputation": 1069, "user_id": 986711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/8ERmO.jpg?s=128&g=1", "display_name": "MingMan", "link": "https://stackoverflow.com/users/986711/mingman"}, "edited": false, "score": 0, "creation_date": 1513714885, "post_id": 47894314, "comment_id": 82755861, "body": "I can&#39;t remember if the jid changes on retry.  Is there another qualifying job factor you can do for lookup?  maybe something in <code>job.args</code> that you can tell is from an older job?"}, {"owner": {"reputation": 1069, "user_id": 986711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/8ERmO.jpg?s=128&g=1", "display_name": "MingMan", "link": "https://stackoverflow.com/users/986711/mingman"}, "edited": false, "score": 0, "creation_date": 1513715316, "post_id": 47894314, "comment_id": 82756074, "body": "I may have misspoken - there are no items in any queues.  It never hits the delete line (or the puts line in my case). The only thing i can think is that at some point the name of the queue changed, but i looked at my redis instance and dont see any other queue names besides mine (&quot;certificates&quot;)"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "reply_to_user": {"reputation": 1069, "user_id": 986711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/8ERmO.jpg?s=128&g=1", "display_name": "MingMan", "link": "https://stackoverflow.com/users/986711/mingman"}, "edited": false, "score": 0, "creation_date": 1513719758, "post_id": 47894314, "comment_id": 82757977, "body": "shut down your workers and check redis again, what you&#39;re saying doesn&#39;t make sense."}, {"owner": {"reputation": 1069, "user_id": 986711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/8ERmO.jpg?s=128&g=1", "display_name": "MingMan", "link": "https://stackoverflow.com/users/986711/mingman"}, "edited": false, "score": 0, "creation_date": 1513786771, "post_id": 47894314, "comment_id": 82788128, "body": "I restarted all the dynos (workers included) and it didn&#39;t seem to do anything.  Makes no sense to me either that&#39;s why I&#39;m posting this. Cannot figure out where the jobs are hidden.  Not in any Sidekiq queue and not in Redis"}], "tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": false, "score": 1, "last_activity_date": 1513713469, "creation_date": 1513713469, "answer_id": 47894314, "question_id": 47893124, "link": "https://stackoverflow.com/questions/47893124/old-sidekiq-jobs-retry-forever-no-visibility-on-sidekiq-ui/47894314#47894314", "title": "Old Sidekiq jobs retry forever. No visibility on Sidekiq UI", "body": "<p>If you know the <code>jid</code>'s you can do this from a rails console:</p>\n\n<pre><code>queue = Sidekiq::Queue.new(\"my_queue\")\nqueue.each do |job|\n  job.delete if job.jid == 'abcdef1234567890'\nend\n</code></pre>\n\n<p>If it's in the retryset you can do:</p>\n\n<pre><code>query = Sidekiq::RetrySet.new\nquery.each do |job|\n  job.delete if job.jid == 'abcdef1234567890'\nend\n</code></pre>\n\n<p>If you can't delete because the jobs are inflight, stop your worker processes (ie shut 'em down) for a few minutes and then run the above.</p>\n"}], "owner": {"reputation": 1069, "user_id": 986711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/8ERmO.jpg?s=128&g=1", "display_name": "MingMan", "link": "https://stackoverflow.com/users/986711/mingman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1513713469, "creation_date": 1513708156, "last_edit_date": 1513708991, "question_id": 47893124, "link": "https://stackoverflow.com/questions/47893124/old-sidekiq-jobs-retry-forever-no-visibility-on-sidekiq-ui", "title": "Old Sidekiq jobs retry forever. No visibility on Sidekiq UI", "body": "<p>I have made a decent amount of changes to the process of one of my jobs over the last year.  Things like triggering it from <code>after_commit</code> instead of <code>after_create</code> on the respective Model as well as cleaning up the logic and covering corner cases</p>\n\n<p>I see my old jobs from months ago retrying over and over again in my <code>Papertrail</code> logs on my Heroku Ruby on Rails app. The new ones are fine and I believe my changes have fixed any issues.  The problem is how do I stop all those old jobs and why do I not see them on my <code>Sidekiq</code> UI? The Sidekiq UI just shows a number of completed jobs, but 0 failed, dead, busy, or enqueued.  It says 0 yet I see the logs churning away.  </p>\n\n<p>I log the job ID's but have seen that <a href=\"https://github.com/mperham/sidekiq/issues/1459\" rel=\"nofollow noreferrer\" title=\"you cannot kill a specific job\">you cannot kill a specific job</a>.  I have restarted my server multiple times with no luck.  Every day they try again.</p>\n\n<p>I should note that all recent jobs are fine.  Anything within the last month or so do not repeat.  Out of the 5000 objects that had an <code>after_create</code> triggered job, only 1-60 are retrying.  The others passed and are fine</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax"], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1513708564, "post_id": 47893044, "comment_id": 82752960, "body": "Thank you, it works! Silly me, I should have checked my code more carefully."}], "tags": [], "owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "is_accepted": true, "score": 1, "last_activity_date": 1513707816, "creation_date": 1513707816, "answer_id": 47893044, "question_id": 47892806, "link": "https://stackoverflow.com/questions/47892806/rails-5-1-refresh-partial-within-partial-with-ajax/47893044#47893044", "title": "Rails 5.1: refresh partial within partial with AJAX", "body": "<p>In <code>update.js.erb</code>, you have a typo. You should delete the <code>%&gt;</code>. Try this:</p>\n\n<pre><code>$('#userprofile').replaceWith('&lt;%= j render (@user) %&gt;')\n</code></pre>\n\n<p>Also, instead of replacing the entire #userprofile node, you may want to change the html inside of it instead:</p>\n\n<pre><code>$('#userprofile').html('&lt;%= j render (@user) %&gt;')\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 47893044, "answer_count": 1, "score": 0, "last_activity_date": 1513707816, "creation_date": 1513706742, "question_id": 47892806, "link": "https://stackoverflow.com/questions/47892806/rails-5-1-refresh-partial-within-partial-with-ajax", "title": "Rails 5.1: refresh partial within partial with AJAX", "body": "<p>I have partial <code>_navigation.html.erb</code> where there is this piece of code:</p>\n\n<pre><code>&lt;div class=\"dropdown profile-element\"&gt;\n  &lt;a data-toggle=\"dropdown\" class=\"dropdown-toggle\" href=\"#\"&gt;\n    &lt;span class=\"clear\"&gt;\n      &lt;span class=\"block m-t-xs\"&gt;\n        &lt;div id=\"userprofile\"&gt;\n          &lt;%= render 'users/user', user: current_user %&gt;\n        &lt;b class=\"caret\"&gt;&lt;/b&gt;\n      &lt;/div&gt;\n      &lt;/span&gt;\n    &lt;/span&gt;\n  &lt;/a&gt;\n  &lt;ul class=\"dropdown-menu animated fadeInRight m-t-xs\"&gt;\n    &lt;li&gt;&lt;%= link_to t('.profile'), edit_user_path(current_user), remote: true %&gt;&lt;/li&gt;\n    &lt;li class=\"divider\"&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;%= link_to t('.logout'), logout_path %&gt;&lt;/li&gt;\n  &lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I render User name in this <code>_user.html.erb</code> partial:</p>\n\n<pre><code>&lt;strong class=\"font-bold\"&gt;&lt;%= user.name %&gt;&lt;/strong&gt;\n</code></pre>\n\n<p>When I login, I see my <code>current_user</code> name in navigation partial as expected. However when I try to Update my User name (modal window), I don't see my <code>current_user</code> value changes in <code>_user.html.erb</code> partial.</p>\n\n<p>My <code>users_controller.rb</code> Update action looks like this:</p>\n\n<pre><code>  def update\n    @user.update(user_params)\n    respond_to do |format|\n      format.json { update_flash }\n      format.js { update_flash }\n    end\n  end\n\n  private\n\n  def user_params\n    params.require(:user).permit(:name, :email, :password, :password_confirmation,\n                                 :locale, :menu_role, :psw_change,\n                                 {company_ids: []}, {user_group_ids: []})\n  end\n\n  def correct_user\n    users = User.where(id: helpers.users_all)\n    @user = User.find(params[:id])\n    redirect_to(errors_path) unless users.include?(@user)\n  end\n\n  def update_flash\n    flash[:notice] = \"#{@user.name.unicode_normalize(:nfkd)\n                                  .encode('ASCII', replace: '')} \", t(:updated)\n  end\n</code></pre>\n\n<p><code>update.js.erb</code> looks like this:</p>\n\n<pre><code>$('#dialog').modal('toggle');\n$('#userprofile %&gt;').replaceWith('&lt;%= j render (@user) %&gt;')\n</code></pre>\n\n<p>I see clearly in my console Update action is done, my files are rendered, no errors:</p>\n\n<pre><code>  Rendering users/update.js.erb\n  Rendered users/_user.html.erb (0.6ms)\n  Rendered users/update.js.erb (8.5ms)\nCompleted 200 OK in 126ms (Views: 41.1ms | ActiveRecord: 16.0ms)\n</code></pre>\n\n<p>What am I doing wrong here, please? It would be nice to be able to show updated <code>current_user</code> name in profile. I'll be happy for any hint, where should I be looking at. Thank you.</p>\n"}, {"tags": ["ruby", "capistrano", "capistrano3"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1513709890, "post_id": 47892635, "comment_id": 82753540, "body": "<a href=\"https://github.com/capistrano/capistrano/pull/757\" rel=\"nofollow noreferrer\">Possibly related</a> issue."}, {"owner": {"reputation": 3346, "user_id": 832780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uOmJB.jpg?s=128&g=1", "display_name": "hallucinations", "link": "https://stackoverflow.com/users/832780/hallucinations"}, "edited": false, "score": 0, "creation_date": 1513794917, "post_id": 47892635, "comment_id": 82792373, "body": "Are you trying to run a git command in the <code>current</code> directory to know the deployed branch?"}, {"owner": {"reputation": 1, "user_id": 5942017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6ae015d441258803d071acd413e4db?s=128&d=identicon&r=PG&f=1", "display_name": "diwu86", "link": "https://stackoverflow.com/users/5942017/diwu86"}, "edited": false, "score": 0, "creation_date": 1513799077, "post_id": 47892635, "comment_id": 82794321, "body": "Yes, it will say not a git repo. Sometimes we make changes directly in the server, it would be nice to see what has been changed."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5942017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6ae015d441258803d071acd413e4db?s=128&d=identicon&r=PG&f=1", "display_name": "diwu86", "link": "https://stackoverflow.com/users/5942017/diwu86"}, "edited": false, "score": 0, "creation_date": 1515005757, "post_id": 47918127, "comment_id": 83141621, "body": "Thanks for explaining this. We actually want to make the current directory a <code>.git</code> directory. It looks like it&#39;s not possible."}, {"owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "reply_to_user": {"reputation": 1, "user_id": 5942017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6ae015d441258803d071acd413e4db?s=128&d=identicon&r=PG&f=1", "display_name": "diwu86", "link": "https://stackoverflow.com/users/5942017/diwu86"}, "edited": false, "score": 0, "creation_date": 1515008517, "post_id": 47918127, "comment_id": 83142880, "body": "@diwu86 It&#39;s possible if you are willing to write some code. You could redefine the <code>git:create_release</code> task to execute a <code>cp -r</code> instead of <code>git archive</code>. I can provide an answer along those lines if that&#39;s what you&#39;re looking for."}], "tags": [], "owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "is_accepted": false, "score": 1, "last_activity_date": 1513831858, "creation_date": 1513831858, "answer_id": 47918127, "question_id": 47892635, "link": "https://stackoverflow.com/questions/47892635/after-capistrano-deploy-there-is-no-git-repo-in-current-path/47918127#47918127", "title": "After capistrano deploy, there is no git repo in current path", "body": "<p>The <code>current</code> directory is not a git working copy. Capistrano purposely does not include the <code>.git</code> directory.</p>\n\n<p>The actual git repository can be found in the <code>repo</code> directory that is alongside the <code>current</code> directory, but I don't think that is what you are asking for. It sounds like you want to be able to figure out what branch or SHA was used to deploy the contents of <code>current</code>.</p>\n\n<p>Also alongside <code>current</code> should be a file named <code>revisions.log</code>. If you <code>tail</code> it you can see the most recent releases, including the branch, SHA, and user that performed the release:</p>\n\n<pre><code>$ tail -n 3 revisions.log \nBranch master (at 609bf349776b24f85f85b1950b92314b2d8f3bdc) deployed as release 20170927161115 by mbrictson\nBranch master (at 6a77bde58a2de42428b44da669c8f01475d6cd46) deployed as release 20171107004019 by mbrictson\nBranch master (at 6d0395ca4067180e0d76735c36b6852691b360ea) deployed as release 20171107011743 by mbrictson\n</code></pre>\n\n<p>Alternatively, you could write a custom Capistrano task to write the branch to a special file. For example:</p>\n\n<pre><code>desc \"Write the branch to a .branch file in the release that was deployed\"\ntask :write_branch do\n  on release_roles(:all) do\n    within release_path do\n      execute :echo, \"#{fetch(:branch)} &gt; .branch\"\n    end\n  end\nend\n\nafter \"deploy:updating\", \"write_branch\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5942017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6ae015d441258803d071acd413e4db?s=128&d=identicon&r=PG&f=1", "display_name": "diwu86", "link": "https://stackoverflow.com/users/5942017/diwu86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513831858, "creation_date": 1513705999, "question_id": 47892635, "link": "https://stackoverflow.com/questions/47892635/after-capistrano-deploy-there-is-no-git-repo-in-current-path", "title": "After capistrano deploy, there is no git repo in current path", "body": "<p>I am deploying our rack app using capistrano 3. We can deploy branches as we expect. However after deployment, when I login to server in current folder with all the codes, I don't see .git. Even I git init, the next time I deploy, it will get lost again. Is there anyway I can keep .git and track which branch we are deploying? Thanks</p>\n"}, {"tags": ["css", "ruby", "shoes", "green-shoes"], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "is_accepted": false, "score": 0, "last_activity_date": 1513714022, "creation_date": 1513714022, "answer_id": 47894439, "question_id": 47892359, "link": "https://stackoverflow.com/questions/47892359/how-to-align-buttons-in-shoes-gui-toolkit-in-ruby/47894439#47894439", "title": "How to align buttons in Shoes GUI Toolkit in Ruby", "body": "<p>You can use: left, right, top, and bottom. I am not sure about centering, but you can give x,y coordinates in pixels.</p>\n\n<pre><code>stack(left: 35, top: 90) do\n      para \"input here\"\n      button button1\n      @content = edit_line\n end\n</code></pre>\n\n<p>This is also a good walkthrough: <a href=\"http://shoesrb.com/walkthrough/\" rel=\"nofollow noreferrer\">http://shoesrb.com/walkthrough/</a></p>\n"}], "owner": {"reputation": 49, "user_id": 9109203, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6eunn.jpg?s=128&g=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/9109203/qubit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513714022, "creation_date": 1513704813, "question_id": 47892359, "link": "https://stackoverflow.com/questions/47892359/how-to-align-buttons-in-shoes-gui-toolkit-in-ruby", "title": "How to align buttons in Shoes GUI Toolkit in Ruby", "body": "<p>I am creating a GUI application using Shoes toolkit in Ruby, and using <code>require 'green_shoes'</code> gem.</p>\n\n<p>project is in progress but i had a problem to align buttons to center\ndoes anyone know about how to?\ni have an example code:</p>\n\n<pre><code>Shoes.app width:500, height: 400 do\n     stack do\n          para \"input here\"\n          button button1\n          @content = edit_line\n     end\nend\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "axlsx", "rubyxl"], "comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1513730490, "post_id": 47891428, "comment_id": 82761267, "body": "Please <a href=\"https://stackoverflow.com/posts/47891428/edit\">edit</a> your question to share the code you are referring to. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 184, "user_id": 3438158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c82a1bbc325f75c273118ad99c45bcd3?s=128&d=identicon&r=PG&f=1", "display_name": "intmarinoreturn0", "link": "https://stackoverflow.com/users/3438158/intmarinoreturn0"}, "edited": false, "score": 0, "creation_date": 1515509797, "post_id": 47891428, "comment_id": 83321074, "body": "did you have any progress? I&#39;m trying to use the cell validations of one sheet with a domain inside another sheet, but no idea"}], "owner": {"reputation": 11, "user_id": 9119070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504b73fa4fb029f77eec76a74cfc364c?s=128&d=identicon&r=PG&f=1", "display_name": "McNels Sylvestre", "link": "https://stackoverflow.com/users/9119070/mcnels-sylvestre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513701664, "creation_date": 1513701664, "question_id": 47891428, "link": "https://stackoverflow.com/questions/47891428/how-to-add-content-to-a-worksheet-by-referencing-its-name-in-ruby-using-axlsx-ge", "title": "How to add content to a worksheet by referencing its name in ruby using axlsx gem?", "body": "<p>I have created a workbook with multiple worksheets using axlsx. I've also given names to each of the worksheets. Now, <strong>I want to add content to one of the existing worksheets. Is there any way to reference the worksheet I want to add content to?</strong> That would be the easiest way. </p>\n\n<p>I've also read that somewhere that you could use another gem to read the excel file then modify it. Does it have to be one with read/write capabilities like rubyXL or can I use one gem to read and then use axlsx again to write on it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 7, "creation_date": 1513699007, "post_id": 47890598, "comment_id": 82747692, "body": "This question will probably get some traffic, as more and more developers ponder this. +1 for usefulness, -1.5 for presentation. Please spend some time and make it good quality. (formatting, grammar, punctuation, some additional info, etc.). This can be an exemplary reference question."}], "answers": [{"comments": [{"owner": {"reputation": 467, "user_id": 6003939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9fP_gxi1pEA/AAAAAAAAAAI/AAAAAAAAAC4/L9NDDYQE22s/photo.jpg?sz=128", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/6003939/vivek-singh"}, "edited": false, "score": 1, "creation_date": 1513757492, "post_id": 47890832, "comment_id": 82769433, "body": "Thanks for your explanation @mikej"}], "tags": [], "owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "is_accepted": true, "score": 45, "last_activity_date": 1597223146, "last_edit_date": 1597223146, "creation_date": 1513699492, "answer_id": 47890832, "question_id": 47890598, "link": "https://stackoverflow.com/questions/47890598/difference-between-kernelyield-self-yieldself-and-objecttap-in-ruby/47890832#47890832", "title": "Difference between Kernel#yield_self, yield(self) and Object#tap in ruby", "body": "<p>The difference between <a href=\"https://rubyapi.org/2.7/o/object#method-i-tap\" rel=\"nofollow noreferrer\"><code>tap</code></a> and <a href=\"https://rubyapi.org/2.7/o/object#method-i-yield_self\" rel=\"nofollow noreferrer\"><code>yield_self</code></a> is in what is returned by each of the two methods.</p>\n<p><code>Object#tap</code> yields self to the block <em>and then returns self</em>. <code>Kernel#yield_self</code> yields self to the block and then <em>returns the result of the block</em>.</p>\n<p>Here are some examples of where each can be useful:</p>\n<h2>tap</h2>\n<p>Replacing the need for a <code>result</code> line at the end of a method:</p>\n<pre><code>def my_method\n  result = get_some_result\n  call_some_method_with result\n  result\nend\n</code></pre>\n<p>can be written as:</p>\n<pre><code>def my_method\n  get_some_result.tap do |result|\n    call_some_method_with result\n  end\nend\n</code></pre>\n<p>Another example is initialisation of some object that takes several steps:</p>\n<pre><code>some_object = SomeClass.new.tap do |obj|\n  obj.field1 = some_value\n  obj.field2 = other_value\nend   \n</code></pre>\n<h2>yield_self and yield(self)</h2>\n<p>If used inside one of your own methods <code>yield_self</code> would have the same effect as <code>yield(self)</code>. However, by having it as a method in its own right this promotes method chaining as an alternative to nested function calls.</p>\n<p><a href=\"https://mlomnicki.com/yield-self-in-ruby-25/\" rel=\"nofollow noreferrer\">This blog post</a> by Micha\u0142 \u0141omnicki has some helpful examples. e.g. this code:</p>\n<pre><code>CSV.parse(File.read(File.expand_path(&quot;data.csv&quot;), __dir__))\n   .map { |row| row[1].to_i }\n   .sum\n</code></pre>\n<p>can be rewritten as:</p>\n<pre><code>&quot;data.csv&quot;\n  .yield_self { |name| File.expand_path(name, __dir__) }\n  .yield_self { |path| File.read(path) }\n  .yield_self { |body| CSV.parse(body) }\n  .map        { |row|  row[1].to_i }\n  .sum\n</code></pre>\n<p>This can aid with clarity where nested calls are being used for a series of transformations on some data. Similar features exist in other programming languages. The <a href=\"https://elixir-lang.github.io/getting-started/enumerables-and-streams.html#the-pipe-operator\" rel=\"nofollow noreferrer\">pipe operator in Elixir</a> is a good one to take a look at,</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1513705787, "post_id": 47891505, "comment_id": 82751611, "body": "That reference is helpful, but a link in a comment would be sufficient and appropriate."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1513705933, "post_id": 47891505, "comment_id": 82751688, "body": "Cheers @CarySwoveland, I did think that, though the number of times I&#39;ve followed a dead link meant me think it might be handy to be able to refer to this directly. As said, happy to remove if the consensus is for that."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1513758392, "post_id": 47891505, "comment_id": 82769891, "body": "I&#39;d want this to stay. @SRack: you <a href=\"https://meta.stackexchange.com/questions/11740/what-are-community-wiki-posts\">could transform this answer into a community wiki</a>, so that you don&#39;t benefit from the upvotes on the content you didn&#39;t produce :)"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1513764100, "post_id": 47891505, "comment_id": 82773268, "body": "Good idea @SergioTulentsev - didn&#39;t know of that option. I&#39;ve switched it over now. Thanks for the advice!"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 8, "last_activity_date": 1528824108, "last_edit_date": 1528824108, "creation_date": 1513701884, "answer_id": 47891505, "question_id": 47890598, "link": "https://stackoverflow.com/questions/47890598/difference-between-kernelyield-self-yieldself-and-objecttap-in-ruby/47891505#47891505", "title": "Difference between Kernel#yield_self, yield(self) and Object#tap in ruby", "body": "<p>Great summary of this here: <a href=\"https://blog.bigbinary.com/2017/12/12/ruby-2-5-added-yield_self.html\" rel=\"noreferrer\">Ruby 2.5 added yield_self</a>.</p>\n\n<p>Quick update: <code>yield_self</code> will have an alias <code>then</code> in new versions of Ruby, following requests from the community for this to be more readable.</p>\n\n<p>It's a very good, concise read, quoted below for posterity. All credit to the original author, Vijay Kumar Agrawal:</p>\n\n<blockquote>\n  <p>Ruby 2.5 added a new method named yield_self. It yields the receiver\n  to the given block and returns output of the last statement in the\n  block.</p>\n\n<pre><code>irb&gt; \"Hello\".yield_self { |str| str + \" World\" }\n  =&gt; \"Hello World\"\n</code></pre>\n  \n  <p><strong>How is it different from try in Rails ?</strong> </p>\n  \n  <p>Without a method argument try\n  behaves similar to yield_self. It would yield to the given block\n  unless the receiver is nil and returns the output of the last\n  statement in the block.</p>\n\n<pre><code>irb&gt; \"Hello\".try { |str| str + \" World\" }\n  =&gt; \"Hello World\"\n</code></pre>\n  \n  <p>Couple of differences to note are, try is not part of Ruby but Rails.\n  Also try\u2019s main purpose is protection against nil hence it doesn\u2019t\n  execute the block if receiver is nil.</p>\n\n<pre><code>irb&gt; nil.yield_self { |obj| \"Hello World\" }\n  =&gt; \"Hello World\"\n\nirb&gt; nil.try { |obj| \"Hello World\" }\n  =&gt; nil\n</code></pre>\n  \n  <p><strong>What about tap?</strong></p>\n  \n  <p>tap also is similar to yield_self. It\u2019s part of Ruby\n  itself. The only difference is the value that is returned. tap returns\n  the receiver itself while yield_self returns the output of the block.</p>\n\n<pre><code>irb&gt; \"Hello\".yield_self { |str| str + \" World\" }\n  =&gt; \"Hello World\"\n\nirb&gt; \"Hello\".tap { |str| str + \" World\" }\n  =&gt; \"Hello\"\n</code></pre>\n  \n  <p>Overall, yield_self improves readability of the code by promoting\n  chaining over nested function calls. Here is an example of both the\n  styles.</p>\n\n<pre><code>irb&gt; add_greeting = -&gt; (str) { \"HELLO \" + str }\nirb&gt; to_upper = -&gt; (str) { str.upcase }\n\n# with new `yield_self`\nirb&gt; \"world\".yield_self(&amp;to_upper)\n            .yield_self(&amp;add_greeting)\n  =&gt; \"HELLO WORLD\"\n\n# nested function calls\nirb&gt; add_greeting.call(to_upper.call(\"world\"))\n  =&gt; \"HELLO WORLD\"\n</code></pre>\n  \n  <p>yield_self is part of Kernel and hence it\u2019s available to all the\n  objects.</p>\n</blockquote>\n\n<p>Please don't accept this as the answer, as it's not my own handiwork (and I'm happy to delete if anyone has any objections) - but I found this a very good read and thought it might help others at some point.</p>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 3, "last_activity_date": 1513739375, "creation_date": 1513739375, "answer_id": 47898238, "question_id": 47890598, "link": "https://stackoverflow.com/questions/47890598/difference-between-kernelyield-self-yieldself-and-objecttap-in-ruby/47898238#47898238", "title": "Difference between Kernel#yield_self, yield(self) and Object#tap in ruby", "body": "<p>I would like to add to mikej's answer on <strong>parallelism between <code>each</code> vs. <code>map</code> and <code>tap</code> vs. <code>yield_self</code></strong>.</p>\n\n<p>There are many question asking the difference between <code>each</code> and <code>map</code> for enumerables. The former is used for doing something with a side effect or something destructive, and then returning the receiver, which is handy for chaining methods. The latter returns the evaluated value in place of each element in the receiver.</p>\n\n<p><code>tap</code> vs. <code>yield_self</code> is just like this; the difference is that they are done for a single receiver object instead of elements within an enumerable receiver. So their use case would parallel what I wrote above. The former is used for doing something with a side effect or something destructive, and then returning the receiver, which is handy for chaining methods. The latter returns the evaluated value instead of the receiver.</p>\n"}], "owner": {"reputation": 467, "user_id": 6003939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9fP_gxi1pEA/AAAAAAAAAAI/AAAAAAAAAC4/L9NDDYQE22s/photo.jpg?sz=128", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/6003939/vivek-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3946, "favorite_count": 1, "accepted_answer_id": 47890832, "answer_count": 3, "score": 23, "last_activity_date": 1597223146, "creation_date": 1513698675, "last_edit_date": 1513781697, "question_id": 47890598, "link": "https://stackoverflow.com/questions/47890598/difference-between-kernelyield-self-yieldself-and-objecttap-in-ruby", "title": "Difference between Kernel#yield_self, yield(self) and Object#tap in ruby", "body": "<p>Ruby 2.5.0-rc1 has been released and introduces a new <code>Kernel#yield_self</code> method.</p>\n\n<p>What is the difference between <code>yield_self</code>, <code>yield(self)</code> and the existing <code>Object#tap</code> method?</p>\n"}, {"tags": ["mysql", "ruby", "database"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1513706330, "post_id": 47890589, "comment_id": 82751871, "body": "Ideally you&#39;d use a database layer like <a href=\"http://sequel.jeremyevans.net\" rel=\"nofollow noreferrer\">Sequel</a> at the absolute least. The <code>mysql2</code> driver is pretty feeble. This code won&#39;t produce output unless you have tables defined in that database."}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "is_accepted": true, "score": 1, "last_activity_date": 1513715471, "last_edit_date": 1513715471, "creation_date": 1513714953, "answer_id": 47894628, "question_id": 47890589, "link": "https://stackoverflow.com/questions/47890589/how-to-use-mysql-with-ruby/47894628#47894628", "title": "How to use MySql with ruby", "body": "<p>You need to adjust the query. This query works for me.</p>\n\n<p><code>client.query(\"SHOW TABLES FROM DB\")</code> DB being your database.</p>\n\n<p>In your connection string you are specifying a database to connect to, so I don't believe you will be able to run <code>SHOW DATABASES</code>. Try removing the DB from the connection string.</p>\n"}], "owner": {"reputation": 49, "user_id": 9109203, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6eunn.jpg?s=128&g=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/9109203/qubit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 47894628, "answer_count": 1, "score": 1, "last_activity_date": 1513715471, "creation_date": 1513698645, "last_edit_date": 1513703702, "question_id": 47890589, "link": "https://stackoverflow.com/questions/47890589/how-to-use-mysql-with-ruby", "title": "How to use MySql with ruby", "body": "<p>I have learned MySql in my school, but on CMD Prompt. Since i want to use that knowledge and want to create a GUI program in ruby (NOT A RUBY-ON-RAILS PROJECT) which use MySql commands like:</p>\n\n<p><code>SHOW DATABASES;</code>\n<code>USE DATABASE ruby;</code>\n<code>SELECT * FROM TABLE staff;</code>\n<code>CREATE TABLE STUDENT(Rollno integer, Class integer);</code>\n<code>INSERT INTO STUDENT VALUES(32, 12);</code>\n<code>SHOW TABLES;</code>\n<code>DROP TABLE STUDENT;</code>\netc. and etc...</p>\n\n<p>but i am unable to find about that,\ni have found mysql2 gemfile but it doesn't supports the command in my code, in</p>\n\n<pre><code>require 'mysql2'\n\nclient = Mysql2::Client.new(hostname: 'localhost', username: 'root', password: '1234', database: 'ruby')\n\nlist = client.query(\"SHOW TABLES\")\nlist.each do |item|\n    puts item\nend\n</code></pre>\n\n<blockquote>\n  <p>No output and I'm just frustrated</p>\n</blockquote>\n\n<p>Please give Suggestions</p>\n\n<p><strong>WITH THE CONTIBUTION OF @URSUS, WE HAVE SOLVED THIS, WE RECHECKED THE <code>MySql GEMFILE</code> AND RECHECK THE <code>Table in Database</code> AND USE <code>irb</code></strong></p>\n\n<p>look over at this link: <a href=\"https://drive.google.com/open?id=19YUhmcLeMJn9aNEjM0bQNjpHIWrPZ0RX\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=19YUhmcLeMJn9aNEjM0bQNjpHIWrPZ0RX</a></p>\n"}, {"tags": ["arrays", "ruby", "loops", "split"], "comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1513697443, "post_id": 47890136, "comment_id": 82746717, "body": "show us your try"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1513697770, "post_id": 47890136, "comment_id": 82746932, "body": "Without an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> it kinda seems like you&#39;re asking the community to do your work for you..."}, {"owner": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513697923, "post_id": 47890136, "comment_id": 82747023, "body": "i have added my code attempt"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1513698074, "post_id": 47890136, "comment_id": 82747141, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47870588/how-to-read-text-from-file-into-an-array-in-ruby\">How to read text from file into an array in ruby</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513698705, "post_id": 47890533, "comment_id": 82747535, "body": "Thank you for answering! I am very to ruby as well as computer science in general. Sorry if the question was unclear."}, {"owner": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513699100, "post_id": 47890533, "comment_id": 82747749, "body": "I must be doing something wrong. This is what i did:                       <code>HOST = Array.new[0] USER = Array.new[0] PASS = Array.new[0]  file = File.open(&quot;HOST_USER_PASS.txt&quot;, &#39;r&#39;) line = file.readline HOST, USER, PASS = line.split(&quot; &quot;).map { |fields| fields.split(&quot;,&quot;) }</code>       how do i format this?"}, {"owner": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513699312, "post_id": 47890533, "comment_id": 82747894, "body": "file_array:8: warning: already initialized constant HOST file_array:2: warning: previous definition of HOST was here file_array:8: warning: already initialized constant USER file_array:3: warning: previous definition of USER was here file_array:8: warning: already initialized constant PASS file_array:4: warning: previous definition of PASS was here i get these  errors"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513699526, "post_id": 47890533, "comment_id": 82748008, "body": "I updated my answer with the rest of your script. you should now use variables <code>one</code>, <code>two</code> and <code>three</code>. have you tried?"}, {"owner": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513699638, "post_id": 47890533, "comment_id": 82748066, "body": "i tried wrong(see jargon above, is there a way to format code in comments?) haha. let me try this now."}, {"owner": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513700491, "post_id": 47890533, "comment_id": 82748558, "body": "i keep getting an issue: warning: already initialized constant PASS file_array:4                                                                                                                  my array is simply HOST = Array.new(3)"}, {"owner": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513700811, "post_id": 47890533, "comment_id": 82748744, "body": "I&#39; going to talk to my mentor for the array part. Thanks you for all the help i will up vote and mark as correct. As your answer is working, but my logic around it is not. Thanks again for working with me! :)"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513700930, "post_id": 47890533, "comment_id": 82748808, "body": "don&#39;t worry. I&#39;d help you more but I&#39;m not sure I actually got your file structure and everything else about ssh and those variables that I don&#39;t see in your code. keep up :)"}, {"owner": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513708324, "post_id": 47890533, "comment_id": 82752858, "body": "Is there a way I could dm you? I have moved what your answer into a separate file. the only change is the definition of the arrays above your code block. All of which have the same formatting. HOST = Array.new(2)"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513708617, "post_id": 47890533, "comment_id": 82752977, "body": "Leave me some contact"}, {"owner": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "edited": false, "score": 0, "creation_date": 1513708750, "post_id": 47890533, "comment_id": 82753039, "body": "vi11agio.creeyt@gmail.com"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 0, "last_activity_date": 1513699455, "last_edit_date": 1513699455, "creation_date": 1513698431, "answer_id": 47890533, "question_id": 47890136, "link": "https://stackoverflow.com/questions/47890136/how-to-read-one-file-into-multiple-arrays-in-ruby/47890533#47890533", "title": "How to read one file into multiple arrays in ruby", "body": "<p>If I got it correctly, your triplets are space separated. Try this one</p>\n\n<pre><code>file = File.open(\"HOST_USER_PASS.txt\", 'r') \nwhile !file.eof?\n  line = file.readline\n  one, two, three = line.split(\" \").map { |fields| fields.split(\",\") }\n  # use one, two and three\n  # each of these variable is an array with host, user and password\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8901363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fff93045d3f771eeb14e81b41efe0d3?s=128&d=identicon&r=PG&f=1", "display_name": "CreeFC", "link": "https://stackoverflow.com/users/8901363/creefc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 47890533, "answer_count": 1, "score": -3, "last_activity_date": 1513699455, "creation_date": 1513697078, "last_edit_date": 1513697901, "question_id": 47890136, "link": "https://stackoverflow.com/questions/47890136/how-to-read-one-file-into-multiple-arrays-in-ruby", "title": "How to read one file into multiple arrays in ruby", "body": "<p>I am currently using the ruby ssh gem where i have three variables HOST, USER, and PASS. I have a file (HOST_USER_PASS.txt) formatted like so:\nHOST,USER,PASS\nHOST,USER,PASS</p>\n\n<p>I want to read these into an array and then use those variables within the gem. I am currently using split with a while loop but nothing is working so far.</p>\n\n<pre><code>file = File.open(\"HOST_USER_PASS.txt\", 'r') \n# Open file\"HOST_USER_PASS.txt\", read that file\nwhile !file.eof? #run while end of file is not true\n      line = file.readline\n      fields = line.split(\",\") #splits line at the comma\nssh gem etc.\nend\n</code></pre>\n\n<p>SO the question is, how can i read a file into three separate arrays?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "postgresql"], "answers": [{"tags": [], "owner": {"reputation": 3299, "user_id": 1749638, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cERvr.jpg?s=128&g=1", "display_name": "coderhs", "link": "https://stackoverflow.com/users/1749638/coderhs"}, "is_accepted": true, "score": 0, "last_activity_date": 1513699058, "creation_date": 1513699058, "answer_id": 47890708, "question_id": 47888572, "link": "https://stackoverflow.com/questions/47888572/generate-json-file-from-postgres-in-ruby/47890708#47890708", "title": "generate json file from Postgres in ruby", "body": "<p>What you need to do is execute the query and then write it on to a file.</p>\n\n<pre><code>require 'pg'\n\nconn = PGconn.connect(\"host\", 5432, '', '', \"d6kabu5l22jugs\", \"cgcscdqtkpesow\", \"5fe2bc97a\")\n\nres  = conn.exec(\"\nSELECT array_to_json(array_agg(a)) as response FROM (select * from applications) a\")\n</code></pre>\n\n<p>once you got the result you write it to a file.</p>\n\n<pre><code>File.open(\"dump.json\",\"w\") do |f|\n  f.write(res.first['response'])\nend\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8901451, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4677509aa264f14c33276033a9f0a5f3?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/8901451/majid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 47890708, "answer_count": 1, "score": -2, "last_activity_date": 1513699058, "creation_date": 1513691799, "question_id": 47888572, "link": "https://stackoverflow.com/questions/47888572/generate-json-file-from-postgres-in-ruby", "title": "generate json file from Postgres in ruby", "body": "<p>I am trying when I run a ruby file to generate a json file, the script is working but it just display the json on the terminal, I don't know to to create a file from it, here is what I did :</p>\n\n<pre><code>  require 'pg'\n\nconn = PGconn.connect(\"host\", 5432, '', '', \"d6kabu5l22jugs\", \"cgcscdqtkpesow\", \"5fe2bc97a\")\n\nres  = conn.exec('select * FROM applicants')\nSELECT array_to_json(array_agg(applicants)) FROM applicants;\n</code></pre>\n\n<p>Thanks, </p>\n"}, {"tags": ["ruby", "shell"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1513691054, "post_id": 47887920, "comment_id": 82742571, "body": "Not sure if this is what you want. But to change a directory use <code>Dir.chdir(&#39;&#47;home&#39;)</code> etc."}, {"owner": {"reputation": 187, "user_id": 7984046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f645b5127876c52253749a43190283f?s=128&d=identicon&r=PG&f=1", "display_name": "H.WZ", "link": "https://stackoverflow.com/users/7984046/h-wz"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1513691708, "post_id": 47887920, "comment_id": 82742971, "body": "In the same way\uff0cIt is only change the sub shell&#39;s dir."}, {"owner": {"reputation": 205702, "user_id": 7552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b60298053f87465641c1b1192338c8cd?s=128&d=identicon&r=PG", "display_name": "glenn jackman", "link": "https://stackoverflow.com/users/7552/glenn-jackman"}, "edited": false, "score": 0, "creation_date": 1513699051, "post_id": 47887920, "comment_id": 82747716, "body": "A child process can not alter the environment of the parent. You will have to have the child process print out commands that the parent shell can <code>source</code>/<code>eval</code> -&gt; <code>bash$ source &quot;$(&#47;path&#47;to&#47;change_dir_script.rb)&quot;</code> and the ruby script does <code>puts &quot;cd #{ENV[&#39;HOME&#39;]}&#47;Desktop&#47;workDir&quot;</code>"}, {"owner": {"reputation": 187, "user_id": 7984046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f645b5127876c52253749a43190283f?s=128&d=identicon&r=PG&f=1", "display_name": "H.WZ", "link": "https://stackoverflow.com/users/7984046/h-wz"}, "edited": false, "score": 0, "creation_date": 1513733041, "post_id": 47887920, "comment_id": 82761923, "body": "Thanks for your answer first, It seems as if there is no way to do this by ruby code."}], "owner": {"reputation": 187, "user_id": 7984046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f645b5127876c52253749a43190283f?s=128&d=identicon&r=PG&f=1", "display_name": "H.WZ", "link": "https://stackoverflow.com/users/7984046/h-wz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1513689503, "creation_date": 1513689503, "question_id": 47887920, "link": "https://stackoverflow.com/questions/47887920/how-to-change-the-bash-shell-working-directory-by-the-ruby", "title": "How to change the bash shell working directory by the ruby?", "body": "<p>When we run this ruby code:</p>\n\n<p><code>IO.popen('cd ~/Desktop/workDir')\n</code></p>\n\n<p>It will create sub shell to run this cmd, and the working directory will changed in the sub shell,but the parent shell.</p>\n\n<p>So, If I want to change the parentShell's working directory by ruby, how can I do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1513703244, "post_id": 47887399, "comment_id": 82750251, "body": "I believe &quot;xyz&quot; should be &quot;pqr&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1513688052, "creation_date": 1513688052, "answer_id": 47887532, "question_id": 47887399, "link": "https://stackoverflow.com/questions/47887399/need-nested-loop-to-print-values-from-two-array-in-ruby/47887532#47887532", "title": "Need nested loop to print values from two array in ruby", "body": "<pre><code>\u25b6 result = ids.zip(iq).\n\u25b7   flat_map do |ip, name|\n\u25b7     [\"New #{ip}\", \"Connect #{name} :: #{ip}\"]\n\u25b7   end.partition { |s| s.start_with? 'New' }.flatten\n#\u21d2 [\n#  [0] \"New 10.12.14\",\n#  [1] \"New 10.12.15\",\n#  [2] \"Connect abc :: 10.12.14\",\n#  [3] \"Connect pqr :: 10.12.15\"\n# ]\n\n\u25b6 result.each(&amp;method(:puts))\nNew 10.12.14\nNew 10.12.15\nConnect abc :: 10.12.14\nConnect pqr :: 10.12.15\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 7497632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034a3a170972c07cb03d5f9564911dc6?s=128&d=identicon&r=PG&f=1", "display_name": "jon1467", "link": "https://stackoverflow.com/users/7497632/jon1467"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513688417, "post_id": 47887542, "comment_id": 82740871, "body": "@mudasobwa Thanks for spotting that, been working with js too much recently."}], "tags": [], "owner": {"reputation": 89, "user_id": 7497632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034a3a170972c07cb03d5f9564911dc6?s=128&d=identicon&r=PG&f=1", "display_name": "jon1467", "link": "https://stackoverflow.com/users/7497632/jon1467"}, "is_accepted": false, "score": 0, "last_activity_date": 1513694218, "last_edit_date": 1513694218, "creation_date": 1513688096, "answer_id": 47887542, "question_id": 47887399, "link": "https://stackoverflow.com/questions/47887399/need-nested-loop-to-print-values-from-two-array-in-ruby/47887542#47887542", "title": "Need nested loop to print values from two array in ruby", "body": "<p>If you can rely on the two kinds of data being connected (ie 10.12.14 > \"abc\"), then you could structure the data better before processing to make this easier:</p>\n\n<pre><code>h = [{\n      target: \"10.12.14\",\n      node: \"abc\"\n    },\n    {\n      target: \"10.12.15\",\n      node: \"xyz\"\n    }]\n</code></pre>\n\n<p>Following this, you'll need to loop once exclusively for the target addresses (array a) to get the first two lines, and then a second time for the combined information lines, which would look something like this:</p>\n\n<pre><code>for o in h\n  puts \"New-IscsiTargetPortal -TargetPortalAddress #{o[:target]}\"     \nend\n\nfor o in h\n  puts \"Connect-IscsiTarget -NodeAddress #{o[:node]} -TargetPortalAddress #{i[:target]} -IsPersistent $True\"\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 9082786, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1faa8c4bf5ad32c93b92e5ee4e0e8fe2?s=128&d=identicon&r=PG&f=1", "display_name": "Akash Sarpate", "link": "https://stackoverflow.com/users/9082786/akash-sarpate"}, "edited": false, "score": 0, "creation_date": 1513690338, "post_id": 47887674, "comment_id": 82742134, "body": "Thanks for help, this is helpful"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 2, "last_activity_date": 1513688578, "creation_date": 1513688578, "answer_id": 47887674, "question_id": 47887399, "link": "https://stackoverflow.com/questions/47887399/need-nested-loop-to-print-values-from-two-array-in-ruby/47887674#47887674", "title": "Need nested loop to print values from two array in ruby", "body": "<p>For the first part, you can just iterate <code>ids</code>:</p>\n\n<pre><code>ids.each do |i|\n  puts \"New-IscsiTargetPortal -TargetPortalAddress #{i}\"\nend\n</code></pre>\n\n<p>For the second part, you can combine <code>ids</code> and <code>iq</code> pair-wise using <a href=\"http://ruby-doc.org/core-2.4.2/Array.html#method-i-zip\" rel=\"nofollow noreferrer\"><code>Array#zip</code></a>:</p>\n\n<pre><code>ids.zip(iq) do |i, j|\n  puts \"Connect-IscsiTarget -NodeAddress #{j} -TargetPortalAddress #{i} -IsPersistent $True\"\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>New-IscsiTargetPortal -TargetPortalAddress 10.12.14\nNew-IscsiTargetPortal -TargetPortalAddress 10.12.15\nConnect-IscsiTarget -NodeAddress abc -TargetPortalAddress 10.12.14 -IsPersistent $True\nConnect-IscsiTarget -NodeAddress pqr -TargetPortalAddress 10.12.15 -IsPersistent $True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1513691934, "creation_date": 1513691934, "answer_id": 47888606, "question_id": 47887399, "link": "https://stackoverflow.com/questions/47887399/need-nested-loop-to-print-values-from-two-array-in-ruby/47888606#47888606", "title": "Need nested loop to print values from two array in ruby", "body": "<p>Use <code>each_with_index</code> and use the index of the first array to determine which element to retrieve on the second array.</p>\n\n<pre><code>ids.each_with_index do |id, index|\n    puts \"New-IscsiTargetPortal -TargetPortalAddress #{id}\"\n    puts \"Connect-IscsiTarget -NodeAddress #{iq[index]} -TargetPortalAddress #{id} -IsPersistent $True\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9082786, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1faa8c4bf5ad32c93b92e5ee4e0e8fe2?s=128&d=identicon&r=PG&f=1", "display_name": "Akash Sarpate", "link": "https://stackoverflow.com/users/9082786/akash-sarpate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 47887674, "answer_count": 4, "score": 1, "last_activity_date": 1513694218, "creation_date": 1513687559, "last_edit_date": 1513689841, "question_id": 47887399, "link": "https://stackoverflow.com/questions/47887399/need-nested-loop-to-print-values-from-two-array-in-ruby", "title": "Need nested loop to print values from two array in ruby", "body": "<p>I have two arrays</p>\n\n<pre><code>ids = [\"10.12.14\",\"10.12.15\"]\niq = [\"abc\",\"pqr\"]\n</code></pre>\n\n<p>I want o/p in below format</p>\n\n<pre><code>New-IscsiTargetPortal -TargetPortalAddress 10.12.14\nNew-IscsiTargetPortal -TargetPortalAddress 10.12.15\nConnect-IscsiTarget -NodeAddress abc -TargetPortalAddress 10.12.14 -IsPersistent $True\nConnect-IscsiTarget -NodeAddress xyz -TargetPortalAddress 10.12.15 -IsPersistent $True\n</code></pre>\n\n<p>My code looks like </p>\n\n<pre><code>for i in ids\n  for j in iq\n    puts \"New-IscsiTargetPortal -TargetPortalAddress #{i}\"\n    puts \"Connect-IscsiTarget -NodeAddress #{j} -TargetPortalAddress #{i} -IsPersistent $True\"\n  end\nend\n</code></pre>\n\n<p>But it is duplicating values for i and j:</p>\n\n<pre><code>New-IscsiTargetPortal -TargetPortalAddress 10.12.14\nConnect-IscsiTarget -NodeAddress abc -TargetPortalAddress 10.12.14 -IsPersistent $True\nNew-IscsiTargetPortal -TargetPortalAddress 10.12.14\nConnect-IscsiTarget -NodeAddress pqr -TargetPortalAddress 10.12.14 -IsPersistent $True\nNew-IscsiTargetPortal -TargetPortalAddress 10.12.15\nConnect-IscsiTarget -NodeAddress abc -TargetPortalAddress 10.12.15 -IsPersistent $True\nNew-IscsiTargetPortal -TargetPortalAddress 10.12.15\nConnect-IscsiTarget -NodeAddress pqr -TargetPortalAddress 10.12.15 -IsPersistent $True\n</code></pre>\n\n<p>Can you please help me in nested for loop or how i can get desired o/p?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "session", "database-concurrency"], "answers": [{"tags": [], "owner": {"reputation": 523, "user_id": 2817111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99961f704b8fb737c723a0b403887949?s=128&d=identicon&r=PG", "display_name": "mikwat", "link": "https://stackoverflow.com/users/2817111/mikwat"}, "is_accepted": false, "score": 0, "last_activity_date": 1513732910, "creation_date": 1513732910, "answer_id": 47897534, "question_id": 47886584, "link": "https://stackoverflow.com/questions/47886584/concurrent-database-session-store/47897534#47897534", "title": "Concurrent database session store", "body": "<p>There are many ways to solve this, but I would just store the cart in your database on a per-user basis. This way when the user has multiple active sessions they will see the same cart.</p>\n"}], "owner": {"reputation": 111, "user_id": 9117908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9e9cb8daf69aa50d4c6c51a7e27b761?s=128&d=identicon&r=PG&f=1", "display_name": "Lalit", "link": "https://stackoverflow.com/users/9117908/lalit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513732910, "creation_date": 1513684953, "question_id": 47886584, "link": "https://stackoverflow.com/questions/47886584/concurrent-database-session-store", "title": "Concurrent database session store", "body": "<p>How does amazon maintain the session between devices while adding the products to the cart?</p>\n\n<p>How can we implement that in ROR?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "postgresql", "select"], "comments": [{"owner": {"reputation": 1357, "user_id": 6229122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tQUnBjPGP9o/AAAAAAAAAAI/AAAAAAAACww/wJS82aCB06E/photo.jpg?sz=128", "display_name": "Alex Suslyakov", "link": "https://stackoverflow.com/users/6229122/alex-suslyakov"}, "edited": false, "score": 0, "creation_date": 1513698200, "post_id": 47886224, "comment_id": 82747240, "body": "I&#39;ve found a very similar question. And there is an answer that looks quite working <a href=\"https://stackoverflow.com/a/11512925/6229122\">stackoverflow.com/a/11512925/6229122</a>. Isn&#39;t it?"}, {"owner": {"reputation": 86, "user_id": 4180908, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1842f4a802c597380bc979f8f6541b54?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Shankar", "link": "https://stackoverflow.com/users/4180908/hari-shankar"}, "edited": false, "score": 0, "creation_date": 1513704577, "post_id": 47886224, "comment_id": 82751043, "body": "If you only trouble is pagination in solution 3, you can look at Kaminari gem.    <code>Kaminari.paginate_array(array_to_paginate).page(page_num).pe&zwnj;&#8203;r(per_page)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1135, "user_id": 251045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jgiVA.png?s=128&g=1", "display_name": "lightalloy", "link": "https://stackoverflow.com/users/251045/lightalloy"}, "edited": false, "score": 1, "creation_date": 1513684850, "post_id": 47886443, "comment_id": 82738696, "body": "That&#39;s a link to an ancient guide. <code>all</code> with arguments won&#39;t work in newer versions. I would suggest: <code>Recipe.joins(:ingredients).where(ingredients: { id: search_array })</code>"}, {"owner": {"reputation": 816, "user_id": 4235383, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh3.googleusercontent.com/-Ewhs105HKKY/AAAAAAAAAAI/AAAAAAAAPds/x3YyZQpYIWg/photo.jpg?sz=128", "display_name": "Rob Hughes", "link": "https://stackoverflow.com/users/4235383/rob-hughes"}, "edited": false, "score": 1, "creation_date": 1513685438, "post_id": 47886443, "comment_id": 82739040, "body": "Unfortunatly, this is like my Eg 1. As long as the Recipe ingredients contain ANY one of the searched ids, the result will show."}, {"owner": {"reputation": 89, "user_id": 7497632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034a3a170972c07cb03d5f9564911dc6?s=128&d=identicon&r=PG&f=1", "display_name": "jon1467", "link": "https://stackoverflow.com/users/7497632/jon1467"}, "edited": false, "score": 0, "creation_date": 1513686323, "post_id": 47886443, "comment_id": 82739570, "body": "Ah, apologies to both of you, that was short-sighted of me. I&#39;m actually quite surprised it works like that. It does seem like there isn&#39;t much choice, then."}], "tags": [], "owner": {"reputation": 89, "user_id": 7497632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034a3a170972c07cb03d5f9564911dc6?s=128&d=identicon&r=PG&f=1", "display_name": "jon1467", "link": "https://stackoverflow.com/users/7497632/jon1467"}, "is_accepted": false, "score": 0, "last_activity_date": 1513684454, "creation_date": 1513684454, "answer_id": 47886443, "question_id": 47886224, "link": "https://stackoverflow.com/questions/47886224/ruby-on-rails-select-where-all-ids-in-array/47886443#47886443", "title": "Ruby on Rails - select where ALL ids in array", "body": "<p><a href=\"http://guides.rubyonrails.org/v2.3.11/active_record_querying.html\" rel=\"nofollow noreferrer\">Ruby on Rails Guide 2.3.3 - Subset Conditions</a></p>\n\n<p><code>Recipe.all(:ingredients =&gt; { :id =&gt; search_array })</code></p>\n\n<p>Should result in:</p>\n\n<p><code>SELECT * FROM recipes WHERE (recipes.ingredients IN (1,2,3,4,5))</code></p>\n\n<p>in SQL.</p>\n"}, {"comments": [{"owner": {"reputation": 816, "user_id": 4235383, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh3.googleusercontent.com/-Ewhs105HKKY/AAAAAAAAAAI/AAAAAAAAPds/x3YyZQpYIWg/photo.jpg?sz=128", "display_name": "Rob Hughes", "link": "https://stackoverflow.com/users/4235383/rob-hughes"}, "edited": false, "score": 0, "creation_date": 1513687810, "post_id": 47886539, "comment_id": 82740474, "body": "Thanks for the response, but this wouldn&#39;t work as expected if providing a shed load of ingredients. Even in my Eg 2, this wouldn&#39;t work as the <code>search_array.length &gt; Recipe.ingredient.length</code> ."}], "tags": [], "owner": {"reputation": 43225, "user_id": 297087, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/17b3a5816f0647e9b0f7c49d60f93e7b?s=128&d=identicon&r=PG", "display_name": "Salil", "link": "https://stackoverflow.com/users/297087/salil"}, "is_accepted": false, "score": 2, "last_activity_date": 1513684813, "creation_date": 1513684813, "answer_id": 47886539, "question_id": 47886224, "link": "https://stackoverflow.com/questions/47886224/ruby-on-rails-select-where-all-ids-in-array/47886539#47886539", "title": "Ruby on Rails - select where ALL ids in array", "body": "<p>Assuming you are using <code>has_many through</code> &amp; recipe_id, ingredient_id combination are unique.</p>\n\n<pre><code>recipe_ids = RecipeIngredient.select(:recipe_id)\n                             .where(ingredient_id: ids)\n                             .group(:recipe_id)\n                             .having(\"COUNT(*) &gt;= ?\", ids.length)\nfiltered_meals = Recipe.find recipe_ids\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1513697436, "creation_date": 1513697436, "answer_id": 47890239, "question_id": 47886224, "link": "https://stackoverflow.com/questions/47886224/ruby-on-rails-select-where-all-ids-in-array/47890239#47890239", "title": "Ruby on Rails - select where ALL ids in array", "body": "<p>Would the array <code>&amp;</code> operator work for you here?</p>\n\n<p>Something like:</p>\n\n<pre><code>search_array = [1, 2, 3, 4, 5]\nrecipe_1 = [1, 4, 5, 6]\nrecipe_2 = [1, 3, 4]\n\ndef contains_all_ingredients?(search_array, recipe)\n  (search_array &amp; recipe).sort == recipe.sort\nend\n\ncontains_all_ingredients(search_array, recipe_1) #=&gt; false\ncontains_all_ingredients(search_array, recipe_2) #=&gt; true\n</code></pre>\n\n<p>This method compares the arrays and returns only the elements present in both, so if the result of the comparison equals the recipe array, all are present. (And obviously you could have a little refactor to have the method sit in the recipe model.)</p>\n\n<p>You could then do:</p>\n\n<pre><code>Recipes.all.select { |recipe| contains_all_ingredients?(search_array, recipe) }\n</code></pre>\n\n<p>I'm not sure it passes your example three, but might help on your way? Let me know if that starts off OK, and I'll have more of a think in the meantime / if it's useful :)</p>\n"}, {"tags": [], "owner": {"reputation": 863, "user_id": 934876, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/60f5a73972bce656c8d4daf75cf8c96b?s=128&d=identicon&r=PG", "display_name": "AndrewSwerlick", "link": "https://stackoverflow.com/users/934876/andrewswerlick"}, "is_accepted": false, "score": 0, "last_activity_date": 1513745120, "creation_date": 1513745120, "answer_id": 47898931, "question_id": 47886224, "link": "https://stackoverflow.com/questions/47886224/ruby-on-rails-select-where-all-ids-in-array/47898931#47898931", "title": "Ruby on Rails - select where ALL ids in array", "body": "<p>How about </p>\n\n<pre><code>filtered_meals = Recipe.joins(:ingredients)\n                       .group(:recipe_id)\n                       .order(\"ingredients.id ASC\")\n                       .having(\"array_agg(ingredients.id) = ?\", ids)\n</code></pre>\n\n<p>You'll need to make sure your ids parameter is listed in ascending order so the order of the elements in the arrays will match too.</p>\n"}], "owner": {"reputation": 816, "user_id": 4235383, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh3.googleusercontent.com/-Ewhs105HKKY/AAAAAAAAAAI/AAAAAAAAPds/x3YyZQpYIWg/photo.jpg?sz=128", "display_name": "Rob Hughes", "link": "https://stackoverflow.com/users/4235383/rob-hughes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2974, "favorite_count": 1, "answer_count": 4, "score": 6, "last_activity_date": 1513745120, "creation_date": 1513683691, "question_id": 47886224, "link": "https://stackoverflow.com/questions/47886224/ruby-on-rails-select-where-all-ids-in-array", "title": "Ruby on Rails - select where ALL ids in array", "body": "<p>I'm trying to find the cleanest way to select records based on its associations and a search array.</p>\n\n<p>I have <code>Recipes</code> which have many <code>Ingredients</code> (through a join table)\nI have a search form field for an <code>array</code> of <code>Ingredient.ids</code></p>\n\n<p>To find any recipe which contains any of the ids in the search array, I can use </p>\n\n<p>eg 1.</p>\n\n<p><code>filtered_meals = Recipe.includes(:ingredients).where(\"ingredients.id\" =&gt; ids)</code></p>\n\n<p>BUT, I want to only match recipes where ALL of it's ingredients are found in the search array.</p>\n\n<p>eg 2.</p>\n\n<pre><code>search_array = [1, 2, 3, 4, 5]\nRecipe1 = [1, 4, 5, 6]\nRecipe2 = [1, 3, 4]\n# results =&gt; Recipe2\n</code></pre>\n\n<p>I am aware that I can use an <code>each</code> loop, something like this;</p>\n\n<p>eg 3.</p>\n\n<pre><code>filtered_meals = []\n\n Recipes.each do |meal|\n   meal_array = meal.ingredients.ids\n   variable =  meal_array-search_array\n     if variable.empty?\n       filtered_meals.push(meal)\n     end\n   end\n end\n\n return filtered_meals\n</code></pre>\n\n<p>The problem here is pagination. In the first example I can use <code>.limit()</code> and <code>.offset()</code> to control how many results are shown, but in the third example I would need to add an extra counter, submit that with the results, and then on a page change, re-send the counter and use <code>.drop(counter)</code> on the <code>each.do</code> loop. </p>\n\n<p>This seems way too long winded, is there any better way to do this??</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 89, "user_id": 7497632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034a3a170972c07cb03d5f9564911dc6?s=128&d=identicon&r=PG&f=1", "display_name": "jon1467", "link": "https://stackoverflow.com/users/7497632/jon1467"}, "edited": false, "score": 0, "creation_date": 1513683789, "post_id": 47886185, "comment_id": 82737992, "body": "To clarify, is the index number to you the numbered order as it is presented in an ActiveRecord query, or an entirely separate property of each link object?"}], "answers": [{"comments": [{"owner": {"reputation": 696, "user_id": 7314004, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/95806024183ca05eed5c8a100c610ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter H&#248;jlund Andersen", "link": "https://stackoverflow.com/users/7314004/peter-h%c3%b8jlund-andersen"}, "edited": false, "score": 0, "creation_date": 1513690223, "post_id": 47887172, "comment_id": 82742058, "body": "A good explanation: <a href=\"https://coderwall.com/p/t0no0g/render-partial-with-collection-has-hidden-index\" rel=\"nofollow noreferrer\">coderwall.com/p/t0no0g/&hellip;</a>"}, {"owner": {"reputation": 171, "user_id": 9043174, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YozTqDHzzhU/AAAAAAAAAAI/AAAAAAAAACE/bxVEKKs150w/photo.jpg?sz=128", "display_name": "Jake Anderson", "link": "https://stackoverflow.com/users/9043174/jake-anderson"}, "edited": false, "score": 0, "creation_date": 1513777485, "post_id": 47887172, "comment_id": 82781930, "body": "So simple! Thank you Anees and Peter."}], "tags": [], "owner": {"reputation": 1670, "user_id": 3475163, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dce396a4249c07f19902779e54c7a40b?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammed Anees", "link": "https://stackoverflow.com/users/3475163/muhammed-anees"}, "is_accepted": true, "score": 1, "last_activity_date": 1513686868, "creation_date": 1513686868, "answer_id": 47887172, "question_id": 47886185, "link": "https://stackoverflow.com/questions/47886185/active-records-list-the-items-index-number-the-actual-order-number-in-which/47887172#47887172", "title": "Active Records - List the item&#39;s index number (the actual order number in which the item is displayed)", "body": "<p>From the documentation:<br></p>\n\n<blockquote>\n  <p>Rails also makes a counter variable available within a partial called\n  by the collection, named after the member of the collection followed\n  by _counter.if you're rendering @products, within the partial you can\n  refer to product_counter to tell you how many times the partial has\n  been rendered.\n  <a href=\"http://guides.rubyonrails.org/layouts_and_rendering.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org</a></p>\n</blockquote>\n\n<p><br>\nSo you can use something like <code>&lt;%= link_counter %&gt;</code> in your _link.html.erb partial. Hope this will help.</p>\n"}, {"tags": [], "owner": {"reputation": 696, "user_id": 7314004, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/95806024183ca05eed5c8a100c610ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter H&#248;jlund Andersen", "link": "https://stackoverflow.com/users/7314004/peter-h%c3%b8jlund-andersen"}, "is_accepted": false, "score": 0, "last_activity_date": 1513691518, "last_edit_date": 1513691518, "creation_date": 1513689963, "answer_id": 47888065, "question_id": 47886185, "link": "https://stackoverflow.com/questions/47886185/active-records-list-the-items-index-number-the-actual-order-number-in-which/47888065#47888065", "title": "Active Records - List the item&#39;s index number (the actual order number in which the item is displayed)", "body": "<p>The tutorial actually explains it quiet well, i think.</p>\n\n<p>Underneath the <code>&lt;%= render @links %&gt;</code>:</p>\n\n<hr>\n\n<p><em>We are using a rails feature here, when you call render on an instance variable holding an active record relation object, it will iteratively loop through the object and then render the appropriate partial.</em></p>\n\n<hr>\n\n<p><strong>So! It's a Rails feature making it easier to write partial loops!</strong></p>\n\n<p><code>&lt;%= render @links %&gt;</code> is the same as: <code>&lt;%= render partial: 'link', collection: @links %&gt;</code></p>\n\n<p>If you want an index in your partial, you can just append a local variable. For example:</p>\n\n<pre><code>&lt;%= render @links, locals: {num: 1} %&gt;\n</code></pre>\n\n<p>And then in your view after you have written the variable, remember to add 1 so it's ascending.</p>\n\n<pre><code>&lt;div class=\"link\"&gt;\n  &lt;div class=\"title\"&gt;\n    &lt;%= num %&gt;\n    &lt;%= link_to link.title, (link.url? ? link.url : link) %&gt;\n...\n&lt;% num += 1 %&gt;\n</code></pre>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 171, "user_id": 9043174, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YozTqDHzzhU/AAAAAAAAAAI/AAAAAAAAACE/bxVEKKs150w/photo.jpg?sz=128", "display_name": "Jake Anderson", "link": "https://stackoverflow.com/users/9043174/jake-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 47887172, "answer_count": 2, "score": 0, "last_activity_date": 1513691518, "creation_date": 1513683563, "last_edit_date": 1513688894, "question_id": 47886185, "link": "https://stackoverflow.com/questions/47886185/active-records-list-the-items-index-number-the-actual-order-number-in-which", "title": "Active Records - List the item&#39;s index number (the actual order number in which the item is displayed)", "body": "<p>I'm a newb to Ruby on Rails and I have a issue trying to display the index number of a record set. I've had a good search, but can't find the specific answer. </p>\n\n<p>The issue I'm having is that I cannot find a way to output the index number from a recordset which i'm displaying.</p>\n\n<blockquote>\n  <ol>\n  <li>[Title], [Description]</li>\n  <li>[Title], [Description]</li>\n  <li>[Title], [Description]\n  <br>etc.</li>\n  </ol>\n</blockquote>\n\n<p>So to clarify, I'm looking to output the order (index) number (1, 2, 3) in a list where i'm able to output the Title &amp; Description, also i'll point out the obvious - this is different to the unique ID which may be stored in the database, thus if i was to filter or sort the results I would still want to show the order (index) number (1, 2, 3 etc).</p>\n\n<p>I have founds example of where they loop through the results and incrementally add to a pre-defined index value. The problem is my app doesn't use a loop statement to output the records, instead it's using an Active Record to display (and essentially loop through) the results. From what I understand, Active records will automatically loop through and output the records by rendering the code snippet ie. <pre>&lt;%= render @links %></pre> This works great for my example - For the full code for the app, please refer to the tutorial I deprived the app from:</p>\n\n<p><a href=\"https://www.codementor.io/danielchinedu/building-a-basic-hacker-news-clone-with-rails-5-4gr4hrbis\" rel=\"nofollow noreferrer\">https://www.codementor.io/danielchinedu/building-a-basic-hacker-news-clone-with-rails-5-4gr4hrbis</a></p>\n\n<p>So in retrospect, I'm looking to clone the app in the tutorial but add an order number to the link lists.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1513705390, "post_id": 47886099, "comment_id": 82751423, "body": "I&#39;m surprised the API does not always return an array of hashes, even when the array contains a single hash."}, {"owner": {"reputation": 707, "user_id": 4857703, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4c429b76da33b18fb818c4890075fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Shalafister&#39;s", "link": "https://stackoverflow.com/users/4857703/shalafisters"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1513726972, "post_id": 47886099, "comment_id": 82760437, "body": "yeah tell me about it!"}], "answers": [{"tags": [], "owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "is_accepted": false, "score": 2, "last_activity_date": 1513685333, "last_edit_date": 1513685333, "creation_date": 1513683684, "answer_id": 47886220, "question_id": 47886099, "link": "https://stackoverflow.com/questions/47886099/rails-how-to-loop-either-array-of-hashes-or-only-a-hash/47886220#47886220", "title": "Rails, how to loop either array of hashes or only a hash", "body": "<p>You could try to use <a href=\"https://apidock.com/ruby/Object/kind_of%3F\" rel=\"nofollow noreferrer\"><code>Object#kind_of?</code></a> to determine whether it is an <code>Array</code> or a <code>Hash</code> instance.</p>\n\n<pre><code>if b[\"extras\"][\"extra\"].kind_of? Array\n    # handle array\nelsif b[\"extras\"][\"extra\"].kind_of? Hash\n    # handle hash\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1513686442, "post_id": 47886707, "comment_id": 82739644, "body": "Since this is a Rails question: <code>Array.wrap(input)</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1513743250, "post_id": 47886707, "comment_id": 82764027, "body": "Why <code>.flatten</code>? Isn&#39;t <code>input</code> a hash or an array of hashes?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1513753146, "post_id": 47886707, "comment_id": 82767251, "body": "@CarySwoveland splatting the hash returns the array, hence I need this magical passes with <code>[*[]]</code>, making array of hashes to be wrapped within another array."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1513687568, "last_edit_date": 1513687568, "creation_date": 1513685358, "answer_id": 47886707, "question_id": 47886099, "link": "https://stackoverflow.com/questions/47886099/rails-how-to-loop-either-array-of-hashes-or-only-a-hash/47886707#47886707", "title": "Rails, how to loop either array of hashes or only a hash", "body": "<p>Nai\u0308ve solution: one might check the object\u2019s type upfront:</p>\n\n<pre><code>case b[\"extras\"][\"extra\"]\nwhen Array\n    # handle array\nwhen Hash\n    # handle hash\nend\n</code></pre>\n\n<p>Proper solution: produce an array of hashes no matter what came.</p>\n\n<pre><code>[*[input]].flatten\n</code></pre>\n\n<p>and deal with it as with an array having at least one hash element (with <code>each</code>.)</p>\n\n<p>Please also refer to valuable comment by @Stefan below if you have no allergy using Rails helpers.</p>\n"}], "owner": {"reputation": 707, "user_id": 4857703, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4c429b76da33b18fb818c4890075fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Shalafister&#39;s", "link": "https://stackoverflow.com/users/4857703/shalafisters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47886707, "answer_count": 2, "score": 0, "last_activity_date": 1513687568, "creation_date": 1513683204, "question_id": 47886099, "link": "https://stackoverflow.com/questions/47886099/rails-how-to-loop-either-array-of-hashes-or-only-a-hash", "title": "Rails, how to loop either array of hashes or only a hash", "body": "<p>I am connecting to an API and I get array of hashes or only 1 hash for the data. So when the data comes as array of hashes;</p>\n\n<pre><code>\"extras\"=&gt;{\"extra\"=&gt;[{\"id\"=&gt;\"529216700000100800\", \"name\"=&gt;\"Transfer Trogir - Dubrovnik (8 persons max)\", \"price\"=&gt;\"290.0\", \"currency\"=&gt;\"EUR\", \"timeunit\"=&gt;\"0\", \"customquantity\"=&gt;\"0\", \"validdatefrom\"=&gt;\"1970-01-01\", \"validdateto\"=&gt;\"2119-07-20\", \"sailingdatefrom\"=&gt;\"1970-01-01\", \"sailingdateto\"=&gt;\"2119-07-20\", \"obligatory\"=&gt;\"0\", \"perperson\"=&gt;\"0\", \"includedinbaseprice\"=&gt;\"0\", \"payableoninvoice\"=&gt;\"1\", \"availableinbase\"=&gt;\"-1\", \"includesdepositwaiver\"=&gt;\"0\", \"includedoptions\"=&gt;\"\"}, {\"id\"=&gt;\"528978430000100800\", \"name\"=&gt;\"Gennaker + extra deposit (HR)\", \"price\"=&gt;\"150.0\", \"currency\"=&gt;\"EUR\", \"timeunit\"=&gt;\"604800000\", \"customquantity\"=&gt;\"0\", \"validdatefrom\"=&gt;\"1970-01-01\", \"validdateto\"=&gt;\"2119-07-19\", \"sailingdatefrom\"=&gt;\"1970-01-01\", \"sailingdateto\"=&gt;\"2119-07-19\", \"obligatory\"=&gt;\"0\", \"perperson\"=&gt;\"0\", \"includedinbaseprice\"=&gt;\"0\", \"payableoninvoice\"=&gt;\"1\", \"availableinbase\"=&gt;\"-1\", \"includesdepositwaiver\"=&gt;\"0\", \"includedoptions\"=&gt;\"\"}]\n</code></pre>\n\n<p>I'am looping through the array to get the values as;</p>\n\n<pre><code>b[\"extras\"][\"extra\"].each do |extra|\n  puts extra[\"id\"]\n  puts extra[\"name\"]\nend\n</code></pre>\n\n<p>But when this is not array; only 1 hash, then this is not working, adding each loop makes it array but not array of hashes;</p>\n\n<pre><code>\"extras\"=&gt;{\"extra\"=&gt;{\"id\"=&gt;\"640079840000100800\", \"name\"=&gt;\"Comfort package (GRE)\", \"price\"=&gt;\"235.0\", \"currency\"=&gt;\"EUR\", \"timeunit\"=&gt;\"0\", \"customquantity\"=&gt;\"0\", \"validdatefrom\"=&gt;\"1970-01-01\", \"validdateto\"=&gt;\"2120-03-25\", \"sailingdatefrom\"=&gt;\"2015-01-01\", \"sailingdateto\"=&gt;\"2120-03-25\", \"obligatory\"=&gt;\"1\", \"perperson\"=&gt;\"0\", \"includedinbaseprice\"=&gt;\"0\", \"payableoninvoice\"=&gt;\"1\", \"availableinbase\"=&gt;\"-1\", \"includesdepositwaiver\"=&gt;\"0\", \"includedoptions\"=&gt;\"\"}}\n\n\nb[\"extras\"][\"extra\"].each do |extra|\n  puts extra[\"id\"]\n  puts extra[\"name\"]\nend\n</code></pre>\n\n<p>This time, that gives error TypeError (no implicit conversion of String into Integer);</p>\n\n<p>When I type puts <code>extra.inspect</code>; I get <code>[\"id\", \"640079840000100800\"]</code>. So to make it work I should pass <code>extra[1]</code> to get the id number. </p>\n\n<p>But I can not predict either array of hashes or only hash. Is there any easy way to solve this issue that works either array of hashes or just a hash?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "user-testing"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1513682167, "post_id": 47885739, "comment_id": 82737088, "body": "A typo error, probably the extra <code>end</code> in line #58."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 9117631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1812987538766021/picture?type=large", "display_name": "Max Heumann", "link": "https://stackoverflow.com/users/9117631/max-heumann"}, "edited": false, "score": 0, "creation_date": 1513727700, "post_id": 47885798, "comment_id": 82760628, "body": "thank you very much for the quick response! the extra end really was the problem. for now, no error anymore..."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 61, "user_id": 9117631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1812987538766021/picture?type=large", "display_name": "Max Heumann", "link": "https://stackoverflow.com/users/9117631/max-heumann"}, "edited": false, "score": 0, "creation_date": 1513764204, "post_id": 47885798, "comment_id": 82773348, "body": "I got the answer in first, save Sebastian&#39;s comment pipping me by a few secs :) Glad to help @MaxHeumann."}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 1, "last_activity_date": 1513682246, "creation_date": 1513682246, "answer_id": 47885798, "question_id": 47885739, "link": "https://stackoverflow.com/questions/47885739/ruby-rails-tutorial-chapter-10-error/47885798#47885798", "title": "ruby rails tutorial chapter 10 error", "body": "<p>Looks like you've got an extra <code>end</code> in the <code>users_controller</code>, right before the closing one - line 58</p>\n\n<p>Edit: what @SebastianPalma said - beat me to it :)</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 9117631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1812987538766021/picture?type=large", "display_name": "Max Heumann", "link": "https://stackoverflow.com/users/9117631/max-heumann"}, "edited": false, "score": 0, "creation_date": 1513727805, "post_id": 47885992, "comment_id": 82760661, "body": "thank you very much for the quick response and the detailed instructions! no error after deleting the extra end!"}], "tags": [], "owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "is_accepted": false, "score": 0, "last_activity_date": 1513683954, "last_edit_date": 1513683954, "creation_date": 1513682863, "answer_id": 47885992, "question_id": 47885739, "link": "https://stackoverflow.com/questions/47885739/ruby-rails-tutorial-chapter-10-error/47885992#47885992", "title": "ruby rails tutorial chapter 10 error", "body": "<p>You have extra end in User#correct_user method. Try this:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  before_action :logged_in_user, only: [:edit, :update]\n  before_action :correct_user,   only: [:edit, :update]\n\n  def show\n    @user = User.find(params[:id])\n  end\n\n  def new\n    @user = User.new\n  end\n\n  def create\n    @user = User.new(user_params)\n    if @user.save\n      log_in @user\n      flash[:success] = \"Welcome to the Sample App!\"\n      redirect_to @user\n    else\n      render 'new'\n    end\n  end\n\n  def edit\n    @user = User.find(params[:id])\n  end\n\n  def update\n    if @user.update_attributes(user_params)\n      flash[:success] = \"Profile updated\"\n      redirect_to @user\n    else\n      render 'edit'\n    end\n  end\n\n  private\n\n  def user_params\n    params.require(:user).permit(:name, :email, :password,\n                                     :password_confirmation)\n  end\n  # Before filters\n\n  # Confirms a logged-in user.\n  def logged_in_user\n    unless logged_in?\n      flash[:danger] = \"Please log in.\"\n      redirect_to login_url\n    end\n  end\n\n  # Confirms the correct user.\n  def correct_user\n    @user = User.find(params[:id])\n    redirect_to(root_url) unless @user == current_user\n  end\nend\n</code></pre>\n\n<p>You dint paid attention to difference between the syntax of if - modifier and if -statment.you dont have to use extra end at the end of modifier.these both are same without any syntax error.</p>\n\n<pre><code>if c.empty?\n  return\nend\n\nreturn if c.empty?\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 9117631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1812987538766021/picture?type=large", "display_name": "Max Heumann", "link": "https://stackoverflow.com/users/9117631/max-heumann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 47885798, "answer_count": 2, "score": 0, "last_activity_date": 1513683954, "creation_date": 1513682054, "last_edit_date": 1513683409, "question_id": 47885739, "link": "https://stackoverflow.com/questions/47885739/ruby-rails-tutorial-chapter-10-error", "title": "ruby rails tutorial chapter 10 error", "body": "<p>I'm getting 8 Errors in chapter 10 of Michael Hartls Ruby on Rails Tutorial. Everything worked just fine until the testing of 10.2.2 .\nI have no idea how to fix it... I hope you can help. Thanks in advance.</p>\n\n<p>The error messages:</p>\n\n<blockquote>\n  <p>E</p>\n  \n  <p>Error: UsersSignupTest#test_invalid_signup_information: SyntaxError:\n  /home/studi/workspace/sample_app/app/controllers/users_controller.rb:59:\n  syntax error, unexpected keyword_end, expecting end-of-input\n      test/integration/users_signup_test.rb:6:in `block in '</p>\n  \n  <p>bin/rails test test/integration/users_signup_test.rb:5</p>\n  \n  <p>E</p>\n  \n  <p>Error: UsersSignupTest#test_valid_signup_information: SyntaxError:\n  /home/studi/workspace/sample_app/app/controllers/users_controller.rb:59:\n  syntax error, unexpected keyword_end, expecting end-of-input\n      test/integration/users_signup_test.rb:17:in `block in '</p>\n  \n  <p>bin/rails test test/integration/users_signup_test.rb:16</p>\n  \n  <p>...E</p>\n  \n  <p>Error:\n  UsersLoginTest#test_login_with_valid_information_followed_by_logout:\n  SyntaxError:\n  /home/studi/workspace/sample_app/app/controllers/users_controller.rb:59:\n  syntax error, unexpected keyword_end, expecting end-of-input\n      test/integration/users_login_test.rb:24:in `block in '</p>\n  \n  <p>bin/rails test test/integration/users_login_test.rb:18</p>\n  \n  <p>E</p>\n  \n  <p>Error: UsersEditTest#test_successful_edit: SyntaxError:\n  /home/studi/workspace/sample_app/app/controllers/users_controller.rb:59:\n  syntax error, unexpected keyword_end, expecting end-of-input\n      test/integration/users_edit_test.rb:22:in `block in '</p>\n  \n  <p>bin/rails test test/integration/users_edit_test.rb:20</p>\n  \n  <p>E</p>\n  \n  <p>Error: UsersEditTest#test_unsuccessful_edit: SyntaxError:\n  /home/studi/workspace/sample_app/app/controllers/users_controller.rb:59:\n  syntax error, unexpected keyword_end, expecting end-of-input\n      test/integration/users_edit_test.rb:11:in `block in '</p>\n  \n  <p>bin/rails test test/integration/users_edit_test.rb:9</p>\n  \n  <p>......E</p>\n  \n  <p>Error:\n  UsersControllerTest#test_should_redirect_update_when_logged_in_as_wrong_user:\n  SyntaxError:\n  /home/studi/workspace/sample_app/app/controllers/users_controller.rb:59:\n  syntax error, unexpected keyword_end, expecting end-of-input\n      test/controllers/users_controller_test.rb:23:in `block in '</p>\n  \n  <p>bin/rails test test/controllers/users_controller_test.rb:21</p>\n  \n  <p>E</p>\n  \n  <p>Error: UsersControllerTest#test_should_get_new: SyntaxError:\n  /home/studi/workspace/sample_app/app/controllers/users_controller.rb:59:\n  syntax error, unexpected keyword_end, expecting end-of-input\n      test/controllers/users_controller_test.rb:11:in `block in '</p>\n  \n  <p>bin/rails test test/controllers/users_controller_test.rb:10</p>\n  \n  <p>E</p>\n  \n  <p>Error:\n  UsersControllerTest#test_should_redirect_edit_when_logged_in_as_wrong_user:\n  SyntaxError:\n  /home/studi/workspace/sample_app/app/controllers/users_controller.rb:59:\n  syntax error, unexpected keyword_end, expecting end-of-input\n      test/controllers/users_controller_test.rb:16:in `block in '</p>\n  \n  <p>bin/rails test test/controllers/users_controller_test.rb:14</p>\n</blockquote>\n\n<p>user_controller_test file:</p>\n\n<pre><code>require 'test_helper'\n\nclass UsersControllerTest &lt; ActionDispatch::IntegrationTest\n\n  def setup\n  @user = users(:michael)\n  @other_user = users(:archer)\nend\n\n  test \"should get new\" do\n    get signup_path\n    assert_response :success\n  end\n  test \"should redirect edit when logged in as wrong user\" do\n    log_in_as(@other_user)\n    get edit_user_path(@user)\n    assert flash.empty?\n    assert_redirected_to root_url\n  end\n\n  test \"should redirect update when logged in as wrong user\" do\n    log_in_as(@other_user)\n    patch user_path(@user), params: { user: { name: @user.name,\n                                              email: @user.email } }\n    assert flash.empty?\n    assert_redirected_to root_url\n  end\nend\n</code></pre>\n\n<p>users_controller file:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  before_action :logged_in_user, only: [:edit, :update]\n  before_action :correct_user,   only: [:edit, :update]\n\n  def show\n    @user = User.find(params[:id])\n  end\n\n  def new\n    @user = User.new\n  end\n\n  def create\n    @user = User.new(user_params)\n    if @user.save\n      log_in @user\n      flash[:success] = \"Welcome to the Sample App!\"\n      redirect_to @user\n    else\n      render 'new'\n    end\n  end\n\n  def edit\n    @user = User.find(params[:id])\n  end\n\n  def update\n      if @user.update_attributes(user_params)\n        flash[:success] = \"Profile updated\"\n        redirect_to @user\n      else\n        render 'edit'\n      end\n    end\n\n  private\n\n  def user_params\n        params.require(:user).permit(:name, :email, :password,\n                                     :password_confirmation)\n      end\n    # Before filters\n\n    # Confirms a logged-in user.\n    def logged_in_user\n      unless logged_in?\n        flash[:danger] = \"Please log in.\"\n        redirect_to login_url\n      end\n    end\n\n    # Confirms the correct user.\n    def correct_user\n      @user = User.find(params[:id])\n      redirect_to(root_url) unless @user == current_user\n    end\n    end\nend\n</code></pre>\n\n<p>The error occured right after the instructions of 10.2.2.\nThe testing of 10.2.1 worked fine.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "edited": false, "score": 0, "creation_date": 1513681342, "post_id": 47885441, "comment_id": 82736638, "body": "What exact output do you expect?"}, {"owner": {"reputation": 1364, "user_id": 5737512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nfjfF.jpg?s=128&g=1", "display_name": "Kaushlendra Tomar", "link": "https://stackoverflow.com/users/5737512/kaushlendra-tomar"}, "edited": false, "score": 0, "creation_date": 1513681532, "post_id": 47885441, "comment_id": 82736756, "body": "please mention your expected output."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513681533, "post_id": 47885441, "comment_id": 82736759, "body": "There is no chance you get <code>id</code>, <code>email</code> etc by calling <code>hash.values</code>."}, {"owner": {"reputation": 173, "user_id": 8718742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XBXjN.jpg?s=128&g=1", "display_name": "Enner31", "link": "https://stackoverflow.com/users/8718742/enner31"}, "edited": false, "score": 0, "creation_date": 1513681667, "post_id": 47885441, "comment_id": 82736838, "body": "I edited it to show you the output i&#39;m expecting to have."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 8718742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XBXjN.jpg?s=128&g=1", "display_name": "Enner31", "link": "https://stackoverflow.com/users/8718742/enner31"}, "edited": false, "score": 0, "creation_date": 1513682955, "post_id": 47885735, "comment_id": 82737545, "body": "Thanks for your answer. I&#39;ve decided what I have to do with profiles and I need to collect them, same way than my output."}], "tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": false, "score": 0, "last_activity_date": 1513683739, "last_edit_date": 1513683739, "creation_date": 1513682045, "answer_id": 47885735, "question_id": 47885441, "link": "https://stackoverflow.com/questions/47885441/how-to-collect-headers-from-a-json-file/47885735#47885735", "title": "How to collect headers from a json file", "body": "<p>You can do something like this:</p>\n\n<pre><code>json = &lt;&lt;-END\n[\n  {\n    \"id\": 0,\n    \"email\": \"colleengriffith@quintity.com\",\n    \"tags\": [\n      \"consectetur\",\n      \"quis\"\n    ],\n    \"profiles\": {\n      \"facebook\": {\n        \"id\": 0,\n        \"picture\": \"//fbcdn.com/a2244bc1-b10c-4d91-9ce8-184337c6b898.jpg\"\n      },\n      \"twitter\": {\n        \"id\": 0,\n        \"picture\": \"//twcdn.com/ad9e8cd3-3133-423e-8bbf-0602e4048c22.jpg\"\n      }\n    }\n  },\n  {\n    \"id\": 1,\n    \"email\": \"maryellengriffin@ginkle.com\",\n    \"tags\": [\n      \"veniam\",\n      \"elit\",\n      \"mollit\"\n    ],\n     \"profiles\": {\n       \"facebook\": {\n         \"id\": 1,\n         \"picture\": \"//fbcdn.com/12e070e0-21ea-4663-97d0-46bc9c7b67a4.jpg\"\n       },\n       \"twitter\": {\n         \"id\": 1,\n         \"picture\": \"//twcdn.com/3057792f-5dfb-4c4b-86b5-cce4d6bbf7ac.jpg\"\n       }\n     }\n   }\n ]\nEND\n\nCSV.generate do |csv| \n  csv &lt;&lt; [:id, :email, :tags, :profiles] # add headers with order\n  JSON.parse(json).each do |item| \n    csv &lt;&lt; [item['id'], item['email'], item['tags'].join(','), item['profiles']] # add rows with the same order\n  end\nend\n</code></pre>\n\n<p>It'll give you the following csv:</p>\n\n<pre><code>id,email,tags,profiles\n0,colleengriffith@quintity.com,\"consectetur,quis\",\"{\"\"facebook\"\"=&gt;{\"\"id\"\"=&gt;0, \"\"picture\"\"=&gt;\"\"//fbcdn.com/a2244bc1-b10c-4d91-9ce8-184337c6b898.jpg\"\"}, \"\"twitter\"\"=&gt;{\"\"id\"\"=&gt;0, \"\"picture\"\"=&gt;\"\"//twcdn.com/ad9e8cd3-3133-423e-8bbf-0602e4048c22.jpg\"\"}}\"\n1,maryellengriffin@ginkle.com,\"veniam,elit,mollit\",\"{\"\"facebook\"\"=&gt;{\"\"id\"\"=&gt;1, \"\"picture\"\"=&gt;\"\"//fbcdn.com/12e070e0-21ea-4663-97d0-46bc9c7b67a4.jpg\"\"}, \"\"twitter\"\"=&gt;{\"\"id\"\"=&gt;1, \"\"picture\"\"=&gt;\"\"//twcdn.com/3057792f-5dfb-4c4b-86b5-cce4d6bbf7ac.jpg\"\"}}\"\n</code></pre>\n\n<p>But you have to decide what to do with profiles.</p>\n\n<p><strong>Updated</strong></p>\n\n<pre><code>CSV.generate do |csv| \n  csv &lt;&lt; ['id', 'email', 'tags', 'profiles.facebook.id', 'profiles.facebook.picture', 'profiles.twitter.id', 'profiles.twitter.picture'] \n  JSON.parse(json).each do |item| \n    csv &lt;&lt; [item['id'], item['email'], item['tags'].join(','), item['profiles']['facebook']['id'], item['profiles']['facebook']['picture'], item['profiles']['twitter']['id'], item['profiles']['twitter']['picture']] \n  end\nend\n</code></pre>\n\n<p>will result</p>\n\n<pre><code>id,email,tags,profiles.facebook.id,profiles.facebook.picture,profiles.twitter.id,profiles.twitter.picture\n0,colleengriffith@quintity.com,\"consectetur,quis\",0,//fbcdn.com/a2244bc1-b10c-4d91-9ce8-184337c6b898.jpg,0,//twcdn.com/ad9e8cd3-3133-423e-8bbf-0602e4048c22.jpg\n1,maryellengriffin@ginkle.com,\"veniam,elit,mollit\",1,//fbcdn.com/12e070e0-21ea-4663-97d0-46bc9c7b67a4.jpg,1,//twcdn.com/3057792f-5dfb-4c4b-86b5-cce4d6bbf7ac.jpg\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 173, "user_id": 8718742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XBXjN.jpg?s=128&g=1", "display_name": "Enner31", "link": "https://stackoverflow.com/users/8718742/enner31"}, "edited": false, "score": 0, "creation_date": 1513683208, "post_id": 47885772, "comment_id": 82737682, "body": "Thanks for answering the question, and It worked indeed. however, what you wrote is not that clear in my head... Could you explain me a bit more ?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 173, "user_id": 8718742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XBXjN.jpg?s=128&g=1", "display_name": "Enner31", "link": "https://stackoverflow.com/users/8718742/enner31"}, "edited": false, "score": 0, "creation_date": 1513684951, "post_id": 47885772, "comment_id": 82738745, "body": "I am not sure what could I add to make it more explicit. <code>get</code> lambda extracts the keys recursively and joins them with a dot."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1513682176, "creation_date": 1513682176, "answer_id": 47885772, "question_id": 47885441, "link": "https://stackoverflow.com/questions/47885441/how-to-collect-headers-from-a-json-file/47885772#47885772", "title": "How to collect headers from a json file", "body": "<p>For the hash of any nesting level:</p>\n\n<pre><code>get = -&gt;(hash, prefix = nil) do\n        hash.flat_map do |k, v|\n          v.is_a?(Hash) ? get.(v, k) : [prefix, k].compact.join('.')\n        end\n      end\n\njson.map(&amp;get)\n#\u21d2\u00a0array of titles in each hash\njson.map(&amp;get).first\n#\u21d2\u00a0[\"id\", \"email\", \"tags\",\n#   \"facebook.id\", \"facebook.picture\",\n#   \"twitter.id\", \"twitter.picture\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 173, "user_id": 8718742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XBXjN.jpg?s=128&g=1", "display_name": "Enner31", "link": "https://stackoverflow.com/users/8718742/enner31"}, "edited": false, "score": 0, "creation_date": 1513684056, "post_id": 47886105, "comment_id": 82738147, "body": "I like the way you wrote your code. But I have one question about it. When I run your code, my heading variable equal <code>#&lt;SortedSet:0x007fd22616b0c0&gt;</code> Any idea ? Am I doing something wrong ?"}, {"owner": {"reputation": 467, "user_id": 6003939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9fP_gxi1pEA/AAAAAAAAAAI/AAAAAAAAAC4/L9NDDYQE22s/photo.jpg?sz=128", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/6003939/vivek-singh"}, "reply_to_user": {"reputation": 173, "user_id": 8718742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XBXjN.jpg?s=128&g=1", "display_name": "Enner31", "link": "https://stackoverflow.com/users/8718742/enner31"}, "edited": false, "score": 0, "creation_date": 1513684358, "post_id": 47886105, "comment_id": 82738353, "body": "@Rapha&#235;lFOSSE Hey I am just using p headings instead of puts headings :)"}, {"owner": {"reputation": 173, "user_id": 8718742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XBXjN.jpg?s=128&g=1", "display_name": "Enner31", "link": "https://stackoverflow.com/users/8718742/enner31"}, "edited": false, "score": 0, "creation_date": 1513691514, "post_id": 47886105, "comment_id": 82742874, "body": "Right ! haha However, <code>tags</code> did not appear into the output I have, neither on your as I can see."}, {"owner": {"reputation": 173, "user_id": 8718742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XBXjN.jpg?s=128&g=1", "display_name": "Enner31", "link": "https://stackoverflow.com/users/8718742/enner31"}, "edited": false, "score": 0, "creation_date": 1513691742, "post_id": 47886105, "comment_id": 82742993, "body": "Oops, didn&#39;t noticed, sorry. Thanks again!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513706440, "post_id": 47886105, "comment_id": 82751930, "body": "You\u2019re abusing <code>each</code> with an outer local variable, use <code>json.each_with_object(SortedSet.new) { |hash, set| set.merge(get_recursive_keys(hash)) }</code> instead."}], "tags": [], "owner": {"reputation": 467, "user_id": 6003939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9fP_gxi1pEA/AAAAAAAAAAI/AAAAAAAAAC4/L9NDDYQE22s/photo.jpg?sz=128", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/6003939/vivek-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1513683228, "creation_date": 1513683228, "answer_id": 47886105, "question_id": 47885441, "link": "https://stackoverflow.com/questions/47885441/how-to-collect-headers-from-a-json-file/47886105#47886105", "title": "How to collect headers from a json file", "body": "<p>Get nested key using get_recursive_keys method</p>\n\n<pre><code>def get_recursive_keys(hash, nested_key=nil)\n  hash.each_with_object([]) do |(k,v),keys|      \n    k = \"#{nested_key}.#{k}\" unless nested_key.nil?\n    if v.is_a? Hash\n      keys.concat(get_recursive_keys(v, k))\n    else\n      keys &lt;&lt; k\n    end\n  end\nend\n</code></pre>\n\n<p>And then append in your sorted set like this:</p>\n\n<pre><code>json = JSON.parse(File.open(\"live.json\").read)\nheadings = SortedSet.new\njson.each do |hash|\n  headings.merge(get_recursive_keys(hash))\nend\n</code></pre>\n\n<p>Now headings of Keys:</p>\n\n<pre><code>#&lt;SortedSet: {\"email\", \"id\", \"profiles.facebook.id\", \"profiles.facebook.picture\", \"profiles.twitter.id\", \"profiles.twitter.picture\", \"tags\"}&gt;\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 8718742, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XBXjN.jpg?s=128&g=1", "display_name": "Enner31", "link": "https://stackoverflow.com/users/8718742/enner31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 47886105, "answer_count": 3, "score": 0, "last_activity_date": 1513683739, "creation_date": 1513681185, "last_edit_date": 1513681637, "question_id": 47885441, "link": "https://stackoverflow.com/questions/47885441/how-to-collect-headers-from-a-json-file", "title": "How to collect headers from a json file", "body": "<p>I'm trying to change a json file to CSV. Here's my Json : </p>\n\n<pre><code>[\n  {\n    \"id\": 0,\n    \"email\": \"colleengriffith@quintity.com\",\n    \"tags\": [\n      \"consectetur\",\n      \"quis\"\n    ],\n    \"profiles\": {\n      \"facebook\": {\n        \"id\": 0,\n        \"picture\": \"//fbcdn.com/a2244bc1-b10c-4d91-9ce8-184337c6b898.jpg\"\n      },\n      \"twitter\": {\n        \"id\": 0,\n        \"picture\": \"//twcdn.com/ad9e8cd3-3133-423e-8bbf-0602e4048c22.jpg\"\n      }\n    }\n  },\n  {\n    \"id\": 1,\n    \"email\": \"maryellengriffin@ginkle.com\",\n    \"tags\": [\n      \"veniam\",\n      \"elit\",\n      \"mollit\"\n    ],\n     \"profiles\": {\n       \"facebook\": {\n         \"id\": 1,\n         \"picture\": \"//fbcdn.com/12e070e0-21ea-4663-97d0-46bc9c7b67a4.jpg\"\n       },\n       \"twitter\": {\n         \"id\": 1,\n         \"picture\": \"//twcdn.com/3057792f-5dfb-4c4b-86b5-cce4d6bbf7ac.jpg\"\n       }\n     }\n   }\n ]\n</code></pre>\n\n<p>All I want first is to collect the headers. Here's what I tried : </p>\n\n<pre><code>json = JSON.parse(File.open(\"live.json\").read)\nheadings = SortedSet.new\njson.each do |hash|\n  headings.merge(hash.values)\nend\n</code></pre>\n\n<p>and It returns me <code>#&lt;SortedSet:0x007fa592128088&gt;</code></p>\n\n<p>Then, I tried to understand what happened (I did not by the way) but I saw that when I ask for my <code>json.values</code> I do not have the nested values. Here's what I have : </p>\n\n<pre><code>id\nemail\ntags\nprofiles\n</code></pre>\n\n<p>Output expected is : </p>\n\n<pre><code>id, email, tags, profiles.facebook.id, profiles.facebook.picture, profiles.twitter.id, profiles.twitter.picture\n</code></pre>\n\n<p>So my question is, does anybody knows how to get those headers ? Is there a simple way to get them without using SortedSet ? </p>\n\n<p>Many Thanks ! </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513680967, "post_id": 47885304, "comment_id": 82736417, "body": "Is there any chance to <i>tune</i> the json <i>publisher</i> to provide these numbers as strings?"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513682798, "post_id": 47885304, "comment_id": 82737453, "body": "How does that JSON get created?"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513683047, "post_id": 47885304, "comment_id": 82737595, "body": "And can you show a real such number, not just that artificial example?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513687575, "post_id": 47885304, "comment_id": 82740344, "body": "@mudasobwa the consumer seems to need some tuning."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513687692, "post_id": 47885304, "comment_id": 82740404, "body": "@StefanPochmann the number in the OP&#39;s example looks fine to me \u2013 it is being truncated."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1513687826, "post_id": 47885304, "comment_id": 82740486, "body": "@Stefan The fractional part is the concatenation of the numbers 1 to 16. Do you think that&#39;s really a real number they got, not just one they made up for an MCVE?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 1, "creation_date": 1513688208, "post_id": 47885304, "comment_id": 82740733, "body": "@StefanPochmann apparently, it is just an example value, but it doesn&#39;t alter the problem."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1513688328, "post_id": 47885304, "comment_id": 82740814, "body": "@Stefan It might. What if the JSON string contains <code>0.1000000000000000055511151231257827021181583404541015625</code> and they&#39;re complaining about ending up with <code>0.1</code>? They&#39;d be wrong to complain, since they&#39;d then have the exact number."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513689459, "post_id": 47885304, "comment_id": 82741571, "body": "@StefanPochmann according to the question&#39;s title the OP wants a BigDecimal, not a Float."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1513689525, "post_id": 47885304, "comment_id": 82741605, "body": "@Stefan Yes, but maybe they just <i>want</i> that based on a misunderstanding and don&#39;t actually <i>need</i> that."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513689705, "post_id": 47885304, "comment_id": 82741718, "body": "@StefanPochmann I would be very surprised to see JSON data with exact (double-precision) floating point values, but you never know ;-)"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1513689955, "post_id": 47885304, "comment_id": 82741872, "body": "@Stefan Well I&#39;m also surprised to see JSON data allegedly needing BigDecimal :-)"}, {"owner": {"reputation": 1061, "user_id": 9196467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hNr2MsW0o_M/AAAAAAAAAAI/AAAAAAAAAAk/yQ0PJK_IojU/photo.jpg?sz=128", "display_name": "Sampson Crowley", "link": "https://stackoverflow.com/users/9196467/sampson-crowley"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1593652314, "post_id": 47885304, "comment_id": 110858074, "body": "@StefanPochmann how is <code>0.1</code> the exact number in any way? the <b>exact</b> number is the number you&#39;re saying their wrong to complain about not getting. <code>0.1</code> is NOT <code>0.1000000000000000055511151231257827021181583404541015625</code>; that&#39;s a pure, undeniable fact. the <b>exact</b> precision might not be <b>necessary</b>, but that isn&#39;t really for you to decide for them in a perfectly valid question"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 1061, "user_id": 9196467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hNr2MsW0o_M/AAAAAAAAAAI/AAAAAAAAAAk/yQ0PJK_IojU/photo.jpg?sz=128", "display_name": "Sampson Crowley", "link": "https://stackoverflow.com/users/9196467/sampson-crowley"}, "edited": false, "score": 0, "creation_date": 1593691639, "post_id": 47885304, "comment_id": 110872313, "body": "@SampsonCrowley The values of <code>0.1</code> and <code>0.1000000000000000055511151231257827021181583404541015625</code> are exactly the same (namely 0.1000000000000000055511151231257827021181583404541015625)."}, {"owner": {"reputation": 1061, "user_id": 9196467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hNr2MsW0o_M/AAAAAAAAAAI/AAAAAAAAAAk/yQ0PJK_IojU/photo.jpg?sz=128", "display_name": "Sampson Crowley", "link": "https://stackoverflow.com/users/9196467/sampson-crowley"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1593712777, "post_id": 47885304, "comment_id": 110883641, "body": "@StefanPochmann no... they are NOT <i>exactly</i> the same, one of them is <i>exactly</i> <code>0.1</code>, and the other is larger than <code>0.1</code> by <code>0.0000000000000000055511151231257827021181583404541015625</code>. I really don&#39;t understand how you possibly think those are the same number.  Again, the <b>precision</b> might not actually <b>matter</b> depending on the use-case, but that has nothing to do with the question"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 1061, "user_id": 9196467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hNr2MsW0o_M/AAAAAAAAAAI/AAAAAAAAAAk/yQ0PJK_IojU/photo.jpg?sz=128", "display_name": "Sampson Crowley", "link": "https://stackoverflow.com/users/9196467/sampson-crowley"}, "edited": false, "score": 0, "creation_date": 1593727599, "post_id": 47885304, "comment_id": 110889480, "body": "@SampsonCrowley They do have the exact same value. <code>0.1</code> is <b>not</b> 0.1 but 0.1000000000000000055511151231257827021181583404541015625. I suggest you learn how floating point works, maybe start <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">here</a>."}, {"owner": {"reputation": 1061, "user_id": 9196467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hNr2MsW0o_M/AAAAAAAAAAI/AAAAAAAAAAk/yQ0PJK_IojU/photo.jpg?sz=128", "display_name": "Sampson Crowley", "link": "https://stackoverflow.com/users/9196467/sampson-crowley"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1593740703, "post_id": 47885304, "comment_id": 110892060, "body": "@StefanPochmann you realize that&#39;s exactly the issue here right? that floating point numbers are <b>not</b> <i>accurate</i>. I didn&#39;t say <i>anything</i> about hardware representation inaccuracies, did I? I said <code>0.1</code> is <i>not</i> <code>0.1000000000000000055511151231257827021181583404541015625</code>. <b>Because it is not</b>. Literally this entire question is about <i>not</i> using <i>inaccurate</i> floating point numbers"}, {"owner": {"reputation": 1061, "user_id": 9196467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hNr2MsW0o_M/AAAAAAAAAAI/AAAAAAAAAAk/yQ0PJK_IojU/photo.jpg?sz=128", "display_name": "Sampson Crowley", "link": "https://stackoverflow.com/users/9196467/sampson-crowley"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1593741025, "post_id": 47885304, "comment_id": 110892118, "body": "@StefanPochmann at no point did you make the statement <i>decimal</i> <code>0.1</code> is <i>binary64</i> <code>0.1000000000000000055511151231257827021181583404541015625</code> those are comparing two completely different number <i>representations</i>, not two numbers"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 1061, "user_id": 9196467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hNr2MsW0o_M/AAAAAAAAAAI/AAAAAAAAAAk/yQ0PJK_IojU/photo.jpg?sz=128", "display_name": "Sampson Crowley", "link": "https://stackoverflow.com/users/9196467/sampson-crowley"}, "edited": false, "score": 0, "creation_date": 1593772816, "post_id": 47885304, "comment_id": 110902753, "body": "@SampsonCrowley Oh good, you&#39;re aware of the difference between numbers and number representations. Now you just need to realize that <code>0.1</code> and <code>0.1000000000000000055511151231257827021181583404541015625</code> are the same number (represented by the different representations &quot;<code>0.1</code>&quot; and &quot;<code>0.1000000000000000055511151231257827021181583404541015625</code>&quot;)&zwnj;&#8203;."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1593772821, "post_id": 47885304, "comment_id": 110902758, "body": "And in case it&#39;s not clear (although the guy I originally talked with understood me perfectly), I don&#39;t mark something as code just for fun (as it seems you do). I mark something as code so you read it as code. &quot;0.1&quot; and &quot;<code>0.1</code>&quot; are two different representations, the former of the number 0.1 and the latter of the number 0.1000000000000000055511151231257827021181583404541015625."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1513681413, "creation_date": 1513681413, "answer_id": 47885531, "question_id": 47885304, "link": "https://stackoverflow.com/questions/47885304/deserialise-json-numbers-as-bigdecimal/47885531#47885531", "title": "Deserialise json numbers as BigDecimal", "body": "<p>One might use any more sophisticated parser, like <a href=\"https://github.com/ohler55/oj\" rel=\"nofollow noreferrer\"><code>Oj</code></a>:</p>\n\n<pre><code>main \u25b6 Oj.load '{\"number\": 12.12345678910111213141516123456789123456789}'\n#\u21d2{\n#  \"number\" =&gt; 12.12345678910111213141516123456789123456789\n# }\nmain \u25b6 Oj.load('{\"number\": 12.12345678910111213141516}')[\"number\"].class\n#\u21d2 BigDecimal &lt; Numeric\n</code></pre>\n"}], "owner": {"reputation": 569, "user_id": 3797956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/36a6be2353c564135c691235a570be03?s=128&d=identicon&r=PG&f=1", "display_name": "pandomic", "link": "https://stackoverflow.com/users/3797956/pandomic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 47885531, "answer_count": 1, "score": 1, "last_activity_date": 1513686957, "creation_date": 1513680737, "last_edit_date": 1513686957, "question_id": 47885304, "link": "https://stackoverflow.com/questions/47885304/deserialise-json-numbers-as-bigdecimal", "title": "Deserialise json numbers as BigDecimal", "body": "<p>There is a json which contain numbers with long fractional part: </p>\n\n<pre><code>json = &lt;&lt;-JSON\n{\n  \"number\": 12.12345678910111213141516\n}\nJSON\n</code></pre>\n\n<p>But when making <code>JSON.parse</code> numbers become truncated:</p>\n\n<pre><code>require 'json'\nJSON.parse(json)\n#=&gt; {\"number\"=&gt;12.123456789101112}\n</code></pre>\n\n<p>But for me it's pretty critical to have the whole number.</p>\n\n<p>Is there any way to save fractional part and prevent it from truncating when parsing json?</p>\n"}, {"tags": ["ruby", "rspec", "filter-run-excluding"], "comments": [{"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 0, "creation_date": 1513709848, "post_id": 47885301, "comment_id": 82753523, "body": "Also discussed here: <a href=\"https://groups.google.com/forum/#!topic/rspec/5qeKQr_7G7k\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/rspec/5qeKQr_7G7k</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "is_accepted": true, "score": 0, "last_activity_date": 1513905630, "creation_date": 1513905630, "answer_id": 47934795, "question_id": 47885301, "link": "https://stackoverflow.com/questions/47885301/rspec-how-to-get-the-number-of-tests-excluded-by-c-filter-run-excluding/47934795#47934795", "title": "RSpec: How to get the number of tests excluded by `c.filter_run_excluding`?", "body": "<p>To answer my own question, based on the discussion I had with Myron Marston at <a href=\"https://groups.google.com/forum/#!topic/rspec/5qeKQr_7G7k\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/rspec/5qeKQr_7G7k</a>:</p>\n\n<p>RSpec does not provide a way to get the number of examples that are not run because of exclusion filters. But it provides a way to \"skip\" examples, which also marks the tests as \"pending\":</p>\n\n<blockquote>\n  <p>500 examples, 0 failures, 20 pending</p>\n</blockquote>\n\n<p>You tag the examples as before, then add:</p>\n\n<pre><code># spec_helper.rb\nrequire 'rbconfig'\n\nRSpec.configure do |config|\n  unless RbConfig::CONFIG['host_os'] =~ /darwin/\n    config.define_derived_metadata(:xcode) do |meta|\n      meta[:skip] = \"Can only be run on OS X\"\n    end\n  end\nend\n</code></pre>\n\n<p>This will add <code>:skip</code> to all examples that are tagged with <code>:xcode</code> when run on a system that is not macOS.</p>\n\n<p>A special case are examples that trigger a <code>before(:all)</code> hook:</p>\n\n<p>If your tags are only active under special conditions (e.g. when the tests are run on a specific platform), you can manually \"skip\" out of execution of the hook by checking the same condition:</p>\n\n<pre><code>before(:all) do\n  skip \"reason to skip\" if should_skip?\n  # rest of your hook logic\nend\n</code></pre>\n\n<p>Alternatively, you can override the hook globally and access the metadata created by tagging again:</p>\n\n<pre><code>module HookOverrides   \n  def before(*args)\n    super unless metadata[:skip]   \n  end \nend\n\nRSpec.configure do |c|   \n  c.extend HookOverrides \nend\n</code></pre>\n\n<p>Constraint here: You have to tag the parent element (most probably a example group via <code>describe</code>) of the hook, only then the metadata will be available in the hook. You can't just tag the individual examples (as they are \"behind\" the hook) and excluding individual examples to not be skipped by setting <code>skip: false</code> will also not work.</p>\n\n<p>And that's it. Read the whole mail thread at <a href=\"https://groups.google.com/forum/#!topic/rspec/5qeKQr_7G7k\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/rspec/5qeKQr_7G7k</a> for details.</p>\n\n<p>Thanks to Myron for taking the time to help me with that, I very much appreciate it.</p>\n"}], "owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 47934795, "answer_count": 1, "score": 0, "last_activity_date": 1513905722, "creation_date": 1513680724, "last_edit_date": 1513905722, "question_id": 47885301, "link": "https://stackoverflow.com/questions/47885301/rspec-how-to-get-the-number-of-tests-excluded-by-c-filter-run-excluding", "title": "RSpec: How to get the number of tests excluded by `c.filter_run_excluding`?", "body": "<p>RSpec has this nice method to exclude individual tests/examples or whole groups by using <code>filter_run_excluding</code> in the config, then tagging the examples:</p>\n\n<ul>\n<li><a href=\"http://rspec.info/documentation/3.7/rspec-core/RSpec/Core/Configuration.html#filter_run_excluding-instance_method\" rel=\"nofollow noreferrer\">http://rspec.info/documentation/3.7/rspec-core/RSpec/Core/Configuration.html#filter_run_excluding-instance_method</a></li>\n<li><a href=\"https://relishapp.com/rspec/rspec-core/v/3-7/docs/filtering/exclusion-filters\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-core/v/3-7/docs/filtering/exclusion-filters</a></li>\n</ul>\n\n<p>Example:</p>\n\n<pre><code>RSpec.configure do |c|\n  c.filter_run_excluding :xcode =&gt; true\nend\n\nRSpec.describe \"something\" do\n  it \"does one thing\" do\n  end\n\n  it \"does another thing that needs xcode\", :xcode =&gt; true do\n  end\nend\n</code></pre>\n\n<p>\"does one thing\" will be checked,<br>\n\"does another thing\" will not.</p>\n\n<hr>\n\n<p>We are using this for example to skip some tests depending on the platform the test is run on by wrapping the <code>c.filter_run_excluding :skip =&gt; true</code> in an <code>if</code> block:</p>\n\n<pre><code>If Mac, \n   no exclusions, \nif Ubuntu, \n   exclude tests that do something with Xcode.\n</code></pre>\n\n<hr>\n\n<p>Right now the numbers of passing examples/tests is just lower if the exclusion filter is used, but it would be nice to see the actual number of tests that are skipped.</p>\n\n<p>Is there a way to get the number of tests skipped by this method during a test run?</p>\n"}, {"tags": ["javascript", "arrays", "ruby"], "comments": [{"owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1513680124, "post_id": 47885018, "comment_id": 82735943, "body": "What have you tried so far? You might find useful something like select2 <a href=\"https://teamtreehouse.com/library/using-select2-with-ruby-on-rails\" rel=\"nofollow noreferrer\">teamtreehouse.com/library/using-select2-with-ruby-on-rails</a>"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 4975242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nlzTEsKNwn4/AAAAAAAAAAI/AAAAAAAAA0w/LOAdMJlXg3M/photo.jpg?sz=128", "display_name": "jumarov", "link": "https://stackoverflow.com/users/4975242/jumarov"}, "is_accepted": false, "score": 0, "last_activity_date": 1513680276, "creation_date": 1513680276, "answer_id": 47885176, "question_id": 47885018, "link": "https://stackoverflow.com/questions/47885018/searching-for-a-set-of-phrases-in-a-text-javascript-ror/47885176#47885176", "title": "Searching for a set of phrases in a text (JavaScript, RoR)", "body": "<p>Your problem is more generic one. Probably using a library will be more appropriate here.\nE.g <a href=\"http://fusejs.io/\" rel=\"nofollow noreferrer\">http://fusejs.io/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9117489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55f40f5accdb326ce919097b7355bc0d?s=128&d=identicon&r=PG&f=1", "display_name": "potniatheron", "link": "https://stackoverflow.com/users/9117489/potniatheron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1513680276, "creation_date": 1513679751, "question_id": 47885018, "link": "https://stackoverflow.com/questions/47885018/searching-for-a-set-of-phrases-in-a-text-javascript-ror", "title": "Searching for a set of phrases in a text (JavaScript, RoR)", "body": "<p>I need to use the information stored on the database to perform a research on a text. What I am trying to achieve is:</p>\n\n<ol>\n<li>Returning one of my database columns as an array.</li>\n<li>Using this data to perform a query on a text.</li>\n<li>If an item of the array corresponds to a portion of text, this one will be underlined.</li>\n</ol>\n\n<p>Should I use a regex, and, if so, what is the correct syntax?</p>\n"}, {"tags": ["ruby", "encoding"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1513679534, "post_id": 47884878, "comment_id": 82735549, "body": "That said, you want to get an <code>U+FFFD</code> codepoint reserved for <a href=\"https://unicode-table.com/en/search/?q=FFFD\" rel=\"nofollow noreferrer\">replacement character</a>? Just print it out: \ufffd, there is no other way to get it from <code>&#254;</code>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1513681574, "post_id": 47884878, "comment_id": 82736780, "body": "Ruby 1.8 had only limited support for Unicode. Do you really need this to work in a Ruby version that was released almost 10 years ago and reached its end of life more than 4 years ago?"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513684099, "post_id": 47884878, "comment_id": 82738185, "body": "Why do you find that 1.8.7 result more desirable?"}, {"owner": {"reputation": 35, "user_id": 2732473, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e7359649f9111a72894da1a2aeaef3be?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Rawat", "link": "https://stackoverflow.com/users/2732473/tarun-rawat"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1513745390, "post_id": 47884878, "comment_id": 82764540, "body": "@StefanPochmann, 1.8.7 result is desirable as it is giving me &quot;254&quot; after decoding. Please check following issue with Ruby-2.4.1 :  <i>puts &quot;#{&quot;%d&quot;%[ &#254;]}&quot;</i>  Output :-  <b>`%&#39;: invalid value for Integer(): &quot;&#254;&quot; (ArgumentError)</b>"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 2732473, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e7359649f9111a72894da1a2aeaef3be?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Rawat", "link": "https://stackoverflow.com/users/2732473/tarun-rawat"}, "edited": false, "score": 0, "creation_date": 1513766883, "post_id": 47894892, "comment_id": 82775098, "body": "There is a problem with decoding in Ruby-2.4.1, which is throwing error :  <b>%&#39;: invalid value for Integer(): &quot;&#254;&quot; (ArgumentError)</b>"}], "tags": [], "owner": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "is_accepted": false, "score": 0, "last_activity_date": 1513716200, "creation_date": 1513716200, "answer_id": 47894892, "question_id": 47884878, "link": "https://stackoverflow.com/questions/47884878/encoding-issues-with-ruby-2-4-1/47894892#47894892", "title": "Encoding issues with Ruby-2.4.1", "body": "<p>I don't know much about Ruby 1.8.7, as I started Ruby with version 2.3, but this looks promising: <a href=\"https://gist.github.com/afair/2911107\" rel=\"nofollow noreferrer\">https://gist.github.com/afair/2911107</a></p>\n\n<p>But as everyone else is saying it would be best to upgrade your Ruby version if at all possible. Older versions of Ruby had limited Unicode support.</p>\n"}], "owner": {"reputation": 35, "user_id": 2732473, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e7359649f9111a72894da1a2aeaef3be?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Rawat", "link": "https://stackoverflow.com/users/2732473/tarun-rawat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1513745663, "creation_date": 1513679257, "last_edit_date": 1513745663, "question_id": 47884878, "link": "https://stackoverflow.com/questions/47884878/encoding-issues-with-ruby-2-4-1", "title": "Encoding issues with Ruby-2.4.1", "body": "<p>I am having different output of following line with different version of ruby:</p>\n\n<pre><code>puts \"#{\"%c\"%[254]}\"\n</code></pre>\n\n<p>Output from <code>ruby-2.4.1</code>  :    <strong>\u00fe</strong></p>\n\n<p>Output from <code>ruby-1.8.7</code>  :    <strong>\ufffd</strong></p>\n\n<p>It looks like issue with encoding, as there is no encoding in <code>Ruby-1.8.7</code></p>\n\n<p>Can someone please help me to get same result as <code>Ruby-1.8.7</code> in <code>Ruby-2.4.1</code> also?</p>\n\n<p>This result is desirable because Ruby-1.8.7 gives me \"<strong>254\"</strong> after decoding while Ruby-2.4.1 gives me following error </p>\n\n<p><em>`%': <strong>invalid value for Integer(): \"\u00fe\" (ArgumentError)</em></strong></p>\n"}, {"tags": ["ruby", "twilio-api", "freeswitch", "ivr", "adhearsion"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9116831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/262f1aa697a2406053503fd515d299ca?s=128&d=identicon&r=PG&f=1", "display_name": "G&#233;rard Bisama", "link": "https://stackoverflow.com/users/9116831/g%c3%a9rard-bisama"}, "edited": false, "score": 0, "creation_date": 1515760786, "post_id": 47897947, "comment_id": 83434589, "body": "Hi @dwilkie, thank for your help. I have been able to install and to test all the five components with docker after uninstalling the first somleng project and used RapidPro TwiML REST API channel. And used <a href=\"http://twimldockerip:3000/api/2010-04-01\" rel=\"nofollow noreferrer\">twimldockerip:3000/api/2010-04-01</a> with 1234 as phone number. But when I try to test the flow I get this message that says &quot; no route matchies api/2010-04-01/&lt;accound_sid&gt;....&#39; . Any help?"}, {"owner": {"reputation": 523, "user_id": 449106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/768cc7e112f643efcb03dd3d646320f3?s=128&d=identicon&r=PG", "display_name": "dwilkie", "link": "https://stackoverflow.com/users/449106/dwilkie"}, "reply_to_user": {"reputation": 1, "user_id": 9116831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/262f1aa697a2406053503fd515d299ca?s=128&d=identicon&r=PG&f=1", "display_name": "G&#233;rard Bisama", "link": "https://stackoverflow.com/users/9116831/g%c3%a9rard-bisama"}, "edited": false, "score": 0, "creation_date": 1516354527, "post_id": 47897947, "comment_id": 83660999, "body": "No route matches [POST] &quot;/2010-04-01/Accounts/8461e585-9d4f-4f6e-9847-dddc9594f190/C&zwnj;&#8203;alls.json&quot; the correct URL should be something like: &quot;/api/2010-04-01/Accounts/8461e585-9d4f-4f6e-9847-dddc9594f1&zwnj;&#8203;90/Calls.json&quot;"}, {"owner": {"reputation": 1, "user_id": 9116831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/262f1aa697a2406053503fd515d299ca?s=128&d=identicon&r=PG&f=1", "display_name": "G&#233;rard Bisama", "link": "https://stackoverflow.com/users/9116831/g%c3%a9rard-bisama"}, "edited": false, "score": 0, "creation_date": 1516868866, "post_id": 47897947, "comment_id": 83868018, "body": "Hi @dwilkie, thanks again for your help. I have been able to connect RapidPro to twiML channel. As you said the problem was on the url: I have used <a href=\"http://twilreapiIP:3000/api\" rel=\"nofollow noreferrer\">twilreapiIP:3000/api</a> and the channel works when I test the call with simulator. I expect to get the simbox very soon so I can test in the real environment. I will not hesitate to ask again some question if needed. Thanks"}], "tags": [], "owner": {"reputation": 523, "user_id": 449106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/768cc7e112f643efcb03dd3d646320f3?s=128&d=identicon&r=PG", "display_name": "dwilkie", "link": "https://stackoverflow.com/users/449106/dwilkie"}, "is_accepted": false, "score": 0, "last_activity_date": 1513736853, "creation_date": 1513736853, "answer_id": 47897947, "question_id": 47884867, "link": "https://stackoverflow.com/questions/47884867/make-a-call-and-retreive-a-call-with-somleng/47897947#47897947", "title": "Make a call and retreive a call with somleng", "body": "<p>The <a href=\"https://github.com/somleng/somleng-project/blob/master/docs/GETTING_STARTED.md\" rel=\"nofollow noreferrer\">GETTING STARTED guide</a> for Somleng describes how to get started with docker and docker-compose. The <a href=\"https://github.com/somleng/somleng-project/blob/master/docker-compose.yml\" rel=\"nofollow noreferrer\">docker-compose configuration file</a> contains 5 services, <a href=\"https://github.com/somleng/twilreapi\" rel=\"nofollow noreferrer\">Twilreapi</a> (Open Source Implementation of Twilio's REST API), <a href=\"https://github.com/somleng/somleng\" rel=\"nofollow noreferrer\">Somleng-Adhearsion</a> (Adhearsion Application configured for Somleng), <a href=\"https://github.com/somleng/freeswitch-config\" rel=\"nofollow noreferrer\">FreeSWITCH configuration</a> (configuration files for FreeSWITCH optimized for Somleng), <a href=\"http://www.linphone.org/\" rel=\"nofollow noreferrer\">Linphone</a> (A docker image for Linphone - a softphone) and <a href=\"https://curl.haxx.se/\" rel=\"nofollow noreferrer\">CURL</a>.</p>\n\n<p>The instructions in the <a href=\"https://github.com/somleng/somleng-project/blob/master/docs/GETTING_STARTED.md\" rel=\"nofollow noreferrer\">GETTING STARTED guide</a> show you how to bring up the services and make a test call through the REST API. There are also instructions on how to test an incoming call.</p>\n\n<p>Once you have the services booted using Docker, you should be able to setup a RapidPro channel and point it the the REST API endpoint.</p>\n"}], "owner": {"reputation": 1, "user_id": 9116831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/262f1aa697a2406053503fd515d299ca?s=128&d=identicon&r=PG&f=1", "display_name": "G&#233;rard Bisama", "link": "https://stackoverflow.com/users/9116831/g%c3%a9rard-bisama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514471247, "creation_date": 1513679226, "last_edit_date": 1514471247, "question_id": 47884867, "link": "https://stackoverflow.com/questions/47884867/make-a-call-and-retreive-a-call-with-somleng", "title": "Make a call and retreive a call with somleng", "body": "<p>I am very interested to start working on IVRs project. After some researches I have discovered the somleng project (<a href=\"https://medium.com/@dwilkie_34546/somleng-an-open-source-twilio-clone-a297062b340d\" rel=\"nofollow noreferrer\">https://medium.com/@dwilkie_34546/somleng-an-open-source-twilio-clone-a297062b340d</a>).\nI have tried to install the full packages on ubuntu 14.04 using docker but the freeswitch was not working and the adhearsion could not connect to it.\nI have decided then to install every components individually:adhearsion-twilio, freeswitch,twilreapi.\nI have configured mod-rayo and every individual test seems to work fine.\nI have started the twilreapi and initial the following call:</p>\n\n<blockquote>\n  <p>curl -XPOST\n  <a href=\"http://localhost:3000/api/2010-04-01/Accounts/35af2347-5656-44fb-ba83-2d1bdd9c593b/Calls.json\" rel=\"nofollow noreferrer\">http://localhost:3000/api/2010-04-01/Accounts/35af2347-5656-44fb-ba83-2d1bdd9c593b/Calls.json</a>\n  -d \"Method=GET\" -d \"Url=<a href=\"http://demo.twilio.com/docs/voice.xml\" rel=\"nofollow noreferrer\">http://demo.twilio.com/docs/voice.xml</a>\" -d \"To=+85510202101\" -d \"From=1234\" -u\n  '35af2347-5656-44fb-ba83-2d1bdd9c593b:0c5388fa8fafaa8f73c62ee13e57030c1d4e3c01361f5b2445e844ae6f4f1c19'</p>\n</blockquote>\n\n<p>and I have this response:</p>\n\n<blockquote>\n  <p>{\"to\":\"+85510202101\",\"from\":\"1234\",\"status\":\"queued\",\"sid\":\"fcfcbd36-3186-4e78-8099-91956ebb2fc5\",\"account_sid\":\"35af2347-5656-44fb-ba83-2d1bdd9c593b\",\"uri\":\"/api/2010-04-01/Accounts/35af2347-5656-44fb-ba83-2d1bdd9c593b/Calls/fcfcbd36-3186-4e78-8099-91956ebb2fc5\",\"date_created\":\"Tue,\n  19 Dec 2017 10:12:13 +0000\",\"date_updated\":\"Tue, 19 Dec 2017 10:12:13\n  +0000\",\"api_version\":\"2010-04-01\",\"annotation\":null,\"answered_by\":null,\"caller_name\":null,\"direction\":\"outbound-api\",\"duration\":null,\"end_time\":null,\"forwarded_from\":null,\"from_formatted\":\"+1\n  (234)\n  \",\"group_sid\":null,\"parent_call_sid\":null,\"phone_number_sid\":null,\"price\":null,\"price_unit\":null,\"start_time\":null,\"subresource_uris\":{},\"to_formatted\":\"+855\n  10 202 101\"}</p>\n</blockquote>\n\n<p>But I dont see any logs activities at the adhearsion side or freeswitch.\nIs it normal?</p>\n\n<p>My other question is this: pratically how can I initiate a call and get response from this plate form using rapidpro or any softphone (I have installed X-lite and test it with freeswitch, it worked fine).</p>\n\n<hr>\n\n<p>Hi @dwilkie, thank for your help. I have been able to install and to test all the five components with docker after uninstalling the first somleng project. Now I try to connect to rapidpro. I went to these steps:\n1. Get the ip address of the twilreapi docker container to be able to build the API url. I have used docker ps command\n2. add a twiML api channel with \nNumber: 1234\nTwiML REST API Host:  <a href=\"http://172.18.0.6:3000\" rel=\"nofollow noreferrer\">http://172.18.0.6:3000</a>\nRole: Voice\nthe the account sid and the account token\nBut after the  validation on rapidpro I have this message</p>\n\n<p>\"\nTo finish configuring your TwiML REST API channel you'll need to add the following URL in your TwiML REST API instance.</p>\n\n<p>TwiML REST API Host\nThe endpoint which will receive Twilio API requests for this channel\n<a href=\"http://172.18.0.6:3000\" rel=\"nofollow noreferrer\">http://172.18.0.6:3000</a>\nRequest URL\nIncoming messages for this channel will be sent to this endpoint.\n<a href=\"https://temba.ngrok.io/handlers/twiml_api/ff560773-3421-48a3-a241-c492c78dbcc4\" rel=\"nofollow noreferrer\">https://temba.ngrok.io/handlers/twiml_api/ff560773-3421-48a3-a241-c492c78dbcc4</a>\n\"\nI have ignored this message and build a voice flow in rapidpro. but when I start the flow in rapidpro I dont see any log info at the twilreapi_1/somleng side but when I use the rapidpro simulator to test the flow I have this message\n\"\ntwilreapi_1   | Started POST \"/2010-04-01/Accounts/8461e585-9d4f-4f6e-9847-dddc9594f190/Calls.json\" for 172.18.0.1 at 2017-12-28 14:13:03 +0000\ntwilreapi_1   |<br>\ntwilreapi_1   | ActionController::RoutingError (No route matches [POST] \"/2010-04-01/Accounts/8461e585-9d4f-4f6e-9847-dddc9594f190/Calls.json\"):\ntwilreapi_1   |<br>\ntwilreapi_1   | actionpack (5.1.3) lib/action_dispatch/middleware/debug_exceptions.rb:63:in <code>call'\ntwilreapi_1   | actionpack (5.1.3) lib/action_dispatch/middleware/show_exceptions.rb:31:in</code>call'\ntwilreapi_1   | railties (5.1.3) lib/rails/rack/logger.rb:36:in <code>call_app'\ntwilreapi_1   | railties (5.1.3) lib/rails/rack/logger.rb:24:in</code>block in call'\ntwilreapi_1   | activesupport (5.1.3) lib/active_support/tagged_logging.rb:69:in <code>block in tagged'\ntwilreapi_1   | activesupport (5.1.3) lib/active_support/tagged_logging.rb:26:in</code>tagged'\ntwilreapi_1   | activesupport (5.1.3) lib/active_support/tagged_logging.rb:69:in <code>tagged'\ntwilreapi_1   | railties (5.1.3) lib/rails/rack/logger.rb:24:in</code>call'\ntwilreapi_1   | actionpack (5.1.3) lib/action_dispatch/middleware/remote_ip.rb:79:in <code>call'\ntwilreapi_1   | actionpack (5.1.3) lib/action_dispatch/middleware/request_id.rb:25:in</code>call'\ntwilreapi_1   | rack (2.0.3) lib/rack/method_override.rb:22:in <code>call'\ntwilreapi_1   | rack (2.0.3) lib/rack/runtime.rb:22:in</code>call'\ntwilreapi_1   | activesupport (5.1.3) lib/active_support/cache/strategy/local_cache_middleware.rb:27:in <code>call'\ntwilreapi_1   | actionpack (5.1.3) lib/action_dispatch/middleware/executor.rb:12:in</code>call'\ntwilreapi_1   | actionpack (5.1.3) lib/action_dispatch/middleware/static.rb:125:in <code>call'\ntwilreapi_1   | rack (2.0.3) lib/rack/sendfile.rb:111:in</code>call'\ntwilreapi_1   | railties (5.1.3) lib/rails/engine.rb:522:in <code>call'\ntwilreapi_1   | puma (3.9.1) lib/puma/configuration.rb:224:in</code>call'\ntwilreapi_1   | puma (3.9.1) lib/puma/server.rb:602:in <code>handle_request'\ntwilreapi_1   | puma (3.9.1) lib/puma/server.rb:435:in</code>process_client'\ntwilreapi_1   | puma (3.9.1) lib/puma/server.rb:299:in <code>block in run'\ntwilreapi_1   | puma (3.9.1) lib/puma/thread_pool.rb:120:in</code>block in spawn_thread'\n\"</p>\n"}, {"tags": ["ruby", "openssl"], "comments": [{"owner": {"reputation": 8454, "user_id": 958529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3ec25db39c63bab1a11037649e326b8?s=128&d=identicon&r=PG", "display_name": "halfelf", "link": "https://stackoverflow.com/users/958529/halfelf"}, "edited": false, "score": 1, "creation_date": 1513677751, "post_id": 47883513, "comment_id": 82734460, "body": "After a few test, it seems <code>require &#39;openssl&#39;</code> is OK to create the cipher while <code>require &#39;openssl&#47;cipher&#39;</code> not."}, {"owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "reply_to_user": {"reputation": 8454, "user_id": 958529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3ec25db39c63bab1a11037649e326b8?s=128&d=identicon&r=PG", "display_name": "halfelf", "link": "https://stackoverflow.com/users/958529/halfelf"}, "edited": false, "score": 0, "creation_date": 1513685202, "post_id": 47883513, "comment_id": 82738902, "body": "Thanks @halfelf. Solved. If you put it as a proper answer I&#39;ll choose it (not sure what the etiquette is here)."}], "owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513677230, "creation_date": 1513674908, "question_id": 47883513, "link": "https://stackoverflow.com/questions/47883513/ruby-openssl-cipher-initialization", "title": "Ruby OpenSSL cipher initialization", "body": "<p>I open <code>irb</code> and run the following:</p>\n\n<pre><code>require 'openssl/cipher'\ncipher = OpenSSL::Cipher.new('AES-128-CBC')\n</code></pre>\n\n<p>But I get the error message:</p>\n\n<pre><code>ArgumentError: wrong number of arguments (given 1, expected 0)\nfrom (irb):4:in `initialize'\nfrom (irb):4:in `new'\nfrom (irb):4\nfrom ~/.rvm/rubies/ruby-2.4.2/bin/irb:11:in `&lt;main&gt;'\n</code></pre>\n\n<p>My Ruby version:</p>\n\n<pre><code>$ ruby --version\nruby 2.4.2p198 (2017-09-14 revision 59899) [x86_64-darwin15]\n</code></pre>\n\n<p>I am following <a href=\"http://ruby-doc.org/stdlib-2.4.2/libdoc/openssl/rdoc/OpenSSL/Cipher.html\" rel=\"nofollow noreferrer\">the docs</a>, but can't see why this isn't working.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 696, "user_id": 7314004, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/95806024183ca05eed5c8a100c610ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter H&#248;jlund Andersen", "link": "https://stackoverflow.com/users/7314004/peter-h%c3%b8jlund-andersen"}, "edited": false, "score": 0, "creation_date": 1513677224, "post_id": 47883439, "comment_id": 82734116, "body": "Is everything working in the controller as it should? Do you have a valid <code>@items</code> before <code>respond_to do ...</code>? If, you need to append the data to your erb. Right now you&#39;re just showing the tab, but the data is not being appended."}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 696, "user_id": 7314004, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/95806024183ca05eed5c8a100c610ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter H&#248;jlund Andersen", "link": "https://stackoverflow.com/users/7314004/peter-h%c3%b8jlund-andersen"}, "edited": false, "score": 0, "creation_date": 1513682099, "post_id": 47883439, "comment_id": 82737054, "body": "Thanks for the reply @Peter Andersen! Yes everything is working as it should, I&#39;m getting a valid <code>@items</code> and thus the results from my search are showing up, I just don&#39;t won it to refresh the page. Also, I have a <code>search.js.erb</code> with this inside <code>$(&quot;#items&quot;).innerHTML += &quot;&lt;%= escape_javascript(render(:partial =&gt; &#39;search&#39;)) %&gt;&quot;</code>"}, {"owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "edited": false, "score": 0, "creation_date": 1513685500, "post_id": 47883439, "comment_id": 82739071, "body": "Do you have any error on rails console and on browser console?"}], "answers": [{"comments": [{"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1513684225, "post_id": 47886007, "comment_id": 82738257, "body": "Thanks for the reply @Manishh! I changes <code>innerHTML</code> to this <code>$(&quot;#items&quot;).append(&quot;&lt;%= escape_javascript(render partial: &#39;search_results&#39;, locals: { items: @items } ) %&gt;&quot;);</code> but still the page reloads upon the search!"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1513686074, "post_id": 47886007, "comment_id": 82739428, "body": "I&#39;m not getting any error inside the browser inspector and the terminal as well.... weird! I also added the <code>return false</code>"}], "tags": [], "owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "is_accepted": false, "score": 0, "last_activity_date": 1513685615, "last_edit_date": 1513685615, "creation_date": 1513682923, "answer_id": 47886007, "question_id": 47883439, "link": "https://stackoverflow.com/questions/47883439/rails-show-search-results-without-refreshing-tab/47886007#47886007", "title": "Rails: Show search results without refreshing tab", "body": "<p>I think the issue is with innerHTML on jquery object. You should use append instead of innerHTML. Open console and check you might be getting error of innerHTML is not a function. And put <code>return false</code> at the end of  <code>$('#tabs').on('click','.tablink,#prodTabs a',function (e) {</code> code.</p>\n"}, {"tags": [], "owner": {"reputation": 696, "user_id": 7314004, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/95806024183ca05eed5c8a100c610ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter H&#248;jlund Andersen", "link": "https://stackoverflow.com/users/7314004/peter-h%c3%b8jlund-andersen"}, "is_accepted": false, "score": 0, "last_activity_date": 1513688980, "creation_date": 1513688980, "answer_id": 47887779, "question_id": 47883439, "link": "https://stackoverflow.com/questions/47883439/rails-show-search-results-without-refreshing-tab/47887779#47887779", "title": "Rails: Show search results without refreshing tab", "body": "<p>You need to append the data to your view, but something is wrong in your jQuery. </p>\n\n<p>So, let's try the Rails way. </p>\n\n<p>When you use </p>\n\n<pre><code>respond_to do |format|\n  format.html\n  format.js \nend\n</code></pre>\n\n<p>You have the <code>search.js.erb</code> to handle your variables in the corresponding view folder <code>views/controller_name/search.js.erb</code> </p>\n\n<p>If you create that file and do the same thing as you wrote before: </p>\n\n<p><em>By the way - you can use the shortcut: <code>&lt;%=j(...) %&gt;</code> instead of <code>&lt;%= escape_javascript(..) %&gt;</code> if you want to</em></p>\n\n<pre><code>$(\"#items\").append(\"&lt;%=j(render partial: 'search_results', locals: { items: @items } ) %&gt;\");\n// show something\n</code></pre>\n\n<p>You can remove your jQuery. Rails knows that you want to submit the data to the corresponding url <code>search_term_path</code> when you hit 'Search'.</p>\n\n<p>I think it will work, and you will save some code.</p>\n\n<p>But you need to be sure that your search_terms_path is set up properly, or else the <code>form_tag</code> will not 'hit' the controller action.</p>\n\n<p>I would recommend reading <a href=\"http://guides.rubyonrails.org/working_with_javascript_in_rails.html\" rel=\"nofollow noreferrer\">Working with javascript in Rails</a> for further info.</p>\n\n<p>And remember to check that your partial file: \u00b4_search_result.html.erb\u00b4 is without errors.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513688980, "creation_date": 1513674612, "question_id": 47883439, "link": "https://stackoverflow.com/questions/47883439/rails-show-search-results-without-refreshing-tab", "title": "Rails: Show search results without refreshing tab", "body": "<p>I have a search <code>form_tag</code> inside a <code>bootstrap tab</code> and I would like to show the results without refreshing the page and inside the <code>tab</code>.</p>\n\n<p>I added the <code>remote: true</code> to the <code>form_tag</code> along with the <code>respond_to do |format|</code> to the search action inside the controller, but when I submit the search the page still reloads.</p>\n\n<p>this is the setup I have thus far?</p>\n\n<p>search.html.errb</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n&lt;div id=\"tabs\"&gt;\n  &lt;ul class=\"nav nav-tabs\" id=\"prodTabs\"&gt;\n    &lt;li class=\"active\"&gt;&lt;a href=\"#nsearch\"&gt;Search&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"#other\"&gt;Other&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"#about\"&gt;About&lt;/a&gt;&lt;/li&gt;\n  &lt;/ul&gt;\n\n  &lt;div class=\"tab-content\"&gt;\n    &lt;div class=\"tab-pane active\" id=\"search\"&gt;\n\n      &lt;%= render 'pages/search' %&gt;\n\n      &lt;% if params[:search].present? %&gt;\n          &lt;% if @items.blank? %&gt;\n\n              &lt;div class=\"centerList\"&gt;\n                &lt;p&gt;No results found&lt;/p&gt;\n              &lt;/div&gt;\n\n          &lt;% else %&gt;\n\n              &lt;h5&gt; Result:&lt;/h5&gt;\n              &lt;% @items.each do |item|%&gt;\n\n                 &lt;% unless item.attachments.blank? %&gt;\n                 &lt;%= image_tag item.attachments.first&amp;.url(:mini) %&gt;\n                            &lt;% end %&gt;\n\n                  &lt;%= link_to item.title, items_show_path(item) %&gt;&lt;/h4&gt;\n                  &lt;strong&gt;Price: &lt;/strong&gt;&lt;%= number_to_currency item.price %&gt;\n\n\n&lt;script&gt;\n  $('#tabs').on('click','.tablink,#prodTabs a',function (e) {\n      e.preventDefault();\n      var url = $(this).attr(\"data-url\");\n\n      if (typeof url !== \"undefined\") {\n          var pane = $(this), href = this.hash;\n\n          // ajax load from data-url\n          $(href).load(url,function(result){\n              pane.tab('show');\n          });\n      } else {\n          $(this).tab('show');\n      }\n  });\n</code></pre>\n\n<p></p>\n\n<p>_search.html.erb</p>\n\n<pre><code>&lt;%= form_tag search_items_path, remote: true, :method =&gt; \"get\" do %&gt;\n    &lt;%= text_field_tag :search, params[:search], autofocus: true,\n                   class: \"search-query search_size\",\n                   placeholder: \"Enter keyword to search\" %&gt;\n&lt;%= submit_tag \"Search\", name: nil, :style =&gt; \"display: none;\" %&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>controller action:</p>\n\n<pre><code>def search\n  if params[:search]\n    @items = Item.search(params[:search]).order(\"created_at DESC\")\n\n     respond_to do |format|\n      format.js\n      format.html\n     end\n  end\nend\n</code></pre>\n\n<p>Any ideas how to fix this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano", "sidekiq", "jobs"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 6, "creation_date": 1513674274, "post_id": 47883283, "comment_id": 82732305, "body": "Yep, downvotes is what I&#39;m here for."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 4, "creation_date": 1513678932, "post_id": 47883283, "comment_id": 82735163, "body": "I am unsure why this question was downvoted; upvoted for the sake of entropy constancy."}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1513679151, "post_id": 47883283, "comment_id": 82735305, "body": "It seems you have a lot of jobs/long job and Sidekiq with concurrency=1. You can try to check what is going on with rails console and <a href=\"https://github.com/mperham/sidekiq/wiki/API\" rel=\"nofollow noreferrer\">github.com/mperham/sidekiq/wiki/API</a>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513679204, "post_id": 47883283, "comment_id": 82735337, "body": "Have you tried three different sidekiq runners, one per queue, as <a href=\"https://github.com/mperham/sidekiq/wiki/Advanced-Options#queues\" rel=\"nofollow noreferrer\">described here</a>?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513679234, "post_id": 47883283, "comment_id": 82735356, "body": "Also, increase a concurrency to be at least <code>10</code>."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513679850, "post_id": 47883283, "comment_id": 82735763, "body": "@mudasobwa it is working locally when I do <code>bundle exec sidekiq --config config&#47;sidekiq.yml</code> - jobs on all three queues are being executed. What I initially wanted is actually having those reserved queues you mentioned, but I do not know how to set it up with capistrano&#39;s <code>deploy.rb</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1513680132, "post_id": 47883283, "comment_id": 82735950, "body": "That\u2019s not a duty of capistrano: you deploy it once, you start it three times. Just create three <code>upstart</code>/<code>systemctl</code> configs for them."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513754109, "post_id": 47883283, "comment_id": 82767720, "body": "@mudasobwa true, worked. Please, make your suggestion an answer if you will, I&#39;ll accept it. Thanks for hints!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513754774, "post_id": 47883283, "comment_id": 82768061, "body": "@AndreyDeineko I believe you\u2019d better describe the winning path that is proven to work. This could be a good reference in the future for \u201csidekiq queue problem\u201d landing, so it makes sense to provide a good answer that works rather than a good hint that helped :)"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513755404, "post_id": 47883283, "comment_id": 82768349, "body": "@mudasobwa damn man how are you so right every single time? :) I&#39;ll make sure to describe the solution later (I still have to set up the <code>systemctl</code> config - ATM I just have tested it with manually firing 3 queues on prod server)."}, {"owner": {"reputation": 6692, "user_id": 762747, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2e07fdac9a5b0de8a17a0e5b6a77acef?s=128&d=identicon&r=PG", "display_name": "amit_saxena", "link": "https://stackoverflow.com/users/762747/amit-saxena"}, "edited": false, "score": 0, "creation_date": 1554303594, "post_id": 47883283, "comment_id": 97703524, "body": "Also the way you define your queues implies all jobs in slack_notifier get processed first, then invoicing and last the jobs in default. That might be the reason for delay. You can use [slack_notifier, 2] notation instead where the second number is the weight which tells sidekiq that this queue must be checked twice as often (in case default was [default, 1])."}], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 4523270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tfkMY.jpg?s=128&g=1", "display_name": "usama", "link": "https://stackoverflow.com/users/4523270/usama"}, "is_accepted": false, "score": 0, "last_activity_date": 1604911628, "creation_date": 1604911628, "answer_id": 64748369, "question_id": 47883283, "link": "https://stackoverflow.com/questions/47883283/sidekiq-with-multiple-queues-jobs-get-stuck/64748369#64748369", "title": "sidekiq with multiple queues: jobs get stuck", "body": "<p>Maybe you can run multiple processes for all queues, put separate queues in separate processes for processing sidekiq jobs. Your configuration will look like this</p>\n<pre><code>set :sidekiq_processes, 3\nset :sidekiq_options_per_process, ['--queue slack_notifier', '--queue invoicing', '--queue default']\n</code></pre>\n<p>I think it will not halt the sidekiq, but the precondition to everything is your sidekiq processes are optimized enough so they are not taking more memory than they are supposed to be using.</p>\n"}], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1507, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1604911628, "creation_date": 1513674044, "question_id": 47883283, "link": "https://stackoverflow.com/questions/47883283/sidekiq-with-multiple-queues-jobs-get-stuck", "title": "sidekiq with multiple queues: jobs get stuck", "body": "<p>I have recently had to prioritize my Sidekiq queues (before I was using only the <code>default</code> queue).</p>\n\n<p>So I have written few jobs which are supposed to be executed on the different queues.</p>\n\n<p>My <code>sidekiq.yml</code>:</p>\n\n<pre><code>:queues:\n  - slack_notifier\n  - invoicing\n  - default\n</code></pre>\n\n<p><code>deploy.rb</code> (capistrano):</p>\n\n<pre><code># ...\nset :sidekiq_config, \"#{current_path}/config/sidekiq.yml\"\n# probably below line does same thing as above one\nset :sidekiq_options_per_process, ['--queue slack_notifier --queue invoicing --queue default']\n# ...\n</code></pre>\n\n<p>And I can see while deploying, that it's being used:</p>\n\n<pre><code>01:32 sidekiq:start\n      01 $HOME/.rbenv/bin/rbenv exec bundle exec sidekiq --index 0 --pidfile /home/ubuntu/cap/shared/tmp/pids/sidekiq.pid --environment production --logfile /home/ubuntu/cap/shared/log/sidekiq.log --config /home/ubuntu/cap/current/config/sidekiq.yml --queue slack_notifier --queue invoicing --queue default --daemon\n</code></pre>\n\n<p>Sidekiq is running:</p>\n\n<pre><code>ps aux | grep '[s]idekiq'\n#=&gt; ubuntu     716 16.4  2.1 668604 176860 ? Sl   07:31  14:18 sidekiq 4.2.6 cap [1 of 1 busy]\n</code></pre>\n\n<p>Now, when I start off the jobs, they just seem to be halted at some point.</p>\n\n<p>Not sure if I can describe the issue better. When I clear out the two priority queues (<code>slack_notifier</code> and <code>invoicing</code>) the default still does not seem to process jobs.</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 3022, "user_id": 1534704, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/StVOZ.jpg?s=128&g=1", "display_name": "Jordi Nebot", "link": "https://stackoverflow.com/users/1534704/jordi-nebot"}, "edited": false, "score": 0, "creation_date": 1513673928, "post_id": 47883131, "comment_id": 82732139, "body": "As the error says what is wrong is that function <code>ajax()</code> is not defined. Where do you define this function?"}, {"owner": {"reputation": 1251, "user_id": 7882685, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/94b65eaecdd85aebae0bcbca18d4b651?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub", "link": "https://stackoverflow.com/users/7882685/jakub"}, "reply_to_user": {"reputation": 3022, "user_id": 1534704, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/StVOZ.jpg?s=128&g=1", "display_name": "Jordi Nebot", "link": "https://stackoverflow.com/users/1534704/jordi-nebot"}, "edited": false, "score": 0, "creation_date": 1513674221, "post_id": 47883131, "comment_id": 82732279, "body": "@JordiNebot the function is related to this code: <a href=\"https://pastebin.com/SDpMDnpr\" rel=\"nofollow noreferrer\">pastebin.com/SDpMDnpr</a>   Line 51 is called"}, {"owner": {"reputation": 3022, "user_id": 1534704, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/StVOZ.jpg?s=128&g=1", "display_name": "Jordi Nebot", "link": "https://stackoverflow.com/users/1534704/jordi-nebot"}, "edited": false, "score": 0, "creation_date": 1513674430, "post_id": 47883131, "comment_id": 82732392, "body": "The code in this pastebin does <b>not</b> define any function called <code>ajax</code>. But it uses jQuery&#39;s ajax function. Maybe you&#39;re just missing the <code>$</code>? <code>return $.ajax({...</code>"}, {"owner": {"reputation": 1251, "user_id": 7882685, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/94b65eaecdd85aebae0bcbca18d4b651?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub", "link": "https://stackoverflow.com/users/7882685/jakub"}, "reply_to_user": {"reputation": 3022, "user_id": 1534704, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/StVOZ.jpg?s=128&g=1", "display_name": "Jordi Nebot", "link": "https://stackoverflow.com/users/1534704/jordi-nebot"}, "edited": false, "score": 0, "creation_date": 1513675159, "post_id": 47883131, "comment_id": 82732789, "body": "Yes I did that but now I have an other error: <code>Uncaught TypeError: $.ajax(...).then(...).catch is not a function</code>"}, {"owner": {"reputation": 3022, "user_id": 1534704, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/StVOZ.jpg?s=128&g=1", "display_name": "Jordi Nebot", "link": "https://stackoverflow.com/users/1534704/jordi-nebot"}, "edited": false, "score": 0, "creation_date": 1513675249, "post_id": 47883131, "comment_id": 82732855, "body": "What version of jQuery are you using?"}, {"owner": {"reputation": 1251, "user_id": 7882685, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/94b65eaecdd85aebae0bcbca18d4b651?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub", "link": "https://stackoverflow.com/users/7882685/jakub"}, "reply_to_user": {"reputation": 3022, "user_id": 1534704, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/StVOZ.jpg?s=128&g=1", "display_name": "Jordi Nebot", "link": "https://stackoverflow.com/users/1534704/jordi-nebot"}, "edited": false, "score": 0, "creation_date": 1513676353, "post_id": 47883131, "comment_id": 82733564, "body": "Running Bundle show I have this <code>jquery-rails (4.0.4)</code>"}, {"owner": {"reputation": 1251, "user_id": 7882685, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/94b65eaecdd85aebae0bcbca18d4b651?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub", "link": "https://stackoverflow.com/users/7882685/jakub"}, "reply_to_user": {"reputation": 3022, "user_id": 1534704, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/StVOZ.jpg?s=128&g=1", "display_name": "Jordi Nebot", "link": "https://stackoverflow.com/users/1534704/jordi-nebot"}, "edited": false, "score": 0, "creation_date": 1513677656, "post_id": 47883131, "comment_id": 82734398, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/161513/discussion-between-jakub-and-jordi-nebot\">continue this discussion in chat</a>."}, {"owner": {"reputation": 8754, "user_id": 6719819, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HmF9I.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6719819/daniel"}, "edited": false, "score": 0, "creation_date": 1514262664, "post_id": 47883131, "comment_id": 82917279, "body": "@Jakub, did you include the jquery library?"}], "owner": {"reputation": 1251, "user_id": 7882685, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/94b65eaecdd85aebae0bcbca18d4b651?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub", "link": "https://stackoverflow.com/users/7882685/jakub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 614, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513673524, "creation_date": 1513673524, "question_id": 47883131, "link": "https://stackoverflow.com/questions/47883131/ajax-is-not-defined-error-in-a-ruby-on-rails-app", "title": "Ajax is not defined error in a Ruby on Rails app", "body": "<p>In Ruby on Rails app one JS function which is using Ajax, it is giving me on the console this error: <code>Uncaught ReferenceError: ajax is not defined</code>\nI have more functions in the same JS file which are not giving the same error and are working good. Would like to understand what wrong with this function.</p>\n\n<p>My code:</p>\n\n<pre><code>SveCrf.prototype.getForms = function(forms) {\n    var _this = this;\n    return Promise.all(forms.map(function(form, idx) {\n        _this.html.push(_this.placeholder(idx, form.label)); // Create the slot for the result.\n        return ajax({\n            url: \"/mdrs/form_show\",\n            data: {\"id\": form.form_id, \"namespace\": form.form_namespace},\n            type: 'GET',\n            dataType: 'html'\n        }).then(function(result) {\n            return result\n        }).catch(handleAjaxError)\n    }))\n}\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1513672759, "post_id": 47882863, "comment_id": 82731507, "body": "That kind of dsl IS (was?) available in some places, though. I have personally used it on arrays/collections: <code>expect(ary).to have(3).elements</code> or <code>expect(project).to have(5).documents</code>. If it&#39;s not available now, then they must have cut it out at some point. Or maybe it&#39;s only a matter of including an add-on DSL module? &#175;\\_(\u30c4)_/&#175;"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1513672461, "creation_date": 1513672461, "answer_id": 47882863, "question_id": 47882811, "link": "https://stackoverflow.com/questions/47882811/rspec-for-characters-count/47882863#47882863", "title": "RSpec for characters count", "body": "<p>I am unsure why do you think <code>rspec</code> understands a human language. </p>\n\n<pre><code>expect(trx_id.length).to eq(25)\n</code></pre>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1513672461, "creation_date": 1513672244, "question_id": 47882811, "link": "https://stackoverflow.com/questions/47882811/rspec-for-characters-count", "title": "RSpec for characters count", "body": "<p>I want to create rspec file for counting characters. I use this code:</p>\n\n<pre><code>private\n\ndef generate_transaction_id(length = 25)\n   chars = [*('a'..'z'), *(0..9)]\n   (0..length).map {chars.sample}.join\n end\n</code></pre>\n\n<p><strong>rspec:</strong></p>\n\n<pre><code>it \"checks transaction id length\" do\n      trx_id = request.send(\"generate_transaction_id\")\n      puts trx_id\n      expect(trx_id).to have(25).characters\n    end\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>.lt3s5gxr0zkm02d0gf2f0vce1o\nFsome output\n.\n\nFailures:\n\n  1)  with no argument checks transaction id length\n     Failure/Error: expect(trx_id).to have(25).characters\n\n     NoMethodError:\n       undefined method `have' for #&lt;RSpec::ExampleGroups::Anonymous::WithNoArgument:0x007fde1f0fb590&gt;\n</code></pre>\n\n<p>Do you know how I can fix this issue?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "devise"], "comments": [{"owner": {"reputation": 1172, "user_id": 4784560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZAAHs.jpg?s=128&g=1", "display_name": "Christian Will", "link": "https://stackoverflow.com/users/4784560/christian-will"}, "edited": false, "score": 1, "creation_date": 1513662624, "post_id": 47880714, "comment_id": 82727276, "body": "Please take the time to read this: stackoverflow.com/help/how-to-ask . It is easier for use to help when we are able to understand the problem."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1513662721, "post_id": 47880714, "comment_id": 82727306, "body": "Doesn&#39;t devise store it automatically?"}, {"owner": {"reputation": 1, "user_id": 8918085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d2b885c761e5ab791b11b5d551316c?s=128&d=identicon&r=PG&f=1", "display_name": "Suraj D Bhat", "link": "https://stackoverflow.com/users/8918085/suraj-d-bhat"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1513662822, "post_id": 47880714, "comment_id": 82727336, "body": "@JagdeepSingh no it is not storing.It is storing only one value 12:00 AM."}, {"owner": {"reputation": 1, "user_id": 8918085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d2b885c761e5ab791b11b5d551316c?s=128&d=identicon&r=PG&f=1", "display_name": "Suraj D Bhat", "link": "https://stackoverflow.com/users/8918085/suraj-d-bhat"}, "reply_to_user": {"reputation": 1172, "user_id": 4784560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZAAHs.jpg?s=128&g=1", "display_name": "Christian Will", "link": "https://stackoverflow.com/users/4784560/christian-will"}, "edited": false, "score": 0, "creation_date": 1513663102, "post_id": 47880714, "comment_id": 82727444, "body": "@ChristianWill please do see now..help me please if you know how to do it"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513670436, "post_id": 47880714, "comment_id": 82730408, "body": "What is your question in the first place?"}, {"owner": {"reputation": 1, "user_id": 8918085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d2b885c761e5ab791b11b5d551316c?s=128&d=identicon&r=PG&f=1", "display_name": "Suraj D Bhat", "link": "https://stackoverflow.com/users/8918085/suraj-d-bhat"}, "edited": false, "score": 0, "creation_date": 1513673363, "post_id": 47880714, "comment_id": 82731831, "body": "i want to update last_sign_in_at and current_sign_in_at but it is not updating how can i do that?@mudasobwa"}, {"owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "edited": false, "score": 0, "creation_date": 1513771617, "post_id": 47880714, "comment_id": 82778064, "body": "Do you have devise Trackable for your user model?"}, {"owner": {"reputation": 1, "user_id": 8918085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d2b885c761e5ab791b11b5d551316c?s=128&d=identicon&r=PG&f=1", "display_name": "Suraj D Bhat", "link": "https://stackoverflow.com/users/8918085/suraj-d-bhat"}, "edited": false, "score": 0, "creation_date": 1513852194, "post_id": 47880714, "comment_id": 82813459, "body": "Trackable.rb?@Manishh"}], "answers": [{"tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 0, "last_activity_date": 1513678362, "creation_date": 1513678362, "answer_id": 47884603, "question_id": 47880714, "link": "https://stackoverflow.com/questions/47880714/update-users-last-sign-in-time-when-logging-in-again/47884603#47884603", "title": "Update user&#39;s last sign in time when logging in again", "body": "<p>That method looks fine, though it's not currently saving the attributes.</p>\n\n<p>Assuming this method is in <code>user.rb</code>, you just need to add:</p>\n\n<pre><code>def method_name  \n  old_current, new_current = current_sign_in_at, Time.now.utc  \n  self.last_sign_in_at     = old_current || new_current  \n  self.current_sign_in_at  = new_current   \n  save\nend\n</code></pre>\n\n<p>You could also look at using <a href=\"https://apidock.com/rails/ActiveRecord/Base/update_attributes\" rel=\"nofollow noreferrer\">update_attributes</a> or similar.</p>\n\n<p>It sounds like you'll just need to call this method on the user in the relevant controller action. If you post a little more code, I can tailor this, though hopefully that'll get you in the right direction.</p>\n"}], "owner": {"reputation": 1, "user_id": 8918085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d2b885c761e5ab791b11b5d551316c?s=128&d=identicon&r=PG&f=1", "display_name": "Suraj D Bhat", "link": "https://stackoverflow.com/users/8918085/suraj-d-bhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 47884603, "answer_count": 1, "score": -3, "last_activity_date": 1513678362, "creation_date": 1513662492, "last_edit_date": 1513668684, "question_id": 47880714, "link": "https://stackoverflow.com/questions/47880714/update-users-last-sign-in-time-when-logging-in-again", "title": "Update user&#39;s last sign in time when logging in again", "body": "<p>for example:\nif the user login at 10:45 AM and logs out and then when he login's again the value of last_sign_in should be 10:45 AM and current_sign_in value should be current Time.  </p>\n\n<pre><code>def method_name  \n old_current, new_current = self.current_sign_in_at, Time.now.utc  \n self.last_sign_in_at     = old_current || new_current  \n self.current_sign_in_at  = new_current   \nend\n</code></pre>\n"}, {"tags": ["ruby", "ldap", "openldap"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1513670372, "post_id": 47880723, "comment_id": 82730371, "body": "This solution has a flaw: <code>create_connection</code> must be called in advance. The proper way would be to put lazy initialization inside getter <code>def ldap; return @ldap if @ldap; @ldap = Net::LDAP.new; ...</code>. That way the call to authenticate will succeed in any case."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1513673563, "post_id": 47880723, "comment_id": 82731943, "body": "Agree with you @mudasobwa. I have updated the answer accordingly."}], "tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1513673527, "last_edit_date": 1513673527, "creation_date": 1513662533, "answer_id": 47880723, "question_id": 47880674, "link": "https://stackoverflow.com/questions/47880674/calling-method-without-passing-argument/47880723#47880723", "title": "calling method without passing argument", "body": "<p>You can do it like this:</p>\n\n<pre><code>class LdapUser\n  def ldap\n    return @ldap if @ldap\n    create_connection\n  end\n\n  # only admin can authenticate\n  def authenticate\n    ldap.authenticate \"cn=admin,dc=example,dc=com\",'123'  \n  end\n\n  private\n\n  def create_connection\n    @ldap = Net::LDAP.new\n    @ldap.host = 'localhost'\n    @ldap.port = 389\n    puts \"****** Conncection result ********\"\n    puts @ldap.get_operation_result \n    @ldap\n  end\nend\n\nuser = LdapUser.new\nuser.authenticate\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 7264802, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9619647177653103cccb62e579a2cadc?s=128&d=identicon&r=PG&f=1", "display_name": "Praneetha", "link": "https://stackoverflow.com/users/7264802/praneetha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 47880723, "answer_count": 1, "score": 0, "last_activity_date": 1513673527, "creation_date": 1513662278, "last_edit_date": 1513671982, "question_id": 47880674, "link": "https://stackoverflow.com/questions/47880674/calling-method-without-passing-argument", "title": "calling method without passing argument", "body": "<p>This is my code </p>\n\n<pre><code>require 'rubygems'\nrequire 'net/ldap'\n\nclass LdapUser\n    def create_connection\n       ldap = Net::LDAP.new\n       ldap.host = 'localhost'\n       ldap.port = 389\n       puts \"****** Conncection result ********\"\n       puts ldap.get_operation_result \n       return ldap\n   end\n\n  # only admin can authenticate\n  def authenticate(ldap)\n       ldap.authenticate \"cn=admin,dc=example,dc=com\",'123'  \n  end\nuser = LdapUser.new\nldap=user.create_connection\nuser.authenticate(ldap)\n</code></pre>\n\n<p>I want to call <code>authenticate</code> with the object without passing <code>ldap</code> as argument.</p>\n\n<p>Is there any way to do that? Is there any way that makes the code more productive and efficient?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1513662101, "post_id": 47879917, "comment_id": 82727116, "body": "Can you add the log when calling this method?"}, {"owner": {"reputation": 214, "user_id": 2125379, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677dbb945adcd4fc00d8a51a083c7c06?s=128&d=identicon&r=PG", "display_name": "Brandon Sturgeon", "link": "https://stackoverflow.com/users/2125379/brandon-sturgeon"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1513662513, "post_id": 47879917, "comment_id": 82727248, "body": "I added the method logs, thanks."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1513662613, "post_id": 47879917, "comment_id": 82727271, "body": "Try <code>player.include(:names).kills...</code>"}, {"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1513662799, "post_id": 47879917, "comment_id": 82727328, "body": "if you want to eager load the records then try something like: <code>Player.includes(:kills, :names).where(id: self.id)</code> and so on..I am not sure what else could be the issue."}, {"owner": {"reputation": 2298, "user_id": 5883753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32d66e6c723279fdfc2a90b269a070c?s=128&d=identicon&r=PG&f=1", "display_name": "fongfan999", "link": "https://stackoverflow.com/users/5883753/fongfan999"}, "edited": false, "score": 0, "creation_date": 1513664809, "post_id": 47879917, "comment_id": 82728115, "body": "You can read <a href=\"https://stackoverflow.com/a/43696520/5883753\">this</a> answer to learn more about <b>eager loading</b>."}, {"owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "edited": false, "score": 0, "creation_date": 1513671570, "post_id": 47879917, "comment_id": 82730919, "body": "which table column does <code>count_id</code> belong to?"}, {"owner": {"reputation": 214, "user_id": 2125379, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677dbb945adcd4fc00d8a51a083c7c06?s=128&d=identicon&r=PG", "display_name": "Brandon Sturgeon", "link": "https://stackoverflow.com/users/2125379/brandon-sturgeon"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1513693716, "post_id": 47879917, "comment_id": 82744231, "body": "@JagdeepSingh, this throws an error as <code>player</code> is an instance of <code>Player</code>.   <code>NoMethodError - undefined method &#39;include&#39; for #&lt;Player id: 304&quot;&gt;</code>"}, {"owner": {"reputation": 214, "user_id": 2125379, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677dbb945adcd4fc00d8a51a083c7c06?s=128&d=identicon&r=PG", "display_name": "Brandon Sturgeon", "link": "https://stackoverflow.com/users/2125379/brandon-sturgeon"}, "reply_to_user": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1513694075, "post_id": 47879917, "comment_id": 82744473, "body": "@Abhinay This returned an error because <code>.kills</code> can&#39;t be run on a <code>.where</code> relation collection. If I do a <code>.where(id: player.id).first</code> (or <code>.find(player.id)</code>), the query actually ends up being slower."}, {"owner": {"reputation": 214, "user_id": 2125379, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677dbb945adcd4fc00d8a51a083c7c06?s=128&d=identicon&r=PG", "display_name": "Brandon Sturgeon", "link": "https://stackoverflow.com/users/2125379/brandon-sturgeon"}, "reply_to_user": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "edited": false, "score": 0, "creation_date": 1513694155, "post_id": 47879917, "comment_id": 82744527, "body": "@WasifHossain I believe <code>count_id</code> is a SQL-y thing. It&#39;s not actually a field on any of my models. I should read up on this though."}, {"owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "edited": false, "score": 0, "creation_date": 1513694737, "post_id": 47879917, "comment_id": 82744945, "body": "would you pls elaborate the criteria on which to get the Top-10 list of the victims for a particular player?"}], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 7138608, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TJYvJEzvz2c/AAAAAAAAAAI/AAAAAAABSoc/EFDWgB2z430/photo.jpg?sz=128", "display_name": "David Weber", "link": "https://stackoverflow.com/users/7138608/david-weber"}, "is_accepted": false, "score": 0, "last_activity_date": 1513800037, "creation_date": 1513800037, "answer_id": 47913545, "question_id": 47879917, "link": "https://stackoverflow.com/questions/47879917/activerecord-including-associations-on-a-group/47913545#47913545", "title": "ActiveRecord: Including associations on a group", "body": "<p>Why don't you create another model with a hmt relationship that tallies new kills as they come in? New model:\n<code>UserKilledPlayers</code>:\n<code>belongs_to :user</code></p>\n\n<p>In user model:</p>\n\n<pre><code>has_many :user_killed_players     \nhas_many :killed_players, source: :user_killed_players, through: :users_killed_players\n</code></pre>\n\n<p>Your table would be something like:\nuser_killed_players</p>\n\n<pre><code>user_id  | killed_players_id |  count\n</code></pre>\n\n<p>Make a method that <code>++</code> on the <code>count</code> every time a user kills another user. Then it would just be an easy one query </p>\n\n<p><code>UserKilledPlayer.where(user_id: current_user).order('max(count) DESC')</code></p>\n\n<p>More details on associating users to users with has many through: \n<a href=\"https://stackoverflow.com/questions/2404246/user-has-many-users-through-friends-how\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 906, "user_id": 7933325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4181aecdacd635102e337da145eafe9?s=128&d=identicon&r=PG", "display_name": "Tom Copeland", "link": "https://stackoverflow.com/users/7933325/tom-copeland"}, "is_accepted": false, "score": 0, "last_activity_date": 1513888346, "creation_date": 1513888346, "answer_id": 47932328, "question_id": 47879917, "link": "https://stackoverflow.com/questions/47879917/activerecord-including-associations-on-a-group/47932328#47932328", "title": "ActiveRecord: Including associations on a group", "body": "<p>Here's a solution that retrieves the data in one query:  </p>\n\n<pre><code>def self.get_top_victims_for_player(player_id, count=10)\n  sql_string = &lt;&lt;-EOS\nwith first_names as \n( select distinct on (player_id) player_id, name \nfrom names \norder by player_id, id ) \nselect players.steam_id, first_names.name, count(kills.id) \nfrom kills \njoin first_names on kills.victim_id = first_names.player_id \njoin players on kills.victim_id = players.id \nwhere kills.player_id = #{player_id} \ngroup by kills.victim_id, first_names.name, players.steam_id \norder by count(kills.id) desc \nlimit #{count}\n  EOS\n  res = connection.execute(sql_string)\n  res.map {|h| {\"#{h['name']} (#{h['steam_id']})\" =&gt; h[\"count\"]}  }\nend\n</code></pre>\n\n<p>Sample run using some local data:</p>\n\n<pre><code>&gt;&gt; Player.get_top_victims_for_player(1)\n   (1.0ms)      with first_names as \n      ( select distinct on (player_id) player_id, name \n      from names \n      order by player_id, id ) \n    select players.steam_id, first_names.name, count(kills.id) \n    from kills \n    join first_names on kills.victim_id = first_names.player_id \n    join players on kills.victim_id = players.id \n    where kills.player_id = 1 \n    group by kills.victim_id, first_names.name, players.steam_id \n    order by count(kills.id) desc \n    limit 10\n\n=&gt; [{\"name2 (2)\"=&gt;5}, {\"name3 (3)\"=&gt;3}, {\"name4 (4)\"=&gt;2}]\n</code></pre>\n\n<p>Downsides are that it's PostgreSQL-specific due to CTE and DISTINCT ON, and also it has lots of raw SQL.  Probably it could be made more Active Record-ish with a bit of work though.</p>\n"}], "owner": {"reputation": 214, "user_id": 2125379, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677dbb945adcd4fc00d8a51a083c7c06?s=128&d=identicon&r=PG", "display_name": "Brandon Sturgeon", "link": "https://stackoverflow.com/users/2125379/brandon-sturgeon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513888346, "creation_date": 1513656696, "last_edit_date": 1513662496, "question_id": 47879917, "link": "https://stackoverflow.com/questions/47879917/activerecord-including-associations-on-a-group", "title": "ActiveRecord: Including associations on a group", "body": "<p>I really like ActiveRecord, but sometimes I find these (relatively) complicated queries challenging and I don't know how to ask for help.</p>\n\n<p>Here's my method:</p>\n\n<pre><code>  def self.get_top_victims_for_player(player, count=10)\n    top_victims = player\n                  .kills\n                  .group(:victim)\n                  .order('count_id DESC')\n                  .limit(count)\n                  .count(:id)\n\n    formatted = top_victims.map do |player, count|\n      { \"#{player.names.first.name} (#{player.steam_id})\" =&gt; count}\n    end.reduce({}, :merge)\n\n    { type: \"list\", data: formatted }\n  end\n</code></pre>\n\n<p>The goal is to get a Top-10 list of the victims of the provided player's kills.</p>\n\n<p>This line:\n<code>{ \"#{player.names.first.name} (#{player.steam_id})\" =&gt; count}</code>\ncreates many queries to retrieve the associated <code>Names</code> for each player. I feel like if I was able to eager-load this <code>Name</code> association, I could retrieve the first <code>Name</code> for each player in one query.</p>\n\n<p>Here're the logs when the method is run:</p>\n\n<pre><code>D, [2017-12-18T23:49:11.324957 #26877] DEBUG -- :   Player Load (0.3ms)  SELECT  \"players\".* FROM \"players\" WHERE \"players\".\"id\" = $1 LIMIT $2  [[\"id\", 304], [\"LIMIT\", 1]]\nD, [2017-12-18T23:49:11.332907 #26877] DEBUG -- :    (5.2ms)  SELECT  COUNT(\"kills\".\"id\") AS count_id, \"kills\".\"victim_id\" AS kills_victim_id FROM \"kills\" WHERE \"kills\".\"player_id\" = $1 GROUP BY \"kills\".\"victim_id\" ORDER BY count_id DESC LIMIT $2  [[\"player_id\", 304], [\"LIMIT\", 10]]\nD, [2017-12-18T23:49:11.335472 #26877] DEBUG -- :   Player Load (0.6ms)  SELECT \"players\".* FROM \"players\" WHERE \"players\".\"id\" IN (735, 96, 98, 893, 335, 213, 2801, 268, 1391, 3108)\nD, [2017-12-18T23:49:11.338581 #26877] DEBUG -- :   Name Load (1.1ms)  SELECT  \"names\".* FROM \"names\" WHERE \"names\".\"player_id\" = $1 ORDER BY \"names\".\"id\" ASC LIMIT $2  [[\"player_id\", 735], [\"LIMIT\", 1]]\nD, [2017-12-18T23:49:11.341112 #26877] DEBUG -- :   Name Load (0.3ms)  SELECT  \"names\".* FROM \"names\" WHERE \"names\".\"player_id\" = $1 ORDER BY \"names\".\"id\" ASC LIMIT $2  [[\"player_id\", 96], [\"LIMIT\", 1]]\nD, [2017-12-18T23:49:11.343411 #26877] DEBUG -- :   Name Load (0.9ms)  SELECT  \"names\".* FROM \"names\" WHERE \"names\".\"player_id\" = $1 ORDER BY \"names\".\"id\" ASC LIMIT $2  [[\"player_id\", 98], [\"LIMIT\", 1]]\nD, [2017-12-18T23:49:11.345129 #26877] DEBUG -- :   Name Load (1.0ms)  SELECT  \"names\".* FROM \"names\" WHERE \"names\".\"player_id\" = $1 ORDER BY \"names\".\"id\" ASC LIMIT $2  [[\"player_id\", 893], [\"LIMIT\", 1]]\nD, [2017-12-18T23:49:11.346893 #26877] DEBUG -- :   Name Load (1.1ms)  SELECT  \"names\".* FROM \"names\" WHERE \"names\".\"player_id\" = $1 ORDER BY \"names\".\"id\" ASC LIMIT $2  [[\"player_id\", 335], [\"LIMIT\", 1]]\nD, [2017-12-18T23:49:11.348842 #26877] DEBUG -- :   Name Load (1.2ms)  SELECT  \"names\".* FROM \"names\" WHERE \"names\".\"player_id\" = $1 ORDER BY \"names\".\"id\" ASC LIMIT $2  [[\"player_id\", 213], [\"LIMIT\", 1]]\nD, [2017-12-18T23:49:11.351487 #26877] DEBUG -- :   Name Load (1.6ms)  SELECT  \"names\".* FROM \"names\" WHERE \"names\".\"player_id\" = $1 ORDER BY \"names\".\"id\" ASC LIMIT $2  [[\"player_id\", 2801], [\"LIMIT\", 1]]\nD, [2017-12-18T23:49:11.354888 #26877] DEBUG -- :   Name Load (1.2ms)  SELECT  \"names\".* FROM \"names\" WHERE \"names\".\"player_id\" = $1 ORDER BY \"names\".\"id\" ASC LIMIT $2  [[\"player_id\", 268], [\"LIMIT\", 1]]\nD, [2017-12-18T23:49:11.357178 #26877] DEBUG -- :   Name Load (1.6ms)  SELECT  \"names\".* FROM \"names\" WHERE \"names\".\"player_id\" = $1 ORDER BY \"names\".\"id\" ASC LIMIT $2  [[\"player_id\", 1391], [\"LIMIT\", 1]]\nD, [2017-12-18T23:49:11.358084 #26877] DEBUG -- :   Name Load (0.2ms)  SELECT  \"names\".* FROM \"names\" WHERE \"names\".\"player_id\" = $1 ORDER BY \"names\".\"id\" ASC LIMIT $2  [[\"player_id\", 3108], [\"LIMIT\", 1]]\n</code></pre>\n\n<p>Association info:</p>\n\n<ul>\n<li><code>Player has_many :kills</code></li>\n<li><code>Player has_many :names</code></li>\n<li><code>Kill belongs_to :player</code></li>\n<li><code>Kill belongs_to :victim, :class_name =&gt; 'Player', foreign_key: 'victim_id'</code></li>\n<li><code>Name belongs_to :player</code></li>\n</ul>\n\n<p>How can I optimize this method?</p>\n\n<p>(Sidenote: Where can I learn more about this? What resources should I use when I have a question similar to this?)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "git", "heroku", "web-deployment"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1513666561, "post_id": 47879869, "comment_id": 82728777, "body": "Are there any entries in the log? Read it with <code>heroku logs</code>"}], "answers": [{"comments": [{"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1513695948, "post_id": 47880188, "comment_id": 82745710, "body": "This answer would be more helpful if you explained why it works."}], "tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": false, "score": 1, "last_activity_date": 1513658939, "creation_date": 1513658939, "answer_id": 47880188, "question_id": 47879869, "link": "https://stackoverflow.com/questions/47879869/why-am-i-getting-the-heroku-welcome-screen-after-i-push-code/47880188#47880188", "title": "Why am I getting the Heroku welcome screen after I push code?", "body": "<p>Try following commands:</p>\n\n<ol>\n<li>git add .</li>\n<li>git commit -m \"fc\"</li>\n<li>git push heroku master</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 4908294, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d07284fe14beb36309343591c96e801?s=128&d=identicon&r=PG&f=1", "display_name": "Conyare", "link": "https://stackoverflow.com/users/4908294/conyare"}, "is_accepted": true, "score": 0, "last_activity_date": 1513728318, "creation_date": 1513728318, "answer_id": 47896999, "question_id": 47879869, "link": "https://stackoverflow.com/questions/47879869/why-am-i-getting-the-heroku-welcome-screen-after-i-push-code/47896999#47896999", "title": "Why am I getting the Heroku welcome screen after I push code?", "body": "<p>I figured out that I had accidentally left SQlite3 in the Gemfile which is not supported by Heroku.</p>\n"}], "owner": {"reputation": 105, "user_id": 4908294, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d07284fe14beb36309343591c96e801?s=128&d=identicon&r=PG&f=1", "display_name": "Conyare", "link": "https://stackoverflow.com/users/4908294/conyare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 47896999, "answer_count": 2, "score": 0, "last_activity_date": 1513728318, "creation_date": 1513656301, "question_id": 47879869, "link": "https://stackoverflow.com/questions/47879869/why-am-i-getting-the-heroku-welcome-screen-after-i-push-code", "title": "Why am I getting the Heroku welcome screen after I push code?", "body": "<p>I am learning Ruby on Rails using Michael Hartl's <a href=\"https://www.railstutorial.org/book\" rel=\"nofollow noreferrer\">book</a> and I've run into a problem in chapter one while trying to use Heroku to deploy my Hello World App. I keep getting the default welcome screen even though I've used git to push my code to Heroku and my project works fine on localhost.</p>\n\n<p>My routes file is set up like this:</p>\n\n<pre><code>Rails.application.routes.draw do\n    root 'application#hello'\nend\n</code></pre>\n\n<p>And my controller like this:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n    protect_from_forgery with: :exception\n\n    def hello\n        render html: \"\u00a1Hola, mundo!\"\n    end\n\nend\n</code></pre>\n\n<p>I made sure to commit any changes to the git and my directory and I created a new Heroku project in my project directory with:</p>\n\n<pre><code>$ heroku login\n$ heroku keys:add\n$cd /mydirectory\n$heroku create\n$git push heroku master\n</code></pre>\n\n<p>Everything in git is up to date and I have no idea what else to try. Any ideas?  Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 3, "creation_date": 1513653938, "post_id": 47879553, "comment_id": 82725157, "body": "Regular expressions are the wrong tool for this. Use Nokogiri or another HTML parser."}, {"owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1513654009, "post_id": 47879553, "comment_id": 82725170, "body": "As I stated in my question. I understand that notion, and I&#39;m not arguing the fact. But for my use case, I really need the string to not be touched or manipulated in any way. It needs to stay exactly the same because I compare it in the next function call."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1513656062, "post_id": 47879553, "comment_id": 82725624, "body": "In that case, you should consider comparing the parsed/normalized versions, not the raw strings."}, {"owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "edited": false, "score": 0, "creation_date": 1513656300, "post_id": 47879553, "comment_id": 82725672, "body": "I don&#39;t have tons of experience with this particular problem. Why is it bad practice to use raw strings? Could you point me to any articles or stackoverflow discussions."}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1513660521, "post_id": 47879744, "comment_id": 82726650, "body": "It is not hardcoding. It uses the numbers given by the <code>rindex</code> used right above. I edited the code to make that point clear."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1513660563, "post_id": 47879744, "comment_id": 82726662, "body": "This is actually close to the way to go."}], "tags": [], "owner": {"reputation": 51, "user_id": 7754363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UAizY.jpg?s=128&g=1", "display_name": "Karthick", "link": "https://stackoverflow.com/users/7754363/karthick"}, "is_accepted": true, "score": 2, "last_activity_date": 1513660381, "last_edit_date": 1513660381, "creation_date": 1513655128, "answer_id": 47879744, "question_id": 47879553, "link": "https://stackoverflow.com/questions/47879553/remove-last-span-from-string/47879744#47879744", "title": "Remove last span from string", "body": "<p>See if this helps. Is this what you're looking for?</p>\n\n<pre><code>txt = \"&lt;span class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon \n Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-\n contents'&gt;- wrong&lt;/div&gt;&lt;/span&gt;&lt;span class='break'&gt;&lt;div class='name-and-\n date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;\n &lt;/strong&gt;&lt;div class='note-contents'&gt;- Wrong again&lt;/div&gt;&lt;/span&gt;&lt;span \n class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson \n - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- \n okay what is the matter with you.&lt;/div&gt;&lt;/span&gt;&lt;span class='break'&gt;&lt;div \n class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:50 PM \n Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- Bro!&lt;/div&gt;&lt;/span&gt;\"\n\ntxt.rindex('&lt;span')\n# =&gt; 540 \ntxt.rindex('&lt;/span')\n# =&gt; 700 \ntxt[txt.rindex('&lt;span'), txt.rindex('&lt;/span')]\n# =&gt; \"&lt;span class='break'&gt;&lt;div \\n class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:50 PM \\n Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- Bro!&lt;/div&gt;&lt;/span&gt;\" \ntxt[txt.rindex('&lt;span'), txt.rindex('&lt;/span')] = \"\"\ntxt\n# =&gt; \"&lt;span class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon \\n Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-\\n contents'&gt;- wrong&lt;/div&gt;&lt;/span&gt;&lt;span class='break'&gt;&lt;div class='name-and-\\n date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;\\n &lt;/strong&gt;&lt;div class='note-contents'&gt;- Wrong again&lt;/div&gt;&lt;/span&gt;&lt;span \\n class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson \\n - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- \\n okay what is the matter with you.&lt;/div&gt;&lt;/span&gt;\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "is_accepted": false, "score": 2, "last_activity_date": 1513655232, "creation_date": 1513655232, "answer_id": 47879757, "question_id": 47879553, "link": "https://stackoverflow.com/questions/47879553/remove-last-span-from-string/47879757#47879757", "title": "Remove last span from string", "body": "<p>You can do it in many ways.</p>\n\n<p>suppose you have that string in txt variable then\n<code>txt.split(\"&lt;span class='break'\")[0..-2].join(\"&lt;span class='break\")</code>\nwill easily work. It is only matter of way.</p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1513667088, "last_edit_date": 1513667088, "creation_date": 1513666407, "answer_id": 47881463, "question_id": 47879553, "link": "https://stackoverflow.com/questions/47879553/remove-last-span-from-string/47881463#47881463", "title": "Remove last span from string", "body": "<p>The following would work unless there could be nested <code>span</code>s having a class <code>\"break\"</code>.</p>\n\n<pre><code>input.scan(%r|&lt;span\\s+class=['\"]break[\"']&gt;.*?&lt;/span&gt;|m)[0...-1].join\n</code></pre>\n\n<p>Slightly slower, but always works as intended:</p>\n\n<pre><code>input[%r|.*(?=&lt;span\\s+class=['\"]break[\"']&gt;.*?&lt;/span&gt;\\z)|m]\n</code></pre>\n\n<p>The latter solution uses <a href=\"http://www.regular-expressions.info/lookaround.html\" rel=\"nofollow noreferrer\">positive lookahead</a> to catch everything save for the last pattern immediately followed by the string end (<code>\\z</code>.) </p>\n\n<p>More info on <a href=\"https://ruby-doc.org/core/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\"><code>String#[]</code></a>, with a regular expression as an argument.</p>\n"}], "owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 47879744, "answer_count": 3, "score": 0, "last_activity_date": 1513667088, "creation_date": 1513653476, "last_edit_date": 1513662282, "question_id": 47879553, "link": "https://stackoverflow.com/questions/47879553/remove-last-span-from-string", "title": "Remove last span from string", "body": "<p>I have this string:</p>\n\n<pre><code>\"&lt;span class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon \n Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-\n contents'&gt;- wrong&lt;/div&gt;&lt;/span&gt;&lt;span class='break'&gt;&lt;div class='name-and-\n date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;\n &lt;/strong&gt;&lt;div class='note-contents'&gt;- Wrong again&lt;/div&gt;&lt;/span&gt;&lt;span \n class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson \n - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- \n okay what is the matter with you.&lt;/div&gt;&lt;/span&gt;&lt;span class='break'&gt;&lt;div \n class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:50 PM \n Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- Bro!&lt;/div&gt;&lt;/span&gt;\"\n</code></pre>\n\n<p>How can I remove the last span from this string so that I get this return value:</p>\n\n<pre><code>\"&lt;span class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon \n Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-\n contents'&gt;- wrong&lt;/div&gt;&lt;/span&gt;&lt;span class='break'&gt;&lt;div class='name-and-\n date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;\n &lt;/strong&gt;&lt;div class='note-contents'&gt;- Wrong again&lt;/div&gt;&lt;/span&gt;&lt;span \n class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson \n - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- \n okay what is the matter with you.&lt;/div&gt;&lt;/span&gt;\"\n</code></pre>\n\n<p>I understand that it is better practice to use Nokogiri for html parsing but for my use case it's important that I keep the integrity of the string in place. Which means it has to be the exact same except that last span removed.</p>\n\n<p>I'd like to do something like this:</p>\n\n<pre><code>string.scan(/&lt;span class='break'&gt;/)\n</code></pre>\n\n<p>But that doesn't grab the entire string and break them into array elements.</p>\n\n<h3>NOTE: I asked a similar question earlier and I appreciate the help but it wasn't quite what I needed.</h3>\n"}, {"tags": ["ruby", "google-chrome", "automation", "selenium-chromedriver", "watir"], "answers": [{"tags": [], "owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "is_accepted": true, "score": 2, "last_activity_date": 1513712974, "creation_date": 1513712974, "answer_id": 47894218, "question_id": 47879469, "link": "https://stackoverflow.com/questions/47879469/chromedriver-switches-disable-popup-blocking-doesnt-work-using-ruby-in-headle/47894218#47894218", "title": "Chromedriver switches --disable-popup-blocking Doesn&#39;t Work Using Ruby in Headless Mode", "body": "<p>Chrome Preferences are not currently supported in Headless Mode. See Comment 7 in <a href=\"https://bugs.chromium.org/p/chromium/issues/detail?id=775911#c7\" rel=\"nofollow noreferrer\">this Chromium Bug</a></p>\n"}], "owner": {"reputation": 140, "user_id": 6948197, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d83235c900136f9a7e3681bae82db841?s=128&d=identicon&r=PG&f=1", "display_name": "Fandratt Muda", "link": "https://stackoverflow.com/users/6948197/fandratt-muda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1068, "favorite_count": 0, "accepted_answer_id": 47894218, "answer_count": 1, "score": 0, "last_activity_date": 1513712974, "creation_date": 1513652790, "question_id": 47879469, "link": "https://stackoverflow.com/questions/47879469/chromedriver-switches-disable-popup-blocking-doesnt-work-using-ruby-in-headle", "title": "Chromedriver switches --disable-popup-blocking Doesn&#39;t Work Using Ruby in Headless Mode", "body": "<p>I start my chromedriver like this in Ruby</p>\n\n<pre><code>driver = Watir::Browser.new :chrome, :switches =&gt; %w[--ignore-certificate-errors --disable-popup-blocking --disable-translate --disable-notifications --start-maximized]\n</code></pre>\n\n<p>But, when I start using headless mode like below, it returns nothing.</p>\n\n<pre><code>driver = Watir::Browser.new :chrome, :switches =&gt; %W[--ignore-certificate-errors --disable-popup-blocking --disable-translate --disable-notifications --disable-gpu --headless]\n</code></pre>\n\n<p>I need the switch <code>--disable-popup-blocking</code> in order to prevent the \"Allow Location\" popup on the website I am trying to access. It works if the chrome doesn't start in headless. But it doesn't work in headless mode. Is there any way to make it works?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "postgresql", "triggers"], "answers": [{"tags": [], "owner": {"reputation": 389, "user_id": 2743124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VcxZw.jpg?s=128&g=1", "display_name": "Chetan Datta", "link": "https://stackoverflow.com/users/2743124/chetan-datta"}, "is_accepted": false, "score": 1, "last_activity_date": 1513653801, "creation_date": 1513653801, "answer_id": 47879580, "question_id": 47879421, "link": "https://stackoverflow.com/questions/47879421/rails-postgresql-and-history-triggers/47879580#47879580", "title": "Rails, PostgreSQL, and History Triggers", "body": "<p>You can use <code>gem 'paper_trail'</code> which Tracks changes to your models, for auditing or versioning. <a href=\"https://github.com/airblade/paper_trail\" rel=\"nofollow noreferrer\">Here is the Link</a></p>\n"}, {"tags": [], "owner": {"reputation": 326, "user_id": 3013354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad9dbf3df6d9dc0944bb224014a3bc2b?s=128&d=identicon&r=PG", "display_name": "nekogami", "link": "https://stackoverflow.com/users/3013354/nekogami"}, "is_accepted": false, "score": 1, "last_activity_date": 1513655627, "creation_date": 1513655627, "answer_id": 47879810, "question_id": 47879421, "link": "https://stackoverflow.com/questions/47879421/rails-postgresql-and-history-triggers/47879810#47879810", "title": "Rails, PostgreSQL, and History Triggers", "body": "<p>Isn't <a href=\"https://github.com/jenseng/hair_trigger\" rel=\"nofollow noreferrer\">https://github.com/jenseng/hair_trigger</a> what you need ?</p>\n\n<p>It allows you to register your trigger in your project and then recreate, update them with a command.</p>\n\n<p>NOTE: I always wanted to use it, but could never had the chance to do it in the end for various reasons so I can't vouch for the quality of the gem. </p>\n\n<p>EDIT: No, they should always use rake db:schema:load for an existing DB</p>\n"}, {"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 8, "last_activity_date": 1513656528, "creation_date": 1513656528, "answer_id": 47879896, "question_id": 47879421, "link": "https://stackoverflow.com/questions/47879421/rails-postgresql-and-history-triggers/47879896#47879896", "title": "Rails, PostgreSQL, and History Triggers", "body": "<p>If you need or want database-specific features that ActiveRecord doesn't understand then you should switch to <code>db/structure.sql</code> for keeping track of your schema. <code>db/structure.sql</code> is pretty much a raw dump of your schema made using the database's native tools so it will contain triggers, CHECK constraints, indexes on function results, and everything else.</p>\n\n<p>Switching is easy:</p>\n\n<ol>\n<li>Update your <code>config/application.rb</code> to contain <code>config.active_record.schema_format = :sql</code>.</li>\n<li>Do a <code>rake db:structure:dump</code> to get an initial <code>db/structure.sql</code>.</li>\n<li>Delete <code>db/schema.rb</code> from your directory tree and revision control.</li>\n<li>Add <code>db/structure.sql</code> to revision control.</li>\n<li>Adjust your rake habits:\n\n<ul>\n<li>Use <code>db:structure:dump</code> instead of <code>db:schema:dump</code></li>\n<li>Use <code>db:structure:load</code> instead of <code>db:schema:load</code></li>\n</ul></li>\n</ol>\n\n<p>Everything else should work as usual (assuming, of course, that you're sane and using PostgreSQL for development, testing, and production).</p>\n\n<p>With this change made, your triggers will be tracked in <code>db/structure.sql</code> and recreating the database won't lose them.</p>\n"}], "owner": {"reputation": 595, "user_id": 1154843, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Mjhv5.jpg?s=128&g=1", "display_name": "Lane", "link": "https://stackoverflow.com/users/1154843/lane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 1, "accepted_answer_id": 47879896, "answer_count": 3, "score": 1, "last_activity_date": 1513656528, "creation_date": 1513652323, "question_id": 47879421, "link": "https://stackoverflow.com/questions/47879421/rails-postgresql-and-history-triggers", "title": "Rails, PostgreSQL, and History Triggers", "body": "<p>SO...</p>\n\n<p>I am adding history tables populated by triggers for auditing in my project via something like...</p>\n\n<pre><code>execute &lt;&lt;-SQL\n  CREATE OR REPLACE FUNCTION process_history_table() RETURNS TRIGGER AS $history_table$\n    BEGIN\n      IF (TG_OP = 'DELETE') THEN\n          INSERT INTO history_table VALUES (DEFAULT, 'D', now(), OLD.*);\n          RETURN OLD;\n      ELSIF (TG_OP = 'UPDATE') THEN\n          INSERT INTO history_table VALUES (DEFAULT, 'U', now(), NEW.*);\n          RETURN NEW;\n      ELSIF (TG_OP = 'INSERT') THEN\n          INSERT INTO history_table VALUES (DEFAULT, 'I', now(), NEW.*);\n          RETURN NEW;\n      END IF;\n      RETURN NULL; -- result is ignored since this is an AFTER trigger\n    END;\n  $history_table$ LANGUAGE plpgsql;\n\n  CREATE TRIGGER history_table\n  AFTER INSERT OR UPDATE OR DELETE ON table\n    FOR EACH ROW EXECUTE PROCEDURE process_history_table();\nSQL\n</code></pre>\n\n<p>...and this will work for production and other environments. The problem is when someone runs <code>bundle exec rake db:drop db:create db:schema:load db:migrate RAILS_ENV=test</code> or something similar (most important is the <code>db:schema:load</code> portion), this will bypass trigger creation as triggers are not saved in the <code>db/schema.rb</code> file.</p>\n\n<p>Perhaps the correct solution is to say that when using rails, developers should never run <code>db:schema:load</code> and always run <code>db:migrate</code> instead to ensure all migrations can continuously be re-run. However, we have not been operating that way for a long time and I believe it would be quite painful to do so as we may need to update several dozen or more migrations. Any thoughts on how I could incorporate triggers into my application incrementally and have the developer / test environments continue to be built / re-created the same way as today would be very helpful.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["java", "ruby", "jruby", "overwrite"], "comments": [{"owner": {"reputation": 8454, "user_id": 958529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3ec25db39c63bab1a11037649e326b8?s=128&d=identicon&r=PG", "display_name": "halfelf", "link": "https://stackoverflow.com/users/958529/halfelf"}, "edited": false, "score": 1, "creation_date": 1513651875, "post_id": 47879239, "comment_id": 82724742, "body": "<a href=\"https://stackoverflow.com/questions/803020/redefining-a-single-ruby-method-on-a-single-instance-with-a-lambda\" title=\"redefining a single ruby method on a single instance with a lambda\">stackoverflow.com/questions/803020/&hellip;</a>"}], "owner": {"reputation": 21, "user_id": 8638265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/621cc5e0242cad6add4888575eed5151?s=128&d=identicon&r=PG&f=1", "display_name": "Yang Liu", "link": "https://stackoverflow.com/users/8638265/yang-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513651732, "creation_date": 1513650568, "last_edit_date": 1513651732, "question_id": 47879239, "link": "https://stackoverflow.com/questions/47879239/how-to-embed-overwrite-in-jruby-when-i-instantiate-java-objects", "title": "How to embed overwrite in jruby when I instantiate Java objects", "body": "<p>I want to overwrite some method when I instantiate a Java Object using ruby</p>\n\n<p>when I use Java,the implement like this</p>\n\n<pre><code>Class name = new Class() {\n    @overwrite\n    public String method() {\n    }\n}\n</code></pre>\n\n<p>but I don't know how to implement like this in jruby when I use ruby to instantiate the instance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "taglib", "taglib-ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1513674943, "post_id": 47878138, "comment_id": 82732653, "body": "So your question is &quot;How do I create a buildpack&quot;? Have you started by <a href=\"https://devcenter.heroku.com/articles/buildpacks#creating-a-buildpack\" rel=\"nofollow noreferrer\">reading the Heroku documentation on creating a buildpack</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 1051, "user_id": 1439489, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/938c2fb421b08ae42c89f97e2a7c86a2?s=128&d=identicon&r=PG", "display_name": "dvkch", "link": "https://stackoverflow.com/users/1439489/dvkch"}, "edited": false, "score": 1, "creation_date": 1600334239, "post_id": 53622658, "comment_id": 113056996, "body": "I have made an updated, though imperfect, buildpack for taglib embeddeding the 1.11.1 build of the library, required for taglib-ruby v1.0. It is available at <a href=\"https://github.com/dvkch/taglib-buildpack/\" rel=\"nofollow noreferrer\">github.com/dvkch/taglib-buildpack</a>"}], "tags": [], "owner": {"reputation": 147, "user_id": 5855101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uCDXY.png?s=128&g=1", "display_name": "Zweih", "link": "https://stackoverflow.com/users/5855101/zweih"}, "is_accepted": false, "score": 1, "last_activity_date": 1544030847, "last_edit_date": 1544030847, "creation_date": 1543964007, "answer_id": 53622658, "question_id": 47878138, "link": "https://stackoverflow.com/questions/47878138/deploying-to-heroku-with-taglib-ruby-gem-rails-5/53622658#53622658", "title": "Deploying to Heroku with Taglib-Ruby Gem (Rails 5)", "body": "<p>I have merged the most recent version of TagLib (1.11.1) and a patched branch from Aug 2018, from <a href=\"https://github.com/mrrad/heroku-buildpack-taglib/pull/4\" rel=\"nofollow noreferrer\">this pull request</a>, of the buildpack and currently have it hosted <a href=\"https://github.com/Zweih/taglib-buildpack\" rel=\"nofollow noreferrer\">here on GitHub</a>.</p>\n\n<p>For Heroku you need to ensure that the library buildpacks are loaded before the language buildpack that uses it is loaded. </p>\n\n<p>For example, here is an image of my buildpack order</p>\n\n<p><a href=\"https://i.stack.imgur.com/Jgwws.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jgwws.png\" alt=\"enter image description here\"></a></p>\n\n<p>(found under your application tab).</p>\n\n<p>EX: </p>\n\n<pre><code>1. https://github.com/Zweih/taglib-buildpack.git\n2. heroku/ruby\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 9115722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf09c96f3487927e98340a6ddb0b306?s=128&d=identicon&r=PG&f=1", "display_name": "RuboTrip", "link": "https://stackoverflow.com/users/9115722/rubotrip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1592178216, "creation_date": 1513641194, "last_edit_date": 1513641830, "question_id": 47878138, "link": "https://stackoverflow.com/questions/47878138/deploying-to-heroku-with-taglib-ruby-gem-rails-5", "title": "Deploying to Heroku with Taglib-Ruby Gem (Rails 5)", "body": "<p>I have recently added the 'taglib-ruby' gem to my rails project, and am trying to push the project to Heroku. However, even when I bundle install, the push is continuously rejected with the following error:</p>\n\n<pre><code>You must have taglib installed in order to use taglib-ruby.\nremote:        \nremote:        Debian/Ubuntu: sudo apt-get install libtag1-dev\nremote:        Fedora/RHEL: sudo yum install taglib-devel\nremote:        Brew: brew install taglib\nremote:        MacPorts: sudo port install taglib\nremote:        \nremote:        *** extconf.rb failed ***\nremote:        Could not create Makefile due to some reason, probably lack of necessary\nremote:        libraries and/or headers.  Check the mkmf.log file for more details.  You may\nremote:        need configuration options.\n  An error occurred while installing taglib-ruby (0.7.1), and Bundler cannot\nremote:        continue.\nremote:        Make sure that `gem install taglib-ruby -v '0.7.1'` succeeds before bundling.\nremote:        \nremote:        In Gemfile:\nremote:        taglib-ruby\n</code></pre>\n\n<p><strong>NOTE: I am aware that this question has been asked, but most answers offer the same buildpacks which extremely outdated and either deprecated, do not work or are poorly documented.</strong></p>\n\n<p>Does anybody know of any up-to-date buildpacks for this issue? </p>\n\n<p><strong>Alternatively, does anybody have any advice for putting together my own buildpack?</strong> </p>\n\n<p>Some info about TagLib: It must be installed via homebrew (if that is what you are running) before you can install the gem. How are dependencies such as these handled when pushing to Heroku?</p>\n\n<p>Thank you for your help!!</p>\n"}, {"tags": ["ruby", "neo4j", "neo4j.rb"], "answers": [{"comments": [{"owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "edited": false, "score": 0, "creation_date": 1513663159, "post_id": 47877275, "comment_id": 82727470, "body": "can you please tell me how to write it in ORM style as well <code>.match().where() etc</code>?"}, {"owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "edited": false, "score": 0, "creation_date": 1513663392, "post_id": 47877275, "comment_id": 82727556, "body": "Also in my query there is match written after <code>where not</code>, all the match statements grouped together to run at first then where, with etc?"}, {"owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "reply_to_user": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "edited": false, "score": 1, "creation_date": 1513695402, "post_id": 47877275, "comment_id": 82745356, "body": "You should definitely group appropriate <code>WHERE</code> clauses with the <code>MATCH</code> clauses that define the variables.  One thing that I don&#39;t think is generally understood is that <code>WHERE</code> is really a modifier for <code>MATCH</code>, not it&#39;s own clause"}, {"owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "reply_to_user": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "edited": false, "score": 0, "creation_date": 1513695491, "post_id": 47877275, "comment_id": 82745413, "body": "I can make another answer with <code>Query</code> style, though your question said you wanted to just execute the Cypher string"}, {"owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "edited": false, "score": 0, "creation_date": 1513700980, "post_id": 47877275, "comment_id": 82748836, "body": "Thanks @brian I will look into your answers and will update you"}], "tags": [], "owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "is_accepted": false, "score": 1, "last_activity_date": 1513635741, "creation_date": 1513635741, "answer_id": 47877275, "question_id": 47876876, "link": "https://stackoverflow.com/questions/47876876/neo4j-rb-how-to-run-cypher-query-directly/47877275#47877275", "title": "Neo4j.rb How to run Cypher query directly?", "body": "<pre><code>Neo4j::ActiveBase.current_session.query(cypher_query_string)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "is_accepted": true, "score": 1, "last_activity_date": 1513695993, "creation_date": 1513695993, "answer_id": 47889850, "question_id": 47876876, "link": "https://stackoverflow.com/questions/47876876/neo4j-rb-how-to-run-cypher-query-directly/47889850#47889850", "title": "Neo4j.rb How to run Cypher query directly?", "body": "<p>Here is <code>Query</code> style as requested in comments.  With a query like this, though, you don't get much benefit from this style unless maybe you're passing partial <code>Query</code> objects around.  You probably want to stick to a Cypher query defined in a Ruby heredoc.</p>\n\n<pre><code>Neo4j::ActiveBase.new_query\n  .match(n: {name: 'MU1'})\n  .match('(n)-[:connected_to*1..2 {status: ?}]-&gt;(sp:User)', 1)\n  .match('(sp)&lt;-[:owner_of|house_mate]-(place:Place)-[:owner_of|house_mate]-&gt;(c:User)')\n  .where_not('(n)-[:house_mate]-(place)')\n  .break\n  .match('(place)-[tenant:owner_of|house_mate]-&gt;(u:User)')\n  .with('DISTINCT place, type(tenant) AS type, u')\n  .with(:place, tenants: 'collect({type: type, u: u})')\n  .pluck(:place,\n          owner: '[tenant IN tenants WHERE tenant.type = 'owner_of'   | [tenant.u]][0]',\n          houseMatesArray: '[tenant IN tenants WHERE tenant.type = 'house_mate' | [tenant.u]]')\n</code></pre>\n\n<p>You need the <code>break</code> in there to keep the <code>match</code> clauses from grouping, though that's because of a design decision that I've wanted to reverse for a while now.</p>\n\n<p>Also, I'm thinking that there should be a <code>with_distinct</code> method because <code>DISTINCT</code> (IIRC) applies to the whole set of columns.</p>\n"}], "owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 47889850, "answer_count": 2, "score": 1, "last_activity_date": 1513695993, "creation_date": 1513633563, "last_edit_date": 1513663099, "question_id": 47876876, "link": "https://stackoverflow.com/questions/47876876/neo4j-rb-how-to-run-cypher-query-directly", "title": "Neo4j.rb How to run Cypher query directly?", "body": "<p>I want to run directly Cypher queries in rails don't want to use ORM style because I have long queries which I made on neo4j console and when I am trying to change into orm style its not behaving as expected</p>\n\n<pre><code>MATCH (n {name: 'MU1'})-[:connected_to*1..2 {status: 1}]-&gt;(sp:User),\n      (sp)&lt;-[:owner_of|house_mate]-(place:Place)-[:owner_of|house_mate]-&gt;(c:User)\nWHERE NOT (n)-[:house_mate]-(place)\nMATCH\n  (place)-[tenant:owner_of|house_mate]-&gt;(u:User)\nWITH DISTINCT place, type(tenant) AS type, u\nWITH place, collect({type: type, u: u}) AS tenants\nRETURN\n   place,\n   [tenant IN tenants WHERE tenant.type = 'owner_of'   | [tenant.u]][0] AS owner,\n   [tenant IN tenants WHERE tenant.type = 'house_mate' | [tenant.u]] AS houseMatesArray\n</code></pre>\n\n<p>Neo4j.query and Neo4j._query etc</p>\n\n<p>Any Help? </p>\n\n<p>Edit: How to write it in ORM style may be I was doing something wrong? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara", "rspec-rails"], "comments": [{"owner": {"reputation": 3180, "user_id": 4659816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5TNaW.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/4659816/david"}, "edited": false, "score": 1, "creation_date": 1513676250, "post_id": 47876802, "comment_id": 82733491, "body": "Finding it hard to understand why you don&#39;t want the database in a clean state for each test you run - what is the purpose of having data in your test database at all - could you clarify your use case?"}], "answers": [{"comments": [{"owner": {"reputation": 547, "user_id": 6792180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mpzfa.jpg?s=128&g=1", "display_name": "Andres23Ramirez", "link": "https://stackoverflow.com/users/6792180/andres23ramirez"}, "edited": false, "score": 0, "creation_date": 1513633569, "post_id": 47876853, "comment_id": 82719414, "body": "This reset the bd of tests, what I need is that no data is saved in the bd so that the other test cases are not affected, but from the same execution"}, {"owner": {"reputation": 389, "user_id": 2743124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VcxZw.jpg?s=128&g=1", "display_name": "Chetan Datta", "link": "https://stackoverflow.com/users/2743124/chetan-datta"}, "reply_to_user": {"reputation": 547, "user_id": 6792180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mpzfa.jpg?s=128&g=1", "display_name": "Andres23Ramirez", "link": "https://stackoverflow.com/users/6792180/andres23ramirez"}, "edited": false, "score": 0, "creation_date": 1513633706, "post_id": 47876853, "comment_id": 82719493, "body": "You can try using <a href=\"https://github.com/DatabaseCleaner/database_cleaner\" rel=\"nofollow noreferrer\">database_cleaner</a>"}, {"owner": {"reputation": 389, "user_id": 2743124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VcxZw.jpg?s=128&g=1", "display_name": "Chetan Datta", "link": "https://stackoverflow.com/users/2743124/chetan-datta"}, "reply_to_user": {"reputation": 547, "user_id": 6792180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mpzfa.jpg?s=128&g=1", "display_name": "Andres23Ramirez", "link": "https://stackoverflow.com/users/6792180/andres23ramirez"}, "edited": false, "score": 0, "creation_date": 1513633812, "post_id": 47876853, "comment_id": 82719546, "body": "And use the <a href=\"https://github.com/DatabaseCleaner/database_cleaner#what-strategy-is-fastest\" rel=\"nofollow noreferrer\">:truncation</a> option"}, {"owner": {"reputation": 547, "user_id": 6792180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mpzfa.jpg?s=128&g=1", "display_name": "Andres23Ramirez", "link": "https://stackoverflow.com/users/6792180/andres23ramirez"}, "edited": false, "score": 0, "creation_date": 1513633856, "post_id": 47876853, "comment_id": 82719569, "body": "I do not need a command, if not the appropriate configuration form of rspec and Capybara to return the data after each test but without deleting all the bd"}, {"owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "edited": false, "score": 0, "creation_date": 1513635213, "post_id": 47876853, "comment_id": 82720154, "body": "@ChetanDatta I think he&#39;s already using database_cleaner and the truncation option."}], "tags": [], "owner": {"reputation": 389, "user_id": 2743124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VcxZw.jpg?s=128&g=1", "display_name": "Chetan Datta", "link": "https://stackoverflow.com/users/2743124/chetan-datta"}, "is_accepted": false, "score": 1, "last_activity_date": 1513633422, "creation_date": 1513633422, "answer_id": 47876853, "question_id": 47876802, "link": "https://stackoverflow.com/questions/47876802/clean-test-database-only-of-the-data-generated-running-the-tests-with-rspec-and/47876853#47876853", "title": "Clean test database, only of the data generated running the tests with RSPEC and Capybara", "body": "<p>You can use this</p>\n\n<pre><code>rake db:reset RAILS_ENV=test\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 547, "user_id": 6792180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mpzfa.jpg?s=128&g=1", "display_name": "Andres23Ramirez", "link": "https://stackoverflow.com/users/6792180/andres23ramirez"}, "edited": false, "score": 0, "creation_date": 1513703934, "post_id": 47877198, "comment_id": 82750680, "body": "Thanks for your answer, it&#39;s very helpful  You tell me that it is not the right way to do what I want, could you tell me then what is the correct way to do it?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 547, "user_id": 6792180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mpzfa.jpg?s=128&g=1", "display_name": "Andres23Ramirez", "link": "https://stackoverflow.com/users/6792180/andres23ramirez"}, "edited": false, "score": 0, "creation_date": 1513704359, "post_id": 47877198, "comment_id": 82750926, "body": "@Andres23Ramirez Normally feature testing is done by setting up just the records required for a specific test at the beginning of that test.  That way each test is fully isolated from the other tests. You may have a really good reason for not doing that, but without a lot more detail/examples about exactly why you want to pre-populate your test DB with a bunch of data before all the tests it&#39;s hard to say."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 1, "last_activity_date": 1513635284, "creation_date": 1513635284, "answer_id": 47877198, "question_id": 47876802, "link": "https://stackoverflow.com/questions/47876802/clean-test-database-only-of-the-data-generated-running-the-tests-with-rspec-and/47877198#47877198", "title": "Clean test database, only of the data generated running the tests with RSPEC and Capybara", "body": "<p>If you're creating records in the tables that contain the data you want saved in your tests, then there's no easy way (simple configuration change of database_cleaner, etc) to do what you want - maintain data existing at the beginning of the test. That's because that would be the transactional mode for database_cleaner which isn't compatible with Capybara and JS test in rails 4.1 (in Rails 5.1 transactional mode is compatible and database_cleaner is no longer needed for most configurations) </p>\n\n<p>If you're not creating/deleting/updating records in the tables you want saved from your tests then you can tell database_cleaner to skip those tables.</p>\n\n<p>Since it's not easy to do what you want you should ask yourself exactly why you're trying to do something most other people aren't and maybe adjust the way you're doing things.</p>\n\n<p>If you still want to continue with what you're trying to do (and you aren't modifying any of the existing data in your tests (just adding new rows) then you'll need to create a before hook that stores the maximum id in each table, and then an after hook that removes records with larger ids, and not use database_cleaner</p>\n"}], "owner": {"reputation": 547, "user_id": 6792180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mpzfa.jpg?s=128&g=1", "display_name": "Andres23Ramirez", "link": "https://stackoverflow.com/users/6792180/andres23ramirez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513635284, "creation_date": 1513633193, "last_edit_date": 1513634578, "question_id": 47876802, "link": "https://stackoverflow.com/questions/47876802/clean-test-database-only-of-the-data-generated-running-the-tests-with-rspec-and", "title": "Clean test database, only of the data generated running the tests with RSPEC and Capybara", "body": "<p>I have an application in <strong>rails 4.1</strong> to which I am doing the test with RSPEC and Capybara, for her I have a test database with data that I use to perform the tests, I am running a test that generates some data that are stored in the bd, or what I need is that after running the tests these data are not stored in it.</p>\n\n<p>I have used the gem database_cleaner (clean test database, only of the data generated running tests with RSPEC and Capybara), but this clears all the data of the test bd and I only want to erase the data that are generated by the tests.</p>\n\n<p>I have this configuration, and the test is a javascrpit test:</p>\n\n<pre><code>config.use_transactional_fixtures = false\n    config.before(:suite) do\n        if config.use_transactional_fixtures?\n             raise(&lt;&lt;-MSG)\n             Delete line `config.use_transactional_fixtures = true` from rails_helper.rb\n             (or set it to false) to prevent uncommitted transactions being used in\n             JavaScript-dependent specs.\n\n             During testing, the app-under-test that the browser driver connects to\n        uses a different database connection to the database connection used by\n            the spec. The app's database connection would not be able to access\n            uncommitted transaction data setup over the spec's database connection.\n            MSG\n        end\n    DatabaseCleaner.clean_with(:truncation)\nend\n\nconfig.before(:each) do\n    DatabaseCleaner.strategy = :transaction\nend\n\n    config.before(:each, type: :feature) do\n        driver_shares_db_connection_with_specs = Capybara.current_driver == :rack_test\n\n        if !driver_shares_db_connection_with_specs\n            DatabaseCleaner.strategy = :truncation\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "testing", "cucumber", "watir", "rubymine"], "comments": [{"owner": {"reputation": 153, "user_id": 8720632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c6968c197a712ca96e5291468ee24a?s=128&d=identicon&r=PG&f=1", "display_name": "sai charan", "link": "https://stackoverflow.com/users/8720632/sai-charan"}, "edited": false, "score": 0, "creation_date": 1513634699, "post_id": 47876745, "comment_id": 82719955, "body": "I have tried changing registry settings too nothing seems to work."}, {"owner": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1513791485, "post_id": 47876745, "comment_id": 82790661, "body": "Are you requiring watir or watir-webdriver ?   When you run <code>gem list watir</code> what is listed (including version numbers)?  Which lines of your code do the two errors above point to as failing, and can you show us those?"}, {"owner": {"reputation": 153, "user_id": 8720632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c6968c197a712ca96e5291468ee24a?s=128&d=identicon&r=PG&f=1", "display_name": "sai charan", "link": "https://stackoverflow.com/users/8720632/sai-charan"}, "reply_to_user": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1513801881, "post_id": 47876745, "comment_id": 82795607, "body": "I tried requiring both watir and watir-webdriver resulted in the same. I am using page-object gem with the watir. gem list watir has given this result:  commonwatir (4.0.0) watir (6.10.2, 5.0.0 x86-mingw32, 4.0.2 x86-mingw32) watir-classic (4.3.0, 3.7.0) watir-webdriver (0.9.9, 0.9.1). The error is pointing to the code which is entering the first field it is expecting."}, {"owner": {"reputation": 153, "user_id": 8720632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c6968c197a712ca96e5291468ee24a?s=128&d=identicon&r=PG&f=1", "display_name": "sai charan", "link": "https://stackoverflow.com/users/8720632/sai-charan"}, "reply_to_user": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1513802143, "post_id": 47876745, "comment_id": 82795731, "body": "Watir::Exception::NoMatchingWindowFoundException: browser window was closed (eval):1:in <code>process_watir_call&#39; .&#47;features&#47;support&#47;pages&#47;Messaging&#47;login_page.rb:66:in </code>enter_username_forward_receiver&#39; ./features/step_definitions/loginpage.rb:21:in <code>&#47;^I enter my username and click on continue$&#47;&#39; .&#47;features&#47;Messages&#47;loginpage.feature:11:in </code>When I enter my username and click on continue&#39;"}, {"owner": {"reputation": 153, "user_id": 8720632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c6968c197a712ca96e5291468ee24a?s=128&d=identicon&r=PG&f=1", "display_name": "sai charan", "link": "https://stackoverflow.com/users/8720632/sai-charan"}, "reply_to_user": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1513803678, "post_id": 47876745, "comment_id": 82796460, "body": "Chuck van der Linden thank you for responding found the solutions for both."}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 8720632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c6968c197a712ca96e5291468ee24a?s=128&d=identicon&r=PG&f=1", "display_name": "sai charan", "link": "https://stackoverflow.com/users/8720632/sai-charan"}, "is_accepted": false, "score": 2, "last_activity_date": 1513800422, "creation_date": 1513800422, "answer_id": 47913633, "question_id": 47876745, "link": "https://stackoverflow.com/questions/47876745/ruby-cucumber-tests-on-multiple-browsers/47913633#47913633", "title": "ruby cucumber tests on multiple browsers", "body": "<p>The problem with chrome has been fixed by using the right chromedriver version, but still having problems with the IE using watir.</p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 8720632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c6968c197a712ca96e5291468ee24a?s=128&d=identicon&r=PG&f=1", "display_name": "sai charan", "link": "https://stackoverflow.com/users/8720632/sai-charan"}, "is_accepted": true, "score": 2, "last_activity_date": 1513803630, "creation_date": 1513803630, "answer_id": 47914279, "question_id": 47876745, "link": "https://stackoverflow.com/questions/47876745/ruby-cucumber-tests-on-multiple-browsers/47914279#47914279", "title": "ruby cucumber tests on multiple browsers", "body": "<p>Found the solution for IE too its something to do with the internet options security and lower down the security level and uncheck the Enable Protected Mode.</p>\n"}], "owner": {"reputation": 153, "user_id": 8720632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c6968c197a712ca96e5291468ee24a?s=128&d=identicon&r=PG&f=1", "display_name": "sai charan", "link": "https://stackoverflow.com/users/8720632/sai-charan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 4, "accepted_answer_id": 47914279, "answer_count": 2, "score": 2, "last_activity_date": 1513803630, "creation_date": 1513632909, "last_edit_date": 1513640233, "question_id": 47876745, "link": "https://stackoverflow.com/questions/47876745/ruby-cucumber-tests-on-multiple-browsers", "title": "ruby cucumber tests on multiple browsers", "body": "<p>I am using windows 10 32 bit ruby version 233, I am facing these issues with running the tests on a ie 11 browser and the chrome browser for the tests(using page object) that are already running on firefox browser,</p>\n\n<blockquote>\n  <p>ISSUE with IE: Watir::Exception::NoMatchingWindowFoundException:\n  browser window was closed (eval):1:in `process_watir_call'</p>\n  \n  <p>ISSUE with Chrome: Errno::ECONNREFUSED: Failed to open TCP connection\n  to 127.0.0.1:9515 (No connection could be made because the target\n  machine actively refused it. - connect(2) for \"127.0.0.1\" port 9515)</p>\n</blockquote>\n\n<p><strong>i have used the following hooks for ie and chrome:</strong></p>\n\n<pre><code>Before do\n  case $browser\n    when 'mozilla'\n      @browser = Watir::Browser.new :firefox\n      @browser.window.maximize\n    when 'chrome'\n      @browser = Watir::Browser.new :chrome, :profile =&gt; \"default\"\n    when 'ie'\n      @browser = Watir::Browser.new :ie\n      # @browser.window.maximize\n      # @browser.visible = true\n    else\n      @browser = Watir::Browser.new :firefox\n      @browser.window.maximize\n  end\n\n  # @browser = Watir::Browser.new :firefox\n  # @browser.window.maximize\n  # this file contains test data that needs to be changed if tests are being executed in a different environment\n  $test_data = YAML.load_file('features/support/input_data/data/login_information.yml')\n  # this file contains base URL that needs to be changed if tests are being executed in a different environment\n  FigNewton.load('default.yml')\nend\n</code></pre>\n\n<p>I was able to run a small sample test on a separate project from ruby mine with  Watir gem. \nIs there any way to make it work on the existing firefox tests?</p>\n"}, {"tags": ["ruby", "api", "coinbase-api"], "comments": [{"owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "edited": false, "score": 0, "creation_date": 1513630360, "post_id": 47875922, "comment_id": 82717907, "body": "it looks like its just json data"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1513630471, "post_id": 47875922, "comment_id": 82717965, "body": "well I am going to have to assume this is a <a href=\"https://github.com/coinbase/coinbase-ruby/blob/master/lib/coinbase/wallet/models/account.rb\" rel=\"nofollow noreferrer\"><code>Coinbase::Wallet::Account</code></a> but you can confirm by simply calling <code>account.class</code> annnnd it appears i would be Correct <a href=\"https://github.com/coinbase/coinbase-ruby/blob/master/lib/coinbase/wallet/api_client.rb#L140\" rel=\"nofollow noreferrer\">Source</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1513631040, "post_id": 47875922, "comment_id": 82718233, "body": "^ This. I&#39;m not sure why you&#39;re asking us -- can&#39;t you just look at the variable and see for yourself?"}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1513866522, "post_id": 47875922, "comment_id": 82822034, "body": "I&#39;m writing a unit test in which I&#39;m trying to mock the behavior, so I need to know what class I should mock."}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513628885, "creation_date": 1513628885, "question_id": 47875922, "link": "https://stackoverflow.com/questions/47875922/what-kind-of-object-is-returned-by-coinbases-client-get-primary-account-method", "title": "What kind of object is returned by Coinbase&#39;s client.get_primary_account method?", "body": "<p>I'm using the Ruby API for Coinbase.  I'm trying to mock the below call</p>\n\n<pre><code>account = @client.get_primary_account()\n</code></pre>\n\n<p>in which \"@client' is built using</p>\n\n<pre><code>@client = Coinbase::Wallet::Client.new(api_key: ENV['COINBASE_KEY'],\n                                  api_secret: ENV['COINBASE_SECRET'],\n                                  CB_VERSION: 'YYYY-MM-DD')\n</code></pre>\n\n<p>However, I can't find an API reference for the \"get_primary_account\" method, which I assume would tell me what kind of object \"account\" is.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1513664481, "post_id": 47875679, "comment_id": 82727986, "body": "If you want to stuff <i>all</i> of params as keyword argument into your method, you could do it as <code>report_orders_path(by_event: @event.id.to_s, format: &#39;xlsx&#39;, **params)</code>. Requires Ruby 2 or higher."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4930434, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/880140592046671/picture?type=large", "display_name": "Lucas Oliveira", "link": "https://stackoverflow.com/users/4930434/lucas-oliveira"}, "edited": false, "score": 0, "creation_date": 1513629776, "post_id": 47876002, "comment_id": 82717609, "body": "That is a good way to do it! although it remains static, which is not my ideal solution since my app may need more filters and so."}, {"owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "reply_to_user": {"reputation": 143, "user_id": 4930434, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/880140592046671/picture?type=large", "display_name": "Lucas Oliveira", "link": "https://stackoverflow.com/users/4930434/lucas-oliveira"}, "edited": false, "score": 0, "creation_date": 1513630769, "post_id": 47876002, "comment_id": 82718110, "body": "Oh I see, maybe leveraging <code>request</code>&#39;s <a href=\"http://guides.rubyonrails.org/action_controller_overview.html#path-parameters-query-parameters-and-request-parameters\" rel=\"nofollow noreferrer\">query_parameters</a> can be helpful."}], "tags": [], "owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "is_accepted": false, "score": 0, "last_activity_date": 1513629602, "last_edit_date": 1513629602, "creation_date": 1513629250, "answer_id": 47876002, "question_id": 47875679, "link": "https://stackoverflow.com/questions/47875679/how-to-send-all-current-params-to-path/47876002#47876002", "title": "How to send all current params to path?", "body": "<p>One way to clean up the markup can be to extract the desired params to a view helper, like so:</p>\n\n<pre><code># app/helpers/application_helper.rb\n\ndef filter_params\n  {\n    by_event: @event.id.to_s, \n    by_document: params[:by_document],\n    by_status: params[:by_status],\n    by_method: params[:by_method], \n    by_date: params[:by_date], \n    by_period_init: params[:by_period_init],\n    by_period_end: params[:by_period_end],\n    format: 'xlsx'\n  }\nend\n</code></pre>\n\n<p>Then in the view, call the helper method to populate the params:</p>\n\n<pre><code># app/views/your/view/path.html.erb\n\n&lt;%= link_to reports_orders_path(filter_params) do %&gt;\n  &lt;span&gt;&lt;i class=\"fa fa-file-excel-o\"&gt;&lt;/i&gt;&lt;/span&gt;\n  &lt;%= t '.export_xlsx' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 326, "user_id": 3013354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad9dbf3df6d9dc0944bb224014a3bc2b?s=128&d=identicon&r=PG", "display_name": "nekogami", "link": "https://stackoverflow.com/users/3013354/nekogami"}, "is_accepted": true, "score": 1, "last_activity_date": 1513656947, "last_edit_date": 1513656947, "creation_date": 1513656219, "answer_id": 47879861, "question_id": 47875679, "link": "https://stackoverflow.com/questions/47875679/how-to-send-all-current-params-to-path/47879861#47879861", "title": "How to send all current params to path?", "body": "<pre><code># x_controller.rb\ndef action\n  [...] #your code\n  @filters = report_filters\nend\n\ndef report_filters\n  extract_fields = params.keys - [\"_method\", \"authenticity_token\", \"commit\", \"controller\", \"action\"] \n\n  { format: :xlsx, by_event: @event.id }.merge(params.slice(*extract_fields))\nend\n</code></pre>\n\n<p>for exemple ?</p>\n\n<p>I absolutely hate helpers because I don't find them maintainable as time passes and are prone to huge technical debt from my experience.</p>\n\n<p>EDIT: Dynamic params extraction</p>\n"}], "owner": {"reputation": 143, "user_id": 4930434, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/880140592046671/picture?type=large", "display_name": "Lucas Oliveira", "link": "https://stackoverflow.com/users/4930434/lucas-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 47879861, "answer_count": 2, "score": 1, "last_activity_date": 1513656947, "creation_date": 1513627708, "question_id": 47875679, "link": "https://stackoverflow.com/questions/47875679/how-to-send-all-current-params-to-path", "title": "How to send all current params to path?", "body": "<p>I've got a form that has the option to export to a spreadsheet, but I need the spreadsheet to have the same current params(Filters) as the report in my page.\nSomething like this: </p>\n\n<pre><code>  &lt;a href=\"&lt;%= reports_orders_path(params, format: 'xlsx') %&gt;\"&gt;\n    &lt;span&gt;&lt;i class=\"fa fa-file-excel-o\"&gt;&lt;/i&gt;&lt;/span&gt;\n    &lt;%= t '.export_xlsx' %&gt;\n  &lt;/a&gt;\n</code></pre>\n\n<p>I've managed to do so like this:</p>\n\n<pre><code>  &lt;a href=\"&lt;%= reports_orders_path(\n    \"by_event\" =&gt; @event.id.to_s, \n    \"by_document\" =&gt; params[:by_document],\n    \"by_status\" =&gt; params[:by_status],\n    \"by_method\" =&gt; params[:by_method], \n    \"by_date\" =&gt; params[:by_date], \n    \"by_period_init\" =&gt; params[:by_period_init],\n    \"by_period_end\" =&gt; params[:by_period_end],\n    format: 'xlsx') %&gt;\"&gt;\n    &lt;span &gt;&lt;i class=\"fa fa-file-excel-o\"&gt;&lt;/i&gt;&lt;/span&gt;\n    &lt;%= t '.export_xlsx' %&gt;\n  &lt;/a&gt;\n</code></pre>\n\n<p>But this feels and looks so messy.</p>\n\n<p>Is there a nicer way to get all current params and apply them to my path?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "cucumber", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1513629587, "post_id": 47875482, "comment_id": 82717539, "body": "What driver are you using with Capybara? What Capybara configuration settings are you using? What are you doing before clicking the link? Also show the stacktrace that goes with your error.  See - <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> . Odds are it&#39;s because your POST link is being interpreted as GET due to not requiring &#39;capybara/rails&#39; or an error in your JS is preventing the UJS code from initializing.  Impossible to tell without more info though."}, {"owner": {"reputation": 1, "user_id": 4568793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367a5a24e6f8c829ea7edda5d332818a?s=128&d=identicon&r=PG&f=1", "display_name": "power96", "link": "https://stackoverflow.com/users/4568793/power96"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1513633579, "post_id": 47875482, "comment_id": 82719420, "body": "Added more informations"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1513636560, "post_id": 47875482, "comment_id": 82720692, "body": "If you are actually using <code>selenium-webdriver</code> for this test (it&#39;s opening firefox/chrome browser window, etc) then it&#39;s most likely you have an error in your JS that is preventing rails ujs from initializing properly and therefore the click_link is generating a GET rather than a POST.  Check your test.log to verify the type of request being made."}, {"owner": {"reputation": 1, "user_id": 4568793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367a5a24e6f8c829ea7edda5d332818a?s=128&d=identicon&r=PG&f=1", "display_name": "power96", "link": "https://stackoverflow.com/users/4568793/power96"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1513639556, "post_id": 47875482, "comment_id": 82721721, "body": "There was indeed an error in my js but correcting it dind&#39;t solve the problem. Actualy I use cucumber to do tests, so there aren&#39;t browsers tab being opened, it&#39;s all in the background. Where I ca find the log file?"}, {"owner": {"reputation": 1, "user_id": 4568793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367a5a24e6f8c829ea7edda5d332818a?s=128&d=identicon&r=PG&f=1", "display_name": "power96", "link": "https://stackoverflow.com/users/4568793/power96"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1513643445, "post_id": 47875482, "comment_id": 82722814, "body": "Ok, I solved. The redirect code was inside an if statment that didn&#39;t pass.. Thank you for your help."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1513643648, "post_id": 47875482, "comment_id": 82722863, "body": "Cucumber will still open browser instances etc if using selenium-webdriver and you haven&#39;t configured it to run chrome or firefox in headless mode.  If you haven&#39;t configured to run headless browsers, and it&#39;s not opening a browser instance, then you&#39;re not using selenium and are probably using rack_test (which doesn&#39;t support JS) to run your tests.  If you have configured headless then it&#39;s often good to disable that when trying to debug since you can then see what the browser is actually doing."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 6097823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fI8Nl.jpg?s=128&g=1", "display_name": "Yauhen", "link": "https://stackoverflow.com/users/6097823/yauhen"}, "is_accepted": false, "score": 0, "last_activity_date": 1513846635, "last_edit_date": 1513846635, "creation_date": 1513845710, "answer_id": 47921098, "question_id": 47875482, "link": "https://stackoverflow.com/questions/47875482/rails-bdd-unable-to-find-visible-xpath-html-capybaraelementnotfound/47921098#47921098", "title": "Rails BDD Unable to find visible xpath &quot;/html&quot; (Capybara::ElementNotFound)", "body": "<p>You will need DatabaseCleaner gem since transactional fixtures do not work with Selenium. If you use framework Ruby on Rails add the database_cleaner gem to the :test group of your Gemfile and put the following code into spec/rails_helper.rb</p>\n\n<pre><code>RSpec.configure do |config|\n  # Remove this line if you're not using ActiveRecord or ActiveRecord fixtures\n  config.fixture_path = \"#{::Rails.root}/spec/fixtures\"\n\n  # If you're not using ActiveRecord, or you'd prefer not to run each of your\n  # examples within a transaction, remove the following line or assign false\n  # instead of true.\n\n  config.use_transactional_fixtures = false\n\n  # Use transactions by default\n  config.before do\n    DatabaseCleaner.strategy = :transaction\n  end\n\n  # For the javascript-enabled tests, switch to truncation\n  config.before :each, driver: :selenium do\n    DatabaseCleaner.strategy = :truncation\n  end\n\n  config.before do\n    DatabaseCleaner.start\n  end\n\n  config.after :each, driver: :selenium do\n    load \"#{Rails.root}/db/seeds.rb\"\n  end\n\n  config.after do\n    DatabaseCleaner.clean\n  end\nend\n</code></pre>\n\n<p>In spec file use 'describe' with specific driver:</p>\n\n<pre><code>describe 'something', type: :feature, driver: :selenium do\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4568793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367a5a24e6f8c829ea7edda5d332818a?s=128&d=identicon&r=PG&f=1", "display_name": "power96", "link": "https://stackoverflow.com/users/4568793/power96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 562, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513846635, "creation_date": 1513626761, "last_edit_date": 1513640083, "question_id": 47875482, "link": "https://stackoverflow.com/questions/47875482/rails-bdd-unable-to-find-visible-xpath-html-capybaraelementnotfound", "title": "Rails BDD Unable to find visible xpath &quot;/html&quot; (Capybara::ElementNotFound)", "body": "<p>selenium-webdriver</p>\n\n<p>when I try to do integration test I fail at this assertion:</p>\n\n<pre><code>@user = FactoryBot.create(:user)\n@client = FactoryBot.create(:client, user: @user)\n@event = FactoryBot.create(:event, client: @client)\nvisit client_path(@client)\nclick_link \"Bill\"\n</code></pre>\n\n<p>and get this error</p>\n\n<pre><code> And an invoice is created to the client                  # features/step_definitions/new_invoice_steps.rb:9\n  Unable to find visible xpath \"/html\" (Capybara::ElementNotFound)\n  ./features/step_definitions/new_invoice_steps.rb:12:in `\"an invoice is created to the client\"'\n  features/new_invoice.feature:15:in `And an invoice is created to the client'\n</code></pre>\n\n<p>Here is the link code</p>\n\n<pre><code>&lt;%= link_to \"Bill\", bill_client_path(@client), method: :post%&gt;\n</code></pre>\n\n<p>This is the method I call which is in the client controller</p>\n\n<pre><code>def bill\n\n#some code here\n\n  respond_to do |format|\n    if invoice.save\n      flash[:success] = 'Invoice was successfully created.'\n      format.html { redirect_to invoice}\n      format.json { render :show, status: :created, location: invoice }\n    else\n      format.html { render :new }\n      format.json { render json: invoice.errors, status: :unprocessable_entity }\n    end\n  end\n  end\n</code></pre>\n\n<p>When I stop just after the link click with byebug and type current_url it gave me this</p>\n\n<pre><code>\"http://www.example.com/clients/1/bill\"\n</code></pre>\n\n<p>which don't have a view because the bill method is intended to redirect to the invoice view. Capybara is stuck at that page and of course gave me a blank page.\nWhy Capybara doesn't get the second redirect?\nHow I fix this?</p>\n\n<p>Test log</p>\n\n<pre><code>    Started POST \"/clients/1/bill\" for 127.0.0.1 at 2017-12-18 15:54:55 +0100\nProcessing by ClientsController#bill as HTML\n  Parameters: {\"id\"=&gt;\"1\"}\n  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT ?[0m  [[\"id\", 1], [\"LIMIT\", 1]]\n  [1m[36mClient Load (0.9ms)[0m  [1m[34mSELECT  \"clients\".* FROM \"clients\" WHERE \"clients\".\"user_id\" = ? AND \"clients\".\"id\" = ? LIMIT ?[0m  [[\"user_id\", 1], [\"id\", 1], [\"LIMIT\", 1]]\n  [1m[36mEvent Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM \"events\" WHERE \"events\".\"client_id\" = ? AND \"events\".\"billed\" IS NULL LIMIT ?[0m  [[\"client_id\", 1], [\"LIMIT\", 1]]\nNo template found for ClientsController#bill, rendering head :no_content\nCompleted 204 No Content in 210ms (ActiveRecord: 2.0ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "parameters", "scope", "arguments"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7643935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1363831447009820/picture?type=large", "display_name": "phuzisham", "link": "https://stackoverflow.com/users/7643935/phuzisham"}, "edited": false, "score": 0, "creation_date": 1513631300, "post_id": 47875879, "comment_id": 82718347, "body": "Thanks...that seems to have fixed it."}], "tags": [], "owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "is_accepted": true, "score": 0, "last_activity_date": 1513628657, "creation_date": 1513628657, "answer_id": 47875879, "question_id": 47875098, "link": "https://stackoverflow.com/questions/47875098/scope-not-seeing-passed-params/47875879#47875879", "title": "Scope not seeing passed params", "body": "<p>Are you using Rails 5? If you are, I think you're missing an argument to <code>or</code>. If you change your scope to something like this, it should work. Your second where clause should be the argument given to <code>or</code>.</p>\n\n<pre><code>scope :between, -&gt; (sender_id, recipient_id) { where(sender_id: sender_id, recipient_id: recipient_id).or(where(sender_id: recipient_id, recipient_id: sender_id)) }\n</code></pre>\n\n<p>The <a href=\"http://edgeguides.rubyonrails.org/active_record_querying.html#or-conditions\" rel=\"nofollow noreferrer\">official documentation</a> shows it like this:</p>\n\n<pre><code>Client.where(locked: true).or(Client.where(orders_count: [1,3,5]))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "is_accepted": false, "score": 0, "last_activity_date": 1513628809, "creation_date": 1513628809, "answer_id": 47875910, "question_id": 47875098, "link": "https://stackoverflow.com/questions/47875098/scope-not-seeing-passed-params/47875910#47875910", "title": "Scope not seeing passed params", "body": "<p>Try this:</p>\n\n<pre><code>scope :between, -&gt;(params) {where(sender_id: params[:sender_id], recipient_id: params[:recipient_id]).or.where(sender_id: params[:recipient_id], recipient_id: params[:sender_id])\n</code></pre>\n\n<p>And then you'd have to call it with: </p>\n\n<pre><code> Conversation.between( { sender_id: params[:sender_id], recipient_id: params[:recipient_id]).present?\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7643935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1363831447009820/picture?type=large", "display_name": "phuzisham", "link": "https://stackoverflow.com/users/7643935/phuzisham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 47875879, "answer_count": 2, "score": 0, "last_activity_date": 1513628809, "creation_date": 1513625042, "last_edit_date": 1513625896, "question_id": 47875098, "link": "https://stackoverflow.com/questions/47875098/scope-not-seeing-passed-params", "title": "Scope not seeing passed params", "body": "<p>I'm getting this error</p>\n\n<blockquote>\n  <p>\"wrong number of arguments (given 0, expected 1)\"</p>\n</blockquote>\n\n<p>But if I run <code>pry</code> in the controller or the scope I can see the params and they are being passed in. I've searched everywhere but can't figure out why this is happening.</p>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>def create\n  if Conversation.between(params[:sender_id], params[:recipient_id]).present?\n    @conversation = Conversation.between(params[:sender_id],\n    params[:recipient_id]).first\n  else\n    @conversation = Conversation.create!(conversation_params)\n  end\nend\n</code></pre>\n\n<p><strong>Model</strong></p>\n\n<pre><code>scope :between, -&gt; (sender_id, recipient_id) { where(sender_id: sender_id, recipient_id: recipient_id).or.where(sender_id: recipient_id, recipient_id: sender_id) }\n</code></pre>\n\n<p>Like I said if I pry in either place I can see the params are there and they're being passed in. Maybe it has something to do with my scope?</p>\n"}, {"tags": ["ruby", "google-bigquery"], "comments": [{"owner": {"reputation": 12372, "user_id": 2877278, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jO6Hj.jpg?s=128&g=1", "display_name": "Graham Polley", "link": "https://stackoverflow.com/users/2877278/graham-polley"}, "edited": false, "score": 0, "creation_date": 1513635787, "post_id": 47874936, "comment_id": 82720391, "body": "&quot;Bring your code to the data, not your data to the code!&quot; I&#39;d be asking yourself a few questions here: 1) why are doing this? 2) do you really need that much raw unaggregated data? 3) can you not use SQL or UDFs to achieve the same directly in BigQuery? It has a whiff of bad practice TBH."}], "answers": [{"tags": [], "owner": {"reputation": 189352, "user_id": 243782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gInNr.png?s=128&g=1", "display_name": "Pentium10", "link": "https://stackoverflow.com/users/243782/pentium10"}, "is_accepted": true, "score": 2, "last_activity_date": 1513628370, "creation_date": 1513628370, "answer_id": 47875828, "question_id": 47874936, "link": "https://stackoverflow.com/questions/47874936/bigquery-can-only-fetch-100-000-records/47875828#47875828", "title": "BigQuery - Can only fetch 100,000 Records", "body": "<p>You should rather do an export job, this way you will have as file(s) on GCS.\nThen downloading from there is easy.</p>\n\n<p><a href=\"https://cloud.google.com/bigquery/docs/exporting-data\" rel=\"nofollow noreferrer\">https://cloud.google.com/bigquery/docs/exporting-data</a></p>\n\n<p>Ruby example here <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-ruby/blob/master/google-cloud-bigquery/lib/google/cloud/bigquery.rb\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/google-cloud-ruby/blob/master/google-cloud-bigquery/lib/google/cloud/bigquery.rb</a></p>\n"}], "owner": {"reputation": 181, "user_id": 9114945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8070e607052c4158c124ead73245?s=128&d=identicon&r=PG&f=1", "display_name": "user9114945", "link": "https://stackoverflow.com/users/9114945/user9114945"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 47875828, "answer_count": 1, "score": 1, "last_activity_date": 1513628370, "creation_date": 1513624254, "last_edit_date": 1513628047, "question_id": 47874936, "link": "https://stackoverflow.com/questions/47874936/bigquery-can-only-fetch-100-000-records", "title": "BigQuery - Can only fetch 100,000 Records", "body": "<p>I have a table with around 50,000,000 records.\nI would like to fetch one column of the whole table</p>\n\n<pre><code>SELECT id FROM `project.dataset.table`\n</code></pre>\n\n<p>Running this code in the Web Console takes around 80 seconds.</p>\n\n<p>However when doing this with the Ruby Gem, I'm limited to fetch only 100,000 records per query. With the <code>#next</code> method I can access the next 100,000 records.</p>\n\n<pre><code>require \"google/cloud/bigquery\"\n\n@big_query = Google::Cloud::Bigquery.new(\n  project: \"project\",\n  keyfile: \"keyfile\"\n)\n\n@dataset = @big_query.dataset(\"dataset\")\n@table   = @dataset.table(\"table\")\n\nqueue = @big_query.query(\"SELECT id FROM `project.dataset.table`\", max: 1_000_000)\nstash = queue\n\nloop do\n  queue = queue.next\n  unless queue\n    break\n  else\n    O.timed stash.size\n    stash += queue\n  end\nend\n</code></pre>\n\n<p>The problem with this is that <strong>each</strong> request takes around 30 seconds. <code>max: 1_000_000</code> is of no use, I'm stuck at 100,000. This way the query takes over 4 hours, which is not acceptable.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 7568, "user_id": 492969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b936bf1ffa62366b2c107de33361cc41?s=128&d=identicon&r=PG", "display_name": "three", "link": "https://stackoverflow.com/users/492969/three"}, "edited": false, "score": 2, "creation_date": 1513625157, "post_id": 47874766, "comment_id": 82715596, "body": "use oga or nokogiri to parse your html. Makes your life easier."}], "answers": [{"comments": [{"owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "edited": false, "score": 0, "creation_date": 1513625394, "post_id": 47875121, "comment_id": 82715712, "body": "This is great. Do you know how I remove that from the string?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "edited": false, "score": 0, "creation_date": 1513625447, "post_id": 47875121, "comment_id": 82715733, "body": "What do you mean? you want everything in your string except this?"}, {"owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "edited": false, "score": 0, "creation_date": 1513625545, "post_id": 47875121, "comment_id": 82715781, "body": "Yes. Everything but that just curious."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "edited": false, "score": 1, "creation_date": 1513625723, "post_id": 47875121, "comment_id": 82715868, "body": "just call <code>html_doc.css(&#39;.break:last-child&#39;).remove</code>"}, {"owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "edited": false, "score": 0, "creation_date": 1513626151, "post_id": 47875121, "comment_id": 82716066, "body": "I screwed up @ursus I actually need that last element to be removed and I need the string to be returned in the exact way but without that last div... Sorry for the confusion"}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1513626398, "post_id": 47875121, "comment_id": 82716183, "body": "You can just <code>gsub()</code> it away \u2013 <code>compliance_string.gsub!(html_doc.css(&#39;.break:last-child&#39;).to&zwnj;&#8203;_s, &#39;&#39;)</code>"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "edited": false, "score": 0, "creation_date": 1513628787, "post_id": 47875121, "comment_id": 82717211, "body": "@Bitwise <code>html_doc.css(&#39;.break:last-child&#39;).remove</code> and then <code>html_doc.css(&#39;.break&#39;).to_s</code> should give what you want. is that?"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 5, "last_activity_date": 1513625133, "creation_date": 1513625133, "answer_id": 47875121, "question_id": 47874766, "link": "https://stackoverflow.com/questions/47874766/find-all-the-of-the-containing-elements-within-a-div-ruby/47875121#47875121", "title": "find all the of the containing elements within a div - Ruby", "body": "<p>Use <code>nokogiri</code> gem</p>\n\n<pre><code>require 'nokogiri'\n\nhtml_doc = Nokogiri::HTML(your_html_string)\nhtml_doc.css('.break:last-child').to_s\n=&gt; \"&lt;div class=\\\"break\\\"&gt;\\n&lt;div class=\\\"name-and-date\\\"&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:50 PM \\n Eastern&lt;/strong&gt;&lt;/div&gt;\\n&lt;div class=\\\"note-contents\\\"&gt;- Bro!&lt;/div&gt;\\n&lt;/div&gt;\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1848, "user_id": 4089357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628dc1c999e767d7aff0e988631a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/4089357/abdullah"}, "is_accepted": false, "score": 1, "last_activity_date": 1513625251, "creation_date": 1513625251, "answer_id": 47875147, "question_id": 47874766, "link": "https://stackoverflow.com/questions/47874766/find-all-the-of-the-containing-elements-within-a-div-ruby/47875147#47875147", "title": "find all the of the containing elements within a div - Ruby", "body": "<p>Try this</p>\n\n<pre><code>require 'nokogiri'\n\nstr = \"&lt;div class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon \n Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-\n contents'&gt;- wrong&lt;/div&gt;&lt;/div&gt;&lt;div class='break'&gt;&lt;div class='name-and-\n date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;\n &lt;/strong&gt;&lt;div class='note-contents'&gt;- Wrong again&lt;/div&gt;&lt;/div&gt;&lt;div \n class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson \n - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- \n okay what is the matter with you.&lt;/div&gt;&lt;/div&gt;&lt;div class='break'&gt;&lt;div \n class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:50 PM \n Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- Bro!&lt;/div&gt;&lt;/div&gt;\"\n\npage = Nokogiri::HTML(str)\nlast_div = page.xpath(\"//div[@class='break'][last()]\")\nputs last_div.to_s\n</code></pre>\n"}], "owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 47875121, "answer_count": 2, "score": 0, "last_activity_date": 1513626100, "creation_date": 1513623514, "last_edit_date": 1513626100, "question_id": 47874766, "link": "https://stackoverflow.com/questions/47874766/find-all-the-of-the-containing-elements-within-a-div-ruby", "title": "find all the of the containing elements within a div - Ruby", "body": "<p>I have this string:</p>\n\n<h3>STRING:</h3>\n\n<pre><code>\"&lt;div class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon \n Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-\n contents'&gt;- wrong&lt;/div&gt;&lt;/div&gt;&lt;div class='break'&gt;&lt;div class='name-and-\n date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;\n &lt;/strong&gt;&lt;div class='note-contents'&gt;- Wrong again&lt;/div&gt;&lt;/div&gt;&lt;div \n class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson \n - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- \n okay what is the matter with you.&lt;/div&gt;&lt;/div&gt;&lt;div class='break'&gt;&lt;div \n class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:50 PM \n Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- Bro!&lt;/div&gt;&lt;/div&gt;\"\n</code></pre>\n\n<p>In this string there is a div that has the class of \"break\". I'm trying to remove the last occurrence of that div and all that it contains.</p>\n\n<p>So from that string I want this to return:</p>\n\n<h2>HOPING FOR THIS RETURN:</h2>\n\n<pre><code>\"&lt;div class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon \n Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-\n contents'&gt;- wrong&lt;/div&gt;&lt;/div&gt;&lt;div class='break'&gt;&lt;div class='name-and-\n date'&gt;&lt;strong&gt;Mr. Talon Williamson - Dec 18,  1:47 PM Eastern&lt;/div&gt;\n &lt;/strong&gt;&lt;div class='note-contents'&gt;- Wrong again&lt;/div&gt;&lt;/div&gt;&lt;div \n class='break'&gt;&lt;div class='name-and-date'&gt;&lt;strong&gt;Mr. Talon Williamson \n - Dec 18,  1:47 PM Eastern&lt;/div&gt;&lt;/strong&gt;&lt;div class='note-contents'&gt;- \n okay what is the matter with you.&lt;/div&gt;&lt;/div&gt;\"\n</code></pre>\n\n<h3>CURRENT ATTEMPT:</h3>\n\n<pre><code>compliance_string.scan(/&lt;div class='break'&gt;/).last\n</code></pre>\n\n<p>But that just returns the div not all of the containing elements and it's contents. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "shopify", "shopify-app"], "answers": [{"tags": [], "owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "is_accepted": false, "score": 7, "last_activity_date": 1513653036, "creation_date": 1513653036, "answer_id": 47879491, "question_id": 47874352, "link": "https://stackoverflow.com/questions/47874352/call-shopify-api-from-app-proxy/47879491#47879491", "title": "Call Shopify API from App Proxy", "body": "<p>An App Proxy call from Shopify gives you the store as parameter <strong>shop</strong>. Hence you can look up the shop in your backend and do anything with an authenticated session. I do this all the time with App Proxy and Webhooks. You validate the calls are from Shopify, you get the shop name, hence you can open a secure session. Additionally, you can send in the customer ID with your App Proxy call to get the products for the customer. </p>\n\n<p>You are doing the right thing, the App Proxy is the right pattern, and so carry on. You are minutes away from glory.</p>\n\n<p>From one of my Proxy controllers...</p>\n\n<pre><code>shop = Shop.find_by(shopify_domain: params[:shop])\nif shop\n  shop.with_shopify_session do\n    products = ShopifyAPI::Product.find(params[:id])\n    # la-dee-da I got a product...\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9114789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e14320b376d7d25dc179eb62c6259c?s=128&d=identicon&r=PG&f=1", "display_name": "dudettes", "link": "https://stackoverflow.com/users/9114789/dudettes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1513653036, "creation_date": 1513621599, "question_id": 47874352, "link": "https://stackoverflow.com/questions/47874352/call-shopify-api-from-app-proxy", "title": "Call Shopify API from App Proxy", "body": "<h1>Goal</h1>\n\n<p>I want to create a following app.</p>\n\n<p>Merchant selects 'top products' for each customer. These will be stored in my backend. </p>\n\n<p>For example:</p>\n\n<ul>\n<li>Customer A:  \n\n<ul>\n<li>Product X, variant 1</li>\n<li>Product Y, variant 3</li>\n</ul></li>\n<li>Customer B:\n\n<ul>\n<li>Product X, variant 2</li>\n<li>Product Z, variant 1</li>\n<li>Product W, variant 1</li>\n</ul></li>\n</ul>\n\n<p>The customer should then be able to login, go to a page in the store (e.g. <code>store.com/top_products</code>) and see their own 'top products'.</p>\n\n<h1>What I managed to do so far</h1>\n\n<p>I managed to deploy the rails Shopify app (<a href=\"https://github.com/Shopify/shopify_app\" rel=\"nofollow noreferrer\">https://github.com/Shopify/shopify_app</a>, which uses the shopify_api gem) to Heroku and connect it to my store. </p>\n\n<p>I also managed to setup the app proxy. I get the right response from the app for both the admin app page and the app proxy. </p>\n\n<p>Essentially my public app seems to work fine. </p>\n\n<h1>What I have to do now</h1>\n\n<p>I will have to call something like this in the app proxy:</p>\n\n<pre><code>ShopifyAPI::Product.find(:all, params: { limit: 10 })\n</code></pre>\n\n<p>However, this can be only called from <code>ShopifyApp::AuthenticatedController</code> (like in the admin app controller) and not <code>ShopifyApp::ApplicationController</code> (like in the proxy controller).</p>\n\n<p>So far I only managed to call the APIs and see the correct results from the admin dashboard of the store. </p>\n\n<p><strong>I cannot manage to call</strong> <code>ShopifyAPI::Product.find</code> <strong>from unauthenticated App Proxy.</strong></p>\n\n<p>Google doesn't really help me. \nThis is similar to my problem (has no solution though): <a href=\"https://ecommerce.shopify.com/c/shopify-discussion/t/how-to-connect-to-a-store-with-api-from-app-proxy-request-429417\" rel=\"nofollow noreferrer\">https://ecommerce.shopify.com/c/shopify-discussion/t/how-to-connect-to-a-store-with-api-from-app-proxy-request-429417</a></p>\n\n<h1>Question</h1>\n\n<ol>\n<li>What would be the best way to call the API from the App Proxy? </li>\n<li>Or how do I display some information on the store frontend using my\nbackend which talks to the store's API? Is an app proxy the correct approach?</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "command-line", "railstutorial.org"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1513622561, "post_id": 47874310, "comment_id": 82714458, "body": "You need to specify the Rails version when you have multiple Rails versions installed and you do not generate the new project with the newest version."}], "answers": [{"tags": [], "owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "is_accepted": false, "score": 2, "last_activity_date": 1513645224, "creation_date": 1513645224, "answer_id": 47878633, "question_id": 47874310, "link": "https://stackoverflow.com/questions/47874310/generating-a-new-sample-app-in-rails-tutorial/47878633#47878633", "title": "Generating a new sample app in rails tutorial", "body": "<p><code>rails</code> is an executable distributed in a Ruby gem. You get the <code>rails</code> command when you run <code>gem install rails</code>.</p>\n\n<p>A confusing aspect of gems is that you can have multiple versions installed. For example, on my computer I have 3 versions of <code>rails</code>:</p>\n\n<pre><code>$ gem list -e rails\n\n*** LOCAL GEMS ***\n\nrails (5.1.4, 5.0.6, 4.2.10)\n</code></pre>\n\n<p>When you run a <code>rails</code> command, which version is actually executed? In practice, Ruby always executes the <em>newest</em> version that you have installed. But what if you don't want to use the newest (or don't remember which version is newest)?</p>\n\n<p>That is where the underscore syntax comes in. This is a feature of rubygems lets you specify the gem version you want to execute by including the version surrounded by underscores as the first argument. For example, this runs <code>rails new</code> with rails version 5.0.6:</p>\n\n<pre><code>$ rails _5.0.6_ new\n</code></pre>\n\n<p>The tutorial you referenced was probably written with a specific version of Rails in mind. So the author is telling you to use the underscore syntax to ensure that you are using the version of Rails they intended, just in case you may have a newer version of Rails installed.</p>\n\n<p>Note that this only matters for <code>rails new</code> command. Once you have generated a Rails app, you can use the special <code>bin/rails</code> script whenever you need to run a Rails command. This script is smart enough to know which version of Rails to use based on the <code>Gemfile</code> in your project.</p>\n\n<p>Side note: the underscore behavior of rubygems does not seem to be documented anywhere. You can see the code that implements the behavior here: <a href=\"https://github.com/rubygems/rubygems/blob/55df5dbb5d917809a27a5881ddf3c0b5543b011f/lib/rubygems/installer.rb#L732-L734\" rel=\"nofollow noreferrer\">https://github.com/rubygems/rubygems/blob/55df5dbb5d917809a27a5881ddf3c0b5543b011f/lib/rubygems/installer.rb#L732-L734</a></p>\n"}], "owner": {"reputation": 33, "user_id": 9114765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yk29r.jpg?s=128&g=1", "display_name": "Ari Kalmen", "link": "https://stackoverflow.com/users/9114765/ari-kalmen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1513645224, "creation_date": 1513621413, "question_id": 47874310, "link": "https://stackoverflow.com/questions/47874310/generating-a-new-sample-app-in-rails-tutorial", "title": "Generating a new sample app in rails tutorial", "body": "<p>When following along with the rails tutorial, does anyone know what the <em>5.1.2</em> means in terms of testing environments? Is there a significance of specifying which rails version to use I'm used to not specifying.</p>\n\n<p>Listing 3.1: Generating a new sample app.</p>\n\n<pre><code>$ cd ~/environment\n$ rails _5.1.2_ new sample_app\n$ cd sample_app/\n</code></pre>\n\n<p><a href=\"https://www.railstutorial.org/book/static_pages\" rel=\"nofollow noreferrer\">https://www.railstutorial.org/book/static_pages</a></p>\n\n<p>Does anyone have more documentation as to what the underscore means?</p>\n\n<p>I'm not seeing it in this the guides.</p>\n\n<p><a href=\"http://guides.rubyonrails.org/command_line.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/command_line.html</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "swagger"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 1, "creation_date": 1513616847, "post_id": 47872740, "comment_id": 82711731, "body": "The Rails API is designed for use with Rails views and forms. If you are accessing your database via something other than Rails views and forms, consider using a more generic API such as <a href=\"http://jsonapi.org\" rel=\"nofollow noreferrer\">jsonapi</a>."}, {"owner": {"reputation": 459, "user_id": 1152865, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3c03dea0e249fc336b9da35a041914c6?s=128&d=identicon&r=PG", "display_name": "yoshiwaan", "link": "https://stackoverflow.com/users/1152865/yoshiwaan"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1513702157, "post_id": 47872740, "comment_id": 82749581, "body": "Rails is extremely mature and makes it easy to get up and running with minimal effort. Do you have a recommendation for a ruby gem which implements jsonapi and is easy to work with (it must be ruby). There seems to be a Rails gem for jsonapi too, any experience with that?"}], "answers": [{"comments": [{"owner": {"reputation": 459, "user_id": 1152865, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3c03dea0e249fc336b9da35a041914c6?s=128&d=identicon&r=PG", "display_name": "yoshiwaan", "link": "https://stackoverflow.com/users/1152865/yoshiwaan"}, "edited": false, "score": 0, "creation_date": 1513702061, "post_id": 47873411, "comment_id": 82749511, "body": "The core of my question is around that potential &#39;gotcha&#39;. I don&#39;t want to make changes for my design which step on something I don&#39;t understand about Rails. If you know of any that would happen because of this particular change, then please, enlighten me!"}, {"owner": {"reputation": 10688, "user_id": 790884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/27659e10cd4f89b49d677aacc2ebc064?s=128&d=identicon&r=PG", "display_name": "Thomas Edwards", "link": "https://stackoverflow.com/users/790884/thomas-edwards"}, "reply_to_user": {"reputation": 459, "user_id": 1152865, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3c03dea0e249fc336b9da35a041914c6?s=128&d=identicon&r=PG", "display_name": "yoshiwaan", "link": "https://stackoverflow.com/users/1152865/yoshiwaan"}, "edited": false, "score": 0, "creation_date": 1513771351, "post_id": 47873411, "comment_id": 82777876, "body": "I think there\u2019s two potentials. The first is just around scaffolding, which if you keep as close as possible, it means adding new features in the future will be easy. This isn\u2019t a big gotcha, as it is just scaffolding, and not a big deal if you go off piste. The bigger gotcha I think is around what the rest of Rails is doing. I don&#39;t know, but I think it could have implications for routing, especially if you intend to use resources. Might be worth checking <a href=\"http://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/routing.html</a> to see if you might use this in the near-future and if it causes a problem."}], "tags": [], "owner": {"reputation": 10688, "user_id": 790884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/27659e10cd4f89b49d677aacc2ebc064?s=128&d=identicon&r=PG", "display_name": "Thomas Edwards", "link": "https://stackoverflow.com/users/790884/thomas-edwards"}, "is_accepted": false, "score": 0, "last_activity_date": 1513618245, "last_edit_date": 1513618245, "creation_date": 1513617668, "answer_id": 47873411, "question_id": 47872740, "link": "https://stackoverflow.com/questions/47872740/why-is-a-rails-post-put-format-different-to-get-by-default/47873411#47873411", "title": "Why is a rails POST/PUT format different to GET by default?", "body": "<p>Tom Lord\u2019s answer and note is probably better than mine.</p>\n\n<hr>\n\n<p>My guess is that this mimics the behaviour of HTTP. If you GET data, you can add parameters (<code>?name=foo</code>). However, if you POST data, you tend to put the payload in the body of the request. And not have any parameters in the URL.</p>\n\n<p>It\u2019s likely that Rails thinks that you\u2019re going put that JSON object into the body of the request. Whereas the GET request it\u2019s going to split the key/values apart and send as parameters.</p>\n\n<ul>\n<li><p>The advantages of keeping it the way they are is that it\u2019ll avoid a gotcha later. I\u2019d argue this is always the best thing to do in programming, but also especially something like Rails. But, if you\u2019re making an API I can see why you\u2019d want to let people send data as parameters rather than a body that needs validating.</p></li>\n<li><p>As for Swagger, let the user know they need to send the data as a JSON string, and then use the parameters feature as expected.</p></li>\n<li><p>Last one is a bit tricky. I guess it\u2019s up to the design of your API. You could pass it as part of the request. Maybe take a look through sometihng like <a href=\"https://www.slideshare.net/apigee/restful-api-design-second-edition\" rel=\"nofollow noreferrer\">RESTful API Design</a> to clarify your goal.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 459, "user_id": 1152865, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3c03dea0e249fc336b9da35a041914c6?s=128&d=identicon&r=PG", "display_name": "yoshiwaan", "link": "https://stackoverflow.com/users/1152865/yoshiwaan"}, "edited": false, "score": 0, "creation_date": 1513701827, "post_id": 47873499, "comment_id": 82749368, "body": "The default generation I&#39;m referring to is <code>rails generate scaffold</code>, it uses strong parameters based on your input in a way which expects the nested hash."}, {"owner": {"reputation": 459, "user_id": 1152865, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3c03dea0e249fc336b9da35a041914c6?s=128&d=identicon&r=PG", "display_name": "yoshiwaan", "link": "https://stackoverflow.com/users/1152865/yoshiwaan"}, "edited": false, "score": 0, "creation_date": 1513701939, "post_id": 47873499, "comment_id": 82749436, "body": "<code>You can design the API any way you like. If you want &quot;flat parameters&quot; everywhere, then just build the Rails application like that.</code> So that&#39;s pretty much the crux of it, want to know why I shouldn&#39;t do that (i.e. if there is some built in rails magic I&#39;ll start to break). It seems like using ParamsWrapper and some manual massaging can get me the behaviour I want for an end user and end up with the same data structure for params on the back end, but it&#39;s potentially extra work so I want to know if it&#39;s worth it."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 459, "user_id": 1152865, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3c03dea0e249fc336b9da35a041914c6?s=128&d=identicon&r=PG", "display_name": "yoshiwaan", "link": "https://stackoverflow.com/users/1152865/yoshiwaan"}, "edited": false, "score": 0, "creation_date": 1513879911, "post_id": 47873499, "comment_id": 82829620, "body": "@yoshiwaan To reiterate what I said above: There is no &quot;rails magic&quot; that requires a certain API structure. However, that structure is designed to play nicely with websites - e.g. form submissions. If you want <code>rails generate</code> to create controllers in your desired format (although frankly, it&#39;s not a huge task to just manually change them!!), you could write your own <code>erb</code> controller template: <a href=\"http://guides.rubyonrails.org/generators.html#customizing-your-workflow-by-changing-generators-templates\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1513618126, "creation_date": 1513618126, "answer_id": 47873499, "question_id": 47872740, "link": "https://stackoverflow.com/questions/47872740/why-is-a-rails-post-put-format-different-to-get-by-default/47873499#47873499", "title": "Why is a rails POST/PUT format different to GET by default?", "body": "<blockquote>\n  <p>What are the advantages of this?</p>\n</blockquote>\n\n<p>This is perhaps an opinion-based answer, which is generally frowned upon by StackOverflow, but here's my 2 cents.</p>\n\n<p>In the GET request, you are simply being returned a resource. So the attributes are all you need to know:</p>\n\n<pre><code>{\n  \"id\": 1,\n  \"name\": \"foo\",\n  \"age\": 21,\n  \"parent_id\": 1\n}\n</code></pre>\n\n<p>On the other hand, for this <code>PUT</code> request:</p>\n\n<pre><code>{\n  \"parent_id\": 1,\n  \"user\": {\n    \"name\": \"foo\",\n    \"age\": 21\n  }\n}\n</code></pre>\n\n<p>You can think of the parameters as being split into two \"sections\": The <code>parent_id</code> (which would normally get sent as a <code>path</code> param, not part of the request body!) is something to \"search/filter\" by, whereas the <code>user</code> params are the attributes of the <code>user</code> resource to update.</p>\n\n<p>This logical separation of concerns is particularly useful in the context of web forms (which is what Rails was originally/primarily designed for), especially when dealing with complex queries or \"nested\" attributes.</p>\n\n<blockquote>\n  <p>what do I risk breaking by changing it?</p>\n</blockquote>\n\n<p>Nothing really.</p>\n\n<p>That format, however, was \"optimised\" for the context of RESTful APIs and web forms.</p>\n\n<p>If you'd rather use some other format then go ahead; Rails isn't forcing you to use anything here. Just beware that a naive \"better design\" may come back to bite you down the line.</p>\n\n<blockquote>\n  <p>How best to add swagger support to the API in a way which doesn't have different GET responses vs PUT/POST (which seems like bad design to me, but maybe I'm wrong)?</p>\n</blockquote>\n\n<p>You can design the API any way you like. If you want \"flat parameters\" everywhere, then just build the Rails application like that.</p>\n\n<blockquote>\n  <p>How best/should I make the API automatically add the parent id when making a call like POST /parents/1/users, because again the default generation doesn't support it and I'm wondering if there's a reason</p>\n</blockquote>\n\n<p>I'm not sure what you mean by \"the default generation doesn't support it\". The default generation of <em>what</em>? The swagger docs? The rails application?</p>\n\n<p>Anyway... That should be implemented as a <strong>path</strong> parameter. The swagger docs should look something like this:</p>\n\n<pre><code>/parents/{parent_id}/users:\n  get:\n    description: '.....'\n    parameters:\n    - name: parent_id\n      in: path\n      description: 'ID of the parent'\n      required: true\n      type: integer\n</code></pre>\n"}], "owner": {"reputation": 459, "user_id": 1152865, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3c03dea0e249fc336b9da35a041914c6?s=128&d=identicon&r=PG", "display_name": "yoshiwaan", "link": "https://stackoverflow.com/users/1152865/yoshiwaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1513618245, "creation_date": 1513615078, "question_id": 47872740, "link": "https://stackoverflow.com/questions/47872740/why-is-a-rails-post-put-format-different-to-get-by-default", "title": "Why is a rails POST/PUT format different to GET by default?", "body": "<p>Say I have a ruby model which has a name and age attribute. A GET request for one of these objects returns something like this when using <code>rails generate scaffold</code>:</p>\n\n<pre><code>{\n    \"id\": 1,\n    \"name\": \"foo\",\n    \"age\": 21,\n    \"parent_id\": 1\n}\n</code></pre>\n\n<p>By default a POST/PUT to this resource expects:</p>\n\n<pre><code>{\n    \"user\": {\n        \"name\": \"foo\",\n        \"age\": 21,\n        \"parent_id\": 1\n     }\n}\n</code></pre>\n\n<p>When using nested resources configured in routes the default behaviour is to add the parent id outside of this nested hash too, e.g.: <code>PUT /parents/1/users</code>:</p>\n\n<pre><code>{\n    \"parent_id\": 1,\n    \"user\": {\n        \"name\": \"foo\",\n        \"age\": 21\n     }\n}\n</code></pre>\n\n<p>I can go to the controller simply enough and alter what parameters are expected, but I'd like to know why that is the case and if I risk breaking anything if changing it.</p>\n\n<p>More specifically this is a Rails API and I'd like to add swagger doc generation to the API, so having this asymmetrical request body is annoying.</p>\n\n<p>So in summary my questions are:</p>\n\n<ul>\n<li>What are the advantages of this, why is it the Rails default and what do I risk breaking by changing it?</li>\n<li>How best to add swagger support to the API in a way which doesn't have different GET responses vs PUT/POST (which seems like bad design to me, but maybe I'm wrong)?</li>\n<li>How best/should I make the API automatically add the parent id when making a call like <code>POST /parents/1/users</code>, because again the default generation doesn't support it and I'm wondering if there's a reason</li>\n</ul>\n"}]