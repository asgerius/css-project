[{"tags": ["ruby", "macos", "command-line"], "comments": [{"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 0, "creation_date": 1538611467, "post_id": 52637151, "comment_id": 92207428, "body": "Make it executable and put it somewhere in your <code>$PATH</code> (the usual place is <i>/usr/local/bin</i>)."}, {"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1538617375, "post_id": 52637151, "comment_id": 92208569, "body": "The default .bashrc on some linux distros also adds <code>$HOME&#47;bin</code> to the path if it exists.  I normally symlink things into it."}], "answers": [{"tags": [], "owner": {"reputation": 288, "user_id": 778098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec4884245f757c993d86e40de221a0a?s=128&d=identicon&r=PG", "display_name": "Jamie Clinton", "link": "https://stackoverflow.com/users/778098/jamie-clinton"}, "is_accepted": false, "score": 0, "last_activity_date": 1538611471, "creation_date": 1538611471, "answer_id": 52637193, "question_id": 52637151, "link": "https://stackoverflow.com/questions/52637151/how-can-i-run-a-ruby-program-as-its-own-command/52637193#52637193", "title": "How can I run a ruby program as its own command?", "body": "<p>You need to add the directory to the PATH variable. When you type a command in *nix, it tries to look up the command in all the directories in PATH.</p>\n\n<p>Here is a random article explaning how <a href=\"https://opensource.com/article/17/6/set-path-linux\" rel=\"nofollow noreferrer\">https://opensource.com/article/17/6/set-path-linux</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 0, "creation_date": 1538647147, "post_id": 52638588, "comment_id": 92220034, "body": "I have a dir like this for little scripts and things I have written over time. These are mostly ruby and with the <code>#!</code> and executable you can also omit the <code>.rb</code>"}, {"owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "reply_to_user": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 1, "creation_date": 1538656639, "post_id": 52638588, "comment_id": 92225661, "body": "Personal preference, I like to keep the file extensions :-)"}, {"owner": {"reputation": 83, "user_id": 8565630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfcfb10a2e286fd9260efd95544fef7?s=128&d=identicon&r=PG&f=1", "display_name": "Mining15", "link": "https://stackoverflow.com/users/8565630/mining15"}, "edited": false, "score": 0, "creation_date": 1538668333, "post_id": 52638588, "comment_id": 92233577, "body": "@AndrewSchwartz When I run <code>ln -s ~&#47;bin&#47;myProgram.rb &#47;path&#47;to&#47;myProgram.rb</code>, it gives me an error <code>ln: ~&#47;bin&#47;myProgram.rb: File exists</code>, but when I go into <code>~&#47;bin</code>, there isn&#39;t anything named <code>myProgram.rb</code>"}, {"owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "reply_to_user": {"reputation": 83, "user_id": 8565630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfcfb10a2e286fd9260efd95544fef7?s=128&d=identicon&r=PG&f=1", "display_name": "Mining15", "link": "https://stackoverflow.com/users/8565630/mining15"}, "edited": false, "score": 1, "creation_date": 1538669403, "post_id": 52638588, "comment_id": 92234139, "body": "@Mining15 I got it backwards, it&#39;s ln -s existing_file new_link_file. Updated my response to reflect this."}], "tags": [], "owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1538669338, "last_edit_date": 1538669338, "creation_date": 1538624062, "answer_id": 52638588, "question_id": 52637151, "link": "https://stackoverflow.com/questions/52637151/how-can-i-run-a-ruby-program-as-its-own-command/52638588#52638588", "title": "How can I run a ruby program as its own command?", "body": "<p>Adding an alternative that I tend to prefer. Instead of balooning my <code>PATH</code> variable, I put a single folder such as <code>~/bin</code> in my <code>PATH</code>. Then I create symlinks from here to any executables I have in odd locations. E.g. <code>ln -s /path/to/myProgram.rb ~/bin/myProgram.rb</code></p>\n"}], "owner": {"reputation": 83, "user_id": 8565630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfcfb10a2e286fd9260efd95544fef7?s=128&d=identicon&r=PG&f=1", "display_name": "Mining15", "link": "https://stackoverflow.com/users/8565630/mining15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52638588, "answer_count": 2, "score": 0, "last_activity_date": 1538669338, "creation_date": 1538611125, "last_edit_date": 1538627247, "question_id": 52637151, "link": "https://stackoverflow.com/questions/52637151/how-can-i-run-a-ruby-program-as-its-own-command", "title": "How can I run a ruby program as its own command?", "body": "<p>It is possible to put the <code>#!/usr/bin/env ruby</code> at the top and run <code>chmod +x myProgram.rb</code> to run it from the terminal by doing something like <code>./myProgram.rb</code>.</p>\n\n<p>This requires the path to the <code>.rb</code> file. I am trying to run the program by just typing <code>myProgram</code> into a terminal.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "loops", "if-statement", "nested-loops"], "comments": [{"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1538618569, "post_id": 52636889, "comment_id": 92208800, "body": "BTW, you don&#39;t need to use an <code>elsif</code> here, just an <code>else</code>.  You&#39;ve already established that the names are not equal, so you don&#39;t have to check again."}], "answers": [{"comments": [{"owner": {"reputation": 520, "user_id": 5839652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/zfBMT.jpg?s=128&g=1", "display_name": "Rich", "link": "https://stackoverflow.com/users/5839652/rich"}, "edited": false, "score": 0, "creation_date": 1538625166, "post_id": 52637959, "comment_id": 92210135, "body": "I spent the whole day on this, and couldn&#39;t figure it out. Thanks so much for your help on it!"}], "tags": [], "owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "is_accepted": true, "score": 1, "last_activity_date": 1538618570, "creation_date": 1538618570, "answer_id": 52637959, "question_id": 52636889, "link": "https://stackoverflow.com/questions/52636889/nested-loop-with-if-statements/52637959#52637959", "title": "Nested loop with &#39;if&#39; statements", "body": "<p>Just to make sure we're on the same page, I'm going to restate your problem:</p>\n\n<p>You have a list of <code>AvailableSite</code>s and you want to display different information depending on if you have a visible <code>Site</code> for it.</p>\n\n<p>If that's accurate, you'll want to use <code>find</code>.  Something like:</p>\n\n<pre><code>&lt;% @available_sites.each do |available_site| %&gt;\n  &lt;% site = @sites.find { |s| s.review_site == available_site.name } %&gt;\n\n  &lt;% if site.present? %&gt;\n    &lt;%# view fragment when you have a site %&gt;\n  &lt;% else %&gt;\n    &lt;%# view fragment when you don't have a site %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This will only output one set of elements per <code>AvailableSite</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1538625338, "creation_date": 1538625338, "answer_id": 52638771, "question_id": 52636889, "link": "https://stackoverflow.com/questions/52636889/nested-loop-with-if-statements/52638771#52638771", "title": "Nested loop with &#39;if&#39; statements", "body": "<p>First, let's make it easier to parse and maintain by moving the two view partials into actual partial files. That way we have simply</p>\n\n<pre><code>&lt;% @available_sites.each do |available_site| %&gt;\n  &lt;% @sites.each do |site| %&gt;\n    &lt;% if site.review_site == available_site.name %&gt;\n       &lt;% render partial: \"sites/site_available\", locals: {site: site}&gt;\n    &lt;% else %&gt;\n       &lt;% render partial: \"sites/site_unavailable\", locals: {site: site}&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Much nicer to play around with!</p>\n\n<p>Next, we don't need to render inside a nested loop; this is why you're getting 9 instead of 3 renderings. You need one outer loop over <code>@sites</code>. In each loop, it will (1) check availability, (2) render. That will look more like</p>\n\n<pre><code>&lt;% @sites.each do |site| %&gt;\n  &lt;% if site_available?(@site, @available_sites) %&gt;\n     &lt;% render partial: \"sites/site_available\", locals: {site: site}&gt;\n  &lt;% else %&gt;\n     &lt;% render partial: \"sites/site_unavailable\", locals: {site: site}&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>where you have lots of options for what to actually do for, or instead of, <code>site_available?</code>, including:</p>\n\n<ol>\n<li>Define it as a helper method, view code is exactly as above. Not my recommended approach, but it'll get the job done.</li>\n<li>Use <code>@available_sites.map(&amp;:name).include?(@site.name)</code>. Now it's more obvious that this is a loop (<code>include?</code> will loop), but that the render is happening outside this loop. Somewhat inefficient, but so is <code>AvailableSite.all</code> so could be fine for now :-)</li>\n<li>Use a presenter: this is just a simple Ruby class that will take a <code>site</code> as an arg to the <code>initialize</code> method, and have additional logic and attrs (such as <code>@available</code>) that you can add without polluting the model, view, or controller. If this gets more complex I always advocate for starting here, but it may be a bit heavy-handed for right now.</li>\n</ol>\n\n<hr>\n\n<pre><code>class AvailableSitePresenter\n  def new(site, available_sites)\n    @site = site\n    @available = available_sites.map(&amp;:name).include?(@site.name)\n  end\n\n  def available?\n    @available\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 520, "user_id": 5839652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/zfBMT.jpg?s=128&g=1", "display_name": "Rich", "link": "https://stackoverflow.com/users/5839652/rich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 52637959, "answer_count": 2, "score": 0, "last_activity_date": 1538627607, "creation_date": 1538608596, "last_edit_date": 1538627607, "question_id": 52636889, "link": "https://stackoverflow.com/questions/52636889/nested-loop-with-if-statements", "title": "Nested loop with &#39;if&#39; statements", "body": "<p>I am trying to loop through an array of options, and check each option to see if it matches a different option within a different array. If the two options match, do one thing, if they don't match, do another thing.</p>\n\n<p>I have 3^2 available options, and it runs through nine times. It goes <code>(true, false, false)</code>, <code>(false, true, false)</code>, <code>(false, false, true)</code>, which isn't ideal. Instead, I'd like to see something along the lines of: <code>(true)</code>, <code>(false)</code>, <code>(true)</code>.</p>\n\n<p>It sits in my frontend in an erb file. I realize that there shouldn't be logic there, and am happy for refactoring suggestions but did plan on moving it out after I figured out how to make the loop work.</p>\n\n<p>Frontend Code:</p>\n\n<pre><code>&lt;% @available_sites.each do |available_site| %&gt;\n  &lt;% @sites.each do |site| %&gt;\n    &lt;% if site.review_site == available_site.name %&gt;\n      &lt;div class=\"site-row columns\"&gt;\n        &lt;div class=\"column col-4 col-md-10 col-mx-auto\"&gt;\n          &lt;div class=\"site-tile\"&gt;\n            &lt;a href=\"&lt;%= site.direct_review_url %&gt;\" style=\"background-image: url(&lt;%= image_path(\"review_site_logos/#{site.review_site}.png\")%&gt;); background-size: cover;\"&gt;&lt;/a&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"column col-4 col-md-10 col-mx-auto\"&gt;\n          &lt;span&gt;Average Rating: &lt;%= site.average_rating %&gt;&lt;/span&gt;\n          &lt;span&gt;Review Site: &lt;a href=\"&lt;%= site.direct_review_url %&gt;\"&gt;&lt;%= site.review_site %&gt;&lt;/a&gt;&lt;/span&gt;\n\n        &lt;/div&gt;\n        &lt;div class=\"column col-4 col-md-10 col-mx-auto is-flex-centered request-row-buttons\"&gt;\n          &lt;%= link_to 'Show', [site.location, site] %&gt;\n          &lt;%= link_to 'Edit', [:edit, site.location, site] %&gt;\n          &lt;%= link_to 'Destroy', [site.location, site], method: :delete, data: { confirm: 'Are you sure?' } %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;% elsif site.review_site != available_site.name %&gt;\n      &lt;div class=\"site-row columns\"&gt;\n        &lt;div class=\"column col-4 col-md-10 col-mx-auto\"&gt;\n          &lt;div class=\"site-tile\"&gt;\n            &lt;a href=\"&lt;%= available_site.link_to_info %&gt;\" style=\"background-image: url(&lt;%= image_path(\"review_site_logos/#{available_site.name}.png\")%&gt;); background-size: cover;\"&gt;&lt;/a&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"column col-4 col-md-10 col-mx-auto\"&gt;\n          &lt;span&gt;Sign Up for &lt;%= available_site.name %&gt; Business Page: &lt;%= available_site.link_to_signup %&gt;&lt;/span&gt;\n          &lt;span&gt;Review Site: &lt;a href=\"&lt;%= site.direct_review_url %&gt;\"&gt;&lt;%= site.review_site %&gt;&lt;/a&gt;&lt;/span&gt;\n\n        &lt;/div&gt;\n        &lt;div class=\"column col-4 col-md-10 col-mx-auto is-flex-centered\"&gt;\n          &lt;%= link_to \"Add #{available_site.name} to Review App\", new_location_site_path(review_site: \"#{available_site.name}\"), class: 'btn btn-primary' %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Relevant Controller Code <code>sites_controller.rb</code> - policy_scope is for authorization:</p>\n\n<pre><code>def index\n    @sites = policy_scope(@location.sites)\n    @available_sites = AvailableSite.all\n  end\n</code></pre>\n\n<p>Relevent Schema Code </p>\n\n<pre><code>create_table \"sites\", force: :cascade do |t|\n    t.bigint \"location_id\"\n    t.string \"review_site\"\n    t.string \"direct_review_url\"\n    t.string \"place_id\"\n    t.decimal \"average_rating\"\n    t.jsonb \"extra_data\", default: {}, null: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer \"rating_count\"\n    t.index [\"extra_data\"], name: \"index_sites_on_extra_data\", using: :gin\n    t.index [\"location_id\"], name: \"index_sites_on_location_id\"\n  end\ncreate_table \"available_sites\", force: :cascade do |t|\n    t.string \"name\"\n    t.string \"link_to_info\"\n    t.string \"link_to_signup\"\n    t.string \"base_review_url\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"name\"], name: \"index_available_sites_on_name\"\n  end\n</code></pre>\n\n<p>I'm looking for help/a new direction on handling nested loops.</p>\n"}, {"tags": ["ruby", "rubygems", "version", "rvm"], "comments": [{"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1538618765, "post_id": 52636855, "comment_id": 92208844, "body": "Any particular reason you want that version of Ruby?  The latest Ruby is 2.5.1 and 2.2.X is <a href=\"https://www.ruby-lang.org/en/news/2018/06/20/support-of-ruby-2-2-has-ended/\" rel=\"nofollow noreferrer\">no longer officially supported</a>."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10453830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606a3ad69257a91313c93d465ccc7bf6?s=128&d=identicon&r=PG&f=1", "display_name": "user10453830", "link": "https://stackoverflow.com/users/10453830/user10453830"}, "edited": false, "score": 0, "creation_date": 1539113651, "post_id": 52638808, "comment_id": 92381421, "body": "Thank you for the information. I am not able to install gcc-4.2 since my mac os version is too new (High Sierra) and there is no usable gcc."}], "tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": 1, "last_activity_date": 1538625659, "creation_date": 1538625659, "answer_id": 52638808, "question_id": 52636855, "link": "https://stackoverflow.com/questions/52636855/no-binary-rubies-available-for-osx-10-13-x86-64-ruby-2-2-3/52638808#52638808", "title": "No binary rubies available for: osx/10.13/x86_64/ruby-2.2.3", "body": "<p>Usually, Ruby binaries are precompiled for some popular operating systems. This significantly reduces installation time.</p>\n\n<p>Obviously, this is not your case and for your OS <code>rvm</code> suggests to compile Ruby files from source code. But compilation fails due to</p>\n\n<pre><code>You requested building with '/usr/local/bin/gcc-4.2' but it is not in your path.\n</code></pre>\n\n<p>So you need to install <code>gcc-4.2</code> compiler to continue. There are a lot of recipes in the web how to do so, from homebrew to macports, for example:</p>\n\n<p><a href=\"https://apple.stackexchange.com/questions/118830/install-gcc-to-mac-via-terminal\">https://apple.stackexchange.com/questions/118830/install-gcc-to-mac-via-terminal</a></p>\n"}], "owner": {"reputation": 41, "user_id": 10453830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606a3ad69257a91313c93d465ccc7bf6?s=128&d=identicon&r=PG&f=1", "display_name": "user10453830", "link": "https://stackoverflow.com/users/10453830/user10453830"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538625659, "creation_date": 1538608303, "last_edit_date": 1538608714, "question_id": 52636855, "link": "https://stackoverflow.com/questions/52636855/no-binary-rubies-available-for-osx-10-13-x86-64-ruby-2-2-3", "title": "No binary rubies available for: osx/10.13/x86_64/ruby-2.2.3", "body": "<p>I am trying to install ruby 2.2.3, currently I have 1.8.7 installed. It shows below error message:</p>\n\n<pre><code>No binary rubies available for: osx/10.13/x86_64/ruby-2.2.3.\nContinuing with compilation. Please read 'rvm help mount' to get more         \ninformation on binary rubies.\nYou requested building with '/usr/local/bin/gcc-4.2' but it is not in \nyour path.\n</code></pre>\n\n<p>I have tried multiple ways to install it, including below commands, but it doesn't work at all.</p>\n\n<pre><code>rvm get head\nrvm autolibs enable\nrvm use --install 1.9.2\nbundle install\n</code></pre>\n\n<p>And </p>\n\n<pre><code>rvm requirements\n</code></pre>\n\n<p>Can someone help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "methods", "view"], "comments": [{"owner": {"reputation": 71, "user_id": 9938431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r2Vx.jpg?s=128&g=1", "display_name": "TheEpicPanic", "link": "https://stackoverflow.com/users/9938431/theepicpanic"}, "edited": false, "score": 0, "creation_date": 1538610703, "post_id": 52636829, "comment_id": 92207282, "body": "Just curious, when you go back to the index page does it show itself as removed?"}, {"owner": {"reputation": 83, "user_id": 9808961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26862ce6525310bdf85b2e7b9c87af0?s=128&d=identicon&r=PG&f=1", "display_name": "J.Day", "link": "https://stackoverflow.com/users/9808961/j-day"}, "reply_to_user": {"reputation": 71, "user_id": 9938431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r2Vx.jpg?s=128&g=1", "display_name": "TheEpicPanic", "link": "https://stackoverflow.com/users/9938431/theepicpanic"}, "edited": false, "score": 0, "creation_date": 1538612832, "post_id": 52636829, "comment_id": 92207679, "body": "No, the post is still there in the index as well."}, {"owner": {"reputation": 71, "user_id": 9938431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r2Vx.jpg?s=128&g=1", "display_name": "TheEpicPanic", "link": "https://stackoverflow.com/users/9938431/theepicpanic"}, "edited": false, "score": 0, "creation_date": 1538612934, "post_id": 52636829, "comment_id": 92207693, "body": "Try putting delete in all caps for the method... <code>method: :DESTROY</code>"}, {"owner": {"reputation": 71, "user_id": 9938431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r2Vx.jpg?s=128&g=1", "display_name": "TheEpicPanic", "link": "https://stackoverflow.com/users/9938431/theepicpanic"}, "edited": false, "score": 0, "creation_date": 1538613066, "post_id": 52636829, "comment_id": 92207715, "body": "Also will you include your routes.rb? I see that the full path for the page is /admin/posts/spiral and I\u2019m curious as to what the spiral is. That could be affecting things. Also notice the output you get in the terminal says \u201cGET\u201d which means it\u2019s not using the correct controller action. I will investigate and get back to you."}, {"owner": {"reputation": 71, "user_id": 9938431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r2Vx.jpg?s=128&g=1", "display_name": "TheEpicPanic", "link": "https://stackoverflow.com/users/9938431/theepicpanic"}, "edited": false, "score": 0, "creation_date": 1538613221, "post_id": 52636829, "comment_id": 92207745, "body": "Duh I had a brain fart. Put delete for the method."}, {"owner": {"reputation": 83, "user_id": 9808961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26862ce6525310bdf85b2e7b9c87af0?s=128&d=identicon&r=PG&f=1", "display_name": "J.Day", "link": "https://stackoverflow.com/users/9808961/j-day"}, "reply_to_user": {"reputation": 71, "user_id": 9938431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r2Vx.jpg?s=128&g=1", "display_name": "TheEpicPanic", "link": "https://stackoverflow.com/users/9938431/theepicpanic"}, "edited": false, "score": 0, "creation_date": 1538613377, "post_id": 52636829, "comment_id": 92207774, "body": "Have tried &#39;DELETE&#39; still no joy, have added routes.rb. &#39;spiral&#39; is the page id for the post which uses the &#39;friendly_id&#39; gem."}, {"owner": {"reputation": 71, "user_id": 9938431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r2Vx.jpg?s=128&g=1", "display_name": "TheEpicPanic", "link": "https://stackoverflow.com/users/9938431/theepicpanic"}, "edited": false, "score": 1, "creation_date": 1538613752, "post_id": 52636829, "comment_id": 92207859, "body": "Try this: &lt;%= link_to \u201cDelete\u201d, admin_post_path(post), method: :delete %&gt;. HOWEVER, double check what the name of the path is. Go to localhost:3000/rails/info/routes or run <code>rake routes</code> to see what the route is for the delete. I think it has something to do with namespacing. If I had my computer with me I\u2019d have had this tested and correct but I\u2019m on mobile, sorry!!"}, {"owner": {"reputation": 71, "user_id": 9938431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r2Vx.jpg?s=128&g=1", "display_name": "TheEpicPanic", "link": "https://stackoverflow.com/users/9938431/theepicpanic"}, "edited": false, "score": 0, "creation_date": 1538614447, "post_id": 52636829, "comment_id": 92207987, "body": "Also I did look at friendly_id and although this seems like a good idea, this isn\u2019t the most practical solution for ID\u2019s, and it increases predictability. If you don\u2019t use a gem for authentication, you\u2019re opening up the door for people to find files via a naming convention as opposed to an arbitrary numerical ID system. May I ask why you\u2019re doing it that way? Just curious :) EDIT: I realize the uses and that\u2019s pretty cool, just exercise caution on what all you choose to name and being careful to add authentication to the pages you wanna protect."}, {"owner": {"reputation": 83, "user_id": 9808961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26862ce6525310bdf85b2e7b9c87af0?s=128&d=identicon&r=PG&f=1", "display_name": "J.Day", "link": "https://stackoverflow.com/users/9808961/j-day"}, "reply_to_user": {"reputation": 71, "user_id": 9938431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r2Vx.jpg?s=128&g=1", "display_name": "TheEpicPanic", "link": "https://stackoverflow.com/users/9938431/theepicpanic"}, "edited": false, "score": 0, "creation_date": 1538650885, "post_id": 52636829, "comment_id": 92222166, "body": "Have tried as suggested, unfortunately still no joy :("}, {"owner": {"reputation": 71, "user_id": 9938431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r2Vx.jpg?s=128&g=1", "display_name": "TheEpicPanic", "link": "https://stackoverflow.com/users/9938431/theepicpanic"}, "edited": false, "score": 0, "creation_date": 1538656153, "post_id": 52636829, "comment_id": 92225358, "body": "At this point I would re-read the documentation on friendly_id to see if there\u2019s something extra that you\u2019re missing about grabbing the ID, but I can tell you that the actual link code is correct, so I\u2019m stumped. Sorry."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 9808961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26862ce6525310bdf85b2e7b9c87af0?s=128&d=identicon&r=PG&f=1", "display_name": "J.Day", "link": "https://stackoverflow.com/users/9808961/j-day"}, "edited": false, "score": 0, "creation_date": 1538642629, "post_id": 52638858, "comment_id": 92217258, "body": "the HTML of the link reads as follows <code>&lt;a rel=&quot;nofollow&quot; data-method=&quot;delete&quot; href=&quot;&#47;admin&#47;posts&#47;restless&quot;&gt;delete&lt;&#47;a&gt;</code>. Will try your suggestion and get back to you."}, {"owner": {"reputation": 83, "user_id": 9808961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26862ce6525310bdf85b2e7b9c87af0?s=128&d=identicon&r=PG&f=1", "display_name": "J.Day", "link": "https://stackoverflow.com/users/9808961/j-day"}, "edited": false, "score": 0, "creation_date": 1538650999, "post_id": 52638858, "comment_id": 92222229, "body": "I tried altering the link as suggested. Again nothing changes! The console output is as follows:"}, {"owner": {"reputation": 83, "user_id": 9808961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26862ce6525310bdf85b2e7b9c87af0?s=128&d=identicon&r=PG&f=1", "display_name": "J.Day", "link": "https://stackoverflow.com/users/9808961/j-day"}, "edited": false, "score": 0, "creation_date": 1538651027, "post_id": 52638858, "comment_id": 92222244, "body": "<code>Started GET &quot;&#47;admin&#47;posts&#47;spiral&quot; for 127.0.0.1 at 2018-10-04 12:02:32 +0100 Processing by Admin::PostsController#show as HTML   Parameters: {&quot;id&quot;=&gt;&quot;spiral&quot;}   Post Load (0.5ms)  SELECT  &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;slug&quot; = ? LIMIT ?  [[&quot;slug&quot;, &quot;spiral&quot;], [&quot;LIMIT&quot;, 1]]   \u21b3 &#47;Users&#47;jonathonday&#47;.rvm&#47;gems&#47;ruby-2.3.1&#47;gems&#47;friendly_id-5.2&zwnj;&#8203;.4&#47;lib&#47;friendly_id&#47;f&zwnj;&#8203;inder_methods.rb:60   Rendering admin&#47;posts&#47;show.html.erb   Rendered admin&#47;posts&#47;show.html.erb (0.7ms) Completed 200 OK in 20ms (Views: 12.8ms | ActiveRecord: 0.5ms)</code>"}], "tags": [], "owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1538626089, "creation_date": 1538626089, "answer_id": 52638858, "question_id": 52636829, "link": "https://stackoverflow.com/questions/52636829/unable-to-get-delete-link-to-work-on-an-admin-panel-in-ruby-on-rails/52638858#52638858", "title": "Unable to get &quot;delete&quot; link to work on an admin panel in Ruby on Rails", "body": "<p>Notice that the route getting hit is a <code>GET</code> request, and you are hitting the <code>show</code> action. If you inspect the HTML of the page I'll bet it says nothing about the delete method. So the <code>link_to</code> call as written must not be passing <code>:method</code> correctly.</p>\n\n<p>I'm a little out of practice, but what happens if you try something like <code>link_to(\"Delete\", admin_post_path(@post), method: :delete)</code> (that is, using a string url instead of array for domain/resource specifier)?</p>\n"}], "owner": {"reputation": 83, "user_id": 9808961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26862ce6525310bdf85b2e7b9c87af0?s=128&d=identicon&r=PG&f=1", "display_name": "J.Day", "link": "https://stackoverflow.com/users/9808961/j-day"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538651273, "creation_date": 1538608072, "last_edit_date": 1538651273, "question_id": 52636829, "link": "https://stackoverflow.com/questions/52636829/unable-to-get-delete-link-to-work-on-an-admin-panel-in-ruby-on-rails", "title": "Unable to get &quot;delete&quot; link to work on an admin panel in Ruby on Rails", "body": "<p>I am new to Ruby On Rails and am currently creating standard CRUD operations for an admin panel I am building manually within the app (no admin gems used). </p>\n\n<p>However, When I call a delete link on my <code>show.html.erb</code> page nothing happens (no error screen or any other feedback in the browser). Javascript is fully enabled and I believe I have the correct gems installed.</p>\n\n<p>Could someone please let me know the best way to remedy this? I will link all relevant files below:</p>\n\n<p><strong>app/views/admin/posts/show.html.erb</strong></p>\n\n<pre><code>&lt;h1&gt;&lt;%= @post.title %&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;%= @post.body %&gt;&lt;/p&gt;&lt;br&gt;\n&lt;%= link_to \"delete\", [:admin, @post], method: :delete %&gt;\n</code></pre>\n\n<p><strong>controllers/admin/posts_controller.rb</strong></p>\n\n<pre><code>class Admin::PostsController &lt; Admin::ApplicationController\n  def index\n    @post = Post.all\n  end\n\n  def show \n    @post = Post.friendly.find(params[:id])\n  end\n\n  def new\n    @post = Post.new\n  end\n\n  def create\n    post_params = params.require(:post).permit(:title, :body, :slug)\n    @post = Post.new(post_params)\n    @post.save\n    redirect_to [:admin, @post]\n  end\n\n  def destroy\n    @post = Post.friendly.find(params[:id])\n    @post.destroy\n  end \nend\n</code></pre>\n\n<p><strong>app/assets/javascripts/admin.js</strong></p>\n\n<pre><code>// This is a manifest file that'll be compiled into application.js, which will include all the files\n// listed below.\n//\n// Any JavaScript/Coffee file within this directory, lib/assets/javascripts, or any plugin's\n// vendor/assets/javascripts directory can be referenced here using a relative path.\n//\n// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the\n// compiled file. JavaScript code in this file should be added after the last require_* statement.\n//\n// Read Sprockets README (https://github.com/rails/sprockets#sprockets-directives) for details\n// about supported directives.\n//\n\n//= require rails-ujs\n//= require activestorage\n//= require turbolinks\n//= require_tree .\n//= require jquery\n//= require jquery_ujs\n</code></pre>\n\n<p><strong>app/assets/stylesheets/admin.css</strong></p>\n\n<pre><code>/*\n * This is a manifest file that'll be compiled into application.css, which will include all the files\n * listed below.\n *\n * Any CSS and SCSS file within this directory, lib/assets/stylesheets, or any plugin's\n * vendor/assets/stylesheets directory can be referenced here using a relative path.\n *\n * You're free to add application-wide styles to this file and they'll appear at the bottom of the\n * compiled file so the styles you add here take precedence over styles defined in any other CSS/SCSS\n * files in this directory. Styles in this file should be added after the last require_* statement.\n * It is generally better to create a new file per style scope.\n *\n *= require_tree .\n *= require_self\n */\n</code></pre>\n\n<p><strong>app/views/admin/admin.html.erb</strong></p>\n\n<pre><code> &lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;JonBlog&lt;/title&gt;\n    &lt;%= csrf_meta_tags %&gt;\n    &lt;%= csp_meta_tag %&gt;\n\n    &lt;%= stylesheet_link_tag    'admin', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n    &lt;%= javascript_include_tag 'admin', 'data-turbolinks-track': 'reload' %&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n    &lt;%= yield %&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>Console output when 'delete' clicked.</strong></p>\n\n<pre><code>Started GET \"/admin/posts/spiral\" for 127.0.0.1 at 2018-10-03 23:43:48 +0100\nProcessing by Admin::PostsController#show as HTML\n  Parameters: {\"id\"=&gt;\"spiral\"}\n  Post Load (0.2ms)  SELECT  \"posts\".* FROM \"posts\" WHERE \"posts\".\"slug\" = ? LIMIT ?  [[\"slug\", \"spiral\"], [\"LIMIT\", 1]]\n  \u21b3 /Users/jonathonday/.rvm/gems/ruby-2.3.1/gems/friendly_id-5.2.4/lib/friendly_id/finder_methods.rb:60\n  Rendering admin/posts/show.html.erb\n  Rendered admin/posts/show.html.erb (1.0ms)\nCompleted 200 OK in 18ms (Views: 12.2ms | ActiveRecord: 0.2ms)\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n  namespace :admin do\n    resources :posts\n  end\n\n  resources :comments\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "database-backups"], "answers": [{"tags": [], "owner": {"reputation": 873, "user_id": 616723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c9f06775156b6cb6536330640e14a24c?s=128&d=identicon&r=PG", "display_name": "Texas", "link": "https://stackoverflow.com/users/616723/texas"}, "is_accepted": true, "score": 0, "last_activity_date": 1538600627, "creation_date": 1538600627, "answer_id": 52635673, "question_id": 52635088, "link": "https://stackoverflow.com/questions/52635088/configuring-backup-gem-in-rails-5-2-performing-backup-of-postgresql-database/52635673#52635673", "title": "Configuring Backup gem in Rails 5.2 - Performing backup of PostgreSQL database", "body": "<p>In case someone else gets stuck in a similar situation, the key to unlocking this problem was the lines:</p>\n\n<pre><code>psql -d my_db_name\nmy_db_name=# \\conninfo\n</code></pre>\n\n<p>I realised that I needed to change <code>db.socket = \"/tmp/pg.sock\"</code> to <code>db.socket = \"/tmp\"</code>, which seems to have resolved the issue.</p>\n\n<p>However, I don't understand why the path on my computer differs to the default as I didn't do anything to customise the installation of any gems or the Postgres App</p>\n"}], "owner": {"reputation": 873, "user_id": 616723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c9f06775156b6cb6536330640e14a24c?s=128&d=identicon&r=PG", "display_name": "Texas", "link": "https://stackoverflow.com/users/616723/texas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 52635673, "answer_count": 1, "score": 0, "last_activity_date": 1538600627, "creation_date": 1538598030, "last_edit_date": 1538599201, "question_id": 52635088, "link": "https://stackoverflow.com/questions/52635088/configuring-backup-gem-in-rails-5-2-performing-backup-of-postgresql-database", "title": "Configuring Backup gem in Rails 5.2 - Performing backup of PostgreSQL database", "body": "<p>I would like to perform a regular backup of a PostgreSQL database, my current intention is to use the Backup and Whenever gems.  I am relatively new to Rails and Postgres, so there is every chance I am making a very simple mistake...</p>\n\n<p>I am currently trying to setup the process on my development machine (MAC), but keep getting an error when trying to connect to the database.</p>\n\n<p>In the terminal window, I have performed the following to check the details of my database and connection:</p>\n\n<pre><code>psql -d my_db_name\nmy_db_name=# \\conninfo\nYou are connected to database \"my_db_name\" as user \"my_MAC_username\" via socket in \"/tmp\" at port \"5432\".\n\\q\n</code></pre>\n\n<p>I have also manually created a backup of the database:</p>\n\n<p><code>pg_dump -U my_MAC_username -p 5432 my_db_name &gt; name_of_backup_file</code></p>\n\n<p>However, when I try to repeat this within <code>db_backup.rb</code> (created by the Backup gem) I get the following error:</p>\n\n<pre><code>[2018/10/03 19:59:00][error] Model::Error: Backup for Description for db_backup (db_backup) Failed!\n --- Wrapped Exception ---\n Database::PostgreSQL::Error: Dump Failed!\n Pipeline STDERR Messages:\n (Note: may be interleaved if multiple commands returned error messages)\n\n pg_dump: [archiver (db)] connection to database \"my_db_name\" failed: could not connect to server: No such file or directory\n Is the server running locally and accepting\n connections on Unix domain socket \"/tmp/pg.sock/.s.PGSQL.5432\"?\n The following system errors were returned:\n Errno::EPERM: Operation not permitted - 'pg_dump' returned exit code: 1\n</code></pre>\n\n<p>The contents of my <code>db_backup.rb</code>:</p>\n\n<pre><code>Model.new(:db_backup, 'Description for db_backup') do\n\n  ##\n  # PostgreSQL [Database]\n  #\n  database PostgreSQL do |db|\n    # To dump all databases, set `db.name = :all` (or leave blank)\n    db.name               = \"my_db_name\"\n    db.username           = \"my_MAC_username\" \n    #db.password           = \"\" \n    db.host               = \"localhost\"\n    db.port               = 5432\n    db.socket             = \"/tmp/pg.sock\"\n    # When dumping all databases, `skip_tables` and `only_tables` are ignored.\n    # db.skip_tables        = [\"skip\", \"these\", \"tables\"]\n    # db.only_tables        = [\"only\", \"these\", \"tables\"]\n    # db.additional_options = [\"-xc\", \"-E=utf8\"]\n  end\nend\n</code></pre>\n\n<p><strong>Please could you suggest what I need to do to resolve this issue and perform the same backup through the <code>db_backup.rb</code> code</strong></p>\n"}, {"tags": ["javascript", "ruby", "testing", "cucumber"], "comments": [{"owner": {"reputation": 1561, "user_id": 4746328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E5r4V.png?s=128&g=1", "display_name": "Brian Peacock", "link": "https://stackoverflow.com/users/4746328/brian-peacock"}, "edited": false, "score": 3, "creation_date": 1538597834, "post_id": 52634886, "comment_id": 92203310, "body": "It would be helpful if you could post an example of what you have tried so far.  You will get better answers more quickly if people can reproduce your problem and/or examine your code.  You might find this link useful: <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>  :-)"}, {"owner": {"reputation": 1, "user_id": 10453358, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Al Zarus", "link": "https://stackoverflow.com/users/10453358/al-zarus"}, "reply_to_user": {"reputation": 1561, "user_id": 4746328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E5r4V.png?s=128&g=1", "display_name": "Brian Peacock", "link": "https://stackoverflow.com/users/4746328/brian-peacock"}, "edited": false, "score": 0, "creation_date": 1538671563, "post_id": 52634886, "comment_id": 92235245, "body": "Thanks, I fixed it!"}], "owner": {"reputation": 1, "user_id": 10453358, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Al Zarus", "link": "https://stackoverflow.com/users/10453358/al-zarus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540423262, "creation_date": 1538597146, "last_edit_date": 1540423262, "question_id": 52634886, "link": "https://stackoverflow.com/questions/52634886/parsing-javascript-in-a-ruby-cucumber-code", "title": "Parsing JavaScript in a Ruby Cucumber Code", "body": "<p>I'm using Ruby Cucumber in my project and I need to check the result of a request (that's an HTML) and I would like to access an specific node through document.querySelector(\"myNode\").</p>\n\n<p>I'm getting an exception that tells me the expression \"document\"(from document.querySelector) does not exists. I'm thinking that the Cucumber does not recognizes my JavaScript code inside my Ruby code.</p>\n\n<p>I would like to know how to evaluate an JavaScript code inside Ruby Cucumber code.</p>\n\n<p>Does anyone knows if and how I can do it?</p>\n\n<hr>\n\n<p>For example:</p>\n\n<p>I have this javascript querySelector selected from a HTML file:</p>\n\n<pre><code>document.querySelector('.billOfSaleCellBoderBottom &gt; tbody:nth-child(1) &gt; tr:nth-child(3) &gt; td:nth-child(1) &gt; table:nth-child(1) &gt; tbody:nth-child(1) &gt; tr:nth-child(4) &gt; td:nth-child(1)').lastChild.textContent.trim()\n</code></pre>\n\n<p>And it returns to me a string like this: '1199883322'</p>\n\n<p>I need to use this string inside my ruby code to make some manipulations.</p>\n\n<p>Could someone help with it?</p>\n"}, {"tags": ["ruby", "string", "capitalization"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1538657950, "post_id": 52634598, "comment_id": 92226476, "body": "&quot;I would like to know how to access the first letter of each string in the array.&quot; \u2013 The first letter of each string is always <code>@</code> in your case, so you don&#39;t really need to access it, you already know what it is."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1539083557, "post_id": 52634598, "comment_id": 92364525, "body": "@J&#246;rgWMittag Sure it&#39;s the first character, but I&#39;m not sure <code>@</code> would be considered a letter."}, {"owner": {"reputation": 4332, "user_id": 792066, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fe47011419fe78b6f8411e909cee9215?s=128&d=identicon&r=PG", "display_name": "Braiam", "link": "https://stackoverflow.com/users/792066/braiam"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1539280944, "post_id": 52634598, "comment_id": 92455427, "body": "@SagarPandya in the context of programming, anything that has a mapping in any of the character sets is a character. That includes the different alphabets, numbers, symbols and special characters without glyph like the whitespace. So, yes, the first character of any string in that array is @."}], "answers": [{"comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 3, "creation_date": 1538597166, "post_id": 52634738, "comment_id": 92203016, "body": "<code>inject</code> is overused. Both <code>Array</code> and <code>Enumerable</code> have an instance method called <code>count</code> which do what OP asks for - counting something."}, {"owner": {"reputation": 5, "user_id": 10018273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69441090e86ac4bf513519b6d5e4d1e3?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Lp", "link": "https://stackoverflow.com/users/10018273/simon-lp"}, "edited": false, "score": 0, "creation_date": 1538597238, "post_id": 52634738, "comment_id": 92203049, "body": "Works perfectly, I even understand what you did there with the ternary but why the 0 inside the inject ?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1538603633, "post_id": 52634738, "comment_id": 92205583, "body": "Consider changing your last line to <code>array.count { |s| s.match? &#47;\\A@[[:upper:]]&#47; }</code>. <code>\\A</code> is the beginning-of-string anchor whereas <code>^</code> is the beginning-of-line anchor. Both work here, but <code>\\A</code> is what you mean. <code>[[:upper:]]</code> (or <code>\\p{Upper}</code>) matches uppercase Unicode letters (in order to match &quot;&#201;clair&quot;, for example). (For the docs, search for those expressions in <a href=\"http://ruby-doc.org/core-2.5.1/Regexp.html\" rel=\"nofollow noreferrer\">Regexp</a>)."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538839233, "post_id": 52634738, "comment_id": 92289413, "body": "@CarySwoveland After thinking about it more, you&#39;re right: including <code>inject</code> in the answer adds nothing to <code>count</code> and detracts from the overall usefulness of the answer. I&#39;m removing it, but keeping <code>select</code> because I think it&#39;s useful for obtaining matched elements in addition to a raw count, which is often the case."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538843931, "post_id": 52634738, "comment_id": 92290673, "body": "No need for the attribution in your answer (though I know that&#39;s quite common here at SO). My preference is to put that in comments, if desired. More generally, I look at answers like passages of a book, concise and focused, always with the reader in mind. Text in books may go through several iterations before the presses are switched on, some of the changes having been prompted by suggestions from reviewers."}], "tags": [], "owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "is_accepted": true, "score": -1, "last_activity_date": 1538839458, "last_edit_date": 1538839458, "creation_date": 1538596502, "answer_id": 52634738, "question_id": 52634598, "link": "https://stackoverflow.com/questions/52634598/how-to-count-words-in-array-that-start-with-a-capital-letter/52634738#52634738", "title": "How to count words in array that start with a capital letter", "body": "<p>I used a regex to match <code>@</code> followed by a capital letter at the start of the string. </p>\n\n<p><code>count</code> is the most semantic function <em>(thanks to @crenmo)</em>:</p>\n\n<pre><code>array.count {|e| e =~ /^@[A-Z]/}\n</code></pre>\n\n<p><code>select</code> is useful if you'd like a list of matched elements as well as (optionally) the size:</p>\n\n<pre><code>array.select {|e| e =~ /^@[A-Z]/ }.size\n</code></pre>\n\n<p><a href=\"https://repl.it/repls/FlatGorgeousIntegrationtesting\" rel=\"nofollow noreferrer\">Try it!</a></p>\n\n<p>Use <code>[[:upper:]]</code> instead of <code>[A-Z]</code> if you wish to match non-English uppercase letters <em>(thanks to @CarySwoveland)</em>.</p>\n\n<p>For reference, indexing into a string can be done with bracket notation (although I didn't wind up using this): <code>str[0]</code></p>\n"}, {"comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1538603152, "post_id": 52635588, "comment_id": 92205424, "body": "@ggorlen I agree a regex might be a better option, the main reason I choose this version is because the question also asks for a way to access parts of a string so I tried to add something else to the answer that might be useful. Thank you for bringing that up"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 3, "creation_date": 1538605876, "post_id": 52635588, "comment_id": 92206217, "body": "@\u0412\u0438\u043a\u0442\u043e\u0440 You will want to create the range outside of the block in order to avoid generating multiple of the same range, one for each iteration of the loop."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1538612071, "post_id": 52635588, "comment_id": 92207551, "body": "@mwp Looking at the <a href=\"https://ruby-doc.org/core-1.9.3/Range.html#method-i-include-3F\" rel=\"nofollow noreferrer\">source</a> for <code>range.include?</code>, it looks like it&#39;s O(1) because it detects that these are ASCII chars and can do a quick greater than/less than. Thanks for pointing that out!"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1538636602, "post_id": 52635588, "comment_id": 92214079, "body": "@mwp That&#39;s definitely a better approach, thank you both for improving the answer"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 1, "creation_date": 1538661681, "post_id": 52635588, "comment_id": 92229159, "body": "I&#39;m wondering if <code>(&#39;A&#39;..&#39;Z&#39;)</code> is O(1) as well. Ruby might not generate the whole range item by item but may simply populate the start and end points and leave its state like that until a full expansion is required (which it isn&#39;t in <code>include?</code>). I&#39;m not 100% sure about this, though; might have time to dig into the source a bit."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1538667059, "post_id": 52635588, "comment_id": 92232791, "body": "@ggorlen Yes, it&#39;s O(1). The expression creates an instance of the Range class with a start of &#39;A&#39; and an end of &#39;Z&#39;.  It doesn&#39;t do any enumeration at the time of creation. And <code>include?</code> <i>will</i> enumerate through the range if the start/end/character to match are not simple values."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1538669304, "post_id": 52635588, "comment_id": 92234098, "body": "Yup, we&#39;re on the same page. I learned something new--go Ruby. I&#39;ll tap an upvote on this A, might even be faster than the regex."}], "tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": false, "score": 3, "last_activity_date": 1538636542, "last_edit_date": 1538636542, "creation_date": 1538600262, "answer_id": 52635588, "question_id": 52634598, "link": "https://stackoverflow.com/questions/52634598/how-to-count-words-in-array-that-start-with-a-capital-letter/52635588#52635588", "title": "How to count words in array that start with a capital letter", "body": "<p>Even though there's an accepted answer, I felt like it's worth mentioning that the same can be accomplished using <code>#count</code> instead of <code>#inject</code>:</p>\n\n<pre><code>array = [\"@user1\",\"@User2\",\"@uSer3\",\"@User4\"]\n\ncapital_letters = ('A'..'Z')\n\narray.count {|x| capital_letters.include?(x[1])}\n#=&gt; 2\n</code></pre>\n\n<p>If a block is given to the <code>#count</code> method, it counts the number of elements for which the block returns a true value. The block, in this case, evaluates to true if the second letter of the array <code>x[1]</code> is a capital letter from A to Z. This works under the assumption that every string in the array starts with a <code>\"@\"</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 4, "last_activity_date": 1538605227, "creation_date": 1538605227, "answer_id": 52636484, "question_id": 52634598, "link": "https://stackoverflow.com/questions/52634598/how-to-count-words-in-array-that-start-with-a-capital-letter/52636484#52636484", "title": "How to count words in array that start with a capital letter", "body": "<p>If the question is \"how many in a collection\" , then <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-count\" rel=\"nofollow noreferrer\">count</a> could very well be the way to go.\nThe regular expression <code>/[[:upper:]]/</code>  has the benefit that it matches capital letters other than A-Z.</p>\n\n<pre><code>array = [\"@user1\",\"@User2\",\"@uSer3\",\"@User4\"]\np array.count{|handle| handle[1].match?( /[[:upper:]]/ )}  # =&gt; 2\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10018273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69441090e86ac4bf513519b6d5e4d1e3?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Lp", "link": "https://stackoverflow.com/users/10018273/simon-lp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 0, "accepted_answer_id": 52634738, "answer_count": 3, "score": 0, "last_activity_date": 1539280583, "creation_date": 1538595874, "last_edit_date": 1539280583, "question_id": 52634598, "link": "https://stackoverflow.com/questions/52634598/how-to-count-words-in-array-that-start-with-a-capital-letter", "title": "How to count words in array that start with a capital letter", "body": "<p>I'm working on an array containing Twitter handles such as: </p>\n\n<pre><code>array = [\"@user1\",\"@User2\",\"@uSer3\",\"@User4\"]\n</code></pre>\n\n<p>I want to know how many handles start with a capital letter.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form", "binding.pry"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1538596303, "post_id": 52634587, "comment_id": 92202617, "body": "Do you need <code>&lt;form&gt;&lt;&#47;form&gt;</code>? Is anything happening in console? Or nothing at all?"}], "answers": [{"tags": [], "owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "is_accepted": true, "score": 0, "last_activity_date": 1538597091, "creation_date": 1538597091, "answer_id": 52634868, "question_id": 52634587, "link": "https://stackoverflow.com/questions/52634587/form-submit-button-not-hitting-moviescreate-in-rails/52634868#52634868", "title": "Form submit button not hitting movies#create in Rails", "body": "<p>You need to add <code>rating</code> and possibly <code>lists</code> into your <code>movie_params</code></p>\n\n<p>You can also clean your <code>create</code> method and make it simpler:</p>\n\n<pre><code>def create\n  @movie = Movie.new(movie_params)\n  if @movie.save\n    redirect_to @movie\n  else\n    flash[:danger] = \"Please try again!\"\n    render 'new'\n  end\nend\n</code></pre>\n\n<p>You shouldn't need to use <code>&lt;form&gt;</code> when using simple_form.</p>\n"}], "owner": {"reputation": 25, "user_id": 7433224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffe1db77c1d1f630db1675be156f7e79?s=128&d=identicon&r=PG&f=1", "display_name": "btcline04", "link": "https://stackoverflow.com/users/7433224/btcline04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 52634868, "answer_count": 1, "score": 0, "last_activity_date": 1538612913, "creation_date": 1538595826, "last_edit_date": 1538612913, "question_id": 52634587, "link": "https://stackoverflow.com/questions/52634587/form-submit-button-not-hitting-moviescreate-in-rails", "title": "Form submit button not hitting movies#create in Rails", "body": "<p>I'm attempting to submit a form in Rails, and it's not creating into the db. I tried placing a <code>binding.pry</code> in the controller action but I'm not reaching it. Can you take a look at my form below and my controller action and let me know if I'm doing anything wrong?</p>\n\n<pre><code>&lt;form&gt;\n&lt;%= simple_form_for @movie do |f| %&gt;\n\n&lt;div class=\"form-group\"&gt;\n  &lt;%= f.input :title, placeholder: \"Movie Title\", input_html: { class: 'form-control' } %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"form-row\"&gt;\n  &lt;div class=\"form-group col-md-6\"&gt;\n     &lt;%= f.input :year, as: :date, \n        start_year: Date.today.year,\n        end_year: Date.today.year - 100, \n        discard_day: true, order: [:year], \n        input_html: { class: 'form-control' } %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group col-md-6\"&gt;\n     &lt;%= f.input :genre, placeholder: \"Genre\", input_html: { class: 'form-control' } %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;div class=\"form-group\"&gt;\n   &lt;%= f.input :poster, placeholder: \"Poster URL\", input_html: { class: 'form-control' } %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"form-row\"&gt;\n  &lt;div class=\"form-group col-md-6\"&gt;\n     &lt;%= f.input :director, placeholder: \"Director\",\n        input_html: { class: 'form-control' } %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group col-md-6\"&gt;\n     &lt;%= f.input :rating, collection: 1..5, prompt: \"1(bad) - 5(great)\", input_html: { class: 'form-control' } %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;div class=\"form-group\"&gt;\n  &lt;%= f.association :lists, as: :radio_buttons, input_html: { class: 'form-control' } %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"form-group\"&gt;\n  &lt;%= f.input :plot, as: :text, placeholder: \"Plot Summary\", input_html: { class: 'form-control' } %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"form-group text-center\"&gt;\n  &lt;%= f.button :submit, \"Add Movie\", class: \"btn btn-primary col-md-4\" \n%&gt; \n&lt;/div&gt;\n\n&lt;% end %&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>My controller actions:</p>\n\n<pre><code>  def new\n    @movie = Movie.new\n  end\n\n  def create\n    binding.pry\n    @movie = Movie.new(movie_params)\n    if @movie.save\n      redirect_to movie_path(@movie)\n    else\n      flash[:danger] = \"Please try again!\"\n      redirect_to new_movie_path\n    end\n  end\n\n  def movie_params\n    params.require(:movie).permit(:title, :year, :genre, :poster, :director, :plot, :list_ids)\n  end\n</code></pre>\n\n<p>Any ideas here? The form will not submit.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pundit", "pg-search"], "answers": [{"tags": [], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "is_accepted": true, "score": 0, "last_activity_date": 1538754280, "creation_date": 1538754280, "answer_id": 52669206, "question_id": 52634221, "link": "https://stackoverflow.com/questions/52634221/adding-pg-search-to-index-page-but-having-pundit-issues/52669206#52669206", "title": "adding pg search to index page but having pundit issues", "body": "<p>i figured it out. i didnt add policy scope to the other part of the if else statement in the tweets controller index method.</p>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 52669206, "answer_count": 1, "score": 0, "last_activity_date": 1538754280, "creation_date": 1538594232, "last_edit_date": 1538595392, "question_id": 52634221, "link": "https://stackoverflow.com/questions/52634221/adding-pg-search-to-index-page-but-having-pundit-issues", "title": "adding pg search to index page but having pundit issues", "body": "<p>im trying to add pg search to my tweets index page, to search for tweets and users, however im having some pundit issues when i search. I've tried to set my tweet policy to return true on the index page but nothing changes.  ive tried to look on pundit documentation, but i cant seem to find anything. thanks. edit: i have added authorize @tweet in the index method but still doesnt work<a href=\"https://i.stack.imgur.com/5hDuf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5hDuf.png\" alt=\"enter image description here\"></a></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class Tweet &lt; ApplicationRecord\r\n  belongs_to :user\r\n  acts_as_votable\r\n  validates :content,\r\n    presence: true,\r\n    length: {maximum: 50},\r\n    on: :create,\r\n    allow_nil: false\r\n\r\n    include PgSearch\r\n  pg_search_scope :global_search,\r\n    against: [ :content ],\r\n    associated_against: {\r\n      user: [ :first_name, :last_name , :username]\r\n    },\r\n    using: {\r\n      tsearch: { prefix: true }\r\n    }\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;%= form_tag tweets_path, method: :get do %&gt;\r\n  &lt;%= text_field_tag :query,\r\n    params[:query],\r\n    class: \"form-control\",\r\n    placeholder: \"Find a tweet or user\"\r\n  %&gt;\r\n&lt;% end %&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>   def index\r\n    # @tweets = Tweet.all.order(\"created_at DESC\")\r\n    # @tweets = policy_scope(Tweet).paginate(page: params[:page], per_page: 7).order('created_at DESC')\r\n\r\n    if params[:query].present?\r\n      @tweets = Tweet.global_search(params[:query])\r\n    else\r\n    @tweets = policy_scope(Tweet).paginate(page: params[:page], per_page: 7).order('created_at DESC')\r\n\r\n    end\r\n    @tweet = Tweet.new\r\n    @user = current_user\r\n  end</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class TweetPolicy &lt; ApplicationPolicy\r\n  class Scope &lt; Scope\r\n    def resolve\r\n      scope.all\r\n    end\r\n  end\r\n\r\n  def index?\r\n    return true\r\n  end\r\n\r\n  def create?\r\n    return true\r\n  end\r\n\r\n  def upvote?\r\n    return true\r\n  end\r\n\r\ndef downvote?\r\n    return true\r\n  end\r\n  def update?\r\n    record.user == user\r\n    # - record: the restaurant passed to the `authorize` method in controller\r\n    # - user:   the `current_user` signed in with Devise.\r\n  end\r\n\r\n  def destroy?\r\n    record.user == user\r\n  end\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby", "sockets", "websocket"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1538594547, "post_id": 52634205, "comment_id": 92201834, "body": "Which line of the code is your error pointing to?"}, {"owner": {"reputation": 99, "user_id": 9435011, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-surR8ciCRkU/AAAAAAAAAAI/AAAAAAAAB9E/5G43kwUd2Io/photo.jpg?sz=128", "display_name": "Mohammed Sayer", "link": "https://stackoverflow.com/users/9435011/mohammed-sayer"}, "reply_to_user": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1538594784, "post_id": 52634205, "comment_id": 92201950, "body": "line number 5 @SaraTibbetts, line number 6,7 and 8 executes properly"}, {"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "edited": false, "score": 1, "creation_date": 1538600304, "post_id": 52634205, "comment_id": 92204369, "body": "I know little about ruby, per se, but every version of the documentation I see shows <code>TCPSocket</code>&#39;s <code>send</code> being inherited from <code>BasicSocket</code> and requiring at least two arguments: <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/socket/rdoc/BasicSocket.html#send-method\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.5.1/libdoc/socket/rdoc/&hellip;</a>. Try adding a second <code>flags</code> argument of zero."}], "owner": {"reputation": 99, "user_id": 9435011, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-surR8ciCRkU/AAAAAAAAAAI/AAAAAAAAB9E/5G43kwUd2Io/photo.jpg?sz=128", "display_name": "Mohammed Sayer", "link": "https://stackoverflow.com/users/9435011/mohammed-sayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538602762, "creation_date": 1538594172, "last_edit_date": 1538602762, "question_id": 52634205, "link": "https://stackoverflow.com/questions/52634205/argument-error-with-ruby-socket-programming", "title": "Argument Error with ruby socket programming", "body": "<p>I am trying to connect to a server and send a simple hello message.</p>\n\n<p>My socket is properly connecting to to the server as i get a connection establish acknowledgment from the server side. but when i am trying to send data to the server using the <code>send</code> method it gives me an error saying \n<code>Argument Error : Wrong number of arguments, (given 1, expected 2...3).</code>\nThe tutorial that i have followed to get it working had just one argument with send method, and even after looking for a while i cant find what other arguments needs to be passed</p>\n\n<p>Here is my code: \nClient.rb</p>\n\n<pre><code>require 'socket'\nhost = host_name\nport = port_number \nstreamSock = TCPSocket::new( host, port )\nstreamSock.send( \"Hello\\n\" )\nstr = streamSock.recv( 1024 )\nprint str\nstreamSock.close\n</code></pre>\n\n<p>The <code>print str</code> prints the server message but the send methods throws an error.</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1538593985, "post_id": 52634070, "comment_id": 92201550, "body": "you may want to give something like <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">github.com/nathanvda/cocoon</a> a try"}], "answers": [{"tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": 0, "last_activity_date": 1538594410, "creation_date": 1538594410, "answer_id": 52634267, "question_id": 52634070, "link": "https://stackoverflow.com/questions/52634070/how-i-can-render-new-field-in-jquery-rails/52634267#52634267", "title": "How I can render new field in jquery/rails?", "body": "<p><code>application.js</code> is a static file which is not pre-processed by a ERB-processor, for example. It goes to user's browser as it is, and when executed on client side this code:</p>\n\n<pre><code>$('#add-ingredients').append('&lt;%= render(\"form-group\") %&gt;');\n</code></pre>\n\n<p>produces a JS error.</p>\n\n<p>To make it work you need to \"unwrap\" call of <code>render(\"form-group\")</code> into HTML code. For example:</p>\n\n<pre><code>$('#add-ingredients').append('&lt;div class=\"form-group\"&gt;...&lt;/div&gt;');\n</code></pre>\n\n<p>Also please note that <a href=\"https://api.jquery.com/append/\" rel=\"nofollow noreferrer\"><code>append</code></a> actually appends newly created element to the end of element, not AFTER it. So after that call new 'form-group' element will be added to the end of '#add-ingredients' content, which may be undesirable since it has class 'form-group' too.</p>\n"}, {"tags": [], "owner": {"reputation": 1589, "user_id": 1123717, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fb3d5703694d21ac6573b31d3f3014f0?s=128&d=identicon&r=PG", "display_name": "aarkerio", "link": "https://stackoverflow.com/users/1123717/aarkerio"}, "is_accepted": false, "score": 1, "last_activity_date": 1538595652, "creation_date": 1538595652, "answer_id": 52634549, "question_id": 52634070, "link": "https://stackoverflow.com/questions/52634070/how-i-can-render-new-field-in-jquery-rails/52634549#52634549", "title": "How I can render new field in jquery/rails?", "body": "<p>Well, you can do that in some ways, I just wanna say that manipulating directly the DOM many times is an anti-pattern. Nowadays you have frameworks as React/Redux or ClojureScript that handle the global state and re-render the DOM automatically when the global state \"ingredients\" is changed.</p>\n\n<p>Maybe not now, but keep it in mind. Handle the state in a \"Single Page Application\" is tricky.</p>\n"}], "owner": {"reputation": 31, "user_id": 10453044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb29dc8d3597bd255223d0580f6e3a0?s=128&d=identicon&r=PG&f=1", "display_name": "aared", "link": "https://stackoverflow.com/users/10453044/aared"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1538597926, "creation_date": 1538593560, "last_edit_date": 1538597926, "question_id": 52634070, "link": "https://stackoverflow.com/questions/52634070/how-i-can-render-new-field-in-jquery-rails", "title": "How I can render new field in jquery/rails?", "body": "<p>I have a problem with rendering an element in jquery/rails. </p>\n\n<p>I would like to do something like this:</p>\n\n<p>When a user clicks on the button \"+\", another field with select ingredient should be rendered below the default field (because a drink can have a lot of ingredients, and I don't want to specify the amount).</p>\n\n<p>I can't figure it out, so I have to ask for help. </p>\n\n<p><strong>views/drinks/new.html.erb</strong></p>\n\n<pre><code>&lt;%= form_for @drink do |f| %&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name, class:'form-control' %&gt;&lt;br /&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :category %&gt;&lt;br /&gt;\n    &lt;%= f.select :category_id, Category.all.collect {|x| [x.name, x.id]}, {:include_blank =&gt; 'Select One'}, class:'form-control' %&gt;&lt;br /&gt;&lt;br /&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\", id: \"add-ingredients\"&gt;\n    &lt;%= f.label :ingredient %&gt;&lt;br /&gt;\n    &lt;%= f.select :ingredient_id, Ingredient.all.collect {|x| [x.name, x.id]}, {:include_blank =&gt; 'Select Few'}, class:'form-control' %&gt;&lt;%= f.button \"+\", class:'btn btn-primary', id: 'btn-ingredients' %&gt;&lt;br /&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :preparation %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :preparation, class:'form-control'%&gt;&lt;br /&gt;\n  &lt;/div&gt;\n\n  &lt;%= f.submit \"Submit\", class:'btn btn-primary' %&gt;\n  &lt;%= link_to \"Cancel\", drinks_path, class:'btn btn-default' %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>application.js</strong></p>\n\n<pre><code>$(document).ready(function(){\n  $('#btn-ingredients').click(function(){\n    $('#add-ingredients').append('&lt;%= render(\"form-group\") %&gt;');\n  });\n});\n</code></pre>\n\n<p>I was trying a lot of times and it could be something really easy, but I'm a newbie and haven't got other ideas.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 2, "creation_date": 1538588689, "post_id": 52632442, "comment_id": 92198937, "body": "What kind of arguments are you trying to pass? Where do they come from? It&#39;s very likely that you&#39;ve chosen the wrong solution for whatever your underlying problem is. There is no reason to want to add extra arguments from inside <code>routes.rb</code> to your controller method, <code>routes.rb</code> shouldn&#39;t contain any logic."}, {"owner": {"reputation": 310, "user_id": 9249700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35444a060098bf89980f294305e2af65?s=128&d=identicon&r=PG&f=1", "display_name": "Monith Shah", "link": "https://stackoverflow.com/users/9249700/monith-shah"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1538621836, "post_id": 52632442, "comment_id": 92209430, "body": "@meagar i have a set of URLs that has common action with difference between them being arguments so i wanted to pass arguments from routes"}], "answers": [{"comments": [{"owner": {"reputation": 310, "user_id": 9249700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35444a060098bf89980f294305e2af65?s=128&d=identicon&r=PG&f=1", "display_name": "Monith Shah", "link": "https://stackoverflow.com/users/9249700/monith-shah"}, "edited": false, "score": 0, "creation_date": 1538587710, "post_id": 52632508, "comment_id": 92198444, "body": "sorry I forgot to mention that I don&#39;t want the arguments to appear in URL"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 310, "user_id": 9249700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35444a060098bf89980f294305e2af65?s=128&d=identicon&r=PG&f=1", "display_name": "Monith Shah", "link": "https://stackoverflow.com/users/9249700/monith-shah"}, "edited": false, "score": 0, "creation_date": 1538588808, "post_id": 52632508, "comment_id": 92199001, "body": "in that case you need to make post type request."}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 2, "last_activity_date": 1538587304, "creation_date": 1538587304, "answer_id": 52632508, "question_id": 52632442, "link": "https://stackoverflow.com/questions/52632442/how-to-pass-arguments-to-controller-from-routes-in-rails/52632508#52632508", "title": "How to pass arguments to controller from routes in rails?", "body": "<pre><code>get '/link' , to: 'controller#method', as: :my_link\n</code></pre>\n\n<p>Use route helper to pass param</p>\n\n<pre><code>&lt;%= link_to 'My Link', my_link_path(param_1: \"abc\", param_2: \"xyz\")%&gt;\n</code></pre>\n\n<p>url will look like</p>\n\n<pre><code>http://localhost:300/link?param_1=abc&amp;&amp;param_2=xyz\n</code></pre>\n\n<p>At controller#method you can get these params as</p>\n\n<pre><code>params[:param_1] = \"abc\"\nparams[:param_2] = \"xyz\"\n</code></pre>\n"}], "owner": {"reputation": 310, "user_id": 9249700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35444a060098bf89980f294305e2af65?s=128&d=identicon&r=PG&f=1", "display_name": "Monith Shah", "link": "https://stackoverflow.com/users/9249700/monith-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1902, "favorite_count": 1, "accepted_answer_id": 52632508, "answer_count": 1, "score": -2, "last_activity_date": 1538587863, "creation_date": 1538587080, "last_edit_date": 1538587863, "question_id": 52632442, "link": "https://stackoverflow.com/questions/52632442/how-to-pass-arguments-to-controller-from-routes-in-rails", "title": "How to pass arguments to controller from routes in rails?", "body": "<p>I have a controller action as follows</p>\n\n<pre><code>def method params\n  //work with params\nend\n</code></pre>\n\n<p>and I want to pass arguments to the controller from routes.rb</p>\n\n<pre><code>get '/link' , to: 'controller#method'\n</code></pre>\n\n<p>and I don't want parameters to appear in URL.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-3.2"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10008716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7NWGSSan85U/AAAAAAAAAAI/AAAAAAAAAOc/KG4eIedeVOM/photo.jpg?sz=128", "display_name": "Karthikraj", "link": "https://stackoverflow.com/users/10008716/karthikraj"}, "edited": false, "score": 0, "creation_date": 1538588718, "post_id": 52632493, "comment_id": 92198957, "body": "Thanks much , also I have added one more query above , can you help on that please"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 7, "user_id": 10008716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7NWGSSan85U/AAAAAAAAAAI/AAAAAAAAAOc/KG4eIedeVOM/photo.jpg?sz=128", "display_name": "Karthikraj", "link": "https://stackoverflow.com/users/10008716/karthikraj"}, "edited": false, "score": 0, "creation_date": 1538589143, "post_id": 52632493, "comment_id": 92199150, "body": "@KarthikrajSaravanan Stop editing and expanding the question with more requests after getting a satisfying answer on the first question."}], "tags": [], "owner": {"reputation": 61, "user_id": 6779645, "user_type": "registered", "profile_image": "https://graph.facebook.com/1110327499045016/picture?type=large", "display_name": "Rafael Corradini da Cunha", "link": "https://stackoverflow.com/users/6779645/rafael-corradini-da-cunha"}, "is_accepted": true, "score": 1, "last_activity_date": 1538587924, "last_edit_date": 1538587924, "creation_date": 1538587262, "answer_id": 52632493, "question_id": 52632299, "link": "https://stackoverflow.com/questions/52632299/comma-separated-output-while-doing-json-parse/52632493#52632493", "title": "Comma separated output while doing JSON parse", "body": "<p>When you use puts with an array, each element is printed in a newline, you can try print that way, using <a href=\"http://ruby-for-beginners.rubymonstas.org/bonus/string_interpolation.html\" rel=\"nofollow noreferrer\">string interpolation</a>:</p>\n\n<pre><code>JSON.parse(value).map {|h| puts \"#{h['created_at']} , #{h['id']}\" }\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10008716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7NWGSSan85U/AAAAAAAAAAI/AAAAAAAAAOc/KG4eIedeVOM/photo.jpg?sz=128", "display_name": "Karthikraj", "link": "https://stackoverflow.com/users/10008716/karthikraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 52632493, "answer_count": 1, "score": -2, "last_activity_date": 1538589092, "creation_date": 1538586530, "last_edit_date": 1538589092, "question_id": 52632299, "link": "https://stackoverflow.com/questions/52632299/comma-separated-output-while-doing-json-parse", "title": "Comma separated output while doing JSON parse", "body": "<p>When I am trying to parse the JSON value using the method below, I'm getting output as:</p>\n\n<pre><code>2017-03-28T13:07:46Z\n,\nrfw23wmnq4wd\n</code></pre>\n\n<p>But, I want to avoid the next line in the output, I expected the output to be </p>\n\n<pre><code>2017-03-28T13:07:46Z , rfw23wmnq4wd.\n</code></pre>\n\n<p>Completely new to ruby, please dont mind since it is very basic one</p>\n\n<pre><code>require 'json'\nvalue = `curl https://api.statuspage.io/v1/pages/pageid/incidents.json -H \"Authorization: OAuth APIKEY\"`\n#puts value\ndata_hash = JSON.parse(value).map {|h| [h[\"created_at\"] , \",\" , h[\"id\"]] }\nputs data_hash\n</code></pre>\n\n<p>Also when I am trying to get the value of <code>body</code> , not getting nay output , please assist </p>\n\n<pre><code>{{\u201cid\":\"920h1l69bqgy\",\"components\":[{\"id\":\"230g793b5kry\",\"page_id\":\"3h5p5rr839fk\",\"group_id\":\"69pspx7kvhhj\",\"created_at\":\"2016-08-11T12:20:00Z\",\"updated_at\":\"2018-10-01T18:14:33Z\",\"group\":false,\"name\":\"WEB APP\",\"description\":null,\"position\":4,\"status\":\"operational\",\"showcase\":false,\"only_show_if_degraded\":false}],\"created_at\":\"2018-10-01T17:18:59Z\",\"impact\":\"minor\",\"impact_override\":null,\"incident_updates\":[{\"id\":\"dwwk370t321t\",\"incident_id\":\"920h1l69bqgy\",\"affected_components\":[{\"code\":\"230g793b5kry\",\"name\":\"EU CENTRAL(FRANKFURT) - WEB APP\",\"old_status\":\"degraded_performance\",\"new_status\":\"operational\"}],\"body\":\"All connectivity issues on the EU accounts have been resolved and the portals will now load without any hassles.\",\"created_at\":\"2018-10-01T18:14:33.844Z\",\"custom_tweet\":null,\"deliver_notifications\":true,\"display_at\":\"2018-10-01T23:44:33.844+05:30\",\"status\":\"resolved\",\"tweet_id\":null,\"twitter_updated_at\":null,\"updated_at\":\"2018-10-01T18:14:33.844Z\",\"wants_twitter_update\":false}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538583034, "post_id": 52631360, "comment_id": 92196082, "body": "That&#39;s an authentication problem on your server, meaning the user defined in <code>database.yml</code> doesn&#39;t exist."}, {"owner": {"reputation": 42, "user_id": 9560200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7623197e1a66834a080dbf08ab872117?s=128&d=identicon&r=PG&f=1", "display_name": "nanobot", "link": "https://stackoverflow.com/users/9560200/nanobot"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538584262, "post_id": 52631360, "comment_id": 92196711, "body": "thats not the case I have that already done that. the user defined in the database.yml is also a role in postgres with rights to create databases ..."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538585247, "post_id": 52631360, "comment_id": 92197184, "body": "I know you think that, but apparently the database you&#39;re connecting to says that&#39;s not the case."}, {"owner": {"reputation": 42, "user_id": 9560200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7623197e1a66834a080dbf08ab872117?s=128&d=identicon&r=PG&f=1", "display_name": "nanobot", "link": "https://stackoverflow.com/users/9560200/nanobot"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538585339, "post_id": 52631360, "comment_id": 92197237, "body": "So what I need to do?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538585393, "post_id": 52631360, "comment_id": 92197265, "body": "Create that role, or find out what role you&#39;re supposed to be using instead and use that. <code>myrole</code> seems like a placeholder."}, {"owner": {"reputation": 42, "user_id": 9560200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7623197e1a66834a080dbf08ab872117?s=128&d=identicon&r=PG&f=1", "display_name": "nanobot", "link": "https://stackoverflow.com/users/9560200/nanobot"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538585637, "post_id": 52631360, "comment_id": 92197392, "body": "Thats exactly what I&#39;ve done. I lopgged in as postgres -&gt; created the user &quot;myrole&quot; with the password &quot;password&quot; and allowed him to create databases. then I opened the database.yml im my /app/config directory and changed it to what ive eddited in my main post. Then I tryed to run rake db:setup and got the error that the role does not exist"}, {"owner": {"reputation": 13804, "user_id": 15754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DrITH.jpg?s=128&g=1", "display_name": "dbugger", "link": "https://stackoverflow.com/users/15754/dbugger"}, "edited": false, "score": 0, "creation_date": 1538586251, "post_id": 52631360, "comment_id": 92197696, "body": "don&#39;t see <code>web_db</code> as a database name in your database.yml"}, {"owner": {"reputation": 42, "user_id": 9560200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7623197e1a66834a080dbf08ab872117?s=128&d=identicon&r=PG&f=1", "display_name": "nanobot", "link": "https://stackoverflow.com/users/9560200/nanobot"}, "edited": false, "score": 0, "creation_date": 1538586756, "post_id": 52631360, "comment_id": 92197942, "body": "When I run the command rails should generate the database given in the database.yml by itself"}, {"owner": {"reputation": 19544, "user_id": 317989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cc8d0c8db8ad0ff2ed65ff3f5a56dd6?s=128&d=identicon&r=PG", "display_name": "house9", "link": "https://stackoverflow.com/users/317989/house9"}, "edited": false, "score": 0, "creation_date": 1538586857, "post_id": 52631360, "comment_id": 92197999, "body": "I don&#39;t think this is an issue with rails, try using the postgres <code>createdb</code> first with the same credentials, my guess is you will get the same error - see: <a href=\"https://www.postgresql.org/docs/10/static/app-createdb.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/10/static/app-createdb.html</a>"}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1538587125, "post_id": 52631360, "comment_id": 92198143, "body": "Try  rake db:migrate fisrt"}, {"owner": {"reputation": 42, "user_id": 9560200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7623197e1a66834a080dbf08ab872117?s=128&d=identicon&r=PG&f=1", "display_name": "nanobot", "link": "https://stackoverflow.com/users/9560200/nanobot"}, "reply_to_user": {"reputation": 19544, "user_id": 317989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cc8d0c8db8ad0ff2ed65ff3f5a56dd6?s=128&d=identicon&r=PG", "display_name": "house9", "link": "https://stackoverflow.com/users/317989/house9"}, "edited": false, "score": 0, "creation_date": 1538587462, "post_id": 52631360, "comment_id": 92198319, "body": "@house9 yep even when I try to login as this user I get the same message that the role does not exist ....I try to login he asks for the password and after I typed that in I get the message fatal role xy does not exist. I dont get it I created this roe like in every tutorial and doc and everytime I want to use this role it tells me it does not exist even when the command \\du shows me that role."}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1538593317, "post_id": 52631360, "comment_id": 92201244, "body": "Can you please check the steps from this tutorial: <a href=\"https://support.chartio.com/knowledgebase/creating-a-user-with-pgadmin\" rel=\"nofollow noreferrer\">support.chartio.com/knowledgebase/creating-a-user-with-pgadm&zwnj;&#8203;in</a>  or generaly can you create user and add them all privilages? Just for purpose test, I think that you need to add more than you add now."}, {"owner": {"reputation": 42, "user_id": 9560200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7623197e1a66834a080dbf08ab872117?s=128&d=identicon&r=PG&f=1", "display_name": "nanobot", "link": "https://stackoverflow.com/users/9560200/nanobot"}, "reply_to_user": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 1, "creation_date": 1538648221, "post_id": 52631360, "comment_id": 92220599, "body": "@Nezir thanks for the tutorial I already found my mistake (Im stupid). I posted it below my main post. My problem was that I changed the user to postgres and created the role under this account. When I switched back to my working user there was no sutch role. So I had to login into psql from my active working user and create the role from there. Then everything worked fine."}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1538648827, "post_id": 52631360, "comment_id": 92220966, "body": "Good job! You&#39;re welcome ;)"}], "answers": [{"tags": [], "owner": {"reputation": 42, "user_id": 9560200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7623197e1a66834a080dbf08ab872117?s=128&d=identicon&r=PG&f=1", "display_name": "nanobot", "link": "https://stackoverflow.com/users/9560200/nanobot"}, "is_accepted": false, "score": 4, "last_activity_date": 1538598820, "last_edit_date": 1538598820, "creation_date": 1538589721, "answer_id": 52633141, "question_id": 52631360, "link": "https://stackoverflow.com/questions/52631360/cant-run-rake-dbcreate/52633141#52633141", "title": "Can&#39;t run &quot;rake db:create&quot;", "body": "<p>What I did wrong:</p>\n\n<p>I used su postgres to open psql and create roles.</p>\n\n<p>What I had to do is to login from my user with the command: </p>\n\n<p><code>psql -h localhost -d web_db -U postgres or sudo -u postgres psql</code></p>\n\n<p>Then I had to create a role and asign rights:</p>\n\n<pre><code>CREATE ROLE myrole;\n\nALTER ROLE myrole WITH login;\n\nALTER ROLE myrole WITH CREATEDB;\n\nALTER ROLE myrole WITH PASSWORD 'password';\n</code></pre>\n\n<p>then I could run the command : <code>rake db:setup</code></p>\n"}], "owner": {"reputation": 42, "user_id": 9560200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7623197e1a66834a080dbf08ab872117?s=128&d=identicon&r=PG&f=1", "display_name": "nanobot", "link": "https://stackoverflow.com/users/9560200/nanobot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1538598820, "creation_date": 1538582795, "last_edit_date": 1538586698, "question_id": 52631360, "link": "https://stackoverflow.com/questions/52631360/cant-run-rake-dbcreate", "title": "Can&#39;t run &quot;rake db:create&quot;", "body": "<p>I try to setup a postgres DB for my rails project but everytime I run the command:</p>\n\n<pre><code>rake db:create\n</code></pre>\n\n<p>I get the error   </p>\n\n<pre><code>    FATAL:  role \"myrole\" does not existCouldn't create database for{\"adapter\"=&gt;\"postgresql\", \"encoding\"=&gt;\"unicode\", \"pool\"=&gt;5, \n\"database\"=&gt;\"web_db\", \"username\"=&gt;\"myrole\", \"password\"=&gt;\"password\", \"host\"=&gt;\"localhost\"}                                                            rake aborted!  \n</code></pre>\n\n<p>When I login into my web_db database with the user myrole and type in \\du it showsme all the roles including myrole! This role has also Superuser, create Role and createDB attributes.</p>\n\n<p>I have no idea whats wrong..</p>\n\n<p>Edit my database.yml</p>\n\n<pre><code>development:                                                                                                           \n  adapter: postgresql                                                                                                  \n  encoding: unicode                                                                                                    \n  database: myapp_development                                                                                          \n  pool: 5                                                                                                              \n  username: myrole                                                                                                    \n  password: password                                                                                                  \n  host: localhost                                                                                                                                                                                                                         \ntest:                                                                                                                  \n  adapter: postgresql                                                                                                  \n  encoding: unicode                                                                                                    \n  database: myapp_test                                                                                                 \n  pool: 5                                                                                                              \n  username: myrole                                                                                                    \n  password: password                                                                                                  \n  host: localhost \n</code></pre>\n"}, {"tags": ["ruby", "xml", "dom", "sax"], "answers": [{"comments": [{"owner": {"reputation": 69587, "user_id": 42585, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/upFCW.jpg?s=128&g=1", "display_name": "Alohci", "link": "https://stackoverflow.com/users/42585/alohci"}, "edited": false, "score": 0, "creation_date": 1538582844, "post_id": 52631087, "comment_id": 92195971, "body": "I know you provided an attribution of sorts, but unless you&#39;re rminner, you could make it clearer that you are quoting somebody else&#39;s opinion and code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10365811"}, "reply_to_user": {"reputation": 69587, "user_id": 42585, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/upFCW.jpg?s=128&g=1", "display_name": "Alohci", "link": "https://stackoverflow.com/users/42585/alohci"}, "edited": false, "score": 0, "creation_date": 1538582932, "post_id": 52631087, "comment_id": 92196026, "body": "@Alohci, reference is mentioned in the post"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10365811"}, "is_accepted": false, "score": 0, "last_activity_date": 1538583302, "last_edit_date": 1538583302, "creation_date": 1538581884, "answer_id": 52631087, "question_id": 52630933, "link": "https://stackoverflow.com/questions/52630933/is-it-possible-in-ruby-to-have-dom-parsing-for-parts-of-a-huge-xml-that-is-oth/52631087#52631087", "title": "Is it possible, in Ruby, to have DOM parsing for parts of a huge XML that is otherwise SAX-parsed?", "body": "<p>rminner wrote <a href=\"https://www.perlmonks.org/?node_id=1172364\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>\"Personally i think XML::DOM is not going to be the right solution, if your input xml file is very large. My perfered choice for parsing xml is XML::Twig. I am using it to parse very large files, and it is doing it quickly with a low memory usage. The same may apply for other modules, however i am most familiar with XML::Twig.</p>\n\n<p>\"I whipped up a short example, on how you can do the parsing with XML::Twig. Since i do not know exactly what you intend to do, i added several example method calls to get you on the right track (in case you ever decide to use it).\"</p>\n\n<pre><code>use strict;\nuse warnings;\nuse Data::Dumper;\n#use Data::Dumper::Concise; # i prefer Data::Dumper::Concise\nuse XML::Twig;\n\n# individually process each &lt;signal&gt; element\nsub signal_handler {\n        my ($data, $twig, $elem) = @_;\n\n        # get the attributes of $elem (&lt;signal&gt;)\n        my $atts = $elem-&gt;atts();  \n\n        if ($atts-&gt;{'sigid'} == 3464) {\n                print \"Found &lt;signal&gt; with sigid == 3464:\\n\",$elem-&gt;sp\n+rint(),\"\\n\";\n                print \"&lt;PRESS ENTER TO CONTINUE&gt;\";&lt;STDIN&gt;;\n        }\n\n        # if you want to access the element in a way similar to XML::S\n+imple:\n        my $xml_simple_style_elem = $elem-&gt;simplify();\n\n        # check out the simplified structure:\n        print Dumper($xml_simple_style_elem);\n        print \"&lt;PRESS ENTER TO CONTINUE&gt;\";&lt;STDIN&gt;;\n\n        # Example for Data Collection:\n        my ($sigid, $id) = @{$atts}{qw/sigid id/};\n        if (defined $sigid and defined $id) {\n                $data-&gt;{sigid_id_count}{$sigid}{$id}++;\n        }\n\n        # get all elements below &lt;signal&gt; which are called &lt;foo&gt;\n        my @foo_subelements  = $elem-&gt;descendants('foo');\n\n        $twig-&gt;purge; # explicitly free the memory\n};\n\nsub main {\n        my $fn = shift @ARGV;\n        my %collected_data;\n\n        my $twig = XML::Twig-&gt;new(\n                twig_roots =&gt; {\n                        'signal'     =&gt;  sub {signal_handler(\\%collect\n+ed_data, @_);},\n                },\n        );\n        eval {\n                $twig-&gt;parsefile($fn);\n        };\n        if ($@) {\n                print STDERR \"Failed to parse '$fn' ($@)\\n\";\n        }\n        if (%collected_data) {\n                print \"I collected the following data:\\n\",Dumper(\\%col\n+lected_data);\n        }\n}\nmain();\n</code></pre>\n\n<p>Please <a href=\"https://www.perlmonks.org/?node_id=1172354\" rel=\"nofollow noreferrer\">click here</a> for Full Documentation</p>\n"}], "owner": {"reputation": 254687, "user_id": 6068, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/931970b8dc51b72e05e3a12b88612d61?s=128&d=identicon&r=PG", "display_name": "pupeno", "link": "https://stackoverflow.com/users/6068/pupeno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538599044, "creation_date": 1538581444, "last_edit_date": 1538599044, "question_id": 52630933, "link": "https://stackoverflow.com/questions/52630933/is-it-possible-in-ruby-to-have-dom-parsing-for-parts-of-a-huge-xml-that-is-oth", "title": "Is it possible, in Ruby, to have DOM parsing for parts of a huge XML that is otherwise SAX-parsed?", "body": "<p>I need to parse a humongous XML file (70GB big) in Ruby and currently I'm using Nokogiri's SAX parser. This file is very big, but it's composed of one root element and then a lot of entries all of which are perfectly manageable in size. Having to do all the parsing in an event-based manner is needlesly hard. Is there a way to parse each of those entries as DOM even though the whole file is parsed as SAX?</p>\n\n<p>For example, I'm thinking of building up the dom with all the <code>start_element</code> and <code>close_element</code> calls and in the last one, when the record is closed, take that DOM and do the processing there. Surelly I'm not the first one to think of such a solution. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium-webdriver", "rubygems"], "comments": [{"owner": {"reputation": 105, "user_id": 475955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3020c3ce4a077f067d2fba5259ae44ec?s=128&d=identicon&r=PG", "display_name": "doitright", "link": "https://stackoverflow.com/users/475955/doitright"}, "edited": false, "score": 0, "creation_date": 1538582438, "post_id": 52630480, "comment_id": 92195717, "body": "I am facing the same issue. Haven&#39;t found any solution yet."}, {"owner": {"reputation": 117, "user_id": 9777233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/072a1b30fe8374a8648623b595ed6135?s=128&d=identicon&r=PG&f=1", "display_name": "Hajar", "link": "https://stackoverflow.com/users/9777233/hajar"}, "reply_to_user": {"reputation": 105, "user_id": 475955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3020c3ce4a077f067d2fba5259ae44ec?s=128&d=identicon&r=PG", "display_name": "doitright", "link": "https://stackoverflow.com/users/475955/doitright"}, "edited": false, "score": 0, "creation_date": 1538855336, "post_id": 52630480, "comment_id": 92293628, "body": "@doitright Hi! So I&#39;m not sure if you&#39;ve found a solution yet. But if you commented out the part that checks whether or not  chromedriver-helper is executable <code>rake test</code> will work. It&#39;s &quot;Platform.assert_executable path&quot; in chrome.rb in Chrome#driver_path.. (C:\\Ruby24-x64\\lib\\ruby\\gems\\2.4.0\\gems\\selenium-webdriver-3&zwnj;&#8203;.14.1\\lib\\selenium\\w&zwnj;&#8203;ebdriver)"}, {"owner": {"reputation": 9213, "user_id": 1105562, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oV4rn.jpg?s=128&g=1", "display_name": "david.pfx", "link": "https://stackoverflow.com/users/1105562/david-pfx"}, "edited": false, "score": 0, "creation_date": 1539338335, "post_id": 52630480, "comment_id": 92475656, "body": "Same problem here, and not the foggiest what do about it. Right now testing is totally broken."}, {"owner": {"reputation": 117, "user_id": 9777233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/072a1b30fe8374a8648623b595ed6135?s=128&d=identicon&r=PG&f=1", "display_name": "Hajar", "link": "https://stackoverflow.com/users/9777233/hajar"}, "reply_to_user": {"reputation": 9213, "user_id": 1105562, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oV4rn.jpg?s=128&g=1", "display_name": "david.pfx", "link": "https://stackoverflow.com/users/1105562/david-pfx"}, "edited": false, "score": 0, "creation_date": 1539342592, "post_id": 52630480, "comment_id": 92478020, "body": "@david.pfx I asked on github and I think there&#39;s not a solution yet, here&#39;s the <a href=\"https://github.com/flavorjones/chromedriver-helper/issues/19\" rel=\"nofollow noreferrer\">link</a>. And so far I&#39;ve been avoiding the problem by commenting out the line that checks whether chrome-driver is executable."}, {"owner": {"reputation": 9213, "user_id": 1105562, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oV4rn.jpg?s=128&g=1", "display_name": "david.pfx", "link": "https://stackoverflow.com/users/1105562/david-pfx"}, "edited": false, "score": 2, "creation_date": 1539472290, "post_id": 52630480, "comment_id": 92516010, "body": "@Hajar: Thanks, I&#39;ll try it. Pretty bad really, I made a new Rails installation and this is the way it came. Broken."}], "answers": [{"tags": [], "owner": {"reputation": 788, "user_id": 2561325, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004097377441/picture?type=large", "display_name": "Ricardo Green", "link": "https://stackoverflow.com/users/2561325/ricardo-green"}, "is_accepted": true, "score": 7, "last_activity_date": 1542609313, "creation_date": 1542609313, "answer_id": 53369448, "question_id": 52630480, "link": "https://stackoverflow.com/questions/52630480/rails-seleniumwebdrivererrorwebdrivererror-not-executable-chromedriver/53369448#53369448", "title": "Rails: Selenium::WebDriver::Error::WebDriverError: not executable: &#39;chromedriver-helper&#39;", "body": "<p>Encountered this issue earlier with a colleague who is working on a Windows laptop.\nResearched and found this thread at Github: \n<a href=\"https://github.com/flavorjones/chromedriver-helper/issues/19\" rel=\"noreferrer\">https://github.com/flavorjones/chromedriver-helper/issues/19</a></p>\n\n<p>This is not really a fix but is just a work around suggested by one of the participants on the thread. What we did was changed <code>gem 'chromedriver-helper', '~&gt; 2.1.0'</code> to <code>gem 'chromedriver-helper', '1.2.0'</code> in your Gemfile.</p>\n\n<p>Steps:</p>\n\n<ol>\n<li><p>Delete Gemlock file.</p></li>\n<li><p>Change chromedriver-helper version in your Gemfile.</p></li>\n<li>Run <code>bundle install</code>, so the change could take effect.</li>\n<li>Run the tests again.</li>\n</ol>\n\n<p>This worked on our end.</p>\n"}], "owner": {"reputation": 117, "user_id": 9777233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/072a1b30fe8374a8648623b595ed6135?s=128&d=identicon&r=PG&f=1", "display_name": "Hajar", "link": "https://stackoverflow.com/users/9777233/hajar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4839, "favorite_count": 0, "accepted_answer_id": 53369448, "answer_count": 1, "score": 3, "last_activity_date": 1542609313, "creation_date": 1538580100, "last_edit_date": 1538590420, "question_id": 52630480, "link": "https://stackoverflow.com/questions/52630480/rails-seleniumwebdrivererrorwebdrivererror-not-executable-chromedriver", "title": "Rails: Selenium::WebDriver::Error::WebDriverError: not executable: &#39;chromedriver-helper&#39;", "body": "<p>I've setup Rails environment two days ago and I thought things were going fine but then when I ran <code>rake test</code> command it got aborted due to this load error:</p>\n\n<pre><code>Bundler::GemRequireError: There was an error while trying to load the gem 'chromedriver-helper'`\n`Caused by: Selenium::WebDriver::Error::WebDriverError: not executable: \"C:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/chromedriver-helper-2.1.0/bin/chromedriver-helper\"\n</code></pre>\n\n<p>I tried a few things but nothing worked. I reinstalled the gem and updated it. Then I tried to install an older version of it. I also tried to add\n<code>gem \"selenium-webdriver\"</code> and  <code>gem \"chromedriver-helper\"</code> to the <code>Gemfile</code></p>\n\n<p>and in <code>spec_helper.rb</code> this:</p>\n\n<pre><code>Capybara.register_driver :selenium do |app|\n  Capybara::Selenium::Driver.new(app, browser: :chrome)\nend\n</code></pre>\n\n<p>as mentioned on <a href=\"https://github.com/flavorjones/chromedriver-helper\" rel=\"nofollow noreferrer\">github</a> but not sure what should I try next. </p>\n\n<p>Could someone help me with this, please? Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1538579957, "post_id": 52630405, "comment_id": 92194247, "body": "If the method is used more than once, I believe best practice is to define it in the concern and then include that concern in controllers where needed."}], "answers": [{"tags": [], "owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1538818820, "creation_date": 1538818820, "answer_id": 52677704, "question_id": 52630405, "link": "https://stackoverflow.com/questions/52630405/where-to-put-code-shared-between-concern-and-controller/52677704#52677704", "title": "Where to put code shared between concern AND controller", "body": "<p>You probably just want a <a href=\"https://www.learnhowtoprogram.com/rails/building-an-e-commerce-site-with-ajax-and-apis/plain-old-ruby-objects\" rel=\"nofollow noreferrer\">plain old ruby object</a>. Rails defines a lot of convenient structure for you, but don't box yourself into it. Create a regular Ruby class, and use it in your controllers, models, and everywhere else.</p>\n"}, {"tags": [], "owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "is_accepted": false, "score": 0, "last_activity_date": 1538826385, "creation_date": 1538826385, "answer_id": 52678724, "question_id": 52630405, "link": "https://stackoverflow.com/questions/52630405/where-to-put-code-shared-between-concern-and-controller/52678724#52678724", "title": "Where to put code shared between concern AND controller", "body": "<p>It all depends on the use case. For ex: I prefer to use ApplicationController mainly for rescuing from exceptions or to set constants. The code related to setting current user, his/her preferences is generally kept in concerns. I like to keep my application controller less cluttered and move logic to different concerns.  </p>\n\n<p>The plus point of using concern is to DRY up your code. If you don't need code in all of your controllers only a few of them then definitely concerns are the way to go.</p>\n"}], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1538826385, "creation_date": 1538579900, "question_id": 52630405, "link": "https://stackoverflow.com/questions/52630405/where-to-put-code-shared-between-concern-and-controller", "title": "Where to put code shared between concern AND controller", "body": "<p>I know I can put shared <code>controller</code> code in <code>ApplicationController</code> and I can put shared concern code in a <code>ApplicationConcern</code> but is there a place where I can put methods that could be shared across both <code>Controllers</code> AND <code>Concerns</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker"], "comments": [{"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "edited": false, "score": 0, "creation_date": 1538584698, "post_id": 52630394, "comment_id": 92196903, "body": "Could you share your <code>Dokcerfile</code> that you use to build the docker image? Probably your app is being deployed inside the container in the <code>&#47;bla</code> path."}], "answers": [{"tags": [], "owner": {"reputation": 600, "user_id": 8129831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/awcNg.jpg?s=128&g=1", "display_name": "H Dox", "link": "https://stackoverflow.com/users/8129831/h-dox"}, "is_accepted": true, "score": 1, "last_activity_date": 1538625061, "creation_date": 1538625061, "answer_id": 52638736, "question_id": 52630394, "link": "https://stackoverflow.com/questions/52630394/rails-docker-finding-the-rails-root-path-in-development/52638736#52638736", "title": "Rails - Docker - finding the Rails root path in development", "body": "<p>If your project folder is mount to your docker container then you will have to explicitly declare <code>WORKDIR</code> by appending this line to your <code>Dockerfile</code> and rebuild the image.</p>\n\n<p><code>WORKDIR /home/projects/bla</code></p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 52638736, "answer_count": 1, "score": 0, "last_activity_date": 1538625061, "creation_date": 1538579883, "question_id": 52630394, "link": "https://stackoverflow.com/questions/52630394/rails-docker-finding-the-rails-root-path-in-development", "title": "Rails - Docker - finding the Rails root path in development", "body": "<p>I'm working on a project that runs in docker containers, and our assets are not displaying locally. They're saving to the DB as they should, with the issue being the assets_path being created.</p>\n\n<p>When I run the application locally (not in a container) and call Rails.root, I receive the full path (/home/projects/bla...)</p>\n\n<p>When I call Rails.root in the docker container, I receive just '/bla'.</p>\n\n<p>Is there any way of getting docker to figure out what the 'real' Rails root is? </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq", "worker", "sidekiq-monitor"], "comments": [{"owner": {"reputation": 19, "user_id": 10365284, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BrGiuKCt_Sc/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMjF__kX01JdIgesLrpf3cjXO_vwg/mo/photo.jpg?sz=128", "display_name": "Rob", "link": "https://stackoverflow.com/users/10365284/rob"}, "edited": false, "score": 0, "creation_date": 1539695999, "post_id": 52629840, "comment_id": 92588940, "body": "I fixed it. It seems working just fine now."}], "owner": {"reputation": 19, "user_id": 10365284, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BrGiuKCt_Sc/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMjF__kX01JdIgesLrpf3cjXO_vwg/mo/photo.jpg?sz=128", "display_name": "Rob", "link": "https://stackoverflow.com/users/10365284/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538578309, "creation_date": 1538578309, "question_id": 52629840, "link": "https://stackoverflow.com/questions/52629840/sidekiq-workers-get-stuck-after-a-while-running", "title": "sidekiq workers get stuck after a while running", "body": "<p>I have been testing some code lately and I found myself in a weird situation. Let me try to explain a bit.\nI have multiple pieces of code (more than 500) that do the following:\n- Parse a string\n- Parse a JSON\n- Parse an array\n- Run HTTP/HTTPS requests via Faraday</p>\n\n<p>Basically they all work together in background to extract and parse data.</p>\n\n<p>I have a 30/40 sidekiq workers that are working perfectly. At some point, randomly (but typically after 1 day) the workers get stuck. They normally take 1 second to 1 minute, at some point, HTTP/HTTPS workers get stuck and takes forever and the system gets slower and slower.</p>\n\n<p>I have read from different places like:\n- <a href=\"https://github.com/mperham/sidekiq/issues/862\" rel=\"nofollow noreferrer\">https://github.com/mperham/sidekiq/issues/862</a> (HenleyChiu commented on Oct 5, 2013 - and few others)\n- <a href=\"https://github.com/mpowered/sidekiq-nag\" rel=\"nofollow noreferrer\">https://github.com/mpowered/sidekiq-nag</a></p>\n\n<p>That sometimes Sidekiq workers get stuck and people are writing codes (or hacks) to restart Sidekiq if this happens. Did you guys find the same problem with Sidekiq especially if the background job is related to HTTP/HTTPS request?</p>\n\n<p>So my questions are:</p>\n\n<ul>\n<li>Anyone found him/herself in a similar situation? What did you do?</li>\n<li>Is there a way in the background job to ensure that all the HTTP/HTTPS connections gets dropped? Like for example I can ensure to close all MYSQL connections with the following code (at the end).</li>\n<li>Is it actually HTTP/HTTPS that might create issues in Sidekiq? Is there a way to kill pending HTTP/HTTPS connections? Not sure as using Timeout in Ruby is not ideal...</li>\n</ul>\n\n<p>Anyone has some example of code that want to share or some ideas on how to fix it?</p>\n\n<pre><code>ensure\n        ActiveRecord::Base.clear_active_connections!\n        ActiveRecord::Base.connection.close\n</code></pre>\n\n<p>Thank you very much and I look forward to hearing from you.</p>\n"}, {"tags": ["ruby", "modulo"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1538578324, "post_id": 52629714, "comment_id": 92193079, "body": "Don&#39;t use PascalCase for method names. Should be snake_case: <code>even_or_odd</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538588059, "post_id": 52629714, "comment_id": 92198611, "body": "Get in the habit of writing <code>number.even?</code> and <code>number.odd?</code>. When compared to using modulo it reads better and is less prone to error. Those are the methods <a href=\"http://ruby-doc.org/core-2.5.1/Integer.html#method-i-even-3F\" rel=\"nofollow noreferrer\">Integer#even?</a> and <a href=\"http://ruby-doc.org/core-2.5.1/Integer.html#method-i-odd-3F\" rel=\"nofollow noreferrer\">Integer#odd?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1538578206, "post_id": 52629797, "comment_id": 92193001, "body": "And as added bonus: <code>.even?</code> crashes on strings :)"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 3, "creation_date": 1538578389, "post_id": 52629797, "comment_id": 92193137, "body": "<code>Integer(gets)</code> would be more suitable as you can wrap it in a <code>begin..rescue</code> and not decide that <code>&quot;asd&quot;</code> is even :)"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 2, "creation_date": 1538578474, "post_id": 52629797, "comment_id": 92193200, "body": "@MarcinKo\u0142odziej You&#39;re certainly correct, but I get the impression this is a case of recommending &quot;small steps.&quot;"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1538579441, "post_id": 52629797, "comment_id": 92193883, "body": "@pjs I understand, just wanted to mention that as I find <code>String#to_i</code> quite surprising for the unaware."}], "tags": [], "owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "is_accepted": true, "score": 3, "last_activity_date": 1538585240, "last_edit_date": 1538585240, "creation_date": 1538578174, "answer_id": 52629797, "question_id": 52629714, "link": "https://stackoverflow.com/questions/52629714/even-or-odd-program-using-modulo/52629797#52629797", "title": "Even or odd program using modulo", "body": "<p>Remember that <code>gets</code> returns a <code>String</code>.  You'll want to convert it to an <code>Integer</code>, for instance with <code>number = gets.to_i</code>.</p>\n\n<p>While you're at it you should consider using <code>number.even?</code>, it's builtin and works like a charm.</p>\n"}], "owner": {"reputation": 33, "user_id": 7158858, "user_type": "registered", "profile_image": "https://graph.facebook.com/1116230031826331/picture?type=large", "display_name": "Archie Payne", "link": "https://stackoverflow.com/users/7158858/archie-payne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 52629797, "answer_count": 1, "score": 0, "last_activity_date": 1538628127, "creation_date": 1538577917, "last_edit_date": 1538628127, "question_id": 52629714, "link": "https://stackoverflow.com/questions/52629714/even-or-odd-program-using-modulo", "title": "Even or odd program using modulo", "body": "<p>I have a program:</p>\n\n<pre><code>def EvenOrOdd(number)\n  if (number%2 == 0) then\n    puts number + \"is even\"\n  else \n    puts number + \"is odd\"\n  end\nend\nputs \"Please input a number: \"\nnumber = gets\nEvenOrOdd(number)\n</code></pre>\n\n<p>When I input a number, it comes back that it is odd. I get an error, and I cannot find where my error is or what is wrong with my code.</p>\n\n<p>Hopefully, you can help me.</p>\n"}, {"tags": ["ruby", "watir"], "answers": [{"tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 1, "last_activity_date": 1538578805, "creation_date": 1538578805, "answer_id": 52630031, "question_id": 52629390, "link": "https://stackoverflow.com/questions/52629390/why-doesnt-watir-find-script-tag-by-src-attribute/52630031#52630031", "title": "Why doesn&#39;t Watir find script tag by src attribute", "body": "<p>It's because the link you are trying doesn't have <code>https:</code>, The element you are trying to locate is this,</p>\n\n<pre><code>&lt;script type=\"text/javascript\" async=\"\" src=\"//mathid.mathtag.com/d/i.js\"/&gt;\n</code></pre>\n\n<p>So write this code, it would work.</p>\n\n<pre><code>p b.script(src: \"//mathid.mathtag.com/d/i.js\").html\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1061, "user_id": 1651458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DQZz9.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1651458/sam"}, "edited": false, "score": 0, "creation_date": 1538582264, "post_id": 52630435, "comment_id": 92195624, "body": "So, for this case, the way to reliably identify such a tag might be: <code>b.script(src: &#47;\\:\\&#47;\\&#47;mathid\\.mathtag\\.com\\&#47;d\\&#47;i\\.js&#47;i).html # =&gt; &quot;&lt;script type=\\&quot;text&#47;javascript\\&quot; async=\\&quot;\\&quot; src=\\&quot;&#47;&#47;mathid.mathtag.com&#47;d&#47;i.js\\&quot;&gt;&lt;&#47;script&gt;&quot;</code>"}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "reply_to_user": {"reputation": 1061, "user_id": 1651458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DQZz9.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1651458/sam"}, "edited": false, "score": 1, "creation_date": 1538675885, "post_id": 52630435, "comment_id": 92237220, "body": "@Sam it depends on what you are trying to do. I highly discourage using Regexp unless you have to, and if you do have to use Regexp it is recommended to &quot;keep it simple&quot; so long as that works for you (e.g. <code>&#47;mathtag&#47;</code>). We&#39;ll be updating Watir soon to allow simple regexp like that to only make one wire call instead of multiple."}], "tags": [], "owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "is_accepted": true, "score": 2, "last_activity_date": 1538579990, "creation_date": 1538579990, "answer_id": 52630435, "question_id": 52629390, "link": "https://stackoverflow.com/questions/52629390/why-doesnt-watir-find-script-tag-by-src-attribute/52630435#52630435", "title": "Why doesn&#39;t Watir find script tag by src attribute", "body": "<p>Watir is locating the element based on string matching what is present in the DOM. If you investigate the DOM, you'll see that the <code>https:</code> is not present, just the <code>//mathid.mathtag.com/d/i.js</code>. The browser driver translates that when queried about the attribute value to include the <code>https</code>, but Watir has no way to assume that when locating.</p>\n\n<p>This will work:</p>\n\n<pre><code>browser.script(src: '//mathid.mathtag.com/d/i.js')\n</code></pre>\n"}], "owner": {"reputation": 1061, "user_id": 1651458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DQZz9.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1651458/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 52630435, "answer_count": 2, "score": 0, "last_activity_date": 1538579990, "creation_date": 1538576988, "question_id": 52629390, "link": "https://stackoverflow.com/questions/52629390/why-doesnt-watir-find-script-tag-by-src-attribute", "title": "Why doesn&#39;t Watir find script tag by src attribute", "body": "<p>Navigating to any page, I can review the scripts present with Watir:</p>\n\n<pre><code>b = Watir::Browser.new\nb.goto \"https://macys.com\"\nb.scripts.collect(&amp;:src)\n# =&gt; [ ..., \"https://mathid.mathtag.com/d/i.js\", ...]\n</code></pre>\n\n<p>The result is a large array of scripts, I've chosen one at random to find:</p>\n\n<pre><code>b.script(src: \"https://mathid.mathtag.com/d/i.js\").html\n# =&gt; Watir::Exception::UnknownObjectException: timed out after 30 seconds, waiting for #&lt;Watir::HTMLElement: located: false; {:xpath=&gt;\"//script[@src='https://mathid.mathtag.com/d/i.js']\"}&gt; to be located; Maybe look in an iframe?\n# ...\n</code></pre>\n\n<p>But it never finds any script this way. Why? How can I detect the presence without investigating the <code>scripts.collect(&amp;:src)</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 857, "user_id": 1445968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f9fbdbd08e711a0a8a57685cacf70e1?s=128&d=identicon&r=PG", "display_name": "Nas", "link": "https://stackoverflow.com/users/1445968/nas"}, "edited": false, "score": 0, "creation_date": 1538577089, "post_id": 52629190, "comment_id": 92192204, "body": "Excellent. Exactly what I was looking for. Thank you so much! How could I miss this :)"}, {"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "reply_to_user": {"reputation": 857, "user_id": 1445968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f9fbdbd08e711a0a8a57685cacf70e1?s=128&d=identicon&r=PG", "display_name": "Nas", "link": "https://stackoverflow.com/users/1445968/nas"}, "edited": false, "score": 0, "creation_date": 1538577190, "post_id": 52629190, "comment_id": 92192268, "body": "Haha, happens to the best of us."}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": true, "score": 1, "last_activity_date": 1538576405, "creation_date": 1538576405, "answer_id": 52629190, "question_id": 52628803, "link": "https://stackoverflow.com/questions/52628803/add-a-generic-not-bound-to-a-key-nor-field-error-message-to-rails-formobject/52629190#52629190", "title": "Add a generic (not bound to a key nor field) error message to rails FormObject", "body": "<p>Per the Rails docs here: <a href=\"https://guides.rubyonrails.org/active_record_validations.html#errors-base\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_record_validations.html#errors-base</a></p>\n\n<blockquote>\n  <p>You can add error messages that are related to the object's state as a\n  whole, instead of being related to a specific attribute. You can use\n  this method when you want to say that the object is invalid, no matter\n  the values of its attributes. Since errors[:base] is an array, you can\n  simply add a string to it and it will be used as an error message.</p>\n</blockquote>\n\n<p>So in your case your validator becomes:</p>\n\n<pre><code>def my_custom_validation\n  errors[:base] &lt;&lt; \"Your error message here.\"\nend\n</code></pre>\n"}], "owner": {"reputation": 857, "user_id": 1445968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f9fbdbd08e711a0a8a57685cacf70e1?s=128&d=identicon&r=PG", "display_name": "Nas", "link": "https://stackoverflow.com/users/1445968/nas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 52629190, "answer_count": 1, "score": 1, "last_activity_date": 1538576723, "creation_date": 1538575333, "last_edit_date": 1538576723, "question_id": 52628803, "link": "https://stackoverflow.com/questions/52628803/add-a-generic-not-bound-to-a-key-nor-field-error-message-to-rails-formobject", "title": "Add a generic (not bound to a key nor field) error message to rails FormObject", "body": "<p>I have the following ruby class:</p>\n\n<pre><code>class MyFormObject &lt; FormObject\n  attribute :some_field\n\n  validates :some_field, presence: true\n  validate :my_custom_validation\n\n  def my_custom_validation\n    errors.add \"Do_not_have_key\",\"This error message is self contained, not linked to any field and no field prefix required\"\n  end\nend\n</code></pre>\n\n<p>I would like to perform my custom validation logic. Add errors to the error collection, but <strong>some</strong> of them are not bound to any key or field. Let's say they depend on the position of the moon at the moment the validation is performed :)</p>\n\n<p>Also I would like when someone else is using my class and calls:</p>\n\n<pre><code>errors.full_messages\n</code></pre>\n\n<p>To get the default behaviour of appending key of the error in front of all the errors, expect the \"generic\"/ \"not bound to a field\" ones.</p>\n\n<p>Is there elegant way to achieve such behaviour? And close the solution/workaround whatever in this class and all of the consumers are unaware that there are \"special\" errors?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "is_accepted": true, "score": 2, "last_activity_date": 1538576166, "creation_date": 1538576166, "answer_id": 52629097, "question_id": 52628737, "link": "https://stackoverflow.com/questions/52628737/how-to-upgrade-ruby-version-from-2-3-1-to-2-5-1-in-ubuntu/52629097#52629097", "title": "how to upgrade ruby version from 2.3.1 to 2.5.1 in ubuntu", "body": "<p>It seems a problem with rvm, first do this in a shell:</p>\n\n<pre><code>  rvm get stable --auto-dotfiles\n</code></pre>\n\n<p>Then be sure that your .bashrc, or .zshrc, depending on what shell you use contains this at the last line</p>\n\n<pre><code># Add RVM to PATH for scripting. Make sure this is the last PATH variable change.\nexport PATH=\"$PATH:$HOME/.rvm/bin\"\n</code></pre>\n\n<p>and restart your shell, it should work, if not try also addding this line to your .XXprofile file or .xxrc file</p>\n\n<pre><code>[[ -s \"$HOME/.rvm/scripts/rvm\" ]] &amp;&amp; source \"$HOME/.rvm/scripts/rvm\" # Load RVM into a shell session *as a function*\n</code></pre>\n\n<p>finally it should work, if not, try to reinstall rvm again as single user</p>\n"}], "owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1586, "favorite_count": 0, "accepted_answer_id": 52629097, "answer_count": 1, "score": 0, "last_activity_date": 1538576166, "creation_date": 1538575128, "question_id": 52628737, "link": "https://stackoverflow.com/questions/52628737/how-to-upgrade-ruby-version-from-2-3-1-to-2-5-1-in-ubuntu", "title": "how to upgrade ruby version from 2.3.1 to 2.5.1 in ubuntu", "body": "<p>I've installed Ruby 2.3.1p112 from the default Ubuntu repository.</p>\n\n<p>No I'm trying to install the Ruby version 2.5.1 and here is what I did:</p>\n\n<pre><code>$ rvm install \"ruby-2.5.1\"\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>$ rvm use 2.5.1 --default\n</code></pre>\n\n<p>And then it complains:</p>\n\n<blockquote>\n  <p>Required ruby-2.3.1 is not installed.\n  To install do: 'rvm install \"ruby-2.3.1\"'</p>\n  \n  <p>RVM is not a function, selecting rubies with 'rvm use ...' will not work.</p>\n  \n  <p>You need to change your terminal emulator preferences to allow login shell.\n  Sometimes it is required to use <code>/bin/bash --login</code> as the command.\n  Please visit <a href=\"https://rvm.io/integration/gnome-terminal/\" rel=\"nofollow noreferrer\">https://rvm.io/integration/gnome-terminal/</a> for an example.</p>\n</blockquote>\n\n<p>I did as recommended, but unsuccessfully, every time I ask <code>$ ruby -v</code> it keeps telling me 2.3.1p112, then if I try to reinstall 2.5.1 it tells me that it is already installed.</p>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "watir"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "edited": false, "score": 1, "creation_date": 1538591487, "post_id": 52630824, "comment_id": 92200306, "body": "No,it doesn`t work. Element &lt;span class=&quot;visuallyhidden&quot;&gt;...&lt;/span&gt; is not clickable at point (593, 588)."}, {"owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "edited": false, "score": 0, "creation_date": 1538591699, "post_id": 52630824, "comment_id": 92200404, "body": "I can click on button by code: browser.button(:text =&gt; &quot;Next Page&quot;).click.Question was about not stopping of searching at last page.It search when all reviews are scraped and then I have error."}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1538581078, "creation_date": 1538581078, "answer_id": 52630824, "question_id": 52628642, "link": "https://stackoverflow.com/questions/52628642/how-to-finish-searching-for-elements-at-watir/52630824#52630824", "title": "How to finish searching for elements at watir?", "body": "<p>Actually the 'Next Page' text is not in the button, it's in the span, So write the code</p>\n\n<pre><code>while b.span(:text =&gt; \"Next Page\").present?\n  b.elements(css: '.review-body-text').each do |comment|\n    p comment\n  end\n  b.span(text: \"Next Page\").click\nend\n</code></pre>\n\n<p>It would work for you.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 4603202, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0031dd8033af4c21a5997b8252a98d53?s=128&d=identicon&r=PG&f=1", "display_name": "albatross", "link": "https://stackoverflow.com/users/4603202/albatross"}, "is_accepted": false, "score": 0, "last_activity_date": 1538604651, "creation_date": 1538604651, "answer_id": 52636383, "question_id": 52628642, "link": "https://stackoverflow.com/questions/52628642/how-to-finish-searching-for-elements-at-watir/52636383#52636383", "title": "How to finish searching for elements at watir?", "body": "<pre><code>def get_all_reviews\n  loop do\n    # Call method to get reviews on page     \n    break unless b.span(:text =&gt; \"Next Page\").present?\n    b.span(text: \"Next Page\").click\n  end\nend\n</code></pre>\n\n<p>I think that Rubys loop do break is a better fit for this kind of operation.</p>\n\n<p>I would also suggest that you assign variables to these elements to make the code easier to read like this:</p>\n\n<pre><code>def get_all_reviews\n  loop do\n    # Call method to get reviews on page     \n    break unless next_page.present?\n    next_page.click\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 0, "last_activity_date": 1538622478, "creation_date": 1538622478, "answer_id": 52638394, "question_id": 52628642, "link": "https://stackoverflow.com/questions/52628642/how-to-finish-searching-for-elements-at-watir/52638394#52638394", "title": "How to finish searching for elements at watir?", "body": "<p>Loading the next page of reviews is done asynchronously. This can result in attempting to read the reviews while they are in the process of being changed. After clicking the paging button, you need to wait for the list of reviews to finish loading.</p>\n\n<p>There are likely a number of ways to detect this. The following example waits for the paging control to be updated to the new page number.</p>\n\n<pre><code>paginator_list = browser.ul(class: 'paginator-list')\nlast_page = paginator_list.button(aria_label: true, index: -1).text.to_i\n1.upto(last_page) do |i|\n  browser.divs(class: 'review-body-text').each do |comment|\n    review= Review.new\n    review.text=comment.text\n    product.reviews&lt;&lt;review\n    review.save\n  end\n\n  unless i == last_page\n    browser.button(text: 'Next Page').click\n    browser.wait_until do\n      current = paginator_list.button(class: 'active').text.to_i\n      current == i + 1\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 52638394, "answer_count": 3, "score": 1, "last_activity_date": 1538622478, "creation_date": 1538574834, "last_edit_date": 1538584847, "question_id": 52628642, "link": "https://stackoverflow.com/questions/52628642/how-to-finish-searching-for-elements-at-watir", "title": "How to finish searching for elements at watir?", "body": "<p>I should save all reviews from page <a href=\"https://www.walmart.com/ip/Ematic-9-Dual-Screen-Portable-DVD-Player-with-Dual-DVD-Players-ED929D/28806789\" rel=\"nofollow noreferrer\">https://www.walmart.com/ip/Ematic-9-Dual-Screen-Portable-DVD-Player-with-Dual-DVD-Players-ED929D/28806789</a>. For it I use Watir because it is dynamic page and I need to click button to update results. I check if button present and then scrape reviews.But when all reviews saved on last page, it don`t finish process and search for elements and after 30 seconds I have error.</p>\n\n<p>Error:</p>\n\n<pre><code>Watir::Exception::UnknownObjectException (timed out after 30 seconds, waiting for #&lt;Watir::Div: located: false; {:css=&gt;\".review-body-text\", :index=&gt;10, :tag_name=&gt;:div}&gt; to be located; Maybe look in an iframe?):\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>while  browser.element(:text =&gt; \"Next Page\").present?\n      browser.elements(css:'.review-body-text').each do |comment|\n        review= Review.new\n        review.text=comment.text\n        product.reviews&lt;&lt;review\n        review.save\n      end\n        browser.button(:text =&gt; \"Next Page\").click\n    end while  browser.element(:text =&gt; \"Next Page\").present?\n    browser.close\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "methods", "parameters", "arguments"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1538628467, "post_id": 52628513, "comment_id": 92210891, "body": "Please use English punctuation, not the French one, when you write in English. Please be consistent with spacing within the code."}], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1538575076, "creation_date": 1538575076, "answer_id": 52628716, "question_id": 52628513, "link": "https://stackoverflow.com/questions/52628513/optional-method-arguments/52628716#52628716", "title": "Optional method arguments", "body": "<p>It looks like you have some typos (<code>filname</code> instead of <code>filename</code>) and syntax errors (e.g., <code>if..end..else..end</code>) in the proposed code. How about something more like:</p>\n\n<pre><code>def generate_file(filename, version=nil, report=nil) \n  draw\n  report_version = report &amp;&amp; version\n  path = report_version ? \"tmp/pdf/reports/#{report.reference}\" : \"temp/pdf\"\n  FileUtils.mkdir_p( path )\n  @pdf.render_file \"#{ Rails.root }/#{path}/#{ report_version ? version : filename }\"\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1538628428, "creation_date": 1538574401, "last_edit_date": 1538628428, "question_id": 52628513, "link": "https://stackoverflow.com/questions/52628513/optional-method-arguments", "title": "Optional method arguments", "body": "<p>I have two methods that do almost the same thing, but but with a little difference in passing parameters:</p>\n\n<pre><code>def generate_file(filename)\n  draw\n  FileUtils.mkdir_p 'tmp/pdf'\n  @pdf.render_file \"#{Rails.root}/tmp/pdf/#{filename}\"\nend\n\ndef generate_pdf(report, version)\n  draw\n  path = \"tmp/pdf/reports/#{report.reference}\"\n  FileUtils.mkdir_p(path)\n  @pdf.render_file \"#{Rails.root}/#{path}/#{version}\"\nend\n</code></pre>\n\n<p>I want to refactor it, and use just the <code>generate_file</code> method when I call a function that generates pdf files. Should I pass an optional <code>params</code> (<code>version = nil</code>) and test if it's defined or not?</p>\n\n<p>Like this:</p>\n\n<pre><code>def generate_file(filname, version = nil, report = nil) \n  draw\n  if report &amp;&amp; version\n    path = \"tmp/pdf/reports/#{report.reference}\"\n    FileUtils.mkdir_p(path)\n    @pdf.render_file \"#{Rails.root}/#{path}/#{version}\"\n  else\n    FileUtils.mkdir_p 'tmp/pdf'\n    @pdf.render_file \"#{Rails.root}/tmp/pdf/#{filename}\"\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1538574305, "post_id": 52628430, "comment_id": 92190431, "body": "Try <code>@my_method[parameter] ||= Table...</code>. And call <code>.to_a</code> on that query, to materialize the resultset. Otherwise you&#39;re memoizing only the query selectors."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 2, "creation_date": 1538574483, "post_id": 52628430, "comment_id": 92190561, "body": "As above, your memoization always ends on an empty hash currently. Apart from that, you might want to rethink how you&#39;re preparing the data. It would be much wiser to prepare all the <code>parameter</code>s you might need beforehand and then query for them once."}, {"owner": {"reputation": 89, "user_id": 5790261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/225b212bb482ad5456e4fa6a1a43593a?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/5790261/steve"}, "edited": false, "score": 0, "creation_date": 1538576075, "post_id": 52628430, "comment_id": 92191533, "body": "Thanks for the comments. I think normally these would work. Another issue is that the resultset goes through a decorator, which adds <code>.group</code> to the results, and I get <code>(undefined method &#39;group&#39; for []:Array Did you mean? group_by)</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1538577031, "post_id": 52628430, "comment_id": 92192164, "body": "&quot;which adds <code>.group</code> to the results&quot; - Well yeah, if you fetch and cache records, you can no longer do that.  You could sort arrays in memory with sort_by, as suggested."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1538577648, "post_id": 52628430, "comment_id": 92192591, "body": "group with group_by, that is."}, {"owner": {"reputation": 89, "user_id": 5790261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/225b212bb482ad5456e4fa6a1a43593a?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/5790261/steve"}, "edited": false, "score": 0, "creation_date": 1538578698, "post_id": 52628430, "comment_id": 92193353, "body": "These are all great suggestions, so I&#39;ve upvoted for each one. I&#39;ve ended up memoizing a downstream method that only includes the <code>sum</code> of the resultset, and it&#39;s working fine, as there are too many other methods using the main query and changing one thing breaks too many others. Thanks for all the help, I can see using these in other scenarios."}], "owner": {"reputation": 89, "user_id": 5790261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/225b212bb482ad5456e4fa6a1a43593a?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/5790261/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538574146, "creation_date": 1538574146, "question_id": 52628430, "link": "https://stackoverflow.com/questions/52628430/ruby-memoization-on-activerecord-with-parameter", "title": "Ruby memoization on ActiveRecord with parameter", "body": "<p>I am trying to memoize an <code>ActiveRecord</code> resultset but can't get it to work properly when passed a parameter. For example:</p>\n\n<pre><code>def my_method(parameter)\n  @my_method ||= {}\n\n  return @my_method[parameter] if @my_method[parameter]\n\n  @my_method ||= Table.where(field: parameter).order(:sort_by_field)\nend\n</code></pre>\n\n<p>I get an error that <code>order</code> isn't available on a <code>Hash</code>, or a variation of that error, depending on how I tweak the query, e.g., adding <code>.includes</code>, etc. If I simply memoize the resultset, it will always return whatever the first method call returned, regardless of the changing <code>parameter</code>. Does anyone know how to accomplish this? Apologies if this is a duplicate - I saw multiple questions re: memoization but none that seem to cover <code>ActiveRecord</code> parameters. Thanks in advance.</p>\n"}, {"tags": ["ruby", "string", "memory", "compression", "bit-manipulation"], "comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1538574167, "post_id": 52628375, "comment_id": 92190326, "body": "Does it have to be base 36? Base 64, 85, or &quot;raw bytes&quot; are of course all higher density"}, {"owner": {"reputation": 144, "user_id": 2180878, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a7df369413e81391828d2f74de0b99e?s=128&d=identicon&r=PG", "display_name": "Jon Wexler", "link": "https://stackoverflow.com/users/2180878/jon-wexler"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1538575678, "post_id": 52628375, "comment_id": 92191306, "body": "It doesn&#39;t have to be base 36, that&#39;s just the current solution I&#39;m at."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1538585162, "post_id": 52628375, "comment_id": 92197140, "body": "@Harold, note that <code>n &lt;= 36</code> in <code>to_s(n)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 144, "user_id": 2180878, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a7df369413e81391828d2f74de0b99e?s=128&d=identicon&r=PG", "display_name": "Jon Wexler", "link": "https://stackoverflow.com/users/2180878/jon-wexler"}, "edited": false, "score": 0, "creation_date": 1538587643, "post_id": 52629427, "comment_id": 92198411, "body": "Thanks, this solution is interesting. Assuming my <code>n</code> represents the largest number I can store as a string prior to encoding, this method increases my binary slots from 1318 to around 2035. That&#39;s definitely an improvement. In other words, <code>encode((0 | (1&lt;&lt;2035)), extended_alphabet).length</code> gives me 255. What would the decode method look like? Is there a way to get this number up by a lot more?"}, {"owner": {"reputation": 494, "user_id": 5115471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BwTkL.jpg?s=128&g=1", "display_name": "Robindar", "link": "https://stackoverflow.com/users/5115471/robindar"}, "reply_to_user": {"reputation": 144, "user_id": 2180878, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a7df369413e81391828d2f74de0b99e?s=128&d=identicon&r=PG", "display_name": "Jon Wexler", "link": "https://stackoverflow.com/users/2180878/jon-wexler"}, "edited": false, "score": 0, "creation_date": 1538651732, "post_id": 52629427, "comment_id": 92222672, "body": "I added the decoding function. Note that I also reversed the encoding to make the decoding simpler. You can encode numbers from 0 to ((1 &lt;&lt; 2040) - 1) included with this method. It is impossible to encode more numbers into 255 characters for the mathematical reason quoted above, so this is as high as you can get, but if you allow more than 255 chars, the encoding will still work and you will have more possibilities"}, {"owner": {"reputation": 494, "user_id": 5115471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BwTkL.jpg?s=128&g=1", "display_name": "Robindar", "link": "https://stackoverflow.com/users/5115471/robindar"}, "reply_to_user": {"reputation": 144, "user_id": 2180878, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a7df369413e81391828d2f74de0b99e?s=128&d=identicon&r=PG", "display_name": "Jon Wexler", "link": "https://stackoverflow.com/users/2180878/jon-wexler"}, "edited": false, "score": 0, "creation_date": 1538651852, "post_id": 52629427, "comment_id": 92222729, "body": "Also, ( 0 | ( 1 &lt;&lt; 2035) ) is the same as ( 1 &lt;&lt; 2035 ), so there is no need to add this &quot;zero or&quot; prefix. It is also equivalent to ( 2 ** 2035 ), which might be easier to read"}], "tags": [], "owner": {"reputation": 494, "user_id": 5115471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BwTkL.jpg?s=128&g=1", "display_name": "Robindar", "link": "https://stackoverflow.com/users/5115471/robindar"}, "is_accepted": false, "score": 1, "last_activity_date": 1538651542, "last_edit_date": 1538651542, "creation_date": 1538577099, "answer_id": 52629427, "question_id": 52628375, "link": "https://stackoverflow.com/questions/52628375/compress-a-number-as-a-string-to-fit-in-256-char-space/52629427#52629427", "title": "Compress a number as a string to fit in 256 char space", "body": "<p>You can always encode your number into base <code>s</code> and then represent that as string with whatever alphabet you want.</p>\n\n<pre><code>def encode(n, alphabet)\n  s = alphabet.size\n  res = []\n  while (n &gt; 0)\n    res &lt;&lt; n % s\n    n = n / s\n  end\n  res.reverse.map { |i| alphabet[i] }.join\nend\n</code></pre>\n\n<p>Your method is then equivalent to <code>encode(n, alphabet)</code>, where <code>alphabet</code> is defined as</p>\n\n<pre><code>alphabet = ((0..9).to_a + (\"a\"..\"z\").to_a).join\n# =&gt; \"0123456789abcdefghijklmnopqrstuvwxyz\"\n</code></pre>\n\n<p>But you might as well use all possible characters instead of only 36 of them:</p>\n\n<pre><code>extended_alphabet = (0..255).map { |i| i.chr }.join\n</code></pre>\n\n<p>This gives a total of (256 ** 255) possibilities, i.e. up to (2 ** 2040), which is much better than your actual (2 ** 1318).</p>\n\n<p>This encoding happens to be optimal because each character of your string can have at most 256 different values, and all of them are used here.</p>\n\n<hr>\n\n<p>Decoding can then be performed as follows:</p>\n\n<pre><code>def decode(encoded, alphabet)\n  s = alphabet.size\n  n = 0\n  decode_dict = {}; i = -1\n  alphabet.each_char { |c| decode_dict[c] = (i += 1) }\n  encoded.each_char do |c|\n    n = n * s + decode_dict[c]\n  end\n  n\nend\n</code></pre>\n\n<p>If you are going to use a fixed alphabet for all your encodings, I would suggest computing the decoding dictionnary outside of the function and taking it as a parameter instead of <code>alphabet</code>, to  avoid computing it every time you try to encode a number.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1539062807, "last_edit_date": 1539062807, "creation_date": 1539060746, "answer_id": 52713584, "question_id": 52628375, "link": "https://stackoverflow.com/questions/52628375/compress-a-number-as-a-string-to-fit-in-256-char-space/52713584#52713584", "title": "Compress a number as a string to fit in 256 char space", "body": "<p><strong>Numbers are non-negative</strong></p>\n\n<p>If the numbers are non-negative we can encode each 8-bits of each number to a character that is part of a string, and then decode the string by converting each character to 8 bits of the number.</p>\n\n<pre><code>def encode(n)\n  str = ''\n  until n.zero?\n    str &lt;&lt; (n &amp; 255).chr\n    n = n &gt;&gt; 8\n  end\n  str.reverse\nend\n\ndef decode(str)     \n  str.each_char.reduce(0) { |n,c| (n &lt;&lt; 8) | c.ord }\nend\n</code></pre>\n\n<p>This uses the following bit-manipulation methods in the class <a href=\"http://ruby-doc.org/core-2.5.1/Integer.html\" rel=\"nofollow noreferrer\">Integer</a>: <code>&amp;</code>, <code>&gt;&gt;</code>, <code>&lt;&lt;</code> and <code>|</code>.</p>\n\n<pre><code>def test(n)\n  encoded = encode(n)\n  puts \"#{n} =&gt; #{encoded} =&gt; #{decode(encoded)}\"\nend\n\ntest      1  #      1 =&gt; [\"\\u0001\"]            =&gt;      1\ntest     63  #     63 =&gt; [\"?\"]                 =&gt;     63\ntest     64  #     64 =&gt; [\"@\"]                 =&gt;     64\ntest    255  #    255 =&gt; [\"\\xFF\"]              =&gt;    255\ntest    256  #    256 =&gt; [\"\\u0001\", \"\\u0000\"]  =&gt;    256\ntest 123456  # 123456 =&gt; [\"\\x01\", \"\\xE2\", \"@\"] =&gt; 123456\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>n = 123456\nn.to_s(2)\n  #=&gt; \"11110001001000000\"\n</code></pre>\n\n<p>so</p>\n\n<pre><code>n = 0b11110001001000000\n  #=&gt; 123456\n</code></pre>\n\n<p>The bytes of this number can be visualized so:</p>\n\n<pre><code>00000001 11100010 01000000\n</code></pre>\n\n<p>We see that</p>\n\n<pre><code>a = [0b00000001, 0b11100010, 0b01000000]\na.map(&amp;:chr)\n  #=&gt; [\"\\x01\", \"\\xE2\", \"@\"]\n</code></pre>\n\n<p><strong>Numbers can be negative</strong></p>\n\n<p>If the numbers to be encoded can be negative we need to first convert then to their absolute values then add some information to the encoded string that indicates whether they are non-negative or negative. That will require at least one additional byte so we might include a <code>\"+\"</code> for non-negative numbers and a <code>\"-\"</code> for negative numbers.</p>\n\n<pre><code>def encode(n)\n  sign = \"+\"\n  if n &lt; 0\n    sign = \"-\"\n    n = -n\n  end\n  str = ''\n  until n.zero?\n    str &lt;&lt; (n &amp; 255).chr\n    n = n &gt;&gt; 8\n  end\n  (str &lt;&lt; sign).reverse\nend\n\ndef decode(str)\n  n = str[1..-1].each_char.reduce(0) { |n,c| (n &lt;&lt; 8) | c.ord }\n  str[0] == '+' ? n : -n\nend\n\ntest    -255  # -255    =&gt; [\"-\", \"\\xFF\"]              =&gt; -255\ntest    -256  # -256    =&gt; [\"-\", \"\\u0001\", \"\\u0000\"]  =&gt; -256\ntest -123456  # -123456 =&gt; [\"-\", \"\\x01\", \"\\xE2\", \"@\"] =&gt; -123456\ntest  123456  #  123456 =&gt; [\"+\", \"\\x01\", \"\\xE2\", \"@\"] =&gt;  123456\n</code></pre>\n"}], "owner": {"reputation": 144, "user_id": 2180878, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a7df369413e81391828d2f74de0b99e?s=128&d=identicon&r=PG", "display_name": "Jon Wexler", "link": "https://stackoverflow.com/users/2180878/jon-wexler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1539062807, "creation_date": 1538573990, "question_id": 52628375, "link": "https://stackoverflow.com/questions/52628375/compress-a-number-as-a-string-to-fit-in-256-char-space", "title": "Compress a number as a string to fit in 256 char space", "body": "<p>I'm trying to use a bitmask to provide as many binary values as possible so that the final value will store in the limited allocate memory for a string. My current methodology is to find a maximum number and convert it to a string base-36.</p>\n\n<pre><code>value = (0 | (1&lt;&lt;1318)).to_s(36)\n</code></pre>\n\n<p>The result is 255 chars of a compressed number from which I can extract my original number of 1318. The downside is I'm limited to 1,318 binary values and I want to expand that number. Are there any alternative strategies in Ruby to compress this number even further?</p>\n"}, {"tags": ["ruby", "cocoapods"], "comments": [{"owner": {"reputation": 8460, "user_id": 494642, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Z7WbB.jpg?s=128&g=1", "display_name": "Hari Honor", "link": "https://stackoverflow.com/users/494642/hari-honor"}, "edited": false, "score": 1, "creation_date": 1613039336, "post_id": 52628354, "comment_id": 116955001, "body": "Might you share the magic in <code>inject_shell_script_build_phase</code>??"}], "answers": [{"comments": [{"owner": {"reputation": 17769, "user_id": 410867, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7c3876979ec8539d49987d1556b6fdd4?s=128&d=identicon&r=PG", "display_name": "Cameron Lowell Palmer", "link": "https://stackoverflow.com/users/410867/cameron-lowell-palmer"}, "edited": false, "score": 2, "creation_date": 1538802559, "post_id": 52671689, "comment_id": 92281081, "body": "This only gives you Pods targets not the main project."}, {"owner": {"reputation": 17769, "user_id": 410867, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7c3876979ec8539d49987d1556b6fdd4?s=128&d=identicon&r=PG", "display_name": "Cameron Lowell Palmer", "link": "https://stackoverflow.com/users/410867/cameron-lowell-palmer"}, "edited": false, "score": 0, "creation_date": 1538821243, "post_id": 52671689, "comment_id": 92284933, "body": "I&#39;ll check it out in a few minutes, thanks for the response."}], "tags": [], "owner": {"reputation": 2842, "user_id": 599686, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6e2b017e2266ab3c15e0439a1ca10946?s=128&d=identicon&r=PG", "display_name": "bliof", "link": "https://stackoverflow.com/users/599686/bliof"}, "is_accepted": true, "score": 0, "last_activity_date": 1538815856, "last_edit_date": 1538815856, "creation_date": 1538765328, "answer_id": 52671689, "question_id": 52628354, "link": "https://stackoverflow.com/questions/52628354/post-install-of-cocoapod-get-main-project-directly/52671689#52671689", "title": "Post-Install of Cocoapod get main project directly", "body": "<p><a href=\"https://guides.cocoapods.org/syntax/podfile.html\" rel=\"nofollow noreferrer\">https://guides.cocoapods.org/syntax/podfile.html</a></p>\n\n<p>There is <code>installer.pods_project</code></p>\n\n<pre><code>post_install do |installer|\n  project = installer.pods_project\n\n  project.targets.each do |target|\n    inject_shell_script_build_phase(target)\n  end\n\n  project.save\nend\n</code></pre>\n\n<p><a href=\"https://www.rubydoc.info/gems/cocoapods/Pod/Installer#pods_project-instance_method\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/cocoapods/Pod/Installer#pods_project-instance_method</a>\n<a href=\"https://www.rubydoc.info/gems/cocoapods/Pod/Project\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/cocoapods/Pod/Project</a> inherits from <a href=\"https://www.rubydoc.info/gems/xcodeproj/Xcodeproj/Project\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/xcodeproj/Xcodeproj/Project</a></p>\n\n<hr>\n\n<p>to iterate the *.xcodeproj you can do</p>\n\n<pre><code>post_install do |installer|\n  installer.aggregate_targets.each do |target|\n    user_project = target.user_project\n\n    puts \"#{user_project.path}\"\n  end\nend\n</code></pre>\n\n<p><a href=\"https://www.rubydoc.info/gems/cocoapods/Pod%2FInstaller%3Aaggregate_targets\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/cocoapods/Pod%2FInstaller%3Aaggregate_targets</a>\n<a href=\"https://www.rubydoc.info/gems/cocoapods/Pod/AggregateTarget\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/cocoapods/Pod/AggregateTarget</a></p>\n"}, {"tags": [], "owner": {"reputation": 8460, "user_id": 494642, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Z7WbB.jpg?s=128&g=1", "display_name": "Hari Honor", "link": "https://stackoverflow.com/users/494642/hari-honor"}, "is_accepted": false, "score": 0, "last_activity_date": 1613041633, "last_edit_date": 1613041633, "creation_date": 1613040338, "answer_id": 66153210, "question_id": 52628354, "link": "https://stackoverflow.com/questions/52628354/post-install-of-cocoapod-get-main-project-directly/66153210#66153210", "title": "Post-Install of Cocoapod get main project directly", "body": "<p>This should do the trick... Notice the <code>post_integrate</code> hook. Otherwise my changes got overridden (ignored?) unless I did it via the direct file open.</p>\n<pre><code>post_integrate do |installer|\n  project =  installer.aggregate_targets[0].user_project\n  project.targets.each do |target|\n    inject_shell_script_build_phase(target)\n  end\n  project.save\nend\n</code></pre>\n"}], "owner": {"reputation": 17769, "user_id": 410867, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7c3876979ec8539d49987d1556b6fdd4?s=128&d=identicon&r=PG", "display_name": "Cameron Lowell Palmer", "link": "https://stackoverflow.com/users/410867/cameron-lowell-palmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1540, "favorite_count": 0, "accepted_answer_id": 52671689, "answer_count": 2, "score": 2, "last_activity_date": 1613041633, "creation_date": 1538573946, "question_id": 52628354, "link": "https://stackoverflow.com/questions/52628354/post-install-of-cocoapod-get-main-project-directly", "title": "Post-Install of Cocoapod get main project directly", "body": "<p>In creating a CocoaPod Podspec for a <code>vendored_framework</code> I need to install a shell script to be run after all other <code>build_phases</code> in the main project. The only way I have found to do this is by groping the directory for the <code>.xcodeproj</code> file from the <code>Podfile</code>.</p>\n\n<pre><code>post_install do |installer|\n  project_name = Dir.glob(\"*.xcodeproj\").first\n  project = Xcodeproj::Project.open(project_name)\n  project.targets.each do |target|\n    inject_shell_script_build_phase(target)\n  end\n  project.save\nend\n</code></pre>\n\n<p>This seems ridiculous given that <code>pod install</code> or <code>pod update</code> is running and clearly has this information already. Is there a way to get the <code>project</code> reference directly without having to glob or hardcode the project filename?</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1538577157, "post_id": 52629352, "comment_id": 92192247, "body": "Yeah, this seems like it should work based on my understanding of the question. In addition, OP might try binding the functions in the &#39;main javascript file&#39;, or the Coffeescript file to the <code>window</code> object, so they&#39;re accessible anywhere."}, {"owner": {"reputation": 313, "user_id": 1406904, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/70ae82210e956e534c6bba9eb626f175?s=128&d=identicon&r=PG", "display_name": "Guj Mil", "link": "https://stackoverflow.com/users/1406904/guj-mil"}, "edited": false, "score": 0, "creation_date": 1538578124, "post_id": 52629352, "comment_id": 92192926, "body": "This is my current workaround, but I wish I could get @item on the callback because I have several mayor functions on that file, and I don&#39;t want to repeat code"}, {"owner": {"reputation": 313, "user_id": 1406904, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/70ae82210e956e534c6bba9eb626f175?s=128&d=identicon&r=PG", "display_name": "Guj Mil", "link": "https://stackoverflow.com/users/1406904/guj-mil"}, "reply_to_user": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1538578378, "post_id": 52629352, "comment_id": 92193126, "body": "@NMPennypacker I want to avoid making the functions global, they are very specific to just that one view. Another workaround I thought of is adding a class &quot;new&quot; to the newly created item on &quot;create.js.erb&quot; and then finding it with $(&#39;li.new&#39;) on the callback, do what I have to do, and finally remove the &quot;new&quot; class. But I mean, there have to be a better way, right?"}, {"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "reply_to_user": {"reputation": 313, "user_id": 1406904, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/70ae82210e956e534c6bba9eb626f175?s=128&d=identicon&r=PG", "display_name": "Guj Mil", "link": "https://stackoverflow.com/users/1406904/guj-mil"}, "edited": false, "score": 0, "creation_date": 1538578502, "post_id": 52629352, "comment_id": 92193219, "body": "@GujMil Why not just put the relevant Javascript directly in your view file? I do it all the time."}], "tags": [], "owner": {"reputation": 486, "user_id": 7069011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AfPIn.jpg?s=128&g=1", "display_name": "ThorTL67", "link": "https://stackoverflow.com/users/7069011/thortl67"}, "is_accepted": false, "score": 0, "last_activity_date": 1538576874, "creation_date": 1538576874, "answer_id": 52629352, "question_id": 52628277, "link": "https://stackoverflow.com/questions/52628277/rails-4-remote-request-callback-issue-with-data-type-js/52629352#52629352", "title": "Rails 4 remote request callback issue with data-type JS", "body": "<p>If I understand your problem correctly, you want to be able to do stuff with @item on the callback.</p>\n\n<p>You should be able to manipulate @item from within <code>create.js.erb</code> instead of using the <code>success</code> callback.</p>\n\n<p>To test this, I would remove this:</p>\n\n<p><code>$('#add_item_form').on('ajax:success', function (e, data){\n  alert('Success!');\n}</code></p>\n\n<p>and then add some Javascript code to your <code>create.js.erb</code> file:</p>\n\n<pre><code>$('#item_list').append(\"&lt;%= escape_javascript(render partial: 'item_li', locals: { item: @item }) %&gt;\")\nalert('Success!');\n// Do whatever you want here, @item should be accessible \n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 1406904, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/70ae82210e956e534c6bba9eb626f175?s=128&d=identicon&r=PG", "display_name": "Guj Mil", "link": "https://stackoverflow.com/users/1406904/guj-mil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538576874, "creation_date": 1538573720, "question_id": 52628277, "link": "https://stackoverflow.com/questions/52628277/rails-4-remote-request-callback-issue-with-data-type-js", "title": "Rails 4 remote request callback issue with data-type JS", "body": "<p>I'm having a issue on Rails 4.1.6, Ruby 2.3.0, JQuery 1.11.1 (jquery-rails 3.1.1, coffee-rails 4.0.1), I will make a simple example to explain my problem:</p>\n\n<p>I have a view with a list of items that gets created with Ajax. On it, there is a button to create a new empty item, remotely:</p>\n\n<pre><code>button_to \"Add Item\",\n          { action: :create },\n          form: { id: \"add_item_form\" },\n          remote: true\n</code></pre>\n\n<p>On my Javascript, I have hooked up the event:</p>\n\n<pre><code>$('#add_item_form').on('ajax:success', function (e, data){\n  alert('Success!');\n}\n</code></pre>\n\n<p>The controller:</p>\n\n<pre><code>def create\n  @item = Item.new()\n  @item.save!\n  respond_to do |format|\n    format.js\n  end\nend\n</code></pre>\n\n<p>Because the <strong>create</strong> method only responds to JS, it will attempt to render a JS view with the same name, which is fine:</p>\n\n<p>create.js.erb</p>\n\n<pre><code>$('#item_list').append(\"&lt;%= escape_javascript(render partial: 'item_li', locals: { item: @item }) %&gt;\")\n</code></pre>\n\n<p>And on the partial:</p>\n\n<p>_item_li.html.erb</p>\n\n<pre><code>&lt;li&gt;\n  &lt;%= form_for(item, remote: true) do |f| %&gt;\n    // List of item fields from model\n  &lt;% end %&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p>If I run that code, it works fine, and the alert shows \"Success!\", the callback executes right after the partial view is rendered. The problem is, where that alert is, I would like to do some stuff with the information of the newly created Item (like the id), but I can't find a way to get the Item I created in the controller back at the callback function. </p>\n\n<p>Since I'm working with CoffeeScript, my main javascript file, and create.js.erb can't communicate with each other (functions declared on main file can't be reached from the other file).</p>\n\n<p>If I change my controller to do:</p>\n\n<pre><code>respond_to do |format|\n  format.js\n  format.json { render json: @item }\nend\n</code></pre>\n\n<p>And change my data-type on the button to \"json\", I will get the item on the callback, but the partial view will never be reached. If I add both data-types, then I get whatever's on <strong>create.js.erb</strong> in the \"data\" variable on the callback.</p>\n\n<p>What is the best solution to this problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 1, "creation_date": 1538569773, "post_id": 52626967, "comment_id": 92187398, "body": "I don&#39;t think this is the answer but try adding parens: <code>j(render(&#39;form&#39;))</code> to be sure it is being parsed as intended by Ruby."}, {"owner": {"reputation": 803, "user_id": 7654691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8Gni.jpg?s=128&g=1", "display_name": "R. Sierra", "link": "https://stackoverflow.com/users/7654691/r-sierra"}, "edited": false, "score": 0, "creation_date": 1538585672, "post_id": 52626967, "comment_id": 92197410, "body": "Where is <code>filename.js.erb</code> being called? can you add the controller ?"}], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 7069011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AfPIn.jpg?s=128&g=1", "display_name": "ThorTL67", "link": "https://stackoverflow.com/users/7069011/thortl67"}, "is_accepted": false, "score": 1, "last_activity_date": 1538575986, "creation_date": 1538575986, "answer_id": 52629027, "question_id": 52626967, "link": "https://stackoverflow.com/questions/52626967/how-do-i-post-a-form-in-rails-using-ajax/52629027#52629027", "title": "How do i post a form in rails using ajax?", "body": "<p>Try changing your single quote to double quotes around the form. For example:</p>\n\n<pre><code>$('#new-band a').html('&lt;%= j render 'form'%&gt;')\n</code></pre>\n\n<p>Changes to:</p>\n\n<pre><code>$('#new-band a').html('&lt;%= j render \"form\" %&gt;')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "is_accepted": false, "score": 0, "last_activity_date": 1538578384, "creation_date": 1538578384, "answer_id": 52629872, "question_id": 52626967, "link": "https://stackoverflow.com/questions/52626967/how-do-i-post-a-form-in-rails-using-ajax/52629872#52629872", "title": "How do i post a form in rails using ajax?", "body": "<p>You can try this: </p>\n\n<pre><code>$('#new-band a').html(\"&lt;%= j render(:partial =&gt; 'form') %&gt;\");\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 9182404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2867469c2f8eecfa39d2fa8c73811dd3?s=128&d=identicon&r=PG&f=1", "display_name": "alphons", "link": "https://stackoverflow.com/users/9182404/alphons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1538578384, "creation_date": 1538569395, "last_edit_date": 1538569882, "question_id": 52626967, "link": "https://stackoverflow.com/questions/52626967/how-do-i-post-a-form-in-rails-using-ajax", "title": "How do i post a form in rails using ajax?", "body": "<p>I have a rails app that I need to use Ajax to post on my model.</p>\n\n<p>I have only this line in my filename.js.erb </p>\n\n<pre><code>$('#new-band a').html('&lt;%= j render 'form'%&gt;')\n</code></pre>\n\n<p>Here is my error:</p>\n\n<pre><code>Showing /&lt;snip&gt;/ajax/app/views/layouts/application.html.erb where line #8 raised:\n\nundefined method `render' for #&lt;#&lt;Class:0x00007fad63eb3b98&gt;:0x00007fad5e2c13f8&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium", "google-chrome", "watir"], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 3396971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c75295766cfc6c5950bb398fa6c7e2?s=128&d=identicon&r=PG", "display_name": "NemyaNation", "link": "https://stackoverflow.com/users/3396971/nemyanation"}, "is_accepted": false, "score": 1, "last_activity_date": 1553442682, "creation_date": 1553442682, "answer_id": 55325608, "question_id": 52625398, "link": "https://stackoverflow.com/questions/52625398/trying-to-use-a-proxy-with-watir-rails/55325608#55325608", "title": "Trying to use a proxy with Watir... (Rails)", "body": "<p>Watir is largely based on selenium. Selenium does not support authorization with proxying as of the time of this posting.</p>\n\n<p>An issue has been brought up <a href=\"https://github.com/watir/watir/issues/798\" rel=\"nofollow noreferrer\">https://github.com/watir/watir/issues/798</a> but nothing has come of it yet. Possibly in the future; but I would suggest looking at alternative methods for right now.</p>\n"}], "owner": {"reputation": 63, "user_id": 9694191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5416dd158f67ab451ea345ebc3637e40?s=128&d=identicon&r=PG&f=1", "display_name": "waynard", "link": "https://stackoverflow.com/users/9694191/waynard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1553442682, "creation_date": 1538563713, "question_id": 52625398, "link": "https://stackoverflow.com/questions/52625398/trying-to-use-a-proxy-with-watir-rails", "title": "Trying to use a proxy with Watir... (Rails)", "body": "<p>I have a few proxies I want to use with my Watir integration that use authentication. There is no documentation for auth with proxies (<a href=\"http://watir.com/guides/proxies/\" rel=\"nofollow noreferrer\">http://watir.com/guides/proxies/</a>). From a previous SO article, I read that it's supposed to be in this format: </p>\n\n<pre><code>proxy = {\n      http: 'http://user:pass@35.197.175.20:3128',\n      ssl:  'https://user:pass@35.197.175.20:3128'\n    }\n</code></pre>\n\n<p>I create my browser object with the proxy like this: <code>browser = Watir::Browser.new :chrome, headless: true, proxy: proxy</code></p>\n\n<p>What am I doing wrong? Why isn't it routing the connection through the proxy?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "race-condition"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1538562152, "post_id": 52624818, "comment_id": 92183036, "body": "so which object&#39;s <code>lock_version</code> you want to update? <code>self</code> or all those <code>Product.where(:id =&gt; self.id)</code>. Your code is so convoluted... Why do you do <code>Product.find(self.id)</code> in <code>Product</code> model? Isn&#39;t <code>id</code> a uniq primary key?"}, {"owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "edited": false, "score": 0, "creation_date": 1538817661, "post_id": 52624818, "comment_id": 92283995, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52624048/ruby-before-validation-triggers-infinite-loop-of-call-back\">Ruby before_validation triggers infinite loop of call back</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": false, "score": 0, "last_activity_date": 1538567196, "last_edit_date": 1538567196, "creation_date": 1538566183, "answer_id": 52626101, "question_id": 52624818, "link": "https://stackoverflow.com/questions/52624818/ruby-how-to-handle-optimistic-locking-using-update-allattributes/52626101#52626101", "title": "Ruby: How to handle optimistic locking using update_all(attributes)", "body": "<h2>Possible Solution:</h2>\n\n<pre><code>class Product &lt; ApplicationRecord    \n  before_validation :reload_and_apply_changes_if_stale, on: :update\n\n  def reload_and_assign_changes_if_stale\n    # if stale\n    if lock_version != Post.find(id).lock_version\n      # store the \"changes\" first into a backup variable\n      current_changes = changes\n\n      # reload this record from \"real\" up-to-date values from DB (because we already know that it's stale)\n      reload\n      # after reloading, `changes` now becomes `{}`, and is why we need the backup variable `current_changes` above\n\n      # now finally, assign back again all the \"changed\" values\n      current_changes.each do |attribute_name, change|\n        change_from = change[0] # you can remove this line\n        change_to = change[1]\n        self[attribute_name] = change_to\n      end\n    end\n  end\nend\n</code></pre>\n\n<h2>Important Notes:</h2>\n\n<ul>\n<li><p>the <code>before_validation</code> above STILL DOES NOT GUARANTEE that the race condition will be avoided! because see the example below:</p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  # this triggers first...\n  before_validation :reload_and_apply_changes_if_stale, on: :update\n  # then, this triggers next...\n  before_update :do_some_heavy_loooong_calculation\n\n  def do_some_heavy_loooong_calculation\n    sleep(60.seconds)\n    # ... of which during this time, this record might already be stale! as perhaps another \"process\" or another \"server\" has already updated this record!\n  end\n</code></pre></li>\n<li><p>make sure that the <code>before_validation</code> above is at the very top of your Post model, so that that callback will be triggered first before any of your other before_validations (or even any subsequent callbacks: <code>*_update</code>, or <code>*_save</code>), as perhaps you might have one or two subsequent callbacks that are dependent on the current state of the attributes (i.e. it's doing some calculation, or checking against some boolean-flag attribute), which then you need to reload first (as is above), before doing these calculations.</p></li>\n<li><p>the <code>before_validation</code> above will only work for \"calculations/dependencies\" in your model callbacks, but will not work properly if you have calculations/dependencies outside of your <code>Product</code> model's callbacks; i.e if you have something like:</p>\n\n<pre><code>class ProductsController &lt; ApplicationController\n  def update\n    @product = Product.find(params[:id])\n\n    # let's assume at this line, @product.cost = nil (no value yet)\n\n    @product.assign_attributes(product_attributes)\n\n    # let's assume at this line, @product.cost = 1100\n\n    # because 1100 &gt; 1000, then DO SOME IMPORTANT THING!\n    if @product.cost_was.nil? &amp;&amp; @product.cost &gt; 1_000.0\n      # do some important thing!\n    end\n\n    # however, when `product.save` is called below and the `before_validation :reload_and_apply_changes_if_stale` is triggered,\n    # of which let's say some other \"process\" has already updated this\n    # exact same record, and thus @product is reloaded, but the real DB value is now\n    # @product.cost = 900; there's no WAY TO UNDO SOME IMPORTANT THING! above\n\n    @product.save\n  end\nend\n</code></pre></li>\n</ul>\n\n<p><em>The notes above are why by default Rails do not auto-reload that attributes as a <code>before_validation</code> or something, because depending on your application/business logic, you might want to \"reload\" or \"not-reload\", and this is why by default Rails instead raises an <code>ActiveRecord::StaleObjectError</code> <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Locking/Optimistic.html\" rel=\"nofollow noreferrer\">(see docs)</a> for you to specifically rescue, and handle what to do accordingly if this race-condition happened.</em></p>\n"}], "owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538567196, "creation_date": 1538561895, "last_edit_date": 1538562021, "question_id": 52624818, "link": "https://stackoverflow.com/questions/52624818/ruby-how-to-handle-optimistic-locking-using-update-allattributes", "title": "Ruby: How to handle optimistic locking using update_all(attributes)", "body": "<p>I am trying to implement the Optimistic Locking for Race Condition. For that, I added an extra column <code>lock_version</code> in the Product: Model through migration.</p>\n\n<pre><code>#Product: Model's new field:\n    #  attribute_1\n    #  lock_version                       :integer(4)      default(0), not null\nbefore_validation :method_1, :if =&gt; :recalculation_required_attribute\n\ndef method_1\n    ####\n    ####\n    if self.lock_version == Product.find(self.id).lock_version\n       Product.where(:id =&gt; self.id).update_all(attributes)\n       self.attributes = attributes\n       self.save!\n    end\nend\n</code></pre>\n\n<p>Product Model has an <code>attribute_1</code>. If recalculation is required for <code>attribute_1</code> then <code>before_validation: method_1</code> will call.</p>\n\n<p>I am using optimistic locking using <code>lock_version</code>. However, <code>update_all</code> will not increase the <code>lock_version</code>. So I start using<code>save!</code>. Now I am getting a new error: <code>SystemStackError: stack level too deep</code> because  <code>self.save!</code> triggers the <code>before_validation: method1</code>. How to stop infinite loop of call back and handle optimistic locking in the above case.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "answers": [{"comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 2, "creation_date": 1538563281, "post_id": 52625040, "comment_id": 92183683, "body": "It&#39;s not good idea to precompile assets on local machine as it won&#39;t assets changes after this precompilation. while posting links with answer make sure you have brief expiation for the answer, external links may not work in future."}], "tags": [], "owner": {"reputation": 1707, "user_id": 3292174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DNPrX.jpg?s=128&g=1", "display_name": "Michael Malov", "link": "https://stackoverflow.com/users/3292174/michael-malov"}, "is_accepted": true, "score": 2, "last_activity_date": 1538563647, "last_edit_date": 1538563647, "creation_date": 1538562575, "answer_id": 52625040, "question_id": 52624154, "link": "https://stackoverflow.com/questions/52624154/receiving-nomethoderror-undefined-method-for-nilnilclass-when-pushing-r/52625040#52625040", "title": "Receiving &quot;NoMethodError: undefined method `[]&#39; for nil:NilClass&quot; when pushing Rails app to Heroku", "body": "<p>You get this error during <code>rake assets:precompile</code>, so you can try this rake task on local machine.</p>\n\n<p>From stack trace I've found <code>font_url</code>, you can try to find this method in your <code>.css</code> file and rename it to <code>.scss</code></p>\n"}], "owner": {"reputation": 269, "user_id": 1405635, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/QxY9c.jpg?s=128&g=1", "display_name": "CJ Jacobs", "link": "https://stackoverflow.com/users/1405635/cj-jacobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 52625040, "answer_count": 1, "score": 0, "last_activity_date": 1538563647, "creation_date": 1538559735, "question_id": 52624154, "link": "https://stackoverflow.com/questions/52624154/receiving-nomethoderror-undefined-method-for-nilnilclass-when-pushing-r", "title": "Receiving &quot;NoMethodError: undefined method `[]&#39; for nil:NilClass&quot; when pushing Rails app to Heroku", "body": "<p>I am getting the following log file when trying to push to Heroku even though the app is running properly when I launch it through the shell on Cloud 9:</p>\n\n<pre><code>remote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: -----&gt; Ruby app detected\nremote: -----&gt; Compiling Ruby/Rails\nremote: -----&gt; Using Ruby version: ruby-2.4.4\nremote: -----&gt; Installing dependencies using bundler 1.15.2\nremote:        Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\nremote:        Warning: the running version of Bundler (1.15.2) is older than the version that created the lockfile (1.16.4). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\nremote:        Fetching gem metadata from https://rubygems.org/.........\nremote:        Fetching version metadata from https://rubygems.org/..\nremote:        Fetching dependency metadata from https://rubygems.org/.\nremote:        Using rake 12.3.1\nremote:        Using concurrent-ruby 1.0.5\nremote:        Using minitest 5.10.3\nremote:        Using thread_safe 0.3.6\nremote:        Using builder 3.2.3\nremote:        Using erubi 1.7.1\nremote:        Using mini_portile2 2.3.0\nremote:        Using crass 1.0.4\nremote:        Using rack 2.0.5\nremote:        Using nio4r 2.3.1\nremote:        Using websocket-extensions 0.1.3\nremote:        Using mini_mime 1.0.1\nremote:        Using arel 8.0.0\nremote:        Using execjs 2.7.0\nremote:        Using popper_js 1.14.3\nremote:        Using rb-fsevent 0.10.3\nremote:        Using ffi 1.9.25\nremote:        Using bundler 1.15.2\nremote:        Using method_source 0.9.0\nremote:        Using thor 0.20.0\nremote:        Using coffee-script-source 1.12.2\nremote:        Using multi_json 1.13.1\nremote:        Using pg 0.18.4\nremote:        Using puma 3.9.1\nremote:        Using tilt 2.0.8\nremote:        Using turbolinks-source 5.2.0\nremote:        Using i18n 1.1.0\nremote:        Using tzinfo 1.2.5\nremote:        Using nokogiri 1.8.4\nremote:        Using rack-test 1.1.0\nremote:        Using sprockets 3.7.2\nremote:        Using websocket-driver 0.6.5\nremote:        Using autoprefixer-rails 9.1.4\nremote:        Using uglifier 3.2.0\nremote:        Using mail 2.7.0\nremote:        Using rb-inotify 0.9.10\nremote:        Using coffee-script 2.4.1\nremote:        Using turbolinks 5.0.1\nremote:        Using activesupport 5.1.6\nremote:        Using loofah 2.2.2\nremote:        Using sass-listen 4.0.0\nremote:        Using rails-dom-testing 2.0.3\nremote:        Using globalid 0.4.1\nremote:        Using activemodel 5.1.6\nremote:        Using jbuilder 2.7.0\nremote:        Using rails-html-sanitizer 1.0.4\nremote:        Using sass 3.6.0\nremote:        Using activejob 5.1.6\nremote:        Using activerecord 5.1.6\nremote:        Using actionview 5.1.6\nremote:        Using bootstrap 4.1.3\nremote:        Using actionpack 5.1.6\nremote:        Using actioncable 5.1.6\nremote:        Using actionmailer 5.1.6\nremote:        Using railties 5.1.6\nremote:        Using sprockets-rails 3.2.1\nremote:        Using coffee-rails 4.2.2\nremote:        Using jquery-rails 4.3.1\nremote:        Using rails 5.1.6\nremote:        Using sass-rails 5.0.6\nremote:        Using bootstrap_form 4.0.0.alpha1\nremote:        Bundle complete! 23 Gemfile dependencies, 61 gems now installed.\nremote:        Gems in the groups development and test were not installed.\nremote:        Bundled gems are installed into ./vendor/bundle.\nremote:        Bundle completed (3.06s)\nremote:        Cleaning up the bundler cache.\nremote:        Warning: the running version of Bundler (1.15.2) is older than the version that created the lockfile (1.16.4). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\nremote:        The latest bundler is 1.17.0.pre.1, but you are currently running 1.15.2.\nremote:        To update, run `gem install bundler --pre`\nremote: -----&gt; Installing node-v8.10.0-linux-x64\nremote: -----&gt; Detecting rake tasks\nremote: -----&gt; Preparing app for Rails asset pipeline\nremote:        Running: rake assets:precompile\nremote:        Yarn executable was not detected in the system.\nremote:        Download Yarn at https://yarnpkg.com/en/docs/install\nremote:        I, [2018-10-03T09:12:18.142230 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/FontAwesome-ecd72f31910a8ee2726fd17bd459be26f230779f3f3ed5f69ebf829e4b12e768.otf\nremote:        I, [2018-10-03T09:12:18.143259 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/FontAwesome-ecd72f31910a8ee2726fd17bd459be26f230779f3f3ed5f69ebf829e4b12e768.otf.gz\nremote:        I, [2018-10-03T09:12:18.146824 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/fontawesome-webfont-50bbe9192697e791e2ee4ef73917aeb1b03e727dff08a1fc8d74f00e4aa812e1.eot\nremote:        I, [2018-10-03T09:12:18.147645 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/fontawesome-webfont-50bbe9192697e791e2ee4ef73917aeb1b03e727dff08a1fc8d74f00e4aa812e1.eot.gz\nremote:        I, [2018-10-03T09:12:18.155999 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/fontawesome-webfont-8e3586389bb4cd01b3f85bb3b622739bde6627f28bba63a020c223ca9cf1b9ae.svg\nremote:        I, [2018-10-03T09:12:18.156816 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/fontawesome-webfont-8e3586389bb4cd01b3f85bb3b622739bde6627f28bba63a020c223ca9cf1b9ae.svg.gz\nremote:        I, [2018-10-03T09:12:18.161253 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/fontawesome-webfont-ae19e2e4c04f2b04bf030684c4c1db8faf5c8fe3ee03d1e0c409046608b38912.ttf\nremote:        I, [2018-10-03T09:12:18.162158 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/fontawesome-webfont-ae19e2e4c04f2b04bf030684c4c1db8faf5c8fe3ee03d1e0c409046608b38912.ttf.gz\nremote:        I, [2018-10-03T09:12:18.171358 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/fontawesome-webfont-adbc4f95eb6d7f2738959cf0ecbc374672fce47e856050a8e9791f457623ac2c.woff\nremote:        I, [2018-10-03T09:12:18.178232 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/fontawesome-webfont-7dacf83f51179de8d7980a513e67ab3a08f2c6272bb5946df8fd77c0d1763b73.woff2\nremote:        I, [2018-10-03T09:12:18.180823 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/glyphicons-halflings-regular-13634da87d9e23f8c3ed9108ce1724d183a39ad072e73e1b3d8cbf646d2d0407.eot\nremote:        I, [2018-10-03T09:12:18.181403 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/glyphicons-halflings-regular-13634da87d9e23f8c3ed9108ce1724d183a39ad072e73e1b3d8cbf646d2d0407.eot.gz\nremote:        I, [2018-10-03T09:12:18.185251 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/glyphicons-halflings-regular-42f60659d265c1a3c30f9fa42abcbb56bd4a53af4d83d316d6dd7a36903c43e5.svg\nremote:        I, [2018-10-03T09:12:18.185519 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/glyphicons-halflings-regular-42f60659d265c1a3c30f9fa42abcbb56bd4a53af4d83d316d6dd7a36903c43e5.svg.gz\nremote:        I, [2018-10-03T09:12:18.187944 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/glyphicons-halflings-regular-e395044093757d82afcb138957d06a1ea9361bdcf0b442d06a18a8051af57456.ttf\nremote:        I, [2018-10-03T09:12:18.188205 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/glyphicons-halflings-regular-e395044093757d82afcb138957d06a1ea9361bdcf0b442d06a18a8051af57456.ttf.gz\nremote:        I, [2018-10-03T09:12:18.191454 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/glyphicons-halflings-regular-a26394f7ede100ca118eff2eda08596275a9839b959c226e15439557a5a80742.woff\nremote:        I, [2018-10-03T09:12:18.194453 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/glyphicons-halflings-regular-fe185d11a49676890d47bb783312a0cda5a44c4039214094e7957b4c040ef11c.woff2\nremote:        I, [2018-10-03T09:12:18.203703 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/icofont-e4cbd1671344845acbca57717d36b47677d9bb3d083f733ae10b9465d94a7762.eot\nremote:        I, [2018-10-03T09:12:18.211381 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/icofont-e4cbd1671344845acbca57717d36b47677d9bb3d083f733ae10b9465d94a7762.eot.gz\nremote:        I, [2018-10-03T09:12:18.283967 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/icofont-667f31ea1b0f726e62ca628f730aa94d25b7e408886962233387ff5ed9541638.svg\nremote:        I, [2018-10-03T09:12:18.354445 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/icofont-667f31ea1b0f726e62ca628f730aa94d25b7e408886962233387ff5ed9541638.svg.gz\nremote:        I, [2018-10-03T09:12:18.399102 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/icofont-ac2e76e07a7208cc4c0f7afb773a89a314c4d13bf7f6def920ad50817e6ba735.ttf\nremote:        I, [2018-10-03T09:12:18.402251 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/icofont-ac2e76e07a7208cc4c0f7afb773a89a314c4d13bf7f6def920ad50817e6ba735.ttf.gz\nremote:        I, [2018-10-03T09:12:18.417501 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/icofont-00f9608b3cbbb28d65eca172de8b338e505e76c228ca385e25f3f6784e29552c.woff\nremote:        I, [2018-10-03T09:12:18.439650 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/footer-bg-dafa00f60bd0f41505cbdecb70a629b5f08e682d3ac2c86a6366c6ad3b369d0e.jpg\nremote:        I, [2018-10-03T09:12:18.450314 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/hand-mockup-581076b7c0893772e9759a46fb5d989e8a1454389c606f3b04c7762450b8e0a5.png\nremote:        I, [2018-10-03T09:12:18.454120 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/loader-bef56aeeae1ddf3cf1a282a73f84d7a0a33b2b3fc2104f9c169bb8a8c05e5a32.gif\nremote:        I, [2018-10-03T09:12:18.461330 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/logo-3d7e2c3ed22e51603ebdf03572ac74b9d966e327fe2f196d5a6a701555113163.png\nremote:        I, [2018-10-03T09:12:18.464691 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/showcase-89c921bf383a4dc538f3629fbf6ab3a31a748539b349581d4458794ba455ec30.png\nremote:        I, [2018-10-03T09:12:18.471609 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/showcase2-3592117095ec5c8714c5b4c4e5b0c5230822f80d4e991b7308609194b825b03e.png\nremote:        I, [2018-10-03T09:12:22.991915 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/application-b10a17f71861db0a548cebad3165cf93d24b4d23401df4869e6d7b6c053b36a5.js\nremote:        I, [2018-10-03T09:12:22.992699 #384]  INFO -- : Writing /tmp/build_12dabe8ded8a8b689b0a385e82947a02/public/assets/application-b10a17f71861db0a548cebad3165cf93d24b4d23401df4869e6d7b6c053b36a5.js.gz\nremote:        rake aborted!\nremote:        NoMethodError: undefined method `[]' for nil:NilClass\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/sass_processor.rb:278:in `sprockets_context'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/sass_processor.rb:124:in `asset_path'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/sass_processor.rb:137:in `asset_url'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/sass_processor.rb:209:in `font_url'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/script/tree/funcall.rb:151:in `block in _perform'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/stack.rb:108:in `block in with_function'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/stack.rb:135:in `with_frame'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/stack.rb:108:in `with_function'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/script/tree/funcall.rb:149:in `_perform'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/script/tree/node.rb:50:in `perform'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:398:in `visit_prop'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/base.rb:36:in `visit'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:158:in `block in visit'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/stack.rb:79:in `block in with_base'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/stack.rb:135:in `with_frame'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/stack.rb:79:in `with_base'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:158:in `visit'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:513:in `block (2 levels) in visit_directive'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:513:in `map'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:513:in `block in visit_directive'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:179:in `with_environment'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:512:in `visit_directive'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/base.rb:36:in `visit'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:158:in `block in visit'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/stack.rb:79:in `block in with_base'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/stack.rb:135:in `with_frame'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/stack.rb:79:in `with_base'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:158:in `visit'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/base.rb:52:in `block in visit_children'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/base.rb:52:in `map'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/base.rb:52:in `visit_children'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:167:in `block in visit_children\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:179:in `with_environment'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:166:in `visit_children'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/base.rb:36:in `block in visit'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:186:in `visit_root'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/base.rb:36:in `visit'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:157:in `visit'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/visitors/perform.rb:10:in `visit'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/root_node.rb:36:in `css_tree'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/tree/root_node.rb:20:in `render'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sass-3.6.0/lib/sass/engine.rb:290:in `render'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/sass_compressor.rb:48:in `call'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/sass_compressor.rb:28:in `call'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/processor_utils.rb:75:in `call_processor'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/processor_utils.rb:57:in `block in call_processors'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/processor_utils.rb:56:in `reverse_each'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/processor_utils.rb:56:in `call_processors'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/loader.rb:134:in `load_from_unloaded'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/loader.rb:60:in `block in load'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/loader.rb:317:in `fetch_asset_from_dependency_cache'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/loader.rb:44:in `load'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/cached_environment.rb:20:in `block in initialize'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/cached_environment.rb:47:in `load'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/base.rb:66:in `find_asset'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/base.rb:73:in `find_all_linked_assets'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/manifest.rb:142:in `block in find'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/legacy.rb:114:in `block (2 levels) in logical_paths'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/path_utils.rb:228:in `block in stat_tree'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/path_utils.rb:212:in `block in stat_directory'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/path_utils.rb:209:in `each'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/path_utils.rb:209:in `stat_directory'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/path_utils.rb:227:in `stat_tree'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/legacy.rb:105:in `each'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/legacy.rb:105:in `block in logical_paths'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/legacy.rb:104:in `each'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/legacy.rb:104:in `logical_paths'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/manifest.rb:140:in `find'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/sprockets/manifest.rb:186:in `compile'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-rails-3.2.1/lib/sprockets/rails/task.rb:68:in `block (3 levels) in define'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-3.7.2/lib/rake/sprocketstask.rb:147:in `with_logger'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/sprockets-rails-3.2.1/lib/sprockets/rails/task.rb:67:in `block (2 levels) in define'\nremote:        /tmp/build_12dabe8ded8a8b689b0a385e82947a02/vendor/bundle/ruby/2.4.0/gems/rake-12.3.1/exe/rake:27:in `&lt;top (required)&gt;'\nremote:        Tasks: TOP =&gt; assets:precompile\nremote:        (See full trace by running task with --trace)\nremote: \nremote:  !\nremote:  !     Precompiling assets failed.\nremote:  !\nremote:  !     Push rejected, failed to compile Ruby app.\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\nremote: \n</code></pre>\n\n<p>I believe <code>remote: NoMethodError: undefined method '[]' for nil:NilClass</code> is the most important part of this error.</p>\n\n<p>I've already tried several things from other answers on the site to no avail.</p>\n\n<p>Such as adding <code>config.assets.initialize_on_precompile = false</code> to my <code>config/application.rb</code> file.</p>\n\n<p>I tried compiling the assests locally before trying to push to Heroku, but I received the same error.</p>\n\n<p>I noticed that many of the other people who had a similar issue at least had a reference to a specific file and line with the NoMethod error, but I have no such thing.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "callback"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1538559482, "post_id": 52624048, "comment_id": 92181457, "body": "You don&#39;t need to save this record, it will be saved anyway."}, {"owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1538560001, "post_id": 52624048, "comment_id": 92181772, "body": "@MarekLipka Lipka I am using optimistic locking using lock_version. &#39;update_all&#39; will not increase the lock_version. So I am using save!. It is calling the infinite look of call back."}], "answers": [{"comments": [{"owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "edited": false, "score": 0, "creation_date": 1538559979, "post_id": 52624114, "comment_id": 92181757, "body": "I am using optimistic locking using lock_version. &#39;update_all&#39; will not increase the lock_version. So I am using save!. It is calling the infinite look of call back."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "edited": false, "score": 0, "creation_date": 1538560062, "post_id": 52624114, "comment_id": 92181811, "body": "@geeks think about it. You are in transaction, it&#39;s waiting till <code>before_validation</code> is done to save the record. In <code>before_validation</code> you do <code>save!</code> which runs <code>before_validation</code> again, which runs <code>save!</code> which runs <code>before_validation</code> which... I hope you get my point"}, {"owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "edited": false, "score": 0, "creation_date": 1538560214, "post_id": 52624114, "comment_id": 92181902, "body": "Yes, you are correct, Can you suggest how to run, if before_validation only one time?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "edited": false, "score": 0, "creation_date": 1538560385, "post_id": 52624114, "comment_id": 92182003, "body": "@geeks if you try to increment the <code>lock_version</code> just go with <code>self.lock_version = lock_version +1</code> or whatever the new iteration of <code>lock_version</code> should result in"}, {"owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "edited": false, "score": 0, "creation_date": 1538560532, "post_id": 52624114, "comment_id": 92182088, "body": "<code>lock_version</code> is auto-increment, if I do it through the <code>update_all</code>, optimistic locking will not work."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "edited": false, "score": 0, "creation_date": 1538560659, "post_id": 52624114, "comment_id": 92182145, "body": "@geeks I answered your initial question. If you have new question, consider accepting this one and create a new question about handling <code>lock_version</code>"}, {"owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "edited": false, "score": 0, "creation_date": 1538561955, "post_id": 52624114, "comment_id": 92182919, "body": "Could you check new question: <a href=\"https://stackoverflow.com/questions/52624818/ruby-how-to-handle-optimistic-locking-using-update-allattributes\" title=\"ruby how to handle optimistic locking using update allattributes\">stackoverflow.com/questions/52624818/&hellip;</a>"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 3, "last_activity_date": 1538559601, "creation_date": 1538559601, "answer_id": 52624114, "question_id": 52624048, "link": "https://stackoverflow.com/questions/52624048/ruby-before-validation-triggers-infinite-loop-of-call-back/52624114#52624114", "title": "Ruby before_validation triggers infinite loop of call back", "body": "<p>You don't need <code>self.save!</code> there: you are already inside the transaction, so just do whatever you want to do and let Rails save the record once you are done.</p>\n\n<p>Sidenotes:</p>\n\n<ul>\n<li><code>Product.where(:id =&gt; self.id).update_all(attributes)</code> probably could be rewritten as <code>products.update_all(attributes)</code> (having the association <code>this_model has_many :products</code></li>\n<li><code>self.attributes = attributes</code> is redundant unless <code>attributes</code> is an instance method.</li>\n</ul>\n"}], "owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 52624114, "answer_count": 1, "score": 0, "last_activity_date": 1538563000, "creation_date": 1538559386, "last_edit_date": 1538563000, "question_id": 52624048, "link": "https://stackoverflow.com/questions/52624048/ruby-before-validation-triggers-infinite-loop-of-call-back", "title": "Ruby before_validation triggers infinite loop of call back", "body": "<p>Product Model has an attribute_1. If recalculation is required for attribute_1 then before_validation will call. It giving <code>SystemStackError: stack level too deep</code> because  <code>self.save!</code> triggers the <code>before_validation</code>. How to stop infinite loop of call back.</p>\n\n<pre><code>before_validation :method_1, :if =&gt; :recalculation_required_attribute\n</code></pre>\n\n<p>I am using optimistic locking using <code>lock_version</code>. 'update_all' will not increase the <code>lock_version</code>. So I am using <code>save!</code>. It is calling the infinite look of call back.</p>\n\n<pre><code>def method_1\n    ####\n    ####\n    if self.lock_version == Product.find(self.id).lock_version\n       Product.where(:id =&gt; self.id).update_all(attributes)\n       self.attributes = attributes\n       self.save!\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 2, "last_activity_date": 1538558407, "creation_date": 1538558407, "answer_id": 52623730, "question_id": 52623667, "link": "https://stackoverflow.com/questions/52623667/convert-strings-into-number-values-within-subarrays/52623730#52623730", "title": "Convert strings into number values within subarrays", "body": "<p>You need to introduce intermediate array, where you can store the results of operation on a single word:</p>\n\n<pre><code>separate_words.each do |word|\n  converted_word = []\n  word.each do |letter|\n    converted_word.push(letter.to_i(36))\n  end\n  converted_words.push(converted_word)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 188, "user_id": 9697317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7UDII.jpg?s=128&g=1", "display_name": "Benisburgers", "link": "https://stackoverflow.com/users/9697317/benisburgers"}, "edited": false, "score": 1, "creation_date": 1538558856, "post_id": 52623806, "comment_id": 92181068, "body": "Basically what you want is a transformation. First, I split every word in an array of characters. then, every letter of every array of character becomes an integer."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1538558936, "post_id": 52623806, "comment_id": 92181125, "body": "That&#39;s a good one, why don&#39;t you put this explanation in answer itself?"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1538570357, "post_id": 52623806, "comment_id": 92187816, "body": "You could also do it as such <code>words.map { |w| w.chars.map { |c| c.to_i(36) } }</code>."}, {"owner": {"reputation": 188, "user_id": 9697317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7UDII.jpg?s=128&g=1", "display_name": "Benisburgers", "link": "https://stackoverflow.com/users/9697317/benisburgers"}, "edited": false, "score": 0, "creation_date": 1539781819, "post_id": 52623806, "comment_id": 92626492, "body": "Is there any way for me to use this function to do the oppsite, i.e. to convert the numbers back into letters?"}, {"owner": {"reputation": 188, "user_id": 9697317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7UDII.jpg?s=128&g=1", "display_name": "Benisburgers", "link": "https://stackoverflow.com/users/9697317/benisburgers"}, "edited": false, "score": 0, "creation_date": 1539783686, "post_id": 52623806, "comment_id": 92627737, "body": "That is, once I&#39;ve converted them from letters to numbers, how do I convert the numbers back to letters? @Ursus"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1539783770, "post_id": 52623806, "comment_id": 92627790, "body": "I&#39;m not sure if there is such an opposite operation for this kind of thing you do."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1538559029, "last_edit_date": 1538559029, "creation_date": 1538558622, "answer_id": 52623806, "question_id": 52623667, "link": "https://stackoverflow.com/questions/52623667/convert-strings-into-number-values-within-subarrays/52623806#52623806", "title": "Convert strings into number values within subarrays", "body": "<p>Basically what you want is a transformation (map). First, I split every word in an array of characters. then, every letter of every array of character becomes an integer.   </p>\n\n<pre><code>words = [\"I\", \"like\", \"elephants\"]\nwords.map(&amp;:chars).map { |letters| letters.map { |letter| letter.to_i 36 } }\n</code></pre>\n"}], "owner": {"reputation": 188, "user_id": 9697317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7UDII.jpg?s=128&g=1", "display_name": "Benisburgers", "link": "https://stackoverflow.com/users/9697317/benisburgers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1538629019, "creation_date": 1538558228, "last_edit_date": 1538629019, "question_id": 52623667, "link": "https://stackoverflow.com/questions/52623667/convert-strings-into-number-values-within-subarrays", "title": "Convert strings into number values within subarrays", "body": "<p>My goal is to convert letters within words in an array into their corresponding number values so that:</p>\n\n<pre><code>[\"I\", \"like\", \"elephants\"]\n</code></pre>\n\n<p>turns into</p>\n\n<pre><code>[[18], [21, 18, 20, 14], [14, 21, 14, 25, 17, 10, 23, 29, 28]]\n</code></pre>\n\n<p>How can I attain my goal?</p>\n\n<p>This is my current code:</p>\n\n<pre><code>words = [\"I\", \"like\", \"elephants\"]\nseperate_words = []\nconverted_words = []\n\nwords.each do |word|\n  seperate_words.push(word.split(//))\nend\nputs seperate_words.to_s\n\nseperate_words.each do |word|\n  word.each do |letter|\n    converted_words.push(letter.to_i 36)\n  end\nend\nputs converted_words.to_s\n</code></pre>\n\n<p>I cannot separate the words as sub-arrays; I get:</p>\n\n<pre><code>[18, 21, 18, 20, 14, 14, 21, 14, 25, 17, 10, 23, 29, 28]\n</code></pre>\n"}, {"tags": ["ruby", "roo"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 3, "creation_date": 1538549430, "post_id": 52621131, "comment_id": 92176177, "body": "Does <code>puts hash[:identifier]</code> print anything?"}, {"owner": {"reputation": 391, "user_id": 6278557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/63d99c1f1c91ef44a601516fbe9e8747?s=128&d=identicon&r=PG&f=1", "display_name": "themaster", "link": "https://stackoverflow.com/users/6278557/themaster"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1538549926, "post_id": 52621131, "comment_id": 92176435, "body": "Ahh .... thats it .. this works . thanks"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 3, "creation_date": 1538550280, "post_id": 52621131, "comment_id": 92176598, "body": "<code>&#39;identifier&#39;</code> and <code>:identifier</code> are different keys."}], "owner": {"reputation": 391, "user_id": 6278557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/63d99c1f1c91ef44a601516fbe9e8747?s=128&d=identicon&r=PG&f=1", "display_name": "themaster", "link": "https://stackoverflow.com/users/6278557/themaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538549840, "creation_date": 1538548939, "last_edit_date": 1538549840, "question_id": 52621131, "link": "https://stackoverflow.com/questions/52621131/fetching-values-based-on-keys-from-hash", "title": "Fetching values based on keys from hash", "body": "<p>I am using roo gem for reading an xlsx file. </p>\n\n<pre><code>sheet.each(identifier: 'identifier',name: 'name') do |hash|\n  puts hash.inspect\n  puts hash['identifier'] =&gt; prints empty\nend\n</code></pre>\n\n<p>inspect correctly gives all the hash with all the key/ value pairs</p>\n\n<pre><code>{:identifier=&gt;\"3254\",:name=&gt;\"Ins\"}.....so on \n</code></pre>\n\n<p>I need to fetch the value based on key at every loop. Did something like this <code>puts hash['identifier']</code> which does not print anything. </p>\n\n<p>How to achieve this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1538547297, "post_id": 52620702, "comment_id": 92175176, "body": "Can you please run this commands: sudo apt-get install libxslt-dev libxml2-dev zlib1g-dev sudo gem install nokogiri"}, {"owner": {"reputation": 79, "user_id": 5717068, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1666959753589793/picture?type=large", "display_name": "Duong Nhat", "link": "https://stackoverflow.com/users/5717068/duong-nhat"}, "reply_to_user": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1538547564, "post_id": 52620702, "comment_id": 92175262, "body": "@Nezir 0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded."}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1538547810, "post_id": 52620702, "comment_id": 92175366, "body": "did you check official nokogiri instructions? <a href=\"http://www.nokogiri.org/tutorials/installing_nokogiri.html\" rel=\"nofollow noreferrer\">nokogiri.org/tutorials/installing_nokogiri.html</a>"}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1538547871, "post_id": 52620702, "comment_id": 92175401, "body": "also please to run this command: sudo apt-get install libgmp-dev"}, {"owner": {"reputation": 79, "user_id": 5717068, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1666959753589793/picture?type=large", "display_name": "Duong Nhat", "link": "https://stackoverflow.com/users/5717068/duong-nhat"}, "reply_to_user": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1538548076, "post_id": 52620702, "comment_id": 92175489, "body": "Still not working"}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1538548266, "post_id": 52620702, "comment_id": 92175590, "body": "What do you get in terminal when you run these commands ruby -v rails -v bundler -v"}, {"owner": {"reputation": 79, "user_id": 5717068, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1666959753589793/picture?type=large", "display_name": "Duong Nhat", "link": "https://stackoverflow.com/users/5717068/duong-nhat"}, "reply_to_user": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1538548346, "post_id": 52620702, "comment_id": 92175625, "body": "ruby 2.4.4p296 (2018-03-28 revision 63013) [x86_64-linux] I have no rails and bundler"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5717068, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1666959753589793/picture?type=large", "display_name": "Duong Nhat", "link": "https://stackoverflow.com/users/5717068/duong-nhat"}, "edited": false, "score": 0, "creation_date": 1538548761, "post_id": 52621010, "comment_id": 92175843, "body": "bundler install success but rails failed when install nokogiri"}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "reply_to_user": {"reputation": 79, "user_id": 5717068, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1666959753589793/picture?type=large", "display_name": "Duong Nhat", "link": "https://stackoverflow.com/users/5717068/duong-nhat"}, "edited": false, "score": 0, "creation_date": 1538549360, "post_id": 52621010, "comment_id": 92176147, "body": "Okay, lets try to install all of these: sudo apt-get install ruby-dev sudo apt-get install ruby2.0-dev sudo apt-get install ruby2.2-dev sudo apt-get install ruby2.3-dev"}, {"owner": {"reputation": 79, "user_id": 5717068, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1666959753589793/picture?type=large", "display_name": "Duong Nhat", "link": "https://stackoverflow.com/users/5717068/duong-nhat"}, "edited": false, "score": 1, "creation_date": 1538550350, "post_id": 52621010, "comment_id": 92176625, "body": "It missing libruby2.3, I install libruby2.3 and it ok, Thanks"}], "tags": [], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "is_accepted": true, "score": 1, "last_activity_date": 1538548505, "creation_date": 1538548505, "answer_id": 52621010, "question_id": 52620702, "link": "https://stackoverflow.com/questions/52620702/ubuntu-instaled-ruby-dev-but-still-can-not-install-gem-nokogiri/52621010#52621010", "title": "Ubuntu instaled ruby-dev but still can not install gem nokogiri", "body": "<p>Thats the problem you dont have rails installed and also gem bundler.\nCan you please install it:</p>\n\n<p>Run in terminal:</p>\n\n<pre><code> gem install bundler\n</code></pre>\n\n<p>and after that:</p>\n\n<pre><code>gem install rails\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2343, "user_id": 6270554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PqRWJ.jpg?s=128&g=1", "display_name": "Hardik Upadhyay", "link": "https://stackoverflow.com/users/6270554/hardik-upadhyay"}, "is_accepted": false, "score": 1, "last_activity_date": 1538549168, "creation_date": 1538549168, "answer_id": 52621184, "question_id": 52620702, "link": "https://stackoverflow.com/questions/52620702/ubuntu-instaled-ruby-dev-but-still-can-not-install-gem-nokogiri/52621184#52621184", "title": "Ubuntu instaled ruby-dev but still can not install gem nokogiri", "body": "<p>install specific version of ruby</p>\n\n<pre><code>sudo apt-get install ruby2.5-dev\n\ngem install nokogiri -v 1.8.4 -- --use-system-libraries\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5717068, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1666959753589793/picture?type=large", "display_name": "Duong Nhat", "link": "https://stackoverflow.com/users/5717068/duong-nhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 52621010, "answer_count": 2, "score": 0, "last_activity_date": 1538549168, "creation_date": 1538547010, "question_id": 52620702, "link": "https://stackoverflow.com/questions/52620702/ubuntu-instaled-ruby-dev-but-still-can-not-install-gem-nokogiri", "title": "Ubuntu instaled ruby-dev but still can not install gem nokogiri", "body": "<p>I'm trying to install gem nokogiri by:</p>\n\n<pre><code>sudo gem install nokogiri\n</code></pre>\n\n<p>But I get this error:</p>\n\n<pre><code>ERROR:  Error installing nokogiri:\nERROR: Failed to build gem native extension.\n\ncurrent directory: /var/lib/gems/2.5.0/gems/nokogiri-1.8.4/ext/nokogiri\n/usr/bin/ruby2.5 -r ./siteconf20181003-5678-1ub6p51.rb extconf.rb\nmkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h\n</code></pre>\n\n<p>I search on google and they said it because there are no ruby-dev. So I install ruby-dev by:</p>\n\n<pre><code>~$ sudo apt-get install ruby-dev\n~$ dpkg -l | grep ruby-dev\nii  ruby-dev:amd64    2:2.3.0+1bbox1~xenial1         \n      amd64        Header files for compiling extension modules for Ruby (default version)\n</code></pre>\n\n<p>And it install ruby-dev successfully but still get error before.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 3, "creation_date": 1538544313, "post_id": 52620167, "comment_id": 92174118, "body": "well, you&#39;re forgetting to end the array in the last one. <code>[:room_id, :message)</code> should be <code>[:room_id, :message])</code>"}, {"owner": {"reputation": 33, "user_id": 8653160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbX3R.jpg?s=128&g=1", "display_name": "Sheldon Bishop", "link": "https://stackoverflow.com/users/8653160/sheldon-bishop"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1538547995, "post_id": 52620167, "comment_id": 92175450, "body": "@JoshBrody apologies, I copied my code incorrectly. I tried it with the closed array and am still getting the same error"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1538553197, "post_id": 52620167, "comment_id": 92178075, "body": "can you update your question with the error message that <i>syntax error</i> is reporting?"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1538553298, "post_id": 52620167, "comment_id": 92178118, "body": "<code>vote_room_message_path(room.id, message.id)</code> should ideally work, notice the <code>room</code> and <code>message</code> they are objects representing a room and message respectively and not the symbol."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1538553363, "post_id": 52620167, "comment_id": 92178152, "body": "or even <code>vote_room_message_path(room_id: room.id, id: message.id)</code>"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1538563585, "post_id": 52620167, "comment_id": 92183854, "body": "Try this <code>&lt;%= link_to &quot;up&quot;, vote_room_message_path(message.room_id, message, type: &quot;up&quot;), method: &quot;post&quot; %&gt;</code>"}, {"owner": {"reputation": 33, "user_id": 8653160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbX3R.jpg?s=128&g=1", "display_name": "Sheldon Bishop", "link": "https://stackoverflow.com/users/8653160/sheldon-bishop"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1538633567, "post_id": 52620167, "comment_id": 92212591, "body": "@Pavan this seemed to work for the constraint &quot;room_id&quot;. So now the only error thats showing is for the constraint &quot;id&quot;. How would I fix both room_id and id? I tried using (message.room_id, message.id, message, type: &quot;up&quot;) however this doesn&#39;t work"}, {"owner": {"reputation": 33, "user_id": 8653160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbX3R.jpg?s=128&g=1", "display_name": "Sheldon Bishop", "link": "https://stackoverflow.com/users/8653160/sheldon-bishop"}, "edited": false, "score": 0, "creation_date": 1538634971, "post_id": 52620167, "comment_id": 92213267, "body": "I can&#39;t seem to find how to properly use syntax to declare my message id. Ive tried using @message. message.id. message.id. message.find(params[:id])."}], "owner": {"reputation": 33, "user_id": 8653160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbX3R.jpg?s=128&g=1", "display_name": "Sheldon Bishop", "link": "https://stackoverflow.com/users/8653160/sheldon-bishop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538544126, "creation_date": 1538544126, "question_id": 52620167, "link": "https://stackoverflow.com/questions/52620167/having-trouble-adding-dynamic-segment-to-url-generator", "title": "Having trouble adding dynamic segment to URL generator", "body": "<p>Im using the ActiveRecord-reputation-system gem to add an upvote and downvote link to my chat_room app and am having some trouble getting the actual link to show up in my view. </p>\n\n<p>In my Room.show I have put:</p>\n\n<pre><code>&lt;%= link_to \"up\", vote_room_message_path(message, type: \"up\"), method: \"post\" %&gt;\n</code></pre>\n\n<p>and I am getting an error:</p>\n\n<pre><code>No route matches {:action=&gt;\"vote\", :controller=&gt;\"messages\", :id=&gt;\"1\", :room_id=&gt;#&lt;Message id: nil, created_at: nil, updated_at: nil, user_id: nil, room_id: 1, body: nil&gt;, :type=&gt;\"up\"}, possible unmatched constraints: [:room_id]\n</code></pre>\n\n<p>What sticks out to me is \"possible unmatched contrasts: [:room_id]. I have searched extensively online and the only thing I can find is that for each dynamic segment you have, you will need to pass an argument. So I pulled up my routes using rails routes and this is the route that shows for vote_room_message: </p>\n\n<pre><code>vote_room_message POST   /rooms/:room_id/messages/:id/vote(.:format)                                              messages#vote\n</code></pre>\n\n<p>I see two dynamic segments here (:room_id and :id) however I dont know how to claim them in my url. I have tried using </p>\n\n<pre><code>&lt;%= link_to \"up\", vote_room_message_path(message, type: \"up\", [:room_id, :message), method: \"post\" %&gt;\n</code></pre>\n\n<p>however this comes up with a syntax error. Any advice on how to make this work?</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "answers": [{"tags": [], "owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "is_accepted": false, "score": 0, "last_activity_date": 1538541106, "creation_date": 1538541106, "answer_id": 52619722, "question_id": 52619612, "link": "https://stackoverflow.com/questions/52619612/remove-keys-which-have-empty-arrays/52619722#52619722", "title": "Remove keys which have empty arrays", "body": "<p>You can create new one by filtering empty keys in the inner hash.</p>\n\n<pre><code>networks = networks.map {|key, inner_hash|  [key, inner_hash.select{|k, v| v.any?}.to_h]}\n                   .to_h\nputs networks\n# {\n#     :CL1 =&gt; {\n#         :\"192.168.56.0/24\" =&gt; [\"192.168.56.57\", \"192.168.56.84\"]\n#     }, \n#     :CL2 =&gt; {\n#         :\"192.168.222.0/24\" =&gt; [\"192.168.222.224\"]\n#     }\n# }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1538542175, "last_edit_date": 1538542175, "creation_date": 1538541841, "answer_id": 52619831, "question_id": 52619612, "link": "https://stackoverflow.com/questions/52619612/remove-keys-which-have-empty-arrays/52619831#52619831", "title": "Remove keys which have empty arrays", "body": "<pre><code>networks.transform_values { |v| v.reject { |_,a| a.empty? } }\n  #=&gt; {:CL1=&gt;{:\"192.168.56.0/24\"=&gt;[\"192.168.56.57\", \"192.168.56.84\"]},\n  #    :CL2=&gt;{:\"192.168.222.0/24\"=&gt;[\"192.168.222.224\"]}}\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\">Hash#transform_values</a> and <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-reject\" rel=\"nofollow noreferrer\">Hash#reject</a>. The former made its debut in MRI v2.4.</p>\n"}], "owner": {"reputation": 153, "user_id": 4254220, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b3f2b88b871bdf3990476ebcf345d22d?s=128&d=identicon&r=PG&f=1", "display_name": "kotyara85", "link": "https://stackoverflow.com/users/4254220/kotyara85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1538629305, "creation_date": 1538540272, "last_edit_date": 1538629305, "question_id": 52619612, "link": "https://stackoverflow.com/questions/52619612/remove-keys-which-have-empty-arrays", "title": "Remove keys which have empty arrays", "body": "<p>I need to delete sub keys which have empty arrays:</p>\n\n<pre><code>  networks = {\n    \"CL1\": {\n      \"192.168.200.0/24\": [\n\n      ],\n      \"192.168.56.0/24\": [\n        \"192.168.56.57\",\n        \"192.168.56.84\",\n      ]\n    },\n    \"CL2\": {\n      \"192.168.222.0/24\": [\n        \"192.168.222.224\",\n      ]\n    }\n  }\n</code></pre>\n\n<p>to</p>\n\n<pre><code>  networks = {\n    \"CL1\": {\n      \"192.168.56.0/24\": [\n        \"192.168.56.57\",\n        \"192.168.56.84\",\n      ]\n    },\n    \"CL2\": {\n      \"192.168.222.0/24\": [\n        \"192.168.222.224\",\n      ]\n    }\n  }\n</code></pre>\n\n<p>Is it possible to remove key elements which have empty array?</p>\n"}, {"tags": ["ruby", "jsonpath"], "answers": [{"comments": [{"owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "edited": false, "score": 1, "creation_date": 1538697775, "post_id": 52627211, "comment_id": 92244254, "body": "Thank you @anquegi.  It is sort of surprising that the original version works at all - albeit inconsistently between JSONPath implementations."}], "tags": [], "owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "is_accepted": true, "score": 1, "last_activity_date": 1538570244, "creation_date": 1538570244, "answer_id": 52627211, "question_id": 52619375, "link": "https://stackoverflow.com/questions/52619375/my-jsonpath-expression-returns-two-results-when-i-expect-just-one/52627211#52627211", "title": "My jsonpath expression returns two results when I expect just one", "body": "<p>It  seems that the problem is the extra point, in your jsonpath expression without this works similar in the two behaviours, you only need to go down one step:</p>\n\n<pre><code>[1] pry(main)&gt; require 'jsonpath'\n=&gt; true\n[2] pry(main)&gt; jsonpath = \"$.[?(@.process=='XX')].processId\"\n=&gt; \"$.[?(@.process=='XX')].processId\"\n[3] pry(main)&gt; path = JsonPath.new(jsonpath)\n=&gt; #&lt;JsonPath:0x00007f8c5bf42f10\n @opts={},\n @path=[\"$\", \"[?(@.process=='XX')]\", \"['processId']\"]&gt;\n[4] pry(main)&gt; string = &lt;&lt;-HERE_DOC\n[4] pry(main)* [\n[4] pry(main)*     {\"processId\":1,\"process\":\"XX\"},\n[4] pry(main)*     {\"processId\":2,\"process\":\"YY\"}\n[4] pry(main)* ]\n[4] pry(main)* HERE_DOC\n=&gt; \"[\\n    {\\\"processId\\\":1,\\\"process\\\":\\\"XX\\\"},\\n    {\\\"processId\\\":2,\\\"process\\\":\\\"YY\\\"}\\n]\\n\"\n[5] pry(main)&gt; result = path.on(string)\n=&gt; [1]\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fWjva.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fWjva.png\" alt=\"jsonpath web example\"></a></p>\n"}], "owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 52627211, "answer_count": 1, "score": 0, "last_activity_date": 1538570244, "creation_date": 1538538155, "question_id": 52619375, "link": "https://stackoverflow.com/questions/52619375/my-jsonpath-expression-returns-two-results-when-i-expect-just-one", "title": "My jsonpath expression returns two results when I expect just one", "body": "<p>This piece of ruby code returns [1,1] but I expect to get just [1].  If I put the same text and jsonpath expression through <a href=\"http://jsonpath.com\" rel=\"nofollow noreferrer\">http://jsonpath.com</a> then I get [1]. Is this a bug in the 'jsonpath' gem?</p>\n\n<pre><code>require 'jsonpath'\n\nstring = &lt;&lt;-HERE_DOC\n[\n    {\"processId\":1,\"process\":\"XX\"},\n    {\"processId\":2,\"process\":\"YY\"}\n]\nHERE_DOC\njsonpath = \"$..[?(@.process=='XX')].processId\"\n\npath = JsonPath.new(jsonpath)\nresult = path.on(string)\nputs \"result: #{result}\"\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1538536014, "post_id": 52618934, "comment_id": 92172324, "body": "<a href=\"https://stackoverflow.com/questions/12648157/instance-evals-block-arguments-documented-purpose\">Same question</a>, though not really answered in my opinion"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1538631114, "post_id": 52618934, "comment_id": 92211606, "body": "It is not just for <code>instance_eval</code>. Other methods like <code>tap</code> (and <code>Thread.new</code>) work in the same way."}], "answers": [{"comments": [{"owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "edited": false, "score": 1, "creation_date": 1538534569, "post_id": 52618993, "comment_id": 92172013, "body": "yes I understand that... The question is why is there this extra parameter being passed from instance_eval... I can find it documented nowhere."}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "reply_to_user": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "edited": false, "score": 0, "creation_date": 1538534629, "post_id": 52618993, "comment_id": 92172026, "body": "@MitchVanDuyn, it is in documentation of <a href=\"https://ruby-doc.org/core-2.5.1/BasicObject.html#method-i-instance_eval\" rel=\"nofollow noreferrer\">instance_eval</a>"}, {"owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "edited": false, "score": 1, "creation_date": 1538534818, "post_id": 52618993, "comment_id": 92172064, "body": "Thanks... Answer accepted.   Still is most curious why ruby would do this.  Seeing as I have access to self inside the block, why add this complication."}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "reply_to_user": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "edited": false, "score": 0, "creation_date": 1538536193, "post_id": 52618993, "comment_id": 92172363, "body": "@MitchVanDuyn, because <code>instance_eval</code> was intended for use within instances, check updated answer."}, {"owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "edited": false, "score": 0, "creation_date": 1538646168, "post_id": 52618993, "comment_id": 92219451, "body": "I&#39;m not 100% satisfied but its seems this is a comprimise so that things like <code>each(&amp;:puts)</code> will work.  Its just unfortunate that instance_eval does not ask if the proc is a lambda (and if it is DONT add the extra param)"}, {"owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "edited": false, "score": 0, "creation_date": 1538647422, "post_id": 52618993, "comment_id": 92220201, "body": "just posted a detailed answer here on my theory of why here: <a href=\"https://stackoverflow.com/questions/12648157/instance-evals-block-arguments-documented-purpose/52643962#52643962\" title=\"instance evals block arguments documented purpose\">stackoverflow.com/questions/12648157/&hellip;</a>"}], "tags": [], "owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "is_accepted": true, "score": 3, "last_activity_date": 1538549314, "last_edit_date": 1538549314, "creation_date": 1538534492, "answer_id": 52618993, "question_id": 52618934, "link": "https://stackoverflow.com/questions/52618934/ruby-lambdas-procs-and-instance-eval/52618993#52618993", "title": "Ruby lambda&#39;s proc&#39;s and &#39;instance_eval&#39;", "body": "<p>From the docs</p>\n\n<blockquote>\n  <p>For procs created using lambda or ->() an error is generated if the\n  wrong number of parameters are passed to a Proc with multiple\n  parameters. For procs created using Proc.new or Kernel.proc, extra\n  parameters are silently discarded.</p>\n</blockquote>\n\n<p>In your case both <code>lamb</code> and <code>proc</code> called with one parameter</p>\n\n<p><a href=\"https://ruby-doc.org/core-2.5.1/BasicObject.html#method-i-instance_eval\" rel=\"nofollow noreferrer\">From the docs of instance_eval</a></p>\n\n<blockquote>\n  <p>When instance_eval is given a block, obj is also passed in as the\n  block's only argument</p>\n</blockquote>\n\n<p><code>instance_eval</code> is method of <code>BasicObject</code> class and can be called within instance. So given block will have access for private methods for example.</p>\n\n<pre><code>class Test\n  def call\n    secret_number + 100\n  end\n  private\n  def secret_number\n    42\n  end\nend\n\ntest = Test.new\nshow_secret = -&gt; (obj) { puts secret_number }\n\ntest.instance_eval(&amp;show_secret) # print 42\n</code></pre>\n\n<p>Without instance <code>self</code> of current context will be passed as an argument. I think <code>instance_eval</code> was designed more for calling it within objects.</p>\n\n<p><a href=\"https://ruby-doc.org/core-2.5.1/BasicObject.html#method-i-instance_eval\" rel=\"nofollow noreferrer\">From the docs of instance_eval</a></p>\n\n<blockquote>\n  <p>In order to set the context, the variable self is set to obj while the\n  code is executing, giving the code access to obj's instance variables\n  and private methods.</p>\n</blockquote>\n"}], "owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 52618993, "answer_count": 1, "score": 2, "last_activity_date": 1538630450, "creation_date": 1538534050, "last_edit_date": 1538630450, "question_id": 52618934, "link": "https://stackoverflow.com/questions/52618934/ruby-lambdas-procs-and-instance-eval", "title": "Ruby lambda&#39;s proc&#39;s and &#39;instance_eval&#39;", "body": "<p>When I pass a lambda to <code>instance_eval</code> as the block, it seems to pass an extra argument:</p>\n\n<pre><code>lamb = -&gt; { puts 'hi' }\nproc = Proc.new { puts 'hi' }\ninstance_eval(&amp;lamb)\n# &gt;&gt; ArgumentError: wrong number of arguments (given 1, expected 0)\n#    from (irb):5:in `block in irb_binding'\n#    from (irb):7:in `instance_eval'\ninstance_eval(&amp;proc)\n# =&gt; hi\ninstance_exec(&amp;lamb)\n# =&gt; hi\n</code></pre>\n\n<p>Why is this the case? Note that this question is NOT about why lambda throws an error. That is well understood. The question is about WHY <code>instance_eval</code> sends <code>self</code> of the receiver as a parameter. It is not needed, and confusing. And AFAIK not documented.</p>\n\n<p><a href=\"https://www.saturnflyer.com/blog/the-difference-between-instanceeval-and-instanceexec\" rel=\"nofollow noreferrer\">This</a> helps, but doesn't explain WHY ruby would do it this way. The whole point of <code>instance_eval</code> is to set <code>self</code> to the receiver; why confuse things by also passing <code>self</code> to the proc?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10008716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7NWGSSan85U/AAAAAAAAAAI/AAAAAAAAAOc/KG4eIedeVOM/photo.jpg?sz=128", "display_name": "Karthikraj", "link": "https://stackoverflow.com/users/10008716/karthikraj"}, "edited": false, "score": 0, "creation_date": 1538537057, "post_id": 52618858, "comment_id": 92172549, "body": "I tried <code>data_hash = JSON.parse(value) puts data_hash.keys</code> but getting below error  <code>script:8:in </code>&lt;main&gt;&#39;: <code>undefined method</code> <code>keys&#39; for #&lt;Array:0x007ff52a965510&gt; (NoMethodError)</code>"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 7, "user_id": 10008716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7NWGSSan85U/AAAAAAAAAAI/AAAAAAAAAOc/KG4eIedeVOM/photo.jpg?sz=128", "display_name": "Karthikraj", "link": "https://stackoverflow.com/users/10008716/karthikraj"}, "edited": false, "score": 0, "creation_date": 1538537266, "post_id": 52618858, "comment_id": 92172596, "body": "Yes, you have an array of hashes, not a hash. If you want first &quot;created_at&quot;, you can simply call <code>JSON.parse(value).first[&quot;created_at&quot;]</code>. If you want all <code>created_at</code>, you can call <code>JSON.parse(value).map {|h| h[&quot;created_at&quot;] }</code>. You will need to learn how to work with arrays and hashes in ruby."}, {"owner": {"reputation": 7, "user_id": 10008716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7NWGSSan85U/AAAAAAAAAAI/AAAAAAAAAOc/KG4eIedeVOM/photo.jpg?sz=128", "display_name": "Karthikraj", "link": "https://stackoverflow.com/users/10008716/karthikraj"}, "edited": false, "score": 0, "creation_date": 1538537642, "post_id": 52618858, "comment_id": 92172672, "body": "I am getting the output now , Thank you so much . will do the work on arrays and hashes , between please suggest good articles for arrays of hashes if any please"}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 1, "last_activity_date": 1538533377, "creation_date": 1538533377, "answer_id": 52618858, "question_id": 52618840, "link": "https://stackoverflow.com/questions/52618840/parse-api-output-in-ruby/52618858#52618858", "title": "Parse API output in ruby", "body": "<p>It's JSON. Since you're using Rails, it will be sufficient to call</p>\n\n<pre><code>JSON.parse(value)\n</code></pre>\n\n<p>This will return an array of multiple hashes which you will be able to further map.</p>\n"}], "owner": {"reputation": 7, "user_id": 10008716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7NWGSSan85U/AAAAAAAAAAI/AAAAAAAAAOc/KG4eIedeVOM/photo.jpg?sz=128", "display_name": "Karthikraj", "link": "https://stackoverflow.com/users/10008716/karthikraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "closed_date": 1538538367, "accepted_answer_id": 52618858, "answer_count": 1, "score": 0, "last_activity_date": 1538533377, "creation_date": 1538533267, "question_id": 52618840, "link": "https://stackoverflow.com/questions/52618840/parse-api-output-in-ruby", "closed_reason": "Duplicate", "title": "Parse API output in ruby", "body": "<p>Apologies if it is very basic one , completely new to ruby.</p>\n\n<p>Below is the sample response I am getting while using the curl , need to get the values of <code>body</code> , <code>created_at</code> from the below output . </p>\n\n<p>When I tried to check type of the value , puts returns <code>true</code> for (string) and <code>false</code> for hash and array</p>\n\n<pre><code>`#puts value.is_a?(Hash)\n#puts value.is_a?(Array)\n#puts value.is_a?(String)`\n</code></pre>\n\n<p>Not sure how to get value from the below output , Please help on with the first step/idea need to do  here , will try on and revert back on getting any issues further</p>\n\n<p>SAMPLE CALL\n     <code>curl https://api.statuspage.io/v1/pages/qfn30z5r6s5h/incidents.json \\\n        -H \"Authorization: OAuth 2a7b9d4aac30956d537ac76850f4d78de30994703680056cc103862d53cf8074\"</code> </p>\n\n<pre><code>SAMPLE RESPONSE\n  [\n    {\n      \"created_at\": \"2013-04-21T11:45:33-06:00\",\n      \"id\": \"tks5n8x7w24h\",\n      \"impact\": \"none\",\n      \"impact_override\": null,\n      \"incident_updates\": [\n        {\n          \"body\": \"We will be performing a data layer migration from our existing Postgres system over to our new, multi-region, distributed Riak cluster. The application will be taken offline during the entirety of this migration. We apologize in advance for the inconvenience\",\n          \"created_at\": \"2013-04-21T11:45:33-06:00\",\n          \"display_at\": \"2013-04-21T11:45:33-06:00\",\n          \"id\": \"kb4fpktpqm0l\",\n          \"incident_id\": \"tks5n8x7w24h\",\n          \"status\": \"scheduled\",\n          \"twitter_updated_at\": null,\n          \"updated_at\": \"2013-04-21T11:45:33-06:00\",\n          \"wants_twitter_update\": false,\n          \"affected_components\": [\n            {\n              \"code\": \"ftgks51sfs2d\",\n              \"name\": \"API\",\n              \"old_status\": \"operational\",\n              \"new_status\": \"operational\"\n            }\n          ]\n        }\n      ],\n      \"metadata\": [\n        \"jira\": {\n          \"issue_id\": \"value\"\n        }\n      ],\n      \"monitoring_at\": null,\n      \"name\": \"Data Layer Migration\",\n      \"page_id\": \"jcm87b8scw0b\",\n      \"postmortem_body\": null,\n      \"postmortem_body_last_updated_at\": null,\n      \"postmortem_ignored\": true,\n      \"postmortem_notified_subscribers\": false,\n      \"postmortem_notified_twitter\": false,\n      \"postmortem_published_at\": null,\n      \"resolved_at\": null,\n      \"scheduled_auto_in_progress\": false,\n      \"scheduled_auto_completed\": false,\n      \"scheduled_for\": \"2013-05-04T01:00:00-06:00\",\n      \"scheduled_remind_prior\": false,\n      \"scheduled_reminded_at\": null,\n      \"scheduled_until\": \"2013-05-04T03:00:00-06:00\",\n      \"shortlink\": \"\",\n      \"status\": \"scheduled\",\n      \"updated_at\": \"2013-04-21T11:45:33-06:00\"\n    },\n    {\n      \"created_at\": \"2013-04-21T11:04:28-06:00\",\n      \"id\": \"cz46ym8qbvwv\",\n      \"impact\": \"critical\",\n      \"impact_override\": null,\n      \"incident_updates\": [\n        {\n          \"body\": \"A postmortem analysis has been posted for this incident.\",\n          \"created_at\": \"2013-04-21T11:42:31-06:00\",\n          \"display_at\": \"2013-04-21T11:42:31-06:00\",\n          \"id\": \"dn051mnj579k\",\n          \"incident_id\": \"cz46ym8qbvwv\",\n          \"status\": \"postmortem\",\n          \"twitter_updated_at\": null,\n          \"updated_at\": \"2013-04-21T11:42:31-06:00\",\n          \"wants_twitter_update\": false\n        },\n        {\n          \"body\": \"The application has returned to it's normal performance profile. We will be following up with a postmortem about future plans to guard against additional master database failure.\",\n          \"created_at\": \"2013-04-21T11:16:38-06:00\",\n          \"display_at\": \"2013-04-21T14:07:00-06:00\",\n          \"id\": \"ppdqv1grhm64\",\n          \"incident_id\": \"cz46ym8qbvwv\",\n          \"status\": \"resolved\",\n          \"twitter_updated_at\": null,\n          \"updated_at\": \"2013-04-21T11:36:15-06:00\",\n          \"wants_twitter_update\": false,\n          \"affected_components\": [\n            {\n              \"code\": \"ftgks51sfs2d\",\n              \"name\": \"API\",\n              \"old_status\": \"degraded_performance\",\n              \"new_status\": \"operational\"\n            }\n          ]\n        },\n        {\n          \"body\": \"The slave database has been successfully promoted, but is running slow due to a cold query cache. The application is open and available for requests, but should will be performing in a degraded state for the next few hours. We will continue to monitor the situation.\",\n          \"created_at\": \"2013-04-21T11:14:46-06:00\",\n          \"display_at\": \"2013-04-21T11:14:46-06:00\",\n          \"id\": \"j7ql87ktwnys\",\n          \"incident_id\": \"cz46ym8qbvwv\",\n          \"status\": \"monitoring\",\n          \"twitter_updated_at\": null,\n          \"updated_at\": \"2013-04-21T11:14:46-06:00\",\n          \"wants_twitter_update\": false,\n          \"affected_components\": [\n            {\n              \"code\": \"ftgks51sfs2d\",\n              \"name\": \"API\",\n              \"old_status\": \"major_outage\",\n              \"new_status\": \"degraded_performance\"\n            }\n          ]\n        },\n        {\n          \"body\": \"The slave database is 60% through it's recovery process. We will provide another update once the application is back up.\",\n          \"created_at\": \"2013-04-21T11:08:42-06:00\",\n          \"display_at\": \"2013-04-21T11:08:42-06:00\",\n          \"id\": \"xzgd3y9zdzt9\",\n          \"incident_id\": \"cz46ym8qbvwv\",\n          \"status\": \"identified\",\n          \"twitter_updated_at\": null,\n          \"updated_at\": \"2013-04-21T11:08:42-06:00\",\n          \"wants_twitter_update\": false,\n          \"affected_components\": [\n            {\n              \"code\": \"ftgks51sfs2d\",\n              \"name\": \"API\",\n              \"old_status\": \"major_outage\",\n              \"new_status\": \"major_outage\"\n            }\n          ]\n        },\n        {\n          \"body\": \"The master database server could not boot due to a corrupted EBS volume. We are in the process of failing over to the slave database. ETA for the application recovering is 5 minutes.\",\n          \"created_at\": \"2013-04-21T11:06:27-06:00\",\n          \"display_at\": \"2013-04-21T11:06:27-06:00\",\n          \"id\": \"9307nsfg3dxd\",\n          \"incident_id\": \"cz46ym8qbvwv\",\n          \"status\": \"identified\",\n          \"twitter_updated_at\": null,\n          \"updated_at\": \"2013-04-21T11:06:27-06:00\",\n          \"wants_twitter_update\": false,\n          \"affected_components\": [\n            {\n              \"code\": \"ftgks51sfs2d\",\n              \"name\": \"API\",\n              \"old_status\": \"major_outage\",\n              \"new_status\": \"major_outage\"\n            }\n          ]\n        },\n        {\n          \"body\": \"We're investigating an outage with our master database server.\",\n          \"created_at\": \"2013-04-21T11:04:28-06:00\",\n          \"display_at\": \"2013-04-21T11:04:28-06:00\",\n          \"id\": \"dz959yz2nd4l\",\n          \"incident_id\": \"cz46ym8qbvwv\",\n          \"status\": \"investigating\",\n          \"twitter_updated_at\": null,\n          \"updated_at\": \"2013-04-21T11:04:29-06:00\",\n          \"wants_twitter_update\": false,\n          \"affected_components\": [\n            {\n              \"code\": \"ftgks51sfs2d\",\n              \"name\": \"API\",\n              \"old_status\": \"operational\",\n              \"new_status\": \"major_outage\"\n            }\n          ]\n        }\n      ],\n      \"metadata\": [\n        \"jira\": {\n          \"issue_id\": \"value\"\n        }\n      ],\n      \"monitoring_at\": \"2013-04-21T11:14:46-06:00\",\n      \"name\": \"Master Database Failure\",\n      \"page_id\": \"jcm87b8scw0b\",\n      \"postmortem_body\": \"##### Issue\\r\\n\\r\\nAt approximately 17:02 UTC on 2013-04-21, our master database server unexpectedly went unresponsive to all network traffic. A reboot of the machine at 17:05 UTC resulted in a failed mount of a corrupted EBS volume, and we made the decision at that time to fail over the slave database.\\r\\n\\r\\n##### Resolution\\r\\n\\r\\nAt 17:12 UTC, the slave database had been successfully promoted to master and the application recovered enough to accept web traffic again. A new slave database node was created and placed into the rotation to guard against future master failures. The promoted slave database performed slowly for the next couple of hours as the query cache began to warm up, and eventually settled into a reasonable performance profile around 20:00 UTC.\\r\\n\\r\\n##### Future Mitigation Plans\\r\\n\\r\\nOver the past few months, we've been working on an overhaul to our data storage layer with a migration from a Postgres setup to a distributed, fault-tolerant, multi-region data layer using Riak. This initiative has been prioritized, and the migration will be performed in the coming weeks. We will notify our clients of the scheduled downtime via an incident on this status site, and via a blog post.\",\n      \"postmortem_body_last_updated_at\": \"2013-04-21T17:41:00Z\",\n      \"postmortem_ignored\": false,\n      \"postmortem_notified_subscribers\": false,\n      \"postmortem_notified_twitter\": false,\n      \"postmortem_published_at\": \"2013-04-21T17:42:31Z\",\n      \"resolved_at\": \"2013-04-21T14:07:00-06:00\",\n      \"scheduled_auto_in_progress\": false,\n      \"scheduled_auto_completed\": false,\n      \"scheduled_for\": null,\n      \"scheduled_remind_prior\": false,\n      \"scheduled_reminded_at\": null,\n      \"scheduled_until\": null,\n      \"shortlink\": \"\",\n      \"status\": \"postmortem\",\n      \"updated_at\": \"2013-04-21T11:42:31-06:00\"\n    },\n    {\n      \"created_at\": \"2013-04-01T12:00:00-06:00\",\n      \"id\": \"2ggpd60zvx3c\",\n      \"impact\": \"none\",\n      \"impact_override\": null,\n      \"incident_updates\": [\n        {\n          \"body\": \"At approximately 6:55 PM, our network provider at ServerCo experienced a brief network outage at their New Jersey data center. The network outage lasted approximately 14 minutes, and all web requests during that time were not received. No data was lost, and the system recovered once the network outage at ServerCo was repaired.\",\n          \"created_at\": \"2013-04-21T11:02:00-06:00\",\n          \"display_at\": \"2013-04-21T11:02:00-06:00\",\n          \"id\": \"mkfzp9swbk4z\",\n          \"incident_id\": \"2ggpd60zvx3c\",\n          \"status\": \"investigating\",\n          \"twitter_updated_at\": null,\n          \"updated_at\": \"2013-04-21T11:02:00-06:00\",\n          \"wants_twitter_update\": false\n        }\n      ],\n      \"metadata\": [\n        \"jira\": {\n          \"issue_id\": \"value\"\n        }\n      ],\n      \"monitoring_at\": null,\n      \"name\": \"Brief Network Outage\",\n      \"page_id\": \"jcm87b8scw0b\",\n      \"postmortem_body\": null,\n      \"postmortem_body_last_updated_at\": null,\n      \"postmortem_ignored\": false,\n      \"postmortem_notified_subscribers\": false,\n      \"postmortem_notified_twitter\": false,\n      \"postmortem_published_at\": null,\n      \"resolved_at\": null,\n      \"scheduled_auto_in_progress\": false,\n      \"scheduled_auto_completed\": false,\n      \"scheduled_for\": null,\n      \"scheduled_remind_prior\": false,\n      \"scheduled_reminded_at\": null,\n      \"scheduled_until\": null,\n      \"shortlink\": \"\",\n      \"status\": \"resolved\",\n      \"updated_at\": \"2013-04-01T12:00:00-06:00\"\n    }\n  ]\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "mutation-testing"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1538575115, "post_id": 52618527, "comment_id": 92190961, "body": "what are you asking us for here?"}, {"owner": {"reputation": 1, "user_id": 10448864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b115987bae3f60a959ca5a9382edf69?s=128&d=identicon&r=PG&f=1", "display_name": "Slopes95", "link": "https://stackoverflow.com/users/10448864/slopes95"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1538577177, "post_id": 52618527, "comment_id": 92192259, "body": "Sorry I should&#39;ve been more clear. I&#39;m trying to create a test suite that properly tests the cipher code and am using mutation testing to &#39;test&#39; the quality of said suite. In order to have a good quality testing suite I&#39;ve read that it should kill as many mutants as possible, however I&#39;m only killing 3 out of 343. I&#39;m basically asking for any suggestions on how I can improve my tests."}, {"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1538736018, "post_id": 52618527, "comment_id": 92257408, "body": "Hi there. I still don&#39;t understand the question, what do you mean by 3/343. It&#39;s best to update you question."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 3751739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc4c089085cb7a88faf57761c63b9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Rene Just", "link": "https://stackoverflow.com/users/3751739/rene-just"}, "is_accepted": false, "score": 0, "last_activity_date": 1538750968, "creation_date": 1538750968, "answer_id": 52668246, "question_id": 52618527, "link": "https://stackoverflow.com/questions/52618527/mutation-testing-with-rspec/52668246#52668246", "title": "Mutation Testing with Rspec", "body": "<p>Since your goal is to develop a mutation-adequate test suite, the unkilled mutants essentially provide guidance for what to test for. Ideally, your question should have provided some examples for generated mutants that are not killed by your test suite so that others can comment on how to write tests that kill them. </p>\n\n<p>Let me try to best answer your question with general recommendations and examples.\nI am not familiar with the particular mutation testing tool you are using, but in general you should follow a process similar to the following*:</p>\n\n<ol>\n<li><p>Select a mutant that is not killed by your test suite and determine whether it can be killed (a mutant might be semantically equivalent to your program -- if so, discard it from the pool of mutants).</p></li>\n<li><p>Write a test that kills the selected mutant -- that is, write a test that passes on your original program but fails on the mutant.</p>\n\n<ul>\n<li>Determine suitable inputs that trigger the faulty behavior, introduced by the mutant.</li>\n<li>Determine a suitable test oracle that asserts on the expected behavior/output of your program (i.e., a test oracle that passes on your original program but fails on the mutant).</li>\n</ul></li>\n</ol>\n\n<p>Please keep in mind that your goal should <em>not</em> be to write minimal tests that simply kill all mutants, but rather tests that make sense in the context of your project and as a byproduct kill the mutants. Again, if you could provide some concrete examples for mutants that your test suite does not kill, I and others can better comment on what tests are missing.</p>\n\n<p><em>Example:</em> Suppose you have a mutant that introduces the following fault (i.e., changes the relational operator in the if statement of your original program):\n<code>\n- if cipher_letter &gt; @z_offset\n+ if cipher_letter &gt;= @z_offset\n</code>\nKilling this mutant requires a test that checks for the boundary condition -- that is, a test that encodes at least one character to a 'Z'. Your current test suite does not have such a test.</p>\n\n<p>*This process describes traditional mutation testing. Recent research <a href=\"https://homes.cs.washington.edu/~rjust/publ/industrial_mutation_icst_2018.pdf\" rel=\"nofollow noreferrer\">[1]</a>, <a href=\"https://ai.google/research/pubs/pub46584\" rel=\"nofollow noreferrer\">[2]</a> suggests that (1) not all killable mutants should be killed (some mutants elicit tests that simply don't make sense) and (2) equivalent mutants may indicate a problem in your program (e.g., unwanted redundancy or ambiguity) that you might want to fix instead of discarding the equivalent mutant.</p>\n"}], "owner": {"reputation": 1, "user_id": 10448864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b115987bae3f60a959ca5a9382edf69?s=128&d=identicon&r=PG&f=1", "display_name": "Slopes95", "link": "https://stackoverflow.com/users/10448864/slopes95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538750968, "creation_date": 1538530440, "last_edit_date": 1538531702, "question_id": 52618527, "link": "https://stackoverflow.com/questions/52618527/mutation-testing-with-rspec", "title": "Mutation Testing with Rspec", "body": "<p>I'm attempting to perform a mutation-test on some ruby code using rspec. I am just learning ruby and I don't really know if I'm doing it right. Part of the code I'm trying to test is:</p>\n\n<pre><code>class Cipher\n\n def initialize()\n  @a_offset = 65 #'A'.unpack('C').first\n  @z_offset = 90 #'Z'.unpack('C').first\n end\n\n def encode(key, plain_text)\n  key_offset = key.upcase.unpack('C').first\n\n  cipher_text = plain_text.upcase.split('').collect do |letter| \n   cipher_letter = (letter.unpack('C').first + key_offset - @a_offset)\n   if cipher_letter &gt; @z_offset\n    cipher_letter -= ( @z_offset - @a_offset + 1 )\n   end\n   cipher_letter.chr\n end\n\n return cipher_text.join\nend\n</code></pre>\n\n<p>So far my test suite looks like this: </p>\n\n<pre><code>require 'rspec'\nrequire 'Cipher'\n\ndescribe \"#initialize\" do \n   it \"should have correct @a_offset\" do\n     encoder = Cipher.new()\n     expect(encoder.instance_variable_get(:@a_offset)).to eq 65\n   end \n\n   it \"should have correct @z_offset\" do\n     encoder = Cipher.new()\n     expect(encoder.instance_variable_get(:@z_offset)).to eq 90\n   end\n end \n\ndescribe \"#encode\" do\n   it \"It should correctly encode Caesar with key = A\"do\n     encoder = Cipher.new()\n     expect(encoder.encode('R', 'CAESAR')).to eq (\"TRVJRI\")\n   end \nend\n</code></pre>\n\n<p>When running rspec my 3 tests pass. However when I use mutation testing on this suite I only kill 3/343 which is not very good.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 947, "user_id": 1730761, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/WlcFp.jpg?s=128&g=1", "display_name": "yeuem1vannam", "link": "https://stackoverflow.com/users/1730761/yeuem1vannam"}, "edited": false, "score": 5, "creation_date": 1538532105, "post_id": 52618503, "comment_id": 92171515, "body": "It is better to include some logs that explain about <code>still can&#39;t get it to work</code>. Your code looks good, so I guess that you mean cannot receive the email at <code>admin@thecompany.com</code>   It is simply that you can go into the <code>rails console</code> then <code>visitor = Visitor.new; NotifierMailer.visitor_info(visitor).deliver_now</code> and see the logs of ActionMailer print out. I believe that your trouble just comes from a wrong configuration of ActionMailer."}, {"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1538735812, "post_id": 52618503, "comment_id": 92257286, "body": "Please be more specific, as &quot;it doesn&#39;t work&quot;, it&#39;s hard to help otherwise. Where does it fail, what do the logs say, have you made sure, mails are sent somewhere in your development environment?"}, {"owner": {"reputation": 37, "user_id": 9592597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3591f8c4fa499ef89e07d20f5ac37a?s=128&d=identicon&r=PG&f=1", "display_name": "KAYJAY", "link": "https://stackoverflow.com/users/9592597/kayjay"}, "edited": false, "score": 0, "creation_date": 1539034871, "post_id": 52618503, "comment_id": 92347142, "body": "Thanks. yeuem1vannam suggestion worked."}], "owner": {"reputation": 37, "user_id": 9592597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3591f8c4fa499ef89e07d20f5ac37a?s=128&d=identicon&r=PG&f=1", "display_name": "KAYJAY", "link": "https://stackoverflow.com/users/9592597/kayjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1538530264, "creation_date": 1538530264, "question_id": 52618503, "link": "https://stackoverflow.com/questions/52618503/send-email-in-a-rails-app-without-using-a-database-model", "title": "Send Email in a Rails App Without using a Database Model", "body": "<p>I am relatively new to Rails. I have created a simple app, using Ruby 2.5 &amp; Rails 5.2, that will send an email to an admin when a website visitor requests some information. The app does not use a database, because none of the visitor's information is to be saved or stored, therefore ActiveRecord is not used. Just need to get some information from the visitor via a form and email it. Research suggests using ActiveModel instead but I still can't get it to work. No 3rd party mailing apps needed. What am I overlooking? Model, Controller, Views, Mailer code appear below.</p>\n\n<pre><code>    #Model: Visitor.rb\n    class Visitor\n        include ActiveModel::Model\n        include ActiveModel::Conversion\n        extend ActiveModel::Naming\n        include ActiveModel::Validations\n\n        attr_accessor :fname, :lname, :phone, :email, :interest\n\n        # Validations &amp; Requirements\n        validates :fname, presence: true, length: { maximum: 50 }\n        validates :lname, presence: true, length: { maximum: 50 }\n        validates :lname, presence: true, length: { maximum: 50 }\n        VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i\n        validates :email, presence: true, length: { maximum: 255 }, format: { with: VALID_EMAIL_REGEX }\n        validates :interest, presence: true\n\n        def initialize(fname, lname, phone, email, interest)\n            @fname = fname\n            @lname = lname\n            @phone = phone\n            @email = email\n            @interest = interest\n\n            post_initialize\n       end\n\n       # #make in lieu of #create\n       def self.make(fname, lname, phone, email, interest)\n           attributes = {fname: fname, lname: lname, phone: phone, email: email, interest: interest}\n           object = new(attributes)\n           object.save\n           @visitor = object\n           @visitor\n       end\n\n      def persisted?\n          false\n      end\n\n      def send_mail\n          # Following method defined in NotifierMailer\n          NotifierMailer.visitor_info(self).deliver_now\n      end\n\n\n      private\n\n      def post_initialize\n          if email\n              email.downcase\n          end\n      end\n    end\n\n    # Controller: Visitors_controller.rb\n    class VisitorsController &lt; ApplicationController\n\n        def new\n            @Visitor = Visitor.new\n        end\n\n       def make\n           @visitor = Visitor.new(visitor_params)\n           if @visitor.valid?\n               @visitor.send_mail # Instance method in Guest model\n               flash[:notice] = \"Your request has been sent! Thank you for contacting us.\"\n               redirect_to welcome_path\n           else\n               render 'new'\n           end\n       end\n\n       private\n\n       def visitor_params\n           params.require(:visitor).permit(:fname, :lname, :phone, :email, :interest)\n       end\n    end\n\n    # Routes: Routes.rb\n    Rails.application.routes.draw do\n        get 'favicon', to: 'pages#favicon'\n\n        root to: 'pages#index', as: 'welcome'\n\n        # ... other routes for static page navigation\n\n        get '/reqinfo', to: 'visitors#new'\n\n        post '/reqinfo', to: 'visitors#make'\n    end\n\n    # View: New.html.erb\n    &lt;div class=\"row\"&gt;\n        &lt;div class=\"col-md-6 col-md-offset-3\"&gt;\n\n            &lt;%= form_with model: @visitor, url: reqinfo_path, local: true do |form| %&gt;\n                &lt;%= render 'layouts/error_messages', object: form.object %&gt;\n                &lt;%= form.label 'First Name' %&gt;\n                &lt;%= form.text_field :fname, class: 'form-control' %&gt;\n                &lt;%= form.label 'Last Name' %&gt;\n                &lt;%= form.text_field :lname, class: 'form-control' %&gt;\n                &lt;%= form.label :phone %&gt;\n                &lt;%= form.text_field :phone, class: 'form-control' %&gt;\n                &lt;%= form.label 'Email Address' %&gt;\n                &lt;%= form.text_field :email, class: 'form-control' %&gt;\n                &lt;%= form.label 'Interest' %&gt;\n                &lt;%= form.text_field :interest, class 'form-control' %&gt;\n                &lt;%= form.submit 'Submit', id: \"button\" %&gt;\n            &lt;% end %&gt;&lt;!-- form_with --&gt;\n        &lt;/div&gt;&lt;!-- col-md6-3 --&gt;\n    &lt;/div&gt;&lt;!-- row --&gt;\n\n     # Mailer: Notifier_mailer.rb\n     class NotifierMailer &lt; ApplicationMailer\n         default from: 'noreply@thecompany.com'\n         def guest_info(visitor)\n             @visitor = visitor\n             mail(to: 'admin@thecompany.com', subject: \"Website Visitors Request for Information\")\n        end\n     end\n\n     # Message: Visitor_info.html.erb\n     &lt;h1&gt;Dear Admin;&lt;/h1&gt;\n     &lt;br&gt;\n     &lt;% timestamp = Time.now %&gt;\n     &lt;p&gt;\n         &lt;%= visitor.fname %&gt; &lt;%= @visitor.lname %&gt; visited the TheCompany website on &lt;%= timestamp.localtime %&gt;. He/she is requesting information regarding a &lt;%= @visitor.interest %&gt;. Their contact information phone: &lt;%= @visitor.phone %&gt; and email: &lt;%= @visitor.email %&gt;\n     &lt;/p&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538529917, "post_id": 52618447, "comment_id": 92171009, "body": "Is that being generated by some kind of test harness? It looks like a unit test failure."}, {"owner": {"reputation": 138, "user_id": 10013290, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OJdm_xmOTQ4/AAAAAAAAAAI/AAAAAAAAAb8/CfK9VdvijTs/photo.jpg?sz=128", "display_name": "Austin Burke", "link": "https://stackoverflow.com/users/10013290/austin-burke"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538529945, "post_id": 52618447, "comment_id": 92171014, "body": "Correct @tadman I just can&#39;t figure out what it means. Why would it think that &#39;&gt;&#39; is attempting to define a method?"}, {"owner": {"reputation": 138, "user_id": 10013290, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OJdm_xmOTQ4/AAAAAAAAAAI/AAAAAAAAAb8/CfK9VdvijTs/photo.jpg?sz=128", "display_name": "Austin Burke", "link": "https://stackoverflow.com/users/10013290/austin-burke"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538530089, "post_id": 52618447, "comment_id": 92171052, "body": "Thanks @tadman ! That helps loads. How can I close this question?"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538542939, "post_id": 52618488, "comment_id": 92173749, "body": "Don&#39;t you mean <code>return nil if name_hash.empty?</code>? Maybe <code>each_key</code> rather than <code>keys</code> to avoid the construction of a temporary array."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538582769, "post_id": 52618488, "comment_id": 92195928, "body": "@CarySwoveland <code>return if x</code> and <code>return nil if x</code> are identical. The only reason <code>keys</code> is called is because the unit test seems to require it, otherwise you&#39;re right, <code>each_key</code> could work."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538584282, "post_id": 52618488, "comment_id": 92196726, "body": "We know that <code>name_hash</code> is a hash (truthy). At issue is whether it&#39;s empty. The OP has written <code>if name_hash == nil</code> which, according to the verbal description of the problem, should be <code>if name_hash.empty?</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538585108, "post_id": 52618488, "comment_id": 92197110, "body": "@CarySwoveland The rest of the code doesn&#39;t care if the hash is empty or not, but calling <code>.keys</code> on <code>nil</code> is going to fail so it needs that guard condition. I&#39;m just adapting the original code."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538587012, "post_id": 52618488, "comment_id": 92198082, "body": "Good point about &quot;The rest of the code doesn&#39;t care if the hash is empty or not&quot;, so <code>return nil if name_hash.empty?</code> is not needed. However, if <code>nil</code> is passed to the method we certainly don&#39;t want to return <code>nil</code> as that indicates that an empty hash was passed. The statement of the question makes it clear that a hash is being passed to the method, so if we want to confirm that we need a first line that raises an exception if the argument is not a hash. I suspect that the OP has confused <code>name_hash == nil</code> with <code>name_hash.empty?</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538587443, "post_id": 52618488, "comment_id": 92198309, "body": "@CarySwoveland All good points. Not sure what the intent is, though sometimes it&#39;s valid to be a bit &quot;defensive&quot; when receiving no arguments. Crashing can be a good result, it can show bugs, but it can also be a huge problem in user-facing systems when handling irregular input. &quot;Do the best you can&quot; is sometimes better than &quot;explode&quot;."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 4, "last_activity_date": 1538530132, "creation_date": 1538530132, "answer_id": 52618488, "question_id": 52618447, "link": "https://stackoverflow.com/questions/52618447/cant-figure-out-what-the-error-is-with-this-method/52618488#52618488", "title": "Can&#39;t figure out what the error is with this method?", "body": "<p>You can't compare <code>nil</code> to anything using <code>&gt;</code>, it's not allowed, so you either have to avoid that test or use tools like <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-min_by\" rel=\"nofollow noreferrer\"><code>min_by</code></a> to get the right value instead of this <code>collect</code> approach.</p>\n\n<p>One way to make your unit test happy might be:</p>\n\n<pre><code>def key_for_min_value(name_hash)\n  return unless (name_hash)\n\n  name_hash.keys.min_by do |key|\n    name_hash[key]\n  end\nend\n</code></pre>\n\n<p>Ruby leans very heavily on the <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html\" rel=\"nofollow noreferrer\">Enumerable</a> library, there's a tool in there for nearly every job, so when you have some free time have a look around there, lots of things to discover.</p>\n\n<p>Now Ruby is very strict about comparisons, and in particular a <code>nil</code> value can't be \"compared\" (e.g. <code>&gt;</code> or <code>&lt;</code> and such) to other values. You'll need to populate that minimum with the first value by default, not <code>nil</code>, then the comparisons work out, but doing that completely is pretty ugly:</p>\n\n<pre><code>def key_for_min_value(name_hash)\n  return unless (name_hash)\n\n  min_key, min_value = name_hash.first\n\n  name_hash.each do |key, value|\n    next unless (value &lt; min_value)\n\n    min_key = key\n    min_value = value\n  end\n\n  min_key\nend\n</code></pre>\n\n<p>So that approach is really not worth it. Enumerable makes it <em>way</em> easier and as a bonus your intent is clear. One thing you'll come to appreciate is that in Ruby if your code looks like <em>code</em> then you're probably going about it the wrong way, over-complicating things.</p>\n\n<p>Ruby is an unusually expressive language, and often there's a very minimal form to express just about anything.</p>\n"}], "owner": {"reputation": 138, "user_id": 10013290, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OJdm_xmOTQ4/AAAAAAAAAAI/AAAAAAAAAb8/CfK9VdvijTs/photo.jpg?sz=128", "display_name": "Austin Burke", "link": "https://stackoverflow.com/users/10013290/austin-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1538530132, "creation_date": 1538529818, "last_edit_date": 1538529878, "question_id": 52618447, "link": "https://stackoverflow.com/questions/52618447/cant-figure-out-what-the-error-is-with-this-method", "title": "Can&#39;t figure out what the error is with this method?", "body": "<p>I'm passing a hash to this function that either a) has keys that are strings along with values that are ints OR b) it is an empty hash. \nThe point of the function is to return nil if the hash is empty and return the key associated with the lowest int. </p>\n\n<pre><code>def key_for_min_value(name_hash)\n  if name_hash == nil\n    return nil \n  else\n   lowest_value = nil\n   lowest_value_name = nil\n  name_hash.collect do |name, value|\n    if lowest_value &gt; value \n      lowest_value = value\n      lowest_value_name = name\n    end\n  end\n  return lowest_value_name\n end\nend\n</code></pre>\n\n<p>The error I'm receiving is:</p>\n\n<pre><code>1) smallest hash value does not call the `#keys` method\n\n Failure/Error: key_for_min_value(hash)\n\n NoMethodError:\n   undefined method `&gt;' for nil:NilClass`\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "locking", "factory-bot"], "answers": [{"comments": [{"owner": {"reputation": 12085, "user_id": 632688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c6e4e8117bbd27fd25e9e2ea350458?s=128&d=identicon&r=PG", "display_name": "Wizard of Ogz", "link": "https://stackoverflow.com/users/632688/wizard-of-ogz"}, "edited": false, "score": 1, "creation_date": 1538537835, "post_id": 52617862, "comment_id": 92172706, "body": "In addition I&#39;d like to say that the order of your tests should not matter. Always build your tests to be independent of each other."}], "tags": [], "owner": {"reputation": 14663, "user_id": 343679, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e65e5b1cd213c3b9c72f2680257d6eaf?s=128&d=identicon&r=PG&f=1", "display_name": "Sharj", "link": "https://stackoverflow.com/users/343679/sharj"}, "is_accepted": false, "score": 1, "last_activity_date": 1538523883, "creation_date": 1538523883, "answer_id": 52617862, "question_id": 52617650, "link": "https://stackoverflow.com/questions/52617650/pessimistic-locking-is-not-working-properly-with-reload/52617862#52617862", "title": "Pessimistic locking is not working properly with reload", "body": "<p>Test result 800 is the correct answer.</p>\n\n<pre><code>before(:each) do\n  @product.total = 600\n  @product.method_name1\nend\n</code></pre>\n\n<p><code>before(:each)</code> means this piece of code will be executed before running each example so 600 + 200 is 800. If you want it to run only once then you have to use <code>before(:all)</code> then this piece of code will run only once before running both examples.</p>\n\n<p>You can see more on this in the official <a href=\"https://relishapp.com/rspec/rspec-core/v/2-2/docs/hooks/before-and-after-hooks#define-before(:each)-block\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n"}], "owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538528368, "creation_date": 1538522152, "last_edit_date": 1538528368, "question_id": 52617650, "link": "https://stackoverflow.com/questions/52617650/pessimistic-locking-is-not-working-properly-with-reload", "title": "Pessimistic locking is not working properly with reload", "body": "<p>Pessimistic locking is not working properly with reload (used in the test cases). <code>with_lock</code> and <code>reload</code> is not working correctly together and test cases are getting failed. If I removed the <code>with_lock</code> then test cases work fine.</p>\n\n<pre><code>def method_name1\n  self.with_lock do\n    attributes[\"amount_used\"] = get_total_amount_used\n    attributes[\"updated_at\"] = Time.now.utc\n    Product.where(:id =&gt; self.id).update_all(attributes)\n  end\nend\n</code></pre>\n\n<p>I have written unit test cases using FactoryGirl. It calls the method_name1 which recalculate the total after the used amount. If you check the first Test case 1: total = 600 and amount_used = -200 (-ve means reducing), now total should be 400.00. Similarly for \"Test case 2\", After running \"Test case 1\" total is 400.00. amount_used = 200 (+ve means add), total should be 600.00. But Test Case 2 is saying 800.00.</p>\n\n<pre><code>context 'description' do\n  before(:each) do\n    @product.total = 600\n    @product.method_name1\n  end\n\n  it 'is updated automatically if valid' do\n    @product.amount_used = -200\n    @product.save\n    @product.reload\n    should eq('400.0')       #Working\n  end\n\n  it 'is not changed if invalid' do\n    @product.amount_used = 200\n    @product.save\n    @product.reload\n    should eq('600.0')      #Not Working\n  end\nend\n</code></pre>\n\n<p>Error For Test Case 2:\nFailure/Error: should eq('600.0')</p>\n\n<pre><code>   expected: \"600.0\"\n        got: \"800.0\"\n\n   (compared using ==)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538518948, "post_id": 52617137, "comment_id": 92168576, "body": "Remember that <code>rescue</code> can be done inside a method without an explicit <code>begin</code> surrounding it. The <code>def</code> level method acts as the same sort of container."}, {"owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538519710, "post_id": 52617137, "comment_id": 92168797, "body": "Thanks tadman. But I guess it doesnt help me too much"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538519786, "post_id": 52617137, "comment_id": 92168824, "body": "Do you have a full stack trace here? I&#39;m curious if something else is trying to instantiate your custom exception. Normally you call <code>raise</code> in the form <code>raise ExceptionClass, message, ...</code> without explicitly calling <code>new</code>."}, {"owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538520115, "post_id": 52617137, "comment_id": 92168932, "body": "I will add to the question"}, {"owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538520295, "post_id": 52617137, "comment_id": 92168987, "body": "I did a raise PaymentGateway::CreateSubscriptionServiceError,e.message , but the error message its still the same"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538520296, "post_id": 52617137, "comment_id": 92168989, "body": "What&#39;s happening on <code>client.rb</code> line 12?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538520334, "post_id": 52617137, "comment_id": 92168998, "body": "This should work, like a very minimal version of your code does, but if something else calls <code>raise PaymentGateway::ServiceError</code> then all bets are off."}, {"owner": {"reputation": 2446, "user_id": 2369428, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CToEN.jpg?s=128&g=1", "display_name": "yivo", "link": "https://stackoverflow.com/users/2369428/yivo"}, "edited": false, "score": 0, "creation_date": 1538520397, "post_id": 52617137, "comment_id": 92169009, "body": "What is your body of PaymentGateway::CreateSubscriptionServiceError class? I think you call super in a wrong way."}, {"owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "edited": false, "score": 0, "creation_date": 1538520449, "post_id": 52617137, "comment_id": 92169026, "body": "I will add both (client and CreateSubscriptionServiceError) on the question"}, {"owner": {"reputation": 2446, "user_id": 2369428, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CToEN.jpg?s=128&g=1", "display_name": "yivo", "link": "https://stackoverflow.com/users/2369428/yivo"}, "edited": false, "score": 0, "creation_date": 1538520485, "post_id": 52617137, "comment_id": 92169037, "body": "@FernandoMaymone Great"}, {"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "edited": false, "score": 0, "creation_date": 1538533517, "post_id": 52617137, "comment_id": 92171794, "body": "You defined <code>PaymentGateway::CreateCustomerServiceError</code> class. However in <code>rescue</code> section you raised <code>PaymentGateway::CreateSubscriptionServiceError</code> exception. Can it be a problem?"}], "owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538520946, "creation_date": 1538518218, "last_edit_date": 1538520946, "question_id": 52617137, "link": "https://stackoverflow.com/questions/52617137/problems-when-rescuing-a-exception-in-ruby", "title": "Problems when rescuing a exception in Ruby", "body": "<p>Im trying to raise some exceptions on my app, and found a bug that its driving me crazy. </p>\n\n<p>Here is my client code: </p>\n\n<pre><code>class PaymentGateway::CreateSubscriptionService &lt; PaymentGateway::Service\n\ndef run\n    begin\n      Subscription.transaction do\n        create_client_subscription\n        self.subscription = create_subscription\n        self.success = true\n      end\n    rescue PaymentGateway::CreateCustomerService, \n      PaymentGateway::CreatePlanService,\n      PaymentGateway::ClientError =&gt; e\n      raise PaymentGateway::CreateSubscriptionServiceError.new(\n        ERROR_MESSAGE,\n        exception_message: e.message)\n    end\n  end\n</code></pre>\n\n<p>My service error: </p>\n\n<pre><code>#services/payment_gateway/service_error.rb\n\nclass PaymentGateway::ServiceError &lt; StandardError\n  attr_reader :exception_message\n\n  def initialize(message, exception_message: )\n\n    super(message)\n    @exception_message = exception_message\n\n  end\nend\n</code></pre>\n\n<p>My client its: </p>\n\n<pre><code>class PaymentGateway::Client\n  attr_accessor :external_client\n\n  def initialize(external_client: PaymentGateway::StripeClient.new)\n    @external_client = external_client\n  end\n\n  def method_missing(*args, &amp;block)\n    begin\n      external_client.send(*args, &amp;block)\n    rescue =&gt; e \n      raise PaymentGateway::ClientError.new(e.message)\n    end\n  end\nend\n\nclass PaymentGateway::CreateCustomerServiceError &lt; PaymentGateway::ServiceError\nend\n</code></pre>\n\n<p>When I run my code, this im getting this error: </p>\n\n<p>ArgumentError in SubscriptionsController#create\n    missing keyword: exception_message\n    Extracted source (around line #4):</p>\n\n<pre><code>  attr_reader :exception_message\n\n  def initialize(message, exception_message: )\n</code></pre>\n\n<p>What Im doing wrong here? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 8120455, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lFtL9XDfm5Y/AAAAAAAAAAI/AAAAAAAAAz8/MG7GGea3EOM/photo.jpg?sz=128", "display_name": "Pavel Puzin", "link": "https://stackoverflow.com/users/8120455/pavel-puzin"}, "is_accepted": true, "score": 2, "last_activity_date": 1538519151, "creation_date": 1538519151, "answer_id": 52617271, "question_id": 52617086, "link": "https://stackoverflow.com/questions/52617086/avoiding-string-cant-be-coerced-into-bigdecimal/52617271#52617271", "title": "Avoiding `String can&#39;t be coerced into BigDecimal`", "body": "<p>Use interpolation:</p>\n\n<pre><code>\"#{value} #{a}\"\n</code></pre>\n\n<p>Or concatenation:</p>\n\n<pre><code>value.to_s + ' ' + a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "is_accepted": false, "score": 0, "last_activity_date": 1538521496, "last_edit_date": 1538521496, "creation_date": 1538519877, "answer_id": 52617378, "question_id": 52617086, "link": "https://stackoverflow.com/questions/52617086/avoiding-string-cant-be-coerced-into-bigdecimal/52617378#52617378", "title": "Avoiding `String can&#39;t be coerced into BigDecimal`", "body": "<p>Quite funny how I used interpolation in the last line of the refactor <code>[[value].join(' '), \"#{a}\"].split(',').join(' ')</code> and I never dim it fit to simply use Interpolation. Aside the suggested interpolation by in the answers thread, I was able to make the code more simple, smaller, and faster.</p>\n\n<pre><code>s = x.currency\na = s.slice(6..11)\nvalue = x.price * x.volume\n\"#{value} #{a}\" # Thanks to @PavelPuzin for this suggestion in this line.\n</code></pre>\n\n<p>Another thing we can consider about the best way to go about this is to investigate <code>Interpolation</code> and the <code>Join</code> I used by using Benchmark to determine its Algorithmic Complexity:</p>\n\n<pre><code>require \"benchmark\"\n\nnumbers = (1..1000).to_a\n\nn = 1000\nBenchmark.bm do |x|\n  x.report { n.times do   ; numbers.each_cons(2) {|a, b| \"#{a} #{b}\"}; end }\n  x.report { n.times do   ; numbers.each_cons(2) {|a, b| [a, b].join(\" \")}; end }\nend \n\n###############################Result###################################\n    user     system      total        real\n   0.467287   0.000731   0.468018 (  0.468641)\n   1.154991   0.001563   1.156554 (  1.157740)\n</code></pre>\n"}], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 52617271, "answer_count": 2, "score": 0, "last_activity_date": 1538521496, "creation_date": 1538517924, "question_id": 52617086, "link": "https://stackoverflow.com/questions/52617086/avoiding-string-cant-be-coerced-into-bigdecimal", "title": "Avoiding `String can&#39;t be coerced into BigDecimal`", "body": "<p>I wrote a logic/method that returns a two different objects (Integer and String), such that for an example the returned value will be <code>5000.00 Dollars</code>. </p>\n\n<p>So I wrote a method to for my expectations. See the logic below:</p>\n\n<pre><code>s = x.currency # This assigns the string `dollarpounds` to s\na = s.slice(6..11) # This slice off 6 to 11 and returns just pounds to variable a\nprice_value = x.price # This is integer (price)\nvolume_volume = x.volume # This is integer (volume)\nvalue = price_value * volume_volume # This multiplies price and volume and returns the value\nvalue + \"#{a}\" # Now this throws TypeError-String can't be coerced into BigDecimal\n</code></pre>\n\n<p>So to do away with this problem I refactored my method but I think its very insulting snippet to be considered a master in Ruby. <em>How do I re-write this re-factored logic below to be smart enough as Ruby code?</em></p>\n\n<p><strong>So here is what I have done:</strong></p>\n\n<p><strong>Re-factored logic</strong>. It returns <code>5000.00 Dollars</code> as expected</p>\n\n<pre><code>s = x.currency # This assigns the string `dollarpounds` to s\na = s.slice(6..11) # This slice off 6 to 11 and returns just pounds to variable a\nprice_value = x.price # This is integer (price)\nvolume_volume = x.volume # This is integer (volume)\nvalue = price_value * volume_volume # This multiplies price and volume and returns the value\n[[value].join(' '), \"#{a}\"].split(',').join(' ') # This returns 5000.00 Dollars\n</code></pre>\n\n<p>As much my <code>re-factored</code> code works, I still feel it's insulting to ruby community and can be better than this. Any help how to do it better will be appreciated.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 7629364, "user_type": "registered", "profile_image": "https://graph.facebook.com/427569477596614/picture?type=large", "display_name": "Ayham Rustom", "link": "https://stackoverflow.com/users/7629364/ayham-rustom"}, "is_accepted": false, "score": 0, "last_activity_date": 1538729291, "creation_date": 1538729291, "answer_id": 52661757, "question_id": 52616954, "link": "https://stackoverflow.com/questions/52616954/why-im-getting-this-error-after-executing-gem-install-any-gem/52661757#52661757", "title": "why I&#39;m getting this error after executing &#39;gem install any_gem&#39;?", "body": "<p>The solution I fount is to install ruby 2.4.4-2 with DevKit.</p>\n"}, {"tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": false, "score": 1, "last_activity_date": 1552334637, "creation_date": 1552334637, "answer_id": 55109545, "question_id": 52616954, "link": "https://stackoverflow.com/questions/52616954/why-im-getting-this-error-after-executing-gem-install-any-gem/55109545#55109545", "title": "why I&#39;m getting this error after executing &#39;gem install any_gem&#39;?", "body": "<p>Being on windows, I have updated ruby and re-installed the ruby devkit for ruby version > 2\nby running </p>\n\n<pre><code>choco install ruby2.devkit --force\nchoco upgrade ruby2.devkit\n</code></pre>\n\n<p>Then I opened a new cmd and the issue was gone.</p>\n"}], "owner": {"reputation": 49, "user_id": 7629364, "user_type": "registered", "profile_image": "https://graph.facebook.com/427569477596614/picture?type=large", "display_name": "Ayham Rustom", "link": "https://stackoverflow.com/users/7629364/ayham-rustom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "closed_date": 1552337100, "answer_count": 2, "score": 0, "last_activity_date": 1552334637, "creation_date": 1538517219, "last_edit_date": 1538586459, "question_id": 52616954, "link": "https://stackoverflow.com/questions/52616954/why-im-getting-this-error-after-executing-gem-install-any-gem", "closed_reason": "Duplicate", "title": "why I&#39;m getting this error after executing &#39;gem install any_gem&#39;?", "body": "<p>I tried the following command:  gem install rgl\nthen I got the following error:</p>\n\n<pre><code>ERROR:  While executing gem ... (ArgumentError)\n    wrong number of arguments (given 1, expected 0)\n</code></pre>\n\n<p>more info:\nwindows 10\nruby 2.5</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1538536551, "post_id": 52616445, "comment_id": 92172459, "body": "Does the output should go on like this: <code>:key=&gt;6, :idx=&gt;4 pass</code>, <code>:key=&gt;8, :idx=&gt;5, fail</code>, <code>:key=&gt;9, :idx=&gt;6, pass</code>, <code>:key=&gt;12, :idx=&gt;7, fail</code>? What if the hash is <code>{2=&gt;&quot;2.06&quot;, 3=&gt;&quot;2.10&quot;, 5=&gt;&quot;2.00&quot;, 6=&gt;&quot;2.10&quot;, 8=&gt;&quot;2.20&quot;, 9=&gt;&quot;2.10&quot;, 14=&gt;&quot;2.10&quot;, 16=&gt;&quot;2.04&quot;}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538516944, "post_id": 52616622, "comment_id": 92167968, "body": "Your second line answers the question, so why not stop there? I find what follows to be of dubious value. I&#39;m sure your answer is correct, but I&#39;d be more comfortable if Ruby&#39;s documentation for <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-values\" rel=\"nofollow noreferrer\">Hash#values</a> stated that values were returned in the insertion order of their associated keys (same for <code>each_key</code>, <code>each_value</code>, <code>keys</code> and so on). Perhaps the second line of <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html\" rel=\"nofollow noreferrer\">Hash</a> implies all those methods return values in key insertion order."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538517115, "post_id": 52616622, "comment_id": 92168019, "body": "@CarySwoveland Yes, great point; it appears hash keys <a href=\"http://ruby-doc.org/core-1.9.3/Hash.html\" rel=\"nofollow noreferrer\">are ordered</a>. The second line alone doesn&#39;t tell OP what they&#39;re doing wrong and doesn&#39;t provide the desired output."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538517288, "post_id": 52616622, "comment_id": 92168064, "body": "er, second paragraph (not line)."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538517407, "post_id": 52616622, "comment_id": 92168102, "body": "It&#39;s OK if you find what follows to be dubious, but to my mind, knowing when to use nested loops vs single loops is pretty fundamental knowledge. Can you specify what you find dubious? Maybe I can improve it."}], "tags": [], "owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "is_accepted": true, "score": 1, "last_activity_date": 1538516149, "last_edit_date": 1538516149, "creation_date": 1538515523, "answer_id": 52616622, "question_id": 52616445, "link": "https://stackoverflow.com/questions/52616445/comparing-individual-elements-of-an-array-and-hash/52616622#52616622", "title": "Comparing individual elements of an array and hash", "body": "<p>Doing an equality check for hash values and an array is easy:</p>\n\n<pre><code>puts hash.values == array\n</code></pre>\n\n<p>To do what you're trying to do, a nested loop isn't appropriate (it iterates over the entire <code>hash</code> for each element in <code>array</code> rather than comparing one to one). You can use <code>zip</code> to iterate over both in parallel:</p>\n\n<pre><code>array.zip(hash).each_with_index do |(av, (hk, hv)), ai|\n  puts \"Key: #{hk}\"\n  puts \"Index: #{ai}\"\n  puts av == hv ? \"pass\" : \"fail\"\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Key: 1\nIndex: 0\npass\nKey: 2\nIndex: 1\npass\nKey: 4\nIndex: 2\npass\nKey: 5\nIndex: 3\npass\nKey: 6\nIndex: 4\npass\nKey: 8\nIndex: 5\npass\nKey: 9\nIndex: 6\npass\nKey: 12\nIndex: 7\npass\n</code></pre>\n\n<p><a href=\"https://repl.it/repls/KeenPinkInversion\" rel=\"nofollow noreferrer\">Try it!</a></p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 8205478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fe08c4d0ec0cb5755e0520d4bcf6f6?s=128&d=identicon&r=PG&f=1", "display_name": "DevMasterAryan", "link": "https://stackoverflow.com/users/8205478/devmasteraryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1538515660, "creation_date": 1538515660, "answer_id": 52616653, "question_id": 52616445, "link": "https://stackoverflow.com/questions/52616445/comparing-individual-elements-of-an-array-and-hash/52616653#52616653", "title": "Comparing individual elements of an array and hash", "body": "<p>You can do something like this</p>\n\n<pre><code> h={1=&gt;\"2.06\", 2=&gt;\"2.10\", 4=&gt;\"2.00\", 5=&gt;\"2.10\", 6=&gt;\"2.20\", 8=&gt;\"2.10\", 9=&gt;\"2.10\", 12=&gt;\"2.04\"}\n a = [\"2.06\",\"2.10\",\"2.00\",\"2.10\",\"2.20\",\"2.10\",\"2.10\",\"2.04\"]\n (0).upto(a.length) do |index|\n    if a[index]==h[index+1]\n       puts \"key: #{index+1}\"\n       puts \"index: #{index}\"\n       puts \"Pass\"\n    else\n      puts \"key: #{index+1}\"\n      puts \"index: #{index}\"\n      puts \"Failed\"\n    end\n end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1538518237, "last_edit_date": 1538518237, "creation_date": 1538516731, "answer_id": 52616870, "question_id": 52616445, "link": "https://stackoverflow.com/questions/52616445/comparing-individual-elements-of-an-array-and-hash/52616870#52616870", "title": "Comparing individual elements of an array and hash", "body": "<p>The issue you currently face is because the second loop isn't necessary.</p>\n\n<pre><code>array.each_with_index do |item, index|\n  hash.each do |key, value|\n  #     ^ this is not needed\n</code></pre>\n\n<p>Instead access the hash by providing the key based on the index.</p>\n\n<pre><code># setup\nhash = {1=&gt;\"2.06\", 2=&gt;\"2.10\", 4=&gt;\"2.00\", 5=&gt;\"2.10\", 6=&gt;\"2.20\", 8=&gt;\"2.10\", 9=&gt;\"2.10\", 12=&gt;\"2.04\"}\narray = [\"2.06\",\"2.10\",\"2.00\",\"2.10\",\"2.20\",\"2.10\",\"2.10\",\"2.04\"]\n</code></pre>\n\n<p></p>\n\n<pre><code>array.each_with_index do |array_item, index|\n  key = index + 1\n  hash_item = hash[key]\n\n  puts \"Key: #{key}\"\n  puts \"Index: #{index}\"\n  puts array_item == hash_item ? 'Pass' : 'Fail'\nend\n</code></pre>\n\n<p>The above prints out what you expect as your output. However if you don't need the index for anything other than accessing the hash you can offset it by one by doing the following:</p>\n\n<pre><code>array.each.with_index(1) do |array_item, key|\n  hash_item = hash[key]\n  puts \"#{key}: #{array_item == hash_item}\"\nend\n</code></pre>\n\n<p><strong>References:</strong></p>\n\n<ul>\n<li><a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_with_index\" rel=\"nofollow noreferrer\"><code>Enumerable#each_with_index</code></a></li>\n<li><a href=\"https://ruby-doc.org/core-2.5.1/Array.html#method-i-each\" rel=\"nofollow noreferrer\"><code>Array#each</code></a></li>\n<li><a href=\"https://ruby-doc.org/core-2.5.1/Enumerator.html#method-i-with_index\" rel=\"nofollow noreferrer\"><code>Enumerator#with_index</code></a></li>\n</ul>\n"}], "owner": {"reputation": 101, "user_id": 10270861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9df664d3c4a3b0f079a5fa3008dc724?s=128&d=identicon&r=PG&f=1", "display_name": "pjano1", "link": "https://stackoverflow.com/users/10270861/pjano1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 52616622, "answer_count": 3, "score": 2, "last_activity_date": 1538518237, "creation_date": 1538514640, "question_id": 52616445, "link": "https://stackoverflow.com/questions/52616445/comparing-individual-elements-of-an-array-and-hash", "title": "Comparing individual elements of an array and hash", "body": "<p>I have the following hash and array, both with 8 elements each: </p>\n\n<pre><code>{1=&gt;\"2.06\", 2=&gt;\"2.10\", 4=&gt;\"2.00\", 5=&gt;\"2.10\", 6=&gt;\"2.20\", 8=&gt;\"2.10\", 9=&gt;\"2.10\", 12=&gt;\"2.04\"}\n\n[\"2.06\",\"2.10\",\"2.00\",\"2.10\",\"2.20\",\"2.10\",\"2.10\",\"2.04\"]\n</code></pre>\n\n<p>I need to verify that each array slot matches with the corresponding hash value. For instance, <code>array[0]</code> needs to equal the value of <code>hash[:1]</code>, <code>array[1]</code> needs to equal <code>hash[:2]</code>, etc. What I don't want is to compare <code>array[0]</code> to any other hash value other than <code>hash[:1]</code>, <code>array[1]</code> to any other value other than <code>hash[:2]</code>, etc. The hash and array values are both read in the exact order pictured, so that order doesn't need to change. If any of these pairs don't match, they shall fail and iterate to the next pair.</p>\n\n<p>I tried making a nested loop which iterated through the array and hash. but what it did was compare every hash value to one array slot and then iterate to the next array slot and repeat (see my current output code). This is my code so far with pseudo-code I need:</p>\n\n<pre><code>array.each_with_index do |item, index|\n  hash.each do |key, value|\n    puts \"Key: #{key}\"\n    puts \"Index: #{index}\"\n    #if item[index] == key[:value1]\n    #print pass, else print fail\n    #iterate to next pair\n    #if item[index+1] == key[:value2]\n    #repeat\n    #...\n    #end \n  end\nend        \n</code></pre>\n\n<p>This is what my code currently outputs:</p>\n\n<pre><code>Key: 1\nIndex: 0\nKey: 2\nIndex: 0\nKey: 4\nIndex: 0\nKey: 5\nIndex: 0\n</code></pre>\n\n<p>...</p>\n\n<p>This is what I would need it to output:</p>\n\n<pre><code>Key: 1     \nIndex: 0\nPass\nKey: 2\nIndex: 1\nPass\nKey: 4\nIndex: 2\nFail\nKey: 5\nIndex: 3\nPass\n</code></pre>\n\n<p>...</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3590, "user_id": 1494245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50a2dcc33b58918f27664b7646d92b7?s=128&d=identicon&r=PG", "display_name": "Sean Huber", "link": "https://stackoverflow.com/users/1494245/sean-huber"}, "edited": false, "score": 0, "creation_date": 1538515778, "post_id": 52616216, "comment_id": 92167528, "body": "Could you please add the code of view template that you are posting from?"}], "answers": [{"tags": [], "owner": {"reputation": 1410, "user_id": 2454036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/746251016e806bec7aaa34b12930d387?s=128&d=identicon&r=PG", "display_name": "Juan Fuentes", "link": "https://stackoverflow.com/users/2454036/juan-fuentes"}, "is_accepted": true, "score": 3, "last_activity_date": 1538516209, "creation_date": 1538516209, "answer_id": 52616755, "question_id": 52616216, "link": "https://stackoverflow.com/questions/52616216/rails-5-post-request-adding-extra-parameter/52616755#52616755", "title": "Rails 5 POST request adding extra parameter?", "body": "<p>What your getting is wrapped parameters </p>\n\n<p><a href=\"https://api.rubyonrails.org/v5.2.1/classes/ActionController/ParamsWrapper.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/v5.2.1/classes/ActionController/ParamsWrapper.html</a></p>\n\n<p>You can turn it off by placing this in your controller</p>\n\n<pre><code>wrap_parameters false\n</code></pre>\n\n<p>This feature can be further customized in config/initializers/wrap_parameters.rb</p>\n"}], "owner": {"reputation": 316, "user_id": 8099543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2dc81140ddddc4bcda4efdbdde191373?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Shi", "link": "https://stackoverflow.com/users/8099543/kevin-shi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 52616755, "answer_count": 1, "score": 0, "last_activity_date": 1538516209, "creation_date": 1538513502, "question_id": 52616216, "link": "https://stackoverflow.com/questions/52616216/rails-5-post-request-adding-extra-parameter", "title": "Rails 5 POST request adding extra parameter?", "body": "<p>My routes.rb file contains:</p>\n\n<pre><code>post 'products/:id/favorite', to: 'products#favorite'\ndelete 'products/:id/unfavorite', to: 'products#unfavorite'\nget 'products/:id', to: 'products#show'\n</code></pre>\n\n<p>In my products controller, I have permitted <code>params.permit(:id)</code></p>\n\n<p>When I make a post request to <code>localhost:3000/products/1/favorite</code> with no body, I get the following in the rails console:</p>\n\n<pre><code>Parameters: {\"id\"=&gt;\"1\", \"product\"=&gt;{}}\nUnpermitted parameter: :product\n</code></pre>\n\n<p>Where did the extra <code>:product</code> param come from?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter-bootstrap", "bootstrap-datepicker"], "answers": [{"comments": [{"owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1538571141, "post_id": 52617052, "comment_id": 92188334, "body": "I added <code>*= require bootstrap-datepicker</code> in my <code>application.css</code> file. Do I need to add something else?"}, {"owner": {"reputation": 4797, "user_id": 177154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f719bc9e36272f09feca03728b4a160c?s=128&d=identicon&r=PG", "display_name": "draganstankovic", "link": "https://stackoverflow.com/users/177154/draganstankovic"}, "reply_to_user": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1538590243, "post_id": 52617052, "comment_id": 92199755, "body": "Is it ok to assume you have the &#39;core&#39; bootstrap css as well and haven&#39;t done anything weird in your custom css? You can perhaps try to get rid of everything except the date picker on your page to narrow down the issue..."}, {"owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1538590771, "post_id": 52617052, "comment_id": 92199988, "body": "you are safe to assume that"}, {"owner": {"reputation": 4797, "user_id": 177154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f719bc9e36272f09feca03728b4a160c?s=128&d=identicon&r=PG", "display_name": "draganstankovic", "link": "https://stackoverflow.com/users/177154/draganstankovic"}, "reply_to_user": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1538592042, "post_id": 52617052, "comment_id": 92200607, "body": "What happens when you use bootstrap&#39;s layout grid and when you remove the clutter (essentially everything except datepicker and form)?"}, {"owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1538592397, "post_id": 52617052, "comment_id": 92200787, "body": "the only thing I&#39;m using in that view coming from bootstrap is the datepicker"}, {"owner": {"reputation": 4797, "user_id": 177154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f719bc9e36272f09feca03728b4a160c?s=128&d=identicon&r=PG", "display_name": "draganstankovic", "link": "https://stackoverflow.com/users/177154/draganstankovic"}, "reply_to_user": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1538592559, "post_id": 52617052, "comment_id": 92200858, "body": "What I mean is - can you try to use bootstrap&#39;s layout structure with classes .row .col to layout your form elements?"}, {"owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "reply_to_user": {"reputation": 4797, "user_id": 177154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f719bc9e36272f09feca03728b4a160c?s=128&d=identicon&r=PG", "display_name": "draganstankovic", "link": "https://stackoverflow.com/users/177154/draganstankovic"}, "edited": false, "score": 0, "creation_date": 1538592583, "post_id": 52617052, "comment_id": 92200880, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/181244/discussion-between-assembler-and-draganstankovic\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 4797, "user_id": 177154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f719bc9e36272f09feca03728b4a160c?s=128&d=identicon&r=PG", "display_name": "draganstankovic", "link": "https://stackoverflow.com/users/177154/draganstankovic"}, "is_accepted": true, "score": 1, "last_activity_date": 1538517745, "creation_date": 1538517745, "answer_id": 52617052, "question_id": 52615869, "link": "https://stackoverflow.com/questions/52615869/how-to-properly-use-bootstrap-datepicker-with-ruby-on-rails/52617052#52617052", "title": "how to properly use bootstrap datepicker with ruby on rails", "body": "<p>This looks more like a CSS issue rather than Rails.\nYou should ensure that you have included all the required CSS files for <code>bootstrap</code> and for <code>bootstrap-datepicker</code> and that should solve it. Check the <code>stylesheets/application.css</code> file in your project for the currently included css files.</p>\n"}], "owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 798, "favorite_count": 0, "accepted_answer_id": 52617052, "answer_count": 1, "score": 0, "last_activity_date": 1538592123, "creation_date": 1538511766, "last_edit_date": 1538592123, "question_id": 52615869, "link": "https://stackoverflow.com/questions/52615869/how-to-properly-use-bootstrap-datepicker-with-ruby-on-rails", "title": "how to properly use bootstrap datepicker with ruby on rails", "body": "<p>In my <code>application.js</code> I've added:</p>\n\n<pre><code>//= require jquery3\n//= require jquery_ujs\n//= require bootstrap\n//= require bootstrap-datepicker\n</code></pre>\n\n<p>then I've added this helper in my <code>app/helpers/application_helper.rb</code>:</p>\n\n<pre><code>def datepicker (form, field)\n    form.text_field(field, data: {provide: \"datepicker\",\n                                  'date-format': 'dd/mm/yyyy',\n                                  'date-autoclose': 'true',\n                                  'date-today-btn': 'linked',\n                                  'date-today-highlight': 'true'}).html_safe\n  end\n</code></pre>\n\n<p>This is my form:</p>\n\n<pre><code>&lt;%= form_with(model: test, local: true) do |form| %&gt;\n  &lt;% if test.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(myform.errors.count, \"error\") %&gt; prohibited this test from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n        &lt;% test.errors.full_messages.each do |message| %&gt;\n          &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n        &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :test_name %&gt;\n    &lt;%= form.text_field :test_name %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :test_desc %&gt;\n    &lt;%= form.text_field :test_desc %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :test_expan %&gt;\n    &lt;%= form.text_field :test_expan %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :test_date %&gt;\n    &lt;%= datepicker(form, :test_date) %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :ci %&gt;\n    &lt;%= form.text_field :ci %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :test_complete %&gt;\n    &lt;%= form.check_box :test_complete %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :tester %&gt;\n    &lt;%= form.text_field :tester %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :test_other_cons %&gt;\n    &lt;%= form.text_field :test_other_cons %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= form.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I have a huge form, which contains a lot of textfields and checkboxes, but the datepicker shows at the end of the form, not right beneath of the textfield. I mean, I would like the calendar to show right beneath the textfield, not after the submit button. </p>\n\n<p>How should I proceed to solve this? Am I missing something here?</p>\n\n<p>Also, I'm using Linux Mint 18.3, Ruby on Rails 5.2.1, and I've tested it on Chromiun 69.0.3497.81 and Firefox 62.0, both of them the same.</p>\n"}, {"tags": ["ruby", "macos", "command-line", "command", "rvm"], "comments": [{"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1538507667, "post_id": 52614888, "comment_id": 92164204, "body": "Might be more appropriate on <a href=\"https://apple.stackexchange.com\">apple.stackexchange.com</a> . Good luck."}], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 6761971, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/33a87fe6a86dff0a7d72841987640edf?s=128&d=identicon&r=PG&f=1", "display_name": "Weirdali", "link": "https://stackoverflow.com/users/6761971/weirdali"}, "is_accepted": true, "score": 0, "last_activity_date": 1538508295, "creation_date": 1538508295, "answer_id": 52615099, "question_id": 52614888, "link": "https://stackoverflow.com/questions/52614888/cannot-install-rvm-in-macos-without-ruby-cannot-upgrade-ruby-without-rvm/52615099#52615099", "title": "Cannot install RVM in macOS without Ruby, cannot upgrade Ruby without RVM", "body": "<p>The answer is to type:</p>\n\n<pre><code>$ source ~/.rvm/scripts/rvm\n</code></pre>\n\n<p>Then to upgrade ruby</p>\n\n<pre><code>rvm reinstall ruby-2.5.1\n</code></pre>\n\n<p>So I now have</p>\n\n<pre><code>$ ruby -v\nruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-darwin16]\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 6761971, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/33a87fe6a86dff0a7d72841987640edf?s=128&d=identicon&r=PG&f=1", "display_name": "Weirdali", "link": "https://stackoverflow.com/users/6761971/weirdali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 52615099, "answer_count": 1, "score": -1, "last_activity_date": 1538508295, "creation_date": 1538507304, "question_id": 52614888, "link": "https://stackoverflow.com/questions/52614888/cannot-install-rvm-in-macos-without-ruby-cannot-upgrade-ruby-without-rvm", "title": "Cannot install RVM in macOS without Ruby, cannot upgrade Ruby without RVM", "body": "<p>My current version of Ruby is:</p>\n\n<pre><code>$ ruby -v \nruby 2.0.0p648 (2015-12-16 revision 53162) [universal.x86_64-darwin16]\n</code></pre>\n\n<p>I need a more current version of Ruby so I tried to install it, however, I do not have RVM installed:</p>\n\n<pre><code>$ rvm\n-bash: rvm: command not found\n</code></pre>\n\n<p>In order to install RVM, I went to <a href=\"https://rvm.io\" rel=\"nofollow noreferrer\">https://rvm.io</a> and followed the instructions. However, on the second command, I got the following:</p>\n\n<pre><code>$ \\curl -sSL https://get.rvm.io | bash -s stable\nDownloading https://github.com/rvm/rvm/archive/1.29.4.tar.gz\nDownloading     \nhttps://github.com/rvm/rvm/releases/download/1.29.4/1.29.4.tar.gz.asc\ngpg: Signature made Sun  1 Jul 20:41:26 2018 BST\ngpg:                using RSA key 62C9E5F4DA300D94AC36166BE206C29FBF04FF17\ngpg: Good signature from \"Michal Papis (RVM signing) &lt;mpapis@gmail.com&gt;\" [unknown]\ngpg:                 aka \"Michal Papis &lt;michal.papis@toptal.com&gt;\" [unknown]\ngpg:                 aka \"[jpeg image of size 5015]\" [unknown]\ngpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\nPrimary key fingerprint: 409B 6B17 96C2 7546 2A17  0311 3804 BB82 D39D C0E3\nSubkey fingerprint: 62C9 E5F4 DA30 0D94 AC36  166B E206 C29F BF04 FF17\nGPG verified '/Users/me/.rvm/archives/rvm-1.29.4.tgz'\nUpgrading the RVM installation in /Users/me/.rvm/\nRVM PATH line found in /Users/me/.mkshrc /Users/me/.profile /Users/me/.bashrc /Users/me/.zshrc.\nRVM sourcing line found in /Users/me/.profile /Users/me/.bash_profile /Users/me/.zlogin.\n./scripts/functions/support: line 559: 65301 Abort trap: 6         \"$ruby_path\" -rrbconfig -e '\\\nFile.open(\"'\"$config_path\"'\",\"w\") { |file|\n  RbConfig::CONFIG.sort.each{|key,value|\n    file.write(\"#{key.gsub(/\\.|-/,\"_\")}=\\\"#    {value.to_s.gsub(\"$\",\"\\\\$\")}\\\"\\n\")\n  }\n}   \n' &gt; /dev/null 2&gt;&amp;1\nCan not save config data for ruby: 'ruby-2.5.1', most likely it is broken installation and you can:\n- try fix it: 'rvm reinstall ruby-2.5.1', OR:\n- remove  it: 'rvm uninstall ruby-2.5.1 --gems'\nUpgrade of RVM in /Users/me/.rvm/ is complete.\n</code></pre>\n\n<p>However, RVM was not installed or upgraded, as I am still getting:</p>\n\n<pre><code>$ rvm reload\n-bash: rvm: command not found\n</code></pre>\n\n<p>Does anyone know what the problem might be? I know I can upgrade Ruby without RVM but I would prefer not to. </p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 252285, "user_id": 541091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd0165a88a06fc92a36f222606f17a11?s=128&d=identicon&r=PG", "display_name": "Michael Berkowski", "link": "https://stackoverflow.com/users/541091/michael-berkowski"}, "edited": false, "score": 2, "creation_date": 1538505856, "post_id": 52614440, "comment_id": 92163352, "body": "Looks like integer overflow. Int32 unsigned max 4294967295 + 704982704 = 4999950000 (give or take 1 wherever the zero lands)"}], "answers": [{"tags": [], "owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "is_accepted": true, "score": 8, "last_activity_date": 1538507710, "last_edit_date": 1538507710, "creation_date": 1538507394, "answer_id": 52614908, "question_id": 52614440, "link": "https://stackoverflow.com/questions/52614440/why-is-rubys-arraycount-unreliable-for-large-arrays/52614908#52614908", "title": "Why is Ruby&#39;s Array#count unreliable for large arrays?", "body": "<p><code>Array#count</code> isn't the buggy method, <code>Enumerator#count</code> is:</p>\n\n<pre><code>100000.times.to_a.combination(2).class # =&gt; Enumerator\n</code></pre>\n\n<p>The good news is the bug you're experiencing was reported a few months ago as <a href=\"https://bugs.ruby-lang.org/issues/14805\" rel=\"noreferrer\">#14805</a> and subsequently fixed but the bad news is since then no new version of CRuby was released. So either wait for 2.5.2, 2.4.5, etc. or compile a version with the fix by yourself.</p>\n\n<p>The issue is the counter of an enumerator was limited to a signed 32-bit integer, so an overflow occurred:</p>\n\n<pre><code>max = (1 &lt;&lt; 31) - 1 # max value\n4999950000 &amp; max    # =&gt; 704982704\n</code></pre>\n\n<p>It was fixed by making the counter a bignum (Ruby's arbitrary precision integer type, since 2.4 an internal implementation detail) in case its value would be out of bounds of an <code>int</code> or as of now an <code>unsigned long</code>.</p>\n"}], "owner": {"reputation": 1081, "user_id": 1288687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7217dd12520210182c093856f60cd376?s=128&d=identicon&r=PG", "display_name": "knugie", "link": "https://stackoverflow.com/users/1288687/knugie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 52614908, "answer_count": 1, "score": 2, "last_activity_date": 1586961374, "creation_date": 1538505551, "last_edit_date": 1592644375, "question_id": 52614440, "link": "https://stackoverflow.com/questions/52614440/why-is-rubys-arraycount-unreliable-for-large-arrays", "title": "Why is Ruby&#39;s Array#count unreliable for large arrays?", "body": "<p>I'm iterating over a combination of 2 elements of a fairly large array. When counting the elements of the combination, I found something odd. The following example shows what I mean:</p>\n<pre><code>[1] pry(main)&gt; 10000.times.to_a.combination(2).count\n=&gt; 49995000   # correct\n\n[2] pry(main)&gt; 100000.times.to_a.combination(2).count\n=&gt; 704982704  # wrong, should be 4999950000\n\n[3] pry(main)&gt; count = 0; 100000.times.to_a.combination(2).each { count+=1 }; count\n=&gt; 4999950000 # correct\n</code></pre>\n<p>I double-checked the results using wolframalpha:</p>\n<ul>\n<li>pairs from 10000 entries <a href=\"https://www.wolframalpha.com/input/?i=10000!%2F((10000-2)!*2!)\" rel=\"nofollow noreferrer\">https://www.wolframalpha.com/input/?i=10000!%2F((10000-2)!*2!)</a></li>\n<li>pairs from 100000 entries <a href=\"https://www.wolframalpha.com/input/?i=100000!%2F((100000-2)!*2!)\" rel=\"nofollow noreferrer\">https://www.wolframalpha.com/input/?i=100000!%2F((100000-2)!*2!)</a></li>\n</ul>\n<p><strong>My question really is, why <code>Array#count</code> is not reliable in this case?</strong></p>\n<p>Also, see <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-combination\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.0/Array.html#method-i-combination</a> and <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-count\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.0/Array.html#method-i-count</a>.</p>\n<p>Thanks a lot.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "ruby-on-rails-4", "exception-handling"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1538509982, "post_id": 52614430, "comment_id": 92165180, "body": "Never raise or catch <code>Exception</code>. Either do <code>raise &quot;Total amount used is greater than approved&quot;</code> or a more specific error class."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1538510296, "post_id": 52614430, "comment_id": 92165319, "body": "Looks like you&#39;re not building that exception correctly. Here&#39;s the constructor signature: <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/StaleObjectError.html#method-c-new\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveRecord/&hellip;</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1538510329, "post_id": 52614430, "comment_id": 92165329, "body": "How do you know it&#39;s not being caught?"}], "owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538531542, "creation_date": 1538505517, "last_edit_date": 1538531542, "question_id": 52614430, "link": "https://stackoverflow.com/questions/52614430/exception-is-not-getting-catch-in-rescue-block-retry", "title": "Exception is not getting catch in rescue block (retry)", "body": "<p>The exception <code>ActiveRecord::StaleObjectError.new</code> is not being caught in my rescue block (retry). Why I am not able to catch Exception? </p>\n\n<pre><code>  attr_accessible :original_updated_at\n\n  def original_updated_at\n    @original_updated_at || updated_at.to_f\n  end\n\n  def set_total_and_buckets_used\n    tries = 0\n    begin\n      if total_approved - attributes[\"total_amount_used\"] &lt; 0\n          raise Exception.new(\"Total amount used is greater than approved\")\n      elsif self.updated_at.to_f == original_updated_at\n        @original_updated_at = nil\n        raise ActiveRecord::StaleObjectError.new(\"Car is changed while you were editing\")\n      else\n        self.with_lock do\n          attributes[\"updated_at\"] = Time.now.utc\n          Product.where(:id =&gt; self.id).update_all(attributes)\n          self.attributes = attributes\n        end\n      end\n    rescue ActiveRecord::StaleObjectError =&gt; e\n      if tries &lt; 3\n        tries += 1\n        retry\n      else\n        raise Exception.new(timeout.inspect)\n      end\n    end\n    self.reload\n    attributes\n  end\n</code></pre>\n"}, {"tags": ["ruby", "escaping", "single-quotes"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1538505542, "post_id": 52614119, "comment_id": 92163206, "body": "Have you tried using the multi-argument form of <code>Kernel#system</code> to avoid having to deal with the shell? Something like <code>system(&#39;ssh&#39;, &#39;-n&#39;, &#39;-o&#39;, &#39;StrictHostKeyChecking no&#39;, nginx_stage_servers[0], ...)</code>."}, {"owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1538505599, "post_id": 52614119, "comment_id": 92163233, "body": "Nope. I have not. But I&#39;ll try. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 2, "last_activity_date": 1538505718, "creation_date": 1538505718, "answer_id": 52614480, "question_id": 52614119, "link": "https://stackoverflow.com/questions/52614119/single-quotes-escaping-ruby/52614480#52614480", "title": "Single quotes escaping Ruby", "body": "<p>You have too many layers of quoting and escaping to deal with when you use <code>system(command_string)</code>, you're almost always better off using the multi-argument form of <a href=\"http://ruby-doc.org/core/Kernel.html#method-i-system\" rel=\"nofollow noreferrer\"><code>Kernel#system</code></a> to avoid dealing with the shell. Something like this will be less problematic:</p>\n\n<pre><code>system('ssh', '-n', '-o', 'StrictHostKeyChecking no', nginx_stage_servers[0], command)\n</code></pre>\n"}], "owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 52614480, "answer_count": 1, "score": 0, "last_activity_date": 1538505718, "creation_date": 1538504178, "question_id": 52614119, "link": "https://stackoverflow.com/questions/52614119/single-quotes-escaping-ruby", "title": "Single quotes escaping Ruby", "body": "<p>So, Im working with a Ruby script that needs to connect to a bunch of servers and get information from them. The problem I am having is that the single quotes seem to be getting lost somehow. What am I doing wrong here ?</p>\n\n<pre><code>command = \"grep -E \\'^(upstream| *server)\\'  /etc/nginx/upstreams.conf | sed -E \\'s/_pool.*//g ; s/^upstream //g\\'\"\n\nputs system(\"ssh -n   -o 'StrictHostKeyChecking no' #{nginx_stage_servers[0]} #{command}\")\n</code></pre>\n\n<h3>Error I am getting :</h3>\n\n<pre><code> $ ruby nx.rb\nbash: -c: line 0: syntax error near unexpected token `('\nbash: -c: line 0: `grep -E ^(upstream| *server) /etc/nginx/upstreams.conf'\ntrue\n</code></pre>\n\n<p>The reason of the error is the single quotes missing.</p>\n"}, {"tags": ["ruby", "newline", "whitespace", "linefeed"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 4, "creation_date": 1538503790, "post_id": 52613980, "comment_id": 92162360, "body": "&quot;both give the same output.&quot; - no, <a href=\"https://pastebin.com/8faQ6fQG\" rel=\"nofollow noreferrer\">they don&#39;t</a>."}, {"owner": {"reputation": 86, "user_id": 4565055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb42f8cac2c8e79afbdb822d6ea8bb4a?s=128&d=identicon&r=PG&f=1", "display_name": "wehdi", "link": "https://stackoverflow.com/users/4565055/wehdi"}, "edited": false, "score": 0, "creation_date": 1538503845, "post_id": 52613980, "comment_id": 92162390, "body": "Look at this <a href=\"https://stackoverflow.com/questions/1761051/difference-between-n-and-r?answertab=active#tab-top\">link</a> i think its the same in ruby"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538519379, "post_id": 52613980, "comment_id": 92168679, "body": "See also <a href=\"https://stackoverflow.com/questions/1552749/difference-between-cr-lf-lf-and-cr-line-break-types\">this answer</a>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1538519434, "post_id": 52613980, "comment_id": 92168704, "body": "In most terminals <code>\\r</code> moves the cursor to the beginning of the line without advancing lines, so you can re-write text. <code>\\n</code> moves to the beginning <i>and</i> advances the line."}, {"owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "edited": false, "score": 0, "creation_date": 1538519791, "post_id": 52613980, "comment_id": 92168825, "body": "Just for clarification, is there a difference between the two if I use them in a script and not in a shell? Thanks for the explanation!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1538543075, "post_id": 52613980, "comment_id": 92173782, "body": "@Practical1: depends on where you&#39;ll run that script. In most cases yes, there is a difference."}], "owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3538, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1546400711, "creation_date": 1538503595, "last_edit_date": 1546400711, "question_id": 52613980, "link": "https://stackoverflow.com/questions/52613980/what-is-the-difference-between-n-newline-and-r-carriage-return-in-ruby", "title": "What is the difference between &quot;\\n&quot; (newline) and &quot;\\r&quot; (carriage return) in Ruby?", "body": "<pre><code>y = \"Ruby\\riscool\"\nx = \"Ruby\\niscool\"\n\nif x == y\n  puts x\n  puts y\nelse\n  print 'Not equal!'\nend\n</code></pre>\n\n<p>The newline and carriage return character both give the same output. However, the code above is false, and triggers the else statement. I don't understand how I can get the same output, but for both to be unequal? Can someone give and example and explain the difference between the two whitespace characters? Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "filtering"], "answers": [{"tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 0, "last_activity_date": 1538504788, "last_edit_date": 1538504788, "creation_date": 1538504292, "answer_id": 52614146, "question_id": 52613869, "link": "https://stackoverflow.com/questions/52613869/how-to-write-solution-for-filtering-reviews/52614146#52614146", "title": "How to write solution for filtering reviews?", "body": "<p>Make a form for search review eg: -</p>\n\n<pre><code>&lt;%=form_tag filter_review_path do %&gt;\n  &lt;%=text_field_tag :terms%&gt;\n  &lt;%=submit_tag :submit%&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>In reviews controller</p>\n\n<pre><code>def filter\n  @filter_reviews = Review.where(\"LOWER(text) LIKE ?\", \"%#{params[:terms].downcase}%\")\nend\n</code></pre>\n\n<p>In routes.rb</p>\n\n<pre><code>get '/filter_review', to: \"reviews#filter\", as: :filter_review\n</code></pre>\n\n<p>In filter.html.erb show all filter_reviews </p>\n\n<pre><code>&lt;%unless @filter_reviews.blank?%&gt;\n  &lt;%@filter_reviews.each do |review|%&gt;\n     &lt;%=review.text%&gt;\n     &lt;%#=review.another_attribute%&gt;\n  &lt;%end%&gt;\n&lt;%else%&gt;\n  No review found\n&lt;%end%&gt;\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 52614146, "answer_count": 1, "score": -2, "last_activity_date": 1538504788, "creation_date": 1538503152, "question_id": 52613869, "link": "https://stackoverflow.com/questions/52613869/how-to-write-solution-for-filtering-reviews", "title": "How to write solution for filtering reviews?", "body": "<p>I am new to rails.I have model Review, with \"text\" column.I need to make a form where i fill a word and then on another page write all reviews which contain this word.How to filter it and write view if it can be 1 or can be a lot of reviews?Where i need pass filtering method(model or controller)?</p>\n"}, {"tags": ["json", "ruby", "hash", "pretty-print"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1538497232, "post_id": 52612281, "comment_id": 92159375, "body": "I don&#39;t think I understand. That&#39;s JSON, not Ruby. Does Rubocop critique JSON? Can you show an example of when this is a linter issue?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1538500668, "post_id": 52612281, "comment_id": 92160957, "body": "@Schwern: Nit picking: That&#39;s not JSON, JSON requires keys and strings to be double quoted so JSON would be <code>{&quot;a&quot;: [1, 2, {&quot;b&quot;: 3, &quot;c&quot;: 4}], &quot;d&quot;: {&quot;e&quot;: {&quot;f g&quot;: 42}}}</code>. And newer Rubies allow symbols to be quoted when using the JavaScript-style syntax (i.e. <code>{&#39;f g&#39;: 42}</code> is valid Ruby). Sorry, this is my Ruby pet peeve."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1538502773, "post_id": 52612281, "comment_id": 92161913, "body": "not sure what you mean, &quot;that would please classical Ruby linters&quot;"}, {"owner": {"reputation": 6840, "user_id": 1353549, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/413d2645039577214eb6382b3166e1c4?s=128&d=identicon&r=PG", "display_name": "akim", "link": "https://stackoverflow.com/users/1353549/akim"}, "edited": false, "score": 0, "creation_date": 1538561308, "post_id": 52612281, "comment_id": 92182555, "body": "For instance Rubocop prefers single quotes for literal strings that don&#39;t need escapes and interpolation, and prefer the new syntax for hash.  However, they appears to have no support in standard Ruby to pretty-print structures this way.  One has to write her own pretty-printer apparently."}], "owner": {"reputation": 6840, "user_id": 1353549, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/413d2645039577214eb6382b3166e1c4?s=128&d=identicon&r=PG", "display_name": "akim", "link": "https://stackoverflow.com/users/1353549/akim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 489, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538543962, "creation_date": 1538496500, "last_edit_date": 1538543962, "question_id": 52612281, "link": "https://stackoverflow.com/questions/52612281/pretty-print-using-the-new-ruby-syntax-for-hashes", "title": "Pretty-print using the new Ruby syntax for hashes", "body": "<p>There's a ton of questions about Ruby pretty-printing of recursive structures \u00e0 la JSON (i.e, just scalars, arrays and hashes), and the answers refer to the json, pp, awesome_printer, etc.  However, I have not seen a way to pretty-print a hash in Ruby syntax, that in addition would please classical Ruby linters.  Something like</p>\n\n<pre><code>&gt; pretty({a: [1, 2, {b: 3, c: 4}], d: {e: {'f g': 42}}})\n=&gt; \"{a: [1, 2, {b: 3, c: 4}], d: {e: {'f g': 42}}}\"\n</code></pre>\n\n<p>awesome_print comes close:</p>\n\n<pre><code>&gt; ({a: [1, 2, {b: 3, c: 4}], d: {e: {'f g': 42}}}).\n    ai(plain: true, multiline: false, ruby19_syntax: true)\n=&gt; \"{ a: [ 1, 2, { b: 3, c: 4 } ], d: { e: { \\\"f g\\\": 42 } } }\"\n</code></pre>\n\n<p>but I didn't find a means to get rid of the inner spaces for braces and brackets, and it chose to use double-quotes for a constant string, which is disliked by Rubocop.</p>\n\n<p>I can write my pretty-printer myself, but I'm surprised there's no COTS^h^h^h^hgem that does that.  Did I miss something?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3.2"], "answers": [{"tags": [], "owner": {"reputation": 49834, "user_id": 25507, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/DqZPI.png?s=128&g=1", "display_name": "Josh Kelley", "link": "https://stackoverflow.com/users/25507/josh-kelley"}, "is_accepted": true, "score": 1, "last_activity_date": 1538498296, "creation_date": 1538498296, "answer_id": 52612726, "question_id": 52612186, "link": "https://stackoverflow.com/questions/52612186/toplevel-error-accessing-ruby-class-variable-in-class-eval/52612726#52612726", "title": "Toplevel error accessing Ruby class variable in class_eval", "body": "<p>It looks like the problem is that, although the <code>class_eval</code> <code>do</code> block is executed within the context of <code>SomeNamespace::Bar</code>, that context doesn't apply to references to class variables.</p>\n\n<p>If you <a href=\"https://stackoverflow.com/q/41027031/25507\">explicitly access the class variable</a>, then things should work as expected:</p>\n\n<pre><code># NOTE: Omitting conditional set (||=) for simplicity\nSomeNamespace::Bar::class_variable_set(:@@part_of_header, JSON.dump({... Stuff ...}))\n\nheaders = {\n  \"Header Part\" =&gt; SomeNamespace::Bar::class_variable_get(:@@part_of_header)\n  #... other headers that I changed ...\n}\n</code></pre>\n\n<p>If <code>@@part_of_header</code> is really only used within <code>some_method</code>, and if you're totally replacing <code>some_method</code>, then there's also nothing wrong with you using your own module variable / class variable, instead of reusing the existing <code>SomeNamespace::Bar::@@part_of_header</code>.  I might prefer that approach; it feels like it better encapsulates your changes.</p>\n\n<pre><code>module MonkeyPatch\n  SomeNamespace::Bar.class_eval do\n    def some_method\n      # This is within the MonkeyPatch module, so it\n      # makes a new class variable for MonkeyPatch\n      @@part_of_header ||= \"JSON.dump({'a': 12})\"\n\n      # ... other code that I changed ...\n\n      headers = {\n        \"Header Part\" =&gt; @@part_of_header\n        #... other headers that I changed ...\n      }\n      puts headers\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 2850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vMuQR.jpg?s=128&g=1", "display_name": "Chris C", "link": "https://stackoverflow.com/users/2850/chris-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 52612726, "answer_count": 1, "score": 1, "last_activity_date": 1538527506, "creation_date": 1538496186, "last_edit_date": 1538527506, "question_id": 52612186, "link": "https://stackoverflow.com/questions/52612186/toplevel-error-accessing-ruby-class-variable-in-class-eval", "title": "Toplevel error accessing Ruby class variable in class_eval", "body": "<p>I'm working on a old code Rails 3, Ruby 1.9.3 code base.  I references a gem I can't upgrade for various reasons.  The gem has already been monkey patched (correct term?) using class_eval.  I need to make a change to another method that looks something like:</p>\n\n<pre><code>SomeNamespace::Bar do\n  def some_method\n    @@part_of_header ||= JSON.dump({... Stuff ...})\n\n    # ... other code ...\n\n    headers = {\n      \"Header Part\" =&gt; @@part_of_header\n      #... other headers ...\n    }\n  end\nend\n</code></pre>\n\n<p>The idea behind the @@part_of_header class variable is to cache the JSON dump so it can be reused.  The @@part_of_header is NOT defined elsewhere in the Bar base class.</p>\n\n<p>My monkey patched method looks like:</p>\n\n<pre><code>SomeNamespace::Bar.class_eval do\n  def some_method\n    @@part_of_header ||= JSON.dump({... Stuff ...})\n\n    # ... other code that I changed ...\n\n    headers = {\n      \"Header Part\" =&gt; @@part_of_header\n      #... other headers that I changed ...\n    }\n  end\nend\n</code></pre>\n\n<p>The code works fine but I get the following warning on the lines with the @@part_of_header class variable:</p>\n\n<pre><code>Class variable access from toplevel\n</code></pre>\n\n<p>I tried moving the class variable to it's own method:</p>\n\n<pre><code>SomeNamespace::Bar.class_eval do\n  def header_part\n    @@part_of_header ||= JSON.dump({... Stuff ...})\n  end\n\n  def some_method\n    # ... other code that I changed ...\n\n    headers = {\n      \"Header Part\" =&gt; header_part\n      #... other headers that I changed ...\n    }\n  end\nend\n</code></pre>\n\n<p>However the \"toplevel\" error just moved to the header_part method.  </p>\n\n<p>I also tried accessing the class variable using class_variable_set and class_variable_get but got undefined method errors.</p>\n\n<p>Any advice on how to fix this warning?  If it can't be fixed any advice on caching the JSON dump in the class_eval?  Thanks.</p>\n\n<p><strong>Update:</strong>\nThanks to @Josh for using the full class name with the class_variable_get/set.  My final solution looks like:</p>\n\n<pre><code>SomeNamespace::Bar.class_eval do\n  def header_part\n    # Create the class variable if it does not exist, remember\n    # the base class does not define @@part_of_header.\n    if !SomeNamesapce::Bar.class_variable_defined?(:@@part_of_header)\n      SomeNamespace::Bar.class_variable_set(:@@part_of_header, nil)\n    end\n\n     if (SomeNamespace::Bar.class_variable_get(:@@part_of_header).nil?\n       header_part = JSON.dump({... Stuff ...})\n       SomeNamespace::Bar.class_variable_set(:@@part_of_header, header_part)\n     end\n\n     SomeNamespace::Bar.class_variable_get(:@@part_of_header)\n  end\n\n  def some_method\n    # ... other code that I changed ...\n\n    headers = {\n      \"Header Part\" =&gt; header_part\n      #... other headers that I changed ...\n    }\n  end\nend\n</code></pre>\n\n<p>The above works but any feedback on the above solution would be appreciated.  Thanks.</p>\n"}, {"tags": ["ruby", "pry"], "comments": [{"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 3, "creation_date": 1538495686, "post_id": 52611949, "comment_id": 92158481, "body": "<code>hist --tail=50 -a</code> does not look like ruby code to me, are you trying to execute an external command as if ruby was a shell script language? If that&#39;s the case, you need to use backtick operators, or something like <code>system</code>. If this is a command as understood by pry itself, then you probably need to call some Pry API and pass the command as a string."}, {"owner": {"reputation": 1317, "user_id": 2013212, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ad34e90fc30380965ee659d6a825b8c?s=128&d=identicon&r=PG", "display_name": "Jonathon Nordquist", "link": "https://stackoverflow.com/users/2013212/jonathon-nordquist"}, "reply_to_user": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1538662842, "post_id": 52611949, "comment_id": 92229970, "body": "You&#39;re correct that it&#39;s not Ruby code, the Pry REPL has it&#39;s own scripting language which is what this is.  The documentation governing this isn&#39;t all that clear when it comes to putting these scripts into the command block (actual Ruby code works no problem.)"}], "answers": [{"comments": [{"owner": {"reputation": 1317, "user_id": 2013212, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ad34e90fc30380965ee659d6a825b8c?s=128&d=identicon&r=PG", "display_name": "Jonathon Nordquist", "link": "https://stackoverflow.com/users/2013212/jonathon-nordquist"}, "edited": false, "score": 0, "creation_date": 1538662932, "post_id": 52618541, "comment_id": 92230036, "body": "And that worked like a charm!  Don&#39;t know how I missed that when I was setting this up, but the run method is the secret sauce I needed.  Can&#39;t thank you enough, you have no idea how much this is going to increase my productivity."}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 2, "last_activity_date": 1538530560, "creation_date": 1538530560, "answer_id": 52618541, "question_id": 52611949, "link": "https://stackoverflow.com/questions/52611949/trying-to-run-pry-command-in-custom-pry-command/52618541#52618541", "title": "Trying to run pry command in custom pry command", "body": "<p>You're missing <a href=\"https://github.com/pry/pry/wiki/Command-system#Custom_commands\" rel=\"nofollow noreferrer\"><code>run</code></a> which is required for running other <code>pry</code> commands:</p>\n\n<pre><code>Pry::Commands.block_command 'fifty', 'List the last fifty inputs' do |x|\n  run 'hist --tail=50 -a'\nend\n</code></pre>\n"}], "owner": {"reputation": 1317, "user_id": 2013212, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ad34e90fc30380965ee659d6a825b8c?s=128&d=identicon&r=PG", "display_name": "Jonathon Nordquist", "link": "https://stackoverflow.com/users/2013212/jonathon-nordquist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 52618541, "answer_count": 1, "score": 2, "last_activity_date": 1539787266, "creation_date": 1538495278, "last_edit_date": 1539787266, "question_id": 52611949, "link": "https://stackoverflow.com/questions/52611949/trying-to-run-pry-command-in-custom-pry-command", "title": "Trying to run pry command in custom pry command", "body": "<p>I'm trying to customize my Pry a bit (been using Pry for a while but this is the first time I've tried to create a command.)  I want to create a custom command which will grab the last fifty items from my history and I'm building it like so:</p>\n\n<pre><code>Pry::Commands.block_command \"fifty\", \"List the last fifty inputs\" do\n  hist --tail=50 -a\nend\n</code></pre>\n\n<p>Once this is in my .pryrc file it does show if I do 'help fifty' but if I try to run the command I get the following:</p>\n\n<pre><code>NameError: undefined local variable or method `a' for #&lt;#&lt;Class:0x007f8a1ee49aa8&gt;:0x007f8a1e873ed0&gt;\n</code></pre>\n\n<p>My guess is that there is some issue with how the command is scoped within the execution block but my search of the Pry documentation hasn't given me any ideas of how to proceed.  Other commands which don't try to replicate Pry cl commands such as the one from the example</p>\n\n<pre><code>Pry::Commands.block_command \"hello\", \"Say hello to three people\" do |x, y, z|\n  output.puts \"hello there #{x}, #{y}, and #{z}!\"\nend\n</code></pre>\n\n<p>work just fine.  Any input is appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "locking"], "answers": [{"comments": [{"owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "edited": false, "score": 0, "creation_date": 1538503023, "post_id": 52612377, "comment_id": 92162021, "body": "I updated question with code for <code>original_updated_at</code>. If you check in the code I am using <code>handle_conflict</code> which is throwing an exception <code>ActiveRecord::StaleObjectError. </code> if <code>self.updated_at.to_f &gt; original_updated_at</code> is true. I updated"}], "tags": [], "owner": {"reputation": 1041, "user_id": 1454143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/44360e6437e6f1a83b61f34b2485185e?s=128&d=identicon&r=PG", "display_name": "Pierre Michard", "link": "https://stackoverflow.com/users/1454143/pierre-michard"}, "is_accepted": false, "score": 0, "last_activity_date": 1538497227, "last_edit_date": 1538497227, "creation_date": 1538496853, "answer_id": 52612377, "question_id": 52611830, "link": "https://stackoverflow.com/questions/52611830/ruby-does-a-locked-object-stay-locked-if-an-exception-occurs-inside-it/52612377#52612377", "title": "Ruby: Does a locked object stay locked if an exception occurs inside it?", "body": "<p>If you look at the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Locking/Pessimistic.html#method-i-with_lock\" rel=\"nofollow noreferrer\">implementation</a>, you can see that <code>with_lock</code> wraps your block into a transaction. So, when an exception is raised in you block, your transaction is rollbacked and your lock released.</p>\n\n<p>By the way:</p>\n\n<ul>\n<li>locking your record ensures you that you won't have to deal with a StaleObjectError.</li>\n<li>I don't think your code work works, why don't you just update your model:</li>\n</ul>\n\n<p><code>\n self.with_lock do\n   update_your_attributes\n   self.save\n end\n</code></p>\n"}], "owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 570, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538502847, "creation_date": 1538494889, "last_edit_date": 1538502847, "question_id": 52611830, "link": "https://stackoverflow.com/questions/52611830/ruby-does-a-locked-object-stay-locked-if-an-exception-occurs-inside-it", "title": "Ruby: Does a locked object stay locked if an exception occurs inside it?", "body": "<p>I am using <code>with_lock</code> to lock the block of instruction where I am going to call <code>update_all</code>. If an exception is raised inside the block, does a locked object stay locked?</p>\n\n<p>For example, validator:handle_conflict raise the exception <code>ActiveRecord::StaleObjectError</code>, will <code>with_lock</code> release the lock? If it doesn't release lock, how to release the lock when exception is raised?</p>\n\n<pre><code>attr_accessible :original_updated_at\n\ndef original_updated_at\n   @original_updated_at || updated_at.to_f\nend\n\nvalidate :handle_conflict, only: :update_all\n\n\n  def set_total_and_buckets_used\n    begin\n      /////\n\n      else\n        self.with_lock do\n          self.reload\n          attributes[\"updated_at\"] = Time.now.utc\n          Product.where(:id =&gt; self.id).update_all(attributes)\n          self.attributes = attributes\n        end\n      end\n    rescue ActiveRecord::StaleObjectError =&gt; e\n      if tries &lt; MAX_RETRIES\n        tries += 1\n        sleep(1 + tries)\n        retry\n      else\n        raise Exception.new(timeout.inspect)\n      end\n    end\n    attributes\n  end\n\n\n  def handle_conflict\n    if self.updated_at.to_f &gt; original_updated_at\n      @original_updated_at = nil\n      raise ActiveRecord::StaleObjectError.new(\"Car is changed while you were editing\")\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1538494765, "post_id": 52611734, "comment_id": 92157860, "body": "&quot;Do you know why?&quot; - yes. Because it&#39;s not initialized or initialized to nil. But it&#39;s impossible to tell why, without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1538494858, "post_id": 52611734, "comment_id": 92157924, "body": "Because instance variables can&#39;t be shared across methods. So <code>@last_known</code> which is defined in <code>first_position</code> can&#39;t be available in <code>default_position</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1538494939, "post_id": 52611734, "comment_id": 92157983, "body": "@pavan what are you talking about? Are you thinking of some other type of variables?"}, {"owner": {"reputation": 302, "user_id": 458436, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7c9c313508675096278e052afa05b707?s=128&d=identicon&r=PG", "display_name": "Emad Elsaid", "link": "https://stackoverflow.com/users/458436/emad-elsaid"}, "edited": false, "score": 0, "creation_date": 1538495080, "post_id": 52611734, "comment_id": 92158073, "body": "please try a simpler approach just to make sure of the problem, because I see a branch there, try putting &quot;binding.pry&quot; or byebug or any breakpoint in <code>first_position</code> after the <code>else</code> line, make sure this block gets executed in the first place."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1538495171, "post_id": 52611734, "comment_id": 92158149, "body": "@SergioTulentsev Auh.. I mean <code>@last_known</code> variable won&#39;t be available to <code>default_position</code> method because its not defined. Am I wrong?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1538496858, "post_id": 52611734, "comment_id": 92159204, "body": "@Pavan: yes, you are. If you&#39;re not confusing this with local variables, I don&#39;t know how you got your ruby/rails badges :)"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1538497656, "post_id": 52611734, "comment_id": 92159592, "body": "@SergioTulentsev I&#39;m not wrong. I&#39;ve checked myself running a sample code. How an instance variable which is defined in one method will be available to another method? :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1538497914, "post_id": 52611734, "comment_id": 92159723, "body": "@Pavan: I&#39;d like to see code of that test :) &quot;How an instance variable ... will be available in another method&quot; - that&#39;s what they <b>do</b>."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1538498526, "post_id": 52611734, "comment_id": 92160052, "body": "@Pavan copy-paste this in your IRB console to see it working: <code>class A ; def set ; @some_var = 12 ; end ; def get ; @some_var ; end ; end ; a = A.new ; a.set ; a.get</code> (<code>set</code> method assign a value to the instance variable <code>@some_var</code>, method <code>get</code> returns the value for that instance variable). If <code>get</code> is called <i>before</i> <code>set</code>, then you will end up with <code>nil</code> instead of <code>12</code>"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1538499648, "post_id": 52611734, "comment_id": 92160514, "body": "Alright, Alright I need a break :)"}, {"owner": {"reputation": 346, "user_id": 1242975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9ce71b4850b15fbbc1cd762be2364f6?s=128&d=identicon&r=PG", "display_name": "lual", "link": "https://stackoverflow.com/users/1242975/lual"}, "edited": false, "score": 0, "creation_date": 1538501770, "post_id": 52611734, "comment_id": 92161459, "body": "don&#39;t know if this could be the problem but rails 4 cancels further processing if a filter returns false... <a href=\"https://api.rubyonrails.org/v4.2.0/classes/ActiveRecord/Callbacks.html#module-ActiveRecord::Callbacks-label-Canceling+callbacks\" rel=\"nofollow noreferrer\">api.rubyonrails.org/v4.2.0/classes/ActiveRecord/&hellip;</a> that seems to be possible in your first_position-method"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1538548626, "post_id": 52611734, "comment_id": 92175772, "body": "Hi, thanks for your answers. If I break after the else condition in <code>first_position</code>, I can see the value of <code>@last_known</code>, so it&#39;s initialized, that&#39;s why I don&#39;t understand my problem"}], "answers": [{"comments": [{"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1538548742, "post_id": 52613367, "comment_id": 92175834, "body": "Hi @Marcin, thanks for your answer. If I break after the else condition in <code>first_position</code>, I can see the vlue of <code>@last_known</code>, that&#39;s why I don&#39;t understand my problem :/"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1538567098, "post_id": 52613367, "comment_id": 92185841, "body": "@escanxr is it possible your <code>after_commit</code> is not failing after creating, but perhaps after updating an object? Without the full stacktrace it is difficult to pinpoint the problem."}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1538569160, "post_id": 52613367, "comment_id": 92187000, "body": "Yes @Marcin it was the problem, so I used another method for doing what I wanted. Sorry for the lack of precision, there is so much code that if I had to put everything it would be huge and unclear.. Thanks for your help"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1538569312, "post_id": 52613367, "comment_id": 92187106, "body": "Ah, okay. Usually it helps to paste the stacktrace, somebody would&#39;ve caught that you&#39;re updating the records somewhere :)"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1538569961, "post_id": 52613367, "comment_id": 92187533, "body": "Yep, sorry, I will give more informations and explain better next time!"}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": false, "score": 0, "last_activity_date": 1538569289, "last_edit_date": 1538569289, "creation_date": 1538500997, "answer_id": 52613367, "question_id": 52611734, "link": "https://stackoverflow.com/questions/52611734/why-i-cannot-access-to-this-instance-variable-in-model-from-another-method/52613367#52613367", "title": "Why I cannot access to this instance variable (in model) from another method?", "body": "<p>Initially I thought that ActiveRecord reloads the record sometime before the after_commit, or at least reinitializes it. I've checked with Rails 5.2.1 and nothing happens with instance variables, they remain correctly set. This means that (unless you're using older Rails), there simply are no pictures for the given user and your code does not seem to handle that.</p>\n\n<p>Also, your <code>after_commit</code> will run after you update the object as well, which might be the issue as your variable will not be set in that case.</p>\n"}], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538569289, "creation_date": 1538494593, "last_edit_date": 1538549834, "question_id": 52611734, "link": "https://stackoverflow.com/questions/52611734/why-i-cannot-access-to-this-instance-variable-in-model-from-another-method", "title": "Why I cannot access to this instance variable (in model) from another method?", "body": "<p>I have a method in my model and I call it with <code>before_create</code>:</p>\n\n<pre><code>  def first_position\n    if [...]\n      [...]\n    else\n      @last_known = Picture.where(user_id: user_id).order('position desc').first\n      self.position = nil\n    end\n  end\n</code></pre>\n\n<p>And I have another method that I call with <code>after_commit</code>:</p>\n\n<pre><code>  def default_position\n    pictures = Picture.where(user_id: user_id).where('created_at &gt; ?', @last_known.created_at)\n\n    i = @last_known.position + 1\n    pictures.each do |pic|\n      pic.position = i\n      i += 1\n    end\n  end\n</code></pre>\n\n<p>But in <code>default_position</code>, <code>@last_known</code> returns <strong>nil</strong>. Do you know why?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Well, I discovered that I have two commit, but the one that concerns the picture is second, so <code>@last_known</code> is set at the first commit but disappears at the second commit.</p>\n"}, {"tags": ["ruby", "fileparsing"], "comments": [{"owner": {"reputation": 33340, "user_id": 605707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MxKJx.jpg?s=128&g=1", "display_name": "deefour", "link": "https://stackoverflow.com/users/605707/deefour"}, "edited": false, "score": 2, "creation_date": 1538493436, "post_id": 52611315, "comment_id": 92157068, "body": "Don&#39;t you mean <a href=\"http://ruby-doc.org/core-1.9.3/String.html#method-i-include-3F\" rel=\"nofollow noreferrer\"><code>include?</code></a>, not plural <code>includes?</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538501086, "post_id": 52611315, "comment_id": 92161112, "body": "I know what you mean by, &quot;I keep getting an error...&quot;: it looks OK, so maybe if I run it again it will work. It makes no sense but I expect we&#39;ve all done that. You need to take Ruby at her word. If she says a method doesn&#39;t exist, it doesn&#39;t. Here you should have looked for <code>includes?</code> in the documentation for <a href=\"http://ruby-doc.org/core-2.5.1/String.html\" rel=\"nofollow noreferrer\">String</a>. You&#39;d then have spotted your mistake. Alas, I don&#39;t think others are likely to learn anything from this question so you may wish to consider deleting it."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538501584, "post_id": 52611315, "comment_id": 92161362, "body": "Consider using <a href=\"http://ruby-doc.org/core-2.5.1/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\">IO::foreach</a>: <code>File.foreach(file) do |line| ...</code>. btw, <code>File.superclass #=&gt; IO</code>, which is why you often see <code>IO</code> methods having <code>File</code> as their receiver."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538501340, "post_id": 52611385, "comment_id": 92161246, "body": "I hardly think you need to repeat the code, minus one &#39;s&#39;. Your first two sentences are sufficient."}], "tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": 2, "last_activity_date": 1538493473, "creation_date": 1538493473, "answer_id": 52611385, "question_id": 52611315, "link": "https://stackoverflow.com/questions/52611315/cant-parse-line-from-file-in-ruby/52611385#52611385", "title": "Can&#39;t parse line from file in ruby", "body": "<p>That's right, <code>includes?</code> is not defined for <code>String</code> in Ruby. Use <code>include?</code> instead, or <code>[]</code>: <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-include-3F\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.0/String.html#method-i-include-3F</a></p>\n\n<p>So the code should be:</p>\n\n<pre><code>File.open(file).each do |line|\n   if line.include? 'BIOS'\n     array = line.split(' ')\n   end\nend\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10270861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9df664d3c4a3b0f079a5fa3008dc724?s=128&d=identicon&r=PG&f=1", "display_name": "pjano1", "link": "https://stackoverflow.com/users/10270861/pjano1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538493473, "creation_date": 1538493253, "question_id": 52611315, "link": "https://stackoverflow.com/questions/52611315/cant-parse-line-from-file-in-ruby", "title": "Can&#39;t parse line from file in ruby", "body": "<p>I'm going through a file line by line and looking for the word \"BIOS\" in each line because each line that contains the word BIOS has a version number I need. After I see that the line contains the word \"BIOS\" I want to take the entire line, and split it into an array. Here's my code:</p>\n\n<pre><code>File.open(file).each do |line|\n   if line.includes? 'BIOS'\n     array = line.split(\" \")\n   end\nend\n</code></pre>\n\n<p>The problem I'm having is that I keep getting an error, saying that \"includes?\" is an undefined method. Is there a better way to parse each line of this file for a specific string? </p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4166854, "user_type": "registered", "profile_image": "https://graph.facebook.com/718788627/picture?type=large", "display_name": "Sunil Pai", "link": "https://stackoverflow.com/users/4166854/sunil-pai"}, "edited": false, "score": 0, "creation_date": 1538494885, "post_id": 52611402, "comment_id": 92157948, "body": "Thanks Kris!  This covers the basic concepts.  I have 2 queries/ doubts - a) How do I test for the code outside the class, but still in the same file? (Input from user) b) How do I pass variables to the get_passenger_seating method in the test?"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 23, "user_id": 4166854, "user_type": "registered", "profile_image": "https://graph.facebook.com/718788627/picture?type=large", "display_name": "Sunil Pai", "link": "https://stackoverflow.com/users/4166854/sunil-pai"}, "edited": false, "score": 0, "creation_date": 1538495742, "post_id": 52611402, "comment_id": 92158510, "body": "a) try and put as much inside another class as possible, so that outside the class is just things like <code>gets</code> and <code>puts</code> (i.e. the user interface), no logic. If you want to test the UI, i.e. fake user input, then I&#39;d start a new question. b) Not sure what you mean..."}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 1, "last_activity_date": 1538493527, "creation_date": 1538493527, "answer_id": 52611402, "question_id": 52611259, "link": "https://stackoverflow.com/questions/52611259/rspecs-with-ruby-file/52611402#52611402", "title": "Rspecs with ruby file", "body": "<p>As a simple example say we have our file for a <code>Foo</code> class, <code>foo.rb</code>:</p>\n\n<pre><code>class Foo\n  def call\n    'bar'\n  end\nend\n</code></pre>\n\n<p>We can create a spec, <code>foo_spec.rb</code>:</p>\n\n<pre><code>require 'rspec'\nrequire_relative 'foo'\n\nRSpec.describe Foo do\n  describe '#call' do\n    it 'works' do\n      expect(described_class.new.call).to eq 'Bar'\n    end\n  end\nend\n</code></pre>\n\n<p>And then from the command line we can run the spec:</p>\n\n<pre><code>$ rspec foo_spec.rb\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4166854, "user_type": "registered", "profile_image": "https://graph.facebook.com/718788627/picture?type=large", "display_name": "Sunil Pai", "link": "https://stackoverflow.com/users/4166854/sunil-pai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538493527, "creation_date": 1538493064, "last_edit_date": 1538493496, "question_id": 52611259, "link": "https://stackoverflow.com/questions/52611259/rspecs-with-ruby-file", "title": "Rspecs with ruby file", "body": "<p>I have a ruby file airplane.rb</p>\n\n<p>with a ruby class like so -</p>\n\n<pre><code>class AirplaneSeat\n attr_accessor :seat_row, :seat_column, :type, :order, :assigned_passenger\n\n  def initialize(seat_row, seat_column, type, order, assigned_passenger = 0)\n    @seat_row = seat_row\n    @seat_column = seat_column\n    @type = type\n    @order = order\n    @assigned_passenger = assigned_passenger\n  end\n\n  def get_passenger_seating\n    #some code   \n  end\nend # end of class\n\n# outside the class\nbegin\n  puts \"Enter the seating matrix as 2D array\"\n  seat_matrix = JSON.parse gets.chomp\n\n  puts \"Enter the number of passengers\"\n  no_of_passengers = gets.chomp\n  raise \"Please enter a valid passenger count\" if (no_of_passengers.empty? || no_of_passengers.to_i &lt;=0)\n\n  AirplaneSeat.get_passenger_seating(seat_matrix, no_of_passengers)\nrescue Exception =&gt; e\n  puts \"Error encountered -&gt; #{e.message}\"\nend\n</code></pre>\n\n<p>So the ruby class has a few methods and couple of lines of code to execute outside the class, which takes input from the user and then calls the class method.</p>\n\n<p>How do I go about writing test cases for this? I have the rspecs gem and spec folder setup done. \nI don't really understand how to begin with the test cases.\nAny pointers greatly appreciated.\nThanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1538490116, "post_id": 52610261, "comment_id": 92154989, "body": "Seems like the response isn&#39;t JSON. Check if you can visit the URL with your provided key manually. Also is the space at the end of <code>ENV[&quot;a4211b7526158c71df283b3b5097eb36 &quot;]</code> intentional? Otherwise this might result in a <code>nil</code> value passed to the request as key."}, {"owner": {"reputation": 15, "user_id": 10298861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q0xzO-ovRtg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaORhFzxWCSSZvoMKHVD2apAELLPWA/mo/photo.jpg?sz=128", "display_name": "The Digital Academy", "link": "https://stackoverflow.com/users/10298861/the-digital-academy"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1538490683, "post_id": 52610261, "comment_id": 92155351, "body": "when i tried to access it manually it returns 403 forbidden"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10298861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q0xzO-ovRtg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaORhFzxWCSSZvoMKHVD2apAELLPWA/mo/photo.jpg?sz=128", "display_name": "The Digital Academy", "link": "https://stackoverflow.com/users/10298861/the-digital-academy"}, "edited": false, "score": 0, "creation_date": 1538491067, "post_id": 52610543, "comment_id": 92155585, "body": "yes it works this way.can you tell me what was wrong because before this i was also using right api key provided to me .when i signed up??"}, {"owner": {"reputation": 313, "user_id": 8257992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dbe2ad1643b4da1dc84e4a16f857ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Jekys", "link": "https://stackoverflow.com/users/8257992/jekys"}, "reply_to_user": {"reputation": 15, "user_id": 10298861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q0xzO-ovRtg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaORhFzxWCSSZvoMKHVD2apAELLPWA/mo/photo.jpg?sz=128", "display_name": "The Digital Academy", "link": "https://stackoverflow.com/users/10298861/the-digital-academy"}, "edited": false, "score": 0, "creation_date": 1538491717, "post_id": 52610543, "comment_id": 92155992, "body": "My script setup default key if ENV key is empty  If string <code>ENV[&#39;FOOD2FORK_KEY&#39;] || &#39;YOUR_API_KEY_HERE&#39;</code> works but string <code>ENV[&#39;FOOD2FORK_KEY&#39;]</code> doesn&#39;t works it means that you don&#39;t have <code>FOOD2FORK_KEY</code> in your ENV, because you have to setup it in your environment before you start your script. Simple example <a href=\"https://rubyplus.com/articles/2261-Ruby-Basics-Setting-Environment-variables\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 313, "user_id": 8257992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dbe2ad1643b4da1dc84e4a16f857ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Jekys", "link": "https://stackoverflow.com/users/8257992/jekys"}, "is_accepted": false, "score": 0, "last_activity_date": 1538490648, "creation_date": 1538490648, "answer_id": 52610543, "question_id": 52610261, "link": "https://stackoverflow.com/questions/52610261/didnt-get-a-specific-answer/52610543#52610543", "title": "didn&#39;t get a specific answer", "body": "<p>It seems like you are sending wrong api key</p>\n\n<p>Try to do it like this:</p>\n\n<pre><code>class Recipe\n    include HTTParty\n\n    key_value = ENV['FOOD2FORK_KEY'] || 'YOUR_API_KEY_HERE'\n\n    base_uri \"http://food2fork.com/api\"\n    default_params key: key_value\n    default_options.update(verify: false)\n    format :json\n\n    def self.for(search_string)\n        get('/search', { query: { q: search_string}})[\"recipes\"]\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10298861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q0xzO-ovRtg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaORhFzxWCSSZvoMKHVD2apAELLPWA/mo/photo.jpg?sz=128", "display_name": "The Digital Academy", "link": "https://stackoverflow.com/users/10298861/the-digital-academy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1538490965, "creation_date": 1538489727, "last_edit_date": 1538490965, "question_id": 52610261, "link": "https://stackoverflow.com/questions/52610261/didnt-get-a-specific-answer", "title": "didn&#39;t get a specific answer", "body": "<p>i'm working with ruby and consuming an api called <strong>food2fork.com</strong>\nwhere i have two files \n<code>recipes_controller.rb</code> and <code>recipes.rb</code></p>\n\n<pre><code>#recipes.rb\n\nrequire 'httparty'\n\nclass Recipe\n  include HTTParty \n\n  default_options.update(verify: false)\n  base_uri \"http://food2fork.com/api\"\n  default_params  key: ENV[\"FOOD2FORK_KEY\"]\n  format :json\n\n  def self.for (para)\n    get(\"/search\",query: {q:para})[\"recipes\"]\n  end\nend\n</code></pre>\n\n<p>and the second file <code>recipes_controller.rb</code></p>\n\n<pre><code>require_relative 'recipes'\nputs Recipe.for(\"chocolate\")\n</code></pre>\n\n<p>but when i run <code>recipes_controller.rb</code> file in command line.i get an error</p>\n\n<pre><code>    `\n  C:\\Users\\Hamza\\module-3-assignment-1&gt;ruby recipes_controller.rb\n  C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/json/common.rb:156:in `parse': \n  822: unexpected token at 'FORBIDDEN' (JSON::ParserError)\n    from C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/json/common.rb:156:in ` \n   parse'\n    from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/httparty- \n    0.16.2/lib/httparty/parser.rb:125:in `json'\n    from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/httparty- \n    0.16.2/lib/httparty/parser.rb:145:in `parse_supported_format'\n    from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/httparty- \n   0.16.2/lib/httparty/parser.rb:110:in `parse'\n    from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/httparty- \n   0.16.2/lib/httparty/parser.rb:69:in `call'\n    from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/httparty- \n   0.16.2/lib/httparty/request.rb:391:in `parse_response'\n    from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/httparty- \n    0.16.2/lib/httparty/request.rb:359:in `block in handle_response'\n    from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/httparty- \n    0.16.2/lib/httparty/response.rb:25:in `parsed_response'\n    from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/httparty- \n   0.16.2/lib/httparty/response.rb:96:in `method_missing'\n    from C:/Users/Hamza/module-3-assignment-1/receipes.rb:12:in `for'\n    from recipes_controller.rb:4:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 1, "creation_date": 1538487976, "post_id": 52609628, "comment_id": 92153640, "body": "what are the association between post/connection/user?"}, {"owner": {"reputation": 500, "user_id": 2338769, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/rWbFL.jpg?s=128&g=1", "display_name": "Praveen KJ", "link": "https://stackoverflow.com/users/2338769/praveen-kj"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1538488047, "post_id": 52609628, "comment_id": 92153682, "body": "@AndreyDeineko No. between user&#39;s posts and his friend&#39;s aka connection&#39;s posts."}, {"owner": {"reputation": 500, "user_id": 2338769, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/rWbFL.jpg?s=128&g=1", "display_name": "Praveen KJ", "link": "https://stackoverflow.com/users/2338769/praveen-kj"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1538488165, "post_id": 52609628, "comment_id": 92153768, "body": "@AndreyDeineko Okay. I will edit question with the codes."}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1538489579, "post_id": 52609628, "comment_id": 92154666, "body": "how looks connection.rb?"}], "answers": [{"comments": [{"owner": {"reputation": 500, "user_id": 2338769, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/rWbFL.jpg?s=128&g=1", "display_name": "Praveen KJ", "link": "https://stackoverflow.com/users/2338769/praveen-kj"}, "edited": false, "score": 0, "creation_date": 1538488761, "post_id": 52609879, "comment_id": 92154185, "body": "Okay. Will try."}, {"owner": {"reputation": 500, "user_id": 2338769, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/rWbFL.jpg?s=128&g=1", "display_name": "Praveen KJ", "link": "https://stackoverflow.com/users/2338769/praveen-kj"}, "edited": false, "score": 0, "creation_date": 1538488957, "post_id": 52609879, "comment_id": 92154312, "body": "current_user.post_ids works but for connection_post_ids i am getting undefined method `post_ids&#39; for #&lt;ActiveRecord::ConnectionAdapters::PostgreSQLAdapter:0x0000&zwnj;&#8203;7fba958160f8&gt; error."}, {"owner": {"reputation": 500, "user_id": 2338769, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/rWbFL.jpg?s=128&g=1", "display_name": "Praveen KJ", "link": "https://stackoverflow.com/users/2338769/praveen-kj"}, "edited": false, "score": 0, "creation_date": 1538489585, "post_id": 52609879, "comment_id": 92154673, "body": "Hi..its working for connections too with following code: &lt;% current_user.networks.each {|network| connection_post_ids.push network.connection.post_ids} %&gt; where connection_post_ids = [] declared as empty array. However now the result has two arrays [[45,34,54,24,53]]. Can you please help how to remove one array."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 500, "user_id": 2338769, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/rWbFL.jpg?s=128&g=1", "display_name": "Praveen KJ", "link": "https://stackoverflow.com/users/2338769/praveen-kj"}, "edited": false, "score": 0, "creation_date": 1538489691, "post_id": 52609879, "comment_id": 92154732, "body": "if array =  [[45,34,54,24,53]] then call array.flatten to remove the outer array brackets"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1538489532, "last_edit_date": 1538489532, "creation_date": 1538488551, "answer_id": 52609879, "question_id": 52609628, "link": "https://stackoverflow.com/questions/52609628/merging-two-activerecord-associations-collections-into-single-association-collec/52609879#52609879", "title": "Merging two ActiveRecord associations collections into single Association collection", "body": "<p>Try:</p>\n\n<pre><code>user_post_ids = current_user.post_ids\nconnection_post_ids = []\ncurrent_user.networks.each do |network|\n  connection_post_ids += network.connection.post_ids\nend\npost_ids = user_post_ids + connection_post_ids\n\nall_posts = Post.where(id: post_ids).order(created_at: :desc)\n</code></pre>\n"}], "owner": {"reputation": 500, "user_id": 2338769, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/rWbFL.jpg?s=128&g=1", "display_name": "Praveen KJ", "link": "https://stackoverflow.com/users/2338769/praveen-kj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 52609879, "answer_count": 1, "score": 1, "last_activity_date": 1538489532, "creation_date": 1538487746, "last_edit_date": 1538488438, "question_id": 52609628, "link": "https://stackoverflow.com/questions/52609628/merging-two-activerecord-associations-collections-into-single-association-collec", "title": "Merging two ActiveRecord associations collections into single Association collection", "body": "<p>I am having a Post model where users can add posts similar to facebook.</p>\n\n<p>In newsfeed i want to show them in descending order with respect to created_at.</p>\n\n<p>The problem is </p>\n\n<pre><code>current_user.posts\n</code></pre>\n\n<p>returns his/her posts whereas </p>\n\n<pre><code>current_user.networks.each {|network| network.connection.posts}\n</code></pre>\n\n<p>returns his connection's posts.</p>\n\n<p>I want to combine both the results so that i can write something like</p>\n\n<pre><code>all_posts.order(created_at: :desc)\n</code></pre>\n\n<p>or is there a better way to do it?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>With codes</p>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>has_many :posts\n</code></pre>\n\n<p><strong>post.rb</strong></p>\n\n<pre><code>belongs_to :user\n</code></pre>\n\n<p><strong>network.rb</strong></p>\n\n<pre><code>belongs_to :user\nbelongs_to :connection, class_name: 'User'\n</code></pre>\n\n<p>where network model is a joint and self-referential model and has <em>user_id</em> and <em>connection_id</em> columns and it updates when both users become friends.</p>\n"}, {"tags": ["ios", "ruby", "appium"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "edited": false, "score": 0, "creation_date": 1539785909, "post_id": 52810861, "comment_id": 92629244, "body": "Thanks a lot!That helped"}], "tags": [], "owner": {"reputation": 909, "user_id": 5320558, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Mx1R2G4xfPs/AAAAAAAAAAI/AAAAAAAAAFg/FQtMUfl9LhM/photo.jpg?sz=128", "display_name": "Wasiq Bhamla", "link": "https://stackoverflow.com/users/5320558/wasiq-bhamla"}, "is_accepted": true, "score": 1, "last_activity_date": 1539584978, "creation_date": 1539584978, "answer_id": 52810861, "question_id": 52609320, "link": "https://stackoverflow.com/questions/52609320/appiumtouchaction-new-tap-doesnt-work-correctly/52810861#52810861", "title": "Appium::TouchAction.new.tap doesn&#39;t work correctly", "body": "<p>After going through your code snippet, I assume you are dealing with alert pop-up in iOS device.</p>\n\n<p>In iOS, with Appium Java client, I can deal with pop-up using traditional <code>driver.switchTo().alert();</code>.</p>\n\n<blockquote>\n  <p>Here <code>driver</code> refers to <code>IOSDriver</code>.</p>\n</blockquote>\n\n<p>I'm sure there must be equivalent to this in Ruby as well.</p>\n\n<p>Try using Alert class to accept the alerts instead of tapping on the coordinates.</p>\n"}], "owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 52810861, "answer_count": 1, "score": 0, "last_activity_date": 1539584978, "creation_date": 1538486719, "question_id": 52609320, "link": "https://stackoverflow.com/questions/52609320/appiumtouchaction-new-tap-doesnt-work-correctly", "title": "Appium::TouchAction.new.tap doesn&#39;t work correctly", "body": "<pre><code>And(/^I click OK button in popup$/) do\n  #Appium::TouchAction.new.tap(x:0.64, y:0.57, count: 1).perform\n  Appium::TouchAction.new.tap(x: 270, y: 506,count: 1).perform\nend\n\nAnd(/^I click Allow button in popup$/) do\n  #Appium::TouchAction.new.tap(x:0.64, y:0.57, count: 1).perform\n  Appium::TouchAction.new.tap(x: 270, y: 506,count: 1).perform \nend\n</code></pre>\n\n<p>Given the next code, I work with Appium 1.9.1, Ruby 2.3.7 and Cucumber to automate iOS app, if I'm passing relative coordinates (percentage) - then appium doesn't perform any taps, but, if I comment out lines with absolute coordinates and comment lines with relative coordinates - all taps will work. The strangest thing is that if I use relative coordinates in 1st line and absolute coordinates in second line - it will perform first tap, but won't perform second.\nMy goal is to use relative coordinates everywhere, so tests will be usable on devices with any screen resolution, please advice, if there are any known solutions to use relative coordinates (or if I'm doing smth wrong)</p>\n"}, {"tags": ["ruby", "string", "file"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1538485222, "post_id": 52608845, "comment_id": 92151767, "body": "What do you mean &quot;two different strings&quot;? Given your input above, what should be the output (and why)?"}, {"owner": {"reputation": 3, "user_id": 9063466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda22565e06ce9093c3f13662fe7738b?s=128&d=identicon&r=PG&f=1", "display_name": "ohmni", "link": "https://stackoverflow.com/users/9063466/ohmni"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1538485350, "post_id": 52608845, "comment_id": 92151833, "body": "Hi Sergio, sorry for being unclear, the output in this case SHOULD be   &quot;Current things: abc ghi&quot;, updating the question as well."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1538485416, "post_id": 52608845, "comment_id": 92151880, "body": "why not &quot;abc def&quot;?"}, {"owner": {"reputation": 3, "user_id": 9063466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda22565e06ce9093c3f13662fe7738b?s=128&d=identicon&r=PG&f=1", "display_name": "ohmni", "link": "https://stackoverflow.com/users/9063466/ohmni"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1538485599, "post_id": 52608845, "comment_id": 92151997, "body": "Cause I don&#39;t want that, I want line 1 and 3 without using line numbers cause they might change  If you want you can substitute abc with foo, def with bur and ghi with bar, i want foo bar, not foo bur."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1538488804, "post_id": 52608845, "comment_id": 92154205, "body": "Do you expect the lines to be added to output only if they are in 2 subsequent lines? Or all matches, but unique? It seems like your input would product <code>abc ghi abc ghi</code>"}, {"owner": {"reputation": 3, "user_id": 9063466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda22565e06ce9093c3f13662fe7738b?s=128&d=identicon&r=PG&f=1", "display_name": "ohmni", "link": "https://stackoverflow.com/users/9063466/ohmni"}, "edited": false, "score": 0, "creation_date": 1538742185, "post_id": 52608845, "comment_id": 92260766, "body": "I wanted all matches, which I got in the answer below."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1538485592, "post_id": 52608950, "comment_id": 92151994, "body": "This will produce &quot;Current things: abc ghi abc ghi&quot;"}], "tags": [], "owner": {"reputation": 196, "user_id": 7111504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZuKH.jpg?s=128&g=1", "display_name": "Macro", "link": "https://stackoverflow.com/users/7111504/macro"}, "is_accepted": true, "score": 0, "last_activity_date": 1538485510, "creation_date": 1538485510, "answer_id": 52608950, "question_id": 52608845, "link": "https://stackoverflow.com/questions/52608845/ruby-put-multiple-lines-from-file/52608950#52608950", "title": "Ruby: Put multiple lines from file", "body": "<p>You could use an array to store the matching lines and then print them when finished iterating.</p>\n\n<pre><code>File.open(filename) do |f|\n  matching_lines = []\n  f.each_line do |line|\n    if line =~ /abc/ || line =~ /ghi/\n      matching_lines &lt;&lt; line\n    end\n  end\n  puts \"Current things: #{matching_lines.join(' ')}\" unless matching_lines.empty?\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1538503833, "post_id": 52610104, "comment_id": 92162381, "body": "I suggest you use <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a> rather than <code>inject</code> (aka <code>reduce</code>), in part to get rid of that pesky <code>arr</code> (or <code>set</code>) after the colon: <code>File.foreach(filename, chomp: true).each_with_object([]) { |line, arr| arr &lt;&lt; line if line.match?(&#47;abc|ghi&#47;) }</code>. <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-match-3F\" rel=\"nofollow noreferrer\">String#match?</a>, which, imo, reads better than <code>=~</code>, made its debut in MRI v2.4. I wasn&#39;t aware of <code>chomp: true</code>. Good to know."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1538506007, "post_id": 52610104, "comment_id": 92163420, "body": "I actually much prefer using <code>each_with_object</code> over <code>inject</code> when possible, but for some reason I was convinced it was a Rails extension to Enumerable. Big thanks for pointing that out, I guess we both learned today :). I would have used <code>match?</code> had I been writing this from scratch, but still, a valid point. I&#39;ll edit the answer to make use of your comments, thanks again."}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": false, "score": 1, "last_activity_date": 1538506117, "last_edit_date": 1538506117, "creation_date": 1538489216, "answer_id": 52610104, "question_id": 52608845, "link": "https://stackoverflow.com/questions/52608845/ruby-put-multiple-lines-from-file/52610104#52610104", "title": "Ruby: Put multiple lines from file", "body": "<p>An alternative, a bit shorter solution:</p>\n\n<pre><code>lines = File.foreach(filename, chomp: true).each_with_object([]) do |line, arr|\n  arr &lt;&lt; line if line.match?(/abc|ghi/)\nend\nputs \"Current things: #{lines.join(' ')}\" if lines.any?\n# =&gt; Current things: abc ghi abc ghi\n</code></pre>\n\n<p>If you want unique lines:</p>\n\n<pre><code>require 'set'\nlines = File.foreach(filename, chomp: true).each_with_object(Set.new) do |line, set|\n  set.add(line) if line.match?(/abc|ghi/)\nend\nputs \"Current things: #{lines.to_a.join(' ')}\" if lines.any?\n# =&gt; Current things: abc ghi\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9063466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda22565e06ce9093c3f13662fe7738b?s=128&d=identicon&r=PG&f=1", "display_name": "ohmni", "link": "https://stackoverflow.com/users/9063466/ohmni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 52608950, "answer_count": 2, "score": -1, "last_activity_date": 1538506117, "creation_date": 1538485116, "last_edit_date": 1538485382, "question_id": 52608845, "link": "https://stackoverflow.com/questions/52608845/ruby-put-multiple-lines-from-file", "title": "Ruby: Put multiple lines from file", "body": "<p>Right, so I have a file in which I want to get two different strings </p>\n\n<p>text.txt: </p>\n\n<pre><code>abc\ndef\nghi\njkl\nabc\nghi\n</code></pre>\n\n<p>How would I go about reading this and printing out two lines? \nI'm currently here: </p>\n\n<pre><code>File.open(filename) do |f|\n  f.each_line do |line|\n    if line =~ /abc/ \n      puts \"Current things: #{line}\"\n      end\n   end\nend\n</code></pre>\n\n<p>I was thinking something like this (which obv doesn't work hence the question) </p>\n\n<pre><code>File.open(filename) do |f|\n  f.each_line do |line,line2|\n    if line =~ /abc/ and line2 =~ /ghi/\n      puts \"Current things: #{line} #{line2}\"\n      end\n   end\nend\n</code></pre>\n\n<p>Am I WAY out on this one? </p>\n\n<p>expected output: </p>\n\n<pre><code>Current things: abc ghi\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 5, "last_activity_date": 1538483794, "creation_date": 1538483794, "answer_id": 52608496, "question_id": 52608428, "link": "https://stackoverflow.com/questions/52608428/find-value-in-ruby-hash/52608496#52608496", "title": "Find value in Ruby hash", "body": "<p>You're passing <code>\"SEK\"</code> as the <code>currency</code> argument and then try to access a hash value by:</p>\n\n<pre><code>currency.to_sym\n</code></pre>\n\n<p>But it returns <code>:SEK</code> instead of <code>:sek</code>. You probably need to fix it to:</p>\n\n<pre><code>currency.downcase.to_sym\n</code></pre>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 52608496, "answer_count": 1, "score": -1, "last_activity_date": 1538483794, "creation_date": 1538483590, "question_id": 52608428, "link": "https://stackoverflow.com/questions/52608428/find-value-in-ruby-hash", "title": "Find value in Ruby hash", "body": "<p>I have this Ruby hash this I use to get amount limits:</p>\n\n<pre><code>AMOUNT_LIMITS_FOR_TRX_TYPE = {\n    zimpler: {\n      eur: { min: 3_50,     max: 15_00_00 },\n      sek: { min: 35_00,    max: 15_000_00 }\n    },\n    qiwi: {\n      eur: { min: 5_00,     max: 350_00 },\n      usd: { min: 5_00,     max: 500_00 },\n      rub: { min: 500_00,   max: 15_000_00 },\n      kzt: { min: 500_00,   max: 74_300_00 }\n    },\n    payu: {\n      czk: { min: 1,        max: 1_000_000_00 },\n      pln: { min: 1,        max: 1_000_000_00 }\n    }\n}.freeze\n\ndef amount_for(transaction_type, currency)\n    p transaction_type\n    p currency\n    min_amount = AMOUNT_LIMITS_FOR_TRX_TYPE[transaction_type.to_sym][currency.to_sym][:min]\n    max_amount = AMOUNT_LIMITS_FOR_TRX_TYPE[transaction_type.to_sym][currency.to_sym][:max]\n    rand(min_amount..max_amount)\n  end\n</code></pre>\n\n<p>I cal the method amount_for with params: <code>:zimpler</code> and <code>\"SEK\"</code> and I get error:</p>\n\n<pre><code>checks.rb:31:in `execute': undefined method `[]' for nil:NilClass (RuntimeError)\n/models/request_builders/request_builder.rb:246:in `amount_for'\n</code></pre>\n\n<p>Do you know where is my mistake and how to fix it?</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1538484519, "post_id": 52608398, "comment_id": 92151383, "body": "Thinking in an iterative style, you want to 1) have an (empty) results variable 2) iterate over the array, 2a) memorizing when you are in an interesting area of the array 2b) by storing start (and end-position) and 2c) add the interesting areas to the result. What exactly goes wrong? Which methods in Array or Enumerable are interesting for you?"}], "answers": [{"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1538486292, "post_id": 52608758, "comment_id": 92152470, "body": "Chunk method, yes, I was expecting a predefined method something like this.Awesome dude! Actually <code>match?</code> method is not working for me, so I used <code>include?</code>, I am using Ruby 2.3.3. Is that the reason?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1538486479, "post_id": 52608758, "comment_id": 92152587, "body": "@Rajagopalan yes, I think <code>String#match?</code> was added around 2.4 (you should upgrade your version btw)"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 0, "last_activity_date": 1538484829, "creation_date": 1538484829, "answer_id": 52608758, "question_id": 52608398, "link": "https://stackoverflow.com/questions/52608398/chunk-array-by-condition/52608758#52608758", "title": "Chunk array by condition", "body": "<pre><code>your_array\n  .chunk { |ary| ary.first.match?(\"Page\") }\n  .each_slice(2)\n  .map { |group| group.flat_map(&amp;:last) }\n#=&gt; [\n#     [[\"Page_1\", nil], [\"ROW1\", \"one\"], [\"ROW2\", \"four\"], [\"ROW3\", \"seven\"], [\"End\", nil]],\n#     [[\"Page_2\", nil], [\"ROW4\", \"Ten\"], [\"ROW5\", \"thirteen\"], [\"End\", nil]],\n#     [[\"Page_4\", nil], [\"ROW6\", \"Sixteen\"], [\"ROW7\", \"Nineteen\"], [\"End\", nil]]\n#   ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1538518804, "post_id": 52614961, "comment_id": 92168529, "body": "I knew you would be coming up with different solution. I made a single mistake by giving page and end in flip flop operator. You came up by the right one. Brilliant, thank you."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1538510536, "last_edit_date": 1538510536, "creation_date": 1538507635, "answer_id": 52614961, "question_id": 52608398, "link": "https://stackoverflow.com/questions/52608398/chunk-array-by-condition/52614961#52614961", "title": "Chunk array by condition", "body": "<p>Your intuition was correct: this is a good application for the <a href=\"https://blog.newrelic.com/engineering/weird-ruby-part-3-fun-flip-flop-phenom/\" rel=\"nofollow noreferrer\">flip-flop</a> operator. If <code>arr</code> is your array, you can write the following.</p>\n\n<pre><code>arr.slice_after { |f,_| true if f=='End' .. f=='End' }.to_a\n  #=&gt; [\n  #     [[\"Page_1\", nil], [\"ROW1\", \"one\"], [\"ROW2\", \"four\"],\n  #      [\"ROW3\", \"seven\"], [\"End\", nil]],\n  #     [[\"Page_2\", nil], [\"ROW4\", \"Ten\"], [\"ROW5\", \"thirteen\"],\n  #      [\"End\", nil]],\n  #     [[\"Page_4\", nil], [\"ROW6\", \"Sixteen\"], [\"ROW7\", \"Nineteen\"],\n  #      [\"End\", nil]]\n  #   ]\n</code></pre>\n\n<p>The flip-flop is turned ON when <code>f == 'End'</code>, causing <code>true</code> to be returned to the block, then, before the next element of the array is passed to the block, it checks the ending condition, <code>f == 'End'</code>, resulting in the flip-flop being turned OFF, causing 'false' to be returned to the block until <code>f == 'End'</code> is <code>true</code> for a subsequent element of the array.</p>\n\n<p>Here's another way.</p>\n\n<pre><code>arr.each_with_object([[]]) do |pair,a|\n  a[-1] &lt;&lt; pair\n  a &lt;&lt; [] if pair.first == \"End\"\nend.tap { |a| a.pop if a[-1].empty? }\n</code></pre>\n"}], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 52608758, "answer_count": 2, "score": 1, "last_activity_date": 1538510536, "creation_date": 1538483488, "last_edit_date": 1538485297, "question_id": 52608398, "link": "https://stackoverflow.com/questions/52608398/chunk-array-by-condition", "title": "Chunk array by condition", "body": "<p>I have array like this</p>\n\n<pre><code>[[\"Page_1\", nil], [\"ROW1\", \"one\"], [\"ROW2\", \"four\"], [\"ROW3\", \"seven\"], [\"End\", nil], [\"Page_2\", nil], [\"ROW4\", \"Ten\"], [\"ROW5\", \"thirteen\"], [\"End\", nil], [\"Page_4\", nil], [\"ROW6\", \"Sixteen\"], [\"ROW7\", \"Nineteen\"], [\"End\", nil]]\n</code></pre>\n\n<p>I want to insert the inner array into another array If array consist of 'Page' and I have stop when the array has 'End',So the resultant array has to be </p>\n\n<pre><code>[\n  [[\"Page_1\", nil], [\"ROW1\", \"one\"], [\"ROW2\", \"four\"], [\"ROW3\", \"seven\"], [\"End\", nil]],\n  [[\"Page_2\", nil], [\"ROW4\", \"Ten\"], [\"ROW5\", \"thirteen\"], [\"End\", nil]], \n  [[\"Page_4\", nil], [\"ROW6\", \"Sixteen\"], [\"ROW7\", \"Nineteen\"], [\"End\", nil]]\n]\n</code></pre>\n\n<p>I tried to use the flip flop operator of ruby but since it's having more than one end, it's taking the entire array, so it doesn't work. Is there any other way I can achieve this in ruby?</p>\n"}, {"tags": ["ruby", "rtf"], "answers": [{"tags": [], "owner": {"reputation": 196, "user_id": 7111504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZuKH.jpg?s=128&g=1", "display_name": "Macro", "link": "https://stackoverflow.com/users/7111504/macro"}, "is_accepted": true, "score": 3, "last_activity_date": 1538487539, "creation_date": 1538487539, "answer_id": 52609568, "question_id": 52607648, "link": "https://stackoverflow.com/questions/52607648/parse-plain-text-from-rtf-text-in-ruby/52609568#52609568", "title": "Parse plain text from rtf text in ruby", "body": "<p>You can use this <a href=\"https://github.com/dj2/Ruby-RTF\" rel=\"nofollow noreferrer\">Ruby-rtf Gem</a></p>\n\n<pre><code>require 'ruby-rtf'\n\ndata = File.read('./rich.rtf')\nparser = RubyRTF::Parser.new\nparsed_text = parser.parse(data).sections.map do |val|\n  val[:text]\nend.join(' ')\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 6493280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-2CD1Eif-TgA/AAAAAAAAAAI/AAAAAAAAAJQ/Kq18hNzk5No/photo.jpg?sz=128", "display_name": "Sunil Jose", "link": "https://stackoverflow.com/users/6493280/sunil-jose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 1, "accepted_answer_id": 52609568, "answer_count": 1, "score": 0, "last_activity_date": 1538487539, "creation_date": 1538480490, "last_edit_date": 1538480617, "question_id": 52607648, "link": "https://stackoverflow.com/questions/52607648/parse-plain-text-from-rtf-text-in-ruby", "title": "Parse plain text from rtf text in ruby", "body": "<p>I have an rtf text shown like below,</p>\n\n<pre><code>{\\rtf1\\ansi\\deff0 {\\fonttbl {\\f0 Courier;}}\n{\\colortbl;\\red0\\green0\\blue0;\\red255\\green0\\blue0;}\nThis line is the default color\\line\n\\cf2\n\\tab This line is red and has a tab before it\\line\n\\cf1\n\\page This line is the default color and the first line on page 2\n}\n</code></pre>\n\n<p>I want to parse plain text from rtf text. Is there any plugins or any other solutions available in ruby, to parse plain text from rtf text?</p>\n"}, {"tags": ["ruby", "testing", "watir"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1538479074, "post_id": 52606925, "comment_id": 92148490, "body": "<code>next if condition</code>... I think."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1538481604, "post_id": 52607387, "comment_id": 92149770, "body": "I think the :css example would still match all items. You&#39;d have to explicitly exclude the unavailable class."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1538481664, "post_id": 52607387, "comment_id": 92149795, "body": "@JustinKo Yeah , you are right, I thought about that while I was writing it, I will remove it now. Thanks."}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 1, "last_activity_date": 1538481685, "last_edit_date": 1538481685, "creation_date": 1538479464, "answer_id": 52607387, "question_id": 52606925, "link": "https://stackoverflow.com/questions/52606925/how-to-skip-an-element-when-iterating-through-a-list-ruby/52607387#52607387", "title": "How to skip an element when iterating through a list Ruby", "body": "<p>When you include the lis using class, you have to be careful because when you locate using <code>menu-index-page__item</code>, it locates everything which <strong>includes</strong> <code>menu-index-page__item</code> so it locates <code>menu-index-page__item menu-index-page__item--unavailable</code> as well. So try forming xpath in this place, it would work</p>\n\n<pre><code>$browser.divs(class: 'menu-index-page__menu-category').map do |cat|\n  cate = cat.h3.text\n  puts cate\n\n  cc = cat.ul(class: 'menu-index-page__items')\n  cc.lis(xpath: \"//li[@class='menu-index-page__item']\").each do |lit|\n    lit.fire_event :click\n  end\nend\n</code></pre>\n\n<p>Or you can exclude the specific list this way</p>\n\n<pre><code>$browser.divs(class:'menu-index-page__menu-category').map do |cat|\n  cate = cat.h3.text\n  puts cate\n\n  cc = cat.ul(class:'menu-index-page__items')\n  cc.lis(xpath: \"//li[not(@class=menu-index-page__item menu-index-page__item--unavailable')]\").each do |lit|\n    lit.fire_event :click\n  end\nend\n</code></pre>\n\n<p>And also never do click via <code>fireevent</code> because that's the javascript click, it's not a selenium click, you would be missing many events which would be triggered after the click.</p>\n\n<p>So perform</p>\n\n<pre><code>lit.click\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "edited": false, "score": 0, "creation_date": 1538484264, "post_id": 52607860, "comment_id": 92151218, "body": "I would like to click on &#39;menu-index-page__item&#39; and ignore/skip &#39;!menu-index-page__item--unavailable&#39; right now it tries to click on &#39;!menu-index-page__item--unavailable&#39; which is what breaks the script."}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "edited": false, "score": 1, "creation_date": 1538486466, "post_id": 52607860, "comment_id": 92152579, "body": "That is what this would do. It would only iterate over the <code>li</code> that have &quot;menu-index-page__item&quot; but do not have &quot;menu-index-page__item--unavailable&quot;. So your click would only be on these ones you want."}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "edited": false, "score": 0, "creation_date": 1538487604, "post_id": 52607860, "comment_id": 92153399, "body": "Perhaps I&#39;m misinterpreting the statement &quot;once in a while the name of the class list changes&quot;. When does the class change? If it&#39;s before you run the above loop, this solution works. If it changes while you are iterating, we&#39;ll need a different solution."}, {"owner": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "edited": false, "score": 0, "creation_date": 1538490674, "post_id": 52607860, "comment_id": 92155345, "body": "ahhh perfect I didn&#39;t pay attention to the exclamation mark, works superbly. Many Thanks"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1538491004, "post_id": 52607860, "comment_id": 92155549, "body": "If this answer answers your question , please accept this answer. You need to click the tic below the downvote."}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 1, "last_activity_date": 1538481470, "creation_date": 1538481470, "answer_id": 52607860, "question_id": 52606925, "link": "https://stackoverflow.com/questions/52606925/how-to-skip-an-element-when-iterating-through-a-list-ruby/52607860#52607860", "title": "How to skip an element when iterating through a list Ruby", "body": "<p>Assuming that you are using Watir v6.5+, the :class locator supports excluding classes. You can find all elements that include class \"a\", but not \"b\" by doing:</p>\n\n<pre><code>browser.elements(class: ['a', '!b'])\n</code></pre>\n\n<p>For your specific example, you can do:</p>\n\n<pre><code>cc.lis(class: ['menu-index-page__item', '!menu-index-page__item--unavailable']).each do |lit|\n  # your actions on lit\nend\n</code></pre>\n"}], "owner": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 52607860, "answer_count": 2, "score": 1, "last_activity_date": 1538544677, "creation_date": 1538477589, "last_edit_date": 1538544677, "question_id": 52606925, "link": "https://stackoverflow.com/questions/52606925/how-to-skip-an-element-when-iterating-through-a-list-ruby", "title": "How to skip an element when iterating through a list Ruby", "body": "<p>I have the following script which loops through an element list:</p>\n\n<pre><code>  $browser.divs(class:'menu-index-page__menu-category').map do |cat|\n  cate = cat.h3.text\n  puts cate\n\n  cc = cat.ul(class:'menu-index-page__items')\n  cc.lis(class:'menu-index-page__item').each do |lit|\n    lit.fire_event :click\n    sleep(5)\n</code></pre>\n\n<p>Once in a while the name of the class list changes to: </p>\n\n<pre><code>menu-index-page__item menu-index-page__item--unavailable\n</code></pre>\n\n<p>This breaks the script, and I want to be able to skip this whenever it comes up and continue with the original script. </p>\n\n<p><a href=\"https://i.stack.imgur.com/3Sh1P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Sh1P.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 3, "creation_date": 1538477433, "post_id": 52606839, "comment_id": 92147694, "body": "I guess you should add <code>:id</code> parameter to your <code>like</code> and <code>dislike</code> paths."}, {"owner": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1538477617, "post_id": 52606839, "comment_id": 92147802, "body": "As the above, id go with something like: <code>put &#39;&#47;post&#47;:post_id&#47;comment&#47;:comment_id&#47;upvote&#39;</code> This might change the helper, but thats a simple update."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1538477775, "post_id": 52606839, "comment_id": 92147863, "body": "You should have a look at <a href=\"https://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\"><i>nested resources</i></a> and <a href=\"https://guides.rubyonrails.org/routing.html#adding-more-restful-actions\" rel=\"nofollow noreferrer\"><i>member routes</i></a>"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1538479800, "post_id": 52606839, "comment_id": 92148889, "body": "@DickieBoy I&#39;d avoid deep nesting of resources and instead use <code>put &#39;&#47;comment&#47;:id&#47;upvote&#39;</code>"}, {"owner": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1538491424, "post_id": 52606839, "comment_id": 92155824, "body": "@JohanWentholt I wouldn&#39;t call two layers &quot;deep nesting&quot;, 2 is fine. 3 starts to get a little off, 4 shouldn&#39;t happen,"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1538494410, "post_id": 52606839, "comment_id": 92157651, "body": "@DickieBoy It depends on your definition of <i>deep</i>. However the Ruby guide about nested resources (linked by Pavan) says the following: <i>&quot;Resources should never be nested more than 1 level deep.&quot;</i>"}, {"owner": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1538557886, "post_id": 52606839, "comment_id": 92180516, "body": "@JohanWentholt yeah looks like we have an off by one error, what I call 2 you call 1. Deep for me is 3(2)+ starts to get frustrating getting all the right things in the right place. Although, it has its places. Especially when permissions for the base objects start to get involved."}], "answers": [{"tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": false, "score": 2, "last_activity_date": 1538477463, "creation_date": 1538477463, "answer_id": 52606893, "question_id": 52606839, "link": "https://stackoverflow.com/questions/52606839/ror-how-to-make-an-each-loop-on-views-pass-a-variable-to-the-controller/52606893#52606893", "title": "RoR - how to make an .each loop on views pass a variable to the controller", "body": "<p>You can get id in parameters, please check below methods</p>\n\n<pre><code>def upvote\n\n    object_comment = Comment.find(params[:id])\n    object_comment.increment!(:upvote)\n    redirect_to show_path(@post)\n\n  end\n\n  def downvote\n    object_comment = Comment.find(params[:id])\n    object_comment.increment!(:downvote)\n    redirect_to show_path(@post)\n  end\n....\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 5813088, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/t4Xcg.jpg?s=128&g=1", "display_name": "Jo&#227;o Mateus", "link": "https://stackoverflow.com/users/5813088/jo%c3%a3o-mateus"}, "edited": false, "score": 0, "creation_date": 1538478248, "post_id": 52606944, "comment_id": 92148086, "body": "Many thanks for your quick reply! doing this how should i then use it on my controller? I see what you mean about the &#39;get&#39; method, i&#39;ll look into it. i thought about &#39;put&#39; as a means to update the upvote and downvote parameters from each comment."}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "reply_to_user": {"reputation": 101, "user_id": 5813088, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/t4Xcg.jpg?s=128&g=1", "display_name": "Jo&#227;o Mateus", "link": "https://stackoverflow.com/users/5813088/jo%c3%a3o-mateus"}, "edited": false, "score": 0, "creation_date": 1538478391, "post_id": 52606944, "comment_id": 92148161, "body": "@Jo&#227;oMateus Sorry, I missed that detail. I&#39;ve updated my question."}, {"owner": {"reputation": 101, "user_id": 5813088, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/t4Xcg.jpg?s=128&g=1", "display_name": "Jo&#227;o Mateus", "link": "https://stackoverflow.com/users/5813088/jo%c3%a3o-mateus"}, "edited": false, "score": 1, "creation_date": 1538556930, "post_id": 52606944, "comment_id": 92179988, "body": "Thanks, @AJFaraday, i made it work with your suggestion."}], "tags": [], "owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "is_accepted": true, "score": 3, "last_activity_date": 1538478376, "last_edit_date": 1538478376, "creation_date": 1538477669, "answer_id": 52606944, "question_id": 52606839, "link": "https://stackoverflow.com/questions/52606839/ror-how-to-make-an-each-loop-on-views-pass-a-variable-to-the-controller/52606944#52606944", "title": "RoR - how to make an .each loop on views pass a variable to the controller", "body": "<p>Your <code>*_path</code> methods do not know what to do with that single argument. (If you want to pass an object to your links, you might want to research RESTful routing. However, to solve it with your current routes, I suggest</p>\n\n<pre><code>&lt;%= link_to \"Downvote #{c.downvote}\" dislike_path(id: c.id) %&gt;\n</code></pre>\n\n<p>It should then be possible to access this <code>id</code> attribute in the controller via <code>params</code>.</p>\n\n<pre><code>def dislike\n  @comment = Comment.find(params[:id])\n  ...\nend\n</code></pre>\n\n<hr>\n\n<p>A couple of other things to think about:</p>\n\n<p>It's very unusual to perform a <code>put</code> action on clicking a link. You might want to consider doing this as a <code>get</code> action instead.</p>\n\n<p>Does the <code>downvote</code> method return something which is different for each comment? If not, it's standard practise to include it in the controller's helper.</p>\n"}, {"comments": [{"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1538552369, "post_id": 52608225, "comment_id": 92177690, "body": "The question was about how to pass this variable to the controller, to be used while clicking on a link. This is an answer about how the model is structured."}, {"owner": {"reputation": 1275, "user_id": 2903313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1623b00b100930ac65e69a8069cd28?s=128&d=identicon&r=PG", "display_name": "Roc Khalil", "link": "https://stackoverflow.com/users/2903313/roc-khalil"}, "reply_to_user": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1538561241, "post_id": 52608225, "comment_id": 92182501, "body": "@AJFaraday 100%; but I saw that you had already answered it, so I thought of helping him in model / database structuring :-)"}], "tags": [], "owner": {"reputation": 1275, "user_id": 2903313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1623b00b100930ac65e69a8069cd28?s=128&d=identicon&r=PG", "display_name": "Roc Khalil", "link": "https://stackoverflow.com/users/2903313/roc-khalil"}, "is_accepted": false, "score": 1, "last_activity_date": 1538482846, "creation_date": 1538482846, "answer_id": 52608225, "question_id": 52606839, "link": "https://stackoverflow.com/questions/52606839/ror-how-to-make-an-each-loop-on-views-pass-a-variable-to-the-controller/52608225#52608225", "title": "RoR - how to make an .each loop on views pass a variable to the controller", "body": "<p>I think you're doing it wrong. You'll need to save the user's action on the comment with a model <code>CommentVote</code> for example that belongs to <code>user</code> and <code>comment</code>.</p>\n\n<p>Then you'll need to do something like:</p>\n\n<pre><code>class CommentVote\n  belongs_to :comment\n  belongs_to :user\n  enum type: [:upvote, :downvote]\n\n  def self.vote(type:, comment_id:, user_id:)\n    comment_vote = CommentVote.where(comment_id: comment_id, user_id: user_id).first_or_initialize\n    comment_vote.type = type\n    comment_vote.save\n  end\nend\n</code></pre>\n\n<p>And then do a <code>after_save :update_counts</code> in the <code>CommentVote</code> model:</p>\n\n<pre><code>def update_counts\n  self.comment.upvote = self.comment.comment_votes.upvote.count\n  self.comment.downvote = self.comment.comment_votes.downvote.count\n  self.comment.save\nend\n</code></pre>\n\n<p>and you'll call it like: <code>CommentVote.vote(type: :upvote, comment_id: 1, user_id: 1)</code></p>\n"}], "owner": {"reputation": 101, "user_id": 5813088, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/t4Xcg.jpg?s=128&g=1", "display_name": "Jo&#227;o Mateus", "link": "https://stackoverflow.com/users/5813088/jo%c3%a3o-mateus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 52606944, "answer_count": 3, "score": 0, "last_activity_date": 1538482846, "creation_date": 1538477256, "question_id": 52606839, "link": "https://stackoverflow.com/questions/52606839/ror-how-to-make-an-each-loop-on-views-pass-a-variable-to-the-controller", "title": "RoR - how to make an .each loop on views pass a variable to the controller", "body": "<p>Im trying to add votes to comments on my blog application. But i cant seem to be able to send the variable within the below loop to the controller:</p>\n\n<pre><code>&lt;% @comments.each do |c| %&gt;\n   &lt;h1&gt;&lt;%= c.title %&gt;&lt;/h1&gt;\n   &lt;p&gt;&lt;%= c.content %&gt;&lt;/p&gt;\n   &lt;p&gt;&lt;%= c.user.username %&gt;&lt;/p&gt;\n\n   &lt;% if current_user.id == c.user_id %&gt;\n    &lt;%= link_to \"Edit\",  edit_comment_path(@post, c)%&gt;\n    &lt;%= link_to \"Delete\", delete_comment_path(@post, c), method: :delete, data: { confirm: \"Are you sure?\" }%&gt;\n   &lt;% end %&gt;\n   &lt;% if current_user.id != c.user_id %&gt;\n      &lt;p&gt;Review this comment&lt;/p&gt;\n\n      &lt;%= link_to like_path(c), method: :put do %&gt;\n        Upvote\n        &lt;%= c.upvote %&gt;\n      &lt;% end %&gt;\n\n      &lt;%= link_to dislike_path(c), method: :put do %&gt;\n        Downvote\n        &lt;%= c.downvote %&gt;\n      &lt;% end %&gt;\n   &lt;% end %&gt;\n &lt;% end %&gt;\n</code></pre>\n\n<p>controller:</p>\n\n<pre><code>...\ndef upvote\n\n    object_comment = Comment.find(@comment.id)\n    object_comment.increment!(:upvote)\n    redirect_to show_path(@post)\n\n  end\n\n  def downvote\n    object_comment = Comment.find(@comment.id)\n    object_comment.increment!(:downvote)\n    redirect_to show_path(@post)\n  end\n....\n</code></pre>\n\n<p>Routes:</p>\n\n<pre><code>Rails.application.routes.draw do\n .... \n  #Comments\n  post    '/post/:post_id',                                  to: 'comment#create',    as: 'new_comments'\n  get     '/post/:post_id/:comment_id/edit',                 to: 'comment#edit',      as: 'edit_comment'\n  put     '/post/:post_id/comment/:comment_id',              to: 'comment#update',    as: 'update_comment'\n  delete  '/post/:id/:comment_id/',                          to: 'comment#destroy',   as: 'delete_comment'\n  put     'like',                       to: \"comment#upvote\",    as: 'like'\n  put     'dislike',                                         to: \"comment#downvote\",  as: 'dislike'\n\n\nend\n</code></pre>\n\n<p>I would like to receive the 'c' stated on the each loop as a variable on the upvote and downvote methods to replace the @comment within object_comment = Comment.find(@comment.id), in order to increment the votes. is this possible? </p>\n\n<p>As it is right i obviously receive the following error:</p>\n\n<p>NoMethodError (undefined method `id' for nil:NilClass):</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "rubyzip"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1538475310, "post_id": 52606247, "comment_id": 92146601, "body": "Do you need to do any processing on the zip file? If not why can&#39;t you just attach it directly in your first step, without bothering with any of the rake task?"}, {"owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1538476849, "post_id": 52606247, "comment_id": 92147410, "body": "I don&#39;t want to attach the zip file. I want to attach each file in the zip to a different instance of ProofreadDocument."}, {"owner": {"reputation": 3146, "user_id": 3622415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/873e6fd319032200fd5dc359f5d897eb?s=128&d=identicon&r=PG", "display_name": "kangkyu", "link": "https://stackoverflow.com/users/3622415/kangkyu"}, "edited": false, "score": 0, "creation_date": 1538756761, "post_id": 52606247, "comment_id": 92269430, "body": "Did you try to remove <code>read</code> from <code>file.get_input_stream.read</code>?"}, {"owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1538969134, "post_id": 52606247, "comment_id": 92316487, "body": "Yes and I get a different error."}], "answers": [{"comments": [{"owner": {"reputation": 16860, "user_id": 1536309, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/40f2ef2f2a528a76dbd3667acd154e5c?s=128&d=identicon&r=PG", "display_name": "Blair Anderson", "link": "https://stackoverflow.com/users/1536309/blair-anderson"}, "edited": false, "score": 0, "creation_date": 1549496387, "post_id": 52772513, "comment_id": 95927314, "body": "Can you update to include your FULL code example here? it looks like you have a different variable name in this section than your question uses"}, {"owner": {"reputation": 9153, "user_id": 6570042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlJAF.jpg?s=128&g=1", "display_name": "Gabor Lengyel", "link": "https://stackoverflow.com/users/6570042/gabor-lengyel"}, "edited": false, "score": 0, "creation_date": 1562871775, "post_id": 52772513, "comment_id": 100525677, "body": "It&#39;s such a pity that <code>attach</code> tries to call <code>#size</code> on <code>zip_entry.get_input_stream</code> when trying that directly for <code>io</code>. If size could be passed to <code>attach</code> separately, it would just work directly with <code>io: zip_entry.get_input_stream</code>. Thanks for this hack though! :)"}], "tags": [], "owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "is_accepted": true, "score": 6, "last_activity_date": 1539320190, "creation_date": 1539320190, "answer_id": 52772513, "question_id": 52606247, "link": "https://stackoverflow.com/questions/52606247/how-can-i-use-rubyzip-to-attach-files-in-a-zip-archive-to-an-activestorage-objec/52772513#52772513", "title": "How can I use rubyzip to attach files in a zip archive to an ActiveStorage object Rails 5", "body": "<p>I was able to succeed by wrapping the input stream in a StringIO object as follows:</p>\n\n<pre><code>self.file.attach(io: StringIO.new(zip_entry.get_input_stream.read), filename: zip_entry.name, content_type: MS_WORD_CONTENT_TYPE)\n</code></pre>\n"}], "owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 1, "accepted_answer_id": 52772513, "answer_count": 1, "score": 5, "last_activity_date": 1539320190, "creation_date": 1538475034, "last_edit_date": 1538542884, "question_id": 52606247, "link": "https://stackoverflow.com/questions/52606247/how-can-i-use-rubyzip-to-attach-files-in-a-zip-archive-to-an-activestorage-objec", "title": "How can I use rubyzip to attach files in a zip archive to an ActiveStorage object Rails 5", "body": "<p>I have a model with one attachment that uses ActiveStorage:</p>\n\n<pre><code>class ProofreadDocument &lt; ApplicationRecord\n\n  has_one_attached :file\n\nend\n</code></pre>\n\n<p>I am working on a rake task to attach files to a proofread_document.\nThe files are compressed into a zip archive.</p>\n\n<p>I understand that I can attach the files as follows from reading the ActiveStorage docs:</p>\n\n<pre><code>@proofread_document.file.attach(io: File.open('/path/to/file'), filename: 'file.pdf')\n</code></pre>\n\n<p>I have the following in my rake task:</p>\n\n<pre><code>    Zip::File.open(args.path_to_directory) do |zipfile|\n          zipfile.each do |file|\n            proofread_document = ProofreadDocument.new()\n            proofread_document.file.attach(io: file.get_input_stream.read, filename: file.name)\n            proofread_document.save\n          end\n     end\n</code></pre>\n\n<p>This produces the following error:</p>\n\n<pre><code>NoMethodError: undefined method `read' for #&lt;String:0x007f8d894d95e0&gt;\n</code></pre>\n\n<p>I need to read the contents of each file one at at time to attach them to the proofread_document instance. How can I do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1618, "user_id": 299781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d380305288301a38f4bac69132e19d?s=128&d=identicon&r=PG", "display_name": "Holger Frohloff", "link": "https://stackoverflow.com/users/299781/holger-frohloff"}, "edited": false, "score": 0, "creation_date": 1538473290, "post_id": 52605223, "comment_id": 92145693, "body": "Hi. Have you tried to make sense of this guide? <a href=\"https://guides.rubyonrails.org/autoloading_and_reloading_constants.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/autoloading_and_reloading_constants.h&zwnj;&#8203;tml</a>"}, {"owner": {"reputation": 536, "user_id": 1194682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81dc6254e4ae1e5578bfba393a844bd4?s=128&d=identicon&r=PG", "display_name": "Strika", "link": "https://stackoverflow.com/users/1194682/strika"}, "reply_to_user": {"reputation": 1618, "user_id": 299781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d380305288301a38f4bac69132e19d?s=128&d=identicon&r=PG", "display_name": "Holger Frohloff", "link": "https://stackoverflow.com/users/299781/holger-frohloff"}, "edited": false, "score": 0, "creation_date": 1538484000, "post_id": 52605223, "comment_id": 92151054, "body": "Yes. That was my first place to search for an answer. But I didn&#39;t find anything related to the state I described."}], "answers": [{"comments": [{"owner": {"reputation": 536, "user_id": 1194682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81dc6254e4ae1e5578bfba393a844bd4?s=128&d=identicon&r=PG", "display_name": "Strika", "link": "https://stackoverflow.com/users/1194682/strika"}, "edited": false, "score": 0, "creation_date": 1538484669, "post_id": 52606394, "comment_id": 92151456, "body": "Thanks for your answer. I&#39;m aware of ActiveSupport core extensions that are added to all instances of <code>Object</code> (<code>#blank?</code>, <code>#try</code>, etc). However, in the example I described, some modules from the application code (not Rails) are included into classes that don&#39;t include them explicitly. Do you know where that happens? Also, why would some helpers from the application be included in a class and others not?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 536, "user_id": 1194682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81dc6254e4ae1e5578bfba393a844bd4?s=128&d=identicon&r=PG", "display_name": "Strika", "link": "https://stackoverflow.com/users/1194682/strika"}, "edited": false, "score": 0, "creation_date": 1538485267, "post_id": 52606394, "comment_id": 92151792, "body": "@Strika oh, sorry, I didn&#39;t read this carefully enough. I edited the answer to provide possible way to find out where it comes from, but I&#39;m not sure if it&#39;s gonna work - let me know if it isn&#39;t, maybe we could figure some other way."}, {"owner": {"reputation": 536, "user_id": 1194682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81dc6254e4ae1e5578bfba393a844bd4?s=128&d=identicon&r=PG", "display_name": "Strika", "link": "https://stackoverflow.com/users/1194682/strika"}, "edited": false, "score": 1, "creation_date": 1538717216, "post_id": 52606394, "comment_id": 92248083, "body": "I accepted this answer since the advice helped our team find a couple of smelly spots in our application. One was in tests where several of these helpers were included directly in <code>Object</code>, which lead to the situation I described. Also, other points you mentioned are correct and the tip about using <code>BasicObject</code> is great."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 1, "last_activity_date": 1538485197, "last_edit_date": 1538485197, "creation_date": 1538475527, "answer_id": 52606394, "question_id": 52605223, "link": "https://stackoverflow.com/questions/52605223/where-does-rails-include-modules-in-a-class-from-lib/52606394#52606394", "title": "Where does Rails include modules in a class from lib?", "body": "<p>Your class, unless specified otherwise, inherits from <code>Object</code> and the <code>ActiveSupport</code> adds its own extensions (also) to <code>Object</code> class, like <a href=\"https://github.com/rails/rails/blob/b2eb1d1c55a59fee1e6c4cba7030d8ceb524267c/activesupport/lib/active_support/core_ext/object/json.rb#L49\" rel=\"nofollow noreferrer\">here</a>, with <code>ActiveSupport::ToJsonWithActiveSupportEncoder</code> for example:</p>\n\n<pre><code>[Object, Array, FalseClass, Float, Hash, Integer, NilClass, String, TrueClass, Enumerable].reverse_each do |klass|\n  klass.prepend(ActiveSupport::ToJsonWithActiveSupportEncoder)\nend\n</code></pre>\n\n<p>so to answer your specific questions:</p>\n\n<ol>\n<li>No, if you write class that inherits from <code>BasicObject</code>, none of it will be included, most probably.</li>\n<li>In various places, I gave you one example, you can search for another ones. </li>\n<li>No, it's based on inheritance chain.</li>\n<li>No, as far as I know. </li>\n</ol>\n\n<p>I'm not sure though, how are the helpers included. I'd try something like this to find it out, with the usage of <code>included</code> hook:</p>\n\n<pre><code>module ApplicationHelper\n  def self.included(base)\n    binding.pry # or any other debugger\n  end\nend\n</code></pre>\n\n<p>And then I'd start the application and see the backtrace, maybe it would work. </p>\n"}], "owner": {"reputation": 536, "user_id": 1194682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81dc6254e4ae1e5578bfba393a844bd4?s=128&d=identicon&r=PG", "display_name": "Strika", "link": "https://stackoverflow.com/users/1194682/strika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 52606394, "answer_count": 1, "score": 2, "last_activity_date": 1538485197, "creation_date": 1538471022, "question_id": 52605223, "link": "https://stackoverflow.com/questions/52605223/where-does-rails-include-modules-in-a-class-from-lib", "title": "Where does Rails include modules in a class from lib?", "body": "<p>We have a Rails application. There is a class in <code>lib</code> called <code>PriorityFilter</code>. It's a simple PORO class. It doesn't explicitly inherit from other classes and it doesn't include any modules. However, if I run Rails console I can see that the class includes a number of modules:</p>\n\n<pre>irb(main):002:0> PriorityFilter.included_modules\n=> [ActiveSupport::ToJsonWithActiveSupportEncoder, ActionView::Helpers::NumberHelper, PP::ObjectMixin, ActiveSupport::Dependencies::Loadable, JSON::Ext::Generator::GeneratorMethods::Object, ActiveSupport::Tryable, Kernel]\n</pre>\n\n<p>The class is used in a view helper, to prepare data for rendering a template. If I place a debugger brake point in the view helper and check included modules, there are even more modules in the list:</p>\n\n<pre>(byebug) PriorityFilter.included_modules\n[ActiveSupport::ToJsonWithActiveSupportEncoder, ActionView::Helpers::UrlHelper, ApplicationHelper, DateTimeHelper, Aligni::DateTimeFormatter, ActiveJob::TestHelper, UnitHelper, ActionView::Helpers::TextHelper, ActionView::Helpers::TagHelper, ActionView::Helpers::OutputSafetyHelper, ActionView::Helpers::CaptureHelper, ActionView::Helpers::SanitizeHelper, ActionView::Helpers::NumberHelper, PP::ObjectMixin, ActiveSupport::Dependencies::Loadable, JSON::Ext::Generator::GeneratorMethods::Object, ActiveSupport::Tryable, Kernel]\n</pre>\n\n<p>Among them are some helpers, such as <code>ApplicationHelper</code>, <code>DateTimeHelper</code> and <code>UnitHelper</code> that are actually defined in the application code, not Rails.</p>\n\n<p>We checked thoroughly and these helpers are not explicitly included in this class (or other similar classes) anywhere in our application code. Because of that, I suspect that Rails does that. The questions are:</p>\n\n<ol>\n<li>Is it true that Rails does that for all classes in <code>lib</code>?</li>\n<li>Where does Rails include those modules?</li>\n<li>Are different modules included based on the context where a class is used? Is there a way to find out which modules will be included?</li>\n<li>Is there a way to control the list of included modules, via some configuration option? (I understand that modules can be explicitly included and that they can be included/excluded in runtime with methods available on every object.)</li>\n</ol>\n"}, {"tags": ["ruby", "web-scraping", "rubygems", "nokogiri", "mechanize"], "comments": [{"owner": {"reputation": 386, "user_id": 4269576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fa6b67e78fa9284e07af2175f295083?s=128&d=identicon&r=PG&f=1", "display_name": "Unai Sanchez", "link": "https://stackoverflow.com/users/4269576/unai-sanchez"}, "edited": false, "score": 0, "creation_date": 1538490863, "post_id": 52604916, "comment_id": 92155454, "body": "You should add the code of what you&#39;ve tried so far, so we don&#39;t have to work from zero."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "edited": false, "score": 0, "creation_date": 1538471097, "post_id": 52605100, "comment_id": 92144533, "body": "This button is not part of form,and I can t submit it"}, {"owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "edited": false, "score": 0, "creation_date": 1538475845, "post_id": 52605100, "comment_id": 92146870, "body": "Question isn&#39;t answered.I know how to go to the reviews page,but it has a lot of reviews pages and I need to click button &quot;next page&quot;.After click this button ,url not change (then i can&#39;t iterate it).Only content change"}, {"owner": {"reputation": 386, "user_id": 4269576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fa6b67e78fa9284e07af2175f295083?s=128&d=identicon&r=PG&f=1", "display_name": "Unai Sanchez", "link": "https://stackoverflow.com/users/4269576/unai-sanchez"}, "reply_to_user": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "edited": false, "score": 0, "creation_date": 1538476670, "post_id": 52605100, "comment_id": 92147310, "body": "Yeah, I realised it after I posted the updated version of my answer. If I can come up with a solution, I&#39;ll tell you.However, could you post the code of what you&#39;ve tried so far?"}], "tags": [], "owner": {"reputation": 386, "user_id": 4269576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fa6b67e78fa9284e07af2175f295083?s=128&d=identicon&r=PG&f=1", "display_name": "Unai Sanchez", "link": "https://stackoverflow.com/users/4269576/unai-sanchez"}, "is_accepted": false, "score": 1, "last_activity_date": 1538471602, "last_edit_date": 1538471602, "creation_date": 1538470562, "answer_id": 52605100, "question_id": 52604916, "link": "https://stackoverflow.com/questions/52604916/how-to-scrape-all-reviews-if-they-are-on-different-pages/52605100#52605100", "title": "How to scrape all reviews if they are on different pages?", "body": "<h2>Updated answer (post question edit):</h2>\n\n<p>I think it may be easier than that. If you pay attention to the product url, you see that there is some kind of ID at the end of the url:</p>\n\n<blockquote>\n  <p><a href=\"http://www.walmart.com/ip/Ematic-9-Dual-Screen-Portable-DVD-Player-with-Dual-DVD-Players-ED929D/\" rel=\"nofollow noreferrer\">http://www.walmart.com/ip/Ematic-9-Dual-Screen-Portable-DVD-Player-with-Dual-DVD-Players-ED929D/</a><strong>28806789</strong></p>\n</blockquote>\n\n<p>If you get that ID, you could take the reviews root page (<a href=\"https://www.walmart.com/reviews/product/\" rel=\"nofollow noreferrer\">https://www.walmart.com/reviews/product/</a>) and concat the ID of the product:</p>\n\n<blockquote>\n  <p><a href=\"https://www.walmart.com/reviews/product/\" rel=\"nofollow noreferrer\">https://www.walmart.com/reviews/product/</a><strong>28806789</strong></p>\n</blockquote>\n\n<p>Now, you can iterate over the products, take the trailing ID, and go to each reviews page to get all the reviews.</p>\n\n<p>Hope it helped.</p>\n\n<h2>Old answer (pre question edit):</h2>\n\n<p>The page you posted is empty for me. However, what I see is that the element is a button, therefore, what you need to do is look for the form and then submit it.</p>\n\n<p>Example taken from <a href=\"https://stackoverflow.com/questions/7263461/clicking-a-button-with-ruby-mechanize\">Clicking a button with Ruby mechanize</a> (in case the link stops working for some reason):</p>\n\n<pre><code># get the form\nform = agent.page.form_with(:name =&gt; \"my-form\")\n# get the button you want from the form\nbutton = form.button_with(:value =&gt; \"Search\")\n# submit the form using that button\nagent.submit(form, button)\n</code></pre>\n\n<p>Credit to @flaviu and @serabe from the question stated.</p>\n\n<p>To do the scraping, you should save the root url and go to the review pages, get the reviews, go back to the root url, and so on.</p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "is_accepted": true, "score": 0, "last_activity_date": 1538574248, "creation_date": 1538574248, "answer_id": 52628463, "question_id": 52604916, "link": "https://stackoverflow.com/questions/52604916/how-to-scrape-all-reviews-if-they-are-on-different-pages/52628463#52628463", "title": "How to scrape all reviews if they are on different pages?", "body": "<p>I solve this task with watir gem.Mechanize cant interact with JavaScript.</p>\n"}], "owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 52628463, "answer_count": 2, "score": 0, "last_activity_date": 1538574248, "creation_date": 1538469963, "last_edit_date": 1538471035, "question_id": 52604916, "link": "https://stackoverflow.com/questions/52604916/how-to-scrape-all-reviews-if-they-are-on-different-pages", "title": "How to scrape all reviews if they are on different pages?", "body": "<p>How to scrape all reviews from walmart review page (ex:<a href=\"http://www.walmart.com/ip/Ematic-9-Dual-Screen-Portable-DVD-Player-with-Dual-DVD-Players-ED929D/28806789\" rel=\"nofollow noreferrer\">http://www.walmart.com/ip/Ematic-9-Dual-Screen-Portable-DVD-Player-with-Dual-DVD-Players-ED929D/28806789</a>) if they are on different pages?I scrape by mechanize(nokogiri) but it can't click on button(it is not part of form,then I can't submit it)</p>\n\n<pre><code>&lt;button class=\"paginator-btn paginator-btn-next\"&gt;&lt;span \nclass=\"visuallyhidden\"&gt;Next Page&lt;/span&gt;&lt;/button&gt;\n</code></pre>\n\n<p>and I can't go to next page.How to solve this problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rubygems", "rspec-rails"], "answers": [{"comments": [{"owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "edited": false, "score": 0, "creation_date": 1538467789, "post_id": 52604192, "comment_id": 92142817, "body": "Hi @Michal i tried to add <code>spec.add_dependency &quot;rails&quot;</code> to my_gem.gemspec and  gem &quot;rails&quot; to Gemfile but still got same error."}, {"owner": {"reputation": 1298, "user_id": 6305204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jGfSZ.png?s=128&g=1", "display_name": "con--", "link": "https://stackoverflow.com/users/6305204/con"}, "reply_to_user": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "edited": false, "score": 1, "creation_date": 1538468311, "post_id": 52604192, "comment_id": 92143082, "body": "@aldrien.h don&#39;t you need to <code>require rails</code> somewhere?"}], "tags": [], "owner": {"reputation": 8065, "user_id": 369894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7417e984cc78c088882a176050cfc07?s=128&d=identicon&r=PG", "display_name": "Micha\u0142 Szajbe", "link": "https://stackoverflow.com/users/369894/micha%c5%82-szajbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1538467162, "creation_date": 1538467162, "answer_id": 52604192, "question_id": 52603975, "link": "https://stackoverflow.com/questions/52603975/how-to-properly-set-up-or-configure-custom-gem-with-rspec-integration/52604192#52604192", "title": "How to properly set up or configure custom gem with RSPEC integration", "body": "<p>You are referring to <code>Rails::Engine</code> in your code, but there is no <code>rails</code> gem in your dependencies.</p>\n"}], "owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538467878, "creation_date": 1538466281, "last_edit_date": 1538467878, "question_id": 52603975, "link": "https://stackoverflow.com/questions/52603975/how-to-properly-set-up-or-configure-custom-gem-with-rspec-integration", "title": "How to properly set up or configure custom gem with RSPEC integration", "body": "<p>I'm doing a simple gem and trying to add rspec to it.\nBut having trouble in configuration :(</p>\n\n<p><strong>Gemfile</strong></p>\n\n<pre><code>source \"https://rubygems.org\"\n\ngit_source(:github) {|repo_name| \"https://github.com/#{repo_name}\" }\n\ngemspec\n\n# gem \"rails\" # as requested\ngem 'rspec-rails', '~&gt; 3.7'\ngem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\ngem 'database_cleaner', '~&gt; 1.5'\ngem 'factory_girl_rails', '~&gt; 4.5.0'\ngem 'faker', :git =&gt; 'https://github.com/stympy/faker.git', :branch =&gt; 'master'\n</code></pre>\n\n<p><strong>my_gem.gemspec</strong></p>\n\n<pre><code># coding: utf-8\nlib = File.expand_path(\"../lib\", __FILE__)\n$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)\nrequire \"my_gem/version\"\n\nGem::Specification.new do |spec|\n  spec.name          = \"my_gem\"\n  spec.version       = MyGem::VERSION\n  spec.authors       = [\"Test Test\"]\n  spec.email         = [\"test@gmail.com\"]\n  ....\n  ....\n  spec.add_dependency \"rails\" # as requested\n  spec.add_development_dependency \"bundler\", \"~&gt; 1.16\"\n  spec.add_development_dependency \"rake\", \"~&gt; 10.0\"\n  spec.add_development_dependency \"rspec\", \"~&gt; 3.0\"\n\nend\n</code></pre>\n\n<p><strong>spec/spec_helper.rb</strong></p>\n\n<pre><code>require 'bundler/setup'\nBundler.setup\nrequire \"my_gem\"\n\nRSpec.configure do |config|\n  # Enable flags like --only-failures and --next-failure\n  config.example_status_persistence_file_path = \".rspec_status\"\n\n  # Disable RSpec exposing methods globally on `Module` and `main`\n  config.disable_monkey_patching!\n  # config.include FactoryGirl::Syntax::Methods\n  config.expect_with :rspec do |c|\n    c.syntax = :expect\n  end\nend\n</code></pre>\n\n<p><strong>test_spec.rb</strong></p>\n\n<pre><code>require 'spec_helper'\n\nRSpec.describe MyGem do\n  it \"has a version number\" do\n    expect(MyGem::VERSION).not_to be nil\n  end\nend\n</code></pre>\n\n<p><strong>lib/my_gem.rb</strong></p>\n\n<pre><code>require \"my_gem/version\"\nrequire 'my_gem/engine'\n\nmodule MyGem\n   #....\nend\n</code></pre>\n\n<p><strong>lib/my_gem/engine.rb</strong></p>\n\n<pre><code>require 'my_gem'\n\nmodule MyGem\n  class Engine &lt; Rails::Engine\n    isolate_namespace MyGem\n\n    config.generators do |g|\n      g.test_framework :rspec\n      g.fixture_replacement :factory_girl, :dir =&gt; 'spec/factories'\n    end\n\n    config.autoload_paths   += Dir.glob(File.join(MyGem::Engine.root, 'app','controllers', '**/'))\n  end\nend\n</code></pre>\n\n<p><strong>lib/my_gem/version.rb</strong></p>\n\n<pre><code>module MyGem\n  VERSION = \"0.1.0\"\nend\n</code></pre>\n\n<p><strong>BUT running</strong> ...</p>\n\n<pre><code>bundle exec rspec spec/test_spec.rb \n\nNameError:\nuninitialized constant MyGem::Rails\n# ./lib/mu_gem/engine.rb:4:in `&lt;module:MyGem&gt;'\n</code></pre>\n\n<p>Please help how to properly setup/configure it and stuffs when adding Rspec. Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "edited": false, "score": 0, "creation_date": 1538534017, "post_id": 52603735, "comment_id": 92171894, "body": "Please provide full code of <code>load_categories</code>. It&#39;s not clear where <code>ancestry</code> attribute comes from."}, {"owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "reply_to_user": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "edited": false, "score": 0, "creation_date": 1538561161, "post_id": 52603735, "comment_id": 92182445, "body": "done) little modified, but the logic is the same"}, {"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "edited": false, "score": 0, "creation_date": 1538577756, "post_id": 52603735, "comment_id": 92192672, "body": "Thanks, that&#39;s better"}], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "edited": false, "score": 0, "creation_date": 1538646281, "post_id": 52629814, "comment_id": 92219529, "body": "now there is a problem: in <code>walk_tree</code> does not come hash - <code>{}</code>, but array - <code>[{&quot;name&quot;=&gt;&quot;IPS&quot;, &quot;children&quot;=&gt;[{}]}, {&quot;name&quot;=&gt;&quot;TFT&quot;, &quot;children&quot;=&gt;[{}]}]</code>. As a result, the error - <code>TypeError - no implicit conversion of String into Integer</code>"}, {"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "reply_to_user": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "edited": false, "score": 0, "creation_date": 1538653618, "post_id": 52629814, "comment_id": 92223718, "body": "Not sure what the problem is. Does adding code guard <code>if root[&quot;children&quot;].present? ...</code> solve the problem?"}], "tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": 1, "last_activity_date": 1538578215, "creation_date": 1538578215, "answer_id": 52629814, "question_id": 52603735, "link": "https://stackoverflow.com/questions/52603735/how-to-save-the-tree-structure-when-parsing-json/52629814#52629814", "title": "How to save the tree structure when parsing json?", "body": "<p>The cause of the problem reveals after quick debugging. Take a look at this chunk of code. Please note my comments:</p>\n\n<pre><code>data_hash[\"catalogs\"][\"children\"].each do |k|\n  # k == { \"name\": \"BenQ\", \"children\": [...] }\n  ancestry = Category.create_with(name: k[\"name\"]).\n    find_or_create_by!(uid_catalog: k[\"uid_catalog\"])\n\n  if k[\"children\"].present?\n    k[\"children\"].each do |parent|\n      # parent == { \"name\": \"Monitor\", \"children\": [...] }\n      parent[\"children\"].each do |child|\n        # child == { \"name\": \"19 inches\", \"children\": [...] }\n        walk_tree(child, ancestry)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>So you do not process <code>parent</code> as a separate node; instead your code immediately dives deeper into <code>parent[\"children\"]</code>. That's why one level of nesting is missing.</p>\n\n<p>I think you need to remove inner iterator, and rewrite it as:</p>\n\n<pre><code>data_hash[\"catalogs\"][\"children\"].each do |k|\n  ancestry = Category.create_with(name: k[\"name\"]).\n    find_or_create_by!(uid_catalog: k[\"uid_catalog\"])\n\n  if k[\"children\"].present?\n    k[\"children\"].each do |child|\n      walk_tree(child, ancestry)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538578215, "creation_date": 1538465191, "last_edit_date": 1538561099, "question_id": 52603735, "link": "https://stackoverflow.com/questions/52603735/how-to-save-the-tree-structure-when-parsing-json", "title": "How to save the tree structure when parsing json?", "body": "<p>My json:</p>\n\n<pre><code>{\n    \"catalogs\": {\n        \"name\": \"catalog 1C\",\n        \"children\": [{\n                \"name\": \"Philips\",\n                \"children\": {}\n            },\n            {\n                \"name\": \"BenQ\",\n                \"children\": [{\n                    \"name\": \"Monitor\",\n                    \"children\": [{\n                        \"name\": \"19 inches\",\n                        \"children\": [{\"name\": \"IPS\", \"children\": {}}, \n                                     {\"name\": \"TFT\",\"children\": {}}] \n                     },\n                     {\n                         \"name\": \"24 inches\",\n                         \"children\": {} }]\n                }]\n            }\n        ]\n    }\n}\n</code></pre>\n\n<p>Json have same keys and levels of nesting within each other.<br>\n<strong>\u0441hildren</strong> can have many directories (for example <strong>IPS</strong>, <strong>TFT</strong>).</p>\n\n<p>This is a menu where some items should be on the same level. I use gem <a href=\"https://github.com/stefankroes/ancestry\" rel=\"nofollow noreferrer\">ancestry</a></p>\n\n<p>I wrote a recursive function (in the controller):</p>\n\n<pre><code>def call\n  # file - inside the json to parse\n  data_hash = JSON.parse(file)\n\n  data_hash[\"catalogs\"][\"children\"].each do |k|\n    ancestry = Category.create_with(name: k[\"name\"]).find_or_create_by!(uid_catalog: k[\"uid_catalog\"])\n\n    if k[\"children\"].present?\n      k[\"children\"].each do |parent|\n        parent[\"children\"].each do |child|\n          walk_tree(child, ancestry)\n        end\n      end\n    end\n  end\nend\n\ndef walk_tree(root, ancestry)\n  ancestry = ancestry.children.find_or_create_by!(name: root[\"name\"])\n\n  root[\"children\"].each do |child|\n    ancestry = ancestry.children.find_or_create_by!(name: child[\"name\"])\n    walk_tree(child[\"children\"], ancestry) if child[\"children\"].present?\n  end\nend\n</code></pre>\n\n<p>Currently the function outputs:  </p>\n\n<pre><code>  - BenQ\n    - 19 inches\n      - IPS\n        - TFT\n</code></pre>\n\n<p>I want to have it like this (missing one level <code>Monitor</code>):</p>\n\n<pre><code>  - BenQ\n    - Monitor\n       - 19 inches\n         - IPS\n         - TFT\n       - 24 inches \n</code></pre>\n"}, {"tags": ["ruby", "file-permissions"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1538474236, "post_id": 52601221, "comment_id": 92146113, "body": "File permissions are usually stored as numbers in Ruby, i.e. <code>0664</code> instead of <code>&#39;0644&#39;</code>. It might make sense to do the same in your program and just convert it for displaying purposes."}, {"owner": {"reputation": 2050, "user_id": 4488070, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/343f7e053fbfad125f237b9178e5b688?s=128&d=identicon&r=PG&f=1", "display_name": "varro", "link": "https://stackoverflow.com/users/4488070/varro"}, "edited": false, "score": 0, "creation_date": 1538501888, "post_id": 52601221, "comment_id": 92161511, "body": "So, what did you actually get?"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1538474560, "post_id": 52601412, "comment_id": 92146263, "body": "<code>desired.to_i(8)</code> \u2192 <code>desired.oct</code>"}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 5, "last_activity_date": 1538457153, "last_edit_date": 1538457153, "creation_date": 1538449049, "answer_id": 52601412, "question_id": 52601221, "link": "https://stackoverflow.com/questions/52601221/and-operator-on-file-permissions-in-ruby/52601412#52601412", "title": "AND operator on file permissions in Ruby", "body": "<p>Your mode strings (<code>'0755'</code> and <code>'0664'</code>) are in octal but calling <code>to_i(2)</code> treats them as binary, you want to call <a href=\"http://ruby-doc.org/core/String.html#method-i-to_i\" rel=\"nofollow noreferrer\"><code>#to_i</code></a> with a <code>base</code> argument of eight. You're also calling <code>to_i</code> on <code>desired</code> twice instead of calling it on both arguments:</p>\n\n<pre><code>def compareBits(desired, existing)\n  desired.to_i(8) &amp; existing.to_i(8)\nend\n</code></pre>\n\n<p>That will give you a numeric result. If you want an octal string back then add a <code>to_s(8)</code> call:</p>\n\n<pre><code>def compareBits(desired, existing)\n  (desired.to_i(8) &amp; existing.to_i(8)).to_s(8)\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10443941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d611895fe7202f6926015a1f228e8cff?s=128&d=identicon&r=PG&f=1", "display_name": "aaronh", "link": "https://stackoverflow.com/users/10443941/aaronh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1538502505, "creation_date": 1538447122, "last_edit_date": 1538482413, "question_id": 52601221, "link": "https://stackoverflow.com/questions/52601221/and-operator-on-file-permissions-in-ruby", "title": "AND operator on file permissions in Ruby", "body": "<p>I am trying to write a function that takes in two strings and returns the AND operation of them.</p>\n\n<p>For example, with file permissions 755 &amp; 664 should return 644.</p>\n\n<pre><code>def compareBits(desired, existing)\n    return desired.to_i(2) &amp; existing.to_i(2)\n\nend\n\ncompareBits('0755', '0664')\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1561, "user_id": 6911952, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lm7Oy.jpg?s=128&g=1", "display_name": "Mirco Cattabriga", "link": "https://stackoverflow.com/users/6911952/mirco-cattabriga"}, "edited": false, "score": 0, "creation_date": 1538446373, "post_id": 52601026, "comment_id": 92136612, "body": "Are you asking how to display edit form for a tweet in a modal?"}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "reply_to_user": {"reputation": 1561, "user_id": 6911952, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lm7Oy.jpg?s=128&g=1", "display_name": "Mirco Cattabriga", "link": "https://stackoverflow.com/users/6911952/mirco-cattabriga"}, "edited": false, "score": 0, "creation_date": 1538446883, "post_id": 52601026, "comment_id": 92136728, "body": "yes however when i tried this in my code above, the original add tweet form is displayed instead of the edit tweet form. @Catmal"}], "answers": [{"tags": [], "owner": {"reputation": 1561, "user_id": 6911952, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lm7Oy.jpg?s=128&g=1", "display_name": "Mirco Cattabriga", "link": "https://stackoverflow.com/users/6911952/mirco-cattabriga"}, "is_accepted": true, "score": 0, "last_activity_date": 1538536413, "last_edit_date": 1538536413, "creation_date": 1538450293, "answer_id": 52601567, "question_id": 52601026, "link": "https://stackoverflow.com/questions/52601026/adding-edit-simple-form-into-modal-on-index-page-ror/52601567#52601567", "title": "adding edit simple_form into modal on index page - ROR", "body": "<p>views/tweets/create.js</p>\n\n<pre><code>$('#dialog').modal('toggle');\n$('#tweets').append('&lt;%= j render (@tweet) %&gt;')\n</code></pre>\n\n<p>views/tweets/new.js</p>\n\n<pre><code>// Add the dialog title\n$('#dialog h3').html(\"&lt;i class='glyphicon glyphicon-plus'&gt;&lt;/i&gt; Add New tweet\");\n\n// Render the new form\n$('.modal-body').html('&lt;%= j render(\"form\") %&gt;');\n\n// Show the dynamic dialog\n$('#dialog').modal(\"show\");\n\n// Set focus to the first element\n$('#dialog').on('shown.bs.modal', function () {\n      $('.first_input').focus()\n  })\n</code></pre>\n\n<p>views/tweets/_dialog.html.erb</p>\n\n<pre><code>&lt;div class=\"modal fade\"\n\n           id=\"dialog\"  role=\"dialog\"\n           aria-labelledby=\"myModalLabel\"\n           aria-hidden=\"true\"\n           data-backdrop=\"static\"\n           data-keyboard=\"true\"&gt;\n  &lt;div class=\"modal-dialog\"&gt;\n    &lt;div class=\"modal-content\"&gt;\n      &lt;div class=\"modal-header\"&gt;\n        &lt;button type=\"button\" class=\"close\"\n                data-dismiss=\"modal\"\n                aria-label=\"Close\"&gt;\n                &lt;span aria-hidden=\"true\"&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;\n        &lt;h3 class=\"modal-title\"&gt;&lt;/h3&gt;\n      &lt;/div&gt;\n      &lt;div class=\"modal-body\"&gt;\n      &lt;/div&gt;\n\n    &lt;/div&gt;&lt;!-- /.modal-content --&gt;\n  &lt;/div&gt;&lt;!-- /.modal-dialog --&gt;\n&lt;/div&gt;&lt;!-- /.modal --&gt;\n</code></pre>\n\n<p>views/tweets/index.html.erb</p>\n\n<p>Change link to new tweet to:</p>\n\n<pre><code>&lt;%= link_to \"New Tweet\", new_tweet_path, remote: true, class: \"btn btn-primary\" %&gt;\n</code></pre>\n\n<p>and also add:</p>\n\n<pre><code>&lt;%= render 'dialog' %&gt;\n</code></pre>\n\n<p>This way the modal is in a partial in order to have your views more clean. You should remove then the part included inside  &lt;% if policy(tweet).edit? %> (including the condition). And for edit and delete action you can do something similar, create delete.js and edit.js and use links with remote: true.</p>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 52601567, "answer_count": 1, "score": 0, "last_activity_date": 1538536413, "creation_date": 1538445139, "question_id": 52601026, "link": "https://stackoverflow.com/questions/52601026/adding-edit-simple-form-into-modal-on-index-page-ror", "title": "adding edit simple_form into modal on index page - ROR", "body": "<p>on my tweets index page, you can see all tweets, post a tweet, delete and edit a tweet if you tweeted the tweet. Currently when i edit a tweet, it goes to a separate page but i want the edit form to display as a modal on the index page so I tried to render it in the modal. However when i do this, the original \"add tweet\" form is displayed in the modal. im guessing its because of the @tweet = tweet.new in my index controller. I was wondering how to do this and what to change as it is starting to get a bit confusing with so much going on on one page. thanks</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;h1 class=\"title text-primary\"&gt;Home&lt;/h1&gt;\r\n\r\n&lt;% if policy(Tweet).create? %&gt;\r\n  &lt;div class=\"tweet-form\"&gt;\r\n      &lt;%= render 'new',user:@user, tweet:@tweet %&gt;\r\n  &lt;/div&gt;\r\n&lt;% end %&gt;\r\n&lt;br&gt;\r\n\r\n\r\n\r\n&lt;div id=\"tweets\"&gt;\r\n  &lt;% @tweets.each do |tweet|  %&gt;\r\n  &lt;div id=\"tweet-&lt;%= tweet.id %&gt;\" class=\"card\"&gt;\r\n\r\n    &lt;h4 class = \"username\"&gt;&lt;%= link_to tweet.user.username, user_path(tweet.user) %&gt;&lt;/h4&gt;\r\n    &lt;p class=\"tweet-content\"&gt;&lt;%= tweet.content %&gt;&lt;/p&gt;\r\n    &lt;p class=\"date\"&gt;&lt;%= tweet.created_at.strftime(\"%B %d %Y, %l:%M%P\") %&gt;&lt;/p&gt;\r\n    &lt;%= render 'icons', tweet: tweet %&gt;\r\n    &lt;% if policy(tweet).edit? %&gt;\r\n    &lt;button type=\"button\" class=\"btn btn-primary edit\" data-toggle=\"modal\" data-target=\"#exampleModalCenter\"&gt;\r\n      edit\r\n    &lt;/button&gt;\r\n    &lt;div class=\"modal fade\" id=\"exampleModalCenter\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalCenterTitle\" aria-hidden=\"true\"&gt;\r\n      &lt;div class=\"modal-dialog modal-dialog-centered\" role=\"document\"&gt;\r\n        &lt;div class=\"modal-content\"&gt;\r\n          &lt;div class=\"modal-header\"&gt;\r\n            &lt;h5 class=\"modal-title\" id=\"exampleModalLongTitle\"&gt;Modal title&lt;/h5&gt;\r\n            &lt;button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"&gt;\r\n              &lt;span aria-hidden=\"true\"&gt;&amp;times;&lt;/span&gt;\r\n            &lt;/button&gt;\r\n          &lt;/div&gt;\r\n          &lt;div class=\"modal-body\"&gt;\r\n          &lt;%= render 'edit',user:@user, tweet:@tweeted %&gt;\r\n          &lt;/div&gt;\r\n          &lt;div class=\"modal-footer\"&gt;\r\n            &lt;button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\"&gt;Close&lt;/button&gt;\r\n            &lt;button type=\"button\" class=\"btn btn-primary\"&gt;Save changes&lt;/button&gt;\r\n          &lt;/div&gt;\r\n        &lt;/div&gt;\r\n      &lt;/div&gt;\r\n    &lt;/div&gt;\r\n      &lt;!-- &lt;p class=\"edit\"&gt; &lt;%= link_to \"Edit\", edit_tweet_path(tweet) %&gt;&lt;/p&gt; --&gt;\r\n    &lt;% end %&gt;\r\n    &lt;% if policy(tweet).destroy? %&gt;\r\n      &lt;p class=\"destroy\"&gt;&lt;%= link_to \"Delete\",  tweet_path(tweet),method: :delete, data: { confirm: \"Are you sure?\" }, class: \"delete\"%&gt; &lt;/p&gt;\r\n    &lt;% end %&gt;\r\n  &lt;/div&gt;\r\n &lt;% end %&gt;\r\n&lt;/div&gt;\r\n\r\n\r\n\r\n&lt;div class=\"pages\"&gt;\r\n  &lt;%= will_paginate @tweets,renderer: BootstrapPagination::Rails %&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class TweetsController &lt; ApplicationController\r\n  # before_action :authenticate_user!, :except =&gt; [:index]\r\n\r\n   def index\r\n    # @tweets = Tweet.all.order(\"created_at DESC\")\r\n    @tweets = policy_scope(Tweet).paginate(page: params[:page], per_page: 7).order('created_at DESC')\r\n    @tweet = Tweet.new\r\n    @user = current_user\r\n  end\r\n\r\n  def show\r\n    @tweet = Tweet.find(params[:id])\r\n  end\r\n\r\n  def new\r\n  end\r\n\r\n  def create\r\n    # @user = current_user\r\n    @user = User.find(params[:user_id])\r\n    @tweet = Tweet.new(tweet_params)\r\n    @tweet.user = @user\r\n    authorize @tweet\r\n\r\n    if @tweet.save\r\n    redirect_to user_tweets_path\r\n    else\r\n      redirect_to user_tweets_path\r\n  end\r\n  end\r\n\r\n\r\n\r\n    #      respond_to do |format|\r\n    #     format.html { redirect_to user_tweets_path }\r\n    #     format.js\r\n    #   end\r\n    # else\r\n    #   respond_to do |format|\r\n    #     format.html { render 'tweets/index' }\r\n    #     format.js\r\n\r\n    # end\r\n\r\n\r\n  def edit\r\n    @tweet = Tweet.find(params[:id])\r\n    @user = current_user\r\n    authorize @tweet\r\n  end\r\n\r\n  def update\r\n\r\n    @tweet = Tweet.find(params[:id])\r\n    authorize @tweet\r\n    @tweet.update(tweet_params)\r\n    redirect_to tweets_path\r\n  end\r\n\r\n  def destroy\r\n    @tweet = Tweet.find(params[:id])\r\n    authorize @tweet\r\n    @tweet.destroy\r\n\r\n    redirect_to tweets_path\r\n\r\n  end\r\n\r\n  def upvote\r\n  @tweet = Tweet.find(params[:id])\r\n  @tweet.upvote_by current_user\r\n  respond_to do |format|\r\n    format.html {redirect_to :tweets}\r\n    format.js {render \"vote\"}\r\n    # redirect_to :tweets\r\n  # redirect_to :tweets\r\n  #  if request.xhr?\r\n  #   head :ok\r\n  # else\r\n  end\r\nend\r\n\r\ndef downvote\r\n  @tweet = Tweet.find(params[:id])\r\n  @tweet.downvote_by current_user\r\n  respond_to do |format|\r\n    format.html {redirect_to :tweets}\r\n    format.js {render \"vote\"}\r\n  # redirect_to :tweets\r\nend\r\nend\r\n\r\n  private\r\n  def tweet_params\r\n    params.require(:tweet).permit(:content)\r\n  end\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 3, "creation_date": 1538441250, "post_id": 52600668, "comment_id": 92135695, "body": "We&#39;d need to see how regular and subscriber users are defined (separate models, one column difference), but whatever it is, just add that to the if, <code>if user.regular? &amp;&amp; users.posts.count &gt; 4</code>"}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 1, "creation_date": 1538445948, "post_id": 52600668, "comment_id": 92136529, "body": "How are you defining the roles ?"}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 6037145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/422ee5f1b70c015253a4073f75f60af3?s=128&d=identicon&r=PG&f=1", "display_name": "nandish ", "link": "https://stackoverflow.com/users/6037145/nandish"}, "is_accepted": true, "score": 1, "last_activity_date": 1538455906, "creation_date": 1538455906, "answer_id": 52602212, "question_id": 52600668, "link": "https://stackoverflow.com/questions/52600668/validation-on-has-many-association-depending-type-of-user/52602212#52602212", "title": "validation on has_many association depending type of user", "body": "<p>You can do something like this:</p>\n\n<pre><code> if user.role == 'role1' &amp;&amp; user.posts.count &gt; 4\n    errors.add(:base, 'Cannot add more than 4 Ads at a time')\n elsif user.type == 'role2' &amp;&amp; user.post.count &gt; 10\n    errors.add(:base, 'Cannot add more than 10 Ads at a time')\n end\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10194603, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hWN495rXPto/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oz4MmZglF5X8q3slj4NuIVT7_CBg/mo/photo.jpg?sz=128", "display_name": "James Smith", "link": "https://stackoverflow.com/users/10194603/james-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52602212, "answer_count": 1, "score": 1, "last_activity_date": 1538455906, "creation_date": 1538441090, "question_id": 52600668, "link": "https://stackoverflow.com/questions/52600668/validation-on-has-many-association-depending-type-of-user", "title": "validation on has_many association depending type of user", "body": "<p>so what I am trying to accomplish might be very simple but i cannot get my head around it. I have subscribe user and a regular user. Regular users are only allowed to post 4 time while current user subscribed is allowed to post 10 times. Below is the code I have right now which works perfect but the validation only works on all type of user.</p>\n\n<pre><code>  class Post &lt; ApplicationRecord\n    validate :validates_posts!, on: :create\n\n    private\n\n    def validates_posts!\n       return if user.nil?\n        if user.posts.count &gt; 4\n          errors.add(:base, 'Cannot add more than 4 Ads at a time')\n        end\n    end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "nomethoderror", "shop"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10443224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eE2ij.jpg?s=128&g=1", "display_name": "Mars", "link": "https://stackoverflow.com/users/10443224/mars"}, "edited": false, "score": 0, "creation_date": 1538431538, "post_id": 52599472, "comment_id": 92133587, "body": "I tried that a few hours before. If i do so i get:  TypeError in CartsController#remove nil can&#39;t be coerced into Fixnum"}, {"owner": {"reputation": 13, "user_id": 10443224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eE2ij.jpg?s=128&g=1", "display_name": "Mars", "link": "https://stackoverflow.com/users/10443224/mars"}, "edited": false, "score": 0, "creation_date": 1538431657, "post_id": 52599472, "comment_id": 92133617, "body": "And still with the  Routing Error No route matches [GET] &quot;/cart/destroy/1&quot;"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 13, "user_id": 10443224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eE2ij.jpg?s=128&g=1", "display_name": "Mars", "link": "https://stackoverflow.com/users/10443224/mars"}, "edited": false, "score": 0, "creation_date": 1538431997, "post_id": 52599472, "comment_id": 92133716, "body": "Do you get the same error if you try <code>item[&#39;quantity&#39;]</code>?"}, {"owner": {"reputation": 13, "user_id": 10443224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eE2ij.jpg?s=128&g=1", "display_name": "Mars", "link": "https://stackoverflow.com/users/10443224/mars"}, "edited": false, "score": 0, "creation_date": 1538432542, "post_id": 52599472, "comment_id": 92133835, "body": "Awesome. This worked! Thank you very much for your fast help!"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 13, "user_id": 10443224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eE2ij.jpg?s=128&g=1", "display_name": "Mars", "link": "https://stackoverflow.com/users/10443224/mars"}, "edited": false, "score": 0, "creation_date": 1538432834, "post_id": 52599472, "comment_id": 92133919, "body": "Super. Feel free to upvote/accept for future searchers."}, {"owner": {"reputation": 13, "user_id": 10443224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eE2ij.jpg?s=128&g=1", "display_name": "Mars", "link": "https://stackoverflow.com/users/10443224/mars"}, "edited": false, "score": 1, "creation_date": 1538433333, "post_id": 52599472, "comment_id": 92134041, "body": "Sure accepted and upvoted! And updated the question form!"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 0, "last_activity_date": 1538431264, "creation_date": 1538431264, "answer_id": 52599472, "question_id": 52599415, "link": "https://stackoverflow.com/questions/52599415/remove-items-from-cart-and-add-this-quantity-back-to-the-stock-quantity-rubyonr/52599472#52599472", "title": "Remove items from cart and add this quantity back to the stock_quantity (rubyonrails)", "body": "<p>As the error indicates, <code>item</code> is a <code>hash</code>. So, you can't call <code>item.quantity</code>. Try <code>item[:quantity]</code> instead.</p>\n\n<p>BTW, it's generally considered (IMO) bad form to post images of error messages. It may be difficult for folks to view an image on various devices (e.g., phones). Also, with an image, we are unable to copy and paste relevant code to help answer your question. It is better if you copy and paste the error into your question.</p>\n"}], "owner": {"reputation": 13, "user_id": 10443224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eE2ij.jpg?s=128&g=1", "display_name": "Mars", "link": "https://stackoverflow.com/users/10443224/mars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 52599472, "answer_count": 1, "score": 1, "last_activity_date": 1538432361, "creation_date": 1538431015, "last_edit_date": 1538432361, "question_id": 52599415, "link": "https://stackoverflow.com/questions/52599415/remove-items-from-cart-and-add-this-quantity-back-to-the-stock-quantity-rubyonr", "title": "Remove items from cart and add this quantity back to the stock_quantity (rubyonrails)", "body": "<p>i am trying to build a shop, \nbut i have an error after removing my items from cart, \nwhile try to add the cart.items.quantity back to the product.stock_quantity.\nThis are the error messages:</p>\n\n<pre><code>NoMethodError in CartsController#remove\nundefined method `quantity' for {\"product_id\"=&gt;\"1\", \"quantity\"=&gt;21}:Hash\n</code></pre>\n\n<p>.</p>\n\n<pre><code>Routing Error\nNo route matches [GET] \"/cart/destroy/1\"\n</code></pre>\n\n<p>Here is the important part of my carts_controller:</p>\n\n<pre><code>    def remove\n    cart = session['cart']\n    item = cart['items'].find { |item| item['product_id'] == params[:id] }\n\n    product = Product.find(item['product_id'])\n\n    product.update_columns(stock_quantity: product.stock_quantity + item.quantity)\n\n    if item\n        cart['items'].delete item\n    end\n  redirect_to cart_path\nend\n</code></pre>\n\n<p>If i change the <strong>item.quantity</strong> to just +1 , everything works fine.\nBut i actually want to add the hole cart.item.quantity back to the stock_quantity.\nHere is the routes file:</p>\n\n<pre><code>Rails.application.routes.draw do\nresources :stockists\npost 'emaillist/subscribe' =&gt; 'emaillist#subscribe'\nget 'products/search' =&gt; 'products#search', as: 'search_products'\nget 'pages/index'\nget 'pages/about'\nget 'pages/help'\ndevise_for :users\nresources :categories\nresources :categories\nresources :designers\nresources :category_names\nresources :products\nresource :cart, only: [:show] do\npost \"add\", path: \"add/:id\", on: :member\ndelete 'remove', path: 'destroy/:id'\nget :checkout\nend\nresources :orders, only: [ :index, :show, :create, :update ] do\nmember do\nget :new_payment\npost :pay\nend\nend\n</code></pre>\n\n<p>Does anyone have an idea?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1538429299, "post_id": 52598851, "comment_id": 92132912, "body": "What have you already tried for the js files?"}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "reply_to_user": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1538429786, "post_id": 52598851, "comment_id": 92133057, "body": "ive attempted to change someone elses code to mine, but i cant see how to be honest. i&#39;ll add it to my question. im quite new to ajax.@ChrisHall"}, {"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1538431505, "post_id": 52598851, "comment_id": 92133579, "body": "Just to encourage other answers, you might want to put the JS snippet after your opening paragraph."}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1538432702, "post_id": 52599445, "comment_id": 92133886, "body": "thank you. i followed these steps however, when i click on an upvote/downvote  button i still need to refresh the page for the effect of the number going up to take place."}, {"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "reply_to_user": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1538434984, "post_id": 52599445, "comment_id": 92134475, "body": "Are you sure the JS is able to target the card?  You may need to manually run some of the code or watch the network requests to see what&#39;s going on.  Most browsers have some form of JS Console / Network monitor."}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1538435360, "post_id": 52599445, "comment_id": 92134555, "body": "im not too sure to be honest, but i&#39;ve uploaded the log when i click on an upvote button from the terminal and the console in my original question, if that helps."}, {"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "reply_to_user": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1538528183, "post_id": 52599445, "comment_id": 92170664, "body": "Ah, right, I forgot that Rails doesn&#39;t come bundled with jQuery anymore.  Let me fix that."}], "tags": [], "owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "is_accepted": true, "score": 1, "last_activity_date": 1538529545, "last_edit_date": 1538529545, "creation_date": 1538431140, "answer_id": 52599445, "question_id": 52598851, "link": "https://stackoverflow.com/questions/52598851/using-ajax-for-acts-as-voteable-in-rails/52599445#52599445", "title": "using ajax for acts_as_voteable in rails", "body": "<p>It looks like the way you initially started on is to attach handlers to the buttons that listen for successful requests.  This is a fair way to do it, but - since you're already using Rails UJS - there's a possibly \"better\" way.</p>\n\n<p>With Rails UJS, JS files returned from a remote action are automatically executed.  In my opinion, a more idiomatic Rails way to do this is as follows:</p>\n\n<p>Extract out the icons into their own template:</p>\n\n<pre><code>&lt;div id=\"tweets\"&gt;\n  &lt;% @tweets.each do |tweet|  %&gt;\n  &lt;div id=\"tweet-&lt;%= tweet.id %&gt;\" class=\"card\"&gt;\n\n    &lt;h4 class = \"username\"&gt;&lt;%= link_to tweet.user.username, user_path(tweet.user) %&gt;&lt;/h4&gt;\n    &lt;p class=\"tweet-content\"&gt;&lt;%= tweet.content %&gt;&lt;/p&gt;\n    &lt;p class=\"date\"&gt;&lt;%= tweet.created_at.strftime(\"%B %d %Y, %l:%M%P\") %&gt;&lt;/p&gt;\n    &lt;%= render 'icons', tweet: tweet %&gt;\n  &lt;/div&gt;\n &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><code>tweets/_icons.html.erb</code>:</p>\n\n<pre><code>&lt;div class=\"icons\"&gt;\n  &lt;%= link_to like_tweet_path(tweet),remote: true , method: :put do %&gt;\n    &lt;div class=\"upvote\"&gt;&lt;i class=\"fas fa-thumbs-up\"&gt;&lt;/i&gt; &lt;%= tweet.get_upvotes.size %&gt;&lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;%= link_to dislike_tweet_path(tweet), remote: true, method: :put do %&gt;\n    &lt;div class=\"downvote\"&gt;&lt;i class=\"fas fa-thumbs-down\"&gt;&lt;/i&gt; &lt;%= tweet.get_downvotes.size %&gt;&lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Then, in your upvote/downvote controller actions you would <code>format.js { render 'vote' }</code> which would live at <code>tweets/vote.js.erb</code> and look like:</p>\n\n<pre><code>document.querySelector('#tweet-&lt;%= @tweet.id %&gt; .icons').outerHTML = '&lt;%= j render('icons', tweet: @tweet) %&gt;';\n</code></pre>\n\n<p>At this point, you're now free to modify <code>tweets/_icons.html.erb</code> to provide extra functionality (e.g. visual feedback on votes or changing the URL of the links to undo a vote).</p>\n\n<hr>\n\n<h3>Old jQuery method</h3>\n\n<p>Keeping this \"older\" jQuery method for those people who encounter a similar issue and are using jQuery.  Though, really, <a href=\"http://youmightnotneedjquery.com/\" rel=\"nofollow noreferrer\">you probably don't need it</a>.</p>\n\n<pre><code>$('#tweet-&lt;%= @tweet.id %&gt; .icons').replaceWith('&lt;%= j render('icons', tweet: @tweet) %&gt;');\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 52599445, "answer_count": 1, "score": 0, "last_activity_date": 1538529545, "creation_date": 1538427690, "last_edit_date": 1538435693, "question_id": 52598851, "link": "https://stackoverflow.com/questions/52598851/using-ajax-for-acts-as-voteable-in-rails", "title": "using ajax for acts_as_voteable in rails", "body": "<p>im trying to use ajax on acts_as_votable gem so the page doesnt refresh on a vote/upvote. I've adjused the controller methods for this, and added remote true on the links. However i think the only thing left are the two .js.erb files. ive looked around on here and the ruby documentation and i cant seem to find how to do it for this instance. thanks</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>VM23182:1 Uncaught ReferenceError: $ is not defined\r\n    at &lt;anonymous&gt;:1:1\r\n    at processResponse (application-50000f29e1bf2752ae7e56dda39f10dd0f67a47aea5c3f07ed0d933f3e1a256a.js:268)\r\n    at application-50000f29e1bf2752ae7e56dda39f10dd0f67a47aea5c3f07ed0d933f3e1a256a.js:196\r\n    at XMLHttpRequest.xhr.onreadystatechange (application-50000f29e1bf2752ae7e56dda39f10dd0f67a47aea5c3f07ed0d933f3e1a256a.js:251)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>`$('.unlike_post').bind('ajax:success', function(){\r\n   $(this).parent().parent().find('.vote_count').html('&lt;%= escape_javascript @post.votes_for.size.to_s %&gt;');\r\n   $(this).closest('.unlike_post').hide();\r\n   $(this).closest('.votes').html(' &lt;%= link_to \"Like\", like_post_path(@post), remote: true, method: :get, class: \"like_post\" %&gt;');\r\n\r\n});`</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Started PUT \"/tweets/60/like\" for 127.0.0.1 at 2018-10-02 00:06:40 +0100\r\nProcessing by TweetsController#upvote as JS\r\n  Parameters: {\"id\"=&gt;\"60\"}\r\n  User Load (0.4ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 3], [\"LIMIT\", 1]]\r\n  \u21b3 /Users/benherring/.rbenv/versions/2.4.4/lib/ruby/gems/2.4.0/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98\r\n  Tweet Load (0.2ms)  SELECT  \"tweets\".* FROM \"tweets\" WHERE \"tweets\".\"id\" = $1 LIMIT $2  [[\"id\", 60], [\"LIMIT\", 1]]\r\n  \u21b3 app/controllers/tweets_controller.rb:57\r\n   (0.4ms)  SELECT COUNT(*) FROM \"votes\" WHERE \"votes\".\"votable_id\" = $1 AND \"votes\".\"votable_type\" = $2 AND \"votes\".\"voter_id\" = $3 AND \"votes\".\"vote_scope\" IS NULL AND \"votes\".\"voter_type\" = $4  [[\"votable_id\", 60], [\"votable_type\", \"Tweet\"], [\"voter_id\", 3], [\"voter_type\", \"User\"]]\r\n  \u21b3 app/controllers/tweets_controller.rb:58\r\n  ActsAsVotable::Vote Load (0.6ms)  SELECT  \"votes\".* FROM \"votes\" WHERE \"votes\".\"votable_id\" = $1 AND \"votes\".\"votable_type\" = $2 AND \"votes\".\"voter_id\" = $3 AND \"votes\".\"vote_scope\" IS NULL AND \"votes\".\"voter_type\" = $4 ORDER BY \"votes\".\"id\" DESC LIMIT $5  [[\"votable_id\", 60], [\"votable_type\", \"Tweet\"], [\"voter_id\", 3], [\"voter_type\", \"User\"], [\"LIMIT\", 1]]\r\n  \u21b3 app/controllers/tweets_controller.rb:58\r\n   (0.2ms)  BEGIN\r\n  \u21b3 app/controllers/tweets_controller.rb:58\r\n  ActsAsVotable::Vote Update (0.5ms)  UPDATE \"votes\" SET \"updated_at\" = $1, \"vote_flag\" = $2 WHERE \"votes\".\"id\" = $3  [[\"updated_at\", \"2018-10-01 23:06:40.357671\"], [\"vote_flag\", true], [\"id\", 10]]\r\n  \u21b3 app/controllers/tweets_controller.rb:58\r\n   (1.3ms)  COMMIT\r\n  \u21b3 app/controllers/tweets_controller.rb:58\r\n  Rendering tweets/vote.js.erb\r\n   (0.4ms)  SELECT COUNT(*) FROM \"votes\" WHERE \"votes\".\"votable_id\" = $1 AND \"votes\".\"votable_type\" = $2 AND \"votes\".\"vote_flag\" = $3  [[\"votable_id\", 60], [\"votable_type\", \"Tweet\"], [\"vote_flag\", true]]\r\n  \u21b3 app/views/tweets/_icons.html.erb:5\r\n   (0.6ms)  SELECT COUNT(*) FROM \"votes\" WHERE \"votes\".\"votable_id\" = $1 AND \"votes\".\"votable_type\" = $2 AND \"votes\".\"vote_flag\" = $3  [[\"votable_id\", 60], [\"votable_type\", \"Tweet\"], [\"vote_flag\", false]]\r\n  \u21b3 app/views/tweets/_icons.html.erb:9\r\n  Rendered tweets/_icons.html.erb (5.7ms)\r\n  Rendered tweets/vote.js.erb (8.7ms)\r\nCompleted 200 OK in 40ms (Views: 21.0ms | ActiveRecord: 4.7ms)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>resources :tweets do\r\n  member do\r\n    put \"like\", to: \"tweets#upvote\"\r\n    put \"dislike\", to: \"tweets#downvote\"\r\n  end</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div id=\"tweets\"&gt;\r\n  &lt;% @tweets.each do |tweet|  %&gt;\r\n  &lt;div class=\"card\"&gt;\r\n\r\n    &lt;h4 class = \"username\"&gt;&lt;%= link_to tweet.user.username, user_path(tweet.user) %&gt;&lt;/h4&gt;\r\n    &lt;p class=\"tweet-content\"&gt;&lt;%= tweet.content %&gt;&lt;/p&gt;\r\n    &lt;p class=\"date\"&gt;&lt;%= tweet.created_at.strftime(\"%B %d %Y, %l:%M%P\") %&gt;&lt;/p&gt;\r\n    &lt;div class=\"icons\"&gt;\r\n\r\n      &lt;%= link_to like_tweet_path(tweet),remote: true , method: :put do %&gt;\r\n      &lt;div class=\"upvote\"&gt;&lt;i class=\"fas fa-thumbs-up\"&gt;&lt;/i&gt; &lt;%= tweet.get_upvotes.size %&gt;&lt;/div&gt;\r\n      &lt;% end %&gt;\r\n      &lt;%= link_to dislike_tweet_path(tweet), remote: true, method: :put do %&gt;\r\n      &lt;div&gt;&lt;i class=\"fas fa-thumbs-down\"&gt;&lt;/i&gt; &lt;%= tweet.get_downvotes.size %&gt;&lt;/div&gt;\r\n      &lt;% end %&gt;\r\n    &lt;/div&gt;\r\n  &lt;/div&gt;\r\n &lt;% end %&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>  def upvote\r\n  @tweet = Tweet.find(params[:id])\r\n  @tweet.upvote_by current_user\r\n  respond_to do |format|\r\n    format.html {redirect_to :tweets}\r\n    format.js {render layout: false}\r\n    # redirect_to :tweets\r\n  # redirect_to :tweets\r\n  #  if request.xhr?\r\n  #   head :ok\r\n  # else\r\n  end\r\nend\r\n\r\ndef downvote\r\n  @tweet = Tweet.find(params[:id])\r\n  @tweet.downvote_by current_user\r\n  respond_to do |format|\r\n    format.html {redirect_to :tweets}\r\n    format.js {render layout: false}\r\n  # redirect_to :tweets\r\nend\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby", "gitlab-api"], "answers": [{"comments": [{"owner": {"reputation": 712, "user_id": 2457149, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y2FcA.png?s=128&g=1", "display_name": "Twonky", "link": "https://stackoverflow.com/users/2457149/twonky"}, "edited": false, "score": 0, "creation_date": 1538514884, "post_id": 52598936, "comment_id": 92167191, "body": "Thanks for helping! Tried with the rest-client gem: <code>parameters = &quot;grant_type=password&amp;username=MyUserName&amp;password=MyPassword&zwnj;&#8203;&quot;</code> but <code>RestClient.post &#39;https:&#47;&#47;My.GitLab.Server&#47;oauth&#47;token&#39;, parameters</code> just returns code 200 instead of the access token. Fortunately, after registering an application at the server, I succeeded using the described way to use the oauth2 gem. Weird. Do <i>have</i> to have a registered application?"}, {"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "reply_to_user": {"reputation": 712, "user_id": 2457149, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y2FcA.png?s=128&g=1", "display_name": "Twonky", "link": "https://stackoverflow.com/users/2457149/twonky"}, "edited": false, "score": 0, "creation_date": 1538528054, "post_id": 52598936, "comment_id": 92170638, "body": "Not that I&#39;m aware of.  A response of 200 from a server means your request was successful.  The response body will have the access token."}], "tags": [], "owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "is_accepted": true, "score": 1, "last_activity_date": 1538428219, "creation_date": 1538428219, "answer_id": 52598936, "question_id": 52598638, "link": "https://stackoverflow.com/questions/52598638/accessing-gitlab-via-api-with-ruby/52598936#52598936", "title": "Accessing GitLab via API with Ruby", "body": "<p>The manual entry you linked is for signing into GitLab with a third-party OAuth provider, which doesn't sound like what you're trying to do.  What it sounds like you're trying to do is <a href=\"https://docs.gitlab.com/ce/api/oauth2.html#resource-owner-password-credentials\" rel=\"nofollow noreferrer\">request an OAuth token</a> which you can then use to access GitLab's API.</p>\n\n<p>From the documentation:</p>\n\n<blockquote>\n  <p>In this flow, a token is requested in exchange for the resource owner credentials (username and password). The credentials should only be used when there is a high degree of trust between the resource owner and the client (e.g. the client is part of the device operating system or a highly privileged application), and when other authorization grant types are not available (such as an authorization code).</p>\n</blockquote>\n\n<p>Which sounds like what you're trying to do.</p>\n\n<p>One important thing of note from the documentation:</p>\n\n<blockquote>\n  <p>Deprecation notice: Starting in GitLab 8.11, the Resource Owner Password Credentials has been disabled for users with two-factor authentication turned on. These users can access the API using <a href=\"https://docs.gitlab.com/ce/user/profile/personal_access_tokens.html\" rel=\"nofollow noreferrer\">personal access tokens</a> instead.</p>\n</blockquote>\n\n<p>If this is the case for you, the following won't work and you'll need to generate an access token instead.</p>\n\n<blockquote>\n  <h3>1. Requesting access token</h3>\n  \n  <p>POST request to /oauth/token with parameters:</p>\n\n<pre><code>{\n  \"grant_type\"    : \"password\",\n  \"username\"      : \"user@example.com\",\n  \"password\"      : \"secret\"\n}\n</code></pre>\n  \n  <p>Then, you'll receive the access token back in the response:</p>\n\n<pre><code>{\n  \"access_token\": \"1f0af717251950dbd4d73154fdf0a474a5c5119adad999683f5b450c460726aa\",\n  \"token_type\": \"bearer\",\n  \"expires_in\": 7200\n}\n</code></pre>\n</blockquote>\n\n<p>You would then assign this token as your <code>GitLab.private_token</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 712, "user_id": 2457149, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y2FcA.png?s=128&g=1", "display_name": "Twonky", "link": "https://stackoverflow.com/users/2457149/twonky"}, "is_accepted": false, "score": 1, "last_activity_date": 1539030113, "last_edit_date": 1539030113, "creation_date": 1538945413, "answer_id": 52692798, "question_id": 52598638, "link": "https://stackoverflow.com/questions/52598638/accessing-gitlab-via-api-with-ruby/52692798#52692798", "title": "Accessing GitLab via API with Ruby", "body": "<p>For the records -- what would have helped quicker is a minimum viable example -- especially since the API documentation contains known and not fixed errors.</p>\n\n<pre><code>host = myGitlabServer\n\nrequire 'oauth2'\nclient = OAuth2::Client.new(clientIdFromGitLab, clientSecretFromGitLab, :site =&gt; host)\naccessToken = client.password.get_token(myGitLabUid, myGitLabPassword)\n\nrequire 'httparty'\n# get own user data\nresponse = HTTParty.get(host + '/api/v4/user?access_token=' + accessToken.token)\nputs response.parsed_response\n\n# get user data by user name\nresponse = HTTParty.get(host + '/api/v4/users?username=' + username + '&amp;access_token=' + access_token.token)\nputs response.parsed_response[0]\n\n# add user as reporter to project\nresponse = HTTParty.post(host + '/api/v4/projects/' + projectId + '/members/?user_id=' + newUID + '&amp;access_level=20&amp;access_token=' + access_token.token)\nputs response.parsed_response\n</code></pre>\n"}], "owner": {"reputation": 712, "user_id": 2457149, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y2FcA.png?s=128&g=1", "display_name": "Twonky", "link": "https://stackoverflow.com/users/2457149/twonky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 52598936, "answer_count": 2, "score": 0, "last_activity_date": 1539030113, "creation_date": 1538426626, "question_id": 52598638, "link": "https://stackoverflow.com/questions/52598638/accessing-gitlab-via-api-with-ruby", "title": "Accessing GitLab via API with Ruby", "body": "<p>Trying to access my university's GitLab for the first time via API (I'm the repo owner but have no access to the console and can not edit config files or restart the server), I seem to lack some mandatory basics. Tried to use Ruby (no rails) with the Narkoz API wrapper. Unfortunately, there are no tutorials available which explain the very first step:</p>\n\n<p>How to connect to the server and authenticate using UID+passwd?</p>\n\n<p>Can anybody explain the process in human-readable instructions? The <a href=\"https://docs.gitlab.com/ce/integration/oauth2_generic.html\" rel=\"nofollow noreferrer\">GitLab Manual</a> was not helpful for me.</p>\n\n<p>I hope that I could then figure out how to add GitLab users to my repository. Don't want to add 100 users using the web interface.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "is_accepted": true, "score": 1, "last_activity_date": 1538429623, "creation_date": 1538429623, "answer_id": 52599189, "question_id": 52598334, "link": "https://stackoverflow.com/questions/52598334/uninitialized-constant-sykecore-rubygem/52599189#52599189", "title": "uninitialized constant Syke::Core RubyGem", "body": "<p>The problem is that your <code>require \"syke/internet\"</code> is <em>before</em> you've defined <code>Syke::Core</code>.</p>\n\n<p>Personally, I would move the definition of <code>Syke::Core</code> into it's own file that you can require inside either the main <code>syke.rb</code> (before requiring internet) file or in the <code>internet.rb</code> file itself.</p>\n"}], "owner": {"reputation": 1583, "user_id": 5253108, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/o5DQ1.jpg?s=128&g=1", "display_name": "Trenton Tyler", "link": "https://stackoverflow.com/users/5253108/trenton-tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 52599189, "answer_count": 1, "score": 0, "last_activity_date": 1538429623, "creation_date": 1538425266, "question_id": 52598334, "link": "https://stackoverflow.com/questions/52598334/uninitialized-constant-sykecore-rubygem", "title": "uninitialized constant Syke::Core RubyGem", "body": "<p>I am building a RubyGem to generate test data and am running into an issue while building it. I have the main <code>syke.rb</code> file that was genereated from the initial gem build.</p>\n\n<pre><code>require \"syke/version\"\nrequire \"syke/internet\"\n\nmydir = __dir__\n\nrequire 'i18n'\n\nI18n.load_path += Dir[File.join(mydir, 'locales', '**/*.yml')]\nI18n.available_locales = [:en]\n\nmodule Syke\n  class Core\n    class &lt;&lt; self\n      def get(key)\n        I18n.t(\"syke.#{key}\")\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I am trying to pull values from a <code>.yml</code> file so in my <code>internet.rb</code> file I have this:</p>\n\n<pre><code>module Syke\n  class Internet &lt; Core\n    class &lt;&lt; self\n      def email\n        get('internet.domain')\n      end\n    end\n  end\nend \n</code></pre>\n\n<p>I am currently getting this error while trying to test the application with rspec: </p>\n\n<blockquote>\n  <p>NameError: uninitialized constant Syke::Core</p>\n</blockquote>\n\n<p>I have the internet class inheriting the Core class under the Syke module so I am confused why I would be getting this error message. Anybody have any idea? Thanks. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1538423302, "post_id": 52597526, "comment_id": 92130438, "body": "Note: <code>then</code> is something that&#39;s really not used in Ruby as it&#39;s basically clutter."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1538423438, "post_id": 52597526, "comment_id": 92130496, "body": "Obligatory <a href=\"https://www.kalzumeus.com/2010/06/17/falsehoods-programmers-believe-about-names/\" rel=\"nofollow noreferrer\">falsehoods programmers believe about names</a> link. I know of dogs named things like &quot;Sir Scratchybutt&quot; and people have names like &quot;Sting&quot; or &quot;Bono&quot;. Careful when making these assumptions."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1538424426, "post_id": 52597526, "comment_id": 92130945, "body": "@tadman, except, for example, <code>x = 1; case x; when 1 then &#39;hi&#39;; when 2 then &#39;ho&#39;; end</code>, <code>then</code> being required."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538424468, "post_id": 52597526, "comment_id": 92130963, "body": "@CarySwoveland People who one-line their case statements will have to deal with the angry wrath of tools like Rubocop!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1538425015, "post_id": 52597526, "comment_id": 92131185, "body": "@tadman, I can live with that. I sometimes find Robocop to more like Persnicketycop or Oldpersonishcop (formerly Oldwomanishcop)."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1538425098, "post_id": 52597526, "comment_id": 92131216, "body": "@CarySwoveland Sometimes you have to break the rules, but it&#39;s nice having tools like that to tell new developers what the rules are."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1538456076, "post_id": 52597526, "comment_id": 92138565, "body": "I cannot get at all what the question is about."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9711242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfjDb.jpg?s=128&g=1", "display_name": "seki", "link": "https://stackoverflow.com/users/9711242/seki"}, "edited": false, "score": 1, "creation_date": 1538506690, "post_id": 52597993, "comment_id": 92163757, "body": "Thank you! the problem was just solved, quite and clean."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1538423626, "creation_date": 1538423626, "answer_id": 52597993, "question_id": 52597526, "link": "https://stackoverflow.com/questions/52597526/using-include-to-check-if-there-is-a-space-in-a-string/52597993#52597993", "title": "Using &#39;include?&#39; to check if there is a space in a string", "body": "<p>The most Ruby way to do this is with <code>case</code> and regular expressions:</p>\n\n<pre><code>def family_member_text\n  name = @fm1.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \")\n\n  case (@fm1)\n  when /\\s/\n    \"#{name} is a puppy!\"\n  when /schnider/i\n    \"#{name} is Schnider's member.\"\n  else\n    \"#{name} is a guest.\"\n  end\nend\n</code></pre>\n\n<p>Where this method returns text that you can, but are not obligated to feed to <code>puts</code>, something that leads to more modular code design. Remember your <a href=\"https://en.wikipedia.org/wiki/SOLID\" rel=\"nofollow noreferrer\">SOLID principles</a>.</p>\n\n<p>Note that I've also applied DRY (Don't Repeat Yourself) here to clean up the duplicated name canonicalization code. That's also probably wrong because names like \"Leonardo da Vinci\" do not have a capital \"Da\".</p>\n"}], "owner": {"reputation": 79, "user_id": 9711242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfjDb.jpg?s=128&g=1", "display_name": "seki", "link": "https://stackoverflow.com/users/9711242/seki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 52597993, "answer_count": 1, "score": 1, "last_activity_date": 1538455875, "creation_date": 1538421527, "last_edit_date": 1538455875, "question_id": 52597526, "link": "https://stackoverflow.com/questions/52597526/using-include-to-check-if-there-is-a-space-in-a-string", "title": "Using &#39;include?&#39; to check if there is a space in a string", "body": "<p>I am testing whether a name <code>@fm1</code> has a space (because dog does not have a surname).</p>\n\n<pre><code>def family_member?\n  if @fm1.include?(\" \")\n    puts @fm1.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \") + \" is a puppy!\"\n  elsif @fm1.include?(\"schnider\")\n    puts @fm1.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \") + \" is Schnider's member.\"\n  else\n    puts @fm1.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \") + \" is a guest.\"\n  end\nend\n</code></pre>\n\n<p>When I do <code>if @fm1.include?(\" \")</code>, it shows the result after <code>else</code>. I would like to know if there is any method. Can you help me finish this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1538422064, "post_id": 52597411, "comment_id": 92129878, "body": "is this rails or just ruby?  before <code>customer.product</code> returned an array of product objects I think but now you want it to return an array of strings?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538422320, "post_id": 52597411, "comment_id": 92129995, "body": "Can you show the associated class definition (with <code>initialize</code> the only method), in part so we can test?"}], "answers": [{"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 2, "last_activity_date": 1538422300, "creation_date": 1538422300, "answer_id": 52597688, "question_id": 52597411, "link": "https://stackoverflow.com/questions/52597411/how-to-update-an-array-in-array-of-objects/52597688#52597688", "title": "how to update an array in array of objects", "body": "<pre><code>test.customer.tap { |obj| obj.product.map!(&amp;:id) }\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 10435612, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J5IUKwG8YaM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWbs4uAQJlzopnMWULploFQ83JTnA/mo/photo.jpg?sz=128", "display_name": "john simons", "link": "https://stackoverflow.com/users/10435612/john-simons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1538422300, "creation_date": 1538421030, "last_edit_date": 1538421935, "question_id": 52597411, "link": "https://stackoverflow.com/questions/52597411/how-to-update-an-array-in-array-of-objects", "title": "how to update an array in array of objects", "body": "<p>I have following output available in a variable test</p>\n\n<pre><code>#&lt;someobject customer=[#&lt;someobject product=[#&lt;someobject id='ABC123'&gt;, #&lt;someobject id=''&gt;], id='ADE343'&gt;]&gt;\n</code></pre>\n\n<p>I am trying to convert its result as follows:</p>\n\n<pre><code>#&lt;someobject customer=[#&lt;someobject product=['ABC123','DEF143'], id='ADE343'&gt;]&gt;\n</code></pre>\n\n<p>I can achieve that using following but looks like overkill</p>\n\n<pre><code>test1 = test.customer.map { |p| p.product }.flatten.map { |e| e.id }\ntest.customer.map { |p| p.product = test1 }\ntest\n</code></pre>\n\n<p>Is there any better way to do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1538426012, "post_id": 52597371, "comment_id": 92131604, "body": "you just want to run one test and then what?  <code>exec(&quot;rspec spec&#47;user_spec.rb&quot;)</code>. If you want more robust you&#39;ll need <a href=\"https://github.com/rspec/rspec-core/blob/master/lib/rspec/core/runner.rb\" rel=\"nofollow noreferrer\">github.com/rspec/rspec-core/blob/master/lib/rspec/core/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 367, "user_id": 921530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i1Yn4.jpg?s=128&g=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/921530/nicolas"}, "is_accepted": false, "score": 0, "last_activity_date": 1608632992, "creation_date": 1608632992, "answer_id": 65407066, "question_id": 52597371, "link": "https://stackoverflow.com/questions/52597371/execute-an-rspec-test-in-rails-console/65407066#65407066", "title": "Execute an rspec test in Rails Console", "body": "<p>As pointed out by <a href=\"https://stackoverflow.com/users/3109182/anthony\">Anthony</a> in <a href=\"https://stackoverflow.com/questions/52597371/execute-an-rspec-test-in-rails-console#comment92131604_52597371\">his comment</a>, you can use <a href=\"https://github.com/rspec/rspec-core/blob/master/lib/rspec/core/runner.rb\" rel=\"nofollow noreferrer\"><code>RSpec::Core::Runner</code></a> to basically invoke the command line behavior from code or an interactive console. However, if you use something like Rails, consider that your environment is likely going to be set to development (or even production, if this is where you'll execute the code). So make sure that whatever you do doesn't have any unwanted side-effects.</p>\n<p>Another thing to consider is that RSpec globally stores its configuration including all example groups that were registerd with it before. That's why you'll need to reset RSpec between subsequent runs. This can be done via <code>RSpec.reset</code>.</p>\n<p>So putting it all together, you'll get:</p>\n<pre><code>require 'rspec/core'\nRSpec::Core::Runner.run(['spec/path/to_spec_1.rb', 'spec/path/to_spec_2.rb'])\nRSpec.reset\n</code></pre>\n<p>The call to <code>RSpec::Core::Runner.run</code> will output to standard out and return the exit code as a result (<code>0</code> meaning no errors, a non-zero exit code means a test failed).</p>\n<pre><code>..\n\nFinished in 0.01791 seconds (files took 17.25 seconds to load)\n2 example, 0 failures\n\n=&gt; 0\n</code></pre>\n<p>You can also pass other <code>IO</code> objects to <code>RSpec::Core::Runner.run</code> to specify where it should output to. And you can also pass other command line parameters to the first array of <code>RSpec::Core::Runner.run</code>, e.g. <code>'--format=json'</code> to output the results in JSON format.</p>\n<p>So if you for example want to capture the output in JSON format to then further do something with it, you could do the following:</p>\n<pre><code>require 'rspec/core'\n\nerror_stream = StringIO.new\noutput_stream = StringIO.new\n\nRSpec::Core::Runner.run(\n  [\n    'spec/path/to_spec_1.rb',\n    'spec/path/to_spec_2.rb',\n    '--format=json'\n  ],\n  error_stream,\n  output_stream\n)\n\nRSpec.reset\n\nerrors =\n  if error_stream.string.present?\n    JSON.parse(error_stream.string)\n  end\n\nresults =\n  if output_stream.string.present?\n    JSON.parse(output_stream.string)\n  end\n\n</code></pre>\n"}], "owner": {"reputation": 826, "user_id": 1172205, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/014a4f4f59a5074908ce3cc9464bd467?s=128&d=identicon&r=PG", "display_name": "Scott Hillson", "link": "https://stackoverflow.com/users/1172205/scott-hillson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1605, "favorite_count": 1, "answer_count": 1, "score": 7, "last_activity_date": 1608632992, "creation_date": 1538420842, "last_edit_date": 1538439033, "question_id": 52597371, "link": "https://stackoverflow.com/questions/52597371/execute-an-rspec-test-in-rails-console", "title": "Execute an rspec test in Rails Console", "body": "<p>Say I have a user_spec.rb for my User model, and I want to run that test inside the rails console.</p>\n\n<p>My first thought is to execute the usual shell command:</p>\n\n<pre><code>exec(\"./spec/user_spec.rb\")\n</code></pre>\n\n<p>But is there a simpler way to run the spec? I'm trying to automate some of the tests (and reinvent the wheel a little, yes), so being able to trigger an rspec test inside of another Ruby class seems ideal.</p>\n\n<p>Edit:</p>\n\n<pre><code>output = `./spec/user_spec.rb`\n</code></pre>\n\n<p>This will provide the rspec output and $?.success? will then provide a pass fail value. Is this the best solution here? Or is there a way to call an RSpec class itself?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "is_accepted": true, "score": 0, "last_activity_date": 1538421898, "creation_date": 1538421898, "answer_id": 52597600, "question_id": 52597325, "link": "https://stackoverflow.com/questions/52597325/how-to-pass-parameters-in-redirect-to/52597600#52597600", "title": "how to pass parameters in redirect_to", "body": "<p>well, I was testing over test and I found this solution</p>\n\n<pre><code>format.html {redirect_to params[:location].nil? ? @prov : provs_path(id: @prov.id, location: 1), notice: 'Success.'}\n</code></pre>\n\n<p>and it worked for me.</p>\n"}], "owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 52597600, "answer_count": 1, "score": 0, "last_activity_date": 1538427785, "creation_date": 1538420582, "question_id": 52597325, "link": "https://stackoverflow.com/questions/52597325/how-to-pass-parameters-in-redirect-to", "title": "how to pass parameters in redirect_to", "body": "<p>Starting with Ruby on rails, I've generated a ProvsController using scaffold.</p>\n\n<p>It generated me this create method:</p>\n\n<pre><code>def create\n  @prov = Prov.new(prov_params)\n  respond_to do |format|\n  if @prov.save\n     format.html {redirect_to @prov, notice: 'Success'}\n     format.json {render :show, status: :created, location: @prov}\n  else\n     format.html {render :new}\n     format.json {render json: @prov.errors, status: :unprocessable_entity}\n  end\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>private\ndef prov_params\n  params.require(:prov).permit(:name, :description)\nend\n</code></pre>\n\n<p>I want to send parameters back to the view under some conditions, that is to say if <code>params[:location].nil?</code> is not true. I did this:</p>\n\n<pre><code>format.html {redirect_to params[:location].nil? ? @prov : provs_url(location: 1), notice: 'Success.'}\n</code></pre>\n\n<p>But <code>@prov</code> and <code>provs_url</code> are not the same. I tried </p>\n\n<pre><code>@prov : @prov(location: 1)\n@prov : prov_url(location: 1)\n</code></pre>\n\n<p>and some other variations, unsuccessfully. All those combinations throw errors.</p>\n\n<p>What I want is to send the <code>location</code> param back to the same view as in <code>@prov</code>. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "edited": false, "score": 0, "creation_date": 1538432828, "post_id": 52596413, "comment_id": 92133918, "body": "Check this thread and see if it helps? <a href=\"https://stackoverflow.com/a/38507114/9911698\">stackoverflow.com/a/38507114/9911698</a>"}, {"owner": {"reputation": 600, "user_id": 8129831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/awcNg.jpg?s=128&g=1", "display_name": "H Dox", "link": "https://stackoverflow.com/users/8129831/h-dox"}, "edited": false, "score": 0, "creation_date": 1538439552, "post_id": 52596413, "comment_id": 92135361, "body": "Try remove your Gemfile.lock and bundle install again."}], "owner": {"reputation": 11, "user_id": 6483247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ae42f4f32582ae07b91c9b587bf9268?s=128&d=identicon&r=PG&f=1", "display_name": "youngdhalsim", "link": "https://stackoverflow.com/users/6483247/youngdhalsim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538430445, "creation_date": 1538416644, "last_edit_date": 1538430445, "question_id": 52596413, "link": "https://stackoverflow.com/questions/52596413/issues-with-starting-a-rails-project", "title": "Issues with starting a Rails project", "body": "<p>I decided to start a rails project. I went to the terminal and as usual typed in rails new blog. Instead of it completing I got this error</p>\n\n<p>Installing nio4r 2.3.1 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.</p>\n\n<p>current directory:\nC:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/nio4r-2.3.1/ext/nio4r\nC:/Ruby23-x64/bin/ruby.exe -r ./siteconf20181001-1392-69sdrh.rb extconf.rb</p>\n\n<p>current directory: C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/nio4r-2.3.1/ext/nio4r\nmake \"DESTDIR=\" clean\n'make' is not recognized as an internal or external command,\noperable program or batch file.</p>\n\n<p>current directory: C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/nio4r-2.3.1/ext/nio4r\nmake \"DESTDIR=\"\n'make' is not recognized as an internal or external command,\noperable program or batch file.</p>\n\n<p>make failed, exit code 1</p>\n\n<p>Gem files will remain installed in\nC:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/nio4r-2.3.1 for inspection.\nResults logged to\nC:/Ruby23-x64/lib/ruby/gems/2.3.0/extensions/x64-mingw32/2.3.0/nio4r-2.3.1/gem_make.out</p>\n\n<p>An error occurred while installing nio4r (2.3.1), and Bundler cannot continue.\nMake sure that <code>gem install nio4r -v '2.3.1' --source 'https://rubygems.org/'</code>\nsucceeds before bundling.</p>\n\n<p>In Gemfile:\n  rails was resolved to 5.2.1, which depends on\n    actioncable was resolved to 5.2.1, which depends on\n      nio4r</p>\n\n<p>Now I did install the gem file nio4r version 2.3.1 and it installed successfully. but I still received the same error message. I do not know what is causing this.</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "edited": false, "score": 0, "creation_date": 1538419272, "post_id": 52596443, "comment_id": 92128633, "body": "I removed it, but then the behavior of Capybara changed where it was not waiting for first element (looked like it was set to false). Anything else I might have missed? Thanks."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "edited": false, "score": 0, "creation_date": 1538434173, "post_id": 52596443, "comment_id": 92134285, "body": "@ibaralf As long as you&#39;re using Capybara 3+ and you&#39;re not passing in &#39;minimum: 0&#39; to the <code>first</code> call there is no way to not have Capybaras <code>first</code> wait up to Capybara.default_max_wait_time seconds for the element to exist.  That being said it&#39;s completely possible site_prism is overriding <code>first</code> and/or passing <code>minimum: 0</code>.  Add the code that isn&#39;t waiting for the element to the question and  a stack trace."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "edited": false, "score": 1, "creation_date": 1538441528, "post_id": 52596443, "comment_id": 92135748, "body": "@ibaralf SitePrism does disable all of Capybaras normal waiting behavior because it sets <code>wait</code> to false in <code>merge_args</code> which is called from <a href=\"https://github.com/natritmeyer/site_prism/blob/v2.17.1/lib/site_prism/element_container.rb#L82\" rel=\"nofollow noreferrer\">github.com/natritmeyer/site_prism/blob/v2.17.1/lib/site_pris&zwnj;&#8203;m/&hellip;</a> - <a href=\"https://github.com/natritmeyer/site_prism/blob/v2.17.1/lib/site_prism/element_container.rb#L58\" rel=\"nofollow noreferrer\">github.com/natritmeyer/site_prism/blob/v2.17.1/lib/site_pris&zwnj;&#8203;m/&hellip;</a> .  You can enable Capybaras normal behavior by setting <code>SitePrism.use_implicit_waits = true</code> - or you&#39;ll have to use the wait_for_xxx, etc methods provided by SitePrism -"}, {"owner": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "edited": false, "score": 0, "creation_date": 1538583190, "post_id": 52596443, "comment_id": 92196159, "body": "I tried to go through the site_prism code as well, but didn&#39;t see it. Thanks for this, really appreciate the help."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 2, "last_activity_date": 1538416752, "creation_date": 1538416752, "answer_id": 52596443, "question_id": 52596328, "link": "https://stackoverflow.com/questions/52596328/getting-error-undefined-method-capybara-wait-on-first-by-default/52596443#52596443", "title": "Getting error undefined method Capybara.wait_on_first_by_default", "body": "<p>That setting was removed in Capybara 3 - and is now the normal behavior for <code>first</code>.  If you were setting it to <code>true</code> you can just remove the offending line.</p>\n"}], "owner": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 52596443, "answer_count": 1, "score": 0, "last_activity_date": 1538419384, "creation_date": 1538416231, "last_edit_date": 1538419384, "question_id": 52596328, "link": "https://stackoverflow.com/questions/52596328/getting-error-undefined-method-capybara-wait-on-first-by-default", "title": "Getting error undefined method Capybara.wait_on_first_by_default", "body": "<p>Updated to latest <a href=\"https://rubygems.org/gems/site_prism/versions/2.17.1\" rel=\"nofollow noreferrer\">site_prism</a> gem and now I'm getting this Capybara error</p>\n\n<pre><code>Failure/Error: Capybara.wait_on_first_by_default = true\n\nNoMethodError:\nundefined method `wait_on_first_by_default=' for Capybara:Module\n# ./specs/spec_helper.rb:27:in `&lt;module:CapybaraHelper&gt;'\n# ./specs/spec_helper.rb:20:in `&lt;top (required)&gt;'\n# ./specs/lendinghome_spec.rb:1:in `require_relative'\n</code></pre>\n\n<p>bundle install shows version:</p>\n\n<pre><code>Using capybara 3.5.1\nUsing chromedriver-helper 1.2.0\nUsing site_prism 2.17.1\n</code></pre>\n\n<p>NOTE: I tried just removing this line, but the effect was Capybara was not waiting for the elements and kept not finding the next elements. Basically my previous tests which has been very stable were now failing in lots of areas or retrying.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rspec", "rspec-rails"], "answers": [{"tags": [], "owner": {"reputation": 340, "user_id": 2058716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1c6dee9f2bd987093535b4d1b1d64d5?s=128&d=identicon&r=PG", "display_name": "Wilberto", "link": "https://stackoverflow.com/users/2058716/wilberto"}, "is_accepted": true, "score": 0, "last_activity_date": 1538587094, "creation_date": 1538587094, "answer_id": 52632446, "question_id": 52596277, "link": "https://stackoverflow.com/questions/52596277/rails-test-sending-emails-on-request-specs/52632446#52632446", "title": "Rails test sending emails on request specs", "body": "<p>It turns out that my initializers were overriding the configuration in <code>config/environments/test.rb</code>. In mailer specs this is fine because <code>ActionMailer::TestCase</code> forces <code>ActionMailer::Base.delivery_method</code> to be <code>:test</code>. In requests specs this doesn't happen. </p>\n\n<p>Anyways I had to:</p>\n\n<pre><code>diff --git a/config/initializers/mail.rb b/config/initializers/mail.rb\ndeleted file mode 100644\nindex 4b8000f..0000000\n--- a/config/initializers/mail.rb\n+++ /dev/null\n@@ -1,10 +0,0 @@\n-ActionMailer::Base.smtp_settings = {\n-    :address              =&gt; \"example.com\",\n-    :port                 =&gt; 587,\n-  } \n- \n-ActionMailer::Base.delivery_method = :smtp\n</code></pre>\n\n<p>and add these settings to each <code>config/environment/</code> file.</p>\n"}], "owner": {"reputation": 340, "user_id": 2058716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1c6dee9f2bd987093535b4d1b1d64d5?s=128&d=identicon&r=PG", "display_name": "Wilberto", "link": "https://stackoverflow.com/users/2058716/wilberto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 52632446, "answer_count": 1, "score": 0, "last_activity_date": 1538587094, "creation_date": 1538416001, "last_edit_date": 1538416352, "question_id": 52596277, "link": "https://stackoverflow.com/questions/52596277/rails-test-sending-emails-on-request-specs", "title": "Rails test sending emails on request specs", "body": "<p>I'm using <code>rails 4.2.4</code> and I am trying to test that a email is sent in a requests spec.</p>\n\n<pre><code>it \"sends a reset password email to the user\" do\n  expect do\n    post users_reset_password_path, params, headers\n  end.to change(ActionMailer::Base.deliveries, :size).by(1)\nend\n</code></pre>\n\n<p>This is resulting in:</p>\n\n<pre><code>end.to change(ActionMailer::Base.deliveries, :size).by(1)\n\nexpected `Array#size` to have changed by 1, but was changed by 0\n</code></pre>\n\n<p>I'm sure my email is being sent because I see it in <code>log/test.log</code>. So my questing, is this happening because it is a <code>request</code> spec? If so, how can I test sending an email in a request spec? Is <code>ActionMailer::Base.deliveries</code> only updated in mailer specs? </p>\n\n<p>To provide more context I'm using devise so in the controller I'm calling <code>user.send_reset_password_instructions</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "pdf-generation", "prawn"], "comments": [{"owner": {"reputation": 1305, "user_id": 623919, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c7d2113d86e7a9b16e8cac6956096bf0?s=128&d=identicon&r=PG", "display_name": "Axel Tetzlaff", "link": "https://stackoverflow.com/users/623919/axel-tetzlaff"}, "edited": false, "score": 0, "creation_date": 1538418265, "post_id": 52596142, "comment_id": 92128162, "body": "Have you checked the file size of the downloaded file? Is it maybe empty?"}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1538420580, "post_id": 52596142, "comment_id": 92129236, "body": "Check this video <a href=\"https://www.youtube.com/watch?v=BW5zwqj37Lo&amp;t=233s\" rel=\"nofollow noreferrer\">youtube.com/watch?v=BW5zwqj37Lo&amp;t=233s</a>"}, {"owner": {"reputation": 13, "user_id": 10441948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d99d214ff46101fffbccb856f6317a6?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen Bothwell", "link": "https://stackoverflow.com/users/10441948/stephen-bothwell"}, "reply_to_user": {"reputation": 1305, "user_id": 623919, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c7d2113d86e7a9b16e8cac6956096bf0?s=128&d=identicon&r=PG", "display_name": "Axel Tetzlaff", "link": "https://stackoverflow.com/users/623919/axel-tetzlaff"}, "edited": false, "score": 0, "creation_date": 1538514820, "post_id": 52596142, "comment_id": 92167159, "body": "@AxelTetzlaff: The file size was only nine bytes or so; the way in which the data was transmitted (using send_data) likely did not appropriately return the PDF and may have lost some of the data on the way. The answer below utilizing send_file seems to have solved my issue, however. Thanks!"}, {"owner": {"reputation": 1305, "user_id": 623919, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c7d2113d86e7a9b16e8cac6956096bf0?s=128&d=identicon&r=PG", "display_name": "Axel Tetzlaff", "link": "https://stackoverflow.com/users/623919/axel-tetzlaff"}, "edited": false, "score": 0, "creation_date": 1538589342, "post_id": 52596142, "comment_id": 92199283, "body": "I guess the content of the file was &quot;hello.pdf&quot; \ud83d\ude02"}], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "is_accepted": false, "score": 0, "last_activity_date": 1538418855, "creation_date": 1538418855, "answer_id": 52596938, "question_id": 52596142, "link": "https://stackoverflow.com/questions/52596142/ruby-on-rails-prawn-gem-generates-pdf-but-pdf-cannot-display/52596938#52596938", "title": "Ruby on Rails: Prawn Gem Generates PDF, but PDF Cannot Display", "body": "<p>I am using prawn a lot in my project and this is the config that i follow. Haven't faced any problem till now.</p>\n\n<pre><code>send_data your_file.render, filename: filename, type: \"application/pdf\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10441948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d99d214ff46101fffbccb856f6317a6?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen Bothwell", "link": "https://stackoverflow.com/users/10441948/stephen-bothwell"}, "edited": false, "score": 0, "creation_date": 1538514911, "post_id": 52599059, "comment_id": 92167203, "body": "This worked! Do you have any idea why send_data didn&#39;t work? Does it have to do with the way in which the two methods send the file back to the requesting user?"}, {"owner": {"reputation": 61, "user_id": 9115207, "user_type": "registered", "profile_image": "https://graph.facebook.com/1775788529100093/picture?type=large", "display_name": "Yoidel Martinez Baquero", "link": "https://stackoverflow.com/users/9115207/yoidel-martinez-baquero"}, "reply_to_user": {"reputation": 13, "user_id": 10441948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d99d214ff46101fffbccb856f6317a6?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen Bothwell", "link": "https://stackoverflow.com/users/10441948/stephen-bothwell"}, "edited": false, "score": 0, "creation_date": 1538516763, "post_id": 52599059, "comment_id": 92167901, "body": "<code>send_data</code> first argument is data(in this case content of pdf) to send not the file location .<code>send_file</code> first argument is the location of the file to send. &quot;hello.pdf&quot; is the file name created before not the content that you want to send."}], "tags": [], "owner": {"reputation": 61, "user_id": 9115207, "user_type": "registered", "profile_image": "https://graph.facebook.com/1775788529100093/picture?type=large", "display_name": "Yoidel Martinez Baquero", "link": "https://stackoverflow.com/users/9115207/yoidel-martinez-baquero"}, "is_accepted": true, "score": 2, "last_activity_date": 1538428916, "creation_date": 1538428916, "answer_id": 52599059, "question_id": 52596142, "link": "https://stackoverflow.com/questions/52596142/ruby-on-rails-prawn-gem-generates-pdf-but-pdf-cannot-display/52599059#52599059", "title": "Ruby on Rails: Prawn Gem Generates PDF, but PDF Cannot Display", "body": "<p>Change <code>send_data</code> with  <code>send_file</code> : </p>\n\n<pre><code> def download_report\n    Prawn::Document.generate(\"hello.pdf\") do\n      text \"Hello World!\"\n    end\n    send_file \"hello.pdf\",type: 'application/pdf'\nend \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10441948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d99d214ff46101fffbccb856f6317a6?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen Bothwell", "link": "https://stackoverflow.com/users/10441948/stephen-bothwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 52599059, "answer_count": 2, "score": 1, "last_activity_date": 1538428916, "creation_date": 1538415337, "question_id": 52596142, "link": "https://stackoverflow.com/questions/52596142/ruby-on-rails-prawn-gem-generates-pdf-but-pdf-cannot-display", "title": "Ruby on Rails: Prawn Gem Generates PDF, but PDF Cannot Display", "body": "<p>I have been using Ruby on Rails (version 5.2.1) with the RubyMine IDE for a project and am at a development stage in which I want to create some PDF-based reports. For this, I have grabbed the Prawn (version 2.2.2) gem. I set up a button that would download the PDF from a page:</p>\n\n<pre><code>&lt;%= button_to \"Download\", action: :download_report %&gt;\n</code></pre>\n\n<p>It is routed to the appropriate controller:</p>\n\n<pre><code>get 'pages#download_report' =&gt; 'pages#report_page'\npost 'pages#download_report', action: :download_report, controller: 'pages'\n</code></pre>\n\n<p>And in the Pages controller, the download_report method is:</p>\n\n<pre><code>def download_report\n    Prawn::Document.generate(\"hello.pdf\") do\n        text \"Hello World!\"\n    end\n    send_data(\"hello.pdf\", filename: \"hello.pdf\", type: 'application/pdf')\nend\n</code></pre>\n\n<p>The server runs fine in development and there is no error in utilizing the button. A PDF is sent and I can \"open\" it, but the PDF fails to load and will not open in any PDF reader that I have tried, including Microsoft Edge's and Adobe Acrobat Reader. I am perplexed as to why this error is happening, as it seems like this basic test should work. I am still relatively new to Ruby on Rails, so I would not be surprised if it is a basic error, but it is not one that I am easily seeing. Any help or advice is appreciated.</p>\n\n<p>Thanks to anyone who responds in advance! Let me know if you want me to provide any more information to help diagnose the problem.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538424057, "post_id": 52593761, "comment_id": 92130790, "body": "That&#39;s the tallest hash I&#39;ve seen in a long time. In real life consider doing some shortening such as making the following one line:  <code>{ activity: [{ id: &quot;1A&quot; }, { id: &quot;2A&quot; }], id: &quot;GA&quot; }</code> (or even <code>goal: [{ activity: [{ id: &quot;1A&quot; }, { id: &quot;2A&quot; }], id: &quot;GA&quot; }],</code>). Isn&#39;t that just as clear? It&#39;s helpful to be able to view an entire object without having to scroll vertically (and even more so, horizontally). Of course, if one were paid by the line of code.."}], "answers": [{"tags": [], "owner": {"reputation": 600, "user_id": 8129831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/awcNg.jpg?s=128&g=1", "display_name": "H Dox", "link": "https://stackoverflow.com/users/8129831/h-dox"}, "is_accepted": false, "score": 0, "last_activity_date": 1538411951, "creation_date": 1538411951, "answer_id": 52595371, "question_id": 52593761, "link": "https://stackoverflow.com/questions/52593761/convert-an-array-of-objects-created-from-openstruct-into-an-array-of-values/52595371#52595371", "title": "convert an array of objects (created from OpenStruct) into an array of values", "body": "<p>You will have to check the child node recursively until you find the <code>OpenStruct</code> with only <code>:id</code> element. Following is the working code for your sample data.</p>\n\n<pre><code>def self.convert_struct_id(os)\n  # Get possible attributes of any open_struct\n  attributes = os.to_h.keys\n\n  # Only get id_value if :id is the only attribute of open_struct\n  if attributes.length == 1 &amp;&amp; attributes.first == :id\n    id_value = os.send(:id)\n    return id_value\n  end\n\n  # Iterate through attributes\n  attributes.each do |attr|\n    # Get child elements\n    data = os.send(attr)\n    case data\n    when OpenStruct\n      convert_struct_id(data)\n    when Array\n      # Recursively process for child node\n      data.map! { |d| convert_struct_id(d) }\n    end\n  end\n  return os\nend\n</code></pre>\n\n<p>Your <code>self.all</code> method will look like this</p>\n\n<pre><code>def self.all\n  json = HASH.to_json\n  os = JSON.parse(json, object_class: OpenStruct)\n  res = convert_struct_id(os)\nend\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>=&gt; #&lt;OpenStruct items=[#&lt;OpenStruct health=[#&lt;OpenStruct goal=[#&lt;OpenStruct activity=[\"1A\", \"2A\"], id=\"GA\"&gt;], activity=[\"1B\", \"2B\"], id=\"GB\"&gt;], goal=[#&lt;OpenStruct activity=[\"1C\", \"2C\"], id=\"3c\"&gt;], createdAt=\"2018-01-01\", updatedAt=\"2018-01-01\", id=\"DA\"&gt;]&gt;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10426417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7828d2ad9b039fb226fc1858173cd055?s=128&d=identicon&r=PG&f=1", "display_name": "user10426417", "link": "https://stackoverflow.com/users/10426417/user10426417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538423410, "creation_date": 1538405584, "last_edit_date": 1538423410, "question_id": 52593761, "link": "https://stackoverflow.com/questions/52593761/convert-an-array-of-objects-created-from-openstruct-into-an-array-of-values", "title": "convert an array of objects (created from OpenStruct) into an array of values", "body": "<p>I am learning ruby and I am playing with a sample data. I converted following hash into an array of objects as follows.</p>\n\n<pre><code>class Openstruct\n  require 'JSON'\n  require 'ostruct'\n\n  HASH = {\n    items: [\n      {\n        health: [\n          {\n            goal: [\n              {\n                activity: [\n                  {\n                    id: \"1A\"\n                  },\n                  {\n                    id: \"2A\"\n                  }\n                ],\n                id: \"GA\"\n              }\n            ],\n            activity: [\n              {\n                id: \"1B\"\n              },\n              {\n                id: \"2B\"\n              }\n            ],\n            id: \"GB\"\n          }\n        ],\n        goal: [\n          {\n            activity: [\n              {\n                id: \"1C\"\n              },\n              {\n                id: \"2C\"\n              },\n            ],\n            id: \"3c\"\n          }\n        ],\n        createdAt: \"2018-01-01\",\n        updatedAt: \"2018-01-01\",\n        id: \"DA\"\n      }\n    ],\n  }\n\n  def self.all\n    json = HASH.to_json\n    JSON.parse(json, object_class: OpenStruct)\n  end\n\nend\n</code></pre>\n\n<p>Above returns me following result</p>\n\n<pre><code>#&lt;OpenStruct items=\n  [#&lt;OpenStruct health=\n      [#&lt;OpenStruct goal=\n        [#&lt;OpenStruct activity=\n          [#&lt;OpenStruct id=\"1A\"&gt;, #&lt;OpenStruct id=\"2A\"&gt;], id=\"GA\"&gt;], \n          activity=[#&lt;OpenStruct id=\"1B\"&gt;, #&lt;OpenStruct id=\"2B\"&gt;], id=\"GB\"&gt;], \n          goal=[#&lt;OpenStruct activity=[#&lt;OpenStruct id=\"1C\"&gt;, #&lt;OpenStruct id=\"2C\"&gt;], id=\"3c\"&gt;], \n          createdAt=\"2018-01-01\", \n          updatedAt=\"2018-01-01\", \n          id=\"DA\"&gt;]&gt;\n</code></pre>\n\n<p>However, i want to convert the array of object having id's into array of values of ids. e.g <code>[#&lt;OpenStruct id=\"1A\"&gt;, #&lt;OpenStruct id=\"2A\"&gt;]</code> --> [\"1A\", \"2A\"]. so i want the final result as follows:</p>\n\n<pre><code>#&lt;OpenStruct items=\n  [#&lt;OpenStruct health=\n      [#&lt;OpenStruct goal=\n        [#&lt;OpenStruct activity=\n          [\"1A\",\"2A\"], id=\"GA\"&gt;], \n          activity=[\"1B\", 2B\"], id=\"GB\"&gt;], \n          goal=[#&lt;OpenStruct activity=[\"1C\",\"2C\"], id=\"3c\"&gt;], \n          createdAt=\"2018-01-01\", \n          updatedAt=\"2018-01-01\", \n          id=\"DA\"&gt;]&gt;\n</code></pre>\n\n<p>Does anyone know how to do that?</p>\n"}, {"tags": ["ruby", "rubygems", "cgi", "uberspace"], "answers": [{"comments": [{"owner": {"reputation": 3044, "user_id": 1821701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99328a43b00d9b2cf789621a03677b8d?s=128&d=identicon&r=PG", "display_name": "Theo", "link": "https://stackoverflow.com/users/1821701/theo"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538414552, "post_id": 52592803, "comment_id": 92126569, "body": "I just picked a random gem that I used for another project. Of course, rack doesn&#39;t make sense here, so I updated the reply. I sometimes use CGI for quick tests/prototypes. Having a functional script on a webserver within a few seconds is useful in 2018 too."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1538417232, "post_id": 52592803, "comment_id": 92127686, "body": "That&#39;s what things like <a href=\"http://sinatrarb.com\" rel=\"nofollow noreferrer\">Sinatra</a> are good for. Since that&#39;s a Rack application you can use any <a href=\"https://www.ruby-toolbox.com/categories/web_servers\" rel=\"nofollow noreferrer\">Rack web server</a> and interface with it directly. CGI is really, really slow because it has to spin up a new process each time."}], "tags": [], "owner": {"reputation": 3044, "user_id": 1821701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99328a43b00d9b2cf789621a03677b8d?s=128&d=identicon&r=PG", "display_name": "Theo", "link": "https://stackoverflow.com/users/1821701/theo"}, "is_accepted": true, "score": 1, "last_activity_date": 1538414197, "last_edit_date": 1538414197, "creation_date": 1538402345, "answer_id": 52592803, "question_id": 52592802, "link": "https://stackoverflow.com/questions/52592802/how-to-use-ruby-cgi-scripts-on-uberspace/52592803#52592803", "title": "How to use Ruby CGI scripts on Uberspace", "body": "<p>First, note that Uberspace 7 runs on SELinux. This means that CGI script files in <code>~/html/</code> not only have to be executable but also need the correct SELinux context. In this case, the type must be <code>httpd_sys_content_t</code>. </p>\n\n<p>You can view the SELinux context with <code>ls -lZ</code>:</p>\n\n<pre><code>$ ls -Z file1\n-rw-rw-r--  user1 group1 unconfined_u:object_r:user_home_t:s0 file1\n</code></pre>\n\n<p>If some files have the wrong context, the context can be restored with the <code>restorecon</code> command, e.g. <code>restorecon -R ~/html/</code>.</p>\n\n<p>The user installation directory for Ruby gems is <code>~/.gem/</code>. On Uberspace, <code>gem install</code> installs into that directory by default:</p>\n\n<pre><code>$ cat /etc/gemrc\ngem: --no-document --user-install\n</code></pre>\n\n<p>As the home directory cannot be accessed by the apache process, gems installed there cannot be executed from CGI scripts. You can install gems in <code>/var/www/virtual/$USER/gem</code> instead, create the directory with</p>\n\n<pre><code>$ mkdir /var/www/virtual/$USER/gem\n</code></pre>\n\n<p>You cannot use the <code>--install-dir</code> parameter for <code>gem install</code> directly as this conflicts with the default parameters mentioned above:</p>\n\n<pre><code>$ gem install mygem --install-dir /var/www/virtual/$USER/gem\nERROR:  Use --install-dir or --user-install but not both\n</code></pre>\n\n<p>Instead, create <code>~/.gemrc</code> with the following content to override the default parameters (replace <code>&lt;USERNAME&gt;</code> with your actual user name):</p>\n\n<pre><code>gem: --install-dir /var/www/virtual/&lt;USERNAME&gt;/gem\n</code></pre>\n\n<p>Now the installation of gems should work:</p>\n\n<pre><code>$ gem install mygem\n</code></pre>\n\n<p>To use the gems in CGI scripts, set the <code>Gem.paths</code> variable before requiring gems:</p>\n\n<pre><code>#!/usr/bin/ruby\n\nGem.paths = { 'GEM_PATH' =&gt; '/var/www/virtual/&lt;USERNAME&gt;/gem' }\n\nrequire 'mygem'\n\n(... rest of the script)\n</code></pre>\n\n<p>This is needed as we cannot modify the environment variables (i.e. set <code>GEM_PATH</code>) for the apache process.</p>\n"}], "owner": {"reputation": 3044, "user_id": 1821701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99328a43b00d9b2cf789621a03677b8d?s=128&d=identicon&r=PG", "display_name": "Theo", "link": "https://stackoverflow.com/users/1821701/theo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 52592803, "answer_count": 1, "score": 0, "last_activity_date": 1538414197, "creation_date": 1538402345, "question_id": 52592802, "link": "https://stackoverflow.com/questions/52592802/how-to-use-ruby-cgi-scripts-on-uberspace", "title": "How to use Ruby CGI scripts on Uberspace", "body": "<p>I want to use Ruby CGI scripts on an Uberspace 7, but ran into several issues with permissions and security settings, in particular when using gems. How do I install CGI scripts with custom gems?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "edited": false, "score": 1, "creation_date": 1538398404, "post_id": 52591388, "comment_id": 92117845, "body": "Are you getting any error messages with your current approach? If so add them to the question."}, {"owner": {"reputation": 45, "user_id": 9436038, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I2xMvsU9oCo/AAAAAAAAAAI/AAAAAAAAAU0/v6l77nnfc2Y/photo.jpg?sz=128", "display_name": "Raycee", "link": "https://stackoverflow.com/users/9436038/raycee"}, "reply_to_user": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "edited": false, "score": 0, "creation_date": 1538399742, "post_id": 52591388, "comment_id": 92118603, "body": "yes i am.Let me add."}, {"owner": {"reputation": 1707, "user_id": 3292174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DNPrX.jpg?s=128&g=1", "display_name": "Michael Malov", "link": "https://stackoverflow.com/users/3292174/michael-malov"}, "edited": false, "score": 0, "creation_date": 1538401314, "post_id": 52591388, "comment_id": 92119592, "body": "<code>user</code> is undefined in <code>_recipient.html.erb</code>. Maybe it should be <code>&lt;%= check_box_tag &quot;message[user_tokens][]&quot;,contact.id ...</code>"}, {"owner": {"reputation": 2062, "user_id": 4896126, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/aUY9T.png?s=128&g=1", "display_name": "Marcos R. Guevara", "link": "https://stackoverflow.com/users/4896126/marcos-r-guevara"}, "edited": false, "score": 0, "creation_date": 1538402302, "post_id": 52591388, "comment_id": 92120212, "body": "can you add the models here? for example, you can access messages if the message model belongs_to user model, then with something like current_user.messages it will return what you need, i think you use so much code for that."}], "answers": [{"tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": true, "score": 1, "last_activity_date": 1538401626, "creation_date": 1538401626, "answer_id": 52592575, "question_id": 52591388, "link": "https://stackoverflow.com/questions/52591388/getting-user-phone-number-and-sending-a-message-in-ruby-on-rails/52592575#52592575", "title": "Getting user phone number and sending a message in ruby on rails", "body": "<p>It's not very clear why you use local variable <code>user</code> in your view template. I think it's just an error and <code>contact</code> variable is supposed to be used instead:</p>\n\n<pre><code>&lt;span class=\"list-group-item\"&gt;&lt;%= contact.name %&gt;&lt;/span&gt;&lt;%= check_box_tag \"message[user_tokens][]\", contact.id, @message.users.include?(contact), id: \"user#{contact.id}\" %&gt;\n</code></pre>\n\n<p>Also, a small HTML error: <code>ul</code> tag should contain <code>li</code> tags; other tags are not allowed as direct descendants. So I would also rewrite that list as:</p>\n\n<pre><code>&lt;ul&gt;\n  &lt;% @recipients.each do |contact| %&gt;\n  &lt;li id=\"stream_item\"&gt;\n    &lt;label for=\"user&lt;%=contact.id%&gt;\" &gt;\n      &lt;span class=\"list-group-item\"&gt;&lt;%= contact.name %&gt;&lt;/span&gt;&lt;%= check_box_tag \"message[user_tokens][]\", contact.id, @message.users.include?(contact), id: \"user#{contact.id}\" %&gt;\n    &lt;/label&gt;\n  &lt;/li&gt;\n  &lt;br&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9436038, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I2xMvsU9oCo/AAAAAAAAAAI/AAAAAAAAAU0/v6l77nnfc2Y/photo.jpg?sz=128", "display_name": "Raycee", "link": "https://stackoverflow.com/users/9436038/raycee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 52592575, "answer_count": 1, "score": 0, "last_activity_date": 1538402186, "creation_date": 1538397622, "last_edit_date": 1538402186, "question_id": 52591388, "link": "https://stackoverflow.com/questions/52591388/getting-user-phone-number-and-sending-a-message-in-ruby-on-rails", "title": "Getting user phone number and sending a message in ruby on rails", "body": "<p>I am working on a messaging app in ruby and i am currently encountering a blocker which i can not fix. I have been using tutorials for this and i think part of the reason i cannot find the solution is because of that. My app allows the users to log in and sign up,they can then add,view and edit contact. Finally the can send a message to different recipients. The problem is, i cannot get the recipients in the contacts and send them a message. I am only able to select my name as a user(which is not what its intended to do). I have attached the controllers used here:</p>\n\n<p><strong>contacts_controller</strong></p>\n\n<pre><code>class ContactsController &lt; ApplicationController\n    def index\n        @contacts = Contact.all\n    end\n\n    def new\n        @contact = Contact.new\n    end\n\n    def create\n        @contact = Contact.new(contact_params)\n        if @contact.save\n            flash[:success]= \"new contact successfully added!\"\n            redirect_to contacts_path\n        else\n            render 'new'\n        end\n    end\n\n    def edit\n        @contact = Contact.find(params[:id])\n    end\n\n    def update\n        @contact = Contact.find(params[:id])\n         permitted_columns = params.require(:contact).permit(:name, :company, :email, :phone)\n        @contact.update_attributes(permitted_columns)\n        redirect_to contacts_path\n    end\n\n    def destroy\n        @contact = Contact.find(params[:id])\n        @contact.destroy\n        redirect_to contacts_path\n    end\n\n    private\n\n    def contact_params\n        params.require(:contact).permit(:name, :company, :email, :phone)\n    end\nend\n</code></pre>\n\n<p><strong>messages_controller</strong></p>\n\n<pre><code>class MessagesController &lt; ApplicationController\n\n    def index\n        @messages = Recipient.where(:user_id =&gt; current_user.id).order('created_at DESC')\n    end\n\n    def new\n        @message = Message.new\n        @recipients = Contact.all\n    end\n\n    def create\n      @message = current_user.messages.build(message_params)\n\n      if @message.save\n        flash[:success]= \"Message sent!\"\n        redirect_to contacts_path \n      else\n        flash[:alert]= \"sorry!message unsent\"\n        render :new\n      end\n    end\n\n    private\n\n    def message_params\n        params.require(:message).permit(:body, :sender_id, user_tokens:[]) \n    end\nend\n</code></pre>\n\n<p><strong>users_controller</strong></p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n    def index\n    end\n\n    def create\n        user = User.new(user_params)\n        if user.save\n            session[:user_id] = user.id\n            redirect_to '/contact'\n        else\n            flash[:register_errors] = user.errors.full_messages\n            redirect_to '/'\n        end\n    end\n\n    private\n\n    def user_params\n         params.require(:user).permit(:fname, :lname, :email, :password, :password_confirmation)\n    end\nend\n</code></pre>\n\n<p><strong>sessions_controller</strong></p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n\n    def create\n        user = User.find_by(email:login_params[:email])\n        if user &amp;&amp; user.authenticate(login_params[:password])\n            session[:user_id] = user.id\n            redirect_to '/contact'\n        else\n            flash[:login_errors] = ['invalid username or password']\n            redirect_to '/'\n        end\n    end\n\n    def destroy\n        session[:user_id] = nil\n        redirect_to '/', notice: 'Successfully logged out!'\n    end\n\n    private\n\n    def login_params\n        params.require(:login).permit(:email,:password)\n    end\nend\n</code></pre>\n\n<p>The _recipient.html.erb is rendered by the <code>new.html.erb</code>. Here is the code:</p>\n\n<pre><code>    &lt;div class=\"container vertical-center\"&gt;\n &lt;div id =\"stream\"&gt;\n    &lt;%= form_for :message, url:messages_path do |f| %&gt;\n    &lt;%= f.text_area :body, id: \"url\", placeholder: \"Message\", class: \"message_body\" %&gt;\n    &lt;div id=\"stream-list\" class=\"follow-list\"&gt;\n        &lt;ul&gt;\n            &lt;% @recipients.each do |contact| %&gt;\n            &lt;label for=\"user&lt;%=contact.id%&gt;\" &gt;\n                &lt;li id=\"stream_item\"&gt;\n                    &lt;span class=\"list-group-item\"&gt;&lt;%= contact.name %&gt;&lt;/span&gt;&lt;%= check_box_tag \"message[user_tokens][]\",user.id, @message.users.include?(user), id: \"user#{user.id}\" %&gt;\n               &lt;/li&gt;\n            &lt;/label&gt;\n            &lt;br&gt;\n            &lt;% end %&gt;\n        &lt;/ul&gt;\n    &lt;/div&gt;\n    &lt;div class=\"stream-footer\"&gt;\n        &lt;%= f.button :submit, class: \"btn btn-success\" %&gt;\n        &lt;% end %&gt;\n    &lt;/div&gt;\n\n &lt;/div&gt; \n&lt;/div&gt;\n</code></pre>\n\n<p>Here is the error when i try to write a message</p>\n\n<p><a href=\"https://i.stack.imgur.com/fQLdU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fQLdU.png\" alt=\"image of new message\"></a></p>\n"}, {"tags": ["ruby", "ubuntu", "readline", "irb"], "answers": [{"tags": [], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "is_accepted": false, "score": 2, "last_activity_date": 1538394383, "creation_date": 1538394383, "answer_id": 52590409, "question_id": 52590408, "link": "https://stackoverflow.com/questions/52590408/ruby-irb-up-arrow-isnt-working-gives-strange-characters-such-as-a/52590409#52590409", "title": "ruby irb up arrow isn&#39;t working - gives strange characters such as ^[[A", "body": "<p>This is a common issue on various linux distributions and versions.</p>\n\n<p>You need to have readline</p>\n\n<pre><code>sudo apt-get install build-essential (so you have a C compiler for Ruby)\nsudo apt-get install -y libssl-dev libreadline-dev zlib1g-dev\n# The above steps should make sure irb up-arrow works correctly (libreadline-dev)\n# Based on using rbenv for managing ruby versions...\nrbenv install 2.5.1 # or latest ruby version as desired\nrbenv global 2.5.1 # if you want that as default for other sessions\n</code></pre>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1538394383, "creation_date": 1538394383, "question_id": 52590408, "link": "https://stackoverflow.com/questions/52590408/ruby-irb-up-arrow-isnt-working-gives-strange-characters-such-as-a", "title": "ruby irb up arrow isn&#39;t working - gives strange characters such as ^[[A", "body": "<p>I upgraded to Ubuntu 18.\nWhen I use IRB and use arrow keys I get characters such as:</p>\n\n<pre><code>^[[A^[[B^[[C^[[B\n</code></pre>\n\n<p>How to fix?</p>\n\n<p>I posted here instead of Ubuntu as issue is ruby and maybe not just Ubuntu flavor of Linux</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10008201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DtbLv.jpg?s=128&g=1", "display_name": "Suhas Shinde", "link": "https://stackoverflow.com/users/10008201/suhas-shinde"}, "edited": false, "score": 0, "creation_date": 1538397970, "post_id": 52590651, "comment_id": 92117554, "body": "upgrading my Ruby and Rails version might help, but frankly speaking the scope should work in my current versions of Ruby (1.9.3-p551) &amp; Rails (3.2.8) because I have already defined similar types of scopes as follows:  <code>scope :managers, -&gt; { with_role(:manager) }</code>  <b>&amp;</b>  <code>scope :supervisor, -&gt; { with_role(:supervisor) }</code>  and they work perfectly fine."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 27, "user_id": 10008201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DtbLv.jpg?s=128&g=1", "display_name": "Suhas Shinde", "link": "https://stackoverflow.com/users/10008201/suhas-shinde"}, "edited": false, "score": 0, "creation_date": 1538398587, "post_id": 52590651, "comment_id": 92117946, "body": "Sure but it looks like the issue arises when you include more than one argument into the with_role method. If that&#39;s how they state you should include more than one argument, and only using 1 argument causes a ruby error, I think that points to the ruby version."}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1538395256, "creation_date": 1538395256, "answer_id": 52590651, "question_id": 52588928, "link": "https://stackoverflow.com/questions/52588928/scope-to-fetch-users-with-different-roles-on-mongoid-undefined-method-to-crite/52590651#52590651", "title": "Scope to fetch users with different roles on Mongoid (undefined method `to_criteria&#39; for #&lt;Array&gt;)", "body": "<p>Try upgrading your version of ruby. From your console output it looks like you're runnning 1.9.3. From their github:</p>\n\n<pre><code>Requirements\nRails &gt;= 4.2\nActiveRecord &gt;= 4.2 or Mongoid &gt;= 4.0\nsupports ruby 2.2+, JRuby 1.6.0+ (in 1.9 mode) and Rubinius 2.0.0dev (in 1.9 mode)\n</code></pre>\n\n<p>You may well need to upgrade Rails too if you're using Rails ~ 3</p>\n"}], "owner": {"reputation": 27, "user_id": 10008201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DtbLv.jpg?s=128&g=1", "display_name": "Suhas Shinde", "link": "https://stackoverflow.com/users/10008201/suhas-shinde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538395256, "creation_date": 1538388837, "question_id": 52588928, "link": "https://stackoverflow.com/questions/52588928/scope-to-fetch-users-with-different-roles-on-mongoid-undefined-method-to-crite", "title": "Scope to fetch users with different roles on Mongoid (undefined method `to_criteria&#39; for #&lt;Array&gt;)", "body": "<p>I am trying to define a scope in my User model on Mongoid to fetch users with either <strong>manager</strong> or <strong>supervisor</strong> role.</p>\n\n<p>In order to implement roles functionality I have used <strong>rolify</strong> gem (<a href=\"https://github.com/RolifyCommunity/rolify\" rel=\"nofollow noreferrer\">https://github.com/RolifyCommunity/rolify</a>).</p>\n\n<p>As per official gem documentation (<a href=\"https://github.com/RolifyCommunity/rolify#class-level\" rel=\"nofollow noreferrer\">https://github.com/RolifyCommunity/rolify#class-level</a>) I am using <strong>with_any_role</strong> method as follows:</p>\n\n<pre><code>scope :managers_and_supervisors, -&gt; { with_any_role(:manager, :supervisor) }\n</code></pre>\n\n<p>but when tried using the same scope in rails console I am getting <strong>undefined method `to_criteria' for Array</strong> error as follows:</p>\n\n<pre><code>1.9.3-p551 :001 &gt; User.managers_and_supervisors\nNoMethodError: undefined method `to_criteria' for #&lt;Array:0x0000000e9c3d40&gt;\n</code></pre>\n\n<p>but if I directly try to invoke the <strong>with_any_role</strong> method in rails console as follows:</p>\n\n<pre><code>1.9.3-p551 :002 &gt; User.with_any_role(:manager, :supervisor)\n</code></pre>\n\n<p>it works fine.</p>\n\n<p>I need some suggestions to correct my scope definition to fetch users with either <strong>manager</strong> or <strong>supervisor</strong> role.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 1, "creation_date": 1538385833, "post_id": 52587888, "comment_id": 92111008, "body": "relational approach would have made more sense I think"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1538387175, "post_id": 52587888, "comment_id": 92111696, "body": "Take a look at <a href=\"https://guides.rubyonrails.org/association_basics.html#the-has-and-belongs-to-many-association\" rel=\"nofollow noreferrer\">The <code>has_and_belongs_to_many</code> Association</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "reply_to_user": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "edited": false, "score": 0, "creation_date": 1538386079, "post_id": 52588001, "comment_id": 92111129, "body": "@Dev I also added a recommendation to add an index to your data to make it more performant. Could you mark the answer as correct? that helps to maintain the quality of the answers at Stackoverflow."}], "tags": [], "owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "is_accepted": true, "score": 1, "last_activity_date": 1538386022, "last_edit_date": 1538386022, "creation_date": 1538385719, "answer_id": 52588001, "question_id": 52587888, "link": "https://stackoverflow.com/questions/52587888/rails-find-if-a-value-exists-inside-a-array-column/52588001#52588001", "title": "Rails: find if a value exists inside a array column", "body": "<pre><code>Discount.where(\":user_id = ANY(user_id)\", user_id: current_user.id)\n</code></pre>\n\n<p>This should do it for you. I assume that <code>user_id</code> is an array field in a postgres database.</p>\n\n<p>I'd recommend that you also index <code>user_id</code> to be more performant. To create an index for your array column, you must choose between GiST and GIN as strategies. The <a href=\"http://www.postgresql.org/docs/9.1/static/textsearch-indexes.html\" rel=\"nofollow noreferrer\">documentation</a> covers the options nicely, but the distilled version is that GIN lookups are much (3x) faster, but take longer (10x) to build. If your data is read far more often than it is written, go for GIN.</p>\n\n<p>Your migration could be something like:</p>\n\n<pre><code>create_table \"discounts\", force: :cascade do |t|\n  t.string \"amount\"\n  t.string \"name\"\n  t.string \"from\"\n  t.string \"to\"\n  t.integer \"user_id\", default: [], array: true\nend\n\nadd_index  :discounts, :user_id, using: 'gin'\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 52588001, "answer_count": 1, "score": 0, "last_activity_date": 1538386022, "creation_date": 1538385315, "question_id": 52587888, "link": "https://stackoverflow.com/questions/52587888/rails-find-if-a-value-exists-inside-a-array-column", "title": "Rails: find if a value exists inside a array column", "body": "<p>I have a table named discounts with an array column named user_id.</p>\n\n<pre><code> create_table \"discounts\", force: :cascade do |t|\n t.string \"amount\"\n t.string \"name\"\n t.string \"from\"\n t.string \"to\"\n t.integer \"user_id\", default: [], array: true\n</code></pre>\n\n<p>I want to search the entire table of discounts and find only the rows that have a user_id(<code>current_user.id</code>).</p>\n\n<p>Any ideas how to implant this search?</p>\n"}]