[{"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "actionmailer"], "comments": [{"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501717543, "post_id": 45472450, "comment_id": 77906214, "body": "I think your problem has something to do with SendGrid setup. Erase &#39;include SendGrid&#39; and test if works."}, {"owner": {"reputation": 2927, "user_id": 1392718, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ceb84129b0baa570896eaf9bf51cc64e?s=128&d=identicon&r=PG&f=1", "display_name": "nulltek", "link": "https://stackoverflow.com/users/1392718/nulltek"}, "reply_to_user": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501717814, "post_id": 45472450, "comment_id": 77906278, "body": "@PapayaLabs no, that&#39;s not the problem.  My other mailer classes use the same include declarative and work just fine.  I removed it by your request and it yields the same exception."}, {"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501718103, "post_id": 45472450, "comment_id": 77906359, "body": "So maybe is in #{@paging.user.username}. I dont know how is your Paging Model. I do not see any otrher problem."}, {"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501718169, "post_id": 45472450, "comment_id": 77906375, "body": "Try to remove all @paging object and see if works"}, {"owner": {"reputation": 2927, "user_id": 1392718, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ceb84129b0baa570896eaf9bf51cc64e?s=128&d=identicon&r=PG&f=1", "display_name": "nulltek", "link": "https://stackoverflow.com/users/1392718/nulltek"}, "reply_to_user": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501718268, "post_id": 45472450, "comment_id": 77906406, "body": "@PapayaLabs it&#39;s not that either, as that instance variable is legitimate and its looked up via AR after the argument is passed.  The exception that is raised is not even relevant to the AR lookup.  It&#39;s the ActionMailer class the action method is not accepting arguments when they are being passed.  Please see the original question."}, {"owner": {"reputation": 2927, "user_id": 1392718, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ceb84129b0baa570896eaf9bf51cc64e?s=128&d=identicon&r=PG&f=1", "display_name": "nulltek", "link": "https://stackoverflow.com/users/1392718/nulltek"}, "reply_to_user": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501718428, "post_id": 45472450, "comment_id": 77906452, "body": "Removing the <code>@paging</code> object doesn&#39;t work and even if it did work I wouldn&#39;t be able to pass the object to my view for rendering which would make my mailer useless."}, {"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501718873, "post_id": 45472450, "comment_id": 77906548, "body": "Ok I reproduce your code and if you change your method name &#39;message&#39; works. That was the last variable to test. I really do not know why."}, {"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501718959, "post_id": 45472450, "comment_id": 77906572, "body": "I think is a reserved word in ActionMailer"}, {"owner": {"reputation": 2927, "user_id": 1392718, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ceb84129b0baa570896eaf9bf51cc64e?s=128&d=identicon&r=PG&f=1", "display_name": "nulltek", "link": "https://stackoverflow.com/users/1392718/nulltek"}, "reply_to_user": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501719506, "post_id": 45472450, "comment_id": 77906710, "body": "@PapayaLabs you were right, I was looking this up too in between comments.  I renamed the method to <code>new_message</code> and it worked! Thanks for the help, i&#39;ll accept your answer!"}, {"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501719940, "post_id": 45472450, "comment_id": 77906806, "body": "Your welcome! I am searching why is this happen."}, {"owner": {"reputation": 2927, "user_id": 1392718, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ceb84129b0baa570896eaf9bf51cc64e?s=128&d=identicon&r=PG&f=1", "display_name": "nulltek", "link": "https://stackoverflow.com/users/1392718/nulltek"}, "reply_to_user": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1501758647, "post_id": 45472450, "comment_id": 77925339, "body": "@PapayaLabs it&#39;s part of the internals for ActionMailer, it&#39;s not a bug so no PR for either of us as it&#39;s a cosmetic change and rails core doesn&#39;t accept cosmetics."}], "answers": [{"tags": [], "owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "is_accepted": true, "score": 4, "last_activity_date": 1501776806, "last_edit_date": 1501776806, "creation_date": 1501718882, "answer_id": 45472824, "question_id": 45472450, "link": "https://stackoverflow.com/questions/45472450/rails-5-1-mailer-wrong-number-of-arguments-given-0-expected-2/45472824#45472824", "title": "Rails 5.1 mailer wrong number of arguments given 0 expected 2", "body": "<p>Change the name of method 'message'. ActionMailer::Base defines an attr_internal named 'message' so read and write instance methods are created and you are overriding it.</p>\n"}], "owner": {"reputation": 2927, "user_id": 1392718, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ceb84129b0baa570896eaf9bf51cc64e?s=128&d=identicon&r=PG&f=1", "display_name": "nulltek", "link": "https://stackoverflow.com/users/1392718/nulltek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1828, "favorite_count": 0, "accepted_answer_id": 45472824, "answer_count": 1, "score": 0, "last_activity_date": 1501776806, "creation_date": 1501715935, "last_edit_date": 1501718330, "question_id": 45472450, "link": "https://stackoverflow.com/questions/45472450/rails-5-1-mailer-wrong-number-of-arguments-given-0-expected-2", "title": "Rails 5.1 mailer wrong number of arguments given 0 expected 2", "body": "<p>I'm working on a Rails 5.1.2 app in Ruby 2.4.1.  I'm creating a simple mailer to use as seen below in the class:</p>\n\n<pre><code>  class PagingMailer &lt; ApplicationMailer\n      include SendGrid\n      default from: Rails.application.secrets.no_reply_email\n\n      def message(paging_id, email)\n        @paging = Paging.find(paging_id)\n        mail to: email, subject: \"#{@paging.user.username} has sent you a message\"\n      end\n    end\n</code></pre>\n\n<p>The <code>message</code> method in the <code>PagingMailer</code> class takes an argument of a <code>paging_id</code> (integer) and gets passed the second argument for the email address (string). Originally I had this fired with a sidekiq worker and it wouldn't deliver giving a wrong number of arguments given 0 expected 2 exception.</p>\n\n<p>So I fired up a rails console and tried to do a simple test, getting sidekiq out of the way just in case.</p>\n\n<pre><code>Loading development environment (Rails 5.1.2)\nirb(main):001:0&gt; PagingMailer.message(33, \"john@domain.com\").deliver\nPagingMailer#message: processed outbound mail in 69.1ms\nArgumentError: wrong number of arguments (given 0, expected 2)\n    from app/mailers/paging_mailer.rb:5:in `message'\n    from app/mailers/paging_mailer.rb:7:in `message'\n    from (irb):1\n</code></pre>\n\n<p>The stacktrace points to line 5 and 7 in the message method which the common theme here is the email argument.</p>\n\n<p>As a test I tried removing the second argument and hardcoding \"john@domain.com\" to the mail to: part so the method would only take a single argument of <code>paging_id</code>.  When I fire that from the Rails console I get the following:</p>\n\n<pre><code>irb(main):003:0&gt; PagingMailer.message(33).deliver\nPagingMailer#message: processed outbound mail in 27.4ms\nArgumentError: wrong number of arguments (given 0, expected 1)\n    from app/mailers/paging_mailer.rb:5:in `message'\n    from app/mailers/paging_mailer.rb:7:in `message'\n</code></pre>\n\n<p>I'm literally passing an argument to the method and it's not seeing it, even though it's being passed as an object.</p>\n\n<p>It should be noted I have a few other mailers inside my app which are configured similarly to take 2 arguments and they perform properly.  But this specific mailer I'm strugglebussing with.</p>\n\n<p>Not sure if I'm missing something totally obvious, or if this might be some sort of Rails bug.</p>\n\n<p>Any help you can provide is greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": false, "score": 0, "last_activity_date": 1501714217, "creation_date": 1501714217, "answer_id": 45472207, "question_id": 45472069, "link": "https://stackoverflow.com/questions/45472069/how-to-parse-and-pull-data-from-json-post-in-create-method/45472207#45472207", "title": "How to parse and pull data from json post in create method", "body": "<p>you need to format your json format as follow</p>\n\n<pre><code>{ \"person\": { \"money\": \"281\", \"address\": \"123 Carrot Street\" } }\n</code></pre>\n\n<p>your create method will received params with this format</p>\n\n<pre><code>params[:person] as { \"money\" =&gt; \"281\", \"address\" =&gt; \"123 Carrot Street\" }\n</code></pre>\n\n<p>and this is <a href=\"http://guides.rubyonrails.org/action_controller_overview.html#json-parameters\" rel=\"nofollow noreferrer\">link document for official guide</a> </p>\n"}], "owner": {"reputation": 85, "user_id": 6856433, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3afcf20c6c643637b597f9f1429b8335?s=128&d=identicon&r=PG&f=1", "display_name": "john samcock", "link": "https://stackoverflow.com/users/6856433/john-samcock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1501714217, "creation_date": 1501713228, "question_id": 45472069, "link": "https://stackoverflow.com/questions/45472069/how-to-parse-and-pull-data-from-json-post-in-create-method", "title": "How to parse and pull data from json post in create method", "body": "<p>Below is the JSON I am feeding my create method in my controller</p>\n\n<pre><code>{\n   \"sex\":null,\n   \"money\":281,\n   \"networth\":281,\n   \"property\":[\n      {\n         \"houses\":\"1\",\n         \"id\":\"5\",\n         \"father\":\"Jerry\",\n         \"mother\":\"Tanya\",\n         \"height\":281,\n         \"children\":2,\n         \"pets\":24\n      },\n      {\n         \"houses\":\"3\",\n         \"id\":\"5\",\n         \"father\":\"Rob\",\n         \"mother\":\"Anne\",\n         \"height\":726,\n         \"children\":1,\n         \"pets\":55\n      }\n   ]\n}\n</code></pre>\n\n<p>My controller below:</p>\n\n<pre><code>  def create\n     person = Person.new\n     person.houses = person_params[:houses]\n     person.father = person_params[:father]\n     person.save\n  end\n\n\n  private\n\n   def person_params\n    params.permit(person: []).require(:person)\n   end\n</code></pre>\n\n<p>I am having trouble finding how to pull out data from the JSON passed, lets say i want to save instances of houses or any other value in the array in the JSON, how would i pull out that data? I think i am having trouble with my person_params</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "devise"], "answers": [{"comments": [{"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1501714535, "post_id": 45472144, "comment_id": 77905516, "body": "Thanks for the reply @coreyward! Also another question I have is, should I use another callback other then <code>Warden::Manager.after_set_user</code> ?"}], "tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 0, "last_activity_date": 1501713691, "creation_date": 1501713691, "answer_id": 45472144, "question_id": 45472034, "link": "https://stackoverflow.com/questions/45472034/callback-during-sign-in-process-in-order-to-change-boolean-to-true-or-false/45472144#45472144", "title": "Callback during sign- in process in order to change boolean to true or false", "body": "<p>Since <code>Braintree::Subscription::Status::Active</code> is merely a <a href=\"https://github.com/braintree/braintree_ruby/blob/02db6f8d75830aa3338d61985183aab4eebfab9b/lib/braintree/subscription.rb#L13\" rel=\"nofollow noreferrer\">constant pointing to a string</a> <code>\"Active\"</code>, it's always \"truthy\". That means that <code>if Braintree::Subscription::Status::Active</code> will always be true. </p>\n\n<p>You probably want to do this instead:</p>\n\n<pre><code>user.update(is_active: sub.status == Braintree::Subscription::Status::Active)\n</code></pre>\n\n<p>No need for that conditional or explicitly setting <code>true</code> or <code>false</code> based on the condition of the block, and you already have a <code>User</code> instance passed to the block so you don't need to load one from the database.  </p>\n"}], "owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501713691, "creation_date": 1501713045, "question_id": 45472034, "link": "https://stackoverflow.com/questions/45472034/callback-during-sign-in-process-in-order-to-change-boolean-to-true-or-false", "title": "Callback during sign- in process in order to change boolean to true or false", "body": "<p>I'm using the devise gem with my app. Which callback should I use in order to pass a method from my user model during the sign in process??</p>\n\n<p><code>Warden::Manager.after_set_user ?\nbefore_validation?\nbefore_save?\nbefore_create?</code></p>\n\n<p>Method details: \nI have a boolean column:is_active in the users table.\nEach time a user tries to sign in, the braintree code finds if the user has has an active or not subscription thru the braintree api. And if the user has and active or not subscription I'm trying to update the is_active column to true or false.</p>\n\n<p>I'm using this currently, but it's not working:</p>\n\n<pre><code>Warden::Manager.after_set_user :scope =&gt; :user do |user, auth, opts|\n\n  customer = Braintree::Customer.find('customer_id')\n  customer_card = customer.payment_methods[0].token\n  payment_method = Braintree::PaymentMethod.find(customer_card)\n  sub = payment_method.subscriptions[0]\n  sub.status\n\nif Braintree::Subscription::Status::Active\n  obj = User.find_by_id(params[:id])\n  obj.is_active = true\n  obj.save!\n\nelse\n  obj = User.find_by_id(params[:id])\n  obj.is_active = false\n  obj.save!\n end\nend\n\ndef active_for_authentication?\n  super &amp;&amp; is_active?\nend\n\ndef inactive_message\n  \"User not active, please subscribe!\"\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1501793281, "post_id": 45471261, "comment_id": 77950133, "body": "I&#39;m a bit confused: you are calling <code>puts</code> without a receiver, you are calling <code>render</code> without a receiver, you are calling <code>params</code> without a receiver, you are calling <code>generate_token</code> without a receiver, and I assume you have already seen <code>attr_accessor</code>, <code>attr_reader</code>, <code>attr_writer</code>, <code>require</code>, and some others. So, why does <code>valid?</code> in particular bother you?"}, {"owner": {"reputation": 2157, "user_id": 6407868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5f5ea0c071e2a5adff7d131f58cc2011?s=128&d=identicon&r=PG&f=1", "display_name": "the12", "link": "https://stackoverflow.com/users/6407868/the12"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1501795677, "post_id": 45471261, "comment_id": 77951179, "body": "That reason why it confused me a little bit is that I&#39;m used to seeing <code>object.valid?</code> being used, and not seeing that confused me. For <code>params</code> <code>render</code>, although I am not aware of how Rails internally implements them, I have not seen an example of an object being explicitly called on them (i.e.: controller_instance.params). I have only seen the method being called, sometimes with arguments being passed in them (<code>render(&quot;new&quot;)</code>), but never with an object in front of it."}], "answers": [{"tags": [], "owner": {"reputation": 1307, "user_id": 5854178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NVece.jpg?s=128&g=1", "display_name": "Jason Spradlin", "link": "https://stackoverflow.com/users/5854178/jason-spradlin"}, "is_accepted": false, "score": 0, "last_activity_date": 1501709507, "creation_date": 1501709507, "answer_id": 45471343, "question_id": 45471261, "link": "https://stackoverflow.com/questions/45471261/how-does-valid-run-even-there-is-no-object-in-front-of-it-valid-instead-of-o/45471343#45471343", "title": "How does .valid? run even there is no object in front of it (valid? instead of object.valid?)?", "body": "<pre><code> class SignupForm \n\n   def submit(params)\n     user.attributes = params.slice(:username, :email, :password, :password_confirmation)\n     profile.attributes = params.slice(:twitter_name, :github_name, :bio)\n     self.subscribed = params[:subscribed]\n     if valid?\n       generate_token\n       user.save!\n       profile.save!\n       true\n     else\n       false\n     end\n   end\n\n   def valid? // &lt;--- this is what they are calling.\n     return true   // this is made up... i am sure it does something\n   end\n end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2157, "user_id": 6407868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5f5ea0c071e2a5adff7d131f58cc2011?s=128&d=identicon&r=PG&f=1", "display_name": "the12", "link": "https://stackoverflow.com/users/6407868/the12"}, "edited": false, "score": 0, "creation_date": 1501710213, "post_id": 45471359, "comment_id": 77904027, "body": "I tried passing an object to a method without explicitly naming it in the if statement and it didn&#39;t work (see edited question above)."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 2157, "user_id": 6407868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5f5ea0c071e2a5adff7d131f58cc2011?s=128&d=identicon&r=PG&f=1", "display_name": "the12", "link": "https://stackoverflow.com/users/6407868/the12"}, "edited": false, "score": 1, "creation_date": 1501725387, "post_id": 45471359, "comment_id": 77907969, "body": "@the12 Your error was because you supplied <code>is_a?</code> with the wrong number of arguments. It expects one argument e.g. <code>is_a?(Array)</code>. You should know there is no &quot;Rails magic&quot;, it is all just Ruby"}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 4, "last_activity_date": 1501709586, "creation_date": 1501709586, "answer_id": 45471359, "question_id": 45471261, "link": "https://stackoverflow.com/questions/45471261/how-does-valid-run-even-there-is-no-object-in-front-of-it-valid-instead-of-o/45471359#45471359", "title": "How does .valid? run even there is no object in front of it (valid? instead of object.valid?)?", "body": "<p>In <a href=\"http://railscasts.com/episodes/416-form-objects\" rel=\"nofollow noreferrer\">the Railscast #416 in question</a>, Ryan includes (among others) the <code>ActiveModel::Validations</code> module into the <code>SignupForm</code> class. This module <a href=\"http://api.rubyonrails.org/classes/ActiveModel/Validations.html#method-i-valid-3F\" rel=\"nofollow noreferrer\">implements</a> the <code>valid?</code> method for the class.</p>\n\n<p>Now, in Ruby you can always call methods on the current object (i.e. <code>self</code>) without explicitly naming the receiver. If the receiver is unnamed, <code>self</code> is always assumed. Thus, in your <code>submit</code> method, <code>valid?</code> in called on the same instance of the <code>SubmitForm</code> where you originally called <code>submit</code> on.</p>\n"}], "owner": {"reputation": 2157, "user_id": 6407868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5f5ea0c071e2a5adff7d131f58cc2011?s=128&d=identicon&r=PG&f=1", "display_name": "the12", "link": "https://stackoverflow.com/users/6407868/the12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 45471359, "answer_count": 2, "score": 0, "last_activity_date": 1501710121, "creation_date": 1501709123, "last_edit_date": 1501710121, "question_id": 45471261, "link": "https://stackoverflow.com/questions/45471261/how-does-valid-run-even-there-is-no-object-in-front-of-it-valid-instead-of-o", "title": "How does .valid? run even there is no object in front of it (valid? instead of object.valid?)?", "body": "<p>Watching Railscasts, more specifically Form Objects. Here is the code.</p>\n\n<p>Controller code:</p>\n\n<pre><code>def create\n  @signup_form = SignupForm.new\n  if @signup_form.submit(params[:user])\n    session[:user_id] = @signup_form.user.id\n    redirect_to @signup_form.user, notice: \"Thank you for signing up!\"\n  else\n    render \"new\"\n  end\nend\n</code></pre>\n\n<p>Method found on form object:</p>\n\n<pre><code>  class SignupForm \n    def submit(params)\n      user.attributes = params.slice(:username, :email, :password, :password_confirmation)\n      profile.attributes = params.slice(:twitter_name, :github_name, :bio)\n      self.subscribed = params[:subscribed]\n      if valid?\n        generate_token\n        user.save!\n        profile.save!\n        true\n      else\n        false\n      end\n    end\n  end\n</code></pre>\n\n<p>I understand most of the code, but what I don't understand is how <code>.valid?</code> can run without an object written directly in front of it (i.e.: <code>object.valid?</code>)? I tried replicating this with Ruby, but Ruby requires an object to be directly written in front of the method, which leads me to believe this is some sort of Rails magic. </p>\n\n<p>Can someone explain how <code>.valid?</code> runs without an object in front of it , and which object it picks up? </p>\n\n<p>I tried using the following Ruby code and did not work:</p>\n\n<pre><code>array = [1,2,3,4]\n\ndef meth\n  if is_a?\n    puts \"is array\"\n  else\n    puts \"not array\"\n  end\nend\n\narray.meth =&gt; error: wrong number of arguments (given 0, expected 1)\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "class-method"], "comments": [{"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 1, "creation_date": 1501707321, "post_id": 45470782, "comment_id": 77902680, "body": "This is not an answer, but a suggestion. Typically in ruby style you would name an array/list <code>@records</code>  rather than <code>@record</code>, just because it is more clear. Most developers will see @record and think &#39;single database record&#39;."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 6, "creation_date": 1501710140, "post_id": 45470782, "comment_id": 77904001, "body": "What actually happens? How do you know it doesn&#39;t work? Have you verified the array contains what you think it does?"}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 3, "creation_date": 1501711661, "post_id": 45470782, "comment_id": 77904584, "body": "If you have to say \u201cunable to\u201d in describing what is happening you&#39;re probably not making your problem clear enough. Did the code physically prevent you from doing something? Does the mouse bite you when you try to invoke a particular action? Does the application crash? ;)"}, {"owner": {"reputation": 1, "user_id": 8366855, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XX6solMyeEA/AAAAAAAAAAI/AAAAAAAANes/zvC_uumDv5Q/photo.jpg?sz=128", "display_name": "sullymodena", "link": "https://stackoverflow.com/users/8366855/sullymodena"}, "reply_to_user": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1501764294, "post_id": 45470782, "comment_id": 77929618, "body": "@whodini9 thank you I will update that!"}, {"owner": {"reputation": 1, "user_id": 8366855, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XX6solMyeEA/AAAAAAAAAAI/AAAAAAAANes/zvC_uumDv5Q/photo.jpg?sz=128", "display_name": "sullymodena", "link": "https://stackoverflow.com/users/8366855/sullymodena"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1501764506, "post_id": 45470782, "comment_id": 77929795, "body": "@DaveNewton When I run the program I add new employee&#39;s  but for some reason I can&#39;t view any other employee beyond the first employee I add, also after the new_record variable it doesn&#39;t display that the employee has been created, etc."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1501815557, "post_id": 45470782, "comment_id": 77956215, "body": "It displays it, but then you&#39;re immediately calling out to <code>system(&quot;clear&quot;)</code> and removing the text you had just output, see my answer below for why you can&#39;t view any employee past the first employee you added"}], "answers": [{"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 0, "last_activity_date": 1501711684, "last_edit_date": 1501711684, "creation_date": 1501711064, "answer_id": 45471681, "question_id": 45470782, "link": "https://stackoverflow.com/questions/45470782/ruby-class-method-unable-to-push-additional-user-input-to-array/45471681#45471681", "title": "ruby class method unable to push additional user input to array", "body": "<p>The problem is with your <code>view_record</code> method. If you change it to look something like:</p>\n\n<pre><code>def view_record\n  puts \"Enter Employee Name to view record: \"\n  name = gets.chomp.capitalize\n  system(\"clear\")\n\n  if a = @record.detect { |rec| rec.employee == name }\n    puts \"\\n\"\n    puts \"Employee Information \"\n    puts \"--------------------\"\n    puts \" Name :  #{a.employee}\"\n    puts \" Role(s) :  #{a.role}\"\n    puts \" Location(s) :  #{a.location}\"\n    puts \" Type 'Exit' to return to the Main Menu \"\n  else\n    puts \"That is not a valid entry, please try again.\"\n    view_record\n  end\nend\n</code></pre>\n\n<p>It works properly.</p>\n\n<p>The problem was that you were calling the <code>if...else</code> statement on every record in <code>@record</code>. So if you create 2 <code>Employee</code>s the first one named \"John\" and the second named \"Jane\". When you go to view \"Jane\", you call the <code>else</code> portion for \"John\", since he's the first record and then once he finishes the <code>else</code> you call the <code>if</code> portion for \"Jane\". The <code>else</code> for \"John\", however, never returns because after you finally finish a [possibly lengthy] stack of <code>view_record</code> calls, with the same issue, you then go back to <code>main_menu</code> which never returns (due to the final <code>else</code> condition in that method that re-calls <code>main_menu</code>)</p>\n\n<p>Hope that helps and makes sense.</p>\n\n<p>Notes:</p>\n\n<ol>\n<li>The <code>modify</code> seems to have the same issue and the <code>change_x</code> methods will loop through and check each employee against the <code>if</code> statement, but since no <code>else</code> no problem (I'd still change them personally, to use the <code>detect</code> on these as well).</li>\n<li>The <code>change_x</code> methods don't look like they would run, because <code>employee</code> isn't defined in them</li>\n<li>If more than 1 employee can have the same name, you can use <code>select</code> instead of <code>detect</code> and then check for <code>empty?</code> or iterate through only those returned by <code>select</code> and call only the <code>if</code> portion on them.</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 8366855, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XX6solMyeEA/AAAAAAAAAAI/AAAAAAAANes/zvC_uumDv5Q/photo.jpg?sz=128", "display_name": "sullymodena", "link": "https://stackoverflow.com/users/8366855/sullymodena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1501711684, "creation_date": 1501707092, "last_edit_date": 1501709720, "question_id": 45470782, "link": "https://stackoverflow.com/questions/45470782/ruby-class-method-unable-to-push-additional-user-input-to-array", "title": "ruby class method unable to push additional user input to array", "body": "<p>It stores the first employee, but when I try to add another employee I am unable to view the additional employees entered. Below is the method for viewing employee record. Thanks for any help!</p>\n\n<p><strong>Employee Class</strong></p>\n\n<pre><code>class Employee\n  attr_accessor :employee, :role, :location\n\n  def initialize(employee, role, location)\n    @employee = employee\n    @role = role\n    @location = location\n  end\n\n  def employee_change(new_emp)\n    @employee = new_emp\n  end\n\n  def role_change(new_role)\n    @role = new_role\n  end.\n\n\n  def location_change(new_loc)\n    @location = new_loc\n  end\nend\n</code></pre>\n\n<p><strong>Main Menu</strong></p>\n\n<pre><code>def main_menu\n  puts \"Welcome to the Employee Portal\"\n  puts \"Please select an option below: \"\n  puts \"---------------------\"\n  puts \"1. Create New Employee Record.\"\n  puts \"2. View an existing record.\"\n  puts \"3. Modify an existing record.\"\n  puts \"4. Exit Portal\"\n\n  option = gets.chomp.to_i\n\n  if option == 1\n    create_record\n    main_menu\n\n  elsif option == 2\n    view_record\n\n  elsif option == 3\n    modify\n\n  elsif option == 4\n    puts \"Thank you for using the Employee Portal\"\n    exit\n  else\n    puts \"Not a valid option. Please try again.\"\n    main_menu\n    system(\"clear\")\n\n  end\nend\n</code></pre>\n\n<p><strong>Create New Employee (Option 1 from Main Menu)</strong></p>\n\n<pre><code>def create_record\n  puts \"Create New Employee Record, click 'Enter' to begin\"\n  puts \"Enter Employee Information: \"\n  employee = gets.chomp.capitalize\n\n  puts \"Enter Employee's Role: \"\n  role = gets.chomp.capitalize\n\n  puts \"Enter Employee's Current Work Location: \"\n  location = gets.chomp.capitalize\n\n  puts \"\\n\"\n\n  new_record = Employee.new(employee, role, location)\n  @record.push(new_record)\n\n  puts \"New Employee Record has been created.\"\n  puts \"Name: #{employee}\"\n  puts \"Role: #{role}\"\n  puts \"Location: #{location}\"\n\n  system(\"clear\")\n\n  main_menu\nend\n</code></pre>\n\n<p><strong>View Employee (Option 2 from Main Menu)</strong></p>\n\n<pre><code>def view_record\n  puts \"Enter Employee Name to view record: \"\n  name = gets.chomp.capitalize\n  system(\"clear\")\n\n  @record.each do |a|\n    if a.employee == name\n\n      puts \"\\n\"\n      puts \"Employee Information \"\n      puts \"--------------------\"\n      puts \" Name :  #{a.employee}\"\n      puts \" Role(s) :  #{a.role}\"\n      puts \" Location(s) :  #{a.location}\"\n      puts \" Type 'Exit' to return to the Main Menu \"\n\n    else\n      puts \"That is not a valid entry, please try again.\"\n      view_record\n      main_menu\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Modify Employee (Option 3 from Main Menu)</strong></p>\n\n<pre><code>def modify\n  system(\"clear\")\n  puts \"Enter employee name to modify existing record: \"\n  name = gets.chomp.capitalize\n\n  @record.each do |r|\n    if r.employee == name\n      puts \"Employee found.\"\n      puts \"Select an option to modify.\"\n      puts \"-----------------------------------\"\n      puts \"1.) Modify employee's name.\"\n      puts \"2.) Modify employee's role.\"\n      puts \"3.) Modify employee's location.\"\n      puts \"4.) Return to Main Menu\"\n      puts \"\\n\"\n\n      option = gets.chomp.to_i\n\n      if option == 1\n        change_employee\n\n      elsif option == 2\n        change_role\n\n      elsif option == 3\n        change_location\n\n      elsif option == 4\n        main_menu\n      else\n        puts \"Invalid selection. Please try again.\"\n        modify\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Change Employee (Option 1 from Modify)</strong></p>\n\n<pre><code>def change_employee\n  puts \"Enter new employee name: \"\n  new_emp = gets.chomp.capitalize\n  @record.each do |r|\n    if r.employee == employee\n      r.employee_change(new_emp)\n      puts \"#{r.employee} has been updated to #{r.employee}\"\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Change Employee Role (Option 2 from Modify)</strong></p>\n\n<pre><code>def change_role\n  puts \"What is #{r.employee}\\'s new role?: \"\n  new_role = gets.chomp.capitalize\n  @record.each do |r|\n    if r.employee == employee\n      r.role_change(new_role)\n      puts \"#{r.employee}\\'s new role is #{r.role}\"\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Change Employee Location (Option 3 from Modify)</strong></p>\n\n<pre><code>def change_location\n  puts \"What is #{r.employee}\\'s new location?: \"\n  new_loc = gets.chomp.capitalize\n  @record.each do |r|\n    if r.employee == employee\n      r.location_change(new_loc)\n      puts \"#{r.employee} has been transfer to new location, #{r.location}.\"\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Run the Program</strong></p>\n\n<pre><code>@record = []\nsystem(\"clear\")\nmain_menu\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1501707023, "post_id": 45470671, "comment_id": 77902519, "body": "Can you add an example of how your models are setup and what you ran to create these models? See <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> Also, if you create a new project from scratch do you see this?"}, {"owner": {"reputation": 434, "user_id": 337928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4da9ad2bd4a2d1ce3c428e32c423588a?s=128&d=identicon&r=PG", "display_name": "Michael Deering", "link": "https://stackoverflow.com/users/337928/michael-deering"}, "edited": false, "score": 0, "creation_date": 1501709043, "post_id": 45470671, "comment_id": 77903552, "body": "I&#39;m assuming this a <b>belongs_to</b> parent relationship.  In rails 5.X a belongs to became required be default. But paperclip could be doing something different then a <b>belongs_to</b> Can you post some code of your model?"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 434, "user_id": 337928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4da9ad2bd4a2d1ce3c428e32c423588a?s=128&d=identicon&r=PG", "display_name": "Michael Deering", "link": "https://stackoverflow.com/users/337928/michael-deering"}, "edited": false, "score": 0, "creation_date": 1501711533, "post_id": 45470671, "comment_id": 77904541, "body": "@MichaelDeering I&#39;ve added some code. Your assumptions are correct."}], "answers": [{"tags": [], "owner": {"reputation": 1751, "user_id": 3275308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100001515476964/picture?type=large", "display_name": "Kkulikovskis", "link": "https://stackoverflow.com/users/3275308/kkulikovskis"}, "is_accepted": false, "score": 0, "last_activity_date": 1502083591, "creation_date": 1502083591, "answer_id": 45539898, "question_id": 45470671, "link": "https://stackoverflow.com/questions/45470671/rails-5-stopped-validating-associations/45539898#45539898", "title": "Rails 5 Stopped Validating Associations", "body": "<p>Firstly offtopic: I <strong>strongly advise against using reserved words as associations</strong> such as <code>has_one :return</code> since you will get into conflicts eventually.</p>\n\n<p>In this case you won't be able to do something like:</p>\n\n<pre><code>def some_method\n  # ...some actions\n  return # say, you wanted to return the association.\nend\n</code></pre>\n\n<p>If you want to set Rails config variables in <code>production.rb</code> or <code>development.rb</code> you have to use <code>Rails.application.config.</code> instead of just <code>config.</code> in those files.</p>\n\n<p>In Rails 5 <code>belongs_to</code> should be validated by default unless you specify <code>optional: true</code> for the association. So in this case your association <code>belongs_to :admin</code> will not be validated. If you have issues with a different association, please update your answer with rails console output when trying to create, say, <code>Order</code> object without any other associations and I will try and update my answer.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502083591, "creation_date": 1501706669, "last_edit_date": 1501711413, "question_id": 45470671, "link": "https://stackoverflow.com/questions/45470671/rails-5-stopped-validating-associations", "title": "Rails 5 Stopped Validating Associations", "body": "<p>I've got a rails 5 project that I've been working on since January and today I noticed that I was able to create a child record without specifying the parent. This is rather alarming since I verified that I am using rails 5.1.2 along with ruby 2.4.1. The site is still in development. I opened up rails console and tested a few of my other models that should have parent validations (should validate by default in rails 5) and those records were created too without the associations. </p>\n\n<p>This makes no sense. I do know that this was working at some point. The largest change was made earlier this week when I added in the gem \"paperclip\" for file uploads. Does anyone have any suggestions or have any ideas on what to check? </p>\n\n<pre><code>class Order &lt; ApplicationRecord\n    require 'csv'\n\n    include SendGrid\n    belongs_to :admin, optional: true\n    belongs_to :user\n    has_one :return\n    has_many :order_shipments, dependent: :destroy\n    has_many :order_items, dependent: :destroy\n    has_many :order_addresses, dependent: :destroy\n    has_many :order_comments, dependent: :destroy\n\n\n     ......\n\nend\n\n\n\n\nclass OrderShipment &lt; ApplicationRecord\n    belongs_to :order\nend\n</code></pre>\n\n<p>I've added the following code to my development.rb and production.rb environments and it appears to resolve the issue as if it is overriding something that paperclip could be doing. </p>\n\n<pre><code>config.active_record.belongs_to_required_by_default = true\n</code></pre>\n\n<p>However, I think this code should go in application.rb but \"config\" is not initialized so I get the following error when doing so: </p>\n\n<pre><code>undefined local variable or method `config' for main:Object (NameError)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 0, "creation_date": 1501707500, "post_id": 45470548, "comment_id": 77902769, "body": "See also <a href=\"https://stackoverflow.com/questions/9727898/parsing-string-dates-in-ruby-such-as-28-may-10/9728030#9728030\" title=\"parsing string dates in ruby such as 28 may 10\">stackoverflow.com/questions/9727898/&hellip;</a> or <a href=\"https://stackoverflow.com/questions/14511141/string-to-date-in-ruby/14511436#14511436\" title=\"string to date in ruby\">stackoverflow.com/questions/14511141/string-to-date-in-ruby/&zwnj;&#8203;&hellip;</a>. Your code would be <code>DateTime.strptime(&#39;20170802173300&#39;,&#39;%Y%m%d%H%M%S&#39;).strftime(&zwnj;&#8203;&#39;%Y-%m-%d %H:%M:%S&#39;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 2091466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/092819a104b2097f9520d60358666242?s=128&d=identicon&r=PG&f=1", "display_name": "martincito", "link": "https://stackoverflow.com/users/2091466/martincito"}, "edited": false, "score": 0, "creation_date": 1501706504, "post_id": 45470599, "comment_id": 77902257, "body": "Sorry, I dont understand, You are using a Rails method?"}, {"owner": {"reputation": 1743, "user_id": 4308435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vgr6X.jpg?s=128&g=1", "display_name": "Nikita Misharin", "link": "https://stackoverflow.com/users/4308435/nikita-misharin"}, "edited": false, "score": 0, "creation_date": 1501706505, "post_id": 45470599, "comment_id": 77902258, "body": "You answer isn&#39;t in Ruby"}, {"owner": {"reputation": 182, "user_id": 2091466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/092819a104b2097f9520d60358666242?s=128&d=identicon&r=PG&f=1", "display_name": "martincito", "link": "https://stackoverflow.com/users/2091466/martincito"}, "edited": false, "score": 0, "creation_date": 1501706746, "post_id": 45470599, "comment_id": 77902381, "body": "Sorry for my uncleared answer"}], "tags": [], "owner": {"reputation": 45, "user_id": 8254191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3fcc15af96f8e42a05d77aedc9db97c6?s=128&d=identicon&r=PG&f=1", "display_name": "Yousif Raad", "link": "https://stackoverflow.com/users/8254191/yousif-raad"}, "is_accepted": false, "score": -1, "last_activity_date": 1501706361, "creation_date": 1501706361, "answer_id": 45470599, "question_id": 45470548, "link": "https://stackoverflow.com/questions/45470548/how-to-convert-ymdhms-to-yyyy-mm-dd-hhmmss/45470599#45470599", "title": "How to convert %Y%m%d%H%m%s to YYYY-mm-dd HH:mm:ss?", "body": "<p>Date now = new Date();\n                            SimpleDateFormat format = new SimpleDateFormat(\"dd-MM-yy\");</p>\n"}, {"comments": [{"owner": {"reputation": 182, "user_id": 2091466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/092819a104b2097f9520d60358666242?s=128&d=identicon&r=PG&f=1", "display_name": "martincito", "link": "https://stackoverflow.com/users/2091466/martincito"}, "edited": false, "score": 1, "creation_date": 1501707049, "post_id": 45470661, "comment_id": 77902539, "body": "That works. Thanks!"}], "tags": [], "owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "is_accepted": true, "score": 1, "last_activity_date": 1501707039, "last_edit_date": 1501707039, "creation_date": 1501706613, "answer_id": 45470661, "question_id": 45470548, "link": "https://stackoverflow.com/questions/45470548/how-to-convert-ymdhms-to-yyyy-mm-dd-hhmmss/45470661#45470661", "title": "How to convert %Y%m%d%H%m%s to YYYY-mm-dd HH:mm:ss?", "body": "<pre><code>require 'date'\ndate = '20170802173300'\nformatted_date = DateTime.parse(date).to_s\n# =&gt; \"2017-08-02T17:33:00+00:00\"\n\n# and to be more explicit:\nreally_formated_date = DateTime.parse(date).strftime('%Y-%m-%d %H:%M:%S %Z')\n# =&gt; \"2017-08-02 17:33:00 +00:00\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1501706940, "post_id": 45470718, "comment_id": 77902472, "body": "minutes should be changed to %M"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 3, "last_activity_date": 1501706815, "creation_date": 1501706815, "answer_id": 45470718, "question_id": 45470548, "link": "https://stackoverflow.com/questions/45470548/how-to-convert-ymdhms-to-yyyy-mm-dd-hhmmss/45470718#45470718", "title": "How to convert %Y%m%d%H%m%s to YYYY-mm-dd HH:mm:ss?", "body": "<p>You can use <code>strftime</code>:</p>\n\n<pre><code>datetime = 'Mie, 02 Ago 2017 17:33:00 -0300'\ndatetime.strftime('%Y-%m-%d %H:%m:%S %z')\n#\u00a0=&gt; 2017-08-02 17:33:00\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1743, "user_id": 4308435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vgr6X.jpg?s=128&g=1", "display_name": "Nikita Misharin", "link": "https://stackoverflow.com/users/4308435/nikita-misharin"}, "is_accepted": false, "score": 2, "last_activity_date": 1501706894, "creation_date": 1501706894, "answer_id": 45470734, "question_id": 45470548, "link": "https://stackoverflow.com/questions/45470548/how-to-convert-ymdhms-to-yyyy-mm-dd-hhmmss/45470734#45470734", "title": "How to convert %Y%m%d%H%m%s to YYYY-mm-dd HH:mm:ss?", "body": "<p>You can format time anyway you like, in Ruby with <a href=\"https://apidock.com/ruby/DateTime/strftime\" rel=\"nofollow noreferrer\">strftime</a>.</p>\n\n<p>For format you want it'll be like this:</p>\n\n<p><code>%Y-%m-%d %H:%M:%S %z</code></p>\n\n<p>For example: <code>Time.now.strftime('%Y-%m-%d %H:%M:%S %z')</code></p>\n"}], "owner": {"reputation": 182, "user_id": 2091466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/092819a104b2097f9520d60358666242?s=128&d=identicon&r=PG&f=1", "display_name": "martincito", "link": "https://stackoverflow.com/users/2091466/martincito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3521, "favorite_count": 0, "closed_date": 1501709806, "accepted_answer_id": 45470661, "answer_count": 4, "score": 2, "last_activity_date": 1501745624, "creation_date": 1501706194, "last_edit_date": 1501745624, "question_id": 45470548, "link": "https://stackoverflow.com/questions/45470548/how-to-convert-ymdhms-to-yyyy-mm-dd-hhmmss", "closed_reason": "Duplicate", "title": "How to convert %Y%m%d%H%m%s to YYYY-mm-dd HH:mm:ss?", "body": "<p>I'm learning Ruby on Rails and have dates with the format \n<code>20170802173300</code> witch is: </p>\n\n<pre><code>Mie, 02 Ago 2017 17:33:00 -0300.\n</code></pre>\n\n<p>How can I convert this to ?</p>\n\n<pre><code>2017-08-02 17:33:00 -0300\n</code></pre>\n"}, {"tags": ["ruby", "sorting", "hash"], "comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 1, "creation_date": 1501760660, "post_id": 45470522, "comment_id": 77926772, "body": "What&#39;s <code>Department.all</code> if it&#39;s not ActiveRecord?"}, {"owner": {"reputation": 6018, "user_id": 3446655, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AH6Ys.jpg?s=128&g=1", "display_name": "HarlemSquirrel", "link": "https://stackoverflow.com/users/3446655/harlemsquirrel"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 1, "creation_date": 1501778523, "post_id": 45470522, "comment_id": 77941391, "body": "It is a custom object for LDAP entries."}], "answers": [{"comments": [{"owner": {"reputation": 6018, "user_id": 3446655, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AH6Ys.jpg?s=128&g=1", "display_name": "HarlemSquirrel", "link": "https://stackoverflow.com/users/3446655/harlemsquirrel"}, "edited": false, "score": 0, "creation_date": 1501768873, "post_id": 45473135, "comment_id": 77933742, "body": "Sort by itself doesn&#39;t work because <code>Department</code> is not an ActiveRecord model. I did forget about the <code>#group_by</code> enumerator which is very helpful here!"}, {"owner": {"reputation": 6018, "user_id": 3446655, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AH6Ys.jpg?s=128&g=1", "display_name": "HarlemSquirrel", "link": "https://stackoverflow.com/users/3446655/harlemsquirrel"}, "edited": false, "score": 0, "creation_date": 1501769012, "post_id": 45473135, "comment_id": 77933879, "body": "Also, sorting the initial set of departments with <code>sort_by(&amp;:cn)</code> makes the second <code>#sort_by!</code> unnecessary."}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 1, "creation_date": 1501778743, "post_id": 45473135, "comment_id": 77941526, "body": "If you define <code>&lt;=&gt;</code> on <code>Department</code> then <code>.sort</code> works. :)"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1501721728, "creation_date": 1501721728, "answer_id": 45473135, "question_id": 45470522, "link": "https://stackoverflow.com/questions/45470522/is-there-a-more-efficient-way-to-build-a-sorted-hash-from-a-collection-of-ruby-o/45473135#45473135", "title": "Is there a more efficient way to build a sorted hash from a collection of Ruby objects?", "body": "<pre><code>def for_select\n  Department.all\n  .sort\n  .group_by(&amp;:top_level_department_cn)\n  .each_value{|v| v.map!{|dept| [dept.cn, dept.sorid]}.sort_by!(&amp;:first)}\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6018, "user_id": 3446655, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AH6Ys.jpg?s=128&g=1", "display_name": "HarlemSquirrel", "link": "https://stackoverflow.com/users/3446655/harlemsquirrel"}, "edited": false, "score": 0, "creation_date": 1501768943, "post_id": 45482030, "comment_id": 77933809, "body": "I didn&#39;t know I could create a hash with default values. That is very cool! However, in the linked SO answer, the author recommends <code>Hash.new([].freeze)</code> and I do like that better."}, {"owner": {"reputation": 1066, "user_id": 2692292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc9547cefa57fafd20952ccf570251a?s=128&d=identicon&r=PG", "display_name": "romainsalles", "link": "https://stackoverflow.com/users/2692292/romainsalles"}, "reply_to_user": {"reputation": 6018, "user_id": 3446655, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AH6Ys.jpg?s=128&g=1", "display_name": "HarlemSquirrel", "link": "https://stackoverflow.com/users/3446655/harlemsquirrel"}, "edited": false, "score": 0, "creation_date": 1501769790, "post_id": 45482030, "comment_id": 77934565, "body": "That&#39;s right, but in this case you&#39;ll have to instantiate a new array each time: <code>.each { |top_level_cn, data| select_list[top_level_cn] += [data] }</code>, which is less intuitive in my point of view (you have to read this like this: <code>.each { |top_level_cn, data| select_list[top_level_cn] = select_list[top_level_cn] + [data] }</code>)"}], "tags": [], "owner": {"reputation": 1066, "user_id": 2692292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc9547cefa57fafd20952ccf570251a?s=128&d=identicon&r=PG", "display_name": "romainsalles", "link": "https://stackoverflow.com/users/2692292/romainsalles"}, "is_accepted": false, "score": 1, "last_activity_date": 1501757234, "creation_date": 1501757234, "answer_id": 45482030, "question_id": 45470522, "link": "https://stackoverflow.com/questions/45470522/is-there-a-more-efficient-way-to-build-a-sorted-hash-from-a-collection-of-ruby-o/45482030#45482030", "title": "Is there a more efficient way to build a sorted hash from a collection of Ruby objects?", "body": "<p>Another solution:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def for_select\n  # @see: https://stackoverflow.com/questions/2698460#answer-28916684\n  select_list = Hash.new { |h, k| h[k] = [] }\n\n  Department.all\n    .map { |d| [d.top_level_department_cn, [d.cn, d.sorid]] }\n    .sort\n    .each { |top_level_cn, data| select_list[top_level_cn] &lt;&lt; data }\n\n  select_list\nend\n</code></pre>\n"}], "owner": {"reputation": 6018, "user_id": 3446655, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AH6Ys.jpg?s=128&g=1", "display_name": "HarlemSquirrel", "link": "https://stackoverflow.com/users/3446655/harlemsquirrel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501757234, "creation_date": 1501706128, "question_id": 45470522, "link": "https://stackoverflow.com/questions/45470522/is-there-a-more-efficient-way-to-build-a-sorted-hash-from-a-collection-of-ruby-o", "title": "Is there a more efficient way to build a sorted hash from a collection of Ruby objects?", "body": "<p>I'm building a sorted hash for use in a grouped select in a rails app. I am not using ActiveRecord. Is there a more efficient or cleaner way than this? </p>\n\n<pre><code>def for_select\n  select_list = {}\n  Department.all.each do |dept|\n    select_list[dept.top_level_department_cn] ||= []\n    select_list[dept.top_level_department_cn] &lt;&lt; [dept.cn, dept.sorid]\n  end\n  select_list.each_value { |select_options| select_options.sort_by!(&amp;:first) }\n             .sort\n             .to_h\nend\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 610, "user_id": 1137702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qbh1B.jpg?s=128&g=1", "display_name": "blacktrance", "link": "https://stackoverflow.com/users/1137702/blacktrance"}, "edited": false, "score": 0, "creation_date": 1501707044, "post_id": 45470567, "comment_id": 77902533, "body": "Then the test would fail if the method stopped raising an error. The test should pass regardless of whether the error is raised, and only care about <code>other_class_method</code> being called."}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 0, "last_activity_date": 1501706259, "creation_date": 1501706259, "answer_id": 45470567, "question_id": 45470415, "link": "https://stackoverflow.com/questions/45470415/preventing-error-from-causing-rspec-test-failure/45470567#45470567", "title": "Preventing error from causing RSpec test failure", "body": "<p>What about adding an expectation that the method is raising an error. That will even enhance your testing:</p>\n\n<pre><code>describe MyClass do\n  describe '.some_class_method' do\n    context 'testing some_class_method' do\n      it 'calls other_class_method' do\n        expect(MyClass).to receive(:other_class_method)\n        expect { MyClass.some_class_method }.to raise_error(\"ERROR\")\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 7993383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb1ae99f86d1aedeb1a1aa7940ae1916?s=128&d=identicon&r=PG&f=1", "display_name": "dtroof", "link": "https://stackoverflow.com/users/7993383/dtroof"}, "is_accepted": true, "score": 1, "last_activity_date": 1501708050, "creation_date": 1501708050, "answer_id": 45471008, "question_id": 45470415, "link": "https://stackoverflow.com/questions/45470415/preventing-error-from-causing-rspec-test-failure/45471008#45471008", "title": "Preventing error from causing RSpec test failure", "body": "<p>You could rescue the exception in the test.</p>\n\n<pre><code>describe MyClass do\n  describe '.some_class_method' do\n    context 'testing some_class_method' do\n      it 'calls other_class_method' do\n        MyClass.should_receive(:other_class_method)\n        begin\n          MyClass.some_class_method\n        rescue\n        end\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 610, "user_id": 1137702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qbh1B.jpg?s=128&g=1", "display_name": "blacktrance", "link": "https://stackoverflow.com/users/1137702/blacktrance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 1, "accepted_answer_id": 45471008, "answer_count": 2, "score": 0, "last_activity_date": 1501708050, "creation_date": 1501705729, "last_edit_date": 1501706141, "question_id": 45470415, "link": "https://stackoverflow.com/questions/45470415/preventing-error-from-causing-rspec-test-failure", "title": "Preventing error from causing RSpec test failure", "body": "<p>Suppose I have a class with methods like these:</p>\n\n<pre><code>class MyClass\n  ...\n\n  def self.some_class_method\n    my_instance = MyClass.new\n    self.other_class_method(my_instance)\n    raise 'ERROR'\n  end\n\n  def self.other_class_method(instance)\n    ...\n  end\nend\n</code></pre>\n\n<p>And the test for it looks like this:</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe MyClass do\n  describe '.some_class_method' do\n    context 'testing some_class_method' do\n      it 'calls other_class_method' do\n        MyClass.should_receive(:other_class_method)\n\n        MyClass.some_class_method\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>The test errors out with <code>ERROR</code>, and if I remove the <code>raise 'ERROR'</code> line, the test passes. But here I want to only test whether <code>some_class_method</code> calls <code>other_class_method</code>, regardless of what happens afterwards. I could change it to expect the method to raise an error, but that's not the purpose of this particular test. Is there a better way?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "class", "controller"], "comments": [{"owner": {"reputation": 2205, "user_id": 1964790, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/33fc51b8b17ac833b3d9e2920f96d6d2?s=128&d=identicon&r=PG", "display_name": "J Smith", "link": "https://stackoverflow.com/users/1964790/j-smith"}, "edited": false, "score": 0, "creation_date": 1501705628, "post_id": 45470283, "comment_id": 77901744, "body": "The <code>ActionController::Base</code> is the base class from which <code>ApplicationController</code> and therefore your controllers inherit. It&#39;s part of the core API, if you want to have a look at it you can do-so in your IDE"}], "answers": [{"tags": [], "owner": {"reputation": 1743, "user_id": 4308435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vgr6X.jpg?s=128&g=1", "display_name": "Nikita Misharin", "link": "https://stackoverflow.com/users/4308435/nikita-misharin"}, "is_accepted": false, "score": 2, "last_activity_date": 1501705643, "creation_date": 1501705643, "answer_id": 45470397, "question_id": 45470283, "link": "https://stackoverflow.com/questions/45470283/where-to-find-source-code-of-actioncontrollerbase/45470397#45470397", "title": "Where to find source code of ActionController::Base", "body": "<p><a href=\"https://github.com/rails/rails/blob/master/actionpack/lib/action_controller/base.rb\" rel=\"nofollow noreferrer\">Here it is</a>. You won't find much there, though. <code>Base</code> module is quite thin. It consists almost entirely out of list of modules to <code>include</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 8183051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38f3e3f420d0fbbf4f25e069716db1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Dimrak", "link": "https://stackoverflow.com/users/8183051/dimrak"}, "edited": false, "score": 0, "creation_date": 1501936621, "post_id": 45470417, "comment_id": 78004169, "body": "Thank you for the answer, will be checking both documentation files."}], "tags": [], "owner": {"reputation": 171, "user_id": 5223394, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399f169b3d4dedcfb231303869583d0a?s=128&d=identicon&r=PG&f=1", "display_name": "maverick5", "link": "https://stackoverflow.com/users/5223394/maverick5"}, "is_accepted": false, "score": 0, "last_activity_date": 1501705737, "creation_date": 1501705737, "answer_id": 45470417, "question_id": 45470283, "link": "https://stackoverflow.com/questions/45470283/where-to-find-source-code-of-actioncontrollerbase/45470417#45470417", "title": "Where to find source code of ActionController::Base", "body": "<p>you can read the Rails Source Code </p>\n\n<p><a href=\"https://github.com/rails/rails/blob/master/actionpack/lib/action_controller/base.rb\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/master/actionpack/lib/action_controller/base.rb</a></p>\n\n<p>or the API docs</p>\n\n<p><a href=\"https://apidock.com/rails/ActionController/Base\" rel=\"nofollow noreferrer\">https://apidock.com/rails/ActionController/Base</a></p>\n"}], "owner": {"reputation": 19, "user_id": 8183051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38f3e3f420d0fbbf4f25e069716db1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Dimrak", "link": "https://stackoverflow.com/users/8183051/dimrak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501716200, "creation_date": 1501705309, "last_edit_date": 1501716200, "question_id": 45470283, "link": "https://stackoverflow.com/questions/45470283/where-to-find-source-code-of-actioncontrollerbase", "title": "Where to find source code of ActionController::Base", "body": "<p>I am checking the structure of the initial steps of a tutorial, to build a blog and while going through the code block by block, got to the point in which I want to read the code of ActionController::Base, but I am not able to find it, maybe some help?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby", "algorithm", "recursion"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501825769, "post_id": 45470134, "comment_id": 77958996, "body": "Note that if <code>m</code> is a factor of <code>n</code>, so is <code>n&#47;m</code>. Moreover the largest factor <code>m</code> that is no larger than <code>n&#47;m</code> satisfies <code>m*m &lt;= n</code>. Therefore, you need only consider factors <code>m</code> up to <code>sqrt(n).floor</code>, and for each one found, add <code>m</code> and <code>n&#47;m</code> to your list."}], "answers": [{"comments": [{"owner": {"reputation": 1360, "user_id": 4430977, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/1268ab423eed6c864e3c43514a55efa5?s=128&d=identicon&r=PG&f=1", "display_name": "segue_segway", "link": "https://stackoverflow.com/users/4430977/segue-segway"}, "edited": false, "score": 0, "creation_date": 1501716088, "post_id": 45470371, "comment_id": 77905891, "body": "hey @mac -- well I&#39;m recursively searching a smaller n, so it&#39;s n/2, n/3, n/4... do you mind explaining further what you mean?"}], "tags": [], "owner": {"reputation": 671, "user_id": 8383973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LMxjr.jpg?s=128&g=1", "display_name": "adnan.c", "link": "https://stackoverflow.com/users/8383973/adnan-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1501705570, "creation_date": 1501705570, "answer_id": 45470371, "question_id": 45470134, "link": "https://stackoverflow.com/questions/45470134/algorithm-factor-combinations/45470371#45470371", "title": "Algorithm: Factor Combinations", "body": "<p>I think always going forward is a good policy (i.e when checking, say, with 5, do not check with 2, 3, 4 etc). That way, searching for duplicates can be eliminated.</p>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 1439549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e25aae155d398327c1836fb0272a2f?s=128&d=identicon&r=PG", "display_name": "Magesoe", "link": "https://stackoverflow.com/users/1439549/magesoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1501707252, "creation_date": 1501707252, "answer_id": 45470821, "question_id": 45470134, "link": "https://stackoverflow.com/questions/45470134/algorithm-factor-combinations/45470821#45470821", "title": "Algorithm: Factor Combinations", "body": "<p>Since the algorithm already uses a lot of time, I don't see a problem sorting each answer and removing duplicates. This requires no proof to ensure it works, which the answer provided by mac does.</p>\n"}, {"comments": [{"owner": {"reputation": 1360, "user_id": 4430977, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/1268ab423eed6c864e3c43514a55efa5?s=128&d=identicon&r=PG&f=1", "display_name": "segue_segway", "link": "https://stackoverflow.com/users/4430977/segue-segway"}, "edited": false, "score": 0, "creation_date": 1501729828, "post_id": 45472751, "comment_id": 77908887, "body": "Thanks @Cary. I&#39;m unable to review at the moment but will do so when I can"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1501726746, "last_edit_date": 1501726746, "creation_date": 1501718193, "answer_id": 45472751, "question_id": 45470134, "link": "https://stackoverflow.com/questions/45470134/algorithm-factor-combinations/45472751#45472751", "title": "Algorithm: Factor Combinations", "body": "<p><strong>Code</strong></p>\n\n<pre><code>require 'prime'\n\ndef get_factors(n)\n  primes, nbr = Prime.prime_division(n).transpose\n  powers = nbr.map { |m| (0..m).to_a }\n  powers.shift.\n         product(*powers).\n         map { |pows| primes.zip(pows).reduce(1) { |t,(pr,po)| t * (pr**po) } }.\n         sort\nend\n</code></pre>\n\n<p>The array returned includes <code>1</code> and  <code>n</code> (which are factors of <code>n</code>). If those values should be excluded, replace <code>.sort</code> with <code>.sort - [1, n]</code>.</p>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>get_factors(24)\n  #=&gt; [1, 2, 3, 4, 6, 8, 12, 24]\nget_factors(64)\n  #=&gt; [1, 2, 4, 8, 16, 32, 64]\nget_factors(90)\n  #=&gt; [1, 2, 3, 5, 6, 9, 10, 15, 18, 30, 45, 90]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>Consider</p>\n\n<pre><code>n = 60\n</code></pre>\n\n<p>The steps are as follows.</p>\n\n<pre><code>a = Prime.prime_division(30)\n  #=&gt; [[2, 2], [3, 1], [5, 1]]\n</code></pre>\n\n<p>Ergo, the primes of <code>30</code> are <code>2</code>, <code>3</code> and <code>5</code>, and</p>\n\n<pre><code>60 = 2**2 * 3**1 * 5**1 \n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/stdlib-2.4.0/libdoc/prime/rdoc/Prime.html#method-i-prime_division\" rel=\"nofollow noreferrer\">Prime::prime_division</a>. Continuing,</p>\n\n<pre><code>primes, nbr = a.transpose\n  #=&gt; [[2, 3, 5], [2, 1, 1]]\nprimes\n  #=&gt; [2, 3, 5]\nnbr\n  #=&gt; [2, 1, 1]\npowers = nbr.map { |m| (0..m).to_a }\n  #=&gt; [[0, 1, 2], [0, 1], [0, 1]]\n</code></pre>\n\n<p>This means that each factor will be the product of <code>0</code>, <code>1</code> or <code>2</code> <code>2</code>'s, <code>0</code> or <code>1</code> <code>3</code>'s and <code>0</code> or <code>1</code> <code>5</code>'s.</p>\n\n<pre><code>b = powers.shift\n  #=&gt; [0, 1, 2]\npowers\n  #=&gt; [[0, 1], [0, 1]]\nc = b.product(*powers)\n  #=&gt; [[0, 0, 0], [0, 0, 1], [0, 1, 0], [0, 1, 1], [1, 0, 0], [1, 0, 1],\n  #    [1, 1, 0], [1, 1, 1], [2, 0, 0], [2, 0, 1], [2, 1, 0], [2, 1, 1]]\nd = c.map { |pows| primes.zip(pows).reduce(1) { |t,(pr,po)| t * (pr**po) } }\n  #=&gt; [1, 5, 3, 15, 2, 10, 6, 30, 4, 20, 12, 60]\nd.sort\n  #=&gt; [1, 5, 3, 15, 2, 10, 6, 30, 4, 20, 12, 60]\n</code></pre>\n\n<p>Consider now the calculation of <code>d</code>. The 10th element of <code>c</code> that is passed to the block is <code>[2, 0, 1]</code>. The block calculation for that element is as follows.</p>\n\n<pre><code>pows = [2, 0, 1]\ne = primes.zip(pows)\n  #=&gt; [[2, 2], [3, 0], [5, 1]]\ne.reduce(1) { |t,(pr,po)| t * (pr**po) }\n  #=&gt; 20\n</code></pre>\n\n<p>The <code>reduce</code> calculation is equivalent to</p>\n\n<pre><code>2**2 * 3**0 * 5**1\n  #=&gt; 4 * 1 * 5 =&gt; 20\n</code></pre>\n\n<p>The calculations for the other values of <code>c</code> passed to the block are similar.</p>\n"}, {"tags": [], "owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1501761350, "creation_date": 1501761350, "answer_id": 45483484, "question_id": 45470134, "link": "https://stackoverflow.com/questions/45470134/algorithm-factor-combinations/45483484#45483484", "title": "Algorithm: Factor Combinations", "body": "<p>A simple way is to replace the last line of your method with</p>\n\n<pre><code>factors.map(&amp;:sort).uniq\n</code></pre>\n\n<p>which sorts all the subarrays and then eliminates duplicates.</p>\n"}], "owner": {"reputation": 1360, "user_id": 4430977, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/1268ab423eed6c864e3c43514a55efa5?s=128&d=identicon&r=PG&f=1", "display_name": "segue_segway", "link": "https://stackoverflow.com/users/4430977/segue-segway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1501761350, "creation_date": 1501704846, "question_id": 45470134, "link": "https://stackoverflow.com/questions/45470134/algorithm-factor-combinations", "title": "Algorithm: Factor Combinations", "body": "<p>I'm working on the following algorithm from Leetcode:</p>\n\n<pre><code>Numbers can be regarded as product of its factors. For example,\n\n8 = 2 x 2 x 2;\n  = 2 x 4.\nWrite a function that takes an integer n and return all possible combinations of its factors.\n\nNote: \nYou may assume that n is always positive.\nFactors should be greater than 1 and less than n.\nExamples: \ninput: 1\noutput: \n[]\ninput: 37\noutput: \n[]\ninput: 12\noutput:\n[\n  [2, 6],\n  [2, 2, 3],\n  [3, 4]\n]\ninput: 32\noutput:\n[\n  [2, 16],\n  [2, 2, 8],\n  [2, 2, 2, 4],\n  [2, 2, 2, 2, 2],\n  [2, 4, 4],\n  [4, 8]\n]\n</code></pre>\n\n<p>Here's the code that I have thus far:</p>\n\n<pre><code>def get_factors(n)\n    factors = [] \n    (2...n).each do |candidate|\n        if n % candidate == 0\n            factors &lt;&lt; [candidate, (n/candidate)]\n            get_factors(n/candidate).each do |factor_set|\n                factors &lt;&lt; [candidate] + factor_set\n            end \n        end \n    end \n  factors\nend\n</code></pre>\n\n<p>This code works really well, but doesn't handle duplicates (e.g [3, 2, 2] will be inserted along with [2, 2, 3]). I tried using a Set with the following code, </p>\n\n<pre><code>def get_factors(n)\n    seen = Set.new\n    factors = [] \n    (2...n).each do |candidate|\n        if n % candidate == 0 &amp;&amp; !seen.include?(candidate)\n            factors &lt;&lt; [candidate, (n/candidate)]\n            get_factors(n/candidate).each do |factor_set|\n                factors &lt;&lt; [candidate] + factor_set\n            end \n        end \n        seen &lt;&lt; (n/candidate)\n    end \n   factors \nend\n</code></pre>\n\n<p>but that only works to solve some test cases and not others. I'm not sure how to go about ensuring no duplicates in an efficient way? The really inefficient way is to generate some sort of hash value for each array depending on it's elements (and not dependent on order), and while this would work, there definitely should be a better way. Any ideas?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1501705932, "post_id": 45469873, "comment_id": 77901936, "body": "is raising <code>SheetEntriesInvalid</code> not working? I would just create another error (<code>PeriodOpenedException</code> or something) and throw/catch that just like [it appears] you&#39;re doing with <code>SheetEntriesInvalid</code>, you should be able to set the <code>flash</code> in <code>method1</code> if you need to customize the error based on where it&#39;s thrown and then throw the error and redirect in <code>batch_save</code>"}, {"owner": {"reputation": 105, "user_id": 7611946, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1bce27b07508f070768a12300c7addf5?s=128&d=identicon&r=PG&f=1", "display_name": "Archie123", "link": "https://stackoverflow.com/users/7611946/archie123"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1501770427, "post_id": 45469873, "comment_id": 77935135, "body": "raise SheetEntriesInavlid is not working... Can some one show me an example of how to do this?"}], "owner": {"reputation": 105, "user_id": 7611946, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1bce27b07508f070768a12300c7addf5?s=128&d=identicon&r=PG&f=1", "display_name": "Archie123", "link": "https://stackoverflow.com/users/7611946/archie123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501705202, "creation_date": 1501703798, "last_edit_date": 1501705202, "question_id": 45469873, "link": "https://stackoverflow.com/questions/45469873/how-to-break-away-from-a-transaction-loop-in-rails", "title": "How to break away from a transaction loop in rails", "body": "<p>I have this controller code where I want to break away from the loop when there is an error in one of methods it has . Below is the example </p>\n\n<pre><code>def batch_save\n  # some code\n\n  SheetEntry.transaction do\n    params[:entries].keys.each do |key|\n      method1(key,value)\n      method2(key,value)\n    end         \n  end\nrescue SheetEntriesInvalid =&gt; e\n  respond_to do |format|\n    format.html {\n      flash[:error] = \"Sorry, cannot save \"\n      redirect_to :action =&gt; :index\n    }\n    format.js { render :batch_save }\n  end\nend\n\ndef method1(key,value)\n  if period_opened(value) == false\n    flash[:error]=\" Please contact Administrator.\"\n    redirect_to :action =&gt; :index \n  end\nend\n</code></pre>\n\n<p>I want to know how to break away from the transaction loop when there is an error in <code>method1</code> and just redirect to index and show the error in <code>method1</code>.</p>\n"}, {"tags": ["ruby", "multithreading", "unit-testing", "testing", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 334, "user_id": 6413990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b2789440f48548f5a99ff92ca186d4?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav Kr.", "link": "https://stackoverflow.com/users/6413990/stanislav-kr"}, "is_accepted": false, "score": 0, "last_activity_date": 1502378257, "creation_date": 1502378257, "answer_id": 45617623, "question_id": 45469849, "link": "https://stackoverflow.com/questions/45469849/testing-number-of-successfully-returned-threads-using-rspec/45617623#45617623", "title": "Testing number of successfully returned threads using rspec", "body": "<pre><code>describe '#update_tokens' do\n  it 'is threadsafe', db_strategy: :truncation do\n    u = create(:user)\n    thread_injected = false\n    time = Time.now\n    allow(Time).to receive(:now) do\n      unless thread_injected\n        thread_injected = true\n        Thread.new { u.reload.update_tokens('c2', 't2') }.join\n      end\n      time\n    end\n    u.update_tokens('c1', 't1')\n    expect(u.tokens['c1']).not_to be_nil\n    expect(u.tokens['c2']).not_to be_nil\n  end\nend\n</code></pre>\n\n<p>Original: <a href=\"http://blog.paulrugelhiatt.com/rails/rspec/2015/09/28/testing-thread-safety-concurrency-in-rspec.html\" rel=\"nofollow noreferrer\">http://blog.paulrugelhiatt.com/rails/rspec/2015/09/28/testing-thread-safety-concurrency-in-rspec.html</a></p>\n"}], "owner": {"reputation": 31, "user_id": 2994514, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/831a0f2615b1b1fcbb90a16495f0f7f6?s=128&d=identicon&r=PG&f=1", "display_name": "MRezk", "link": "https://stackoverflow.com/users/2994514/mrezk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502378257, "creation_date": 1501703721, "question_id": 45469849, "link": "https://stackoverflow.com/questions/45469849/testing-number-of-successfully-returned-threads-using-rspec", "title": "Testing number of successfully returned threads using rspec", "body": "<p>How can I test that the number of successfully returned threads to the main thread is equal to the number of threads created in rspec?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "security", "controllers"], "answers": [{"comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 2, "creation_date": 1501702583, "post_id": 45468985, "comment_id": 77900018, "body": "Going along with this, <a href=\"https://github.com/thoughtbot/paperclip#post-processing\" rel=\"nofollow noreferrer\">looks like</a> using paper clip the model is possibly setup like <code>has_attached_file :avatar, styles: { thumb: [&quot;32x32#&quot;, :png] }</code> so I&#39;d probably suggest using the constant there as well <code>AVAILABLE_SIZE_TYPES = { thumb: [&quot;32x32#&quot;, :png] }</code> <code>has_attached_file :avatar, styles: AVAILABLE_SIZE_TYPES</code> and then <code>Model::AVAILABLE_SIZE_TYPES.has_key?(params[:style])</code> (again watch string/symbols)...single source of truth...if you added <code>:tiny</code> later, it&#39;s already updated."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1501702832, "post_id": 45468985, "comment_id": 77900162, "body": "Extending what @SimpleLime said: you can have one constant, let&#39;s say <code>IMAGE_CONFIGURATIONS = { small: [&#39;32x32#&#39;, :png] }.freeze</code> and then define <code>AVAILABLE_SIZE_TYPES = IMAGE_CONFIGURATIONS.keys</code> or even have an <code>ImageConfiguration</code> object (see part &quot;Extracting Value Objects&quot; of the following excellent article <a href=\"https://www.toptal.com/ruby-on-rails/decoupling-rails-components\" rel=\"nofollow noreferrer\">toptal.com/ruby-on-rails/decoupling-rails-components</a>)"}], "tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": false, "score": 4, "last_activity_date": 1501700397, "creation_date": 1501700397, "answer_id": 45468985, "question_id": 45468848, "link": "https://stackoverflow.com/questions/45468848/rails-4-parameters-how-to-whitelist-a-param-to-a-set-of-values/45468985#45468985", "title": "Rails 4 parameters; how to whitelist a param to a set of values", "body": "<p>First, you need to define a Constant white-listing all the valid <code>style</code> values (I would argue that <code>size_type</code> is a more explicit name). (Watch out for the Symbol / String comparisons).</p>\n\n<p>Then, you either return a 404 if the <code>params[:style]</code> is not included in the white-listed values OR you fallback to <code>'medium'</code>:</p>\n\n<pre><code>style = Model::AVAILABLE_SIZE_TYPES.include?(params[:style]) ? params[:style] || Model::AVAILABLE_SIZE_TYPES.first\n</code></pre>\n\n<p>Personally, I don't like fallbacks for user's input. They did something wrong (manipulated the URL, changed a value in a form, etc), they deserve to get an error page.</p>\n\n<p>I implied the constant is defined in the Model, but it should not be there as it is not related to the business logic but related to the display of the Model. If you have a ModelDecorator, define it there.</p>\n"}, {"comments": [{"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 2441, "user_id": 224707, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/870ccdb57016c46120bb8e93f8bca94a?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/224707/nick"}, "edited": false, "score": 0, "creation_date": 1501703031, "post_id": 45469519, "comment_id": 77900299, "body": "@Nick Thanks! : )"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1501703241, "post_id": 45469519, "comment_id": 77900416, "body": "@m.simonborg good work! Although, I don&#39;t think that <code>{ &#39;a&#39; =&gt; 1 }.allow(a: 1)</code> should work, your code is disregarding the fact that the hash is a regular Hash or HashWithIndifferentAccess. Also, <code>{ a: 1, &#39;a&#39; =&gt; 2 }.allow(a: [1,2])</code> would allow both keys and I have no way to restrict this based on the key&#39;s type. (I have not tested it, just read the source code)"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 2, "creation_date": 1501703793, "post_id": 45469519, "comment_id": 77900755, "body": "@MrYoshiji thanks, that&#39;s very good feedback. I developed it with <code>ActionController::Parameters</code> in mind, so the implementation for that is probably not the best implementation for <code>Hash</code>. I think a separate implementation for <code>Hash</code> in a separate module will address those valid issues"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501715397, "post_id": 45469519, "comment_id": 77905729, "body": "@MrYoshiji thanks again for raising the issue, pushed those changes so key types are respected in <code>Hash</code>"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1501716305, "post_id": 45469519, "comment_id": 77905949, "body": "@m.simonborg thank you for this tool, I will probably use it in my next project!"}], "tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": false, "score": 4, "last_activity_date": 1502055827, "last_edit_date": 1502055827, "creation_date": 1501702482, "answer_id": 45469519, "question_id": 45468848, "link": "https://stackoverflow.com/questions/45468848/rails-4-parameters-how-to-whitelist-a-param-to-a-set-of-values/45469519#45469519", "title": "Rails 4 parameters; how to whitelist a param to a set of values", "body": "<p>I wrote a gem that extends <code>ActionController::Parameters</code> for exactly this purpose: whitelisting parameter values. It's simple and lightweight. You would use it like this:</p>\n\n<pre><code>def model_params\n  params.require(:model).permit(:style, :other_attribute).allow(style: %w[small medium large])\nend\n</code></pre>\n\n<p>Hope you find it useful</p>\n\n<p><a href=\"https://github.com/msimonborg/allowable\" rel=\"nofollow noreferrer\">https://github.com/msimonborg/allowable</a></p>\n"}], "owner": {"reputation": 2441, "user_id": 224707, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/870ccdb57016c46120bb8e93f8bca94a?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/224707/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2557, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1502055827, "creation_date": 1501699977, "last_edit_date": 1501700304, "question_id": 45468848, "link": "https://stackoverflow.com/questions/45468848/rails-4-parameters-how-to-whitelist-a-param-to-a-set-of-values", "title": "Rails 4 parameters; how to whitelist a param to a set of values", "body": "<p>I have already read some posts, such as <a href=\"https://stackoverflow.com/questions/28541432\">Value whitelist using strong parameters in Rails 4</a>, but it's not quite what I need.</p>\n\n<p>I have a controller which takes an ID and loads a model. It also optionally takes a query string param (<code>style</code>) which can be one of 3 values, <code>small</code>, <code>medium</code> or <code>large</code>. This is passed to a method on the model which uses it to fetch an attached image (using paperclip). I noticed that if I pass an invalid param (eg <code>style=wibble</code>), then I get a 400 error and a notice that the internal file path doesn't exist. Brakeman also notes this as a security issue...</p>\n\n<pre><code>def show\n  style = params[:style] || :medium\n\n  thing = Model.find(params[:id])\n\n  path = \"#{Rails.root}/public#{thing.image_url(style)}\"\n  content_type = thing.image.content_type || 'image/png'\n  send_file path, type: content_type, disposition: 'inline'\nend\n</code></pre>\n\n<p>We use <a href=\"http://api.rubyonrails.org/classes/ActionController/Parameters.html\" rel=\"noreferrer\">ActionController Parameters</a> elsewhere to great effect; but I cannot see how that could \"whitelist\" a parameters options? Everywhere I have seen says to use a model validator, but that's assuming I'm submitting a parameter to update a model, which I am not.</p>\n\n<p>I'm aware I could do something like:</p>\n\n<pre><code>return head :not_found unless %w(small medium large).include? style\n</code></pre>\n\n<p>Is this the best way?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 34214, "user_id": 1141839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b5c46e3c79ab446329ff05949594cd?s=128&d=identicon&r=PG", "display_name": "PinnyM", "link": "https://stackoverflow.com/users/1141839/pinnym"}, "is_accepted": true, "score": 25, "last_activity_date": 1501697871, "creation_date": 1501697871, "answer_id": 45468243, "question_id": 45468195, "link": "https://stackoverflow.com/questions/45468195/bundle-not-found-after-changing-ruby-version-with-rvm/45468243#45468243", "title": "Bundle not found after changing ruby version with RVM", "body": "<p>You probably had Bundler installed for the version of ruby you've been using until this point.  However, Bundler is not installed on versions of ruby provided by RVM by default, so for after you switch to ruby-2.2.2, install Bundler for that ruby:</p>\n\n<pre><code>gem install bundler\n</code></pre>\n\n<p>Then try running <code>bundle install</code> again.</p>\n"}, {"comments": [{"owner": {"reputation": 631, "user_id": 4534959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cZiJjzmwu88/AAAAAAAAAAI/AAAAAAAAAD0/zDFGSxrSBkU/photo.jpg?sz=128", "display_name": "Jeremy_inPDX", "link": "https://stackoverflow.com/users/4534959/jeremy-inpdx"}, "edited": false, "score": 0, "creation_date": 1525900444, "post_id": 45471344, "comment_id": 87542401, "body": "Michael Deering&#39;s suggestion was especially helpful to me, and my bundler was pointing at my system Ruby rather than my RVM install of Ruby, despite that I had set the latter as my default. Putting the bundler gem into a global gemset for my RVM Ruby install got things working."}], "tags": [], "owner": {"reputation": 434, "user_id": 337928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4da9ad2bd4a2d1ce3c428e32c423588a?s=128&d=identicon&r=PG", "display_name": "Michael Deering", "link": "https://stackoverflow.com/users/337928/michael-deering"}, "is_accepted": false, "score": 3, "last_activity_date": 1501709510, "creation_date": 1501709510, "answer_id": 45471344, "question_id": 45468195, "link": "https://stackoverflow.com/questions/45468195/bundle-not-found-after-changing-ruby-version-with-rvm/45471344#45471344", "title": "Bundle not found after changing ruby version with RVM", "body": "<p>If you just switched to a new version of ruby on your RVM install 2.2.2 in this case the </p>\n\n<pre><code>  gem install bundler \n</code></pre>\n\n<p>command listed as correct above is only going to solve this error for that single gemset. I would suggest running the following command to avoid it for any other gemsets also tied to the same version of ruby.</p>\n\n<pre><code>  rvm use 2.2.2@global\n  gem install bundler\n</code></pre>\n\n<p>That will put the <em>bundler</em> gem into your <em>global</em> 2.2.2 gemset making it available but over writable by all other 2.2.2 gemsets.  You can also install gems like nokogiri and such that are common but very time consuming into this global 2.2 gemset</p>\n"}], "owner": {"reputation": 3774, "user_id": 7168582, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh5.googleusercontent.com/-8dcI0krNoFE/AAAAAAAAAAI/AAAAAAAAADY/mLQQmEB4qLs/photo.jpg?sz=128", "display_name": "Max Millington", "link": "https://stackoverflow.com/users/7168582/max-millington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4051, "favorite_count": 0, "accepted_answer_id": 45468243, "answer_count": 2, "score": 3, "last_activity_date": 1501709510, "creation_date": 1501697713, "question_id": 45468195, "link": "https://stackoverflow.com/questions/45468195/bundle-not-found-after-changing-ruby-version-with-rvm", "title": "Bundle not found after changing ruby version with RVM", "body": "<p>I feel like this is a super beginner question with an obvious answer but I'm missing it.</p>\n\n<p>I'm installing a Rails project that includes a gem requiring me to use a version of Ruby that is 2.2.2 or earlier. Since my current system is set up with a newer version of Ruby, when I run <code>bundle install</code>, it fails because one of the gems can't be installed with the newest version of Ruby. </p>\n\n<p>So, I set my system to use ruby 2.2.2 with rvm, <code>rvm use ruby-2.2.2</code>.</p>\n\n<p>I then run <code>bundle install</code> and get <code>zsh: command not found: bundle</code>. Why is this? All my other commands work and I can install the problem gem individually with <code>gem install</code>.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested", "resources"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501697078, "post_id": 45467974, "comment_id": 77896818, "body": "GrandChildrenController#new should have <code>@grand_children = Parent.find(params[:parent_id]).children.find(params[:childr&zwnj;&#8203;en_id]).grand_childr&zwnj;&#8203;en.new</code>, same for the create action (use the same chain of nesting) and even for the show/edit actions, as you should not be able to see GrandChildren #2 with URL <code>&#47;parents&#47;1&#47;children&#47;1&#47;grand_children&#47;2</code> if GrandChildren parent&#39;s id is not 1 or GrandChildren&#39;s Children id is not 1. This prevent from basic URL manipulation."}], "answers": [{"tags": [], "owner": {"reputation": 3505, "user_id": 1133488, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b15cf4835e6eefdf1e8bf204f13fc71b?s=128&d=identicon&r=PG", "display_name": "Laser", "link": "https://stackoverflow.com/users/1133488/laser"}, "is_accepted": false, "score": 0, "last_activity_date": 1501722483, "creation_date": 1501722483, "answer_id": 45473217, "question_id": 45467974, "link": "https://stackoverflow.com/questions/45467974/nesting-three-level-deep-resource-in-ruby-on-rails/45473217#45473217", "title": "nesting three level deep resource in ruby on rails", "body": "<p>In your <code>GrandChildren</code> model you could have <code>belongs_to :child, optional: true</code>, but I'm not sure that will resolve your routing error, as nesting the route requires for the parent to exist. </p>\n\n<p>Perhaps the solution instead is for your <code>grand_children#new</code> action to ensure a parent <code>child</code> exists, and the foreign key <code>child_id</code> is passed in on the creation of a <code>grand_child</code> record. </p>\n"}], "owner": {"reputation": 31, "user_id": 7611138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/072985672dc2fa583a24561d5aafa316?s=128&d=identicon&r=PG&f=1", "display_name": "saeed ", "link": "https://stackoverflow.com/users/7611138/saeed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1501722483, "creation_date": 1501696930, "last_edit_date": 1501697015, "question_id": 45467974, "link": "https://stackoverflow.com/questions/45467974/nesting-three-level-deep-resource-in-ruby-on-rails", "title": "nesting three level deep resource in ruby on rails", "body": "<p>I have three level deep nesting resources such as parent, child, comment</p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :parents do\n    resources :children do\n      resources :grand_children\n    end\n  end\nend\n</code></pre>\n\n<p>In action <code>grand_children#new</code> it alert the \"parent must exist\" \ncould anyone help me how to create a grand_children nested in three level deep ?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 434, "user_id": 337928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4da9ad2bd4a2d1ce3c428e32c423588a?s=128&d=identicon&r=PG", "display_name": "Michael Deering", "link": "https://stackoverflow.com/users/337928/michael-deering"}, "edited": false, "score": 0, "creation_date": 1501709656, "post_id": 45467155, "comment_id": 77903822, "body": "Might be as easy as calling <i>.uniq</i> on <i>p.users.uniq.company_name</i> but would need to see your models and associations to confirm."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501705441, "post_id": 45467241, "comment_id": 77901645, "body": "Thanks for your help but i get SQL error &quot;subquery has too many columns&quot;"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501706223, "post_id": 45467241, "comment_id": 77902089, "body": "@AntoineWako try my updated answer. Also, what DB system are you using?"}, {"owner": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501706983, "post_id": 45467241, "comment_id": 77902499, "body": "I use PostgreSQL"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501707301, "post_id": 45467241, "comment_id": 77902672, "body": "@AntoineWako What is the Rails version you are using?"}, {"owner": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501707404, "post_id": 45467241, "comment_id": 77902717, "body": "i use 5.1, now i dont get errors but i dont get users"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501707725, "post_id": 45467241, "comment_id": 77902885, "body": "@AntoineWako my bad... I took the problem the wrong way, see my updated answer"}, {"owner": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501708166, "post_id": 45467241, "comment_id": 77903107, "body": "I get &quot;ERROR:  column &quot;distance&quot; does not exist&quot;,  i dont know where it from"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501708343, "post_id": 45467241, "comment_id": 77903182, "body": "This is not related to the User model but most likely related to the Product. Can you post the full error message?"}, {"owner": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501708537, "post_id": 45467241, "comment_id": 77903268, "body": "PG::UndefinedColumn: ERROR:  column &quot;distance&quot; does not exist LINE 1: ... 0.0 AND 1) AND &quot;biens&quot;.&quot;product_type&quot; = $1 ORDER BY distance A...                                                              ^"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501708624, "post_id": 45467241, "comment_id": 77903309, "body": "Can you post the full SQL query instead? This seems to be related to the GeoCoder gem or whatever the GPS location gem you are using"}, {"owner": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501708813, "post_id": 45467241, "comment_id": 77903417, "body": "SELECT &quot;products&quot;.&quot;user_id&quot; FROM &quot;products&quot; WHERE (products.latitude BETWEEN 50.62025678394081 AND 50.63824321605919 AND products.longitude BETWEEN 3.043078628915486 AND 3.0714333710845145 AND (6371.0 * 2 * ASIN(SQRT(POWER(SIN((50.62925 - products.latitude) * PI() / 180 / 2), 2) + COS(50.62925 * PI() / 180) * COS(products.latitude * PI() / 180) * POWER(SIN((3.057256 - products.longitude) * PI() / 180 / 2), 2)))) BETWEEN 0.0 AND 1) AND &quot;products&quot;.&quot;product_type&quot; = $1 ORDER BY distance ASC"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501709041, "post_id": 45467241, "comment_id": 77903550, "body": "Ok, I see ... The <code>near</code> method forces an order, can you try with <code>User.where(user_id: @products.reorder(:user_id).pluck(:user_id))</code>? -- What gem is providing you this <code>near</code> method? Geocoder?"}, {"owner": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501709598, "post_id": 45467241, "comment_id": 77903800, "body": "It works ! Thanks for your help you save a french startup haha, its .where(id:....) not user_id"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501710779, "post_id": 45467241, "comment_id": 77904246, "body": "Ahah Im glad I helped you out. Have fun with rails!"}], "tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": false, "score": 1, "last_activity_date": 1501710768, "last_edit_date": 1501710768, "creation_date": 1501694399, "answer_id": 45467241, "question_id": 45467155, "link": "https://stackoverflow.com/questions/45467155/get-users-of-search-products-search-results/45467241#45467241", "title": "Get users of search products search results", "body": "<p>Assuming the following:</p>\n\n<pre><code>User has_many :products\nProduct belongs_to :user\n</code></pre>\n\n<p>You can do:</p>\n\n<pre><code>@users_from_product_results = User.where(id: @products.pluck(:user_id))\n</code></pre>\n\n<p>If several products refer to the same user, this User will be listed only once.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6003059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd2e8c0fd072057d0ae6cc91274f8fca?s=128&d=identicon&r=PG&f=1", "display_name": "bTspm10", "link": "https://stackoverflow.com/users/6003059/btspm10"}, "is_accepted": false, "score": 0, "last_activity_date": 1501874741, "creation_date": 1501874741, "answer_id": 45514152, "question_id": 45467155, "link": "https://stackoverflow.com/questions/45467155/get-users-of-search-products-search-results/45514152#45514152", "title": "Get users of search products search results", "body": "<p>Rather than making 2 separate AR calls, use includes(eager_loading) which gives both products and users in a single query. </p>\n\n<pre><code>if params[:product_type].present? &amp;&amp; params[:location].present? &amp;&amp; params[:discount].present?\n  @products = Product.near(params[:location], 1, units: :km).where(product_type: params[:product_type], discount: params[:discount])\n.includes(:user)\nend\n</code></pre>\n\n<p>And in the view you could use <code>@products.map(:users).uniq</code> which gives all the users associated with the products. </p>\n"}], "owner": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501874741, "creation_date": 1501694144, "last_edit_date": 1501707064, "question_id": 45467155, "link": "https://stackoverflow.com/questions/45467155/get-users-of-search-products-search-results", "title": "Get users of search products search results", "body": "<p>I would know the best way to get all users who have products of the search result</p>\n\n<p>My controller</p>\n\n<pre><code>    @users = User.all // i must change here ?\n    if params[:product_type].present? &amp;&amp; params[:location].present? &amp;&amp; params[:discount].present?\n      @products = Product.near(params[:location], 1, units: :km).where(product_type: params[:product_type], discount: params[:discount])\n    end\n</code></pre>\n\n<p>My view</p>\n\n<pre><code>&lt;% @products.each do |p| %&gt;\n  &lt;%= p.user.company_name %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My method work but if a company have 2 products its display it 2 times</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501693345, "post_id": 45466887, "comment_id": 77894582, "body": "Precisely. In other words, if you want just the first value of each array, call <code>first</code> on each one."}, {"owner": {"reputation": 69, "user_id": 8041945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e11758949228df43138240ec1e7b9bdf?s=128&d=identicon&r=PG&f=1", "display_name": "LewMoore", "link": "https://stackoverflow.com/users/8041945/lewmoore"}, "edited": false, "score": 0, "creation_date": 1501694306, "post_id": 45466887, "comment_id": 77895192, "body": "This worked for two of the tests however for the third test (when the input is 24) its returning Expected: [2, 3, 4, 6, 8, 12], instead got: [2, 3], any help?"}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 2, "last_activity_date": 1501693292, "creation_date": 1501693292, "answer_id": 45466887, "question_id": 45466786, "link": "https://stackoverflow.com/questions/45466786/ruby-prime-division-returning-two-values/45466887#45466887", "title": "Ruby prime_division returning two values,", "body": "<pre><code>15.prime_division.map(&amp;:first) # =&gt; [3, 5]\n</code></pre>\n\n<p>The <code>1</code>s in the result stand for the number of occurrences (aka one 3 and one 5).</p>\n"}], "owner": {"reputation": 69, "user_id": 8041945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e11758949228df43138240ec1e7b9bdf?s=128&d=identicon&r=PG&f=1", "display_name": "LewMoore", "link": "https://stackoverflow.com/users/8041945/lewmoore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 45466887, "answer_count": 1, "score": 2, "last_activity_date": 1501695098, "creation_date": 1501692960, "last_edit_date": 1501693430, "question_id": 45466786, "link": "https://stackoverflow.com/questions/45466786/ruby-prime-division-returning-two-values", "title": "Ruby prime_division returning two values,", "body": "<p>I'm trying to return the divisors of the input and have come up with the below:</p>\n\n<pre><code>require 'prime'\n\ndef divisors(n)\n  n.prime_division\nend\n</code></pre>\n\n<p>With an input of 15, it is returning this:</p>\n\n<pre><code>Expected: [3, 5], instead got: [[3, 1], [5, 1]] \n</code></pre>\n\n<p>How do I make it return just 3 &amp; 5 without the 1's?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 1068, "user_id": 5854882, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fe1e093f1daa8277a4dd0b61eafd72b?s=128&d=identicon&r=PG&f=1", "display_name": "jhhoff02", "link": "https://stackoverflow.com/users/5854882/jhhoff02"}, "edited": false, "score": 0, "creation_date": 1501693208, "post_id": 45466687, "comment_id": 77894484, "body": "It&#39;s hard to read your post"}], "answers": [{"tags": [], "owner": {"reputation": 15010, "user_id": 536890, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/85530c6eefdc35e70ff1e2119eaad7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Kim", "link": "https://stackoverflow.com/users/536890/jason-kim"}, "is_accepted": false, "score": 0, "last_activity_date": 1501695058, "creation_date": 1501695058, "answer_id": 45467434, "question_id": 45466687, "link": "https://stackoverflow.com/questions/45466687/c9-and-heroku-rake-aborted-undefined-method-mount/45467434#45467434", "title": "c9 and heroku / rake aborted! undefined method `mount&#39;", "body": "<p>I see <code>mount ActionCable.server =&gt; '/cable'</code> in config/environments/production.rb</p>\n\n<p><a href=\"https://github.com/sangyeol-kim/KNU_Community_Sy_part/blob/3dc80e210f3a8d40fb9184877098560c65d3b37f/config/environments/production.rb#L2\" rel=\"nofollow noreferrer\">https://github.com/sangyeol-kim/KNU_Community_Sy_part/blob/3dc80e210f3a8d40fb9184877098560c65d3b37f/config/environments/production.rb#L2</a></p>\n\n<p>Remove that and try it out.</p>\n"}, {"tags": [], "owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "is_accepted": true, "score": 0, "last_activity_date": 1501695291, "creation_date": 1501695291, "answer_id": 45467496, "question_id": 45466687, "link": "https://stackoverflow.com/questions/45466687/c9-and-heroku-rake-aborted-undefined-method-mount/45467496#45467496", "title": "c9 and heroku / rake aborted! undefined method `mount&#39;", "body": "<p>In <code>config/environments/production.rb</code> on <a href=\"https://github.com/sangyeol-kim/KNU_Community_Sy_part/blob/master/config/environments/production.rb#L2\" rel=\"nofollow noreferrer\">line 2</a>, change this:</p>\n\n<pre><code>mount ActionCable.server =&gt; '/cable'\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>config.action_cable.mount_path = \"/cable\"\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 8406937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2dcec684312e20f86da6d68437ac8c8e?s=128&d=identicon&r=PG&f=1", "display_name": "COLEAN", "link": "https://stackoverflow.com/users/8406937/colean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 45467496, "answer_count": 2, "score": 1, "last_activity_date": 1501695291, "creation_date": 1501692636, "last_edit_date": 1501694531, "question_id": 45466687, "link": "https://stackoverflow.com/questions/45466687/c9-and-heroku-rake-aborted-undefined-method-mount", "title": "c9 and heroku / rake aborted! undefined method `mount&#39;", "body": "<p>Everything working fine on the development environment(C9). However, when it comes to deploying to Heroku, when I try to run 'heroku rake db:migrate', I get the following error message:</p>\n\n<pre><code>breadeat:~/workspace/KNU_Community_Sy_part (master) $ heroku run rake db:migrate\nRunning rake db:migrate on \u2b22 arcane-woodland-11170... up, run.6105 (Free)\nrake aborted!\nNoMethodError: undefined method `mount' for #&lt;Kcm::Application:0x00000002c99d00&gt;\n/app/config/environments/production.rb:2:in `block in &lt;top (required)&gt;'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/railtie.rb:211:in `instance_eval'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/railtie.rb:211:in `configure'\n/app/config/environments/production.rb:1:in `&lt;top (required)&gt;'\n/app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.2/lib/active_support/dependencies.rb:292:in `require'\n/app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.2/lib/active_support/dependencies.rb:292:in `block in require'\n/app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.2/lib/active_support/dependencies.rb:258:in `load_dependency'\n/app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.2/lib/active_support/dependencies.rb:292:in `require'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/engine.rb:600:in `block (2 levels) in &lt;class:Engine&gt;'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/engine.rb:599:in `each'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/engine.rb:599:in `block in &lt;class:Engine&gt;'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/initializable.rb:30:in `instance_exec'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/initializable.rb:30:in `run'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/initializable.rb:59:in `block in run_initializers'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/initializable.rb:48:in `each'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/initializable.rb:48:in `tsort_each_child'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/initializable.rb:58:in `run_initializers'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/application.rb:353:in `initialize!'\n/app/config/environment.rb:5:in `&lt;top (required)&gt;'\n/app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.2/lib/active_support/dependencies.rb:292:in `require'\n/app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.2/lib/active_support/dependencies.rb:292:in `block in require'\n/app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.2/lib/active_support/dependencies.rb:258:in `load_dependency'\n/app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.2/lib/active_support/dependencies.rb:292:in `require'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/application.rb:329:in `require_environment!'\n/app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.2/lib/rails/application.rb:445:in `block in run_tasks_blocks'\n/app/vendor/bundle/ruby/2.3.0/gems/rake-12.0.0/exe/rake:27:in `&lt;top (required)&gt;'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/cli/exec.rb:74:in `load'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/cli/exec.rb:74:in `kernel_load'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/cli/exec.rb:27:in `run'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/cli.rb:360:in `exec'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/vendor/thor/lib/thor.rb:369:in `dispatch'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/cli.rb:20:in `dispatch'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/vendor/thor/lib/thor/base.rb:444:in `start'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/cli.rb:10:in `start'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/exe/bundle:30:in `block in &lt;top (required)&gt;'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/lib/bundler/friendly_errors.rb:121:in `with_friendly_errors'\n/app/vendor/bundle/ruby/2.3.0/gems/bundler-1.15.2/exe/bundle:22:in `&lt;top (required)&gt;'\n/app/bin/bundle:3:in `load'\n/app/bin/bundle:3:in `&lt;main&gt;'\nTasks: TOP =&gt; db:migrate =&gt; environment\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>help plz..</p>\n\n<p>my code in github\nlink_to : <a href=\"https://github.com/sangyeol-kim/KNU_Community_Sy_part\" rel=\"nofollow noreferrer\">https://github.com/sangyeol-kim/KNU_Community_Sy_part</a></p>\n\n<p>For reference, I have installed the Heroku redis add-on.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501692334, "post_id": 45466549, "comment_id": 77893935, "body": "Strip spaces, then match."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501692743, "post_id": 45466549, "comment_id": 77894180, "body": "What is the format of a UK Postcode?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1501693709, "post_id": 45466549, "comment_id": 77894835, "body": "@sagarpandya82 The <a href=\"https://en.wikipedia.org/wiki/Postcodes_in_the_United_Kingdom\" rel=\"nofollow noreferrer\">Wikipedia article on them</a> actually includes a regular expression definition, which is pretty amazing: <code>^([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-&zwnj;&#8203;9]{1,2})|(([A-Za-z][&zwnj;&#8203;0-9][A-Za-z])|([A-Za&zwnj;&#8203;-z][A-Ha-hJ-Yj-y][0-&zwnj;&#8203;9]?[A-Za-z])))) [0-9][A-Za-z]{2})$</code>"}, {"owner": {"reputation": 63, "user_id": 8164742, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154857681276559/picture?type=large", "display_name": "Charles Syms", "link": "https://stackoverflow.com/users/8164742/charles-syms"}, "edited": false, "score": 0, "creation_date": 1501707088, "post_id": 45466549, "comment_id": 77902563, "body": "Thanks but doesn&#39;t answer my question. I&#39;m trying to filter only for certain postcodes, not find out how to write all postcodes"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501711347, "post_id": 45466549, "comment_id": 77904479, "body": "In my answer I assumed that &quot;If postcodes match MK11 - MK18 then don&#39;t allow it.&quot; could be replaced by &quot;If postcodes don&#39;t match these, then don&#39;t allow it.&quot; Is that an appropriate assumption?"}, {"owner": {"reputation": 63, "user_id": 8164742, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154857681276559/picture?type=large", "display_name": "Charles Syms", "link": "https://stackoverflow.com/users/8164742/charles-syms"}, "edited": false, "score": 0, "creation_date": 1501740341, "post_id": 45466549, "comment_id": 77912458, "body": "Hi Cary, yes that&#39;s an accurate assumption :) I will reply to your answer now. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 836, "user_id": 5184993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjJCR.jpg?s=128&g=1", "display_name": "9953-div-37", "link": "https://stackoverflow.com/users/5184993/9953-div-37"}, "edited": false, "score": 0, "creation_date": 1501734837, "post_id": 45471302, "comment_id": 77910157, "body": "I like how you wrote the regex in the top part of your answer, I will be doing it like this when I struggle to get it right or when it is a long regex."}, {"owner": {"reputation": 63, "user_id": 8164742, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154857681276559/picture?type=large", "display_name": "Charles Syms", "link": "https://stackoverflow.com/users/8164742/charles-syms"}, "edited": false, "score": 0, "creation_date": 1501742265, "post_id": 45471302, "comment_id": 77913539, "body": "Hi Cary, great answer and very easy to understand. My question however must not have been as this is only partly where I&#39;m trying to get to. The standard format of a UK postcode is either (for example) MK131ES or MK13 1ES, either one must be accepted whether or not there is white space in the middle. As above it is written as 2 letters (donate area of UK), 1 or 2 numbers (donates locality within that area), then 1 number and 2 letters (donating a specific group of houses within that locality). I have edited to also accept lowercase (just in case), I have edited my question, thank you."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 836, "user_id": 5184993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjJCR.jpg?s=128&g=1", "display_name": "9953-div-37", "link": "https://stackoverflow.com/users/5184993/9953-div-37"}, "edited": false, "score": 1, "creation_date": 1501786895, "post_id": 45471302, "comment_id": 77946366, "body": "@RoanFourie, yes, the free-spacing mode makes the regex definition self-documenting, but there is a potential &quot;gotcha&quot; with its use: it strips out spaces. Whereas <code>&#39;cat dog&#39;[&#47;t d&#47;] #=&gt; &#39;t d&#39;</code>, <code>&#39;cat dog&#39;[&#47;t g&#47;x] #=&gt; nil</code>. That&#39;s because the latter is equivalent to <code>&#39;cat dog&#39;[&#47;tg&#47;]</code>. You need to use <code>&#47;t\\sg&#47;</code>, <code>&#47;t[ ]g&#47;</code> or a non-breaking space."}, {"owner": {"reputation": 836, "user_id": 5184993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjJCR.jpg?s=128&g=1", "display_name": "9953-div-37", "link": "https://stackoverflow.com/users/5184993/9953-div-37"}, "edited": false, "score": 0, "creation_date": 1501814181, "post_id": 45471302, "comment_id": 77955903, "body": "Thanks Cary, that is very useful, I understand. I will definitely keep that in mind."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501831748, "post_id": 45471302, "comment_id": 77962172, "body": "I added something to the end of my answer to address your concern."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1501831680, "last_edit_date": 1501831680, "creation_date": 1501709314, "answer_id": 45471302, "question_id": 45466549, "link": "https://stackoverflow.com/questions/45466549/ruby-regular-expression-for-parcelify-shopify/45471302#45471302", "title": "Ruby Regular Expression for Parcelify (Shopify)", "body": "<pre><code>r = /\n    (?:                                     # begin non-capture group           \n      MK                                    # match characters\n      (?:1|2|3|4|5|6|7|8|9|10|19|43|46|77)  # match one of the choices\n      |                                     # or\n      NN                                    # match characters\n      (?:1|2|3|4|5|6|7|12|13|29|77)         # match one of the choices\n    )                                       # end non-capture group\n    (?![^\\sA-Z])                            # do not match a space or cap letter\n    /ix                                     # case indifferent and free-spacing\n                                            # regex definition mode\n</code></pre>\n\n<p>This is conventionally written</p>\n\n<pre><code>r = /(?:MK(?:1|2|...|10|19|...|77)|NN(?:1|2|...|7|12|13|29|77))(?![^\\sA-Z])/i\n\n\"MK4 abc def MK11MK19ghi NN6 jkl NN13 NN29NN77\".scan(r)\n   # =&gt; [\"MK4\", \"NN6\", \"NN13\", \"NN29\", \"NN77\"]\n</code></pre>\n\n<p><code>\"MK11\"</code> is not matched because <code>\"11\"</code> is not in the list. <code>\"MK19\"</code> is not matched because it is followed by a character that is neither a space nor a capital letter.</p>\n\n<p>Alternatively, one could write</p>\n\n<pre><code>s = (['MK'].product(%w{1 2 3 4 5 6 7 8 9 10 19 43 46 77}).map(&amp;:join) +\n     ['NN'].product(%w{1 2 3 4 5 6 7 12 13 29 77}).map(&amp;:join)).join('|')\n  # =&gt; \"MK1|MK2|...|MK10|MK19|MK43|MK46|MK77|NN1|NN2|...|NN7|NN12|NN13|NN29|NN77\"\nr = /(?:#{s})(?![^\\sA-Z])/i\n  #=&gt; /(?:MK1|MK2|...|MK10|MK19|...|MK77|NN1|NN2|...|NN7|NN12|NN13|NN29|NN77)(?![^\\sA-Z])/\n</code></pre>\n\n<p>If the remainder of the postal code is to be included in the regex, perhaps something like the following could be done.</p>\n\n<pre><code>suffixes = %w|ES AB CD EF|.join('|')\n  #=&gt; \"ES|AB|CD|EF\"\n</code></pre>\n\n<p>Then replace <code>(?![^\\sA-Z])/x</code> with the following.</p>\n\n<pre><code>\\s?             # optionally match a space\n(?:#{suffixes}) # match a valid suffix in a non-capture group\n(?!\\S)          # do not match a non-whitespace char (negative lookahead)\n/ix             # case-indifferent and free-spacing regex definition mode\n</code></pre>\n\n<p>Note the negative lookahead is satisfied if the suffix is at the end of the string.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 8164742, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154857681276559/picture?type=large", "display_name": "Charles Syms", "link": "https://stackoverflow.com/users/8164742/charles-syms"}, "is_accepted": false, "score": 0, "last_activity_date": 1501742643, "creation_date": 1501742643, "answer_id": 45476743, "question_id": 45466549, "link": "https://stackoverflow.com/questions/45466549/ruby-regular-expression-for-parcelify-shopify/45476743#45476743", "title": "Ruby Regular Expression for Parcelify (Shopify)", "body": "<p>Now I have written the following to match the postcodes format exactly:</p>\n\n<pre><code>#format: Area Code, Localities accepted, whitespace (MKor not), any digit, any single character, any single character\n    ((MK|mk|Mk|mK)(?:1|2|3|4|5|6|7|8|9|10|19|43|46|77)\\s\\d[A-Za-z][A-Za-z]) #with whitespace\n    |\n    ((MK|mk|Mk|mK)(?:1|2|3|4|5|6|7|8|9|10|19|43|46|77)\\d[A-Za-z][A-Za-z]) #without whitespace\n    |\n    ((NN|nn|Nn|nN)(?:1|2|3|4|5|6|7|12|13|29|77)\\s\\d[A-Za-z][A-Za-z]) #with whitespace\n    |\n    ((NN|nn|Nn|nN)(?:1|2|3|4|5|6|7|12|13|29|77)\\d[A-Za-z][A-Za-z]) #without whitespace\n</code></pre>\n\n<p>This works for my purposes, I got here using Cary's answer, which has been extremely helpful. Thank you and have marked up.</p>\n"}], "owner": {"reputation": 63, "user_id": 8164742, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154857681276559/picture?type=large", "display_name": "Charles Syms", "link": "https://stackoverflow.com/users/8164742/charles-syms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 1, "accepted_answer_id": 45471302, "answer_count": 2, "score": 1, "last_activity_date": 1501831680, "creation_date": 1501692218, "last_edit_date": 1501742585, "question_id": 45466549, "link": "https://stackoverflow.com/questions/45466549/ruby-regular-expression-for-parcelify-shopify", "title": "Ruby Regular Expression for Parcelify (Shopify)", "body": "<p>I'm trying to write a Regex in Ruby for a shipping query. </p>\n\n<p>If postcodes match MK1 - MK10, MK19, MK43, MK46 or MK77, then allow it. \nIf postcodes match NN1 - NN7, NN12, NN13, NN29 or NN77, then allow it.\nIf postcodes match MK11 - MK18 then don't allow it.</p>\n\n<p>My trouble is that in the UK our postcodes are a bit funny where you can put MK1 1TS and MK11TS and they're considered the same. By not allowing MK11, MK11TY could be misread as MK11.</p>\n\n<p>I've written a regex below, and so far it will disallow MK111TS and MK11\\s1TS, and allow MK1\\s1TS but not MK11TS. Any help would be greatly appreciated, I've only tested this for MK11 so far.</p>\n\n<pre><code>^((?!MK11\\d).)*$&amp;^((?!MK11\\s\\d).)*$|(MK(1 |2 |3 |4 |5 |6 |7 |8 |9 |10 ))|(MK19)|(MK43)|(MK46)|(MK77)|(NN1)|(NN2)|(NN3)|(NN4)|(NN5)|(NN6)|(NN7)|(NN12)|(NN13)|(NN29)|(NN77)\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1501691855, "post_id": 45466167, "comment_id": 77893644, "body": "I&#39;d be super careful using w3ii as a reference site as it looks fairly low quality. There are much better <a href=\"https://en.wikipedia.org/wiki/Programming_Ruby\" rel=\"nofollow noreferrer\">places to start</a>."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1501691917, "post_id": 45466225, "comment_id": 77893684, "body": "You can also make <code>walk_dog</code> a chainable method by adding <code>self</code> as the last line of code in it."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 2, "creation_date": 1501693403, "post_id": 45466225, "comment_id": 77894617, "body": "This would be a good case to use the <code>tap(&amp;:block)</code> method, which yield the <code>block</code> given and then return the object itself. In that case: <code>Dog.new(good_or_bad).tap(&amp;:walk_dog)</code>"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 3, "last_activity_date": 1501691214, "creation_date": 1501691214, "answer_id": 45466225, "question_id": 45466167, "link": "https://stackoverflow.com/questions/45466167/why-is-ruby-returning-true-for-method-call/45466225#45466225", "title": "Why is ruby returning `true` for method call?", "body": "<p>That's because the <code>create_and_walk_dog</code> returns that the <code>walk_dog</code> method returns</p>\n\n<p>To return a dog from the <code>create_and_walk_dog</code> method you'll need something like</p>\n\n<pre><code>describe Dog do\n   def create_and_walk_dog(good_or_bad)\n      dog = Dog.new(good_or_bad)\n      dog.walk_dog\n      dog\n   end\n\n   it 'should be able to create and walk a good dog' do\n      dog = create_and_walk_dog(true)\n\n      expect(dog.good_dog).to be true\n      expect(dog.has_been_walked).to be true\n   end\nend\n</code></pre>\n\n<p>Or extend the expectation block:</p>\n\n<pre><code>describe Dog do\n   it 'should be able to create and walk a good dog' do\n      dog = Dog.new(true)\n\n      expect(dog.good_dog).to be true\n      expect {\n        dog.walk_dog\n      }.to change(dog, :has_been_walked).from(false).to true\n   end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 434, "user_id": 337928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4da9ad2bd4a2d1ce3c428e32c423588a?s=128&d=identicon&r=PG", "display_name": "Michael Deering", "link": "https://stackoverflow.com/users/337928/michael-deering"}, "is_accepted": false, "score": 0, "last_activity_date": 1501711220, "creation_date": 1501711220, "answer_id": 45471722, "question_id": 45466167, "link": "https://stackoverflow.com/questions/45466167/why-is-ruby-returning-true-for-method-call/45471722#45471722", "title": "Why is ruby returning `true` for method call?", "body": "<p>I think for clarity you could/should be using the RSpec <a href=\"https://relishapp.com/rspec/rspec-core/v/3-6/docs/helper-methods/let-and-let\" rel=\"nofollow noreferrer\"><em>let</em></a> method here not a full method definition included in your RSpec file.  Having your _walk_dog_ method return self like suggested on another answer I see here fixes your current RSpec implementation but does not help your flow anywhere else in your potential application. Hypothetical case where <em>bad</em> dogs return <em>false</em> for _dog.walk_dog_ randomly 50% of the time or just not cooperate at all.</p>\n\n<pre><code>class Dog\n  attr_reader :good_dog, :has_been_walked\n\n  def initialize(good_or_not)\n    @good_dog = good_or_not\n    @has_been_walked = false\n  end\n\n  # Command to attempt walking a dog.\n  # \n  # @api public\n  # \n  # @example\n  #   good_dog = Dog.new(true)\n  #   good_dog.walk_dog # =&gt; Will always return true for good dogs.\n  #   bad_dog = Dog.new(false)\n  #   bad_dog.wal_dog # =&gt; 50/50 chance of true or false\n  def walk_dog\n    return @has_been_walked = true if @good_dog\n    [true, false].sample\n  end\nend\n\ndescribe Dog do\n\n  let(:good_dog) { Dog.new(true) }\n\n  it 'should always be able to walk a good dog' do\n    expect(good_dog.walk_dog).to be true\n  end\n\n  it 'should track if the dog has been walked' do\n    expect {\n      good_dog.walk_dog\n    }.to change(dog, :has_been_walked).from(false).to true\n  end\n\nend\n</code></pre>\n\n<p>Up for debate also but you should only be asserting a single thing per spec also unless you are hitting the db or doing something relatively time consuming.</p>\n\n<p>P.S. They are all good dogs Brent</p>\n"}], "owner": {"reputation": 71, "user_id": 6410696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a549ccb37c657faec7901edf2421d9?s=128&d=identicon&r=PG", "display_name": "siderio2", "link": "https://stackoverflow.com/users/6410696/siderio2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1501711486, "creation_date": 1501691033, "last_edit_date": 1501711486, "question_id": 45466167, "link": "https://stackoverflow.com/questions/45466167/why-is-ruby-returning-true-for-method-call", "title": "Why is ruby returning `true` for method call?", "body": "<p>So this is a brief tutorial I found abouot Rspec: <a href=\"http://www.w3ii.com/en-US/rspec/rspec_helpers.html\" rel=\"nofollow noreferrer\">w3ii.com: rspec</a> on it's explanation about rspec helpers. This is the code for the example:</p>\n\n<pre><code>class Dog\n   attr_reader :good_dog, :has_been_walked\n\n   def initialize(good_or_not)\n      @good_dog = good_or_not\n      @has_been_walked = false\n   end\n\n   def walk_dog\n      @has_been_walked = true\n   end\nend\n\ndescribe Dog do\n   def create_and_walk_dog(good_or_bad)\n      Dog.new(good_or_bad).walk_dog\n   end\n\n   it 'should be able to create and walk a good dog' do\n      dog = create_and_walk_dog(true)\n\n      expect(dog.good_dog).to be true\n      expect(dog.has_been_walked).to be true\n   end\nend\n</code></pre>\n\n<p>When I run this, I get this error:</p>\n\n<blockquote>\n  <p>NoMethodError:   undefined method 'good_dog' for true:TrueClass<br>\n  # ./dor.rb:22:in 'block &lt;2 levels> in >'</p>\n</blockquote>\n\n<p>I can't understand how a call to Dog.new() returns a true:TrueClass object instead of a simple dog.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "kaminari"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501694987, "post_id": 45466070, "comment_id": 77895545, "body": "does <code>@collection</code> contain duplicates also? (before using the Kaminari paginate method)"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1501697076, "post_id": 45466070, "comment_id": 77896815, "body": "No - I wasn&#39;t supplying params to the link_to - changing that fixed it - thanks for your time"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501690727, "creation_date": 1501690727, "question_id": 45466070, "link": "https://stackoverflow.com/questions/45466070/rails-kaminari-paginate-array-returns-duplicate-records", "title": "Rails - Kaminari - paginate_array returns duplicate records", "body": "<p>I'm trying to paginate the following array. At the moment the table is being appended to, but only with the same records as the first page:</p>\n\n<pre><code>def collection\n  @collection ||= begin\n    viewable_pupils.where(level: level, group_id: group_id).ordered\n      .map{ |p| Schools::Admin::PupilReportTableFacade.new(p, school.calendar_range_for_year_starting(report_start_year)) }\n  end\n  @collection = Kaminari.paginate_array(@collection).page(params[:page]).per(10)\nend\nhelper_method :collection\n</code></pre>\n\n<p>My view is as follows:</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;%= render 'schools/admin/reporting/collection_partial' %&gt;\n&lt;/div&gt;\n&lt;%= link_to 'Load More', school_reporting_load_more_path, remote: true, id: \"load_more_link\", class: 'btn btn-info' %&gt;\n</code></pre>\n\n<p>And the partial being rendered:</p>\n\n<pre><code>&lt;% collection.each do |pupil| %&gt;\n  &lt;div class=\"well well--bordered well--skinny well--collapse-pad well--shadow\"&gt;\n    &lt;div class=\"marking-header marking-header--table marking-header--table-even\"&gt;\n      &lt;div class=\"marking-header__cell\"&gt;\n        &lt;%= pupil.first_name %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"marking-header__cell\"&gt;&lt;%= pupil.last_name %&gt;&lt;/div&gt;\n      &lt;div class=\"marking-header__cell\" align=\"center\"&gt;\n        &lt;% pupil.histories.each do |history| %&gt;\n          &lt;% next unless school.calendar_range_for_year_starting(report_start_year).cover?(history[:created_at]) %&gt;\n          &lt;%= history[:year] %&gt;   &lt;%= history[:level] %&gt;\n          &lt;%= history[:created_at] %&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"marking-header__cell\"&gt;\n        &lt;%= \"Total completed: #{pupil.pupil.activities_completed_year_starting(report_start_year)}\" %&gt;&lt;/br&gt;\n        &lt;%= \"(#{pupil.pupil.comprehensions_completed_year_starting(report_start_year)} x comprehensions)\" unless pupil.pupil.comprehensions_completed_year_starting(report_start_year).zero? %&gt;&lt;/br&gt;\n        &lt;%= \"(#{pupil.pupil.crosswords_completed_year_starting(report_start_year)} x crosswords)\" unless pupil.pupil.crosswords_completed_year_starting(report_start_year).zero? %&gt;&lt;/br&gt;\n        &lt;%= \"(#{pupil.pupil.debates_completed_year_starting(report_start_year)} x debates\" unless pupil.pupil.debates_completed_year_starting(report_start_year).zero? %&gt;&lt;/br&gt;\n        &lt;%= \"(#{pupil.pupil.word_definitions_completed_year_starting(report_start_year)} x word definitions\" unless pupil.pupil.word_definitions_completed_year_starting(report_start_year).zero? %&gt;\n        &lt;div class=\"gems\"&gt;\n          &lt;% pupil.milestone_badges.each do |badge| %&gt;\n            &lt;%= image_tag image_path(badge.image), class: 'gem' %&gt;\n          &lt;% end %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=\"marking-header__cell\"&gt;\n        &lt;input type=\"checkbox\" name=\"pupils[]\" value=\"&lt;%= pupil.id %&gt;\" class=\"tick-check\" id=\"check-&lt;%= pupil.id %&gt;\" data-behaviour=\"update-compare-count\"&gt;\n        &lt;label for=\"check-&lt;%= pupil.id %&gt;\"&gt;&lt;/label&gt;\n        &lt;%= \"Total this year: #{pupil.pupil.total_points_this_year}\" %&gt;&lt;/br&gt;\n        &lt;%= \"(Total all time: #{pupil.pupil.total_points})\" %&gt;&lt;/br&gt;&lt;/br&gt;\n        &lt;%= \"iHub points: #{pupil.pupil.score}\" %&gt;&lt;/br&gt;\n        &lt;%= \"Teacher Points: #{pupil.pupil.total_points_year_starting(report_start_year)}\" %&gt;&lt;/br&gt;\n        &lt;%= \"Words Read: #{pupil.pupil.words_read_year_starting(report_start_year)}\" %&gt;&lt;/br&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Finally my ajax:</p>\n\n<pre><code>$('.container').append(\"&lt;%= escape_javascript(render 'schools/admin/reporting/collection_partial')%&gt;\");\n$('#load_more_link').replaceWith(\"&lt;%= escape_javascript(link_to 'Load More', school_reporting_load_more_path, remote: true, id: \"load_more_link\", class: 'btn btn-info')%&gt;\");\n</code></pre>\n\n<p>If any more info is needed please ask, I feel I've tried everything I can think of at this point.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501691841, "post_id": 45465884, "comment_id": 77893632, "body": "Your code won\u2019t even be parsed properly."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 7611946, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1bce27b07508f070768a12300c7addf5?s=128&d=identicon&r=PG&f=1", "display_name": "Archie123", "link": "https://stackoverflow.com/users/7611946/archie123"}, "edited": false, "score": 0, "creation_date": 1501693072, "post_id": 45466636, "comment_id": 77894397, "body": "Thanks! I would also like to how to do it using the begin and rescue statement."}, {"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "reply_to_user": {"reputation": 105, "user_id": 7611946, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1bce27b07508f070768a12300c7addf5?s=128&d=identicon&r=PG&f=1", "display_name": "Archie123", "link": "https://stackoverflow.com/users/7611946/archie123"}, "edited": false, "score": 0, "creation_date": 1501697724, "post_id": 45466636, "comment_id": 77897218, "body": "I would argue that this approach is more thorough than trying to rescue the exception in your controller. <code>rescue</code> without a specific exception catches all <code>StandardError</code>s, not necessarily just the the one you are intending it to catch. In any case, in order to know how to capture the exception correctly, we would need to know how <code>SheetEntry.import</code> is defined"}, {"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "reply_to_user": {"reputation": 105, "user_id": 7611946, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1bce27b07508f070768a12300c7addf5?s=128&d=identicon&r=PG&f=1", "display_name": "Archie123", "link": "https://stackoverflow.com/users/7611946/archie123"}, "edited": false, "score": 0, "creation_date": 1501697878, "post_id": 45466636, "comment_id": 77897307, "body": "Also there is a lengthy discussion here if you are interested in knowing why using exceptions to control flow is bad practice: <a href=\"https://softwareengineering.stackexchange.com/questions/189222/are-exceptions-as-control-flow-considered-a-serious-antipattern-if-so-why\" title=\"are exceptions as control flow considered a serious antipattern if so why\">softwareengineering.stackexchange.com/questions/189222/&hellip;</a> or <a href=\"https://softwareengineering.stackexchange.com/a/107727/279615\">softwareengineering.stackexchange.com/a/107727/279615</a>"}], "tags": [], "owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "is_accepted": true, "score": 1, "last_activity_date": 1501692867, "last_edit_date": 1501692867, "creation_date": 1501692467, "answer_id": 45466636, "question_id": 45465884, "link": "https://stackoverflow.com/questions/45465884/checking-if-the-uploaded-file-is-csv/45466636#45466636", "title": "Checking if the uploaded file is csv", "body": "<p>One approach would be to use <a href=\"https://github.com/thoughtbot/paperclip\" rel=\"nofollow noreferrer\">Paperclip</a> to handle file uploads. In general using exceptions to control flow is considered bad practice. With paperclip you can enforce a validation for the file's content-type up front in your Model rather than relying on <code>SheetEntry.import()</code> to raise an exception.</p>\n\n<pre><code>class SheetEntry &lt; ActiveRecord::Base\n  has_attached_filed :csv\n  validates_attachment :csv, content_type: { content_type: ['text/csv','text/plain']} # 'csv' files may have text/plain as a content-type.\n  # ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "is_accepted": false, "score": 1, "last_activity_date": 1501701645, "creation_date": 1501701645, "answer_id": 45469305, "question_id": 45465884, "link": "https://stackoverflow.com/questions/45465884/checking-if-the-uploaded-file-is-csv/45469305#45469305", "title": "Checking if the uploaded file is csv", "body": "<p>You can check the file mine type </p>\n\n<pre><code>class SheetEntriesController &lt; EntryController\n  def create\n    puts MIME::Types.type_for(file_path).first.content_type # \"text/csv\"\n    if MIME::Types.type_for(file_path).first.content_type == 'text/csv'\n      ...\n    end\n  end\nend\n</code></pre>\n\n<p>I hope that this helps</p>\n"}], "owner": {"reputation": 105, "user_id": 7611946, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1bce27b07508f070768a12300c7addf5?s=128&d=identicon&r=PG&f=1", "display_name": "Archie123", "link": "https://stackoverflow.com/users/7611946/archie123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 0, "accepted_answer_id": 45466636, "answer_count": 2, "score": 0, "last_activity_date": 1501701645, "creation_date": 1501690110, "last_edit_date": 1501701298, "question_id": 45465884, "link": "https://stackoverflow.com/questions/45465884/checking-if-the-uploaded-file-is-csv", "title": "Checking if the uploaded file is csv", "body": "<p>I have this method called import file which I am trying to upload a CSV. I want to check that the uploaded file in csv format. I did do the \n   <strong>&lt;%= file_field_tag :upload_entries, accept:'.csv' %></strong> but that didn't work so I am trying to write this begin and and rescue block in the controller \nand not able to rescue the error when some other format of the file is uploaded . I get this error \"\n<strong>ArgumentError in SheetEntriesController#import\n\"</strong> when I upload .jpg or .xls file Can someone help me with it?</p>\n\n<pre><code>require \"csv\"\n  class SheetEntriesInvalid &lt; Exception\nend\n\nclass SheetEntriesController &lt; EntryController\n\n  unloadable\n\n  def import\n    if (params[:upload_entries]).present?\n      begin\n        SheetEntry.import(params[:upload_entries].path)\n        redirect_to root_url, notice: \"Updated Succesfully\"\n      rescue \n        redirect_to root_url, notice: \"Invalid CSV file format.\"\n      end\n    end\n  else\n    redirect_to root_url, error: \"No File Chosen\"\n  end \n  end\nend\n</code></pre>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "activeadmin"], "answers": [{"comments": [{"owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "edited": false, "score": 1, "creation_date": 1501691836, "post_id": 45465992, "comment_id": 77893629, "body": "Thank you so much @DiegoSalazar, I previously accidentally sent an unfinished question :). Now I have added Active admin model, Controller for products, and views.  It would be so nice of you could take your answer further."}, {"owner": {"reputation": 767, "user_id": 6893534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/udUvu.jpg?s=128&g=1", "display_name": "Slowboy", "link": "https://stackoverflow.com/users/6893534/slowboy"}, "reply_to_user": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "edited": false, "score": 1, "creation_date": 1501694089, "post_id": 45465992, "comment_id": 77895065, "body": "I can&#39;t wait to see if @DiegoSalazar will take his answer further since you provided all missing files @DaudiHell.  I&#39;ve had similar issues with `paperclip&#180;"}, {"owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "edited": false, "score": 0, "creation_date": 1501696237, "post_id": 45465992, "comment_id": 77896283, "body": "I totally understand that you don&#39;t want to write this for me, and I wouldn&#39;t want that either, I can&#39;t see how I would learn from that :)  I&#39;ve made the <code>image.rb</code> model and added the <code>has_many</code> and <code>belongs_to</code> relations to both models. Thing I&#39;m not sure of at the moment is how the product_controller.rb would look since I added all the image logic to a new model, the <code>image.rb</code>model.  Do I have to create I new controller for the image.rb model?"}, {"owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "edited": false, "score": 0, "creation_date": 1501697092, "post_id": 45465992, "comment_id": 77896824, "body": "please see ANOTHER UPDATE in the question"}, {"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 0, "creation_date": 1501697325, "post_id": 45465992, "comment_id": 77896968, "body": "You wouldn&#39;t have to change much of your controller except for the strong parameters to allow the new nested fields. And add the <code>accepts_nested_attributes_for :images</code> declaration to your <code>Product</code> model. You can read all about that in the <a href=\"http://guides.rubyonrails.org/form_helpers.html#nested-forms\" rel=\"nofollow noreferrer\">Rails nested forms</a> documentation I linked to above."}], "tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": true, "score": 3, "last_activity_date": 1501695075, "last_edit_date": 1501695075, "creation_date": 1501690490, "answer_id": 45465992, "question_id": 45465680, "link": "https://stackoverflow.com/questions/45465680/uploading-more-than-one-image-using-paperclip-and-active-admin/45465992#45465992", "title": "Uploading more than one image using paperclip and active admin", "body": "<p>That model, as you have it, can only hold one file upload in its <code>image</code> attribute. You need to add a <code>has_many</code> association to your product so that it can have many files.</p>\n\n<p>i.e. create an Image model that will hold the attachment and be associated to the product:</p>\n\n<pre><code>rails g model Image product_id:integer image_file_name:string image_file_size:integer image_content_type:string\nrake db:migrate\n</code></pre>\n\n<p>Then associate the product to it:</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  has_many :images\n  # ... the rest of your code...\nend\n</code></pre>\n\n<p>And move the attached file declaration to your Image model:</p>\n\n<pre><code>class Image &lt; ActiveRecord::Base\n  belongs_to :product\n\n  has_attached_file :image, styles: { medium: \"500x500#\", thumb: \"100x100#\" }\n  validates_attachment_content_type :image, content_type: /\\Aimage\\/.*\\z/\nend\n</code></pre>\n\n<p>Now you have a way of associating many images with one product:</p>\n\n<pre><code>product = Product.new\nproduct.images.build image: File.open('some/image/for/example.jpg', ?r)\nproduct.save\nproduct.images.first.image # the Paperclip::Attachment object\n</code></pre>\n\n<p>I can only take you this far since you didn't post any controller, view code, or active_admin setup but, you just need to <a href=\"http://guides.rubyonrails.org/form_helpers.html#nested-forms\" rel=\"nofollow noreferrer\">read rails</a> or <a href=\"https://activeadmin.info/5-forms.html#nested-resources\" rel=\"nofollow noreferrer\">active_admin documentation on nested resources</a> so that you can figure out how to write a nested form that lets you create these images for your Product.</p>\n\n<p><strong>Update</strong>: If by \"taking this answer further\" you mean \"write the code for you\" Then, no. There is enough information here and in the <a href=\"https://activeadmin.info/5-forms.html#nested-resources\" rel=\"nofollow noreferrer\">active_admin documentation on nested resources</a> for you to figure it out. I can however, provide clarifications if any of this is confusing. </p>\n"}], "owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 1, "accepted_answer_id": 45465992, "answer_count": 1, "score": 1, "last_activity_date": 1501715895, "creation_date": 1501689509, "last_edit_date": 1501715895, "question_id": 45465680, "link": "https://stackoverflow.com/questions/45465680/uploading-more-than-one-image-using-paperclip-and-active-admin", "title": "Uploading more than one image using paperclip and active admin", "body": "<p>I need to upload more than one image to products in a app I'm building.\nThe Images are uploaded via <code>ActiveAdmin</code> with <code>paperclip</code> </p>\n\n<p>There is no problem uploading one image, but multiple images is not working.</p>\n\n<p>I've tried to use the <code>jquery-fileupload-rails</code>gem  and it is supposed to wire into <code>active admin</code>, but with out a luck.</p>\n\n<p>I have also searched the web for this and checked out many posts on Stack Overflow, but I haven't found a solution yet.</p>\n\n<p>Here is the product model <code>product.rb</code></p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  acts_as_list :scope =&gt; [:category, :label]\n  belongs_to :category\n  belongs_to :label\n\n  has_many :product_items, :dependent =&gt; :destroy\n\n    validates :title, :description, presence: true\n    validates :price_usd, :price_eur, numericality: {greater_than_or_equal_to: 0.01}\n    validates :title, uniqueness: true\n\n\n has_attached_file :image, styles: { medium: \"500x500#\", thumb: \"100x100#\" }\n validates_attachment_content_type :image, content_type: /\\Aimage\\/.*\\z/\n\nend\n</code></pre>\n\n<p><strong>THIRD UPDATE</strong></p>\n\n<p>Ok I added this <code>images_attributes:</code> snipped below to the <code>products_controller.rb</code> in the end of the <code>def product_params</code></p>\n\n<pre><code>def product_params\n      params.require(:product).permit(:title, :description,...., images_attributes: [:image , :id , :_destroy])\nend\n</code></pre>\n\n<p>And to the <code>admin/product.rb</code> I added</p>\n\n<pre><code>            f.has_many :images , heading: false, allow_destroy: true do |ff|\n            ff.input :image, required: true, as: :file\n             end\n</code></pre>\n\n<p>Now I can select images via active admin, but it don't get saved to the database.</p>\n\n<p><strong>ANOTHER UPDATE</strong></p>\n\n<p>Here is the <code>app/views/pages/index.html.erb</code> </p>\n\n<p>In that snippet located on the index page the latest upload in each category is shown. See how the app loops through products and shows the corresponding image to each product.  Now I'm getting error from this line <code>&lt;%= image_tag product.image.url(:medium), class: \"img-responsive\" %&gt;</code> in the index file.</p>\n\n<pre><code>&lt;div class=\"container-fluid\"&gt;\n\n    &lt;% @products.each_slice(3) do |products_group| %&gt;\n            &lt;div class=\"row\"&gt;\n              &lt;% products_group.each do |category, products| %&gt;\n\n                    &lt;% products.each_with_index do |product, index| %&gt;\n                        &lt;% if index == 0 %&gt;\n                            &lt;div class=\"col-lg-4 col-sm-6 col-xs-12 center-block \" &gt;\n\n                            &lt;%= link_to category_path (category), { :method =&gt; 'GET' } do %&gt;\n                                &lt;%= image_tag product.image.url(:medium), class: \"img-responsive\" %&gt;\n                            &lt;% end %&gt;\n                    &lt;div class=\"caption\"&gt;\n                        &lt;p class=\"category-name\" &gt;&lt;%= product.category.name %&gt;&lt;/p&gt;\n                     &lt;/div&gt; \n                    &lt;% end %&gt;\n                    &lt;% end %&gt;\n                    &lt;/div&gt; \n                &lt;% end %&gt;\n                &lt;/div&gt;\n            &lt;% end %&gt;\n\n    &lt;/div&gt;\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<pre><code>here is the `products_controller.rb`\n\nclass ProductsController &lt; ApplicationController\nbefore_action :set_product, only: [:show, :edit, :update, :destroy]\n\n  def show\n   offset = rand(100)\n   @products_rand = Product.where(category_id: \n   @product.category_id).order(\"RANDOM()\").limit(6)\n  end\n\nprivate\n# Use callbacks to share common setup or constraints between actions.\ndef set_product\n  @product = Product.find(params[:id])\nend\n\n# Never trust parameters from the scary internet, only allow the white list through.\ndef product_params\n  params.require(:product).permit(:title, :description, :price_usd, :price_eur, :image, :category_id, :stock_quantity, :label_id, :query, :slug)\nend \nend\n</code></pre>\n\n<p>And this is the Active admin product model <code>admin/product.rb</code></p>\n\n<pre><code>    ActiveAdmin.register Product do\n\n  config.sort_order = 'position_asc' # assumes you are using 'position' for your acts_as_list column\n  config.paginate   = true # optional; drag-and-drop across pages is not supported\n\n  sortable # creates the controller action which handles the sorting\n\npermit_params :title, :slug, :description, :stock_quantity, :image, :price_usd, :price_eur, :category_id, :label_id,  images_attributes: [:image , :id , :_destroy]\n\n    index do\n         sortable_handle_column # inserts a drag handle\n        column :title\n        column :slug\n        column :category\n        column :label\n        column :created_at\n        column :stock_quantity\n\n        column :price_eur, :sortable =&gt; :price_eur do |product|\n            number_to_currency(product.price_eur, :unit =&gt; \"\u20ac \" , :precision =&gt; 0) \n        end\n        column :price_euro, :sortable =&gt; :price_usd do |product|\n            number_to_currency(product.price_usd, :unit =&gt; \"$ \" , :precision =&gt; 0)\n        end\n\n        actions \n\n    end\n\n    form multipart: true do |f|\n            f.inputs \"Product Details\" do\n            f.input :title\n            f.input :slug\n            f.input :description, as: :ckeditor, input_html: { ckeditor: { toolbar: 'Full' } }\n            f.input :stock_quantity\n            f.input :image, required: false\n            f.input :price_usd\n            f.input :price_isl\n            f.input :category\n            f.input :label\n            end\n            f.actions   \n          end\n\nend\n</code></pre>\n\n<p>And finally here is the product view, `app/views/products/show.html.erb``</p>\n\n<pre><code>    &lt;div class=\"container\"&gt;  \n     &lt;div class=\"row product_top text-center\"&gt;\n      &lt;div class=\"col-xs-12 col-sm-6 center-block\"&gt;\n       &lt;div class=\"product_description\"&gt;\n\n        &lt;h3 class=\"title\"&gt;&lt;%= @product.title %&gt;&lt;/h3&gt;\n        &lt;p class=\"label-product\"&gt;&lt;%= @product.label.name %&gt;&lt;/p&gt;\n\n        &lt;p class=\"description\"&gt;Description&lt;/p&gt;\n\n        &lt;p class=\"product-description\"&gt;&lt;%= @product.description.html_safe %&gt;&lt;/p&gt;\n\n            &lt;% if @product.stock_quantity &lt;= 0 %&gt;\n               &lt;p&gt; Out of stock &lt;/p&gt; \n            &lt;% end %&gt;\n     &lt;/div&gt;\n        &lt;div class=\"col-xs-12\"&gt;\n         &lt;p class=\"product-price\"&gt; Price:&lt;/p&gt; &lt;%= number_to_currency(@product.price_usd, :unit =&gt; \"\u20ac \" , :precision =&gt; 0) %&gt; | &lt;%= number_to_currency(@product.price_isl.to_i, :unit =&gt; \"IKR \" , :precision =&gt; 0) %&gt;\n        &lt;/div&gt;\n\n       &lt;%# if @product.stock_quantity &gt;= 1 %&gt;\n        &lt;div class=\"row text-center add-cart-wrapper\"&gt;  \n          &lt;% if @product.stock_quantity &gt;= 1 %&gt;\n          &lt;%= link_to 'Add to Cart', product_product_items_path(@product), :method =&gt; :post, class: 'add-to-cart'%&gt;\n         &lt;% end %&gt;\n       &lt;/div&gt;\n    &lt;/div&gt;  \n   &lt;div class=\"col-xs-12 col-sm-6 center-block\" &gt; \n    &lt;%= image_tag @product.image.url(:medium), class: \"img-responsive center-block\"  %&gt;\n\n  &lt;/div&gt;\n  &lt;/div&gt;  \n\n  &lt;div class=\"row product-teaser\"&gt;\n\n  &lt;h4 class=\"text-center teaser-text\"&gt; similar products to &lt;%= @product.title %&gt; : &lt;/h4&gt;\n   &lt;% @products_rand.each do |product| %&gt;\n      &lt;div class=\"col-sm-2 col-xs-3 center-block product-thumbs-product-view\" &gt;\n\n  &lt;%= link_to product_path (product) do %&gt;\n                &lt;%= image_tag product.image.url, :size =&gt; \"100%x100%\", class: \"img-responsive center-block\" %&gt;\n            &lt;% end %&gt;\n\n          &lt;h5 class=\"text-center\"&gt;&lt;%= link_to product.title, product, class: \"text-center\" %&gt;&lt;/h5&gt;\n\n      &lt;/div&gt;\n    &lt;% end %&gt;\n\n  &lt;/div&gt;\n\n   &lt;/div&gt;  \n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1501690367, "post_id": 45465657, "comment_id": 77892753, "body": "It is ruby parser who looks up the method when it sees parentheses, no matter casing (<code>_whatever()</code>) looks up constant when it sees a first capital and tries variable and then method with arity 0 when it sees a snake casing."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1501692388, "post_id": 45465657, "comment_id": 77893967, "body": "I wonder why the downvotes, this seems like an insightful and interesting question..."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1501693982, "post_id": 45465657, "comment_id": 77894998, "body": "Quite long-winded question. IMO you can delete everything up to the last example."}], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 4, "last_activity_date": 1501703298, "creation_date": 1501703298, "answer_id": 45469746, "question_id": 45465657, "link": "https://stackoverflow.com/questions/45465657/kernelarray-how-does-ruby-interpret-methods-that-have-the-same-name-as-a-cons/45469746#45469746", "title": "Kernel#Array - How does Ruby interpret methods that have the same name as a constant?", "body": "<blockquote>\n  <p>How does Ruby interpret this? How does it distinguish between the method and the constant?</p>\n</blockquote>\n\n<p>The rules are pretty much the same as with local variables: Ruby will assume it is a constant unless it's obvious that it isn't: constants can't have arguments, and constants can't have receivers.</p>\n\n<pre><code>FOO      # constant\nself.FOO # message send\nFOO()    # message send\nFOO :bar # message send\n</code></pre>\n\n<blockquote>\n  <p>Given \"normal\" behavior, one might expect Ruby to complain with a name warning when you define the method, or raise a <code>SyntaxError</code>.</p>\n</blockquote>\n\n<p>Why? Defining a method is perfectly legal syntactically (after all, that's what OO is all about), and <code>Array</code> is a perfectly legal Ruby identifier.</p>\n"}], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 45469746, "answer_count": 1, "score": 1, "last_activity_date": 1501703298, "creation_date": 1501689452, "last_edit_date": 1501690131, "question_id": 45465657, "link": "https://stackoverflow.com/questions/45465657/kernelarray-how-does-ruby-interpret-methods-that-have-the-same-name-as-a-cons", "title": "Kernel#Array - How does Ruby interpret methods that have the same name as a constant?", "body": "<p>When I'm coding in Ruby, to avoid type checks and <code>respond_to?</code>s and <code>nil</code> checks I often coerce objects into the type I expect. If I expect an <code>Array</code>, instead of <code>foo.nil? ? handle_nil(foo) : handle_array(foo)</code> I prefer to just <code>handle_foo(foo.to_a)</code> since <code>nil.to_a # =&gt; []</code>.</p>\n\n<p>This doesn't work for everything, <code>1.to_a</code> raises <code>NoMethodError: undefined method 'to_a' for 1:Integer</code>. <code>1.to_ary</code> raises the same error. <code>Array()</code> seems to solve the problem, handling what seems like any object and either making a sensible conversion to an <code>Array</code> or wrapping it in <code>[]</code>.</p>\n\n<pre><code>Array(nil)        # =&gt; []\nArray('')         # =&gt; [\"\"]\nArray(Class)      # =&gt; [Class] \nArray(1)          # =&gt; [1]\nArray(Object.new) # =&gt; [#&lt;Object:0x007fdbd40df4c8&gt;]\nArray({})         # =&gt; []\nArray(foo: :bar)  # =&gt; [[:foo, :bar]]\n</code></pre>\n\n<p>You can do the same thing with other classes too. <code>String()</code>, <code>Float()</code>... I'd used it a lot without thinking about the unusual syntax. I wanted to learn more about the implementation. Is it syntactic sugar for a special method, similar to <code>#[]</code>?</p>\n\n<p>Both of these raise a <code>SyntaxError</code></p>\n\n<pre><code>def self.(foo)\n  puts foo\nend\n\ndef self.()(foo)\n  puts foo\nend\n</code></pre>\n\n<p>You use <code>Array()</code> like you would use a method. Looking at the docs for <code>Kernel</code> it becomes clear that that's what's going on. The following works as you'd expect:</p>\n\n<pre><code>class Thing\n  attr_accessor :name\n\n  def initialize(name)\n    @name = name\n  end\nend\n\nmodule Kernel\n  def Thing(name)\n    Thing.new(name)\n  end\nend\n\nthing = Thing('name') # =&gt; #&lt;Thing:0x007fefef89d8e8 @name=\"name\"&gt;\nthing.name # =&gt; \"name\"\n</code></pre>\n\n<p>You can also do this</p>\n\n<pre><code>HI = 'hi'.freeze\n\ndef HI(word)\n  word\nend\n\nHI       # =&gt; \"hi\"\nHI(\"ho\") # =&gt; \"ho\"\n</code></pre>\n\n<p>My question is: How does Ruby interpret this? How does it distinguish between the method and the constant? Is this a silly question? Given \"normal\" behavior, one might expect Ruby to complain with a name warning when you define the method, or raise a <code>SyntaxError</code>. Does anyone know how Ruby handles this under the hood?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501689506, "post_id": 45465607, "comment_id": 77892173, "body": "Can you, perhaps, provide a few code snippets with both types of behaviour (with links to github, of course)?"}, {"owner": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501696310, "post_id": 45465607, "comment_id": 77896326, "body": "eg. <a href=\"https://github.com/rails/rails/blob/cfb1e4dfd8813d3d5c75a15a750b3c53eebdea65/activesupport/lib/active_support/time_with_zone.rb\" rel=\"nofollow noreferrer\">ActiveSupport::TimeWithZone</a> calls super from respond_to? but also has <a href=\"https://github.com/rails/rails/blob/cfb1e4dfd8813d3d5c75a15a750b3c53eebdea65/activesupport/lib/active_support/time_with_zone.rb#L503\" rel=\"nofollow noreferrer\">respond_to_missing?</a> which does not.  <a href=\"https://github.com/rails/rails/blob/cfb1e4dfd8813d3d5c75a15a750b3c53eebdea65/activesupport/lib/active_support/string_inquirer.rb\" rel=\"nofollow noreferrer\">StringInquirer</a> is more typical."}, {"owner": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501697303, "post_id": 45465607, "comment_id": 77896950, "body": "A common pattern is calling respond_to? on a wrapped object and skipping super, eg. <a href=\"https://github.com/rails/rails/blob/cfb1e4dfd8813d3d5c75a15a750b3c53eebdea65/activesupport/lib/active_support/duration.rb#L365\" rel=\"nofollow noreferrer\">Duration#respond_to_missing?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "edited": false, "score": 0, "creation_date": 1501696528, "post_id": 45466201, "comment_id": 77896468, "body": "So you call super when you know a superclass also implements <code>respond_to_missing?</code>  Is it safe to call super if you are not sure?"}, {"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "reply_to_user": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "edited": false, "score": 0, "creation_date": 1501697148, "post_id": 45466201, "comment_id": 77896860, "body": "Yes it is safe if you&#39;re not sure because it will just bubble up to the <code>Object</code> class"}], "tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": false, "score": 1, "last_activity_date": 1501691138, "creation_date": 1501691138, "answer_id": 45466201, "question_id": 45465607, "link": "https://stackoverflow.com/questions/45465607/ruby-respond-to-missing-call-super-or-not/45466201#45466201", "title": "Ruby respond_to_missing? Call super or not?", "body": "<p><code>respond_to_missing?</code> appears in Ruby version 1.9.2 as a solution to the <code>method</code> method. Here's a blog post by a Ruby core committer about it: <a href=\"http://blog.marc-andre.ca/2010/11/15/methodmissing-politely/\" rel=\"nofollow noreferrer\">http://blog.marc-andre.ca/2010/11/15/methodmissing-politely/</a></p>\n\n<p>The reason for calling <code>super</code> however, is so that in the event your logic returns false, the call will bubble up the class hierarchy to <code>Object</code> which returns <code>false</code>. If your class is a subclass to a class that implements <code>respond_to_missing?</code> then you would want to call super in the event your logic returns false. This is generally an issue for library code and not so much for application code.</p>\n"}, {"comments": [{"owner": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "edited": false, "score": 0, "creation_date": 1501700915, "post_id": 45468976, "comment_id": 77899112, "body": "Agreed.  Is the omission of <code>|| super</code> at the end of respond_to_missing? an oversight or a deliberate design decision?"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "edited": false, "score": 1, "creation_date": 1501701208, "post_id": 45468976, "comment_id": 77899265, "body": "@PiersC To me it looks like a deliberate design decision. They want it to return whatever <code>Time</code> would return. Same as how there is no <code>super</code> in <code>method_missing</code>, they just let <code>Time</code> figure out how to handle it. The consistent pattern in the class is that it is trying to trick the caller into thinking it is an instance of <code>Time</code>. As if the class is monkey patched without actually being altered at all."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "edited": false, "score": 0, "creation_date": 1501701542, "post_id": 45468976, "comment_id": 77899421, "body": "@PiersC looking at your other example, <code>StringInquirer</code>, both <code>method_missing</code> and <code>respond_to_missing?</code> call <code>super</code>, and under the same conditions e.g. if <code>method_name[-1] != &quot;?&quot;</code>. It seems like a reasonable rule of thumb that in most cases <code>respond_to_missing?</code> should mirror <code>method_missing</code>."}], "tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": true, "score": 3, "last_activity_date": 1501700372, "creation_date": 1501700372, "answer_id": 45468976, "question_id": 45465607, "link": "https://stackoverflow.com/questions/45465607/ruby-respond-to-missing-call-super-or-not/45468976#45468976", "title": "Ruby respond_to_missing? Call super or not?", "body": "<p>It depends on the implementation of the class and the behavior you want out of <code>#respond_to_missing?</code>. Looking at <code>ActiveSupport::TimeWithZone</code>, it is a proxy wrapper for <code>Time</code>. It tries to mimic it, fooling you into thinking it is an instance of <code>Time</code>. <code>TimeWithZone#is_a?</code> would respond <code>true</code> when passed <code>Time</code>, for example. </p>\n\n<pre><code># Say we're a Time to thwart type checking.\ndef is_a?(klass)\n  klass == ::Time || super\nend\nalias_method :kind_of?, :is_a?\n</code></pre>\n\n<p><code>respond_to_missing?</code> should catch cases that would be caught by <code>method_missing</code>, so you have to look at both methods. <code>TimeWithZone#method_missing</code> delegates missing methods to <code>Time</code> instead of <code>super</code>.</p>\n\n<pre><code>def method_missing(sym, *args, &amp;block)\n  wrap_with_time_zone time.__send__(sym, *args, &amp;block)\nrescue NoMethodError =&gt; e\n  raise e, e.message.sub(time.inspect, inspect), e.backtrace\nend\n</code></pre>\n\n<p>So it makes sense that it would delegate <code>respond_to_missing?</code> to <code>Time</code> as well.</p>\n\n<pre><code># Ensure proxy class responds to all methods that underlying time instance\n# responds to.\ndef respond_to_missing?(sym, include_priv)\n  return false if sym.to_sym == :acts_like_date?\n  time.respond_to?(sym, include_priv)\nend\n</code></pre>\n"}], "owner": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 45468976, "answer_count": 2, "score": 3, "last_activity_date": 1501700372, "creation_date": 1501689312, "question_id": 45465607, "link": "https://stackoverflow.com/questions/45465607/ruby-respond-to-missing-call-super-or-not", "title": "Ruby respond_to_missing? Call super or not?", "body": "<p>Looking through the Rails codebase sometimes respond_to_missing? invokes super and sometimes not.  Are there cases where you should not invoke super from respond_to_missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3"], "comments": [{"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1501689708, "post_id": 45465477, "comment_id": 77892319, "body": "Usually, you are using a gem for file uploading/image processing like <code>Paperclip</code>, <code>CarrierWave</code> etc. And you are configuring them different, per environment: S3 storage for <code>staging</code>|<code>production</code> and local file storage for <code>test</code>|<code>development</code>"}, {"owner": {"reputation": 83, "user_id": 4756520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11b7a881b23761ce0482fd5779a86d1f?s=128&d=identicon&r=PG&f=1", "display_name": "MostXlent1", "link": "https://stackoverflow.com/users/4756520/mostxlent1"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1501690137, "post_id": 45465477, "comment_id": 77892607, "body": "Ah ok, that makes sense. Thanks for the response! I was planning on using a gem that utilizes direct upload, so I&#39;d just set different settings in the environment config. Cool! Do you know if people will typically use a free option for local dev by any chance?"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1501690523, "post_id": 45465477, "comment_id": 77892848, "body": "Didn&#39;t understand last question."}, {"owner": {"reputation": 83, "user_id": 4756520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11b7a881b23761ce0482fd5779a86d1f?s=128&d=identicon&r=PG&f=1", "display_name": "MostXlent1", "link": "https://stackoverflow.com/users/4756520/mostxlent1"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1501691305, "post_id": 45465477, "comment_id": 77893300, "body": "Sorry Pavel, thanks for your patience. While still in development on a local machine, do developers still use and pay for a service like S3 to host images? Or do they use a free solution, and only pay for S3 in the production environment?"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1501740939, "post_id": 45465477, "comment_id": 77912784, "body": "Don&#39;t know about the others, I&#39;m using S3 in dev too. The most of S3 charge is for requests, so storage itself is very cheap."}, {"owner": {"reputation": 83, "user_id": 4756520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11b7a881b23761ce0482fd5779a86d1f?s=128&d=identicon&r=PG&f=1", "display_name": "MostXlent1", "link": "https://stackoverflow.com/users/4756520/mostxlent1"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1501780932, "post_id": 45465477, "comment_id": 77942908, "body": "Good to know, thank you very much. I researched it a bit more and you&#39;re right, we&#39;re talking pennies rather than dollars. I think my boss will be cool with that. Thanks for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4756520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11b7a881b23761ce0482fd5779a86d1f?s=128&d=identicon&r=PG&f=1", "display_name": "MostXlent1", "link": "https://stackoverflow.com/users/4756520/mostxlent1"}, "edited": false, "score": 0, "creation_date": 1501702175, "post_id": 45466789, "comment_id": 77899764, "body": "Thanks for the example Alex! That&#39;s interesting that you use it for dev too, I&#39;ll have to look at the costs more closely."}], "tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": true, "score": 0, "last_activity_date": 1501692962, "creation_date": 1501692962, "answer_id": 45466789, "question_id": 45465477, "link": "https://stackoverflow.com/questions/45465477/how-is-image-storage-typically-handled-during-local-development-in-rails/45466789#45466789", "title": "How is image storage typically handled during local development in Rails?", "body": "<p>For the development environment, you can use the file system for storage and S3 for production. Below CarrierWave config to implement this.</p>\n\n<pre><code># config/initializers/carrierwave.rb\n\nCarrierWave.configure do |config|\n  if Rails.env.test? ||  Rails.env.development?\n    config.storage = :file\n  else\n    config.storage = :fog\n  end\n\n  # Configuration for Amazon S3 should be made available through an Environment variable.\n  config.fog_credentials = {\n    provider:              'AWS',\n    aws_access_key_id:     ENV['AWS_ACCESS_KEY_ID'],\n    aws_secret_access_key: ENV['AWS_SECRET_ACCESS_KEY'],\n    region:                ENV['AWS_S3_REGION']\n  }\n\n  config.fog_directory  = ENV['AWS_S3_BUCKET_NAME']\n  config.fog_public     = true  \nend\n</code></pre>\n\n<p>Really I'm using S3 for development too because its very low cost. Too sometimes needs to use specific methods of S3 storage, like file privacy.</p>\n"}], "owner": {"reputation": 83, "user_id": 4756520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11b7a881b23761ce0482fd5779a86d1f?s=128&d=identicon&r=PG&f=1", "display_name": "MostXlent1", "link": "https://stackoverflow.com/users/4756520/mostxlent1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 45466789, "answer_count": 1, "score": 0, "last_activity_date": 1501692962, "creation_date": 1501688965, "question_id": 45465477, "link": "https://stackoverflow.com/questions/45465477/how-is-image-storage-typically-handled-during-local-development-in-rails", "title": "How is image storage typically handled during local development in Rails?", "body": "<p>I have recently started my first project in Rails(5), coming from a PHP/Wordpress background (so bear with me). I plan on hosting the production site on Heroku, and I know that people will typically use a service like S3 to host uploaded images.</p>\n\n<p>My question is: do you usually set up a connection to S3 while still in local development? I'm trying to keep costs low, so I'm wondering if there is another option while still in dev. And if there is another option, is it a huge hassle to switch over to S3 for production?</p>\n\n<p>I'm sorry if these questions are extremely stupid, I just cannot find information on this; maybe I'm wording my questions poorly. Any information would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch-model"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1501688366, "post_id": 45465025, "comment_id": 77891334, "body": "Have you tried calling <code>to_a</code> on the result?"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1501688403, "post_id": 45465025, "comment_id": 77891366, "body": "What happens when you do a <code>Entry.search_index(&#39;test&#39;).records.to_a</code>? This class contains &quot;PROXY&quot; in it, which suggests that this class is just a <i>proxy</i> for the records list."}, {"owner": {"reputation": 1016, "user_id": 4500083, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FfdBQ.gif?s=128&g=1", "display_name": "Mini", "link": "https://stackoverflow.com/users/4500083/mini"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501694519, "post_id": 45465025, "comment_id": 77895305, "body": "@MrYoshiji but still I don&#39;t undrestand why I need to convert it to array , records is an object from Elasticsearch::Model::Response::Records &lt; Object so it should be printable right ?"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1501694707, "post_id": 45465025, "comment_id": 77895407, "body": "It is printable, but the way you are printing it is asking the <b>proxy</b> to be printed, not the actual records. When you do a simple <code>User.where(true)</code> in the console, the output looks like an Array, but if you do <code>User.where(true).class</code>, you will see it is not an Array but an from the <b>proxy</b> class ActiveRecord::Relation."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1501694814, "post_id": 45465025, "comment_id": 77895471, "body": "in your byebug, I am pretty sure you can do <code>Entry.search_index(&#39;test&#39;).records.first</code> to return the first entry matching the conditions (if there is any)"}, {"owner": {"reputation": 1016, "user_id": 4500083, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FfdBQ.gif?s=128&g=1", "display_name": "Mini", "link": "https://stackoverflow.com/users/4500083/mini"}, "edited": false, "score": 0, "creation_date": 1501704623, "post_id": 45465025, "comment_id": 77901216, "body": "yes you are right"}], "answers": [{"tags": [], "owner": {"reputation": 373, "user_id": 11402804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ALDDn.jpg?s=128&g=1", "display_name": "Andriy Kondzolko", "link": "https://stackoverflow.com/users/11402804/andriy-kondzolko"}, "is_accepted": false, "score": 0, "last_activity_date": 1571942575, "last_edit_date": 1571942575, "creation_date": 1571940478, "answer_id": 58546960, "question_id": 45465025, "link": "https://stackoverflow.com/questions/45465025/search-by-elasticsearch-model-not-returns-the-records/58546960#58546960", "title": "search by elasticsearch-model not returns the records", "body": "<p>You should use to your </p>\n\n<blockquote>\n  <p>respond</p>\n</blockquote>\n\n<pre><code>records\n</code></pre>\n\n<p>Like Example</p>\n\n<pre><code>Foo.new().search('1234').response.records\n</code></pre>\n\n<p>It will return your Active record objects.</p>\n"}], "owner": {"reputation": 1016, "user_id": 4500083, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FfdBQ.gif?s=128&g=1", "display_name": "Mini", "link": "https://stackoverflow.com/users/4500083/mini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 489, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1571942575, "creation_date": 1501687708, "last_edit_date": 1501688079, "question_id": 45465025, "link": "https://stackoverflow.com/questions/45465025/search-by-elasticsearch-model-not-returns-the-records", "title": "search by elasticsearch-model not returns the records", "body": "<p>I'm using elasticsearch-model and I used concern approach and here is my search method.I have tried my query by curl it returns me back 5 entries but when I used this method </p>\n\n<pre><code>def search_index(*args)\n      self.__elasticsearch__.search(*args)\nend\n</code></pre>\n\n<p>it's returns me a class </p>\n\n<pre><code>(byebug) Entry.search_index('test').records\n#&lt;Elasticsearch::Model::Response::Records:0x007f8eb85ca280 @klass=[PROXY] Entry(id: integer, created_at: datetime, updated_at: datetime, source_id: integer, data: text, uuid: string, source_entry_id: string, bytesize: integer), @response=#&lt;Elasticsearch::Model::Response::Response:0x007f8eb85ca370 @klass=[PROXY] Entry(id: integer, created_at: datetime, updated_at: datetime, source_id: integer, data: text, uuid: string, source_entry_id: string, bytesize: integer), @search=#&lt;Elasticsearch::Model::Searching::SearchRequest:0x007f8eb85ca438 @klass=[PROXY] Entry(id: integer, created_at: datetime, updated_at: datetime, source_id: integer, data: text, uuid: string, source_entry_id: string, bytesize: integer), @options={}, @definition={:index=&gt;\"self_driving_entries\", :type=&gt;\"entry\", :q=&gt;\"test\"}&gt;, @records=#&lt;Elasticsearch::Model::Response::Records:0x007f8eb85ca280 ...&gt;&gt;, @options={}&gt;\n</code></pre>\n\n<p>how can I have access to my records by this search method ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1501688875, "post_id": 45464961, "comment_id": 77891727, "body": "What is the result of <code>which bundle</code>? Are you perhaps running the <i>system</i> bundle, not the rbenv <code>bundle</code>? In which case, you may need to <code>gem install bundler</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1501688920, "post_id": 45464961, "comment_id": 77891761, "body": "Also, I would suggest that you use <a href=\"https://www.ruby-lang.org/en/news/2017/03/30/ruby-2-3-4-released/\" rel=\"nofollow noreferrer\">ruby version 2.3.4</a>, not 2.3.3."}, {"owner": {"reputation": 152, "user_id": 3477024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b471f3e07d29b0ec3a74bd35a3470fdb?s=128&d=identicon&r=PG&f=1", "display_name": "nilesguo", "link": "https://stackoverflow.com/users/3477024/nilesguo"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1501689775, "post_id": 45464961, "comment_id": 77892364, "body": "Thank you, it was due to the version of bundler I was using that was the issue. Re-installying gem install bundler did fix the issue. In regards to the ruby version, I used 2.3.3 only because it was the suggested ruby version from the solution to my previous issue."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1501746763, "post_id": 45464961, "comment_id": 77916503, "body": "The post you linked to was written before ruby 2.3.4 was released! You should <i>always</i> aim to use the latest patch release of a minor version."}], "answers": [{"comments": [{"owner": {"reputation": 152, "user_id": 3477024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b471f3e07d29b0ec3a74bd35a3470fdb?s=128&d=identicon&r=PG&f=1", "display_name": "nilesguo", "link": "https://stackoverflow.com/users/3477024/nilesguo"}, "edited": false, "score": 1, "creation_date": 1501689664, "post_id": 45465452, "comment_id": 77892284, "body": "Thank you! Turns out my bundler was installed to my old ruby, reinstallying bundler again did fix the problem."}], "tags": [], "owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "is_accepted": true, "score": 1, "last_activity_date": 1501688905, "creation_date": 1501688905, "answer_id": 45465452, "question_id": 45464961, "link": "https://stackoverflow.com/questions/45464961/mismatched-ruby-version-after-downgrade-from-2-4-1-to-2-3-3-while-running-bundle/45465452#45465452", "title": "Mismatched ruby version after downgrade from 2.4.1 to 2.3.3 while running bundle install", "body": "<p>Gem installation is specific to ruby version, so the <code>bundler</code> you're using is likely installed to your old ruby. Try installing <code>bundler</code> again:</p>\n\n<pre><code>gem install bundler\n</code></pre>\n\n<p>That should fix your problem.</p>\n"}], "owner": {"reputation": 152, "user_id": 3477024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b471f3e07d29b0ec3a74bd35a3470fdb?s=128&d=identicon&r=PG&f=1", "display_name": "nilesguo", "link": "https://stackoverflow.com/users/3477024/nilesguo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 45465452, "answer_count": 1, "score": 0, "last_activity_date": 1501688905, "creation_date": 1501687558, "question_id": 45464961, "link": "https://stackoverflow.com/questions/45464961/mismatched-ruby-version-after-downgrade-from-2-4-1-to-2-3-3-while-running-bundle", "title": "Mismatched ruby version after downgrade from 2.4.1 to 2.3.3 while running bundle install", "body": "<p>While attempting to solve another issue identified in this thread:\n <a href=\"https://stackoverflow.com/questions/41703128/error-while-trying-to-load-the-gem-devise-activesupport-duration-cant-be-coe\">Error while trying to load the gem &#39;devise. ActiveSupport: Duration can&#39;t be coerced into Integer</a>, I followed the suggested solution and changed my ruby version from 2.4.1 to 2.3.3 using rbenv. I also made similar changes in my Gemfile to reflect the new ruby version. However, when I tried to bundle install again, it throws an error saying that my ruby version is 2.4.1, when my Gem specified 2.3.3. However, running <code>ruby -v</code> shows my ruby version is on 2.3.3. </p>\n\n<pre><code>$ bundle install\nYour Ruby version is 2.4.1, but your Gemfile specified 2.3.3\n$ ruby -v\nruby 2.3.3p222 (2016-11-21 revision 56859) [x86_64-darwin16]\n</code></pre>\n\n<p>Any help here would be appreciated. Thank you! </p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "cookies", "controller"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7383466"}, "edited": false, "score": 0, "creation_date": 1501703546, "post_id": 45466276, "comment_id": 77900592, "body": "Thanks for your help &amp; links @DiegoSalazar. Appreciate your time :)"}], "tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": true, "score": 0, "last_activity_date": 1501691356, "creation_date": 1501691356, "answer_id": 45466276, "question_id": 45464503, "link": "https://stackoverflow.com/questions/45464503/ruby-on-rails-read-cookie-value-after-page-load/45466276#45466276", "title": "Ruby on Rails - Read Cookie value after page load", "body": "<p>Cookies are a client side feature. You server can only read cookies when there is a request, i.e in your controller action. </p>\n\n<p>The only way to read a cookie after the page has loaded is with Javascript: <code>document.cookie</code></p>\n\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie</a></p>\n\n<p><a href=\"http://clubmate.fi/setting-and-reading-cookies-with-javascript/\" rel=\"nofollow noreferrer\">http://clubmate.fi/setting-and-reading-cookies-with-javascript/</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7383466"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1350, "favorite_count": 0, "accepted_answer_id": 45466276, "answer_count": 1, "score": 0, "last_activity_date": 1501691356, "creation_date": 1501686341, "question_id": 45464503, "link": "https://stackoverflow.com/questions/45464503/ruby-on-rails-read-cookie-value-after-page-load", "title": "Ruby on Rails - Read Cookie value after page load", "body": "<p>In my application in one of my views, I add a <code>Cookie</code> from my <code>Controller</code> and based on this <code>Cookie</code>, I set a value to my variable <em>(which will be used in my view)</em>.</p>\n\n<pre><code>class SomeController &lt; ApplicationController\n\n  def a_action\n    if params[:utm] == 'a'\n       cookies[:user_cookie] = {value: 'a', expires: 1.day.from_now}\n    else\n       cookies[:user_cookie] = {value: 'b', expires: 1.day.from_now}\n    end\n\n    if cookies[:user_cookie] == 'a'\n       @variable = 'a'\n    else\n       @variable = 'b'\n    end\n  end\n</code></pre>\n\n<p>In my view <code>a_action#some</code>, I'm doing:</p>\n\n<pre><code>%h1= @variable\n</code></pre>\n\n<p>When user is coming to <code>a_action#some</code> view, <code>cookies[:user_cookie]</code> is set to user's browser cookie, but my view or controller doesn't <em>read</em> <code>Cookie</code> value until next refresh. So <code>@variable</code> in my view becomes wrong value/no value at all.</p>\n\n<p>Is it possible to read <code>Cookie</code> after page is loaded so my <code>@variable</code> always has a value and don't need to wait for next refresh?</p>\n"}, {"tags": ["ruby", "google-ads-api", "awql"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1501686846, "post_id": 45464224, "comment_id": 77890155, "body": "You should add the code you tried and any error at the very least."}, {"owner": {"reputation": 1999, "user_id": 1116381, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7b470e79f9eb14c32bc0b8f3eb47fbd8?s=128&d=identicon&r=PG", "display_name": "Tachyons", "link": "https://stackoverflow.com/users/1116381/tachyons"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1501687530, "post_id": 45464224, "comment_id": 77890684, "body": "@Kris Added code sample for AD_PERFOMENCE_REPORT"}], "answers": [{"comments": [{"owner": {"reputation": 1999, "user_id": 1116381, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7b470e79f9eb14c32bc0b8f3eb47fbd8?s=128&d=identicon&r=PG", "display_name": "Tachyons", "link": "https://stackoverflow.com/users/1116381/tachyons"}, "edited": false, "score": 0, "creation_date": 1501785262, "post_id": 45489903, "comment_id": 77945446, "body": "That will be pretty slow, Thanks anyway"}], "tags": [], "owner": {"reputation": 4008, "user_id": 1101713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25fcf8c3e2f25e5b0f96b8a7dbb360a2?s=128&d=identicon&r=PG", "display_name": "dorian", "link": "https://stackoverflow.com/users/1101713/dorian"}, "is_accepted": true, "score": 1, "last_activity_date": 1501777812, "creation_date": 1501777812, "answer_id": 45489903, "question_id": 45464224, "link": "https://stackoverflow.com/questions/45464224/how-do-i-fetch-best-performing-ads-from-adwords-api/45489903#45489903", "title": "How do I fetch best performing ads from adwords api", "body": "<p>AFAIK there's no way to have the Adwords API give you any entities ordered by <em>stats</em>. The reports don't support any ordering. With the services, you can order by <em>attributes</em> (e.g. alphabetically by headline for text ads), but not performance metrics.</p>\n\n<p>So the only way is to download the whole report and do the ordering on your end.</p>\n"}], "owner": {"reputation": 1999, "user_id": 1116381, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7b470e79f9eb14c32bc0b8f3eb47fbd8?s=128&d=identicon&r=PG", "display_name": "Tachyons", "link": "https://stackoverflow.com/users/1116381/tachyons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 45489903, "answer_count": 1, "score": 0, "last_activity_date": 1501777812, "creation_date": 1501685610, "last_edit_date": 1501687225, "question_id": 45464224, "link": "https://stackoverflow.com/questions/45464224/how-do-i-fetch-best-performing-ads-from-adwords-api", "title": "How do I fetch best performing ads from adwords api", "body": "<p>I am trying to fetch top performing ads using attributes like impressions, clickx etc</p>\n\n<p>I tried google adwords reporting api first, but reporting api do not support  <code>ORDER BY</code> clause. And I couldn't find any <code>AdsService</code> in the <a href=\"https://github.com/googleads/google-api-ads-ruby/tree/a01574ba9b085f59640bd56726a16d8ef13e41e3/adwords_api/lib/adwords_api/v201609\" rel=\"nofollow noreferrer\">service list</a>. Closest I could find <code>AdGroupsAd</code> which seeems do not have attributes like impressions clicks, etc. Am I missing something ?</p>\n\n<pre><code>query = \"SELECT Headline,AdGroupName,AdType,CampaignName, Clicks FROM AD_PERFORMANCE_REPORT ORDER BY Clicks\"\nCSV.parse(report_utils.download_report_with_awql(query, 'CSV'))\n</code></pre>\n\n<blockquote>\n  <p>AdwordsApi::Errors::ReportXmlError: HTTP code: 400, error type:\n  'QueryError.ORDER_BY_CLAUSE_NOT_SUPPORTED', trigger: '', field path:\n  ''</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri"], "comments": [{"owner": {"reputation": 34664, "user_id": 390819, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee2ef44de10f7791cca06df317246935?s=128&d=identicon&r=PG", "display_name": "Cristian Lupascu", "link": "https://stackoverflow.com/users/390819/cristian-lupascu"}, "edited": false, "score": 0, "creation_date": 1501685593, "post_id": 45464115, "comment_id": 77889155, "body": "could you not do <code>doc.css(&quot;div.t.m0.h3.ff2.fs1.fc0.sc0.ls0.ws1&quot;)</code> (without the <code>x13</code> or <code>x15</code>) and then check if the selected element also has an <code>x\\d\\d</code> class?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501685623, "post_id": 45464115, "comment_id": 77889181, "body": "Maybe you can target the div with a selector that is not affected by the change? How does your markup look like? Why does the class change? <i>&quot;x15 can be x13&quot;</i> seems a bit arbitrary."}, {"owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "edited": false, "score": 0, "creation_date": 1501685896, "post_id": 45464115, "comment_id": 77889409, "body": "Can&#39;t do that guys, updated the question. There&#39;s another element I would get if I remove the x* class"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501686670, "post_id": 45464115, "comment_id": 77890001, "body": "I never used Nokogiri but can&#39;t you do <code>classes_to_select = [&#39;.x15&#39;, &#39;.x13&#39;]</code> and then <code>doc.css(*classes_to_select.map { |c| &quot;div#{base_classes}#{c}&quot; })</code>? where <code>base_classes = &#39;.t.m0.h3.ff2.fs1.fc0.sc0.ls0.ws1&#39;</code>"}, {"owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501689300, "post_id": 45464115, "comment_id": 77892020, "body": "@MrYoshiji yeah, that would be a good option. But would like to know first if there&#39;s some way to do that with regex. In case not, I&#39;ll accept your answer!"}, {"owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501690408, "post_id": 45464115, "comment_id": 77892773, "body": "@MrYoshiji You can post your answer, I&#39;ll accept it"}], "answers": [{"tags": [], "owner": {"reputation": 424, "user_id": 406835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbae80f1ea00408841fcd67312ba365?s=128&d=identicon&r=PG", "display_name": "Dmitry Z.", "link": "https://stackoverflow.com/users/406835/dmitry-z"}, "is_accepted": true, "score": 2, "last_activity_date": 1501690303, "creation_date": 1501690303, "answer_id": 45465939, "question_id": 45464115, "link": "https://stackoverflow.com/questions/45464115/nokogiri-get-div-with-class-by-regex/45465939#45465939", "title": "Nokogiri - Get div with class by regex", "body": "<p>You can use <code>.xpath</code> method for that purpose. E.g.</p>\n\n<pre><code>doc.xpath(\"//div[@class='x13' or @class='x15']\")\n</code></pre>\n\n<p>Or you can use </p>\n\n<pre><code>//div[starts-with(@class, 'x') and (ends-with(@class, '13') or (ends-with(@class, '15'))]\n</code></pre>\n\n<p>Searching by regexp appears in XPath 2.0, but I don't know what xpath version nokogiri supports.</p>\n"}, {"tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": false, "score": 1, "last_activity_date": 1501691502, "creation_date": 1501691502, "answer_id": 45466328, "question_id": 45464115, "link": "https://stackoverflow.com/questions/45464115/nokogiri-get-div-with-class-by-regex/45466328#45466328", "title": "Nokogiri - Get div with class by regex", "body": "<p>You can do the following:</p>\n\n<pre><code>base_classes = '.t.m0.h3.ff2.fs1.fc0.sc0.ls0.ws1'\nextra_classes = ['.x15', '.x13']\ndoc.css(*extra_classes.map { |extra_class| \"div#{base_classes}#{extra_class}\" })\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "is_accepted": false, "score": 2, "last_activity_date": 1501971847, "creation_date": 1501971847, "answer_id": 45526866, "question_id": 45464115, "link": "https://stackoverflow.com/questions/45464115/nokogiri-get-div-with-class-by-regex/45526866#45526866", "title": "Nokogiri - Get div with class by regex", "body": "<p>If you really need regex you would use <code>select</code>:</p>\n\n<pre><code>doc.css(\"div.t.m0.h3.ff2.fs1.fc0.sc0.ls0.ws1\").\n  select{|div| div[:class][/x1[3-5]/]}\n</code></pre>\n\n<p>Note: that regex may not do what you expect. Also note: using <code>select</code> turns your NodeSet into an Array</p>\n"}], "owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1153, "favorite_count": 0, "accepted_answer_id": 45465939, "answer_count": 3, "score": 4, "last_activity_date": 1501971847, "creation_date": 1501685330, "last_edit_date": 1501685861, "question_id": 45464115, "link": "https://stackoverflow.com/questions/45464115/nokogiri-get-div-with-class-by-regex", "title": "Nokogiri - Get div with class by regex", "body": "<p>I'm using nokogiri gem on my rails application to get some html nodes. I'm getting my div by its class. But that class name will change sometimes. For example, right now I'm getting it like this:</p>\n\n<pre><code>doc.css(\"div.t.m0.x15.h3.ff2.fs1.fc0.sc0.ls0.ws1\")\n</code></pre>\n\n<p>but that \"x15\" can be \"x13\", for example. I could do something like this:</p>\n\n<pre><code>doc.css(\"div.t.m0.x13.h3.ff2.fs1.fc0.sc0.ls0.ws1\", \"div.t.m0.x15.h3.ff2.fs1.fc0.sc0.ls0.ws1\")\n</code></pre>\n\n<p>This would work, but I think it would be nicer to set a range, like x13-x15, so if it comes a x14, I don't need to keep it so verbose.</p>\n\n<p>Any tips of how to do that? Thanks!</p>\n\n<p>EDIT:</p>\n\n<p>I can't remove the \"x*\" class, 'cause there's another div with the same another classes, so what differences the two elements is the \"x\" class. The another one is xa, xb; and this one I'm trying to get is x13, x15.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1501686988, "post_id": 45463938, "comment_id": 77890267, "body": "It would help if you could reduce the code down to just show the problem you are having... I don&#39;t think there is any need for any of the pseudo-bitcoin stuff?"}, {"owner": {"reputation": 116, "user_id": 6683788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c134430a7708872d4dbdbf60c092150?s=128&d=identicon&r=PG&f=1", "display_name": "Sem", "link": "https://stackoverflow.com/users/6683788/sem"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1501687283, "post_id": 45463938, "comment_id": 77890511, "body": "Yeah, sure I can reduce code. and it is just for personal use just experimenting let&#39;s say."}, {"owner": {"reputation": 116, "user_id": 6683788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c134430a7708872d4dbdbf60c092150?s=128&d=identicon&r=PG&f=1", "display_name": "Sem", "link": "https://stackoverflow.com/users/6683788/sem"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1501687298, "post_id": 45463938, "comment_id": 77890528, "body": "Well the main idea is that I want a function to be executed on the client.rb when the server.rb file decides to."}], "owner": {"reputation": 116, "user_id": 6683788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c134430a7708872d4dbdbf60c092150?s=128&d=identicon&r=PG&f=1", "display_name": "Sem", "link": "https://stackoverflow.com/users/6683788/sem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501684851, "creation_date": 1501684851, "question_id": 45463938, "link": "https://stackoverflow.com/questions/45463938/rubyserver-client-command-client-to-start-using-function", "title": "[RUBY]Server/Client | Command Client to start Using function", "body": "<p>So I am working on some stupid simulation of mining cryptocoins - just for fun.\nBut I have run into an issue I want to command the client to start using a function but I am not sure how to do it, my code is bellow for Server.rb and Client.rb</p>\n\n<p>Client</p>\n\n<pre><code>require 'socket'\n\ns = TCPSocket.new 'localhost', 2626\n\nwhile line = s.gets\n    puts line\nend\n\ns.close\n</code></pre>\n\n<p>Server.rb</p>\n\n<pre><code>#!/bin/ruby\n\nrequire \"socket\"\nrequire 'securerandom'\n\n\nPORT = 2626\nserver_pool = TCPServer.open(PORT)\n\nsndc_block_time = 200    # Size of block\nsndc_block_time = 10        # Time to brake block 1,1 out of 200, 200    \n\nsndc_coin_blocks= 126^2     # Ammount of available blocks\nsndc_coin_balance = 0\n\nsub_blocks = 0      # Sub blocks user wants to mine\n\naddr = SecureRandom.hex # generate a random hexadecimal address\n\n# Notify message shown when user registers a new address\ndisclaimer = \"Welcome to the SendCoin Network!\nA new address has been registered and saved\nto your computer desktop!\"\n\n\ndef handle_connection(client)\n  puts \"New client! #{client} \\n\\n\"\n\nend\n\nputs \"Listening on #{PORT}. Press CTRL+C to cancel.\"\n\nwhile client = server_pool.accept\n  if Thread.new { handle_connection(client) }\n\n  if sndc_coin_blocks &lt; 126^2 / 4\n    sndc_coin_blocks + 126^2 / 4    # Add a quarter of the original size\n  end\n\n  if Dir['../MyAddress/*.addr'].any? == true\n\n    # Statrs Mining\n    client.puts \"Starting to mine..\"\n    sleep(5)\n    client.puts \"Current blocks: \" + sndc_coin_blocks.to_s\n    client.puts \"Block Size: \" + sndc_coin_balance.to_s\n    client.puts \"Approximate time to mine 1 sub-block: \" + sndc_block_time.to_s\n    client.puts \"Searching for block..\"\n    sleep(3)\n    if sndc_block_time != 10\n      sndc_block_time = 10\n    end\n    client.puts \"Started mining...\" \n\n\n  elsif Dir['../addresses/*.addr'].any? == false\n    File.open(\"../addresses/\"+addr+\".addr\", \"w\") do |f|    # Create file    \n      f.write(sndc_coin_balance.to_s)   \n    end\n\n    client.puts \"New address generated: \" + addr.to_s + \" , you may realunch the app now and enter your address!\"\n\n    # Start Mining\n    puts \"&gt; File 'address.addr' has been generated for#{client}\"\n  end\n\nend\nend\n</code></pre>\n\n<p>So essentially I want after this line of code:</p>\n\n<pre><code>client.puts \"Started mining...\" \n</code></pre>\n\n<p>.. to command the client to (client.rb) to start using a function.</p>\n"}, {"tags": ["php", "ruby", "http", "post", "httparty"], "answers": [{"tags": [], "owner": {"reputation": 1030, "user_id": 2100645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9894864f33c42fffe19330d2e00d1b?s=128&d=identicon&r=PG", "display_name": "Lucas Costa", "link": "https://stackoverflow.com/users/2100645/lucas-costa"}, "is_accepted": false, "score": 8, "last_activity_date": 1501685756, "creation_date": 1501685756, "answer_id": 45464294, "question_id": 45463812, "link": "https://stackoverflow.com/questions/45463812/ruby-httparty-post-request/45464294#45464294", "title": "Ruby httparty post request", "body": "<p>Note that in your PHP code, you're passing a string as the POST body.<br>\nIn Ruby code, you're passing a json.</p>\n\n<p>Try the following:</p>\n\n<pre><code>HTTParty.post(\"https://myurl/api/add_lead\", {\n  body: \"first_name=test&amp;phone=123456789&amp;email=email@email.com&amp;ipaddress=192.168.0.0\",\n  headers: {\n    'Content-Type' =&gt; 'application/x-www-form-urlencoded',\n    'charset' =&gt; 'utf-8'\n  }\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 6658347, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/a9EtJ.jpg?s=128&g=1", "display_name": "31113", "link": "https://stackoverflow.com/users/6658347/31113"}, "is_accepted": false, "score": 0, "last_activity_date": 1598880726, "creation_date": 1598880726, "answer_id": 63671805, "question_id": 45463812, "link": "https://stackoverflow.com/questions/45463812/ruby-httparty-post-request/63671805#63671805", "title": "Ruby httparty post request", "body": "<p>For <code>application/x-www-form-urlencoded</code> Content-Type use <code>URI.encode_www_form(your_data)</code>:</p>\n<pre><code>require 'uri'\n\n...\n\ndata = { \n  first_name: &quot;test&quot;, \n  phone: &quot;123456789&quot;, \n  email: &quot;email@email.com&quot; , \n  ipaddress:'192.168.0.0'\n}\n\nauthorization_string = &quot;#{ENV['API_KEY']}:#{ENV['API_SECRET']}&quot;\nurl = &quot;https://myurl/api/add_lead&quot;\n\nresponse = HTTParty.post(url,\n  body: URI.encode_www_form(data),\n  headers: { \n    'Content-Type' =&gt; 'application/x-www-form-urlencoded', \n    'Authorization' =&gt; &quot;Basic #{Base64.strict_encode64(authorization_string)}&quot; \n  }\n)\n\nresponse_body = JSON.parse(response.body)\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8338151, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/218e0fee3ecbe13a7490c7734c60adc3?s=128&d=identicon&r=PG&f=1", "display_name": "user8338151", "link": "https://stackoverflow.com/users/8338151/user8338151"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5925, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1598880726, "creation_date": 1501684561, "question_id": 45463812, "link": "https://stackoverflow.com/questions/45463812/ruby-httparty-post-request", "title": "Ruby httparty post request", "body": "<p>I have working php code </p>\n\n<pre><code>   &lt;?php\n    $ch = curl_init(\"https://myurl/api/add_lead\");\n\n    $first_name = $_POST[\"name\"];\n    $phone = $_POST[\"phone\"];\n    $email = $_POST[\"email\"];\n    $ipaddress = $_SERVER['REMOTE_ADDR'];\n\n    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);\n    curl_setopt($ch,CURLOPT_POST,true);\n    curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,1120);\n\n    curl_setopt($ch,CURLOPT_POSTFIELDS,\"first_name=$first_name&amp;phone=$phone&amp;email=$email&amp;ipaddress=$ipaddress\");\n    curl_setopt($ch,CURLOPT_HTTPHEADER,[\"Content-Type:application/x-www-form-urlencoded; charset=utf-8\"]);\n\n    curl_setopt($ch,CURLOPT_TIMEOUT,60);\n    $result = curl_exec($ch);\n\n    curl_close($ch);\n    ?&gt;\n</code></pre>\n\n<p>I need to transform it in ruby code </p>\n\n<p>I have tried </p>\n\n<pre><code>HTTParty.post(\"https://myurl/api/add_lead\",\n{\n:body =&gt; { first_name: \"test\", phone: \"123456789\", email: \"email@email.com\" , ipaddress:'192.168.0.0'},\n:headers =&gt; {  'Content-Type' =&gt; 'application/x-www-form-urlencoded','charset'=&gt;'utf-8'}\n\n})\n</code></pre>\n\n<p>but have got <code>500</code> error code</p>\n\n<p>How to do it properly?</p>\n"}, {"tags": ["android", "ruby", "termux"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8408089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36743c0e35525a59cdc1c01add043fd1?s=128&d=identicon&r=PG&f=1", "display_name": "Efrain Lugo", "link": "https://stackoverflow.com/users/8408089/efrain-lugo"}, "is_accepted": false, "score": 0, "last_activity_date": 1501711005, "last_edit_date": 1501711005, "creation_date": 1501709551, "answer_id": 45471353, "question_id": 45462145, "link": "https://stackoverflow.com/questions/45462145/ruby-on-android-termux/45471353#45471353", "title": "Ruby on android.Termux", "body": "<p>You need root access for this.  Once you do, create your ruby script in the Termux directory (which may be in \"/data/data/\"-- you need root access to make sure).  Then just run <code>ruby rubyscript.rb</code> in the terminal.</p>\n"}], "owner": {"reputation": 11, "user_id": 8405821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09103619aa740308bc71315f08f2abef?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Souza e Silva", "link": "https://stackoverflow.com/users/8405821/daniel-souza-e-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 891, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501711005, "creation_date": 1501680247, "last_edit_date": 1501680969, "question_id": 45462145, "link": "https://stackoverflow.com/questions/45462145/ruby-on-android-termux", "title": "Ruby on android.Termux", "body": "<p>How do I run Ruby scripts in the Termux terminal? I only know how to activate IRB.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "erb", "findby"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1501680597, "post_id": 45462141, "comment_id": 77885042, "body": "Do you have any assocition between <code>people</code> and <code>people_org</code> ?"}, {"owner": {"reputation": 1030, "user_id": 2100645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9894864f33c42fffe19330d2e00d1b?s=128&d=identicon&r=PG", "display_name": "Lucas Costa", "link": "https://stackoverflow.com/users/2100645/lucas-costa"}, "edited": false, "score": 0, "creation_date": 1501680611, "post_id": 45462141, "comment_id": 77885055, "body": "You can use the lookup aggregation provided by MongoDB: <a href=\"https://stackoverflow.com/a/35948843/2100645\">stackoverflow.com/a/35948843/2100645</a>"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1501680907, "post_id": 45462141, "comment_id": 77885276, "body": "are you using mongoid?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1501681191, "post_id": 45462141, "comment_id": 77885523, "body": "quite slow? 10s is abysmal, especially for a few hundred records."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501681240, "post_id": 45462141, "comment_id": 77885574, "body": "(3) : You can grab all the <code>PeopleOrg</code> records before displaying the page and try to look for them in the view: <code>@people_orgs_grouped_by_name = PeopleOrg.where(name: @people.pluck(:name)).group_by(&amp;:name)</code> and then in the view use <code>if @people_orgs_grouped_by_name[p.name].present?</code> etc. (1) yes, you should define a relation between the 2 models without using the name, because Bob (id 1) is not the same as Bob (id 2) but will still be grabbed by this code"}, {"owner": {"reputation": 244, "user_id": 4596870, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/24619feb1a0ccb8c4520d7e5d05f38d7?s=128&d=identicon&r=PG&f=1", "display_name": "BrandonFlynn-NB", "link": "https://stackoverflow.com/users/4596870/brandonflynn-nb"}, "edited": false, "score": 0, "creation_date": 1501760206, "post_id": 45462141, "comment_id": 77926443, "body": "Thank you for the answers, I&#39;ll be back soon"}], "answers": [{"tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": false, "score": 0, "last_activity_date": 1504832899, "creation_date": 1504832899, "answer_id": 46107159, "question_id": 45462141, "link": "https://stackoverflow.com/questions/45462141/improve-performance-of-find-by-method-matching-strings/46107159#46107159", "title": "Improve performance of find_by method matching strings?", "body": "<p>As mentioned in the comment, you can utilise <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/lookup/\" rel=\"nofollow noreferrer\">MongoDB Aggregation operator $lookup</a> to perform lookup operation to another collection. </p>\n\n<p>For example, having MongoDB documents in <code>people</code> collection such below: </p>\n\n<pre><code>{ \"name\": \"Brandon\", \n  \"phone\": 123456789 }\n</code></pre>\n\n<p>also an example of documents in <code>people_org</code> collection as below: </p>\n\n<pre><code>{ \"organisation\": \"NBCC\", \n  \"contact\": \"Brandon\"}\n</code></pre>\n\n<p>You can use <a href=\"https://docs.mongodb.com/ruby-driver/master/tutorials/ruby-driver-aggregation/\" rel=\"nofollow noreferrer\">MongoDB Ruby Aggregation</a> example as below to lookup <code>people</code> by name to <code>people_org</code>: </p>\n\n<pre><code>cursor = collection.aggregate([\n                   {\"$match\":\n                          {\"name\":\"Brandon\"}}, \n                   {\"$lookup\": \n                          {\"from\": \"people_org\", \n                           \"localField\": \"name\", \n                           \"foreignField\": \"contact\", \n                           \"as\": \"organisation\"}\n                   }])\ncursor.each do |document|\n    puts document\nend\n</code></pre>\n\n<p>Note that <code>$lookup</code> is available only since MongoDB v3.2+ </p>\n"}], "owner": {"reputation": 244, "user_id": 4596870, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/24619feb1a0ccb8c4520d7e5d05f38d7?s=128&d=identicon&r=PG&f=1", "display_name": "BrandonFlynn-NB", "link": "https://stackoverflow.com/users/4596870/brandonflynn-nb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504832899, "creation_date": 1501680224, "question_id": 45462141, "link": "https://stackoverflow.com/questions/45462141/improve-performance-of-find-by-method-matching-strings", "title": "Improve performance of find_by method matching strings?", "body": "<p>Pardon my Ruby/Rails ignorance, I'm still learning.</p>\n\n<p><strong>Details:</strong><br>\nI have two mongodb tables. <code>people</code> has 214 records, <code>people_org</code> has 107, this will only increase in the future. The only unique connection between these tables is a person's name, which is on average ~15 characters. I do not have control over this DB structure at this time.</p>\n\n<p>Currently I'm looping through each <code>people</code> object, then using <code>find_by</code> to find the matching record, printing an ID that I need, and printing some information.</p>\n\n<pre><code>&lt;%@people.each do |p|%&gt;\n...\n    &lt;%=@people_org.find_by(name: p.name).id%&gt;\n    ...[priting a few paragraphs of text]...\n    &lt;%end%&gt;\n...\n&lt;%end%&gt;   \n</code></pre>\n\n<p><strong>Problem:</strong><br>\nThe performance is quite slow (~10 seconds).  </p>\n\n<p><strong>Potential Solutions:</strong><br>\n(1) Our team may adapt to a structure that does not rely on string matching and use integers instead (I assume this would improve performance).   </p>\n\n<p>(2) Perhaps there is a more efficient method?  </p>\n\n<p>(3) Perhaps there is a way to prepare or alter the data for a more effcient sort?</p>\n\n<p>Thank you in advance for your help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "devise"], "comments": [{"owner": {"reputation": 1586, "user_id": 1798644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rr1jq.jpg?s=128&g=1", "display_name": "MatayoshiMariano", "link": "https://stackoverflow.com/users/1798644/matayoshimariano"}, "edited": false, "score": 0, "creation_date": 1501679798, "post_id": 45461638, "comment_id": 77884339, "body": "Do you receive some kind of error or exception when saving?"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1501680718, "post_id": 45461638, "comment_id": 77885138, "body": "@Theopap You can active field in <code>def after_sign_in_path_for(resource_or_scope)</code>"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 1586, "user_id": 1798644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rr1jq.jpg?s=128&g=1", "display_name": "MatayoshiMariano", "link": "https://stackoverflow.com/users/1798644/matayoshimariano"}, "edited": false, "score": 0, "creation_date": 1501682678, "post_id": 45461638, "comment_id": 77886802, "body": "@MatayoshiMariano, no nothing!"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1501683736, "post_id": 45461638, "comment_id": 77887601, "body": "@Vishal I placed my code in the application controller under the <code>def after_sign_in_path_for(resource_or_scope)</code> but the same thing happens... no error and it won&#39;t let me sign in"}, {"owner": {"reputation": 1586, "user_id": 1798644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rr1jq.jpg?s=128&g=1", "display_name": "MatayoshiMariano", "link": "https://stackoverflow.com/users/1798644/matayoshimariano"}, "edited": false, "score": 0, "creation_date": 1501683928, "post_id": 45461638, "comment_id": 77887762, "body": "@Theopap are you sure that the <code>obj.save!</code> is being executed?"}, {"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1501684178, "post_id": 45461638, "comment_id": 77887973, "body": "@Theopap  Have you trie to use  update_column?  <a href=\"https://apidock.com/rails/ActiveRecord/Persistence/update_column\" rel=\"nofollow noreferrer\">apidock.com/rails/ActiveRecord/Persistence/update_column</a>  Instead of saving again."}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 1586, "user_id": 1798644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rr1jq.jpg?s=128&g=1", "display_name": "MatayoshiMariano", "link": "https://stackoverflow.com/users/1798644/matayoshimariano"}, "edited": false, "score": 0, "creation_date": 1501684207, "post_id": 45461638, "comment_id": 77888002, "body": "hmmm I&#39;m not sure @MatayoshiMariano, in the rails console when I try to sign in nothing appears!"}, {"owner": {"reputation": 1586, "user_id": 1798644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rr1jq.jpg?s=128&g=1", "display_name": "MatayoshiMariano", "link": "https://stackoverflow.com/users/1798644/matayoshimariano"}, "edited": false, "score": 0, "creation_date": 1501684255, "post_id": 45461638, "comment_id": 77888043, "body": "@Theopap do you use a debugger like <a href=\"https://github.com/rweng/pry-rails\" rel=\"nofollow noreferrer\">pry</a>? Try putting a <code>binding.pry</code> in the code to see if it is being executed"}, {"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1501684323, "post_id": 45461638, "comment_id": 77888102, "body": "Write byebug before the save call and see if at least the application goes there."}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1501685235, "post_id": 45461638, "comment_id": 77888879, "body": "Just getting this:  <code>Parameters: {&quot;utf8&quot;=&gt;&quot;\u2713&quot;, &quot;authenticity_token&quot;=&gt;&quot;YZpVWN0BVrEc1juPjKYScnxdbIb&#47;FRSV74TBV&zwnj;&#8203;YL+PAbh&#47;jo9xBlrwWmOB&zwnj;&#8203;kmToDzHFNLZ&#47;T3nqtJ36&zwnj;&#8203;hW7SOwK7w==&quot;, &quot;store&quot;=&gt;{&quot;email&quot;=&gt;&quot;example@hotmail.com&quot;, &quot;password&quot;=&gt;&quot;[FILTERED]&quot;, &quot;remember_me&quot;=&gt;&quot;0&quot;}, &quot;commit&quot;=&gt;&quot;Log in&quot;}   Store Load (0.2ms)  SELECT  &quot;stores&quot;.* FROM &quot;stores&quot; WHERE &quot;stores&quot;.&quot;email&quot; = ? ORDER BY &quot;stores&quot;.&quot;id&quot; ASC LIMIT ?  [[&quot;email&quot;, &quot;example@hotmail.com&quot;], [&quot;LIMIT&quot;, 1]]</code>"}], "owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501678909, "creation_date": 1501678909, "question_id": 45461638, "link": "https://stackoverflow.com/questions/45461638/update-attribute-at-sign-in-with-devise-after-set-user-callback", "title": "Update attribute at sign in with devise (after_set_user callback)", "body": "<p>I have the devise gem installed on my rails app. Also I have a boolean column:is_active in the stores table.</p>\n\n<p>Each time a store tries to sign in I'm running the <code>Warden::Manager.after_set_user</code> callback along with the braintree code to find if the store has has an active or not subscription. And if the store has and active or not subscription I'm trying to update the is_active column to true or false.</p>\n\n<p>But for some reason I can't get the is_active boolean to update!</p>\n\n<pre><code>Warden::Manager.after_set_user :scope =&gt; :store do |store, auth, opts|\n\ncustomer = Braintree::Customer.find('customer_id')\ncustomer_card = customer.payment_methods[0].token\npayment_method = Braintree::PaymentMethod.find(customer_card)\nsub = payment_method.subscriptions[0]\nsub.status\n\nif Braintree::Subscription::Status::Active\n  obj = Store.find_by_id(params[:id])\n  obj.is_active = true\n  obj.save!\n\n\nelse\n  obj = Store.find_by_id(params[:id])\n  obj.is_active = false\n  obj.save!\nend\nend\n</code></pre>\n\n<p>And this is the code I'm using for devise in order to allow or block a store from signing in.</p>\n\n<pre><code> def active_for_authentication?\n    super &amp;&amp; is_active?\n end\n\n def inactive_message\n    \"User not active, please subscribe!\"\n end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1501676448, "post_id": 45460638, "comment_id": 77881525, "body": "You need to remove Job.find_job(..) from show action as it will try to override the current value of @job which has been set through before_action."}, {"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1501676604, "post_id": 45460638, "comment_id": 77881646, "body": "Also, find_job is not even a method In activerecord assuming you are trying to find the record based on id. It should be either find or find_by"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1501677149, "post_id": 45460638, "comment_id": 77882105, "body": "@Ale replace this line <code>@job = Job.find_job(jobs_params[:id])</code> with this <code>@job = Job.find(jobs_params[:id])</code> . second this, why you iterate the loop of @job. it have only one job. If you want all jobs. than you can get it by this code <code>@jobs = Job.all</code> and you can iterate loop of <code>@jobs</code>"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1501677689, "post_id": 45460638, "comment_id": 77882539, "body": "@Vishal actually OP can just remove the &quot;find_job&quot; line completely.  The before_action will get the record for him.  And <code>jobs_params</code> is not available at <code>show</code>."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1501677887, "post_id": 45460638, "comment_id": 77882710, "body": "@SteveTurczyn Sorry i didnt notice that method. yes you are right . no need to right anything in show method. but if he want all jobs than he need to write <code>@jobs = Job.all</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8359832"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1501678157, "post_id": 45460638, "comment_id": 77882951, "body": "@Vishal, I changed the code to what you suggested, then I got a param is missing or the value is empty: job. I did a rails console and I have this:  Job Load (1.1ms)  SELECT  &quot;jobs&quot;.* FROM &quot;jobs&quot; LIMIT ?  [[&quot;LIMIT&quot;, 11]]  =&gt; #&lt;ActiveRecord::Relation [#&lt;Job id: 1, poster: nil, category: nil, location: nil, status: &quot;New&quot;, description: &quot;Your job is to plant trees all over the Dorchester...&quot;, created_at: &quot;2017-08-01 10:29:40&quot;, updated_at: &quot;2017-08-01 10:29:40&quot;&gt;]&gt;. I don&#39;t understand why I have nil on everything except description."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1501679391, "post_id": 45460638, "comment_id": 77883992, "body": "@Ale spelling is correct of description ?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8359832"}, "edited": false, "score": 0, "creation_date": 1501678418, "post_id": 45461236, "comment_id": 77883171, "body": "Snake, I checked my rails console and I am going to continue to get a blank screen because of this: [#&lt;Job id: 1, poster: nil, category: nil, location: nil, status: &quot;New&quot;, description: &quot;Your job is to plant trees all over the Dorchester...&quot;, I am not sure why I got a nil on everything."}], "tags": [], "owner": {"reputation": 1079, "user_id": 3550170, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Pu9Na.png?s=128&g=1", "display_name": "Snake", "link": "https://stackoverflow.com/users/3550170/snake"}, "is_accepted": false, "score": 0, "last_activity_date": 1501677802, "creation_date": 1501677802, "answer_id": 45461236, "question_id": 45460638, "link": "https://stackoverflow.com/questions/45460638/how-does-my-show-page-need-to-be-written-in-order-to-display-data/45461236#45461236", "title": "How does my show page need to be written in order to display data?", "body": "<p>Remove this line from the show action in your JobsController :</p>\n\n<pre><code>@job = Job.find_job(jobs_params[:id])\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8359832"}, "edited": false, "score": 0, "creation_date": 1501678392, "post_id": 45461249, "comment_id": 77883153, "body": "Steve, I checked my rails console and I am going to continue to get a blank screen because of this: [#&lt;Job id: 1, poster: nil, category: nil, location: nil, status: &quot;New&quot;, description: &quot;Your job is to plant trees all over the Dorchester...&quot;, I am not sure why I got a nil on everything."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1501677861, "creation_date": 1501677861, "answer_id": 45461249, "question_id": 45460638, "link": "https://stackoverflow.com/questions/45460638/how-does-my-show-page-need-to-be-written-in-order-to-display-data/45461249#45461249", "title": "How does my show page need to be written in order to display data?", "body": "<p>change this</p>\n\n<pre><code>  def show\n    @job = Job.find_job(jobs_params[:id])\n  end\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>  def show\n  end\n</code></pre>\n\n<p>The @job record is retrieved for you by the before_action</p>\n\n<p>And use this in the show.html.erb</p>\n\n<pre><code>&lt;h1&gt;&lt;%= @job.poster %&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;%= @job.category %&gt;&lt;/p&gt;\n&lt;p&gt;&lt;%= @job.location %&gt;&lt;/p&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "is_accepted": true, "score": 0, "last_activity_date": 1501678773, "creation_date": 1501678773, "answer_id": 45461577, "question_id": 45460638, "link": "https://stackoverflow.com/questions/45460638/how-does-my-show-page-need-to-be-written-in-order-to-display-data/45461577#45461577", "title": "How does my show page need to be written in order to display data?", "body": "<p>Try to Replace your <code>_form.html.erb</code> with</p>\n\n<pre><code>&lt;%= simple_form_for(@job, html: {class: 'form-horizontal'}) do |f| %&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label \"Poster:\", class: 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.select(:poster, options_for_select([['Nick Maloney','Nick Maloney'],\n        ['Peter Brown','Peter Brown'],['Jen Morris','Jen Morris']])) %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label \"Category:\", class: 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.select(:category, options_for_select([['Landscaping','Landscaping'],\n        ['Babysitting','Babysitting'],['Tree planting','Tree planting']])) %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label \"Location:\", class: 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.select(:location, options_for_select([['Dorchester','Dorchester'],\n        ['Roxbury','Roxbury'],['Mattapan','Mattapan']])) %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label \"Status:\", class: 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.select(:status, options_for_select([['New','New'],\n        ['Pending','Pending'],['Complete','Complete']])) %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;%= f.input :description, label: \"Job Description\" %&gt;\n  &lt;%= f.submit 'Add Job', class: 'btn btn-default' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In controller</p>\n\n<pre><code>   def show\n   end\n</code></pre>\n\n<p>show.html.erb</p>\n\n<pre><code>&lt;h1&gt;&lt;%= @job.poster %&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;%= @job.category %&gt;&lt;/p&gt;\n&lt;p&gt;&lt;%= @job.location %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>You got </p>\n\n<blockquote>\n  <p>Job id: 1, poster: nil, category: nil, location: nil, status:\n  \"New\", description: \"Your job is to plant trees all over the\n  Dorchester...\"</p>\n</blockquote>\n\n<p>because by mistek you have used <code>:status</code> in every <code>select</code> in <code>_form.html.erb</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8359832"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 45461577, "answer_count": 3, "score": 2, "last_activity_date": 1501678878, "creation_date": 1501676119, "last_edit_date": 1501678878, "question_id": 45460638, "link": "https://stackoverflow.com/questions/45460638/how-does-my-show-page-need-to-be-written-in-order-to-display-data", "title": "How does my show page need to be written in order to display data?", "body": "<p>I am a newbie to the world of Ruby on Rails and I am developing a form that is dropdown in nature for the first time and you can see the code here in _form.html.erb:</p>\n\n<pre><code>&lt;%= simple_form_for(@job, html: {class: 'form-horizontal'}) do |f| %&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label \"Poster:\", class: 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.select(:status, options_for_select([['Nick Maloney','Nick Maloney'],\n        ['Peter Brown','Peter Brown'],['Jen Morris','Jen Morris']])) %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label \"Category:\", class: 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.select(:status, options_for_select([['Landscaping','Landscaping'],\n        ['Babysitting','Babysitting'],['Tree planting','Tree planting']])) %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label \"Location:\", class: 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.select(:status, options_for_select([['Dorchester','Dorchester'],\n        ['Roxbury','Roxbury'],['Mattapan','Mattapan']])) %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label \"Status:\", class: 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.select(:status, options_for_select([['New','New'],\n        ['Pending','Pending'],['Complete','Complete']])) %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;%= f.input :description, label: \"Job Description\" %&gt;\n  &lt;%= f.submit 'Add Job', class: 'btn btn-default' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I click on 'Add Job', it takes me to a blank screen which I have not been able to resolve on my own.</p>\n\n<p>I have changed the code around a view times in the views/show.html.erb. I have had this:</p>\n\n<pre><code>&lt;h1&gt;&lt;%= @job.poster %&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;%= @job.category %&gt;&lt;/p&gt;\n&lt;p&gt;&lt;%= @job.location %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>&lt;tbody&gt;\n  &lt;% @job.each do |job| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= job.poster %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>and I continue to get a blank screen or if I went to my jobs_controller.rb and developed it like this:</p>\n\n<pre><code>class JobsController &lt; ApplicationController\n  before_action :find_job, only: [:show, :edit, :update, :destroy]\n\n  def index\n    # @job = Job.all\n  end\n\n  def show\n    @job = Job.find_job(jobs_params[:id])\n  end\n\n  def new\n    @job = Job.new\n  end\n\n  def create\n    @job = Job.new(jobs_params)\n\n    if @job.save\n      redirect_to @job, notice: 'Your job was successfully added'\n    else\n      render \"New\"\n    end\n  end\n\n  def edit\n\n  end\n\n  def update\n\n  end\n\n  def destroy\n\n  end\n\n  private\n\n  def jobs_params\n    params.require(:job).permit(:poster, :category, :location, :status, :description)\n  end\n\n  def find_job\n    @job = Job.find(params[:id])\n  end\nend\n</code></pre>\n\n<p>I would get an undefined method for 'poster' for ActiveRecord object, but if I remove the code in the show action, I just get a blank page. I am out of solutions here and I have looked on SO, but nothing resembled a solution for me.</p>\n\n<p>My routes.rb file looks like this:</p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :jobs\n  root 'jobs#index'\nend\n</code></pre>\n\n<p>I changed the show action to reflect this:</p>\n\n<pre><code>def show\n    @job = Job.find(jobs_params[:id])\nend\n</code></pre>\n\n<p>then I got a param is missing or the value is empty: job. </p>\n\n<p>I did a rails console and I have this: </p>\n\n<pre><code>Job Load (1.1ms) SELECT \"jobs\".* FROM \"jobs\" LIMIT ? [[\"LIMIT\", 11]] =&gt; #&lt;ActiveRecord::Relation [#&lt;Job id: 1, poster: nil, category: nil, location: nil, status: \"New\", description: \"Your job is to plant trees all over the Dorchester...\", created_at: \"2017-08-01 10:29:40\", updated_at: \"2017-08-01 10:29:40\"&gt;]&gt; \n</code></pre>\n\n<p>I don't understand why I have nil on everything except description.</p>\n\n<p>It seems that every form input like this:</p>\n\n<pre><code>&lt;div class=\"control-group\"&gt;\n    &lt;%= f.label \"Poster:\", class: 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.select(:status, options_for_select([['Nick Maloney','Nick Maloney'],\n        ['Peter Brown','Peter Brown'],['Jen Morris','Jen Morris']])) %&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>Gave me a nil in the rails console and only this one:</p>\n\n<pre><code>&lt;%= f.input :description, label: \"Job Description\" %&gt;\n</code></pre>\n\n<p>successfully inputted data, so something is wrong with the code for f.select, but I am not sure what.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501680301, "post_id": 45460431, "comment_id": 77884803, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7533104/mongoid-find-through-array-of-ids\" title=\"mongoid find through array of ids\">stackoverflow.com/questions/7533104/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 1451241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246bb74431393751743c2e3f2d47b9c8?s=128&d=identicon&r=PG", "display_name": "Calmon", "link": "https://stackoverflow.com/users/1451241/calmon"}, "edited": false, "score": 0, "creation_date": 1501677578, "post_id": 45460949, "comment_id": 77882471, "body": "But I want the order by the Array of ids not by uid. Thats the whole point of the problem."}, {"owner": {"reputation": 176, "user_id": 6198573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93e4f964565b8e1a6151750e864d70f7?s=128&d=identicon&r=PG", "display_name": "gururuby", "link": "https://stackoverflow.com/users/6198573/gururuby"}, "reply_to_user": {"reputation": 573, "user_id": 1451241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246bb74431393751743c2e3f2d47b9c8?s=128&d=identicon&r=PG", "display_name": "Calmon", "link": "https://stackoverflow.com/users/1451241/calmon"}, "edited": false, "score": 0, "creation_date": 1501678483, "post_id": 45460949, "comment_id": 77883237, "body": "I&#39;ve edited a solution, but I need to check"}, {"owner": {"reputation": 573, "user_id": 1451241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246bb74431393751743c2e3f2d47b9c8?s=128&d=identicon&r=PG", "display_name": "Calmon", "link": "https://stackoverflow.com/users/1451241/calmon"}, "edited": false, "score": 0, "creation_date": 1501682443, "post_id": 45460949, "comment_id": 77886602, "body": "Thanks, is there a way to keep the result object type because I want to use .only .skip .limit etc. on it and I can&#39;t do it with Mongo::Collection::View::Aggregation"}], "tags": [], "owner": {"reputation": 176, "user_id": 6198573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93e4f964565b8e1a6151750e864d70f7?s=128&d=identicon&r=PG", "display_name": "gururuby", "link": "https://stackoverflow.com/users/6198573/gururuby"}, "is_accepted": true, "score": 1, "last_activity_date": 1501678424, "last_edit_date": 1501678424, "creation_date": 1501676998, "answer_id": 45460949, "question_id": 45460431, "link": "https://stackoverflow.com/questions/45460431/sorting-a-query-in-order-of-an-input-array-using-mongoid/45460949#45460949", "title": "Sorting a query in order of an input array using mongoid", "body": "<p>Use <code>User.where(:uid.in =&gt; ids).order_by(uid: :asc)</code></p>\n\n<p>Or use aggregation when sequence important</p>\n\n<pre><code>ids = [1, 2, 3]\nmatch = { \"$match\" =&gt; {\"uid\" =&gt; {\"$in\" =&gt; ids } } }\nfield = { \"$addFields\" =&gt; { \"__order\" =&gt; { \"$indexOfArray\" =&gt; [ ids, \"$uid\" } } }\nsort = { \"$sort\" : { \"__order\" : 1 } };\nUser.collection.aggregate([match, field, sort]);\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 1451241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246bb74431393751743c2e3f2d47b9c8?s=128&d=identicon&r=PG", "display_name": "Calmon", "link": "https://stackoverflow.com/users/1451241/calmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "closed_date": 1501680287, "accepted_answer_id": 45460949, "answer_count": 1, "score": 0, "last_activity_date": 1501680340, "creation_date": 1501675591, "last_edit_date": 1501680340, "question_id": 45460431, "link": "https://stackoverflow.com/questions/45460431/sorting-a-query-in-order-of-an-input-array-using-mongoid", "closed_reason": "Duplicate", "title": "Sorting a query in order of an input array using mongoid", "body": "<p>We use mongoid in a ruby on rails project and I need a simple user list sorted by the ids I use to find the correct result sets. </p>\n\n<p>So basically something like this:</p>\n\n<pre><code>ids = [7, 1, 3]\nUser.where(:uid.in =&gt; ids)\n</code></pre>\n\n<p>This gives a list back sorted by the indexed UIDs.</p>\n\n<p>But it needs to be sorted by the <code>ids</code> array. </p>\n\n<p>Is there an easy way to do this with mongoid? Thanks.</p>\n"}, {"tags": ["ruby", "split"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 5, "creation_date": 1501675058, "post_id": 45459812, "comment_id": 77880412, "body": "<a href=\"https://stackoverflow.com/a/1732454/477037\">You can&#39;t parse (X)HTML with regex</a>. Anyway \u2013 what is your expected result?"}, {"owner": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501675312, "post_id": 45459812, "comment_id": 77880608, "body": "@Stefan <code>&#47;torrent&#47;2349324&#47;some-stuuf-here</code> is my expected result."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501675565, "post_id": 45459812, "comment_id": 77880797, "body": "Why not <code>&#47;sub&#47;48&#47;0&#47;</code>? How do you determine the correct link?"}, {"owner": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501675771, "post_id": 45459812, "comment_id": 77880968, "body": "@Stefan Thats the whole point. What I am trying is to make a bot that gives me the <code>&#47;torrent&#47;2349324&#47;some-stuuf-here&#47;</code> from a webpage. I have the very line from the webpage which is stored in <code>my_string</code>. I just want to extract the address from it. I determine the correct link by knowing that the correct link ends right with <code>&#47;&quot;&gt;</code> every time."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1501686426, "post_id": 45459812, "comment_id": 77889815, "body": "Please edit your question rather than elaborating in comments. Not all readers see all comments."}], "answers": [{"comments": [{"owner": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "edited": false, "score": 0, "creation_date": 1501678438, "post_id": 45461135, "comment_id": 77883187, "body": "Thank You very much Sir this works very well and also does what is needed. But with respect it does not answer my question. The question is &quot;How do i split using 2 keywords using regex&quot; in my case. Basically How do i merge those 2 regex splits.  The point here is to learn and not just to come to the answer. The required string could be extracted by splitting the string with <code>&quot;</code> and then selecting the 9th index but sincerely I want to learn and not just jump to the conclusions. Thanks anyways. Please add the solution to your answer. Thanks again for the answer."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "edited": false, "score": 0, "creation_date": 1501678722, "post_id": 45461135, "comment_id": 77883433, "body": "@Rishav You can use <code>|</code> to denote <i>or</i>, for example: <code>my_string.split(&#47;(?:href=&quot;|&#47;&quot;&gt;)&#47;)</code> will split either with <code>href=&quot;</code> or with <code>&#47;&quot;&gt;</code>. Is that what your are looking for?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6506253"}, "edited": false, "score": 1, "creation_date": 1501678852, "post_id": 45461135, "comment_id": 77883549, "body": "Damn That effort though. Upvoting. :)"}], "tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": true, "score": 1, "last_activity_date": 1501678842, "last_edit_date": 1501678842, "creation_date": 1501677503, "answer_id": 45461135, "question_id": 45459812, "link": "https://stackoverflow.com/questions/45459812/split-using-multiple-keywords-using-regex/45461135#45461135", "title": "Split using multiple keywords using regex", "body": "<p>You can take advantage of <em>lookahead</em> and <em>lookbehind</em>, like this:</p>\n\n<pre><code>my_string.scan(/(?&lt;=href=\").*(?=\\/\"&gt;)/)\n#=&gt; [\"/torrent/2349324/some-stuuf-here\"]\n</code></pre>\n\n<p>This will return an array with all occurrences of <code>href=\" ... /\"&gt;</code> with only the <code>...</code> part (which can be any string).</p>\n\n<p>Or you can get everything that matches <code>href=\".../\"&gt;</code> and then remove <code>href=\"</code> and the trailing <code>/\"&gt;</code>, something like this:</p>\n\n<pre><code>my_string.scan(/(?:href=\".*\\/\"&gt;)/).map { |e| e.gsub(/(href=\"|\\/\"&gt;)/, \"\") }\n#=&gt; [\"/torrent/2349324/some-stuuf-here\"]\n</code></pre>\n\n<p>This will return an array of all instances that match <code>/href=\".*\\/\"&gt;/</code>.</p>\n\n<blockquote>\n  <p>How do i split using 2 keywords using regex</p>\n</blockquote>\n\n<p>You can use a <code>|</code> to denote an <em>or</em> in regex, like this:</p>\n\n<pre><code>my_string.split(/(?:href=\"|/\"&gt;)/)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "edited": false, "score": 0, "creation_date": 1501681448, "post_id": 45462020, "comment_id": 77885750, "body": "Above my head. xD"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "edited": false, "score": 0, "creation_date": 1501682036, "post_id": 45462020, "comment_id": 77886277, "body": "@Rishav what exactly? CSS selectors?"}, {"owner": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "edited": false, "score": 0, "creation_date": 1501682400, "post_id": 45462020, "comment_id": 77886579, "body": "Your solution is giving the required result after installing the gem though.  But really I know only basic Ruby and batch commands.  Icon class  CSS n all r too far.  Thanks though. Learned something."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1501679888, "creation_date": 1501679888, "answer_id": 45462020, "question_id": 45459812, "link": "https://stackoverflow.com/questions/45459812/split-using-multiple-keywords-using-regex/45462020#45462020", "title": "Split using multiple keywords using regex", "body": "<p>Given this string:</p>\n\n<pre><code>string = &lt;&lt;-HTML\n  &lt;td class=\"coll-1 name\"&gt;\n    &lt;a href=\"/sub/48/0/\" class=\"icon\"&gt;&lt;i class=\"flaticon-divx\"&gt;&lt;/i&gt;&lt;/a&gt;\n    &lt;a href=\"/torrent/2349324/some-stuuf-here/\"&gt;SAME stuff here&lt;/a&gt;\n    &lt;span class=\"comments\"&gt;&lt;i class=\"flaticon-message\"&gt;&lt;/i&gt;1&lt;/span&gt;\n  &lt;/td&gt;\nHTML\n</code></pre>\n\n<p>and assuming that the correct link is the one without <code>icon</code> class, you could use the CSS selector <code>a:not(.icon)</code>, for example via <a href=\"http://www.nokogiri.org\" rel=\"nofollow noreferrer\">Nokogiri</a>:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::HTML::DocumentFragment.parse(string)\n\ndoc.at_css('a:not(.icon)')[:href]\n#=&gt; \"/torrent/2349324/some-stuuf-here/\"\n</code></pre>\n"}], "owner": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 45461135, "answer_count": 2, "score": 0, "last_activity_date": 1501679888, "creation_date": 1501673815, "last_edit_date": 1501675537, "question_id": 45459812, "link": "https://stackoverflow.com/questions/45459812/split-using-multiple-keywords-using-regex", "title": "Split using multiple keywords using regex", "body": "<p>Well I have a string containing (actually without line breaks)</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;td class=\"coll-1 name\"&gt;\n  &lt;a href=\"/sub/48/0/\" class=\"icon\"&gt;&lt;i class=\"flaticon-divx\"&gt;&lt;/i&gt;&lt;/a&gt;\n  &lt;a href=\"/torrent/2349324/some-stuuf-here/\"&gt;SAME stuff here&lt;/a&gt;\n  &lt;span class=\"comments\"&gt;&lt;i class=\"flaticon-message\"&gt;&lt;/i&gt;1&lt;/span&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>and I want an array to store the string which is split using <code>href=\"</code> and <code>/\"&gt;</code> specifically. How can i do that. I have tried this out.</p>\n\n<pre><code>new_array=my_string.split(/ href=\"  ,   \\/\"&gt;/)\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<pre><code>.split(/href=\"/)\n</code></pre>\n\n<p>This works  out too good but not with the other part.</p>\n\n<pre><code>.split(/\\/\"&gt;/)\n</code></pre>\n\n<p>Similarly this works too But i am unable to combine them together into 1 line.</p>\n"}, {"tags": ["javascript", "ruby", "modal-dialog"], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 7298790, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b3f79673c4aae407dcf4ac30c6e559ca?s=128&d=identicon&r=PG&f=1", "display_name": "nicodo", "link": "https://stackoverflow.com/users/7298790/nicodo"}, "is_accepted": false, "score": 0, "last_activity_date": 1518456744, "creation_date": 1518456744, "answer_id": 48752223, "question_id": 45459671, "link": "https://stackoverflow.com/questions/45459671/how-to-pass-data-from-ruby-loop-to-plain-javascript-modal-not-bootstrap/48752223#48752223", "title": "How to pass data from Ruby loop to plain JavaScript modal (not Bootstrap)", "body": "<p>Probably at the time I was overthinking it too much but there is nothing special about Middleman vs Rails. Based on a simple custom pop-up using jQuery and reusing all the code I mentioned above (including same projects.yml), this is I think one example of what I can do:</p>\n\n<pre><code>&lt;div class=\"shuffle-grid\"&gt;\n  &lt;% data.projects.each do |project, details| %&gt;\n  &lt;div class=\"open-me\" data-modal-idx=\"&lt;%= details.project_id %&gt;\"&gt;\n    &lt;div class=\"padded-card\"&gt;\n      &lt;div class=\"img-container\"&gt;&lt;%= image_tag &lt;%= details.card.image %&gt; %&gt;&lt;/div&gt;\n      &lt;div class=\"text-padd\"&gt;\n        &lt;div&gt;&lt;h3&gt;&lt;%= project %&gt;&lt;/h3&gt;&lt;/div&gt;\n        &lt;div&gt;&lt;h4&gt;&lt;%= details.card.text %&gt;&lt;/h4&gt;&lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div &gt;\n  &lt;div style=\"display: none\" class=\"pop-outer\" id=\"pop-outer-&lt;%= details.project_id %&gt;\"&gt;\n    &lt;div class=\"pop-inner\"&gt;\n      &lt;button class=\"close-me\"&gt;X&lt;/button&gt;\n      &lt;h2&gt;This is a custom pop-up example for card id n\u00b0&lt;%= details.project_id %&gt;&lt;/h2&gt;\n      &lt;p&gt;&lt;%= details.modal.title %&gt;&lt;/p&gt;\n      &lt;%= image_tag details.modal.img_banner %&gt;\n      (...)\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Modal is inside the card and jQuery is as follows:</p>\n\n<pre><code>$(document).ready(function(){\n  $('.open-me').click(function(){\n    var idx = $(this).attr('data-modal-idx');\n    var modalOpenMe = $('#pop-outer-' + idx);\n    modalOpenMe.fadeIn(\"slow\");\n    modalOpenMe.find('.close-me').click(function(){\n      modalOpenMe.fadeOut(\"slow\");\n    });\n  });\n});\n</code></pre>\n\n<p>A bit of css for the pop-up:</p>\n\n<pre><code>.pop-outer {\n  background-color: rgba(0, 0, 0, 0.5);\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.pop-inner {\n  background-color: #ffff;\n  width: 500px;\n  height: 350px;\n  padding: 30px;\n  margin: 15% auto;\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7298790, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b3f79673c4aae407dcf4ac30c6e559ca?s=128&d=identicon&r=PG&f=1", "display_name": "nicodo", "link": "https://stackoverflow.com/users/7298790/nicodo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518456744, "creation_date": 1501673459, "last_edit_date": 1503316414, "question_id": 45459671, "link": "https://stackoverflow.com/questions/45459671/how-to-pass-data-from-ruby-loop-to-plain-javascript-modal-not-bootstrap", "title": "How to pass data from Ruby loop to plain JavaScript modal (not Bootstrap)", "body": "<p>I want a grid of projects represented by cards. Clicking each card you get a modal with details for the project (title, banner image, description etc). I am using Middleman static site generator.</p>\n\n<p>I created a projects.yml file in a data folder:</p>\n\n<pre><code>\"Project 1\":\n     project_id: 1\n     card:\n         selector: HTML5-CSS3-JavaScript\n         image: project1-card.jpg\n         text: Middleman \u00b7 HTML5 &amp; CSS3 \u00b7 Ruby\n     modal:\n         title: A personal website.\n         img_banner: project1-modal.jpg\n         description:\n             title_left: What is it?\n             text_left:  A portfolio built with Middleman\n             title_right: Categories\n             text_right: HTML CSS Ruby Javascript\n             title_middle: whatever\n         body:\n             title_1: My personal website with Middleman\n             text_1: Lorem ipsum dolor sit amet....\n         etc.....\n\n\"Project 2\":\n    project_id: 2\n    card:\n        selector: RubyOnRails\n        image: project2-card.jpg\n        text: Rails \u00b7 HTML5 &amp; CSS3 \u00b7 Ruby\n    modal: \n        title: A yelp clone\n        img_banner: project2-modal.jpg\n        description:\n            title_left: What is it?\n            text_left:  A yelp clone\n            title_right: Categories\n            text_right: HTML CSS Ruby Rails\n            title_middle: whatever\n        body:\n            title_1: A yelp clone built with Rails\n            text_1: Lorem ipsum dolor sit amet....\n        etc.....\netc....\n</code></pre>\n\n<p>In projects.html.erb  my Ruby iteration is like this:</p>\n\n<pre><code>&lt;div class=\"shuffle-grid\"&gt;\n&lt;% data.projects.each do |project, details| %&gt;\n    &lt;div class=\"item trigger\" data-category=\"&lt;%= details.card.selector %&gt;\" data-modal-title=\"&lt;%= details.modal.title %&gt;\" data-modal-img-banner=\"&lt;%= details.modal.img_banner %&gt;\" data-modal-description-title-left=\"&lt;%= details.modal.description.title_left %&gt;\" data-modal-description-text-left=\"&lt;%= details.modal.description.text_left %&gt;\" data-modal-description-title-right=\"&lt;%= details.modal.description.title_right %&gt;\" data-modal-description-text-right=\"&lt;%= details.modal.description.text_right %&gt;\" &gt;\n        &lt;div class=\"padded-card\"&gt;\n            &lt;div class=\"img-container\"&gt;&lt;%= image_tag &lt;%= details.card.image %&gt; %&gt;&lt;/div&gt;\n            &lt;div class=\"text-padd\"&gt;\n                &lt;div&gt;&lt;h3&gt;&lt;%= project %&gt;&lt;/h3&gt;&lt;/div&gt;\n                &lt;div&gt;&lt;h4&gt;&lt;%= details.card.text %&gt;&lt;/h4&gt;&lt;/div&gt;\n            &lt;/div&gt;\n       &lt;/div&gt;\n  &lt;/div &gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And right after comes the modal:</p>\n\n<pre><code>&lt;div class=\"modal-overlay closed\" id=\"modal-overlay\"&gt;&lt;/div&gt;\n&lt;div class=\"modal closed\" id=\"modal\"&gt;\n    &lt;button class=\"close-button\" id=\"close-button\"&gt;Close&lt;/button&gt;\n    &lt;div class=\"modal-inner\"&gt;\n        &lt;div id='title-id'&gt;&lt;/div&gt;\n        &lt;div id='image-id'&gt;&lt;/div&gt;\n        &lt;div id='description-title_left-id'&gt;&lt;/div&gt;\n        &lt;div id='description-text_left-id'&gt;&lt;/div&gt;\n        &lt;div id='description-title_right-id'&gt;&lt;/div&gt;\n        &lt;div id='description-text_right-id'&gt;&lt;/div&gt;\n        etc...\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Obviously I know the solution I found is clunky passing all the parameters one by one in data-attributes and retrieving them in my javascript:</p>\n\n<pre><code> window.onload = function () {\n    'use strict';\n     var modal = document.querySelector(\"#modal\");\n     var modalOverlay = document.querySelector(\"#modal-overlay\");\n     var closeButton = document.querySelector(\"#close-button\");\n\n     closeButton.addEventListener(\"click\", function() {\n         modal.classList.toggle(\"closed\");\n         modalOverlay.classList.toggle(\"closed\");\n     });\n\n    $('.trigger').on('click', function() {\n        $('#title-id').html($(this).data('modal-title'));\n        var modal_img_banner = $(this).attr('data-modal-img-banner');\n        var img_to_insert = \"&lt;img src=/images/\" + modal_img_banner + \"&gt;\";\n        $('#image-id').html(img_to_insert);\n        $('#description-title_left-id').html($(this).data('modal-description-title-left'));\n        etc...\n        modal.classList.toggle(\"closed\");\n        modalOverlay.classList.toggle(\"closed\");\n   });\n};\n</code></pre>\n\n<p>What is the best solution in this situation? Is there a way to pass only the id of each project to the modal and then have this id populate each data directly into the view?</p>\n\n<p>If I had used Bootstrap modal instead this is what I could have done using data-target:</p>\n\n<pre><code>&lt;div class=\"shuffle-grid\"&gt;\n    &lt;% data.projects.each do |project, details| %&gt;\n        &lt;div class=\"item project_id-&lt;%= project_id %&gt;\" data-category=\"&lt;%= details.card.selector %&gt;\" data-toggle=\"modal\" data-target=\"#modal-project-&lt;%= project_id %&gt;\"&gt;\n            &lt;div class=\"padded-card\"&gt;\n                &lt;div class=\"img-container\"&gt;&lt;%= image_tag &lt;%= details.card.image %&gt; %&gt;&lt;/div&gt;\n                &lt;div class=\"text-padd\"&gt;\n                    &lt;div&gt;&lt;h3&gt;&lt;%= project %&gt;&lt;/h3&gt;&lt;/div&gt;\n                    &lt;div&gt;&lt;h4&gt;&lt;%= details.card.text %&gt;&lt;/h4&gt;&lt;/div&gt;\n                &lt;/div&gt;\n           &lt;/div&gt;\n      &lt;/div &gt;\n    &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And in the modal:</p>\n\n<pre><code>&lt;div class=\"modal fade\" id=\"modal-project-&lt;%= project_id %&gt;\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\"&gt;\n    &lt;button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"&gt;&lt;span aria-hidden=\"true\"&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;\n\n    &lt;div class=\"modal-dialog\" role=\"document\"&gt;\n        &lt;div class=\"modal-content\"&gt;\n            &lt;div class=\"modal-container\"&gt;\n                &lt;div class=\"modal-banner\"&gt;\n                    &lt;h2 class=\"modal-title\" id=\"myModalLabel\"&gt;&lt;%= details.modal.title %&gt;&lt;/h2&gt;\n                    &lt;%= image_tag details.modal.img_banner %&gt;\n                &lt;/div&gt;\n                &lt;div class=\"modal-description\"&gt;\n                    &lt;div class=\"left-col flex1\"&gt;\n                        &lt;div&gt;&lt;h4&gt;&lt;%= details.modal.description.title_left_1%&gt;&lt;/h4&gt;\n                etc....\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>What is the trick I am missing? Basically I'd like to do the same as with Bootstrap but with a vanilla JavaScript modal.</p>\n\n<p>Thank you all !</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "notifications", "actionmailer"], "comments": [{"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 3, "creation_date": 1501674731, "post_id": 45459167, "comment_id": 77880186, "body": "And what the question? You can add <code>def notify_me(order)</code> with <code>mail to: &#39;me@mystore.com&#39;</code> OR add <code>cc</code> or <code>bcc</code> to existing methods."}, {"owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1501682603, "post_id": 45459167, "comment_id": 77886733, "body": "Thank you @PavelMikhailyuk it is basically that I was asking for.... I havn&#39;t tested it yet, but I&#39;m sure it works!"}], "answers": [{"tags": [], "owner": {"reputation": 112, "user_id": 5733935, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b7c840376f4f8533a7693502f55fb6da?s=128&d=identicon&r=PG", "display_name": "Che", "link": "https://stackoverflow.com/users/5733935/che"}, "is_accepted": true, "score": 4, "last_activity_date": 1501685718, "creation_date": 1501685718, "answer_id": 45464277, "question_id": 45459167, "link": "https://stackoverflow.com/questions/45459167/get-notified-when-customer-place-an-order-in-ruby-on-rails-e-commerce-app/45464277#45464277", "title": "Get notified when customer place an order in ruby on rails e commerce app", "body": "<p>You could add a bcc options.</p>\n\n<pre><code>def received(order)\n @order = order\n mail(\n to: order.email,\n subject: 'My Store Concept Store'\n bcc:   %w[\n     my@email_adress.com\n     ]\n )\nend\n</code></pre>\n\n<p>for example</p>\n"}], "owner": {"reputation": 1019, "user_id": 5587988, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10207118714582472/picture?type=large", "display_name": "DaudiHell", "link": "https://stackoverflow.com/users/5587988/daudihell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 45464277, "answer_count": 1, "score": 1, "last_activity_date": 1501685718, "creation_date": 1501672072, "last_edit_date": 1501679668, "question_id": 45459167, "link": "https://stackoverflow.com/questions/45459167/get-notified-when-customer-place-an-order-in-ruby-on-rails-e-commerce-app", "title": "Get notified when customer place an order in ruby on rails e commerce app", "body": "<p>I'm working on my first E-commerce web app to learn Ruby on Rails.\nIt's a steep learning curve :) </p>\n\n<p>I need some guidance about how I can be notified by email when a customer place an order.</p>\n\n<p>So far I've manage to build a <code>order notifier</code> so the customer is notified when it's order is placed and shipped as shown below.</p>\n\n<p><em>mailers/order_notifier.rb</em></p>\n\n<pre><code>class OrderNotifier &lt; ApplicationMailer\n\n  default from: 'My Store Concept Store &lt;orders@mystore.com&gt;'\n\n  def received(order)\n    @order = order\n    mail to: order.email, subject: 'My Store Concept Store'\n  end\n\n  def shipped(order)\n    @order = order\n    mail to: order.email, subject: 'Order Shipped'\n  end\nend\n</code></pre>\n\n<p>this is working well but now I need to get notified my self via email, when user place an order at my store.</p>\n\n<p>Please can anyone help me?</p>\n"}, {"tags": ["ruby", "parsing"], "comments": [{"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1501672093, "post_id": 45459122, "comment_id": 77878320, "body": "I don&#39;t think it will be that easy. Where are you getting such string from?"}, {"owner": {"reputation": 10274, "user_id": 930207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oy7Q3.png?s=128&g=1", "display_name": "mcfinnigan", "link": "https://stackoverflow.com/users/930207/mcfinnigan"}, "edited": false, "score": 0, "creation_date": 1501672292, "post_id": 45459122, "comment_id": 77878467, "body": "This is pretty much the use case for parser generators such as as <a href=\"http://www.antlr.org/\" rel=\"nofollow noreferrer\">ANTLR</a> - if this is a custom syntax your options are to either hand-craft a parser or to use a parser generator such as ANTLR."}, {"owner": {"reputation": 548, "user_id": 987533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b838905086baf5cefc00961e8151cc0?s=128&d=identicon&r=PG", "display_name": "Anton K", "link": "https://stackoverflow.com/users/987533/anton-k"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1501672796, "post_id": 45459122, "comment_id": 77878848, "body": "@Surya I want to implement in my api the same syntax for selecting fields as facebook. Since objects are nested, syntax should also allow that."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1501684541, "post_id": 45459122, "comment_id": 77888294, "body": "@antulik What Facebook (and others like Spotify and GitHub) is using there is a standard language called GraphQL. There is a pretty complete Ruby gem also called <a href=\"http://graphql-ruby.org/\" rel=\"nofollow noreferrer\">graphql</a> which allows you to  implement your schema, the querying and many other aspects in your app."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1501694566, "post_id": 45459122, "comment_id": 77895331, "body": "As I said, you should have a look at the <a href=\"http://graphql-ruby.org/\" rel=\"nofollow noreferrer\">graphql gem</a> which (among other things) implements a parser for the <a href=\"http://graphql.org/\" rel=\"nofollow noreferrer\">GraphQL language</a>. Using this gem, you should be able to build your API as GraphQL endpoint without having to implement everything from scratch."}], "answers": [{"tags": [], "owner": {"reputation": 548, "user_id": 987533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b838905086baf5cefc00961e8151cc0?s=128&d=identicon&r=PG", "display_name": "Anton K", "link": "https://stackoverflow.com/users/987533/anton-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1501763682, "creation_date": 1501763682, "answer_id": 45484354, "question_id": 45459122, "link": "https://stackoverflow.com/questions/45459122/parse-json-like-syntax-to-ruby-object/45484354#45484354", "title": "Parse JSON like syntax to ruby object", "body": "<p>Wrote my own solution</p>\n\n<pre><code>module Parser\n  extend self\n\n  def parse str\n    parse_list(str).map do |i|\n      extract_item_fields i\n    end\n  end\n\n  def extract_item_fields item\n    field_name, fields_str = item.scan(/(.+?){(.+)}/).flatten\n\n    if field_name.nil?\n      item\n    else\n      fields = parse_list fields_str\n      result = fields.map { |field| extract_item_fields(field) }\n\n      { field_name =&gt; result }\n    end\n  end\n\n  def parse_list list\n    return list if list.nil?\n    list.concat(',').scan(/([^,{}]+({.+?})?),/).map(&amp;:first).map(&amp;:strip)\n  end\nend\n\nstr = 'album{name, photo{name, picture, tags}}, post{id}'\nputs Parser.parse(str).inspect\n# =&gt; [{\"album\"=&gt;[\"name\", {\"photo\"=&gt;[\"name\", \"picture\", \"tags\"]}]}, {\"post\"=&gt;[\"id\"]}]\n</code></pre>\n"}], "owner": {"reputation": 548, "user_id": 987533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b838905086baf5cefc00961e8151cc0?s=128&d=identicon&r=PG", "display_name": "Anton K", "link": "https://stackoverflow.com/users/987533/anton-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1501763682, "creation_date": 1501671964, "last_edit_date": 1501700451, "question_id": 45459122, "link": "https://stackoverflow.com/questions/45459122/parse-json-like-syntax-to-ruby-object", "title": "Parse JSON like syntax to ruby object", "body": "<p>Simple parser which turned out to be much harder than i thought. I need a string parser to convert nested fields to ruby object. In my case api response will only return desired fields.</p>\n\n<p>Given </p>\n\n<pre><code>Parser.parse \"album{name, photo{name, picture, tags}}, post{id}\"\n</code></pre>\n\n<p>Desired output or similar</p>\n\n<pre><code>{album: [:name, photo: [:name, :picture, :tags]], post: [:id]}\n</code></pre>\n\n<p>Any thoughts? </p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501671669, "post_id": 45458939, "comment_id": 77878011, "body": "Which example fails? Could you show the failure message?"}, {"owner": {"reputation": 47, "user_id": 8311486, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AtvdVZFgke4/AAAAAAAAAAI/AAAAAAAABVc/8DON_j6WKlE/photo.jpg?sz=128", "display_name": "radioactive001", "link": "https://stackoverflow.com/users/8311486/radioactive001"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501671847, "post_id": 45458939, "comment_id": 77878145, "body": "` Failure/Error: expect(@timer.seconds).to eq(0)              expected: 0             got: nil`"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1501672918, "post_id": 45458939, "comment_id": 77878934, "body": "BTW, your <code>seconds=</code> method is redundant \u2013 <code>attr_accessor :seconds</code> implements that method for you. On the other hand, you can remove <code>attr_accessor :time_string</code> because you probably don&#39;t want to set <code>@time_string</code> from the outside. That said, <code>@time_string=</code> is superfluous (the instance variable is never used), you can just return the string. And you might want to take a look at <a href=\"http://ruby-doc.org/core-2.4.1/Numeric.html#method-i-divmod\" rel=\"nofollow noreferrer\"><code>divmod</code></a>, e.g. <code>h, m = m.divmod(60)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 3, "last_activity_date": 1501671963, "creation_date": 1501671963, "answer_id": 45459121, "question_id": 45458939, "link": "https://stackoverflow.com/questions/45458939/ruby-returning-unexpected-nil/45459121#45459121", "title": "Ruby Returning unexpected nil", "body": "<p>That's because you initialize <code>Timer.new</code> without any arguments. Thus, the <code>seconds</code> is <code>nil</code></p>\n\n<p>You need either:</p>\n\n<pre><code>before(:each) do\n  @timer = Timer.new\n  @timer.seconds = 0\nend\n</code></pre>\n\n<p>Or implement an initializer:</p>\n\n<pre><code>class Timer\n  attr_accessor :seconds, :time_string\n\n  def initialize\n    @seconds = 0\n  end\n  ...\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8311486, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AtvdVZFgke4/AAAAAAAAAAI/AAAAAAAABVc/8DON_j6WKlE/photo.jpg?sz=128", "display_name": "radioactive001", "link": "https://stackoverflow.com/users/8311486/radioactive001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 45459121, "answer_count": 1, "score": 1, "last_activity_date": 1501672493, "creation_date": 1501671441, "last_edit_date": 1501672493, "question_id": 45458939, "link": "https://stackoverflow.com/questions/45458939/ruby-returning-unexpected-nil", "title": "Ruby Returning unexpected nil", "body": "<p>I have a RSpec problem. According to that problem I have written a solution in ruby. But when running with RSpec Where I expect to get a value, I am getting <code>nil</code> here is the RSpec </p>\n\n<pre><code>require 'timer'\n\ndescribe \"Timer\" do\n  before(:each) do\n    @timer = Timer.new\n  end\n\n  it \"should initialize to 0 seconds\" do\n    expect(@timer.seconds).to eq(0)\n  end\n\n  describe 'time_string' do\n    it \"should display 0 seconds as 00:00:00\" do\n      @timer.seconds = 0\n      expect(@timer.time_string).to eq(\"00:00:00\")\n    end\n\n    it \"should display 12 seconds as 00:00:12\" do\n      @timer.seconds = 12\n      expect(@timer.time_string).to eq(\"00:00:12\")\n    end\n\n    it \"should display 66 seconds as 00:01:06\" do\n      @timer.seconds = 66\n      expect(@timer.time_string).to eq(\"00:01:06\")\n    end\n\n    it \"should display 4000 seconds as 01:06:40\" do\n      @timer.seconds = 4000\n      expect(@timer.time_string).to eq(\"01:06:40\")\n    end\n  end\n</code></pre>\n\n<p>Here's the solution I wrote:</p>\n\n<pre><code>class Timer\n     attr_accessor :seconds, :time_string\n\n\n    def seconds=(num)\n     @seconds=num\n   end #seconds\n\n\n     def time_string\n       s=@seconds%60\n       m=@seconds/60\n       h=m/60\n       m=m%60\n       @time_string=\"%02d:%02d:%02d\" %[h,m,s]\n     end #time_string\nend #class\n</code></pre>\n\n<p>Error I am getting </p>\n\n<pre><code> Failure/Error: expect(@timer.seconds).to eq(0)\n\n       expected: 0\n            got: nil\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "ruby-on-rails-3", "devise"], "comments": [{"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 1, "creation_date": 1501684415, "post_id": 45458912, "comment_id": 77888174, "body": "could you post the error please."}, {"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1501684498, "post_id": 45458912, "comment_id": 77888248, "body": "Also do you have a create method? if so, could you use a byebug and post your params please."}, {"owner": {"reputation": 1418, "user_id": 493674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134075878cc4e13e36a6099c277381a5?s=128&d=identicon&r=PG", "display_name": "Vijay Agrawal", "link": "https://stackoverflow.com/users/493674/vijay-agrawal"}, "edited": false, "score": 0, "creation_date": 1501703959, "post_id": 45458912, "comment_id": 77900859, "body": "Like Gabriel mentioned, please narrow post the specific error you get, is User validation failing?, are params not making back to controller?, are params not in the format they way they are permitted in <code>signup_params</code>"}], "owner": {"reputation": 81, "user_id": 6513027, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ec277bb373975eea2c0037fd5f8fabfe?s=128&d=identicon&r=PG&f=1", "display_name": "antonyCas", "link": "https://stackoverflow.com/users/6513027/antonycas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501671381, "creation_date": 1501671381, "question_id": 45458912, "link": "https://stackoverflow.com/questions/45458912/unable-to-create-a-user-using-a-custom-form-using-devise-in-ruby-on-rails", "title": "Unable to create a user using a custom form using devise in ruby on rails", "body": "<p>Im having a problem creating a devise user using a custom form. Whenever I submit the form I get an error saying the email and password fields cant be blank, It seems that the problem is something to do with the parameters not being permitted. I Have tried creating my own sign_up_params method to permit them manually but it still doesn't work and keep seeing the error.</p>\n\n<p>Here is my code:</p>\n\n<p>This is the form I am submitting:</p>\n\n<pre><code>&lt;div class=\"panel panel-default\"&gt;\n    &lt;div class=\"panel-heading\"&gt;\n        &lt;h4&gt;Sign Up&lt;/h4&gt;\n   &lt;/div&gt;\n   &lt;div class=\"panel-body\"&gt;\n      &lt;%= form_for resource, url: user_registration_path do |f| %&gt;\n        &lt;%= devise_error_messages! %&gt;\n\n        &lt;div class=\"form-group row\"&gt;\n            &lt;%= f.label :email, \"Email: \", class: \"col-sm-2\" %&gt;\n            &lt;div class=\"col-sm-10\"&gt;\n                &lt;%= f.email_field :email, class: 'form-control' %&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group row\"&gt;\n            &lt;%= f.label :password, \"Password: \", class: \"col-sm-2 col-form-label\" %&gt;\n            &lt;div class=\"col-sm-10\"&gt;\n                &lt;%= f.password_field :password, class: 'form-control' %&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group row\"&gt;\n            &lt;%= f.label :password_confirmation, \"Confirmation: \", class: \"col-sm-2 col-form-label\" %&gt;\n            &lt;div class=\"col-sm-10\"&gt;\n                &lt;%= f.password_field :password_confirmation, class: 'form-control' %&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;%= f.submit \"Sign Up\", class: 'btn btn-primary' %&gt;\n    &lt;% end %&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And this is the controller: </p>\n\n<pre><code>class Users::RegistrationsController &lt; Devise::RegistrationsController\n    include DeviseHelper\n\n    def new\n    end\n\n    protected\n\n    def sign_up_params\n        params.require(:user).permit(:email, :password, :password_confirmation)\n    end\nend\n</code></pre>\n\n<p>Also my routes file:</p>\n\n<pre><code>Rails.application.routes.draw do\n    root 'users/registrations#new'\n  devise_for :users, controllers: {registrations: 'users/registrations', sessions: 'users/sessions'}\nend\n</code></pre>\n\n<p>This is really starting to bug me now as Ive set up devise plenty of times before and never had this issue. If anyone could help me out here it would be really appreciated</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "radio-button", "e-commerce"], "comments": [{"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1501684659, "post_id": 45458647, "comment_id": 77888398, "body": "Have you tried to use radio_button_Tag?  <a href=\"https://apidock.com/rails/ActionView/Helpers/FormTagHelper/radio_button_tag\" rel=\"nofollow noreferrer\">apidock.com/rails/ActionView/Helpers/FormTagHelper/&hellip;</a>"}, {"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1501684854, "post_id": 45458647, "comment_id": 77888555, "body": "One other thing, do you think that a radio button is correct for this functionality? A select dropdown would not be better?"}, {"owner": {"reputation": 491, "user_id": 8404695, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/W3DQM.jpg?s=128&g=1", "display_name": "codegirl", "link": "https://stackoverflow.com/users/8404695/codegirl"}, "reply_to_user": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1501685178, "post_id": 45458647, "comment_id": 77888829, "body": "Hi @GabrielMesquita  no I haven&#39;t used  the <code>radio_button_Tag</code>... I&#39;m not sure what is correct for this functionality, maybe the select dropdown would be better.  I&#39;m getting kind of lost in this all :)  Could you post how you would do this??"}, {"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1501685248, "post_id": 45458647, "comment_id": 77888891, "body": "Ok I will try.."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1501687785, "post_id": 45458647, "comment_id": 77890887, "body": "I strongly recommend you to use a column <code>delivery_type</code> (string) instead of <code>pick_up</code> (bool) for flexibility reasons. Then you can ensure the presence of this <code>delivery_type</code> attribute with a validates and also make sure the value is valid (use a constant as whitelist). Then in the Admin pages, you can just display the <code>delivery_type</code> and the address when relevant."}], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 8404695, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/W3DQM.jpg?s=128&g=1", "display_name": "codegirl", "link": "https://stackoverflow.com/users/8404695/codegirl"}, "edited": false, "score": 1, "creation_date": 1501686808, "post_id": 45464261, "comment_id": 77890125, "body": "Thanks @GabrielMesquita,  I&#39;m not sure why I should change the <code>t.boolean</code> to string since boolean is either true or false. The database will see either true = sent product or false = pick up products."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 491, "user_id": 8404695, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/W3DQM.jpg?s=128&g=1", "display_name": "codegirl", "link": "https://stackoverflow.com/users/8404695/codegirl"}, "edited": false, "score": 1, "creation_date": 1501687465, "post_id": 45464261, "comment_id": 77890643, "body": "@codegirl a boolean type is, like you said, true or false (or nil but that should be handled by your code/DB). What if tomorrow your boss wants you to add another type of delivery, let&#39;s say <code>pigeons</code>? You would have to convert this boolean column to string type and update the existing data depending on its current value, etc. See where I am going? You are currently implementing a feature that can potentially become something bigger, try to produce a flexible code/DB structure right now so you won&#39;t have to spent a lot of effort if that eventuality comes."}, {"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501689899, "post_id": 45464261, "comment_id": 77892438, "body": "Like @MrYoshiji said, string is more flexible and i think it solves your issue. If the answer helped, please give an upvote :)"}], "tags": [], "owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "is_accepted": false, "score": 2, "last_activity_date": 1501685675, "creation_date": 1501685675, "answer_id": 45464261, "question_id": 45458647, "link": "https://stackoverflow.com/questions/45458647/saving-boolean-values-to-postgres-database-using-ruby-on-rails/45464261#45464261", "title": "saving boolean values to postgres database using ruby on rails", "body": "<p>So you want to know if the product is going to be picked up at the store or sent by email correct?</p>\n\n<p>Since you are lost, a simpler solution would be:</p>\n\n<p>1 - Change the  t.boolean  \"pick_up\" to  t.string  \"pick_up\"</p>\n\n<p>2 - use this <a href=\"http://guides.rubyonrails.org/form_helpers.html#the-select-and-option-tags\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/form_helpers.html#the-select-and-option-tags</a>, to create a list with this two options.</p>\n\n<p>3 - In your controller save the option the user wants.</p>\n\n<p>I think that in order to use radio buttons, you must have two fields in your database. Something like this: </p>\n\n<p>t.boolean  \"pick_up\"\nt.boolean  \"sent_email\"</p>\n\n<p>if the user choose to pick up, you will receive a param with a true value for pick up, then you can save on you database. So this is another option too!</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 491, "user_id": 8404695, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/W3DQM.jpg?s=128&g=1", "display_name": "codegirl", "link": "https://stackoverflow.com/users/8404695/codegirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1198, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1501685675, "creation_date": 1501670634, "last_edit_date": 1501683802, "question_id": 45458647, "link": "https://stackoverflow.com/questions/45458647/saving-boolean-values-to-postgres-database-using-ruby-on-rails", "title": "saving boolean values to postgres database using ruby on rails", "body": "<p>I've been working on a old rails project for a bit now. Since I haven't worked with rails in some time I'm a bit rusty and need some help along the way.</p>\n\n<p>The thing is that I'm adding a pick up options to a E commerce web.</p>\n\n<p>The backend is driven by <code>active admin</code></p>\n\n<p>When the customer is checking out its product.\nHe gets the option to pick it up in the store or have it sent.</p>\n\n<p>And I want the order to show in the backend whether the product should be sent or if it is picked up at the store. </p>\n\n<p>I'm kind of stuck here, and the delivery options don't seems to be saving to the database.... It would be so nice if someone could help me with this. </p>\n\n<p>here is the html for the pick up option. it is located in the <code>views/orders/_form.html.erb</code></p>\n\n<pre><code>&lt;div class=\"col-md-5 pick-up-buttons\" id=\"country_div\"&gt;\n  &lt;li&gt;\n    &lt;%= f.radio_button :pick_up, \"1\", checked: false, data: { question: \"Pick up your items in the store\" } %&gt; \n    &lt;%= f.label :pick_up, \"Pick up your items in the store\" %&gt;\n  &lt;/li&gt;\n  &lt;li&gt;\n    &lt;%= f.radio_button :pick_up, \"0\", checked: true,  data: { question: \"Send the items by mail\" } %&gt; \n    &lt;%= f.label :pick_up, \"Send the items by mail\" %&gt;\n  &lt;/li&gt;\n&lt;/div&gt; \n</code></pre>\n\n<p>and here is a part of the <code>schema.rb</code> file  </p>\n\n<pre><code>create_table \"orders\", force: :cascade do |t|\n  t.string   \"name\"\n  t.string   \"email\"\n  t.text     \"address\"\n  t.string   \"city\"\n  t.string   \"country\"\n  t.datetime \"created_at\",                 null: false\n  t.datetime \"updated_at\",                 null: false\n  t.boolean  \"shipped\",    default: false\n  t.boolean  \"pick_up\",    default: false\n  t.string   \"delivery\"\nend\n</code></pre>\n\n<p>And here is the <code>orders_controller.rb</code></p>\n\n<pre><code>class OrdersController &lt; ApplicationController\n  include CurrentCart\n  before_action :set_cart, only: [:new, :create]\n  before_action :set_order, only: [:show, :edit, :destroy]\n\n  def index\n    @orders = Order.all? \n  end\n\n  def new\n    @images  = [\"1.jpg\", \"2.jpg\", \"3.jpg\", \"4.jpg\", \"5.jpg\"]\n    @random_no = rand(5)\n    @random_image = @images[@random_no]\n\n    if @cart.product_items.empty?\n      redirect_to root_url, notice: 'Your Cart is Empty'\n      return\n    end\n\n    @order = Order.new\n    @client_token = Braintree::ClientToken.generate\n\n    @del_cost_euro = 20\n  end\n\n  def create\n    @order = Order.new(order_params)\n    if @order.save\n      charge\n      if @result.success?\n        @order.add_product_items_from_cart(@cart)\n        Cart.destroy(session[:cart_id])\n        session[:cart_id] = nil\n        OrderNotifier.received(@order).deliver \n        redirect_to root_url, notice: 'Thank You for Your Order'\n      else\n        flash[:error] = 'Please Check Your Cart'\n        redirect_to root_url, alert: @result.message\n        @order.destroy\n      end\n    else\n      @client_token = Braintree::ClientToken.generate\n      render :new\n    end\n  end\n\n  def show\n  end\n\n  def destroy\n    @order.destroy\n    redirect_to root_url, notice: 'Order deleted'\n  end\n\n  private\n  def set_order\n    @order = Order.find(params[:id])\n  end\n\n  def order_params\n    params.require(:order).permit(:name, :email, :address, :city, :country, :pick_up, :delivery)\n  end\n\n  def charge\n    @result = Braintree::Transaction.sale(\n      amount: @cart.total_price_usd,\n      payment_method_nonce: params[:payment_method_nonce] )\n  end\nend\n</code></pre>\n\n<p>And here is the <code>app/admin/order.rb</code></p>\n\n<pre><code>ActiveAdmin.register Order do\n\npermit_params :shipped\n\nafter_update do |order|\n  OrderNotifier.shipped(@order).deliver if order.shipped\nend\n\nshow do |order|\n  panel 'Customer Details' do\n    attributes_table_for order, :name, :email, :address, :city, :country\n  end\n\n  panel 'Created' do\n    \"#{time_ago_in_words order.created_at} ago\"\n  end\n\n  panel 'Shipped' do\n    order.shipped\n  end\n\n  panel 'delivery' do\n    order.pick_up\n  end\n\n  panel 'Order Details' do\n    table_for(order.product_items) do \n      column 'Product' do |item|\n        item.product.title\n      end\n\n      column 'Quantity' do |item|\n        item.quantity\n      end\n\n      column 'Price Euro' do |item|\n        number_to_currency item.total_price_eur\n      end\n\n      column 'Price USD' do |item|\n        number_to_currency item.total_price_usd\n      end\n    end\n  end\n\n  panel 'Order Total USD' do \n    number_to_currency order.total_price_usd\n  end\n\n  panel 'Order Total Euro' do \n    number_to_currency order.total_price_eur\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "google-chrome", "selenium", "selenium-webdriver", "headless"], "comments": [{"owner": {"reputation": 5366, "user_id": 3122133, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WGob2.jpg?s=128&g=1", "display_name": "Madhan", "link": "https://stackoverflow.com/users/3122133/madhan"}, "edited": false, "score": 0, "creation_date": 1501669732, "post_id": 45457447, "comment_id": 77876647, "body": "are you using any maximize function?"}, {"owner": {"reputation": 12669, "user_id": 1482709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ef49d195f8555bdc65d793cf965a2f6f?s=128&d=identicon&r=PG", "display_name": "Prashanth Sams", "link": "https://stackoverflow.com/users/1482709/prashanth-sams"}, "reply_to_user": {"reputation": 5366, "user_id": 3122133, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WGob2.jpg?s=128&g=1", "display_name": "Madhan", "link": "https://stackoverflow.com/users/3122133/madhan"}, "edited": false, "score": 0, "creation_date": 1501669865, "post_id": 45457447, "comment_id": 77876741, "body": "ah, thats the villain... thanks Madhan; can you please answer the same in this post"}], "answers": [{"tags": [], "owner": {"reputation": 5366, "user_id": 3122133, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WGob2.jpg?s=128&g=1", "display_name": "Madhan", "link": "https://stackoverflow.com/users/3122133/madhan"}, "is_accepted": true, "score": 1, "last_activity_date": 1501671747, "creation_date": 1501671747, "answer_id": 45459039, "question_id": 45457447, "link": "https://stackoverflow.com/questions/45457447/unknown-error-cannot-get-automation-extension/45459039#45459039", "title": "unknown error: cannot get automation extension", "body": "<p>This is a known issue in chromedriver. As mentioned in the <a href=\"https://github.com/SeleniumHQ/selenium/issues/3508#issuecomment-285653089\" rel=\"nofollow noreferrer\">github</a></p>\n\n<blockquote>\n  <p>This is a long standing issue with Chromedriver. The window resizing\n  doesn't work with the chromedriver and the community is silent on this\n  bug fix. If the resizing is not critical for your tests, I would\n  suggest you avoid the manage() method altogether and use a workaround\n  of having your browser window always maximized using the ChromeOptions\n  object at the launch of your chromedriver instantiation.</p>\n</blockquote>\n\n<p>Though it is not happening to everyone, the issue still exists. It is mostly resolved by updating chrome or chromedriver to the latest version(still wont work for most people)</p>\n\n<p>So better not to use maximize or resizing activity on chrome .However if you want, you can go with <code>ChromeOptions</code> which is suggested by <a href=\"https://sites.google.com/a/chromium.org/chromedriver/capabilities\" rel=\"nofollow noreferrer\">ChromeDriver</a></p>\n\n<pre><code>ChromeOptions options = new ChromeOptions();\noptions.addArguments(\"start-maximized\");\n</code></pre>\n"}], "owner": {"reputation": 12669, "user_id": 1482709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ef49d195f8555bdc65d793cf965a2f6f?s=128&d=identicon&r=PG", "display_name": "Prashanth Sams", "link": "https://stackoverflow.com/users/1482709/prashanth-sams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 45459039, "answer_count": 1, "score": 0, "last_activity_date": 1501671747, "creation_date": 1501667599, "question_id": 45457447, "link": "https://stackoverflow.com/questions/45457447/unknown-error-cannot-get-automation-extension", "title": "unknown error: cannot get automation extension", "body": "<p>Unable to run tests in <strong>headless</strong> mode; it doesn't seem to be an issue with snippet, cos i tried it in different ways and outcome is the same.</p>\n\n<pre><code>  caps = Selenium::WebDriver::Remote::Capabilities.chrome(chromeOptions: { binary: \"/Applications/Google\\ Chrome.app/Contents/MacOS/Google\\ Chrome\",\n                                                                           args: [ \"--headless\" ]})\n  @driver = Selenium::WebDriver.for :chrome, desired_capabilities: caps\n</code></pre>\n\n<p><strong>Error</strong></p>\n\n<pre><code>unknown error: cannot get automation extension\nfrom unknown error: page could not be found: chrome-extension://aapnijgdinlhnhlmodcfapnahmbfebeb/_generated_background_page.html\n    (Session info: headless chrome=59.0.3071.115)\n    (Driver info: chromedriver=2.31.488774 (7e15618d1bf16df8bf0ecf2914ed1964a387ba0b),platform=Mac OS X 10.12.3 x86_64) (Selenium::WebDriver::Error::UnknownError)\n</code></pre>\n\n<blockquote>\n  <p><strong>Chrome browser:</strong> 59.0.3071.115 (latest) </p>\n  \n  <p><strong>Chrome driver:</strong> chromedriver=2.31.488774 (latest)</p>\n  \n  <p><strong>Language used:</strong> Ruby</p>\n</blockquote>\n"}, {"tags": ["php", "html", "ruby", "api"], "comments": [{"owner": {"reputation": 2548, "user_id": 4369087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5908bc8d0b3b540f2e34a4af722e42fc?s=128&d=identicon&r=PG", "display_name": "yoeunes", "link": "https://stackoverflow.com/users/4369087/yoeunes"}, "edited": false, "score": 0, "creation_date": 1501666346, "post_id": 45456893, "comment_id": 77874209, "body": "you can use curl for that, or use a library for more functionnality like guzzle: <a href=\"http://docs.guzzlephp.org\" rel=\"nofollow noreferrer\">docs.guzzlephp.org</a>"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501666659, "post_id": 45456996, "comment_id": 77874438, "body": "Guzzle seems useful and it&#39;s not mentioned in the linked post. Would you please also add this answer there (because that question is far more googlable)?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501666670, "post_id": 45456996, "comment_id": 77874447, "body": "And then you can delete this one."}], "tags": [], "owner": {"reputation": 2548, "user_id": 4369087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5908bc8d0b3b540f2e34a4af722e42fc?s=128&d=identicon&r=PG", "display_name": "yoeunes", "link": "https://stackoverflow.com/users/4369087/yoeunes"}, "is_accepted": false, "score": 0, "last_activity_date": 1501666468, "creation_date": 1501666468, "answer_id": 45456996, "question_id": 45456893, "link": "https://stackoverflow.com/questions/45456893/ruby-get-request-to-php-get-request/45456996#45456996", "title": "Ruby get request to PHP get request", "body": "<p>i suggest using guzzle : </p>\n\n<p><a href=\"http://docs.guzzlephp.org/en/stable/\" rel=\"nofollow noreferrer\">http://docs.guzzlephp.org/en/stable/</a></p>\n\n<pre><code>$client = new GuzzleHttp\\Client();\n$res = $client-&gt;request('GET', 'https://api.github.com/user', [\n    'auth' =&gt; ['user', 'pass']\n]);\necho $res-&gt;getStatusCode();\n// \"200\"\necho $res-&gt;getHeader('content-type');\n// 'application/json; charset=utf8'\necho $res-&gt;getBody();\n// {\"type\":\"User\"...'\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8404585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213729443651227/picture?type=large", "display_name": "Mathias Huse Jensen", "link": "https://stackoverflow.com/users/8404585/mathias-huse-jensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "closed_date": 1501666345, "answer_count": 1, "score": 1, "last_activity_date": 1501668290, "creation_date": 1501666219, "last_edit_date": 1501668290, "question_id": 45456893, "link": "https://stackoverflow.com/questions/45456893/ruby-get-request-to-php-get-request", "closed_reason": "Duplicate", "title": "Ruby get request to PHP get request", "body": "<p>I am currently working on a website in which I use PHP.\nI want to make a get request like the one shown here in Ruby code:</p>\n\n<pre><code>response = RestClient::Request.execute(\n:method  =&gt; :get,\n:url     =&gt; 'https://api.place2book.com/event_api/available_tickets',\n:timeout =&gt; 5,\n:headers =&gt; {\n'X-PLACE2BOOK-API-TOKEN' =&gt; 'foobar789baz7674',\n'X-PLACE2BOOK-EVENT-ID' =&gt; 123456\n}\n)\n\nresponse.headers[:available_tickets]\n</code></pre>\n\n<p>However I do not know much of API Get requests in PHP.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "json", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1302, "user_id": 6612655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fAsxJ.jpg?s=128&g=1", "display_name": "alopez02", "link": "https://stackoverflow.com/users/6612655/alopez02"}, "edited": false, "score": 0, "creation_date": 1501668862, "post_id": 45457412, "comment_id": 77876032, "body": "Thanks a lot Ho. It looks that this is a much sensible approach. Let me try it and go back to you.  One more thing though that method twitter_profile that you suggested where should it be set up. I am confused as there&#39;s no model Intel and it couldn&#39;t be an instance method of the Profile model as I haven&#39;t created  the object yet. Could you advise further?"}, {"owner": {"reputation": 1302, "user_id": 6612655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fAsxJ.jpg?s=128&g=1", "display_name": "alopez02", "link": "https://stackoverflow.com/users/6612655/alopez02"}, "edited": false, "score": 0, "creation_date": 1501671405, "post_id": 45457412, "comment_id": 77877840, "body": "Shouldn&#39;t it be something like the code below added in application_record.rb  `  def twitter_profile     return unless self.social_profiles     self.social_profiles.select { |slot| slot.type_name == &quot;Twitter&quot; }.first   end`"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1501687102, "post_id": 45457412, "comment_id": 77890361, "body": "<code>return unless @intel.social_profiles.present?</code> would be better (if <code>social_profiles</code> is an empty array, then it will always be truthy). Also, doing <code>[].select { |el| el.some_cond? }.first</code> can be changed to <code>[].find { |el| el.some_cond? }</code> so will stop at the first truthy occurence and not execute the block for each array&#39;s element."}, {"owner": {"reputation": 2110, "user_id": 2146879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NMsq7.jpg?s=128&g=1", "display_name": "Ho Man", "link": "https://stackoverflow.com/users/2146879/ho-man"}, "reply_to_user": {"reputation": 1302, "user_id": 6612655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fAsxJ.jpg?s=128&g=1", "display_name": "alopez02", "link": "https://stackoverflow.com/users/6612655/alopez02"}, "edited": false, "score": 0, "creation_date": 1501725007, "post_id": 45457412, "comment_id": 77907879, "body": "@andrew It could be just a private method in the controller. Or if it becomes too much there, you could create a service object that hides all these creation logic away from the controller. So you might have like ProfileCreator.new(@intel).perform (and this returns a profile)"}, {"owner": {"reputation": 1302, "user_id": 6612655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fAsxJ.jpg?s=128&g=1", "display_name": "alopez02", "link": "https://stackoverflow.com/users/6612655/alopez02"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501757072, "post_id": 45457412, "comment_id": 77924196, "body": "@MrYoshiji, Ho. Thanks both for your very useful advice. It make sense now"}], "tags": [], "owner": {"reputation": 2110, "user_id": 2146879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NMsq7.jpg?s=128&g=1", "display_name": "Ho Man", "link": "https://stackoverflow.com/users/2146879/ho-man"}, "is_accepted": true, "score": 2, "last_activity_date": 1501771934, "last_edit_date": 1501771934, "creation_date": 1501667486, "answer_id": 45457412, "question_id": 45456773, "link": "https://stackoverflow.com/questions/45456773/best-way-to-iterate-through-a-json-object-to-create-a-ruby-object/45457412#45457412", "title": "Best way to iterate through a JSON object to create a ruby object", "body": "<p>You can use a combination of <code>.first</code>, <code>.try</code>. (and <code>.dig</code> if you're on ruby 2.3) to avoid exceptions when accessing them.</p>\n\n<p><code>.try</code> will just return nil if it can't be found. For example:</p>\n\n<pre><code>{ a: 2 }.try(:b) # returns nil \n</code></pre>\n\n<p><code>.dig</code> is like <code>.try</code>, but it can go multiple levels so this might be useful for deeply nested ones.</p>\n\n<pre><code>[['a'], ['a','b']].dig(0, 1) # first element, then second element - nil\n[['a'], ['a','b']].dig(1, 1) # second, then second again - 'b'\n\n{ a: [1, 2] }.dig(:a, 0) # 1\n{ a: [1, 2] }.dig(:a, 2) # nil\n\nfoo = OpenStruct.new\nfoo.bar = \"foobar\"\n{ b: foo }.dig(:b, :bar) # 'foobar'\n\n@intel.dig(:contact_info, :full_name)\n@intel.dig(:organizations, :first, :name)\n</code></pre>\n\n<p>For the last part, you can also refactor it in this way:</p>\n\n<pre><code>def twitter_profile\n  return unless @intel.social_profiles.present?\n  @intel.social_profiles.find { |slot| slot.type_name == \"Twitter\" }\nend\n\ntwitter: twitter_profile.try(:url),\ntwitter_followers: twitter_profile.try(:followers).to_i,\ntwitter_followings: twitter_profile.try(:followings).to_i,\n</code></pre>\n\n<p><code>twitter_profile</code> could be a private method in the controller. If you find that you start to have too many of these, you could have a service object for the creation of a profile.</p>\n\n<pre><code>class ProfileCreatorService\n  def initialize(intel)\n    @intel = intel\n  end\n\n  def perform\n    AutomaticProfile.new(...)\n  end\n\n  private \n\n  def twitter_profile\n    return unless @intel.social_profiles.present?\n    @intel.social_profiles.find { |slot| slot.type_name == \"Twitter\" }\n  end\n\n  ..\nend\n</code></pre>\n"}], "owner": {"reputation": 1302, "user_id": 6612655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fAsxJ.jpg?s=128&g=1", "display_name": "alopez02", "link": "https://stackoverflow.com/users/6612655/alopez02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 45457412, "answer_count": 1, "score": 1, "last_activity_date": 1501771934, "creation_date": 1501665984, "question_id": 45456773, "link": "https://stackoverflow.com/questions/45456773/best-way-to-iterate-through-a-json-object-to-create-a-ruby-object", "title": "Best way to iterate through a JSON object to create a ruby object", "body": "<p>I'm getting a <a href=\"https://www.fullcontact.com/developer/\" rel=\"nofollow noreferrer\">FullContact API</a> response in the form of a JSON object with some nested arrays that contain a set of contact details. I'd like to create an object in my Rails app controller that holds whatever information comes in the response. I'm trying to do this using a code like bellow (note that the gem I'm using allows accessing the object with dot notation):</p>\n\n<pre><code>@automatic_profile = AutomaticProfile.new(\n  profile_id: @profile.id,\n  first_name: @intel.contact_info.full_name,\n  email: @profile.email,\n  gender: @intel.demographics.gender,\n  city: @intel.demographics.location_deduced.city.name,\n  skype: @intel.contact_info.chats.select { |slot| slot.client == \"skype\" }[0].handle),\n  organization_1: @intel.organizations[0].name if @intel.organizations,\n  # other similar lines for other organizations\n  twitter: (@intel.social_profiles.select { |slot| slot.type_name == \"Twitter\" }[0].url if @intel.social_profiles),\n  twitter_followers: (@intel.social_profiles.select { |slot| slot.type_name == \"Twitter\" }[0].followers.to_i) if @intel.social_profiles,\n  twitter_following: (@intel.social_profiles.select { |slot| slot.type_name == \"Twitter\" }[0].following.to_i if @intel.social_profiles),\n  # other similar lines for other social profiles\n)\n</code></pre>\n\n<p>I have two issues with this code:</p>\n\n<ol>\n<li>The Json object won't always have all information required to populate some hash keys thus raising an exception when, for example, calling an index in an array that doesn't exist. </li>\n</ol>\n\n<p>I've tried adding an if statement in each line like this:</p>\n\n<pre><code>twitter: (@intel.social_profiles.select { |slot| slot.type_name == \"Twitter\" }[0].url if @intel.social_profiles),\n</code></pre>\n\n<p>but it's not DRY and I'm so confused with the use of parenthesis that I'm raising additional exceptions. </p>\n\n<ol start=\"2\">\n<li>In order to set the correct value to my keys I'm using the slot method to find the specific data I'm looking for.  This as well seems verbose and not much practical.</li>\n</ol>\n\n<p>Could you advice on the best practice when it comes to create an object with data from big Json with nested array responses and advise on how could I solve this particular case? </p>\n"}, {"tags": ["json", "ruby", "serialization", "sketchup"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1501671122, "post_id": 45456507, "comment_id": 77877648, "body": "<code>require &#39;json&#39;; some_var.to_json</code>"}, {"owner": {"reputation": 2681, "user_id": 486990, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b0220a4b0ec42f2ddc610d0c187b1ee1?s=128&d=identicon&r=PG", "display_name": "thomthom", "link": "https://stackoverflow.com/users/486990/thomthom"}, "edited": false, "score": 1, "creation_date": 1502717758, "post_id": 45456507, "comment_id": 78309027, "body": "There is no built in serialisation of SketchUp entities/models to JSON so you need to figure out your own method. For each subclass of <code>Sketchup::Entity</code> you need to determine what properties to export and how to represent them. How you do that is determined by the requirements of whatever will be using it."}, {"owner": {"reputation": 2681, "user_id": 486990, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b0220a4b0ec42f2ddc610d0c187b1ee1?s=128&d=identicon&r=PG", "display_name": "thomthom", "link": "https://stackoverflow.com/users/486990/thomthom"}, "edited": false, "score": 0, "creation_date": 1502717808, "post_id": 45456507, "comment_id": 78309063, "body": "hmm.. Is this question about how to recursively dig down into every child-instance of the model? Because I notice your code only traverse the root and first level."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8404386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a17243f070065079495df75e7cdef0a?s=128&d=identicon&r=PG&f=1", "display_name": "matteo Vilardo", "link": "https://stackoverflow.com/users/8404386/matteo-vilardo"}, "edited": false, "score": 0, "creation_date": 1501673312, "post_id": 45458946, "comment_id": 77879190, "body": "ty but is not my problem , i need to get all object in hierarchy i am tring with recursive method"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 1, "user_id": 8404386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a17243f070065079495df75e7cdef0a?s=128&d=identicon&r=PG&f=1", "display_name": "matteo Vilardo", "link": "https://stackoverflow.com/users/8404386/matteo-vilardo"}, "edited": false, "score": 0, "creation_date": 1501683455, "post_id": 45458946, "comment_id": 77887408, "body": "I&#39;m not sure that you mean, it converts the entire data structure to JSON, I added an example to the answer."}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 0, "last_activity_date": 1501683487, "last_edit_date": 1501683487, "creation_date": 1501671461, "answer_id": 45458946, "question_id": 45456507, "link": "https://stackoverflow.com/questions/45456507/ruby-sketchup-scene-serialization/45458946#45458946", "title": "ruby sketchup scene serialization", "body": "<p>Have you tried the <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/json/rdoc/JSON.html\" rel=\"nofollow noreferrer\">JSON library</a></p>\n\n<pre><code>require 'json'\nsource = { a: [ { b: \"hello\" }, 1, \"world\" ], c: 'hi' }.to_json\nsource.to_json # =&gt; \"{\\\"a\\\":[{\\\"b\\\":\\\"hello\\\"},1,\\\"world\\\"],\\\"c\\\":\\\"hi\\\"}\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8404386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a17243f070065079495df75e7cdef0a?s=128&d=identicon&r=PG&f=1", "display_name": "matteo Vilardo", "link": "https://stackoverflow.com/users/8404386/matteo-vilardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501683487, "creation_date": 1501665258, "last_edit_date": 1501671342, "question_id": 45456507, "link": "https://stackoverflow.com/questions/45456507/ruby-sketchup-scene-serialization", "title": "ruby sketchup scene serialization", "body": "<p>I am very new on Sketchup and ruby , I have worked with java and c# but this is the first time with ruby.</p>\n\n<p>Now I have one problem, I need to serialize all scene in one json (scene hierarchy, object name, object material and position this for single object) how can I do this? </p>\n\n<p>I have already done this for unity3D (c#) without a problem.</p>\n\n<p>I tried this:</p>\n\n<pre><code>def main   \n  avr_entities = Sketchup.active_model.entities # all objects\n\n  ambiens_dictionary = {}\n  ambiens_list = []\n\n  avr_entities.each do |root|\n\n    if root.is_a?(Sketchup::Group) || root.is_a?(Sketchup::ComponentInstance)\n      if root.name == \"\"\n        UI.messagebox(\"this is a group #{root.definition.name}\")\n\n        if root.entities.count &gt; 0\n          root.entities.each do |leaf|\n            if leaf.is_a?(Sketchup::Group) || leaf.is_a?(Sketchup::ComponentInstance)\n              UI.messagebox(\"this is a leaf #{leaf.definition.name}\")\n            end\n          end\n        end\n\n      else\n        # UI.messagebox(\"this is a leaf #{root.name}\")\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "regex", "regex-lookarounds"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "edited": false, "score": 0, "creation_date": 1501667210, "post_id": 45456962, "comment_id": 77874817, "body": "Oh cool, thanks. Why do you use the first method here, before .length?"}, {"owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "reply_to_user": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "edited": false, "score": 0, "creation_date": 1501667353, "post_id": 45456962, "comment_id": 77874942, "body": "<code>split</code> will return an array of 2 strings. We need the <code>length</code> of only first string. Accept and upvote if the answer helped you. Thanks :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501697226, "post_id": 45456962, "comment_id": 77896908, "body": "What if the string begins with something other than a letter?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501697329, "post_id": 45456962, "comment_id": 77896969, "body": "user211309, answers are to be accepted if they are helpful <i>and</i> are the most helpful of all answers submitted. Also, there&#39;s no rush in selecting an answer. Many here wait a couple of hours at least. Sajin, it is unprofessional, imo, to request that one&#39;s answer be selected, especially when the asker is new to SO and possibly not familiar with the criteria for applying the checkmark. I for one would <i>never</i> award the greenie to someone who asked for it."}, {"owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501698143, "post_id": 45456962, "comment_id": 77897480, "body": "@CarySwoveland I completely agree with &quot;answers are to be accepted if they are helpful and are the most helpful of all answers submitted&quot;. I thought this was the answer he was looking for when he said thanks. So i thought it was better to have an answer accepted if it is correct rather than leaving it unaccepted, so that people like us will be encouraged to answer more questions. I also accept the fact that Stefan&#39;s answer is a much better one. +1 for that."}], "tags": [], "owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "is_accepted": false, "score": 0, "last_activity_date": 1501666394, "creation_date": 1501666394, "answer_id": 45456962, "question_id": 45456321, "link": "https://stackoverflow.com/questions/45456321/how-to-count-consecutive-consonants-at-beginning-of-a-string-in-ruby/45456962#45456962", "title": "How to count consecutive consonants at beginning of a string in Ruby?", "body": "<p>Something along this line would work:</p>\n\n<pre><code>&gt;&gt; 'Cherry'.downcase.split(/([aeiou].*)/).first.length\n# =&gt; 2\n&gt;&gt; 'hello'.downcase.split(/([aeiou].*)/).first.length\n# =&gt; 1\n&gt;&gt; 'schlepp'.downcase.split(/([aeiou].*)/).first.length\n# =&gt; 4\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1501698037, "post_id": 45457476, "comment_id": 77897416, "body": "<code>&quot;1. Cherry cobler.&quot;[r].length #=&gt; 0</code>, as it should."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 4, "last_activity_date": 1501668364, "last_edit_date": 1501668364, "creation_date": 1501667673, "answer_id": 45457476, "question_id": 45456321, "link": "https://stackoverflow.com/questions/45456321/how-to-count-consecutive-consonants-at-beginning-of-a-string-in-ruby/45457476#45457476", "title": "How to count consecutive consonants at beginning of a string in Ruby?", "body": "<p>This would work:</p>\n\n<pre><code>'Cherry'[/\\A[bcdfghjklmnpqrstvwxyz]*/i].length #=&gt; 2\n</code></pre>\n\n<p>The regex matches zero or more consonants at the beginning of the string. <a href=\"http://ruby-doc.org/core-2.4.1/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\"><code>String#[]</code></a> returns the matching part and <a href=\"http://ruby-doc.org/core-2.4.1/String.html#method-i-length\" rel=\"nofollow noreferrer\"><code>length</code></a> determines its length.</p>\n\n<p>You can also express the consonants character class more succinct by intersecting <code>[a-z]</code> and <code>[^aeiou]</code> via <code>&amp;&amp;</code>:</p>\n\n<pre><code>'Cherry'[/\\A[a-z&amp;&amp;[^aeiou]]*/i].length #=&gt; 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501697695, "post_id": 45460229, "comment_id": 77897198, "body": "What if the string does not begin with a letter? For example, `&quot;1. Make dinner reservarions&quot;."}, {"owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501698165, "post_id": 45460229, "comment_id": 77897495, "body": "@CarySwoveland: Sure, it will not work (as other answers) but those cases haven&#39;t been explicitly requested by OP."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501701247, "post_id": 45460229, "comment_id": 77899279, "body": "The OP only said the object was a string, so why not write the method so  that it works regardless of whether it begins with a letter?"}], "tags": [], "owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "is_accepted": false, "score": 0, "last_activity_date": 1501675049, "creation_date": 1501675049, "answer_id": 45460229, "question_id": 45456321, "link": "https://stackoverflow.com/questions/45456321/how-to-count-consecutive-consonants-at-beginning-of-a-string-in-ruby/45460229#45460229", "title": "How to count consecutive consonants at beginning of a string in Ruby?", "body": "<p>Another way is to replace from the first vowel until end of string by nothing then take the length:</p>\n\n<pre><code>'Cherry'.gsub(/[aeiou].*$/,\"\").length\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1501700927, "last_edit_date": 1501700927, "creation_date": 1501700277, "answer_id": 45468947, "question_id": 45456321, "link": "https://stackoverflow.com/questions/45456321/how-to-count-consecutive-consonants-at-beginning-of-a-string-in-ruby/45468947#45468947", "title": "How to count consecutive consonants at beginning of a string in Ruby?", "body": "<p>It is not necessary to use a regular expression.</p>\n\n<pre><code>CONSONANTS = (('a'..'z').to_a - 'aeiou'.chars).join\n  #=&gt; \"bcdfghjklmnpqrstvwxyz\"\n\ndef consecutive_constants(str)\n  e, a = str.each_char.chunk { |c| CONSONANTS.include?(c.downcase) }.first\n  e ? a.size : 0\nend\n\nconsecutive_constants(\"THIS is nuts\")       #=&gt; 2\nconsecutive_constants(\"Is this ever cool?\") #=&gt; 0\nconsecutive_constants(\"1. this is wrong\")   #=&gt; 0\n</code></pre>\n\n<p>Note</p>\n\n<pre><code>enum = \"THIS is nuts\".each_char.chunk { |c| CONSONANTS.include?(c.downcase) }\n  #=&gt; #&lt;Enumerator: #&lt;Enumerator::Generator:0x000000010e1a40&gt;:each&gt;\n</code></pre>\n\n<p>We can see the elements that will be generated by this enumerator by applying <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-entries\" rel=\"nofollow noreferrer\">Enumerable#entries</a> (or <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-to_a\" rel=\"nofollow noreferrer\">Enumerable#to_a</a>):</p>\n\n<pre><code>enum.entries\n  #=&gt; [[true, [\"T\", \"H\"]], [false, [\"I\"]], [true, [\"S\"]], [false, [\" \", \"i\"]],\n  #    [true, [\"s\"]], [false, [\" \"]], [true, [\"n\"]], [false, [\"u\"]], [true, [\"t\", \"s\"]]]\n</code></pre>\n\n<p>Continuing,</p>\n\n<pre><code>  e, a = enum.first\n    #=&gt; [true, [\"T\", \"H\"]]\n  e #=&gt; true\n  a #=&gt; [\"T\", \"H\"]\n  a.size\n    #=&gt; 2\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 45457476, "answer_count": 4, "score": 0, "last_activity_date": 1501700927, "creation_date": 1501664780, "last_edit_date": 1501668513, "question_id": 45456321, "link": "https://stackoverflow.com/questions/45456321/how-to-count-consecutive-consonants-at-beginning-of-a-string-in-ruby", "title": "How to count consecutive consonants at beginning of a string in Ruby?", "body": "<p>I'm still coming to terms with Regex and want to formulate an expression that will let me count the number of successive consonants at the beginning of a string. E.g. <code>'Cherry'</code> will return <code>2</code>, <code>'hello'</code> <code>1</code>, <code>'schlepp'</code> <code>4</code> and so on. Since the number isn't predetermined (although English probably has some upper limit on initial consonants!) I'd need some flexible expression, but I'm a bit stuck about how to write it. Any pointers would be welcome!</p>\n"}, {"tags": ["ruby", "heroku", "sinatra", "selenium-chromedriver", "ruby-watir"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8125349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/swnsg.jpg?s=128&g=1", "display_name": "Vincent Cheloudiakoff", "link": "https://stackoverflow.com/users/8125349/vincent-cheloudiakoff"}, "edited": false, "score": 0, "creation_date": 1501856239, "post_id": 45464541, "comment_id": 77979280, "body": "I abandoned the idea of Heroku, for a ScaleWay hosting, and in this case, i have to use the headless gem and install xvfb !  Thank&#39;s for your answer, who gave me the existence of Headless gem !"}], "tags": [], "owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "is_accepted": false, "score": 0, "last_activity_date": 1501686430, "creation_date": 1501686430, "answer_id": 45464541, "question_id": 45456271, "link": "https://stackoverflow.com/questions/45456271/how-to-deploy-a-ruby-app-on-heroku-using-sinatra-and-watir-gem/45464541#45464541", "title": "How to deploy a Ruby app on Heroku using Sinatra and Watir gem", "body": "<p>I'm not sure how heroku works with running chrome, but you can get a working chromedriver using the <code>webdrivers</code> gem. Also if xvfb is installed, it is easy to use the <code>headless</code> gem.</p>\n"}], "owner": {"reputation": 65, "user_id": 8125349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/swnsg.jpg?s=128&g=1", "display_name": "Vincent Cheloudiakoff", "link": "https://stackoverflow.com/users/8125349/vincent-cheloudiakoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501686430, "creation_date": 1501664644, "last_edit_date": 1501678929, "question_id": 45456271, "link": "https://stackoverflow.com/questions/45456271/how-to-deploy-a-ruby-app-on-heroku-using-sinatra-and-watir-gem", "title": "How to deploy a Ruby app on Heroku using Sinatra and Watir gem", "body": "<p>Hi i've some trouble to deploy my Ruby application on Heroku using Sinatra and Watir gem.\nI have to load a chrome window, that's why i read the message:</p>\n\n<p><code>\"Application error\nAn error occurred in the application and your page could not be served.\"</code></p>\n\n<p>I tried to launch my app on localhost, it work perfectly, but not on Heroku.</p>\n\n<p>I installed this chrome driver buildpack <a href=\"https://github.com/heroku/heroku-buildpack-chromedriver\" rel=\"nofollow noreferrer\">https://github.com/heroku/heroku-buildpack-chromedriver</a>\nand this <a href=\"https://github.com/heroku/heroku-buildpack-xvfb-google-chrome\" rel=\"nofollow noreferrer\">https://github.com/heroku/heroku-buildpack-xvfb-google-chrome</a>.</p>\n\n<p>I've also done the following step <code>\"Only supported on Cedar-14\nNote that this buildpack only works on Cedar-14 stack.\"</code></p>\n\n<p>My build log tell that my app is deploy on Heroku without problem.\nIt's the first time i deploy an application on web, and i really need to use Heroku if it's possible.</p>\n\n<p>I've try another way to deploy my app, without chrome driver buildpacks, and it works perfectly. Obviously, the part that uses the Watir gem, in my program doesn't work anyway.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1501657100, "post_id": 45453552, "comment_id": 77867948, "body": "It&#39;s the <a href=\"http://mitrev.net/ruby/2015/11/13/the-operator-in-ruby/\" rel=\"nofollow noreferrer\">Safe Navigation Operator</a>. It made its debut in Ruby 2.3."}, {"owner": {"reputation": 3465, "user_id": 5946118, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/CbjEl.jpg?s=128&g=1", "display_name": "Rajkaran Mishra", "link": "https://stackoverflow.com/users/5946118/rajkaran-mishra"}, "edited": false, "score": 1, "creation_date": 1501657111, "post_id": 45453552, "comment_id": 77867950, "body": "See this <a href=\"https://stackoverflow.com/questions/36812647/what-does-ampersand-dot-mean-in-ruby\" title=\"what does ampersand dot mean in ruby\">stackoverflow.com/questions/36812647/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 7, "last_activity_date": 1501657088, "creation_date": 1501657088, "answer_id": 45453625, "question_id": 45453552, "link": "https://stackoverflow.com/questions/45453552/what-does-the-ampersand-at-the-end-of-a-ruby-parameter-mean/45453625#45453625", "title": "What does the ampersand at the end of a Ruby parameter mean?", "body": "<p>It is called as <strong>Safe Navigation Operator</strong>. Introduced in ruby 2.3.0</p>\n\n<p>You can use it to make sure the value exist before calling some method on it</p>\n\n<p>For example:</p>\n\n<pre><code>a = nil\n\na.some_method # This will break\n\n#=&gt; NoMethodError: undefined method `some_method' for nil:NilClass\n\na&amp;.some_method # This will not\n\n#=&gt; nil\n</code></pre>\n\n<p>You can use this operator instead of</p>\n\n<pre><code>a &amp;&amp; a.some_method &amp;&amp; a.some_method.some_other_method\n# OR\na.try(:some_method).try(:some_other_method)\n</code></pre>\n\n<p>Using this operator</p>\n\n<pre><code>a&amp;.some_method&amp;.some_other_method\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 7942320, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/385767dbcdb57b1ce08f9cda7d0e6c41?s=128&d=identicon&r=PG&f=1", "display_name": "mangocaptain1", "link": "https://stackoverflow.com/users/7942320/mangocaptain1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "closed_date": 1501657126, "answer_count": 1, "score": 3, "last_activity_date": 1501657238, "creation_date": 1501656904, "question_id": 45453552, "link": "https://stackoverflow.com/questions/45453552/what-does-the-ampersand-at-the-end-of-a-ruby-parameter-mean", "closed_reason": "Duplicate", "title": "What does the ampersand at the end of a Ruby parameter mean?", "body": "<p>Below is an example of named arguments in Ruby, but what does the ampersand do?</p>\n\n<pre><code>def set_tools(foo:, bar:, baz:)\n    @instance_variable = baz&amp;.stuff\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "active-model-serializers"], "comments": [{"owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "edited": false, "score": 0, "creation_date": 1583578307, "post_id": 45452662, "comment_id": 107169430, "body": "Did you find a solution for this?"}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 2666049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c9f68f875bf135b7fcca0c33b16c4c0?s=128&d=identicon&r=PG", "display_name": "palash-kulkarni", "link": "https://stackoverflow.com/users/2666049/palash-kulkarni"}, "edited": false, "score": 0, "creation_date": 1501654827, "post_id": 45452821, "comment_id": 77866605, "body": "This is not giving me &quot;distance &quot; in json."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 347, "user_id": 2666049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c9f68f875bf135b7fcca0c33b16c4c0?s=128&d=identicon&r=PG", "display_name": "palash-kulkarni", "link": "https://stackoverflow.com/users/2666049/palash-kulkarni"}, "edited": false, "score": 0, "creation_date": 1501655012, "post_id": 45452821, "comment_id": 77866732, "body": "@palash-kulkarni: can&#39;t reproduce. Works for me."}, {"owner": {"reputation": 347, "user_id": 2666049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c9f68f875bf135b7fcca0c33b16c4c0?s=128&d=identicon&r=PG", "display_name": "palash-kulkarni", "link": "https://stackoverflow.com/users/2666049/palash-kulkarni"}, "edited": false, "score": 0, "creation_date": 1501655106, "post_id": 45452821, "comment_id": 77866782, "body": "I tried this too. But didnt work. I think the extra attribute which we want and have in the select query as &quot;distance&quot; and which is not a part of Vendor model. So it is not getting added"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 347, "user_id": 2666049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c9f68f875bf135b7fcca0c33b16c4c0?s=128&d=identicon&r=PG", "display_name": "palash-kulkarni", "link": "https://stackoverflow.com/users/2666049/palash-kulkarni"}, "edited": false, "score": 0, "creation_date": 1501655227, "post_id": 45452821, "comment_id": 77866851, "body": "@palash-kulkarni: ah, that may be. In this case, indeed, serializing vendor seems useless. You could just bypass all the things (creating vendors and serializing them) and output your resultset directly."}, {"owner": {"reputation": 347, "user_id": 2666049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c9f68f875bf135b7fcca0c33b16c4c0?s=128&d=identicon&r=PG", "display_name": "palash-kulkarni", "link": "https://stackoverflow.com/users/2666049/palash-kulkarni"}, "edited": false, "score": 0, "creation_date": 1501656052, "post_id": 45452821, "comment_id": 77867353, "body": "How it can be useless if somebody wants all the other attributes along with the extra field?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 347, "user_id": 2666049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c9f68f875bf135b7fcca0c33b16c4c0?s=128&d=identicon&r=PG", "display_name": "palash-kulkarni", "link": "https://stackoverflow.com/users/2666049/palash-kulkarni"}, "edited": false, "score": 0, "creation_date": 1501657042, "post_id": 45452821, "comment_id": 77867905, "body": "@palash-kulkarni: because someone wants that extra field and it&#39;s not available on a Vendor."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1501654584, "creation_date": 1501654584, "answer_id": 45452821, "question_id": 45452662, "link": "https://stackoverflow.com/questions/45452662/add-a-extra-field-to-activemodel-serializer/45452821#45452821", "title": "Add a extra field to ActiveModel Serializer", "body": "<p>AMS has built-in support for this. No need for dirty hacks.</p>\n\n<pre><code>class VendorSerializer &lt; ActiveModel::Serializer\n  attributes :id, :lat, :lon, :name, :created_at,\n             :distance, :foobar\n\n\n  def include_distance?\n    object.distance.present?\n  end\n\n  def foobar\n    'custom value'\n  end\n\n  def include_foobar?\n    # ...\n  end\nend\n</code></pre>\n\n<p>For every attribute, AMS will try find and call method <code>include_ATTR?</code>. If the method exists and returns falsey value, the attribute is not included in the output.</p>\n"}, {"comments": [{"owner": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "edited": false, "score": 0, "creation_date": 1579847171, "post_id": 45452855, "comment_id": 105910604, "body": "Downvoting, bcoz not explained how to use this method <code>some_extra_attribute</code>."}, {"owner": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "edited": false, "score": 0, "creation_date": 1582087649, "post_id": 45452855, "comment_id": 106651713, "body": "What Rails API has to do with this? It is not mentioned anywhere in you answer how can i call this <code>some_extra_attribute</code> method from this serialize or how do I include the result of this <code>some_extra_attribute</code> method to my response. Does it gets automatically append to the serialized json? Because that was not happening."}, {"owner": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "reply_to_user": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "edited": false, "score": 1, "creation_date": 1582523514, "post_id": 45452855, "comment_id": 106792903, "body": "It is actually mentioned. If you have a look at line #2, <code>attributes :id, :lan, :etc</code> this is how rails knows which attributes to serialize into response. You dont need to explicitly call any methods, rails does it for you  As for rails api - you need to know interface of railse&#39;s classes in order to use them, so I encourage you to go and read what and how serializer in rails works to stop making wrong decisions based on your own limited knowledge"}], "tags": [], "owner": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "is_accepted": false, "score": -1, "last_activity_date": 1501654704, "creation_date": 1501654704, "answer_id": 45452855, "question_id": 45452662, "link": "https://stackoverflow.com/questions/45452662/add-a-extra-field-to-activemodel-serializer/45452855#45452855", "title": "Add a extra field to ActiveModel Serializer", "body": "<p>You can do like following</p>\n\n<pre><code>class VendorSerializer &lt; ActiveModel::Serializer\n    attributes :id,\n               :lat,\n               :lon,\n               :name,\n               :created_at,\n               :some_extra_attribute\n\n    def some_extra_attribute\n      object.some_extra_attribute # Or any other calculation inside this method\n    end\n\n\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501704947, "post_id": 45457138, "comment_id": 77901380, "body": "Link-only answers are not very useful. Include the <i>relevant</i> part of the linked article in the answer itself."}], "tags": [], "owner": {"reputation": 7, "user_id": 5879261, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2Vp-tcZNTQY/AAAAAAAAAAI/AAAAAAAAA50/aEa_X5Ia0Rw/photo.jpg?sz=128", "display_name": "Miro Mudrik", "link": "https://stackoverflow.com/users/5879261/miro-mudrik"}, "is_accepted": false, "score": -1, "last_activity_date": 1501666798, "creation_date": 1501666798, "answer_id": 45457138, "question_id": 45452662, "link": "https://stackoverflow.com/questions/45452662/add-a-extra-field-to-activemodel-serializer/45457138#45457138", "title": "Add a extra field to ActiveModel Serializer", "body": "<p>Here are guides to active model serializer:\n<a href=\"https://github.com/rails-api/active_model_serializers/blob/0-10-stable/docs/README.md\" rel=\"nofollow noreferrer\">Active Model Serializer Guide</a></p>\n\n<p>Resolution to your problem is defining here:\n<a href=\"https://github.com/rails-api/active_model_serializers/blob/0-10-stable/docs/general/serializers.md\" rel=\"nofollow noreferrer\">Active Model Serializer Guide - Serializer</a></p>\n"}], "owner": {"reputation": 347, "user_id": 2666049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c9f68f875bf135b7fcca0c33b16c4c0?s=128&d=identicon&r=PG", "display_name": "palash-kulkarni", "link": "https://stackoverflow.com/users/2666049/palash-kulkarni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3035, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1501666798, "creation_date": 1501653975, "last_edit_date": 1501654337, "question_id": 45452662, "link": "https://stackoverflow.com/questions/45452662/add-a-extra-field-to-activemodel-serializer", "title": "Add a extra field to ActiveModel Serializer", "body": "<p>Lets say I am having a Model called Vendor(id, name, lat, lon, created_at).\nAnd i have a query in which i find distance of vendors from the current latitude and longitude.</p>\n\n<p>Query is -</p>\n\n<pre><code>query = \"*, ST_Distance(ST_SetSRID(ST_Point(#{lat}, #{lon}), 4326)::geography,ST_SetSRID(ST_Point(lat, lon), 4326)::geography) as distance\"\n\nVendor.select(query)\n</code></pre>\n\n<p>I have serializer class as -</p>\n\n<pre><code>class VendorSerializer &lt; ActiveModel::Serializer\n    attributes :id,\n               :lat,\n               :lon,\n               :name,\n               :created_at\n\n    def attributes\n        hash = super\n        # I tried to override attributes and added distance but it doesn't add\n        hash[:distance] = object.distance if object.distance.present?\n        hash\n    end\nend\n</code></pre>\n\n<p>I want to have a serialised object as {id, lat, lon, name, created_at,  distance}. \nSo the model attributes get attached but how can i add the extra field/attribute i.e, \"distance\" to the serialised hash?</p>\n"}, {"tags": ["arrays", "ruby", "recursion"], "answers": [{"tags": [], "owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "is_accepted": false, "score": 0, "last_activity_date": 1501658823, "last_edit_date": 1501658823, "creation_date": 1501655743, "answer_id": 45453176, "question_id": 45452373, "link": "https://stackoverflow.com/questions/45452373/arr-last-returns-nil-in-recursive-add-numbers/45453176#45453176", "title": "arr.last returns nil in recursive add_numbers", "body": "<p>In my case, it worked well but with a bad result the problem is using:</p>\n\n<pre><code>arr = arr[0...-1]\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>arr.pop\n</code></pre>\n\n<p>with pop you modify arr doing it smaller with out de last number and returns last number, and with the other you get the array smaller before getting the last:</p>\n\n<pre><code>    [32] pry(main)&gt; a = [1,2,3,4,5]\n    =&gt; [1, 2, 3, 4, 5]\n    [33] pry(main)&gt; a.pop\n    =&gt; 5\n    [34] pry(main)&gt; a\n    =&gt; [1, 2, 3, 4]\n    [35] pry(main)&gt; a = [1,2,3,4,5]\n    =&gt; [1, 2, 3, 4, 5]\n    [36] pry(main)&gt; a = a[0...-1]\n    =&gt; [1, 2, 3, 4]\n    [37] pry(main)&gt; a.last\n    =&gt; 4\n</code></pre>\n\n<p>let's add some debugger to your functions:</p>\n\n<pre><code>    def add_numbers(arr)\n\n      puts \"array = #{arr}\"\n      puts \"length = #{arr.length}\"\n\n      return arr.first if arr.size == 1\n      return nil if arr.empty?\n\n\n      arr.pop + add_numbers(arr[0..-1])\n    end\n\n    def add_numbers(arr)\n\n      puts \"array = #{arr}\"\n      puts \"length = #{arr.length}\"\n\n\n      return arr.first if arr.size == 1\n      return nil if arr.empty?\n\n      arr = arr[0...-1]\n      arr.last + add_numbers(arr[0..-1])\n    end\n</code></pre>\n\n<p>with the following output respectively:</p>\n\n<pre><code>[1] pry(main)&gt; \n[1] pry(main)* =&gt; :add_numbers\n[2] pry(main)&gt; add_numbers [1, 2, 3, 4, 5]\narray = [1, 2, 3, 4, 5]\nlength = 5\narray = [1, 2, 3, 4]\nlength = 4\narray = [1, 2, 3]\nlength = 3\narray = [1, 2]\nlength = 2\narray = [1]\nlength = 1\n=&gt; 15\n[11] pry(main)&gt; \n[11] pry(main)* =&gt; :add_numbers\n[12] pry(main)&gt; add_numbers [1, 2, 3, 4, 5]\narray = [1, 2, 3, 4, 5]\nlength = 5\narray = [1, 2, 3, 4]\nlength = 4\narray = [1, 2, 3]\nlength = 3\narray = [1, 2]\nlength = 2\narray = [1]\nlength = 1\n=&gt; 11\n</code></pre>\n\n<p>so you should change the last function to something like this:</p>\n\n<pre><code>def add_numbers(arr)\n\n  puts \"array = #{arr}\"\n  puts \"length = #{arr.length}\"\n\n\n  return arr.first if arr.size == 1\n  return nil if arr.empty?\n\n  arr.last + add_numbers(arr[0...-1])\nend\n</code></pre>\n\n<p>with the following output</p>\n\n<pre><code>[39] pry(main)&gt; add_numbers [1, 2, 3, 4, 5]\narray = [1, 2, 3, 4, 5]\nlength = 5\narray = [1, 2, 3, 4]\nlength = 4\narray = [1, 2, 3]\nlength = 3\narray = [1, 2]\nlength = 2\narray = [1]\nlength = 1\n=&gt; 15\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1501656073, "creation_date": 1501656073, "answer_id": 45453280, "question_id": 45452373, "link": "https://stackoverflow.com/questions/45452373/arr-last-returns-nil-in-recursive-add-numbers/45453280#45453280", "title": "arr.last returns nil in recursive add_numbers", "body": "<p>Suppose</p>\n\n<pre><code>arr = [1,2,3]\n</code></pre>\n\n<p>In the first case,</p>\n\n<pre><code>last = arr.pop\n  #=&gt; 3\narr\n  #=&gt; [1,2]\narr[0..-1]\n  #=&gt; [1,2]\nlast + add_numbers(arr[0..-1])\n  #=&gt; 3 + add_numbers([1,2])\n</code></pre>\n\n<p>In the second case,</p>\n\n<pre><code>arr[0..-1] \n  #=&gt; [1,2,3]\narr = arr[0...-1]\n  #=&gt; [1,2]\narr[0..-1]\n  #=&gt; [1,2]\narr.last + add_numbers(arr[0..-1])\n  #=&gt; 2 + add_numbers([1,2])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": false, "score": 0, "last_activity_date": 1501658169, "creation_date": 1501658169, "answer_id": 45453979, "question_id": 45452373, "link": "https://stackoverflow.com/questions/45452373/arr-last-returns-nil-in-recursive-add-numbers/45453979#45453979", "title": "arr.last returns nil in recursive add_numbers", "body": "<p>In a range, <code>..</code> is inclusive, <code>...</code> is exclusive. If <code>arr = [1, 2, 3]</code>, <code>arr[0..-1] == [1, 2, 3]</code> while <code>arr[0...-1] == [1, 2]</code></p>\n\n<p>On the first iteration of your second method, here's your last line</p>\n\n<pre><code>2 + add_numbers([1, 2])\n</code></pre>\n\n<p>Compare that with your working method</p>\n\n<pre><code>3 + add_numbers([1, 2])\n</code></pre>\n\n<p>You will definitely end up with the wrong results, but you shouldn't be getting a <code>nil</code> error if all of your inputs are integers. So the question is, what's your input?\n`</p>\n"}], "owner": {"reputation": 325, "user_id": 6307495, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c792ad4b67832f30ff684da5e1b1628e?s=128&d=identicon&r=PG&f=1", "display_name": "killer_manatee", "link": "https://stackoverflow.com/users/6307495/killer-manatee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1501658823, "creation_date": 1501652732, "last_edit_date": 1501653161, "question_id": 45452373, "link": "https://stackoverflow.com/questions/45452373/arr-last-returns-nil-in-recursive-add-numbers", "title": "arr.last returns nil in recursive add_numbers", "body": "<p>I'm sorry but I couldn't think of good title</p>\n\n<p>My question is, why does this recursive function to add the numbers in an array work:</p>\n\n<pre><code>def add_numbers(arr)\n  return arr.first if arr.size == 1\n  return nil if arr.empty?\n\n\n  arr.pop + add_numbers(arr[0..-1])\nend\n</code></pre>\n\n<p>but not this one:</p>\n\n<pre><code>def add_numbers(arr)\n  return arr.first if arr.size == 1\n  return nil if arr.empty?\n\n  arr = arr[0...-1]\n  arr.last + add_numbers(arr[0..-1])\nend\n</code></pre>\n\n<p>The error I receive is </p>\n\n<pre><code>TypeError: nil can't be coerced into Fixnum \n</code></pre>\n\n<p>because arr.last is nil at the very last step, I suppose. I've tried doing a memory model on paper but I still can't figure out why the first isn't equivalent to the second. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "model"], "comments": [{"owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 0, "creation_date": 1501665424, "post_id": 45452207, "comment_id": 77873491, "body": "I guess the <code>project_id</code> should be <code>project_ids</code> (just a guess)"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 5298978, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/acf6a54c855a70a7bcb2505163ff65f2?s=128&d=identicon&r=PG&f=1", "display_name": "Sharvari Nagesh", "link": "https://stackoverflow.com/users/5298978/sharvari-nagesh"}, "edited": false, "score": 0, "creation_date": 1501725035, "post_id": 45457714, "comment_id": 77907885, "body": "No it didn&#39;t help :("}], "tags": [], "owner": {"reputation": 7, "user_id": 5879261, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2Vp-tcZNTQY/AAAAAAAAAAI/AAAAAAAAA50/aEa_X5Ia0Rw/photo.jpg?sz=128", "display_name": "Miro Mudrik", "link": "https://stackoverflow.com/users/5879261/miro-mudrik"}, "is_accepted": false, "score": 0, "last_activity_date": 1501668220, "creation_date": 1501668220, "answer_id": 45457714, "question_id": 45452207, "link": "https://stackoverflow.com/questions/45452207/saving-associated-many-to-many-relation-in-rails/45457714#45457714", "title": "Saving associated many to many relation in Rails", "body": "<p>Im not sure, but try this params.\nMaybe it helps. :)    </p>\n\n<pre><code>def device_params\n params.require(:device).permit(:name, :projects_devices_attributes =&gt;[:id, :device_id, :project_id, :_destroy])\nend\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 5298978, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/acf6a54c855a70a7bcb2505163ff65f2?s=128&d=identicon&r=PG&f=1", "display_name": "Sharvari Nagesh", "link": "https://stackoverflow.com/users/5298978/sharvari-nagesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501668220, "creation_date": 1501651962, "last_edit_date": 1501655939, "question_id": 45452207, "link": "https://stackoverflow.com/questions/45452207/saving-associated-many-to-many-relation-in-rails", "title": "Saving associated many to many relation in Rails", "body": "<p>I looked at related posts but could not get my code working. I have device and project models which are connected thru <code>projects_devices</code> table. My models look like this:</p>\n\n<pre><code>class Device &lt; ActiveRecord::Base\n  has_many :projects, :through =&gt; :projects_devices\n  has_many :projects_devices \n  accepts_nested_attributes_for :projects_devices, allow_destroy: true\nend\n\n\nclass Project &lt; ActiveRecord::Base\n  has_many :devices, :through =&gt; :projects_devices\n  has_many :projects_devices\n  accepts_nested_attributes_for :projects_devices\nend\n\n\nclass ProjectsDevice &lt; ActiveRecord::Base\n  belongs_to :device\n  belongs_to :project\nend\n</code></pre>\n\n<p>my device controller:</p>\n\n<pre><code>def new\n  @device = Device.new\n  project_device = @device.projects_devices.build\n  @projects = Project.all\nend\n\ndef create\n  @device = Device.create(device_params)\nend\n</code></pre>\n\n<p>and my device_param :</p>\n\n<pre><code>def device_params\n  params.require(:device).permit(:name, :projects_devices_attributes =&gt; [:id , project_id: []])\nend\n</code></pre>\n\n<p>My view:</p>\n\n<pre><code>&lt;%= f.label :Projects_devices %&gt;&lt;br&gt;\n&lt;%= f.fields_for :projects_devices do |proj| %&gt;\n  &lt;%= proj.select(:project_id, [], {},  {class: \"form-control projects-devices\", multiple: \"multiple\" } ) do %&gt;\n    &lt;% if (@projects)  %&gt;\n      &lt;% for @project in @projects  %&gt;\n        &lt;%= content_tag(:option, @project.name, value: @project.id) %&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I have a many to many association between two models. While creating and editing devices, I should be able to list all the projects available. And select only the ones required. When I save, the projects_devices table should be updated. </p>\n\n<p>I have multiple problems here:</p>\n\n<ol>\n<li><p>When I save a new device, </p>\n\n<p>a. the <code>projects_devices</code> table has only <code>device_id</code> but not <code>project_id</code>. <code>project_id</code> is null</p>\n\n<p>b. if there are 2 projects and I select only one, even then, two association records are created with only <code>device_id</code> (as mentioned above, <code>project_id</code> is missing). It should create only one association. </p></li>\n<li><p>When a new device is edited, </p>\n\n<p>a. Project list, list of all projects is empty.</p>\n\n<p>b. I see 2 select boxes are displayed instead of one for projects(there are 2 projects currently).</p>\n\n<p>c. updating the device is not happening. </p></li>\n</ol>\n\n<p>I checked the params:</p>\n\n<pre><code>\"device\"=&gt;{\"name\"=&gt;\"ABC\",\n \"projects_devices_attributes\"=&gt;{\"0\"=&gt;{\"project_id\"=&gt;[\"\",\n \"298486374\"]}}},\n \"commit\"=&gt;\"Create Device\"}\n</code></pre>\n\n<p>My rails log shows that my application is inserting only device_id:</p>\n\n<pre><code>SQL (0.1ms)  INSERT INTO `projects_devices` (`device_id`) VALUES (980190994)\n</code></pre>\n\n<p>Can somebody help me figure out the problem</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "tesseract"], "comments": [{"owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 0, "creation_date": 1501654402, "post_id": 45451925, "comment_id": 77866406, "body": "I know nothing about tesseract, but do you have ImageMagick installed? If you type convert -version in a shell window, what do you get returned?"}, {"owner": {"reputation": 21, "user_id": 8379287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89678fef137082eda57658a19ff40280?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Jagdish", "link": "https://stackoverflow.com/users/8379287/anirudh-jagdish"}, "reply_to_user": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 0, "creation_date": 1501654526, "post_id": 45451925, "comment_id": 77866467, "body": "Thanks for replying! This is what I got:"}, {"owner": {"reputation": 21, "user_id": 8379287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89678fef137082eda57658a19ff40280?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Jagdish", "link": "https://stackoverflow.com/users/8379287/anirudh-jagdish"}, "reply_to_user": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 0, "creation_date": 1501654531, "post_id": 45451925, "comment_id": 77866471, "body": "Version: ImageMagick 6.9.9-4 Q8 x64 2017-07-29 <a href=\"http://www.imagemagick.org\" rel=\"nofollow noreferrer\">imagemagick.org</a> Copyright: Copyright (C) 1999-2015 ImageMagick Studio LLC License: <a href=\"http://www.imagemagick.org/script/license.php\" rel=\"nofollow noreferrer\">imagemagick.org/script/license.php</a> Visual C++: 180040629 Features: Cipher DPC Modules OpenMP Delegates (built-in): bzlib cairo flif freetype jng jp2 jpeg lcms lqr openexr pangocairo png ps rsvg tiff webp xml zlib"}, {"owner": {"reputation": 445, "user_id": 8018505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b91738cee0a49bbbf95faf11cf9bc5a?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Coleman", "link": "https://stackoverflow.com/users/8018505/paul-coleman"}, "edited": false, "score": 0, "creation_date": 1501658402, "post_id": 45451925, "comment_id": 77868757, "body": "Have you added the tesseract executable to your PATH?"}, {"owner": {"reputation": 21, "user_id": 8379287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89678fef137082eda57658a19ff40280?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Jagdish", "link": "https://stackoverflow.com/users/8379287/anirudh-jagdish"}, "edited": false, "score": 0, "creation_date": 1501659295, "post_id": 45451925, "comment_id": 77869305, "body": "Would that be done by going into settings and manually adding it? And also, I am not certain to which of the files I would set the path to if its necessary, but I added a variable called PATH with value C:\\Program Files (x86)\\Tesseract-OCR"}, {"owner": {"reputation": 21, "user_id": 8379287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89678fef137082eda57658a19ff40280?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Jagdish", "link": "https://stackoverflow.com/users/8379287/anirudh-jagdish"}, "edited": false, "score": 0, "creation_date": 1501660639, "post_id": 45451925, "comment_id": 77870154, "body": "Hey guys, I did what Paul Coleman suggested, I updated my question to reflect the changes. It helped in a way but fmw42&#39;s suggested command doesn&#39;t work anymore"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8379287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89678fef137082eda57658a19ff40280?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Jagdish", "link": "https://stackoverflow.com/users/8379287/anirudh-jagdish"}, "is_accepted": true, "score": 0, "last_activity_date": 1501722078, "creation_date": 1501722078, "answer_id": 45473172, "question_id": 45451925, "link": "https://stackoverflow.com/questions/45451925/rtesseract-causing-no-such-file-or-directory-error-under-windows-10/45473172#45473172", "title": "RTesseract causing &quot;no such file or directory&quot; error under Windows 10", "body": "<p>Got it working lol\nI simply switched over to Ubuntu 16.04 and did the standard installs of all the requirements, and voila, no errors. LOTD: Ubuntu > Windows for development</p>\n"}], "owner": {"reputation": 21, "user_id": 8379287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89678fef137082eda57658a19ff40280?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Jagdish", "link": "https://stackoverflow.com/users/8379287/anirudh-jagdish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 45473172, "answer_count": 1, "score": 1, "last_activity_date": 1597719362, "creation_date": 1501650606, "last_edit_date": 1597719362, "question_id": 45451925, "link": "https://stackoverflow.com/questions/45451925/rtesseract-causing-no-such-file-or-directory-error-under-windows-10", "title": "RTesseract causing &quot;no such file or directory&quot; error under Windows 10", "body": "<p>I am trying to use RTesseract and mini_magick to do some simple OCR in a Ruby program for some images with white background color and pink font color. Unfortunately, I keep having issues with RTesseract. I have  Tesseract-OCR v3.05 installed via the .dll executable found online and stored in my <code>Program Files (x86)</code> folder. I also have ImageMagick v6.9.9 installed via its own executable in <code>Program Files</code> folder (not x86). Here is my code:</p>\n<pre><code>require &quot;mini_magick&quot;\nrequire &quot;rtesseract&quot;\n\nRTesseract.configure do |config|\n  config.processor = &quot;mini_magick&quot;\nend\n\nimage = MiniMagick::Image.open(&quot;input.png&quot;)\nimage = RTesseract.new('input.png').to_s\nputs image\n</code></pre>\n<p>As you can see, it is a very simple piece of code. It executes without a problem when I have the RTesseract code commented out, but as soon as I call RTesseract's functionalities, things like the following began to rise up:</p>\n<pre><code>C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/rtesseract-2.1.0/lib/rtesseract.rb:182:in `convert': No such file or directory - tesseract &quot;C:/Users/NORMAL~1/AppData/Local/Temp/20170801-8600-1evxygh.tif&quot; &quot;C:/Users/NORMAL~1/AppData/Local/Temp/1501649603.1925441244&quot;  -l eng         (RTesseract::ConversionError)\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/rtesseract-2.1.0/lib/rtesseract.rb:194:in `to_s'\n        from testingTesseract.rb:12:in `&lt;main&gt;'\n</code></pre>\n<p>I have tried a lot of different things, but nothing seems to get this confounded gem to work. I would've gone to a different language or wrapper by now, but this gem is central to my project and I desperately need a solution.</p>\n<p>When I set the environment variable <code>PATH</code> to <code>C:\\Program Files (x86)\\Tesseract-OCR</code>, <code>tesseract</code> became a recognized command and <code>convert -version</code> started to give the output <code>Invalid Drive Specification</code>. The error now seems to be that ImageMagick is not recognized/found by the calls.</p>\n"}, {"tags": ["java", "ruby", "cryptography", "rsa", "public-key-encryption"], "comments": [{"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1501675940, "post_id": 45451680, "comment_id": 77881096, "body": "&quot;What am I missing here?&quot;  The java code. It&#39;s not possible to answer your question without it."}, {"owner": {"reputation": 81, "user_id": 5804379, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ySEsfUdDRaI/AAAAAAAAAAI/AAAAAAAAAEU/1zHeV1oXLB4/photo.jpg?sz=128", "display_name": "Vikram Bahl", "link": "https://stackoverflow.com/users/5804379/vikram-bahl"}, "reply_to_user": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1501683855, "post_id": 45451680, "comment_id": 77887701, "body": "Have added the Java code. If I generate a key in ruby and use Java code to encrypt my message, it works. Also added a hint about PKCS1 padding changes in Ruby OpenSSL, incase the answer lies somewhere in that direction."}], "owner": {"reputation": 81, "user_id": 5804379, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ySEsfUdDRaI/AAAAAAAAAAI/AAAAAAAAAEU/1zHeV1oXLB4/photo.jpg?sz=128", "display_name": "Vikram Bahl", "link": "https://stackoverflow.com/users/5804379/vikram-bahl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1501744266, "creation_date": 1501649266, "last_edit_date": 1501744266, "question_id": 45451680, "link": "https://stackoverflow.com/questions/45451680/ruby-rsa-public-encrypt-facing-given-final-block-not-properly-padded-error-in-ja", "title": "Ruby RSA public_encrypt facing Given final block not properly padded error in Java", "body": "<p>I am implementing Symmetric key encryption with another entity (let's call it APIProvider). Whenever I send them a request, they respond with an error - </p>\n\n<pre><code>Given final block not properly padded#012#011at\n</code></pre>\n\n<p>Here is the code that I have implemented</p>\n\n<p>Step 1: I extract the public key from the Certificate</p>\n\n<pre><code>def extract_public_key_from_certificate\n  certificate_file_content = File.read(\"#{Rails.root}/lib/certificates/GSTN_G2B_SANDBOX_UAT_public.cer\")\n  cert = OpenSSL::X509::Certificate.new(certificate_file_content)    \n  cert.public_key\nend\n</code></pre>\n\n<p>Step 2: I generate my own AES-256 key </p>\n\n<p>Step 3: I encrypt the key using public key and send it using HTTParty</p>\n\n<pre><code>@encrypted_key = Base64.encode64(@public_key.public_encrypt(@app_key))\n</code></pre>\n\n<p>The APIProvider responds with an error - </p>\n\n<pre><code>Given final block not properly padded#012#011at\n</code></pre>\n\n<p><strong>Other details for debugging</strong></p>\n\n<p>The AES Key that I generate looks like this</p>\n\n<pre><code>3aeMkWqxAQeQBp7LKl49FCBDYcwtl9QK6dDdeD7fzM8=\n</code></pre>\n\n<p>The Public Key that I extracted from the certificate</p>\n\n<pre><code>-----BEGIN PUBLIC KEY- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAn4ccEVpmsRfrUvxK6yfk g6brTJoGe90qzDNWOSqXJh51mwyLKjd7mccSaL7oMKTkXKLRmZvZtR1NYWnAU6nu KNjDQOC6LTzhoSE7siL2rneh0+A9rXyjEl6FuYp+ilV5rrsuWR3RLCUDYOFkIobH Ddhbl/B8Ol05bLrZvU1XIn7E98j47q/rWGp+SiHA5Ui7hAw+b2UCv8os8HWKmr6z NDziKPCGabrZTws/e1XJ0/uW5mxTfX/DOjbukP+aosMrlD1kVocJr+SrVRKzIOiC 7FYuY6q2CGY5+soXz8cQi7be6h5wJvZB9HdU6mYzTk4yw/bnNvuqlGIgoGF0nZzn MwIDAQAB -----END PUBLIC KEY-----\n</code></pre>\n\n<p>My encrypted key looks like this </p>\n\n<pre><code>evpqDyverZMmJVWhoZXNrAnpveNKDuQfiKt5nPJgTTtUMAeUp3IT7F+8cAad gCowubOwesJ7/hsMeAkVbLHMi1YUsWZ1xsDjTXUihOiRYLId8/Blyf5nP+wt AeG5MBfIWgP0o7cotve4lmH8/4Gh8Nh36ZH1jYEewwtjiNXE6lPtY3CESHIe lgPSf+vGy+O1YLKpDGPNu0twoBJfjeL9COnjJkpzOHofoh28SBMJoDeFrOGw cbkHC8fGLgv+sAkKdhy342aHBNeBlmLDt3McI2u+oHPniwtUyHFpJJ40bW2k IZeSpCT79ZNolXU3dcbXAwiJkcmdWEBGD40irAQaTw==\n</code></pre>\n\n<ol>\n<li><p>APIProvider has confirmed they are using PKCS1 padding. It's the same that I am using. <a href=\"https://ruby-doc.org/stdlib-2.0.0/libdoc/openssl/rdoc/OpenSSL/PKey/RSA.html#method-i-public_encrypt\" rel=\"nofollow noreferrer\">Infact I have checked that PKCS1 padding is the default in public_encrypt</a> </p></li>\n<li><p>The error message looks like it's part of their AES encryption-decryption. Here we are using RSA. It could be a standard message whenever they are not able to decrypt the message.</p></li>\n<li><p>Their application is working. In fact if I use a key generated using Java code (as implemented by others), it works. I am probably the only one implementing it in Ruby.</p></li>\n</ol>\n\n<p>What am I missing here? </p>\n\n<p>Edit 1 -</p>\n\n<p><strong>Here is the Java code that works</strong></p>\n\n<pre><code>    public class EncryptionUtil {\n\n    //public key url or location on the desktop for testing\n    public static String publicKeyUrl1 =\"/Users/vikrambahl/Work/gstn-keys/GSTN_G2B_SANDBOX_UAT_public.cer\";\n            private static String file;\n\n    private static PublicKey readPublicKey(String filename) throws Exception\n    {\n        FileInputStream fin = new FileInputStream(filename);\n        CertificateFactory f = CertificateFactory.getInstance(\"X.509\");\n        X509Certificate certificate = (X509Certificate)f.generateCertificate(fin);\n        PublicKey pk = certificate.getPublicKey();\n        return pk;\n\n    }\n\n\n    public static String encrypt(byte[] plaintext) throws Exception,NoSuchAlgorithmException, NoSuchPaddingException, InvalidKeyException, IllegalBlockSizeException, BadPaddingException\n    {\n\n        PublicKey key = readPublicKey(publicKeyUrl1);\n        Cipher cipher = Cipher.getInstance(\"RSA/ECB/PKCS1Padding\");\n        cipher.init(Cipher.ENCRYPT_MODE, key);\n        byte[] encryptedByte= cipher.doFinal(plaintext);\n        String encodedString = new String(java.util.Base64.getEncoder().encode(encryptedByte));\n        return encodedString;\n    }\n\n    public static String generateEncAppkey(byte[] key){\n        try {\n            return encrypt(key);\n        } catch (Exception e) {\n            e.printStackTrace();\n            return null;\n        }\n    }       \n}\n\nprivate static void produceSampleData(){\n    try {\n        //Generation of app key. this will be in encoded.\n        String appkey = generateSecureKey();\n        System.out.println(\"App key in encoded : \"+ appkey);\n        //Encrypt with GSTN public key\n        String encryptedAppkey = EncryptionUtil.generateEncAppkey(decodeBase64StringTOByte(appkey));\n        System.out.println(\"Encrypted App Key -&gt;\"+ encryptedAppkey);    \n    } catch (Exception e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    }\n}\n</code></pre>\n\n<p><strong>Pre 1.9.3 Ruby Padding</strong></p>\n\n<p>Also It seems that the PKCS1 encryption in pre 1.9.3 Ruby was different than what it is currently. <a href=\"https://redmine.ruby-lang.org/issues/4421\" rel=\"nofollow noreferrer\">Here is the commit where the change was brought in.</a> However it is more to do with how the public key was generated (PUBLIC KEY BEGINS VS PUBLIC RSA KEY BEGINS). Nonetheless I have tried to recreate the public key using the old standard and then encrypting my symmetric key. </p>\n\n<p>That didn't work either. Here is the code for that</p>\n\n<pre><code>def convert_public_key_to_old_ruby_pkcs1_format\n\n  gst_pem_file = File.read(\"#{Rails.root}/lib/certificates/GSTN_G2B_SANDBOX_UAT_public.pem\")\n\n  rsa = OpenSSL::PKey::RSA.new(gst_pem_file)\n  modulus = rsa.n\n  exponent = rsa.e\n\n  ary = [OpenSSL::ASN1::Integer.new(modulus), OpenSSL::ASN1::Integer.new(exponent)]\n  pub_key = OpenSSL::ASN1::Sequence.new(ary)\n  base64 = Base64.encode64(pub_key.to_der)\n\n  #This is the equivalent to the PKCS#1 encoding used before 1.9.3\n  pem = \"-----BEGIN RSA PUBLIC KEY-----\\n#{base64}-----END RSA PUBLIC KEY-----\"\n  the_public_key = OpenSSL::PKey::RSA.new(pem)\nend\n</code></pre>\n\n<p>Edit/Update - 2</p>\n\n<p><strong>Rails 3 / Ruby 1.9.1 did not work either</strong>\nI created a rails 3, ruby 1.9.1 app and tested. That didn't work either. I am yet to assess what was the exact change and whether the current version of padding that we use is PKCS1ver 1 or PKCS1 ver1.5. The investigation continues. </p>\n\n<p><strong>Let's try and use some symmetric encryption gems instead</strong>\nI did read through the code of a gem that offered symmetric encryption. Let me go ahead and use a few of them to see if my implementation is incorrect.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "logging"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501648180, "post_id": 45451485, "comment_id": 77863968, "body": "<i>Sidenote:</i> this happens in a development environment only. Do you really want to suppress logging to the console in <code>dev</code>?"}, {"owner": {"reputation": 45, "user_id": 4634994, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/62c8a2da92be005e44b8cb032aa2f51e?s=128&d=identicon&r=PG&f=1", "display_name": "3d510", "link": "https://stackoverflow.com/users/4634994/3d510"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501648990, "post_id": 45451485, "comment_id": 77864220, "body": "Oh I dont know that this only happens in development environment. This helps explain a lot. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501649546, "post_id": 45451575, "comment_id": 77864412, "body": "<code>1</code> in <code>1&gt;</code> is redundant. Also, rails logger might be configured to avoid printing anything to console; doing that printing, even followed by redirection to <code>&#47;dev&#47;null</code>, slows things down and should not be used."}], "tags": [], "owner": {"reputation": 1418, "user_id": 493674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134075878cc4e13e36a6099c277381a5?s=128&d=identicon&r=PG", "display_name": "Vijay Agrawal", "link": "https://stackoverflow.com/users/493674/vijay-agrawal"}, "is_accepted": true, "score": 0, "last_activity_date": 1501648645, "creation_date": 1501648645, "answer_id": 45451575, "question_id": 45451485, "link": "https://stackoverflow.com/questions/45451485/rails-logger-logging-to-console/45451575#45451575", "title": "Rails logger logging to console", "body": "<p>Thats how <code>rails s</code> behaves. It puts the logs in <code>log/development.log</code> as well as show at the command line. As thats more convenient for most cases.</p>\n\n<p>Anyways if you do not want it you can run your server something like this:</p>\n\n<pre><code>rails s 1&gt; /dev/null\n</code></pre>\n\n<p>This would redirect all that text to /dev/null</p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1501649410, "post_id": 45451618, "comment_id": 77864369, "body": "This is \u201chow to screw rails up\u201d advice. Don\u2019t you think that redirecting the output to the <i>already opened by rails for writing file</i> is not the best idea?"}, {"owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501649678, "post_id": 45451618, "comment_id": 77864458, "body": "@mudasobwa: He don&#39;t want to print the log in the console, so the above will work as per the question"}, {"owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501651046, "post_id": 45451618, "comment_id": 77864962, "body": "@mudasobwa: I have executed above &amp; I am not able to see the logs in console. All the logs are going on log/development.log file."}], "tags": [], "owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "is_accepted": false, "score": -1, "last_activity_date": 1501648933, "creation_date": 1501648933, "answer_id": 45451618, "question_id": 45451485, "link": "https://stackoverflow.com/questions/45451485/rails-logger-logging-to-console/45451618#45451618", "title": "Rails logger logging to console", "body": "<p>If you only wants to print the log in log/development.log and not in the console, then use below to start your <code>rails server</code>.</p>\n\n<pre><code>rails s &gt; log/development.log\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4634994, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/62c8a2da92be005e44b8cb032aa2f51e?s=128&d=identicon&r=PG&f=1", "display_name": "3d510", "link": "https://stackoverflow.com/users/4634994/3d510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 45451575, "answer_count": 2, "score": 0, "last_activity_date": 1501648933, "creation_date": 1501648073, "question_id": 45451485, "link": "https://stackoverflow.com/questions/45451485/rails-logger-logging-to-console", "title": "Rails logger logging to console", "body": "<p>I am using Rails logger to log information in my Rails 4 application. \nI do not set <code>config.logger=Logger.new(STDOUT)</code> in my configuration and just keep the default option for logger.However, besides the log file under <code>/log</code> folder, the information is still printed to the console when the statement <code>Rails.logger.info</code> is used.</p>\n\n<p>Why does this happen as I only want the log info to be inside the log file, not printed to console? Thanks</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501648361, "post_id": 45451049, "comment_id": 77864027, "body": "Your question is muddy. Look at your first sentence. Suppose you began a conversation that way. How could you expect anyone to understand that or even know which way the conversation was going. You are effectively saying, &quot;Here&#39;s my code. Please debug it.&quot;. You need to first explain what you are trying to do, without any reference to your code. When applicable, augment that with a simple example that includes the desired return value."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501655817, "post_id": 45451049, "comment_id": 77867199, "body": "What is the <code>n.each</code> loop supposed to achieve (you don&#39;t have to traverse an entire hash in order to set a single value)? If this is tic tac toe, then why do you assign the slot&#39;s number to the slot (<code>@entries[key]= name2</code>) instead of <code>&quot;X&quot;</code> or <code>&quot;O&quot;</code>? Why do you refer directly to <code>@entries</code> within the <code>choice</code> method, although it was passes as an argument <code>n</code>?"}, {"owner": {"reputation": 257, "user_id": 6642551, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1145135395532946/picture?type=large", "display_name": "Jacob Moore", "link": "https://stackoverflow.com/users/6642551/jacob-moore"}, "edited": false, "score": 0, "creation_date": 1501669378, "post_id": 45451049, "comment_id": 77876386, "body": "I edited it to equal &quot;X&quot; instead of name2.  The point of the loop was to iterate through the hash and if the users answer matched a key than a &quot;X&quot; is placed in the corresponding square of the grid. You asked why I traversed through the entire hash....I did so because that&#39;s the only way I know of right now to check if that value exists."}, {"owner": {"reputation": 257, "user_id": 6642551, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1145135395532946/picture?type=large", "display_name": "Jacob Moore", "link": "https://stackoverflow.com/users/6642551/jacob-moore"}, "edited": false, "score": 0, "creation_date": 1501680612, "post_id": 45451049, "comment_id": 77885057, "body": "So any idea how I can keep giving input instead of the program ending after the first?"}], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 6642551, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1145135395532946/picture?type=large", "display_name": "Jacob Moore", "link": "https://stackoverflow.com/users/6642551/jacob-moore"}, "edited": false, "score": 0, "creation_date": 1501709042, "post_id": 45451427, "comment_id": 77903551, "body": "Isn&#39;t n the parameter that I used for n.each?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 257, "user_id": 6642551, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1145135395532946/picture?type=large", "display_name": "Jacob Moore", "link": "https://stackoverflow.com/users/6642551/jacob-moore"}, "edited": false, "score": 1, "creation_date": 1501709461, "post_id": 45451427, "comment_id": 77903749, "body": "Oh, indeed. Never call parameters a single letter. My bad."}, {"owner": {"reputation": 257, "user_id": 6642551, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1145135395532946/picture?type=large", "display_name": "Jacob Moore", "link": "https://stackoverflow.com/users/6642551/jacob-moore"}, "edited": false, "score": 0, "creation_date": 1501710163, "post_id": 45451427, "comment_id": 77904011, "body": "Noted. if I put the code in a loop like you suggested it will keep printing my grid until the program crashes instead of what I want which is to put an X in one square then get prompted again for the next until there is 3 in a row."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1501647667, "creation_date": 1501647667, "answer_id": 45451427, "question_id": 45451049, "link": "https://stackoverflow.com/questions/45451049/restarting-iteration-and-prompting-for-user-input-until-given-hash-values-are-me/45451427#45451427", "title": "restarting iteration and prompting for user input until given hash values are met", "body": "<p><code>choice</code> function currently expects a parameter, that is never used. It is unclear what you are trying to achieve, but certainly, the function should use the parameter received, or it should not receive a parameter at all. </p>\n\n<p>If the goal is to fill all the sockets, one might iterate unless they are filled:</p>\n\n<pre><code>loop do\n  break \"Completed!\" if @entries.all? { |k, v| k == v }\n\n  choice()\nend\n</code></pre>\n"}], "owner": {"reputation": 257, "user_id": 6642551, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1145135395532946/picture?type=large", "display_name": "Jacob Moore", "link": "https://stackoverflow.com/users/6642551/jacob-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 45451427, "answer_count": 1, "score": 0, "last_activity_date": 1501667167, "creation_date": 1501645245, "last_edit_date": 1501667167, "question_id": 45451049, "link": "https://stackoverflow.com/questions/45451049/restarting-iteration-and-prompting-for-user-input-until-given-hash-values-are-me", "title": "restarting iteration and prompting for user input until given hash values are met", "body": "<p>This is the beginning of a tic tac toe program. I want the program to loop through, and then reset back for more input until a given scenario of hash values is met. As of right now it asks for input and displays it on my grid one time. If I try to wrap it in a loop the program prints the first input until it crashes.</p>\n\n<pre><code>@entries = {1=&gt;\" \", 2=&gt;\" \", 3=&gt;\" \", 4=&gt;\" \", 5=&gt;\" \", 6=&gt;\" \", 7=&gt;\" \", 8=&gt;\" \",9=&gt;\" \"}\n\ndef choice(n)\n  puts \"pick a space!\"\n  name = gets.chomp\n  name2 = name.to_i\n  n.each do |key,value|\n    if name2 == key \n      @entries[key]= \"X\"\n      puts \"\\t\\t #{@entries[1]} | #{@entries[2]} | #{@entries[3]} \"\n      puts \"\\t\\t-----------\"\n      puts \"\\t\\t #{@entries[4]} | #{@entries[5]} | #{@entries[6]} \"\n      puts \"\\t\\t-----------\"\n      puts \"\\t\\t #{@entries[7]} | #{@entries[8]} | #{@entries[9]} \"\n    end\n  end\nend\n\nchoice(@entries)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "edited": false, "score": 2, "creation_date": 1501645023, "post_id": 45450780, "comment_id": 77863059, "body": "your code looks fine .. try removing that extra space <code>&quot;product[category_ids][] &quot;</code> after []"}, {"owner": {"reputation": 13, "user_id": 8042378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-c58vdB6u26U/AAAAAAAAAAI/AAAAAAAAAIQ/xHs1Skj9KAU/photo.jpg?sz=128", "display_name": "Gerardo J. Colina Q.", "link": "https://stackoverflow.com/users/8042378/gerardo-j-colina-q"}, "reply_to_user": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "edited": false, "score": 0, "creation_date": 1501680352, "post_id": 45450780, "comment_id": 77884846, "body": "THANKS!!! that solved the problem. thank you , How can i reward you in stackoverflow for your answer ?"}, {"owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "edited": false, "score": 0, "creation_date": 1501680995, "post_id": 45450780, "comment_id": 77885357, "body": "cool .. i&#39;ll add this as an answer"}], "answers": [{"tags": [], "owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "is_accepted": true, "score": 0, "last_activity_date": 1501681286, "creation_date": 1501681286, "answer_id": 45462577, "question_id": 45450780, "link": "https://stackoverflow.com/questions/45450780/ruby-on-rails-5-im-getting-a-hash-instead-of-an-array-when-submiting-a-form/45462577#45462577", "title": "Ruby on Rails 5 : I&#39;m getting a hash instead of an array when submiting a form", "body": "<p>Try removing that extra space on your rails' form's checkbox syntax <code>check_box_tag</code> </p>\n\n<p>Update \"product[category_ids][] \" without the extra space to \"product[category_ids][]\"</p>\n\n<pre><code>&lt;%= check_box_tag \"product[category_ids][]\", c.id, product.category_ids.include?(c.id) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8042378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-c58vdB6u26U/AAAAAAAAAAI/AAAAAAAAAIQ/xHs1Skj9KAU/photo.jpg?sz=128", "display_name": "Gerardo J. Colina Q.", "link": "https://stackoverflow.com/users/8042378/gerardo-j-colina-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 45462577, "answer_count": 1, "score": 0, "last_activity_date": 1501681286, "creation_date": 1501643181, "question_id": 45450780, "link": "https://stackoverflow.com/questions/45450780/ruby-on-rails-5-im-getting-a-hash-instead-of-an-array-when-submiting-a-form", "title": "Ruby on Rails 5 : I&#39;m getting a hash instead of an array when submiting a form", "body": "<p>i have a form with several check boxes, where checkboxes are categories of products .</p>\n\n<p>A product can be in one or many categories, and a category can have one or many products.</p>\n\n<p>I'm using a has_many :through association in ruby on rails 5</p>\n\n<p>when i submit a form with these check_boxes : </p>\n\n<pre><code> &lt;div class=\"field\"&gt;\n  &lt;h5&gt;Category&lt;/h5&gt;\n  &lt;% Category.all.each do |c| %&gt;\n    &lt;%= check_box_tag \"product[category_ids][] \", c.id, product.category_ids.include?(c.id) %&gt;\n      &lt;%= c.name %&gt; &lt;br/&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p></p>\n\n<p>this is what get passed as parameters :</p>\n\n<pre><code>\"product\"=&gt;{\"name\"=&gt;\"Pencil\", \"category_ids\"=&gt;[{\" \"=&gt;\"1\"}, {\" \"=&gt;\"2\"}]}\n</code></pre>\n\n<p>but what i really need is something like this:</p>\n\n<pre><code> \"product\"=&gt;{\"name\"=&gt;\"Pencil\", \"category_ids\"=&gt;[\"1\", \"2\"]}\n</code></pre>\n\n<p>i need an array not an array of hashes .</p>\n\n<p>How could i get that array?. </p>\n\n<p>this is what i mostly have in my product controller:</p>\n\n<pre><code>def create\n    @product = Product.new(product_params)\n\n    respond_to do |format|\n      if @product.save\n        format.html { redirect_to @product, notice: 'Product was successfully created.' }\n      else\n        format.html { render :new }\n      end\n    end\n  end\n  def product_params\n      params.require(:product).permit!\n  end\n</code></pre>\n\n<p>Thanks for your help !</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 8454, "user_id": 958529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3ec25db39c63bab1a11037649e326b8?s=128&d=identicon&r=PG", "display_name": "halfelf", "link": "https://stackoverflow.com/users/958529/halfelf"}, "edited": false, "score": 0, "creation_date": 1501641588, "post_id": 45450454, "comment_id": 77862229, "body": "change <code>:modifiers=&gt;[]</code> to <code>:modifiers=&gt;set</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501647847, "post_id": 45450454, "comment_id": 77863841, "body": "In the second example, <code>[&#39;2222&#39;=&gt;&#39;33333&#39;, &#39;4444&#39;=&gt;&#39;55555&#39;]  =&gt; [{&quot;2222&quot;=&gt;&quot;33333&quot;, &quot;4444&quot;=&gt;&quot;55555&quot;}]</code>. I wasn&#39;t sure if you meant to write the hash that way or forget the braces, but either way is of course OK."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501657352, "post_id": 45450454, "comment_id": 77868105, "body": "You question is unclear. Do you want to find the differences or ignore such differences?"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 2486, "user_id": 3149988, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e372b773ea8ee0931b8173763e0b758d?s=128&d=identicon&r=PG&f=1", "display_name": "echan00", "link": "https://stackoverflow.com/users/3149988/echan00"}, "edited": false, "score": 1, "creation_date": 1501651303, "post_id": 45451094, "comment_id": 77865043, "body": "echan00, you are welcome. See my edit. I was able to simplify quite a bit."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1501651240, "last_edit_date": 1501651240, "creation_date": 1501645540, "answer_id": 45451094, "question_id": 45450454, "link": "https://stackoverflow.com/questions/45450454/compare-hash-arrays-in-ruby/45451094#45451094", "title": "Compare Hash Arrays in Ruby", "body": "<p>This recursive solution should work with any number of levels of nested arrays and hashes.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>require 'set'\n\ndef arr_to_set(o)\n  case o\n  when Hash\n    o.each_with_object({}) { |(k,v),g| g[k] = arr_to_set(v) }\n  when Array\n    o.map { |e| arr_to_set(e) }.to_set\n  else\n    o\n  end\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<p><em>Example 1</em></p>\n\n<pre><code>a = {\"197315\"=&gt;{:qty=&gt;1, :modifiers=&gt;[\n                           {\"197323-197319\"=&gt;{:qty=&gt;1}},\n                           {\"197322-197321\"=&gt;{:qty=&gt;1}}\n                         ]\n               }\n    }\n\nb = {\"197315\"=&gt;{:qty=&gt;1, :modifiers=&gt;[\n                           {\"197322-197321\"=&gt;{:qty=&gt;1}},\n                           {\"197323-197319\"=&gt;{:qty=&gt;1}}\n                         ]\n               }\n    }\n\narr_to_set(a) == arr_to_set(b)\n  #=&gt; true\n</code></pre>\n\n<p><em>Example 2</em></p>\n\n<pre><code>c = {\"197315\"=&gt;{:qty=&gt;1,\n                :modifiers=&gt;[\n                  {\"197322-197321\"=&gt;{ :qty=&gt;1,\n                                      :modifiers=&gt;['2222'=&gt;'33333', '4444'=&gt;'55555']\n                                    }\n                  },\n                  {\"197323-197319\"=&gt;{:qty=&gt;1}\n                  }\n                ]\n              }\n    }\n\nd = {\"197315\"=&gt;{:qty=&gt;1,\n                :modifiers=&gt;[\n                  {\"197322-197321\"=&gt;{:qty=&gt;1,\n                                     :modifiers=&gt;['4444'=&gt;'55555', '2222'=&gt;'33333']\n                                    }\n                  },\n                  {\"197323-197319\"=&gt;{:qty=&gt;1}\n                  }\n                ]\n               }\n    }\n\narr_to_set(c) == arr_to_set(d)\n  #=&gt; true\n</code></pre>\n"}], "owner": {"reputation": 2486, "user_id": 3149988, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e372b773ea8ee0931b8173763e0b758d?s=128&d=identicon&r=PG&f=1", "display_name": "echan00", "link": "https://stackoverflow.com/users/3149988/echan00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 45451094, "answer_count": 1, "score": 1, "last_activity_date": 1501651240, "creation_date": 1501640456, "last_edit_date": 1501647908, "question_id": 45450454, "link": "https://stackoverflow.com/questions/45450454/compare-hash-arrays-in-ruby", "title": "Compare Hash Arrays in Ruby", "body": "<p>I'm trying to compare and find the difference between two nested hashes with multiple hash arrays within arrays.</p>\n\n<p>What is the best way to go about this comparison? It appears there are no libraries or functions that can help with this..</p>\n\n<p>For example, I want the below two examples of hash a and hash b to be considered equal.</p>\n\n<pre><code>pry(main)&gt; a\n#\u21d2 {\"197315\"=&gt;{:qty=&gt;1,\n#              :modifiers=&gt;[{\"197323-197319\"=&gt;{:qty=&gt;1}},\n#                           {\"197322-197321\"=&gt;{:qty=&gt;1}}]}}\n\npry(main)&gt; b\n#\u21d2 {\"197315\"=&gt;{:qty=&gt;1,\n#              :modifiers=&gt;[{\"197322-197321\"=&gt;{:qty=&gt;1}},\n#                           {\"197323-197319\"=&gt;{:qty=&gt;1}}]}}\n\npry(main)&gt; a == b\n#\u21d2 false\n\npry(main)&gt; a\n#\u21d2 {\"197315\"=&gt;{:qty=&gt;1,\n#              :modifiers=&gt;[{\"197322-197321\"=&gt;{\n#                :qty=&gt;1,\n#                :modifiers=&gt;['2222'=&gt;'33333', '4444'=&gt;'55555']}}, \n#                           {\"197323-197319\"=&gt;{:qty=&gt;1}}]}}\n\npry(main)&gt; b\n#\u21d2 {\"197315\"=&gt;{:qty=&gt;1,\n#              :modifiers=&gt;[{\"197322-197321\"=&gt;{\n#                :qty=&gt;1,\n#                :modifiers=&gt;['4444'=&gt;'55555', '2222'=&gt;'33333']}},\n#                            {\"197323-197319\"=&gt;{:qty=&gt;1}}]}}\n\npry(main)&gt; a == b\n#\u21d2 false\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1501644653, "post_id": 45450450, "comment_id": 77862955, "body": "Related (not dupe): <a href=\"https://stackoverflow.com/q/45069756/525478\">stackoverflow.com/q/45069756/525478</a>"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 2, "creation_date": 1501644873, "post_id": 45450450, "comment_id": 77863025, "body": "<a href=\"http://ruby-doc.org/stdlib-2.4.1/libdoc/benchmark/rdoc/Benchmark.html\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.4.1/libdoc/benchmark/rdoc/Benchmark.ht&zwnj;&#8203;ml</a>"}], "answers": [{"comments": [{"owner": {"reputation": 271, "user_id": 4073708, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5fc9bc081d93bff93c1442a7d90695b1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/4073708/nathan"}, "edited": false, "score": 0, "creation_date": 1501642283, "post_id": 45450581, "comment_id": 77862394, "body": "Ok, yeah, I get that. the [until] statement is more readable.   But really, the question is about speed. In a large program, would it really make a difference? How much of &quot;until&quot; is being parsed down into machine code compared to &quot;while&quot;?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 271, "user_id": 4073708, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5fc9bc081d93bff93c1442a7d90695b1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/4073708/nathan"}, "edited": false, "score": 2, "creation_date": 1501657512, "post_id": 45450581, "comment_id": 77868213, "body": "@Nathan: &quot;I&#39;m learning Ruby right now.&quot; - In this case, worrying about what bytecode gets generated should be the <b>last</b> thing on your mind. Ruby programs are never slow just because one loop keyword is &quot;slower&quot; than the other."}], "tags": [], "owner": {"reputation": 172, "user_id": 6831572, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d0bdcbb13d6f5b35393b736e4d030f44?s=128&d=identicon&r=PG&f=1", "display_name": "Zonet", "link": "https://stackoverflow.com/users/6831572/zonet"}, "is_accepted": false, "score": 3, "last_activity_date": 1501641562, "creation_date": 1501641562, "answer_id": 45450581, "question_id": 45450450, "link": "https://stackoverflow.com/questions/45450450/ruby-what-is-the-speed-difference-between-while-and-until-loops/45450581#45450581", "title": "Ruby: What is the speed difference between While and Until loops?", "body": "<p>Speed differences aside, it's really all about readability, which is something that Ruby prides itself on.</p>\n\n<p>Let's pretend we're making a drink - which do you think reads better?</p>\n\n<pre><code>A) pour_drink until glass.full?\nB) pour_drink while !glass.full?\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 271, "user_id": 4073708, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5fc9bc081d93bff93c1442a7d90695b1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/4073708/nathan"}, "edited": false, "score": 0, "creation_date": 1501683641, "post_id": 45450986, "comment_id": 77887540, "body": "Wow, this is actually really cool to see! Thank you. Where can I learn more about this?"}, {"owner": {"reputation": 2764, "user_id": 557460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcb0f0a01469bd704dac5c6d0e1ebb16?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/557460/jon"}, "reply_to_user": {"reputation": 271, "user_id": 4073708, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5fc9bc081d93bff93c1442a7d90695b1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/4073708/nathan"}, "edited": false, "score": 0, "creation_date": 1501690517, "post_id": 45450986, "comment_id": 77892844, "body": "@Nathan There&#39;s a great book about Ruby&#39;s internals: <a href=\"https://www.nostarch.com/rum\" rel=\"nofollow noreferrer\"><i>Ruby Under a Microscope</i></a> by Pat Shaughnessy. Pat has some excerpts in a few blog posts here: <a href=\"http://patshaughnessy.net/2012/6/29/how-ruby-executes-your-code\" rel=\"nofollow noreferrer\">patshaughnessy.net/2012/6/29/how-ruby-executes-your-code</a> There aren&#39;t too many resources about this topic. There are a few blog posts, but they tend to reference Pat&#39;s book."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1501703562, "post_id": 45450986, "comment_id": 77900600, "body": "Note: Ruby Under a Microscope is <i>not</i> a book about Ruby&#39;s internals. It is a book about YARV&#39;s internals. (Ruby is a programming language, a language is a specification, a piece of paper, it has no &quot;internals&quot;.) As far as I know, it doesn&#39;t cover TruffleRuby <i>at all</i>, for example, which I personally think is by far the most interesting Ruby implementation to study."}, {"owner": {"reputation": 2764, "user_id": 557460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcb0f0a01469bd704dac5c6d0e1ebb16?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/557460/jon"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1501705084, "post_id": 45450986, "comment_id": 77901450, "body": "@J&#246;rgWMittag Right! The book specifically looks at YARV/MRI, but it&#39;s a great source for those looking to learn more. If you know of other resources for those looking to learn, please share. TruffleRuby is a very interesting implementation which stands out among other implementations. I&#39;m just waiting for MRI&#39;s <a href=\"https://github.com/ruby/ruby/pull/1419\" rel=\"nofollow noreferrer\">deoptimizations</a>... :)"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1501718951, "post_id": 45450986, "comment_id": 77906570, "body": "FWIW, it looks like Ruby Under a Microscope spends a chapter each on JRuby and Rubinius. Both Ruby Under a Microscope and TruffleRuby look pretty interesting, I guess I have some reading to do..."}], "tags": [], "owner": {"reputation": 2764, "user_id": 557460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcb0f0a01469bd704dac5c6d0e1ebb16?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/557460/jon"}, "is_accepted": true, "score": 5, "last_activity_date": 1501675897, "last_edit_date": 1501675897, "creation_date": 1501644670, "answer_id": 45450986, "question_id": 45450450, "link": "https://stackoverflow.com/questions/45450450/ruby-what-is-the-speed-difference-between-while-and-until-loops/45450986#45450986", "title": "Ruby: What is the speed difference between While and Until loops?", "body": "<p>There would not be a speed difference between <code>while</code> and <code>until</code> as they mirror each other.</p>\n\n<p>We'll compare a <code>while</code> loop with an <code>until</code> loop:</p>\n\n<pre><code>n = 0\nputs n += 1 while n != 3\n\nn = 0\nputs n += 1 until n == 3\n</code></pre>\n\n<p>These will both print 1 through 3.</p>\n\n<p>Here's a diff between the two disassembled human-readable instruction sequences from the Ruby VM:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>@@ -13,7 +13,7 @@\n 0021 pop              \n 0022 getlocal_OP__WC__0 2\n 0024 putobject        3\n-0026 opt_neq          &lt;callinfo!mid:!=, argc:1, ARGS_SIMPLE&gt;, &lt;callcache&gt;, &lt;callinfo!mid:==, argc:1, ARGS_SIMPLE&gt;, &lt;callcache&gt;\n-0031 branchif         8\n-0033 putnil           \n-0034 leave\n+0026 opt_eq           &lt;callinfo!mid:==, argc:1, ARGS_SIMPLE&gt;, &lt;callcache&gt;\n+0029 branchunless     8\n+0031 putnil           \n+0032 leave\n</code></pre>\n\n<p>A <code>while</code> loop uses a <code>branchif</code> for its jump, whereas the <code>until</code> loop used a <code>branchunless</code>. So, these loops simply differ in the comparison being made, which you can see by looking at how <code>branchif</code> and <code>branchunless</code> are <a href=\"https://github.com/ruby/ruby/blob/ruby_2_4/insns.def#L1186\" rel=\"nofollow noreferrer\">defined</a>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>DEFINE_INSN\nbranchif\n(OFFSET dst)\n(VALUE val)\n()\n{\n    if (RTEST(val)) {\n    RUBY_VM_CHECK_INTS(th);\n    JUMP(dst);\n    }\n}\n</code></pre>\n\n<pre class=\"lang-c prettyprint-override\"><code>DEFINE_INSN\nbranchunless\n(OFFSET dst)\n(VALUE val)\n()\n{\n    if (!RTEST(val)) {\n    RUBY_VM_CHECK_INTS(th);\n    JUMP(dst);\n    }\n}\n</code></pre>\n\n<p>Performance between <code>while</code> and <code>until</code> should be nearly identical. Usage should be determined by readability.</p>\n"}, {"comments": [{"owner": {"reputation": 271, "user_id": 4073708, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5fc9bc081d93bff93c1442a7d90695b1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/4073708/nathan"}, "edited": false, "score": 0, "creation_date": 1501683729, "post_id": 45452641, "comment_id": 77887596, "body": "This is kinda cool, but yeah, I can see where speed is a very negligible difference here. Obviously this will also depend on each individual computer at this level. Thank you for the effort on writing this up for me."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 271, "user_id": 4073708, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5fc9bc081d93bff93c1442a7d90695b1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/4073708/nathan"}, "edited": false, "score": 0, "creation_date": 1501684489, "post_id": 45452641, "comment_id": 77888238, "body": "@Nathan No problem! Thanks for asking the question. Jon&#39;s answer is definitely better at explaining why they&#39;re the same, there&#39;s no way I could top that. But it&#39;s always fun to write up some benchmarks and test things out for real."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 271, "user_id": 4073708, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5fc9bc081d93bff93c1442a7d90695b1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/4073708/nathan"}, "edited": false, "score": 0, "creation_date": 1501684646, "post_id": 45452641, "comment_id": 77888384, "body": "@Nathan It was interesting to see that <code>!=</code> was about 20% slower than <code>&lt;</code> in this context"}], "tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": false, "score": 3, "last_activity_date": 1501655870, "last_edit_date": 1501655870, "creation_date": 1501653865, "answer_id": 45452641, "question_id": 45450450, "link": "https://stackoverflow.com/questions/45450450/ruby-what-is-the-speed-difference-between-while-and-until-loops/45452641#45452641", "title": "Ruby: What is the speed difference between While and Until loops?", "body": "<p>Speed will be more influenced by your choice of comparison operator than your choice of <code>while</code> or <code>until</code></p>\n\n<pre><code>Benchmark.bmbm do |bm|\n  bm.report('while') do\n    n = 0\n    n += 1 while n != 10_000_000\n  end\n\n  bm.report('until') do\n    n = 0\n    n += 1 until n == 10_000_000\n  end\nend\n\n            user     system      total        real\nwhile   0.250000   0.000000   0.250000 (  0.247949)\nuntil   0.220000   0.000000   0.220000 (  0.222049)\n</code></pre>\n\n<p>With <code>while n != 10_000_000</code> vs. <code>until n == 10_000_000</code>, <code>until</code> appears to be faster.</p>\n\n<pre><code>Benchmark.bmbm do |bm|\n  bm.report('while') do\n    n = 0\n    n += 1 while n &lt; 10_000_000\n  end\n\n  bm.report('until') do\n    n = 0\n    n += 1 until n == 10_000_000\n  end\nend\n\n            user     system      total        real\nwhile   0.210000   0.000000   0.210000 (  0.207265)\nuntil   0.220000   0.000000   0.220000 (  0.223195)\n</code></pre>\n\n<p>Change it to <code>while n &lt; 10_000_000</code> and now <code>while</code> seems to have the edge. To be fair we should give them the more equivalent <code>while n &lt; 10_000_000</code> vs. <code>until n &gt; 9_999_999</code></p>\n\n<pre><code>Benchmark.bmbm do |bm|\n  bm.report('while') do\n    n = 0\n    n += 1 while n &lt; 10_000_000\n  end\n\n  bm.report('until') do\n    n = 0\n    n += 1 until n &gt; 9_999_999\n  end\nend\n\n            user     system      total        real\nwhile   0.200000   0.000000   0.200000 (  0.208428)\nuntil   0.200000   0.000000   0.200000 (  0.206218)\n</code></pre>\n\n<p>Now they're almost identical. So follow Ruby's lead and gain your satisfaction from code that reads like an English sentence. But make sure you use <code>&lt;</code> or <code>&gt;</code> to gain that extra boost of .0000000001 seconds.</p>\n"}], "owner": {"reputation": 271, "user_id": 4073708, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5fc9bc081d93bff93c1442a7d90695b1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/4073708/nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 45450986, "answer_count": 3, "score": 2, "last_activity_date": 1501675897, "creation_date": 1501640437, "question_id": 45450450, "link": "https://stackoverflow.com/questions/45450450/ruby-what-is-the-speed-difference-between-while-and-until-loops", "title": "Ruby: What is the speed difference between While and Until loops?", "body": "<p>I'm learning Ruby right now. Coming from using Javascript the past couple of years, I'm familiar with the While loop. But the until loop? I've looked around but couldn't find a solid reason why one would be better than the other.</p>\n\n<p>Ruby has \"until\" which is described as another way to phrase a problem. The way I see it, \"while\" iterates until false, and \"until\" iterates until true.</p>\n\n<p>I'm sure that most of the programs I write won't really need refactoring for speed. However, I like to get into the little details sometimes.</p>\n\n<p>Is there a speed difference between the two loops? Why is there an \"until\" syntax in Ruby? Why not just stick with \"while?\"</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "comments": [{"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1501651367, "post_id": 45450445, "comment_id": 77865073, "body": "Quick question -- Did you start sidekiq server by running <code>bundle exec sidekiq</code>?"}, {"owner": {"reputation": 137, "user_id": 8230428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5ca1140f36a3f53b85638086c6cc08b1?s=128&d=identicon&r=PG&f=1", "display_name": "qanknku", "link": "https://stackoverflow.com/users/8230428/qanknku"}, "reply_to_user": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1501739084, "post_id": 45450445, "comment_id": 77911882, "body": "Sure I did @31piy"}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 8230428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5ca1140f36a3f53b85638086c6cc08b1?s=128&d=identicon&r=PG&f=1", "display_name": "qanknku", "link": "https://stackoverflow.com/users/8230428/qanknku"}, "is_accepted": true, "score": 1, "last_activity_date": 1501739209, "creation_date": 1501739209, "answer_id": 45475791, "question_id": 45450445, "link": "https://stackoverflow.com/questions/45450445/rails-using-activejob-sidekiq-does-not-initiate-job/45475791#45475791", "title": "Rails using ActiveJob/Sidekiq does not initiate job", "body": "<p>Solved problem.</p>\n\n<p>This was due to Work did not successfully dequeued job from suggested queue. When running the sidekiq, I gave <code>-q</code> option.</p>\n\n<p>For example <code>bundle exec sidekiq -e develop -q develop_submit_job_queue</code> </p>\n"}], "owner": {"reputation": 137, "user_id": 8230428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5ca1140f36a3f53b85638086c6cc08b1?s=128&d=identicon&r=PG&f=1", "display_name": "qanknku", "link": "https://stackoverflow.com/users/8230428/qanknku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 45475791, "answer_count": 1, "score": 1, "last_activity_date": 1501739209, "creation_date": 1501640374, "question_id": 45450445, "link": "https://stackoverflow.com/questions/45450445/rails-using-activejob-sidekiq-does-not-initiate-job", "title": "Rails using ActiveJob/Sidekiq does not initiate job", "body": "<p>While using ActiveJob with sidekiq,</p>\n\n<pre><code># application.rb\nconfig.active_job.queue_adapter = :sidekiq\n</code></pre>\n\n<p>I made a job using redis. </p>\n\n<pre><code>class SubmissionJob &lt; ActiveJob::Base\n  queue_as :default\n\n  def perform(*args)\n</code></pre>\n\n<p>While checking through the log, after calling job as </p>\n\n<pre><code>SubmissionJob_perform_later args\n</code></pre>\n\n<p>But this doesn't work after giving message when doing <code>rails s</code></p>\n\n<pre><code>Enqueued SubmissionJob (Job ID: 63320b9d-de2a-4791-99f6-e58f2adf73d7) to Sidekiq(development_default) with arguments: [\"12345\", \"12346\"]\n</code></pre>\n\n<p>when at last, I render the result calling with job_id from redis, the result supposed to be return the arguments, but it only returns empty array, and it seems SubmissionJob never runned.</p>\n\n<p>However, when I call with <code>perform_now</code> ,  <code>SubmissionJob.perform_now args</code> the function works properly so it seems the method SubmissionJob itself is not the problem.</p>\n\n<p>Where should I start to find problem and what is the possible solution to solve this. </p>\n"}, {"tags": ["ruby", "terminology", "control-flow"], "answers": [{"tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": true, "score": 1, "last_activity_date": 1501655437, "last_edit_date": 1501655437, "creation_date": 1501646007, "answer_id": 45451183, "question_id": 45449602, "link": "https://stackoverflow.com/questions/45449602/in-ruby-is-an-if-elsif-else-statements-subordinate-block-the-same-as-a-block/45451183#45451183", "title": "In Ruby, is an if/elsif/else statement&#39;s subordinate block the same as a &#39;block&#39; that is passed as a parameter?", "body": "<h1>TL;DR <code>if...end</code> is an expression, not a block</h1>\n\n<p>The proper use of the term <code>block</code> in Ruby is the code passed to a method in between <code>do...end</code> or curly braces <code>{...}</code>. A block can be and often is implicitly converted into a <code>Proc</code> within a method by using the <code>&amp;block</code> syntax in the method signature. This new <code>Proc</code> is an object with its own methods that can be passed to other methods, stored in variables and data structures, called repeatedly, etc... </p>\n\n<pre><code>def block_to_proc(&amp;block)\n  prc = block\n  puts prc\n  prc.class\nend\n\nblock_to_proc { 'inside the block' }\n# \"#&lt;Proc:0x007fa626845a98@(irb):21&gt;\"\n# =&gt; Proc\n</code></pre>\n\n<p>In the code above, a <code>Proc</code> is being implicitly created with the block as its body and assigned to the variable <code>block</code>. Likewise, a <code>Proc</code> (or a <code>lambda</code>, a type of <code>Proc</code>) can be \"expanded\" into blocks and passed to methods that are expecting them, by using the <code>&amp;block</code> syntax at the end of an arguments list.</p>\n\n<pre><code>def proc_to_block\n  result = yield # only the return value of the block can be saved, not the block itself\n  puts result\n  result.class\nend\n\nblock = Proc.new { 'inside the Proc' }\n\nproc_to_block(&amp;block)\n# \"inside the Proc\"\n# =&gt; String\n</code></pre>\n\n<p>Although there's somewhat of a two-way street between <code>block</code>s and <code>Proc</code>s, they're not the same. Notice that to define a <code>Proc</code> we had to pass a <code>block</code> to <code>Proc.new</code>. Strictly speaking a <code>block</code> is just a chunk of code passed to a method whose execution is deferred until explicitly called. A <code>Proc</code> is defined with a <code>block</code>, its execution is also deferred until called, but it is a bonafide object just like any other. A <code>block</code> cannot survive on its own, a <code>Proc</code> can.</p>\n\n<p>On the other hand, <code>block</code> or <code>block of code</code> is sometimes casually used to refer to any discreet chunk of code enclosed by Ruby keywords terminating with <code>end</code>: <code>if...else...end</code>, <code>begin...rescue...end</code>, <code>def...end</code>, <code>class...end</code>, <code>module...end</code>, <code>until...end</code>. But these are not really blocks, per se, and only really resemble them on the surface. Often they also have deferred execution until some condition is met. But they can stand entirely on their own, and always have return values. Ruby-doc.org's use of \"expression\" is more accurate. </p>\n\n<p>From <a href=\"https://en.wikipedia.org/wiki/Expression_(computer_science)\" rel=\"nofollow noreferrer\">wikipedia</a></p>\n\n<blockquote>\n  <p>An expression in a programming language is a combination of one or\n  more explicit values, constants, variables, operators, and functions\n  that the programming language interprets (according to its particular\n  rules of precedence and of association) and computes to produce (\"to\n  return\", in a stateful environment) another value.</p>\n</blockquote>\n\n<p>This is why you can do things like this</p>\n\n<pre><code>return_value = if 'expression'\n  true\nend\n\nreturn_value # =&gt; true\n</code></pre>\n\n<p>Try doing that with a block</p>\n\n<pre><code>return_value = do\n  true\nend\n\n# SyntaxError: (irb):24: syntax error, unexpected keyword_do_block\n# return_value = do\n#                  ^\n</code></pre>\n\n<p>A block is not an expression on its own. It needs either <code>yield</code> or a conversion to a <code>Proc</code> to survive. What happens when we pass a block to a method that doesn't want one?</p>\n\n<pre><code>puts(\"indifferent\") { \"to blocks\" }\n# \"indifferent\"\n# =&gt; nil\n</code></pre>\n\n<p>The block is totally lost, it disappears with no return value, no execution, as if it never existed. It needs <code>yield</code> to complete the expression and produce a return value.</p>\n\n<pre><code>class Object\n  def puts(*args)\n    super\n    yield if block_given?\n  end\nend\n\nputs(\"mindful\") { \"of blocks\" }\n# \"mindful\"\n# =&gt; \"of blocks\"\n</code></pre>\n"}], "owner": {"reputation": 68, "user_id": 5722323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C8noy.jpg?s=128&g=1", "display_name": "Dallas", "link": "https://stackoverflow.com/users/5722323/dallas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 1, "accepted_answer_id": 45451183, "answer_count": 1, "score": 3, "last_activity_date": 1501655437, "creation_date": 1501633756, "question_id": 45449602, "link": "https://stackoverflow.com/questions/45449602/in-ruby-is-an-if-elsif-else-statements-subordinate-block-the-same-as-a-block", "title": "In Ruby, is an if/elsif/else statement&#39;s subordinate block the same as a &#39;block&#39; that is passed as a parameter?", "body": "<p>I was doing some reading on if/elsif/else in Ruby, and I ran into some differences in terminology when describing how control expressions work.</p>\n\n<p>In the <a href=\"https://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Control_Structures\" rel=\"nofollow noreferrer\">Ruby Programming Wikibooks</a> (emphasis added):</p>\n\n<blockquote>\n  <p>A conditional Branch takes the result of a test expression and executes a <strong>block of code</strong> depending whether the test expression is true or false.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>An if expression, for example, not only determines whether a <strong>subordinate block of code</strong> will execute, but also results in a value itself.</p>\n</blockquote>\n\n<p>Ruby-doc.org, however, does not mention blocks at all in the definitions:</p>\n\n<blockquote>\n  <p>The simplest if expression has two parts, a \u201ctest\u201d expression and a \u201cthen\u201d <strong>expression</strong>. If the \u201ctest\u201d expression evaluates to a true then the \u201cthen\u201d expression is evaluated.</p>\n</blockquote>\n\n<p>Typically, when I have read about 'blocks' in Ruby, it has almost always been within the context of procs and lambdas. For example, rubylearning.com defines a block:</p>\n\n<blockquote>\n  <p>A Ruby <strong>block</strong> is a way of grouping statements, and may appear only in the source adjacent to a method call; the <strong>block</strong> is written starting on the same line as the method call's last parameter (or the closing parenthesis of the parameter list).</p>\n</blockquote>\n\n<p>The questions:</p>\n\n<ul>\n<li>When talking about blocks of code in Ruby, are we talking about\nthe group of code that gets passed in to a method or are we simply\ntalking about a group of code in general?</li>\n<li>Is there a way to easily differentiate between the two (and is there\na technical difference between the two)?</li>\n</ul>\n\n<p>Context for these questions: I am wondering if referring to the code inside of conditionals as <em>blocks</em> will be confusing to to new Ruby programmers when they are later introduced to blocks, procs, and lambdas.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "railstutorial.org"], "comments": [{"owner": {"reputation": 19544, "user_id": 317989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cc8d0c8db8ad0ff2ed65ff3f5a56dd6?s=128&d=identicon&r=PG", "display_name": "house9", "link": "https://stackoverflow.com/users/317989/house9"}, "edited": false, "score": 1, "creation_date": 1501629588, "post_id": 45448999, "comment_id": 77859284, "body": "Have you run your migrations and test prepared the database for the spec? <code>bundle exec rake db:migrate db:test:prepare</code>"}, {"owner": {"reputation": 11, "user_id": 8280747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6452faad400779911e264dafc046e9?s=128&d=identicon&r=PG&f=1", "display_name": "user693260", "link": "https://stackoverflow.com/users/8280747/user693260"}, "reply_to_user": {"reputation": 19544, "user_id": 317989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cc8d0c8db8ad0ff2ed65ff3f5a56dd6?s=128&d=identicon&r=PG", "display_name": "house9", "link": "https://stackoverflow.com/users/317989/house9"}, "edited": false, "score": 1, "creation_date": 1501629789, "post_id": 45448999, "comment_id": 77859332, "body": "Db:test:prepare did the trick. I didn&#39;t actually know that command existed. Thanks so much :)"}, {"owner": {"reputation": 19544, "user_id": 317989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cc8d0c8db8ad0ff2ed65ff3f5a56dd6?s=128&d=identicon&r=PG", "display_name": "house9", "link": "https://stackoverflow.com/users/317989/house9"}, "edited": false, "score": 0, "creation_date": 1501630703, "post_id": 45448999, "comment_id": 77859597, "body": "cool, glad it helped - always run it after every migration to keep development and test synced"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1501632390, "post_id": 45448999, "comment_id": 77860033, "body": "Not sure which version of Rails you are running, but you shouldn&#39;t really need to run <code>db:test:prepare</code> anymore. You probably didn&#39;t know that it existed because it has been deprecated."}, {"owner": {"reputation": 11, "user_id": 8280747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6452faad400779911e264dafc046e9?s=128&d=identicon&r=PG&f=1", "display_name": "user693260", "link": "https://stackoverflow.com/users/8280747/user693260"}, "edited": false, "score": 0, "creation_date": 1501632466, "post_id": 45448999, "comment_id": 77860049, "body": "5.0.(3 or 4) I can&#39;t remember which. I had literally never had to run anything other than reset or migrate so I don&#39;t doubt that"}], "owner": {"reputation": 11, "user_id": 8280747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6452faad400779911e264dafc046e9?s=128&d=identicon&r=PG&f=1", "display_name": "user693260", "link": "https://stackoverflow.com/users/8280747/user693260"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501629380, "creation_date": 1501629141, "last_edit_date": 1501629380, "question_id": 45448999, "link": "https://stackoverflow.com/questions/45448999/michael-hartl-ruby-tutorial-sql-exceptions", "title": "Michael Hartl Ruby Tutorial SQL Exceptions", "body": "<p>So I'm doing the Michael Hartl rails tutorial and have it completely done. It is running with two errors, however.</p>\n\n<p>It's the same error twice, and is as follows: </p>\n\n<pre><code>Error:\nPasswordResetsTest#test_password_resets:\nActiveRecord::StatementInvalid: SQLite3::SQLException: no such column: reset_sent_at: UPDATE \"users\" SET \"reset_digest\" = '$2a$04$W0ZosPrPZYt.uZi.onBQsOI/SEAYdCkNbXWKWtX.64mkkuGohToha', \"reset_sent_at\" = '2017-08-01 22:46:32.972718' WHERE \"users\".\"id\" = ?\n    app/models/user.rb:82:in `create_reset_digest'\n    app/controllers/password_resets_controller.rb:12:in `create'\n    test/integration/password_resets_test.rb:18:in `block in &lt;class:PasswordResetsTest&gt;'\n</code></pre>\n\n<p>As far as I know the following pages are the only relevant pages to the issue, but I could be wrong. So feel free to yell at me if that's the case :)</p>\n\n<p>This is the schema file</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20170622040432) do\n\n  create_table \"microposts\", force: :cascade do |t|\n    t.text     \"content\"\n    t.integer  \"user_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.string   \"picture\"\n    t.index [\"user_id\", \"created_at\"], name: \"index_microposts_on_user_id_and_created_at\"\n    t.index [\"user_id\"], name: \"index_microposts_on_user_id\"\n  end\n\n  create_table \"relationships\", force: :cascade do |t|\n    t.integer  \"follower_id\"\n    t.integer  \"followed_id\"\n    t.datetime \"created_at\",  null: false\n    t.datetime \"updated_at\",  null: false\n    t.index [\"followed_id\"], name: \"index_relationships_on_followed_id\"\n    t.index [\"follower_id\", \"followed_id\"], name: \"index_relationships_on_follower_id_and_followed_id\", unique: true\n    t.index [\"follower_id\"], name: \"index_relationships_on_follower_id\"\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string   \"name\"\n    t.string   \"email\"\n    t.datetime \"created_at\",                        null: false\n    t.datetime \"updated_at\",                        null: false\n    t.string   \"password_digest\"\n    t.string   \"remember_digest\"\n    t.boolean  \"admin\",             default: false\n    t.string   \"activation_digest\"\n    t.boolean  \"activated\",         default: false\n    t.datetime \"activated_at\"\n    t.string   \"reset_digest\"\n    t.datetime \"reset_sent_at\"\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n  end\n\nend\n</code></pre>\n\n<p>This is the Password Reset Test file</p>\n\n<pre><code>require 'test_helper'\n\nclass PasswordResetsTest &lt; ActionDispatch::IntegrationTest\n\n  def setup\n    ActionMailer::Base.deliveries.clear\n    @user = users(:michael)\n  end\n\n  test \"password resets\" do\n    get new_password_reset_path\n    assert_template 'password_resets/new'\n    # Invalid email\n    post password_resets_path, params: { password_reset: { email: \"\" } }\n    assert_not flash.empty?\n    assert_template 'password_resets/new'\n    # Valid email\n    post password_resets_path,\n         params: { password_reset: { email: @user.email } }\n    assert_not_equal @user.reset_digest, @user.reload.reset_digest\n    assert_equal 1, ActionMailer::Base.deliveries.size\n    assert_not flash.empty?\n    assert_redirected_to root_url\n    # Password reset form\n    user = assigns(:user)\n    # Wrong email\n    get edit_password_reset_path(user.reset_token, email: \"\")\n    assert_redirected_to root_url\n    # Inactive user\n    user.toggle!(:activated)\n    get edit_password_reset_path(user.reset_token, email: user.email)\n    assert_redirected_to root_url\n    user.toggle!(:activated)\n    # Right email, wrong token\n    get edit_password_reset_path('wrong token', email: user.email)\n    assert_redirected_to root_url\n    # Right email, right token\n    get edit_password_reset_path(user.reset_token, email: user.email)\n    assert_template 'password_resets/edit'\n    assert_select \"input[name=email][type=hidden][value=?]\", user.email\n    # Invalid password &amp; confirmation\n    patch password_reset_path(user.reset_token),\n          params: { email: user.email,\n                    user: { password:              \"foobaz\",\n                            password_confirmation: \"barquux\" } }\n    assert_select 'div#error_explanation'\n    # Empty password\n    patch password_reset_path(user.reset_token),\n          params: { email: user.email,\n                    user: { password:              \"\",\n                            password_confirmation: \"\" } }\n    assert_select 'div#error_explanation'\n    # Valid password &amp; confirmation\n    patch password_reset_path(user.reset_token),\n          params: { email: user.email,\n                    user: { password:              \"foobaz\",\n                            password_confirmation: \"foobaz\" } }\n    assert is_logged_in?\n    assert_not flash.empty?\n    assert_redirected_to user\n  end\n\n  test \"expired token\" do\n    get new_password_reset_path\n    post password_resets_path,\n         params: { password_reset: { email: @user.email } }\n\n    @user = assigns(:user)\n    @user.update_attribute(:reset_sent_at, 3.hours.ago)\n    patch password_reset_path(@user.reset_token),\n          params: { email: @user.email,\n                    user: { password:              \"foobar\",\n                            password_confirmation: \"foobar\" } }\n    assert_response :redirect\n    follow_redirect!\n    assert_match /expired/i, response.body\n  end\n\nend\n</code></pre>\n\n<p>And this is the Password Reset Controller</p>\n\n<pre><code>class PasswordResetsController &lt; ApplicationController\n  before_action :get_user,         only: [:edit, :update]\n  before_action :valid_user,       only: [:edit, :update]\n  before_action :check_expiration, only: [:edit, :update]    # Case (1)\n\n  def new\n  end\n\n  def create\n    @user = User.find_by(email: params[:password_reset][:email].downcase)\n    if @user\n      @user.create_reset_digest\n      @user.send_password_reset_email\n      flash[:info] = \"Email sent with password reset instructions\"\n      redirect_to root_url\n    else\n      flash.now[:danger] = \"Email address not found\"\n      render 'new'\n    end\n  end\n\n  def edit\n  end\n\n  def update\n    if params[:user][:password].empty?\n      @user.errors.add(:password, \"can't be empty\")\n      render 'edit'\n    elsif @user.update_attributes(user_params)\n      log_in @user\n      @user.update_attribute(:reset_digest, nil)\n      flash[:success] = \"Password has been reset.\"\n      redirect_to @user\n    else\n      render 'edit'\n    end\n  end\n\n\n  private\n\n    def user_params\n      params.require(:user).permit(:password, :password_confirmation)\n    end\n\n    # Before filters\n\n    def get_user\n      @user = User.find_by(email: params[:email])\n    end\n\n    # Confirms a valid user.\n    def valid_user\n      unless (@user &amp;&amp; @user.activated? &amp;&amp;\n              @user.authenticated?(:reset, params[:id]))\n        redirect_to root_url\n      end\n    end\n\n    # Checks expiration of reset token.\n    def check_expiration\n      if @user.password_reset_expired?\n        flash[:danger] = \"Password reset has expired.\"\n        redirect_to new_password_reset_url\n      end\n    end\nend\n</code></pre>\n\n<p>As you can see, all the referenced columns are present. I suppose the problem could be it's looking for a column in the wrong table, and therefore not finding it. I haven't found evidence to that claim, but it would logically solve the problem</p>\n\n<p>Also, like I said above, I've followed this tutorial to it's completion. So the only thing that might be missing is an exercise I didn't see, but other than that if something is missing that could be a problem. </p>\n\n<p>Like I said before if I've left anything out you guys need feel free to yell at me. I can't find out why it throws this exception, hopefully you guys can help</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1501627778, "post_id": 45448789, "comment_id": 77858788, "body": "Has the Quiz model the attribute <code>end_date</code>?"}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 1, "creation_date": 1501628459, "post_id": 45448789, "comment_id": 77858978, "body": "Sebastian is basically asking, is there an end_date column for quiz?  If so, active_record would have made a getter/setter for you automagically.  If end_date isn&#39;t meant to be a column but just some form data to manipulate and pass along you can add &quot;attr_accessor :end_date&quot; to your quiz model file to setup virtual attribute."}, {"owner": {"reputation": 21, "user_id": 8063362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qdT2k.jpg?s=128&g=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8063362/vincent"}, "edited": false, "score": 0, "creation_date": 1501630698, "post_id": 45448789, "comment_id": 77859595, "body": "thank you everyone! I was incorrectly trying to manually add the attribute to an already existing model\u2013 whoops!"}], "answers": [{"tags": [], "owner": {"reputation": 34077, "user_id": 1249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ed9686d6910478914966ec99bbcaa069?s=128&d=identicon&r=PG", "display_name": "Adam Lassek", "link": "https://stackoverflow.com/users/1249/adam-lassek"}, "is_accepted": true, "score": 0, "last_activity_date": 1501630734, "last_edit_date": 1501630734, "creation_date": 1501630416, "answer_id": 45449175, "question_id": 45448789, "link": "https://stackoverflow.com/questions/45448789/ruby-on-rails-method-undefined/45449175#45449175", "title": "Ruby on Rails, method undefined", "body": "<p>Let me break down how these different pieces relate to one-another, which hopefully will make this easier for you to troubleshoot.</p>\n\n<pre><code>&lt;%= form_for @quiz do |q| %&gt;\n</code></pre>\n\n<p>Here you are invoking <code>form_for</code> to create a form bound to the <code>@quiz</code> object. It yields a <strong><a href=\"http://guides.rubyonrails.org/form_helpers.html#binding-a-form-to-an-object\" rel=\"nofollow noreferrer\">form builder</a></strong> object as the argument <code>q</code>.</p>\n\n<pre><code>&lt;%= q.text_field :quiz_name %&gt;\n</code></pre>\n\n<p>Here you are calling the <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-text_field\" rel=\"nofollow noreferrer\"><code>text_field</code></a> method on the form builder with the field named <code>quiz_name</code>. This means it will generate a text input, and call the <code>quiz_name</code> method on <code>@quiz</code> to find the current value.</p>\n\n<p>So given that background, it should be clear why you are seeing this error:</p>\n\n<pre><code>&lt;%= q.text_field :end_date %&gt;\n</code></pre>\n\n<p>You are telling the form builder to call <code>@quiz.end_date</code> for the value of this field, but that method does not exist.</p>\n\n<p>You have not given enough code samples for us to determine why you expect this method to exist. Perhaps this is a field you've added to the quizzes table, but haven't yet run the migration? Is this supposed to be a virtual attribute on <code>Quiz</code>? Or perhaps you just want to send a field that isn't connected to the <code>Quiz</code> model inside this form. (You can do that with a separate set of helpers, in this case <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-text_field_tag\" rel=\"nofollow noreferrer\"><code>text_field_tag</code></a>, that give you more flexibility in where the data comes from).</p>\n"}], "owner": {"reputation": 21, "user_id": 8063362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qdT2k.jpg?s=128&g=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8063362/vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 45449175, "answer_count": 1, "score": 1, "last_activity_date": 1501630734, "creation_date": 1501627670, "last_edit_date": 1501629721, "question_id": 45448789, "link": "https://stackoverflow.com/questions/45448789/ruby-on-rails-method-undefined", "title": "Ruby on Rails, method undefined", "body": "<p>I'm very new to ruby on rails. I'm trying to make a text field to assign one of my variables (end_date), but I keep getting this error:</p>\n\n<pre><code>undefined method `end_date' for #&lt;Quiz:0x007fccd1e0f9c0&gt;\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>&lt;%# Main Canvas where cardes places %&gt;\n&lt;div class=\"column large-11\" id=\"main\"&gt;\n  &lt;%= form_for @quiz do |q| %&gt;\n    &lt;%= q.label :quiz_name %&gt;\n    &lt;%= q.text_field :quiz_name %&gt;\n    &lt;%= q.label :end_date %&gt;\n    &lt;%= q.text_field :end_date %&gt;\n    &lt;%= hidden_field_tag 'selected', 'none' %&gt;\n    &lt;%= q.hidden_field :classroom_id, value: @classroom_id%&gt;\n\n  &lt;%= q.submit \"Create Quiz\", class: \"expanded button\" %&gt;\n  &lt;% end %&gt;\n  &lt;%= form_tag(\"/quiz/#{@classroom_id}/copy\", method: \"get\") do %&gt;\n  &lt;%= label :id, \"ID\" %&gt;\n  &lt;%= text_field_tag \"id\", \"\" %&gt;\n  &lt;%= submit_tag \"Copy Quiz By ID\", class: \"expanded button\" %&gt;\n  &lt;% end %&gt;\n\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "url"], "comments": [{"owner": {"reputation": 424, "user_id": 2453580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22d4c9d549f4e3c58619b67c8e27e83a?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie L", "link": "https://stackoverflow.com/users/2453580/charlie-l"}, "edited": false, "score": 1, "creation_date": 1501627356, "post_id": 45448700, "comment_id": 77858672, "body": "So a URI could potentially contain both <code>,</code> and <code>.</code> which is probably why <code>extract</code> includes them. If you were looking to customize the behavior you could pass extract a block and then maybe check against the extracted string to see if it has any values that you would consider invalid.  <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/uri/rdoc/URI.html#method-c-extract-label-Synopsis\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.0.0/libdoc/uri/rdoc/&hellip;</a> <a href=\"https://stackoverflow.com/questions/7109143/what-characters-are-valid-in-a-url\" title=\"what characters are valid in a url\">stackoverflow.com/questions/7109143/&hellip;</a>  It is annoying that you even have to consider doing anything weird here though"}, {"owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "reply_to_user": {"reputation": 424, "user_id": 2453580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22d4c9d549f4e3c58619b67c8e27e83a?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie L", "link": "https://stackoverflow.com/users/2453580/charlie-l"}, "edited": false, "score": 1, "creation_date": 1501627498, "post_id": 45448700, "comment_id": 77858716, "body": "Yeah, I read the RFC. I&#39;m more looking for somebody who&#39;s already thought through the common-sense use cases, so I&#39;m not playing whack-a-mole."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501633648, "post_id": 45448700, "comment_id": 77860349, "body": "I don&#39;t know but +1 on the question. I&#39;m sure there&#39;s a well thought out regex that will solve the problem in combination with <code>URI.extract(..., &amp;block)</code>. I haven&#39;t thought it out very well though"}], "owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1501626953, "creation_date": 1501626953, "question_id": 45448700, "link": "https://stackoverflow.com/questions/45448700/common-sense-url-extraction-in-ruby", "title": "Common-sense URL extraction in Ruby", "body": "<p>Consider a URL embedded in plain text, such as <a href=\"http://example.com/\" rel=\"nofollow noreferrer\">http://example.com/</a>. Stack Overflow is smart enough to know that I didn't mean to include the period at the end as part of the URL, even though <code>.</code> is an unreserved character according to <a href=\"https://www.ietf.org/rfc/rfc3986.txt\" rel=\"nofollow noreferrer\">RFC 3986</a>.</p>\n\n<p>Likewise, if I type <a href=\"http://example.org/\" rel=\"nofollow noreferrer\">http://example.org/</a>, Stack Overflow is smart enough to know that I didn't mean to include the comma, even though as a member of the <code>sub-delims</code> class, <code>,</code> is a valid path character.</p>\n\n<p>Ruby's <code>URI.extract()</code>, as suggested in <a href=\"https://stackoverflow.com/a/9716632/27358\">this</a> and <a href=\"https://stackoverflow.com/a/5939906/27358\">this</a> highly-voted answer, is not as smart as Stack Overflow.</p>\n\n<pre><code>2.2.5 :002 &gt; URI.extract('...such as http://example.com/.')\n =&gt; [\"http://example.com/.\"] \n2.2.5 :003 &gt; URI.extract('Likewise, if I type http://example.org/, Stack Overflow...')\n =&gt; [\"http://example.org/,\"] \n</code></pre>\n\n<p>Is there a smarter alternative?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501627033, "post_id": 45448546, "comment_id": 77858576, "body": "What is the output of <code>puts self.inspect</code> in the <code>log_event</code> method in the context of the creation of an object using the Logger module?"}, {"owner": {"reputation": 249, "user_id": 1862366, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/J0hu2.jpg?s=128&g=1", "display_name": "PiKaY", "link": "https://stackoverflow.com/users/1862366/pikay"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501627213, "post_id": 45448546, "comment_id": 77858619, "body": "It gives the User object like &lt;xUser: h188b12hjh&gt;"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501635125, "post_id": 45448546, "comment_id": 77860692, "body": "then <code>self</code> represents the User instance (in that case). <code>self.class</code> should return User"}], "answers": [{"comments": [{"owner": {"reputation": 249, "user_id": 1862366, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/J0hu2.jpg?s=128&g=1", "display_name": "PiKaY", "link": "https://stackoverflow.com/users/1862366/pikay"}, "edited": false, "score": 0, "creation_date": 1501627232, "post_id": 45448697, "comment_id": 77858624, "body": "this gives the User object string"}, {"owner": {"reputation": 1418, "user_id": 493674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134075878cc4e13e36a6099c277381a5?s=128&d=identicon&r=PG", "display_name": "Vijay Agrawal", "link": "https://stackoverflow.com/users/493674/vijay-agrawal"}, "reply_to_user": {"reputation": 249, "user_id": 1862366, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/J0hu2.jpg?s=128&g=1", "display_name": "PiKaY", "link": "https://stackoverflow.com/users/1862366/pikay"}, "edited": false, "score": 0, "creation_date": 1501627365, "post_id": 45448697, "comment_id": 77858680, "body": "You would get <code>Class</code> as output if you are calling <code>.class</code> on <code>User</code> instead of an object of <code>User</code>"}, {"owner": {"reputation": 1418, "user_id": 493674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134075878cc4e13e36a6099c277381a5?s=128&d=identicon&r=PG", "display_name": "Vijay Agrawal", "link": "https://stackoverflow.com/users/493674/vijay-agrawal"}, "reply_to_user": {"reputation": 249, "user_id": 1862366, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/J0hu2.jpg?s=128&g=1", "display_name": "PiKaY", "link": "https://stackoverflow.com/users/1862366/pikay"}, "edited": false, "score": 0, "creation_date": 1501627509, "post_id": 45448697, "comment_id": 77858719, "body": "Can you post exact method and class definitions(the one posted don&#39;t have AR inheritance) or try with <code>pry</code> or <code>byebug</code> in this method. <code>self</code> should be pointing to the user object being created"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 249, "user_id": 1862366, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/J0hu2.jpg?s=128&g=1", "display_name": "PiKaY", "link": "https://stackoverflow.com/users/1862366/pikay"}, "edited": false, "score": 0, "creation_date": 1501632708, "post_id": 45448697, "comment_id": 77860112, "body": "@PiKaY this should work. If you&#39;re getting <code>users</code> from <code>self.class.table_name</code> then <code>self.class.name</code> should be <code>User</code>. Just to be 100% sure, I tested your module myself. Please post more of your class definitions, there must be something wrong"}], "tags": [], "owner": {"reputation": 1418, "user_id": 493674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134075878cc4e13e36a6099c277381a5?s=128&d=identicon&r=PG", "display_name": "Vijay Agrawal", "link": "https://stackoverflow.com/users/493674/vijay-agrawal"}, "is_accepted": false, "score": 2, "last_activity_date": 1501626898, "creation_date": 1501626898, "answer_id": 45448697, "question_id": 45448546, "link": "https://stackoverflow.com/questions/45448546/how-to-get-the-class-name-in-activesupportconcern/45448697#45448697", "title": "How to get the class name in ActiveSupport::Concern?", "body": "<p>The same way you would get it in a normal instance method.</p>\n\n<pre><code>def log_event\n  puts \"#{self.class} created now.\"\nend  \n</code></pre>\n\n<p>You can do <code>self.class.name</code> also.</p>\n"}, {"comments": [{"owner": {"reputation": 1418, "user_id": 493674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134075878cc4e13e36a6099c277381a5?s=128&d=identicon&r=PG", "display_name": "Vijay Agrawal", "link": "https://stackoverflow.com/users/493674/vijay-agrawal"}, "edited": false, "score": 0, "creation_date": 1501627731, "post_id": 45448777, "comment_id": 77858776, "body": "<code>self.class.table_name</code> would work only if <code>self.class</code> gets resolved to <code>User</code> or <code>Product</code>. It doesn&#39;t sound right that <code>self.class.table_name</code> works but <code>self.class</code> doesn&#39;t."}], "tags": [], "owner": {"reputation": 249, "user_id": 1862366, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/J0hu2.jpg?s=128&g=1", "display_name": "PiKaY", "link": "https://stackoverflow.com/users/1862366/pikay"}, "is_accepted": false, "score": 0, "last_activity_date": 1501627551, "creation_date": 1501627551, "answer_id": 45448777, "question_id": 45448546, "link": "https://stackoverflow.com/questions/45448546/how-to-get-the-class-name-in-activesupportconcern/45448777#45448777", "title": "How to get the class name in ActiveSupport::Concern?", "body": "<p>I think I found the answer to this. I can use self.class.table_name to get the name as users, products etc. i.e. if the table name is not custom</p>\n"}, {"tags": [], "owner": {"reputation": 2766, "user_id": 1081603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c1a5884d8af26fc89582f26425c6d85a?s=128&d=identicon&r=PG", "display_name": "Samuel G. P.", "link": "https://stackoverflow.com/users/1081603/samuel-g-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1551965993, "creation_date": 1551965993, "answer_id": 55045229, "question_id": 45448546, "link": "https://stackoverflow.com/questions/45448546/how-to-get-the-class-name-in-activesupportconcern/55045229#55045229", "title": "How to get the class name in ActiveSupport::Concern?", "body": "<p>You can use just <code>self.name</code> instead of <code>self.class</code> or <code>self.class.name</code> when using concerns.</p>\n\n<p>Example:</p>\n\n<pre><code>def log_event\n  puts \"#{self.name} created now.\"\nend \n</code></pre>\n"}], "owner": {"reputation": 249, "user_id": 1862366, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/J0hu2.jpg?s=128&g=1", "display_name": "PiKaY", "link": "https://stackoverflow.com/users/1862366/pikay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1551965993, "creation_date": 1501625952, "question_id": 45448546, "link": "https://stackoverflow.com/questions/45448546/how-to-get-the-class-name-in-activesupportconcern", "title": "How to get the class name in ActiveSupport::Concern?", "body": "<p>I have classes User, Product and Order. I have a common concern Logger which I have included in each. I have a after_create callback in the Logger module which will log the creation. I need the different type of class names with the log there.</p>\n\n<pre><code>class User\n  include Logger\n  attr_accessor :name\nend\n\nclass Product\n  include Logger\n  attr_accessor :name\nend\n\nclass Order\n  include Logger\n  attr_accessor :name\nend\n</code></pre>\n\n<p>I have the logger module</p>\n\n<pre><code>module Logger\n  extend ActiveSupport::Concern\n\n  included do\n    after_create :log_event\n  end\n\n  def log_event\n    puts \"#{&lt;some way to get name of the class&gt;} created now.\"\n  end \nend\n</code></pre>\n\n<p>I want \"some way to get name of the class\" there. I have tried self.name (returns the value in the name attribute of the class), self.class.name (returns Class), self.downcase (return error), self.table_name (return error). Please let me know the solution to this. It is imperative that I don't change this structure too much too.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501625701, "post_id": 45448484, "comment_id": 77858140, "body": "This is probably a super bad idea. Why not pivot to a schemaless type design? MySQL 5.7 supports JSON columns which are great for this sort of thing, though the down-side is they can&#39;t be easily indexed or manipulated. Postgres provides excellent support for JSON, you can index it and manipulate it quite easily, which might be worth considering as an option. There&#39;s also more pure document stores like MongoDB that go all-in on this concept."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501625791, "post_id": 45448484, "comment_id": 77858168, "body": "Another more pure RDBMS approach is to create a key/value table pair for your row data. This can get extremely messy and is often held up as an anti-pattern, but it can get you out of a jam like this where you really don&#39;t know what data you need to accommodate. Altering large tables can bring your server to its knees and can cause severe service disruptions at scale. It&#39;s something you want to do reluctantly, not by design."}, {"owner": {"reputation": 1144, "user_id": 541164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nFGD8.png?s=128&g=1", "display_name": "jahrichie", "link": "https://stackoverflow.com/users/541164/jahrichie"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501626014, "post_id": 45448484, "comment_id": 77858244, "body": "@tadman yeah I agree. I;d never do this anywhere else but a private api for our data warehouse."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501626053, "post_id": 45448484, "comment_id": 77858258, "body": "If you&#39;re doing it specifically for warehousing, the <a href=\"https://en.wikipedia.org/wiki/Star_schema\" rel=\"nofollow noreferrer\">Star Schema</a> can simplify implementation."}, {"owner": {"reputation": 1, "user_id": 8166907, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ku-FUgy4ucU/AAAAAAAAAAI/AAAAAAAAAAo/CSJZjbE_EmY/photo.jpg?sz=128", "display_name": "Richard O&#39;Reilly", "link": "https://stackoverflow.com/users/8166907/richard-oreilly"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501626216, "post_id": 45448484, "comment_id": 77858305, "body": "Sorry that submitted early @tadman.  Upgrading sql version or  using serialized columns is deal breaker.  We have too much investment in SQL that;s not worth getting into here, and we need to be able to query by sql on a col by col basis. Fully understand your points/approach tho, appreciate the  notes so far!"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501626288, "post_id": 45448484, "comment_id": 77858333, "body": "I think you can flip to a star-schema style approach which minimizes the impact of these schema changes. A pure key-value method is a lot more clunky, way more rows to manage, but it can work in a pinch if your data is fairly uniform in nature, like all numerical."}, {"owner": {"reputation": 210, "user_id": 1187029, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7ac14c3c14ebbc122c4da8a88ca4389d?s=128&d=identicon&r=PG", "display_name": "RobinBattle", "link": "https://stackoverflow.com/users/1187029/robinbattle"}, "edited": false, "score": 0, "creation_date": 1501633030, "post_id": 45448484, "comment_id": 77860191, "body": "Looks like the problem is from space in the column name, you can add `` if you really want space. <a href=\"https://stackoverflow.com/questions/25009440/how-to-create-column-name-with-space\" title=\"how to create column name with space\">stackoverflow.com/questions/25009440/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 541164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nFGD8.png?s=128&g=1", "display_name": "jahrichie", "link": "https://stackoverflow.com/users/541164/jahrichie"}, "edited": false, "score": 0, "creation_date": 1501640572, "post_id": 45448981, "comment_id": 77862001, "body": "I cannot believe I missed that.  I used a rails helper to replace spaces with underscores, that clearly had an issue. Resolved.  Thanks so much!!"}], "tags": [], "owner": {"reputation": 1418, "user_id": 493674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134075878cc4e13e36a6099c277381a5?s=128&d=identicon&r=PG", "display_name": "Vijay Agrawal", "link": "https://stackoverflow.com/users/493674/vijay-agrawal"}, "is_accepted": false, "score": 2, "last_activity_date": 1501628992, "creation_date": 1501628992, "answer_id": 45448981, "question_id": 45448484, "link": "https://stackoverflow.com/questions/45448484/dynamically-create-mysql-columns-in-rails/45448981#45448981", "title": "dynamically create mysql columns in Rails", "body": "<p>Your <code>sql</code> doesn't work because column names have space. Wrap you column names in generated <code>sql</code> with quotes.</p>\n\n<pre><code>attrs.each_with_index do |x, i|\n  connection = ActiveRecord::Base.connection\n  connection.execute \"ALTER TABLE #{table}  ADD COLUMN \\\"#{x}\\\" VARCHAR(15);\" \n# this didnt work :-( connection.close \nend\n</code></pre>\n\n<p>Though I would rather not go down the path of writing sql myself. Instead you can create a service like this:</p>\n\n<pre><code>class DbService &lt; ActiveRecord::Migration\n  def initialize(table_name)\n    @table_name = table_name\n  end\n  def add_string_column(column_name)\n    add_column @table_name, column_name, :string\n  end\nend\n</code></pre>\n\n<p>And then do something like </p>\n\n<pre><code>service = DbService.new(\"customer\")\nattrs.each do |column_name|\n  service.add_string_column(column_name)\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8166907, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ku-FUgy4ucU/AAAAAAAAAAI/AAAAAAAAAAo/CSJZjbE_EmY/photo.jpg?sz=128", "display_name": "Richard O&#39;Reilly", "link": "https://stackoverflow.com/users/8166907/richard-oreilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501628992, "creation_date": 1501625587, "question_id": 45448484, "link": "https://stackoverflow.com/questions/45448484/dynamically-create-mysql-columns-in-rails", "title": "dynamically create mysql columns in Rails", "body": "<p>I'm working on a private api that unifies our many dbs/vendor data in one sql db. </p>\n\n<p>We face a challenge with our ESP where our marketers are always changing/adding new columns.  We want this app to scale with those column changes and not require massaging columns every time they change names or add new attributes.</p>\n\n<p>I need to create a list of columns on the fly using Rails (we don't want to do this 100% in Mysql, because we're renaming some columns  in mapping).</p>\n\n<pre><code>table = \"customer\"\nattrs = [\"vendor_cm_name_d\", \"vendor_cm_email address_d\", \"vendor_cm_date added_d\", \"vendor_cm_extid_d\" ]\n\nattrs.each_with_index do |attr, i|\n  connection = ActiveRecord::Base.connection\n  connection.execute( \"ALTER TABLE #{table}  ADD COLUMN #{attr} VARCHAR(15);\"  )\n  # this didnt work :-( connection.close \nend\n</code></pre>\n\n<p>This approach works a single column but fails with more than one element in the array. reading the logs (pasted below) seems like it's trying to run the entire statement as one call,  not transactionally.  I tried adding in a connection.close before the end of each loop and that didn't work either.  All pointers are welcome.   </p>\n\n<pre><code>Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'address_d VARCHAR(15)' at line 1: ALTER TABLE customer  ADD COLUMN vendor_cm_email address_d VARCHAR(15);\nActiveRecord::StatementInvalid: Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'address_d VARCHAR(15)' at line 1: ALTER TABLE customer  ADD COLUMN vendor_cm_email address_d VARCHAR(15);\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "edited": false, "score": 0, "creation_date": 1501625146, "post_id": 45448251, "comment_id": 77857938, "body": "Take a look at this question of SO: <a href=\"https://stackoverflow.com/questions/38543894/ruby-grammar-name-for-number-after-subclass-of-one-class\" title=\"ruby grammar name for number after subclass of one class\">stackoverflow.com/questions/38543894/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1501625390, "creation_date": 1501625390, "answer_id": 45448454, "question_id": 45448251, "link": "https://stackoverflow.com/questions/45448251/ruby-2-4-documentation-for-this-bracket-syntax/45448454#45448454", "title": "Ruby 2.4 documentation for this bracket syntax", "body": "<p>It's a familiar syntax, but it's unfamiliar in this location, that's all. The base class specifier is allowed to be an expression, which can include method calls.</p>\n\n<p>Here's a way of re-creating that situation:</p>\n\n<pre><code>class CrazyProxyClass\n  def [](v)\n     Class.new\n  end\nend\n\nCrazyMethod = CrazyProxyClass.new\n\nclass CrazyDerived &lt; CrazyMethod[1.2]\nend\n\nCrazyDerived.new\n# =&gt; CrazyDerived\n</code></pre>\n\n<p>You can also get even more adventurous:</p>\n\n<pre><code>class NormalBase\nend\n\nclass DebugBase &lt; NormalBase\nend\n\nclass Example &lt; (ENV['DEBUG'] ? DebugBase : NormalBase)\nend\n</code></pre>\n\n<p>The only limit is your imagination and tools like Rubocop that will tell you it's <em>probably a bad idea</em> to get this nuts. The only real obligation is that whatever that expression returns is a Class or you'll get a \"superclass must be a Class\" exception.</p>\n"}], "owner": {"reputation": 41223, "user_id": 175836, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3b5a5015d8459c645abe6e906b9e77b?s=128&d=identicon&r=PG", "display_name": "randombits", "link": "https://stackoverflow.com/users/175836/randombits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "closed_date": 1566103234, "accepted_answer_id": 45448454, "answer_count": 1, "score": 2, "last_activity_date": 1501625390, "creation_date": 1501624332, "last_edit_date": 1501625083, "question_id": 45448251, "link": "https://stackoverflow.com/questions/45448251/ruby-2-4-documentation-for-this-bracket-syntax", "closed_reason": "Duplicate", "title": "Ruby 2.4 documentation for this bracket syntax", "body": "<p>Have not used Ruby in quite sometime and ran into some unfamiliar syntax:</p>\n\n<pre><code>class AddQuantityToLineItems &lt; ActiveRecord::Migration[5.1]\n</code></pre>\n\n<p>The <code>[5.1]</code> seems to be forcing a particular ActiveRecord::Migration version? What is this syntax called and where can the documentation for it be found?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "base64"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501626226, "post_id": 45448098, "comment_id": 77858313, "body": "Your data isn&#39;t Base64 <i>except</i> when you call debug which uses YAML which uses Base64."}, {"owner": {"reputation": 19544, "user_id": 317989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cc8d0c8db8ad0ff2ed65ff3f5a56dd6?s=128&d=identicon&r=PG", "display_name": "house9", "link": "https://stackoverflow.com/users/317989/house9"}, "edited": false, "score": 0, "creation_date": 1501630359, "post_id": 45448098, "comment_id": 77859489, "body": "for debugging you might want to write to a file on the file system and verify that it can be decoded: <code>bundle exec rails console</code> : <code>photo = Photo.find(xxxx)</code> : <code>File.open(&#39;.&#47;tmp&#47;photo1.xxxx, &#39;wb&#39;) { |f| f.write(Base64.decode64(photo)) }</code> then open that file from the rails tmp directory, if it is valid then use this technique to render it in an html page: <a href=\"https://stackoverflow.com/a/8499716/317989\">stackoverflow.com/a/8499716/317989</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "is_accepted": true, "score": 1, "last_activity_date": 1501768433, "creation_date": 1501768433, "answer_id": 45486307, "question_id": 45448098, "link": "https://stackoverflow.com/questions/45448098/showing-base64-data-with-ruby-on-rails/45486307#45486307", "title": "Showing base64 data with Ruby on Rails", "body": "<p>This is not Base64 encoded data, you should try below code:</p>\n\n<pre><code> require \"base64\"\n\n &lt;%= Base64.encode64(@photo) %&gt;\n</code></pre>\n\n<p>Learn <a href=\"https://ruby-doc.org/stdlib-2.2.2/libdoc/base64/rdoc/Base64.html#module-Base64-label-Example\" rel=\"nofollow noreferrer\">more</a> </p>\n"}], "owner": {"reputation": 35, "user_id": 8175208, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f44b11ee8b1a76f1ee57ccf2443fb7d?s=128&d=identicon&r=PG&f=1", "display_name": "faul", "link": "https://stackoverflow.com/users/8175208/faul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 45486307, "answer_count": 1, "score": 1, "last_activity_date": 1501768433, "creation_date": 1501623595, "question_id": 45448098, "link": "https://stackoverflow.com/questions/45448098/showing-base64-data-with-ruby-on-rails", "title": "Showing base64 data with Ruby on Rails", "body": "<p>I'm facing a problem when showing <code>base64</code> data please see below:</p>\n\n<p>When I'm using for debugging:</p>\n\n<pre><code>&lt;%= debug @photo %&gt;\n</code></pre>\n\n<p>Showing like below image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/t3t4T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t3t4T.png\" alt=\"enter image description here\"></a></p>\n\n<p>And this is correct.</p>\n\n<p>When I'm using for the show:</p>\n\n<pre><code>&lt;%= @photo %&gt;\n</code></pre>\n\n<p>Showing like below image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/US9vF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/US9vF.png\" alt=\"enter image description here\"></a></p>\n\n<p>And this is not correct!</p>\n\n<p>What I'm doing wrong?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1501626386, "post_id": 45448132, "comment_id": 77858369, "body": "Another thing to consider is <code>return true</code> when evaluating a boolean condition is a waste. Just express the logic as-is, which is implicitly returned."}, {"owner": {"reputation": 1, "user_id": 8401512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d9b0b0a9a123b0c66fe5acb6ca3a04?s=128&d=identicon&r=PG&f=1", "display_name": "malex", "link": "https://stackoverflow.com/users/8401512/malex"}, "edited": false, "score": 0, "creation_date": 1501628051, "post_id": 45448132, "comment_id": 77858873, "body": "I do not want to put together all the codes since I only want it to be True if both the rev_code &#39;300&#39; and the cdm_code &#39;86580&#39; exist. That is why I coded them separately. The other codes are independent of my new codes. Can I still use the &quot;&amp;&amp;&quot; with adding the parens?"}, {"owner": {"reputation": 1, "user_id": 8401512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d9b0b0a9a123b0c66fe5acb6ca3a04?s=128&d=identicon&r=PG&f=1", "display_name": "malex", "link": "https://stackoverflow.com/users/8401512/malex"}, "edited": false, "score": 0, "creation_date": 1501629889, "post_id": 45448132, "comment_id": 77859362, "body": "I tried it with the parenthesis on the (charge[:rev_code]) and the (charge[:cdm_code]). I got another syntax error, unexpected tLPAREN_ARG, expecting keyword_end (SyntaxError) ..._code]) &amp;&amp; [&#39;86580&#39;].include? (charge[:cdm_code]). Just curious, is the space between the &quot;include?&quot; and the &quot;(charge&quot; make any difference?"}, {"owner": {"reputation": 1, "user_id": 8401512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d9b0b0a9a123b0c66fe5acb6ca3a04?s=128&d=identicon&r=PG&f=1", "display_name": "malex", "link": "https://stackoverflow.com/users/8401512/malex"}, "edited": false, "score": 0, "creation_date": 1501688575, "post_id": 45448132, "comment_id": 77891506, "body": "Yes, it does. The line that I added: return true if [&#39;300&#39;].include? (charge[:rev_code]) &amp;&amp; [&#39;86580&#39;].include? (charge[:cdm_code])"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 2, "last_activity_date": 1501624069, "last_edit_date": 1501624069, "creation_date": 1501623765, "answer_id": 45448132, "question_id": 45448094, "link": "https://stackoverflow.com/questions/45448094/syntax-error-in-ruby-using-in-multiple-conditions/45448132#45448132", "title": "syntax error in ruby using &amp;&amp; in multiple conditions", "body": "<p>As it's a one-line statement, wrap the include? arguments in parenthesis:</p>\n\n<pre><code>return true if ['300'].include?(charge[:rev_code]) &amp;&amp; ['86580'].include?(charge[:cdm_code])\n</code></pre>\n\n<p>I think you could make it a little bit more readable:</p>\n\n<pre><code>def drug_dispensation_condition(charge)\n  if ['250', '251', '300'].include?(charge[:rev_code]) ||\n     ['981262', '86580'].include?(charge[:cdm_code])\n    return true\n  end\n  false\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8401512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d9b0b0a9a123b0c66fe5acb6ca3a04?s=128&d=identicon&r=PG&f=1", "display_name": "malex", "link": "https://stackoverflow.com/users/8401512/malex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1501624069, "creation_date": 1501623571, "last_edit_date": 1501623626, "question_id": 45448094, "link": "https://stackoverflow.com/questions/45448094/syntax-error-in-ruby-using-in-multiple-conditions", "title": "syntax error in ruby using &amp;&amp; in multiple conditions", "body": "<p>I'm baffled why I have a syntax error using '&amp;&amp;' when combining two conditions that should be true before the program can continue. I'm new to ruby and have not had a chance to actually code a complete program by myself.\nI am just updating an old program and following through whatever code that is similar to what I need to update it with.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>def drug_dispensation_condition(charge)\n  return true if ['250','251'].include? charge[:rev_code]\n  return true if ['981262'].include? charge[:cdm_code]\n  return true if ['300'].include? charge[:rev_code] &amp;&amp; ['86580'].include? charge[:cdm_code]  #this line is inserted\n  false\nend\n</code></pre>\n\n<p>Here's my error message:</p>\n\n<blockquote>\n  <p>syntax error, unexpected tIDENTIFIER, expecting keyword_end\n  (syntaxerror) ...e] &amp;&amp; ['86580'].include? charge[:cdm_code]</p>\n</blockquote>\n\n<p>I added the 3rd \"return true\" clause to include the rev_code 300 and the cdm_code 86580.\nI need both the rev_code 300 and the cdm_code 86580 to declare the statement as True, so I needed to add the \"&amp;&amp;\" in between them. It looked like it was expecting the \"end\" after \"charge[:rev_code]\" instead of the 2nd condition. </p>\n\n<p>Is there any other way of coding this to avoid the syntax error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis", "sidekiq"], "answers": [{"tags": [], "owner": {"reputation": 1159, "user_id": 4537254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6OpD.jpg?s=128&g=1", "display_name": "Andr&#233; Guimar&#227;es Sakata", "link": "https://stackoverflow.com/users/4537254/andr%c3%a9-guimar%c3%a3es-sakata"}, "is_accepted": false, "score": 0, "last_activity_date": 1501958694, "creation_date": 1501958694, "answer_id": 45525325, "question_id": 45447941, "link": "https://stackoverflow.com/questions/45447941/save-metadata-to-jobs-on-sidekiq/45525325#45525325", "title": "Save metadata to jobs on Sidekiq", "body": "<p>You can't recover any state of a job when it's finished.</p>\n\n<p>Seems that in your case you will need to save or send the data to somewhere else (like the database) to read it later and take action.</p>\n"}, {"comments": [{"owner": {"reputation": 1402, "user_id": 21087, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1b08e1791e0d3ead8cd996009d8d7b3b?s=128&d=identicon&r=PG", "display_name": "MegaTux", "link": "https://stackoverflow.com/users/21087/megatux"}, "edited": false, "score": 0, "creation_date": 1565876284, "post_id": 45525526, "comment_id": 101489040, "body": "sidekiq-status use Sidekiq [<i>middleware</i>][1] and job <i>metadata</i> hash to accomplish this. It is possible to do the same without this gem. [<a href=\"https://github.com/mperham/sidekiq/wiki/Middleware#custom-middleware]\" rel=\"nofollow noreferrer\">github.com/mperham/sidekiq/wiki/Middleware#custom-middlewar&zwnj;&#8203;e]</a>"}], "tags": [], "owner": {"reputation": 22509, "user_id": 585456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8fb4f62d355848572e309fdb0c2664a7?s=128&d=identicon&r=PG", "display_name": "Nobita", "link": "https://stackoverflow.com/users/585456/nobita"}, "is_accepted": true, "score": 2, "last_activity_date": 1501960373, "creation_date": 1501960373, "answer_id": 45525526, "question_id": 45447941, "link": "https://stackoverflow.com/questions/45447941/save-metadata-to-jobs-on-sidekiq/45525526#45525526", "title": "Save metadata to jobs on Sidekiq", "body": "<p>Not straight out of the box with Sidekiq, but I have accomplished this with <a href=\"https://github.com/utgarda/sidekiq-status\" rel=\"nofollow noreferrer\">sidekiq-status</a></p>\n\n<p>For example, in your scenario, it would look something like this:</p>\n\n<pre><code>class ValidatorJob\n  include Sidekiq::Worker\n  include Sidekiq::Status::Worker \n\n  def perform(*args)\n    # Run validations\n\n    # after they are done, you can store any data with the store method\n    store attr1: 'failed'\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1402, "user_id": 21087, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1b08e1791e0d3ead8cd996009d8d7b3b?s=128&d=identicon&r=PG", "display_name": "MegaTux", "link": "https://stackoverflow.com/users/21087/megatux"}, "is_accepted": false, "score": 1, "last_activity_date": 1565875472, "creation_date": 1565875472, "answer_id": 57510351, "question_id": 45447941, "link": "https://stackoverflow.com/questions/45447941/save-metadata-to-jobs-on-sidekiq/57510351#57510351", "title": "Save metadata to jobs on Sidekiq", "body": "<p>Yes, Sidekiq provides <em>middleware</em> (client &amp; server) and the possibility to add metadata to the job. </p>\n\n<pre><code>  def call(worker_class, job, queue, redis_pool)\n    # return false/nil to stop the job from going to redis\n    return false if queue != 'default'\n    job['customer'] = Customer.current_id\n    yield\n  end\n</code></pre>\n\n<p>Check <a href=\"https://github.com/mperham/sidekiq/wiki/Middleware#custom-middleware\" rel=\"nofollow noreferrer\">this link</a> for the docs.</p>\n"}], "owner": {"reputation": 1166, "user_id": 7044625, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/80daf516453640dcd23184fbf8b8df11?s=128&d=identicon&r=PG&f=1", "display_name": "felipeecst", "link": "https://stackoverflow.com/users/7044625/felipeecst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 1, "accepted_answer_id": 45525526, "answer_count": 3, "score": 3, "last_activity_date": 1565875472, "creation_date": 1501622844, "question_id": 45447941, "link": "https://stackoverflow.com/questions/45447941/save-metadata-to-jobs-on-sidekiq", "title": "Save metadata to jobs on Sidekiq", "body": "<p>Is it possible to save metadata to jobs when using Sidekiq? </p>\n\n<p>For example, I want to execute a validation as a background job so that when it finishes, any errors encountered would be saved as metadata inside the job.</p>\n\n<p>If this is possible, will I still be able to recover this metadata after the job is finished or dead?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "fullcalendar"], "answers": [{"tags": [], "owner": {"reputation": 2038, "user_id": 1911146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7f7e660639447e7b129d19befb5934?s=128&d=identicon&r=PG", "display_name": "serdar.sanri", "link": "https://stackoverflow.com/users/1911146/serdar-sanri"}, "is_accepted": false, "score": 1, "last_activity_date": 1501620443, "last_edit_date": 1592644375, "creation_date": 1501620443, "answer_id": 45447433, "question_id": 45447274, "link": "https://stackoverflow.com/questions/45447274/add-classname-after-added-a-new-fullcalendar-event/45447433#45447433", "title": "Add className after added a new fullcalendar event", "body": "<p>Take a look at <a href=\"https://fullcalendar.io/docs/event_data/eventDataTransform/\" rel=\"nofollow noreferrer\">https://fullcalendar.io/docs/event_data/eventDataTransform/</a></p>\n<blockquote>\n<p>This hook allows you to receive arbitrary event data from a JSON feed or any other Event Source and transform it into the type of data FullCalendar accepts. This let's you easily accept alternative data formats without having to write a completely custom events function.</p>\n<p>This function is called once per received event. eventData is the event data that has been receieved. The function must return a new object in the Event Object format.</p>\n</blockquote>\n"}], "owner": {"reputation": 29, "user_id": 7203387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7894d657478623505eb49188d1ae9beb?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/7203387/andres-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501620443, "creation_date": 1501619879, "question_id": 45447274, "link": "https://stackoverflow.com/questions/45447274/add-classname-after-added-a-new-fullcalendar-event", "title": "Add className after added a new fullcalendar event", "body": "<p>Hello im using FullCalendar, after the calendar is completely loaded i add more events using 'addEventSource' with an url </p>\n\n<pre><code>calendar.fullCalendar('addEventSource', url)\n</code></pre>\n\n<p>And this works fine, but i want to add a custom class to these events, i don't know exactly how. i've tried modifying the events but my function apparently executes before the addEventSource one... So, what can i do? I read here that I should add the class from backend, but i can't edit the endpoint where i bring all the information of the calendar. </p>\n\n<p>So, does anyone have an idea how to solve this?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "ajax"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7742587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25bc8da09783343e5c2e06542d39dc69?s=128&d=identicon&r=PG&f=1", "display_name": "rachster", "link": "https://stackoverflow.com/users/7742587/rachster"}, "edited": false, "score": 0, "creation_date": 1501689274, "post_id": 45464967, "comment_id": 77891997, "body": "Thank you for all your help!!! I found a great explanation and fix here: <a href=\"https://stackoverflow.com/questions/18429274/how-to-add-new-attribute-to-activerecord\" title=\"how to add new attribute to activerecord\">stackoverflow.com/questions/18429274/&hellip;</a>  ... As it turns out, <code>attr_accessor</code> creates properties, not hashes and therefore it uses the <code>.</code> syntax. I ended up using the solution by  Chris Kerlin."}], "tags": [], "owner": {"reputation": 168, "user_id": 2878024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IY3Y6.jpg?s=128&g=1", "display_name": "Jacopo Beschi", "link": "https://stackoverflow.com/users/2878024/jacopo-beschi"}, "is_accepted": false, "score": 0, "last_activity_date": 1501687578, "creation_date": 1501687578, "answer_id": 45464967, "question_id": 45447245, "link": "https://stackoverflow.com/questions/45447245/add-attributes-to-ror-object-dynamically-with-ajax/45464967#45464967", "title": "Add attributes to RoR object dynamically with Ajax", "body": "<blockquote>\n  <p>Out of the 4 print statements, only puts x.first_name prints</p>\n</blockquote>\n\n<p>This is because when you call x['comment']\u00a0etc you call the [] method on x object and I don't think that the object is an hash. when you call .first_name you use the new attr_accessor created dynamically; i think also . avatar_url should work.</p>\n\n<p>Does it work if you do instead: </p>\n\n<pre><code>  @ajaxInfo = {\n    translationUsers: allTranslations,\n    currentUserId: @current_user.id,\n    transComments: comments\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 7742587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25bc8da09783343e5c2e06542d39dc69?s=128&d=identicon&r=PG&f=1", "display_name": "rachster", "link": "https://stackoverflow.com/users/7742587/rachster"}, "is_accepted": false, "score": 0, "last_activity_date": 1501689552, "creation_date": 1501689552, "answer_id": 45465695, "question_id": 45447245, "link": "https://stackoverflow.com/questions/45447245/add-attributes-to-ror-object-dynamically-with-ajax/45465695#45465695", "title": "Add attributes to RoR object dynamically with Ajax", "body": "<p>I found this awesome thread that answers my questions: <a href=\"https://stackoverflow.com/questions/18429274/how-to-add-new-attribute-to-activerecord\">How to add new attribute to ActiveRecord</a></p>\n\n<p>As stated by @CuriousMind <code>attr_accessor</code> creates properties, not hashes.</p>\n\n<p>I solved this issue by following the solution by @Chris Kerlin </p>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 51, "user_id": 7742587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25bc8da09783343e5c2e06542d39dc69?s=128&d=identicon&r=PG&f=1", "display_name": "rachster", "link": "https://stackoverflow.com/users/7742587/rachster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501689552, "creation_date": 1501619774, "question_id": 45447245, "link": "https://stackoverflow.com/questions/45447245/add-attributes-to-ror-object-dynamically-with-ajax", "title": "Add attributes to RoR object dynamically with Ajax", "body": "<p>I would like to dynamically add attributes to a Ruby on Rails object so I can access them with an Ajax call. I understand that I can send the info with another Ajax call, but I would much prefer to add the <code>:first_name</code> and <code>:avatar_url</code> attributes dynamically. Here is my code...</p>\n\n<pre><code>def get_info\n\n    comments = []\n    allTranslations.each do |trans|\n\n        if trans.comments.exists?\n            trans.comments.each do |transComment|\n\n                user = ...\n                    class &lt;&lt; transComment\n                        attr_accessor :first_name\n                        attr_accessor :avatar_url\n                    end\n                transComment.first_name = user.first_name\n                transComment.avatar_url = user.avatar.url\n\n                comments.push(transComment)\n\n\n                puts(\"trans user comments info\")\n                transComments.each do |x|\n\n                    puts x['comment']\n                    puts x['first_name']\n                    puts x.first_name\n                    puts x['avatar_url']\n\n                end\n            end \n        end\n    end\n\n    @ajaxInfo = {\n        translationUsers: allTranslations,\n        currentUserId: @current_user.id,\n        transComments: transComments\n\n    }\n\n    render json: @ajaxInfo\n\nend\n</code></pre>\n\n<p>Out of the 4 print statements, only <code>puts x.first_name</code> prints, and none of the attributes are added to the objects when I log the results on my console. </p>\n\n<p>Here is the corresponding Javascript and Ajax:</p>\n\n<pre><code> $('.my-translations').click(function(){\n    $('#translation').empty();\n\n\n\n    getTranslations(id).done(function(data){\n        console.log(data)    \n        var transUsers = []\n\n        ...\n\n  });\n });\n\nfunction getTranslations(translationId)   {\n    return $.ajax({ \n        type: \"GET\",\n        url: '/get_translations_users',\n        data: {\n            translationId: translationId\n        },\n        success: function(result)   {\n            return result;\n        },\n        error: function(err)    {\n            console.log(err);\n        }\n    });\n};\n</code></pre>\n\n<p>Any tips or advice is appreciated! Thanks :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "parameters"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1501617060, "post_id": 45446524, "comment_id": 77854144, "body": "Add the controller, to see what&#39;s <code>@uploaded_planners[0]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1501618327, "post_id": 45446864, "comment_id": 77854834, "body": "in the print statement it appears to be a string, so maybe <code>[&quot;pic&quot;]</code> instead."}, {"owner": {"reputation": 1135, "user_id": 251045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jgiVA.png?s=128&g=1", "display_name": "lightalloy", "link": "https://stackoverflow.com/users/251045/lightalloy"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1501618615, "post_id": 45446864, "comment_id": 77854998, "body": "Values of ActionController::Parameters are accessible both by symbol and string keys:  &gt; You can fetch values of ActionController::Parameters using either :key or &quot;key&quot;. (<a href=\"http://api.rubyonrails.org/classes/ActionController/Parameters.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActionController/Parameters.htm&zwnj;&#8203;l</a>)"}], "tags": [], "owner": {"reputation": 1135, "user_id": 251045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jgiVA.png?s=128&g=1", "display_name": "lightalloy", "link": "https://stackoverflow.com/users/251045/lightalloy"}, "is_accepted": true, "score": 2, "last_activity_date": 1501618294, "creation_date": 1501618294, "answer_id": 45446864, "question_id": 45446524, "link": "https://stackoverflow.com/questions/45446524/bizarrely-unable-to-access-elements-in-an-actioncontrollerparameters/45446864#45446864", "title": "Bizarrely unable to access elements in an ActionController::Parameters", "body": "<pre><code>params[:uploaded_planner][:pic].original_filename\n</code></pre>\n"}], "owner": {"reputation": 5962, "user_id": 1222564, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/35e05136eb1700834c71d59bb25a1c24?s=128&d=identicon&r=PG", "display_name": "PinkElephantsOnParade", "link": "https://stackoverflow.com/users/1222564/pinkelephantsonparade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 45446864, "answer_count": 1, "score": 0, "last_activity_date": 1501618294, "creation_date": 1501616988, "last_edit_date": 1501617794, "question_id": 45446524, "link": "https://stackoverflow.com/questions/45446524/bizarrely-unable-to-access-elements-in-an-actioncontrollerparameters", "title": "Bizarrely unable to access elements in an ActionController::Parameters", "body": "<p>Making an extension to an already-written rails project. In an erb file I have:</p>\n\n<p><code>\n   &lt;%= form_for @uploaded_planners[0], :url =&gt; method_path, :html =&gt; { \n   :multipart =&gt; true } do |form| %&gt;\n     &lt;%= form.file_field :pic %&gt;\n     &lt;%=form.submit 'Upload'%&gt;\n   &lt;% end %&gt;\n</code></p>\n\n<p>In the appropriate controller I have:</p>\n\n<pre><code>def create\n  p params\n  print \"\\n\"\n  testing = params[:uploaded_planner]\n  print testing.class\n  print \"\\n\"\n  print testing\n  print \"\\n\"\n  print testing['@original_filename']\n  print testing[:original_filename]\n  print \"\\n\"\nend\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>def plan\n    @uploaded_planners = UploadedPlanner.all #there are two i inserted via rails console..\nend\n</code></pre>\n\n<p>Output of those prints are </p>\n\n<pre><code>{\"utf8\"=&gt;\"\u2713\", \"_method\"=&gt;\"patch\", \"authenticity_token\"=&gt;\"UxgdziS9PwY/SAaOMj4upXzSTf5brOT4R9x+paMNNlxehYwY34OT7hvdGJXwvK/cffPIjYOwdf1h+MndJh6LBg==\", \"uploaded_planner\"=&gt;{\"pic\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x007f9b9b3bc5e8 @tempfile=#&lt;Tempfile:/var/folders/hc/67y08p7s3ws6rsjl5rlxk3f00000gn/T/RackMultipart20170801-25372-godqfg.xlsx&gt;, @original_filename=\"AF_CSX_DISTRIBUTE_NUMBERS.xlsx\", @content_type=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", @headers=\"Content-Disposition: form-data; name=\\\"uploaded_planner[pic]\\\"; filename=\\\"AF_CSX_DISTRIBUTE_NUMBERS.xlsx\\\"\\r\\nContent-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\\r\\n\"&gt;}, \"commit\"=&gt;\"Upload\", \"controller\"=&gt;\"viacom\", \"action\"=&gt;\"create\"}\n\nActionController::Parameters\n\n{\"pic\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x007f9b9d529190 @tempfile=#&lt;Tempfile:/var/folders/hc/67y08p7s3ws6rsjl5rlxk3f00000gn/T/RackMultipart20170801-25372-baavaj.xlsx&gt;, @original_filename=\"AF_CSX_DISTRIBUTE_NUMBERS.xlsx\", @content_type=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", @headers=\"Content-Disposition: form-data; name=\\\"uploaded_planner[pic]\\\"; filename=\\\"AF_CSX_DISTRIBUTE_NUMBERS.xlsx\\\"\\r\\nContent-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\\r\\n\"&gt;}\n</code></pre>\n\n<p>The bottom two print statements are nil. My statements do not dig into the double-nested hash and retrieve the values I am trying to get. I tried every combination syntax-wise that I know of to try to get to those values out of the hash, but to no avail - every time I get nothing. I know the 'create' method in my controller is being invoked - it's how I am getting this print output - it's just I cannot get any value in the hash of \"uploaded_planner\" (aka can't index into the testing variable). I cannot figure out how to reference those members by any means, which sucks, as those are the members I really want to get to.</p>\n\n<p>Here is the official ActionController doc:</p>\n\n<p><a href=\"http://api.rubyonrails.org/v4.2/classes/ActionController/Parameters.html#method-i-extract-21\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/v4.2/classes/ActionController/Parameters.html#method-i-extract-21</a></p>\n\n<p>It alleges that I can do:</p>\n\n<pre><code>params[:key]\n</code></pre>\n\n<p>And I can... the first time. But after that, the object that I have is still an ActionController::Parameters (as shown by my .class print statement) yet I cannot do that very same indexing to get members of the second hash. It is extremely frustrating because I see the data that I need in the print output, but cannot get that data and manipulate it (without going super jank and reading print output somehow... not a good way to do things). Any ideas on this?</p>\n"}, {"tags": ["ruby", "xpath", "nokogiri"], "comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1501616210, "post_id": 45446276, "comment_id": 77853677, "body": "<code>&#47;&#47;</code> means start from root. Maybe you want <code>&#47;</code>"}, {"owner": {"reputation": 466, "user_id": 3734354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a9fe1260a3b6ccd2efd1d62f02d0f24?s=128&d=identicon&r=PG&f=1", "display_name": "ForceMagic", "link": "https://stackoverflow.com/users/3734354/forcemagic"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1501616302, "post_id": 45446276, "comment_id": 77853725, "body": "-_- Told ya I was missing a tiny detail. :P Thanks so much!"}, {"owner": {"reputation": 137664, "user_id": 252228, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ea75023c3c487f36257090d420b7c50?s=128&d=identicon&r=PG", "display_name": "Martin Honnen", "link": "https://stackoverflow.com/users/252228/martin-honnen"}, "edited": false, "score": 0, "creation_date": 1501616374, "post_id": 45446276, "comment_id": 77853756, "body": "If you want to search the descendants of the <code>meta</code> node then use the path <code>descendant::a</code> or <code>.&#47;&#47;a</code>. For child elements you simply need <code>a</code>."}, {"owner": {"reputation": 466, "user_id": 3734354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a9fe1260a3b6ccd2efd1d62f02d0f24?s=128&d=identicon&r=PG&f=1", "display_name": "ForceMagic", "link": "https://stackoverflow.com/users/3734354/forcemagic"}, "edited": false, "score": 0, "creation_date": 1501616418, "post_id": 45446276, "comment_id": 77853782, "body": "Just a question: then why does it work until the <code>This seems fine</code> line? Given that it also has <code>&#47;&#47;</code>"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1501616469, "post_id": 45446276, "comment_id": 77853809, "body": "It doesn&#39;t. You&#39;re just lucky there aren&#39;t any other <code>span</code> elements."}, {"owner": {"reputation": 466, "user_id": 3734354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a9fe1260a3b6ccd2efd1d62f02d0f24?s=128&d=identicon&r=PG&f=1", "display_name": "ForceMagic", "link": "https://stackoverflow.com/users/3734354/forcemagic"}, "edited": false, "score": 0, "creation_date": 1501616592, "post_id": 45446276, "comment_id": 77853874, "body": "Oh, okay, got it. Tested in Chrome&#39;s search thing, you&#39;re right. Thank you all for helping! Sometimes I just love SO. I mean, I rarely ask questions, but this whole site saves me a ton of work."}], "answers": [{"comments": [{"owner": {"reputation": 466, "user_id": 3734354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a9fe1260a3b6ccd2efd1d62f02d0f24?s=128&d=identicon&r=PG&f=1", "display_name": "ForceMagic", "link": "https://stackoverflow.com/users/3734354/forcemagic"}, "edited": false, "score": 0, "creation_date": 1501621221, "post_id": 45447378, "comment_id": 77856338, "body": "Hmm, those are gems that I seriously have to check out, but in the meantime, I&#39;m not just looking for the rating. I&#39;m sorry you took all the time making this answer, but I need that if statement cause I&#39;m storing everything. Here: <code>attr_reader :id, :title, :author, :summary, :rating, :language, :genres, :characters, :words, :chapters, :reviews, :favs, :follows, :updated, :published</code>"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "reply_to_user": {"reputation": 466, "user_id": 3734354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a9fe1260a3b6ccd2efd1d62f02d0f24?s=128&d=identicon&r=PG&f=1", "display_name": "ForceMagic", "link": "https://stackoverflow.com/users/3734354/forcemagic"}, "edited": false, "score": 0, "creation_date": 1501636237, "post_id": 45447378, "comment_id": 77860947, "body": "Hey no problem, I figured you wanted more than the rating. My intent was to show you that you can have a single expression per item. Let me know (via another SO post) if you have problems constructing an XPath for any of those items."}, {"owner": {"reputation": 466, "user_id": 3734354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a9fe1260a3b6ccd2efd1d62f02d0f24?s=128&d=identicon&r=PG&f=1", "display_name": "ForceMagic", "link": "https://stackoverflow.com/users/3734354/forcemagic"}, "edited": false, "score": 0, "creation_date": 1501675576, "post_id": 45447378, "comment_id": 77880809, "body": "Thanks, but I&#39;ve got everything under control now :) I&#39;m not an expert on XPath and extracting stuff from HTML markups, but I kinda got used to it by now. I&#39;ll mark your post as an answer in case it helps some people."}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "reply_to_user": {"reputation": 466, "user_id": 3734354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a9fe1260a3b6ccd2efd1d62f02d0f24?s=128&d=identicon&r=PG&f=1", "display_name": "ForceMagic", "link": "https://stackoverflow.com/users/3734354/forcemagic"}, "edited": false, "score": 0, "creation_date": 1501678790, "post_id": 45447378, "comment_id": 77883493, "body": "Hopefully my additions help"}], "tags": [], "owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1501678685, "last_edit_date": 1501678685, "creation_date": 1501620273, "answer_id": 45447378, "question_id": 45446276, "link": "https://stackoverflow.com/questions/45446276/nokogiri-is-returning-to-root-element-why/45447378#45447378", "title": "Nokogiri is returning to root element. Why?", "body": "<p>Using the full power of XPath often means you don't have to stop and iterate, you can just grab what you want directly with a single expression. This allows you to externalize, store in variables, or otherwise organize your expressions and maintain them more easily, even if the XML changes. With XPath you can even incorporate some logic in the expressions.</p>\n\n<p>Are you trying to get the rating of a story? Note that there's a <code>target=rating</code> attribute, so you can key off of that, rather than counting <code>span</code> elements.</p>\n\n<pre><code>doc.xpath('//*[@id=\"profile_top\"]/span/a[@target=\"rating\"]/text()')\n\n#=&gt; \"Fiction M\"\n</code></pre>\n\n<p>Another thing I'd recommend is to use either HTTParty or Mechanize, if you aren't already. They have different strengths. HTTParty gives you an easy way to create a nice object-oriented client with fetching and parsing. Mechanize focuses on scraping but it has Nokogiri built in and you can access the underlying Nokogiri document and just start executing XPath on it. </p>\n\n<p><strong>Edit:</strong>\nAdding a couple others from your comment below.</p>\n\n<pre><code>language = doc.xpath('//*[@id=\"profile_top\"]/span[a[@target=\"rating\"]]/text()').to_s.split(' - ')[1]\n#=&gt; \"English\"\n</code></pre>\n\n<p>Note that the brackets <code>[]</code> can be read as \"which contains,\" so we are looking for the span <em>which contains</em> a link with a target of rating. This way you don't need to count spans, which is more brittle.</p>\n\n<pre><code>genres = doc.xpath('//*[@id=\"profile_top\"]/span[a[@target=\"rating\"]]/text()').to_s.split(' - ')[2].split('/')\n#=&gt; [\"Humor\", \"Adventure\"]\n\nid = doc.xpath('//*[@id=\"profile_top\"]/span[a[@target=\"rating\"]]/text()').to_s.split(' - ')[5].split(': ')\n#=&gt; \"12596791\"\n\npublished = DateTime.strptime(doc.xpath('//*[@id=\"profile_top\"]//span/@data-xutime').first.value, '%s')\n#=&gt; 2017-08-01T20:03:19+00:00\n</code></pre>\n\n<p>And so on. I recommend putting the XPaths in something like a hash so you can refer to the more descriptive <code>xpath_for[:rating]</code> instead of hardcoding them all throughout the code.</p>\n"}], "owner": {"reputation": 466, "user_id": 3734354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a9fe1260a3b6ccd2efd1d62f02d0f24?s=128&d=identicon&r=PG&f=1", "display_name": "ForceMagic", "link": "https://stackoverflow.com/users/3734354/forcemagic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 45447378, "answer_count": 1, "score": 0, "last_activity_date": 1501678685, "creation_date": 1501616044, "last_edit_date": 1501675639, "question_id": 45446276, "link": "https://stackoverflow.com/questions/45446276/nokogiri-is-returning-to-root-element-why", "title": "Nokogiri is returning to root element. Why?", "body": "<p>I'm sorry, this seems like an off-topic question, but just give me 2 minutes. I'm probably missing a tiny detail, but I'm going crazy over this tiny piece of code:</p>\n\n<pre><code>parsed = Nokogiri::HTML(open(url))\n\nfullmeta = parsed.xpath('//*[@id=\"profile_top\"]')[0]\nif fullmeta.inner_html.to_s.include? \"image\"\n    meta = fullmeta.xpath('//span[4]')[0]\nelse\n    meta = fullmeta.xpath('//span[3]')[0]\nend\n\nputs meta.inner_html                    # This seems fine\nputs meta.xpath('//a[1]')[0].inner_html # !!!\n</code></pre>\n\n<p>The line marked with <code>!!!</code> is the culprit. Something is making that line re-do the XPath from the root element of <code>parsed</code>! I have that variable declared a couple XPaths before. What. is. going. on. here? I've been sitting on this code for like an hour! (DuckDuckGo'd half the Internet already)</p>\n\n<p>If you want an XML, just use any FanFiction story page. I'm writing an API for that in rails, but that's not really an important fact here.</p>\n\n<hr>\n\n<p>Just in case anyone tries it out with FanFiction, this is what I get:</p>\n\n<pre><code>Rated: &lt;a class=\"xcontrast_txt\" href=\"https://www.fictionratings.com/\" target=\"rating\"&gt;Fiction  T&lt;/a&gt; - English - Humor/Adventure - Chapters: 15   - Words: 55,643 - Reviews: &lt;a href=\"/r/12135694/\"&gt;22&lt;/a&gt; - Favs: 5 - Follows: 8 - Updated: &lt;span data-xutime=\"1501553985\"&gt;17h&lt;/span&gt; - Published: &lt;span data-xutime=\"1473081239\"&gt;9/5/2016&lt;/span&gt; - id: 12135694 \nFanFiction\n</code></pre>\n\n<p>The last line should say <code>Fiction  T</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "activerecord"], "comments": [{"owner": {"reputation": 1068, "user_id": 5854882, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fe1e093f1daa8277a4dd0b61eafd72b?s=128&d=identicon&r=PG&f=1", "display_name": "jhhoff02", "link": "https://stackoverflow.com/users/5854882/jhhoff02"}, "edited": false, "score": 1, "creation_date": 1501615788, "post_id": 45445963, "comment_id": 77853470, "body": "<a href=\"https://www.google.com/search?q=how+use+regular+expression+with+active+record\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 8067836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIY38.jpg?s=128&g=1", "display_name": "Andrea Baz&#225;n", "link": "https://stackoverflow.com/users/8067836/andrea-baz%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1501693922, "post_id": 45446222, "comment_id": 77894954, "body": "Thanks Sebasti&#225;n! =)"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 3, "last_activity_date": 1501615862, "creation_date": 1501615862, "answer_id": 45446222, "question_id": 45445963, "link": "https://stackoverflow.com/questions/45445963/active-record-regular-expression/45446222#45446222", "title": "ACTIVE RECORD REGULAR EXPRESSION", "body": "<p>You can validate the phone format in your model, and in the with option to pass the regex:</p>\n\n<pre><code>validates :phone, format: { with: /\\d{10,}/ }\n</code></pre>\n\n<p>In this case the phone must have ten or more digits. Note are ten digits one after another.</p>\n"}], "owner": {"reputation": 93, "user_id": 8067836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIY38.jpg?s=128&g=1", "display_name": "Andrea Baz&#225;n", "link": "https://stackoverflow.com/users/8067836/andrea-baz%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501616657, "creation_date": 1501614859, "last_edit_date": 1501616657, "question_id": 45445963, "link": "https://stackoverflow.com/questions/45445963/active-record-regular-expression", "title": "ACTIVE RECORD REGULAR EXPRESSION", "body": "<p>I need to know how use regular expression with active record. \nI need to create a custom validation where the phone can not have less than 10 digits without counting non-numeric characters.\nThank you so much for your help!.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501618392, "post_id": 45445624, "comment_id": 77854880, "body": "If you insist on using <code>any?</code> you could write <code>%w{ant bear cat}.any? {|word| (@x=word) == &#39;cat&#39;} &amp;&amp; &#39;cat&#39;</code>, which returns <code>false</code> or <code>&#39;cat&#39;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1501613820, "creation_date": 1501613820, "answer_id": 45445671, "question_id": 45445624, "link": "https://stackoverflow.com/questions/45445624/in-ruby-using-the-any-method-to-return-a-value/45445671#45445671", "title": "In Ruby, using the any method to return a value", "body": "<pre><code>%w{ant bear cat}.find {|word| word == 'cat'}\n# =&gt; \"cat\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 3, "last_activity_date": 1501613821, "creation_date": 1501613821, "answer_id": 45445672, "question_id": 45445624, "link": "https://stackoverflow.com/questions/45445624/in-ruby-using-the-any-method-to-return-a-value/45445672#45445672", "title": "In Ruby, using the any method to return a value", "body": "<p>In such case use <code>select</code> to return the elements equal to 'cat' or <code>find</code> to return the first element equal to 'cat':</p>\n\n<pre><code>p %w{ant bear cat}.find {|word| word == 'cat'}\n# =&gt; \"cat\"\n\np %w{ant bear cat}.select {|word| word == 'cat'}\n# =&gt; [\"cat\"]\n</code></pre>\n"}], "owner": {"reputation": 665, "user_id": 4946720, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/622978bee90b9bd34da2af337578bf32?s=128&d=identicon&r=PG&f=1", "display_name": "some user", "link": "https://stackoverflow.com/users/4946720/some-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501613821, "creation_date": 1501613637, "question_id": 45445624, "link": "https://stackoverflow.com/questions/45445624/in-ruby-using-the-any-method-to-return-a-value", "title": "In Ruby, using the any method to return a value", "body": "<p>I use the any? method to check for something within an array, e.g. (simplified example, actual condition more complex)</p>\n\n<pre><code>%w{ant bear cat}.any? {|word| word == 'cat'}\n</code></pre>\n\n<p>it will return true. But what if I want the actual match to return? e.g. \"cat\" for above? I thought of using something like this:</p>\n\n<pre><code>%w{ant bear cat}.any? {|word| (@x=word) == 'cat'}\n</code></pre>\n\n<p>But it does not look nice. </p>\n"}, {"tags": ["ruby", "xml", "xslt", "nokogiri"], "comments": [{"owner": {"reputation": 137664, "user_id": 252228, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ea75023c3c487f36257090d420b7c50?s=128&d=identicon&r=PG", "display_name": "Martin Honnen", "link": "https://stackoverflow.com/users/252228/martin-honnen"}, "edited": false, "score": 1, "creation_date": 1501615798, "post_id": 45445392, "comment_id": 77853476, "body": "Try whether setting strict parsing <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/ParseOptions\" rel=\"nofollow noreferrer\">rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/&hellip;</a> helps."}, {"owner": {"reputation": 5619, "user_id": 1723695, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/dx9jj.jpg?s=128&g=1", "display_name": "Kirill", "link": "https://stackoverflow.com/users/1723695/kirill"}, "reply_to_user": {"reputation": 137664, "user_id": 252228, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ea75023c3c487f36257090d420b7c50?s=128&d=identicon&r=PG", "display_name": "Martin Honnen", "link": "https://stackoverflow.com/users/252228/martin-honnen"}, "edited": false, "score": 0, "creation_date": 1501742936, "post_id": 45445392, "comment_id": 77913925, "body": "@MartinHonnen thanks, but XML strict options didn&#39;t help (same result): <code>Nokogiri::XML(File.open(&#39;target.xml&#39;)) { |config| config.strict }</code>. It seems that  <code>Nokogiri::XSLT</code> doesn&#39;t have a configuration block like <code>Nokogiri::XML</code> has. I found possible workaround: read <code>xsl</code> with <code>Nokogiri::XML</code> with strict config, convert it back to string and read with <code>Nokogiri:XSLT</code>, but I&#39;m not sure that it&#39;s the best option."}, {"owner": {"reputation": 137664, "user_id": 252228, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ea75023c3c487f36257090d420b7c50?s=128&d=identicon&r=PG", "display_name": "Martin Honnen", "link": "https://stackoverflow.com/users/252228/martin-honnen"}, "edited": false, "score": 0, "creation_date": 1501746726, "post_id": 45445392, "comment_id": 77916472, "body": "Hopefully someone with good knowledge of that API can help you further and tell you whether there is not a way to provide the options for the XSLT parsing or at least allow you to parse the stylesheet once with the <code>Nokogiri::XML</code> and the strict option to then pass that document on to the XSLT API without the need to serialize it back to a string."}], "owner": {"reputation": 5619, "user_id": 1723695, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/dx9jj.jpg?s=128&g=1", "display_name": "Kirill", "link": "https://stackoverflow.com/users/1723695/kirill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501612750, "creation_date": 1501612750, "question_id": 45445392, "link": "https://stackoverflow.com/questions/45445392/nokogiri-xslt-can-transform-with-invalid-stylesheet", "title": "Nokogiri XSLT can transform with invalid stylesheet", "body": "<p>If I try to transform sample xml (<code>target.xml</code>)</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;root /&gt;\n</code></pre>\n\n<p>with invalid XSL stylesheet (<code>invalid.xsl</code>):</p>\n\n<pre><code>&lt;xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n  xmlns=\"http://www.w3.org/1999/xhtml\" version=\"1.0\"&gt;\n  &lt;xsl:template match=\"/root\"&gt;\n    &lt;new-root /&gt;\n  &lt;/xsl:stylesheet&gt;\n&lt;/xsl:template&gt;\n</code></pre>\n\n<p>using Nokogiri (1.6.8.1) ruby v2.1.9:</p>\n\n<pre><code>require 'nokogiri'\n\nprint Nokogiri::XSLT(File.open('invalid.xsl'))\n  .transform(Nokogiri::XML(File.open('target.xml')))\n</code></pre>\n\n<p>it will finish successfully:</p>\n\n<pre><code># ruby program.rb\n&lt;?xml version=\"1.0\"?&gt;\n&lt;new-root xmlns=\"http://www.w3.org/1999/xhtml\"/&gt;\n</code></pre>\n\n<p>How to configure nokogiri to validate XSL and throw an error if it's invalid?</p>\n"}, {"tags": ["ruby", "scripting", "watir"], "comments": [{"owner": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1501612804, "post_id": 45445347, "comment_id": 77851694, "body": "do you have chrome installed on the machine, and added to $PATH?"}], "answers": [{"comments": [{"owner": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1501614934, "post_id": 45445429, "comment_id": 77852925, "body": "this isn&#39;t a problem with chromedriver, but with Chrome itself."}, {"owner": {"reputation": 701, "user_id": 8189786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05f8cdcac615b9ddff502e7cd8b0724?s=128&d=identicon&r=PG&f=1", "display_name": "R Balasubramanian", "link": "https://stackoverflow.com/users/8189786/r-balasubramanian"}, "reply_to_user": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1501616926, "post_id": 45445429, "comment_id": 77854068, "body": "can you explain why you think my answer is incorrect? It looks pretty similar to your own comment (which I regrettably did not see until I posted my answer). The error states &quot;cannot find Chrome binary&quot;, which is what I addressed by suggesting that they either did not have their chrome binary or that they had not put it in an accessible location."}, {"owner": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1501617067, "post_id": 45445429, "comment_id": 77854148, "body": "yea no problem!  absolutely.  so, chrome != chromedriver.  the OP has in their post <code>&quot;chromedriver=2.31.488774&quot;</code>  so we know that the chromedriver is being invoked correctly.  it looks like it&#39;s the connection between the chromedriver and the chrome browser itself."}, {"owner": {"reputation": 701, "user_id": 8189786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05f8cdcac615b9ddff502e7cd8b0724?s=128&d=identicon&r=PG&f=1", "display_name": "R Balasubramanian", "link": "https://stackoverflow.com/users/8189786/r-balasubramanian"}, "reply_to_user": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1501617207, "post_id": 45445429, "comment_id": 77854231, "body": "I see. My mistake. So this means that they <b>do</b> have a chromedriver on their path, and it is just their call to it that is not working?"}, {"owner": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1501617238, "post_id": 45445429, "comment_id": 77854248, "body": "their call to it is working.  it just looks like chromedriver can&#39;t find the chrome browser.  you (in general) need to install both chrome AND chromedriver.  they are missing the former"}, {"owner": {"reputation": 701, "user_id": 8189786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05f8cdcac615b9ddff502e7cd8b0724?s=128&d=identicon&r=PG&f=1", "display_name": "R Balasubramanian", "link": "https://stackoverflow.com/users/8189786/r-balasubramanian"}, "reply_to_user": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1501617390, "post_id": 45445429, "comment_id": 77854336, "body": "Aha! Thank you. I will edit my answer to reflect that."}, {"owner": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1501617424, "post_id": 45445429, "comment_id": 77854354, "body": "my pleasure!  i will redact my downvote once it helps the OP :)"}], "tags": [], "owner": {"reputation": 701, "user_id": 8189786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05f8cdcac615b9ddff502e7cd8b0724?s=128&d=identicon&r=PG&f=1", "display_name": "R Balasubramanian", "link": "https://stackoverflow.com/users/8189786/r-balasubramanian"}, "is_accepted": false, "score": 0, "last_activity_date": 1501617755, "last_edit_date": 1501617755, "creation_date": 1501612889, "answer_id": 45445429, "question_id": 45445347, "link": "https://stackoverflow.com/questions/45445347/seleniumwebdrivererrorunknownerror-unknown-error-cannot-find-chrome-bina/45445429#45445429", "title": "Selenium::WebDriver::Error::UnknownError: unknown error: cannot find Chrome binary (Driver info: chromedriver=2.31.488774)", "body": "<p>This means that your script is unable to find the Chrome <strike>driver</strike> browser executable. Make sure that you have downloaded the Chrome browser from <a href=\"https://www.google.com/chrome/browser/desktop/index.html\" rel=\"nofollow noreferrer\">here</a>. Additionally, from the <a href=\"https://sites.google.com/a/chromium.org/chromedriver/capabilities\" rel=\"nofollow noreferrer\">ChromeDriver Capabilities docs</a>,</p>\n\n<blockquote>\n  <p>Path to the Chrome executable to use (on Mac OS X, this should be the actual binary, not just the app. e.g., '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome') </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 5455, "user_id": 393021, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5761f8f81bb258e64b585889481ef25c?s=128&d=identicon&r=PG", "display_name": "iGbanam", "link": "https://stackoverflow.com/users/393021/igbanam"}, "is_accepted": false, "score": 1, "last_activity_date": 1519798911, "creation_date": 1519798911, "answer_id": 49023161, "question_id": 45445347, "link": "https://stackoverflow.com/questions/45445347/seleniumwebdrivererrorunknownerror-unknown-error-cannot-find-chrome-bina/49023161#49023161", "title": "Selenium::WebDriver::Error::UnknownError: unknown error: cannot find Chrome binary (Driver info: chromedriver=2.31.488774)", "body": "<p>There may be some libraries which the the version of <code>chromedriver</code> you're trying to install depends on. You need to install these libraries to start <code>chromedriver</code>.</p>\n\n<p>How did I solve this?</p>\n\n<p>I SSH'd into my testing environment and ran <code>chromedriver</code> (I am using the latest version at the time of this answer: 2.35 on Ubuntu Trusty 14.04)</p>\n\n<pre><code>chromedriver: error while loading shared libraries: libnss3.so: cannot open ...\n</code></pre>\n\n<p>This is the Network Security Service library. Other versions may require some other libraries to be installed. Checkout <a href=\"https://stackoverflow.com/a/38689924/393021\">this answer</a> for more on this.</p>\n\n<p>So I installed the library using <code>apt-get</code>.</p>\n\n<p>p.s: Make sure you have Chrome installed in the box too. If you're using CircleCI, checkout <a href=\"https://discuss.circleci.com/t/installing-chrome-inside-of-your-docker-container/9067/4\" rel=\"nofollow noreferrer\">this tip</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 162, "user_id": 1524989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f735e1f71071f706a8eee44d241234b9?s=128&d=identicon&r=PG", "display_name": "suo", "link": "https://stackoverflow.com/users/1524989/suo"}, "is_accepted": false, "score": 0, "last_activity_date": 1549666772, "creation_date": 1549666772, "answer_id": 54601378, "question_id": 45445347, "link": "https://stackoverflow.com/questions/45445347/seleniumwebdrivererrorunknownerror-unknown-error-cannot-find-chrome-bina/54601378#54601378", "title": "Selenium::WebDriver::Error::UnknownError: unknown error: cannot find Chrome binary (Driver info: chromedriver=2.31.488774)", "body": "<p>The solution is to add the location of the Chrome or Chromium app to your PATH. You likely tried to organize the apps on your Mac and did not put Chrome directly in the Applications folder.</p>\n\n<p>However it came to be, the folder containing the Chrome or Chromium .app is not in your PATH. To remedy it, edit your ~/.bash_profile and add a line such as:<br>\n<code>export PATH=\"$PATH:/Applications/Web\"</code><br>\n<em>In this example, I have put all of my browsers in a folder called \"Web\" inside of Applications.</em></p>\n\n<p>The more technical explanation is that chromedriver searches for a specific subpath within each entry in your PATH. The code that does it is here:\n<a href=\"https://chromium.googlesource.com/chromium/src/+/35a93c1ca219f698ace9358df126429291a445a0/chrome/test/chromedriver/chrome/chrome_finder.cc#136\" rel=\"nofollow noreferrer\">Chromedriver Source Code</a></p>\n"}, {"tags": [], "owner": {"reputation": 782, "user_id": 4056534, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/qmVJC.jpg?s=128&g=1", "display_name": "Sandip Subedi", "link": "https://stackoverflow.com/users/4056534/sandip-subedi"}, "is_accepted": false, "score": 1, "last_activity_date": 1582672303, "creation_date": 1582672303, "answer_id": 60404538, "question_id": 45445347, "link": "https://stackoverflow.com/questions/45445347/seleniumwebdrivererrorunknownerror-unknown-error-cannot-find-chrome-bina/60404538#60404538", "title": "Selenium::WebDriver::Error::UnknownError: unknown error: cannot find Chrome binary (Driver info: chromedriver=2.31.488774)", "body": "<p>Remember,</p>\n\n<p>You also need to have chrome installed on the machine in order for Selenium Chrome Driver to work.</p>\n"}], "owner": {"reputation": 11, "user_id": 5521750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca043cc7388866d213addc6c3290534?s=128&d=identicon&r=PG&f=1", "display_name": "Nazuk", "link": "https://stackoverflow.com/users/5521750/nazuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4552, "favorite_count": 2, "answer_count": 4, "score": 1, "last_activity_date": 1582672303, "creation_date": 1501612603, "last_edit_date": 1501613000, "question_id": 45445347, "link": "https://stackoverflow.com/questions/45445347/seleniumwebdrivererrorunknownerror-unknown-error-cannot-find-chrome-bina", "title": "Selenium::WebDriver::Error::UnknownError: unknown error: cannot find Chrome binary (Driver info: chromedriver=2.31.488774)", "body": "<p>I'm trying to use Watir gem for writing scripts in ruby but the following code gives an error:</p>\n\n<pre><code>browser = Watir::Browser.new :chrome\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Selenium::WebDriver::Error::UnknownError: unknown error: cannot find Chrome binary\n  (Driver info: chromedriver=2.31.488774 (7e15618d1bf16df8bf0ecf2914ed1964a387ba0b),platform=Mac OS X 10.12.5 x86_64)\n</code></pre>\n\n<p>Please let me know the solution to the above issue.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 4711, "user_id": 83729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5071d40db06ac987180c40e675b7193b?s=128&d=identicon&r=PG", "display_name": "msergeant", "link": "https://stackoverflow.com/users/83729/msergeant"}, "edited": false, "score": 0, "creation_date": 1501612481, "post_id": 45445164, "comment_id": 77851512, "body": "The ternary is the value that goes into h[k]. If k &lt; 2, then k goes into h[k]. Otherwise, it&#39;s h[k-1] + h[k-2]. For 6, it would be h[5] + h[4]."}, {"owner": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "reply_to_user": {"reputation": 4711, "user_id": 83729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5071d40db06ac987180c40e675b7193b?s=128&d=identicon&r=PG", "display_name": "msergeant", "link": "https://stackoverflow.com/users/83729/msergeant"}, "edited": false, "score": 0, "creation_date": 1501612883, "post_id": 45445164, "comment_id": 77851737, "body": "Ok, but 6 returns 8 (8 being the 6th fibonacci number), so how is the h[k-1] + h[k-2] getting the fibonacci sequence.  5 + 4 is not 8, so I&#39;m still confused."}, {"owner": {"reputation": 4711, "user_id": 83729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5071d40db06ac987180c40e675b7193b?s=128&d=identicon&r=PG", "display_name": "msergeant", "link": "https://stackoverflow.com/users/83729/msergeant"}, "edited": false, "score": 0, "creation_date": 1501632463, "post_id": 45445164, "comment_id": 77860048, "body": "h is a hash. When you call fib[6], it does some recursive calls to the hash and ends up looking like this: {1=&gt;1, 0=&gt;0, 2=&gt;1, 3=&gt;2, 4=&gt;3, 5=&gt;5, 6=&gt;8}. h[5] == 5 and h[4] == 3. 5 + 3 == 8"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "edited": false, "score": 0, "creation_date": 1501619506, "post_id": 45445821, "comment_id": 77855422, "body": "I followed along till going back up, <code>h[3]</code>.  Why did` h[2] + h[1]` add as <code>1 + 1</code>.  Same with the rest, like the next -  <code>h[4] = h[3] + h[2] is added 2 + 1</code>."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "edited": false, "score": 0, "creation_date": 1501623659, "post_id": 45445821, "comment_id": 77857370, "body": "@stuartambient This is just recursion, to understand it better try solving first <code>fib[0]</code>, then <code>fib[1]</code> and so on. For example: <code>fib[0]</code> will return <code>0</code>, thus, whenever <code>h[0]</code> is executed in the code (in the above example) its value will be <code>0</code>; the same with <code>fib[1]</code>. Now that you now the values for <code>h[0]</code> and <code>h[1]</code> try to figure out <code>fib[2]</code> using the logic displayed above."}, {"owner": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "edited": false, "score": 0, "creation_date": 1501623943, "post_id": 45445821, "comment_id": 77857476, "body": "Thank you! I will try that again using the information you&#39;ve given me.  I&#39;m not well versed in recursion and just recently did a fibonacci method without recursion.  This would be the next step and hopefully at some point I&#39;ll get it.  Thanks for the help!"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "edited": false, "score": 0, "creation_date": 1501624179, "post_id": 45445821, "comment_id": 77857555, "body": "@stuartambient <code>h[2]</code> is the same than <code>fib[2]</code>; that means that <code>k</code> value is <code>2</code>. Step 1: <code>if k &lt; 2</code> becomes <code>2 &lt; 2</code>, that is: <b>false</b>, so <code>else</code> code is execued; Step 2: <code>h[k] = h[k-1] + h[k-2]</code>, which becomes <code>h[2] = h[2-1] + h[2-2]</code>, which becomes <code>h[2] = h[1] + h[0]</code>. But now you know the values for <code>h[0]</code> and <code>h[1]</code>, right? <code>h[2] = 1 + 0</code>. Now you see why <code>fib[2] == 1</code>? Now go for <code>f[3]</code> up to <code>f[6]</code>."}, {"owner": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "edited": false, "score": 0, "creation_date": 1501631749, "post_id": 45445821, "comment_id": 77859879, "body": "I&#39;m still sort of stuck at this point, going up. I don&#39;t understand where the <code>1+1</code> came from in the sequence.  In other words where did <code>h[k-2]</code>  go.                                                                                                                 <code>h[3] = h[2] + h[1]</code> <code>h[3] = 1 + 1</code> h[3] = 2`  Obviously I know nothing about, nor have ever used recursion before.  This is probably the biggest hurdle for me in understanding it."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "edited": false, "score": 0, "creation_date": 1501676537, "post_id": 45445821, "comment_id": 77881588, "body": "@stuartambient Check <a href=\"https://stackoverflow.com/questions/25676961/understanding-how-recursive-functions-work\">here</a>, <a href=\"https://stackoverflow.com/questions/6418017/what-is-recursion-and-how-does-it-work\">here</a> and <a href=\"https://stackoverflow.com/questions/717725/understanding-recursion\">here</a> for some explanations about recursion. When you get a better grasp at it come back to this answer."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "edited": false, "score": 0, "creation_date": 1501676580, "post_id": 45445821, "comment_id": 77881629, "body": "@stuartambient Also, do you understand how <code>Hash.new</code> with a <i>block</i> works?"}, {"owner": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "edited": false, "score": 0, "creation_date": 1501689880, "post_id": 45445821, "comment_id": 77892426, "body": "I&#39;m looking over the links, thank you!.  As far as understanding how Hash.new works with blocks, I&#39;ve used them a few times now.  Used for counting items  in a list for instance,  The other thing I did with this particular code is to take off the conditionals and I see that just sending a number to  &#39;h[k] = k&#39;  will give me a key/value of the number.  Both key and value get the same number. So I&#39;d say there is some kind of dynamic behavior that goes on between the hash and block, particularly in these cases."}], "tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": false, "score": 2, "last_activity_date": 1501614354, "creation_date": 1501614354, "answer_id": 45445821, "question_id": 45445164, "link": "https://stackoverflow.com/questions/45445164/please-explain-ruby-hash-used-for-fibonacci/45445821#45445821", "title": "Please explain Ruby hash used for fibonacci", "body": "<p>That code is the same as the following:</p>\n\n<pre><code>fib = Hash.new do |h,k|\n  if k &lt; 2\n    h[k] = k\n  else \n    h[k] = h[k-1] + h[k-2]\n  end\nend\n</code></pre>\n\n<p>When you access a key that is not part of the hash <code>fib</code> it will default to whatever is in the block, where <code>h</code> is the hash itself and <code>k</code> is the key you want to access.</p>\n\n<p>Using <code>fib[6]</code> the evaluation of <code>if k &lt; 2</code> returns <code>false</code>, so the <code>else</code> clause is executed:</p>\n\n<pre><code>h[k] = h[k-1] + h[k-2]\nh[6] = h[6-1] + h[6-2]\nh[6] = h[5] + h[4]\n</code></pre>\n\n<p>As you can see both <code>h[5]</code> and <code>h[4]</code> also try to access a non-existing key, so the same evaluation is made for both, and both return <code>false</code> from the condition in <code>if</code>, so:</p>\n\n<pre><code>h[5] = h[5-1] + h[5-2]\nh[5] = h[4] + h[3]\n\nh[4] = h[4-1] + h[4-2]\nh[4] = h[3] + h[2]\n</code></pre>\n\n<p>Again, both <code>h[3]</code> and <code>h[2]</code> look for a non-existing key, so the process repeats:</p>\n\n<pre><code>h[3] = h[3-1] + h[3-2]\nh[3] = h[2] + h[1]\n\nh[2] = h[2-1] + h[2-2]\nh[2] = h[1] + h[0]\n</code></pre>\n\n<p>Finally, the same goes with <code>h[1]</code> and <code>h[0]</code>, but this time the condition in <code>if</code> will evaluate to <code>true</code>, so now it will return <code>h[k] = k</code>:</p>\n\n<pre><code>h[0] = 0\nh[1] = 1\n</code></pre>\n\n<p>Now, after going all the way down, we go back up:</p>\n\n<pre><code>h[2] = h[1] + h[0]\nh[2] = 1 + 0\nh[2] = 1\n\nh[3] = h[2] + h[1]\nh[3] = 1 + 1\nh[3] = 2\n\nh[4] = h[3] + h[2]\nh[4] = 2 + 1\nh[4] = 3\n\nh[5] = h[4] + h[3]\nh[5] = 3 + 2\nh[5] = 5\n\nh[6] = h[5] + h[4]\nh[6] = 5 + 3\nh[6] = 8\n</code></pre>\n\n<p>So:</p>\n\n<pre><code>fib[6]\n#=&gt; 8\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1501623726, "creation_date": 1501611854, "last_edit_date": 1501623726, "question_id": 45445164, "link": "https://stackoverflow.com/questions/45445164/please-explain-ruby-hash-used-for-fibonacci", "title": "Please explain Ruby hash used for fibonacci", "body": "<p>Trying to understand the following code which returns the F(n) for the sequence number in the method call.  It is actually from an older SO post.  I do understand the Fibonacci numbers.</p>\n\n<pre><code>fib = Hash.new{ |h,k| h[k] = k &lt; 2 ? k : h[k-1] + h[k-2]}\nfib[6]  # =&gt; 8\n</code></pre>\n\n<p>I know it's a Hash, and understand all the syntax.  My stumbling block is the operation at the end of the line - <code>h[k-1] + h[k-2]</code> </p>\n\n<p>Perhaps I do not fully understand the recursion method.  Thanks for the help!\n.</p>\n"}, {"tags": ["ruby", "rubygems", "linux-mint", "cups"], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 1, "last_activity_date": 1501614992, "creation_date": 1501614992, "answer_id": 45446001, "question_id": 45445160, "link": "https://stackoverflow.com/questions/45445160/error-installing-cups-gem-on-linux-mint/45446001#45446001", "title": "Error Installing cups Gem on Linux Mint", "body": "<p>The error message is:</p>\n\n<pre><code>Couldn't find CUPS libraries on your system. Check they're installed and in your path.\n</code></pre>\n\n<p>Install the CUPS libraries and retry <code>bundle install</code>:</p>\n\n<pre><code>sudo apt-get install libcups2-dev\nsudo apt-get install libcupsimage2-dev\n</code></pre>\n\n<p>This is a common pattern in Ruby when installing gems; if it has to compile a native extension that relies on a third-party library then you need to have the third-party library installed first. Other gems like <code>mysql2</code>, <code>pg</code>, and <code>nokogiri</code> will all have the same behavior and require the appropriate library to be installed.</p>\n"}], "owner": {"reputation": 43, "user_id": 7735961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpVLQ.jpg?s=128&g=1", "display_name": "mtsvr", "link": "https://stackoverflow.com/users/7735961/mtsvr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 45446001, "answer_count": 1, "score": 0, "last_activity_date": 1501614992, "creation_date": 1501611836, "last_edit_date": 1501612277, "question_id": 45445160, "link": "https://stackoverflow.com/questions/45445160/error-installing-cups-gem-on-linux-mint", "title": "Error Installing cups Gem on Linux Mint", "body": "<p>I'm having trouble installing the <code>cups 0.1.10</code> gem.\nWhen running <code>bundle install</code> on my project folder the process is interrupted because of the following error:</p>\n\n<pre><code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory: /tmp/bundler20170801-5492-c0toxgcups-0.1.10/gems/cups-0.1.10/ext\n/usr/bin/ruby2.3 -r ./siteconf20170801-5492-1frgnir.rb extconf.rb\nchecking for main() in -lcups... no\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/bin/$(RUBY_BASE_NAME)2.3\n    --with-cupslib\n    --without-cupslib\nCouldn't find CUPS libraries on your system. Check they're installed and in your path.\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /tmp/bundler20170801-5492-c0toxgcups-0.1.10/extensions/x86_64-linux/2.3.0/cups-0.1.10/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /tmp/bundler20170801-5492-c0toxgcups-0.1.10/gems/cups-0.1.10 for inspection.\nResults logged to /tmp/bundler20170801-5492-c0toxgcups-0.1.10/extensions/x86_64-linux/2.3.0/cups-0.1.10/gem_make.out\n\nAn error occurred while installing cups (0.1.10), and Bundler cannot continue.\nMake sure that `gem install cups -v '0.1.10'` succeeds before bundling.\n</code></pre>\n\n<p>I've cloned the repository on OS X Sierra 10.12.6, and I get no problem at all. I've tried using <code>rvm</code> to install and use the same version of ruby installed on OS X, but still no luck.</p>\n\n<p>The system version of Ruby on Linux Mint is <code>ruby2.3.1pp112</code>, and I've also installed <code>ruby-dev</code> using <code>sudo apt-get install ruby2.3-dev</code>, as I've read in many places that's a suitable solution to the problem, but it presists.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "owner": {"reputation": 35, "user_id": 2351161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66d4de113f95228117da3e7c208b2178?s=128&d=identicon&r=PG", "display_name": "Pranav Ganorkar", "link": "https://stackoverflow.com/users/2351161/pranav-ganorkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501697734, "creation_date": 1501609534, "last_edit_date": 1501697734, "question_id": 45444551, "link": "https://stackoverflow.com/questions/45444551/rails-update-nested-attribute-having-a-unique-constraint-in-a-form", "title": "Rails: update nested attribute having a unique constraint in a form", "body": "<p>I have two models: Interview and Interviewee</p>\n\n<p>Interview to Interviewee is Many to One relationship. I am creating a form for creating a new Interview through which I also accept the nested attributes for Interviewee. There is also a field \"email\" having unique constraint in Interviewee model.</p>\n\n<p><strong>If an Interviewee having the specified \"email\" already exists in the model, then I simply want to link the Interview to it.</strong></p>\n\n<p>Here are my models:</p>\n\n<p>Interviewee.rb:</p>\n\n<pre><code>class Interviewee &lt; ApplicationRecord\n    has_many :interviews, inverse_of: :interviewee\n\n    def self.find_by_email(email)\n        where(\"email = ?\", email)\n    end\nend\n</code></pre>\n\n<p>Interview.rb:</p>\n\n<pre><code>class Interview &lt; ApplicationRecord\n  belongs_to :interviewee, inverse_of: :interviews\n  has_many :meetings\n  has_many :interviewers, through: :meetings\n  accepts_nested_attributes_for :interviewee\n  accepts_nested_attributes_for :interviewers\nend\n</code></pre>\n\n<p>Interview Controller:</p>\n\n<pre><code>class InterviewsController &lt; ApplicationController\n    def index\n        @interviews = Interview.all\n    end\n\n    def new\n        @interview = Interview.new(date: Date.current)\n        #2.times {@interview.interviewers.build}\n        @interview.interviewers.build\n        @interview.build_interviewee\n    end\n\n    def create\n        render plain: interview_params[\"interviewee_attributes\"][\"email\"].inspect\n        @interview = Interview.new(interview_params)\n        logger.debug \"#{@interview.interviewee.email}\"\n\n        # Check if the interviewee already exists\n        interviewee = Interviewee.find_by(email:@interview.interviewee.email)\n\n        if interviewee.present?\n            logger.debug \"Interviewee exists, linking to it\"\n            @interview.interviewee.id = interviewee.id\n        else\n            logger.debug \"Interviewee does not exist\"\n        end\n\n\n\n        # Check if the interviewers already exists\n\n        # If they, exist, display alert message on frontend\n        #begin\n        @interview.save\n           #redirect_to interviews_url\n        # rescue ActiveRecord::RecordNotUnique =&gt; ex\n        #     logger.error \"#{ex}\"\n        #     flash[:error] = \"#{ex}\"\n        #     redirect_to new_interview_url\n        # end\n    end\n\n    private\n        def interview_params\n            params.require(:interview).permit(\n                :title, :date, :start_time, :end_time,\n                interviewee_attributes: [:id, :email],\n                interviewers_attributes: [:id, :email]\n            )\n        end\nend\n</code></pre>\n\n<p>When I try to save an Interviewee whose email is already present in the table, It gives me this error:</p>\n\n<p><strong>SQLite3::ConstraintException: UNIQUE constraint failed: interviewees.id: INSERT INTO \"interviewees\" (\"id\", \"email\", \"created_at\", \"updated_at\") VALUES (?, ?, ?, ?)</strong></p>\n\n<p>Shouldn't it just create the Interview model without inserting into the Interviewee model as I am passing it an already existing id as given in <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html</a> ?</p>\n\n<p>Regards.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "web-applications", "slim-lang"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1501611165, "post_id": 45444116, "comment_id": 77850718, "body": "can you show the error? are you sure it has to do with slim?"}, {"owner": {"reputation": 367, "user_id": 1743452, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b24be693471aabcc9ca974b5912c9624?s=128&d=identicon&r=PG", "display_name": "Hirohito Yamada", "link": "https://stackoverflow.com/users/1743452/hirohito-yamada"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1501640851, "post_id": 45444116, "comment_id": 77862056, "body": "@maxpleaner thx for the comment! it says &quot;ArgumentError at / unknown keyword: class&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 5879261, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2Vp-tcZNTQY/AAAAAAAAAAI/AAAAAAAAA50/aEa_X5Ia0Rw/photo.jpg?sz=128", "display_name": "Miro Mudrik", "link": "https://stackoverflow.com/users/5879261/miro-mudrik"}, "is_accepted": false, "score": 0, "last_activity_date": 1501670957, "last_edit_date": 1501670957, "creation_date": 1501669337, "answer_id": 45458121, "question_id": 45444116, "link": "https://stackoverflow.com/questions/45444116/how-to-add-a-class-and-have-thumb-option-in-one-line-with-slim/45458121#45458121", "title": "How to add a class and have thumb option in one line with slim", "body": "<p>I think you are losing 'do' after first line.\nTry this:</p>\n\n<pre><code>= link_to collaborator.user do\n  = user_image_of collaborator.user.avatar, thumb: true, class: \"ui avatar image carouselCollaboratorsImage\"\n</code></pre>\n\n<p>But I dont think it will help. Maybe try:</p>\n\n<pre><code>= link_to collaborator.user do\n  = user_image_of collaborator.user.avatar, thumb: true, input_html: { class: \"ui avatar image carouselCollaboratorsImage\" }\n</code></pre>\n\n<p>Btw - What are you using to manage images? If are you using paperclip u can try it with this:</p>\n\n<pre><code>= link_to collaborator.user do\n  =image_tag collaborator.user.avatar.url(:thumb), class: '...'\n</code></pre>\n\n<p>Or if u are using dragonfly try this</p>\n\n<pre><code>= link_to collaborator.user do\n  =image_tag collaborator.user.avatar.thumb('100x100#').url, class: '...'\n</code></pre>\n\n<p>The options for defining thumb options u can find here: <a href=\"https://markevans.github.io/dragonfly/imagemagick#processors\" rel=\"nofollow noreferrer\">ImageMagic Processors Guide</a></p>\n"}], "owner": {"reputation": 367, "user_id": 1743452, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b24be693471aabcc9ca974b5912c9624?s=128&d=identicon&r=PG", "display_name": "Hirohito Yamada", "link": "https://stackoverflow.com/users/1743452/hirohito-yamada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501701502, "creation_date": 1501608071, "last_edit_date": 1501701502, "question_id": 45444116, "link": "https://stackoverflow.com/questions/45444116/how-to-add-a-class-and-have-thumb-option-in-one-line-with-slim", "title": "How to add a class and have thumb option in one line with slim", "body": "<p>I have this code written in slim.</p>\n\n<pre><code>= link_to collaborator.user\n  = user_image_of collaborator.user.avatar, thumb: true, class: \"ui avatar image carouselCollaboratorsImage\"\n</code></pre>\n\n<p>I get an error with having, <code>thumb: true</code> and <code>class: \"ui~~~~\"</code> in the same line. How can I avoid error and still manage to add <code>class</code> in image tag?</p>\n"}, {"tags": ["ruby", "utf-8"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1501609864, "post_id": 45444050, "comment_id": 77849965, "body": "I&#39;m using Ruby 2.3 and your code produces no errors. Are you sure that string is correct and actually UTF-8 in your source?"}], "answers": [{"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 4, "last_activity_date": 1501612720, "creation_date": 1501612720, "answer_id": 45445378, "question_id": 45444050, "link": "https://stackoverflow.com/questions/45444050/convert-utf-8-to-cp1252-ruby-2-2/45445378#45445378", "title": "Convert UTF-8 to CP1252 ruby 2.2", "body": "<p>UTF-8 covers the entire range of unicode, but CP1252 only includes a subset of them. Obviously this means that there are characters that can be encoded in UTF-8 but not in CP1252. This is the problem you are facing.</p>\n\n<p>In your example it <em>looks</em> like the string only contains characters that should work in CP1252, but clearly it doesn\u2019t.</p>\n\n<p>The character in the error message, <a href=\"http://www.charbase.com/0327-unicode-combining-cedilla\" rel=\"nofollow noreferrer\">U+0327</a> is a <a href=\"https://en.wikipedia.org/wiki/Combining_character\" rel=\"nofollow noreferrer\"><em>combining character</em></a>, and is not representable in CP1252. It combines with the preceding <code>c</code> to produce <code>\u00e7</code>. <code>\u00e7</code> can also be represented as a <em>single</em> character (<a href=\"http://www.charbase.com/00e7-unicode-latin-small-letter-c-with-cedilla\" rel=\"nofollow noreferrer\">U+00E7</a>), which <em>is</em> representable in CP1252.</p>\n\n<p>One option might be <a href=\"https://en.wikipedia.org/wiki/Unicode_equivalence#Normalization\" rel=\"nofollow noreferrer\"><em>normalisation</em></a>, which will convert the string into a form that is representable in CP1252.</p>\n\n<pre><code>file = 'd:/1 descri\u00e7\u00e3o.txt'.unicode_normalize(:nfc)\nputs file.encode('cp1252')\n</code></pre>\n\n<p>(It appears that Stack Overflow is normalizing the string when displaying your question, which is probably why copying the code from the question and running it doesn\u2019t produce any errors.)</p>\n\n<p>This will avoid the error, but note that it is not necessarily possible to reverse the process to get the original string unless the original is in a known normalized form already.</p>\n"}], "owner": {"reputation": 1022, "user_id": 1542787, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bdf21bb9180001d38386750fa565b5f9?s=128&d=identicon&r=PG", "display_name": "ricardo", "link": "https://stackoverflow.com/users/1542787/ricardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 0, "accepted_answer_id": 45445378, "answer_count": 1, "score": 0, "last_activity_date": 1501612720, "creation_date": 1501607807, "question_id": 45444050, "link": "https://stackoverflow.com/questions/45444050/convert-utf-8-to-cp1252-ruby-2-2", "title": "Convert UTF-8 to CP1252 ruby 2.2", "body": "<p>How to keep all characters converting from UTF-8 to CP1252 on ruby 2.2</p>\n\n<p>this code:</p>\n\n<pre><code>file = 'd:/1 descri\u00e7\u00e3o.txt'\nputs file.encode('cp1252')\n</code></pre>\n\n<p>Give this error:</p>\n\n<pre><code>`encode': U+0327 to WINDOWS-1252 in conversion from UTF-8 to WINDOWS-1252 (Encoding::UndefinedConversionError)\n</code></pre>\n\n<p>My application need to be cp1252, but I can't find any way to keep all the characters.</p>\n\n<p>I can't replace this characters, because later I will use this info to read the file from file system.</p>\n\n<pre><code>puts file.encode('cp1252', undef: :replace, replace: '')\n&gt; d:/1 descricao.txt\n</code></pre>\n\n<p>ps: It is a ruby script not a ruby on rails application</p>\n"}, {"tags": ["ruby", "macos", "homebrew", "msgpack"], "answers": [{"comments": [{"owner": {"reputation": 152, "user_id": 3477024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b471f3e07d29b0ec3a74bd35a3470fdb?s=128&d=identicon&r=PG&f=1", "display_name": "nilesguo", "link": "https://stackoverflow.com/users/3477024/nilesguo"}, "edited": false, "score": 0, "creation_date": 1501612130, "post_id": 45443580, "comment_id": 77851289, "body": "Thank you, I updated the msgpack version in my gem and it was installed correctly."}], "tags": [], "owner": {"reputation": 1030, "user_id": 2100645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9894864f33c42fffe19330d2e00d1b?s=128&d=identicon&r=PG", "display_name": "Lucas Costa", "link": "https://stackoverflow.com/users/2100645/lucas-costa"}, "is_accepted": true, "score": 2, "last_activity_date": 1501606658, "last_edit_date": 1501606658, "creation_date": 1501606353, "answer_id": 45443580, "question_id": 45443135, "link": "https://stackoverflow.com/questions/45443135/install-msgpack-0-5-8-using-homebrew-mac-osx-error/45443580#45443580", "title": "Install msgpack (0.5.8) using homebrew mac OSX error", "body": "<p>I found this issue in msgpack repository in Github:<br>\n<a href=\"https://github.com/msgpack/msgpack-ruby/issues/120\" rel=\"nofollow noreferrer\">https://github.com/msgpack/msgpack-ruby/issues/120</a></p>\n\n<p>Looks like this issue was resolved in version 1.0.0.<br>\nDo you really need to use the version 0.5.8? Is it possible to update the gem version?</p>\n"}], "owner": {"reputation": 152, "user_id": 3477024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b471f3e07d29b0ec3a74bd35a3470fdb?s=128&d=identicon&r=PG&f=1", "display_name": "nilesguo", "link": "https://stackoverflow.com/users/3477024/nilesguo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 0, "accepted_answer_id": 45443580, "answer_count": 1, "score": 2, "last_activity_date": 1532001312, "creation_date": 1501605003, "last_edit_date": 1532001312, "question_id": 45443135, "link": "https://stackoverflow.com/questions/45443135/install-msgpack-0-5-8-using-homebrew-mac-osx-error", "title": "Install msgpack (0.5.8) using homebrew mac OSX error", "body": "<p>I've been trying to install msgpack using homebrew, and it repeatedly throw the following error:</p>\n\n<pre><code>Building native extensions.  This could take a while...\nERROR:  Error installing msgpack:\nERROR: Failed to build gem native extension.\n\ncurrent directory: /usr/local/lib/ruby/gems/2.4.0/gems/msgpack \n0.5.8/ext/msgpack\n/usr/local/opt/ruby/bin/ruby -r ./siteconf20170801-23901-1ar0ojr.rb extconf.rb\nchecking for ruby/st.h... yes\nchecking for st.h... yes\nchecking for rb_str_replace() in ruby.h... yes\ncreating Makefile\n\ncurrent directory: /usr/local/lib/ruby/gems/2.4.0/gems/msgpack-\n0.5.8/ext/msgpack\nmake \"DESTDIR=\" clean\n\ncurrent directory: /usr/local/lib/ruby/gems/2.4.0/gems/msgpack-\n0.5.8/ext/msgpack\nmake \"DESTDIR=\"\ncompiling buffer.c\ncompiling buffer_class.c\ncompiling core_ext.c\ncore_ext.c:121:22: error: use of undeclared identifier 'rb_cFixnum'\nrb_define_method(rb_cFixnum, \"to_msgpack\", Fixnum_to_msgpack, -1);\n                 ^\ncore_ext.c:122:22: error: use of undeclared identifier 'rb_cBignum'\nrb_define_method(rb_cBignum, \"to_msgpack\", Bignum_to_msgpack, -1);\n                 ^\n2 errors generated.\nmake: *** [core_ext.o] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in \n/usr/local/lib/ruby/gems/2.4.0/gems/msgpack-0.5.8 for inspection.\nResults logged to /usr/local/lib/ruby/gems/2.4.0/extensions/x86_64-darwin-\n16/2.4.0/msgpack-0.5.8/gem_make.out\n</code></pre>\n\n<p>Searching for the solution to this has been unfruitful. My Ruby version is 2.4.1, but I'm not sure if it's a version issue. </p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "edited": false, "score": 1, "creation_date": 1501606039, "post_id": 45442223, "comment_id": 77847762, "body": "There&#39;s no &quot;rails&quot; way to do this. You&#39;ll have to use Javascript to make an ajax call to your rails server to get the content and then update DOM. Google &quot;javascript ajax,&quot; &quot;javascript onchange event&quot; and &quot;changing DOM with javascript&quot; to get started. I recommend using <code>jquery</code> if you&#39;re familiar with it.  And of course, if you get stuck, you can always come back here with your broken code- we&#39;ll be happy to help you fix it."}], "answers": [{"tags": [], "owner": {"reputation": 2594, "user_id": 2628223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dbHga.jpg?s=128&g=1", "display_name": "BigRon", "link": "https://stackoverflow.com/users/2628223/bigron"}, "is_accepted": true, "score": 0, "last_activity_date": 1501607396, "creation_date": 1501607396, "answer_id": 45443915, "question_id": 45442223, "link": "https://stackoverflow.com/questions/45442223/rails-dynamic-search-in-a-model/45443915#45443915", "title": "Rails Dynamic Search in a Model", "body": "<p>I have a special affinity for questions like this because it took me a LONG time to figure out similar things. So generally it should be like this:  </p>\n\n<ol>\n<li><p>Set up your <code>:car_brand_eq</code> collection_select with an instance variable that you can update as a result of an ajax call and a class you can reference it with. Change: </p>\n\n<pre><code>&lt;%= f.collection_select :car_brand_eq, CarBrand.all... \n</code></pre>\n\n<p>to: </p>\n\n<pre><code>&lt;%= f.collection_select :car_brand_eq, @car_brands, :id, :name, {prompt: 'brand'}, class: \"grey-text car-brand-collection\" %&gt;\n</code></pre></li>\n<li><p>Set up your AJAX call:</p>\n\n<p>Either grab the id of the <code>&lt;%= f.select(:year_eq...</code> to use in jquery or add a unique class name to it:</p>\n\n<pre><code>&lt;%= f.select(:year_eq, 1960..(Date.today.year+1), {prompt: 'year'}, class: \"grey-text year-selector\") %&gt;\n</code></pre>\n\n<p>Then the script:</p>\n\n<pre><code>&lt;script&gt;\n  $(document).on(\"change\", \".year-selector\", function () {\n    $.ajax({\n      url: \"/car_brands/search.js\",\n      // now pass params[:year] as a query string\n      data: { year: $(\".year-selector\").val() },\n      type: \"GET\"\n    });\n  });\n&lt;/script&gt;\n</code></pre></li>\n<li><p>Now set up your <code>search_car_brands_path</code> route and then the logic in <code>car_brands_controller.rb</code>, or whatever other controller you would use:</p>\n\n<p><strong>routes.rb</strong> <a href=\"http://guides.rubyonrails.org/routing.html#adding-more-restful-actions\" rel=\"nofollow noreferrer\">(an explantion of this routes logic here)</a></p>\n\n<pre><code>resources :car_brands do\n  collection do\n    # search_car_brands_path\n    get :search\n  end\nend\n</code></pre>\n\n<p><strong>car_brands_controller.rb</strong></p>\n\n<pre><code>...\n# GET /car_brands/search\n# search_car_brands_path\ndef search\n  # not knowing how exactly you filter CarBrands by year, I'm guessing:\n  @car_brands = CarBrand.where(year: params[:year])\nend\n</code></pre></li>\n<li><p>Finally. Now you just need to set up search.js.erb in:</p>\n\n<p><strong>views/car_brands/search.js.erb</strong></p>\n\n<pre><code>// grab that car-brand-collection selector from step 1 &amp; update it\n$(\".car-brand-collection\").html(\"&lt;%= f.collection_select :car_brand_eq, @car_brands, :id, :name, {prompt: 'brand'}, class: \"grey-text car-brand-collection\" %&gt;\");\n</code></pre></li>\n</ol>\n\n<p>These are the steps. I haven't tested them, but you should be able to work it out from here.</p>\n"}], "owner": {"reputation": 121, "user_id": 3754535, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3e9a6cd050b583ed82c84e99a0e0eb1?s=128&d=identicon&r=PG&f=1", "display_name": "user3754535", "link": "https://stackoverflow.com/users/3754535/user3754535"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 45443915, "answer_count": 1, "score": -2, "last_activity_date": 1501607396, "creation_date": 1501602211, "question_id": 45442223, "link": "https://stackoverflow.com/questions/45442223/rails-dynamic-search-in-a-model", "title": "Rails Dynamic Search in a Model", "body": "<p>I have the following model:</p>\n\n<p>Car which has :<strong>year</strong>, :<strong>model</strong> and :<strong>car_brand_id</strong> fields.\nCarBrand which has only a :<strong>name</strong> field and has_many :<strong>cars</strong>.</p>\n\n<p>In the view I have a search form with ransack like the following:</p>\n\n<pre><code>&lt;%= search_form_for(@q, url: search_result_path) do |f| %&gt;\n\n  &lt;%= f.select(:year_eq, 1960..(Date.today.year+1), {prompt: 'year'}, class: \"grey-text\") %&gt;\n  &lt;%= f.collection_select :car_brand_id_eq, CarBrand.all, :id, :name, {prompt: 'brand'}, class: \"grey-text\" %&gt;\n  &lt;%= f.collection_select :model_eq, Car.models, :model, :model, {prompt: 'model'}, class: \"grey-text \" %&gt;\n  &lt;%= f.button \"Search\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>I would like to make the form search dynamic, for example, if a user choose a specific year in the form, the next field (:car_brand_id) only returns the options for select which have the year previously selected, an so on with the next fields. Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "jenkins", "time", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501604074, "post_id": 45442807, "comment_id": 77846601, "body": "<i>Sidenote:</i> open source brings an ability to check the code, which is always faster, easier and cleaner, than asking on SO :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1501603989, "creation_date": 1501603989, "answer_id": 45442807, "question_id": 45442086, "link": "https://stackoverflow.com/questions/45442086/since-updating-to-business-time-gem-version-0-9-2-dates-miscalculating/45442807#45442807", "title": "Since updating to business_time gem version 0.9.2 dates miscalculating", "body": "<p>This problem was already fixed in <code>develop</code>, unless it\u2019s released, I would suggest you to either use <code>github: \"bokmann/business_time\", branch: :develop</code> or to downgrade to <code>0.9.1</code>. Here is a diff <a href=\"https://github.com/bokmann/business_time/compare/v0.9.2...develop\" rel=\"nofollow noreferrer\"><code>develop</code>..<code>v0.9.2</code></a>.</p>\n\n<p>Note:</p>\n\n<pre><code> def after(time = Time.current)\n   - positive_days? ? calculate_after(time, @days) : ...\n   + non_negative_days? ? calculate_after(time, @days) : ...\n end\n</code></pre>\n\n<p><code>v0.9.2</code> erroneously introduced step back on zero adjustment.</p>\n"}], "owner": {"reputation": 182, "user_id": 4296703, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6486cfedf121a8932517cdc11b3ceb92?s=128&d=identicon&r=PG&f=1", "display_name": "partydog", "link": "https://stackoverflow.com/users/4296703/partydog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 45442807, "answer_count": 1, "score": 1, "last_activity_date": 1501603989, "creation_date": 1501601821, "question_id": 45442086, "link": "https://stackoverflow.com/questions/45442086/since-updating-to-business-time-gem-version-0-9-2-dates-miscalculating", "title": "Since updating to business_time gem version 0.9.2 dates miscalculating", "body": "<p>I've got a daily smoke test running every morning in multiple environments via Jenkins from around 6 - 8 AM. </p>\n\n<p>Everything was running smoothly until I updated <code>business_time</code> gem to version 0.9.2 from 0.9.1. Now the date calculation I have <code>0.business_days.from_now</code> calculates to <em>yesterday's date</em>. </p>\n\n<p>This only happening in the morning runs. When running in the late morning, after, etc, the date properly calculates to <em>today's date</em></p>\n\n<p>Anyone else experiencing issues with this? I'm assuming I need to change something in <code>config.yml</code> for business hours? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "edited": false, "score": 0, "creation_date": 1501611611, "post_id": 45441651, "comment_id": 77850983, "body": "Check here: <a href=\"https://github.com/rails/rails/issues/25155#issuecomment-222100462\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/25155#issuecomment-222100462</a>, This might help."}, {"owner": {"reputation": 19325, "user_id": 67505, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/094c0ec476b95ed7619d6a4cb918da78?s=128&d=identicon&r=PG", "display_name": "Chen Kinnrot", "link": "https://stackoverflow.com/users/67505/chen-kinnrot"}, "reply_to_user": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "edited": false, "score": 0, "creation_date": 1501664433, "post_id": 45441651, "comment_id": 77872791, "body": "@AtulKhanduri thanks, but this issue is relevant only for concerns, what about module used as namespace without any relation to concerns?"}], "owner": {"reputation": 19325, "user_id": 67505, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/094c0ec476b95ed7619d6a4cb918da78?s=128&d=identicon&r=PG", "display_name": "Chen Kinnrot", "link": "https://stackoverflow.com/users/67505/chen-kinnrot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501600575, "creation_date": 1501600575, "question_id": 45441651, "link": "https://stackoverflow.com/questions/45441651/modules-load-issue-with-upgrading-to-rails-5-1", "title": "modules load Issue with upgrading to rails 5.1", "body": "<p>I got a new issue with module loading when upgraded an app from rails 4.2 to rails 5.1</p>\n\n<p>Consider the following file tree</p>\n\n<pre><code>lib\n-- core\n------- util.rb\n</code></pre>\n\n<p>if util is a class defined like this</p>\n\n<pre><code>module Core \n  class Util \n  end\nend\n</code></pre>\n\n<p>And I write </p>\n\n<pre><code>Core::Util.some_method\n</code></pre>\n\n<p>All good</p>\n\n<p>If Util is a module </p>\n\n<pre><code>module Core \n  module Util \n  end\nend\n</code></pre>\n\n<p>I get an error when trying to reference Core::Util, this didn't happen on rails 4.2.7.</p>\n\n<p>the error I get is </p>\n\n<blockquote>\n  <p>LoadError: Unable to autoload constant Core::Util expected /../lib/core/util.rb to define it.</p>\n</blockquote>\n\n<p>Now if I change the folder structure and put another sub folder called util like this:</p>\n\n<pre><code>lib\n- core\n-- util\n--- util.rb\n</code></pre>\n\n<p>the module Util works fine.</p>\n\n<p>Is there a change in rails, do I need to do something ?</p>\n\n<p>thanks,</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax"], "answers": [{"tags": [], "owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "is_accepted": true, "score": 2, "last_activity_date": 1501600727, "creation_date": 1501600727, "answer_id": 45441690, "question_id": 45441527, "link": "https://stackoverflow.com/questions/45441527/rails-current-user-is-nil-in-ajax-response/45441690#45441690", "title": "Rails: current_user is nil in AJAX response", "body": "<p>It looks like your browser isn't sending the cookie with the fetch request. Try initializing like this:</p>\n\n<pre><code>var myInit = { \n    method: 'GET',\n    headers: myHeaders,\n    credentials: 'same-origin'\n};\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8276455, "user_type": "registered", "profile_image": "https://graph.facebook.com/483205358680686/picture?type=large", "display_name": "Alexander Isora", "link": "https://stackoverflow.com/users/8276455/alexander-isora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 45441690, "answer_count": 1, "score": 0, "last_activity_date": 1501601225, "creation_date": 1501600237, "last_edit_date": 1501601225, "question_id": 45441527, "link": "https://stackoverflow.com/questions/45441527/rails-current-user-is-nil-in-ajax-response", "title": "Rails: current_user is nil in AJAX response", "body": "<p>I want to create a simple AJAX request to my ruby controller, but can not reach <code>current_user</code>.\nThe JS request:</p>\n\n<pre><code>var myHeaders = new Headers();\nmyHeaders.append('X-CSRF-Token', \"P7qiN53QfDGbHjCXdV8BzL8McxgT1lBkXE3WpjP7taydWrF7d+xkZi+b9fG9TC13IMy61jmGK8pzhmdAoHjlZA==\");\nvar myInit = { method: 'GET',\n  headers: myHeaders,\n};\n\nfetch('/get_user_last_activities.json', myInit).then(function(response) {\n  if(response.ok) {\n    console.log(response);\n  }\n  throw new Error('Network response was not ok.');\n});\n</code></pre>\n\n<p>I use the 'omniauth-twitter' and  'omniauth-facebook' gems.</p>\n\n<p>The response tells that <code>current_user</code> is <code>nil</code> \ud83e\udd14\nHow can I teach my controller to access <code>current_user</code> when rendering .json responses?</p>\n"}, {"tags": ["ruby", "protractor", "cucumber"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1501605749, "post_id": 45441286, "comment_id": 77847581, "body": "A keyboard would probably be the best tool for this. There is honestly no functional way to do this as ruby and javascript live in different worlds and serve very different purposes"}, {"owner": {"reputation": 3069, "user_id": 1394981, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8bc6f5d86a2a8d7ed90dea48ca7c67e2?s=128&d=identicon&r=PG", "display_name": "Matt Westlake", "link": "https://stackoverflow.com/users/1394981/matt-westlake"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1501607725, "post_id": 45441286, "comment_id": 77848759, "body": "They both serve the same purpose in this case (running cucumber tests) but I understand they live in different worlds... I just wasn&#39;t sure if a translator has been built or not."}, {"owner": {"reputation": 4007, "user_id": 4741503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQxaj.png?s=128&g=1", "display_name": "Ram Pasala", "link": "https://stackoverflow.com/users/4741503/ram-pasala"}, "edited": false, "score": 0, "creation_date": 1501664643, "post_id": 45441286, "comment_id": 77872960, "body": "<code>cucumber-ruby</code> is written using ruby language and <code>protractor-cucumber</code> is written using node.js (javascript language). Though there are tools to convert ruby to javascript like - <a href=\"http://opalrb.org/\" rel=\"nofollow noreferrer\">opalrb.org</a>. I think its not worth the time. Instead start afresh with writing your scripts using protractor.js &amp; cucumber.js which are built using node.js"}], "owner": {"reputation": 3069, "user_id": 1394981, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8bc6f5d86a2a8d7ed90dea48ca7c67e2?s=128&d=identicon&r=PG", "display_name": "Matt Westlake", "link": "https://stackoverflow.com/users/1394981/matt-westlake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501599516, "creation_date": 1501599516, "question_id": 45441286, "link": "https://stackoverflow.com/questions/45441286/convert-ruby-cucumber-to-protractor-cucumber", "title": "convert ruby cucumber to protractor-cucumber", "body": "<p>Is there is any tooling out there to convert a ruby cucumber test script to protractorjs?  I want to try out a new tool, but need a way to convert ruby cucumber to protractorjs.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 17582, "user_id": 280143, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/46ac5380f2c25f9901f83964916c0226?s=128&d=identicon&r=PG", "display_name": "casraf", "link": "https://stackoverflow.com/users/280143/casraf"}, "edited": false, "score": 3, "creation_date": 1501595930, "post_id": 45439861, "comment_id": 77840869, "body": "SO isn&#39;t a code-writing service, what have you tried so far and where have you not succeeded? Post examples of your code, and try searching on SO/Google before posting"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1501595972, "post_id": 45439861, "comment_id": 77840904, "body": "Several steps: 1) build the UI (records with checkboxes, etc.). 2) in the controller (you&#39;re using rails, I assume?) handle posted form and find all the matching elements, according to checkboxes. 3) Do a mass-update on those records."}], "answers": [{"comments": [{"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1501607322, "post_id": 45439984, "comment_id": 77848528, "body": "Haha @Ursus it seems everyone else has taken it for granted too"}, {"owner": {"reputation": 15, "user_id": 8400088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wrYI2fbkrRY/AAAAAAAAAAI/AAAAAAAADX8/vLkJZu2aRu4/photo.jpg?sz=128", "display_name": "Machael Ellakkis", "link": "https://stackoverflow.com/users/8400088/machael-ellakkis"}, "edited": false, "score": 0, "creation_date": 1501611307, "post_id": 45439984, "comment_id": 77850802, "body": "I am using ruby on rails."}, {"owner": {"reputation": 15, "user_id": 8400088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wrYI2fbkrRY/AAAAAAAAAAI/AAAAAAAADX8/vLkJZu2aRu4/photo.jpg?sz=128", "display_name": "Machael Ellakkis", "link": "https://stackoverflow.com/users/8400088/machael-ellakkis"}, "edited": false, "score": 0, "creation_date": 1501611320, "post_id": 45439984, "comment_id": 77850809, "body": "my code is similar to what you say... is there a way to post my code here/"}, {"owner": {"reputation": 15, "user_id": 8400088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wrYI2fbkrRY/AAAAAAAAAAI/AAAAAAAADX8/vLkJZu2aRu4/photo.jpg?sz=128", "display_name": "Machael Ellakkis", "link": "https://stackoverflow.com/users/8400088/machael-ellakkis"}, "edited": false, "score": 0, "creation_date": 1501611502, "post_id": 45439984, "comment_id": 77850917, "body": "@Ursus &lt;%= check_box_tag &quot;time_cards_to_approve[]&quot;, time_card.id %&gt;"}, {"owner": {"reputation": 15, "user_id": 8400088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wrYI2fbkrRY/AAAAAAAAAAI/AAAAAAAADX8/vLkJZu2aRu4/photo.jpg?sz=128", "display_name": "Machael Ellakkis", "link": "https://stackoverflow.com/users/8400088/machael-ellakkis"}, "edited": false, "score": 0, "creation_date": 1501611554, "post_id": 45439984, "comment_id": 77850937, "body": "@Ursus yet where I try to update all it cannot find the time_cards_ids"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1501611574, "post_id": 45439984, "comment_id": 77850955, "body": "I think you have some problems with the UI"}, {"owner": {"reputation": 15, "user_id": 8400088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wrYI2fbkrRY/AAAAAAAAAAI/AAAAAAAADX8/vLkJZu2aRu4/photo.jpg?sz=128", "display_name": "Machael Ellakkis", "link": "https://stackoverflow.com/users/8400088/machael-ellakkis"}, "edited": false, "score": 0, "creation_date": 1501611590, "post_id": 45439984, "comment_id": 77850968, "body": "@Ursus @time_cards.update_all({status: &#39;Approved&#39;}, {id: params[:time_cards_to_approve]})"}, {"owner": {"reputation": 15, "user_id": 8400088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wrYI2fbkrRY/AAAAAAAAAAI/AAAAAAAADX8/vLkJZu2aRu4/photo.jpg?sz=128", "display_name": "Machael Ellakkis", "link": "https://stackoverflow.com/users/8400088/machael-ellakkis"}, "edited": false, "score": 0, "creation_date": 1501616233, "post_id": 45439984, "comment_id": 77853691, "body": "@Ursus I have updated the question with the code... please help"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 3, "last_activity_date": 1501596312, "last_edit_date": 1501596312, "creation_date": 1501595970, "answer_id": 45439984, "question_id": 45439861, "link": "https://stackoverflow.com/questions/45439861/approve-multiple-records-at-once/45439984#45439984", "title": "approve multiple records at once", "body": "<p>Send these ids to an action like this</p>\n\n<pre><code>Post.where(id: params[:ids]).update_all(approved: true)\n</code></pre>\n\n<p><code>params[:ids]</code> is an array of posts' ids</p>\n\n<p><code>update_all</code> returns the number of the updated records</p>\n\n<p>Ops, I took for granted we were talking about rails but it's never mentioned.</p>\n"}], "owner": {"reputation": 15, "user_id": 8400088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wrYI2fbkrRY/AAAAAAAAAAI/AAAAAAAADX8/vLkJZu2aRu4/photo.jpg?sz=128", "display_name": "Machael Ellakkis", "link": "https://stackoverflow.com/users/8400088/machael-ellakkis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 45439984, "answer_count": 1, "score": 1, "last_activity_date": 1501616264, "creation_date": 1501595662, "last_edit_date": 1501616264, "question_id": 45439861, "link": "https://stackoverflow.com/questions/45439861/approve-multiple-records-at-once", "title": "approve multiple records at once", "body": "<p>how to achieve this Scenario:</p>\n\n<p>admin to select multiple records using a checkbox and click a button to approve selected, which will change the status of the selected items to approved at once. records are like posts.</p>\n\n<h2>here is my code:</h2>\n\n<p>config/routes:</p>\n\n<pre><code>resources :time_cards do\ncollection do\n  get 'management'\n  put 'approve_multiple'\nend\nmember do\n  get 'review'\n  get 'tracking'\n  patch 'approve_or_reject'\nend\n</code></pre>\n\n<p>end</p>\n\n<hr>\n\n<p>html:</p>\n\n<pre><code>    &lt;%= form_tag({controller: 'time_cards', action: 'approve_multiple'}, method: 'put', id: 'approve_multiple_time_card_form') do %&gt;\n      &lt;% @time_cards.each do |time_card| %&gt;\n          &lt;tr&gt;\n            &lt;% if time_card.status.downcase == 'submitted' %&gt;\n                &lt;td&gt;&lt;%= check_box_tag \"time_cards_to_approve[]\", time_card.id %&gt;&lt;/td&gt;\n            &lt;% else %&gt;\n                &lt;td&gt;&amp;nbsp;&lt;/td&gt;\n            &lt;% end %&gt;\n            &lt;td&gt;&lt;%= time_card.id %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= time_card.week_of.to_date.strftime('%B %-d, %Y') %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= time_card.user.name %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= time_card.status %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= output_hours(time_card.time_card_entries) %&gt;&lt;/td&gt;\n            &lt;td&gt;\n              &lt;%= link_to review_time_card_path(time_card) do %&gt;\n                  &lt;% if time_card.status.downcase == 'submitted' %&gt;\n                      &lt;i class=\"material-icons\"&gt;edit&lt;/i&gt;\n                  &lt;% end %&gt;\n              &lt;% end %&gt;\n\n            &lt;/td&gt;\n          &lt;/tr&gt;\n      &lt;% end %&gt;\n      &lt;%= submit_tag \"Approve Selected\", class: 'btn btn-success' %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p>controller:</p>\n\n<pre><code>#PUT /time_cards/approve_multiple\n  def approve_multiple\n    authorize TimeCard\n\n    @time_cards.update_all({status: 'Approved'}, {id: params[:time_cards_to_approve]})\n    respond_to do |format|\n      if !@time_cards.errors\n        format.json { render json: { notice: 'Time cards approved successfully.'} }\n        format.html { redirect_to redirect_to management_time_cards_path, notice: 'Time cards approved successfully.'}\n      else\n        format.json { render json: { error: @time_cards.errors, alert: 'There was a problem approving the time card.'}}\n        format.html { redirect_to management_time_cards_path, alert: @time_cards.errors}\n      end\n    end\n</code></pre>\n\n<h2>      end</h2>\n\n<p>??? I don't no where it is wrong?</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 2272439, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/09fc3f0a0fec024750865851d8c3bf02?s=128&d=identicon&r=PG", "display_name": "dfaulken", "link": "https://stackoverflow.com/users/2272439/dfaulken"}, "edited": false, "score": 0, "creation_date": 1501597584, "post_id": 45440402, "comment_id": 77842283, "body": "Ugh missed that, thanks! That&#39;s what happens when I do method abstraction too quickly..."}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 2, "last_activity_date": 1501597159, "creation_date": 1501597159, "answer_id": 45440402, "question_id": 45439673, "link": "https://stackoverflow.com/questions/45439673/rspec-mocking-name-not-available-from-within-an-example-group/45440402#45440402", "title": "RSpec mocking, `name` not available from within an example group", "body": "<p><code>name</code> is not a keyword <code>RSpec</code> method, it's a method that <code>report_deviation</code> is trying to call</p>\n\n<pre><code>file.puts \"#{timestamp}, #{name}: Run #{run_id} (#{headsign}), deviation #{deviation}\"\n</code></pre>\n\n<p>but the method is not defined.</p>\n\n<p>You need to define the <code>name</code> method in the class where <code>report_deviation</code> is defined. Or, if <code>report_deviation</code> is defined and used in the spec file, add a simple variable called <code>name</code>:</p>\n\n<pre><code>describe 'report_deviation' do\n  let(:departure) { double }\n  let(:trip) { double }\n  let(:file) { double }\n  let(:name) { \"simple name\" }\n  ...\n</code></pre>\n"}], "owner": {"reputation": 306, "user_id": 2272439, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/09fc3f0a0fec024750865851d8c3bf02?s=128&d=identicon&r=PG", "display_name": "dfaulken", "link": "https://stackoverflow.com/users/2272439/dfaulken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1276, "favorite_count": 0, "accepted_answer_id": 45440402, "answer_count": 1, "score": 0, "last_activity_date": 1501597159, "creation_date": 1501595148, "question_id": 45439673, "link": "https://stackoverflow.com/questions/45439673/rspec-mocking-name-not-available-from-within-an-example-group", "title": "RSpec mocking, `name` not available from within an example group", "body": "<p>I have the following Ruby code:</p>\n\n<pre><code>def report_deviation(departure)\n  deviation = departure.fetch('Dev')\n  trip = departure.fetch('Trip')\n  run_id = trip.fetch('RunId')\n  headsign = trip.fetch('InternetServiceDesc')\n  timestamp = Time.now.strftime '%l:%M %P'\n  FileUtils.mkdir 'log' unless File.directory? 'log'\n  File.open DAILY_LOG_FILE, 'a' do |file|\n    file.puts \"#{timestamp}, #{name}: Run #{run_id} (#{headsign}), deviation #{deviation}\"\n  end\nend\n</code></pre>\n\n<p>Tested by the following RSpec code:</p>\n\n<pre><code>describe 'report_deviation' do\n  let(:departure) { double }\n  let(:trip) { double }\n  let(:file) { double }\n  it 'appends to a log file with the correct entry format' do\n    expect(departure).to receive(:fetch).with('Trip').and_return trip\n    expect(departure).to receive(:fetch).with('Dev').and_return 'DEVIATION'\n    expect(trip).to receive(:fetch).with('RunId')\n      .and_return 'RUN'\n    expect(trip).to receive(:fetch).with('InternetServiceDesc')\n      .and_return 'HEADSIGN'\n    stub_const 'DeviationValidator::DAILY_LOG_FILE', :log_file\n    expect(File).to receive(:open).with(:log_file, 'a').and_yield file\n    timestamp = '12:00 pm: Run RUN (HEADSIGN), deviation DEVIATION'\n    expect(file).to receive(:puts).with timestamp\n    Timecop.freeze(Time.new 2017, 7, 31, 12) { report_deviation(departure) }\n  end\nend\n</code></pre>\n\n<p>But when I run I receive the failure message:</p>\n\n<pre><code>`name` is not available from within an example (e.g. an `it` block) or from constructs that run in the scope of an example (e.g. `before`, `let`, etc). It is only available on an example group (e.g. a `describe` or `context` block).\n</code></pre>\n\n<p>The word <code>name</code> isn't written anywhere in here, and if I remove the final line of the test (which invokes the actual code) I get the test failures I would expect for unsatisfied exceptions. I normally would boil my code down to the pieces that are causing the error, but I have no idea what's causing the error.</p>\n\n<p>For what it's worth, the specific line number mentioned in the backtrace is the <code>file.puts</code> within the <code>File.open</code> block - but I don't understand why that should cause a failure. I've set up test doubles such that those objects are nothing special - <code>File</code> receives <code>open</code> and yields <code>file</code>, whose only job is to listen for receiving <code>puts</code> with the string I expect. So what piece of code is calling what happens to be a keyword RSpec method <code>name</code>?</p>\n"}, {"tags": ["ruby", "enumeration"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501594197, "post_id": 45438960, "comment_id": 77839389, "body": "Where do the key names in your hash come from?"}, {"owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1501594301, "post_id": 45438960, "comment_id": 77839462, "body": "Scraped values from fields in a table which do not match the attrs of the model I&#39;m trying to save them in, thus my manually having to rename them to fit my model attrs."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1501594475, "post_id": 45438960, "comment_id": 77839604, "body": "It would be safer to have an explicit mapping in that case, i.e. <code>{ field1: :address1, field2: :address2, ... }</code> instead of relying on the field&#39;s offset."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501595925, "post_id": 45438960, "comment_id": 77840862, "body": "I don&#39;t know if there is a way to replace actual keys of a hash?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1501596551, "post_id": 45438960, "comment_id": 77841424, "body": "@sagarpandya82 only by modifying the key objects and calling <code>rehash</code>. But symbols are always immutable and even string keys can&#39;t be modified because they are frozen beforehand. In general, hash keys are not supposed to change."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1501608342, "post_id": 45438960, "comment_id": 77849145, "body": "Since Ruby v1.9 it has been guaranteed that hash keys are ordered by their time of insertion. That property can be useful in some situations, though many Rubiests always treat hash keys as unordered, reflecting the origins of the concept of a hash. What you want to do, however, is fraught with peril. My advice: don&#39;t do that! If you want to change the keys use a hash for mapping them, as @Stefan suggests. If that&#39;s not practical, reorganize your code."}], "answers": [{"comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 3, "creation_date": 1501594741, "post_id": 45439091, "comment_id": 77839832, "body": "Or <code>map.with_index</code>."}, {"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "reply_to_user": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1501595134, "post_id": 45439091, "comment_id": 77840157, "body": "Nice one @Ilya!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1501597349, "post_id": 45439091, "comment_id": 77842118, "body": "<code>map.with_index</code> corresponds to the block argument order <code>|(k, v), i|</code> whereas <code>each_with_index.map</code> seems swapped at first glance."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1501601127, "post_id": 45439091, "comment_id": 77844725, "body": "It&#39;s OP&#39;S problem, but the whole conversion is a bit brittle."}], "tags": [], "owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "is_accepted": true, "score": 3, "last_activity_date": 1501593756, "creation_date": 1501593756, "answer_id": 45439091, "question_id": 45438960, "link": "https://stackoverflow.com/questions/45438960/how-to-replace-a-hashs-key-names-with-the-values-from-a-separate-array/45439091#45439091", "title": "How to replace a Hash&#39;s key names with the values from a separate array?", "body": "<pre><code>hash = {field1: 'name', field2: 'street1', field3: 'street2', field4: 'city'}\narray = [:address1, :address2, :address3, :city]\nhash.each_with_index.map { |(k, v), i| [array[i], v] }.to_h\n#=&gt; {:address1=&gt;\"name\", :address2=&gt;\"street1\", :address3=&gt;\"street2\", :city=&gt;\"city\"}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "edited": false, "score": 0, "creation_date": 1501594389, "post_id": 45439300, "comment_id": 77839533, "body": "Hmm, even nicer than the :each_with_index, but bugger answer already accepted."}, {"owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "edited": false, "score": 1, "creation_date": 1501594861, "post_id": 45439300, "comment_id": 77839928, "body": ";) Let me play and see which one i end up using \ud83d\udc4d\ud83c\udffc"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1501595112, "post_id": 45439300, "comment_id": 77840139, "body": "Prefer <code>to_h</code> :)"}], "tags": [], "owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "is_accepted": false, "score": 4, "last_activity_date": 1501594247, "creation_date": 1501594247, "answer_id": 45439300, "question_id": 45438960, "link": "https://stackoverflow.com/questions/45438960/how-to-replace-a-hashs-key-names-with-the-values-from-a-separate-array/45439300#45439300", "title": "How to replace a Hash&#39;s key names with the values from a separate array?", "body": "<pre><code>hash = {field1: 'name', field2: 'street1', field3: 'street2', field4: 'city'}\narray = [:address1, :address2, :address3, :city]\n\nh = Hash[array.zip hash.values]\n# =&gt; {:address1=&gt;\"name\", :address2=&gt;\"street1\", :address3=&gt;\"street2\", :city=&gt;\"city\"}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1501606747, "post_id": 45439923, "comment_id": 77848160, "body": "...or <code>hash.map { |k,v| [attrs[k], v] }.to_h</code>.These both assume <code>attrs</code> and <code>hash</code> have the same keys. If <code>attrs</code> may contain only some of <code>hash.keys</code>  and/or some keys that <code>hash</code> doesn&#39;t have,  <code>hash.map { |k,v| [attrs.key?(k) ? attrs[k] : k, v] }.to_h</code> (or <code>[attrs[k] || k, v]</code>) if no keys of <code>hash</code> are <code>nil</code>)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501607038, "post_id": 45439923, "comment_id": 77848339, "body": "@CarySwoveland instead of <code>attrs[k] || k</code>, there&#39;s also <code>attrs.fetch(k, k)</code> which will even work for <code>nil</code> and <code>false</code> values."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501607444, "post_id": 45439923, "comment_id": 77848598, "body": "Yes, I like that better. Hadn&#39;t thought about it working with <code>false</code> and <code>nil</code>."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 3, "last_activity_date": 1501596859, "last_edit_date": 1501596859, "creation_date": 1501595834, "answer_id": 45439923, "question_id": 45438960, "link": "https://stackoverflow.com/questions/45438960/how-to-replace-a-hashs-key-names-with-the-values-from-a-separate-array/45439923#45439923", "title": "How to replace a Hash&#39;s key names with the values from a separate array?", "body": "<p>Your code depends on the order of the scraped table (or the order you are scraping the data off the table), which seems a little brittle. I would use an explicit mapping from table field names to model attribute names (or vice-versa, it doesn't really matter for a 1:1 mapping):</p>\n\n<pre><code>attrs = {\n  :field1 =&gt; :address1,\n  :field2 =&gt; :address2,\n  :field3 =&gt; :address3,\n  :field4 =&gt; :city\n}\n</code></pre>\n\n<p>Given a hash:</p>\n\n<pre><code>hash = { field1: 'name', field2: 'street1', field3: 'street2', field4: 'city' }\n</code></pre>\n\n<p>it can be converted via:</p>\n\n<pre><code>attrs.map { |k, v| [v, hash[k]] }.to_h\n#=&gt; {:address1=&gt;\"name\", :address2=&gt;\"street1\", :address3=&gt;\"street2\", :city=&gt;\"city\"}\n</code></pre>\n"}], "owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 45439091, "answer_count": 3, "score": -1, "last_activity_date": 1501596859, "creation_date": 1501593366, "last_edit_date": 1501594922, "question_id": 45438960, "link": "https://stackoverflow.com/questions/45438960/how-to-replace-a-hashs-key-names-with-the-values-from-a-separate-array", "title": "How to replace a Hash&#39;s key names with the values from a separate array?", "body": "<p>I have a hash, e.g.:</p>\n\n<pre><code>hash = {field1: 'name', field2: 'street1', field3: 'street2', field4: 'city'}\n</code></pre>\n\n<p>and I would like to replace all of the key names with the values I have in a separate array, e.g.:</p>\n\n<pre><code>array = [:address1, :address2, :address3, :city]\n</code></pre>\n\n<p>How could I most nicely acheive this in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501592913, "post_id": 45438314, "comment_id": 77838374, "body": "What should happen if only some parameters are present, e.g. just <code>tlat</code> and <code>blong</code>?"}, {"owner": {"reputation": 1397, "user_id": 7196495, "user_type": "registered", "profile_image": "https://graph.facebook.com/930216313790047/picture?type=large", "display_name": "Alex Borodin", "link": "https://stackoverflow.com/users/7196495/alex-borodin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501593009, "post_id": 45438314, "comment_id": 77838437, "body": "@Stefan I think that controller should return all records."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1501593164, "post_id": 45438314, "comment_id": 77838550, "body": "So you have to check if all parameters are present and return <code>Places.all</code> otherwise, just like in your example."}], "answers": [{"comments": [{"owner": {"reputation": 1397, "user_id": 7196495, "user_type": "registered", "profile_image": "https://graph.facebook.com/930216313790047/picture?type=large", "display_name": "Alex Borodin", "link": "https://stackoverflow.com/users/7196495/alex-borodin"}, "edited": false, "score": 0, "creation_date": 1501592950, "post_id": 45438423, "comment_id": 77838397, "body": "Thanks, I&#39;ve added the query, may be it will be more understandable. As I understand Rails have no dedicated method &quot;choose by params if exist, else choose all&quot;, and I should check an existence of params anyway. Am I right?"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 1397, "user_id": 7196495, "user_type": "registered", "profile_image": "https://graph.facebook.com/930216313790047/picture?type=large", "display_name": "Alex Borodin", "link": "https://stackoverflow.com/users/7196495/alex-borodin"}, "edited": false, "score": 1, "creation_date": 1501593177, "post_id": 45438423, "comment_id": 77838557, "body": "@AlexanderBorodin No there is no implicit way to tell Rails &quot;if this params is present, use it, otherwise ignore it&quot; because <code>nil</code> is not nothing, if you do <code>Place.where(attr: params[:attr])</code> and <code>params[:attr]</code> is <code>nil</code>, then the SQL query will look for Places where the <code>attr IS NULL</code>. You may be able to find a gem to do what you are looking for, or build something yourself (I can help you with that) to fit your requirements."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 1397, "user_id": 7196495, "user_type": "registered", "profile_image": "https://graph.facebook.com/930216313790047/picture?type=large", "display_name": "Alex Borodin", "link": "https://stackoverflow.com/users/7196495/alex-borodin"}, "edited": false, "score": 0, "creation_date": 1501593587, "post_id": 45438423, "comment_id": 77838908, "body": "<code>has_scope</code> does exactly this, but it requires that you have <code>scope</code>s defined for each param you want to use it with @AlexanderBorodin"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501594277, "post_id": 45438423, "comment_id": 77839444, "body": "wouldn&#39;t this execute a separate database query for each <code>where</code> clause?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 1, "creation_date": 1501594322, "post_id": 45438423, "comment_id": 77839478, "body": "Nope @m.simonborg. Just build the query dinamically. It runs the query when you access the resultset"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1501594988, "post_id": 45438423, "comment_id": 77840037, "body": "In this case the only query would run probably in the view. Not with the all method, nor with the where method."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1501592003, "creation_date": 1501592003, "answer_id": 45438423, "question_id": 45438314, "link": "https://stackoverflow.com/questions/45438314/how-to-query-records-with-and-without-params-in-rails/45438423#45438423", "title": "How to query records with and without params in Rails?", "body": "<p>I'd do something like this if possible. Important to note the this is just one query, composed dynamically.</p>\n\n<pre><code>@places = Place.all\n%i(tlat tlong blat blong).each do |field|\n  if params[field].present?\n    @places = @places.where(field =&gt; params[field]) \n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 1, "creation_date": 1501593083, "post_id": 45438828, "comment_id": 77838493, "body": "or <code>if params.values_at(:blat, :tlat).all?(&amp;:present?)</code>"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 1, "creation_date": 1501593308, "post_id": 45438828, "comment_id": 77838676, "body": "@Ursus I prefer code readability over tiny gain of performances, but yeah that would also works"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1501593485, "post_id": 45438828, "comment_id": 77838830, "body": "Mine is probably slower but if you have three or four params to check that become a very long line :D"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1501593973, "post_id": 45438828, "comment_id": 77839204, "body": "I agree with you, especially when you know that a line of code should be 120 characters max... (looking at you rubocop!)"}], "tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": true, "score": 2, "last_activity_date": 1501593007, "creation_date": 1501593007, "answer_id": 45438828, "question_id": 45438314, "link": "https://stackoverflow.com/questions/45438314/how-to-query-records-with-and-without-params-in-rails/45438828#45438828", "title": "How to query records with and without params in Rails?", "body": "<p>If you want to set WHERE clauses depending on params, you can use Ursus' code which is fine. </p>\n\n<p>However, if you need to apply those WHERE clauses only if a set of params are present, you can use the following:</p>\n\n<pre><code>@places = Place.all\nif params[:blat].present? &amp;&amp; params[:tlat].present?\n  @places = @places.where(blat: params[:blat], tlat: params[:tlat])\nend\n# etc.\n</code></pre>\n\n<p>You could use an array of arrays to pair the associated params, kind of like what Ursus did.</p>\n"}, {"comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501606416, "post_id": 45439261, "comment_id": 77847999, "body": "the Rails&#39; way is skinny controllers - fat models, so this would be a scope in the model which could handle the <code>nil</code> values. Best would be a QueryObject, but that&#39;s a whole new debate... ahahah"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1501608507, "post_id": 45439261, "comment_id": 77849239, "body": "@MrYoshiji I agree, this was just easier to quickly illustrate. I&#39;ll update the answer to better represent the real rails way"}], "tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": false, "score": 1, "last_activity_date": 1501608976, "last_edit_date": 1501608976, "creation_date": 1501594151, "answer_id": 45439261, "question_id": 45438314, "link": "https://stackoverflow.com/questions/45438314/how-to-query-records-with-and-without-params-in-rails/45439261#45439261", "title": "How to query records with and without params in Rails?", "body": "<p>IMO, truly the \"Rails way\" (but actually just the \"Ruby way\") would be to extract this long conditional, and the query itself, out to their own private method. It becomes much easier to understand what's going on in the <code>index</code> action</p>\n\n<pre><code>class MyController &lt; ApplicationController\n  def index\n    @places = Place.all\n    apply_geo_scope if geo_params_present?\n  end\n\n  private\n\n  def geo_params_present?\n    !!(params[:tlat] &amp;&amp; params[:blat] &amp;&amp; params[:tlong] &amp;&amp; params[:blong])\n  end\n\n  # A scope in the model would be better than defining this in the controller\n  def apply_geo_scope\n    %i(tlat tlong blat blong).each do |field|\n      @places = @places.where(field =&gt; params[field]) \n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1397, "user_id": 7196495, "user_type": "registered", "profile_image": "https://graph.facebook.com/930216313790047/picture?type=large", "display_name": "Alex Borodin", "link": "https://stackoverflow.com/users/7196495/alex-borodin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 45438828, "answer_count": 3, "score": 1, "last_activity_date": 1501608976, "creation_date": 1501591756, "last_edit_date": 1501592696, "question_id": 45438314, "link": "https://stackoverflow.com/questions/45438314/how-to-query-records-with-and-without-params-in-rails", "title": "How to query records with and without params in Rails?", "body": "<p>I have model Places and I have the index method in a controller. I need to get all places via request</p>\n\n<pre><code>/places\n</code></pre>\n\n<p>And filter places via request with query</p>\n\n<pre><code>/places?tlat=xxxx&amp;tlong=xxxx&amp;blat=xxxxx&amp;blong=xxxx\n</code></pre>\n\n<p>What the best way to get this records? Should I check an existence of each param or are there Rails way?</p>\n\n<pre><code>@places = if params[tlat]&amp;&amp;params[blat]....\n  Places.all.where(\"lat &gt; ? AND long &gt; ? AND lat &lt; ? AND long &lt; ?\", tlat, tlong, blat, blong)\nelse\n  Places.all\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "edited": false, "score": 0, "creation_date": 1501588733, "post_id": 45437152, "comment_id": 77835167, "body": "and the error is?"}, {"owner": {"reputation": 1, "user_id": 8399435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20922d122c35c34f84e2b7989e1bfed?s=128&d=identicon&r=PG", "display_name": "Arjun Singh", "link": "https://stackoverflow.com/users/8399435/arjun-singh"}, "reply_to_user": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "edited": false, "score": 0, "creation_date": 1501589033, "post_id": 45437152, "comment_id": 77835372, "body": "Error is No route matches [GET] &quot;/wallpapers/2/like&quot;"}, {"owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "edited": false, "score": 2, "creation_date": 1501589153, "post_id": 45437152, "comment_id": 77835457, "body": "with the full backtrace, please"}, {"owner": {"reputation": 696, "user_id": 4745028, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PV2HK.jpg?s=128&g=1", "display_name": "Sathishkumar Jayaraj", "link": "https://stackoverflow.com/users/4745028/sathishkumar-jayaraj"}, "edited": false, "score": 0, "creation_date": 1501589402, "post_id": 45437152, "comment_id": 77835639, "body": "@ArjunSingh Run <code>rake routes</code> in you terminal. It shows the list of routes with parameters and type. Check whether the requested routes are available or not."}, {"owner": {"reputation": 7240, "user_id": 327201, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0ee53216660fae93d26f8dcaba3945a0?s=128&d=identicon&r=PG", "display_name": "Ramon Snir", "link": "https://stackoverflow.com/users/327201/ramon-snir"}, "edited": false, "score": 0, "creation_date": 1501589690, "post_id": 45437152, "comment_id": 77835856, "body": "Could it be that your browser has JavaScript disabled? Or you&#39;re not using the link with a simple left-mouse-button click? link_to&#39;s documentation on the :method option is: <code>Supported verbs are :post, :delete, :patch, and :put. Note that if the user has JavaScript disabled, the request will fall back to using GET.</code>"}, {"owner": {"reputation": 1, "user_id": 8399435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20922d122c35c34f84e2b7989e1bfed?s=128&d=identicon&r=PG", "display_name": "Arjun Singh", "link": "https://stackoverflow.com/users/8399435/arjun-singh"}, "edited": false, "score": 0, "creation_date": 1501589719, "post_id": 45437152, "comment_id": 77835874, "body": "I have ran rake routes it shows the like_wallpaper POST   /wallpapers/:id/like(.:format) wallpapers#like"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1501589898, "post_id": 45437152, "comment_id": 77836000, "body": "Please add full error log."}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 5476928, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-z1x_51bzkXI/AAAAAAAAAAI/AAAAAAAAAHk/rlPnC73wMjw/photo.jpg?sz=128", "display_name": "shruti gupta", "link": "https://stackoverflow.com/users/5476928/shruti-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1501590188, "creation_date": 1501590188, "answer_id": 45437689, "question_id": 45437152, "link": "https://stackoverflow.com/questions/45437152/i-am-defining-post-method-in-link-to-but-i-am-getting-routing-error-for-get-i/45437689#45437689", "title": "I am defining post method in link_to but i am getting routing error for get , i have defined a post route", "body": "<p>Instead of just <code>method: :post</code> write <code>data: { method: 'post' }</code>. So your link should look like</p>\n\n<pre><code>&lt;%= link_to like_wallpaper_path(@wallpaper), data: { method: 'post' }  do %&gt;\n    &lt;i class=\"glyphicon glyphicon-thumbs-up\"&gt;&lt;/i&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8399435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20922d122c35c34f84e2b7989e1bfed?s=128&d=identicon&r=PG", "display_name": "Arjun Singh", "link": "https://stackoverflow.com/users/8399435/arjun-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572611351, "creation_date": 1501588585, "last_edit_date": 1572611351, "question_id": 45437152, "link": "https://stackoverflow.com/questions/45437152/i-am-defining-post-method-in-link-to-but-i-am-getting-routing-error-for-get-i", "title": "I am defining post method in link_to but i am getting routing error for get , i have defined a post route", "body": "<p>I have defined a post route in my routes.rb and using it in <code>link_to</code> helper. When I click the link generated by <code>link_to</code> helper, I am getting an error that is suppose to be an error for get method.</p>\n\n<pre><code>Started GET \"/wallpapers/1/like?like=true\" for 127.0.0.1 at 2017-08-03 12:51:59 +0530\n\nActionController::RoutingError (No route matches [GET] \"/wallpapers/1/like\"):\n\nactionpack (5.0.4) lib/action_dispatch/middleware/debug_exceptions.rb:53:in `call'\nweb-console (3.5.1) lib/web_console/middleware.rb:135:in `call_app'\nweb-console (3.5.1) lib/web_console/middleware.rb:28:in `block in call'\nweb-console (3.5.1) lib/web_console/middleware.rb:18:in `catch'\nweb-console (3.5.1) lib/web_console/middleware.rb:18:in `call'\nactionpack (5.0.4) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'\nrailties (5.0.4) lib/rails/rack/logger.rb:36:in `call_app'\nrailties (5.0.4) lib/rails/rack/logger.rb:24:in `block in call'\nactivesupport (5.0.4) lib/active_support/tagged_logging.rb:69:in `block in tagged'\nactivesupport (5.0.4) lib/active_support/tagged_logging.rb:26:in `tagged'\nactivesupport (5.0.4) lib/active_support/tagged_logging.rb:69:in `tagged'\nrailties (5.0.4) lib/rails/rack/logger.rb:24:in `call'\nsprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'\nactionpack (5.0.4) lib/action_dispatch/middleware/request_id.rb:24:in `call'\nrack (2.0.3) lib/rack/method_override.rb:22:in `call'\nrack (2.0.3) lib/rack/runtime.rb:22:in `call'\nactivesupport (5.0.4) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'\nactionpack (5.0.4) lib/action_dispatch/middleware/executor.rb:12:in `call'\nactionpack (5.0.4) lib/action_dispatch/middleware/static.rb:136:in `call'\nrack (2.0.3) lib/rack/sendfile.rb:111:in `call'\nrailties (5.0.4) lib/rails/engine.rb:522:in `call'\npuma (3.9.1) lib/puma/configuration.rb:224:in `call'\npuma (3.9.1) lib/puma/server.rb:602:in `handle_request'\npuma (3.9.1) lib/puma/server.rb:435:in `process_client'\npuma (3.9.1) lib/puma/server.rb:299:in `block in run'\npuma (3.9.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'\n  Rendering C:/RailsInstaller/Ruby2.3.0/lib/ruby/gems/2.3.0/gems/actionpack-5.0.4/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout\n  Rendering C:/RailsInstaller/Ruby2.3.0/lib/ruby/gems/2.3.0/gems/actionpack-5.0.4/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb\n  Rendered C:/RailsInstaller/Ruby2.3.0/lib/ruby/gems/2.3.0/gems/actionpack-5.0.4/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.5ms)\n  Rendered collection of C:/RailsInstaller/Ruby2.3.0/lib/ruby/gems/2.3.0/gems/actionpack-5.0.4/lib/action_dispatch/middleware/templates/routes/_route.html.erb [11 times] (3.5ms)\n  Rendered C:/RailsInstaller/Ruby2.3.0/lib/ruby/gems/2.3.0/gems/actionpack-5.0.4/lib/action_dispatch/middleware/templates/routes/_table.html.erb (5.0ms)\n  Rendering C:/RailsInstaller/Ruby2.3.0/lib/ruby/gems/2.3.0/gems/actionpack-5.0.4/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb\n  Rendered C:/RailsInstaller/Ruby2.3.0/lib/ruby/gems/2.3.0/gems/actionpack-5.0.4/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.5ms)\n  Rendered C:/RailsInstaller/Ruby2.3.0/lib/ruby/gems/2.3.0/gems/actionpack-5.0.4/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (1391.8ms)\n</code></pre>\n\n<p><strong>my routes.rb file</strong></p>\n\n<pre><code>Rails.application.routes.draw do  \n  root 'pages#home'\n  get '/home', to: 'pages#home'\n\n  resources :wallpapers do\n    member do  \n      post 'like'\n    end\n  end\nend\n</code></pre>\n\n<p><strong>my link_to</strong></p>\n\n<pre><code>&lt;%= link_to like_wallpaper_path(@wallpaper), :method =&gt; :post  do %&gt;\n  &lt;i class=\"glyphicon glyphicon-thumbs-up\"&gt;&lt;/i&gt;\n&lt;% end %&gt; \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "solidus"], "comments": [{"owner": {"reputation": 474, "user_id": 5379362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38f95f8ddc8d16b7945bccd6ba76e00?s=128&d=identicon&r=PG&f=1", "display_name": "Fede Bonisconti", "link": "https://stackoverflow.com/users/5379362/fede-bonisconti"}, "edited": false, "score": 0, "creation_date": 1501587741, "post_id": 45436514, "comment_id": 77834407, "body": "It cannot find the defined method within you class_eval&#39;s block. How are you calling the decorator to add these methods? You should use a module to include them."}], "answers": [{"tags": [], "owner": {"reputation": 185, "user_id": 3240728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86121ae6841b84c857ab339c0ef581ec?s=128&d=identicon&r=PG&f=1", "display_name": "The user without number", "link": "https://stackoverflow.com/users/3240728/the-user-without-number"}, "is_accepted": true, "score": 1, "last_activity_date": 1501587653, "creation_date": 1501587653, "answer_id": 45436815, "question_id": 45436514, "link": "https://stackoverflow.com/questions/45436514/ruby-check-if-controller-defined/45436815#45436815", "title": "Ruby - Check if controller defined", "body": "<p>This worked in the end:</p>\n\n<pre><code>def class_defined?(klass)\n  Object.const_get(klass)\nrescue\n  false\nend\n\nif class_defined? 'Spree::Api::MeController'\n ....\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": false, "score": 1, "last_activity_date": 1501592148, "creation_date": 1501592148, "answer_id": 45438484, "question_id": 45436514, "link": "https://stackoverflow.com/questions/45436514/ruby-check-if-controller-defined/45438484#45438484", "title": "Ruby - Check if controller defined", "body": "<p><code>if defined?</code> should do exactly what you want it to do in theory. The problem is you're checking <code>if defined? Spree::Api::MeController.class</code>. The <code>#class</code> of your class is <code>Class</code>. So what you're really getting is <code>if defined? Class</code> which will always be true!</p>\n\n<p>This issue is most likely not that the conditional is failing but that it's never getting read. Rails lazy loads most of the code you write, meaning the file is not read until it's called somewhere in execution.</p>\n\n<p>The decorator module should just contain the methods you want to add, without the conditionals or the use of <code>class_eval</code>. Then in the original <code>class</code> you can include it.</p>\n\n<pre><code>module Spree\n  module Api\n    class MeController &lt; Spree::Api::BaseController\n      include MeDecorator\n    end\n  end\nend\n</code></pre>\n\n<p>If for any reason you're not certain <code>MeDecorator</code> will be defined, don't use <code>defined?</code>, because <code>defined? MeDecorator</code> will not actually go looking for it if it's not defined and load the necessary file. It will return <code>nil</code> if the constant has no value. Just <code>rescue</code> a <code>NameError</code></p>\n\n<pre><code>module Spree\n  module Api\n    class MeController &lt; Spree::Api::BaseController\n      begin\n        include MeDecorator\n      rescue NameError =&gt; e\n        logger.error e\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 3240728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86121ae6841b84c857ab339c0ef581ec?s=128&d=identicon&r=PG&f=1", "display_name": "The user without number", "link": "https://stackoverflow.com/users/3240728/the-user-without-number"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 1, "accepted_answer_id": 45436815, "answer_count": 2, "score": 1, "last_activity_date": 1501592148, "creation_date": 1501586780, "question_id": 45436514, "link": "https://stackoverflow.com/questions/45436514/ruby-check-if-controller-defined", "title": "Ruby - Check if controller defined", "body": "<p>I am using Solidus with Ruby on Rails to create a webshop and I have multiple modules for that webshop. </p>\n\n<p>So, I defined a me controller into an module called 'solidus_jwt_auth' with the followin code:</p>\n\n<pre><code>module Spree\n  module Api\n    class MeController &lt; Spree::Api::BaseController\n      def index\n        ...\n      end\n\n      def orders\n        ...\n      end\n\n      def addresses\n        ...\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I want to extend this in another module called 'solidus_prescriptions' so I created a decorator for this with the following code <code>me_decorator</code>:</p>\n\n<pre><code>if defined? Spree::Api::MeController.class\n  Spree::Api::MeController.class_eval do\n    def prescriptions\n      ...\n    end\n\n    def create_prescription\n      ...\n    end\n\n    private\n\n    def prescription_params\n      params.require(:prescription).permit(\n          *Spree::CustomerPrescription.permitted_attributes\n      )\n    end\n  end\nend\n</code></pre>\n\n<p>And for this I wrote unit tests in solidus_prescription module and integration tests in webshop. The unit tests are working fine, but the integration tests are giving the following error:</p>\n\n<p><strong>Error:\nMeEndpointsTest#test_me/prescriptions_post_endpoint_throws_an_error_when_wrong_params:\nAbstractController::ActionNotFound: The action 'create_prescription' could not be found for Spree::Api::MeController\n    test/integration/me_endpoints_test.rb:68:in `block in '</strong></p>\n\n<p>Which means that he can not find the MeController defined in another module. How can I make the check if the MeController is defined since the code bellow does not help me with anything:</p>\n\n<pre><code>if defined? Spree::Api::MeController.class\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "date", "datetime"], "comments": [{"owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 1, "creation_date": 1501586248, "post_id": 45436232, "comment_id": 77833290, "body": "Will something like this work for you: <code>where(&#39;DATE(start) = ?&#39;, start_date.to_date)</code> and are you on Rails 5.1?"}], "answers": [{"comments": [{"owner": {"reputation": 414, "user_id": 6556383, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-rFjQCuJsaAk/AAAAAAAAAAI/AAAAAAAAEio/VDKKrZfNTtM/photo.jpg?sz=128", "display_name": "dendomenko", "link": "https://stackoverflow.com/users/6556383/dendomenko"}, "edited": false, "score": 0, "creation_date": 1501586970, "post_id": 45436447, "comment_id": 77833807, "body": "Thanks, database field must have datetime type because in this field I store start date and start time"}], "tags": [], "owner": {"reputation": 13091, "user_id": 385532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/082cc70175616a7f63b134a741c5d6e3?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/385532/matt"}, "is_accepted": true, "score": 13, "last_activity_date": 1501591343, "last_edit_date": 1501591343, "creation_date": 1501586587, "answer_id": 45436447, "question_id": 45436232, "link": "https://stackoverflow.com/questions/45436232/rails-convert-datetime-to-date-in-where-query/45436447#45436447", "title": "Rails convert DateTime to date in &#39;where&#39; query", "body": "<p>If you want to cast the database value to a date you'll have to do different things for different database servers, like the following for mysql:</p>\n\n<pre><code>scope :day, -&gt; (start_date) {where(\"DATE(start_date) = ?\", start_date)}\n</code></pre>\n\n<p>May therefore be more sensible to cast your start_date argument to a datetime:</p>\n\n<pre><code>scope :day, -&gt; (start_date) {where start_date: start_date.to_datetime}\n</code></pre>\n\n<p>Also, BigRon <a href=\"https://stackoverflow.com/a/45436474/385532\">posted</a> an excellent approach to filter between start and end of day and Deep <a href=\"https://stackoverflow.com/a/45436533/385532\">posted</a> a helper for Rails 5.1 that streamlines that approach further, but you really should consider whether your database column actually needs to be datetime if you want to filter by date alone.</p>\n"}, {"tags": [], "owner": {"reputation": 2594, "user_id": 2628223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dbHga.jpg?s=128&g=1", "display_name": "BigRon", "link": "https://stackoverflow.com/users/2628223/bigron"}, "is_accepted": false, "score": 6, "last_activity_date": 1501586672, "creation_date": 1501586672, "answer_id": 45436474, "question_id": 45436232, "link": "https://stackoverflow.com/questions/45436232/rails-convert-datetime-to-date-in-where-query/45436474#45436474", "title": "Rails convert DateTime to date in &#39;where&#39; query", "body": "<p>You can use a range for the beginning of the day to the end of the day: </p>\n\n<pre><code>scope :day, -&gt; (start_date) {where start_date: start_date.beginning_of_day..start_date.end_of_day}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "is_accepted": false, "score": 16, "last_activity_date": 1501587243, "last_edit_date": 1501587243, "creation_date": 1501586806, "answer_id": 45436533, "question_id": 45436232, "link": "https://stackoverflow.com/questions/45436232/rails-convert-datetime-to-date-in-where-query/45436533#45436533", "title": "Rails convert DateTime to date in &#39;where&#39; query", "body": "<p>You may do it like this:</p>\n\n<p>Using SQL Date Function (depends on database this is for <code>MySQL</code>):</p>\n\n<pre><code>scope :on_day -&gt; (start_date) { where(\"DATE(start_date) = ?\", start_date.to_date) }\n</code></pre>\n\n<p>Or using range (so this will check using date and time both just using the start and end time of the day and executing a <code>BETWEEN</code> query):</p>\n\n<pre><code>scope :day, -&gt; (start_date) { where start_date: start_date.beginning_of_day..start_date.end_of_day }\n</code></pre>\n\n<p>Or if on <strong>Rails 5.1</strong> (this is a new helper introduced in Rails 5.1):</p>\n\n<pre><code>scope :day, -&gt; (start_date) { where start_date: start_date.all_day }\n</code></pre>\n"}], "owner": {"reputation": 414, "user_id": 6556383, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-rFjQCuJsaAk/AAAAAAAAAAI/AAAAAAAAEio/VDKKrZfNTtM/photo.jpg?sz=128", "display_name": "dendomenko", "link": "https://stackoverflow.com/users/6556383/dendomenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7695, "favorite_count": 3, "accepted_answer_id": 45436447, "answer_count": 3, "score": 9, "last_activity_date": 1501591343, "creation_date": 1501585972, "question_id": 45436232, "link": "https://stackoverflow.com/questions/45436232/rails-convert-datetime-to-date-in-where-query", "title": "Rails convert DateTime to date in &#39;where&#39; query", "body": "<p>I need to make a query to database and filter Event by start date, but column type is DateTime.\nI made scope in model:  </p>\n\n<pre><code>scope :day, -&gt; (start_date) {where start_date: start_date}\n</code></pre>\n\n<p>It works fine for same DateTime value, but I need a filter to get <code>Event</code> only by date, not DateTime.</p>\n\n<p>I have PG database and try:</p>\n\n<pre><code>  scope :day, -&gt; (start_date) {where(\"start_date:date =?\", \"#{start_date.to_date}\")}  \n</code></pre>\n\n<p>but I get an error</p>\n"}]