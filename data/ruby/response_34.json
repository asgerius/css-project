[{"tags": ["arrays", "ruby", "regex", "input"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5294673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c8df5960a3bdde91a819e233e578bf?s=128&d=identicon&r=PG&f=1", "display_name": "MDB", "link": "https://stackoverflow.com/users/5294673/mdb"}, "edited": false, "score": 0, "creation_date": 1441255261, "post_id": 32366262, "comment_id": 52606108, "body": "Thank you so much!  I would have never been able to come up with a regex even half as easy as that.  Your step-by-step explanation has really helped as well."}], "tags": [], "owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "is_accepted": true, "score": 2, "last_activity_date": 1441251333, "last_edit_date": 1441251333, "creation_date": 1441249199, "answer_id": 32366262, "question_id": 32364991, "link": "https://stackoverflow.com/questions/32364991/taking-user-input-and-confirming-format/32366262#32366262", "title": "Taking user input and confirming format", "body": "<p>Here's a contrived solution:</p>\n\n<pre><code>puts \"enter three capital letters, a dash, and then seven numbers:\"\ninput = gets.chomp  #=&gt; note that input is a String\n\nif input =~ /^[A-Z]{3}-\\d{7}$/\n  puts \"valid\"\nelse\n  puts \"invalid\"\nend\n</code></pre>\n\n<p>Breaking down the regular expression into human-readable language:</p>\n\n<ul>\n<li><code>^</code> means start of line (unless it is in a character class where it's negation) </li>\n<li><code>[A-Z]{3}</code> means 3 of any uppercase letter; <code>[]</code> represents a character class (i.e. uppercase letters) and the associated<code>{3}</code> means exactly three of the character class </li>\n<li><code>-</code> is the dash character </li>\n<li><code>\\d{7}</code> means exactly 7 digits</li>\n<li><code>$</code> means end of line</li>\n</ul>\n\n<p>If you don't have experience with regular expressions, it'll be worth your while to find a tutorial and invest the time to learn the basics.  And <a href=\"http://rubular.com/\" rel=\"nofollow\">http://rubular.com/</a> is an online regular expression editor that I can't endorse stronly enough.</p>\n"}], "owner": {"reputation": 27, "user_id": 5294673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c8df5960a3bdde91a819e233e578bf?s=128&d=identicon&r=PG&f=1", "display_name": "MDB", "link": "https://stackoverflow.com/users/5294673/mdb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 32366262, "answer_count": 1, "score": 1, "last_activity_date": 1441251333, "creation_date": 1441238246, "question_id": 32364991, "link": "https://stackoverflow.com/questions/32364991/taking-user-input-and-confirming-format", "title": "Taking user input and confirming format", "body": "<p>I am new to Ruby: I have only completed the codecademy for it and I have very limited experience with Rails.</p>\n\n<p>I am trying to create a simple function that will take a user's input and see if it meets the right criteria for a serial number:  three capital letters, a dash, and then seven numbers.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>\"enter serial\"\nserialNumber = gets.chomp\n\nserNumarr = serialNumber.split(\"\")\n\ncaps = serNumarr[0..2]\ndash = serNumarr[3]\nnums = serNumarr[4..10]\n\nif dash != \"-\"\n    puts \"not a serial Number\"\nend\n</code></pre>\n\n<p>Now I have also asked on other forums and I was told to utilize this code:</p>\n\n<pre><code>def letter?(lookAhead)\n  lookAhead =~ /[[:alpha:]]/\nend\n</code></pre>\n\n<p>But I have zero experience with regular expressions.  How can I use the above code to solve my problem?  Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "strong-parameters", "mass-assignment"], "answers": [{"tags": [], "owner": {"reputation": 1055, "user_id": 1036829, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b680b4c9272d0bd7cd1dfd15f9daa913?s=128&d=identicon&r=PG", "display_name": "Anh Nguyen", "link": "https://stackoverflow.com/users/1036829/anh-nguyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1449052951, "creation_date": 1449052951, "answer_id": 34040703, "question_id": 32364473, "link": "https://stackoverflow.com/questions/32364473/upgrading-to-rails-4-strong-parameters/34040703#34040703", "title": "Upgrading to Rails 4 - Strong Parameters", "body": "<p>Firstly, if you are upgrading to Rails 4 and using <code>strong_parameters</code> gem, you should have </p>\n\n<pre><code>config.active_record.whitelist_attributes = false\n</code></pre>\n\n<p>and</p>\n\n<pre><code>ActiveRecord::Base.send(:include, ActiveModel::ForbiddenAttributesProtection)\n</code></pre>\n\n<p>Secondly, it seems that 'type' is reserved for Rails <a href=\"https://github.com/rails/strong_parameters/issues/142\" rel=\"nofollow\">https://github.com/rails/strong_parameters/issues/142</a>, so that's why it's still giving errors even when you have permitted that <code>type</code> key. </p>\n\n<p>My solution is to set the <code>type</code> through setter method like <code>bar.type = 'YourType'</code> when you're about to save it. That will work with no problem.</p>\n\n<p>I hope it'll help.</p>\n"}], "owner": {"reputation": 237, "user_id": 465419, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/29cc96c777cd085f60b5387aaf301f29?s=128&d=identicon&r=PG", "display_name": "sixtimes", "link": "https://stackoverflow.com/users/465419/sixtimes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 614, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1449052951, "creation_date": 1441234528, "question_id": 32364473, "link": "https://stackoverflow.com/questions/32364473/upgrading-to-rails-4-strong-parameters", "title": "Upgrading to Rails 4 - Strong Parameters", "body": "<p>I'm hitting some inconsistent behavior while trying to upgrade my project to Rails 4 from 3.2 incrementally with the strong_parameters gem.</p>\n\n<p>In config/application.rb I have the following:</p>\n\n<pre><code>config.active_record.whitelist_attributes = false\nconfig.action_controller.action_on_unpermitted_parameters = :raise\n</code></pre>\n\n<p>I'm following the upgrade procedures as spelled out on the gem's <a href=\"https://github.com/rails/strong_parameters#migration-path-to-rails-4\" rel=\"nofollow\">github page</a>.</p>\n\n<p>I take a model, strip out attr_accessible and attr_protected, and add <code>include ActiveModel::ForbiddenAttributesProtection</code> as the first line in the class definition. Then I run rspec to find what tests are red to try to turn them green.</p>\n\n<h2>Class Bar</h2>\n\n<pre><code>class Bar &lt; ActiveRecord::Base\n  include ActiveModel::ForbiddenAttributesProtection\n  ...\nend\n\nlet(:bar)  { Bar.create(type: \"#{klass_name}\") }\n</code></pre>\n\n<p>and</p>\n\n<pre><code>let(:bar)  {\n  raw_params = { type: \"#{klass_name}\" }\n  params = ActionController::Parameters.new(raw_params)\n  Bar.create(params.permit(:type))\n}\n</code></pre>\n\n<p>both produce</p>\n\n<pre><code> ActiveModel::MassAssignmentSecurity::Error:\n   Can't mass-assign protected attributes: type\n</code></pre>\n\n<p>regardless of the value of <code>config.active_record.whitelist_attributes</code></p>\n\n<p><strong>Problem: This isn't working at all.</strong></p>\n\n<h2>Class Foo</h2>\n\n<pre><code>class Foo &lt; Bar\n  ...\nend\n</code></pre>\n\n<p>For both</p>\n\n<pre><code>before :each do\n  Foo.create(status: 'active')\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>before :each do\n  raw_params = { status: 'active' }\n  params = ActionController::Parameters.new(raw_params)\n  Foo.create(params.permit(:status))\nend\n</code></pre>\n\n<p>When <code>config.active_record.whitelist_attributes = false</code>, both turn tests green, and removing .permit(:status) correctly produces</p>\n\n<pre><code> Failure/Error: Foo.create(params)\n ActiveModel::ForbiddenAttributes:\n   ActiveModel::ForbiddenAttributes\n</code></pre>\n\n<p>When <code>config.active_record.whitelist_attributes = true</code>, both produce</p>\n\n<pre><code>Failure/Error: Foo.create(params.permit(:status))\n     ActiveModel::MassAssignmentSecurity::Error:\n      Can't mass-assign protected attributes: status\n</code></pre>\n\n<p><strong>Problem: Either both succeed or both fail for either value of whitelist_attributes. For the purposes of iterative testing, I want a situation where traditional mass assignment fails and the updated code succeeds.</strong></p>\n\n<p>Where am I faltering?</p>\n"}, {"tags": ["ruby", "inheritance", "lambda", "proc"], "answers": [{"comments": [{"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "edited": false, "score": 0, "creation_date": 1441236970, "post_id": 32364756, "comment_id": 52602004, "body": "Well, that actually makes a lot of things make sense! Thanks a lot!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441238356, "post_id": 32364756, "comment_id": 52602355, "body": "You could write <code>def self.new *_</code> to draw attention to the fact that you&#39;re not using the arguments."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441238489, "post_id": 32364756, "comment_id": 52602398, "body": "@CarySwoveland: Actually, Ruby allows you to not name the argument at all, when you want to ignore it: <code>def self.new(*)</code>. I assume, the OP wants to use the arguments in some fashion, but for now you&#39;re right. While I&#39;m at it, I could go completely overboard and do <code>super(&amp;2.method(:*))</code> :-D"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441238592, "post_id": 32364756, "comment_id": 52602426, "body": "I didn&#39;t know that. Learned a couple of things."}, {"owner": {"reputation": 7491, "user_id": 1134742, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/17977a15fb035d378d8a0a93b3401215?s=128&d=identicon&r=PG", "display_name": "rudolph9", "link": "https://stackoverflow.com/users/1134742/rudolph9"}, "edited": false, "score": 0, "creation_date": 1478014340, "post_id": 32364756, "comment_id": 67979595, "body": "Why overload <code>new</code> instead of <code>initialize</code> ?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 7491, "user_id": 1134742, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/17977a15fb035d378d8a0a93b3401215?s=128&d=identicon&r=PG", "display_name": "rudolph9", "link": "https://stackoverflow.com/users/1134742/rudolph9"}, "edited": false, "score": 0, "creation_date": 1478022128, "post_id": 32364756, "comment_id": 67984365, "body": "@rudolph9: I can&#39;t remember. The thing is, this has absolutely nothing to do with <code>Proc</code>, <code>new</code>, or <code>initialize</code>. It is simply about the semantics of <code>super</code>. So, it doesn&#39;t really matter."}, {"owner": {"reputation": 7491, "user_id": 1134742, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/17977a15fb035d378d8a0a93b3401215?s=128&d=identicon&r=PG", "display_name": "rudolph9", "link": "https://stackoverflow.com/users/1134742/rudolph9"}, "edited": false, "score": 0, "creation_date": 1478190123, "post_id": 32364756, "comment_id": 68063204, "body": "@J&#246;rgWMittag I actually dug into it a little more, the block that gets called when you pass a <code>proc</code> to say <code>[1,2,3].map(&amp;proc.new{|v| puts &#39;v&#39;}</code> is set in <code>self.new</code> and as far as I can tell can&#39;t be modified once initialize is executed."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 3, "last_activity_date": 1441238515, "last_edit_date": 1441238515, "creation_date": 1441236567, "answer_id": 32364756, "question_id": 32364402, "link": "https://stackoverflow.com/questions/32364402/have-a-class-inherit-proc-in-ruby/32364756#32364756", "title": "Have a class inherit Proc in Ruby", "body": "<p><code>super</code> without an argument list means \"pass the original arguments along\". In this case, the original argument is the string <code>\"hello\"</code>, which is passed along to <code>Proc::new</code>, but that doesn't take an argument!</p>\n\n<p>The fix is to explicitly pass along no arguments:</p>\n\n<pre><code>class MyClass &lt; Proc\n  def self.new(*)\n    super() {|x| 2 * x }\n  end\nend\n\nm = MyClass.new \"hello\"\nm.(23) # =&gt; 46\n</code></pre>\n\n<p>Apparently, a block doesn't count as an argument list. You learn something new every day.</p>\n"}], "owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "accepted_answer_id": 32364756, "answer_count": 1, "score": 1, "last_activity_date": 1441238515, "creation_date": 1441234181, "question_id": 32364402, "link": "https://stackoverflow.com/questions/32364402/have-a-class-inherit-proc-in-ruby", "title": "Have a class inherit Proc in Ruby", "body": "<p>I have been trying to inherit the <code>Proc</code> class in Ruby. I know there are tons of other ways I could implement my class without actually inheriting <code>Proc</code>, but now I want to know out of curiosity. </p>\n\n<p>I want a class that can be instantiated without a block passed as an argument, but it just won't work (<a href=\"https://github.com/ruby/ruby/blob/24da2db3e1eab67b6ee7be00d75b73beb273a4c4/proc.c#L585\" rel=\"nofollow\">this</a> seems to be the reason). It is clear that you can't instantiate an actual <code>Proc</code> without a block (not even with a <code>proc</code> or <code>lamba</code>):</p>\n\n<pre><code>Proc.new proc {|x| 2 * x } # =&gt; ArgumentError: tried to create Proc object without a block\nProc.new lambda {|x| 2 * x } # =&gt; ArgumentError: tried to create Proc object without a block\n</code></pre>\n\n<p>I assumed that overriding <code>initialize</code> might just do the trick, but actually even overriding <code>new</code> won't do:</p>\n\n<pre><code>class MyClass &lt; Proc\n  def new *args, &amp;block\n    super { |x| 2 * x }\n  end\n\n  def initialize *args, &amp;block\n    super { |x| 2 * x }    \n  end\nend\n\nMyClass.new { |x| 2 * x } # =&gt; everything is fine\nMyClass.new \"hello\" # =&gt; ArgumentError: tried to create Proc object without a block\n</code></pre>\n\n<p>Is there any way (from within Ruby) to go around that restriction in <a href=\"https://github.com/ruby/ruby/blob/24da2db3e1eab67b6ee7be00d75b73beb273a4c4/proc.c#L585\" rel=\"nofollow\">proc.c</a>? Or any elegant workaround?</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "partial-views"], "comments": [{"owner": {"reputation": 499, "user_id": 2974739, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/aa0b69edfbd9f807b1d66c9afa3e8b9b?s=128&d=identicon&r=PG&f=1", "display_name": "user2974739", "link": "https://stackoverflow.com/users/2974739/user2974739"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1441234560, "post_id": 32364284, "comment_id": 52601341, "body": "Nope.  It&#39;s not the same thing I am asking.  I don&#39;t want to send the data back as html to display.  I already have the partial views created.  They just need to be called on click of the link and dynamically display the results in a modal dialog.  From the link you sent I how would I be able to call the partial view with the parameters I want for each link?"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1441234727, "post_id": 32364284, "comment_id": 52601381, "body": "The answers in the provided link explain how.... If you don&#39;t want to do it on page load, and you don&#39;t want to fetch via AJAX, how exactly are you planning on doing it?"}, {"owner": {"reputation": 499, "user_id": 2974739, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/aa0b69edfbd9f807b1d66c9afa3e8b9b?s=128&d=identicon&r=PG&f=1", "display_name": "user2974739", "link": "https://stackoverflow.com/users/2974739/user2974739"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1441234818, "post_id": 32364284, "comment_id": 52601407, "body": "So, let&#39;s say I do it via AJAX - are you saying I would have to return an HTML equivalent of what I want to display to the user?"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1441234916, "post_id": 32364284, "comment_id": 52601441, "body": "Yep, exactly. It&#39;s the only way, except magic, if it&#39;s not rendered in the page in advance."}, {"owner": {"reputation": 499, "user_id": 2974739, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/aa0b69edfbd9f807b1d66c9afa3e8b9b?s=128&d=identicon&r=PG&f=1", "display_name": "user2974739", "link": "https://stackoverflow.com/users/2974739/user2974739"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1441234992, "post_id": 32364284, "comment_id": 52601458, "body": "I guess I need to figure out how to properly render it on pageload.  Thanks,"}], "owner": {"reputation": 499, "user_id": 2974739, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/aa0b69edfbd9f807b1d66c9afa3e8b9b?s=128&d=identicon&r=PG&f=1", "display_name": "user2974739", "link": "https://stackoverflow.com/users/2974739/user2974739"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13, "favorite_count": 0, "closed_date": 1441235002, "answer_count": 0, "score": 0, "last_activity_date": 1441233523, "creation_date": 1441233523, "question_id": 32364284, "link": "https://stackoverflow.com/questions/32364284/ruby-how-to-dynamically-open-a-dialog-with-partial-view", "closed_reason": "Duplicate", "title": "Ruby how to dynamically open a dialog with partial view", "body": "<p>How do you dynamically open a modal dialog window on click from a list of items and passing parameters to a partial view.  For example, I have a list of items.  When the user clicks on one of the items I want to open a modal dialog window that dynamically (goes to the controller, etc.) displays the information for that particular item on the list.  I don't want to and can't do a render of the partial views when the page loads and just hide them until a user clicks the link.  I tried that and there is too much javascript in the partial view that the id's are the same because of the many items in the list.  The dialog for the partial view has to be dynamically loaded when a user clicks the link for the specific item.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "has-many-through", "strong-parameters"], "answers": [{"tags": [], "owner": {"reputation": 8058, "user_id": 594763, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e95f906d1c0b54495bb4685b24569ec3?s=128&d=identicon&r=PG", "display_name": "patrick", "link": "https://stackoverflow.com/users/594763/patrick"}, "is_accepted": true, "score": 1, "last_activity_date": 1441301954, "last_edit_date": 1441301954, "creation_date": 1441238747, "answer_id": 32365066, "question_id": 32364030, "link": "https://stackoverflow.com/questions/32364030/has-many-throught-not-instering-into-database-from-form/32365066#32365066", "title": "has_many :throught not INSTERING INTO database from form", "body": "<p>I believe your problem is this line in your controller:</p>\n\n<pre><code>params.require(:patient).permit({:clinician_ids =&gt; [:id]}...\n</code></pre>\n\n<p>It should be:</p>\n\n<pre><code>params.require(:patient).permit({:clinician_ids =&gt; []}...\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4630110, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hDsTU.jpg?s=128&g=1", "display_name": "Skiapex", "link": "https://stackoverflow.com/users/4630110/skiapex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 1, "accepted_answer_id": 32365066, "answer_count": 1, "score": 0, "last_activity_date": 1441301954, "creation_date": 1441232077, "last_edit_date": 1441235975, "question_id": 32364030, "link": "https://stackoverflow.com/questions/32364030/has-many-throught-not-instering-into-database-from-form", "title": "has_many :throught not INSTERING INTO database from form", "body": "<p>I have tried all of the solutions to similar problems and haven't gotten this one figured out.</p>\n\n<p>I have a has_many :through relationship between 'Clinician', and 'Patient' with a joined model 'CareGroupAssignment'.  I would like to have a <code>patient</code> be able to have multiple <code>clinicians</code> associated with it and <code>clinicians</code> will have multiple <code>patients</code>.</p>\n\n<p>When I submit my form this is logged:\n<code>Started POST \"/patients\" for 127.0.0.1 at 2015-09-02 14:56:38 -0700\nProcessing by PatientsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"XXX=\", \"patient\"=&gt;{\"user_attributes\"=&gt;{\"email\"=&gt;\"allencentre\", \"password\"=&gt;\"[FILTERED]\"}, \"first_name\"=&gt;\"Allen\", \"last_name\"=&gt;\"Centre\", \"birth_date(1i)\"=&gt;\"2002\", \"birth_date(2i)\"=&gt;\"9\", \"birth_date(3i)\"=&gt;\"2\", \"clinician_ids\"=&gt;[\"85\", \"87\"], \"patient_deceased\"=&gt;\"0\", \"patient_archived\"=&gt;\"0\"}, \"button\"=&gt;\"\"}</code></p>\n\n<p>So <code>\"clinician_ids\"=&gt;[\"85\", \"87\"]</code> is being passed from the form.</p>\n\n<p>There is an <code>INSERT INTO \"users\" (\"email\", ....</code> and an <code>INSERT INTO \"patients\" (\"bir....</code> but the data for <code>care_group_assignments</code> doesn't have one.</p>\n\n<p>There is <code>[36mCareGroupAssignment Load (0.4ms)[0m  [1mSELECT \"care_group_assignments\".* FROM \"care_group_assignments\"  WHERE \"care_group_assignments\".\"patient_id\" = $1[0m  [[\"patient_id\", 199]]</code></p>\n\n<p><strong>clinician.rb</strong> (simplified)</p>\n\n<pre><code>class Clinician &lt; ActiveRecord::Base\n    belongs_to :care_group\n\n    has_many :patients ,:through=&gt; :care_group_assignments\n    has_many :care_group_assignments, :dependent =&gt; :destroy\n\n    belongs_to :user\n    accepts_nested_attributes_for :user,  :allow_destroy =&gt; true\nend\n</code></pre>\n\n<p><strong>patient.rb</strong></p>\n\n<pre><code>class Patient &lt; ActiveRecord::Base\n    belongs_to :care_group\n\n    has_many :clinicians ,:through=&gt; :care_group_assignments\n    has_many :care_group_assignments\n\n    belongs_to :user\n    accepts_nested_attributes_for :user,  :allow_destroy =&gt; true\nend\n</code></pre>\n\n<p><strong>care_group_assignments.rb</strong></p>\n\n<pre><code>class CareGroupAssignment &lt; ActiveRecord::Base\n    belongs_to :clinician\n    belongs_to :patient\nend\n</code></pre>\n\n<p>This is following the example from <a href=\"https://www.youtube.com/watch?v=c2qwV0B9yfU\" rel=\"nofollow\">Railscasts PRO #17- HABTM Checkboxes</a> to at least start getting the data collected and to have the models set up correctly.  Below is the form with the checkboxes for each clinician as described in the RailsCast, checkboxes show up and the data is sent but not stored (can't figure out why).</p>\n\n<p>patient <strong>new.html.erb</strong> form</p>\n\n<pre><code>&lt;%= form_for @patient do |form| %&gt;\n\n  &lt;%= form.fields_for :user do |builder| %&gt;\n   &lt;div class=\"form-group\"&gt;\n      &lt;%= builder.label \"Email or Username\" %&gt;\n      &lt;%= builder.text_field :email, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"form-group\"&gt;\n      &lt;%= builder.label :password %&gt;\n      &lt;%= builder.password_field :password, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= form.label :first_name %&gt;\n    &lt;%= form.text_field :first_name, class: \"form-control\", placeholder: \"First name\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= form.label :last_name %&gt;\n    &lt;%= form.text_field :last_name, class: \"form-control\", placeholder: \"Last name\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;% Clinician.where(care_group_id: @care_group.id).each do |clinician| %&gt;\n      &lt;%= check_box_tag \"patient[clinician_ids][]\", clinician.id, @patient.clinician_ids.include?(clinician.id), id: dom_id(clinician) %&gt;\n      &lt;%= label_tag dom_id(clinician), clinician.full_name %&gt;&lt;br&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n\n  &lt;%= form.button 'Create Patient', class: \"btn btn-u btn-success\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This method has so far not been able to save the <code>clinician</code> to <code>patient</code> association.</p>\n\n<p><strong>patient_controller.rb</strong></p>\n\n<pre><code>def new\n  @patient = Patient.new\n  @user = User.new\n  @patient.build_user\n\n  @care_group = current_clinician.care_group\nend\n\ndef create\n  @patient = Patient.create(patient_params)\n  @patient.care_group = current_clinician.care_group\n\n  if @patient.save\n    redirect_to patient_path(@patient), notice: \"New patient created!\"\n  else\n    render \"new\"\n  end\nend\n\ndef show\n @patient = Patient.find_by(id: params[\"id\"])\nend\n\nprivate\n def patient_params\n  params.require(:patient).permit({:clinician_ids =&gt; [:id]},:first_name,:last_name,:user_id,:birth_date, user_attributes: [ :email, :password, :patient_id, :clinician_id ])\n end\n</code></pre>\n\n<p>I plan to display the <code>clinicians</code> associated with a <code>patient</code> on the patient <code>show</code> page:</p>\n\n<p>patient <strong>show.html.erb</strong></p>\n\n<pre><code>&lt;strong&gt;Shared with:&lt;/strong&gt;\n &lt;% @patient.clinicians.each do |clinician| %&gt;\n  &lt;%= clinician.full_name %&gt;&lt;\n &lt;% end %&gt;\n</code></pre>\n\n<p>This works if I seed the database but since the data doesn't seem to be stored, nothing is showing up.</p>\n\n<p>Rails 4.1.8, ruby 2.2.1p85, PostgreSQL</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "watir-webdriver", "rubymine"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1441231385, "post_id": 32363853, "comment_id": 52600333, "body": "I don&#39;t see how, the browser placement will use whatever OS mechanism in place when it&#39;s launched. Maybe another intellij window used exclusively to start up the tests."}, {"owner": {"reputation": 409, "user_id": 3513665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RvMjj.jpg?s=128&g=1", "display_name": "Carldmitch", "link": "https://stackoverflow.com/users/3513665/carldmitch"}, "edited": false, "score": 0, "creation_date": 1441238563, "post_id": 32363853, "comment_id": 52602419, "body": "I do believe this is an OS controlled thing, I can easily manipulate which monitor the new browser opens on by just clicking inside that monitor with my mouse before it opens. However with my setup I just use the move_to method to move the browser where i want after it opens"}], "answers": [{"comments": [{"owner": {"reputation": 515, "user_id": 3981312, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6ec2f8899cb31327d8ec61352fcd09f8?s=128&d=identicon&r=PG&f=1", "display_name": "mancocapac", "link": "https://stackoverflow.com/users/3981312/mancocapac"}, "edited": false, "score": 0, "creation_date": 1441738267, "post_id": 32407559, "comment_id": 52792301, "body": "thanks, i will give it a try. where do you place this script, in your hooks.rb?"}], "tags": [], "owner": {"reputation": 115, "user_id": 992753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2117f0d9f2ecce7682c164e0c6612b19?s=128&d=identicon&r=PG", "display_name": "Jason McI", "link": "https://stackoverflow.com/users/992753/jason-mci"}, "is_accepted": true, "score": 1, "last_activity_date": 1441406576, "creation_date": 1441406576, "answer_id": 32407559, "question_id": 32363853, "link": "https://stackoverflow.com/questions/32363853/how-can-i-dynamically-display-browser-on-2nd-monitor-when-using-watir-with-rubym/32407559#32407559", "title": "How can I dynamically display browser on 2nd monitor when using watir with Rubymine?", "body": "<p>Since I write tests at home and in the office and I have dual monitors in both places, and they are different sizes, I just use an environment variable:  </p>\n\n<pre><code>if ENV['MOVE_BROWSER'] =~ /home/i\n  browser.window.move_to(2080,0)\nelsif ENV['MOVE_BROWSER'] =~ /office/i\n  browser.window.move_to(-2562, -600)   \nend\n\nscreen_width = browser.execute_script(\"return screen.width;\")\nscreen_height = browser.execute_script(\"return screen.height;\")\nbrowser.driver.manage.window.resize_to(screen_width,screen_height)\n</code></pre>\n\n<p>This also ensures other testers are not affected by my preferences. I use Sublime on the largest available screen, and then have the browser on the other. </p>\n"}], "owner": {"reputation": 515, "user_id": 3981312, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6ec2f8899cb31327d8ec61352fcd09f8?s=128&d=identicon&r=PG&f=1", "display_name": "mancocapac", "link": "https://stackoverflow.com/users/3981312/mancocapac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 32407559, "answer_count": 1, "score": 1, "last_activity_date": 1441406576, "creation_date": 1441231196, "last_edit_date": 1441241560, "question_id": 32363853, "link": "https://stackoverflow.com/questions/32363853/how-can-i-dynamically-display-browser-on-2nd-monitor-when-using-watir-with-rubym", "title": "How can I dynamically display browser on 2nd monitor when using watir with Rubymine?", "body": "<p>How do I force my browser to come up on the monitor opposite Rubymine in a dual monitor setup?</p>\n\n<p>I am trying to test/debug Feature Scenarios. My tool-set is RubyMine, Ruby, watir, page-object-gem, and Cucumber. I have a dual monitor setup, but the browser always comes up on the same monitor as Rubymine.</p>\n\n<p>I made some changes to my hooks.rb file: </p>\n\n<pre><code>Before do\n  @browser = Watir::Browser.new :firefox\n  @browser.window.move_to(1985,24)\n  @browser.window.maximize \n  puts \" Browser Position \" + @browser.window.position.to_s\nend\n\nAfter do\n  @browser.close\nend\n</code></pre>\n\n<p>This is a very clunky solution. It always comes up on the same monitor as rubymine then moves. I had to hard-code position to use 2nd monitor, so it probably won't work on a different dual-monitor setup.</p>\n\n<p>Question: </p>\n\n<ol>\n<li>If there is a config item for this, what is it?</li>\n<li><p>Can you suggest a way to implement the following and where would it go?</p>\n\n<p>If(dual_monitor) \nthen browser.move.window_to(other_monitor)</p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 0, "creation_date": 1445341828, "post_id": 32363787, "comment_id": 54274632, "body": "did you figure this out?  I&#39;m getting the same error, but only if i run the offending file explicitly - running all specs doesn&#39;t raise this error"}], "answers": [{"tags": [], "owner": {"reputation": 624, "user_id": 7188109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f0d98756028ef12c8cdbf8d89a2a259?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 D\u0105browski", "link": "https://stackoverflow.com/users/7188109/pawe%c5%82-d%c4%85browski"}, "is_accepted": false, "score": 1, "last_activity_date": 1480309512, "creation_date": 1480309512, "answer_id": 40837499, "question_id": 32363787, "link": "https://stackoverflow.com/questions/32363787/nomethoderror-in-rspec/40837499#40837499", "title": "NoMethodError: in Rspec", "body": "<ol>\n<li>Check if you have <code>config.include FactoryGirl::Syntax::Methods</code> inside <code>rails_helper.rb</code></li>\n<li>If you have above line in <code>rails_helper.rb</code> file you can always use <code>FactoryGirl.create :user</code></li>\n<li>You didn't probably include <code>include Devise::TestHelpers</code> in specs for <code>VotesController</code> that's why it does not see <code>sign_in</code> method</li>\n</ol>\n"}], "owner": {"reputation": 15, "user_id": 4902481, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/JkoHU.jpg?s=128&g=1", "display_name": "BryanPorras", "link": "https://stackoverflow.com/users/4902481/bryanporras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480309512, "creation_date": 1441230937, "question_id": 32363787, "link": "https://stackoverflow.com/questions/32363787/nomethoderror-in-rspec", "title": "NoMethodError: in Rspec", "body": "<p>I'm currently doing rspec testing on two files and I got these failures regarding undefined methods. I need more calcification on how to exactly fixes these errors,Thanks!</p>\n\n<p>Failures:</p>\n\n<pre><code>  1) FavoritesController#create creates a favorite for the current user and specified post\n     Failure/Error: @post = create(:post)\n     NoMethodError:\n       undefined method `create' for #&lt;RSpec::ExampleGroups::FavoritesController::Create:0x007fdabc84f7f8&gt;\n     # /Users/bryanporras/.rvm/gems/ruby-2.2.1/gems/actionpack-4.2.1/lib/action_dispatch/testing/assertions/routing.rb:171:in `method_missing'\n     # ./spec/controllers/favorites_controller_spec.rb:8:in `block (2 levels) in &lt;top (required)&gt;'\n\n  2) FavoritesController#destroy destroys the favorite for the current user and post\n     Failure/Error: @post = create(:post)\n     NoMethodError:\n       undefined method `create' for #&lt;RSpec::ExampleGroups::FavoritesController::Destroy:0x007fdabfe0f3e8&gt;\n     # /Users/bryanporras/.rvm/gems/ruby-2.2.1/gems/actionpack-4.2.1/lib/action_dispatch/testing/assertions/routing.rb:171:in `method_missing'\n     # ./spec/controllers/favorites_controller_spec.rb:8:in `block (2 levels) in &lt;top (required)&gt;'\n\n  3) VotesController#up_vote adds an up-vote to the post\n     Failure/Error: sign_in @user\n     NoMethodError:\n       undefined method `sign_in' for #&lt;RSpec::ExampleGroups::VotesController::UpVote:0x007fdabfe26fe8&gt;\n     # /Users/bryanporras/.rvm/gems/ruby-2.2.1/gems/actionpack-4.2.1/lib/action_dispatch/testing/assertions/routing.rb:171:in `method_missing'\n     # ./spec/controllers/votes_controller_spec.rb:12:in `block (3 levels) in &lt;top (required)&gt;'\n\n  4) Vote after_save calls `Post#update_rank` after save\n     Failure/Error: vote = Vote.new(value: 1, post: post)\n     NameError:\n       undefined local variable or method `post' for #&lt;RSpec::ExampleGroups::Vote::AfterSave:0x007fdabdb8b0b0&gt;\n     # ./spec/models/vote_spec.rb:25:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 0.78639 seconds (files took 2.82 seconds to load)\n15 examples, 4 failures, 2 pending\n\nFailed examples:\n\nrspec ./spec/controllers/favorites_controller_spec.rb:14 # FavoritesController#create creates a favorite for the current user and specified post\nrspec ./spec/controllers/favorites_controller_spec.rb:24 # FavoritesController#destroy destroys the favorite for the current user and post\nrspec ./spec/controllers/votes_controller_spec.rb:8 # VotesController#up_vote adds an up-vote to the post\nrspec ./spec/models/vote_spec.rb:24 # Vote after_save calls `Post#update_rank` after save\n</code></pre>\n\n<p>This is the favorites_controller_spec.rb file:</p>\n\n<pre><code>require 'rails_helper'\n\ndescribe FavoritesController do\n\n  include Devise::TestHelpers\n\n  before do \n    @post = create(:post)\n    @user = create(:user)\n    sign_in @user\n  end\n\n  describe '#create' do\n    it \"creates a favorite for the current user and specified post\" do\n      expect( @user.favorites.find_by(post_id: @post.id) ).to be_nil\n\n      post :create, { post_id: @post.id }\n\n      expect( @user.favorites.find_by(post_id: @post.id) ).not_to be_nil\n    end\n  end\n\n  describe '#destroy' do\n    it \"destroys the favorite for the current user and post\" do\n      favorite = @user.favorites.where(post: @post).create\n      expect( @user.favorites.find_by(post_id: @post.id) ).not_to be_nil\n\n      delete :destroy, { post_id: @post.id, id: favorite.id }\n\n      expect( @user.favorites.find_by(post_id: @post.id) ).to be_nil\n    end\n  end\nend\n</code></pre>\n\n<p>and this is the votes_controller_spec.rb file:</p>\n\n<pre><code>require 'rails_helper'\n\n describe VotesController do\n\n   include TestFactories\n\n   describe '#up_vote' do\n     it \"adds an up-vote to the post\" do\n        request.env[\"HTTP_REFERER\"] = '/'\n       @user = authenticated_user\n       @post = associated_post\n       sign_in @user\n\n       expect {\n         post( :up_vote, post_id: @post.id )\n       }.to change{ @post.up_votes }.by 1\n     end\n   end\n end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 3614, "user_id": 1569930, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7bc43a689388dd4697947ffe8f4c9dcd?s=128&d=identicon&r=PG", "display_name": "eirikir", "link": "https://stackoverflow.com/users/1569930/eirikir"}, "edited": false, "score": 0, "creation_date": 1441232901, "post_id": 32363533, "comment_id": 52600828, "body": "What&#39;s the string you&#39;re parsing? I&#39;m sure this is obvious, but are the system time/dates correct?"}, {"owner": {"reputation": 4313, "user_id": 1177198, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4ea56c658e69eef33b6557b20c7a19ab?s=128&d=identicon&r=PG", "display_name": "bigtunacan", "link": "https://stackoverflow.com/users/1177198/bigtunacan"}, "reply_to_user": {"reputation": 3614, "user_id": 1569930, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7bc43a689388dd4697947ffe8f4c9dcd?s=128&d=identicon&r=PG", "display_name": "eirikir", "link": "https://stackoverflow.com/users/1569930/eirikir"}, "edited": false, "score": 0, "creation_date": 1441237830, "post_id": 32363533, "comment_id": 52602207, "body": "@eirikir, The first thing I checked was system date/time; both match.  The string comes in looking something like this &quot;Wed, Sept 2, 2015&quot;"}], "owner": {"reputation": 4313, "user_id": 1177198, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4ea56c658e69eef33b6557b20c7a19ab?s=128&d=identicon&r=PG", "display_name": "bigtunacan", "link": "https://stackoverflow.com/users/1177198/bigtunacan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441229799, "creation_date": 1441229799, "question_id": 32363533, "link": "https://stackoverflow.com/questions/32363533/rails-3-inconsistent-date-to-activesupporttimewithzone-behavior", "title": "Rails 3 inconsistent Date to ActiveSupport::TimeWithZone behavior", "body": "<p>I'm working with an older Rails project (recently migrated from Rails 2 to Rails 3) that has some existing code that uses Date.parse to convert a String to a Date and then puts that into an ActiveRecord model where it becomes an ActiveSupport::TimeWithZone class.</p>\n\n<p>In Rails 2 this worked fine; but handling of time zones changed between 2 &amp; 3.  Now I see inconsistent behavior on the same code base between Mac &amp; CentOS.</p>\n\n<p>On the Mac the Date converts into the TimeWithZone correctly and keeps the same Date.  On CentOS the TimeWithZone is always converted to 1 day prior to the actual date.  I'm not sure why this is happening as both systems have time zone set to America/Chicago.</p>\n\n<p>Here is a sample of what happens.</p>\n\n<pre><code>df = Date.parse(a_string)\nrecord.date_with_tz = df # &lt;-- On Mac date_with_tz will have correct date; on CentOS is previous day. \nrecord.save\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 2564, "user_id": 4134881, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/797360342295a3f637a9c4d71d40d113?s=128&d=identicon&r=PG&f=1", "display_name": "evianpring", "link": "https://stackoverflow.com/users/4134881/evianpring"}, "edited": false, "score": 0, "creation_date": 1441230249, "post_id": 32363542, "comment_id": 52599900, "body": "Got it, but still confused about the following: a = *ary.flatten  # =&gt; [4,8,15,16,23,42] b = ary.flatten   # =&gt; [4,8,15,16,23,42] So how come there is a difference in class, and how come one of them (variable a) is an Array of Array, when it doesn&#39;t look like it from the output above."}, {"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441230947, "post_id": 32363542, "comment_id": 52600158, "body": "It&#39;s because <code>a = *ary.flatten</code> is equivalent to <code>a.=(*ary.flatten)</code> which flattens your array in the argument and wraps the elements in a final array given the spat operator."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 2564, "user_id": 4134881, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/797360342295a3f637a9c4d71d40d113?s=128&d=identicon&r=PG&f=1", "display_name": "evianpring", "link": "https://stackoverflow.com/users/4134881/evianpring"}, "edited": false, "score": 1, "creation_date": 1441231888, "post_id": 32363542, "comment_id": 52600490, "body": "@evianpring: I don&#39;t understand what you mean. First off, variables aren&#39;t anything. They don&#39;t have a class. Only objects have classes. Variables point to objects. <code>a</code> points to an array with a single element which is the class <code>Array</code>, <code>b</code> points to the class <code>Array</code>. There are no arrays-of-arrays here."}, {"owner": {"reputation": 2564, "user_id": 4134881, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/797360342295a3f637a9c4d71d40d113?s=128&d=identicon&r=PG&f=1", "display_name": "evianpring", "link": "https://stackoverflow.com/users/4134881/evianpring"}, "edited": false, "score": 1, "creation_date": 1441240914, "post_id": 32363542, "comment_id": 52602943, "body": "I understand now what I was missing. I thought that in a = *ary.flatten.class, class would be applied to *ary.flatten. Actually * is applied to ary.flatten.class, so that the object Class is then coerced into an Array, so I get an Array with a Class object in it. In b = ary.flatten.class, class is applied to ary.flatten, so I just get the class object Array."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 2564, "user_id": 4134881, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/797360342295a3f637a9c4d71d40d113?s=128&d=identicon&r=PG&f=1", "display_name": "evianpring", "link": "https://stackoverflow.com/users/4134881/evianpring"}, "edited": false, "score": 0, "creation_date": 1441241007, "post_id": 32363542, "comment_id": 52602967, "body": "@evianpring: Ah, now I understand your question :-D Yes, it&#39;s <code>(a = (*(array.flatten.class)))</code>. The <code>.</code> operator binds really tight, the tightest of all operators."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 3, "last_activity_date": 1441229843, "creation_date": 1441229843, "answer_id": 32363542, "question_id": 32363360, "link": "https://stackoverflow.com/questions/32363360/why-can-i-execute-a-ary-flatten-but-not-simply-ary-flatten/32363542#32363542", "title": "Why can I execute a = *ary.flatten but not simply *ary.flatten?", "body": "<p>The splat transforms an array into a list of objects as if you had written them out explicitly using commas. So, obviously, it can only be used where such a list of objects can be used.</p>\n\n<pre><code>a = 4, 8, 15, 16, 23, 42\n</code></pre>\n\n<p>is legal, it's a parallel assignment.</p>\n\n<pre><code>4, 8, 15, 16, 23, 42\n</code></pre>\n\n<p>is not legal, it's a <code>SyntaxError</code>.</p>\n\n<blockquote>\n  <p>So, what does</p>\n\n<pre><code>*ary.flatten\n</code></pre>\n  \n  <p>return after all? Seems like it should return the individual elements of ary (what exactly is this object it returns?),</p>\n</blockquote>\n\n<p>It doesn't return an object. It is a syntactic construct that allows you to take an array and use it as if you had written out the elements by hand one-by-one.</p>\n\n<blockquote>\n<pre><code>a = *ary.flatten.class  # =&gt; [Array]\nb = ary.flatten.class   # =&gt; Array\n</code></pre>\n  \n  <p>What is the difference between [Array] and Array?</p>\n</blockquote>\n\n<p><code>Array</code> is a class, <code>[Array]</code> is an array with a single element, which is the class <code>Array</code>.</p>\n"}], "owner": {"reputation": 2564, "user_id": 4134881, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/797360342295a3f637a9c4d71d40d113?s=128&d=identicon&r=PG&f=1", "display_name": "evianpring", "link": "https://stackoverflow.com/users/4134881/evianpring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 32363542, "answer_count": 1, "score": 0, "last_activity_date": 1441229843, "creation_date": 1441229055, "last_edit_date": 1441229355, "question_id": 32363360, "link": "https://stackoverflow.com/questions/32363360/why-can-i-execute-a-ary-flatten-but-not-simply-ary-flatten", "title": "Why can I execute a = *ary.flatten but not simply *ary.flatten?", "body": "<pre><code>ary = = [[4, 8], [15, 16], [23, 42]]\n</code></pre>\n\n<p>In irb, why can I execute</p>\n\n<pre><code>a = *ary.flatten  # =&gt; [4,8,15,16,23,42]\n</code></pre>\n\n<p>but not simply </p>\n\n<pre><code>*ary.flatten\n</code></pre>\n\n<p>which gives me an error:</p>\n\n<pre><code>SyntaxError: (irb):97: syntax error, unexpected '\\n', expecting '='\n    from /usr/bin/irb:12:in `&lt;main&gt;'\n</code></pre>\n\n<p>I could also execute</p>\n\n<pre><code>a,b,c,d,e,f = *ary.flatten\n</code></pre>\n\n<p>without a problem, and the returned value after I press enter is</p>\n\n<pre><code>=&gt; [4, 8, 15, 16, 23, 42]\n</code></pre>\n\n<p>with a,b,c,d,e,f being now of class Fixnum.</p>\n\n<p>So, what does </p>\n\n<pre><code>*ary.flatten\n</code></pre>\n\n<p>return after all? Seems like it should return the individual elements of ary (what exactly is this object it returns?), that I can assign to something: either a (which somehow automatically becomes an Array) or separate individual variables a,b,c,d,e,f each of which is now a Fixnum.</p>\n\n<p>Also,</p>\n\n<pre><code>a = *ary.flatten.class  # =&gt; [Array]\nb = ary.flatten.class   # =&gt; Array\n</code></pre>\n\n<p>What is the difference between [Array] and Array? (perhaps I should make this a separate question but I can only post every 90min and I want to know now!)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "scaffold"], "answers": [{"comments": [{"owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "reply_to_user": {"reputation": 13, "user_id": 5145551, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4TjK1YMt0Dc/AAAAAAAAAAI/AAAAAAAABiI/UZM-dkVDZDc/photo.jpg?sz=128", "display_name": "Roger Hoffman", "link": "https://stackoverflow.com/users/5145551/roger-hoffman"}, "edited": false, "score": 0, "creation_date": 1441235582, "post_id": 32363018, "comment_id": 52601647, "body": "@RogerHoffman If you would, please go ahead and click the checkbox next to this answer so people will know what worked."}, {"owner": {"reputation": 13, "user_id": 5145551, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4TjK1YMt0Dc/AAAAAAAAAAI/AAAAAAAABiI/UZM-dkVDZDc/photo.jpg?sz=128", "display_name": "Roger Hoffman", "link": "https://stackoverflow.com/users/5145551/roger-hoffman"}, "edited": false, "score": 0, "creation_date": 1441236062, "post_id": 32363018, "comment_id": 52601769, "body": "Would there be a permanent solution to this? I have to issue this command everytime I open terminal."}, {"owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "reply_to_user": {"reputation": 13, "user_id": 5145551, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4TjK1YMt0Dc/AAAAAAAAAAI/AAAAAAAABiI/UZM-dkVDZDc/photo.jpg?sz=128", "display_name": "Roger Hoffman", "link": "https://stackoverflow.com/users/5145551/roger-hoffman"}, "edited": false, "score": 0, "creation_date": 1441237545, "post_id": 32363018, "comment_id": 52602138, "body": "That solution <i>should</i> be permanent. Are you using Homebrew, RVM or Rbenv to manage your Ruby libraries? Did you run <code>bundle install</code> after <code>gem pristine --all</code>?"}, {"owner": {"reputation": 13, "user_id": 5145551, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4TjK1YMt0Dc/AAAAAAAAAAI/AAAAAAAABiI/UZM-dkVDZDc/photo.jpg?sz=128", "display_name": "Roger Hoffman", "link": "https://stackoverflow.com/users/5145551/roger-hoffman"}, "edited": false, "score": 0, "creation_date": 1441239186, "post_id": 32363018, "comment_id": 52602565, "body": "I did that time run bundle install."}, {"owner": {"reputation": 13, "user_id": 5145551, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4TjK1YMt0Dc/AAAAAAAAAAI/AAAAAAAABiI/UZM-dkVDZDc/photo.jpg?sz=128", "display_name": "Roger Hoffman", "link": "https://stackoverflow.com/users/5145551/roger-hoffman"}, "edited": false, "score": 0, "creation_date": 1441239227, "post_id": 32363018, "comment_id": 52602576, "body": "and no i wasn&#39;t runniing rvm. I switched to rvm and did bundle install"}, {"owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "reply_to_user": {"reputation": 13, "user_id": 5145551, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4TjK1YMt0Dc/AAAAAAAAAAI/AAAAAAAABiI/UZM-dkVDZDc/photo.jpg?sz=128", "display_name": "Roger Hoffman", "link": "https://stackoverflow.com/users/5145551/roger-hoffman"}, "edited": false, "score": 0, "creation_date": 1441243881, "post_id": 32363018, "comment_id": 52603516, "body": "@RogerHoffman I&#39;ve updated the answer to include the missing step. You can go ahead and click the checkbox to the left of the answer to let people know what worked for you."}], "tags": [], "owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "is_accepted": true, "score": 2, "last_activity_date": 1441243833, "last_edit_date": 1441243833, "creation_date": 1441227611, "answer_id": 32363018, "question_id": 32362656, "link": "https://stackoverflow.com/questions/32362656/rails-generate-scaffold-error-message/32363018#32363018", "title": "Rails generate scaffold error message", "body": "<p>One of your gems doesn't match your installed Ruby version.</p>\n\n<p>Open up your Terminal utility, <code>cd /Users/macowner/workspace/toy_app</code> and run:</p>\n\n<pre><code>gem pristine --all\nbundle install\n</code></pre>\n\n<p>This command will restore your gems to their original condition at the time you installed them.</p>\n"}], "owner": {"reputation": 13, "user_id": 5145551, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4TjK1YMt0Dc/AAAAAAAAAAI/AAAAAAAABiI/UZM-dkVDZDc/photo.jpg?sz=128", "display_name": "Roger Hoffman", "link": "https://stackoverflow.com/users/5145551/roger-hoffman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1009, "favorite_count": 0, "accepted_answer_id": 32363018, "answer_count": 1, "score": 1, "last_activity_date": 1441243833, "creation_date": 1441226321, "question_id": 32362656, "link": "https://stackoverflow.com/questions/32362656/rails-generate-scaffold-error-message", "title": "Rails generate scaffold error message", "body": "<p>i'm having trouble generating scaffolding in my rails app:rails generate scaffold User name: string email:string</p>\n\n<p>dyld: lazy symbol binding failed: Symbol not found: _rb_str_new_static Referenced from: /Users/macowner/workspace/toy_app/vendor/bundle/gems/json-1.8.3/lib/json/ext/parser.bundle Expected in: flat namespace</p>\n\n<p>dyld: Symbol not found: _rb_str_new_static Referenced from: /Users/macowner/workspace/toy_app/vendor/bundle/gems/json-1.8.3/lib/json/ext/parser.bundle Expected in: flat namespace</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "gem", "rbenv"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1441224847, "post_id": 32362244, "comment_id": 52597301, "body": "You can run it with whatever you want."}, {"owner": {"reputation": 399, "user_id": 719661, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f52d8660c0c8d98223778a71ba89844a?s=128&d=identicon&r=PG&f=1", "display_name": "dcalixto", "link": "https://stackoverflow.com/users/719661/dcalixto"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1441224948, "post_id": 32362244, "comment_id": 52597359, "body": "right so why when i try to start the ap aways show this message:  rbenv: rails: command not found  The `rails&#39; command exists in these Ruby versions:   2.0.0-p0"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1441225843, "post_id": 32362244, "comment_id": 52597798, "body": "You still need to install your bundles."}], "answers": [{"tags": [], "owner": {"reputation": 1829, "user_id": 1442966, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2347a5fea07665538a73887817f30b85?s=128&d=identicon&r=PG", "display_name": "Edward", "link": "https://stackoverflow.com/users/1442966/edward"}, "is_accepted": true, "score": 1, "last_activity_date": 1441225480, "creation_date": 1441225480, "answer_id": 32362457, "question_id": 32362244, "link": "https://stackoverflow.com/questions/32362244/how-update-the-ruby-version-on-a-old-rails-project/32362457#32362457", "title": "How update the ruby version on a old rails project", "body": "<p>You have switched to another version of Ruby and you are probably using a different gemset (probably an empty one). Try running:</p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>Note that after switching to a newer version of Ruby, some of your old code might not be compatible, i.e. need debugging.</p>\n\n<p>Hope this help!</p>\n"}], "owner": {"reputation": 399, "user_id": 719661, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f52d8660c0c8d98223778a71ba89844a?s=128&d=identicon&r=PG&f=1", "display_name": "dcalixto", "link": "https://stackoverflow.com/users/719661/dcalixto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 32362457, "answer_count": 1, "score": -1, "last_activity_date": 1441225480, "creation_date": 1441224661, "question_id": 32362244, "link": "https://stackoverflow.com/questions/32362244/how-update-the-ruby-version-on-a-old-rails-project", "title": "How update the ruby version on a old rails project", "body": "<p>I have a rails 3 app that was made with 2.0.0-p0 ruby.</p>\n\n<p>Now i would like to update just the ruby to 2.2.2</p>\n\n<p>I changed already the local and global ruby on rbenv to 2.2.2.</p>\n\n<blockquote>\n  <p>There is a way or i have to keep using the 2.0.0-p0 on this app?</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "model-view-controller"], "comments": [{"owner": {"reputation": 1219, "user_id": 2463608, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71a718079ab00b87628fd52df9eb6e42?s=128&d=identicon&r=PG", "display_name": "Daiku", "link": "https://stackoverflow.com/users/2463608/daiku"}, "edited": false, "score": 0, "creation_date": 1441224670, "post_id": 32362054, "comment_id": 52597206, "body": "This strikes me as a `has_and_belongs_to_many&#39; relationship."}], "answers": [{"comments": [{"owner": {"reputation": 132, "user_id": 4527342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-AKXe02EY78w/AAAAAAAAAAI/AAAAAAAAAFA/ReagtzxHT90/photo.jpg?sz=128", "display_name": "DarkCoderRises", "link": "https://stackoverflow.com/users/4527342/darkcoderrises"}, "edited": false, "score": 0, "creation_date": 1441224849, "post_id": 32362250, "comment_id": 52597303, "body": "how to add data into it, and extract from it. Sorry, I am just starting in ruby"}, {"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "reply_to_user": {"reputation": 132, "user_id": 4527342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-AKXe02EY78w/AAAAAAAAAAI/AAAAAAAAAFA/ReagtzxHT90/photo.jpg?sz=128", "display_name": "DarkCoderRises", "link": "https://stackoverflow.com/users/4527342/darkcoderrises"}, "edited": false, "score": 0, "creation_date": 1441225921, "post_id": 32362250, "comment_id": 52597848, "body": "@HARSHILGOEL look at my updated answer. Let me know if you have any other questions."}, {"owner": {"reputation": 132, "user_id": 4527342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-AKXe02EY78w/AAAAAAAAAAI/AAAAAAAAAFA/ReagtzxHT90/photo.jpg?sz=128", "display_name": "DarkCoderRises", "link": "https://stackoverflow.com/users/4527342/darkcoderrises"}, "edited": false, "score": 0, "creation_date": 1441226237, "post_id": 32362250, "comment_id": 52598033, "body": "I have to create the join table using rails generate model users_projects, right? and then add to model of users_project belong to user , project"}, {"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "reply_to_user": {"reputation": 132, "user_id": 4527342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-AKXe02EY78w/AAAAAAAAAAI/AAAAAAAAAFA/ReagtzxHT90/photo.jpg?sz=128", "display_name": "DarkCoderRises", "link": "https://stackoverflow.com/users/4527342/darkcoderrises"}, "edited": false, "score": 0, "creation_date": 1441226319, "post_id": 32362250, "comment_id": 52598072, "body": "You don&#39;t need a model for that. You just need the <code>users_projects</code>. This can be a part of your migration when you create <code>users</code> and <code>project</code> tables. See the example here: <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-and-belongs-to-many-association\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}, {"owner": {"reputation": 132, "user_id": 4527342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-AKXe02EY78w/AAAAAAAAAAI/AAAAAAAAAFA/ReagtzxHT90/photo.jpg?sz=128", "display_name": "DarkCoderRises", "link": "https://stackoverflow.com/users/4527342/darkcoderrises"}, "edited": false, "score": 0, "creation_date": 1441227082, "post_id": 32362250, "comment_id": 52598495, "body": "So, I create table in both or only in user?"}, {"owner": {"reputation": 132, "user_id": 4527342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-AKXe02EY78w/AAAAAAAAAAI/AAAAAAAAAFA/ReagtzxHT90/photo.jpg?sz=128", "display_name": "DarkCoderRises", "link": "https://stackoverflow.com/users/4527342/darkcoderrises"}, "reply_to_user": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "edited": false, "score": 0, "creation_date": 1441227118, "post_id": 32362250, "comment_id": 52598521, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/88628/discussion-between-harshil-goel-and-k-m-rakibul-islam\">continue this discussion in chat</a>."}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1441227556, "post_id": 32362250, "comment_id": 52598705, "body": "Would this prevent a single person from being both the owner of the project and working on it?"}, {"owner": {"reputation": 132, "user_id": 4527342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-AKXe02EY78w/AAAAAAAAAAI/AAAAAAAAAFA/ReagtzxHT90/photo.jpg?sz=128", "display_name": "DarkCoderRises", "link": "https://stackoverflow.com/users/4527342/darkcoderrises"}, "edited": false, "score": 0, "creation_date": 1441240527, "post_id": 32362250, "comment_id": 52602878, "body": "When I Run , project.project_users, I get ActiveRecord::StatementInvalid: Could not find table &#39;projects_users&#39;"}, {"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "edited": false, "score": 0, "creation_date": 1441364809, "post_id": 32362250, "comment_id": 52661452, "body": "I cloned your github repo. But, I don&#39;t see any such models. Please push the latest changes so that I can take a look what is wrong in there. Thanks."}], "tags": [], "owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "is_accepted": false, "score": 2, "last_activity_date": 1441228867, "last_edit_date": 1441228867, "creation_date": 1441224673, "answer_id": 32362250, "question_id": 32362054, "link": "https://stackoverflow.com/questions/32362054/multiple-relations-between-two-models-in-rails/32362250#32362250", "title": "Multiple relations between two models in Rails", "body": "<p>One way of designing the models would be to have a separate <code>ProjectOwner</code> and <code>ProjectUser</code> models both of them are inherited from <code>User</code> model.\nand having <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-and-belongs-to-many-association\" rel=\"nofollow\">has_and_belongs_to_many</a> association between <code>Project</code> and <code>ProjectUser</code> models.</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  belongs_to :project_owner\n  has_and_belongs_to_many :project_users\nend\n\nclass User &lt; ActiveRecord::Base\n  has_secure_password\n  # other common attributes here\nend\n\nclass ProjectOwner &lt; User\n  has_many :projects\nend\n\nclass ProjectUser &lt; User\n  has_and_belongs_to_many :projects\nend\n</code></pre>\n\n<p>Add a <code>project_owner_id</code> column in your <code>projects</code> table. </p>\n\n<p>Create a join table <code>project_users_projects</code> which will look like this:</p>\n\n<pre><code>create_table :project_users_projects, id: false do |t|\n  t.belongs_to :project_user, index: true\n  t.belongs_to :project, index: true\nend \n</code></pre>\n\n<p>Then, you will be able to do things like these:</p>\n\n<pre><code>project_owner = project.project_owner\nproject_owner_projects = project_owner.projects\nproject_user_projects = project_user.projects\nproject_users = project.project_users\n</code></pre>\n"}], "owner": {"reputation": 132, "user_id": 4527342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-AKXe02EY78w/AAAAAAAAAAI/AAAAAAAAAFA/ReagtzxHT90/photo.jpg?sz=128", "display_name": "DarkCoderRises", "link": "https://stackoverflow.com/users/4527342/darkcoderrises"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441228867, "creation_date": 1441224050, "question_id": 32362054, "link": "https://stackoverflow.com/questions/32362054/multiple-relations-between-two-models-in-rails", "title": "Multiple relations between two models in Rails", "body": "<p>I have a model User and Project in Rails. A Project have a owner (User) and multiple people working on it (User). \nI have tried this model </p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  belongs_to :owner, class_name: \"User\"\n  has_many :users\n\nend\n\nclass User &lt; ActiveRecord::Base\n  has_secure_password\n\n  has_many :projects\nend\n</code></pre>\n\n<p>But then was unable to put values into the record for association. Can someone suggest me what to do.\n(I need to get what projects a user own, works on. Project's owner and people who work in it)\nThanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash", "key"], "answers": [{"comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1441223414, "post_id": 32361815, "comment_id": 52596555, "body": "This is best, as it is o(1)."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1441223730, "post_id": 32361815, "comment_id": 52596729, "body": "Your first solution is what I liked most."}, {"owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "edited": false, "score": 0, "creation_date": 1441235519, "post_id": 32361815, "comment_id": 52601625, "body": "Hi Wand, thank you for the answer. I am testing it, but the output is still <code>false</code> (<code>p is_permitted</code>), no matter if I am on an approved page or not. Do I overlook something or what I do wrong?"}], "tags": [], "owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "is_accepted": false, "score": 1, "last_activity_date": 1441224062, "last_edit_date": 1441224062, "creation_date": 1441223080, "answer_id": 32361815, "question_id": 32361761, "link": "https://stackoverflow.com/questions/32361761/rails-how-to-check-if-key-and-value-in-a-hash-match-given-parameters/32361815#32361815", "title": "Rails - how to check if key and value in a hash match given parameters?", "body": "<p>You can do something like this:</p>\n\n<pre><code>key = params[:controller]\nvalue= params[:action]\np is_permitted = (AUTH_MODERATOR_DEFINITIONS[key] == value)\n</code></pre>\n\n<p>However, I think you may revise values in your hash to be array at some point, as it is unlikely that a controller will have only one action, and hence, user can have access to multiple actions. For example:</p>\n\n<pre><code>AUTH_MODERATOR_DEFINITIONS = {\n    \"articles\" =&gt; \"index\",\n    \"readers\"  =&gt; \"index\",\n    \"commenters\"  =&gt; [\"index\",\"new\",\"update\"] # Added by me to show possible use case\n}\n</code></pre>\n\n<p>Considering the above scenario, I think you can do something like this.  This will work in both scenarios (your example, and my extension to that example)</p>\n\n<pre><code>key = params[:controller]\nvalue= params[:action]\n\np is_permitted = [AUTH_MODERATOR_DEFINITIONS[key]].flatten.include?(value)\n</code></pre>\n"}], "owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441224062, "creation_date": 1441222890, "question_id": 32361761, "link": "https://stackoverflow.com/questions/32361761/rails-how-to-check-if-key-and-value-in-a-hash-match-given-parameters", "title": "Rails - how to check if key and value in a hash match given parameters?", "body": "<p>I am working on a simple authorization in a Rails 4 app. Each user has a role; then I set up pages they can access, for example:</p>\n\n<pre><code>AUTH_MODERATOR_DEFINITIONS = {\"articles\"     =&gt; \"index\",\n                              \"readers\"  =&gt; \"index\"}\n</code></pre>\n\n<p>Then, in a controller action, I will call:</p>\n\n<pre><code>def index\n  check_permissions(current_admin)\n  ...\nend\n</code></pre>\n\n<p>And in the <code>ApplicationController</code>:</p>\n\n<pre><code>  def check_permissions(current_admin)\n    if current_admin.role == 1 # for moderators\n      # find a pair key-vale AUTH_DISPATCHER_DEFINITIONS that matches `params[:controller]` and `params[:action]\n    else\n      redirect_to root_path, :alert =&gt; \"No permission\"\n    end\n  end\n</code></pre>\n\n<p>But how to search a hash according to key AND value?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "ruby", "mri"], "answers": [{"comments": [{"owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "edited": false, "score": 0, "creation_date": 1441274579, "post_id": 32361813, "comment_id": 52616446, "body": "Credits to you man :) <a href=\"https://github.com/ruby/ruby/commit/e26ba49bd15079b5567048ef1714c2b6d1719eee\" rel=\"nofollow noreferrer\">github.com/ruby/ruby/commit/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "is_accepted": true, "score": 2, "last_activity_date": 1441223879, "last_edit_date": 1441223879, "creation_date": 1441223076, "answer_id": 32361813, "question_id": 32361688, "link": "https://stackoverflow.com/questions/32361688/where-error-message-argumenterror-no-id-given-comes-from-when-calling-method-mi/32361813#32361813", "title": "Where error message ArgumentError: no id given comes from when calling method_missing", "body": "<p><a href=\"https://www.omniref.com/ruby/2.2.0/files/vm_eval.c#line=683\" rel=\"nofollow\"><code>raise_method_missing()</code></a> does raise that argument error:</p>\n\n<pre><code>static void\nraise_method_missing(rb_thread_t *th, int argc, const VALUE *argv, VALUE obj,\n                     int last_call_status)\n{\n    // ...\n    if (argc == 0 || !SYMBOL_P(argv[0])) {\n        rb_raise(rb_eArgError, \"no id given\");\n    }\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 32361813, "answer_count": 1, "score": -1, "last_activity_date": 1441223879, "creation_date": 1441222578, "last_edit_date": 1592644375, "question_id": 32361688, "link": "https://stackoverflow.com/questions/32361688/where-error-message-argumenterror-no-id-given-comes-from-when-calling-method-mi", "title": "Where error message ArgumentError: no id given comes from when calling method_missing", "body": "<p>When you call <code>method_missing</code> with first parameter as <code>'string'</code> instead of <code>:symbol</code> you get this cryptic error message:</p>\n<pre><code>BasicObject.send(:method_missing, 'any-method')\nArgumentError: no id given\nfrom (pry):3:in `method_missing'\n</code></pre>\n<p>When you look at the <a href=\"https://www.omniref.com/ruby/2.2.0/symbols/BasicObject/method_missing?#annotation=4439641&amp;line=650\" rel=\"nofollow noreferrer\">source code</a> for method_missing</p>\n<pre><code>static VALUE\nrb_method_missing(int argc, const VALUE *argv, VALUE obj)\n{\n    rb_thread_t *th = GET_THREAD();\n    raise_method_missing(th, argc, argv, obj, th-&gt;method_missing_reason);\n    UNREACHABLE;\n}\n</code></pre>\n<p>there is nothing with error message <code>ArgumentError: no id given</code>.\nWhere it comes from?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", ".htaccess", "bluehost"], "comments": [{"owner": {"reputation": 6706, "user_id": 569374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948f8031e9110f7fc6d53ccb9abddb5f?s=128&d=identicon&r=PG", "display_name": "Michael Papile", "link": "https://stackoverflow.com/users/569374/michael-papile"}, "edited": false, "score": 0, "creation_date": 1441222687, "post_id": 32361193, "comment_id": 52596111, "body": "Are you sure you are not running RVM or something like that when installing gems? It seems that the ruby env running under FCGI is not the same. That would explain ruby not finding the gem. Ruby 2.2.3 is quite new I would be surprised if Bluehost is running that. Try echoing the ruby version in your web app <code>puts RUBY_VERSION</code>"}, {"owner": {"reputation": 26124, "user_id": 171950, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ccee38944752d481128936450ddb687e?s=128&d=identicon&r=PG", "display_name": "Muhammad Hewedy", "link": "https://stackoverflow.com/users/171950/muhammad-hewedy"}, "reply_to_user": {"reputation": 6706, "user_id": 569374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948f8031e9110f7fc6d53ccb9abddb5f?s=128&d=identicon&r=PG", "display_name": "Michael Papile", "link": "https://stackoverflow.com/users/569374/michael-papile"}, "edited": false, "score": 0, "creation_date": 1441222907, "post_id": 32361193, "comment_id": 52596249, "body": "I installed it myself from source, not using rvm."}, {"owner": {"reputation": 26124, "user_id": 171950, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ccee38944752d481128936450ddb687e?s=128&d=identicon&r=PG", "display_name": "Muhammad Hewedy", "link": "https://stackoverflow.com/users/171950/muhammad-hewedy"}, "reply_to_user": {"reputation": 6706, "user_id": 569374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948f8031e9110f7fc6d53ccb9abddb5f?s=128&d=identicon&r=PG", "display_name": "Michael Papile", "link": "https://stackoverflow.com/users/569374/michael-papile"}, "edited": false, "score": 0, "creation_date": 1441222963, "post_id": 32361193, "comment_id": 52596285, "body": "my app completely is not accessible when access my domain name in the browser"}, {"owner": {"reputation": 26124, "user_id": 171950, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ccee38944752d481128936450ddb687e?s=128&d=identicon&r=PG", "display_name": "Muhammad Hewedy", "link": "https://stackoverflow.com/users/171950/muhammad-hewedy"}, "reply_to_user": {"reputation": 6706, "user_id": 569374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948f8031e9110f7fc6d53ccb9abddb5f?s=128&d=identicon&r=PG", "display_name": "Michael Papile", "link": "https://stackoverflow.com/users/569374/michael-papile"}, "edited": false, "score": 0, "creation_date": 1441223002, "post_id": 32361193, "comment_id": 52596310, "body": "I think the right question is, how to make that <code>FCGI</code> thing to point to my newly installed ruby versions?"}], "owner": {"reputation": 26124, "user_id": 171950, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ccee38944752d481128936450ddb687e?s=128&d=identicon&r=PG", "display_name": "Muhammad Hewedy", "link": "https://stackoverflow.com/users/171950/muhammad-hewedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441220743, "creation_date": 1441220743, "question_id": 32361193, "link": "https://stackoverflow.com/questions/32361193/bluehost-using-rails-4-error-could-not-find-rake-10-4-2-in-any-of-the-sources", "title": "Bluehost using rails 4 error: Could not find rake-10.4.2 in any of the sources (Bundler::GemNotFound)", "body": "<p>I am using rails 4 on blue-host, every thing goes fine during the installation.</p>\n\n<p>here's output from my shared machine:</p>\n\n<pre><code># ruby --version &amp;&amp; rails --version &amp;&amp; rake --version &amp;&amp; gem --version\nruby 2.2.3p173 (2015-08-18 revision 51636) [x86_64-linux]\nWarning: Running `gem pristine --all` to regenerate your installed gemspecs (and deleting then reinstalling your bundle if you use bundle --path) will improve the startup performance of Spring.\nRails 4.2.4\nrake, version 10.4.2\n2.4.5.1\n</code></pre>\n\n<p>And rails app start when I run rails s:</p>\n\n<pre><code># rails s\nWarning: Running `gem pristine --all` to regenerate your installed gemspecs (and deleting then reinstalling your bundle if you use bundle --path) will improve the startup performance of Spring.\n=&gt; Booting WEBrick\n=&gt; Rails 4.2.4 application starting in development on http://localhost:3000\n=&gt; Run `rails server -h` for more startup options\n=&gt; Ctrl-C to shutdown server\n[2015-09-02 13:02:15] INFO  WEBrick 1.3.1\n[2015-09-02 13:02:15] INFO  ruby 2.2.3 (2015-08-18) [x86_64-linux]\n[2015-09-02 13:02:15] INFO  WEBrick::HTTPServer#start: pid=11143 port=3000\n</code></pre>\n\n<p>And here's my .htaccess and dispatch.fcgi files:</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire File.dirname(__FILE__) + \"/../config/environment\"require 'fcgi_handler'\nRailsFCGIHandler.process!\n</code></pre>\n\n<p>-</p>\n\n<pre><code>&lt;IfModule mod_passenger.c&gt;\nOptions -MultiViews\nPassengerResolveSymlinksInDocumentRoot on\n#Set this to whatever environment you'll be running in\n#PassengerRuby /home1/myapp/ruby\nRailsEnv production\nRackBaseURI /\nPassengerAppRoot /home1/user/rails_apps/myapp\nSetEnv GEM_HOME /home1/user/ruby/gems\nSetEnv GEM_PATH /home1/user/ruby/gems\n&lt;/IfModule&gt;\n</code></pre>\n\n<p>And I am linking my app public to ~/public_html:</p>\n\n<pre><code>public_html -&gt; rails_apps/myapp/public\n</code></pre>\n\n<p>But I got the error <code>Could not find rake-10.4.2 in any of the sources (Bundler::GemNotFound)</code> when access my rails app from the browser.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model"], "comments": [{"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "edited": false, "score": 0, "creation_date": 1441221349, "post_id": 32361183, "comment_id": 52595438, "body": "Why do you have <code>.to_i</code> for some holes and not for other holes? However, the idea is, you can define a <code>score</code> method in your <code>Game</code> model where you can add all the holes of the <code>Game</code> model. Then, from view, you can just call <code>game.score</code> on the <code>game</code> object."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1441221975, "post_id": 32361183, "comment_id": 52595740, "body": "Why do you have one extra column for each hole? Why not store them in a separate table? That would help you avoid the hidden duplicate of hole 10 as well."}, {"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "edited": false, "score": 0, "creation_date": 1441222233, "post_id": 32361183, "comment_id": 52595887, "body": "I think you meant to write <code>hole_18</code> instead of <code>hole_10</code> again at the end and got a typo in there."}], "answers": [{"comments": [{"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1441222141, "post_id": 32361258, "comment_id": 52595844, "body": "Yeah, I would consider having separate tables for them as well. But, I tried to keep my answer as short as possible and as much aligned with the OP as possible. Thanks for pointing that :)"}], "tags": [], "owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "is_accepted": true, "score": 0, "last_activity_date": 1441221434, "last_edit_date": 1441221434, "creation_date": 1441220982, "answer_id": 32361258, "question_id": 32361183, "link": "https://stackoverflow.com/questions/32361183/ruby-on-rails-doing-addition-in-the-model/32361258#32361258", "title": "Ruby on Rails - Doing addition in the model", "body": "<p>In your model, define a method <code>score</code>:</p>\n\n<pre><code>def score\n  self.hole_1 + self.hole_2 + self.hole_3 + self.hole_4 + self.hole_5 +\n      self.hole_6 + self.hole_7 + self.hole_8 + self.hole_9 +\n      self.hole_10.to_i + self.hole_11.to_i + self.hole_12.to_i +\n      self.hole_13.to_i + self.hole_14.to_i + self.hole_15.to_i +\n      self.hole_16.to_i + self.hole_17.to_i + self.hole_10.to_i\nend\n</code></pre>\n\n<p>Then, in your view, just call that <code>score</code> method on a <code>Game</code> object:</p>\n\n<pre><code>&lt;%= game.score %&gt;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5236385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c59f72d9184094c3aeaee97da441eaa?s=128&d=identicon&r=PG&f=1", "display_name": "jthyten", "link": "https://stackoverflow.com/users/5236385/jthyten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 32361258, "answer_count": 1, "score": 1, "last_activity_date": 1441221434, "creation_date": 1441220710, "question_id": 32361183, "link": "https://stackoverflow.com/questions/32361183/ruby-on-rails-doing-addition-in-the-model", "title": "Ruby on Rails - Doing addition in the model", "body": "<p>I'm brand new to Rails. I have a simple golf app that you can track you score on each hole.  I want to calculate the total score for each game.  I currently have this code in the view (which works just fine):</p>\n\n<pre><code>&lt;td&gt;&lt;%= game.hole_1 + game.hole_2 + game.hole_3 + game.hole_4 + game.hole_5 + game.hole_6 + game.hole_7 + game.hole_8 + game.hole_9 + game.hole_10.to_i + game.hole_11.to_i + game.hole_12.to_i + game.hole_13.to_i + game.hole_14.to_i + game.hole_15.to_i + game.hole_16.to_i + game.hole_17.to_i + game.hole_10.to_i %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>I know this isn't the rails way so I was wondering how I would put this logic into the model so that I can write <code>&lt;%= game.score %&gt;</code> in the view</p>\n"}, {"tags": ["ruby", "cucumber", "feature-file"], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 3236557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p6V9b.jpg?s=128&g=1", "display_name": "Kirill Zhukov", "link": "https://stackoverflow.com/users/3236557/kirill-zhukov"}, "is_accepted": true, "score": 1, "last_activity_date": 1441223370, "creation_date": 1441223370, "answer_id": 32361882, "question_id": 32360080, "link": "https://stackoverflow.com/questions/32360080/is-there-any-alternative-for-scenario-steps-method-in-cucucmber-2-0-0/32361882#32361882", "title": "is there any alternative for scenario.steps method in cucucmber 2.0.0?", "body": "<p>Not sure about <code>2.0.0</code>, but with <code>2.0.2</code> I am able to get steps like that:<br>\n<code>scenario.test_steps</code>.<br>\nDoesn't matter if it's scenario outline or not.</p>\n\n<p>And if you need array of steps names:<br>\n<code>scenario.test_steps.map(&amp;:name)</code></p>\n"}], "owner": {"reputation": 184, "user_id": 4847664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d668097907d35b74564ed0365cf1b1f3?s=128&d=identicon&r=PG&f=1", "display_name": "Annette", "link": "https://stackoverflow.com/users/4847664/annette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 32361882, "answer_count": 1, "score": 0, "last_activity_date": 1486989740, "creation_date": 1441216707, "question_id": 32360080, "link": "https://stackoverflow.com/questions/32360080/is-there-any-alternative-for-scenario-steps-method-in-cucucmber-2-0-0", "title": "is there any alternative for scenario.steps method in cucucmber 2.0.0?", "body": "<p>I have just upgraded to Cucumber 2.0.0 and looks the version 2 is not supporting the steps method for the scenario.</p>\n\n<p>The below code in the my hooks is not working due to this and  dont see any alternative method in ruby docs for cucumber version 2.0.0 </p>\n\n<pre><code>@step_t = Array.new\nscenario.steps.each do |step|\n  @step_t.push(\"#{step.name}\")\nend\n</code></pre>\n\n<p>Please let me know if anyone got a chance to get the steps of a scenario using cucumber 2.0.0</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5293374, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/07a4855615e46da96d42aa6bd9689f66?s=128&d=identicon&r=PG&f=1", "display_name": "Anubix", "link": "https://stackoverflow.com/users/5293374/anubix"}, "edited": false, "score": 0, "creation_date": 1441230541, "post_id": 32359656, "comment_id": 52600016, "body": "Thanks for help. Friendly_id looks nice, but route_translator is something different. It add fr/de/es language to url. If i uderstand it correctly, when i will use my website only in germany language, i will have prefix /de/ in all urls. It&#39;s not what i need. I have my website in one language, but the language is different then language in code."}, {"owner": {"reputation": 101, "user_id": 5293374, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/07a4855615e46da96d42aa6bd9689f66?s=128&d=identicon&r=PG&f=1", "display_name": "Anubix", "link": "https://stackoverflow.com/users/5293374/anubix"}, "edited": false, "score": 0, "creation_date": 1441296547, "post_id": 32359656, "comment_id": 52631595, "body": "Thanks this is exactly what I need."}], "tags": [], "owner": {"reputation": 1328, "user_id": 4434754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/229f3471c616c096f92e3d2ef79f87e7?s=128&d=identicon&r=PG", "display_name": "Florent Ferry", "link": "https://stackoverflow.com/users/4434754/florent-ferry"}, "is_accepted": true, "score": 1, "last_activity_date": 1441279775, "last_edit_date": 1441279775, "creation_date": 1441215257, "answer_id": 32359656, "question_id": 32359395, "link": "https://stackoverflow.com/questions/32359395/local-language-and-seo-friendly-urls-in-ruby-on-rails-4/32359656#32359656", "title": "Local language and SEO friendly urls in Ruby on Rails 4", "body": "<p>You can use <a href=\"https://github.com/enriclluelles/route_translator\" rel=\"nofollow\">route_translator</a> gem for this task.</p>\n\n<p>You have just to wrap your routes you want to be localized in a <code>localized</code> block, and add translations to your locale files.</p>\n\n<p>For friendly urls, you can use <a href=\"https://github.com/norman/friendly_id\" rel=\"nofollow\">friendly_id</a>.</p>\n\n<p>Edit:\nConsidering your comment, you can use <code>path</code> in your routes:</p>\n\n<pre><code>resources :users, path: 'betnuzer', path_names: { new: 'schaffen', edit: 'bearbeiten' }\n</code></pre>\n\n<p>Then you can use <code>users_path</code>, etc in your backend, and your routes are translated.</p>\n"}], "owner": {"reputation": 101, "user_id": 5293374, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/07a4855615e46da96d42aa6bd9689f66?s=128&d=identicon&r=PG&f=1", "display_name": "Anubix", "link": "https://stackoverflow.com/users/5293374/anubix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 32359656, "answer_count": 1, "score": 2, "last_activity_date": 1441279775, "creation_date": 1441214411, "question_id": 32359395, "link": "https://stackoverflow.com/questions/32359395/local-language-and-seo-friendly-urls-in-ruby-on-rails-4", "title": "Local language and SEO friendly urls in Ruby on Rails 4", "body": "<p>I have problem with renaming urls for local language in Ruby on Rails 4. I am writing all apps (backend) in English, I think its good practise. For frontend I just use local language, but problem is in Rails 4 that I don't know how to rename URls to local language.</p>\n\n<p>I have url like this <strong>www.website.com/users/1</strong> . I am using resources :users in routes.rb. I found as '' part, but it changes all paths as well. </p>\n\n<p>So when i am using routes for Germany language:\n<strong>resources :users as 'Benutzer'</strong>  then i have to change all paths in backend to benutzer_path etc.. and this is what i don't want. It should still be user_path in backend. How i can do this?</p>\n\n<p>The second question is I want to use friendly urls. I use the example with users, and I want to write all users from any town, url will generally looks like this: <strong>www.website.com/towns/id/users/id</strong></p>\n\n<p>And it's not nice for many reasons. How i can change this to something like this: <strong>www.website.com/town_name/user_name</strong>  ?</p>\n\n<p>Thanks for help</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1441214559, "post_id": 32359234, "comment_id": 52591691, "body": "<a href=\"https://github.com/rest-client/rest-client\" rel=\"nofollow noreferrer\">github.com/rest-client/rest-client</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1441214791, "post_id": 32359234, "comment_id": 52591827, "body": "If you are building a gem then this dependency should be declared in your gemspec file. Here is a great tutorial on <a href=\"https://quickleft.com/blog/engineering-lunch-series-step-by-step-guide-to-building-your-first-ruby-gem/\" rel=\"nofollow noreferrer\">Building Your First Gem</a>. Also <code>gems</code> and <code>rails</code> are very different things. <code>rails</code> is to build web applications and utilizes gems where as a <code>gem</code> is a plugin library."}, {"owner": {"reputation": 1179, "user_id": 2858044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b99bf8baf41337577e4e425677080472?s=128&d=identicon&r=PG&f=1", "display_name": "itx", "link": "https://stackoverflow.com/users/2858044/itx"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1441215322, "post_id": 32359234, "comment_id": 52592124, "body": "@engineersmnky thanks, I forgot to <code>add_dependency</code>.."}], "answers": [{"comments": [{"owner": {"reputation": 1179, "user_id": 2858044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b99bf8baf41337577e4e425677080472?s=128&d=identicon&r=PG&f=1", "display_name": "itx", "link": "https://stackoverflow.com/users/2858044/itx"}, "edited": false, "score": 0, "creation_date": 1441214438, "post_id": 32359365, "comment_id": 52591632, "body": "thanks, but I&#39;m using this <a href=\"https://github.com/treeder/rest_client\" rel=\"nofollow noreferrer\">github.com/treeder/rest_client</a>, and I should use <code>require &#39;rest_client&#39;</code>, and also I have tried that before I ask this question."}, {"owner": {"reputation": 1142, "user_id": 3562561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5455f5135299cdb6b4640148fa176f9f?s=128&d=identicon&r=PG", "display_name": "treiff", "link": "https://stackoverflow.com/users/3562561/treiff"}, "reply_to_user": {"reputation": 1179, "user_id": 2858044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b99bf8baf41337577e4e425677080472?s=128&d=identicon&r=PG&f=1", "display_name": "itx", "link": "https://stackoverflow.com/users/2858044/itx"}, "edited": false, "score": 0, "creation_date": 1441214666, "post_id": 32359365, "comment_id": 52591750, "body": "Interesting, I just installed the gem to try it using ruby 2.2.2.  <code>require rest-client</code> worked, however returned a depreciation message: <code>WARNING: The rest_client gem is deprecated and will be removed from RubyGems. Please use rest-client gem instead.</code>"}], "tags": [], "owner": {"reputation": 1142, "user_id": 3562561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5455f5135299cdb6b4640148fa176f9f?s=128&d=identicon&r=PG", "display_name": "treiff", "link": "https://stackoverflow.com/users/3562561/treiff"}, "is_accepted": false, "score": 0, "last_activity_date": 1441214320, "creation_date": 1441214320, "answer_id": 32359365, "question_id": 32359234, "link": "https://stackoverflow.com/questions/32359234/require-cannot-load-such-file-rest-client-loaderror/32359365#32359365", "title": "`require&#39;: cannot load such file -- rest_client (LoadError)", "body": "<p>I think you need to try <code>require 'rest-client'</code></p>\n"}, {"tags": [], "owner": {"reputation": 82, "user_id": 5253143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/797f48bd59184071db53596b05c3748f?s=128&d=identicon&r=PG&f=1", "display_name": "Dayvson Lima", "link": "https://stackoverflow.com/users/5253143/dayvson-lima"}, "is_accepted": false, "score": 0, "last_activity_date": 1441214443, "creation_date": 1441214443, "answer_id": 32359412, "question_id": 32359234, "link": "https://stackoverflow.com/questions/32359234/require-cannot-load-such-file-rest-client-loaderror/32359412#32359412", "title": "`require&#39;: cannot load such file -- rest_client (LoadError)", "body": "<p>Try below - </p>\n\n<pre><code>require 'rest-client'\n</code></pre>\n"}], "owner": {"reputation": 1179, "user_id": 2858044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b99bf8baf41337577e4e425677080472?s=128&d=identicon&r=PG&f=1", "display_name": "itx", "link": "https://stackoverflow.com/users/2858044/itx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3371, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1441214443, "creation_date": 1441213930, "question_id": 32359234, "link": "https://stackoverflow.com/questions/32359234/require-cannot-load-such-file-rest-client-loaderror", "title": "`require&#39;: cannot load such file -- rest_client (LoadError)", "body": "<p>I'm building first gems, I want to use rest_client gems for my gems, I have put <code>gem 'rest_client', '~&gt; 1.8.3'</code> on <code>lib/foo/Gemfile</code>, and this my file</p>\n\n<pre><code># lib/foo/lib/foo.rb\n\nrequire 'rest_client'\nrequire 'json'\nrequire \"foo/version\"\n\nmodule Foo\n # other stuff here\nend\n</code></pre>\n\n<p>when I run <code>rails c</code> I get this error :</p>\n\n<pre><code>/home/user/.rvm/gems/ruby-2.1.2/gems/activesupport-4.2.1/lib/active_support/dependencies.rb:274:in `require': cannot load such file -- rest_client (LoadError)\n</code></pre>\n\n<p>note : I have installed my gems in rails apps </p>\n"}, {"tags": ["ruby", "overriding", "method-hiding"], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 10, "last_activity_date": 1441213391, "last_edit_date": 1441213391, "creation_date": 1441213054, "answer_id": 32358958, "question_id": 32358521, "link": "https://stackoverflow.com/questions/32358521/ruby-hiding-vs-overriding/32358958#32358958", "title": "Ruby hiding vs overriding", "body": "<p>Java has three different kinds of \"methods\": instance methods, static methods and constructors. Ruby only has one: instance methods.</p>\n\n<p>In Java, static methods <em>must</em> behave differently from instance methods, because classes aren't objects. They have no class, therefore no superclass, so there is nothing to override. In Ruby, classes are objects just like any other object, they have a class, which can have a superclass, and thus subclasses can override superclass methods.</p>\n\n<p>Note: you may have heard about class methods or singleton methods in Ruby. That's a lie. Well, okay, not a lie. It's a convenient shorthand we use, because \"class method\" is easier to pronounce than \"regular instance method of the class object's singleton class\" \u2026 but that's precisely what it is. There are no class methods.</p>\n\n<p>In Ruby, every object can have methods of its own. These are called \"singleton methods\". Classes are objects like any other object, so they can have singleton methods, too. When the object a singleton method belongs to is a class, we call that method a class method. But that's just what we call it, there is no difference between a class method and a singleton method.</p>\n\n<p>Actually, in Ruby, every object has a singleton class. The singleton class is in a 1:1 relation with the object: the object has exactly one singleton class and each singleton class has exactly one instance, its object. So, when I said above that objects can have methods and those methods are called singleton methods? Well, that was a lie, too. Singleton methods are really just standard instance methods, which happen to be defined in the singleton class of an object, and thus can be called <em>only</em> on that object (because that object is the only instance of its singleton class).</p>\n\n<p>So, when a method is defined in a singleton class, we call it a singleton method and when the singleton class belongs to a class, we call it a class method, but it's all just instance methods. (BTW: modules work the same way. In that case, they are called module methods or sometimes \"module functions\".)</p>\n\n<p>The <code>class</code> pointer of an object <em>always</em> points to its singleton class. The <em>actual</em> class of an object is then the <code>superclass</code> of the singleton class, i.e. the singleton class's <code>superclass</code> pointer points to the actual class of the object. (Unless there are mixins, which become superclasses of the class they are mixed into, so if you mix a module into a singleton class, the module becomes the superclass of the singleton class, and the old superclass becomes the superclass of the module, or rather its include proxy class.)</p>\n\n<p>What this means is that <em>method lookup</em>, which is the most often performed operation in an OO language, becomes really simple and really fast: grab the object, grab its <code>class</code> pointer, see if the method is there, grab the superclass pointer, see if the method is there, grab the superclass pointer \u2026 until you found the method.</p>\n\n<p>It does mean that reflection gets a little more complex, but reflection is not a performance-critical operation. For example, if you ask an object for its class, you can't simply return the <code>class</code> pointer, as that would always be its singleton class and thus not very informative. You have to get the superclass, and the superclass's superclass and so on, until you end up at a class which is not a singleton class or an include proxy class.</p>\n\n<p>But method lookup itself is very simple, and <code>super</code> always does what you expect.</p>\n\n<p>In particular, when you create a new class, the singleton class of the superclass becomes the superclass of the singleton class of the subclass, so that \"class methods\" are inherited just as you would expect.</p>\n\n<p>So, to recap: while Java has three different kinds of \"methods\" with different inheritance behavior (instance methods get inherited, static methods don't, constructors get inherited but have this <code>super</code> calling restriction), Ruby has only one. It has, however, three different kinds of classes: regular classes, singleton classes, and include proxy classes (created as proxies for mixins, when mixing a module into a class). The latter two are also called \"virtual classes\" inside of YARV, the most widely-used Ruby implementation.</p>\n\n<p>One last thing: there are also so-called \"global methods\", sometimes called \"global procedures\" or \"global functions\". Again, as you probably guessed already, these don't exist. When you define a method outside of any class, it implicitly becomes a private instance method of <code>Object</code> and thus available for every object.</p>\n\n<p>[I ignored two things here: <code>BasicObject</code> and <code>prepend</code>. These complicate matters somewhat, especially the latter. But the main mental model remains.]</p>\n"}], "owner": {"reputation": 61, "user_id": 5290482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6b44b3203791f4187204faa9b72f3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/5290482/javier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 2, "accepted_answer_id": 32358958, "answer_count": 1, "score": 5, "last_activity_date": 1441213391, "creation_date": 1441211789, "last_edit_date": 1441213118, "question_id": 32358521, "link": "https://stackoverflow.com/questions/32358521/ruby-hiding-vs-overriding", "title": "Ruby hiding vs overriding", "body": "<p>I've just learned that in Java there is a distinction between overriding and hiding (static methods are hidden not overriden) which implies that Java uses both early and late binding. </p>\n\n<p>Is there something similar to method hiding or it does it just have method overriding?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1441212270, "post_id": 32358507, "comment_id": 52590224, "body": "Why not build this array in the module, where constants can be accessed by short name?"}], "answers": [{"comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1441212356, "post_id": 32358597, "comment_id": 52590269, "body": "Thanks @SergioTulentsev By the way, what is the recipe of becoming Ruby Ninja like you (and few others who at SO have answers for all questions)?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1441212737, "post_id": 32358597, "comment_id": 52590501, "body": "Some advice from Jon Skeet himself: <a href=\"http://codeblog.jonskeet.uk/2009/02/17/answering-technical-questions-helpfully/\" rel=\"nofollow noreferrer\">codeblog.jonskeet.uk/2009/02/17/&hellip;</a> :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1441216024, "post_id": 32358597, "comment_id": 52592508, "body": "Cone, I see nothing wrong with #2. You&#39;ve assigned the value to a constant (<code>M</code>), but it could be a variable.  As for #1, off with its head!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441218804, "post_id": 32358597, "comment_id": 52594043, "body": "@CarySwoveland: I certainly was. Thanks  for pinging me :)"}], "tags": [], "owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "is_accepted": true, "score": 2, "last_activity_date": 1441216610, "last_edit_date": 1441216610, "creation_date": 1441212010, "answer_id": 32358597, "question_id": 32358507, "link": "https://stackoverflow.com/questions/32358507/accessing-constants-without-always-specifying-the-module/32358597#32358597", "title": "Accessing constants without always specifying the module", "body": "<p>You can create sort of alias</p>\n\n<pre><code>M = My::Very::Long::Module::Name\np [M::FIRST_CONSTANT, M::SECOND_CONSTANT]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 2, "last_activity_date": 1441212529, "creation_date": 1441212529, "answer_id": 32358788, "question_id": 32358507, "link": "https://stackoverflow.com/questions/32358507/accessing-constants-without-always-specifying-the-module/32358788#32358788", "title": "Accessing constants without always specifying the module", "body": "<p>It depends on what exactly you're trying to achieve there. One possible solution is to build that array of yours closer to the constants. Check out this totally made up example:</p>\n\n<pre><code>module Postable\n  FREE_POST_TYPES = ['text', 'image']\n  PREMIUM_POST_TYPES = ['video']\n\n  def types\n    FREE_POST_TYPES + PREMIUM_POST_TYPES\n  end\nend\n\nclass Article\n  extend Postable\nend\n\nArticle.types # =&gt; [\"text\", \"image\", \"video\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1441265785, "creation_date": 1441265785, "answer_id": 32369619, "question_id": 32358507, "link": "https://stackoverflow.com/questions/32358507/accessing-constants-without-always-specifying-the-module/32369619#32369619", "title": "Accessing constants without always specifying the module", "body": "<p>You could use <a href=\"http://ruby-doc.org/core-2.2.3/Module.html#method-i-const_get\" rel=\"nofollow\"><code>const_get</code></a>:</p>\n\n<pre><code>%i(FIRST_CONSTANT SECOND_CONSTANT).map { |c|\n  My::Very::Long::Module::Name.const_get(c)\n}\n#=&gt; [1, 2]\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 1238368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f190364f004d8ed6af502c9aebe944bc?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#244;me Tremblay", "link": "https://stackoverflow.com/users/1238368/j%c3%a9r%c3%b4me-tremblay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 32358597, "answer_count": 3, "score": 1, "last_activity_date": 1441265785, "creation_date": 1441211739, "last_edit_date": 1441218290, "question_id": 32358507, "link": "https://stackoverflow.com/questions/32358507/accessing-constants-without-always-specifying-the-module", "title": "Accessing constants without always specifying the module", "body": "<p>I have a module with several constants:</p>\n\n<pre><code>module My::Very::Long::Module::Name\n  FIRST_CONSTANT = 1\n  SECOND_CONSTANT = 2\n  THIRD_CONSTANT = 3\n  ...\nend\n</code></pre>\n\n<p>Elsewhere, I want to build an array with some of those constants:</p>\n\n<pre><code>[My::Very::Long::Module::Name::FIRST_CONSTANT, My::Very::Long::Module::Name::SECOND_CONSTANT]\n</code></pre>\n\n<p>This is very annoying. Is there a better way, perhaps without always having to use the module name prefix?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "edited": false, "score": 1, "creation_date": 1441211677, "post_id": 32358029, "comment_id": 52589893, "body": "Have you considered using JQuery DataTables? You can page the rows of your table in chunks. By default, it can show 10, 25, 50 or 100 rows at a time, but you can override that behavior to display 8 as per your requirements."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3720516"}, "edited": false, "score": 0, "creation_date": 1441220319, "post_id": 32358029, "comment_id": 52594898, "body": "Off topic, but your class and controller name should adhere to CamelCase per ruby naming conventions."}, {"owner": {"reputation": 1, "user_id": 5293311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9110bf8258491ee359d677763293fe84?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi", "link": "https://stackoverflow.com/users/5293311/aditi"}, "reply_to_user": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "edited": false, "score": 0, "creation_date": 1441267499, "post_id": 32358029, "comment_id": 52611869, "body": "@MarsAtomic Jquery data tables is only for restricting the view but I want to submit the entries i.e. timing of students in slots of 8 which is stored in an array &quot;mem[]&quot;"}], "owner": {"reputation": 1, "user_id": 5293311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9110bf8258491ee359d677763293fe84?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi", "link": "https://stackoverflow.com/users/5293311/aditi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441210179, "creation_date": 1441210179, "question_id": 32358029, "link": "https://stackoverflow.com/questions/32358029/view-and-submit-entries-in-batches-slots", "title": "View and Submit entries in batches/slots", "body": "<p>I am designing a rails application in which there is model named race_timing which store the timings of students participate in different events.On view page names of student according to selected event and age group is displayed for entering the time taken by each individual to complete the race.Currently I am storing the student_id and their corresponding timing in an array as I want to submit multiple entries on single submit and it is working properly.\nBut now I want to display only 8 students at a time from the array and store their corresponding timings  but i am not getting a proper way to do so.\nCan anyone suggest some solution??</p>\n\n<p>race_timing_controller</p>\n\n<pre><code>@mid = MemberEvent.where(\"event_id IN (?)\", params[:race_timing_ind_evnt][:event_id]).pluck(:member_id)\n#@mid=MemberEvents.find_by_event_id(params[:event_id]).pluck(:member_id)\n@midlst=Member.where(\"id IN (?) AND competetion_level_id IN (?)\",@mid,params[:race_timing_ind_evnt][:age]).pluck(:id)\n#@meid=MemberEvent.where(@mname.id).pluck(:id)\n@mname=[]\n@midlst.each do |i|\n  @fmn=Member.where(\"id IN (?)\", i).pluck( :name)\n  @mname.push(@fmn).flatten!\nend\n@race_timing_ind_evnt = RaceTimingIndEvnt.new\n</code></pre>\n\n<p>race_timing_view</p>\n\n<pre><code>&lt;% @mname.zip(@midlst).each do |mn,i| %&gt; \n\n        &lt;tr&gt;\n            &lt;td&gt;&lt;%= mn %&gt;&lt;/td&gt;\n            &lt;%= hidden_field_tag \"member_id[]\",i%&gt;\n            &lt;%= f.hidden_field :event_id, :value =&gt; params[:race_timing_ind_evnt][:event_id]%&gt;\n            &lt;%= f.hidden_field :age_group, :value =&gt; params[:race_timing_ind_evnt][:age]%&gt;\n            &lt;td&gt;&lt;%=text_field_tag \"mem[]\"%&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= check_box_tag(\"\", \"\", true, class: \"checkbox\") %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n       &lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1441218055, "post_id": 32357970, "comment_id": 52593602, "body": "I guess this is perhaps from Perl, and was adopted to keep compatibility with Perl. Recently, it has been realized that this second syntax is not useful, so it was removed from the modern <code>to_h</code> method."}], "answers": [{"tags": [], "owner": {"reputation": 1592, "user_id": 4271743, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Nivk1.jpg?s=128&g=1", "display_name": "ConnorCMcKee", "link": "https://stackoverflow.com/users/4271743/connorcmckee"}, "is_accepted": false, "score": 3, "last_activity_date": 1441213170, "last_edit_date": 1441213170, "creation_date": 1441210453, "answer_id": 32358110, "question_id": 32357970, "link": "https://stackoverflow.com/questions/32357970/why-use-splat-operator-to-create-a-hash/32358110#32358110", "title": "Why use splat operator to create a Hash?", "body": "<p>One difference between <code>Hash[ary]</code> and <code>Hash[*ary.flatten]</code> is the behavior if the array can't be turned into a hash cleanly. Consider, for instance, this object:</p>\n\n<pre><code># ary now contains an array with more than two values\nary = [[4, 8, 9], [15, 16], [23, 42]]\n\n# Calling Hash[ary] will succeed by ignoring the invalid array\nputs Hash[ary] # =&gt; {15=&gt;16, 23=&gt;42}\n\n# Calling Hash[*ary.flatten] will return the expected error\nputs Hash[*ary.flatten]\n# =&gt; class: ArgumentError\n# =&gt; message: odd number of arguments for Hash\n# =&gt; backtrace: RubyMonk:4:in `[]'\n</code></pre>\n\n<p>If you're trying to understand what the splat is actually doing for you I strongly recommend this article (it's not very recent, but still very applicable).</p>\n\n<p><a href=\"https://endofline.wordpress.com/2011/01/21/the-strange-ruby-splat/\" rel=\"nofollow\">https://endofline.wordpress.com/2011/01/21/the-strange-ruby-splat/</a></p>\n"}, {"comments": [{"owner": {"reputation": 2564, "user_id": 4134881, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/797360342295a3f637a9c4d71d40d113?s=128&d=identicon&r=PG&f=1", "display_name": "evianpring", "link": "https://stackoverflow.com/users/4134881/evianpring"}, "edited": false, "score": 0, "creation_date": 1441228610, "post_id": 32358135, "comment_id": 52599179, "body": "Good explanation. So the conclusion is that Hash(*ary.flatten) doesn&#39;t really make sense to use if ary is a two-dimensional array, because you could just pass ary itself to initialize a Hash. However, if you did receive something like ary.flatten and needed to initialize a hash with it you would then use splat."}, {"owner": {"reputation": 2564, "user_id": 4134881, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/797360342295a3f637a9c4d71d40d113?s=128&d=identicon&r=PG&f=1", "display_name": "evianpring", "link": "https://stackoverflow.com/users/4134881/evianpring"}, "edited": false, "score": 0, "creation_date": 1441229097, "post_id": 32358135, "comment_id": 52599384, "body": "Related question I now have: <a href=\"http://stackoverflow.com/questions/32363360/why-can-i-execute-str-ary-flatten-but-not-simply-ary-flatten\" title=\"why can i execute str ary flatten but not simply ary flatten\">stackoverflow.com/questions/32363360/&hellip;</a>"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 6, "last_activity_date": 1441210878, "last_edit_date": 1441210878, "creation_date": 1441210534, "answer_id": 32358135, "question_id": 32357970, "link": "https://stackoverflow.com/questions/32357970/why-use-splat-operator-to-create-a-hash/32358135#32358135", "title": "Why use splat operator to create a Hash?", "body": "<p>There are a few ways you can initialize a hash. You can pass it array of pairs or just list the keys and values. Examples from documentation:</p>\n\n<pre><code>Hash[\"a\", 100, \"b\", 200]             #=&gt; {\"a\"=&gt;100, \"b\"=&gt;200}\nHash[ [ [\"a\", 100], [\"b\", 200] ] ]   #=&gt; {\"a\"=&gt;100, \"b\"=&gt;200}\n</code></pre>\n\n<p>Note that there is no form that accepts a one-level array. It's either array of arrays or no array at all. The splat is needed to \"expand\" that flattened array into simple argument list (thus, making it behave like the first form in your example)</p>\n\n<p>Depending on ruby version, this will either return an empty hash or raise an error.</p>\n\n<pre><code>RUBY_VERSION # =&gt; \"2.1.5\"\nary = [[4, 8], [15, 16], [23, 42]].flatten\nary # =&gt; [4, 8, 15, 16, 23, 42]\nHash[ary] # =&gt; {} # !&gt; this causes ArgumentError in the next release\n</code></pre>\n\n<p>It obviously doesn't make sense to do <code>*ary.flatten</code> (just use <code>ary</code>), but you might get this flat array from elsewhere. That's when you'll need to splat it.</p>\n"}], "owner": {"reputation": 2564, "user_id": 4134881, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/797360342295a3f637a9c4d71d40d113?s=128&d=identicon&r=PG&f=1", "display_name": "evianpring", "link": "https://stackoverflow.com/users/4134881/evianpring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 32358135, "answer_count": 2, "score": 4, "last_activity_date": 1441213170, "creation_date": 1441209925, "question_id": 32357970, "link": "https://stackoverflow.com/questions/32357970/why-use-splat-operator-to-create-a-hash", "title": "Why use splat operator to create a Hash?", "body": "<p>I'm following the RubyMonk tutorial. There is a part that deals with the splat operator, and how you can use it with a Hash.\nThis is valid code:</p>\n\n<pre><code>puts Hash[4, 8]\nputs Hash[ [[4, 8], [15, 16]] ]\n</code></pre>\n\n<p>But then it says that you can also use:</p>\n\n<pre><code>ary = [[4, 8], [15, 16], [23, 42]]\nputs Hash[*ary.flatten]\n</code></pre>\n\n<p>Why would anyone use this last form of creating a Hash, with flatten, instead of just doing <code>Hash[ary]</code> directly?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1441211218, "post_id": 32357897, "comment_id": 52589645, "body": "Usually for this you would initially have rendered out a partial which uses the @post object.  Then, you can update the post with your data from params, and then do <code>render :partial =&gt; &quot;posts&#47;my_partial&quot;, :locals =&gt; {:post =&gt; @post}</code> or something like that."}], "answers": [{"tags": [], "owner": {"reputation": 392, "user_id": 4019861, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-KAdg6ufDoos/AAAAAAAAAAI/AAAAAAAAABc/MQGIFfZbgSM/photo.jpg?sz=128", "display_name": "Chris Williams", "link": "https://stackoverflow.com/users/4019861/chris-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1441213826, "last_edit_date": 1495539926, "creation_date": 1441213826, "answer_id": 32359204, "question_id": 32357897, "link": "https://stackoverflow.com/questions/32357897/rails-render-partial-with-json-object/32359204#32359204", "title": "Rails render partial with JSON object", "body": "<p>I was able to get it work by rendering the partial as a string of HTML inside of the json object, similar to what's being done in this question: <a href=\"https://stackoverflow.com/questions/4810584/rails-3-how-to-render-a-partial-as-a-json-response\">rails 3 - How to render a PARTIAL as a Json response</a></p>\n\n<p>I changed the if statement in <strong>post_controller.rb</strong> to:</p>\n\n<pre><code>if !@post.image_processing?\n  data[:partial] = render_to_string(@post)\nend\n</code></pre>\n\n<p>and then in <strong>create.js.erb</strong> changed the callback to:</p>\n\n<pre><code>$(\"#js-capture-container\").html(data.partial);\n</code></pre>\n\n<p>very nice, very clean.</p>\n"}], "owner": {"reputation": 392, "user_id": 4019861, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-KAdg6ufDoos/AAAAAAAAAAI/AAAAAAAAABc/MQGIFfZbgSM/photo.jpg?sz=128", "display_name": "Chris Williams", "link": "https://stackoverflow.com/users/4019861/chris-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1820, "favorite_count": 0, "accepted_answer_id": 32359204, "answer_count": 1, "score": 2, "last_activity_date": 1441213826, "creation_date": 1441209660, "question_id": 32357897, "link": "https://stackoverflow.com/questions/32357897/rails-render-partial-with-json-object", "title": "Rails render partial with JSON object", "body": "<p>In my rails app I have a javascript callback after the a post is created that polls a processing endpoint to check if an image has finished processing and then updates the view like this:</p>\n\n<p><strong>create.js.erb</strong> <em>create callback</em></p>\n\n<pre><code>// start polling for processed image\nfunction imageProcessed() {\n  $.ajax({ url: \"/posts/\" + &lt;%= @post.id %&gt; + \"/processing\"})\n    .done(function(data) {\n      if (data.processing) {\n        setTimeout(imageProcessed(), 2000);\n      } else {\n        // append image url when processed\n        $(\"#js-capture-container\").html('&lt;img src=\"' + data.image_url + '\" alt=\"image\"&gt;');\n      }\n    });\n}\n\nimageProcessed();\n</code></pre>\n\n<p><strong>posts_controller.rb</strong> <em>endpoint</em></p>\n\n<pre><code>def processing\n  data = { processing: @post.image_processing }\n  if !@post.image_processing?\n    data[:image_url] = @post.image_url(:pair)\n  end\n  render json: data\nend\n</code></pre>\n\n<p>This works fine, but I would like to take the data returned in the ajax and render the already existing _post.html.erb partial with this data.</p>\n\n<p>Something like return an updated instance of @post and then render that object into the partial.</p>\n\n<p><code>\"&lt;%= escape_javascript(render @post) %&gt;\"</code> in create.js.erb</p>\n\n<p>Any ideas would greatly help, thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "puppet", "flume"], "comments": [{"owner": {"reputation": 1219, "user_id": 2463608, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71a718079ab00b87628fd52df9eb6e42?s=128&d=identicon&r=PG", "display_name": "Daiku", "link": "https://stackoverflow.com/users/2463608/daiku"}, "edited": false, "score": 0, "creation_date": 1441213052, "post_id": 32357438, "comment_id": 52590687, "body": "Perhaps double-quotes around your interpolated ruby stuff: <code>a1.sources = &lt;%= &quot;#{sourcenamelist}&quot; -%&gt;</code> etc"}, {"owner": {"reputation": 11, "user_id": 5261378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d279049445b52aac847c7c56a7c1b240?s=128&d=identicon&r=PG&f=1", "display_name": "mlb2101", "link": "https://stackoverflow.com/users/5261378/mlb2101"}, "reply_to_user": {"reputation": 1219, "user_id": 2463608, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71a718079ab00b87628fd52df9eb6e42?s=128&d=identicon&r=PG", "display_name": "Daiku", "link": "https://stackoverflow.com/users/2463608/daiku"}, "edited": false, "score": 0, "creation_date": 1441213327, "post_id": 32357438, "comment_id": 52590883, "body": "Thanks! That got me somewhere; it&#39;s passing the syntax check, but now Puppet reports:  <code>Could not find value for &#39;sourcenamelist&#39;</code>"}, {"owner": {"reputation": 11, "user_id": 5261378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d279049445b52aac847c7c56a7c1b240?s=128&d=identicon&r=PG&f=1", "display_name": "mlb2101", "link": "https://stackoverflow.com/users/5261378/mlb2101"}, "reply_to_user": {"reputation": 1219, "user_id": 2463608, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71a718079ab00b87628fd52df9eb6e42?s=128&d=identicon&r=PG", "display_name": "Daiku", "link": "https://stackoverflow.com/users/2463608/daiku"}, "edited": false, "score": 0, "creation_date": 1441215814, "post_id": 32357438, "comment_id": 52592398, "body": "Oops, that was my mistake! I should&#39;ve looked at the line number; the problem wasn&#39;t when I was trying to insert it into the .conf, it was when I was trying to append to the list variables (which didn&#39;t exist yet, hence the problem). Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1219, "user_id": 2463608, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71a718079ab00b87628fd52df9eb6e42?s=128&d=identicon&r=PG", "display_name": "Daiku", "link": "https://stackoverflow.com/users/2463608/daiku"}, "is_accepted": true, "score": 2, "last_activity_date": 1441215939, "creation_date": 1441215939, "answer_id": 32359864, "question_id": 32357438, "link": "https://stackoverflow.com/questions/32357438/puppet-erb-template-syntax-error-unexpected-end-expecting-or-insertin/32359864#32359864", "title": "Puppet .erb template: syntax error, unexpected $end, expecting &#39;)&#39; (or: inserting variables declared in .erb into text after end of code)", "body": "<p>You need double-quotes around your interpolated ruby stuff: </p>\n\n<p><code>a1.sources = &lt;%= \"#{sourcenamelist}\" -%&gt;</code> </p>\n\n<p>etc.</p>\n"}], "owner": {"reputation": 11, "user_id": 5261378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d279049445b52aac847c7c56a7c1b240?s=128&d=identicon&r=PG&f=1", "display_name": "mlb2101", "link": "https://stackoverflow.com/users/5261378/mlb2101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 909, "favorite_count": 0, "accepted_answer_id": 32359864, "answer_count": 1, "score": 0, "last_activity_date": 1441215946, "creation_date": 1441208342, "last_edit_date": 1441215946, "question_id": 32357438, "link": "https://stackoverflow.com/questions/32357438/puppet-erb-template-syntax-error-unexpected-end-expecting-or-insertin", "title": "Puppet .erb template: syntax error, unexpected $end, expecting &#39;)&#39; (or: inserting variables declared in .erb into text after end of code)", "body": "<p>I'm working on an .erb in Puppet to manage an Apache Flume config file. (Flume is going to ship logs to Elasticsearch, so they can be searched and sorted in Kibana.)</p>\n\n<p>Some background: it's getting this information from a custom fact in facter called logpaths that keeps the paths of my logs in this format:</p>\n\n<pre><code>&gt;MysqlBlah;/var/logs/mysql/error.log:/var/logs/mysql/slow_query.log\n&gt;TomcatBlah;/var/logs/tomcat/catalina.out:/var/logs/tomcat/error.log\n</code></pre>\n\n<p>So each service starts with a >, the list of logs starts with a ;, and the log paths are delimited with a :.</p>\n\n<p>I want my ERB to read that, and iterate through each logfile to come out with text I can put in my flume config file. </p>\n\n<p>All that seems to be OK, but I'm getting hit with an error that I can't track down:</p>\n\n<pre><code>-:58: syntax error, unexpected $end, expecting ')'\n</code></pre>\n\n<p>I don't seem to have any unclosed parentheses anywhere, so I'm not sure how to look for what's causing this.</p>\n\n<p><strong>EDIT 1:</strong></p>\n\n<p>Per @Daiku, I added double-quotes around all the variables, and it is now passing syntax check. However, Puppet now presents this error:</p>\n\n<pre><code>Could not find value for 'sourcenamelist'\n</code></pre>\n\n<p>Is this a scope issue? Is there another way to access the variable (which I declared in this erb) after the <code>%&gt;</code>?</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>I should have looked at the line number. It turns out I could insert variables the way I was, the line number causing problems was the one where I was appending to a list (which makes sense, as I hadn't declared that variable before I started appending to it). I'm back on track now; will post the finished code once I work out the remaining bugs of mine.</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>&lt;%\n#split on &gt; to get each service\nservices = @logpaths.split(\"&gt;\")\nservices.each do |serviceline| \n#split on semicolon\nservice = serviceline.split(\";\")\nservicename = service[0]\n#split into logs on colon\nlogs = service[1].string.split(\":\")\nlognumber = 0\nlogs.each do |log|\n#sourcelist is a space-delimited list of names for each logfile (eg mysql3311-1)\nlognumber += 1\nsourcename = servicename + \"-\" + lognumber.to_s + \" \"\nsourcenamelist &lt;&lt; sourcename    \n#sourceconfigs assigns each source to channel, exec path\nsourceconfig = \"a1.sources.#{sourcename}.type = exec\\na1.sources.#{sourcename}.command = tail -F #{log}\\na1.sources.#{sourcename}.channels = c1\"\nsourceconfiglist &lt;&lt; sourceconfig\n#sourceinterceptors appends sourcename, path, and servicename (you know, for search)\nsourceinterceptors = \"a1.sources.#{sourcename}.interceptors = i1 i2 i3 i4\\na1.sources.#{sourcename}.interceptors.i1.type = timestamp\"\nsourceinterceptorlist &lt;&lt; sourceinterceptors\nend\nend \n-%&gt;\n\n# Name the components on this agent\na1.sources = &lt;%= #{sourcenamelist} -%&gt;\na1.sinks = k1\na1.channels = c1\n\n# Describe/configure the source \n&lt;%= #{sourceconfiglist} -%&gt;\n\n# Describe the sink\na1.sinks.k1.type = elasticsearch\na1.sinks.k1.hostNames = (my elasticsearch host):9300\na1.sinks.k1.indexName = flume\na1.sinks.k1.indexType = flume_logs\na1.sinks.k1.clusterName = elasticsearch\na1.sinks.k1.batchSize = 1000\na1.sinks.k1.ttl = 2\na1.sinks.k1.serializer = org.apache.flume.sink.elasticsearch.ElasticSearchLogStashEventSerializer\n\n# Use a channel which buffers events in memory\na1.channels.c1.type = memory\na1.channels.c1.capacity = 1000\na1.channels.c1.transactionCapacity = 100\n\n# Bind the source and sink to the channel\na1.sources.r1.channels = c1\na1.sinks.k1.channel = c1\n\n#interceptor\n&lt;%= #{sourceinterceptorlist} -%&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "youtube", "oembed", "video-embedding"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5292992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463ff776a33c78af533ef6d4048f4d89?s=128&d=identicon&r=PG&f=1", "display_name": "DrestZ", "link": "https://stackoverflow.com/users/5292992/drestz"}, "edited": false, "score": 0, "creation_date": 1441225671, "post_id": 32360806, "comment_id": 52597694, "body": "Thank you so much, this has bugging me for ever and now it works :D cant thank you enough and thanks for responding :)"}], "tags": [], "owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "is_accepted": true, "score": 0, "last_activity_date": 1441219304, "creation_date": 1441219304, "answer_id": 32360806, "question_id": 32357309, "link": "https://stackoverflow.com/questions/32357309/how-to-used-oembed-to-embed-a-youtube-thumbnail-title-to-index-page-with-ror/32360806#32360806", "title": "How to used Oembed to embed a youtube thumbnail/title to Index page with RoR", "body": "<p>You cannot set <code>@youtube</code> in the index method of your controller because at that moment you have an array of videos. What you need to have is something like:</p>\n\n<p>in your controller</p>\n\n<pre><code>def index\n    @videos = Video.all.order(\"created_at DESC\").paginate(page: params[:page], per_page: 20)\nend\n</code></pre>\n\n<p>and in your HAML view</p>\n\n<pre><code>- @videos.each do |video|\n    - youtube = OEmbed::Providers::Youtube.get(video.link)\n    .Video\n        .Video_image\n            = image_tag youtube.thumbnail_url.html_safe, video\n        .Video_content\n            .title\n                %h2= youtube.title.html_safe, video\n            .data.clearfix\n                %p.username\n                    Shared by\n                    = video.user.name\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5292992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463ff776a33c78af533ef6d4048f4d89?s=128&d=identicon&r=PG&f=1", "display_name": "DrestZ", "link": "https://stackoverflow.com/users/5292992/drestz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 32360806, "answer_count": 1, "score": 0, "last_activity_date": 1441219304, "creation_date": 1441207924, "question_id": 32357309, "link": "https://stackoverflow.com/questions/32357309/how-to-used-oembed-to-embed-a-youtube-thumbnail-title-to-index-page-with-ror", "title": "How to used Oembed to embed a youtube thumbnail/title to Index page with RoR", "body": "<p>I'm quite new to ruby on rails and I was hoping to get some help. \nI've been able to figure out how to embed a youtube clip in to my show page and have the title show</p>\n\n<p>Show View</p>\n\n<pre><code>#video_show\n  %h1= @youtube.title.html_safe \n  %p.username\n    Shared by\n    = @video.user.name\n    about\n    = time_ago_in_words(@video.created_at)\n  .clearfix\n    .video_image_show\n      = @youtube.html.html_safe\n</code></pre>\n\n<p>Video Controller</p>\n\n<pre><code>def index\n    @videos = Video.all.order(\"created_at DESC\").paginate(page: params[:page], per_page: 20)\n    @video.link = Video.find(params[:id])\n    @youtube = OEmbed::Providers::Youtube.get(@video.link)\n\n\nend\n\ndef show\n     @infos = Info.where(video_id: @video)\n     @comments = Comment.where(video_id: @video)\n     @random_video = Video.where.not(id: @Video).order(\"RANDOM()\").first\n     @youtube = OEmbed::Providers::Youtube.get(@video.link)\nend\n</code></pre>\n\n<p>But then it comes to showing the Thumbnail and title in my index page, it tells me that I have a undefined method such as 'title'.</p>\n\n<p>index View</p>\n\n<pre><code>- @videos.each do |video|\n    .Video\n        .Video_image\n            = image_tag @youtube.thumbnail_url.html_safe, video\n        .Video_content\n            .title\n                %h2= @youtube.title.html_safe, video\n            .data.clearfix\n                %p.username\n                    Shared by\n                    = video.user.name\n</code></pre>\n\n<p>Is there anyway that I can link the video id to the index page which will allow the Oembed to show the @youtube = OEmbed::Providers::Youtube.get(@video.link) thumbnail and title ?</p>\n\n<p>thanks so much in advance</p>\n"}, {"tags": ["ruby", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 5157, "user_id": 97893, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/679f1c565405b6521eb1b78eeab69051?s=128&d=identicon&r=PG", "display_name": "fenec", "link": "https://stackoverflow.com/users/97893/fenec"}, "edited": false, "score": 0, "creation_date": 1441218820, "post_id": 32359770, "comment_id": 52594052, "body": "Excellent explanation !!"}, {"owner": {"reputation": 5157, "user_id": 97893, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/679f1c565405b6521eb1b78eeab69051?s=128&d=identicon&r=PG", "display_name": "fenec", "link": "https://stackoverflow.com/users/97893/fenec"}, "edited": false, "score": 0, "creation_date": 1441222638, "post_id": 32359770, "comment_id": 52596086, "body": "this would not work if i want to conserve the html tags that are inside the paragraph, try to do that for <code>&lt;p&gt;fsome test and then &lt;b&gt;bold&lt;&#47;b&gt;&lt;&#47;p&gt;</code>"}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 2, "last_activity_date": 1441302418, "last_edit_date": 1441302418, "creation_date": 1441215633, "answer_id": 32359770, "question_id": 32357156, "link": "https://stackoverflow.com/questions/32357156/how-to-add-trademark-symbols/32359770#32359770", "title": "How to add trademark symbols", "body": "<p>Here's how I'd do it:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::HTML(&lt;&lt;EOT)\n&lt;p&gt;Whether you want to build a playground, make play a priority in your community, or learn more about Imagination Playground , we've got webinars for you in March!&lt;/p&gt;\n&lt;p&gt;As always, all our webinars are FREE. All you need to participate is a phone and a computer with an Internet connection.&lt;/p&gt;\nEOT\n\ndoc.encoding = 'UTF-8'\ndoc.css('p').each do |p|\n  p.children = p.content.gsub(/Imagination Playground\\s/, 'Imagination Playground&lt;i class=\"fa fa-trademark\"&gt;&lt;/i&gt;')\nend\nputs doc\n</code></pre>\n\n<p>Which results in:</p>\n\n<pre><code># &gt;&gt; &lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/REC-html40/loose.dtd\"&gt;\n# &gt;&gt; &lt;html&gt;&lt;body&gt;\n# &gt;&gt; &lt;p&gt;Whether you want to build a playground, make play a priority in your community, or learn more about Imagination Playground&lt;i class=\"fa fa-trademark\"&gt;&lt;/i&gt;, we've got webinars for you in March!&lt;/p&gt;\n# &gt;&gt; &lt;p&gt;As always, all our webinars are FREE. All you need to participate is a phone and a computer with an Internet connection.&lt;/p&gt;\n# &gt;&gt; &lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>Nokogiri is pretty smart. When it sees <code>children=</code>, it looks to see whether it's receiving a string. If so, it parses that string and converts it into a Node then replaces the existing children with the new node. This is a big difference from using <code>content=</code> which Nokogiri knows should be text, and then will encode the embedded tags into <code>&amp;lt;</code>, etc. This is covered in the documentation.</p>\n\n<p>For <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Node:children=\" rel=\"nofollow\"><code>children=</code></a>:</p>\n\n<blockquote>\n  <p>Set the inner html for this Node node_or_tags node_or_tags can be a Nokogiri::XML::Node, a Nokogiri::XML::DocumentFragment, or a string containing markup.</p>\n</blockquote>\n\n<p>For <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Node:content=\" rel=\"nofollow\"><code>content=</code></a>:</p>\n\n<blockquote>\n  <p>Set the Node's content to a Text node containing string. The string gets XML escaped, not interpreted as markup.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>this would not work if i want to conserve the html tags that are inside the paragraph, try to do that for <code>&lt;p&gt;fsome test and then &lt;b&gt;bold&lt;/b&gt;&lt;/p&gt;</code></p>\n</blockquote>\n\n<p>You are changing the requirements. Don't do that. Be specific about your needs so we can answer the real question once. </p>\n\n<p>A small alteration is needed to take the contents of the desired tag. Use <code>children.to_html</code> to get the HTML string of the embedded nodes then <code>gsub</code> it and use its result:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::HTML('&lt;p&gt;Imagination Playground&lt;b&gt;foo&lt;/b&gt;&lt;/p&gt;')\nputs doc.to_html\n</code></pre>\n\n<p>Which looks like this to start:</p>\n\n<pre><code># &gt;&gt; &lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/REC-html40/loose.dtd\"&gt;\n# &gt;&gt; &lt;html&gt;&lt;body&gt;&lt;p&gt;Imagination Playground&lt;b&gt;foo&lt;/b&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>Modify the DOM:</p>\n\n<pre><code>doc.search('p').each do |p|\n  p.children = p.children.to_html.gsub(/Imagination Playground\\s?/, 'Imagination Playground&lt;i class=\"fa fa-trademark\"&gt;&lt;/i&gt;')\nend\nputs doc\n</code></pre>\n\n<p>Which now looks like:</p>\n\n<pre><code># &gt;&gt; &lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/REC-html40/loose.dtd\"&gt;\n# &gt;&gt; &lt;html&gt;&lt;body&gt;&lt;p&gt;Imagination Playground&lt;i class=\"fa fa-trademark\"&gt;&lt;/i&gt;&lt;b&gt;foo&lt;/b&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>Notice I'm using <code>search</code> instead of <code>css</code>. Use the generic method instead of the more specific. It makes it easier to switch to XPaths if needed.</p>\n\n<p>Also, I'm using a little more intelligent pattern in the <code>gsub</code> to conditionally grab a single trailing whitespace if it's available. It's not essential to do that with HTML because browsers gobble blanks, but it would be the right way to do it if you were dealing with regular text documents or preformatted text.</p>\n\n<p>And, just for more detail about what Nokogiri is seeing:</p>\n\n<pre><code>doc.search('p').first \n# =&gt; #(Element:0x3fd222462204 {\n#      name = \"p\",\n#      children = [\n#        #(Text \"Imagination Playground\"),\n#        #(Element:0x3fd2224608f0 { name = \"b\", children = [ #(Text \"foo\")] })]\n#      })\ndoc.search('p').first.children \n# =&gt; [#&lt;Nokogiri::XML::Text:0x3fd222461688 \"Imagination Playground\"&gt;, #&lt;Nokogiri::XML::Element:0x3fd2224608f0 name=\"b\" children=[#&lt;Nokogiri::XML::Text:0x3fd22245fe64 \"foo\"&gt;]&gt;]\n</code></pre>\n"}], "owner": {"reputation": 5157, "user_id": 97893, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/679f1c565405b6521eb1b78eeab69051?s=128&d=identicon&r=PG", "display_name": "fenec", "link": "https://stackoverflow.com/users/97893/fenec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 32359770, "answer_count": 1, "score": 1, "last_activity_date": 1441302418, "creation_date": 1441207492, "last_edit_date": 1441217218, "question_id": 32357156, "link": "https://stackoverflow.com/questions/32357156/how-to-add-trademark-symbols", "title": "How to add trademark symbols", "body": "<p>I am trying to add a trademark symbol to all the instances of \"Imagination Playground\" in my HTML document. However I end up with something like this:</p>\n\n<pre><code>&amp;lt;i class=\"fa fa-trademark\"&amp;gt;&amp;lt;/i&amp;gt;\n</code></pre>\n\n<p>It seems like the symbol I am using is converted to HTML characters. How can I escape that?</p>\n\n<p>This is my original Ruby code:</p>\n\n<pre><code>body = \"&lt;p&gt;Whether you want to build a playground, make play a priority in your community, or learn more about Imagination Playground , we've got webinars for you in March!&lt;/p&gt;\n  &lt;p&gt;As always, all our webinars are FREE. All you need to participate is a phone and a computer with an Internet connection.&lt;/p&gt;\"\nnew_body = Nokogiri::HTML(body)\nnew_body.encoding = 'UTF-8'\nnew_body.css('p','a').each{ |p|\np.content =  p.content.gsub(/Imagination Playground\\s/,'Imagination Playground&lt;i class=\"fa fa-trademark\"&gt;&lt;/i&gt;');\nputs new_body\n</code></pre>\n\n<p>And this is what I get:</p>\n\n<pre><code>&lt;p&gt;Whether you want to build a playground, make play a priority in your community, or learn more about Imagination Playground&amp;lt;i class=\"fa fa-trademark\"&amp;gt;&amp;lt;/i&amp;gt;, we've got webinars for you in March!&lt;/p&gt;\n&lt;p&gt;As always, all our webinars are FREE. All you need to participate is a phone and a computer with an Internet connection.&lt;/p&gt;\n</code></pre>\n\n<p>How can I replace that HTML paragraph and escape ampersand and special characters?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activesupport"], "comments": [{"owner": {"reputation": 712, "user_id": 4191738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wKXDY.jpg?s=128&g=1", "display_name": "Sculper", "link": "https://stackoverflow.com/users/4191738/sculper"}, "edited": false, "score": 0, "creation_date": 1441207265, "post_id": 32357017, "comment_id": 52587096, "body": "If you&#39;re just looking for a one-liner, you could use an inline if statement: <code>call_something(some_object.some_attribute) if some_object.some_attribute.present?</code>"}, {"owner": {"reputation": 5186, "user_id": 1690765, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/59237bb43f984f251e904bd4904e4156?s=128&d=identicon&r=PG", "display_name": "Niels B.", "link": "https://stackoverflow.com/users/1690765/niels-b"}, "reply_to_user": {"reputation": 712, "user_id": 4191738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wKXDY.jpg?s=128&g=1", "display_name": "Sculper", "link": "https://stackoverflow.com/users/4191738/sculper"}, "edited": false, "score": 0, "creation_date": 1441207350, "post_id": 32357017, "comment_id": 52587159, "body": "This invokes <code>some_attribute</code> twice, which is not desirable for verbosity and performance reasons (if <code>some_attribute</code> invoked IO)"}, {"owner": {"reputation": 11595, "user_id": 748259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d341d3b717765103bbd71484af0e96b?s=128&d=identicon&r=PG", "display_name": "Mikhail Nikalyukin", "link": "https://stackoverflow.com/users/748259/mikhail-nikalyukin"}, "edited": false, "score": 0, "creation_date": 1441207403, "post_id": 32357017, "comment_id": 52587203, "body": "<code>attr = if some_object.some_attribute.present?   call_something(attr) end</code> this will call attribute only once"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1441216800, "post_id": 32357017, "comment_id": 52592969, "body": "It&#39;s not necessary to say &quot;Update&quot;. We can tell whether you&#39;ve modified the question if necessary. Instead, simply add your additional information into the normal flow of the question."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441216920, "post_id": 32357017, "comment_id": 52593028, "body": "You could also write <code>some_object.some_attribute.present &amp;    call_something(some_object.some_attribute)</code>."}, {"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 0, "creation_date": 1441456072, "post_id": 32357017, "comment_id": 52693285, "body": "What&#39;s wrong with just <code>if object.attribute</code>? If it exists, it&#39;ll be true, if it&#39;s nil (aka not present) it&#39;ll be false."}], "answers": [{"comments": [{"owner": {"reputation": 5186, "user_id": 1690765, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/59237bb43f984f251e904bd4904e4156?s=128&d=identicon&r=PG", "display_name": "Niels B.", "link": "https://stackoverflow.com/users/1690765/niels-b"}, "edited": false, "score": 0, "creation_date": 1441207297, "post_id": 32357069, "comment_id": 52587118, "body": "I know, but I want to avoid referring <code>some_object.some_attribute</code> twice."}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "reply_to_user": {"reputation": 5186, "user_id": 1690765, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/59237bb43f984f251e904bd4904e4156?s=128&d=identicon&r=PG", "display_name": "Niels B.", "link": "https://stackoverflow.com/users/1690765/niels-b"}, "edited": false, "score": 0, "creation_date": 1441207404, "post_id": 32357069, "comment_id": 52587206, "body": "Unless the attribute is actually a method which is doing some heavy lifting, then there&#39;s very little overhead to calling it twice, it&#39;s a piece of data which is already stored in memory, so this is fast to execute."}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "reply_to_user": {"reputation": 5186, "user_id": 1690765, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/59237bb43f984f251e904bd4904e4156?s=128&d=identicon&r=PG", "display_name": "Niels B.", "link": "https://stackoverflow.com/users/1690765/niels-b"}, "edited": false, "score": 0, "creation_date": 1441207526, "post_id": 32357069, "comment_id": 52587274, "body": "You could set it to a local variable instead, although this really doesn&#39;t help much for only two useages. Or you could add the nil check inside your <code>call_something</code> method, keeping the calling code a bit cleaner. e.g. <code>def call_something(attr); return if attr.nil? ; #main body; end</code>"}], "tags": [], "owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "is_accepted": false, "score": 2, "last_activity_date": 1441207228, "creation_date": 1441207228, "answer_id": 32357069, "question_id": 32357017, "link": "https://stackoverflow.com/questions/32357017/do-something-if-value-is-present/32357069#32357069", "title": "Do something if value is present", "body": "<p>You could try</p>\n\n<pre><code>do_thing(object.attribute) if object.attribute\n</code></pre>\n\n<p>This is usually fine, unless the attribute is a boolean. In which case it will not call if the value is false.</p>\n\n<p>If your attribute can be false, use <code>.nil?</code> instead.</p>\n\n<pre><code>do_thing(object.attribute) unless object.attribute.nil?\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1441207966, "post_id": 32357187, "comment_id": 52587591, "body": "I dislike <code>try</code> for various reasons, but here it is a great answer to the question."}, {"owner": {"reputation": 978, "user_id": 3797480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZuuZI.jpg?s=128&g=1", "display_name": "nsave", "link": "https://stackoverflow.com/users/3797480/nsave"}, "edited": false, "score": 0, "creation_date": 1441208400, "post_id": 32357187, "comment_id": 52587906, "body": "Nice but only if you are on rails"}, {"owner": {"reputation": 5186, "user_id": 1690765, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/59237bb43f984f251e904bd4904e4156?s=128&d=identicon&r=PG", "display_name": "Niels B.", "link": "https://stackoverflow.com/users/1690765/niels-b"}, "edited": false, "score": 0, "creation_date": 1441214918, "post_id": 32357187, "comment_id": 52591903, "body": "Really cool - and it seems that you can omit <code>presence</code> and just invoke <code>try</code> directly."}, {"owner": {"reputation": 5186, "user_id": 1690765, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/59237bb43f984f251e904bd4904e4156?s=128&d=identicon&r=PG", "display_name": "Niels B.", "link": "https://stackoverflow.com/users/1690765/niels-b"}, "edited": false, "score": 0, "creation_date": 1441214930, "post_id": 32357187, "comment_id": 52591915, "body": "Btw, I&#39;m using Rails 4.1"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 978, "user_id": 3797480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZuuZI.jpg?s=128&g=1", "display_name": "nsave", "link": "https://stackoverflow.com/users/3797480/nsave"}, "edited": false, "score": 1, "creation_date": 1441216937, "post_id": 32357187, "comment_id": 52593033, "body": "@nsave, <code>try</code> is available by pulling in the appropriate Active Support core library, making it very lightweight and easily accessible in non-Rails code. See <a href=\"http://guides.rubyonrails.org/active_support_core_extensions.html#try\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/active_support_core_extensions.html#t&zwnj;&#8203;ry</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 5186, "user_id": 1690765, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/59237bb43f984f251e904bd4904e4156?s=128&d=identicon&r=PG", "display_name": "Niels B.", "link": "https://stackoverflow.com/users/1690765/niels-b"}, "edited": false, "score": 1, "creation_date": 1441217298, "post_id": 32357187, "comment_id": 52593227, "body": "@NielsB. not really, in my second example <code>&#39; &#39;.try(&amp;:upcase)</code> would execute the block and return its result, whereas <code>&#39; &#39;.presence.try(&amp;:upcase)</code> does not."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 14, "last_activity_date": 1441207570, "creation_date": 1441207570, "answer_id": 32357187, "question_id": 32357017, "link": "https://stackoverflow.com/questions/32357017/do-something-if-value-is-present/32357187#32357187", "title": "Do something if value is present", "body": "<p>You can use a combination of <a href=\"http://api.rubyonrails.org/classes/Object.html#method-i-presence\"><code>presence</code></a> and <a href=\"http://api.rubyonrails.org/classes/Object.html#method-i-try\"><code>try</code></a>:</p>\n\n<blockquote>\n  <p>If <code>try</code> is called without arguments it yields the receiver to a given block unless it is <code>nil</code>:</p>\n</blockquote>\n\n<pre><code>'foo'.presence.try(&amp;:upcase)\n#=&gt; \"FOO\"\n\n' '.presence.try(&amp;:upcase)\n#=&gt; nil\n\nnil.presence.try(&amp;:upcase)\n#=&gt; nil\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1441217147, "post_id": 32357198, "comment_id": 52593156, "body": "Why not use <a href=\"http://guides.rubyonrails.org/active_support_core_extensions.html#try\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/active_support_core_extensions.html#t&zwnj;&#8203;ry</a> instead. It&#39;s lightweight, it is well tested and supported. Years ago they broke Active Support into little chunks so we can cherry-pick what we want and can rely on the AS maintainers to keep it working."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1441218735, "post_id": 32357198, "comment_id": 52594002, "body": "@theTinMan <code>try</code> is a good choice, I just shew a technique that may be used. I upvoted Stefan\u2019s answer, btw."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1441207595, "creation_date": 1441207595, "answer_id": 32357198, "question_id": 32357017, "link": "https://stackoverflow.com/questions/32357017/do-something-if-value-is-present/32357198#32357198", "title": "Do something if value is present", "body": "<p>Though there is no such functionality out of the box, one could do:</p>\n\n<pre><code>some_object.some_attribute.tap do |attr|\n  attr.present? &amp;&amp; call_smth(attr) \nend\n</code></pre>\n\n<p>On the other hand, Rails provides so many monkeypatches, that one could append one to this circus:</p>\n\n<pre><code>class Object\n  def presense_with_rails\n    raise 'Block required' unless block_given?\n    yield self if self.present? # requires rails\n  end\n  def presense_without_rails\n    raise 'Block required' unless block_given?\n    skip = case self\n           when NilClass, FalseClass then true\n           when String, Array then empty?\n           else false\n           end\n    yield self unless skip\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 5186, "user_id": 1690765, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/59237bb43f984f251e904bd4904e4156?s=128&d=identicon&r=PG", "display_name": "Niels B.", "link": "https://stackoverflow.com/users/1690765/niels-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3733, "favorite_count": 1, "accepted_answer_id": 32357187, "answer_count": 3, "score": 7, "last_activity_date": 1441216832, "creation_date": 1441207071, "last_edit_date": 1441216832, "question_id": 32357017, "link": "https://stackoverflow.com/questions/32357017/do-something-if-value-is-present", "title": "Do something if value is present", "body": "<p>I frequently find myself writing Ruby code where I check for the presence of a value and subsequently do something with that value if it is present. E.g.</p>\n\n<pre><code>if some_object.some_attribute.present?\n  call_something(some_object.some_attribute)\nend\n</code></pre>\n\n<p>I think it would be cool, if it could be written as</p>\n\n<pre><code>some_object.some_attribute.presence { |val| call_something(val) }\n=&gt; the return value of call_something\n</code></pre>\n\n<p>Anyone know if there's such a feature in Ruby or though activesupport?</p>\n\n<p>I opened a <a href=\"https://github.com/rails/rails/pull/21470\" rel=\"nofollow\">pull request</a> for this feature.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1441209234, "post_id": 32356920, "comment_id": 52588421, "body": "You need to clarify some things: What was returned for the failed test cases? Did they return -1 and is that what you expected since they don&#39;t follow either of the rules you have set up?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1441216309, "post_id": 32356920, "comment_id": 52592680, "body": "Welcome to Stack Overflow. Is this a homework problem or a problem for a tutorial? If so, strongly consider whether you want people to tell you how to solve the problem, or do you want to learn on your own? In real, professional, life we don&#39;t get a lot of opportunity to ask others how to do our work. Do it regularly and you&#39;ll need to find another job. Instead we dig in and figure it out."}], "answers": [{"comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1441225793, "post_id": 32358938, "comment_id": 52597762, "body": "After thetinman&#39;s comment, it does look like this might be a homework assignment. I&#39;ll leave my answer, but realize that if it is school work and you just copy the answer then your teacher may expect you to be able to explain what is going on with <code>inject()</code> and how it works. Looking at your code it looked as if you were coming to ruby from another language. Things like the capitalized method name and your while statement are not very ruby-like."}, {"owner": {"reputation": 1, "user_id": 3389010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a8d4aae4fc3f63fb7d3a1487d06229?s=128&d=identicon&r=PG&f=1", "display_name": "Jlmynksfn22", "link": "https://stackoverflow.com/users/3389010/jlmynksfn22"}, "edited": false, "score": 0, "creation_date": 1441723124, "post_id": 32358938, "comment_id": 52783268, "body": "I assure you this is not a homework assignment. I have been looking up a number of problems from resources, such as this one from CoderByte, trying to teach myself Ruby. I am new to programming (been practicing on my own for a couple months) and am starting to understand how to create methods."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "reply_to_user": {"reputation": 1, "user_id": 3389010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a8d4aae4fc3f63fb7d3a1487d06229?s=128&d=identicon&r=PG&f=1", "display_name": "Jlmynksfn22", "link": "https://stackoverflow.com/users/3389010/jlmynksfn22"}, "edited": false, "score": 0, "creation_date": 1441725432, "post_id": 32358938, "comment_id": 52784955, "body": "Does this answer make sense to you. I can explain any thing you need clarified. If you are new to Ruby you should go to ruby-doc.org and read the docs on Enumerable. Inject can be tough to grasp at first but is incredibly handy in cases like this. I&#39;ve tested this solution and can&#39;t find a case where it fails."}, {"owner": {"reputation": 1, "user_id": 3389010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a8d4aae4fc3f63fb7d3a1487d06229?s=128&d=identicon&r=PG&f=1", "display_name": "Jlmynksfn22", "link": "https://stackoverflow.com/users/3389010/jlmynksfn22"}, "edited": false, "score": 0, "creation_date": 1441741763, "post_id": 32358938, "comment_id": 52794044, "body": "Yes, thank you for your feedback. The answer does make sense and I agree, inject is a bit confusing but after manipulating a few cases, I feel I understand. Thanks again."}], "tags": [], "owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "is_accepted": false, "score": 0, "last_activity_date": 1441226063, "last_edit_date": 1441226063, "creation_date": 1441213004, "answer_id": 32358938, "question_id": 32356920, "link": "https://stackoverflow.com/questions/32356920/arithgeoarr-coderbyte-ruby-why-doesnt-this-solution-work-for-certain-test-ca/32358938#32358938", "title": "ArithGeo(arr) CoderByte Ruby: Why doesn&#39;t this solution work for certain test case scenarios", "body": "<p>OK, lets do a much more \"ruby like\" way:</p>\n\n<pre><code>def arith?(arr)\n  check_arr = []\n  arr.reverse.inject {|memo, num| check_arr &lt;&lt; (memo - num); num}\n    #loop through from highest to lowest, subtracting each from the next and store in check_arr\n  check_arr.all? {|num| num == check_arr[-1]}\n    #check that all results are the same in the arr i.e. [2,2,2,2,2]\nend\n</code></pre>\n\n<p>This returns <code>true</code> if all of the operations return the same result, thus a linear progression.</p>\n\n<pre><code>def geo?(arr)\n  check_arr = []\n  arr.reverse.inject {|memo, num| check_arr &lt;&lt; (memo / num); num}\n    #loop through from highest to lowest, dividing each by the next and store in check_arr\n  check_arr.all? {|x| x == check_arr[-1]}\n    #check that all products are the same in the arr i.e. [3,3,3,3,3]\nend\n</code></pre>\n\n<p>This returns true if all of the operations return the same result, thus a geometric progression.</p>\n\n<p>Now use those methods in your other method</p>\n\n<pre><code>def arith_geo?(arr)\n\n  if arith?(arr)\n    'Arithmetic' \n  elsif geo?(arr)\n     'Geometric'\n  else\n    -1\n  end\n\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 3389010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a8d4aae4fc3f63fb7d3a1487d06229?s=128&d=identicon&r=PG&f=1", "display_name": "Jlmynksfn22", "link": "https://stackoverflow.com/users/3389010/jlmynksfn22"}, "edited": false, "score": 0, "creation_date": 1441723200, "post_id": 32378040, "comment_id": 52783321, "body": "Thanks for the feedback! This really helped and I found a number of issues in this code, including the fact that I was creating a nil value while looping through the full length of the array and coming to the end result + 1/+ 2. Thanks again."}], "tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 0, "last_activity_date": 1441289489, "creation_date": 1441289489, "answer_id": 32378040, "question_id": 32356920, "link": "https://stackoverflow.com/questions/32356920/arithgeoarr-coderbyte-ruby-why-doesnt-this-solution-work-for-certain-test-ca/32378040#32378040", "title": "ArithGeo(arr) CoderByte Ruby: Why doesn&#39;t this solution work for certain test case scenarios", "body": "<p>You did use a <code>while</code> but you do not loop over the data, because you write <code>return</code> you will only ever look at the first three numbers and then <em>immediately</em> return the result. You will have to keep the previous result, and make sure the result stays the same to return either geometric or arithmetic. </p>\n\n<p>This should help you to complete the exercise :) </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3389010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a8d4aae4fc3f63fb7d3a1487d06229?s=128&d=identicon&r=PG&f=1", "display_name": "Jlmynksfn22", "link": "https://stackoverflow.com/users/3389010/jlmynksfn22"}, "is_accepted": false, "score": 0, "last_activity_date": 1441723253, "creation_date": 1441723253, "answer_id": 32460676, "question_id": 32356920, "link": "https://stackoverflow.com/questions/32356920/arithgeoarr-coderbyte-ruby-why-doesnt-this-solution-work-for-certain-test-ca/32460676#32460676", "title": "ArithGeo(arr) CoderByte Ruby: Why doesn&#39;t this solution work for certain test case scenarios", "body": "<p>I was able to do the solution in JavaScript and this is what I came up with:</p>\n\n<pre><code>function algoGeo(arr){\n    var algo = true;\n    var geo = true;\n    //first check algo\n    for(var k = 1; k &lt; arr.length; k++){\n        if( (arr[0] + (arr[1] - arr[0]) * k) !== arr[k] &amp;&amp; algo ){\n            algo = false;\n        }\n        if( arr[0] * Math.pow(arr[1] / arr[0], k) !== arr[k] &amp;&amp; geo){\n            geo = false;\n        }\n    }\n    return algo ? \"Arithmetic\" : geo ? \"Geometric\" : -1; \n}\n\nvar arr = [5,12,19,26];\nconsole.log(algoGeo(arr));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 5508163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89641fec2cad508942a7c162095bf08d?s=128&d=identicon&r=PG&f=1", "display_name": "jslice", "link": "https://stackoverflow.com/users/5508163/jslice"}, "is_accepted": false, "score": 0, "last_activity_date": 1449691054, "creation_date": 1449691054, "answer_id": 34187879, "question_id": 32356920, "link": "https://stackoverflow.com/questions/32356920/arithgeoarr-coderbyte-ruby-why-doesnt-this-solution-work-for-certain-test-ca/34187879#34187879", "title": "ArithGeo(arr) CoderByte Ruby: Why doesn&#39;t this solution work for certain test case scenarios", "body": "<pre><code>def ArithGeo(arr)\n  diff1 = []\n  diff2 = []\n  arr.each_index do |x|\n    if(x + 1 &lt; arr.length)\n      diff1 &lt;&lt; arr[x + 1] - arr[x]\n      diff2 &lt;&lt; arr[x + 1] / arr[x]\n     end\n    end\n  diff1.uniq.size == 1 ? \"Arithmetic\" : diff2.uniq.size == 1 ? \"Geometric\" : -1\nend\n</code></pre>\n\n<p>A little late but this is what i came up with when trying to solve this same question. </p>\n"}], "owner": {"reputation": 1, "user_id": 3389010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a8d4aae4fc3f63fb7d3a1487d06229?s=128&d=identicon&r=PG&f=1", "display_name": "Jlmynksfn22", "link": "https://stackoverflow.com/users/3389010/jlmynksfn22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 1, "answer_count": 4, "score": -1, "last_activity_date": 1449691054, "creation_date": 1441206813, "last_edit_date": 1441208128, "question_id": 32356920, "link": "https://stackoverflow.com/questions/32356920/arithgeoarr-coderbyte-ruby-why-doesnt-this-solution-work-for-certain-test-ca", "title": "ArithGeo(arr) CoderByte Ruby: Why doesn&#39;t this solution work for certain test case scenarios", "body": "<p>Below I have posted the instructions for this problem along with my solution. A few test case scenarios have failed, but seem to be working for most. Can anybody help out at which point I've gone wrong? Any help is much appreciated!!</p>\n\n<ul>\n<li><p>Using the Ruby language, have the function ArithGeo(arr) take the array of numbers stored in arr and return the string \"Arithmetic\" if the sequence follows an arithmetic pattern or return \"Geometric\" if it follows a geometric pattern. </p></li>\n<li><p>If the sequence doesn't follow either pattern return -1. </p></li>\n<li><p>An arithmetic sequence is one where the difference between each of the numbers is consistent</p></li>\n<li><p>Arithmetic example: [2, 4, 6, 8]</p></li>\n<li><p>In a geometric sequence, each term after the first is multiplied by some constant or common ratio.</p></li>\n<li><p>Geometric example: [2, 6, 18, 54]</p></li>\n<li><p>Negative numbers may be entered as parameters, 0 will not be entered, and no array will contain all the same elements.</p></li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>def arithGeo(num)\n\n  idx = 0\n  while idx &lt; num.length\n\n    if ((num[idx] - num[idx + 1]) == (num[idx + 1] - num[idx + 2]))\n      return \"Arithmetic\"\n    elsif ((num[idx + 1] / num[idx]) == (num[idx + 2] / num[idx + 1]))\n      return \"Geometric\"\n    else\n      return \"-1\"\n    end\n\n  idx += 1\n  end\n\nend\n\n #Test Cases that Failed\n\n p arithGeo([1, 2, 3, 4, 5, 10, 20])\n\n p arithGeo([1, 2, 3, 4, 5, 6, 7, 88, 2])\n\n p arithGeo([10, 110, 210, 310, 410, 511])\n</code></pre>\n"}, {"tags": ["ruby", "nginx", "geoip", "maxmind"], "answers": [{"comments": [{"owner": {"reputation": 5875, "user_id": 277370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/95a76c24c89bdbe5bd913597b619e1f1?s=128&d=identicon&r=PG", "display_name": "allaire", "link": "https://stackoverflow.com/users/277370/allaire"}, "edited": false, "score": 0, "creation_date": 1441293061, "post_id": 32360383, "comment_id": 52629339, "body": "What I struggle to understand is by default the legacy database returns latin-1 encoded city name. Where in the process does it gets broken? Is it because my html page is utf-8 encoded with the meta tag utf-8? Would I see the accents correctly if my page was latin1 encoded? Thanks for any insights you can provide!"}], "tags": [], "owner": {"reputation": 1557, "user_id": 2535509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13c5ac433fe64c7be20098cdda4d8a9?s=128&d=identicon&r=PG", "display_name": "Greg Oschwald", "link": "https://stackoverflow.com/users/2535509/greg-oschwald"}, "is_accepted": true, "score": 8, "last_activity_date": 1441217744, "creation_date": 1441217744, "answer_id": 32360383, "question_id": 32356640, "link": "https://stackoverflow.com/questions/32356640/maxmind-geoip-city-encoding-issue/32360383#32360383", "title": "Maxmind Geoip city encoding issue", "body": "<p>Although it isn't documented, <a href=\"https://github.com/nginx/nginx/blob/220c36d6128bcf3e869fdd0f7767ead9a4222f08/src/http/modules/ngx_http_geoip_module.c#L814\" rel=\"noreferrer\">it appears</a> that you can force the Nginx module to use UTF-8. To use this, I believe you load the database in the following manner:</p>\n\n<pre><code>http {\n    geoip_city            GeoLiteCity.dat  utf8;\n    ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6778650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c05ba19c3e79a1ab36b52ff2e27c1?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando", "link": "https://stackoverflow.com/users/6778650/fernando"}, "is_accepted": false, "score": 2, "last_activity_date": 1472653273, "last_edit_date": 1472653273, "creation_date": 1472645599, "answer_id": 39249352, "question_id": 32356640, "link": "https://stackoverflow.com/questions/32356640/maxmind-geoip-city-encoding-issue/39249352#39249352", "title": "Maxmind Geoip city encoding issue", "body": "<p>You can use <code>utf8_encode()</code> to get the results that you are trying to achieve.</p>\n\n<p>For example(in php): </p>\n\n<pre><code>// $city_name = $record-&gt;city; \n$city_name = utf8_encode($record-&gt;city);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 632, "user_id": 4845615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-k-_IbriMjQU/AAAAAAAAAAI/AAAAAAAABDM/7vimTa9cQ0A/photo.jpg?sz=128", "display_name": "C&#233;dric Fran&#231;oys", "link": "https://stackoverflow.com/users/4845615/c%c3%a9dric-fran%c3%a7oys"}, "is_accepted": false, "score": 0, "last_activity_date": 1504085156, "creation_date": 1504085156, "answer_id": 45956678, "question_id": 32356640, "link": "https://stackoverflow.com/questions/32356640/maxmind-geoip-city-encoding-issue/45956678#45956678", "title": "Maxmind Geoip city encoding issue", "body": "<p>Despite the fact that MaxMind provides a GeoIPCity API that uses UTF-8 as default charset, it appears that the GeoListeCity.dat uses ANSI encoding. Since some places have no translation in English, it might result in encoding confusion...</p>\n\n<p>Fernando solution is working, but just in case newer versions of geoLiteCity.dat use a non ISO-8859-1 compatible charset, you might also make sure final string is UTF-8 encoded by using <code>mb_convert_encoding</code> :</p>\n\n<pre><code>$location-&gt;city = mb_convert_encoding($location-&gt;city, 'UTF-8');\n</code></pre>\n"}], "owner": {"reputation": 5875, "user_id": 277370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/95a76c24c89bdbe5bd913597b619e1f1?s=128&d=identicon&r=PG", "display_name": "allaire", "link": "https://stackoverflow.com/users/277370/allaire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1201, "favorite_count": 0, "accepted_answer_id": 32360383, "answer_count": 3, "score": 3, "last_activity_date": 1504085156, "creation_date": 1441205980, "question_id": 32356640, "link": "https://stackoverflow.com/questions/32356640/maxmind-geoip-city-encoding-issue", "title": "Maxmind Geoip city encoding issue", "body": "<p>When configuring Max Mind with Nginx (using something like <code>proxy_set_header GEOIP_CITY $geoip_city;</code>), I get encoding issues with the city name when it has accents in it (like Montr\u00e9al).</p>\n\n<p>I\u2019ve search everywhere and I can\u2019t find an nginx switch to force utf-8 encoding. What am I missing?</p>\n\n<p>I tried to <code>city.force_encoding('iso-8859-1').encode('utf-8')</code> on ruby's side, but no dice.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite", "phantomjs", "casperjs"], "comments": [{"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 0, "creation_date": 1441204485, "post_id": 32355967, "comment_id": 52584924, "body": "are you getting an error?  what&#39;s preventing you from saving this data now?"}, {"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1441204520, "post_id": 32355967, "comment_id": 52584953, "body": "You really can&#39;t if the DB doesn&#39;t provide an http api. But surely you can write your results to a file and call some other script which adds the data to the DB."}, {"owner": {"reputation": 245, "user_id": 5265276, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/793786827407572/picture?type=large", "display_name": "Hyung Kyu Park", "link": "https://stackoverflow.com/users/5265276/hyung-kyu-park"}, "edited": false, "score": 0, "creation_date": 1441204806, "post_id": 32355967, "comment_id": 52585204, "body": "Oh, I mean.. in casperjs, I just can check result of parsing only in bash terminal and I can&#39;t write 7,000,000 of words one by one in my seeds.rb so I&#39;d like to know how to do it...!"}, {"owner": {"reputation": 245, "user_id": 5265276, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/793786827407572/picture?type=large", "display_name": "Hyung Kyu Park", "link": "https://stackoverflow.com/users/5265276/hyung-kyu-park"}, "edited": false, "score": 0, "creation_date": 1441205255, "post_id": 32355967, "comment_id": 52585562, "body": "And additionally, I will not parse data just once, maybe I have to do 3,000 times because I have to crawl many of different web pages..."}], "owner": {"reputation": 245, "user_id": 5265276, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/793786827407572/picture?type=large", "display_name": "Hyung Kyu Park", "link": "https://stackoverflow.com/users/5265276/hyung-kyu-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441204241, "creation_date": 1441204241, "question_id": 32355967, "link": "https://stackoverflow.com/questions/32355967/how-to-insert-data-in-db-sqlite3-or-sth-after-parsing-through-casperjs", "title": "How to insert data in DB (SQLite3 or sth) after parsing through casperjs?", "body": "<p>I'm new at ruby on rails and casperjs!</p>\n\n<p>I wrote code that parsing a lot of words (innerHTML) from some webpages.</p>\n\n<p>and I know how to run this code and I can check data in bash terminal</p>\n\n<p>But I don't know how to insert this data directly in my DB (now i'm using SQLite3)</p>\n\n<p>Here is my js code...(filename : application.js)</p>\n\n<pre><code>var words = [];\nvar casper = require('casper').create();\n\n    function getWords() {\n        var words = document.querySelectorAll('td.subject a');\n        return Array.prototype.map.call(words, function(e) {\n            return e.innerHTML;\n        });\n    }\n\n\n        casper.start('http://www.todayhumor.co.kr/board/list.php?table=bestofbest', function() {\n            // search for 'casperjs' from google form\n            words = this.evaluate(getWords);\n        });\n\n        for (var i=2; i &lt;=5; i++) {\n        casper.thenOpen('http://www.todayhumor.co.kr/board/list.php?table=bestofbest&amp;page='+i, function() {\n            // search for 'casperjs' from google form\n\n            words = words.concat(this.evaluate(getWords));\n        });\n        }\n\n    casper.run(function() {\n        // echo results in some pretty fashion\n        this.echo(words.length + ' links found:').exit();\n        this.echo(words.join('\\n')).exit();\n});\n</code></pre>\n\n<p>and </p>\n\n<p>I run this code through terminal like this!</p>\n\n<pre><code>username@wow:~/workspace/app/assets/javascripts $ casperjs application.js\n</code></pre>\n\n<p>and the result is <em>(for example)</em></p>\n\n<pre><code>Fontconfig warning: ignoring C.UTF-8: not a valid language tag\n150 words found:\nword1\nword2\nword3\nword4\nword5\nword6\nword7\nword8\nword9\n...\n</code></pre>\n\n<p>maybe the number of words is over <strong>7,000,000</strong>!</p>\n\n<p>So I want to insert this data in my DB table(seed.rb file)</p>\n\n<p>tell you more details, the db table is consist of 3 columns and will have many rows(<strong>7,000,000</strong> of parsing data)</p>\n\n<p>here is my code of file in migrate directory and <strong>I want to insert words that I parsed in column2(:word)!!</strong></p>\n\n<pre><code>class CreateFans &lt; ActiveRecord::Migration\n  def change\n    create_table :fans do |t|\n       t.string :type\n       t.string :word\n       t.string :spelling\n\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<p>and this is codes of <code>seeds.rb</code> <em>(for example)</em></p>\n\n<pre><code>my_initial_words = [\n                    ['fruits', 'apple', 'ap'],\n                    ['fruits', 'banana', 'ba'],\n                    ['fruits', 'kiwi', 'ki'],\n                    ['fruits', 'melon', 'me'],\n                    ['foods', 'cake', 'ca'],\n                    ['foods', 'pizza', 'pi'],\n                    ['foods', 'hamburger', 'ha'],\n                    ['foods', 'hotdog', 'ho'],\n                    ['foods', 'toast', 'to']                        \n                  ]    \nmy_initial_words.each do |word_data|\n  Fan.create(type: word_data[0], word: word_data[1], spelling: word_data[2])\nend\n</code></pre>\n\n<p>As a conclusion, I'd like to know how to insert parsing data(through casperjs) directly in my DB seed file! or are there any good way to save the data??</p>\n\n<p>Thanks for read my long question!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1219, "user_id": 2463608, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71a718079ab00b87628fd52df9eb6e42?s=128&d=identicon&r=PG", "display_name": "Daiku", "link": "https://stackoverflow.com/users/2463608/daiku"}, "edited": false, "score": 1, "creation_date": 1441204177, "post_id": 32355813, "comment_id": 52584693, "body": "First of all, I would not put a method on an ActiveRecord model named <code>first</code>, as that will override a standard Rails method.  That may or may not be your problem.  I can&#39;t tell because your failure is in code you are not showing, where you call <code>first_class_seats</code>."}, {"owner": {"reputation": 599, "user_id": 4929753, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7f4edccafe958081e3dda2c428095f05?s=128&d=identicon&r=PG&f=1", "display_name": "Pino ", "link": "https://stackoverflow.com/users/4929753/pino"}, "reply_to_user": {"reputation": 1219, "user_id": 2463608, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71a718079ab00b87628fd52df9eb6e42?s=128&d=identicon&r=PG", "display_name": "Daiku", "link": "https://stackoverflow.com/users/2463608/daiku"}, "edited": false, "score": 0, "creation_date": 1441204569, "post_id": 32355813, "comment_id": 52585000, "body": "I changed the name but it still doesn&#39;t work.. I moidified the code above, now you can see where I call first_class_seats, now called prima_classe_seats.. If you can help me I&#39;d really appreciate that"}, {"owner": {"reputation": 599, "user_id": 4929753, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7f4edccafe958081e3dda2c428095f05?s=128&d=identicon&r=PG&f=1", "display_name": "Pino ", "link": "https://stackoverflow.com/users/4929753/pino"}, "edited": false, "score": 0, "creation_date": 1441205302, "post_id": 32355813, "comment_id": 52585599, "body": "I now posted the new error message and I changed first_class_seats to prima_classe_seats"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1441206158, "post_id": 32355813, "comment_id": 52586253, "body": "If <code>route.train.prima_classe_seats</code> raises an <code>undefined method ... for nil</code> exception then the only explanation is: Your <code>reservation</code> has a <code>route</code> that doesn&#39;t have a <code>train</code>. You need to ensure first that your routes allways have trains."}, {"owner": {"reputation": 599, "user_id": 4929753, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7f4edccafe958081e3dda2c428095f05?s=128&d=identicon&r=PG&f=1", "display_name": "Pino ", "link": "https://stackoverflow.com/users/4929753/pino"}, "edited": false, "score": 0, "creation_date": 1441206872, "post_id": 32355813, "comment_id": 52586813, "body": "but the route has a train!"}, {"owner": {"reputation": 1219, "user_id": 2463608, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71a718079ab00b87628fd52df9eb6e42?s=128&d=identicon&r=PG", "display_name": "Daiku", "link": "https://stackoverflow.com/users/2463608/daiku"}, "edited": false, "score": 0, "creation_date": 1441212593, "post_id": 32355813, "comment_id": 52590407, "body": "You still have a method called <code>first</code>."}, {"owner": {"reputation": 1219, "user_id": 2463608, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71a718079ab00b87628fd52df9eb6e42?s=128&d=identicon&r=PG", "display_name": "Daiku", "link": "https://stackoverflow.com/users/2463608/daiku"}, "edited": false, "score": 1, "creation_date": 1441212748, "post_id": 32355813, "comment_id": 52590510, "body": "Do you know how to use <code>byebug</code>?  Put a breakpoint right before the line the fails, and check to see that you have a train."}], "owner": {"reputation": 599, "user_id": 4929753, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7f4edccafe958081e3dda2c428095f05?s=128&d=identicon&r=PG&f=1", "display_name": "Pino ", "link": "https://stackoverflow.com/users/4929753/pino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441205257, "creation_date": 1441203860, "last_edit_date": 1441205257, "question_id": 32355813, "link": "https://stackoverflow.com/questions/32355813/unable-to-run-a-restriction-on-activerecordvalidator-classes", "title": "Unable to run a restriction on ActiveRecord::Validator classes", "body": "<p>I can't understand why this is wrong.\nI have a rail transport site and users shouldn't been able to book a first(or second) class seats if they're already sold out.  Here's the code</p>\n\n<pre><code>class CountValidator &lt; ActiveModel::Validator\ndef validate(record)\n        if (record.second || record.first)\n        record.errors[:base]&lt;&lt; ' error '\n        end \nend \nend\n\nclass DepartureValidator &lt; ActiveModel::Validator\n\ndef validate(record)\n        if record.date_trip.nil? || record.date_trip &lt; Date.today\n        record.errors[:base]&lt;&lt; ' error '\n        end \nend \n\nend \n\nclass Reservation &lt; ActiveRecord::Base\n  validates_with DepartureValidator\n  validates_with CountValidator\n\n  belongs_to :dep ,:class_name =&gt; 'Stop', :foreign_key =&gt; 'dep_id'\n  belongs_to :arr ,:class_name =&gt; 'Stop',:foreign_key =&gt; 'arr_id'\n  belongs_to :route\n  belongs_to :user\n  delegate :CountStop, :to =&gt; :route, prefix: true, :allow_nil =&gt; false\n  delegate :city ,:to =&gt; :arr, :allow_nil =&gt; false\n  delegate :city ,:to =&gt; :dep, :allow_nil =&gt; false\n\ndef division \n  return Reservation.select{|r| r.route_id == route_id &amp;&amp; r.date_trip == date_trip &amp;&amp; r.id != id }\nend\n\ndef second\n        if (class_point == 2)\n        y=division.select{ |l| l.class_point == 2 }.count\n        if(y+1 &gt; route.train.second_class_seats)\n                return true\n        end\n        end\n        return false\nend\ndef first\n        if (class_point == 1)\n        y=division.select{ |l| l.class_point == 1 }.count\n        if(y+1 &gt; route.train.prima_classe_seats)\n                return true\n        end\n        end\n        return false\nend\n\n\nend\n</code></pre>\n\n<p>this is the full error message </p>\n\n<pre><code>    Started POST \"/reservations\" for 127.0.0.1 at 2015-09-02 16:46:01 +0200\nProcessing by ReservationsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"7sHFpj6yzhfy9IC67OTu8qQDuDNCk3Gqhj4iCcRN3fARpkd9bsQCEWZomT6WBFJ8ty5BZk/Fv78PKL5aceL+Eg==\", \"reservation\"=&gt;{\"class_point\"=&gt;\"1\", \"route_id\"=&gt;\"2\", \"dep_id\"=&gt;\"4\", \"arr_id\"=&gt;\"4\"}, \"commit\"=&gt;\"Create reservation!\"}\n  User Load (0.1ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT 1  [[\"id\", 1]]\n   (0.1ms)  begin transaction\n  Reservation Load (0.2ms)  SELECT \"reservations\".* FROM \"reservations\"\n  Route Load (0.1ms)  SELECT  \"routes\".* FROM \"routes\" WHERE \"routes\".\"id\" = ? LIMIT 1  [[\"id\", 2]]\n   (0.1ms)  rollback transaction\nCompleted 500 Internal Server Error in 4ms (ActiveRecord: 0.5ms)\n\nNoMethodError (undefined method `prima_classe_seats' for nil:NilClass):\n  app/models/reservation.rb:47:in `first'\n  app/models/reservation.rb:3:in `validate'\n  app/controllers/reservations_controller.rb:33:in `block in create'\n  app/controllers/reservations_controller.rb:32:in `create'\n\n\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/actionpack-4.2.1/lib/action_dispatch/middleware/templates/rescues/_source.erb (6.1ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/actionpack-4.2.1/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (4.1ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/actionpack-4.2.1/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.6ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/actionpack-4.2.1/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (26.4ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/web-console-2.2.1/lib/web_console/templates/_markup.html.erb (0.5ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/web-console-2.2.1/lib/web_console/templates/_inner_console_markup.html.erb within layouts/inlined_string (0.5ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/web-console-2.2.1/lib/web_console/templates/_prompt_box_markup.html.erb within layouts/inlined_string (0.9ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/web-console-2.2.1/lib/web_console/templates/style.css.erb within layouts/inlined_string (0.5ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/web-console-2.2.1/lib/web_console/templates/console.js.erb within layouts/javascript (18.2ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/web-console-2.2.1/lib/web_console/templates/main.js.erb within layouts/javascript (0.9ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/web-console-2.2.1/lib/web_console/templates/error_page.js.erb within layouts/javascript (0.7ms)\n  Rendered /home/railsuser/.rvm/gems/ruby-2.2.2/gems/web-console-2.2.1/lib/web_console/templates/index.html.erb (35.9ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "credit-card-track-data"], "answers": [{"comments": [{"owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1441231074, "post_id": 32355401, "comment_id": 52600209, "body": "Thanks. Could you explain what would be the allowed names with the above regex?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1441254056, "post_id": 32355401, "comment_id": 52605793, "body": "Whatever that is not started with a percent sign."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1441202738, "creation_date": 1441202738, "answer_id": 32355401, "question_id": 32355160, "link": "https://stackoverflow.com/questions/32355160/ruby-rails-detect-financial-track-data-and-return-nil-empty-string/32355401#32355401", "title": "ruby/rails detect financial track data and return nil/empty string", "body": "<ol>\n<li>Your example input string does not contain format code after first sentinel.</li>\n<li>You are trying to parse html-encoded version, which is weird.</li>\n</ol>\n\n<p>So, I would start with html decoding. E.g. with <a href=\"http://nokogiri.org\" rel=\"nofollow\">Nokogiri</a>:</p>\n\n<pre><code>\u25b6 guestname=\"&amp;#x0025;4234242xx12&amp;#x005E;TEST&amp;#x002F;GUEST L      &amp;#x005E;324532635645744646462\"\n#\u21d2 \"&amp;#x0025;4234242xx12&amp;#x005E;TEST&amp;#x002F;GUEST L      &amp;#x005E;324532635645744646462\"\n\u25b6 parsed = Nokogiri::HTML.parse(guestname).text\n#\u21d2 \"%4234242xx12^TEST/GUEST L      ^324532635645744646462\"\n</code></pre>\n\n<p>OK, now we at least have a leading percent. Now let us ask ourselves: how many users have a guest name starting with a percent sign? I bet none. You might re-check yourself by running a query against your database. Since it is a temporary solution, I would definitely shut the perfectionism up and go with:</p>\n\n<pre><code>\u25b6 parsed =~ /\\A%/ ? '' : parsed\n</code></pre>\n\n<p>Hope it helps. </p>\n"}], "owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441202738, "creation_date": 1441202097, "question_id": 32355160, "link": "https://stackoverflow.com/questions/32355160/ruby-rails-detect-financial-track-data-and-return-nil-empty-string", "title": "ruby/rails detect financial track data and return nil/empty string", "body": "<p>I read through similar stackoverflow questions to understand financial track card data.</p>\n\n<p>I think the issue I am facing might be slightly different or maybe I am really weak in regex.</p>\n\n<p>Now we have a service that returns track data accidentally instead of the guest name.</p>\n\n<p>My goal is every time I receive track data I display \"\" empty string, else return the guest name.( This is a temp solution until we fix the root cause)</p>\n\n<p>This is what my regular expressions is but looks like it doesn't detect track data.</p>\n\n<pre><code>irb(main):043:0&gt; guestname=\"&amp;#x0025;4234242xx12&amp;#x005E;TEST&amp;#x002F;GUEST L      &amp;#x005E;324532635645744646462\"\n\nirb(main):044:0&gt; (/[(%[bB])(;)]\\d{3,}.{9,}[(^.+^)(=)].+\\?.{,2}/.match(guestname)) ? \"\" : guestname\n=&gt; \"&amp;#x0025;4234242xx12&amp;#x005E;TEST&amp;#x002F;GUEST L      &amp;#x005E;324532635645744646462\"\n</code></pre>\n\n<p>(Not real data)</p>\n\n<p>Now, looking at the wiki for track data information I want to cover most cases, if not all:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Magnetic_stripe_card#Financial_cards\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Magnetic_stripe_card#Financial_cards</a></p>\n\n<p><strong>Could some help with my regex. This is what I have:</strong></p>\n\n<p><code>/[(%[bB])(;)]\\d{3,}.{9,}[(^.+^)(=)].+\\?.{,2}</code>/</p>\n\n<blockquote>\n  <p>Track 1, Format B:</p>\n  \n  <p><strong>Start sentinel</strong> \u2014 one character (generally '%')</p>\n  \n  <p><strong>Format code=\"B\"</strong> \u2014 one character (alpha only)</p>\n  \n  <p><strong>Primary account number (PAN)</strong> \u2014 up to 19 characters. Usually, but not\n  always, matches the credit card number printed on the front of the\n  card.</p>\n  \n  <p><strong>Field Separator</strong> \u2014 one character (generally '^')</p>\n  \n  <p><strong>Name</strong> \u2014 2 to 26 characters</p>\n  \n  <p><strong>Field Separator</strong> \u2014 one character (generally '^')</p>\n  \n  <p><strong>Expiration date</strong> \u2014 four characters in the form YYMM.</p>\n  \n  <p><strong>Service code</strong> \u2014 three characters</p>\n  \n  <p><strong>Discretionary data</strong> \u2014 may include Pin Verification Key Indicator (PVKI,\n  1 character), PIN Verification Value (PVV, 4 characters), Card\n  Verification Value or Card Verification Code (CVV or CVC, 3\n  characters)</p>\n  \n  <p><strong>End sentinel</strong> \u2014 one character (generally '?')</p>\n  \n  <p><strong>Longitudinal redundancy check (LRC)</strong> \u2014 it is one character and a\n  validity character calculated from other data on the track.</p>\n  \n  <p><strong>Track 2</strong>: This format was developed by the banking industry (ABA). This\n  track is written with a 5-bit scheme (4 data bits + 1 parity), which\n  allows for sixteen possible characters, which are the numbers 0-9,\n  plus the six characters  : ; &lt; = > ? . The selection of six\n  punctuation symbols may seem odd, but in fact the sixteen codes simply\n  map to the ASCII range 0x30 through 0x3f, which defines ten digit\n  characters plus those six symbols. The data format is as follows:</p>\n  \n  <p><strong>Start sentinel</strong> \u2014 one character (generally ';')</p>\n  \n  <p><strong>Primary account number (PAN)</strong> \u2014 up to 19 characters. Usually, but not\n  always, matches the credit card number printed on the front of the\n  card.</p>\n  \n  <p><strong>Separator</strong> \u2014 one char (generally '=')</p>\n  \n  <p><strong>Expiration date</strong> \u2014 four characters in the form YYMM.</p>\n  \n  <p><strong>Service code</strong> \u2014 three digits. The first digit specifies the interchange\n  rules, the second specifies authorisation processing and the third\n  specifies the range of services</p>\n  \n  <p><strong>Discretionary data</strong> \u2014 as in track one</p>\n  \n  <p><strong>End sentinel</strong> \u2014 one character (generally '?')</p>\n  \n  <p><strong>Longitudinal redundancy check (LRC)</strong> \u2014 it is one character and a\n  validity character calculated from other data on the track. Most\n  reader devices do not return this value when the card is swiped to the\n  presentation layer, and use it only to verify the input internally to\n  the reader.</p>\n</blockquote>\n"}, {"tags": ["ruby", "internationalization", "haml", "rails-i18n"], "answers": [{"tags": [], "owner": {"reputation": 643, "user_id": 1463572, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/01bfce085158b21e02684c6531fc364b?s=128&d=identicon&r=PG", "display_name": "tpei", "link": "https://stackoverflow.com/users/1463572/tpei"}, "is_accepted": true, "score": 0, "last_activity_date": 1441202113, "creation_date": 1441202113, "answer_id": 32355166, "question_id": 32355003, "link": "https://stackoverflow.com/questions/32355003/haml-pass-localized-variable-to-partial/32355166#32355166", "title": "Haml pass localized variable to partial", "body": "<p>Ok, apparently it's</p>\n\n<pre><code>= render 'form', user: @admin_user, roles: @roles, \n  button_name: t('.update_admin_user')\n</code></pre>\n"}], "owner": {"reputation": 643, "user_id": 1463572, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/01bfce085158b21e02684c6531fc364b?s=128&d=identicon&r=PG", "display_name": "tpei", "link": "https://stackoverflow.com/users/1463572/tpei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 32355166, "answer_count": 1, "score": 0, "last_activity_date": 1441202129, "creation_date": 1441201682, "last_edit_date": 1441202129, "question_id": 32355003, "link": "https://stackoverflow.com/questions/32355003/haml-pass-localized-variable-to-partial", "title": "Haml pass localized variable to partial", "body": "<p>I'm rendering a Haml partial in my application and I'd like to localize a parameter I'm passing in.</p>\n\n<p>So instead of</p>\n\n<pre><code>= render 'form', user: @admin_user, roles: @roles,\n  button_name: 'non localized text'\n</code></pre>\n\n<p>I'd like to have something like</p>\n\n<pre><code>= render 'form', user: @admin_user, roles: @roles,\n  button_name: - t '.localized_text_version'\n</code></pre>\n\n<p>to access my yml variable localization. How would I best do that? </p>\n\n<p>Any input is highly appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "irb"], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1441202255, "post_id": 32355148, "comment_id": 52583316, "body": "So the real question is: Why did <code>:symbol.object_id</code> return the same value in  Rails console and IRB (unless it is a coincidence)?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1441202579, "post_id": 32355148, "comment_id": 52583546, "body": "Some sort of caching optimization, most likely. I haven&#39;t kept up with recent developments in YARV, specifically with GC-able <code>Symbol</code>s (I find JRuby+Truffle much more interesting), so I can&#39;t say definitively. It might <i>also</i> be that those Polish <code>\u0142</code>s are encoded differently, and the <code>object_id</code> would have been the same had they been encoded identically. Or maybe the caching only works for pure 7-bit ASCII <code>Symbol</code>s."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1441202778, "last_edit_date": 1441202778, "creation_date": 1441202079, "answer_id": 32355148, "question_id": 32354963, "link": "https://stackoverflow.com/questions/32354963/why-does-object-id-of-symbols-vary-between-rails-console-and-pry-irb/32355148#32355148", "title": "Why does `object_id` of symbols vary between rails console and pry/irb?", "body": "<p>Why not? <code>object_id</code>s only have four properties:</p>\n\n<ul>\n<li><code>object_id</code> is an <code>Integer</code></li>\n<li>every object has an <code>object_id</code></li>\n<li>no two objects have the same <code>object_id</code> at the same time (however, note that two different objects may have the same <code>object_id</code> at <em>different</em> times, i.e. <code>object_id</code>s might get re-used)</li>\n<li>an object's <code>object_id</code> doesn't change during its lifetime</li>\n</ul>\n\n<p>Your observation doesn't violate any of those four properties, therefore, it is perfectly valid.</p>\n\n<p>There may be some optimization and/or caching going on, so that certain <code>Symbol</code>s always have the same <code>object_id</code>. Whatever the case, this is purely an internal implementation detail of YARV and <em>not</em> a semantic of Ruby.</p>\n\n<p>For example, YARV optimizes <code>nil</code>, <code>false</code>, <code>true</code>, <code>Fixnum</code>s (<code>Integer</code>s that fit into n-1 bits, where n is the size of a machine word), flonums (<code>Float</code>s that fit into n-2 bits, for n >= 64) and certain <code>Symbol</code>s, and one side-effect of this is that those objects always have the same <code>object_id</code>. However, that is not guaranteed, and for example, when flonums were introduced, the <code>object_id</code> of <code>nil</code> changed from <code>4</code> to <code>8</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 2, "last_activity_date": 1441206535, "creation_date": 1441206535, "answer_id": 32356831, "question_id": 32354963, "link": "https://stackoverflow.com/questions/32354963/why-does-object-id-of-symbols-vary-between-rails-console-and-pry-irb/32356831#32356831", "title": "Why does `object_id` of symbols vary between rails console and pry/irb?", "body": "<blockquote>\n  <p>Why does <code>:symbol</code> have the same <code>object_id</code> in both cases while <code>:micha\u0142_kulesza</code> has a different one?</p>\n</blockquote>\n\n<p>This is because the symbol <code>:symbol</code> was already generated (by a gem):</p>\n\n<pre><code>$ irb\n\nirb(main):001:0&gt; Symbol.all_symbols.grep /sym/\n#=&gt; [:to_sym, :all_symbols, :symlink?, :symlink, :sym, :symbol, :@post_symbeg]\n#                                                      ^^^^^^^\n\nirb(main):002:0&gt; :symbol.object_id\n#=&gt; 771548\n</code></pre>\n\n<p>If you start IRB without loading any gems, you get a different result:</p>\n\n<pre><code>$ ruby --disable-gems -S irb\n\nirb(main):001:0&gt; Symbol.all_symbols.grep /sym/\n#=&gt; [:to_sym, :all_symbols, :symlink?, :symlink, :@post_symbeg]\n\nirb(main):002:0&gt; :symbol.object_id\n#=&gt; 833308\n</code></pre>\n\n<p>Generating another symbol before <code>:symbol</code> results in a different object id:</p>\n\n<pre><code>$ ruby --disable-gems -S irb\n\nirb(main):001:0&gt; :foo.object_id\n#=&gt; 833308\n\nirb(main):002:0&gt; :symbol.object_id\n#=&gt; 833628\n</code></pre>\n\n<p>Rails generates many symbols, that's why <code>:micha\u0142_kulesza</code> has a much higher object id in rails console.</p>\n"}], "owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 32356831, "answer_count": 2, "score": 0, "last_activity_date": 1441206535, "creation_date": 1441201564, "last_edit_date": 1441202935, "question_id": 32354963, "link": "https://stackoverflow.com/questions/32354963/why-does-object-id-of-symbols-vary-between-rails-console-and-pry-irb", "title": "Why does `object_id` of symbols vary between rails console and pry/irb?", "body": "<p>While I was debugging <code>BasicObject#method_missing</code> (I had a <code>No Id Given</code> error), I came to the conclusion that the first argument of <code>rb_method_missing(int argc, const VALUE *argv, VALUE obj)</code> is mapped to a method name (with the help of <code>:symbol.object_id</code>).</p>\n\n<p>I wanted to check it, so I typed <code>:symbol.object_id</code> in rails console (Rails 4.2/Ruby 2.2):</p>\n\n<pre><code>:symbol.object_id\n# =&gt; 771548\n</code></pre>\n\n<p>Then I checked in IRB (Ruby 2.2):</p>\n\n<pre><code>:symbol.object_id\n# =&gt; 771548\n</code></pre>\n\n<p>and everything looked awesome. I tried in IRB:</p>\n\n<pre><code>:micha\u0142_kulesza.object_id\n# =&gt; 2531228\n</code></pre>\n\n<p>and then in rails console:</p>\n\n<pre><code>:micha\u0142_kulesza.object_id\n# =&gt; 7816668\n</code></pre>\n\n<p>Why does <code>:symbol</code> have the same <code>object_id</code> in both cases while <code>:micha\u0142_kulesza</code> has a different one?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "logging"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1441201245, "post_id": 32354721, "comment_id": 52582589, "body": "Get rid of hms part of time: <code>config.logger = Logger.new(&quot;log&#47;dev_daily_#{Time.now.strftime(&#39;%Y-%m-%d&#39;)}.l&zwnj;&#8203;og&quot;, &#39;daily&#39;)</code>."}, {"owner": {"reputation": 5008, "user_id": 2840147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vcVX6.jpg?s=128&g=1", "display_name": "Sachin Prasad", "link": "https://stackoverflow.com/users/2840147/sachin-prasad"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1441201342, "post_id": 32354721, "comment_id": 52582655, "body": "@mudasobwa What if it overides the logs file? I don&#39;t want that  to happen. I think we need to use the older file if it already exists."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1441201528, "post_id": 32354721, "comment_id": 52582786, "body": "What if you go and give it a try, huh? It will append, not overwrite, as clearly stated in a documentation."}, {"owner": {"reputation": 5008, "user_id": 2840147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vcVX6.jpg?s=128&g=1", "display_name": "Sachin Prasad", "link": "https://stackoverflow.com/users/2840147/sachin-prasad"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1441201813, "post_id": 32354721, "comment_id": 52583022, "body": "@mudasobwa Thanks a lot its working fine :)"}], "owner": {"reputation": 5008, "user_id": 2840147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vcVX6.jpg?s=128&g=1", "display_name": "Sachin Prasad", "link": "https://stackoverflow.com/users/2840147/sachin-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 767, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1441200986, "creation_date": 1441200986, "question_id": 32354721, "link": "https://stackoverflow.com/questions/32354721/rails-create-log-file-daily", "title": "rails create log file daily", "body": "<p>I'm trying to create log files daily. \nHere's the code I'm using:</p>\n\n<pre><code>  config.logger = Logger.new(\"log/dev_daily_#{Time.now.strftime('%Y-%m-%d_%H-%M-%S')}.log\", 'daily')\n</code></pre>\n\n<p>Now the problem with this is that whenever I run my rake task it creates a new log file. This there any way to skip this? </p>\n\n<p>Also, is there any other way of doing this(may be a gem)?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1441201086, "post_id": 32354577, "comment_id": 52582480, "body": "You might find <a href=\"http://stackoverflow.com/questions/2383479/ruby-on-rails-multiple-has-many-through-possible\">this post</a> useful regarding nesting of <code>has_many through</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1441201307, "post_id": 32354577, "comment_id": 52582635, "body": "<code>ControlMedicine.joins(:task =&gt; :medical_order).order(&quot;tasks.created_at DESC&quot;).where(&quot;medical_orders.patient_id = ?&quot;,@patient.id)</code> should work. <code>includes</code> is a query method it is not tied to the class and could be called like <code>@patient.medical_orders.includes(:tasks =&gt; :control_medicines).order(&quot;tasks.created_at DESC&quot;)</code> but since you just want the <code>ControlMedicine</code>s this route will return <code>MedicalOrder</code>s with the tasks and control medicines eager loaded and you would still have to drill down to get them all."}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1441202109, "post_id": 32354577, "comment_id": 52583226, "body": "@engineersmnky I wouldn&#39;t do it that way -- this is a natural fit for the has_many through paradigm in GSPs answer, which allows control_medicines to be sent to a patient instance."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 1, "creation_date": 1441202384, "post_id": 32354577, "comment_id": 52583413, "body": "@DavidAldridge the title is about Query optimization not code refactor and this query will actually require 1 less join than the has_many through because it will not need to join the patient table. I agree from a code readability standpoint that <code>has_many :through</code> is the cleanest solution but my suggestion still fully applies to query optimization."}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1441203371, "post_id": 32354577, "comment_id": 52584130, "body": "@engineersmnky Both GSPs and your code modify the original, so they&#39;re both refactoring. GSPs refactoring represents a better Rails idiom. (GSP&#39;s generated query is incorrect I think, and I edited it to remove the inclusion of &quot;patients&quot;, so performance is not affected)."}, {"owner": {"reputation": 749, "user_id": 1407371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7bd86ea983f40b9fe1a2f9dbaade9d?s=128&d=identicon&r=PG", "display_name": "Francisco Quintero", "link": "https://stackoverflow.com/users/1407371/francisco-quintero"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1441203912, "post_id": 32354577, "comment_id": 52584485, "body": "@engineersmnky your way does the job. If you&#39;d mind adding it as an answer, I would mark it.  Both GSPs and your solution work."}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1441203966, "post_id": 32354577, "comment_id": 52584535, "body": "@Francisco If this was your code base, which method would you use?"}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1441205473, "post_id": 32354577, "comment_id": 52585730, "body": "@Francisco I don&#39;t believe it is more optimised. GSPs inclusion of the patients table in the expected query was an error, I think."}, {"owner": {"reputation": 749, "user_id": 1407371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7bd86ea983f40b9fe1a2f9dbaade9d?s=128&d=identicon&r=PG", "display_name": "Francisco Quintero", "link": "https://stackoverflow.com/users/1407371/francisco-quintero"}, "reply_to_user": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1441221205, "post_id": 32354577, "comment_id": 52595369, "body": "@DavidAldridge I know. I just double checked both queries and they&#39;re the same. They both do the job."}], "answers": [{"comments": [{"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 2, "creation_date": 1441202279, "post_id": 32354818, "comment_id": 52583338, "body": "Yes this is the correct way, except that you might also add scope(s) to order the classes, and merge those scopes into the relations, so that the order in which the control medicines are returned is deterministic. That might be important for the user experience."}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1441203190, "post_id": 32354818, "comment_id": 52584009, "body": "Oh your sample generated query should not include the patients table, I think. At least on Rails 4.2.1 it doesn&#39;t."}], "tags": [], "owner": {"reputation": 3540, "user_id": 131051, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1b41d7397afdd0a922953945f1111e55?s=128&d=identicon&r=PG", "display_name": "GSP", "link": "https://stackoverflow.com/users/131051/gsp"}, "is_accepted": true, "score": 3, "last_activity_date": 1441203226, "last_edit_date": 1441203226, "creation_date": 1441201243, "answer_id": 32354818, "question_id": 32354577, "link": "https://stackoverflow.com/questions/32354577/how-this-active-record-query-could-be-optimized/32354818#32354818", "title": "How this active record query could be optimized?", "body": "<p>You can use the <code>has_many through</code> in Rails to allow ActiveRecord to make your joins for you.</p>\n\n<pre><code>class Patient &lt; ActiveRecord::Base\n  has_many :medical_orders\n  has_many :tasks, through: :medical_orders\n  has_many :control_medicines, through: :tasks\nend\n</code></pre>\n\n<p>Writing your query like:</p>\n\n<pre><code>@patient.control_medicines\n</code></pre>\n\n<p>Generates SQL like: </p>\n\n<pre><code>SELECT \"control_medicines\".* FROM \"control_medicines\" \nINNER JOIN \"tasks\" ON \"tasks\".\"id\" = \"control_medicines\".\"task_id\" \nINNER JOIN \"medical_orders\" ON \"medical_orders\".\"id\" = \"tasks\".\"medical_order_id\" \nWHERE \"medical_orders.patient_id\"  = $1  [[\"id\", 12345]]\n</code></pre>\n"}], "owner": {"reputation": 749, "user_id": 1407371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7bd86ea983f40b9fe1a2f9dbaade9d?s=128&d=identicon&r=PG", "display_name": "Francisco Quintero", "link": "https://stackoverflow.com/users/1407371/francisco-quintero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 32354818, "answer_count": 1, "score": 1, "last_activity_date": 1441203226, "creation_date": 1441200566, "question_id": 32354577, "link": "https://stackoverflow.com/questions/32354577/how-this-active-record-query-could-be-optimized", "title": "How this active record query could be optimized?", "body": "<p>There are these models:</p>\n\n<h2>Patient</h2>\n\n<pre><code>Patient has_many MedicalOrders\n</code></pre>\n\n<h2>MedicalOrder</h2>\n\n<pre><code>MedicalOrder belongs_to Patient\nMedicalOrder has_many Tasks\n</code></pre>\n\n<h2>Task</h2>\n\n<pre><code>Task belongs_to MedicalOrder\nTask has_many ControlMedicines\n</code></pre>\n\n<h2>ControlMedicine</h2>\n\n<pre><code>ControlMedicine belongs_to Task\n</code></pre>\n\n<p>And there's this block of code to get the actual @patient's <strong>control_medicines</strong>:</p>\n\n<pre><code>def index\n @control_medicines = []\n\n @patient.medical_orders.each do |mo|\n    mo.tasks.order(created_at: :desc).each do |t|\n        t.control_medicines.each do |cm|\n            @control_medicines &lt;&lt; cm\n        end\n    end\n  end\nend\n</code></pre>\n\n<p>I know it's not the best way to query associated models but haven't figured out how to do it using <code>.includes()</code> method. Mostly because <code>.includes()</code> only works being called to a Class (eg, <code>Patient.includes()</code>) and they're not suitable for nested models, like in this situation.</p>\n\n<p>I've read about preloading, eager_loading and includes but all the examples are limited to get data from two associated models.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 3540, "user_id": 131051, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1b41d7397afdd0a922953945f1111e55?s=128&d=identicon&r=PG", "display_name": "GSP", "link": "https://stackoverflow.com/users/131051/gsp"}, "edited": false, "score": 0, "creation_date": 1441201416, "post_id": 32354717, "comment_id": 52582705, "body": "That returns what I&#39;d expect: none of the chars are in the [:punct] group which makes me thing the warning is incorrect."}, {"owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "reply_to_user": {"reputation": 3540, "user_id": 131051, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1b41d7397afdd0a922953945f1111e55?s=128&d=identicon&r=PG", "display_name": "GSP", "link": "https://stackoverflow.com/users/131051/gsp"}, "edited": false, "score": 1, "creation_date": 1441206372, "post_id": 32354717, "comment_id": 52586415, "body": "Maybe the Rails app is using a different environment than the one you&#39;re checking in?  You could try running that <code>puts</code> command in the Rails console to be sure."}], "tags": [], "owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "is_accepted": false, "score": 1, "last_activity_date": 1441200961, "creation_date": 1441200961, "answer_id": 32354717, "question_id": 32354550, "link": "https://stackoverflow.com/questions/32354550/regex-punct-character-range-results-in-warning-about-duplicate-range/32354717#32354717", "title": "Regex &quot;punct&quot; character range results in warning about duplicate range", "body": "<p>I don't get that warning in my locale, but what I would assume is that not all of the characters are in <code>[[:punct:]]</code>.  Just remove the ones that are; you can use something like this to figure out which those are:</p>\n\n<pre><code>ruby -e 'puts \"`$&lt;&gt;^|+=~\".chars.grep /[[:punct:]]/'\n</code></pre>\n"}], "owner": {"reputation": 3540, "user_id": 131051, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1b41d7397afdd0a922953945f1111e55?s=128&d=identicon&r=PG", "display_name": "GSP", "link": "https://stackoverflow.com/users/131051/gsp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441200961, "creation_date": 1441200498, "last_edit_date": 1495535197, "question_id": 32354550, "link": "https://stackoverflow.com/questions/32354550/regex-punct-character-range-results-in-warning-about-duplicate-range", "title": "Regex &quot;punct&quot; character range results in warning about duplicate range", "body": "<p>I have a simply library that is intended to create safe slugs for a rails project. The RSpec test looks like this:</p>\n\n<pre><code>RSpec.describe SlugSupport do\n  it 'filters out punctuation' do\n    expect(SlugSupport.slugify('`~!@#$%^&amp;*()_+-={}|[]\\:\",./&lt;&gt;?:\\'\\/\\\\')).to be_nil\n  end\nend\n</code></pre>\n\n<p>and the implementation looks like:</p>\n\n<pre><code>class SlugSupport\n  def self.slugify str\n    slug = str.to_s.downcase.strip\n    tmp = slug.gsub(/[[:punct:]\\s`$&lt;&gt;^|+=~]+/, '-').gsub(/^[-]+/, '')\n    tmp.empty? ? nil : tmp\n  end\nend\n</code></pre>\n\n<p>With this implementation the test works, but results in a warning.</p>\n\n<pre><code>lib/slug_support.rb:8: warning: character class has duplicated range: /[[:punct:]\\s`$&lt;&gt;^|+=~]+/\n</code></pre>\n\n<p>However, when I remove the additional characters from the Regex </p>\n\n<pre><code>slug.gsub(/[[:punct:]\\s]+/, '-').gsub(/^[-]+/, '')\n</code></pre>\n\n<p>I get no warning but the test fails with:</p>\n\n<pre><code>1) SlugSupport filters out punctuation\n Failure/Error: expect(SlugSupport.slugify('`~!@#$%^&amp;*()_+-={}|[]\\:\",./&lt;&gt;?:\\'\\/\\\\')).to be_nil\n   expected: nil\n        got: \"`~-$-^-+-=-|-&lt;&gt;-\"\n # ./spec/lib/slug_support_spec.rb:12:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>From other SO questions (e.g. <a href=\"https://stackoverflow.com/questions/11130490/why-does-ruby-punct-miss-some-punctuation-characters\">Why does Ruby /[[:punct:]]/ miss some punctuation characters?</a> ) the [:punct] character group is behaving correctly for my locale, I think. So the question: is the warning incorrect? And, if the warning is incorrect, which part of the stack generates that warning, RSpec, Rails or Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec3"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 22, "last_activity_date": 1441200282, "creation_date": 1441200282, "answer_id": 32354467, "question_id": 32354356, "link": "https://stackoverflow.com/questions/32354356/how-to-raise-an-exception-in-an-rspec-test/32354467#32354467", "title": "How to raise an exception in an RSpec test", "body": "<p>Like this, for example</p>\n\n<pre><code>expect(object).to receive(:save).and_raise(ActiveRecord::StaleObjectError)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1441203925, "last_edit_date": 1441203925, "creation_date": 1441202733, "answer_id": 32355398, "question_id": 32354356, "link": "https://stackoverflow.com/questions/32354356/how-to-raise-an-exception-in-an-rspec-test/32355398#32355398", "title": "How to raise an exception in an RSpec test", "body": "<p>I would do something like this:</p>\n\n<pre><code>describe '#update' do\n  let(:object) { double }\n\n  before do \n    allow(Object).to receive(:find).with('5').and_return(object)\n    xhr(:put, :update, id: 5)\n  end\n\n  context 'when `save` is successful' do\n    before do \n      allow(object).to receive(:save).and_return(true)\n    end\n\n    it 'returns the object' do\n      expect(response).to be_success\n      expect(assigns(:object)).to eq(object)\n    end\n  end\n\n  context 'when `save` raises a `StaleObjectError`' do\n    before do \n      allow(object).to receive(:save).and_raise(ActiveRecord::StaleObjectError) \n    end\n\n    it 'is not successful' do\n      expect(response).to_not be_success\n    end\n  end\nend\n</code></pre>\n\n<p>Please note that I make a difference between stubing methods in the test setup (I prefer <code>allow</code> in this case) and the actual expectation (<code>expect</code>).</p>\n"}], "owner": {"reputation": 1809, "user_id": 4966705, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh5.googleusercontent.com/-33GGBSJvG1o/AAAAAAAAAAI/AAAAAAAAAEw/l3yn5OOYHKA/photo.jpg?sz=128", "display_name": "rob", "link": "https://stackoverflow.com/users/4966705/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9769, "favorite_count": 0, "accepted_answer_id": 32354467, "answer_count": 2, "score": 6, "last_activity_date": 1510328483, "creation_date": 1441200041, "last_edit_date": 1510328483, "question_id": 32354356, "link": "https://stackoverflow.com/questions/32354356/how-to-raise-an-exception-in-an-rspec-test", "title": "How to raise an exception in an RSpec test", "body": "<p>I'm stuck on a test scenario.</p>\n\n<p>I have a controller method:</p>\n\n<pre><code>def update\n  @object = Object.find params[:id]\n  # some other stuff\n  @object.save\n  rescue ActiveRecord::StaleObjectError\n    # woo other stuff\nend  \n</code></pre>\n\n<p>The first part I test with:</p>\n\n<pre><code>context '#update'\n  let(:object) { double }\n\n  it 'nothing fails' do\n    # some other stuff\n    expect(Object).to receive(:find).with('5').and_return(object)\n    expect(object).to receive(:save).and_return(true)\n    xhr :put, :update, id:5\n    expect(response).to be_success\n    expect(assigns(:object)).to eq(object)\n  end\nend\n</code></pre>\n\n<p>Now I want to test the <code>ActiveRecord::StaleObjectError</code> exception. I want to stub it, but I didn't find any solution how to do this.</p>\n\n<p>So my question is, how to raise the <code>ActiveRecord::StaleObjectError</code> in an RSpec test?</p>\n"}, {"tags": ["ruby", "file"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1441199740, "post_id": 32354017, "comment_id": 52581463, "body": "Please share a couple of lines from <code>&#47;PATH_TO_FILE&#47;dates_randoms.tsv</code>. BTW, you do not close this file descriptor, so there might be any garbage in it."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1441200103, "post_id": 32354017, "comment_id": 52581714, "body": "@mudasobwa: it&#39;s the newline"}, {"owner": {"reputation": 4828, "user_id": 594765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0QpY8.png?s=128&g=1", "display_name": "JBoy", "link": "https://stackoverflow.com/users/594765/jboy"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1441200109, "post_id": 32354017, "comment_id": 52581719, "body": "@lurker that was a mistake thx for noticing, the random variable is being picked up within the <code>puts</code> command of the first snippet."}, {"owner": {"reputation": 4828, "user_id": 594765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0QpY8.png?s=128&g=1", "display_name": "JBoy", "link": "https://stackoverflow.com/users/594765/jboy"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1441200204, "post_id": 32354017, "comment_id": 52581792, "body": "@mudasobwa the <code>file.close</code> is called in the next piece of code that is not shown in that snipped as its irrelevant, but thx for noticing"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1441200490, "post_id": 32354352, "comment_id": 52581999, "body": "Indeed. It looks like the substitution is being done at filesystem level."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 7, "last_activity_date": 1441200030, "creation_date": 1441200030, "answer_id": 32354352, "question_id": 32354017, "link": "https://stackoverflow.com/questions/32354017/ruby-question-mark-in-filename/32354352#32354352", "title": "Ruby question mark in filename", "body": "<pre><code> parts = line.split(\"\\t\")\n random = parts.at(1)\n</code></pre>\n\n<p><code>line</code> there will contain a trailing newline char. So for a line</p>\n\n<pre><code>\"whatever\\t1234\\n\"\n</code></pre>\n\n<p><code>random</code> will contain <code>\"1234\\n\"</code>. That newline char then becomes a part of filename and you see it as a question mark. The simplest workaround is to do some sanitization:</p>\n\n<pre><code>random = parts.at(1).chomp\n# alternatively use .strip if you want to remove whitespaces \n# from beginning of the value too\n</code></pre>\n"}], "owner": {"reputation": 4828, "user_id": 594765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0QpY8.png?s=128&g=1", "display_name": "JBoy", "link": "https://stackoverflow.com/users/594765/jboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 32354352, "answer_count": 1, "score": 0, "last_activity_date": 1441200030, "creation_date": 1441199163, "last_edit_date": 1441199869, "question_id": 32354017, "link": "https://stackoverflow.com/questions/32354017/ruby-question-mark-in-filename", "title": "Ruby question mark in filename", "body": "<p>I have a little piece of ruby that creates a file containing tsv content with 2 columns, a date, and a random number.</p>\n\n<pre><code>   #!/usr/bin/ruby\n\nrequire 'date'\nrequire 'set'\n\nstartDate=Date.new(2014,11,1)\nendDate=Date.new(2015,9,1)\n\ndates=File.new(\"/PATH_TO_FILE/dates_randoms.tsv\",\"w+\")\n\nrands=Set.new\n\nwhile startDate &lt;= endDate do\n   random=rand(1000)\n   while rands.add?(random).nil? do\n     random=rand(1000)\n   end\n   dates.puts(\"#{startDate.to_s.gsub(\"-\",\"\")}   #{random}\")\n   startDate=startDate+1\nend\n</code></pre>\n\n<p>Then, from another program, i read this file and create a file out of the random number:</p>\n\n<pre><code>  dates_file=File.new(DATES_FILE_PATH,\"r\")\n    dates_file.each_line do |line|\n      parts=line.split(\"\\t\")\n      random=parts.at(1)\n      table=File.new(\"#{TMP_DIR}#{random}.tsv\",\"w\")\n    end\n</code></pre>\n\n<p>But when i go and check the file i see <code>645?.tsv</code> for example.\nI initially thought that was the line separator in the tsv file (the one containing the date and the random) but its run in the same unix filesystem, its not a transaction from dos to unix\nSome lines from the file:</p>\n\n<pre><code>head dates_randoms.tsv\n20141101        356\n20141102        604\n20141103        680\n20141104        668\n20141105        995\n20141106        946\n20141107        354\n20141108        234\n20141109        429\n20141110        384\n</code></pre>\n\n<p>Any advice?</p>\n"}, {"tags": ["ruby", "macos", "openssl", "rvm"], "comments": [{"owner": {"reputation": 493, "user_id": 2232802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d5e2910b69c2dc2e75e329c427ced6?s=128&d=identicon&r=PG", "display_name": "Artur Peniche", "link": "https://stackoverflow.com/users/2232802/artur-peniche"}, "edited": false, "score": 0, "creation_date": 1441199064, "post_id": 32353917, "comment_id": 52580954, "body": "have you read this article? <a href=\"https://gist.github.com/luislavena/f064211759ee0f806c88\" rel=\"nofollow noreferrer\">gist.github.com/luislavena/f064211759ee0f806c88</a>"}, {"owner": {"reputation": 1985, "user_id": 1629709, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ykH7V.png?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1629709/sebastian"}, "reply_to_user": {"reputation": 493, "user_id": 2232802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d5e2910b69c2dc2e75e329c427ced6?s=128&d=identicon&r=PG", "display_name": "Artur Peniche", "link": "https://stackoverflow.com/users/2232802/artur-peniche"}, "edited": false, "score": 0, "creation_date": 1441199284, "post_id": 32353917, "comment_id": 52581123, "body": "Yes, I already have a AddTrustExternalCARoot-2048.pem in my .rvm/rubies/ruby-2.2.3/lib/ruby/2.2.0/rubygems/ssl_certs folder"}], "answers": [{"comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 1, "creation_date": 1447875864, "post_id": 32363597, "comment_id": 55344850, "body": "Ditto on reinstalling and disabling binary solving these problems."}, {"owner": {"reputation": 4112, "user_id": 3624671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6809b1a8ab341528232408bcf4f0d079?s=128&d=identicon&r=PG", "display_name": "Taysky", "link": "https://stackoverflow.com/users/3624671/taysky"}, "edited": false, "score": 0, "creation_date": 1448745889, "post_id": 32363597, "comment_id": 55709515, "body": "Why does disabling binary fix it?"}, {"owner": {"reputation": 1, "user_id": 536622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2129e119ffeb986497d80db7fdaa9f?s=128&d=identicon&r=PG", "display_name": "geekbri", "link": "https://stackoverflow.com/users/536622/geekbri"}, "reply_to_user": {"reputation": 4112, "user_id": 3624671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6809b1a8ab341528232408bcf4f0d079?s=128&d=identicon&r=PG", "display_name": "Taysky", "link": "https://stackoverflow.com/users/3624671/taysky"}, "edited": false, "score": 1, "creation_date": 1449684935, "post_id": 32363597, "comment_id": 56125009, "body": "@Taysky the reason disabling the binary works is that the binaries being used by RVM are linking to /etc/openssl for the certs dir and the cert file, which is mostly likely not where they are most peoples systems. You can of course just set the path using the environmental variables noted. However some people would rather just compile ruby by hand and avoid that."}, {"owner": {"reputation": 4112, "user_id": 3624671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6809b1a8ab341528232408bcf4f0d079?s=128&d=identicon&r=PG", "display_name": "Taysky", "link": "https://stackoverflow.com/users/3624671/taysky"}, "reply_to_user": {"reputation": 1, "user_id": 536622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2129e119ffeb986497d80db7fdaa9f?s=128&d=identicon&r=PG", "display_name": "geekbri", "link": "https://stackoverflow.com/users/536622/geekbri"}, "edited": false, "score": 0, "creation_date": 1449769149, "post_id": 32363597, "comment_id": 56161040, "body": "@geekbri - ah ok. Thanks!"}, {"owner": {"reputation": 4831, "user_id": 3144928, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e2a01c799169f3de4c57c0f0366840f?s=128&d=identicon&r=PG", "display_name": "Ben Aubin", "link": "https://stackoverflow.com/users/3144928/ben-aubin"}, "edited": false, "score": 0, "creation_date": 1453171709, "post_id": 32363597, "comment_id": 57474564, "body": "can&#39;t you just <code>rvm reinstall 2.2.3 --disable-binary</code>? No idea if that will work 100%, though."}, {"owner": {"reputation": 171, "user_id": 3999144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kgoyt.jpg?s=128&g=1", "display_name": "Colin Lee", "link": "https://stackoverflow.com/users/3999144/colin-lee"}, "edited": false, "score": 0, "creation_date": 1486867199, "post_id": 32363597, "comment_id": 71529826, "body": "That works for me. Although there is still SSL warnings but the bundler works. Thanks very much!"}], "tags": [], "owner": {"reputation": 1985, "user_id": 1629709, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ykH7V.png?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1629709/sebastian"}, "is_accepted": true, "score": 20, "last_activity_date": 1441283260, "last_edit_date": 1441283260, "creation_date": 1441230069, "answer_id": 32363597, "question_id": 32353917, "link": "https://stackoverflow.com/questions/32353917/cant-run-ruby-2-2-3-with-rvm-on-osx/32363597#32363597", "title": "Can&#39;t run Ruby 2.2.3 with RVM on OSX", "body": "<p>Downloading <a href=\"http://curl.haxx.se/ca/cacert.pem\" rel=\"noreferrer\">http://curl.haxx.se/ca/cacert.pem</a> and adding</p>\n\n<pre><code>export SSL_CERT_FILE=PATH_TO_THe_DOWNLOADED_FILE/cacert.pem\n</code></pre>\n\n<p>to the .bash_profile/.zshrc partially fixed the issue, because it throws the following error on my system:</p>\n\n<pre><code>Excon::Errors::SocketError: Unable to verify certificate, please set `Excon.defaults[:ssl_ca_path] = path_to_certs`, `ENV['SSL_CERT_DIR'] = path_to_certs`, `Excon.defaults[:ssl_ca_file] = path_to_file`, `ENV['SSL_CERT_FILE'] = path_to_file`, `Excon.defaults[:ssl_verify_callback] = callback` (see OpenSSL::SSL::SSLContext#verify_callback), or `Excon.defaults[:ssl_verify_peer] = false` (less secure).\n</code></pre>\n\n<p>Setting Excon.defaults[:ssl_verify_peer] to false in a Rails initializer (only on development/test envs) makes it work.</p>\n\n<p><strong>Update:</strong> Reinstalling 2.2.3 from source got rid of all my problems.</p>\n\n<pre><code>rvm remove 2.2.3\nrvm install 2.2.3 --disable-binary\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2106, "user_id": 2044567, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Mii0y.jpg?s=128&g=1", "display_name": "igraczech", "link": "https://stackoverflow.com/users/2044567/igraczech"}, "is_accepted": false, "score": 0, "last_activity_date": 1457713963, "creation_date": 1457713963, "answer_id": 35945321, "question_id": 32353917, "link": "https://stackoverflow.com/questions/32353917/cant-run-ruby-2-2-3-with-rvm-on-osx/35945321#35945321", "title": "Can&#39;t run Ruby 2.2.3 with RVM on OSX", "body": "<p>Couldn't help myself otherwise than with <code>brew install openssl</code> on El Capitan. I've tried everything like updating certs using RVM, replacing SSL certs from haxx.se, or reinstalling ruby. Nothing else worked.</p>\n"}], "owner": {"reputation": 1985, "user_id": 1629709, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ykH7V.png?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1629709/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4096, "favorite_count": 1, "accepted_answer_id": 32363597, "answer_count": 2, "score": 10, "last_activity_date": 1457713963, "creation_date": 1441198840, "question_id": 32353917, "link": "https://stackoverflow.com/questions/32353917/cant-run-ruby-2-2-3-with-rvm-on-osx", "title": "Can&#39;t run Ruby 2.2.3 with RVM on OSX", "body": "<p>I've got two MacBooks (one on Mavericks, the other on Yosemite) and the same thing happens on both.\nAfter installing Ruby 2.2.3 with RVM, I get the following error:</p>\n\n<pre><code>.rvm/rubies/ruby-2.2.3/lib/ruby/2.2.0/net/http.rb:923:in `connect': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (Faraday::SSLError)\n</code></pre>\n\n<p>I've tried searching for a solution online, but nothing seems to work. Most of the people having this issues are running Windows machines.</p>\n\n<pre><code>$ rvm osx-ssl-certs status all\nCertificates for /usr/local/etc/openssl/cert.pem: Up to date.\nCertificates for /etc/openssl/cert.pem: Up to date.\n</code></pre>\n\n<p>Switching back to 2.2.2 works fine. Any thoughts?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "html"], "comments": [{"owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "edited": false, "score": 0, "creation_date": 1441199791, "post_id": 32353803, "comment_id": 52581497, "body": "There is no standard helper for it yet, but you can easily write one yourself."}, {"owner": {"reputation": 414, "user_id": 1082351, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/add35b737f797f13838941cf584f2b4a?s=128&d=identicon&r=PG", "display_name": "Nick Weavers", "link": "https://stackoverflow.com/users/1082351/nick-weavers"}, "reply_to_user": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "edited": false, "score": 0, "creation_date": 1441202902, "post_id": 32353803, "comment_id": 52583785, "body": "Thanks @dimakura, I&#39;m still relatively new to Ruby so that would probably be a stretch for me."}], "answers": [{"comments": [{"owner": {"reputation": 414, "user_id": 1082351, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/add35b737f797f13838941cf584f2b4a?s=128&d=identicon&r=PG", "display_name": "Nick Weavers", "link": "https://stackoverflow.com/users/1082351/nick-weavers"}, "edited": false, "score": 0, "creation_date": 1441271097, "post_id": 32354319, "comment_id": 52614151, "body": "Thanks @dimakura. I know how to do it using html in my erb. My question was &quot;Is there any built in support in Ruby/Rails for these new methods of form control?&quot; If you could make your first comment &quot;There is no standard helper for it yet, but you can easily write one yourself.&quot; an answer I&#39;d accept it."}], "tags": [], "owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "is_accepted": true, "score": 1, "last_activity_date": 1441274031, "last_edit_date": 1441274031, "creation_date": 1441199929, "answer_id": 32354319, "question_id": 32353803, "link": "https://stackoverflow.com/questions/32353803/is-there-any-built-in-support-in-ruby-rails-for-the-formaction-button-attribute/32354319#32354319", "title": "Is there any built in support in Ruby/Rails for the formaction button attribute in HTML5?", "body": "<p>There is no standard helper for it yet, but you can easily write one yourself.</p>\n"}], "owner": {"reputation": 414, "user_id": 1082351, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/add35b737f797f13838941cf584f2b4a?s=128&d=identicon&r=PG", "display_name": "Nick Weavers", "link": "https://stackoverflow.com/users/1082351/nick-weavers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "accepted_answer_id": 32354319, "answer_count": 1, "score": 1, "last_activity_date": 1441274031, "creation_date": 1441198574, "last_edit_date": 1441270909, "question_id": 32353803, "link": "https://stackoverflow.com/questions/32353803/is-there-any-built-in-support-in-ruby-rails-for-the-formaction-button-attribute", "title": "Is there any built in support in Ruby/Rails for the formaction button attribute in HTML5?", "body": "<p>HTML5 introduced a couple of new attributes where a type=submit button can override the action defined by the form tag, and even specify which form it submits. The button attributes are formaction and form respectively. The first takes a URL and the second an id. Is there any built in support in Ruby/Rails for these new methods of form control?</p>\n\n<p>In my case I would like two buttons on an email form; one to save and send, the other just to save and return.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "nokogiri"], "comments": [{"owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "edited": false, "score": 1, "creation_date": 1441198802, "post_id": 32353715, "comment_id": 52580746, "body": "Here is a detailed answer how to install nokogiri on osx:    <a href=\"http://stackoverflow.com/questions/24091869/installing-nokogiri-on-osx-10-10-yosemite\" title=\"installing nokogiri on osx 10 10 yosemite\">stackoverflow.com/questions/24091869/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1160, "user_id": 3593460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3ee65bf7ae8f8793601079ef009bb7?s=128&d=identicon&r=PG&f=1", "display_name": "viks", "link": "https://stackoverflow.com/users/3593460/viks"}, "edited": false, "score": 0, "creation_date": 1447742694, "post_id": 32390983, "comment_id": 55269158, "body": "Worked for me!                                                                                       $ sudo rm /Users/username/.rbenv/versions/2.2.3/lib/ruby/gems/2.2.0/ca&zwnj;&#8203;che/nokogiri-1.6.6.2&zwnj;&#8203;.gem                                                                                               $ gem install nokogiri -v &#39;1.6.6.2&#39;"}], "tags": [], "owner": {"reputation": 1169, "user_id": 2980650, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/245ca292e170237592a28dcac223a196?s=128&d=identicon&r=PG&f=1", "display_name": "Mezbah", "link": "https://stackoverflow.com/users/2980650/mezbah"}, "is_accepted": true, "score": 11, "last_activity_date": 1441346070, "creation_date": 1441346070, "answer_id": 32390983, "question_id": 32353715, "link": "https://stackoverflow.com/questions/32353715/invalid-gem-package-is-corrupt-while-installing-rails-in-osx-yosemite-10-10/32390983#32390983", "title": "invalid gem: package is corrupt -- while installing rails in osx yosemite 10.10.1", "body": "<p>I got my answer. I remove previous cache and then everything fine.</p>\n\n<pre><code>sudo rm /Users/username/.rbenv/versions/2.2.3/lib/ruby/gems/2.2.0/cache/nokogiri-1.6.6.2.gem\n\nbrew install libiconv   \n\ngem install nokogiri\n</code></pre>\n"}], "owner": {"reputation": 1169, "user_id": 2980650, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/245ca292e170237592a28dcac223a196?s=128&d=identicon&r=PG&f=1", "display_name": "Mezbah", "link": "https://stackoverflow.com/users/2980650/mezbah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3993, "favorite_count": 0, "accepted_answer_id": 32390983, "answer_count": 1, "score": 4, "last_activity_date": 1441346070, "creation_date": 1441198358, "question_id": 32353715, "link": "https://stackoverflow.com/questions/32353715/invalid-gem-package-is-corrupt-while-installing-rails-in-osx-yosemite-10-10", "title": "invalid gem: package is corrupt -- while installing rails in osx yosemite 10.10.1", "body": "<p>I am getting this error while installing rails in osx yosemite 10.10.1</p>\n\n<pre><code> mezbah$ gem install rails --no-ri --no-rdoc\n    ERROR:  Error installing rails:\n        invalid gem: package is corrupt, exception while verifying: undefined method `size' for nil:NilClass (NoMethodError) in /Users/mezbah/.rbenv/versions/2.2.3/lib/ruby/gems/2.2.0/cache/nokogiri-1.6.6.2.gem\n mezbah$ gem install nokogiri\n       ERROR:  Error installing nokogiri:\n            invalid gem: package is corrupt, exception while verifying: undefined method `size' for nil:NilClass (NoMethodError) in /Users/mezbah/.rbenv/versions/2.2.3/lib/ruby/gems/2.2.0/cache/nokogiri-1.6.6.2.gem\n</code></pre>\n\n<p>Any Idea??</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1441199633, "post_id": 32354013, "comment_id": 52581386, "body": "How you managed to make <code>change_it</code> a method of <code>v</code> in your example with <code>tap</code> - not sure that code works - I am just trying to understand"}, {"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "edited": false, "score": 0, "creation_date": 1441199680, "post_id": 32354013, "comment_id": 52581426, "body": "@mudasobwa <code>&amp;&amp;=</code> checks to see if the left side evaluates to true, correct?  If it does, then it executes the right side?"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 1, "creation_date": 1441199861, "post_id": 32354013, "comment_id": 52581545, "body": "To clarify, <code>&amp;&amp;=</code> only does the assignment if <i>not</i> nil and <i>not</i> false"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1441199915, "post_id": 32354013, "comment_id": 52581586, "body": "To <code>truthy</code>, in other words in it neither <code>false</code> nor <code>nil</code>. <code>tap</code> just taps the receiver, as soon as the hint 1. above is applied, hash values have <code>change_it</code> method on them."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1441200167, "last_edit_date": 1441200167, "creation_date": 1441199149, "answer_id": 32354013, "question_id": 32353677, "link": "https://stackoverflow.com/questions/32353677/reduce-length-and-or-dry-out-assignment-statement-that-occurs-based-on-presence/32354013#32354013", "title": "Reduce length and/or dry out assignment statement that occurs based on presence", "body": "<p>This particular line could not be rewritten shortly (at least I do not see any reasonable way to do it,) mostly because the whole design is not quite rubyish.</p>\n\n<ol>\n<li>Use inplace change instead of reassignment. <code>a = change_it(a)</code> is bad, <code>a.change_it</code> is good (whenever possible and it turns out it is possible nearly always.)</li>\n<li><code>a.present?</code> in most cases is a superfluous check. Do you really need it? Won\u2019t plain old good ruby <code>if a</code> suffice?</li>\n</ol>\n\n<p>With refactoring above taken into consideration, the codepiece above would become:</p>\n\n<p><em>with simple check for <code>nil or false</code>:</em></p>\n\n<pre><code>self.some_hash[:some_key] &amp;&amp;= change_it self.some_hash[:some_key]\n</code></pre>\n\n<p><em>with both changes:</em></p>\n\n<pre><code>self.some_hash[:some_key].tap { |v| v.change_it if v }\n</code></pre>\n\n<p>I understand that is not an exact answer on your question, but I hope it might help.</p>\n\n<p><strong>UPD</strong> As noted by @WandMaker, <code>self</code> looks suspiciously superfluous here as well.</p>\n"}, {"tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 1, "last_activity_date": 1441199674, "creation_date": 1441199674, "answer_id": 32354242, "question_id": 32353677, "link": "https://stackoverflow.com/questions/32353677/reduce-length-and-or-dry-out-assignment-statement-that-occurs-based-on-presence/32354242#32354242", "title": "Reduce length and/or dry out assignment statement that occurs based on presence", "body": "<p>There is a simple alternative</p>\n\n<pre><code>hash[:key] &amp;&amp;= change_it(hash[:key])\n</code></pre>\n\n<p>but it only checks for <code>nil</code> and it will not set the value again if it was false, which may or may not be what you want. While <code>.present?</code> not only checks for nil but also when given a string or array, if is non-empty.</p>\n\n<p>Alternatively, Why not just define a method? </p>\n\n<p>E.g.</p>\n\n<pre><code>def change_if_present(hash, key)\n  hash[key] = change_it(hash[key]) if hash[key].present? \nend \n</code></pre>\n\n<p>or if you have to do the same for a bunch of keys, you could just write</p>\n\n<pre><code>[:key_a, :key_b, ...].each do |key|\n   hash[key] = change_it(hash[:key]) if hash[:key].present? \nend \n</code></pre>\n\n<p>And then you could even wrap that in a method</p>\n\n<pre><code>def change_values_if_key_present(hash, keys)\n  keys.each do |key|\n    hash[key] = change_it(hash[key]) if hash[key].present? \n  end\nend \n</code></pre>\n\n<p>Of course this is assuming the change is the same for all keys. </p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 32354013, "answer_count": 2, "score": -1, "last_activity_date": 1441200167, "creation_date": 1441198269, "last_edit_date": 1441198629, "question_id": 32353677, "link": "https://stackoverflow.com/questions/32353677/reduce-length-and-or-dry-out-assignment-statement-that-occurs-based-on-presence", "title": "Reduce length and/or dry out assignment statement that occurs based on presence", "body": "<p>Within a class method I have the following line:</p>\n\n<pre><code>self.some_hash[:some_key] = change_it(self.some_hash[:some_key]) if self.some_hash[:some_key].present?\n</code></pre>\n\n<p>It works, but it is a long statement, mostly because I am repeating <code>self.some_hash[:some_key]</code> three times within the assignment statement.  </p>\n\n<p>Is there some ruby syntactic sugar for this where I can shorten this line of code?  Maybe by doing some syntactic sugar to reduce repeating <code>self.some_hash[:some_key]</code> three times, or perhaps another technique?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "foreign-keys", "mariadb"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 206798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559b27de124ce7dfa6a8173160d4c12b?s=128&d=identicon&r=PG", "display_name": "kasi", "link": "https://stackoverflow.com/users/206798/kasi"}, "edited": false, "score": 0, "creation_date": 1441210260, "post_id": 32357789, "comment_id": 52589090, "body": "Hi, thanks for the answer, unfortunately that is exactly my issue - I am aware that it is not applicable but I didn&#39;t create the statement, it is generated somewhere between my Rails App and the mariadbclient lib - I have no idea where it comes from..."}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "reply_to_user": {"reputation": 1, "user_id": 206798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559b27de124ce7dfa6a8173160d4c12b?s=128&d=identicon&r=PG", "display_name": "kasi", "link": "https://stackoverflow.com/users/206798/kasi"}, "edited": false, "score": 0, "creation_date": 1441211481, "post_id": 32357789, "comment_id": 52589794, "body": "Alas, another case of a 3rd party software getting in the way."}], "tags": [], "owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "is_accepted": false, "score": 0, "last_activity_date": 1441209385, "creation_date": 1441209385, "answer_id": 32357789, "question_id": 32353052, "link": "https://stackoverflow.com/questions/32353052/ruby-on-rails-foreign-key-migration-on-mariadb-10-0-20-server-does-not-apply/32357789#32357789", "title": "Ruby on Rails foreign key migration on MariaDB 10.0.20 Server does not apply", "body": "<blockquote>\n  <p>TRANSACTIONAL is only applicable for Aria tables.</p>\n</blockquote>\n\n<p>Reference:\n<a href=\"https://mariadb.com/kb/en/mariadb/create-table/#transactional\" rel=\"nofollow\">https://mariadb.com/kb/en/mariadb/create-table/#transactional</a></p>\n\n<p>So leave it off when creating InnoDB/XtraDB tables.</p>\n\n<p>FOREIGN KEYS are supported.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 206798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559b27de124ce7dfa6a8173160d4c12b?s=128&d=identicon&r=PG", "display_name": "kasi", "link": "https://stackoverflow.com/users/206798/kasi"}, "is_accepted": false, "score": 0, "last_activity_date": 1441217038, "creation_date": 1441217038, "answer_id": 32360169, "question_id": 32353052, "link": "https://stackoverflow.com/questions/32353052/ruby-on-rails-foreign-key-migration-on-mariadb-10-0-20-server-does-not-apply/32360169#32360169", "title": "Ruby on Rails foreign key migration on MariaDB 10.0.20 Server does not apply", "body": "<p>I finally figured it out myself. </p>\n\n<p>After not finding any hint of TRANSACTIONAL=1 in the gem source, rails itself or even the MariaDB client library I experimented with the MariaDB.</p>\n\n<p>The statement does NOT contain the TRANSACTIONAL parameter.</p>\n\n<p>This seems to be a bug in MariaDB 10.0.21. If a table is created as MyISAM or ARIA engine or was at some point in the past converted to this engine type, a later conversion to INNODB and any subsequent ALTER TABLE statement produces the warning.</p>\n\n<p>This can be reproduced using the following SQL: </p>\n\n<pre><code>CREATE DATABASE testdb;\nCONNECT testdb;\nCREATE TABLE testtable (id INT(11)) ENGINE=INNODB;\nALTER TABLE testtable ENGINE=INNODB;\nALTER TABLE testtable ENGINE=INNODB;\nALTER TABLE testtable ENGINE=ARIA TRANSACTIONAL=1;\nALTER TABLE testtable ENGINE=INNODB;\nSHOW WARNINGS;\nALTER TABLE testtable ENGINE=INNODB;\nSHOW WARNINGS;\n</code></pre>\n\n<p>Result: </p>\n\n<pre><code>MariaDB [(none)]&gt; connect testdb;\nConnection id:    6698\nCurrent database: testdb\n\nMariaDB [testdb]&gt; create table testtable (id INT(11)) ENGINE=INNODB;\nQuery OK, 0 rows affected (0.30 sec)\n\nMariaDB [testdb]&gt; alter table testtable ENGINE=INNODB;\nQuery OK, 0 rows affected (0.35 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\nMariaDB [testdb]&gt; alter table testtable ENGINE=INNODB;\nQuery OK, 0 rows affected (0.36 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\nMariaDB [testdb]&gt; alter table testtable ENGINE=ARIA TRANSACTIONAL=1;\nQuery OK, 0 rows affected (0.49 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\nMariaDB [testdb]&gt; alter table testtable ENGINE=INNODB;\nQuery OK, 0 rows affected, 1 warning (0.54 sec)\nRecords: 0  Duplicates: 0  Warnings: 1\n\nMariaDB [testdb]&gt; show warnings;\n+---------+------+------------------------------------------------------------------------------------+\n| Level   | Code | Message                                                                            |\n+---------+------+------------------------------------------------------------------------------------+\n| Warning | 1478 | Table storage engine 'InnoDB' does not support the create option 'TRANSACTIONAL=1' |\n+---------+------+------------------------------------------------------------------------------------+\n1 row in set (0.00 sec)\n\nMariaDB [testdb]&gt; alter table testtable ENGINE=INNODB;\nQuery OK, 0 rows affected, 1 warning (0.39 sec)\nRecords: 0  Duplicates: 0  Warnings: 1\n\nMariaDB [testdb]&gt; show warnings;\n+---------+------+------------------------------------------------------------------------------------+\n| Level   | Code | Message                                                                            |\n+---------+------+------------------------------------------------------------------------------------+\n| Warning | 1478 | Table storage engine 'InnoDB' does not support the create option 'TRANSACTIONAL=1' |\n+---------+------+------------------------------------------------------------------------------------+\n1 row in set (0.00 sec)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 206798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559b27de124ce7dfa6a8173160d4c12b?s=128&d=identicon&r=PG", "display_name": "kasi", "link": "https://stackoverflow.com/users/206798/kasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441217038, "creation_date": 1441196597, "question_id": 32353052, "link": "https://stackoverflow.com/questions/32353052/ruby-on-rails-foreign-key-migration-on-mariadb-10-0-20-server-does-not-apply", "title": "Ruby on Rails foreign key migration on MariaDB 10.0.20 Server does not apply", "body": "<p>I am trying to apply a database migration on my Ruby on rails project that defines a reference and foreign key constraint.</p>\n\n<p>The migration itself works fine on a dev Sqlite3 DB and also on a MariaDB Server using the Aria storage engine. To support foreign key constraints we are using InnoDB (here: XtraDB) storage engine in the live MariaDB 10 server. </p>\n\n<p>When applying the migration on live, it fails with the error message stated below. </p>\n\n<pre><code>== 20150831210234 AddStyleToPiece: migrating ==================================\n-- add_reference(:nv_pieces, :style, {:index=&gt;true, :foreign_key=&gt;true})\nrake aborted!\nStandardError: An error has occurred, all later migrations canceled:\n\nMysql2::Error: Table storage engine 'InnoDB' does not support the create option 'TRANSACTIONAL=1': ALTER TABLE `nv_pieces` ADD `style_id` int(11)/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:305:in `query'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:305:in `block in execute'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/connection_adapters/abstract_adapter.rb:473:in `block in log'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activesupport-4.2.4/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/connection_adapters/abstract_adapter.rb:467:in `log'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:305:in `execute'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/connection_adapters/mysql2_adapter.rb:231:in `execute'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/connection_adapters/abstract/schema_statements.rb:393:in `add_column'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/connection_adapters/abstract/schema_statements.rb:663:in `add_reference'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/migration.rb:662:in `block in method_missing'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/migration.rb:631:in `block in say_with_time'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/migration.rb:631:in `say_with_time'\n/usr/local/rvm/gems/ruby-2.1.5/gems/activerecord-4.2.4/lib/active_record/migration.rb:651:in `method_missing'\n/srv/httpd/rails-app/db/migrate/20150831210234_add_style_to_piece.rb:3:in `change'\n</code></pre>\n\n<p>I am aware that the MariaDB server does not support TRANSACTIONAL for the XtraDB storage engine.</p>\n\n<p>This seems to be som consistency issue between the mysql2 gem, the libmariadbclient and the server but I couldn't find where the statement is generated. </p>\n"}, {"tags": ["ruby", "benchmarking"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1441194956, "post_id": 32352278, "comment_id": 52577877, "body": "Did you disable caching in your database and in the Rails stack while testing? How many records do you have in your database? Are there any big columns (e.g. descriptions blogs) on the article table?"}, {"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 1, "creation_date": 1441195226, "post_id": 32352278, "comment_id": 52578068, "body": "Check your benchmarks again: <a href=\"http://rubyinrails.com/2014/06/05/rails-pluck-vs-select-map-collect/\" rel=\"nofollow noreferrer\">rubyinrails.com/2014/06/05/rails-pluck-vs-select-map-collect</a>"}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1441196551, "post_id": 32352278, "comment_id": 52578971, "body": "You ca  actually do it three way: &quot;Article.all.collect{|a| a.id}&quot; would be the default Ruby way, and if you benchmark that then you&#39;ll find it&#39;s very slow in comparison. Your first example is a mid-way approach between a fully-Rubyish method and one that is optimised for speed."}], "answers": [{"comments": [{"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441196294, "post_id": 32352873, "comment_id": 52578799, "body": "Only problem with that argument is that pluck happens in the db, so removing it from the equation when doing the comparison is moot. Perhaps a better test would be to get an average as you eluded to in your point about running the query 100 times. Spot on in all other regards!"}, {"owner": {"reputation": 3281, "user_id": 486820, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d585b7d57d57eec701c760d84ab1a79d?s=128&d=identicon&r=PG", "display_name": "RocketR", "link": "https://stackoverflow.com/users/486820/rocketr"}, "edited": false, "score": 0, "creation_date": 1457134189, "post_id": 32352873, "comment_id": 59285172, "body": "@Simore Could you provide a test prooving <code>pluck</code> is more efficient, please? I&#39;m really curious, as in my own experiments it either fell into the margin of error, or was actually slower than <code>find_by!</code>. I used benchmark-ips, disabled query cache, SQL was identical. Quite surprising"}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": true, "score": 8, "last_activity_date": 1441196072, "creation_date": 1441196072, "answer_id": 32352873, "question_id": 32352278, "link": "https://stackoverflow.com/questions/32352278/activerecords-selectid-collect-vs-pluckid-methods-why-is-pure-ar-pluck/32352873#32352873", "title": "ActiveRecords select(:id).collect vs. pluck(:id) methods: Why is pure AR &quot;pluck&quot; slower?", "body": "<p>Your benchmark is inaccurate. First of all, as you can see, both executions on the database side triggers the same query</p>\n\n<pre><code>SELECT \"articles\".\"id\" FROM \"articles\"\n</code></pre>\n\n<p>Therefore, the database time should be considered irrelevant. Clearly the two queries had different execution time as shown by the console, but this is normal as if you run the same query 100 times the execution time can be different each time as it depends by a variety of variables such as the machine load, the database state, etc.</p>\n\n<p>Since the database execution time can be considered equivalent, it's irrelevant for the benchmark.</p>\n\n<p>Therefore, what you need to compare is the Ruby execution time and allocation. Pluck is supposed to be faster and more lightweight as compared to <code>collect</code> it doesn't allocate ActiveRecord objects, rather it returns only the selected values.</p>\n\n<p>If you really want to benchmark the methods, you should mock the database time (which is clearly variable but irrelevant for this benchmark) and only benchmark allocation and the two different Ruby methods.</p>\n\n<p>Long story short, <code>pluck</code> is generally more efficient.</p>\n"}, {"tags": [], "owner": {"reputation": 1656, "user_id": 6138119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YzV7y.jpg?s=128&g=1", "display_name": "Pravesh Khatri", "link": "https://stackoverflow.com/users/6138119/pravesh-khatri"}, "is_accepted": false, "score": 2, "last_activity_date": 1462902188, "last_edit_date": 1462902188, "creation_date": 1462900990, "answer_id": 37145120, "question_id": 32352278, "link": "https://stackoverflow.com/questions/32352278/activerecords-selectid-collect-vs-pluckid-methods-why-is-pure-ar-pluck/37145120#37145120", "title": "ActiveRecords select(:id).collect vs. pluck(:id) methods: Why is pure AR &quot;pluck&quot; slower?", "body": "<p><code>select</code> is used to fetch records with specific attributes. It returns an <code>ActiveRecord::Relation</code> object.</p>\n\n<p><code>pluck</code> can be used the same way <code>select</code> is used, however it returns an array of selected attributes.</p>\n\n<p>You can go through <a href=\"http://findnerd.com/list/view/Select-Vs-Pluck-in-Rails/19258/\" rel=\"nofollow\">this article</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 394, "user_id": 5114104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWk9k.jpg?s=128&g=1", "display_name": "coisnepe", "link": "https://stackoverflow.com/users/5114104/coisnepe"}, "is_accepted": false, "score": 2, "last_activity_date": 1593075062, "last_edit_date": 1593075062, "creation_date": 1593074742, "answer_id": 62571371, "question_id": 32352278, "link": "https://stackoverflow.com/questions/32352278/activerecords-selectid-collect-vs-pluckid-methods-why-is-pure-ar-pluck/62571371#62571371", "title": "ActiveRecords select(:id).collect vs. pluck(:id) methods: Why is pure AR &quot;pluck&quot; slower?", "body": "<p>You shouldn't pay attention to the times recorded in the console and do a proper <code>benchmark</code> instead. Here's how much faster <code>select</code> can be when used in a nested query (about 30 times faster!)</p>\n<pre class=\"lang-rb prettyprint-override\"><code>[25] pry(main)&gt; ActiveRecord::Base.logger = nil\n[25] pry(main)&gt; Benchmark.bmbm do |bm|\n[25] pry(main)*   bm.report('select') do\n[25] pry(main)*     2000.times do\n[25] pry(main)*       ActiveRecord::Base.uncached do\n[25] pry(main)*         Agenda.where(organization_id: Organization.limit(2).select(:id))\n[25] pry(main)*       end\n[25] pry(main)*     end\n[25] pry(main)*   end\n[25] pry(main)*   bm.report('pluck') do\n[25] pry(main)*     2000.times do\n[25] pry(main)*       ActiveRecord::Base.uncached do\n[25] pry(main)*         Agenda.where(organization_id: Organization.limit(2).pluck(:id))\n[25] pry(main)*       end\n[25] pry(main)*     end\n[25] pry(main)*   end\n[25] pry(main)* end\nRehearsal ------------------------------------------\nselect   0.147064   0.001408   0.148472 (  0.149976)\npluck    1.494075   0.077501   1.571576 (  4.175919)\n--------------------------------- total: 1.720048sec\n\n             user     system      total        real\nselect   0.140494   0.000301   0.140795 (  0.140956)\npluck    1.200006   0.070174   1.270180 (  3.958814)\n</code></pre>\n<p>As has been explained, this is because in the first case the query is merged into the main query as a nested select, while with <code>pluck</code> a first query is executed to get the ids, which are then used to run the main query.</p>\n<p>Bear in mind that this kinds of benchmarks always depend on your database, indexes, amount of rows you're dealing with, etc. When in doubt always run a quick benchmark to confirm this kind hypothesis!</p>\n<p>For the record, here's a similar benchmark for your kind of &quot;simple&quot; query, which indeed shows <code>pluck</code> is faster, albeit not by a huge margin:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>[27] pry(main)&gt; Benchmark.bmbm do |bm|\n[27] pry(main)*   bm.report('select') do\n[27] pry(main)*     2000.times do\n[27] pry(main)*       ActiveRecord::Base.uncached do\n[27] pry(main)*         Organization.select(:id).collect(&amp;:id)\n[27] pry(main)*       end\n[27] pry(main)*     end\n[27] pry(main)*   end\n[27] pry(main)*   bm.report('pluck') do\n[27] pry(main)*     2000.times do\n[27] pry(main)*       ActiveRecord::Base.uncached do\n[27] pry(main)*         Organization.pluck(:id)\n[27] pry(main)*       end\n[27] pry(main)*     end\n[27] pry(main)*   end\n[27] pry(main)* end\nRehearsal ------------------------------------------\nselect   1.669422   0.080951   1.750373 (  4.318759)\npluck    1.081312   0.064770   1.146082 (  3.797270)\n--------------------------------- total: 2.896455sec\n\n             user     system      total        real\nselect   1.601772   0.069176   1.670948 (  4.298829)\npluck    1.094950   0.064165   1.159115 (  3.811094)\n</code></pre>\n"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8146, "favorite_count": 2, "accepted_answer_id": 32352873, "answer_count": 3, "score": 7, "last_activity_date": 1593075062, "creation_date": 1441194319, "last_edit_date": 1441199379, "question_id": 32352278, "link": "https://stackoverflow.com/questions/32352278/activerecords-selectid-collect-vs-pluckid-methods-why-is-pure-ar-pluck", "title": "ActiveRecords select(:id).collect vs. pluck(:id) methods: Why is pure AR &quot;pluck&quot; slower?", "body": "<p>I am trying to get all the ids from my Article model. I can do it two ways:</p>\n\n<pre><code> Article.select(:id).collect{|a| a.id}\n  Article Load (2.6ms)  SELECT \"articles\".\"id\" FROM \"articles\" \n</code></pre>\n\n<p>OR</p>\n\n<pre><code>2.2.1 :006 &gt; Article.pluck(:id)\n   (4.3ms)  SELECT \"articles\".\"id\" FROM \"articles\"\n</code></pre>\n\n<p>What gives? Why is the AR slower than the Ruby version?</p>\n\n<p>Even when I benchmark the Ruby method, it seems faster:</p>\n\n<pre><code>Benchmark.measure{Article.select(:id).collect{|a| a.id}}\n  Article Load (1.9ms)  SELECT \"articles\".\"id\" FROM \"articles\"\n =&gt; #&lt;Benchmark::Tms:0x007feb12060658 @label=\"\", @real=0.026455502957105637, @cstime=0.0, @cutime=0.0, @stime=0.0, @utime=0.020000000000000018, @total=0.020000000000000018&gt;\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "tdd"], "comments": [{"owner": {"reputation": 690, "user_id": 5058260, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SQ22g.jpg?s=128&g=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5058260/harry"}, "reply_to_user": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441193313, "post_id": 32351636, "comment_id": 52576794, "body": "Yes working for me now also, it was a problem within the require directory"}], "answers": [{"tags": [], "owner": {"reputation": 690, "user_id": 5058260, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SQ22g.jpg?s=128&g=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5058260/harry"}, "is_accepted": false, "score": -1, "last_activity_date": 1441193362, "creation_date": 1441193362, "answer_id": 32351928, "question_id": 32351636, "link": "https://stackoverflow.com/questions/32351636/rspec-validation-of-method-definition-failure-error/32351928#32351928", "title": "Rspec validation of method definition - Failure/Error", "body": "<pre><code>require_relative '../DockingStation'\n</code></pre>\n"}], "owner": {"reputation": 690, "user_id": 5058260, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SQ22g.jpg?s=128&g=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/5058260/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441193362, "creation_date": 1441192483, "question_id": 32351636, "link": "https://stackoverflow.com/questions/32351636/rspec-validation-of-method-definition-failure-error", "title": "Rspec validation of method definition - Failure/Error", "body": "<p>In Rspec, testing whether an instance is able to call method x.</p>\n\n<p><strong>DockingStation.rb</strong></p>\n\n<pre><code>class DockingStation\n  def release_bike\n  end\nend\n</code></pre>\n\n<p><strong>Docking_spec.rb</strong></p>\n\n<pre><code>require_relative '../lib/DockingStation'\n\ndescribe DockingStation do\n  before(:each) do\n    @dockstat = DockingStation.new\n  end\n\ndescribe \"#DockingStation\" do\n  it \"Check release method\" do\n  expect(@dockstat).to respond_to(:release_bike)\n  end\nend\n\nend\n</code></pre>\n\n<p>Currently getting the following error message:</p>\n\n<pre><code>  1) DockingStation#DockingStation Check release method\n     Failure/Error: expect(@dockstat).to respond_to(:release_bike)\n       expected #&lt;DockingStation:0x007fa518a6da00&gt; to respond to :release_bike\n     # ./spec/Docking_spec.rb:10:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>What I'm expecting is for the object @dockstat instantiated in the Docking_spec.rb to respond to the release_bike method defined in DockingStation.rb, but this is not the case.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1441194084, "post_id": 32351558, "comment_id": 52577299, "body": "One issue is that it looks like you are saving to <code>&#47;tmp</code> and then trying to access <code>tmp</code> (without the /) which will be <code>&lt;path to your rails app&gt;&#47;tmp</code>"}, {"owner": {"reputation": 2704, "user_id": 3968048, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/efc99cf1bee109f5f2d797f32b492ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter R", "link": "https://stackoverflow.com/users/3968048/peter-r"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1441196588, "post_id": 32351558, "comment_id": 52579002, "body": "@MaxWilliams I thought that might be it initially, but it works for some users, and it works in testing. I think its an issue with tmp/ getting cleared out before users can access the file."}], "answers": [{"comments": [{"owner": {"reputation": 2704, "user_id": 3968048, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/efc99cf1bee109f5f2d797f32b492ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter R", "link": "https://stackoverflow.com/users/3968048/peter-r"}, "edited": false, "score": 0, "creation_date": 1441196832, "post_id": 32351976, "comment_id": 52579194, "body": "my controller limits which users can access the file. Would it be best to just create a /downloads directory and put the files in there? I also asked the question to get a better understanding of how tmp/ works. What is clearing out this folder? When does it get cleared? When I put something there, how long can I expect it to stay there?"}], "tags": [], "owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "is_accepted": true, "score": 3, "last_activity_date": 1441196938, "last_edit_date": 1492086159, "creation_date": 1441193489, "answer_id": 32351976, "question_id": 32351558, "link": "https://stackoverflow.com/questions/32351558/best-place-to-store-files-for-download/32351976#32351976", "title": "Best place to store files for download", "body": "<p>If the files are public why not to store them at <code>\"#{Rails.root}/public/csv-files/#{@file_name}.csv\"</code>. If <code>public</code> is not an option, then place them at some safe place. Not in <code>/tmp</code>, where they can be deleted by system.</p>\n\n<p><code>/tmp</code> dir is cleaned regularly by your system. Read this discussion for more info <a href=\"https://askubuntu.com/questions/20783/how-is-the-tmp-directory-cleaned-up\">https://askubuntu.com/questions/20783/how-is-the-tmp-directory-cleaned-up</a></p>\n"}], "owner": {"reputation": 2704, "user_id": 3968048, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/efc99cf1bee109f5f2d797f32b492ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter R", "link": "https://stackoverflow.com/users/3968048/peter-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "accepted_answer_id": 32351976, "answer_count": 1, "score": 1, "last_activity_date": 1441196938, "creation_date": 1441192282, "question_id": 32351558, "link": "https://stackoverflow.com/questions/32351558/best-place-to-store-files-for-download", "title": "Best place to store files for download", "body": "<p>I have a script that runs once a week and creates a CSV file. A download link is emailed out so users can download the file. I am currently storing the file in <code>/tmp/</code>. This works sometimes, but some users get an error and the logs show </p>\n\n<pre><code>ActionController::MissingFile occurred in csv_downloads#download:\nCannot read file tmp/filename.csv\n</code></pre>\n\n<p>What is a better way to store these files? Here is part of the current script</p>\n\n<pre><code>  csv_string = CSV.generate(write_headers: true, headers: HEADER) { |csv| write_data(csv) }\n  file = File.new(File.join(Dir.pwd, \"/tmp/#{@file_name}.csv\"), \"w+\")\n  file.write(csv_string)\n  file.close\n  file\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 1, "creation_date": 1441192353, "post_id": 32351456, "comment_id": 52576153, "body": "Your example is illustrating scope more than mutation (i.e. destruction). In the first method you&#39;re array argument is being assigned to <code>arr</code> then right away you&#39;re re-assigning a new array to <code>arr</code>. This is why it not not changing the original array."}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 3, "creation_date": 1441192654, "post_id": 32351456, "comment_id": 52576346, "body": "Read this article - <a href=\"http://robertheaton.com/2014/07/22/is-ruby-pass-by-reference-or-pass-by-value/\" rel=\"nofollow noreferrer\">robertheaton.com/2014/07/22/&hellip;</a>, and just earlier someone else had asked same question - <a href=\"http://stackoverflow.com/questions/32338232/variable-scope-and-modification\" title=\"variable scope and modification\">stackoverflow.com/questions/32338232/&hellip;</a>"}, {"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "edited": false, "score": 0, "creation_date": 1441216638, "post_id": 32351456, "comment_id": 52592884, "body": "<code>def demolish_everything; end</code>"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1441193980, "post_id": 32351622, "comment_id": 52577240, "body": "Pass / call by reference usually means the opposite, i.e. that you can assign to the variable being passed."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1441194511, "post_id": 32351622, "comment_id": 52577566, "body": "@Stefan Frankly, this part of terminology was always tricky to me. I treat it like one might change anything save for the reference itself. What would be the right term here?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1441194756, "post_id": 32351622, "comment_id": 52577735, "body": "Wikipedia mentions a third term: <a href=\"https://en.wikipedia.org/wiki/Evaluation_strategy#Call_by_sharing\" rel=\"nofollow noreferrer\">call-by-sharing</a>"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1441196731, "last_edit_date": 1441196731, "creation_date": 1441192443, "answer_id": 32351622, "question_id": 32351456, "link": "https://stackoverflow.com/questions/32351456/how-to-create-destructive-functions/32351622#32351622", "title": "How to create destructive functions", "body": "<p>All the parameters in Ruby are passed to methods using <a href=\"https://en.wikipedia.org/wiki/Evaluation_strategy#Call_by_sharing\" rel=\"nofollow\">call-by-sharing</a>. That said, you might change the content of a variable passed, but can not reassign it (the latter will just reassign a value, leaving the old value intact.)</p>\n\n<p>So, one should modify <em>content</em>, e.g.:</p>\n\n<pre><code>def not_really_destructive_fun(arr)\n    # that won\u2019t work\n    # arr = [1,1,1]\n    # that will\n    arr.replace [1,1,1]\n    # and that will\n    arr.clear # array is now empty\n    arr &lt;&lt; 1 &lt;&lt; 1 &lt;&lt; 1\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1441192447, "creation_date": 1441192447, "answer_id": 32351623, "question_id": 32351456, "link": "https://stackoverflow.com/questions/32351456/how-to-create-destructive-functions/32351623#32351623", "title": "How to create destructive functions", "body": "<p>You could use <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-replace\" rel=\"nofollow\"><code>replace</code></a> to replace the an array with another:</p>\n\n<pre><code>def really_destructive_fun(arr)\n  arr.replace([1,1,1])\n  puts \"arr changed to: #{arr}\"\nend\n\na = [1,2,3]\nreally_destructive_fun(a)\n#=&gt; arr changed to: [1, 1, 1]\n\na\n#=&gt; [1, 1, 1]\n</code></pre>\n"}], "owner": {"reputation": 981, "user_id": 2373609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Sij07.jpg?s=128&g=1", "display_name": "MatthewRock", "link": "https://stackoverflow.com/users/2373609/matthewrock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 32351622, "answer_count": 2, "score": 2, "last_activity_date": 1441196731, "creation_date": 1441191942, "last_edit_date": 1441192695, "question_id": 32351456, "link": "https://stackoverflow.com/questions/32351456/how-to-create-destructive-functions", "title": "How to create destructive functions", "body": "<p>I want to create a destructive function. Let's consider the following example:</p>\n\n<pre><code>def not_really_destructive_fun(arr)\n  arr = [1,1,1]\n  puts \"arr changed to: \" + arr.to_s\nend\ndef destructive_fun(arr)\n  p \"Destructive function run.\"\n  arr.map!{|x| x+= 1}\nend\n</code></pre>\n\n<p>Output of calling such methods is the following:</p>\n\n<pre><code>a = [1,2,3]\nnot_really_destructive_fun a # =&gt; arr changed to: [1, 1, 1]\na # =&gt; [1, 2, 3]\ndestructive_fun a            # =&gt; \"Destructive function run.\"\na # =&gt; [2, 3, 4]\n</code></pre>\n\n<p><code>map!</code> still changed the original value. However, <code>=</code> didn't. How can I write a destructive function?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "imagemagick"], "answers": [{"comments": [{"owner": {"reputation": 1106, "user_id": 2805144, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45e65bf377dfc11fed59d677f86a8288?s=128&d=identicon&r=PG&f=1", "display_name": "Virge Assault", "link": "https://stackoverflow.com/users/2805144/virge-assault"}, "edited": false, "score": 0, "creation_date": 1441192515, "post_id": 32351489, "comment_id": 52576256, "body": "I don&#39;t have a <code>has_attached_file</code> configuration.  I added my Car model above where I believe that would go, the picture config is <code>mount_uploader :picture, PictureUploader</code>.  Can I just add a <code>has_attached_file</code> line with the default image or can I do it through PictureUploader?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1106, "user_id": 2805144, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45e65bf377dfc11fed59d677f86a8288?s=128&d=identicon&r=PG&f=1", "display_name": "Virge Assault", "link": "https://stackoverflow.com/users/2805144/virge-assault"}, "edited": false, "score": 0, "creation_date": 1441193057, "post_id": 32351489, "comment_id": 52576625, "body": "@VirgeAssault : I updated my answer. Seems like you are using CarrierWave and not paperclip."}, {"owner": {"reputation": 1106, "user_id": 2805144, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45e65bf377dfc11fed59d677f86a8288?s=128&d=identicon&r=PG&f=1", "display_name": "Virge Assault", "link": "https://stackoverflow.com/users/2805144/virge-assault"}, "edited": false, "score": 0, "creation_date": 1441193943, "post_id": 32351489, "comment_id": 52577218, "body": "Yeah CarrierWave my fault.  I added the <code>default_url</code> method (edited question to include it) and ran <code>rake assets:precompile</code> but the image still isn&#39;t showing up by default.  Any ideas on further steps?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1106, "user_id": 2805144, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45e65bf377dfc11fed59d677f86a8288?s=128&d=identicon&r=PG&f=1", "display_name": "Virge Assault", "link": "https://stackoverflow.com/users/2805144/virge-assault"}, "edited": false, "score": 0, "creation_date": 1441194357, "post_id": 32351489, "comment_id": 52577472, "body": "@VirgeAssault : I updated my answer to fix your problem with the asset pipeline."}, {"owner": {"reputation": 1106, "user_id": 2805144, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45e65bf377dfc11fed59d677f86a8288?s=128&d=identicon&r=PG&f=1", "display_name": "Virge Assault", "link": "https://stackoverflow.com/users/2805144/virge-assault"}, "edited": false, "score": 0, "creation_date": 1441194959, "post_id": 32351489, "comment_id": 52577881, "body": "Replacing that line with what you suggested isn&#39;t working (added it above). There are no errors on the page or server output.  The server isn&#39;t showing the picture at all when the object is created because it&#39;s not a parameter when a picture isn&#39;t added by the user, so I&#39;m not sure how to troubleshoot this."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1106, "user_id": 2805144, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45e65bf377dfc11fed59d677f86a8288?s=128&d=identicon&r=PG&f=1", "display_name": "Virge Assault", "link": "https://stackoverflow.com/users/2805144/virge-assault"}, "edited": false, "score": 0, "creation_date": 1441198503, "post_id": 32351489, "comment_id": 52580502, "body": "What URL does the server render into the HTML? Under what URL is the default image available on the server?"}, {"owner": {"reputation": 1106, "user_id": 2805144, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45e65bf377dfc11fed59d677f86a8288?s=128&d=identicon&r=PG&f=1", "display_name": "Virge Assault", "link": "https://stackoverflow.com/users/2805144/virge-assault"}, "edited": false, "score": 0, "creation_date": 1441202990, "post_id": 32351489, "comment_id": 52583857, "body": "It&#39;s just rendering a blank <code>&lt;span class=&quot;pic&quot;&gt;</code>.  Could any of this (Maybe rake precompile) Have messed up my JS?  It&#39;s acting weird, adding two car objects instead of one, and dropdowns in the header aren&#39;t working.  Seems like changes aren&#39;t doing anything."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1106, "user_id": 2805144, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45e65bf377dfc11fed59d677f86a8288?s=128&d=identicon&r=PG&f=1", "display_name": "Virge Assault", "link": "https://stackoverflow.com/users/2805144/virge-assault"}, "edited": false, "score": 0, "creation_date": 1441204231, "post_id": 32351489, "comment_id": 52584733, "body": "When it does not even render an image tag, then it does not sound like a problem with CarrierWave to me. Hard to tell without knowing the html partials and the JavaScript involved."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1441194323, "last_edit_date": 1441194323, "creation_date": 1441192054, "answer_id": 32351489, "question_id": 32351291, "link": "https://stackoverflow.com/questions/32351291/can-i-set-a-default-picture-for-an-objects-picture-field-through-a-rails-migrat/32351489#32351489", "title": "Can I set a default picture for an object&#39;s picture field through a Rails migration?", "body": "<p>I would avoid storing the fallback image path in the database, because that makes it much harder to change the default later on.</p>\n\n<p><strong>Paperclip</strong> allows default (fallback) images. Just add something like <code>default_url: \"/images/default.jpg\"</code> to your <code>has_attached_file</code> configuration. </p>\n\n<p>See: <a href=\"https://github.com/thoughtbot/paperclip#models\" rel=\"nofollow\">https://github.com/thoughtbot/paperclip#models</a></p>\n\n<p>If you use <strong>CarrierWave</strong> just add a <code>default_url</code> method to your Uploader:</p>\n\n<pre><code>class PictureUploader &lt; CarrierWave::Uploader::Base\n  def default_url(*args)\n    \"/images/default.jpg\"\n  end\nend\n</code></pre>\n\n<p>See: <a href=\"https://github.com/carrierwaveuploader/carrierwave#providing-a-default-url\" rel=\"nofollow\">https://github.com/carrierwaveuploader/carrierwave#providing-a-default-url</a></p>\n\n<p>If you use the <strong>AssetPipeline</strong> you will need to use the <code>asset_path</code> helper to build the fallback URL. Change this line <code>\"/images/default.jpg\"</code> to:</p>\n\n<pre><code>    ActionController::Base.helpers.asset_path(\"/images/default.jpg\")\n</code></pre>\n"}], "owner": {"reputation": 1106, "user_id": 2805144, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45e65bf377dfc11fed59d677f86a8288?s=128&d=identicon&r=PG&f=1", "display_name": "Virge Assault", "link": "https://stackoverflow.com/users/2805144/virge-assault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441194979, "creation_date": 1441191429, "last_edit_date": 1441194979, "question_id": 32351291, "link": "https://stackoverflow.com/questions/32351291/can-i-set-a-default-picture-for-an-objects-picture-field-through-a-rails-migrat", "title": "Can I set a default picture for an object&#39;s picture field through a Rails migration?", "body": "<p>I have a <code>car</code> object that currently has no default picture, and is causing issues when there isn't a user-uploaded picture.  I'd like to make a default picture, and was wondering if this would work:</p>\n\n<pre><code>class AddPictureToCars &lt; ActiveRecord::Migration\n  def change\n    add_column :cars, :picture, :string, default: assets/images/default.jpg\n  end\nend\n</code></pre>\n\n<p>The default part is what I would be adding, not sure if that path is correct within the migration either.</p>\n\n<p>OR if I need to go into ImageMagick and <strong>EDIT</strong> Carrierwave's (previously said Paperclip's) settings for this to be more robust.  What should I do?</p>\n\n<p>EDIT \n<strong>Car.rb</strong></p>\n\n<pre><code>class Car &lt; ActiveRecord::Base\n  belongs_to :user\n  mount_uploader :picture, PictureUploader\n  validates :user_id, presence: true\n  validates :year, presence:true, length: { maximum: 4 }\n  validates :brand, presence:true\n  validates :model, presence:true\n  validates :vin, presence:true, length: { maximum: 17 }\n  validates :mileage, presence:true\n  validate  :picture_size\n\n  private\n\n    def picture_size\n      if picture.size &gt; 5.megabytes\n        errors.add(:picture, \"should be less than 5MB\")\n      end\n    end\nend\n</code></pre>\n\n<p>EDIT <strong>picture_uploader.rb</strong> with default_url suggestion</p>\n\n<pre><code>class PictureUploader &lt; CarrierWave::Uploader::Base\n  include CarrierWave::MiniMagick\n  process resize_to_limit: [380, 240]\n\n  if Rails.env.production?\n    storage :fog\n  else\n    storage :file\n  end\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\n\n  def default_url(*args)\n    ActionController::Base.helpers.asset_path(\"/images/default.jpg\")\n  end\nend\n</code></pre>\n\n<p>Default picture located at assets/images/default.jpeg</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "devise"], "comments": [{"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441192496, "post_id": 32351158, "comment_id": 52576246, "body": "What makes you think <code>render</code> is defined in your class?"}, {"owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "reply_to_user": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441192662, "post_id": 32351158, "comment_id": 52576349, "body": "@Nathan I didn&#39;t get you."}, {"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441193257, "post_id": 32351158, "comment_id": 52576763, "body": "Where is <code>render</code> defined?"}, {"owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "reply_to_user": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441194643, "post_id": 32351158, "comment_id": 52577650, "body": "render is not defined. I just used like what we do in controller."}], "answers": [{"comments": [{"owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "edited": false, "score": 0, "creation_date": 1441195221, "post_id": 32352497, "comment_id": 52578064, "body": "now i am getting undefined local variable or method `response_body"}, {"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "reply_to_user": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "edited": false, "score": 0, "creation_date": 1441195365, "post_id": 32352497, "comment_id": 52578176, "body": "Like I said, I would not recommend it. It&#39;s part of a larger stack of mixed in modules in Rails and you&#39;re not going to get it to work the way you want unless you understand those modules very well. My answer is mostly that you can&#39;t do what you&#39;re trying to do. You should post a new question describing the problem you&#39;re trying to solve... as the current implementation approach you&#39;re using is not reasonable."}], "tags": [], "owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1441194977, "creation_date": 1441194977, "answer_id": 32352497, "question_id": 32351158, "link": "https://stackoverflow.com/questions/32351158/how-to-render-a-file-from-devise-module/32352497#32352497", "title": "How to render a file from Devise module?", "body": "<p>You can't just call <code>render</code> arbitrarily like that. The <code>render</code> method is defined in <code>ActionController::Rendering</code> which gets mixed into the controller and view stack in Rails.</p>\n\n<p><a href=\"http://apidock.com/rails/ActionController/Rendering/render\" rel=\"nofollow\">http://apidock.com/rails/ActionController/Rendering/render</a></p>\n\n<p>You can try to include that module into your class, but I wouldn't recommend it as it sounds like you're not completely sure what you're doing.</p>\n\n<pre><code>class IdmAuthenticatable &lt; Authenticatable\n  include ActionController::Rendering\nend\n</code></pre>\n"}], "owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441194977, "creation_date": 1441191057, "question_id": 32351158, "link": "https://stackoverflow.com/questions/32351158/how-to-render-a-file-from-devise-module", "title": "How to render a file from Devise module?", "body": "<p>I am using devise gem in my rails application for authentication. In idm_authenticatable.rb I have a method as follows..</p>\n\n<pre><code> module Devise\n  module Strategies\n   class IdmAuthenticatable &lt; Authenticatable\n     def create_employee\n       if !employee.save\n         render 'devise/sessions/new'\n       end\n     end\n   end\n  end\n end\n</code></pre>\n\n<p>But the above method is throwing </p>\n\n<pre><code> undefined method `render' for #&lt;Devise::Strategies::IdmAuthenticatable:0x00000001771068&gt;\n</code></pre>\n\n<p>I think we can't render from inside a Module. Is there any alternate way to render error page inside devise module?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 420, "user_id": 1731237, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7ad0b72e2b54b432ae6f4e72c02fc33f?s=128&d=identicon&r=PG", "display_name": "Supersonic", "link": "https://stackoverflow.com/users/1731237/supersonic"}, "edited": false, "score": 0, "creation_date": 1441193052, "post_id": 32351490, "comment_id": 52576618, "body": "Thanks for the help. The logic looks rite and I can understand where I went wrong. But I am not able to get this script to work. When I execute the last line the logic is still not working."}, {"owner": {"reputation": 420, "user_id": 1731237, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7ad0b72e2b54b432ae6f4e72c02fc33f?s=128&d=identicon&r=PG", "display_name": "Supersonic", "link": "https://stackoverflow.com/users/1731237/supersonic"}, "edited": false, "score": 0, "creation_date": 1441193125, "post_id": 32351490, "comment_id": 52576679, "body": "This basically creates a vb scipt for creating a shortcut icon in the favorites folder. If I paste this in a bat file it works. But not when I run it like how you given it above. Can you please help me out ?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 420, "user_id": 1731237, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7ad0b72e2b54b432ae6f4e72c02fc33f?s=128&d=identicon&r=PG", "display_name": "Supersonic", "link": "https://stackoverflow.com/users/1731237/supersonic"}, "edited": false, "score": 1, "creation_date": 1441193141, "post_id": 32351490, "comment_id": 52576684, "body": "Sorry, I do not know anything about Windows OS."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1441192535, "last_edit_date": 1441192535, "creation_date": 1441192062, "answer_id": 32351490, "question_id": 32351050, "link": "https://stackoverflow.com/questions/32351050/execute-few-command-line-bash-commands-in-ruby/32351490#32351490", "title": "Execute few command line bash commands in ruby", "body": "<p>You are trying to execute each single line of your script, what is wrong. Just prepare your script and then execute it all in once.</p>\n\n<pre><code>cmd = &lt;&lt;EOC\n@echo off\nSETLOCAL ENABLEDELAYEDEXPANSION\nSET LinkName=Projects\nSET Esc_LinkDest=%userprofile%\\Links\\!LinkName!.lnk\nSET Esc_LinkTarget=C:\\Projects\nSET cSctVBS=CreateShortcut.vbs\nSET LOG=\".\\%~N0_runtime.log\"\n((\necho Set oWS = WScript.CreateObject^(\"WScript.Shell\"^)\necho sLinkFile = oWS.ExpandEnvironmentStrings^(\"!Esc_LinkDest!\"^)\necho Set oLink = oWS.CreateShortcut^(sLinkFile^) \necho oLink.TargetPath = oWS.ExpandEnvironmentStrings^(\"!Esc_LinkTarget!\"^)\necho oLink.Save\n)1&gt;!cSctVBS!\ncscript //nologo .\\!cSctVBS!\nDEL !cSctVBS! /f /q\n)1&gt;&gt;!LOG! 2&gt;&gt;&amp;1\nEOC\n\n# OK, time to rock\u2019n\u2019roll!\n`#{cmd}`\n</code></pre>\n"}], "owner": {"reputation": 420, "user_id": 1731237, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7ad0b72e2b54b432ae6f4e72c02fc33f?s=128&d=identicon&r=PG", "display_name": "Supersonic", "link": "https://stackoverflow.com/users/1731237/supersonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 32351490, "answer_count": 1, "score": 0, "last_activity_date": 1441192535, "creation_date": 1441190694, "question_id": 32351050, "link": "https://stackoverflow.com/questions/32351050/execute-few-command-line-bash-commands-in-ruby", "title": "Execute few command line bash commands in ruby", "body": "<p>Have a small bash script which I would like to put it into a method in ruby the script content is as follows. </p>\n\n<pre><code>def test_method\n  `@echo off`\n  `SETLOCAL ENABLEDELAYEDEXPANSION`\n  `SET LinkName=Projects`\n  `SET Esc_LinkDest=%userprofile%\\Links\\!LinkName!.lnk`\n  `SET Esc_LinkTarget=C:\\Projects`\n  `SET cSctVBS=CreateShortcut.vbs`\n  `SET LOG=\".\\%~N0_runtime.log\"`\n  `((`\n    `echo Set oWS = WScript.CreateObject^(\"WScript.Shell\"^)`\n    `echo sLinkFile = oWS.ExpandEnvironmentStrings^(\"!Esc_LinkDest!\"^)`\n    `echo Set oLink = oWS.CreateShortcut^(sLinkFile^)` \n    `echo oLink.TargetPath = oWS.ExpandEnvironmentStrings^(\"!Esc_LinkTarget!\"^)`\n    `echo oLink.Save`\n    `)1&gt;!cSctVBS!`\n  `cscript //nologo .\\!cSctVBS!`\n  `DEL !cSctVBS! /f /q`\n  `)1&gt;&gt;!LOG! 2&gt;&gt;&amp;1`\nend\n</code></pre>\n\n<p>It executes till <code>((</code> i.e line number 8 and gives me the error <code>No such file or directory - ((</code> \nThat part in the bash script is something which I am writing some content to a file. </p>\n\n<p>Just want to execute that method and make it work like if I had written the same content in a bat file it works absolutely fine. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 0, "creation_date": 1441190606, "post_id": 32351009, "comment_id": 52575034, "body": "please include a code sample"}], "answers": [{"comments": [{"owner": {"reputation": 1647, "user_id": 673919, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/125ccdf95e7ce5b7671142731507fad0?s=128&d=identicon&r=PG", "display_name": "VoodooChild92", "link": "https://stackoverflow.com/users/673919/voodoochild92"}, "edited": false, "score": 0, "creation_date": 1441191442, "post_id": 32351211, "comment_id": 52575565, "body": "Thought of this. But, here we&#39;ll be re-arranging the scopes which will bring wrong results for sure."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1647, "user_id": 673919, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/125ccdf95e7ce5b7671142731507fad0?s=128&d=identicon&r=PG", "display_name": "VoodooChild92", "link": "https://stackoverflow.com/users/673919/voodoochild92"}, "edited": false, "score": 0, "creation_date": 1441191698, "post_id": 32351211, "comment_id": 52575726, "body": "You could create a scope like <code>max_on, -&gt;(column) { where(column =&gt; maximum(column)) }</code>. Can you explain under which circumstances the order of scopes might affect the result?"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1441191198, "creation_date": 1441191198, "answer_id": 32351211, "question_id": 32351009, "link": "https://stackoverflow.com/questions/32351009/how-can-i-find-all-the-records-with-max-attribute-across-records-in-rails/32351211#32351211", "title": "How can I find ALL the records with max attribute across records in rails?", "body": "<p>I would solve this with a subquery in the database:</p>\n\n<pre><code>Team.where(rank: Team.maximum(:rank)).\n     of_city(seller_lead.city).\n     with_access_to(seller_lead.state)\n</code></pre>\n"}], "owner": {"reputation": 1647, "user_id": 673919, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/125ccdf95e7ce5b7671142731507fad0?s=128&d=identicon&r=PG", "display_name": "VoodooChild92", "link": "https://stackoverflow.com/users/673919/voodoochild92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1441191215, "creation_date": 1441190526, "last_edit_date": 1441191215, "question_id": 32351009, "link": "https://stackoverflow.com/questions/32351009/how-can-i-find-all-the-records-with-max-attribute-across-records-in-rails", "title": "How can I find ALL the records with max attribute across records in rails?", "body": "<p>I have several records with several attributes (A, B, C, D).</p>\n\n<p>I want to be able to find which record has the higher value for a given attribute, such as D.</p>\n\n<pre><code>Team.of_city(seller_lead.city).with_access_to(seller_lead.state).max_by{ |team| team.rank }\n</code></pre>\n\n<p>For example, The above code gives me only one city but there are multiple cities with the same maximum rank. How do I get them all?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "for-loop"], "comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 4, "creation_date": 1441190021, "post_id": 32350737, "comment_id": 52574696, "body": "Maybe it&#39;s come through as a string.  try <code>@gcount = params[:group_count].to_i</code>"}], "answers": [{"tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": true, "score": 1, "last_activity_date": 1441190468, "creation_date": 1441190468, "answer_id": 32350982, "question_id": 32350737, "link": "https://stackoverflow.com/questions/32350737/use-param-value-as-loop-range-ruby-on-rails/32350982#32350982", "title": "Use param value as loop range ruby on rails", "body": "<p>When you fetch a parameter from the request, the value is generally a String. Therefore, in the following line <code>@gcount</code> is a String, not an integer.</p>\n\n<pre><code>@gcount = params[:group_count]\n</code></pre>\n\n<p>You need to cast it. Moreover, in Ruby you never use the for loop, rather you use blocks.</p>\n\n<pre><code>require 'fileutils'\n\ndef creategroups\n  gcount = params[:group_count].to_i\n  gcount.times do |index|\n    Fileutils::mkdir_p \"/groups/group_#{index}\"\n  end\n  render json: params\nend\n</code></pre>\n\n<p>or to keep it shorter</p>\n\n<pre><code>require 'fileutils'\n\ndef creategroups\n  params[:group_count].to_i.times do |index|\n    Fileutils::mkdir_p \"/groups/group_#{index}\"\n  end\n  render json: params\nend\n</code></pre>\n\n<p>Of course, you may want to validate <code>:group_count</code> to avoid someone passes a gigantic number that will kill your system.</p>\n"}], "owner": {"reputation": 2453, "user_id": 2647198, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/fhjZv.jpg?s=128&g=1", "display_name": "Vikram", "link": "https://stackoverflow.com/users/2647198/vikram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 32350982, "answer_count": 1, "score": 0, "last_activity_date": 1441194408, "creation_date": 1441189786, "last_edit_date": 1441194408, "question_id": 32350737, "link": "https://stackoverflow.com/questions/32350737/use-param-value-as-loop-range-ruby-on-rails", "title": "Use param value as loop range ruby on rails", "body": "<p>Controller return error \"bad value for range\" when passing param as loop range limit, following is my code</p>\n\n<pre><code>def creategroups\n  require 'fileutils'\n  @gcount = params[:group_count]\n  for i in (1..@gcount) do\n    Fileutils::mkdir_p \"/groups/group_#{i}\"\n  end\n  render json: params\nend\n</code></pre>\n\n<p>here group_count is the number of groups to be created.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "angularjs", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441188805, "post_id": 32350109, "comment_id": 52573983, "body": "You really don&#39;t want to work with rails helpers and routes once you are in angular. You use rails routes to call the controller and serve up the template that loads up angular... from there, you use angular. That means you&#39;ll need to understand how to have angular call rails controllers for data, and on the rails side you&#39;ll need to respond with json rather than setting instance variables as you normally would."}, {"owner": {"reputation": 25, "user_id": 2565681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1811adaa25a54f17419f0d7a17f4dbc?s=128&d=identicon&r=PG", "display_name": "Javi", "link": "https://stackoverflow.com/users/2565681/javi"}, "reply_to_user": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441189554, "post_id": 32350109, "comment_id": 52574421, "body": "@Nathan what about things like I18n translations, Devise login/signup pages and image assets? These are usually handled by Rails. Plus, can&#39;t I just do a quick Rails scaffolding for testing a new feature, for instance? Every view must be served by Angular now?"}, {"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441190475, "post_id": 32350109, "comment_id": 52574944, "body": "Angular has its own I18n translation capability: <a href=\"https://docs.angularjs.org/guide/i18n\" rel=\"nofollow noreferrer\">docs.angularjs.org/guide/i18n</a> , as for assets.. those are just urls that you can reference in your angular templates. If you&#39;re looking to build a 100% single page app using angular, then you will need to interact with devise as an api, so you will need to build your own view templates in angular. However some people have a hybrid app where they login using rails templates and then route to the angular app. I don&#39;t recommend this."}, {"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441190560, "post_id": 32350109, "comment_id": 52574996, "body": "Here is a free course I&#39;ve found very helpful when getting started with this stuff: <a href=\"http://code.tutsplus.com/courses/hands-on-angular\" rel=\"nofollow noreferrer\">code.tutsplus.com/courses/hands-on-angular</a>"}], "owner": {"reputation": 25, "user_id": 2565681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1811adaa25a54f17419f0d7a17f4dbc?s=128&d=identicon&r=PG", "display_name": "Javi", "link": "https://stackoverflow.com/users/2565681/javi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441187899, "creation_date": 1441187899, "question_id": 32350109, "link": "https://stackoverflow.com/questions/32350109/serve-both-rails-generated-views-and-angular-templates-from-the-same-railsangul", "title": "Serve both Rails-generated views and Angular templates from the same Rails+Angular project", "body": "<p>I have a Rails app with an AngularJS front end. For the main app, Angular handles the routing and serves the templates, but I'd like to serve Rails-generated views as well on the same project.</p>\n\n<p>Why? I haven't found out an easy way to use Rails helpers and assets in Angular templates.\nIf I try to load Rails views with Rails routing, Angular immediately takes control and displays a blank page.</p>\n\n<p>I'm pretty new to this technology stack (and web programming in general), so sorry if this is a very basic question, I didn't find any information on the internet about this.</p>\n\n<p>This is my folder structure:</p>\n\n<pre><code>app\n--assets\n----javascripts // here lives the Angular app\n------controllers // Angular controllers\n------templates // Angular templates\n   ...\n--controllers // Rails controllers\n--views // Rails views\n   ...\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "mail-gem"], "comments": [{"owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "edited": false, "score": 0, "creation_date": 1441188473, "post_id": 32349652, "comment_id": 52573762, "body": "Is it <code>ActionMailer</code> or are you using <code>mail</code> gem standalone?"}, {"owner": {"reputation": 469, "user_id": 494674, "user_type": "registered", "accept_rate": 7, "profile_image": "https://graph.facebook.com/1440313044/picture?type=large", "display_name": "Shaliko Usubov", "link": "https://stackoverflow.com/users/494674/shaliko-usubov"}, "reply_to_user": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "edited": false, "score": 0, "creation_date": 1441203990, "post_id": 32349652, "comment_id": 52584553, "body": "ActionMailer, but prepare email address via mail GEM &quot;m = Mail::Address.new(email); m.display_name = full_name.dup; m.format&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "is_accepted": false, "score": 0, "last_activity_date": 1441188400, "last_edit_date": 1441188400, "creation_date": 1441187845, "answer_id": 32350083, "question_id": 32349652, "link": "https://stackoverflow.com/questions/32349652/netsmtpsyntaxerror-501-invalid-rcpt-to-address-provided/32350083#32350083", "title": "Net::SMTPSyntaxError: 501 Invalid RCPT TO address provided", "body": "<p>According to <code>ActionMailer</code> documentation multibyte encoding should be done automatically: <a href=\"http://guides.rubyonrails.org/action_mailer_basics.html#auto-encoding-header-values\" rel=\"nofollow\">http://guides.rubyonrails.org/action_mailer_basics.html#auto-encoding-header-values</a></p>\n\n<p>There might be several things to try:</p>\n\n<ol>\n<li>Try adding <code># encoding: utf-8</code> to the first line of your controller;</li>\n<li>Try using <code>mail.transport_encoding = '8bit'</code> <a href=\"http://www.rubydoc.info/github/mikel/mail/Mail%2FMessage%3Atransport_encoding\" rel=\"nofollow\">http://www.rubydoc.info/github/mikel/mail/Mail%2FMessage%3Atransport_encoding</a></li>\n</ol>\n"}], "owner": {"reputation": 469, "user_id": 494674, "user_type": "registered", "accept_rate": 7, "profile_image": "https://graph.facebook.com/1440313044/picture?type=large", "display_name": "Shaliko Usubov", "link": "https://stackoverflow.com/users/494674/shaliko-usubov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7112, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1615640575, "creation_date": 1441186646, "question_id": 32349652, "link": "https://stackoverflow.com/questions/32349652/netsmtpsyntaxerror-501-invalid-rcpt-to-address-provided", "title": "Net::SMTPSyntaxError: 501 Invalid RCPT TO address provided", "body": "<p>As I understood I have issue because use not ASCII symbols in emails address</p>\n\n<p>Example:</p>\n\n<p>Notifier.rb</p>\n\n<pre><code>mail(to: \"Tam\u00f3n \u00c4RU\u00c4 &lt;example@example.com&gt;\", subject: \"Email subject\")\n</code></pre>\n\n<p>Any advice how I can handle this case? I prefer keep user name in address.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "mongoid"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1441188330, "post_id": 32349591, "comment_id": 52573668, "body": "we need the full backtrace."}, {"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441188742, "post_id": 32349591, "comment_id": 52573940, "body": "I tried to upgrade mongoid in an existing app of mine from 4.0.2 to 5.0.0.beta and could not reproduce the same problem. Rails version = 4.2.1 What is your Rails version?"}, {"owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "edited": false, "score": 0, "creation_date": 1441188767, "post_id": 32349591, "comment_id": 52573959, "body": "also, please include <code>Gemfile</code>"}, {"owner": {"reputation": 921, "user_id": 3998467, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/K1FeG.jpg?s=128&g=1", "display_name": "arthur-net", "link": "https://stackoverflow.com/users/3998467/arthur-net"}, "edited": false, "score": 0, "creation_date": 1441189378, "post_id": 32349591, "comment_id": 52574327, "body": "Rails version - Rails 4.2.0.beta4"}, {"owner": {"reputation": 921, "user_id": 3998467, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/K1FeG.jpg?s=128&g=1", "display_name": "arthur-net", "link": "https://stackoverflow.com/users/3998467/arthur-net"}, "edited": false, "score": 0, "creation_date": 1441189853, "post_id": 32349591, "comment_id": 52574593, "body": "When you upgraded your app to 5.0.0 did you change anything in your mongoid.yml file ?"}, {"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441191160, "post_id": 32349591, "comment_id": 52575373, "body": "It complained about not having a <code>clients</code> entry in mongoid.yml, which basically made me replace <code>sessions</code> with <code>clients</code> and the server booted nicely."}, {"owner": {"reputation": 921, "user_id": 3998467, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/K1FeG.jpg?s=128&g=1", "display_name": "arthur-net", "link": "https://stackoverflow.com/users/3998467/arthur-net"}, "edited": false, "score": 0, "creation_date": 1441191233, "post_id": 32349591, "comment_id": 52575425, "body": "I just changed sessions to clients and now it is complaining <code>Mongoid::Errors::NoClientConfig:  Problem:   No configuration could be found for a client named &#39;default&#39;. Summary:   When attempting to create the new client, Mongoid could not find a client configuration for the name: &#39;default&#39;. This is necessary in order to know the host, port, and options needed to connect. Resolution:   Double check your mongoid.yml to make sure under the clients key that a configuration exists for &#39;default&#39;. </code>"}, {"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441191405, "post_id": 32349591, "comment_id": 52575541, "body": "development:   # Configure available database sessions. (required)   clients:     # Defines the default session. (required)     default:       # Defines the name of the default database that Mongoid can connect to.       # (required).       database: myapp_development       # Provides the hosts the default session can connect to. Must be an array       # of host:port pairs. (required)       hosts:         - localhost:27017       options:"}, {"owner": {"reputation": 921, "user_id": 3998467, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/K1FeG.jpg?s=128&g=1", "display_name": "arthur-net", "link": "https://stackoverflow.com/users/3998467/arthur-net"}, "edited": false, "score": 0, "creation_date": 1441192328, "post_id": 32349591, "comment_id": 52576130, "body": "it is same as my config"}, {"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441207106, "post_id": 32349591, "comment_id": 52586983, "body": "Have you tried having mongoid regenerate its config file?"}], "answers": [{"tags": [], "owner": {"reputation": 921, "user_id": 3998467, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/K1FeG.jpg?s=128&g=1", "display_name": "arthur-net", "link": "https://stackoverflow.com/users/3998467/arthur-net"}, "is_accepted": false, "score": 0, "last_activity_date": 1441268432, "creation_date": 1441268432, "answer_id": 32370480, "question_id": 32349591, "link": "https://stackoverflow.com/questions/32349591/ruby-on-rails-upgrade-mongoid-to-version-5-0-0/32370480#32370480", "title": "Ruby on Rails upgrade Mongoid to version 5.0.0", "body": "<p>Here how I fixed this issue</p>\n\n<ol>\n<li><p>Removed from Gemfile <code>gem \"less-rails\"</code></p></li>\n<li><p>From application.rb removed <code>require \"mongo\"</code></p></li>\n<li><p>In mongoid.yml changed <code>sessions:</code> to <code>clients:</code></p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 4373, "user_id": 1007325, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ba57e1be1c442cef7e9f81d09d95e1e6?s=128&d=identicon&r=PG", "display_name": "Sagar Ranglani", "link": "https://stackoverflow.com/users/1007325/sagar-ranglani"}, "is_accepted": false, "score": 1, "last_activity_date": 1443888528, "creation_date": 1443888528, "answer_id": 32924652, "question_id": 32349591, "link": "https://stackoverflow.com/questions/32349591/ruby-on-rails-upgrade-mongoid-to-version-5-0-0/32924652#32924652", "title": "Ruby on Rails upgrade Mongoid to version 5.0.0", "body": "<p>Most important thing to look for while upgrading to Mongoid 5 is <code>mongoid.yml</code></p>\n\n<p>From:</p>\n\n<pre><code>&lt;%= rails_env %&gt;:\n  sessions:\n    default:\n      database: &lt;%= mongodb_database %&gt;\n      hosts:\n        - &lt;%= mongodb_staging_host %&gt;\n        username: &lt;%= mongodb_user %&gt;\n        password: &lt;%= mongodb_password %&gt;\n      options:\n        read: :primary_preferred\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>&lt;%= rails_env %&gt;:\n  clients:\n    default:\n      database: &lt;%= mongodb_database %&gt;\n      hosts:\n        - &lt;%= mongodb_staging_host %&gt;\n      options:\n        user: &lt;%= mongodb_user %&gt;\n        password: &lt;%= mongodb_password %&gt;\n        read:\n          mode: :primary_preferred\n</code></pre>\n\n<ol>\n<li>Change <code>sessions</code> to <code>clients</code> </li>\n<li>Move <code>username</code> (will become <code>user</code>) and <code>password</code> into <code>options</code></li>\n<li>change <code>read</code> mode as shown, if you have any.</li>\n</ol>\n\n<p>Bottomline is to check mongoid.yml thoroughly while comparing with <a href=\"http://docs.mongodb.org/ecosystem/tutorial/ruby-mongoid-tutorial/#configuration\" rel=\"nofollow\">this page</a></p>\n"}, {"comments": [{"owner": {"reputation": 521, "user_id": 633630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mZ9V9.jpg?s=128&g=1", "display_name": "Jonathan Liono", "link": "https://stackoverflow.com/users/633630/jonathan-liono"}, "edited": false, "score": 0, "creation_date": 1451030282, "post_id": 34385833, "comment_id": 56664118, "body": "Hopefully this is resolved really soon, the git source provided by suzan2go  works for me."}], "tags": [], "owner": {"reputation": 3422, "user_id": 1226906, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/LlI32.jpg?s=128&g=1", "display_name": "Pamela Cook - LightBe Corp", "link": "https://stackoverflow.com/users/1226906/pamela-cook-lightbe-corp"}, "is_accepted": false, "score": 2, "last_activity_date": 1450645418, "creation_date": 1450645418, "answer_id": 34385833, "question_id": 32349591, "link": "https://stackoverflow.com/questions/32349591/ruby-on-rails-upgrade-mongoid-to-version-5-0-0/34385833#34385833", "title": "Ruby on Rails upgrade Mongoid to version 5.0.0", "body": "<p>It looks like the error has appeared again in less-rails. The error is not related to Mongoid at all. I started getting the error a couple of days ago on my development server. I decided to check Github to see if an issue was reported about this. I found the following issue addressing the error.</p>\n\n<p><a href=\"https://github.com/metaskills/less-rails/pull/112\" rel=\"nofollow\">https://github.com/metaskills/less-rails/pull/112</a></p>\n\n<p>I changed my Gemfile to the following as provided on the link which corrected the error.</p>\n\n<pre><code>gem \"less-rails\", :git =&gt; 'https://github.com/suzan2go/less-rails.git', :branch =&gt; 'fix-nomethoderror-for-sprockets3'\n</code></pre>\n\n<p>As of now this solution has not been applied to the gem. I guess it will be soon.</p>\n"}], "owner": {"reputation": 921, "user_id": 3998467, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/K1FeG.jpg?s=128&g=1", "display_name": "arthur-net", "link": "https://stackoverflow.com/users/3998467/arthur-net"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1736, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1450645418, "creation_date": 1441186457, "last_edit_date": 1441268170, "question_id": 32349591, "link": "https://stackoverflow.com/questions/32349591/ruby-on-rails-upgrade-mongoid-to-version-5-0-0", "title": "Ruby on Rails upgrade Mongoid to version 5.0.0", "body": "<p>I have a Rails application which was using Mongoid 4.0.2. I upgraded Mongoid to version 5.0.0 and start getting this error </p>\n\n<pre><code>....gems/2.2.0/gems/less-rails-2.7.0/lib/less/rails/railtie.rb:19:in `block in &lt;class:Railtie&gt;': undefined method `register_preprocessor' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>How to fix this issue or is any manual how to upgrade Mongoid to version 5.0.0 ?</p>\n\n<p>Gemfile</p>\n\n<pre><code> source 'https://rubygems.org'\n\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '4.2.0.beta4'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0.0.beta1'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.1.0'\n# See https://github.com/sstephenson/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\n# Use jQuery as the JavaScript library\ngem 'jquery-rails', '~&gt; 4.0.0.beta2'\n# Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks\ngem 'turbolinks'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.0'\n# bundle exec rake doc:rails generates the API under doc/api.\ngem 'sdoc', '~&gt; 0.4.0', group: :doc\n\n#new gems\n#database\ngem 'mongoid', '~&gt; 5.0.0.beta'\ngem \"mongoid-paperclip\", :require =&gt; \"mongoid_paperclip\"\ngem 'bson_ext'\n#stile\ngem \"therubyracer\"\ngem \"less-rails\" #Sprockets (what Rails 3.1 uses for its asset pipeline) supports LESS\ngem \"twitter-bootstrap-rails\"\ngem 'bootstrap_form'\ngem 'bootstrap-sass', '~&gt; 3.3.4'\ngem 'bootswatch-rails'\ngem 'simple_form'\ngem 'mongo'\ngem \"figaro\"\ngem 'sidekiq'\ngem 'sidekiq-status'\ngem 'rubyzip'\n#gem 'sidekiq_status'\n#gem 'sidekiq-status'\ngem 'sinatra', require: false\ngem 'slim'\ngem 'capistrano', '~&gt; 3.1.0'\n\n# rails specific capistrano funcitons\ngem 'capistrano-rails', '~&gt; 1.1.0'\ngem 'capistrano-rails-console'\n\n# integrate bundler with capistrano\ngem 'capistrano-bundler'\n\n# if you are using RBENV\ngem 'capistrano-rbenv', \"~&gt; 2.0\"\ngem 'capistrano-sidekiq', github: 'seuros/capistrano-sidekiq'\n\ngem 'capistrano-passenger'\ngem 'utf8-cleaner'\ngem \"devise\"\ngem 'rollbar', '~&gt; 1.5.3'\n\n\n#gem 'bson', '~&gt; 3.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Unicorn as the app server\n# gem 'unicorn'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  gem 'thin'\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug'\n\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; in views\n  gem 'web-console', '~&gt; 2.0.0.beta4'\n\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n\n  #new gems\n  gem \"rspec-rails\"\n  gem 'pry-rails'\n  gem 'pry-rescue'\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; in views\n  gem 'better_errors'\n  #gem 'mongoid-rspec', '~&gt; 2.1.0'\n\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rspec"], "comments": [{"owner": {"reputation": 306, "user_id": 2140191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vPeZd.jpg?s=128&g=1", "display_name": "D. Wonnink", "link": "https://stackoverflow.com/users/2140191/d-wonnink"}, "edited": false, "score": 0, "creation_date": 1441188153, "post_id": 32349503, "comment_id": 52573541, "body": "I don&#39;t know if it is the answer but you have a typo; <code>subjet { klass.new }</code>. Shouldn&#39;t it be: <code>subject { klass.new }</code> (missing a &#39;c&#39;). Try that and let us know!"}], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 3, "last_activity_date": 1441188719, "creation_date": 1441188719, "answer_id": 32350379, "question_id": 32349503, "link": "https://stackoverflow.com/questions/32349503/stub-unimplemented-method-in-rspec/32350379#32350379", "title": "Stub unimplemented method in rspec", "body": "<pre><code>subject(:klass) do \n  Struct.new(:name) do\n   include MyModule\n  end\nend\n</code></pre>\n\n<p><a href=\"http://ruby-doc.org/core-2.2.0/Struct.html\" rel=\"nofollow\">http://ruby-doc.org/core-2.2.0/Struct.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1441189890, "post_id": 32350707, "comment_id": 52574612, "body": "<code>name</code> should probably be an instance method returning <code>&#39;SOreadytohelp&#39;</code>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1441190417, "post_id": 32350707, "comment_id": 52574908, "body": "@Stefan: I agree, that is also a good idea. Depends on the focus: To stress that specs and code are in sync or that there is something to fix..."}, {"owner": {"reputation": 449, "user_id": 5397051, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68b724016d680eb143dd20e9da217b04?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Gouy", "link": "https://stackoverflow.com/users/5397051/nathan-gouy"}, "edited": false, "score": 0, "creation_date": 1548094885, "post_id": 32350707, "comment_id": 95411877, "body": "definition of NotImplementedError :   <code>NotImplementedError  Raised when a feature is not implemented on the current platform. For example, methods depending on the +fsync+ or +fork+ system calls may raise this exception if the underlying operating system or Ruby runtime does not support them.</code>  it should be  <code>NoMethodError</code> :  <code>Raised when a method is called on a receiver which doesn\u2019t have it defined and also fails to respond with +method_missing+</code>  Correction needed"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 7, "last_activity_date": 1564212746, "last_edit_date": 1564212746, "creation_date": 1441189710, "answer_id": 32350707, "question_id": 32349503, "link": "https://stackoverflow.com/questions/32349503/stub-unimplemented-method-in-rspec/32350707#32350707", "title": "Stub unimplemented method in rspec", "body": "<p>RSpec raises this exception because it is not useful to stub a method that does not exist on the original object. </p>\n\n<p>Mocking methods is always error-prone because the mock might behave differently than the original implementation and therefore specs might be successful even if the original implementation would have returned an error (or does not even exist). Allowing to mock non-existing methods is just plain wrong.</p>\n\n<p>Therefore I would argue that you should not try to bypass this exception. Just add a <code>name</code> method to your class that raises a clear exception if run outside of the test environment:</p>\n\n<pre><code>def self.name\n  raise NoMethodError  # TODO: check specs...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15010, "user_id": 567863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abda861707b1e78e0fce47ced55f84ee?s=128&d=identicon&r=PG", "display_name": "Paul Fioravanti", "link": "https://stackoverflow.com/users/567863/paul-fioravanti"}, "is_accepted": false, "score": 1, "last_activity_date": 1442043726, "creation_date": 1442043726, "answer_id": 32536440, "question_id": 32349503, "link": "https://stackoverflow.com/questions/32349503/stub-unimplemented-method-in-rspec/32536440#32536440", "title": "Stub unimplemented method in rspec", "body": "<p>I think that if the test you're writing is focused on your <code>MyModule</code> module, and that module relies on an instance method in the class that it is mixed into, then I think that method should be mocked out in the anonymous class that you use when testing the module.  For example:</p>\n\n<pre><code>module MyModule\n  def call_name\n    # expected implementation of #name to be\n    # in the class this module is mixed into\n    name\n  end\nend\n\nRSpec.describe MyModule do\n  let(:my_module_able) do\n    Class.new do\n      include MyModule\n\n      # We don't care what the return value of this method is;\n      # we just need this anonymous class to respond to #name\n      def name\n        'Some Name that is not SOReadytohelp'\n      end\n    end.new\n  end\n\n  describe '#call_name' do\n    let(:name) { 'SOReadytohelp' }\n\n    before do\n      allow(my_module_able).to receive(:name).and_return(name)\n    end\n\n    it 'returns the name' do\n      expect(my_module_able.call_name).to eq(name)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10065, "favorite_count": 1, "accepted_answer_id": 32350707, "answer_count": 3, "score": 12, "last_activity_date": 1564212746, "creation_date": 1441186221, "last_edit_date": 1441189802, "question_id": 32349503, "link": "https://stackoverflow.com/questions/32349503/stub-unimplemented-method-in-rspec", "title": "Stub unimplemented method in rspec", "body": "<p>I'm testing my module and I decided to test it versus anonymous class:</p>\n\n<pre><code>  subject(:klass) { Class.new { include MyModule } }\n</code></pre>\n\n<p><code>MyModule</code> uses method <code>name</code> inside <code>klass</code>. To let my specs work I need to stub this method <code>name</code> (which is unimplemented). So I wrote:</p>\n\n<pre><code>subject { klass.new }\nallow(subject).to receive(:name).and_return('SOreadytohelp') }\n</code></pre>\n\n<p>but it raises:</p>\n\n<pre><code> RSpec::Mocks::MockExpectationError: #&lt;#&lt;Class:0x007feb67a17750&gt;:0x007feb67c7adf8&gt; does not implement: name\nfrom spec-support-3.3.0/lib/rspec/support.rb:86:in `block in &lt;module:Support&gt;'\n</code></pre>\n\n<p>how to stub this method without defining it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "prawn"], "answers": [{"comments": [{"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441190325, "post_id": 32350801, "comment_id": 52574855, "body": "Also you should check in the controller code that the correct value is assigned to <code>@order</code> before creating the new instance of <code>PdfReport</code>"}], "tags": [], "owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "is_accepted": false, "score": 0, "last_activity_date": 1441189964, "creation_date": 1441189964, "answer_id": 32350801, "question_id": 32349008, "link": "https://stackoverflow.com/questions/32349008/insert-variable-in-bounding-box-on-prawn-rails-4/32350801#32350801", "title": "Insert variable in bounding_box on Prawn rails 4", "body": "<p>Since you pass the <code>@order</code> object as a parameter to the constructor of <code>ReportPdf</code> you should access it via the local parameter</p>\n\n<pre><code>    text \"#{order.company_fact}\", size: 15, style: :bold\n    text \"#{order.civility_fact} #{order.last_name_fact} #{order.first_name_fact}\"\n    text \"#{order.address_fact} \n</code></pre>\n\n<p>and you should add the parameter <code>order</code> to method product rows</p>\n\n<pre><code>def product_rows(order)\n    [['#', 'Pictogram code', 'Price']] +\n    order.pictograms.map do |p|\n        [p.id, p.code, '/']\n    end\nend\n</code></pre>\n\n<p>and invoke it like <code>table product_rows(order) do</code></p>\n"}], "owner": {"reputation": 471, "user_id": 4524405, "user_type": "registered", "accept_rate": 9, "profile_image": "https://lh5.googleusercontent.com/-fjErJCkTgpE/AAAAAAAAAAI/AAAAAAAAEA0/Yuvi6mOQONs/photo.jpg?sz=128", "display_name": "Gregory Frerot", "link": "https://stackoverflow.com/users/4524405/gregory-frerot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441189964, "creation_date": 1441184914, "question_id": 32349008, "link": "https://stackoverflow.com/questions/32349008/insert-variable-in-bounding-box-on-prawn-rails-4", "title": "Insert variable in bounding_box on Prawn rails 4", "body": "<p>I would like insert variable in my bounding_box text.\nWhen i generate my PDF, my text is blank.</p>\n\n<p>My controller action \"show\" in Order :</p>\n\n<pre><code>def show\n  respond_to do |format|\n    format.html\n    format.pdf do\n      pdf = ReportPdf.new(@order, view_context)\n      send_data pdf.render, filename: 'report.pdf', type: 'application/pdf'\n    end\n  end\nend\n</code></pre>\n\n<p>My report file (app/pdfs/report_pdf.rb)</p>\n\n<pre><code>class ReportPdf &lt; Prawn::Document\nrequire 'prawn/table'\n\n  def initialize(order, view)\n    super()\n    @view = view\n    @order = order\n    image \"#{Rails.root}/app/assets/images/pdf/header.jpg\", width: 540, height: 60\n\n    # The cursor for inserting content starts on the top left of the page. Here we move it down a little to create more space between the text and the image inserted above\n    y_position = cursor - 50\n\n    # The bounding_box takes the x and y coordinates for positioning its content and some options to style it\n    bounding_box([0, y_position], :width =&gt; 270, :height =&gt; 300) do\n        text \"Lorem ipsum\", size: 15, style: :bold\n        text \"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse interdum semper placerat. Aenean mattis fringilla risus ut fermentum. Fusce posuere dictum venenatis. Aliquam id tincidunt ante, eu pretium eros. Sed eget risus a nisl aliquet scelerisque sit amet id nisi. Praesent porta molestie ipsum, ac commodo erat hendrerit nec. Nullam interdum ipsum a quam euismod, at consequat libero bibendum. Nam at nulla fermentum, congue lectus ut, pulvinar nisl. Curabitur consectetur quis libero id laoreet. Fusce dictum metus et orci pretium, vel imperdiet est viverra. Morbi vitae libero in tortor mattis commodo. Ut sodales libero erat, at gravida enim rhoncus ut.\"\n    end\n\n    bounding_box([300, y_position], :width =&gt; 270, :height =&gt; 300) do\n        text \"#{@order.company_fact}\", size: 15, style: :bold\n        text \"#{@order.civility_fact} #{@order.last_name_fact} #{@order.first_name_fact}\"\n        text \"#{@order.address_fact} \"\n    end\n\n    table product_rows do\n        row(0).font_style = :bold\n        self.header = true\n        self.row_colors = ['DDDDDD', 'FFFFFF']\n        self.column_widths = [40, 300, 200]\n    end\n  end\n\n  def product_rows\n    [['#', 'Pictogram code', 'Price']] +\n        @order.pictograms.map do |p|\n            [p.id, p.code, '/']\n        end\n  end  end\n</code></pre>\n\n<p>I create 2 bounding_box, one with sample text and one with text from variable. The first one works perfectly but with I include variable the text is blank.</p>\n\n<p>I think that it's about the context, on google lot of people add pdf.text to include variable but in my case i'm in the initialize method not in the controller.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "rspec", "thor"], "comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 1, "creation_date": 1441197841, "post_id": 32348860, "comment_id": 52580009, "body": "Thats how <code>Thor</code> works, it is unclear why you would launch <code>Thor</code> CLI and expect it not to work the way it works"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1441197918, "post_id": 32348860, "comment_id": 52580068, "body": "If you do not want the description to be shown, do not define a description. It is not mandatory."}, {"owner": {"reputation": 737, "user_id": 4757050, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8f17eec299ccddf9f84808550217e9c?s=128&d=identicon&r=PG&f=1", "display_name": "s-cho-m", "link": "https://stackoverflow.com/users/4757050/s-cho-m"}, "reply_to_user": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1441244092, "post_id": 32348860, "comment_id": 52603553, "body": "@WandMaker Because in my project, I should run a batch by hand and use some options."}, {"owner": {"reputation": 737, "user_id": 4757050, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8f17eec299ccddf9f84808550217e9c?s=128&d=identicon&r=PG&f=1", "display_name": "s-cho-m", "link": "https://stackoverflow.com/users/4757050/s-cho-m"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1441244148, "post_id": 32348860, "comment_id": 52603563, "body": "@mudasobwa If I don&#39;t use it. My test will not past."}], "answers": [{"comments": [{"owner": {"reputation": 737, "user_id": 4757050, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8f17eec299ccddf9f84808550217e9c?s=128&d=identicon&r=PG&f=1", "display_name": "s-cho-m", "link": "https://stackoverflow.com/users/4757050/s-cho-m"}, "edited": false, "score": 0, "creation_date": 1441244231, "post_id": 32360121, "comment_id": 52603576, "body": "Thank you. Do you mean I should rewrite Thor module?"}, {"owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "reply_to_user": {"reputation": 737, "user_id": 4757050, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8f17eec299ccddf9f84808550217e9c?s=128&d=identicon&r=PG&f=1", "display_name": "s-cho-m", "link": "https://stackoverflow.com/users/4757050/s-cho-m"}, "edited": false, "score": 0, "creation_date": 1441336286, "post_id": 32360121, "comment_id": 52648009, "body": "It&#39;s not out of the ordinary to monkey patch out some methods in your libraries for testing. It adds a dependency to your code, but I find being able to test the functionality is usually worth it"}], "tags": [], "owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "is_accepted": false, "score": 0, "last_activity_date": 1441217466, "last_edit_date": 1441217466, "creation_date": 1441216853, "answer_id": 32360121, "question_id": 32348860, "link": "https://stackoverflow.com/questions/32348860/how-to-remove-desc-messages-from-rspec-when-using-thor/32360121#32360121", "title": "How to remove desc messages from rspec when using thor?", "body": "<p>Haven't tested it, but I'd imagine you could probably patch it out with something like:</p>\n\n<pre><code>module Thor\n  def puts(*args, &amp;block)\n    # do nothing\n  end\nend\n</code></pre>\n\n<p>EDIT: actually it looks like this might be handled a little differently here: <a href=\"https://github.com/erikhuda/thor/blob/master/lib/thor/shell/basic.rb\" rel=\"nofollow\">https://github.com/erikhuda/thor/blob/master/lib/thor/shell/basic.rb</a></p>\n\n<p>It looks like you could stub out <code>Thor::Shell::Basic#stdout</code> and <code>#stderr</code></p>\n"}], "owner": {"reputation": 737, "user_id": 4757050, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8f17eec299ccddf9f84808550217e9c?s=128&d=identicon&r=PG&f=1", "display_name": "s-cho-m", "link": "https://stackoverflow.com/users/4757050/s-cho-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441243994, "creation_date": 1441184516, "last_edit_date": 1441243994, "question_id": 32348860, "link": "https://stackoverflow.com/questions/32348860/how-to-remove-desc-messages-from-rspec-when-using-thor", "title": "How to remove desc messages from rspec when using thor?", "body": "<p>Now I am using <a href=\"http://whatisthor.com/\" rel=\"nofollow\">thor</a> in a rails project.</p>\n\n<p>I wrote these codes:</p>\n\n<p>lib/tasks/my_task.rb</p>\n\n<pre><code>require 'thor'\n\nmodule Tasks\n  class MyTask &lt; Thor\n    desc 'My Batch', 'This is my awesome batch'\n    option :date\n    def execute(type)\n      # do_something\n    end\n  end\nend\n\nTasks::MyTask.start(ARGV)\n</code></pre>\n\n<p>spec/lib/tasks/my_task_spec.rb</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe 'Test my task' do\n  context 'With date option' do\n    before do\n      @option = { date: '20150903' }\n    end\n\n    it 'Can insert to db' do\n      expect do\n        Tasks::MyTask.new.invoke(:execute, ['commit'], @option)\n      end.to change(ProductTable, :count).by(1)\n    end\n  end\nend\n</code></pre>\n\n<p>The problem is when I run <code>bundle exec rspec</code>, it showed:</p>\n\n<pre><code>Run options: exclude {:heavy=&gt;true}\n..................................................................................................................................................................................................****************************...................................................\n........................................................************.......................................................................................................................................................................................................******\nCommands:\n  rspec help [COMMAND]  # Describe available commands or one specific command\n  rspec My Batch          # This is my awesome batch\n.................................................................................................................................................................................................................................................................................\n</code></pre>\n\n<p>Why the desc messages been shown here? How to config to remove them?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 7259, "user_id": 5239247, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/9WOIt.png?s=128&g=1", "display_name": "Praveen George", "link": "https://stackoverflow.com/users/5239247/praveen-george"}, "edited": false, "score": 0, "creation_date": 1441185432, "post_id": 32348549, "comment_id": 52571666, "body": "Thanks for the reply, but I have to implement it using pure ruby on rails itself."}], "tags": [], "owner": {"reputation": 569, "user_id": 5268327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fsYqc.jpg?s=128&g=1", "display_name": "Asad Ali", "link": "https://stackoverflow.com/users/5268327/asad-ali"}, "is_accepted": false, "score": 2, "last_activity_date": 1441183946, "last_edit_date": 1441183946, "creation_date": 1441183595, "answer_id": 32348549, "question_id": 32348362, "link": "https://stackoverflow.com/questions/32348362/drop-down-list-with-search-button-in-rails/32348549#32348549", "title": "Drop Down List With Search Button In Rails", "body": "<p>Answer 1:</p>\n\n<p>you can do this task using JS I will recommend you to use one of these jquery plugins for search bars <a href=\"https://select2.github.io/examples.html\" rel=\"nofollow\">Select2</a> and <a href=\"https://select2.github.io/examples.html\" rel=\"nofollow\">Chosen</a>. </p>\n\n<p>My personal experience with select2 is impressive. </p>\n\n<p>it loads data via ajax and cache as well to avoid repeat calls. Its GUI give u a Google like feel. read its documentation and use it.</p>\n\n<p>Answer 2:</p>\n\n<p>select2 also give u events like <code>change</code>  so u can make another ajax call to load filterd customers.</p>\n"}, {"comments": [{"owner": {"reputation": 7259, "user_id": 5239247, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/9WOIt.png?s=128&g=1", "display_name": "Praveen George", "link": "https://stackoverflow.com/users/5239247/praveen-george"}, "edited": false, "score": 0, "creation_date": 1441186289, "post_id": 32349382, "comment_id": 52572278, "body": "@doctors =  Customer.joins(:user).where(users: {role: User.roles[:doctor]})  Now what to do in    view, I dont understand the rails guide. I just want to list all doctors :firstname as drop down  list items, then a search or selecting any of the dropdown item must show all customers created by that doctor id."}, {"owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "reply_to_user": {"reputation": 7259, "user_id": 5239247, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/9WOIt.png?s=128&g=1", "display_name": "Praveen George", "link": "https://stackoverflow.com/users/5239247/praveen-george"}, "edited": false, "score": 1, "creation_date": 1441186922, "post_id": 32349382, "comment_id": 52572693, "body": "Is that link clearer? <a href=\"https://howilearnedrails.wordpress.com/2013/12/18/rails-4-dropdown-menu-with-collection_select/\" rel=\"nofollow noreferrer\">howilearnedrails.wordpress.com/2013/12/18/&hellip;</a> I try to get you to understand how it works rather than writing the code for you :P"}, {"owner": {"reputation": 7259, "user_id": 5239247, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/9WOIt.png?s=128&g=1", "display_name": "Praveen George", "link": "https://stackoverflow.com/users/5239247/praveen-george"}, "edited": false, "score": 0, "creation_date": 1441188678, "post_id": 32349382, "comment_id": 52573906, "body": "thank you , I still confused as I am a total beginner. I need the drop down with doctors first name. Clicking on it must filter the customers under that particular doctor."}], "tags": [], "owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "is_accepted": true, "score": 1, "last_activity_date": 1441192056, "last_edit_date": 1441192056, "creation_date": 1441185908, "answer_id": 32349382, "question_id": 32348362, "link": "https://stackoverflow.com/questions/32348362/drop-down-list-with-search-button-in-rails/32349382#32349382", "title": "Drop Down List With Search Button In Rails", "body": "<ol>\n<li><p>You can simply use the following tag in your rails view:</p>\n\n<p><code>&lt;%= select(\"doctor\", \"firstname\", @doctors.all.collect(&amp;:firstname)) %&gt;</code></p></li>\n<li><p>Then in your controller you'd have something like this:</p>\n\n<p><code>def index\n  if params[:doctor]\n     @customers = Customer.joins(:user).where(users: {role: User.roles[:doctor]}, firstname: params[:doctor][:firstname].downcase)\n  else\n     @customers = Customer.all\n  end\nend</code></p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 744, "user_id": 1885107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f3cb4e9a996ab41c7980d6954dfb68d?s=128&d=identicon&r=PG", "display_name": "Prakash Laxkar", "link": "https://stackoverflow.com/users/1885107/prakash-laxkar"}, "is_accepted": false, "score": 1, "last_activity_date": 1441187956, "creation_date": 1441187956, "answer_id": 32350125, "question_id": 32348362, "link": "https://stackoverflow.com/questions/32348362/drop-down-list-with-search-button-in-rails/32350125#32350125", "title": "Drop Down List With Search Button In Rails", "body": "<p>You can do this auto_complete rails. Have a look on \n    <a href=\"http://railscasts.com/episodes/102-auto-complete-association\" rel=\"nofollow\">http://railscasts.com/episodes/102-auto-complete-association</a></p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 7259, "user_id": 5239247, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/9WOIt.png?s=128&g=1", "display_name": "Praveen George", "link": "https://stackoverflow.com/users/5239247/praveen-george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5790, "favorite_count": 1, "accepted_answer_id": 32349382, "answer_count": 3, "score": 1, "last_activity_date": 1441192056, "creation_date": 1441183060, "last_edit_date": 1441189616, "question_id": 32348362, "link": "https://stackoverflow.com/questions/32348362/drop-down-list-with-search-button-in-rails", "title": "Drop Down List With Search Button In Rails", "body": "<p>I have a customer model with the following collection:</p>\n\n<pre><code>@doctors =  Customer.joins(:user).where(users: {role: User.roles[:doctor]}) \n</code></pre>\n\n<p>which joins the user table and customer tables where user role is \"doctor\".</p>\n\n<p>In my Customers index view currently I am listing all the customers, now I want to add a search filter using a Drop down list with a search button, where the list contains the first name of the Doctors. If I press the search button it should show only customers created by that particular doctor selected from the drop down list.</p>\n\n<p><strong>1.</strong> How to add a drop down list with search button which displays only first names of doctors ?</p>\n\n<hr>\n\n<p><strong>2.</strong> How to filter my customers listing when I select a particular doctor from the drop down and click on search button ?</p>\n\n<hr>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"btn-group\"&gt;\r\n            &lt;button type=\"button\" class=\"btn btn-success btn-sm\"&gt;&lt;b&gt;Search By Dr.&lt;/b&gt;&lt;/button&gt;\r\n            &lt;button type=\"button\" class=\"btn btn-success btn-sm\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\"&gt;\r\n            \t&lt;span class=\"caret\"&gt;&lt;/span&gt;\r\n            \t&lt;span class=\"sr-only\"&gt;Toggle Dropdown&lt;/span&gt;\r\n            &lt;/button&gt;\r\n            &lt;ul class=\"dropdown-menu\"&gt;\r\n\r\n              &lt;li&gt;&lt;a href=\"#\"&gt;List All Customers&lt;/a&gt;&lt;/li&gt;\r\n            &lt;% @practices.each do |practice| %&gt;\r\n              &lt;li&gt;&lt;a href=\"#\"&gt;Dr.&lt;%= practice.firstname %&gt;&lt;/a&gt;&lt;/li&gt;\r\n            &lt;% end %&gt;\r\n            &lt;/ul&gt;\r\n        &lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The above is the code that I am currently using, but is it correct way of Rails ?</p>\n"}, {"tags": ["ruby", "ajax", "rest-client"], "answers": [{"tags": [], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "is_accepted": false, "score": 0, "last_activity_date": 1441184434, "creation_date": 1441184434, "answer_id": 32348837, "question_id": 32348138, "link": "https://stackoverflow.com/questions/32348138/error-converting-ajax-request-into-ruby-incoming-message-has-an-unexpected-form/32348837#32348837", "title": "Error converting ajax request into Ruby (Incoming message has an unexpected format &#39;Raw&#39;)", "body": "<p>Where you have:</p>\n\n<pre><code>headers = {\n  contentType: \"application/json\",\n  dataType: \"json\"\n}\n</code></pre>\n\n<p>it should be</p>\n\n<pre><code>headers = {\n  content_type: \"application/json\",\n  data_type: \"json\"\n}\n</code></pre>\n"}], "owner": {"reputation": 1810, "user_id": 1301840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ad9bbcb458c0923c2946f85b6b98107b?s=128&d=identicon&r=PG&f=1", "display_name": "lusketeer", "link": "https://stackoverflow.com/users/1301840/lusketeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441184481, "creation_date": 1441182373, "last_edit_date": 1441184481, "question_id": 32348138, "link": "https://stackoverflow.com/questions/32348138/error-converting-ajax-request-into-ruby-incoming-message-has-an-unexpected-form", "title": "Error converting ajax request into Ruby (Incoming message has an unexpected format &#39;Raw&#39;)", "body": "<p>I'm in the process of converting an ajax request into Ruby using <a href=\"https://github.com/rest-client/rest-client\" rel=\"nofollow\">RestClient</a></p>\n\n<p>Functions in Javascript</p>\n\n<pre><code>var dispatchWebAPIEndpointURL = 'http://dispatchweb.eureka-technology.fr/webmanager/WCFDispatchAPI.svc/REST/';\nfunction APICallPOST(Method, Data, OnSucces, OnError) {\n    $.ajax(\n            {\n                url: dispatchWebAPIEndpointURL + 'json/' + Method,\n                type: 'POST',\n                data: Data,\n                contentType: \"application/json; charset=utf-8\",\n                dataType: \"json\",\n                success: OnSucces,\n                failure: OnError\n            });\n}\nfunction Authentification() {\n\n    var AuthentificationRequest = new Object();\n    AuthentificationRequest.Credential = new Object();\n    AuthentificationRequest.Credential.License = \"license\";\n    AuthentificationRequest.Credential.Login = \"login\";\n    AuthentificationRequest.Credential.Password = \"password\";\n    AuthentificationRequest.Credential.EMail = null;\n    AuthentificationRequest.Credential.Language = 'fr-FR';\n\n\n    APICallPOST('Authentify', JSON.stringify(AuthentificationRequest), function (response) {\n        if (response.Status == 200 &amp;&amp; response.Authentified == true) {\n            alert('Authentification success');\n        }\n        else {\n            alert(response.Errors[0]);\n        }\n    },\n    function (response) {\n        alert('Error');\n    });\n\n}\n</code></pre>\n\n<p>Functions in Ruby using RestClient</p>\n\n<pre><code>url = 'http://dispatchweb.eureka-technology.fr/webmanager/WCFDispatchAPI.svc/REST/';\ncredential = {\n      \"Credential\" =&gt; {\n        \"License\"   =&gt; \"License\",\n        \"Login\"     =&gt; \"Login\",\n        \"Password\"  =&gt; \"Password\",\n        \"EMail\"     =&gt; nil,\n        \"Language\"  =&gt; \"en-EN\"\n      }\n    }\nrequest_url = url + \"json/Authentify\"\n    headers = {\n      contentType: \"application/json\",\n      dataType: \"json\"\n    }\n    RestClient.post(request_url, credential.to_json, headers) {|response, request, result, &amp;block|\n      case response.code\n      when 200\n        p \"It worked !\"\n        response\n      when 423\n        raise SomeCustomExceptionIfYouWant\n      else\n        p \"you messed up\"\n        response.return!(request, result, &amp;block)\n      end\n    }\n</code></pre>\n\n<p>The javascript functions work fine, and I get a response for success. The ruby version keeps giving me the 500 error along with the message </p>\n\n<blockquote>\n  <p>\"Exception caught at WCFDispatchWebAPIErrorHandler &amp; # xD; \\ nMethod:\n  DeserializeRequest &amp; # xD; \\ nMessage: The incoming message has an\n  unexpected format 'Raw'. The message formats expected for the op \\ XC3\n  \\ xA9ration are 'XML'; 'Json'.\"</p>\n</blockquote>\n\n<p>I'm wondering if I actually pass in the credential in a correct way.</p>\n\n<p>Any thought would be appreciated! Thanks!</p>\n\n<p><strong>Solved</strong>\nSo it turns out</p>\n\n<pre><code>headers = {\n          contentType: \"application/json\",\n          dataType: \"json\"\n        }\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>headers = {\n          content_type: \"application/json\",\n          data_type: \"json\"\n        }\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1441179787, "post_id": 32347194, "comment_id": 52568270, "body": "Rails does not update the connection, because the above configuration is set only once when the class is loaded. You might want to add a class method that triggers a re-configuration. Why do you want to do that? What do you try to achieve? Is a load balancer in front of the database an option?"}, {"owner": {"reputation": 801, "user_id": 253721, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/395f4735583556fd881a11931ec7c546?s=128&d=identicon&r=PG", "display_name": "Dobler", "link": "https://stackoverflow.com/users/253721/dobler"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1441225417, "post_id": 32347194, "comment_id": 52597579, "body": "yeah thats what I figured, I tried a before_validation but that didn&#39;t work. could you post an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "is_accepted": false, "score": 2, "last_activity_date": 1441180248, "last_edit_date": 1441180248, "creation_date": 1441179932, "answer_id": 32347363, "question_id": 32347194, "link": "https://stackoverflow.com/questions/32347194/dynamic-database-connection-connection-not-updating-until-ror-is-restarted/32347363#32347363", "title": "Dynamic database connection connection not updating until RoR is restarted", "body": "<p>You can switch to a new connection dynamically using this snippet:</p>\n\n<pre><code>connection_info = Submission.configurations[RAILS_ENV].clone\nconnection_info['database'] = 'new_database'\nSubmission.establish_connection(connection_info)\n</code></pre>\n\n<p>In first line we get existing settings for connection (<code>clone</code> is essential). Then we update settings to desired (in this case only <code>database</code> is updated) and then reestablishing the connection.</p>\n\n<p>If you need to return to default configuration, you can use:</p>\n\n<pre><code>Submission.establish_connection(RAILS_ENV)\n</code></pre>\n\n<p>See more info <a href=\"http://apidock.com/rails/ActiveRecord/Base/establish_connection/class\" rel=\"nofollow\">http://apidock.com/rails/ActiveRecord/Base/establish_connection/class</a></p>\n"}], "owner": {"reputation": 801, "user_id": 253721, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/395f4735583556fd881a11931ec7c546?s=128&d=identicon&r=PG", "display_name": "Dobler", "link": "https://stackoverflow.com/users/253721/dobler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441180248, "creation_date": 1441179491, "question_id": 32347194, "link": "https://stackoverflow.com/questions/32347194/dynamic-database-connection-connection-not-updating-until-ror-is-restarted", "title": "Dynamic database connection connection not updating until RoR is restarted", "body": "<p>The variable used by establish_connection is changing, but for some reason the model doesn't switch to the updated configuration until Rails is restarted. How can I get the model to dynamically connect to a different database successfully?</p>\n\n<pre><code>class Submission &lt; ActiveRecord::Base\n establish_connection(ExtDBInfo.current_ext_db)\nend\n</code></pre>\n"}, {"tags": ["ruby", "redis", "sinatra", "sidekiq"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 1847495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c2be5e228bacf3ee6eaa6041425940?s=128&d=identicon&r=PG", "display_name": "cubicme", "link": "https://stackoverflow.com/users/1847495/cubicme"}, "is_accepted": false, "score": 1, "last_activity_date": 1441180891, "creation_date": 1441180891, "answer_id": 32347675, "question_id": 32347142, "link": "https://stackoverflow.com/questions/32347142/multiple-sidekiq-queue-for-an-sinatra-application/32347675#32347675", "title": "multiple sidekiq queue for an sinatra application", "body": "<p>take a look at sidekiq wiki: <a href=\"https://github.com/mperham/sidekiq/wiki/Advanced-Options\" rel=\"nofollow\">https://github.com/mperham/sidekiq/wiki/Advanced-Options</a></p>\n\n<p>by default everything goes inside 'default' queue but you can specify a queue in your worker:</p>\n\n<pre><code> sidekiq_options :queue =&gt; :file_queue\n</code></pre>\n\n<p>and to tell sidekiq to process your queue, you have to either declare it in configuration file:</p>\n\n<pre><code>:queues:\n  - file_queue\n  - default \n</code></pre>\n\n<p>or pass it as argument to the sidekiq process: <code>sidekiq -q file_queue</code></p>\n"}, {"comments": [{"owner": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "edited": false, "score": 0, "creation_date": 1441182248, "post_id": 32347679, "comment_id": 52569709, "body": "Thanks for your great information. Good to know this. I am just curious that how will the jobs get processed from two different queues? are they processed in parallel ?"}, {"owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "reply_to_user": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "edited": false, "score": 0, "creation_date": 1441182344, "post_id": 32347679, "comment_id": 52569760, "body": "Yes. And not only different queue are processed in parallel. By default there are 25 jobs in a single queue, each of them executed in parallel."}], "tags": [], "owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "is_accepted": true, "score": 2, "last_activity_date": 1441184211, "last_edit_date": 1441184211, "creation_date": 1441180905, "answer_id": 32347679, "question_id": 32347142, "link": "https://stackoverflow.com/questions/32347142/multiple-sidekiq-queue-for-an-sinatra-application/32347679#32347679", "title": "multiple sidekiq queue for an sinatra application", "body": "<p>You probably need advanced queue options. Read about them here: <a href=\"https://github.com/mperham/sidekiq/wiki/Advanced-Options\" rel=\"nofollow\">https://github.com/mperham/sidekiq/wiki/Advanced-Options</a></p>\n\n<p>Create <code>csv</code> queue from command line (it can be done in config file as well):</p>\n\n<pre><code>sidekiq -q csv -q default\n</code></pre>\n\n<p>Then in your worker:</p>\n\n<pre><code>class CSVWorker\n  include Sidekiq::Worker\n  sidekiq_options :queue =&gt; :csv\n\n  # perform method\nend\n</code></pre>\n"}], "owner": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 32347679, "answer_count": 2, "score": 1, "last_activity_date": 1441184211, "creation_date": 1441179310, "last_edit_date": 1441180080, "question_id": 32347142, "link": "https://stackoverflow.com/questions/32347142/multiple-sidekiq-queue-for-an-sinatra-application", "title": "multiple sidekiq queue for an sinatra application", "body": "<p>We have a Ruby on Sinatra application. We use sidekiq and redis for queue process.</p>\n\n<p>We already implemented and using sidekiq that queues up jobs that does insertion into database. it works pretty fine till now.</p>\n\n<p>Now I wanted to add another jobs which will read bulk data from database and export to csv file.</p>\n\n<p>I donot want both this job to be in same queue instead is there possible to create different queue for these jobs in same application?</p>\n\n<p>Please give some solution.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "dci"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1441185066, "post_id": 32347078, "comment_id": 52571418, "body": "It&#39;s basically a global variable. Only thread-safe."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1441185122, "last_edit_date": 1441185122, "creation_date": 1441182083, "answer_id": 32348051, "question_id": 32347078, "link": "https://stackoverflow.com/questions/32347078/what-is-thread-current-for-in-the-dci-in-ruby-example/32348051#32348051", "title": "What is Thread.current for in the DCI in Ruby example?", "body": "<p>Generally, inside block you do not have an access to the caller\u2019s context (besides closure variables.)</p>\n\n<pre><code>\u25b6 class A\n\u25b7   attr_accessor :a\n\u25b7   def test\n\u25b7     yield if block_given?\n\u25b7   end  \n\u25b7 end  \n#\u21d2 :test\n\u25b6 inst = A.new\n#\u21d2 #&lt;A:0x00000006f41e28&gt;\n\u25b6 inst.a = 'Test'\n#\u21d2 \"Test\"\n\u25b6 inst.test do \n\u25b7   puts self\n\u25b7   # here you do not have an access to inst at all\n\u25b7   # this would raise an exception: puts self.a\n\u25b7 end\n#\u21d2 main\n</code></pre>\n\n<p>But with context you still might have an access to <code>inst</code> from inside block:</p>\n\n<pre><code>\u25b6 in_context do \n\u25b7   puts self.context.a\n\u25b7 end\n#\u21d2 'Test'\n</code></pre>\n\n<p>So, one might introduce the <code>proc</code> (consider both <code>A</code> and <code>B</code> have <code>Context</code> included):</p>\n\n<pre><code>\u25b6 pr = -&gt;() { puts self.context }\n\u25b6 A.new.in_context &amp;pr\n#\u21d2 #&lt;A:0x00000006f41e28&gt;\n\u25b6 B.new.in_context &amp;pr\n#\u21d2 #&lt;B:0x00000006f41eff&gt;\n</code></pre>\n\n<p>Now external <code>proc</code> <em><code>pr</code></em> has virtually full access to <em>its caller</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "is_accepted": false, "score": 2, "last_activity_date": 1441185017, "last_edit_date": 1441185017, "creation_date": 1441182257, "answer_id": 32348108, "question_id": 32347078, "link": "https://stackoverflow.com/questions/32347078/what-is-thread-current-for-in-the-dci-in-ruby-example/32348108#32348108", "title": "What is Thread.current for in the DCI in Ruby example?", "body": "<p><code>Thread.current</code> is required to support multiple threading application, where each thread has its own context.</p>\n\n<p>There is also <a href=\"https://github.com/vsavkin/DCI-Sample/blob/master/lib/context_accessor.rb\" rel=\"nofollow\"><code>ContextAccessor</code> module</a> included, where one gets context. Putting them together just gives more clear picture:</p>\n\n<pre><code># context.rb\ndef context=(ctx)\n  Thread.current[:context] = ctx\nend\n\n# context_accessor.rb\ndef context\n  Thread.current[:context]\nend\n</code></pre>\n\n<p>The <code>in_context</code> method is designed to safely change context inside its block. Whatever the changes were, the old context is restored when the block ends execution.</p>\n"}], "owner": {"reputation": 770, "user_id": 2341321, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bd6c380c7b09a8f821e45e9a2a561643?s=128&d=identicon&r=PG", "display_name": "Jared Rader", "link": "https://stackoverflow.com/users/2341321/jared-rader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 32348051, "answer_count": 2, "score": 0, "last_activity_date": 1441185122, "creation_date": 1441179088, "question_id": 32347078, "link": "https://stackoverflow.com/questions/32347078/what-is-thread-current-for-in-the-dci-in-ruby-example", "title": "What is Thread.current for in the DCI in Ruby example?", "body": "<p>What is <code>Thread.current</code> for in this code? I'm looking at <a href=\"https://github.com/vsavkin/DCI-Sample\" rel=\"nofollow\">this</a> example of using DCI in a Rails application. In lib/context.rb, there's this:</p>\n\n<pre><code>module Context\n  include ContextAccessor\n\n  def context=(ctx)\n    Thread.current[:context] = ctx\n  end\n\n  def in_context\n    old_context = self.context\n    self.context = self\n    res = yield\n    self.context = old_context\n    res\n  end\nend\n</code></pre>\n\n<p>which is used in the various contexts in app/contexts, e.g.:</p>\n\n<pre><code>def bid\n  in_context do\n    validator.validate\n    biddable.create_bid\n  end\n  #...\nend\n</code></pre>\n\n<p>What is the benefit of running the code in the <code>in_context</code> block and setting a key-value pair on the current thread?</p>\n"}, {"tags": ["ruby", "serialization", "yaml", "dump"], "comments": [{"owner": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 0, "creation_date": 1441182110, "post_id": 32346940, "comment_id": 52569647, "body": "You have shown a lot of code, including <code>.save</code> and <code>.load</code> method definitions for the board (critically, you don&#39;t have anything which stores other game state, such as whose turn it is, which may be a clue as to what you are missing). However, I cannot see anywhere in the code that you actually use those methods, or how you are attempting to quit, save, then load and re-start the game. You need to show that code - even if it is just trying something in IRB - because otherwise it is anyone&#39;s guess on what is wrong."}], "answers": [{"tags": [], "owner": {"reputation": 551, "user_id": 4613575, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/94ee57c5cea9f3b94b68b7e5cf76369e?s=128&d=identicon&r=PG&f=1", "display_name": "hackrnaut", "link": "https://stackoverflow.com/users/4613575/hackrnaut"}, "is_accepted": true, "score": 0, "last_activity_date": 1441593483, "creation_date": 1441593483, "answer_id": 32430371, "question_id": 32346940, "link": "https://stackoverflow.com/questions/32346940/how-do-i-continue-tic-tac-toe-game-from-saved-yaml-file/32430371#32430371", "title": "How do I continue tic-tac-toe game from saved yaml file?", "body": "<p>I regionally thought that doing something like <code>YAML::load(self)</code> would automatically load the save state of the file I was referring to via some kind of magic. However, I have come to learn that that the way that I designed my class and the dependencies in my \"play\" function would not allow me to load the previous state if my file.</p>\n\n<p>When loading a YAML file, one has to load the file to a variable and then manually assign the object values to values of the class. That way, the current state of the variables are pretty much being manually assigned to the instance variables of the class. For example, I could have done something like this: <code>file = YAML.load(\"file_name\")</code>, then assign variables values like: <code>@board = file.board</code>.</p>\n\n<p>Had I known this before, I would have designed my class with less dependencies so that it would be loadable in a much cleaner and more convenient way.</p>\n"}], "owner": {"reputation": 551, "user_id": 4613575, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/94ee57c5cea9f3b94b68b7e5cf76369e?s=128&d=identicon&r=PG&f=1", "display_name": "hackrnaut", "link": "https://stackoverflow.com/users/4613575/hackrnaut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 32430371, "answer_count": 1, "score": -2, "last_activity_date": 1443437276, "creation_date": 1441178639, "last_edit_date": 1443437276, "question_id": 32346940, "link": "https://stackoverflow.com/questions/32346940/how-do-i-continue-tic-tac-toe-game-from-saved-yaml-file", "title": "How do I continue tic-tac-toe game from saved yaml file?", "body": "<p>I have the following tic-tac-toe game: (I'm a noob, please disregard the design of the class, the game works, that's all I care about for now.)</p>\n\n<pre><code>#a tic tac toe game\nclass TicTacToe\n    require \"yaml\"\n    attr_accessor :player1, :player2\n    #crates playes and a game board to play tic tac toe\n    def initialize()\n        @player1 = Player.new(\"Player One\", \"x\")\n        @player2 = Player.new(\"Player Two\", \"o\")\n        @game_board = Board.new\n    end\n\n    #prints the board\n    def print_board\n        @game_board.board.each_with_index do |row, index| \n            puts \"#{row.join(\" | \")}\"\n            puts \"---------\" unless index == 2\n        end\n        puts\n    end\n\n    #determines whose move it is\n    def move\n        if @turn % 2 == 1\n            player_one_turn\n        else\n            player_two_turn\n        end\n        @turn += 1\n    end\n\n    def valid_move?(row, col)\n        if @game_board.board[row][col] == \" \"\n            return true\n        else\n            return false\n        end\n    end\n\n    #player ones turn\n    def player_one_turn\n        print_board\n        puts \"#{@player1.name} it's your turn:\"\n        puts \"Enter a row (0-2)\"\n        row = gets.chomp.to_i\n        puts \"Enter a column (0-2)\"\n        col = gets.chomp.to_i\n        if valid_move?(row, col)\n            @game_board.board[row][col] = @player1.shape\n        else\n            puts \"There's already a shape at that position.\"\n            player_one_turn\n        end\n\n        if win?(@player1.shape)\n            winner(@player1.name)\n            @winner = true\n        end\n    end\n\n    #player two's turn\n    def player_two_turn\n        print_board\n        puts \"#{@player2.name} it's your turn:\"\n        puts \"Enter a row (0-2)\"\n        row = gets.chomp.to_i\n        puts \"Enter a column (0-2)\"\n        col = gets.chomp.to_i\n        if valid_move?(row, col)\n            @game_board.board[row][col] = @player2.shape\n        else\n            puts \"There's already a shape at that position.\"\n            player_two_turn\n        end\n\n        if win?(@player2.shape)\n            winner(@player2.name)\n            @winner = true\n        end\n    end\n\n    def win?(shape)\n        if (@game_board.board[0][0] == shape) &amp;&amp; (@game_board.board[0][1] == shape) &amp;&amp; (@game_board.board[0][2] == shape)\n            return true\n        elsif (@game_board.board[1][0] == shape) &amp;&amp; (@game_board.board[1][1] == shape) &amp;&amp; (@game_board.board[1][2] == shape)\n            return true\n        elsif (@game_board.board[2][0] == shape) &amp;&amp; (@game_board.board[2][1] == shape) &amp;&amp; (@game_board.board[2][2] == shape)\n            return true\n        elsif (@game_board.board[0][0] == shape) &amp;&amp; (@game_board.board[1][0] == shape) &amp;&amp; (@game_board.board[2][0] == shape)\n            return true\n        elsif (@game_board.board[0][1] == shape) &amp;&amp; (@game_board.board[1][1] == shape) &amp;&amp; (@game_board.board[2][1] == shape)\n            return true\n        elsif (@game_board.board[0][2] == shape) &amp;&amp; (@game_board.board[1][2] == shape) &amp;&amp; (@game_board.board[2][2] == shape)\n            return true\n        elsif (@game_board.board[0][0] == shape) &amp;&amp; (@game_board.board[1][1] == shape) &amp;&amp; (@game_board.board[2][2] == shape)\n            return true\n        elsif (@game_board.board[0][2] == shape) &amp;&amp; (@game_board.board[1][1] == shape) &amp;&amp; (@game_board.board[2][0] == shape)\n            return true\n        else\n            return false\n        end\n    end\n\n    def draw?\n        if @turn &gt; 9\n            print_board\n            puts \"The game ended in a draw. :)\"\n            @winner = true\n            return true\n        end\n        false\n    end\n\n    def winner(winner_name)\n        puts \"#{winner_name}, YOU WIN!!!\"\n    end\n\n    def play\n        @turn = 1\n        @winner = false\n\n        until @winner\n            move unless draw?\n            save\n        end\n    end\n\n\n    #a class that generates an empty board\n    class Board\n    attr_accessor :board\n        def initialize\n            @board = [[' ', ' ', ' '], [' ', ' ', ' '], [' ', ' ', ' ']]\n        end\n    end\n\n    #a class that assigns creates plaers and assigns them a shape \"x\" or \"o\"\n    class Player\n        attr_accessor :name, :shape\n        def initialize(name, shape)\n            @name = name\n            @shape = shape\n        end\n    end\n\n    def save\n        yaml = YAML::dump(self)\n        File.open(\"save.txt\", \"w\"){|file| file.write(yaml)}\n    end\n\n    def self.load\n        file = File.read(\"save.txt\")\n        YAML::load_file(file)\n    end\nend\n\ngame = TicTacToe.new\ngame.play\n</code></pre>\n\n<p>I want to start playing the game, quit the program in the middle of the game and then come back and finish it later after I call <code>TicTacToe.load</code>. However, when I do this now, the YAML file is loaded, but program does not resume where it's supposed to.</p>\n\n<p>Can someone tell me if there is a way to do what I'm trying to do?</p>\n"}, {"tags": ["ruby", "openssl"], "comments": [{"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441179406, "post_id": 32346466, "comment_id": 52568037, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14602069/why-cant-i-make-openssl-with-ruby-and-command-line-openssl-interoperable\" title=\"why cant i make openssl with ruby and command line openssl interoperable\">stackoverflow.com/questions/14602069/&hellip;</a>"}, {"owner": {"reputation": 2647, "user_id": 302274, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b5598a61f85012ea1de2a5c8cee2e6c?s=128&d=identicon&r=PG", "display_name": "analyticsPierce", "link": "https://stackoverflow.com/users/302274/analyticspierce"}, "reply_to_user": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441202294, "post_id": 32346466, "comment_id": 52583353, "body": "@MarcoSandrini my question is similar to that question. however, the solution given was to change the openssl command which I stated I cannot do. I can only modify the Ruby method."}, {"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441206589, "post_id": 32346466, "comment_id": 52586564, "body": "Then you should change your code so that it would use the same derivation algorithms that the command-line version of openssl uses to derivate key and IV from the passphrase. But quoting the answer of question <a href=\"http://security.stackexchange.com/questions/29106/openssl-recover-key-and-iv-by-passphrase\" title=\"openssl recover key and iv by passphrase\">security.stackexchange.com/questions/29106/&hellip;</a>  &quot;uses a custom key derivation function with some repeated hashing. This is a non-standard and not-well vetted construct (!) which relies on the MD5 hash function of dubious reputation (!!);&quot;"}, {"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441206747, "post_id": 32346466, "comment_id": 52586717, "body": "Given the info in the answer quoted in my previous comment, I would start thinking about alternative routes, like wrapping an invocation to the openssl command line tool into a system/exec/spawn call"}, {"owner": {"reputation": 2647, "user_id": 302274, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b5598a61f85012ea1de2a5c8cee2e6c?s=128&d=identicon&r=PG", "display_name": "analyticsPierce", "link": "https://stackoverflow.com/users/302274/analyticspierce"}, "reply_to_user": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441207344, "post_id": 32346466, "comment_id": 52587155, "body": "@MarcoSandrini calling openssl from system or exec or open3 only accepts input from keyboard or tty. It does not accept stdin for providing the key."}, {"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441217387, "post_id": 32346466, "comment_id": 52593274, "body": "looking at the OpenSSL manual, as one of the options for the pass phrase arguments it specifies <code>-pass stdin</code>.  If that doesn&#39;t work, I would try with <code>-pass file:my_named_pipe</code> and use a named pipe."}], "answers": [{"tags": [], "owner": {"reputation": 2647, "user_id": 302274, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b5598a61f85012ea1de2a5c8cee2e6c?s=128&d=identicon&r=PG", "display_name": "analyticsPierce", "link": "https://stackoverflow.com/users/302274/analyticspierce"}, "is_accepted": false, "score": 0, "last_activity_date": 1441345242, "creation_date": 1441345242, "answer_id": 32390831, "question_id": 32346466, "link": "https://stackoverflow.com/questions/32346466/encrypt-file-with-ruby-openssl-and-decrypt-with-command-line/32390831#32390831", "title": "Encrypt file with Ruby OpenSSL and decrypt with command line", "body": "<p>I got this to work though not using the Ruby OpenSSL implementation (which I would prefer). If you use the -k flag you can specify a password as the next argument then you don't need to pass anything and can use system to call it. </p>\n\n<pre><code>  system(\"openssl aes-256-cbc -k '#{key}' -in file.zip -out file.enc\")\n</code></pre>\n\n<p>If anyone has an approach using the Ruby OpenSSL implementation I would appreciate it. </p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 5127027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ae718ad6beb50838d03725fdec3cd6f?s=128&d=identicon&r=PG", "display_name": "Sumit Maheshwari", "link": "https://stackoverflow.com/users/5127027/sumit-maheshwari"}, "is_accepted": false, "score": 2, "last_activity_date": 1451400135, "creation_date": 1451400135, "answer_id": 34513316, "question_id": 32346466, "link": "https://stackoverflow.com/questions/32346466/encrypt-file-with-ruby-openssl-and-decrypt-with-command-line/34513316#34513316", "title": "Encrypt file with Ruby OpenSSL and decrypt with command line", "body": "<p>With the help of a similar question in stackoverflow, Im able to achieve it in ruby. </p>\n\n<p>First u've to add an <code>iv</code> thing into ur cipher object, like this</p>\n\n<pre><code>cipher = OpenSSL::Cipher.new('aes-256-cbc')\ncipher.encrypt\ncipher.iv = \"0\"*16\ncipher.key = \"somelongkeystring\"\n</code></pre>\n\n<p>While decryption u've to pass <code>-K</code> and <code>-iv</code> values</p>\n\n<pre><code>openssl aes-256-cbc -d -in file.enc -out file.zip -K &lt;key_hex_code&gt; -iv &lt;iv_hex_code&gt;\n</code></pre>\n\n<p>U can generate <code>hex</code> codes in ruby like this <code>\"string\".unpack('H*')</code>. There must be some way to generate hex codes in cli as well. </p>\n"}, {"tags": [], "owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "is_accepted": false, "score": 1, "last_activity_date": 1513099262, "creation_date": 1513099262, "answer_id": 47778187, "question_id": 32346466, "link": "https://stackoverflow.com/questions/32346466/encrypt-file-with-ruby-openssl-and-decrypt-with-command-line/47778187#47778187", "title": "Encrypt file with Ruby OpenSSL and decrypt with command line", "body": "<p>A solution based on Sumit's answer: </p>\n\n<pre><code>require 'openssl'\n\nclass Crypto\n  def initialize(key, iv, data, cipher='aes-256-cbc')\n    @key = key \n    @iv = iv\n    @cipher = cipher\n    @data = data\n  end \n\n  def encrypt\n    c = OpenSSL::Cipher.new(@cipher).encrypt\n    c.iv = @iv \n    c.key = @key\n    c.update(@data) + c.final    \n  end \n\n  def decrypt\n    c = OpenSSL::Cipher.new(@cipher).decrypt\n    c.iv = @iv \n    c.key = @key\n    c.update(@data) + c.final    \n  end \nend\n\niv = '0'*16\nkey = '1'*32\nmessage = 'My Message' \nencrypted = Crypto.new(key,iv,message).encrypt\nputs Crypto.new(key,iv,encrypted).decrypt\nputs `echo -n '#{encrypted}' | openssl aes-256-cbc -d -K #{key.unpack('H*').first} -iv #{iv.unpack('H*').first}`\n# My Message\n# My Message\n</code></pre>\n\n<p>This solutions works for strings, can easily be adapted to files.</p>\n"}], "owner": {"reputation": 2647, "user_id": 302274, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b5598a61f85012ea1de2a5c8cee2e6c?s=128&d=identicon&r=PG", "display_name": "analyticsPierce", "link": "https://stackoverflow.com/users/302274/analyticspierce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2326, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1513099262, "creation_date": 1441177127, "question_id": 32346466, "link": "https://stackoverflow.com/questions/32346466/encrypt-file-with-ruby-openssl-and-decrypt-with-command-line", "title": "Encrypt file with Ruby OpenSSL and decrypt with command line", "body": "<p>I am automating an OpenSSL file encryption process using Ruby. The files encrypted this way need to be able to be decrypted using OpenSSL on linux command line.</p>\n\n<p>I can encrypt the file using the following Ruby method:</p>\n\n<pre><code>  def encrypt_file\n    cipher = OpenSSL::Cipher.new('aes-256-cbc')\n    cipher.encrypt\n    cipher.key = \"somelongkeystring\"\n\n    buf = \"\"\n    File.open(\"file.enc\", \"wb\") do |outf|\n      File.open(\"file.zip\", \"rb\") do |inf|\n\n        while inf.read(4096, buf)\n          outf &lt;&lt; cipher.update(buf)\n        end\n        outf &lt;&lt; cipher.final\n      end\n    end\n  end\n</code></pre>\n\n<p>I need to be able to decrypt the file (file.enc) using the following command:</p>\n\n<pre><code>$ openssl aes-256-cbc -d -in file.enc -out file.zip\n</code></pre>\n\n<p>However, when I run this I get an error for <code>bad magic number</code> after I type the key from above.</p>\n\n<p>Since I cannot change the decrypt approach (meaning it uses only a password and is entered on linux command line) how can I change my Ruby method to encrypt the file so it can be decrypted this way?  </p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 205376, "user_id": 13, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1XtZi.jpg?s=128&g=1", "display_name": "Chris Jester-Young", "link": "https://stackoverflow.com/users/13/chris-jester-young"}, "edited": false, "score": 0, "creation_date": 1441171570, "post_id": 32345194, "comment_id": 52564366, "body": "It is more idiomatic to write <code>a.inject(:+)</code>, however (or <code>a.inject(&amp;:+)</code> if you&#39;re really attached to passing in a proc)."}, {"owner": {"reputation": 149047, "user_id": 762073, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7fb6b9bc012cd839a99ba778c722c5a7?s=128&d=identicon&r=PG", "display_name": "xdazz", "link": "https://stackoverflow.com/users/762073/xdazz"}, "reply_to_user": {"reputation": 205376, "user_id": 13, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1XtZi.jpg?s=128&g=1", "display_name": "Chris Jester-Young", "link": "https://stackoverflow.com/users/13/chris-jester-young"}, "edited": false, "score": 0, "creation_date": 1441171651, "post_id": 32345194, "comment_id": 52564395, "body": "@ChrisJester-Young Yep, add to the answer."}], "tags": [], "owner": {"reputation": 149047, "user_id": 762073, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7fb6b9bc012cd839a99ba778c722c5a7?s=128&d=identicon&r=PG", "display_name": "xdazz", "link": "https://stackoverflow.com/users/762073/xdazz"}, "is_accepted": false, "score": 5, "last_activity_date": 1441172146, "last_edit_date": 1441172146, "creation_date": 1441171485, "answer_id": 32345194, "question_id": 32345067, "link": "https://stackoverflow.com/questions/32345067/why-cant-i-use-a-b-instead-of-a-b-in-arr-map-a-b-b-nil-a-b/32345194#32345194", "title": "Why can&#39;t I use |a,b| instead of |(a,b)| in arr.map { |(a, b)| !b.nil? ? a + b : a }?", "body": "<p>You could use <code>|a,b|</code> too, it's nothing different from <code>|(a,b)|</code>.</p>\n\n<p>You may also rewrite the code as below, which doesn't have the element number limit for the sub arrays:</p>\n\n<pre><code> arr.map { |a| a.inject{ |sum,x| sum + x } }\n</code></pre>\n\n<p>or even:</p>\n\n<pre><code>arr.map { |a| a.inject(:+) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 2, "last_activity_date": 1441186982, "creation_date": 1441186982, "answer_id": 32349782, "question_id": 32345067, "link": "https://stackoverflow.com/questions/32345067/why-cant-i-use-a-b-instead-of-a-b-in-arr-map-a-b-b-nil-a-b/32349782#32349782", "title": "Why can&#39;t I use |a,b| instead of |(a,b)| in arr.map { |(a, b)| !b.nil? ? a + b : a }?", "body": "<p>Both are equivalent if <code>arr</code> is an array:</p>\n\n<pre><code>arr = [[1, 2], [4, 5]]\narr.map { |a, b| [a, b] }   #=&gt; [[1, 2], [4, 5]]\narr.map { |(a, b)| [a, b] } #=&gt; [[1, 2], [4, 5]]\n</code></pre>\n\n<p>This is because the block is called with a single argument at a time: the subarray. Something like:</p>\n\n<pre><code>yield [1, 2]\nyield [4, 5]\n</code></pre>\n\n<p>This changes if more than one arguments is yielded. <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-each_with_index\" rel=\"nofollow\"><code>each_with_index</code></a> for example, calls the block with two arguments: the item (i.e. the subarray) and its index. Something like:</p>\n\n<pre><code>yield [1, 2], 0\nyield [4, 5], 1\n</code></pre>\n\n<p>The difference is obvious:</p>\n\n<pre><code>enum = [[1, 2], [4, 5]].each_with_index\nenum.map { |a, b| [a, b] }   #=&gt; [[[1, 2], 0], [[4, 5], 1]]\nenum.map { |(a, b)| [a, b] } #=&gt; [[1, 2], [4, 5]]\n</code></pre>\n\n<p>Note that omitting parenthesis also allows you to set a default argument value:</p>\n\n<pre><code>arr = [[1, 2], [4]]\narr.map { |a, b = 0| a + b } #=&gt; [3, 4]\n</code></pre>\n"}], "owner": {"reputation": 2564, "user_id": 4134881, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/797360342295a3f637a9c4d71d40d113?s=128&d=identicon&r=PG&f=1", "display_name": "evianpring", "link": "https://stackoverflow.com/users/4134881/evianpring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 32349782, "answer_count": 2, "score": 1, "last_activity_date": 1441186982, "creation_date": 1441170801, "last_edit_date": 1441171173, "question_id": 32345067, "link": "https://stackoverflow.com/questions/32345067/why-cant-i-use-a-b-instead-of-a-b-in-arr-map-a-b-b-nil-a-b", "title": "Why can&#39;t I use |a,b| instead of |(a,b)| in arr.map { |(a, b)| !b.nil? ? a + b : a }?", "body": "<p>In the code below, arr is meant to be a two-dimensional array, such as <code>[[1,2],[4,5]]</code>. It computes the sum of the elements of the sub arrays. A subarray can have only one element, in which case the sum is just that one element.     </p>\n\n<pre><code>def compute(arr)\n  return nil unless arr\n  arr.map { |(a, b)| !b.nil? ? a + b : a }\nend\n</code></pre>\n\n<p>Why does the code have to be <code>|(a, b)|</code> instead of <code>|a,b|</code>?\nWhat does <code>(a,b)</code> mean in Ruby? </p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "edited": false, "score": 0, "creation_date": 1441170455, "post_id": 32344983, "comment_id": 52563959, "body": "I&#39;d prefer to see an answer explaining what global variables are, why they would solve this problem, but what other better solutions there are instead."}, {"owner": {"reputation": 23808, "user_id": 2382734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d80069e46785505b443aa9d1dd9eb3a3?s=128&d=identicon&r=PG", "display_name": "Renzo", "link": "https://stackoverflow.com/users/2382734/renzo"}, "reply_to_user": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "edited": false, "score": 0, "creation_date": 1441170521, "post_id": 32344983, "comment_id": 52563981, "body": "I&#39;ll update the answer."}, {"owner": {"reputation": 179, "user_id": 5115752, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/7tls6.jpg?s=128&g=1", "display_name": "Jacob Crofts", "link": "https://stackoverflow.com/users/5115752/jacob-crofts"}, "edited": false, "score": 0, "creation_date": 1441171638, "post_id": 32344983, "comment_id": 52564392, "body": "I haven&#39;t covered the different kinds of variables, but I&#39;m used to chucking them in methods and iterating over them without having to specify what sort of variables they are. Are arrays treated differently (for example, are they by default assigned a more localized variable tier than strings, booleans, etc?)"}, {"owner": {"reputation": 23808, "user_id": 2382734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d80069e46785505b443aa9d1dd9eb3a3?s=128&d=identicon&r=PG", "display_name": "Renzo", "link": "https://stackoverflow.com/users/2382734/renzo"}, "edited": false, "score": 0, "creation_date": 1441171837, "post_id": 32344983, "comment_id": 52564473, "body": "Variable names are not related to their type. Arrays, strings, booleans, etc. are all objects and are all treated in the same way from this respect. What change is the way in which they are named, to denote either a different scope, or a different kind of use. For instance class attribute names start with <code>@</code>, class and module names start with a capital letter, etc."}, {"owner": {"reputation": 179, "user_id": 5115752, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/7tls6.jpg?s=128&g=1", "display_name": "Jacob Crofts", "link": "https://stackoverflow.com/users/5115752/jacob-crofts"}, "edited": false, "score": 0, "creation_date": 1441172446, "post_id": 32344983, "comment_id": 52564688, "body": "all right, thank you for your help!"}], "tags": [], "owner": {"reputation": 23808, "user_id": 2382734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d80069e46785505b443aa9d1dd9eb3a3?s=128&d=identicon&r=PG", "display_name": "Renzo", "link": "https://stackoverflow.com/users/2382734/renzo"}, "is_accepted": true, "score": 2, "last_activity_date": 1441172310, "last_edit_date": 1441172310, "creation_date": 1441170324, "answer_id": 32344983, "question_id": 32344905, "link": "https://stackoverflow.com/questions/32344905/getting-a-nameerror-in-very-simple-ruby-code/32344983#32344983", "title": "Getting a NameError in very simple Ruby code", "body": "<p>Global variables in Ruby are distinguished from every other program name (like regular variables, class names, methods names, module names, etc.) by an initial <code>$</code>, so you should change your program in this way:</p>\n\n<pre><code>$pentagonals = []\n\ndef pent?(num)\n  $pentagonals.include?(num)\nend\n\n(1..1000).each {|i|\n  $pentagonals &lt;&lt; (i * (3 * i - 1) / 2)\n  }\n\nputs pent?(1)\n</code></pre>\n\n<p>Note that global variables should be used sparingly, in fact they are dangerous because they can be written to from anywhere in your program.</p>\n"}, {"tags": [], "owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "is_accepted": false, "score": 0, "last_activity_date": 1441172992, "creation_date": 1441172992, "answer_id": 32345486, "question_id": 32344905, "link": "https://stackoverflow.com/questions/32344905/getting-a-nameerror-in-very-simple-ruby-code/32345486#32345486", "title": "Getting a NameError in very simple Ruby code", "body": "<p>Variables in a method are local to the method scope, unless they are passed in as parameters. </p>\n\n<p>The method can also access global, class variables and other methods in the same scope. </p>\n\n<pre><code>class MyClass\n\n  # calling methods in the same class\n  def method1\n    method2\n  end \n\n  def method2\n    puts 'method2 was called'\n  end\n\n  # getter / setter method pair for class variables\n  # @class_variable is only accessible within this class\n  def print_class_variable\n    puts @class_variable\n  end\n\n  def set_class_variable(param)\n    @class_variable = param\n  end\n\n  # global variables can be accessed from anywhere\n  def print_global_var \n    puts $global_variable \n  end\n\n  def self.some_class_method\n    # cannot be directly accessed by the instance methods above \n  end\nend\n</code></pre>\n\n<p>Note that global variables are not recommended as they can easily result in conflicts and ambiguity.</p>\n\n<pre><code>class Dog\n  $name = \"Dog\" \nend\n\nclass Cat\n  $name = \"Cat\"\nend\n\nputs $name\n# which one does $name refer to? \n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 5115752, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/7tls6.jpg?s=128&g=1", "display_name": "Jacob Crofts", "link": "https://stackoverflow.com/users/5115752/jacob-crofts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1441180349, "accepted_answer_id": 32344983, "answer_count": 2, "score": 0, "last_activity_date": 1441172992, "creation_date": 1441169881, "question_id": 32344905, "link": "https://stackoverflow.com/questions/32344905/getting-a-nameerror-in-very-simple-ruby-code", "closed_reason": "Duplicate", "title": "Getting a NameError in very simple Ruby code", "body": "<p>I'm getting a NameError, which supposedly indicates that my array \"pentagonals\" is undefined. But I'm a monkey's uncle if I didn't define it in line 1. What am I forgetting/misunderstanding? The goal is to write a method that tells me whether a given number is pentagonal.</p>\n\n<pre><code>pentagonals = []\n\ndef pent?(num)\n  pentagonals.include?(num)\nend\n\n(1..1000).each {|i|\n  pentagonals &lt;&lt; (i * (3 * i - 1) / 2)\n  }\n\nputs pent?(1)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "heroku", "foreman"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5290921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cd612055f253a04697f64263105662?s=128&d=identicon&r=PG&f=1", "display_name": "M Jomaa", "link": "https://stackoverflow.com/users/5290921/m-jomaa"}, "edited": false, "score": 0, "creation_date": 1441170831, "post_id": 32344815, "comment_id": 52564082, "body": "Thank you so much Rokibul! That was it! Sometimes we&#39;re looking for the complicated and completely forget to try the easy! Thank you again!"}], "tags": [], "owner": {"reputation": 3724, "user_id": 2409515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a33T6.jpg?s=128&g=1", "display_name": "Rokibul Hasan", "link": "https://stackoverflow.com/users/2409515/rokibul-hasan"}, "is_accepted": true, "score": 1, "last_activity_date": 1441169371, "creation_date": 1441169371, "answer_id": 32344815, "question_id": 32344790, "link": "https://stackoverflow.com/questions/32344790/prelaunchr-app-deploys-through-foreman-in-development-but-doesnt-work-when-depl/32344815#32344815", "title": "Prelaunchr App deploys through foreman in development but doesn&#39;t work when deployed to heroku", "body": "<p>Seems you did not run database migration, Can you please try after running migration </p>\n\n<pre><code>heroku run rake db:migrate\n</code></pre>\n\n<p>You may need to restart heroku server.</p>\n"}], "owner": {"reputation": 3, "user_id": 5290921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cd612055f253a04697f64263105662?s=128&d=identicon&r=PG&f=1", "display_name": "M Jomaa", "link": "https://stackoverflow.com/users/5290921/m-jomaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 32344815, "answer_count": 1, "score": 0, "last_activity_date": 1441171023, "creation_date": 1441169215, "last_edit_date": 1441171023, "question_id": 32344790, "link": "https://stackoverflow.com/questions/32344790/prelaunchr-app-deploys-through-foreman-in-development-but-doesnt-work-when-depl", "title": "Prelaunchr App deploys through foreman in development but doesn&#39;t work when deployed to heroku", "body": "<p>I cloned the updated Harry's prelaunchr site from wardpenney,who thankfully updated it to rails 4.2 and ruby 2.2.0.</p>\n\n<p><a href=\"https://github.com/wardpenney/prelaunchr/tree/master\" rel=\"nofollow\">https://github.com/wardpenney/prelaunchr/tree/master</a></p>\n\n<p>I have made no changes, just wanted to see if it works and when i start up foreman, the site is up and running with no issues.</p>\n\n<p>However, when I deployed it to Heroku, I got </p>\n\n<blockquote>\n  <p>We're sorry, but something went wrong.</p>\n</blockquote>\n\n<p>I have been trying to rack my brains around what the issue might but just can't make any sense of the log files.</p>\n\n<p>Just a note, I have been developing this app through cloud9 IDE because windows does not have a reliable way to install Rails 4.2 and ruby 2.2.0.</p>\n\n<p>Thanks for reading and appreciate any help you can give me!</p>\n\n<pre><code>2015-09-02T04:11:26.451915+00:00 app[web.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod\n2015-09-02T04:11:26.451917+00:00 app[web.1]:                 FROM pg_attribute a LEFT JOIN pg_attrdef d\n2015-09-02T04:11:26.451918+00:00 app[web.1]:                   ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n2015-09-02T04:11:26.451920+00:00 app[web.1]:                WHERE a.attrelid = '\"users\"'::regclass\n2015-09-02T04:11:26.451921+00:00 app[web.1]:                  AND a.attnum &gt; 0 AND NOT a.attisdropped\n2015-09-02T04:11:26.451922+00:00 app[web.1]:                ORDER BY a.attnum\n2015-09-02T04:11:26.451924+00:00 app[web.1]: \n2015-09-02T04:11:26.452726+00:00 app[web.1]: Completed 500 Internal Server Error in 25ms\n2015-09-02T04:11:26.456354+00:00 heroku[router]: at=info method=GET path=\"/\" host=assistprelaunchr.herokuapp.com request_id=5c2f9062-9685-48ca-98f4-6c069e74f479 fwd=\"94.205.135.161\" dyno=web.1 connect=1ms service=118ms status=500 bytes=906\n2015-09-02T04:11:26.427369+00:00 app[web.1]: Processing by UsersController#new as HTML\n2015-09-02T04:11:26.455914+00:00 app[web.1]: \n2015-09-02T04:11:26.455918+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::UndefinedTable: ERROR:  relation \"users\" does not exist\n2015-09-02T04:11:26.455921+00:00 app[web.1]:                                           ^\n2015-09-02T04:11:26.455920+00:00 app[web.1]: LINE 5:                WHERE a.attrelid = '\"users\"'::regclass\n2015-09-02T04:11:26.455923+00:00 app[web.1]: :               SELECT a.attname, format_type(a.atttypid, a.atttypmod),\n2015-09-02T04:11:26.455929+00:00 app[web.1]:                WHERE a.attrelid = '\"users\"'::regclass\n2015-09-02T04:11:26.455930+00:00 app[web.1]:                  AND a.attnum &gt; 0 AND NOT a.attisdropped\n2015-09-02T04:11:26.455933+00:00 app[web.1]: ):\n2015-09-02T04:11:26.455925+00:00 app[web.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod\n2015-09-02T04:11:26.455927+00:00 app[web.1]:                   ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n2015-09-02T04:11:26.455932+00:00 app[web.1]:                ORDER BY a.attnum\n2015-09-02T04:11:26.455935+00:00 app[web.1]:   app/controllers/users_controller.rb:8:in `new'\n2015-09-02T04:11:26.455926+00:00 app[web.1]:                 FROM pg_attribute a LEFT JOIN pg_attrdef d\n2015-09-02T04:11:26.455937+00:00 app[web.1]: \n2015-09-02T04:11:26.455936+00:00 app[web.1]: \n2015-09-02T04:11:26.549241+00:00 heroku[mailcatcher.1]: Starting process with command `mailcatcher -f`\n2015-09-02T04:11:27.228922+00:00 heroku[mailcatcher.1]: State changed from starting to up\n2015-09-02T04:11:27.895004+00:00 app[mailcatcher.1]: bash: mailcatcher: command not found\n2015-09-02T04:11:28.554909+00:00 heroku[mailcatcher.1]: Process exited with status 127\n2015-09-02T04:11:28.565470+00:00 heroku[mailcatcher.1]: State changed from up to crashed\n2015-09-02T04:19:32.033503+00:00 heroku[api]: Deploy fffb014 by mjomaa@gmail.com\n2015-09-02T04:19:32.033646+00:00 heroku[api]: Release v7 created by mjomaa@gmail.com\n2015-09-02T04:19:32.097747+00:00 heroku[slug-compiler]: Slug compilation started\n2015-09-02T04:19:32.097769+00:00 heroku[slug-compiler]: Slug compilation finished\n2015-09-02T04:19:32.592055+00:00 heroku[mailcatcher.1]: State changed from crashed to starting\n2015-09-02T04:19:33.016644+00:00 heroku[web.1]: State changed from up to starting\n2015-09-02T04:19:35.832157+00:00 heroku[web.1]: Stopping all processes with SIGTERM\n2015-09-02T04:19:36.272334+00:00 app[web.1]: Unicorn worker intercepting TERM and doing nothing. Wait for master to sent QUIT\n2015-09-02T04:19:36.272338+00:00 app[web.1]: Unicorn worker intercepting TERM and doing nothing. Wait for master to sent QUIT\n2015-09-02T04:19:36.278650+00:00 app[web.1]: Unicorn master intercepting TERM and sending myself QUIT instead\n2015-09-02T04:19:36.282717+00:00 app[web.1]: Unicorn worker intercepting TERM and doing nothing. Wait for master to sent QUIT\n2015-09-02T04:19:36.878952+00:00 app[web.1]: I, [2015-09-02T04:19:36.878786 #3]  INFO -- : reaped #&lt;Process::Status: pid 9 exit 0&gt; worker=1\n2015-09-02T04:19:36.879464+00:00 app[web.1]: I, [2015-09-02T04:19:36.879327 #3]  INFO -- : master complete\n2015-09-02T04:19:36.878666+00:00 app[web.1]: I, [2015-09-02T04:19:36.878497 #3]  INFO -- : reaped #&lt;Process::Status: pid 6 exit 0&gt; worker=0\n2015-09-02T04:19:36.879214+00:00 app[web.1]: I, [2015-09-02T04:19:36.879161 #3]  INFO -- : reaped #&lt;Process::Status: pid 12 exit 0&gt; worker=2\n2015-09-02T04:19:37.906516+00:00 heroku[web.1]: Process exited with status 0\n2015-09-02T04:19:41.102811+00:00 heroku[mailcatcher.1]: Starting process with command `mailcatcher -f`\n2015-09-02T04:19:41.709173+00:00 heroku[mailcatcher.1]: State changed from starting to up\n2015-09-02T04:19:43.093473+00:00 heroku[mailcatcher.1]: Process exited with status 127\n2015-09-02T04:19:43.101552+00:00 heroku[mailcatcher.1]: State changed from up to crashed\n2015-09-02T04:19:42.349322+00:00 app[mailcatcher.1]: bash: mailcatcher: command not found\n2015-09-02T04:19:46.299263+00:00 heroku[web.1]: Starting process with command `bundle exec unicorn -p 6500`\n2015-09-02T04:19:48.782583+00:00 heroku[web.1]: State changed from starting to up\n2015-09-02T04:19:48.554040+00:00 app[web.1]: I, [2015-09-02T04:19:48.553900 #3]  INFO -- : listening on addr=0.0.0.0:6500 fd=9\n2015-09-02T04:19:48.554135+00:00 app[web.1]: I, [2015-09-02T04:19:48.554081 #3]  INFO -- : worker=0 spawning...\n2015-09-02T04:19:48.561161+00:00 app[web.1]: I, [2015-09-02T04:19:48.560987 #3]  INFO -- : master process ready\n2015-09-02T04:19:48.563933+00:00 app[web.1]: I, [2015-09-02T04:19:48.563501 #6]  INFO -- : worker=0 spawned pid=6\n2015-09-02T04:19:48.564057+00:00 app[web.1]: I, [2015-09-02T04:19:48.564006 #6]  INFO -- : Refreshing Gem list\n2015-09-02T04:19:50.403037+00:00 app[web.1]: DEPRECATION WARNING: You did not specify a `log_level` in `production.rb`. Currently, the default value for `log_level` is `:info` for the production environment and `:debug` in all other environments. In Rails 5 the default value will be unified to `:debug` across all environments. To preserve the current setting, add the following line to your `production.rb`:\n2015-09-02T04:19:50.403045+00:00 app[web.1]: \n2015-09-02T04:19:50.403047+00:00 app[web.1]:    config.log_level = :info\n2015-09-02T04:19:50.403048+00:00 app[web.1]: \n2015-09-02T04:19:50.403050+00:00 app[web.1]: . (called from block in tsort_each at /app/vendor/ruby-2.2.0/lib/ruby/2.2.0/tsort.rb:226)\n2015-09-02T04:19:51.228920+00:00 heroku[router]: at=info method=GET path=\"/\" host=assistprelaunchr.herokuapp.com request_id=e80ef01e-1e33-4ea0-86ed-39c29b2263fe fwd=\"94.205.135.161\" dyno=web.1 connect=1ms service=742ms status=500 bytes=906\n2015-09-02T04:19:51.153047+00:00 app[web.1]: Started GET \"/\" for 94.205.135.161 at 2015-09-02 04:19:51 +0000\n2015-09-02T04:19:51.217703+00:00 app[web.1]: LINE 5:                WHERE a.attrelid = '\"users\"'::regclass\n2015-09-02T04:19:51.217700+00:00 app[web.1]: PG::UndefinedTable: ERROR:  relation \"users\" does not exist\n2015-09-02T04:19:51.217705+00:00 app[web.1]:                                           ^\n2015-09-02T04:19:51.217707+00:00 app[web.1]: :               SELECT a.attname, format_type(a.atttypid, a.atttypmod),\n2015-09-02T04:19:51.217708+00:00 app[web.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod\n2015-09-02T04:19:51.217710+00:00 app[web.1]:                 FROM pg_attribute a LEFT JOIN pg_attrdef d\n2015-09-02T04:19:51.217711+00:00 app[web.1]:                   ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n2015-09-02T04:19:51.217713+00:00 app[web.1]:                WHERE a.attrelid = '\"users\"'::regclass\n2015-09-02T04:19:51.217716+00:00 app[web.1]:                ORDER BY a.attnum\n2015-09-02T04:19:51.217714+00:00 app[web.1]:                  AND a.attnum &gt; 0 AND NOT a.attisdropped\n2015-09-02T04:19:51.217717+00:00 app[web.1]: \n2015-09-02T04:19:51.217946+00:00 app[web.1]: Completed 500 Internal Server Error in 12ms\n2015-09-02T04:19:51.219073+00:00 app[web.1]: \n2015-09-02T04:19:51.219075+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::UndefinedTable: ERROR:  relation \"users\" does not exist\n2015-09-02T04:19:51.219077+00:00 app[web.1]: LINE 5:                WHERE a.attrelid = '\"users\"'::regclass\n2015-09-02T04:19:51.219078+00:00 app[web.1]:                                           ^\n2015-09-02T04:19:51.219080+00:00 app[web.1]: :               SELECT a.attname, format_type(a.atttypid, a.atttypmod),\n2015-09-02T04:19:51.219081+00:00 app[web.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod\n2015-09-02T04:19:51.219084+00:00 app[web.1]:                   ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n2015-09-02T04:19:51.219085+00:00 app[web.1]:                WHERE a.attrelid = '\"users\"'::regclass\n2015-09-02T04:19:51.219082+00:00 app[web.1]:                 FROM pg_attribute a LEFT JOIN pg_attrdef d\n2015-09-02T04:19:51.219089+00:00 app[web.1]: ):\n2015-09-02T04:19:51.219088+00:00 app[web.1]:                ORDER BY a.attnum\n2015-09-02T04:19:51.219087+00:00 app[web.1]:                  AND a.attnum &gt; 0 AND NOT a.attisdropped\n2015-09-02T04:19:51.219091+00:00 app[web.1]:   app/controllers/users_controller.rb:8:in `new'\n2015-09-02T04:19:51.219092+00:00 app[web.1]: \n2015-09-02T04:19:51.219093+00:00 app[web.1]: \n2015-09-02T04:19:51.150682+00:00 app[web.1]: I, [2015-09-02T04:19:51.150568 #6]  INFO -- : worker=0 ready\n2015-09-02T04:19:51.205884+00:00 app[web.1]: Processing by UsersController#new as HTML\n2015-09-02T04:19:51.703515+00:00 heroku[router]: at=info method=GET path=\"/favicon.ico\" host=assistprelaunchr.herokuapp.com request_id=1882ea9d-3791-4fb3-9641-cb45fb182083 fwd=\"94.205.135.161\" dyno=web.1 connect=0ms service=2ms status=200 bytes=1367\n2015-09-02T04:23:26.650172+00:00 heroku[mailcatcher.1]: State changed from crashed to starting\n2015-09-02T04:23:41.362840+00:00 heroku[mailcatcher.1]: Starting process with command `mailcatcher -f`\n2015-09-02T04:23:42.043598+00:00 heroku[mailcatcher.1]: State changed from starting to up\n2015-09-02T04:23:43.422698+00:00 app[mailcatcher.1]: bash: mailcatcher: command not found\n2015-09-02T04:23:44.388696+00:00 heroku[mailcatcher.1]: State changed from up to crashed\n2015-09-02T04:23:44.368015+00:00 heroku[mailcatcher.1]: Process exited with status 127\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Migration in Heroku and then restarted the server solving the issue!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "ruby-on-rails-4", "ruby-2.0"], "comments": [{"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441168689, "post_id": 32344645, "comment_id": 52563455, "body": "Try adding <code>:format =&gt; :csv</code> to your <code>link_to</code>"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 1385816, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7cbb70367b2acec0236ff6d2733dac5a?s=128&d=identicon&r=PG", "display_name": "user1385816", "link": "https://stackoverflow.com/users/1385816/user1385816"}, "edited": false, "score": 0, "creation_date": 1441214289, "post_id": 32344740, "comment_id": 52591553, "body": "Your suggestion seems to be making it better but then I got an error like this:  <code>NoMethodError (undefined method &#39;to_csv&#39; for #&lt;String:0x0000000a57c1c8&gt;):</code> I think there might be something wrong with my model"}, {"owner": {"reputation": 3724, "user_id": 2409515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a33T6.jpg?s=128&g=1", "display_name": "Rokibul Hasan", "link": "https://stackoverflow.com/users/2409515/rokibul-hasan"}, "reply_to_user": {"reputation": 89, "user_id": 1385816, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7cbb70367b2acec0236ff6d2733dac5a?s=128&d=identicon&r=PG", "display_name": "user1385816", "link": "https://stackoverflow.com/users/1385816/user1385816"}, "edited": false, "score": 1, "creation_date": 1441215995, "post_id": 32344740, "comment_id": 52592485, "body": "I did not found any method like <code>to_csv</code> in your code, you can trace details form log. But I think no need to use <code>as_csv</code> called in your controller action, You can get <code>csv</code> only using <code>send_data @output</code>, because <code>@output</code> already hold <code>csv</code> data for you."}, {"owner": {"reputation": 89, "user_id": 1385816, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7cbb70367b2acec0236ff6d2733dac5a?s=128&d=identicon&r=PG", "display_name": "user1385816", "link": "https://stackoverflow.com/users/1385816/user1385816"}, "edited": false, "score": 0, "creation_date": 1441216238, "post_id": 32344740, "comment_id": 52592630, "body": "Ah yes, I changed <code>as_csv</code> into <code>to_csv</code> to see if that worked. But I took your suggestion just to remove it and it worked, thanks!"}, {"owner": {"reputation": 3724, "user_id": 2409515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a33T6.jpg?s=128&g=1", "display_name": "Rokibul Hasan", "link": "https://stackoverflow.com/users/2409515/rokibul-hasan"}, "reply_to_user": {"reputation": 89, "user_id": 1385816, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7cbb70367b2acec0236ff6d2733dac5a?s=128&d=identicon&r=PG", "display_name": "user1385816", "link": "https://stackoverflow.com/users/1385816/user1385816"}, "edited": false, "score": 0, "creation_date": 1441216702, "post_id": 32344740, "comment_id": 52592923, "body": "Welcome @user1385816 :)"}], "tags": [], "owner": {"reputation": 3724, "user_id": 2409515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a33T6.jpg?s=128&g=1", "display_name": "Rokibul Hasan", "link": "https://stackoverflow.com/users/2409515/rokibul-hasan"}, "is_accepted": true, "score": 2, "last_activity_date": 1441168896, "creation_date": 1441168896, "answer_id": 32344740, "question_id": 32344645, "link": "https://stackoverflow.com/questions/32344645/rails-exporting-to-csv-failing/32344740#32344740", "title": "Rails: Exporting to CSV failing", "body": "<p>Change your view as following, use your route path for view action, instead of <code>id</code>, pass <code>ids</code> because its collection of ids not single id. </p>\n\n<pre><code>&lt;%= link_to \"Export to CSV\", your_route_path(:format =&gt; :csv, :ids =&gt; @nterm.map {|i| i.id }}) %&gt;\n</code></pre>\n\n<p>And slide changes need to your action as following, for receive <code>ids</code></p>\n\n<pre><code>def show\n @output = Nterm.generate_csv(params[:ids])\n #your codes goes here \nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 148, "user_id": 4016635, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZM1-iWCyRWo/AAAAAAAAAAI/AAAAAAAAAko/k9ZcPD2Ytks/photo.jpg?sz=128", "display_name": "Adem Dinarevi\u0107", "link": "https://stackoverflow.com/users/4016635/adem-dinarevi%c4%87"}, "is_accepted": false, "score": 0, "last_activity_date": 1618869978, "creation_date": 1618869978, "answer_id": 67169918, "question_id": 32344645, "link": "https://stackoverflow.com/questions/32344645/rails-exporting-to-csv-failing/67169918#67169918", "title": "Rails: Exporting to CSV failing", "body": "<p>@rokibul-hasan already answered the question, but I would also suggest for you to make a single query to fetch all the objects:</p>\n<p><code>@objects = Nterm.find(ids)</code></p>\n<p>and to loop through these objects instead of calling <code>.find</code> on each ID because you are hitting the database for each record, which is unnecessary. So something like:</p>\n<pre><code>@objects.each do |object|\n  csv &lt;&lt; [object.externalid, object.pos, ...]\nend\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 1385816, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7cbb70367b2acec0236ff6d2733dac5a?s=128&d=identicon&r=PG", "display_name": "user1385816", "link": "https://stackoverflow.com/users/1385816/user1385816"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "accepted_answer_id": 32344740, "answer_count": 2, "score": 0, "last_activity_date": 1618869978, "creation_date": 1441168020, "question_id": 32344645, "link": "https://stackoverflow.com/questions/32344645/rails-exporting-to-csv-failing", "title": "Rails: Exporting to CSV failing", "body": "<p>I am attempting to export my data to a CSV file. This is my model:   </p>\n\n<pre><code>def self.generate_csv(ids)\n    CSV.generate({:col_sep =&gt; \"\\t\"}) do |csv|\n      csv &lt;&lt; ['topfind terminus id','position','sequence','protein (uniprot ac)','topfind evidence ids']\n      ids.each do |id|\n        n = Nterm.find(id)       \n        csv &lt;&lt; [n.externalid,n.pos,n.protein.sequence[n.pos-1..n.pos+9],n.protein.ac,n.evidences.collect{|e| e.externalid}.join(':')]\n      end\n    end  \n  end \n</code></pre>\n\n<p>And this is the controller for this model that calls this method:</p>\n\n<pre><code>  def show\n     puts \"id search: [#{params[:id]}]\" \n     @output = Nterm.generate_csv(params[:id])\n     respond_to do |format|\n       format.html\n       format.csv { send_data @output.as_csv }\n     end\n     p @output\n  end\n</code></pre>\n\n<p>And this is my view:</p>\n\n<pre><code>&lt;%= link_to \"Export to CSV\", {:method=&gt; \"show\", :id =&gt; @nterm.map {|i| i.id }} %&gt;\n</code></pre>\n\n<p>I'm not quite sure what to put on my show view in this case. How do I produce a CSV?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "nested-forms"], "comments": [{"owner": {"reputation": 1453, "user_id": 3192664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yH1co.jpg?s=128&g=1", "display_name": "Gautam", "link": "https://stackoverflow.com/users/3192664/gautam"}, "edited": false, "score": 0, "creation_date": 1441167939, "post_id": 32344562, "comment_id": 52563271, "body": "In your <code>edit</code> action - 3rd line try <code>@post.create_location</code> instead of <code>@post.build_location</code>"}, {"owner": {"reputation": 87, "user_id": 4314067, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-bDsqcQdnPXM/AAAAAAAAAAI/AAAAAAAAACU/Pu9wIWa5CRg/photo.jpg?sz=128", "display_name": "Florence Liang", "link": "https://stackoverflow.com/users/4314067/florence-liang"}, "reply_to_user": {"reputation": 1453, "user_id": 3192664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yH1co.jpg?s=128&g=1", "display_name": "Gautam", "link": "https://stackoverflow.com/users/3192664/gautam"}, "edited": false, "score": 0, "creation_date": 1441168674, "post_id": 32344562, "comment_id": 52563452, "body": "Tried  @post.create_location but it didn&#39;t work."}, {"owner": {"reputation": 1453, "user_id": 3192664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yH1co.jpg?s=128&g=1", "display_name": "Gautam", "link": "https://stackoverflow.com/users/3192664/gautam"}, "edited": false, "score": 0, "creation_date": 1441169274, "post_id": 32344562, "comment_id": 52563601, "body": "try with a bang and please post the server log after that -&gt; <code>@post.create_location!</code>"}, {"owner": {"reputation": 87, "user_id": 4314067, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-bDsqcQdnPXM/AAAAAAAAAAI/AAAAAAAAACU/Pu9wIWa5CRg/photo.jpg?sz=128", "display_name": "Florence Liang", "link": "https://stackoverflow.com/users/4314067/florence-liang"}, "reply_to_user": {"reputation": 1453, "user_id": 3192664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yH1co.jpg?s=128&g=1", "display_name": "Gautam", "link": "https://stackoverflow.com/users/3192664/gautam"}, "edited": false, "score": 0, "creation_date": 1441172109, "post_id": 32344562, "comment_id": 52564572, "body": "It still has the same log after adding the bang."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 4314067, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-bDsqcQdnPXM/AAAAAAAAAAI/AAAAAAAAACU/Pu9wIWa5CRg/photo.jpg?sz=128", "display_name": "Florence Liang", "link": "https://stackoverflow.com/users/4314067/florence-liang"}, "edited": false, "score": 0, "creation_date": 1441170254, "post_id": 32344844, "comment_id": 52563895, "body": "Thanks! But after I remove @post.build_location, it just takes out the whole location fields when I open the edit page again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5067463"}, "reply_to_user": {"reputation": 87, "user_id": 4314067, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-bDsqcQdnPXM/AAAAAAAAAAI/AAAAAAAAACU/Pu9wIWa5CRg/photo.jpg?sz=128", "display_name": "Florence Liang", "link": "https://stackoverflow.com/users/4314067/florence-liang"}, "edited": false, "score": 0, "creation_date": 1441172761, "post_id": 32344844, "comment_id": 52564794, "body": "That is the expected location as this indicates that the Post doesn&#39;t have a Location. If you want it to show empty fields when there is no location i would if you add the build back in like so <code>@post.build_location if @post.location.nil?</code>"}, {"owner": {"reputation": 87, "user_id": 4314067, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-bDsqcQdnPXM/AAAAAAAAAAI/AAAAAAAAACU/Pu9wIWa5CRg/photo.jpg?sz=128", "display_name": "Florence Liang", "link": "https://stackoverflow.com/users/4314067/florence-liang"}, "edited": false, "score": 0, "creation_date": 1441174558, "post_id": 32344844, "comment_id": 52565518, "body": "Thanks so much! It works with if @post.location.blank? instead of @post.location.nil, though. Thanks for the hint!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5067463"}, "is_accepted": false, "score": 2, "last_activity_date": 1441173415, "last_edit_date": 1441173415, "creation_date": 1441169506, "answer_id": 32344844, "question_id": 32344562, "link": "https://stackoverflow.com/questions/32344562/rails-4-2-nested-forms-sql-automatically-deleted-nested-forms-content-when-load/32344844#32344844", "title": "Rails 4.2 Nested Forms--SQL Automatically Deleted Nested Forms Content When Loading &#39;Edit&#39; Page", "body": "<p><code>@post.build_location</code> creates a new location object in memory, and therefore that is getting passed to the <code>update</code> and therefore deletes locations associated to the post. It doesn't fetch the current location.</p>\n\n<p><code>@post.create_location</code> also creates a new location object but sames this to the database. This is not what you want.</p>\n\n<p><s>I would remove the <code>@post.build_location</code> from the edit action. The view should work as its already looking for the <code>location</code> for the <code>post</code> which is same as doing <code>@post.location</code></s></p>\n\n<p><strong>Edit</strong>\nYou probably want the behavior as below:</p>\n\n<ul>\n<li>If a Post has a Location, show the current Location in the Edit of Post</li>\n<li>If a Post doesn't have a Location, show empty field in the Edit of Post</li>\n</ul>\n\n<p>for this you need to build the Location object in the edit action only when a Post has no Location. </p>\n\n<pre><code> def edit\n    @category = Category.friendly.find(params[:category_id])\n    @post = Post.find(params[:id])\n    @post.build_location if @post.location.nil?\n  end\n</code></pre>\n\n<p>This is what you need in the edit action</p>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 4314067, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-bDsqcQdnPXM/AAAAAAAAAAI/AAAAAAAAACU/Pu9wIWa5CRg/photo.jpg?sz=128", "display_name": "Florence Liang", "link": "https://stackoverflow.com/users/4314067/florence-liang"}, "edited": false, "score": 0, "creation_date": 1441171331, "post_id": 32345065, "comment_id": 52564275, "body": "Thanks for the guide! But can you explain why the example in <a href=\"http://www.amooma.de/screencasts/2015-01-22-nested_forms-rails-4.2/\" rel=\"nofollow noreferrer\">amooma.de/screencasts/2015-01-22-nested_forms-rails-4.2</a> still works (without clearing the old record)  while keeping @hotel.room_categories.build in its edit action?"}, {"owner": {"reputation": 1568, "user_id": 966100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xN0ul.jpg?s=128&g=1", "display_name": "eeeeeean", "link": "https://stackoverflow.com/users/966100/eeeeeean"}, "reply_to_user": {"reputation": 87, "user_id": 4314067, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-bDsqcQdnPXM/AAAAAAAAAAI/AAAAAAAAACU/Pu9wIWa5CRg/photo.jpg?sz=128", "display_name": "Florence Liang", "link": "https://stackoverflow.com/users/4314067/florence-liang"}, "edited": false, "score": 0, "creation_date": 1441172348, "post_id": 32345065, "comment_id": 52564663, "body": "The tutorial is using a has_many association, which allows you to build and save as many &quot;child&quot; objects as you&#39;d like. It&#39;s a particularity of the has_one association that it deletes the old record once you build a new one."}], "tags": [], "owner": {"reputation": 1568, "user_id": 966100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xN0ul.jpg?s=128&g=1", "display_name": "eeeeeean", "link": "https://stackoverflow.com/users/966100/eeeeeean"}, "is_accepted": false, "score": 1, "last_activity_date": 1441172553, "last_edit_date": 1441172553, "creation_date": 1441170797, "answer_id": 32345065, "question_id": 32344562, "link": "https://stackoverflow.com/questions/32344562/rails-4-2-nested-forms-sql-automatically-deleted-nested-forms-content-when-load/32345065#32345065", "title": "Rails 4.2 Nested Forms--SQL Automatically Deleted Nested Forms Content When Loading &#39;Edit&#39; Page", "body": "<p>When you call <code>@post.build_location</code> it clears your old Location from the database. </p>\n\n<p>Check out the <a href=\"http://guides.rubyonrails.org/association_basics.html#methods-added-by-has-one\" rel=\"nofollow\">Rails</a> guide here on \"When are objects saved?\" </p>\n\n<p>For example:</p>\n\n<pre><code>a = Whole.new\na.save\na\n=&gt; #&lt;Whole id: 2, name: \"foo\", created_at: \"2015-09-02 05:15:15\", updated_at: \"2015-09-02 05:15:15\"&gt;\na.part\n=&gt; nil\nb = a.build_part\nb.save\na.part\n=&gt; #&lt;Part id: 1, name: nil, created_at: \"2015-09-02 05:16:37\", updated_at: \"2015-09-02 05:16:37\", whole_id: 2&gt; \nc = a.build_part\n=&gt; #&lt;Part id: nil, name: nil, created_at: nil, updated_at: nil, whole_id: 2&gt;\nPart.find_by(whole_id: 2)\n=&gt; nil\n</code></pre>\n\n<p>You could also only build a new location if there isn't one already:</p>\n\n<pre><code>@post.build_location unless @post.location\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 744, "user_id": 1885107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f3cb4e9a996ab41c7980d6954dfb68d?s=128&d=identicon&r=PG", "display_name": "Prakash Laxkar", "link": "https://stackoverflow.com/users/1885107/prakash-laxkar"}, "is_accepted": true, "score": 2, "last_activity_date": 1441172936, "creation_date": 1441172936, "answer_id": 32345470, "question_id": 32344562, "link": "https://stackoverflow.com/questions/32344562/rails-4-2-nested-forms-sql-automatically-deleted-nested-forms-content-when-load/32345470#32345470", "title": "Rails 4.2 Nested Forms--SQL Automatically Deleted Nested Forms Content When Loading &#39;Edit&#39; Page", "body": "<p>Update your edit method in controller. Build instance only when post doesn't have associated location.</p>\n\n<pre><code>@post.build_location if @post.location.blank?\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4314067, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-bDsqcQdnPXM/AAAAAAAAAAI/AAAAAAAAACU/Pu9wIWa5CRg/photo.jpg?sz=128", "display_name": "Florence Liang", "link": "https://stackoverflow.com/users/4314067/florence-liang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 32345470, "answer_count": 3, "score": 1, "last_activity_date": 1441173415, "creation_date": 1441167426, "last_edit_date": 1441171848, "question_id": 32344562, "link": "https://stackoverflow.com/questions/32344562/rails-4-2-nested-forms-sql-automatically-deleted-nested-forms-content-when-load", "title": "Rails 4.2 Nested Forms--SQL Automatically Deleted Nested Forms Content When Loading &#39;Edit&#39; Page", "body": "<p>I use this <a href=\"http://www.amooma.de/screencasts/2015-01-22-nested_forms-rails-4.2/\" rel=\"nofollow\">Blog</a> as a guide to learn <code>nested form</code> on <code>Ruby on Rails 4.2</code>. I tried to create a location nested form within the <code>Post</code> model with the same steps from this instruction.</p>\n\n<p>After creating a new <code>post</code> with nested location form, the location content was shown correctly on the <code>post's</code> show page. However, when I open the <code>edit</code> page, the location content is all gone. After inspecting the log carefully, I found below information:</p>\n\n<pre><code>Started GET \"/categories/category#name/posts/323/edit\"...\nLocation Load (0.1ms)  SELECT  \"locations\".* FROM \"locations\" WHERE \"locations\".\"post_id\" = ? LIMIT 1  [[\"post_id\", 323]]\n   (0.1ms)  begin transaction\n  SQL (0.4ms)  DELETE FROM \"locations\" WHERE \"locations\".\"id\" = ?  [[\"id\", 27]]\n</code></pre>\n\n<p>It seems the content created in nested form was deleted by SQL automatically when loading the edit page.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>   class Post &lt; ActiveRecord::Base\n      belongs_to :user\n      belongs_to :category\n\n      has_one :location, dependent: :destroy\n\n      accepts_nested_attributes_for :location, reject_if: lambda { |a| a['street'].blank? },\n                                     allow_destroy: true\n      def to_s\n        title\n      end\n   end\n</code></pre>\n\n<p>Location model:</p>\n\n<pre><code>class Location &lt; ActiveRecord::Base\n  belongs_to :post\n  has_one :user, through: :post\n\n\n  validates :city, presence: true\n  validates :zipcode, presence: true,\n             format: { with: /\\A\\d{5}\\z/i }\n\n\nend\n</code></pre>\n\n<p>PostsController:</p>\n\n<pre><code> class Categories::PostsController &lt; ApplicationController\n    ...\n    def new\n        @category = Category.friendly.find(params[:category_id])\n        @post = Post.new\n        @post.build_location\n      end\n\n      def create\n        @category = Category.friendly.find(params[:category_id])\n        @post = current_user.posts.build(post_params)\n        @post.category = @category\n\n        if @post.save\n          flash[:success] = \"You have succesfully created a new post.\"\n          redirect_to [@category, @post]\n        else\n          flash[:error] = \"Error occured. Please try again.\"\n          render :new\n        end\n      end\n\n      def edit\n        @category = Category.friendly.find(params[:category_id])\n        @post = Post.find(params[:id])\n        @post.build_location\n      end\n\n      def update\n        @category = Category.friendly.find(params[:category_id])\n        @post = Post.find(params[:id])\n          if @post.update_attributes(post_params)\n            flash[:success] = \"Post was upated.\"\n            redirect_to [@category, @post]\n          else\n            flash[:error] = \"There was an error saving a post, please try again.\"\n            render :new\n          end\n      end\n    ...\n    private \n\n        def post_params\n          params.require(:post).permit(:title, :body, location_attributes: [:id, :street, :city, :zipcode, :_destroy])\n        end\n</code></pre>\n\n<p>app/views/posts/_form.html.erb</p>\n\n<pre><code>&lt;%= form_for [@category, @post] do |f| %&gt;\n  ...\n  &lt;strong&gt;Location:&lt;/strong&gt;\n  &lt;div class=\"well\"&gt;\n    &lt;%= f.fields_for :location do |location| %&gt;\n      &lt;%= location.label :street %&gt;\n  &lt;%= location.text_field :street, placeholder: \"If you don't want to provide your address, just put 'NA' in this field\" %&gt;\n\n  &lt;%= location.label :city %&gt;\n  &lt;%= location.text_field :city %&gt;\n\n  &lt;%= location.label :zipcode%&gt;\n  &lt;%= location.text_field :zipcode %&gt;\n\n  &lt;%= location.check_box :_destroy %&gt;\n  &lt;%= location.label :_destroy, 'remove' %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>While everything works well from the instruction I followed, I keep getting the \"silent\" error in my app when I test it on the server. How can I make the existing data from nested form appear on the edit page?</p>\n\n<p>Any insight is welcomed and thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "has-many-through", "collection-select"], "comments": [{"owner": {"reputation": 1600, "user_id": 1395009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/88yfK.jpg?s=128&g=1", "display_name": "nikkypx", "link": "https://stackoverflow.com/users/1395009/nikkypx"}, "edited": false, "score": 0, "creation_date": 1441164035, "post_id": 32344096, "comment_id": 52562338, "body": "&quot;But since the data doesn&#39;t seem to be stored, nothing is showing up.&quot; -strong params issue?"}, {"owner": {"reputation": 133, "user_id": 4630110, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hDsTU.jpg?s=128&g=1", "display_name": "Skiapex", "link": "https://stackoverflow.com/users/4630110/skiapex"}, "reply_to_user": {"reputation": 1600, "user_id": 1395009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/88yfK.jpg?s=128&g=1", "display_name": "nikkypx", "link": "https://stackoverflow.com/users/1395009/nikkypx"}, "edited": false, "score": 0, "creation_date": 1441164349, "post_id": 32344096, "comment_id": 52562409, "body": "maybe but I am not getting the usual error.  no errors.  I added <code>patient_params</code> to what I was showing for the <code>patient_controller</code>"}, {"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441189010, "post_id": 32344096, "comment_id": 52574093, "body": "Could you please include the parameters passed in the create requests. Also you could print the state of <code>@patient</code> before the save statement, to split the problem whether it is the parameters mass assignment, or it is the persisting to the DB"}, {"owner": {"reputation": 133, "user_id": 4630110, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hDsTU.jpg?s=128&g=1", "display_name": "Skiapex", "link": "https://stackoverflow.com/users/4630110/skiapex"}, "edited": false, "score": 0, "creation_date": 1441212641, "post_id": 32344096, "comment_id": 52590430, "body": "in the parameters being passed: <code>&quot;clinician_ids&quot;=&gt;[&quot;81&quot;, &quot;83&quot;]</code> is included (when selecting two clinicians via checkboxes). Afterwards there is the message: <code>Unpermitted parameters: clinician_ids</code>"}, {"owner": {"reputation": 133, "user_id": 4630110, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hDsTU.jpg?s=128&g=1", "display_name": "Skiapex", "link": "https://stackoverflow.com/users/4630110/skiapex"}, "edited": false, "score": 0, "creation_date": 1441231326, "post_id": 32344096, "comment_id": 52600307, "body": "resolved that by changing params to have <code>{:clinician_ids =&gt; [:id]}</code> instead of just <code>:clinician_ids</code>.  still isn&#39;t inserting the values"}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 4630110, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hDsTU.jpg?s=128&g=1", "display_name": "Skiapex", "link": "https://stackoverflow.com/users/4630110/skiapex"}, "is_accepted": false, "score": 0, "last_activity_date": 1483801831, "last_edit_date": 1495535437, "creation_date": 1441329840, "answer_id": 32388740, "question_id": 32344096, "link": "https://stackoverflow.com/questions/32344096/has-many-through-and-collection-select-rails-form/32388740#32388740", "title": "has_many :through and collection_select rails form", "body": "<p>Found the answer on <a href=\"https://stackoverflow.com/questions/32364030/has-many-throught-not-instering-into-database-from-form/32365066#32365066\">another question</a> I asked:</p>\n\n<p>problem is this line in the controller:</p>\n\n<p><code>params.require(:patient).permit({:clinician_ids =&gt; [:id]}...</code></p>\n\n<p>It should be:</p>\n\n<p><code>params.require(:patient).permit({:clinician_ids =&gt; []}...</code></p>\n"}], "owner": {"reputation": 133, "user_id": 4630110, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hDsTU.jpg?s=128&g=1", "display_name": "Skiapex", "link": "https://stackoverflow.com/users/4630110/skiapex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 815, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1483801831, "creation_date": 1441163732, "last_edit_date": 1495541451, "question_id": 32344096, "link": "https://stackoverflow.com/questions/32344096/has-many-through-and-collection-select-rails-form", "title": "has_many :through and collection_select rails form", "body": "<p>I have tried all of the solutions to similar problems and haven't gotten this one figured out.</p>\n\n<p>I have a has_many :through relationship between 'Clinician', and 'Patient' with a joined model 'CareGroupAssignment'.  None of the methods I have tried so far been able to save the <code>clinician</code> to <code>patient</code> association.  I would like to have a <code>patient</code> be able to have multiple <code>clinicians</code> associated with it and <code>clinicians</code> will have multiple <code>patients</code>.</p>\n\n<p><strong>clinician.rb</strong> (simplified)</p>\n\n<pre><code>class Clinician &lt; ActiveRecord::Base\n    belongs_to :care_group\n\n    has_many :patients ,:through=&gt; :care_group_assignments\n    has_many :care_group_assignments, :dependent =&gt; :destroy\n\n    belongs_to :user\n    accepts_nested_attributes_for :user,  :allow_destroy =&gt; true\nend\n</code></pre>\n\n<p><strong>patient.rb</strong></p>\n\n<pre><code>class Patient &lt; ActiveRecord::Base\n    belongs_to :care_group\n\n    has_many :clinicians ,:through=&gt; :care_group_assignments\n    has_many :care_group_assignments\n\n    belongs_to :user\n    accepts_nested_attributes_for :user,  :allow_destroy =&gt; true\nend\n</code></pre>\n\n<p><strong>care_group_assignments.rb</strong></p>\n\n<pre><code>class CareGroupAssignment &lt; ActiveRecord::Base\n    belongs_to :clinician\n    belongs_to :patient\nend\n</code></pre>\n\n<p>I first tried to follow the example from <a href=\"https://www.youtube.com/watch?v=c2qwV0B9yfU\" rel=\"nofollow noreferrer\">Railscasts PRO #17- HABTM Checkboxes</a> to at least start getting the data collected and to have the models set up correctly.  Below is the form with the checkboxes for each clinician as described in the RailsCast, checkboxes show up and the data is sent but not stored (can't figure out why).</p>\n\n<p>patient <strong>new.html.erb</strong> form</p>\n\n<pre><code>&lt;%= form_for @patient do |form| %&gt;\n\n  &lt;%= form.fields_for :user do |builder| %&gt;\n   &lt;div class=\"form-group\"&gt;\n      &lt;%= builder.label \"Email or Username\" %&gt;\n      &lt;%= builder.text_field :email, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"form-group\"&gt;\n      &lt;%= builder.label :password %&gt;\n      &lt;%= builder.password_field :password, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= form.label :first_name %&gt;\n    &lt;%= form.text_field :first_name, class: \"form-control\", placeholder: \"First name\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= form.label :last_name %&gt;\n    &lt;%= form.text_field :last_name, class: \"form-control\", placeholder: \"Last name\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;% Clinician.where(care_group_id: @care_group.id).each do |clinician| %&gt;\n      &lt;%= check_box_tag \"patient[clinician_ids][]\", clinician.id, @patient.clinician_ids.include?(clinician.id), id: dom_id(clinician) %&gt;\n      &lt;%= label_tag dom_id(clinician), clinician.full_name %&gt;&lt;br&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n\n  &lt;%= form.button 'Create Patient', class: \"btn btn-u btn-success\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Next, I tried the <code>collection_select</code> answer to <a href=\"https://stackoverflow.com/questions/8239961/rails-has-many-through-and-collection-select-with-multiple\">this question</a>.  This creates a badly formatted list where only one <code>clinician</code> can be selected. The data seems to get sent but again doesn't save.</p>\n\n<p>patient <strong>new.html.erb</strong> form</p>\n\n<pre><code>  &lt;div class=\"form-group\"&gt;\n    &lt;%= collection_select(:patient, :clinician_ids, \n      Clinician.where(care_group_id: @care_group.id).order(\"first_name asc\"), \n      :id, :full_name, {:selected =&gt; @patient.clinician_ids, :include_blank =&gt; true}, {:multiple =&gt; true}) %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>Lastly, I copied what was done in <a href=\"https://stackoverflow.com/questions/31146224/rails-app-creating-join-records-has-many-through-with-a-form-fields-for-sectio\">this questions/solution</a>.  Also isn't formatted as a normal <code>collection_select</code> dropdown but instead a list with a boarder around it where only one <code>clinician</code> can be selected.</p>\n\n<p>patient <strong>new.html.erb</strong> form</p>\n\n<pre><code>  &lt;div class=\"form-group\"&gt;\n    &lt;% Clinician.where(care_group_id: @care_group.id).each do |clinician| %&gt;\n      &lt;%= check_box_tag \"patient[clinician_ids][]\", clinician.id, @patient.clinician_ids.include?(clinician.id), id: dom_id(clinician) %&gt;\n      &lt;%= label_tag dom_id(clinician), clinician.full_name %&gt;&lt;br&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>None of these methods have so far been able to save the <code>clinician</code> to <code>patient</code> association.</p>\n\n<p><strong>patient_controller.rb</strong></p>\n\n<pre><code>def new\n  @patient = Patient.new\n  @user = User.new\n  @patient.build_user\n\n  @care_group = current_clinician.care_group\nend\n\ndef create\n  @patient = Patient.create(patient_params)\n  @patient.care_group = current_clinician.care_group\n\n  if @patient.save\n    redirect_to patient_path(@patient), notice: \"New patient created!\"\n  else\n    render \"new\"\n  end\nend\n\ndef show\n @patient = Patient.find_by(id: params[\"id\"])\nend\n\nprivate\n def patient_params\n  params.require(:patient).permit({:clinician_ids =&gt; [:id]},:first_name,:last_name,:user_id,:care_group_id, user_attributes: [ :email, :password, :patient_id, :clinician_id ])\n end\n</code></pre>\n\n<p>I plan to display the <code>clinicians</code> associated with a <code>patient</code> on the patient <code>show</code> page:</p>\n\n<p>patient <strong>show.html.erb</strong></p>\n\n<pre><code>&lt;strong&gt;Shared with:&lt;/strong&gt;\n &lt;% @patient.clinicians.each do |clinician| %&gt;\n  &lt;%= clinician.full_name %&gt;&lt;\n &lt;% end %&gt;\n</code></pre>\n\n<p>This works if I seed the database but since the data doesn't seem to be stored, nothing is showing up.</p>\n\n<p>Rails 4.1.8, ruby 2.2.1p85, PostgreSQL</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441162540, "post_id": 32343886, "comment_id": 52561991, "body": "From which directory are you trying to run the rake command? What happens if, from the root directory of your app (where your Gemfile sits), try to run <code>bundle exec rake db:create</code> ?"}, {"owner": {"reputation": 1, "user_id": 2067531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ca10a166a561b8c1f1b3173ede9f144?s=128&d=identicon&r=PG", "display_name": "user2067531", "link": "https://stackoverflow.com/users/2067531/user2067531"}, "reply_to_user": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441171172, "post_id": 32343886, "comment_id": 52564212, "body": "I was executing the command from app-name/bin directory. I tried executing the suggested command from the root directory of the app and it throws the same error <code>Your Ruby version is 1.9.3, but your Gemfile specified 2.2.1</code>"}, {"owner": {"reputation": 2482, "user_id": 3654356, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100006427382469/picture?type=large", "display_name": "orvi", "link": "https://stackoverflow.com/users/3654356/orvi"}, "edited": false, "score": 0, "creation_date": 1441171260, "post_id": 32343886, "comment_id": 52564250, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/19342044/in-ruby-your-ruby-version-is-1-9-3-but-your-gemfile-specified-2-0-0\">In Ruby: &quot;Your Ruby version is 1.9.3, but your Gemfile specified 2.0.0&quot;</a>"}, {"owner": {"reputation": 1, "user_id": 2067531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ca10a166a561b8c1f1b3173ede9f144?s=128&d=identicon&r=PG", "display_name": "user2067531", "link": "https://stackoverflow.com/users/2067531/user2067531"}, "edited": false, "score": 0, "creation_date": 1441174510, "post_id": 32343886, "comment_id": 52565498, "body": "I have gone through all the solutions suggested there but none of the solutions worked for me"}, {"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441178413, "post_id": 32343886, "comment_id": 52567408, "body": "Have you installed rvm? Or rbenv, or any other equivalent?"}, {"owner": {"reputation": 1, "user_id": 2067531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ca10a166a561b8c1f1b3173ede9f144?s=128&d=identicon&r=PG", "display_name": "user2067531", "link": "https://stackoverflow.com/users/2067531/user2067531"}, "edited": false, "score": 0, "creation_date": 1441179553, "post_id": 32343886, "comment_id": 52568135, "body": "yes it&#39;s installed.  <code>ubuntu@myserver:~$ rvm -v rvm 1.26.11 (latest) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https:&#47;&#47;rvm.io&#47;] ubuntu@myserver:~$ rbenv -v rbenv 0.4.0 </code>"}, {"owner": {"reputation": 648, "user_id": 2880527, "user_type": "registered", "profile_image": "https://graph.facebook.com/554008300/picture?type=large", "display_name": "Marco Sandrini", "link": "https://stackoverflow.com/users/2880527/marco-sandrini"}, "edited": false, "score": 0, "creation_date": 1441196303, "post_id": 32343886, "comment_id": 52578807, "body": "You have BOTH rvm and rbenv?"}], "answers": [{"comments": [{"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "reply_to_user": {"reputation": 1, "user_id": 2067531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ca10a166a561b8c1f1b3173ede9f144?s=128&d=identicon&r=PG", "display_name": "user2067531", "link": "https://stackoverflow.com/users/2067531/user2067531"}, "edited": false, "score": 0, "creation_date": 1441166119, "post_id": 32343948, "comment_id": 52562825, "body": "what&#39;s the output of: <code>bundle exec ruby -v</code>?"}, {"owner": {"reputation": 1, "user_id": 2067531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ca10a166a561b8c1f1b3173ede9f144?s=128&d=identicon&r=PG", "display_name": "user2067531", "link": "https://stackoverflow.com/users/2067531/user2067531"}, "edited": false, "score": 1, "creation_date": 1441170978, "post_id": 32343948, "comment_id": 52564140, "body": "It gives following output <i>ruby 2.2.1p85 (2015-02-26 revision 49769) [x86_64-linux]</i>"}], "tags": [], "owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "is_accepted": false, "score": 1, "last_activity_date": 1441162553, "creation_date": 1441162553, "answer_id": 32343948, "question_id": 32343886, "link": "https://stackoverflow.com/questions/32343886/your-ruby-version-is-1-9-3-but-your-gemfile-specified-2-2-1/32343948#32343948", "title": "Your Ruby version is 1.9.3, but your Gemfile specified 2.2.1", "body": "<p>Run with <a href=\"http://bundler.io/man/bundle-exec.1.html\" rel=\"nofollow\">bundle exec</a>:</p>\n\n<pre><code>bundle exec rake db:create\n</code></pre>\n\n<p>This will ensure that the rake command is executed in the context of the current bundle.</p>\n"}], "owner": {"reputation": 1, "user_id": 2067531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ca10a166a561b8c1f1b3173ede9f144?s=128&d=identicon&r=PG", "display_name": "user2067531", "link": "https://stackoverflow.com/users/2067531/user2067531"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441162553, "creation_date": 1441162114, "question_id": 32343886, "link": "https://stackoverflow.com/questions/32343886/your-ruby-version-is-1-9-3-but-your-gemfile-specified-2-2-1", "title": "Your Ruby version is 1.9.3, but your Gemfile specified 2.2.1", "body": "<p>There were so many questions on this topic but none could help me to solve the issue.I am new to ROR. I am trying to run following command</p>\n\n<pre><code>rake db:create\n</code></pre>\n\n<p>it throws error though I have ruby 2.2.1 installed and by default it is pointed to</p>\n\n<blockquote>\n  <p>Your Ruby version is 1.9.3, but your Gemfile specified 2.2.1</p>\n</blockquote>\n\n<p>I tried running following commands to check which ruby version is being used</p>\n\n<pre><code>ubuntu@myserver:~/workspace/railpro/appraiser-events/bin$ ruby -v\nruby 2.2.1p85 (2015-02-26 revision 49769) [x86_64-linux]\nubuntu@myserver:~/workspace/railpro/appraiser-events/bin$ which ruby\n/home/ubuntu/.rvm/rubies/ruby-2.2.1/bin/ruby\nubuntu@myserver:~/workspace/railpro/appraiser-events/bin$ echo $PATH\n/home/ubuntu/.rvm/gems/ruby-2.2.1/bin:/home/ubuntu/.rvm/gems/ruby-        2.2.1@global/bin:/home/ubuntu/.rvm/rubies/ruby-    2.2.1/bin:/home/ubuntu/.rvm/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/ usr/bin:/sbin:/bin:/usr/games:/usr/local/games\n</code></pre>\n\n<p>This shows that i am using ruby 2.2.1 and in my Gemfile also it points to 2.2.1 but when I use rake db:create it throws this error.</p>\n\n<p>When I tried to change the Gemfile to point to 1.9.3 it said the reverse</p>\n\n<blockquote>\n  <p>Your Ruby version is 2.2.1, but your Gemfile specified 1.9.3</p>\n</blockquote>\n\n<p>I tried putting a .ruby-version file in the top level directory and mentioned the 2.2.1 inside that but it didn't work</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller"], "answers": [{"comments": [{"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1441172821, "post_id": 32344608, "comment_id": 52564818, "body": "Thank you so much! That&#39;s perfect."}], "tags": [], "owner": {"reputation": 9015, "user_id": 155826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/55RCe.jpg?s=128&g=1", "display_name": "Ryan Crispin Heneise", "link": "https://stackoverflow.com/users/155826/ryan-crispin-heneise"}, "is_accepted": true, "score": 2, "last_activity_date": 1441167679, "creation_date": 1441167679, "answer_id": 32344608, "question_id": 32343804, "link": "https://stackoverflow.com/questions/32343804/abstractcontrollerdoublerendererror/32344608#32344608", "title": "AbstractController::DoubleRenderError", "body": "<p>You are calling <code>head</code>, which returns a header-only response <a href=\"http://guides.rubyonrails.org/layouts_and_rendering.html#using-head-to-build-header-only-responses\" rel=\"nofollow\">see <em>Using head To Build Header-Only Responses</em> on Rails Guides</a>. Calling <code>head</code> is the equivalent of a return statement in the render block. It looks like you're calling <code>head</code>, and then going on to render more code, hence the double-render error. You probably don't need that line at all because the default response code is 200 anyway. </p>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 32344608, "answer_count": 1, "score": 0, "last_activity_date": 1441167679, "creation_date": 1441161382, "last_edit_date": 1441161970, "question_id": 32343804, "link": "https://stackoverflow.com/questions/32343804/abstractcontrollerdoublerendererror", "title": "AbstractController::DoubleRenderError", "body": "<p>When I submit this:</p>\n\n<pre><code>&lt;%= simple_form_for(@missed_date, url: habit_level_missed_dates_path({ habit_id: @habit, level_id: @habit.current_habit_level.id }), remote: request.xhr?, html: { data: { modal: true } }) do |f| %&gt;\n</code></pre>\n\n<p>The modal doesn't disappear because the page doesn't <code>redirect_to :root_url</code> as it's suppose to with the create action.</p>\n\n<pre><code>  def create\n    habit = Habit.find(params[:habit_id])\n    habit.missed_days = habit.missed_days + 1\n    habit.save!\n    level = habit.levels.find(params[:level_id])\n    level.missed_days = level.missed_days + 1\n    if level.missed_days == 3\n      level.missed_days = 0\n      level.days_lost += habit.calculate_days_lost + 2\n    end\n    level.save!\n    head :ok # this returns an empty response with a 200 success status code\n    @missed_date = level.missed_dates.new(missed_date_params)\n    @missed_date.save\n    respond_modal_with @date_missed, location: root_path # How to intergrate with this line?\n  end\n</code></pre>\n\n<p>This is because of the error:</p>\n\n<pre><code>AbstractController::DoubleRenderError (Render and/or redirect were called multiple times in this action. Please note that you may only call render OR redirect, and at most once per action. Also note that neither redirect nor render terminate execution of the action, so if you want to exit an action after redirecting, you need to do something like \"redirect_to(...) and return\".):\n  app/controllers/missed_dates_controller.rb:26:in `create'\n</code></pre>\n\n<p>Now I know the cause, which is that I have in the form_for <code>url: habit_level_missed_dates_path({ habit_id: @habit, level_id: @habit.current_habit_level.id })</code>, but I need that there, at least I think so, to pass those attributes upon creation.</p>\n\n<p>How can I revise this so that when the user clicks submit in the <code>@missed_date</code> form the id's pass AND he is redirected back to the <code>root_url</code>?</p>\n\n<p>I followed this tutorial for the modal logic: <a href=\"http://www.jetthoughts.com/blog/tech/2014/08/27/5-steps-to-add-remote-modals-to-your-rails-app.html\" rel=\"nofollow\">http://www.jetthoughts.com/blog/tech/2014/08/27/5-steps-to-add-remote-modals-to-your-rails-app.html</a>.</p>\n"}, {"tags": ["ruby", "console"], "comments": [{"owner": {"reputation": 8454, "user_id": 958529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3ec25db39c63bab1a11037649e326b8?s=128&d=identicon&r=PG", "display_name": "halfelf", "link": "https://stackoverflow.com/users/958529/halfelf"}, "edited": false, "score": 0, "creation_date": 1441162970, "post_id": 32343620, "comment_id": 52562087, "body": "I guess <code>curses</code> is not overkill but the standard way. And it is in ruby core lib before 2.1 after all."}], "answers": [{"tags": [], "owner": {"reputation": 425, "user_id": 3907426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vR3cD.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/3907426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1441168995, "last_edit_date": 1495539866, "creation_date": 1441168995, "answer_id": 32344749, "question_id": 32343620, "link": "https://stackoverflow.com/questions/32343620/refreshing-several-lines-in-console-while-running/32344749#32344749", "title": "Refreshing several lines in console while running", "body": "<p>What you are trying to make is called 'alternate screen'.<br>\nIf you think <code>curses</code> is overkill for this, then maybe you can do this solution that has been given to me <a href=\"https://stackoverflow.com/questions/31845890/ruby-gem-command-line-application-creating-a-new-session-in-bash\">here</a>.  </p>\n\n<pre><code>print `tput smcup`\nputs 'We are on alternate screen'\n# ...do something here...\n\n# when you finished, do this to get out of the alternate screen\nprint `tput rmcup`\n</code></pre>\n\n<p>To rewrite several lines:  </p>\n\n<pre><code>print \"\\r\\e[#{number_of_lines_to_jump_up_to}A\"\n</code></pre>\n\n<p>To delete previous characters:  </p>\n\n<pre><code>print \"\\b\"*number_of_characters_to_delete  # \\b for backspace\n</code></pre>\n"}], "owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441168995, "creation_date": 1441159827, "question_id": 32343620, "link": "https://stackoverflow.com/questions/32343620/refreshing-several-lines-in-console-while-running", "title": "Refreshing several lines in console while running", "body": "<p>I want to make a program that looks like <code>top</code> or something similar that is updating several lines while running. The <code>system \"clear\"</code> in Mac OS Terminal.app in fact just scrolls current contents to the top, so if I scroll up, I see a lot of garbage.<br>\nIt is somehow solvable via <code>curses</code>, but wouldn't it be overkill?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm", "consul"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6416211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afc386edbc910369a5eb9d044742514?s=128&d=identicon&r=PG&f=1", "display_name": "Wawura", "link": "https://stackoverflow.com/users/6416211/wawura"}, "is_accepted": false, "score": 0, "last_activity_date": 1464892005, "creation_date": 1464892005, "answer_id": 37599522, "question_id": 32343120, "link": "https://stackoverflow.com/questions/32343120/cannot-load-rails-due-to-switch-to-inspect-mode-error/37599522#37599522", "title": "Cannot load Rails due to Switch to inspect mode error", "body": "<p>try following:</p>\n\n<pre><code>export $(envconsul -consul your_consul_server/agent -prefix your_app_env/ -upcase -pristine -once env)\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>ruby -S bundle exec /usr/local/bin/rails c\n</code></pre>\n\n<p>you can obviously include all these envconsul options in your *.hcl file. </p>\n"}], "owner": {"reputation": 1213, "user_id": 1510953, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c4d9ad57732080bee93412dcb174d8e1?s=128&d=identicon&r=PG", "display_name": "greggilbert", "link": "https://stackoverflow.com/users/1510953/greggilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 909, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464892005, "creation_date": 1441155679, "question_id": 32343120, "link": "https://stackoverflow.com/questions/32343120/cannot-load-rails-due-to-switch-to-inspect-mode-error", "title": "Cannot load Rails due to Switch to inspect mode error", "body": "<p>I'm on a fresh install of Ubuntu 14.04 LTS. RVM 1.26.11 is installed with Ruby ruby 2.2.0p0. I'm using <a href=\"https://github.com/hashicorp/envconsul\" rel=\"nofollow\">envconsul</a> to handle environment variables. However, when I do:</p>\n\n<p><code>envconsul -config=/etc/envconsul.hcl bundle exec rails c</code></p>\n\n<p>it returns this error:</p>\n\n<p><code>I, [2015-09-02T00:10:00.420551 #3953]  INFO -- : ** [Raven] Raven 0.14.0 ready to catch errors\nLoading development environment (Rails 4.2.3)\nSwitch to inspect mode.</code></p>\n\n<p>and just dumps out to the command line. I can run <code>bundle exec rails c</code> on its own, but it fails out because the environment variables aren't set. I tried setting an <code>~/.irbrc</code> but that doesn't help at all.</p>\n\n<p>I'm really stumped on this one. Anyone have any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "vanity"], "answers": [{"tags": [], "owner": {"reputation": 1911, "user_id": 3163663, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/dfc7587fd73f2efa19d6f1f9611b70ba?s=128&d=identicon&r=PG", "display_name": "Jason FB", "link": "https://stackoverflow.com/users/3163663/jason-fb"}, "is_accepted": false, "score": 0, "last_activity_date": 1443359039, "creation_date": 1443359039, "answer_id": 32808195, "question_id": 32342902, "link": "https://stackoverflow.com/questions/32342902/vanity-gem-can-i-create-experiments-programmatically-via-a-database-table/32808195#32808195", "title": "Vanity (gem) - can I create experiments programmatically via a database table?", "body": "<p>The author of the gem replied to me on Github:</p>\n\n<p><a href=\"https://github.com/assaf/vanity/issues/269\" rel=\"nofollow\">https://github.com/assaf/vanity/issues/269</a></p>\n\n<p>phillbaker commented 26 days ago\nJason, (2) is something Vanity doesn't currently support, but I'd\ndefinitely like to support it.</p>\n\n<p>If you'd like to play around with a solution and submit a PR that'd be\namazing!</p>\n"}], "owner": {"reputation": 1911, "user_id": 3163663, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/dfc7587fd73f2efa19d6f1f9611b70ba?s=128&d=identicon&r=PG", "display_name": "Jason FB", "link": "https://stackoverflow.com/users/3163663/jason-fb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443359039, "creation_date": 1441153765, "question_id": 32342902, "link": "https://stackoverflow.com/questions/32342902/vanity-gem-can-i-create-experiments-programmatically-via-a-database-table", "title": "Vanity (gem) - can I create experiments programmatically via a database table?", "body": "<p>I am using Vanity gem and have the basics of experiments &amp; metrics set up fine. I was wondering if anyone has tried to extend it to set up experiments themselves via records in a database. </p>\n\n<p>It seems to me that Vanity is built to initialize its experiments during the app's boot, so this might be working against the design of the tool.</p>\n\n<p>As background, I see myself using this for two distinct kinds of experiments: (1) UX changes that requires a Rails/Javascript developer, and (2) changes of Images and copy which require simply a switch in my custom-built CMS. </p>\n\n<p>Vanity works well for #1, but for #2 I want the admin users of my site to be able to create experiments without involving a Rails/Javascript dev and without deploying code. I could easily implement the switch pull the right content myself, but I'm not sure how Vanity will feel about having experiments defined in a database?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 935, "user_id": 2095793, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/98ec2ef665b7e86cd22ed73e5c149fbd?s=128&d=identicon&r=PG", "display_name": "itsh", "link": "https://stackoverflow.com/users/2095793/itsh"}, "edited": false, "score": 0, "creation_date": 1441154324, "post_id": 32342944, "comment_id": 52560246, "body": "Appreciate quick reponse. Will try it and post how it worked."}], "tags": [], "owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": false, "score": 2, "last_activity_date": 1441154164, "creation_date": 1441154164, "answer_id": 32342944, "question_id": 32342887, "link": "https://stackoverflow.com/questions/32342887/how-to-pass-options-to-cp-r-in-ruby/32342944#32342944", "title": "How to pass options to cp_r in Ruby?", "body": "<p>Try:</p>\n\n<pre><code>FileUtils.cp_r 'src/.', 'dest', preserve: 'p', dereference_root: false\n</code></pre>\n\n<p>I don't know anything about those options and whether they are valid.  But that is the syntax you generally need to use to pass options to a Ruby method.  The last part will usually end up getting converted to a hash with keys <code>:preserve</code> and <code>:dereference_root</code>, and that hash will be passed as the last argument to the method.</p>\n"}], "owner": {"reputation": 935, "user_id": 2095793, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/98ec2ef665b7e86cd22ed73e5c149fbd?s=128&d=identicon&r=PG", "display_name": "itsh", "link": "https://stackoverflow.com/users/2095793/itsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441154164, "creation_date": 1441153665, "question_id": 32342887, "link": "https://stackoverflow.com/questions/32342887/how-to-pass-options-to-cp-r-in-ruby", "title": "How to pass options to cp_r in Ruby?", "body": "<p>Can someone tell me how to pass <code>options</code> to Ruby <code>cp_r</code>? I want to set <code>:derefernce_root</code> to <code>false</code> so that if there is a broken symlink it still gets copied and <code>:preserve</code> to <code>true</code> to preserve the permissions.</p>\n\n<p>I am thinking of somthing like this: <code>cp_r 'src/.', 'dest', options[:preserve] = 'p', options[:dereference_root] = false</code>. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "edited": false, "score": 0, "creation_date": 1441151421, "post_id": 32342554, "comment_id": 52559562, "body": "Can you post the migration where you added confirmations?"}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 2, "creation_date": 1441179862, "post_id": 32342554, "comment_id": 52568313, "body": "There is a typo in your migration - shouldn&#39;t <code>confirmation_tokention_sent_at</code> be <code>confirmation_sent_at</code> ?"}, {"owner": {"reputation": 1, "user_id": 5275461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37Qgg.png?s=128&g=1", "display_name": "leo", "link": "https://stackoverflow.com/users/5275461/leo"}, "edited": false, "score": 0, "creation_date": 1441209721, "post_id": 32342554, "comment_id": 52588750, "body": "hmm.. logically that makes sense to me. I will say that all I did was uncomment these four lines of code for <code>:confirmable</code>. I tried <code>t.datetime :confirmation_sent_at</code> and still receive the same error."}, {"owner": {"reputation": 2542, "user_id": 5763627, "user_type": "registered", "profile_image": "https://graph.facebook.com/941560632625951/picture?type=large", "display_name": "Divyanshu Rawat", "link": "https://stackoverflow.com/users/5763627/divyanshu-rawat"}, "edited": false, "score": 0, "creation_date": 1544339242, "post_id": 32342554, "comment_id": 94236455, "body": "@leo I am facing exactly similar problem can you help me with that?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5275461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37Qgg.png?s=128&g=1", "display_name": "leo", "link": "https://stackoverflow.com/users/5275461/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1441220259, "creation_date": 1441220259, "answer_id": 32361052, "question_id": 32342554, "link": "https://stackoverflow.com/questions/32342554/nomethoderror-in-deviseregistrationscontrollercreate-undefined-method-confir/32361052#32361052", "title": "NoMethodError in Devise::RegistrationsController#create undefined method `confirmation_sent_at=&#39; for #&lt;User:0x007fd83f5ccb68&gt;", "body": "<p>@Wand Maker was correct. The code should reflect <code>confirmation_sent_at</code> instead of <code>confirmation_tokention_sent_at</code>. </p>\n\n<p>The additional step I had to take was to remove my <code>schema.rb</code> file, run <code>rake db:reset</code> and then <code>rake db:migrate</code> to create the updated (and correct) <code>schema.rb</code>. </p>\n"}], "owner": {"reputation": 1, "user_id": 5275461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37Qgg.png?s=128&g=1", "display_name": "leo", "link": "https://stackoverflow.com/users/5275461/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 701, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441220259, "creation_date": 1441151244, "last_edit_date": 1441161844, "question_id": 32342554, "link": "https://stackoverflow.com/questions/32342554/nomethoderror-in-deviseregistrationscontrollercreate-undefined-method-confir", "title": "NoMethodError in Devise::RegistrationsController#create undefined method `confirmation_sent_at=&#39; for #&lt;User:0x007fd83f5ccb68&gt;", "body": "<p>I'm new to Rails. I'm using Devise to add authentication and an email confirmation upon signup. When I run the code on my local I get the error message in the title. I've reviewed similar posts and tried running <code>rake db:reset</code> and restarting the server.</p>\n\n<p>I've added <code>:confirmable</code> to <code>models/user.rb</code></p>\n\n<p><code>class User &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable, :confirmable\nend\n</code></p>\n\n<p>The error message highlights this block of code and specifically calls out the line of code beginning with <code>match ?</code> as line 433</p>\n\n<p><code>else\n   match = match_attribute_method?(method.to_s)\n   match ? attribute_missing(match, *args, &amp;block) : super\n end\nend</code></p>\n\n<pre><code>Completed 500 Internal Server Error in 327ms (ActiveRecord: 0.5ms)\n\nNoMethodError (undefined method `confirmation_sent_at=' for #   &lt;User:0x007fd21e2ebce0&gt;):\n activemodel (4.2.3) lib/active_model/attribute_methods.rb:433:in `method_missing'\n devise (3.5.2) lib/devise/models/confirmable.rb:240:in `generate_confirmation_token'\n activesupport (4.2.3) lib/active_support/callbacks.rb:430:in `block in make_lambda'\n activesupport (4.2.3) lib/active_support/callbacks.rb:143:in `call'\n</code></pre>\n\n<p>I appreciate any help!</p>\n\n<hr>\n\n<p><strong>Added migration file</strong></p>\n\n<pre><code>class DeviseCreateUsers &lt; ActiveRecord::Migration\n  def change\n    create_table(:users) do |t|\n      ## Database authenticatable\n      t.string :name\n      t.string :email,              null: false, default: \"\"\n      t.string :encrypted_password, null: false, default: \"\"\n\n      ## Recoverable\n      t.string   :reset_password_token\n      t.datetime :reset_password_sent_at\n\n      ## Rememberable\n      t.datetime :remember_created_at\n\n      ## Trackable\n      t.integer  :sign_in_count, default: 0, null: false\n      t.datetime :current_sign_in_at\n      t.datetime :last_sign_in_at\n      t.string   :current_sign_in_ip\n      t.string   :last_sign_in_ip\n\n      ## Confirmable\n      t.string   :confirmation_token\n      t.datetime :confirmed_at\n      t.datetime :confirmation_tokention_sent_at\n      t.string   :unconfirmed_email # Only if using reconfirmable\n\n      ## Lockable\n      # t.integer  :failed_attempts, default: 0, null: false # Only if lock strategy is :failed_attempts\n      # t.string   :unlock_token # Only if unlock strategy is :email or :both\n      # t.datetime :locked_at\n\n      t.timestamps null: false\n    end\n\n    add_index :users, :email,                unique: true\n    add_index :users, :reset_password_token, unique: true\n    # add_index :users, :confirmation_token,   unique: true\n    # add_index :users, :unlock_token,         unique: true\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 2020050, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1996be92f32060ab0a34053b0f3a1a8?s=128&d=identicon&r=PG", "display_name": "cvoep28", "link": "https://stackoverflow.com/users/2020050/cvoep28"}, "edited": false, "score": 0, "creation_date": 1441153275, "post_id": 32342744, "comment_id": 52559989, "body": "Thanks! Out of curiosity, does URI have a method for extracting everything after the .com as well?"}, {"owner": {"reputation": 383, "user_id": 2020050, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1996be92f32060ab0a34053b0f3a1a8?s=128&d=identicon&r=PG", "display_name": "cvoep28", "link": "https://stackoverflow.com/users/2020050/cvoep28"}, "edited": false, "score": 0, "creation_date": 1441153619, "post_id": 32342744, "comment_id": 52560068, "body": "Ah, got it, that&#39;s uri.path"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 383, "user_id": 2020050, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1996be92f32060ab0a34053b0f3a1a8?s=128&d=identicon&r=PG", "display_name": "cvoep28", "link": "https://stackoverflow.com/users/2020050/cvoep28"}, "edited": false, "score": 2, "creation_date": 1441153716, "post_id": 32342744, "comment_id": 52560088, "body": "Yes, good, you looked at the documentation. :-) Use the tools. They&#39;re written to handle corner cases you won&#39;t expect but will make you insane when you run into them. Pay particular attention to how to (re)build URIs using URI. Being able to build them and follow the specs is very important."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 2, "last_activity_date": 1441152508, "creation_date": 1441152508, "answer_id": 32342744, "question_id": 32342532, "link": "https://stackoverflow.com/questions/32342532/split-url-from-beginning-occurrence-to-end-occurrence/32342744#32342744", "title": "Split URL from beginning occurrence to end occurrence", "body": "<p>Use the right tools:</p>\n\n<pre><code>require 'uri'\n\nuri = URI.parse(\"http://mywebsite.com/mySubdirectory\")\nuri.host # =&gt; \"mywebsite.com\"\n</code></pre>\n\n<p>These days, EVERY decent language has code already written to tear apart a URI. Use those tools instead of trying to reinvent the wheel. </p>\n\n<p><a href=\"http://ruby-doc.org/stdlib-2.2.3/libdoc/uri/rdoc/URI.html\" rel=\"nofollow\">URI's documentation</a></p>\n"}], "owner": {"reputation": 383, "user_id": 2020050, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1996be92f32060ab0a34053b0f3a1a8?s=128&d=identicon&r=PG", "display_name": "cvoep28", "link": "https://stackoverflow.com/users/2020050/cvoep28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 32342744, "answer_count": 1, "score": 0, "last_activity_date": 1441152785, "creation_date": 1441151100, "last_edit_date": 1441152785, "question_id": 32342532, "link": "https://stackoverflow.com/questions/32342532/split-url-from-beginning-occurrence-to-end-occurrence", "title": "Split URL from beginning occurrence to end occurrence", "body": "<p>If I have the following URL: </p>\n\n<pre><code>myString = \"http://mywebsite.com/mySubdirectory\" \n</code></pre>\n\n<p>and I only want to extract \"<code>mywebsite.com</code>\", how can I achieve this? </p>\n\n<p>I need to take everything after the <code>http://</code> and everything before the end of \"<code>.com.</code>\" </p>\n\n<p>I know that <code>myString.split('http://')</code> will leave <code>mywebsite.com/mySubdirectory</code>, but then how do I remove everything after the \"<code>.com</code>\" takes place? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 25180, "user_id": 1849664, "user_type": "moderator", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/9278dc00e1a8755dc2de02b6a908a15a?s=128&d=identicon&r=PG", "display_name": "Undo", "link": "https://stackoverflow.com/users/1849664/undo"}, "edited": false, "score": 0, "creation_date": 1441148626, "post_id": 32342132, "comment_id": 52558885, "body": "Can you paste the exact error you get when using <code>player.team.name</code>?"}, {"owner": {"reputation": 2781, "user_id": 4200307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/59KSj.jpg?s=128&g=1", "display_name": "Elvn", "link": "https://stackoverflow.com/users/4200307/elvn"}, "edited": false, "score": 1, "creation_date": 1441148923, "post_id": 32342132, "comment_id": 52558952, "body": "#&lt;Team:0x007f8f37a76f20&gt; is an object reference. Please post your controller code for the Player &quot;index&quot; action."}, {"owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "edited": false, "score": 0, "creation_date": 1441153409, "post_id": 32342132, "comment_id": 52560026, "body": "Let&#39;s make sure we&#39;re covering all bases here: look in your schema.rb file, where the teams table is defined. There&#39;s a column definition for name, yes? Does <code>&lt;%= @ownership.team.name %&gt;</code> display the team name properly?"}, {"owner": {"reputation": 205, "user_id": 4925363, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f9677975a7f1508434abccac7b2409ec?s=128&d=identicon&r=PG&f=1", "display_name": "SeattleDucati", "link": "https://stackoverflow.com/users/4925363/seattleducati"}, "edited": false, "score": 0, "creation_date": 1441154315, "post_id": 32342132, "comment_id": 52560242, "body": "Yes, the team table has a name column, and &lt;%= @ownership.team.name %&gt; works fine in the ownership index.html.erb view."}], "owner": {"reputation": 205, "user_id": 4925363, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f9677975a7f1508434abccac7b2409ec?s=128&d=identicon&r=PG&f=1", "display_name": "SeattleDucati", "link": "https://stackoverflow.com/users/4925363/seattleducati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1441212018, "creation_date": 1441148117, "last_edit_date": 1441212018, "question_id": 32342132, "link": "https://stackoverflow.com/questions/32342132/rails-4-object-reference-output-when-displaying-value-from-different-model", "title": "Rails 4 - Object reference output when displaying value from different model", "body": "<p>I have three models, team, player, and ownerships. Their relationships look like this:</p>\n\n<p>team.rb</p>\n\n<pre><code>class Team &lt; ActiveRecord::Base\n  has_many :ownerships\n  has_many :players, through: :ownerships \n\n  validates :name, presence: true\n  validates :division, presence: true\nend\n</code></pre>\n\n<p>player.rb:</p>\n\n<pre><code>class Player &lt; ActiveRecord::Base\n  has_one :team, through: :ownership\n  has_one :ownership\n\n  validates :name, presence: true\n  validates :position, presence: true\nend\n</code></pre>\n\n<p>ownership.rb</p>\n\n<pre><code>class Ownership &lt; ActiveRecord::Base\n  belongs_to :player\n  belongs_to :team\n\n  validates :round, :pick, :team_id, presence: true\nend\n</code></pre>\n\n<p>Ownerships is indexed off both player_id and team_id:</p>\n\n<pre><code>add_index \"ownerships\", [\"player_id\"], name: \"index_ownerships_on_player_id\"\nadd_index \"ownerships\", [\"team_id\"], name: \"index_ownerships_on_team_id\"\n</code></pre>\n\n<p>When I update an ownership, the player(s) show up fine when I show the team(show.html.erb). But when I display the players index view, I get weird output from &lt;%= player.team %>. The team assignments are working, but, the team names get displayed as things like </p>\n\n<pre><code> #&lt;Team:0x007f8f37a76f20&gt; and #&lt;Team:0x007f8f37a4c360&gt;. \n</code></pre>\n\n<p>I've tried &lt;%= player.team.name %>, but that throws an undefined method error. </p>\n\n<p>How can I get the team names to display correctly? And what are those values I'm seeing above?</p>\n\n<p>Thank you in advance.</p>\n\n<p>This the pertinent part of the players index.html.erb page:</p>\n\n<pre><code>&lt;% @players.each do |player| %&gt;\n   &lt;tr&gt;\n   &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= player.name %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= player.position %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= player.team %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>When I user &lt;%= player.team.name %>, I get:</p>\n\n<pre><code>undefined method `name' for nil:NilClass\n</code></pre>\n\n<p>The index action from the players_controller.rb is basic:</p>\n\n<pre><code>def index\n@players = Player.all\nend\n</code></pre>\n\n<p>Would the way I'm selecting the players matter? I'm using a drop down menu in the ownership edit form that looks like this:</p>\n\n<pre><code>&lt;%= form_for @ownership do |f| %&gt;\n&lt;p&gt;\n&lt;%= f.label :team_id %&gt;&lt;br&gt;\n&lt;%= @ownership.team.name %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;&lt;%= f.label :player_id %&gt;&lt;br&gt;\n&lt;%= f.collection_select(:player_id, Player.all, :id, :name)%&gt;\n&lt;/p&gt;\n&lt;p&gt;\n&lt;%= f.submit %&gt;\n&lt;/p&gt;\n\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "git", "gitlab"], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 3288070, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3ec31403370bc858c0524a492f633d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiden Prince", "link": "https://stackoverflow.com/users/3288070/kaiden-prince"}, "edited": false, "score": 0, "creation_date": 1441240661, "post_id": 32346407, "comment_id": 52602899, "body": "Thank you for this. I am unable to test it yet, but if it works I will make this the answer."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1441176920, "last_edit_date": 1495540336, "creation_date": 1441176920, "answer_id": 32346407, "question_id": 32341990, "link": "https://stackoverflow.com/questions/32341990/post-receive-hook-tell-which-repo-you-are-in/32346407#32346407", "title": "post-receive hook tell which repo you are in", "body": "<p>In your hook, you can try:</p>\n\n<pre><code>git rev-parse --git-dir\n</code></pre>\n\n<p>That should give the full path of the bare repo in which the hook (here a post-receive one) is executed.<br>\nThat is what I used in \"<a href=\"https://stackoverflow.com/a/958125/6309\">Is there a way to get the git root directory in one command?</a>\".</p>\n"}], "owner": {"reputation": 462, "user_id": 3288070, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3ec31403370bc858c0524a492f633d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiden Prince", "link": "https://stackoverflow.com/users/3288070/kaiden-prince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1441176920, "creation_date": 1441147261, "last_edit_date": 1495541197, "question_id": 32341990, "link": "https://stackoverflow.com/questions/32341990/post-receive-hook-tell-which-repo-you-are-in", "title": "post-receive hook tell which repo you are in", "body": "<p>I have a gitlab server. Gitlab has its own hooks symlinked to every git repo. I wish to be able to tell the difference in between repos when that script is called. I seen <a href=\"https://stackoverflow.com/questions/7351551/writing-a-git-post-receive-hook-to-deal-with-a-specific-branch#13057643\">this</a> but I don't think it provides any useful information in this case.</p>\n\n<p>Perhaps it may be possible to detect which repo the hook belongs to by figuring out where the script was executed from? (The original script is in ruby) Or possibly to check <code>/home/git/git-data/repositories/&lt;all git users&gt;/&lt;all repos&gt;</code> for the right ref? Either way I do not know how to do that.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1441147862, "post_id": 32341730, "comment_id": 52558658, "body": "The standard indentation in Ruby is 2 spaces, not 3, not 8, not 11, and certainly not 32."}], "answers": [{"tags": [], "owner": {"reputation": 205376, "user_id": 13, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1XtZi.jpg?s=128&g=1", "display_name": "Chris Jester-Young", "link": "https://stackoverflow.com/users/13/chris-jester-young"}, "is_accepted": false, "score": 2, "last_activity_date": 1441170424, "creation_date": 1441170424, "answer_id": 32345009, "question_id": 32341730, "link": "https://stackoverflow.com/questions/32341730/ruby-zipfile-extract-is-not-preserving-the-permissions/32345009#32345009", "title": "Ruby ZipFile.extract is not preserving the permissions", "body": "<p>The <code>zip</code> gem does not restore permissions by default. You must set the <code>restore_permissions</code> attribute to true on the <code>ZipFile</code> object before extracting its entries. So, use this:</p>\n\n<pre><code>Zip::ZipFile.open(file_path) do |zip_file|\n  zip_file.restore_permissions = true\n  zip_file.each do |f|\n    # ...\n  end\nend\n</code></pre>\n\n<p>There is also a <code>restore_ownership</code> attribute you can set, if you want to restore ownership too.</p>\n"}, {"tags": [], "owner": {"reputation": 935, "user_id": 2095793, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/98ec2ef665b7e86cd22ed73e5c149fbd?s=128&d=identicon&r=PG", "display_name": "itsh", "link": "https://stackoverflow.com/users/2095793/itsh"}, "is_accepted": false, "score": 0, "last_activity_date": 1441304112, "creation_date": 1441304112, "answer_id": 32382753, "question_id": 32341730, "link": "https://stackoverflow.com/questions/32341730/ruby-zipfile-extract-is-not-preserving-the-permissions/32382753#32382753", "title": "Ruby ZipFile.extract is not preserving the permissions", "body": "<p>Below is the working piece of code which will unzip the zipfile and preserve permissions.</p>\n\n<pre><code>def unzip_file (file_path, destination_path)\n   begin\n      Zip::ZipFile.open(file_path) { |zip_file|  \n                                      zip_file.restore_permissions = true\n                                      zip_file.each { |f|\n                                           f_path=File.join(destination_path, f.name)\n                                           FleUtils.mkdir_p(File.dirname(f_path))\n                                           zip_file.extract(f, f_path) unless File.exist?(f_path)\n                                         }\n                                    }\n    rescue =&gt; e\n             $LOG.error \"Error occurred in Utils.unzip_file - #{e}\"\n     end\n end\n</code></pre>\n"}], "owner": {"reputation": 935, "user_id": 2095793, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/98ec2ef665b7e86cd22ed73e5c149fbd?s=128&d=identicon&r=PG", "display_name": "itsh", "link": "https://stackoverflow.com/users/2095793/itsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441304112, "creation_date": 1441145790, "question_id": 32341730, "link": "https://stackoverflow.com/questions/32341730/ruby-zipfile-extract-is-not-preserving-the-permissions", "title": "Ruby ZipFile.extract is not preserving the permissions", "body": "<p>I have written a Ruby method to unzip the zip file (as per the requirements I am not suppose to use shell <code>unzip</code> command). But it is not preserving the permissions. There are lots of file (the zipfile is pretty big) so I don't want to update the permissions manually. Can someone kindly help me in fixing this issue? </p>\n\n<p>Below is the piece of code that unzips the build.</p>\n\n<pre><code> def unzip_file (file_path, destination_path)\n            begin\n               Zip::ZipFile.open(file_path) { |zip_file| zip_file.each { |f|\n\n                                               f_path=File.join(destination_path, f.name)\n\n                                               FileUtils.mkdir_p(File.dirname(f_path))\n\n                                               zip_file.extract(f, f_path) unless File.exist?(f_path)\n                                             }\n                                           }\n            rescue =&gt; e\n                    $LOG.error \"Error occurred in Utils.unzip_file - #{e}\"\n            end\n       end\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "docker", "travis-ci"], "answers": [{"tags": [], "owner": {"reputation": 67608, "user_id": 107049, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1f458499807b5dbd4019bfc9714f644?s=128&d=identicon&r=PG", "display_name": "Thomasleveil", "link": "https://stackoverflow.com/users/107049/thomasleveil"}, "is_accepted": true, "score": 1, "last_activity_date": 1441160120, "last_edit_date": 1441160120, "creation_date": 1441151107, "answer_id": 32342533, "question_id": 32341701, "link": "https://stackoverflow.com/questions/32341701/docker-containers-on-travis-ci/32342533#32342533", "title": "Docker containers on travis-ci", "body": "<h3>tl;dr</h3>\n\n<p>A container MUST run its program in the foreground.</p>\n\n<hr>\n\n<p>Your Dockerfile is the issue. From the <a href=\"https://github.com/tomasbasham/nginx/blob/master/Dockerfile\" rel=\"nofollow\">github repository</a> you provided, the Dockerfile content is:</p>\n\n<pre><code># Dockerfile for nginx with configurable persistent volumes\n\n# Select nginx as the base image\nFROM nginx\nMAINTAINER Tomas Basham &lt;me@tomasbasham.co.uk&gt;\n\n# Install net-tools\nRUN apt-get update -q &amp;&amp; \\\n    apt-get install -qy net-tools &amp;&amp; \\\n    apt-get clean\n\n# Mount configurable persistent volumes\nVOLUME [\"/etc/nginx/sites-enabled\", \"/etc/nginx/certs\", \"/etc/nginx/conf.d\", \"/var/log/nginx\", \"/var/www/html\"]\n\n# Expose both HTTP and HTTPS ports\nEXPOSE 80 443\n\n# ENTRYPOINT\nENTRYPOINT [\"service\", \"nginx\", \"start\"]\n</code></pre>\n\n<p>Before debugging your RSpec/serverspec tests, you should make sure that docker image is able to run a container.</p>\n\n<p>Type those commands from the directory which has the <code>Dockerfile</code> in:</p>\n\n<pre><code>docker build -t tmp .\ndocker run --rm -it tmp\n</code></pre>\n\n<p>If you get your shell prompt back to you, that means your container stopped running. If your container isn't starting, then your test suite will fail.</p>\n\n<hr>\n\n<h2>What's wrong with the dockerfile</h2>\n\n<p>The entrypoint you defined <code>ENTRYPOINT [\"service\", \"nginx\", \"start\"]</code> will execute a command that will, in turn, start the <em>nginx</em> program in the <strong>background</strong>. This means the process that was initially run by docker (<code>/bin/service</code>) will terminate, and docker will detect that and stop your container.</p>\n\n<p>To run nginx in the <strong>foreground</strong>, one must run <code>nginx -g daemon off;</code> as you can find in the <a href=\"https://github.com/nginxinc/docker-nginx/blob/7f3ef0927ec619d20181e677c97f991df0d7d446/Dockerfile#L22\" rel=\"nofollow\">Dockerfile for the official nginx image</a>. But since you put <code>daemon off;</code> in your <em>nginx.conf</em> file, you should be fine with just <code>nginx</code>.</p>\n\n<p>I suggest you remove the entrypoint from your Dockerfile <em>(and also remove the <code>daemon off;</code> from your nginx config)</em> and it should work fine.</p>\n\n<hr>\n\n<h2>serverspec</h2>\n\n<p>Once you get a container which runs, you will have to focus on the serverspec part on which I'm not experienced with.</p>\n"}], "owner": {"reputation": 1489, "user_id": 1613695, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/49b5b3b9873e3060bff7244940fed930?s=128&d=identicon&r=PG", "display_name": "tomasbasham", "link": "https://stackoverflow.com/users/1613695/tomasbasham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 32342533, "answer_count": 1, "score": 0, "last_activity_date": 1441160120, "creation_date": 1441145660, "last_edit_date": 1441148589, "question_id": 32341701, "link": "https://stackoverflow.com/questions/32341701/docker-containers-on-travis-ci", "title": "Docker containers on travis-ci", "body": "<p>I have a Dockerfile that I am attempting to test using RSpec, serverspec and docker-api. Locally (using boot2docker as I am on OS X) this works great and all my test pass, but on travis-ci none of the tests pass. My <code>.travis.yml</code> file is as such:</p>\n\n<pre><code>language: ruby\nrvm:\n  - \"2.2.0\"\n\nsudo: required\ncache: bundler\n\nservices:\n  - docker\n\nbefore_install:\n  - docker build -t tomasbasham/nginx .\n  - docker run -d -p 80:80 -p 443:443 --name nginx -v $(pwd)/nginx.conf:/etc/nginx/nginx.conf tomasbasham/nginx\n\nscript: bundle exec rspec\n</code></pre>\n\n<p>Am I doing something noticeably wrong here? The repository I have created and is run on travis-ci is on <a href=\"https://github.com/tomasbasham/nginx\" rel=\"nofollow\">GitHub</a>. There may be something else amiss that I am unaware of</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "asset-pipeline", "sprockets"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5183201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HSu2n.jpg?s=128&g=1", "display_name": "Mr.Monsieur", "link": "https://stackoverflow.com/users/5183201/mr-monsieur"}, "edited": false, "score": 0, "creation_date": 1441733395, "post_id": 32443196, "comment_id": 52789570, "body": "Wow, Thank You! I had tried a rake reset, and then a bundle update, but didn&#39;t know I could do a bundle rake temp clear. I&#39;ll need to find and read more on rake commands. Thank you again."}], "tags": [], "owner": {"reputation": 556, "user_id": 1343810, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/634ab278467e8f28f1ac9f981b45e7d0?s=128&d=identicon&r=PG&f=1", "display_name": "droptheplot", "link": "https://stackoverflow.com/users/1343810/droptheplot"}, "is_accepted": true, "score": 4, "last_activity_date": 1441644966, "creation_date": 1441644966, "answer_id": 32443196, "question_id": 32341459, "link": "https://stackoverflow.com/questions/32341459/sprocketsfileoutsidepaths-in-postsindex-where-application-css-scss-is-no-long/32443196#32443196", "title": "Sprockets::FileOutsidePaths in Posts#index where application.css.scss is no longer under a load path", "body": "<p>Running <code>bundle exec rake tmp:clear</code> helped me.</p>\n\n<p><a href=\"https://github.com/rails/sprockets/issues/96\" rel=\"nofollow\">Source.</a></p>\n"}], "owner": {"reputation": 41, "user_id": 5183201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HSu2n.jpg?s=128&g=1", "display_name": "Mr.Monsieur", "link": "https://stackoverflow.com/users/5183201/mr-monsieur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 32443196, "answer_count": 1, "score": 1, "last_activity_date": 1441644966, "creation_date": 1441144242, "last_edit_date": 1441148401, "question_id": 32341459, "link": "https://stackoverflow.com/questions/32341459/sprocketsfileoutsidepaths-in-postsindex-where-application-css-scss-is-no-long", "title": "Sprockets::FileOutsidePaths in Posts#index where application.css.scss is no longer under a load path", "body": "<p>So I decided to clone my repo from github and came up with this error. I'm not exactly sure how this came about when the original still works. Thank you everyone who is able to help.</p>\n\n<pre><code>&lt;head&gt;\n</code></pre>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Extracted source (around line #5):\r\n3  &lt;head&gt;\r\n4   &lt;title&gt;Yarp&lt;/title&gt;\r\n5    &lt;%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' =&gt; true %&gt;\r\n6    &lt;%= javascript_include_tag 'application', 'data-turbolinks-track' =&gt; true %&gt;\r\n7    &lt;%= csrf_meta_tags %&gt;\r\n8  &lt;/head&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>My application.index.erb</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n  &lt;title&gt;Yarp&lt;/title&gt;\r\n  &lt;%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' =&gt; true %&gt;\r\n  &lt;%= javascript_include_tag 'application', 'data-turbolinks-track' =&gt; true %&gt;\r\n  &lt;%= csrf_meta_tags %&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n\r\n\r\n\t\t&lt;%= render 'layouts/header' %&gt;\r\n\r\n\t&lt;div class=\"container\"&gt;\r\n\t\t&lt;% flash.each do |message_type, message| %&gt;\r\n\t\t\t&lt;div id=\"flash\" class=\"flash-&lt;%= message_type %&gt;\"&gt;&lt;%= message %&gt;&lt;/div&gt;\r\n\t\t&lt;% end %&gt;\r\n\r\n\t\t&lt;%= yield %&gt;\r\n\t&lt;/div&gt;\r\n\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Heres my Gem file</p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'rails', '4.2.2'\ngem 'pg'\ngem 'sass-rails', '~&gt; 5.0'\ngem 'uglifier', '&gt;= 1.3.0'\ngem 'coffee-rails', '~&gt; 4.1.0'\ngem 'jquery-rails'\ngem 'devise', '~&gt; 3.5.2'\ngem 'turbolinks'\ngem 'jbuilder', '~&gt; 2.0'\ngem 'acts_as_votable', '~&gt; 0.10.0'\ngem 'auto_html', '~&gt; 1.6.4'\n# Design\ngem 'font-awesome-rails', '~&gt; 4.4.0.0'\ngem 'bourbon', '~&gt; 4.2.3'\ngem 'neat', '~&gt; 1.7.2'\ngem 'refills', '~&gt; 0.1.0'\ngem 'normalize-rails', '~&gt; 3.0.3'\ngem 'sdoc', '~&gt; 0.4.0', group: :doc\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441144897, "post_id": 32341166, "comment_id": 52557715, "body": "Speaking of ugly, doesn&#39;t <code>[&#39;thing&#39;, nil].each do |i|     class_variable_set(:&quot;@@#{i}reqs&quot;, {}); end</code> qualify?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441145119, "post_id": 32341166, "comment_id": 52557801, "body": "@CarySwoveland: Personally, I don&#39;t see what&#39;s wrong with just <code>@@thingreqs, @@reqs = {}, {}</code>, but I wanted to keep the feel of the original code."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441146992, "post_id": 32341166, "comment_id": 52558388, "body": "Beauty is in the eye of the beholder, but I find <code>class_variable_set(:@@thingreqs, {}); class_variable_set(:@@reqs, {})</code> cleaner and clearer."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441147583, "post_id": 32341166, "comment_id": 52558568, "body": "@CarySwoveland: In this particular case, since the names are statically known, and there&#39;s only two of them, I don&#39;t see any reason to use metaprogramming (i.e. <code>class_variable_set</code>) at all, to be honest. Just <code>@@thingreqs, @@reqs = {}, {}</code> or <code>@@thingreqs = {}; @@reqs = {}</code> or something like that, but like I said, I wanted to keep the feel of the original code. This also makes it obvious that the problem is not with the metaprogramming or the closure property of the <code>each</code> block but purely one of dynamic instance scope."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 7, "last_activity_date": 1441143851, "last_edit_date": 1441143851, "creation_date": 1441142777, "answer_id": 32341166, "question_id": 32341027, "link": "https://stackoverflow.com/questions/32341027/disappearing-instance-var/32341166#32341166", "title": "Disappearing instance var", "body": "<p>Instance variables belong to particular instances. That's why they are called instance variables.</p>\n\n<p>In line 3, you set the instance variable called <code>@reqs</code> of the object <code>Klass</code>. In line 6, you access the instance variable called <code>@reqs</code> of an instance of the class <code>Klass</code>. Those are two <em>completely</em> different, distinct objects each with its own set of instance variables. Heck, those two objects don't even have the same <em>class</em>! (<code>Klass</code>'s class is <code>Class</code>, whereas <code>Klass.new</code>'s class is <code>Klass</code>.)</p>\n\n<p>In line 6, <code>@reqs</code> is uninitialized, and uninitialized instance variables evaluate to <code>nil</code>.</p>\n\n<p>There are many different ways to fix this, depending on your exact circumstances and requirements, the easiest way would be to initialize the instance variables in the <code>initialize</code> method, after all, that's what that method is there for:</p>\n\n<pre><code>class Klass\n  def initialize(var)\n    ['thing', nil].each do |i|\n      instance_variable_set(:\"@#{i}reqs\", {})\n    end\n\n    @reqs[var] = self\n  end\nend\n\nKlass.new('hello')\n</code></pre>\n\n<p>Remember, the problem was that the instance variables were initialized in one object, and accessed in another. This solution moves the initialization to the same object that was doing the reading.</p>\n\n<p>However, the dual is also possible: move the reading to where the initialized variables are:</p>\n\n<pre><code>class Klass\n  ['thing', nil].each do |i|\n    instance_variable_set(:\"@#{i}reqs\", {})\n  end\n\n  def initialize(var)\n    self.class.instance_variable_get(:@reqs)[var] = self\n  end\nend\n\nKlass.new('hello')\n</code></pre>\n\n<p>This is kind of ugly, so let's add an <code>attr_reader</code>:</p>\n\n<pre><code>class Klass\n  ['thing', nil].each do |i|\n    instance_variable_set(:\"@#{i}reqs\", {})\n  end\n\n  class &lt;&lt; self; attr_reader :reqs end\n\n  def initialize(var)\n    self.class.reqs[var] = self\n  end\nend\n\nKlass.new('hello')\n</code></pre>\n\n<p>Obviously, these two do very different things. It is unclear from your question which of the two you actually want.</p>\n\n<p>A third possibility would be using class variables:</p>\n\n<pre><code>class Klass\n  ['thing', nil].each do |i|\n    class_variable_set(:\"@@#{i}reqs\", {})\n  end\n\n  def initialize(var)\n    @@reqs[var] = self\n  end\nend\n\nKlass.new('hello')\n</code></pre>\n\n<p>Note that this does yet another different thing. Again, whether you want that or not is not clear from your question.</p>\n"}, {"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1441143482, "post_id": 32341248, "comment_id": 52557135, "body": "There&#39;s no reason to use class variables here."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1441150138, "post_id": 32341248, "comment_id": 52559253, "body": "If he wants a hash where a key <code>name</code> stores the object itself, that sounds like he wants to store all objects under different names... it&#39;s easy to infer that he wants a class variable (or a class-level instance variable)"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1441143214, "creation_date": 1441143214, "answer_id": 32341248, "question_id": 32341027, "link": "https://stackoverflow.com/questions/32341027/disappearing-instance-var/32341248#32341248", "title": "Disappearing instance var", "body": "<p>The loop at the top is defining an instance variable for the Class, not for any object of the class.</p>\n\n<p>So for the object, it doesn't exist.</p>\n\n<p>From the looks of it, you want a hash common to the whole class where you store each created object in the hash.  Assuming you don't have issues with class inheritance, you'd be better of with a class variable.</p>\n\n<p>so...</p>\n\n<pre><code>class Klass\n    [\"thing\",nil].each do |i|\n        class_variable_set(\"@@#{i}reqs\", {})\n    end\n    def initialize(var)\n        @@reqs[var] = self\n    end\nend\nKlass.new(\"hello\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "is_accepted": false, "score": 0, "last_activity_date": 1441143508, "creation_date": 1441143508, "answer_id": 32341309, "question_id": 32341027, "link": "https://stackoverflow.com/questions/32341027/disappearing-instance-var/32341309#32341309", "title": "Disappearing instance var", "body": "<p>If you define class like this:</p>\n\n<pre><code>class Klass\n  instance_variable_set(:@name, 'dog')\n\n  def self.name\n    @name\n  end\n\n  def name\n    @name\n  end\nend\n</code></pre>\n\n<p>then</p>\n\n<pre><code>Klass.name # =&gt; 'dog'\n\ninstance = Klass.new\ninstance.name # =&gt; nil\n</code></pre>\n\n<p>Now you can see the difference. Your variable is defined on class level, not instance level.</p>\n"}], "owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 32341166, "answer_count": 3, "score": 0, "last_activity_date": 1441197551, "creation_date": 1441142122, "last_edit_date": 1441197551, "question_id": 32341027, "link": "https://stackoverflow.com/questions/32341027/disappearing-instance-var", "title": "Disappearing instance var", "body": "<p>Here is my code:</p>\n\n<pre><code>class Klass\n  [\"thing\", nil].each do |i|\n    instance_variable_set(\"@#{i}reqs\", {})\n  end\n\n  def initialize(var)\n    @reqs[var] = self\n  end\nend\n\nKlass.new(\"hello\")\n</code></pre>\n\n<p>Which gives me the error:</p>\n\n<p>in <code>initialize': undefined method</code>[]=' for nil:NilClass (NoMethodError)</p>\n\n<p>I shouldn't be getting this error because the loop at the top should have initialized @reqs in it's second iteration. What is going on?</p>\n"}, {"tags": ["ruby", "database", "sqlite", "csv"], "comments": [{"owner": {"reputation": 147, "user_id": 3903556, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7238a329b7d526bfb029bd4953bd438d?s=128&d=identicon&r=PG&f=1", "display_name": "bcan001", "link": "https://stackoverflow.com/users/3903556/bcan001"}, "edited": false, "score": 0, "creation_date": 1441141791, "post_id": 32340957, "comment_id": 52556442, "body": "sorry i said 2 sqlite databases... I meant 2 tables in the SAME sqlite database"}], "answers": [{"tags": [], "owner": {"reputation": 2218, "user_id": 5129208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wfsc3HumFMQ/AAAAAAAAAAI/AAAAAAAAAGw/2TW94iOeLhQ/photo.jpg?sz=128", "display_name": "yez", "link": "https://stackoverflow.com/users/5129208/yez"}, "is_accepted": true, "score": 1, "last_activity_date": 1441144867, "creation_date": 1441144867, "answer_id": 32341576, "question_id": 32340957, "link": "https://stackoverflow.com/questions/32340957/sqlite-relational-database-query-in-ruby/32341576#32341576", "title": "SQLite Relational Database Query in Ruby", "body": "<p>I think this is what you want</p>\n\n<pre><code>SELECT name, sum(sales_amount)\nFROM salesmen INNER JOIN sales on sales.salesmen_id = salesmen.id\nGROUP BY salesmen_id\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 3903556, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7238a329b7d526bfb029bd4953bd438d?s=128&d=identicon&r=PG&f=1", "display_name": "bcan001", "link": "https://stackoverflow.com/users/3903556/bcan001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 32341576, "answer_count": 1, "score": 1, "last_activity_date": 1441144867, "creation_date": 1441141759, "question_id": 32340957, "link": "https://stackoverflow.com/questions/32340957/sqlite-relational-database-query-in-ruby", "title": "SQLite Relational Database Query in Ruby", "body": "<p>I have 2 SQLite databases, Salesmen and Sales. Here's what the original CSV files looked like, but I've already put them in SQLite (just so you can see how the tables are layed out):</p>\n\n<pre><code>Salesmen Table\nid, name\n1, john\n2, luther\n3, bob\n\nSales Table\nid, salesmen_id, sales_amount\n1, 1, 100\n2, 3, 20\n3, 2, 35\n4, 3, 25\n5, 1, 55\n6, 2, 200\n7, 2, 150\n</code></pre>\n\n<p>My question is how do I write a function in ruby that will return all the Salesmen names, sorted by their total sales amount? I know this requires using a join, but I'm not entirely sure how the query should look like.</p>\n\n<p>I want the new table to look like this:</p>\n\n<pre><code>New Table\nname, total_sales\nluther, 385\njohn, 155\nbob, 45\n</code></pre>\n\n<p>The new sqlite query should be in this format:</p>\n\n<pre><code>$db.execute %q{\n    SELECT account_name, units, unit_price \n    FROM accounts, positions\n    ...\n}\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm"], "comments": [{"owner": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "edited": false, "score": 0, "creation_date": 1441139799, "post_id": 32340414, "comment_id": 52555460, "body": "What version of rvm?"}, {"owner": {"reputation": 1142, "user_id": 3562561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5455f5135299cdb6b4640148fa176f9f?s=128&d=identicon&r=PG", "display_name": "treiff", "link": "https://stackoverflow.com/users/3562561/treiff"}, "reply_to_user": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "edited": false, "score": 0, "creation_date": 1441139903, "post_id": 32340414, "comment_id": 52555510, "body": "RVM version is: 1.26.11"}, {"owner": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "edited": false, "score": 0, "creation_date": 1441140013, "post_id": 32340414, "comment_id": 52555565, "body": "and <code>which rails</code> returns?"}, {"owner": {"reputation": 1142, "user_id": 3562561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5455f5135299cdb6b4640148fa176f9f?s=128&d=identicon&r=PG", "display_name": "treiff", "link": "https://stackoverflow.com/users/3562561/treiff"}, "reply_to_user": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "edited": false, "score": 0, "creation_date": 1441140328, "post_id": 32340414, "comment_id": 52555726, "body": "<code>&#47;Users&#47;trevor&#47;.rvm&#47;gems&#47;ruby-2.2.2&#47;bin&#47;rails</code>"}, {"owner": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "edited": false, "score": 0, "creation_date": 1441141092, "post_id": 32340414, "comment_id": 52556119, "body": "Assuming that you&#39;re working in your Desktop directory and that doesn&#39;t have rails files that don&#39;t belongs there, then I would probably run <code>rvm implode</code>  to nuke the rvm installation and re-install it."}, {"owner": {"reputation": 1142, "user_id": 3562561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5455f5135299cdb6b4640148fa176f9f?s=128&d=identicon&r=PG", "display_name": "treiff", "link": "https://stackoverflow.com/users/3562561/treiff"}, "reply_to_user": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "edited": false, "score": 0, "creation_date": 1441141636, "post_id": 32340414, "comment_id": 52556386, "body": "Yeah, I&#39;m going to do some more searching around, but will probably end up going that route.  I&#39;ll let you know. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 1459209, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a6a170c33a7a70686cd5314979755771?s=128&d=identicon&r=PG", "display_name": "Matt Ramirez", "link": "https://stackoverflow.com/users/1459209/matt-ramirez"}, "edited": false, "score": 0, "creation_date": 1454706064, "post_id": 32343270, "comment_id": 58181509, "body": "Great tip for a beginner"}], "tags": [], "owner": {"reputation": 1142, "user_id": 3562561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5455f5135299cdb6b4640148fa176f9f?s=128&d=identicon&r=PG", "display_name": "treiff", "link": "https://stackoverflow.com/users/3562561/treiff"}, "is_accepted": true, "score": 2, "last_activity_date": 1441156964, "creation_date": 1441156964, "answer_id": 32343270, "question_id": 32340414, "link": "https://stackoverflow.com/questions/32340414/rvm-rails-loaderror/32343270#32343270", "title": "RVM, Rails LoadError", "body": "<p>Figured it out, but wanted to post in case someone else is in the same boat.  After I realized <code>rails new</code> would work in other directories, obviously something was going on with creating projects on the desktop. </p>\n\n<p>Bottom line, make sure you have no file/directories in the directory where your running a rails command named <code>script</code>.  There are probably other file/directory names that could cause conflict as well.</p>\n"}], "owner": {"reputation": 1142, "user_id": 3562561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5455f5135299cdb6b4640148fa176f9f?s=128&d=identicon&r=PG", "display_name": "treiff", "link": "https://stackoverflow.com/users/3562561/treiff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 32343270, "answer_count": 1, "score": 2, "last_activity_date": 1441156964, "creation_date": 1441139676, "last_edit_date": 1441152678, "question_id": 32340414, "link": "https://stackoverflow.com/questions/32340414/rvm-rails-loaderror", "title": "RVM, Rails LoadError", "body": "<p>I am having a issue getting a new rails project up and running.  Its been a while since I've created a new project, but have been working on various work related projects with many different rails/ruby versions (all fine).  That said, I just tried to create a new project and when I run <code>rails -v</code> or <code>rails new xxxx</code> for that matter I get:</p>\n\n<pre><code>/Users/trevor/.rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require': cannot load such file -- /Users/trevor/Desktop/config/boot (LoadError)\nfrom /Users/trevor/.rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require'\nfrom script/rails:5:in `&lt;main&gt;'\n</code></pre>\n\n<p><strong>Specifics</strong></p>\n\n<p><strong>ruby -v =></strong> <code>ruby 2.2.2p95 (2015-04-13 revision 50295) [x86_64-darwin14]</code> * using RVM\n<strong>which ruby =></strong> <code>/Users/trevor/.rvm/rubies/ruby-2.2.2/bin/ruby</code><br>\n<strong>gem list =></strong> shows all necessary gems (i.e rails, bundler etc)<br>\n<strong>rvm info =></strong></p>\n\n<pre><code>ruby-2.2.2:\n\n  system:\n    uname:       \"Darwin Trevor.local 14.5.0 Darwin Kernel Version 14.5.0: Wed Jul 29 02:26:53 PDT 2015; root:xnu-2782.40.9~1/RELEASE_X86_64 x86_64\"\n    system:      \"osx/10.10/x86_64\"\n    bash:        \"/bin/bash =&gt; GNU bash, version 3.2.57(1)-release (x86_64-apple-darwin14)\"\n    zsh:         \"/usr/local/bin/zsh =&gt; zsh 5.0.8 (x86_64-apple-darwin14.3.0)\"\n\n  rvm:\n    version:      \"rvm 1.26.11 (latest) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\"\n    updated:      \"2 months 7 days 5 hours 33 minutes 19 seconds ago\"\n    path:         \"/Users/trevor/.rvm\"\n\n  ruby:\n    interpreter:  \"ruby\"\n    version:      \"2.2.2p95\"\n    date:         \"2015-04-13\"\n    platform:     \"x86_64-darwin14\"\n    patchlevel:   \"2015-04-13 revision 50295\"\n    full_version: \"ruby 2.2.2p95 (2015-04-13 revision 50295) [x86_64-darwin14]\"\n\n  homes:\n    gem:          \"/Users/trevor/.rvm/gems/ruby-2.2.2\"\n    ruby:         \"/Users/trevor/.rvm/rubies/ruby-2.2.2\"\n\n  binaries:\n    ruby:         \"/Users/trevor/.rvm/rubies/ruby-2.2.2/bin/ruby\"\n    irb:          \"/Users/trevor/.rvm/rubies/ruby-2.2.2/bin/irb\"\n    gem:          \"/Users/trevor/.rvm/rubies/ruby-2.2.2/bin/gem\"\n    rake:         \"/Users/trevor/.rvm/rubies/ruby-2.2.2/bin/rake\"\n\n  environment:\n    PATH:         \"/Users/trevor/.rvm/gems/ruby-2.2.2/bin:/Users/trevor/.rvm/gems/ruby-2.2.2@global/bin:/Users/trevor/.rvm/rubies/ruby-2.2.2/bin:/Users/trevor/.rvm/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:bin:/Users/trevor/bin:/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:/usr/local/git/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/mysql/bin\"\n    GEM_HOME:     \"/Users/trevor/.rvm/gems/ruby-2.2.2\"\n    GEM_PATH:     \"/Users/trevor/.rvm/gems/ruby-2.2.2:/Users/trevor/.rvm/gems/ruby-2.2.2@global\"\n    MY_RUBY_HOME: \"/Users/trevor/.rvm/rubies/ruby-2.2.2\"\n    IRBRC:        \"/Users/trevor/.rvm/rubies/ruby-2.2.2/.irbrc\"\n    RUBYOPT:      \"\"\n    gemset:       \"\"\n</code></pre>\n\n<p><strong>What I've Tried</strong></p>\n\n<ul>\n<li><code>rvm gemset empty</code>, empty the current <code>default</code> gemset</li>\n<li><code>gem install rails</code></li>\n<li>Typically I have different gemsets for every project, I switched to one using <code>2.2.2</code> with a different gemset, <code>rails new</code> does not work in that config either. </li>\n<li>This line in the error seems strange to me: <code>require': cannot load such file -- /Users/trevor/Desktop/config/boot (LoadError)</code> Why would rails be looking on the desktop/config for a boot file?</li>\n<li>Preformed <code>rvm implode</code>, reinstalled rvm, same results.  However, I did notice that by changing directories I am able to create new projects.  For some reason the error has to do with trying to create a project while in <code>Users/trevor/Desktop</code>.</li>\n</ul>\n"}, {"tags": ["ruby", "emacs"], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 3497006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c0cbde1ec2eddcdd7d5f14752131cb?s=128&d=identicon&r=PG&f=1", "display_name": "sfoop", "link": "https://stackoverflow.com/users/3497006/sfoop"}, "edited": false, "score": 0, "creation_date": 1441141364, "post_id": 32340666, "comment_id": 52556266, "body": "...automatically propagating old .emacs files leads to strange things. I feel dumb."}], "tags": [], "owner": {"reputation": 3477, "user_id": 615245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15a41553cc73e877f5809c1a9bde8eef?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/615245/dmitry"}, "is_accepted": true, "score": 0, "last_activity_date": 1441153727, "last_edit_date": 1441153727, "creation_date": 1441140623, "answer_id": 32340666, "question_id": 32340391, "link": "https://stackoverflow.com/questions/32340391/emacs-24-function-definition-is-void-ruby-indent-command/32340666#32340666", "title": "Emacs 24 function definition is void: ruby-indent-command", "body": "<p>It's not defined anywhere in Emacs versions 24.2 to 24.5 (those are the only ones I've checked right now), nor is it referenced anywhere.</p>\n\n<p>So you should look into your config and figure out why pressing <code>RET</code> results in an attempt to call it.</p>\n"}], "owner": {"reputation": 502, "user_id": 3497006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c0cbde1ec2eddcdd7d5f14752131cb?s=128&d=identicon&r=PG&f=1", "display_name": "sfoop", "link": "https://stackoverflow.com/users/3497006/sfoop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 32340666, "answer_count": 1, "score": 0, "last_activity_date": 1441153727, "creation_date": 1441139554, "question_id": 32340391, "link": "https://stackoverflow.com/questions/32340391/emacs-24-function-definition-is-void-ruby-indent-command", "title": "Emacs 24 function definition is void: ruby-indent-command", "body": "<p>On a fresh installation of emacs 24.3.1, I can't edit ruby files because hitting return results in an error,</p>\n\n<blockquote>\n  <p>Symbol's function definition is void: ruby-indent-command</p>\n</blockquote>\n\n<p>What's it supposed to be defined to? This happens on a fresh install of Ubuntu 14.04 with <code>apt-get install emacs</code>. I have a few AWS instances with it so I'd rather not do something complicated like installing a different ruby mode.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1441140620, "post_id": 32340210, "comment_id": 52555874, "body": "Can you please post the true Array? Is this an Array of Hashes or is it a multi dimensional Array? With True data it will be easier to determine a functional efficient solution to the problem."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1441145325, "post_id": 32340210, "comment_id": 52557873, "body": "...and while you&#39;re at it, please assign it to a variable (e.g., <code>cities = [ {city: &quot;Bakersfield&quot;, state: &quot;California&quot;, Interstates: [&quot;I-5&quot;] }, ... ]</code>, so readers can refer to <code>cities</code> without having to define it."}], "answers": [{"comments": [{"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1441139415, "post_id": 32340318, "comment_id": 52555284, "body": "consider <code>(mapping[interstate] ||= []) &lt;&lt; city</code>. Looks weird first, but once you got the hang of it it becomes useful in probably many places."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1441140687, "post_id": 32340318, "comment_id": 52555908, "body": "@Felix In that case why not consider <code>mapping = Hash.new {|h,k| h[k] = []}</code> Then it would just be <code>mapping[interstate] &lt;&lt; city</code>."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1441174791, "post_id": 32340318, "comment_id": 52565614, "body": "@engineersmnky Yes, thats another possibility."}], "tags": [], "owner": {"reputation": 4103, "user_id": 4271125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VQnWR.jpg?s=128&g=1", "display_name": "djaszczurowski", "link": "https://stackoverflow.com/users/4271125/djaszczurowski"}, "is_accepted": false, "score": 1, "last_activity_date": 1441139244, "creation_date": 1441139244, "answer_id": 32340318, "question_id": 32340210, "link": "https://stackoverflow.com/questions/32340210/group-array-of-objects-by-their-array-property-elements/32340318#32340318", "title": "Group array of objects by their array property elements", "body": "<p>try this</p>\n\n<pre><code>mapping = {}\n\ncities.each do |city|\n    city.interstates.each do |interstate|\n      mapping[interstate] ||= []\n      mapping[interstate] &lt;&lt; city\n    end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2044, "user_id": 1107211, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mte2a.jpg?s=128&g=1", "display_name": "wurde", "link": "https://stackoverflow.com/users/1107211/wurde"}, "is_accepted": false, "score": 0, "last_activity_date": 1441140602, "creation_date": 1441140602, "answer_id": 32340664, "question_id": 32340210, "link": "https://stackoverflow.com/questions/32340210/group-array-of-objects-by-their-array-property-elements/32340664#32340664", "title": "Group array of objects by their array property elements", "body": "<pre><code>cities = {\n  'Bakersfield' =&gt; {\n    state: 'California',\n    interstate: ['I-5']\n  },\n  'Oakland' =&gt; {\n    state: 'California',\n    interstate: ['I-80']\n  },\n  'Atlanta' =&gt; {\n    state: 'Georgia',\n    interstate: [\"I-20\", \"I-75\", \"I-86\"]\n  },\n  'Cleveland' =&gt; {\n    state: 'Ohio',\n    interstate: [\"I-71\", \"I-77\", \"I-80\", \"I-90\"]\n  },\n  'Arlington' =&gt; {\n    state: 'Texas',\n    interstate: [\"I-20\", \"I-30\"]\n  }\n}\n\ninterstates = {}\ncities.each do |city|\n  city[1][:interstate].each do |road|\n    interstates[road] ||= []\n    interstates[road] &lt;&lt; city[0]\n  end\nend\n\nputs interstates.inspect\n#=&gt; {\n#=&gt;   \"I-5\"=&gt;[\"Bakersfield\"],\n#=&gt;   \"I-80\"=&gt;[\"Oakland\", \"Cleveland\"],\n#=&gt;   \"I-20\"=&gt;[\"Atlanta\", \"Arlington\"],\n#=&gt;   \"I-75\"=&gt;[\"Atlanta\"],\n#=&gt;   \"I-86\"=&gt;[\"Atlanta\"],\n#=&gt;   \"I-71\"=&gt;[\"Cleveland\"],\n#=&gt;   \"I-77\"=&gt;[\"Cleveland\"],\n#=&gt;   \"I-90\"=&gt;[\"Cleveland\"],\n#=&gt;   \"I-30\"=&gt;[\"Arlington\"]\n#=&gt; }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1441140965, "creation_date": 1441140965, "answer_id": 32340774, "question_id": 32340210, "link": "https://stackoverflow.com/questions/32340210/group-array-of-objects-by-their-array-property-elements/32340774#32340774", "title": "Group array of objects by their array property elements", "body": "<p>Given the assumption that @wurde's Hash structure is true I would do something like this </p>\n\n<pre><code>cities = {\n  'Bakersfield' =&gt; {\n    state: 'California',\n    interstate: ['I-5']\n  },\n  'Oakland' =&gt; {\n    state: 'California',\n    interstate: ['I-80']\n  },\n  'Atlanta' =&gt; {\n    state: 'Georgia',\n    interstate: [\"I-20\", \"I-75\", \"I-86\"]\n  },\n  'Cleveland' =&gt; {\n    state: 'Ohio',\n    interstate: [\"I-71\", \"I-77\", \"I-80\", \"I-90\"]\n  },\n  'Arlington' =&gt; {\n    state: 'Texas',\n    interstate: [\"I-20\", \"I-30\"]\n  }\n}\n\n\ncities.each_with_object(Hash.new {|h,k| h[k] = []}) do |(city_name,data),h|\n  data[:interstate].each do |interstate|\n    h[interstate] &lt;&lt; \"#{city_name}, #{data[:state]}\"\n  end\nend\n#=&gt; {\"I-5\"=&gt;[\"Bakersfield, California\"], \n     \"I-80\"=&gt;[\"Oakland, California\", \"Cleveland, Ohio\"], \n     \"I-20\"=&gt;[\"Atlanta, Georgia\", \"Arlington, Texas\"], \n     \"I-75\"=&gt;[\"Atlanta, Georgia\"], \n     \"I-86\"=&gt;[\"Atlanta, Georgia\"], \n     \"I-71\"=&gt;[\"Cleveland, Ohio\"], \n     \"I-77\"=&gt;[\"Cleveland, Ohio\"], \n     \"I-90\"=&gt;[\"Cleveland, Ohio\"], \n     \"I-30\"=&gt;[\"Arlington, Texas\"]}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1441141129, "post_id": 32340777, "comment_id": 52556133, "body": "why not <code>interstates = cities.values.flatten</code>? I don&#39;t see a need to inject a <code>Set</code>"}, {"owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1441141185, "post_id": 32340777, "comment_id": 52556168, "body": "Is it good in terms of performance? I have feeling <code>Set</code> should perform it much faster. Your version is much shorter though."}, {"owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1441141710, "post_id": 32340777, "comment_id": 52556417, "body": "@engineersmnky btw, the full version is <code>interstates = cities.values.flatten.uniq</code>"}], "tags": [], "owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "is_accepted": false, "score": 0, "last_activity_date": 1441171908, "last_edit_date": 1441171908, "creation_date": 1441140971, "answer_id": 32340777, "question_id": 32340210, "link": "https://stackoverflow.com/questions/32340210/group-array-of-objects-by-their-array-property-elements/32340777#32340777", "title": "Group array of objects by their array property elements", "body": "<p>We have:</p>\n\n<pre><code>cities = {\n  'Bakersfield' =&gt; ['I-5'],\n  'Oakland' =&gt; ['I-80'],\n  'Atlanta' =&gt; [\"I-20\", \"I-75\", \"I-86\"],\n  'Cleveland' =&gt; [\"I-71\", \"I-77\", \"I-80\", \"I-90\"],\n  'Arlington' =&gt; [\"I-20\", \"I-30\"]\n}\n</code></pre>\n\n<p><strong>Longer version</strong> We can get what you want by this operations:</p>\n\n<pre><code>require 'set'\ninterstates = cities.inject(Set.new){|all,item| all+item[1]} # =&gt; #&lt;Set: {\"I-5\", \"I-80\", \"I-20\", \"I-75\", \"I-86\", \"I-71\", \"I-77\", \"I-90\", \"I-30\"}&gt;\nresult = interstates.map{|inter| [inter, cities.select{|_,interstates| interstates.include?(inter)}.keys]}.to_h # =&gt; {\"I-5\"=&gt;[\"Bakersfield\"], \"I-80\"=&gt;[\"Oakland\", \"Cleveland\"], \"I-20\"=&gt;[\"Atlanta\", \"Arlington\"], \"I-75\"=&gt;[\"Atlanta\"], \"I-86\"=&gt;[\"Atlanta\"], \"I-71\"=&gt;[\"Cleveland\"], \"I-77\"=&gt;[\"Cleveland\"], \"I-90\"=&gt;[\"Cleveland\"], \"I-30\"=&gt;[\"Arlington\"]}\n</code></pre>\n\n<p>We use <code>Set</code> because it's efficient in given settings (for more elegant syntax, see note below). On line 2 we get all <code>interstates</code> using <code>Enumerable</code>'s <code>inject</code> method. Final result is obtained on line 3, where we use mapping and filtering (<code>map</code> and <code>select</code> methods). Note, that <code>to_h</code> method is available from Ruby 2.1. If you are on older Ruby, you can convert mapped array to <code>Hash</code> using <code>Hash[array]</code>.</p>\n\n<p><strong>One-liner</strong> It can even be written as one-liner:</p>\n\n<pre><code>cities.inject(Set.new){|all,item| all+item[1]}.map{|inter| [inter, cities.select{|_,interstates| interstates.include?(inter)}.keys]}.to_h\n</code></pre>\n\n<p><strong>Note</strong> I included <code>Set</code> here for performance. If you prefer readability, then it's much shorter simply write <code>interstates = cities.values.flatten.uniq</code>, as @engineersmnky noted in comment.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1441146496, "last_edit_date": 1441146496, "creation_date": 1441146174, "answer_id": 32341802, "question_id": 32340210, "link": "https://stackoverflow.com/questions/32340210/group-array-of-objects-by-their-array-property-elements/32341802#32341802", "title": "Group array of objects by their array property elements", "body": "<p>Using @wurde's example (thank you, thank you, thank you):</p>\n\n<pre><code>cities.each_with_object({}) do |(k,g),h|\n  g[:interstate].each { |i| h.update(i=&gt;[k]) { |_,o,n| o+n } }\nend\n  #=&gt; {\"I-5\" =&gt;[\"Bakersfield\"],\n  #    \"I-80\"=&gt;[\"Oakland\", \"Cleveland\"],\n  #    \"I-20\"=&gt;[\"Atlanta\", \"Arlington\"],\n  #    \"I-75\"=&gt;[\"Atlanta\"],\n  #    \"I-86\"=&gt;[\"Atlanta\"],\n  #    \"I-71\"=&gt;[\"Cleveland\"],\n  #    \"I-77\"=&gt;[\"Cleveland\"],\n  #    \"I-90\"=&gt;[\"Cleveland\"],\n  #    \"I-30\"=&gt;[\"Arlington\"]} \n</code></pre>\n\n<p>This uses the form of <a href=\"http://ruby-doc.org/core-2.2.0/Hash.html#method-i-update\" rel=\"nofollow\">Hash#update</a> (aka <code>merge!</code>) that uses the block:</p>\n\n<pre><code>{ |_,o,n| o+n }\n</code></pre>\n\n<p>to determine values of keys that are present in both hashes being merged. The key is the intestate (written <code>_</code> because it is not be used), <code>o</code> is an array of cities for the key in the hash <code>h</code> being constructed and <code>n</code> is an array of a single city for the merging hash <code>{ i=&gt;[k] }</code>. </p>\n"}], "owner": {"reputation": 27, "user_id": 5289984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909bcc52da039c0bfb70d8d7f8ed77fd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Grases", "link": "https://stackoverflow.com/users/5289984/luis-grases"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1441210234, "creation_date": 1441138775, "last_edit_date": 1441210234, "question_id": 32340210, "link": "https://stackoverflow.com/questions/32340210/group-array-of-objects-by-their-array-property-elements", "title": "Group array of objects by their array property elements", "body": "<p>I have this array of cities: </p>\n\n<pre><code>Bakersfield, California\nInterstates: [\"I-5\"]\n\nOakland, California\nInterstates: [\"I-80\"]\n\nAtlanta, Georgia\nInterstates: [\"I-20\", \"I-75\", \"I-86\"]\n\nCleveland, Ohio\nInterstates: [\"I-71\", \"I-77\", \"I-80\", \"I-90\"]\n\nArlington, Texas\nInterstates: [\"I-20\", \"I-30\"]\n</code></pre>\n\n<p>The name, the state and the interstates array are properties of each city.</p>\n\n<p>I want to group them by their interstates so the final result would look something like this:</p>\n\n<pre><code>I-20: [Arlington, Atlanta]\nI-5: [Bakersfield]\nI-86: [Atlanta]\n...\n</code></pre>\n\n<p>Is there a quick way to do this?</p>\n\n<p>EDIT: Here is the true array, just as @wurde example.</p>\n\n<pre><code>cities = {\n  'Bakersfield' =&gt; {\n    state: 'California',\n    interstate: ['I-5']\n  },\n  'Oakland' =&gt; {\n    state: 'California',\n    interstate: ['I-80']\n  },\n  'Atlanta' =&gt; {\n    state: 'Georgia',\n    interstate: [\"I-20\", \"I-75\", \"I-86\"]\n  },\n  'Cleveland' =&gt; {\n    state: 'Ohio',\n    interstate: [\"I-71\", \"I-77\", \"I-80\", \"I-90\"]\n  },\n  'Arlington' =&gt; {\n    state: 'Texas',\n    interstate: [\"I-20\", \"I-30\"]\n  }\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "edited": false, "score": 0, "creation_date": 1441139037, "post_id": 32340166, "comment_id": 52555101, "body": "Which version of Ruby you are using?"}, {"owner": {"reputation": 1332, "user_id": 2217676, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/hnEt0.jpg?s=128&g=1", "display_name": "Amir Nabaei", "link": "https://stackoverflow.com/users/2217676/amir-nabaei"}, "reply_to_user": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "edited": false, "score": 0, "creation_date": 1441139194, "post_id": 32340166, "comment_id": 52555174, "body": "@AtulKhanduri Ruby 2.2.2"}], "answers": [{"comments": [{"owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "edited": false, "score": 0, "creation_date": 1441139382, "post_id": 32340333, "comment_id": 52555270, "body": "Haha that&#39;s what I was typing, that&#39;s why I asked for Ruby Version.. :D"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3855476"}, "edited": false, "score": 0, "creation_date": 1441139572, "post_id": 32340333, "comment_id": 52555372, "body": "Always happy to help. :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3855476"}, "is_accepted": true, "score": 1, "last_activity_date": 1441139331, "last_edit_date": 1495540287, "creation_date": 1441139331, "answer_id": 32340333, "question_id": 32340166, "link": "https://stackoverflow.com/questions/32340166/running-rails-server-gives-error-can-not-load-such-a-file-nokogiri-nokogiri/32340333#32340333", "title": "running rails server gives error can not load such a file -- nokogiri/nokogiri", "body": "<p>Nokogiri doesn't support Ruby 2.2 on windows.</p>\n\n<p>See <a href=\"https://stackoverflow.com/a/29007731/2945616\">this</a> answer.</p>\n\n<p>Also check <a href=\"http://makandracards.com/makandra/18139-cannot-load-such-file-nokogiri-nokogiri-or-any-other-gem-with-native-extensions-on-rvm-and-ruby-2\" rel=\"nofollow noreferrer\">this</a> for more assistance.</p>\n"}], "owner": {"reputation": 1332, "user_id": 2217676, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/hnEt0.jpg?s=128&g=1", "display_name": "Amir Nabaei", "link": "https://stackoverflow.com/users/2217676/amir-nabaei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 947, "favorite_count": 0, "accepted_answer_id": 32340333, "answer_count": 1, "score": 0, "last_activity_date": 1441139331, "creation_date": 1441138603, "last_edit_date": 1441139069, "question_id": 32340166, "link": "https://stackoverflow.com/questions/32340166/running-rails-server-gives-error-can-not-load-such-a-file-nokogiri-nokogiri", "title": "running rails server gives error can not load such a file -- nokogiri/nokogiri", "body": "<p>I am new in ROR When I want to run rails s, it gives me the above error, I already install gem nokogiri and bundle but still same problem exists. I use windows 7. I use ruby version 2.2.2 and rails 4.2.4</p>\n\n<pre><code>   C:\\sites\\simple_cms&gt;rails s\nC:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/nokogiri-1.6.6.2-x64-       mingw32/lib/nokogiri\n .rb:29:in `require': cannot load such file -- nokogiri/nokogiri (LoadError)\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/nokogiri-1.6.6.2-x64-mingw32\n/lib/nokogiri.rb:29:in `rescue in &lt;top (required)&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/nokogiri-1.6.6.2-x64-mingw32\n/lib/nokogiri.rb:25:in `&lt;top (required)&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/loofah-2.0.3/lib/loofah.rb:3\n:in `require'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/loofah-2.0.3/lib/loofah.rb:3\n:in `&lt;top (required)&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/rails-html-sanitizer-1.0.2/l\nib/rails-html-sanitizer.rb:2:in `require'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/rails-html-sanitizer-1.0.2/l\nib/rails-html-sanitizer.rb:2:in `&lt;top (required)&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\nview/helpers/sanitize_helper.rb:3:in `require'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n view/helpers/sanitize_helper.rb:3:in `&lt;top (required)&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n view/helpers/text_helper.rb:32:in `&lt;module:TextHelper&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n  view/helpers/text_helper.rb:29:in `&lt;module:Helpers&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n view/helpers/text_helper.rb:6:in `&lt;module:ActionView&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n view/helpers/text_helper.rb:4:in `&lt;top (required)&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n view/helpers/form_tag_helper.rb:18:in `&lt;module:FormTagHelper&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n  view/helpers/form_tag_helper.rb:14:in `&lt;module:Helpers&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n   view/helpers/form_tag_helper.rb:8:in `&lt;module:ActionView&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n   view/helpers/form_tag_helper.rb:6:in `&lt;top (required)&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n  view/helpers/form_helper.rb:4:in `require'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n    view/helpers/form_helper.rb:4:in `&lt;top (required)&gt;'\n    from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.4/lib/action_\n\n    from bin/rails:4:in `require'\n    from bin/rails:4:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "puppet", "beaker-testing"], "owner": {"reputation": 2936, "user_id": 2977760, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/706f6a6f8d0316cfae7c6dbd552c311f?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhjot", "link": "https://stackoverflow.com/users/2977760/prabhjot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1441138101, "creation_date": 1441138101, "question_id": 32340057, "link": "https://stackoverflow.com/questions/32340057/beaker-error-getaddrinfo-name-or-service-not-known", "title": "Beaker Error: getaddrinfo: Name or service not known", "body": "<p>I am writing an acceptance test for my Puppet module using Beaker. My module depends on PuppetDB to get some info. To add PuppetDB dependency, I added <code>dependency 'puppetlabs/puppetdb'</code> to my Modulefile and this</p>\n\n<pre><code>mod 'puppetlabs/puppetdb',\n   path: 'puppet',\n   git: 'https://github.com/puppetlabs/puppetdb.git'\n</code></pre>\n\n<p>to my Puppetfile. However, when I run my acceptance test, I get <code>Error: getaddrinfo: Name or service not known</code></p>\n\n<p>I googled and tried multiple approaches like giving the correct permission to /etc/hosts file, manually running PuppetDB on the VM created by Beaker, but I can't go past this error. It would be great if anyone put me in right direction. Considering I am new to Puppet and Beaker, is it even possible to write an acceptance test for the module that depends on PuppetDB?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1785, "user_id": 3373470, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8f968c218643a09267014e4beaeb4770?s=128&d=identicon&r=PG&f=1", "display_name": "onebree", "link": "https://stackoverflow.com/users/3373470/onebree"}, "edited": false, "score": 2, "creation_date": 1441137816, "post_id": 32339938, "comment_id": 52554433, "body": "Please format your code by clicking <code>{}</code> in the editor. Your question is also very unclear. What have you tried so far? SO is not the place to ask &quot;how do I do XYZ&quot;, <i>without</i> error messages or previous attempts you made"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441138157, "post_id": 32339938, "comment_id": 52554612, "body": "Could the string be  <code>&quot;TXDAT - SnpRespData_SC_PD (7) or SnpRespData_SC&quot;</code>? If &#39;yes&#39;, what would be the desired values of the six variables?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1441139238, "post_id": 32339938, "comment_id": 52555191, "body": "Are you looking for the string <code>&quot;SnpRespData&quot;</code> or is the string to be identified in some other manner?  For example, <code>&quot;TXDAT&quot;</code>, <code>&quot;-&quot;</code>, <code>&quot;or&quot;</code> or <code>&quot;(..)&quot;</code> could be keywords to guide the search."}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1441139057, "creation_date": 1441139057, "answer_id": 32340273, "question_id": 32339938, "link": "https://stackoverflow.com/questions/32339938/better-way-to-return-values-from-split/32340273#32340273", "title": "Better way to return values from split", "body": "<p>I assume that you are looking for a specific string, namely, <code>\"SnpRespData\"</code>. If so, you could do this:</p>\n\n<pre><code>str = \"TXDAT - SnpRespData_SC or SnpRespData_SC_PD (7)\"\n\nf, l = str.scan(/SnpRespData\\w+/).sort\n  #=&gt; [\"SnpRespData_SC\", \"SnpRespData_SC_PD\"] \ntype_0, resp_0, pd_0 = f.split('_') &lt;&lt; 0\n  #=&gt; [\"SnpRespData\", \"SC\", 0] \ntype_1, resp_1, pd_1 = f.split('_').first(2) &lt;&lt; 1\n  #=&gt; [\"SnpRespData\", \"SC\", 1]\n\ntype_0 #=&gt; \"SnpRespData\" \nresp_0 #=&gt; \"SC\" \npd_0   #=&gt; 0 \n\ntype_1 #=&gt; \"SnpRespData\" \nresp_1 #=&gt; \"SC\" \npd_1   #=&gt; 1 \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5289931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2423664189372256bcbcdeebda85a0e0?s=128&d=identicon&r=PG&f=1", "display_name": "NidN", "link": "https://stackoverflow.com/users/5289931/nidn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1441204587, "creation_date": 1441137531, "last_edit_date": 1441204587, "question_id": 32339938, "link": "https://stackoverflow.com/questions/32339938/better-way-to-return-values-from-split", "title": "Better way to return values from split", "body": "<p>I need to parse a field from a CSV column which is a string:</p>\n\n<pre><code>TXDAT - SnpRespData_SC or SnpRespData_SC_PD (7)\n</code></pre>\n\n<p>I need to extract:</p>\n\n<pre><code>type_0 = SnpRespData\nresp_0 = SC\npd_0 = 0\ntype_1 = SnpRespData\nresp_1 = SC\npd_1 = 1\n</code></pre>\n\n<p>from this string. I want to pass the whole string to a function and be able to return these six values. </p>\n\n<p>The string could be any of the following:<br>\na) TXDAT - SnpRespData_SC_PD<br>\nb) TXRSP - SnpResp_SC<br>\nc) TXDAT - SnpRespData_SC or SnpRespData_SC_PD (7)<br>\nd) TXRSP - SnpResp_UC or TXDAT - SnpRespData_UC_PD (7)  </p>\n\n<p>So I created a function which receives this string and returns the following:<br>\ndef map_rxsnp_transaction(rxsnp_transaction)<br>\n   tx_dat = []<br>\n   tx_rsp = []<br>\n   case rxsnp_transaction<br>\n       when (/SnpRespData.*SnpRespData/)<br>\n           tx_dat = rxsnp_transaction.split(/or/)<br>\n           (tx_dat_0, dat_0_resp, dat_0_pd) = tx_dat[0].split(/_/)<br>\n      (tx_dat_1, dat_1_resp, dat_1_pd) = tx_dat[1].split(/_/)<br>\n      return [tx_dat_0, dat_0_resp, dat_0_pd, tx_dat_1, dat_1_resp, dat_1_pd]<br>\n    when (/SnpResp.*SnpRespData/)<br>\n      (tx_rsp, tx_dat) = rxsnp_transaction.split(/or/)<br>\n      (tx_rsp, rsp_resp, rsp_pd) = tx_rsp.split(/_/)<br>\n      (tx_dat, dat_resp, dat_pd) = tx_dat.split(/_/)<br>\n      return [tx_rsp, rsp_resp, rsp_pd, tx_dat, dat_resp, dat_pd]<br>\n    when (/SnpRespData_{1}/)<br>\n      return rxsnp_transaction.split(/<em>/)<br>\n    when (/SnpResp</em>{1}/)<br>\n      return rxsnp_transaction.split(/_/)<br>\n    end<br>\n end  </p>\n\n<p>Function call:<br>\n(tx_rsp[0],tx_rsp[1],tx_rsp[2],tx_rsp[3],tx_rsp[4],tx_rsp[5]) = map_rxsnp_transaction table_col[5]  </p>\n\n<p>Just wondering if I can optimize this code better...don't like the way it   </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 803, "user_id": 4739356, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2840861b630380bb691a2e7b793c22ca?s=128&d=identicon&r=PG&f=1", "display_name": "M.T Davis", "link": "https://stackoverflow.com/users/4739356/m-t-davis"}, "edited": false, "score": 0, "creation_date": 1441986149, "post_id": 32339951, "comment_id": 52912495, "body": "@Andrey-denineko that seems to fix my problem. After reviewing my code a little more, I was able to see the problem. Thanks."}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 1, "last_activity_date": 1441138727, "last_edit_date": 1441138727, "creation_date": 1441137589, "answer_id": 32339951, "question_id": 32339778, "link": "https://stackoverflow.com/questions/32339778/nomethoderror-in-insurancesnew/32339951#32339951", "title": "NoMethodError in Insurances#new", "body": "<p>You don't seem to have <code>insurance</code> within whitelisted attributes (in <code>insurance_params</code>) and most likely you did not define such field in database (and why would you define an attribute identical to model name? :)),</p>\n\n<p>So the following raises an error:</p>\n\n<pre><code>      &lt;%= f.label :insurance %&gt;&lt;br&gt;\n      &lt;%= f.text_field :insurance, class: \"form-control\" %&gt;\n</code></pre>\n\n<p>What you probably want is</p>\n\n<pre><code>      &lt;%= f.label :name %&gt;&lt;br&gt;\n      &lt;%= f.text_field :name, class: \"form-control\" %&gt;\n</code></pre>\n"}], "owner": {"reputation": 803, "user_id": 4739356, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2840861b630380bb691a2e7b793c22ca?s=128&d=identicon&r=PG&f=1", "display_name": "M.T Davis", "link": "https://stackoverflow.com/users/4739356/m-t-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 32339951, "answer_count": 1, "score": 0, "last_activity_date": 1441138727, "creation_date": 1441136863, "question_id": 32339778, "link": "https://stackoverflow.com/questions/32339778/nomethoderror-in-insurancesnew", "title": "NoMethodError in Insurances#new", "body": "<p>I need a second pair of eyes. I'm not really sure what I'm missing. </p>\n\n<p>I created a new scaffold <code>rails generate scaffold Insurance string:name</code> followed by a <code>rake db:migrate</code>. However, when I go to the newly created page and select \"New Insurance\" I get the following error message.</p>\n\n<p><em>NoMethodError in Insurances#new Showing /home/ubuntu/workspace/app/views/insurances/_form.html.erb where line #5 raised:\nundefined method `insurance' for # Extracted source (around line #5):</em></p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n      &lt;%= f.label :insurance %&gt;&lt;br&gt;\n      &lt;%= f.text_field :insurance, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"actions\"&gt;\n      &lt;%= f.submit class: \"btn btn-primary\" %&gt;\n</code></pre>\n\n<p>I'm sure it's something easy I just don't see it.</p>\n\n<p>Insurance controller:</p>\n\n<pre><code>class InsurancesController &lt; ApplicationController\n  before_action :set_insurance, only: [:show, :edit, :update, :destroy]\n\n  respond_to :html\n\n  def index\n    @insurances = Insurance.all\n    respond_with(@insurances)\n  end\n\n  def show\n    respond_with(@insurance)\n  end\n\n  def new\n    @insurance = Insurance.new\n    respond_with(@insurance)\n  end\n\n  def edit\n  end\n\n  def create\n    @insurance = Insurance.new(insurance_params)\n    @insurance.save\n    respond_with(@insurance)\n  end\n\n  def update\n    @insurance.update(insurance_params)\n    respond_with(@insurance)\n  end\n\n  def destroy\n    @insurance.destroy\n    respond_with(@insurance)\n  end\n\n  private\n    def set_insurance\n      @insurance = Insurance.find(params[:id])\n    end\n\n    def insurance_params\n      params.require(:insurance).permit(:name)\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "nokogiri", "open-uri"], "comments": [{"owner": {"reputation": 7240, "user_id": 1426097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV7IQ.jpg?s=128&g=1", "display_name": "dimakura", "link": "https://stackoverflow.com/users/1426097/dimakura"}, "edited": false, "score": 0, "creation_date": 1441138001, "post_id": 32339776, "comment_id": 52554521, "body": "I tried it for Ruby 2.1.1p76 it works fine."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1441153468, "post_id": 32339776, "comment_id": 52560035, "body": "Your code works without problems with Ruby 2.2.3. What version of Ruby are you using?"}, {"owner": {"reputation": 413, "user_id": 1392654, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/MC2Xb.jpg?s=128&g=1", "display_name": "While True", "link": "https://stackoverflow.com/users/1392654/while-true"}, "edited": false, "score": 0, "creation_date": 1441182650, "post_id": 32339776, "comment_id": 52569963, "body": "I&#39;m using ruby 2.2.3p173  So, it really can be that the market.yandex.ru blocking me?"}], "owner": {"reputation": 413, "user_id": 1392654, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/MC2Xb.jpg?s=128&g=1", "display_name": "While True", "link": "https://stackoverflow.com/users/1392654/while-true"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441153291, "creation_date": 1441136857, "last_edit_date": 1441153291, "question_id": 32339776, "link": "https://stackoverflow.com/questions/32339776/cant-open-page-with-openuri-because-of-an-eoferror", "title": "Can&#39;t open page with OpenUri because of an EOFError", "body": "<p>I'm trying to load a page to parse with Nokogiri. I have:</p>\n\n<pre><code>require 'open-uri'\nrequire 'nokogiri'\n\ndoc = Nokogiri::HTML(open(\"https://market.yandex.ru/product/10791229/spec\"))\n</code></pre>\n\n<p>as shown in Nokogiri's tutorial.</p>\n\n<p>I get an error:</p>\n\n<pre><code>.../ruby/2.2.0/openssl/buffering.rb:182:in `sysread_nonblock': end of file reached (EOFError)\n</code></pre>\n\n<p>But requesting <code>https://google.com</code> or <code>https://yandex.ru</code> is fine. Getting that URL using curl works also.</p>\n\n<p>Thinking that I was being blocked because of the \"User-Agent\" I tried to add <code>\"User-Agent\" =&gt; specification</code> to <code>open</code> with Mozilla stuff, but still got an error.</p>\n"}, {"tags": ["ruby", "xml", "nokogiri"], "comments": [{"owner": {"reputation": 1152, "user_id": 2656537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/947b7466e9afbf1c2f6cbe6dbb7ac28d?s=128&d=identicon&r=PG", "display_name": "XLII", "link": "https://stackoverflow.com/users/2656537/xlii"}, "edited": false, "score": 0, "creation_date": 1441136281, "post_id": 32339416, "comment_id": 52553581, "body": "Unfortunately your post is unreadable due to wrongly formated XML example. Please check <a href=\"http://stackoverflow.com/editing-help\">Markdown help</a> and make sure to check post after submitting for formatting errors."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1441155859, "post_id": 32339416, "comment_id": 52560572, "body": "Your &quot;text file&quot; is a variant of a CSV (&quot;Comma Separated Value&quot;) file. Look at Ruby&#39;s CSV class, and figure out how to tell it to use <code>|</code> instead of a comma between fields. It&#39;ll handle all sorts of corner cases you haven&#39;t thought of."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1441155933, "post_id": 32339416, "comment_id": 52560590, "body": "What are <code>String strChannel</code> and similar lines? That&#39;s not Ruby."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1442077209, "post_id": 32339416, "comment_id": 52939865, "body": "Your XML is invalid. <code>&lt;programme start=&quot;20150828110000 +0300&quot; stop=&quot;20150828110500 +0300&quot; &gt;channel=&quot;YLE TV1&quot;&gt;</code> isn&#39;t syntactically correct. Nokogiri will attempt to do a fix-up which will change the XML."}], "answers": [{"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1442077692, "creation_date": 1442077692, "answer_id": 32541501, "question_id": 32339416, "link": "https://stackoverflow.com/questions/32339416/how-to-get-title-and-description-data-from-xml-file/32541501#32541501", "title": "How to get title and description data from XML file", "body": "<p>This is untested code. The XML was tweaked to make it syntactically correct. Read the <a href=\"http://ruby-doc.org/stdlib-2.2.3/libdoc/csv/rdoc/index.html\" rel=\"nofollow\">CSV</a> and <a href=\"http://ruby-doc.org/stdlib-2.2.3/libdoc/date/rdoc/index.html\" rel=\"nofollow\">Date/DateTime</a> or <a href=\"http://ruby-doc.org/stdlib-2.2.3/libdoc/time/rdoc/index.html\" rel=\"nofollow\">Time</a> documentation to finish the code where marked.</p>\n\n<pre><code>require 'csv'\nrequire 'nokogiri'\n\ndoc = Nokogiri::XML(&lt;&lt;EOT)\n&lt;tv&gt;\n  &lt;channel id=\"YLE TV1\"&gt;\n    &lt;display-name lang=\"fi\"&gt;YLE TV1&lt;/display-name&gt;\n  &lt;programme start=\"20150828110000 +0300\" stop=\"20150828110500 +0300\" channel=\"YLE TV1\"&gt;\n    &lt;title lang=\"fi\"&gt;Yle Uutiset&lt;/title&gt;\n  &lt;/programme&gt;\n  &lt;programme start=\"20150828110500 +0300\" stop=\"20150828111200 +0300\" channel=\"YLE TV1\"&gt;\n    &lt;title lang=\"fi\"&gt;Yle Uutiset Uusimaa&lt;/title&gt;\n    &lt;desc lang=\"fi\"&gt;Uutisia Uudeltamaalta.(n)&lt;/desc&gt;\n  &lt;/programme&gt;\n&lt;/tv&gt;\nEOT\n\nCSV.open(\n  'file.csv', 'wb', \n  quote_char: '|', \n  headers: ['Channel', 'Date', 'Start time', 'Duration', 'Title', 'Desc']\n) do |csv|\n  doc.search('programme').each do |programme|\n    channel = programme['channel']\n    date = programme['start']       # =&gt; further processing needed\n    start_time = programme['start'] # =&gt; further processing needed\n    stop_time = programme['stop']   # =&gt; further processing needed\n    duration = 0                    # =&gt; further processing needed\n    title = programme.at('title').text\n    desc = programme.at('desc').text || ''\n\n    csv &lt;&lt; [channel, date, start_time, duration, title, desc]\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5282547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af9b9ce33ecf8d3cce81edf2f456260?s=128&d=identicon&r=PG&f=1", "display_name": "Ordanoth", "link": "https://stackoverflow.com/users/5282547/ordanoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1442077692, "creation_date": 1441135497, "last_edit_date": 1441183778, "question_id": 32339416, "link": "https://stackoverflow.com/questions/32339416/how-to-get-title-and-description-data-from-xml-file", "title": "How to get title and description data from XML file", "body": "<p>I'm trying to write data to a text file in this format: </p>\n\n<pre><code>Channel|Date|Start time|Duration|Title|Desc\n</code></pre>\n\n<p>Here is XML example:</p>\n\n<pre><code>&lt;!-- language: xml --&gt;\n&lt;tv&gt;\n  &lt;channel id=\"YLE TV1\"&gt;\n    &lt;display-name lang=\"fi\"&gt;YLE TV1&lt;/display-name&gt;\n  &lt;programme start=\"20150828110000 +0300\" stop=\"20150828110500 +0300\" &gt;channel=\"YLE TV1\"&gt;\n    &lt;title lang=\"fi\"&gt;Yle Uutiset&lt;/title&gt;\n  &lt;/programme&gt;\n  &lt;programme start=\"20150828110500 +0300\" stop=\"20150828111200 +0300\" &gt;channel=\"YLE TV1\"&gt;\n    &lt;title lang=\"fi\"&gt;Yle Uutiset Uusimaa&lt;/title&gt;\n    &lt;desc lang=\"fi\"&gt;Uutisia Uudeltamaalta.(n)&lt;/desc&gt;\n  &lt;/programme&gt;\n&lt;/tv&gt;\n</code></pre>\n\n<p>Here is my Ruby code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'rubygems'\nrequire 'nokogiri'\n\nopen('myfile.out', 'a') do |f|\n  doc = Nokogiri::XML(File.open(\"guidetv1.xml\"))\n  doc.css(\"programme\").each do |response_node|\n\n    strChannel = response_node[\"channel\"]\n    if(strChannel.eql? \"YLE TV1\")\n      strChannel = \"1\"\n    elsif(strChannel.eql? \"YLE TV2\")\n      strChannel = \"2\"\n    end\n    strStart = response_node[\"start\"]\n    strStop = response_node[\"stop\"]\n    strTitle = response_node[\"title\"]\n    strDesc = response_node[\"desc\"]\n    f.puts strChannel + \"|\" + strStart + \"|\" + strStop + \"|\" + strTitle + \"|\" + strDesc\n  end\nend\n</code></pre>\n\n<p>How can I read <code>title</code> and <code>desc</code> data? \nAnd how to check that is <code>Desc</code> exists?</p>\n"}, {"tags": ["ruby", "cucumber"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5285178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7039d05bf94689edd181031cdefc977?s=128&d=identicon&r=PG&f=1", "display_name": "William Grove", "link": "https://stackoverflow.com/users/5285178/william-grove"}, "edited": false, "score": 0, "creation_date": 1441138029, "post_id": 32339687, "comment_id": 52554537, "body": "Worked like a charm... thanks! I&#39;ll keep in mind that it may be changing and move towards parsing the JSON for the long term. Nice for a quick fix in the mean time."}], "tags": [], "owner": {"reputation": 3406, "user_id": 941172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ead355c2d56457e5ed9119b30dc907dc?s=128&d=identicon&r=PG", "display_name": "robustus", "link": "https://stackoverflow.com/users/941172/robustus"}, "is_accepted": true, "score": 0, "last_activity_date": 1441136524, "creation_date": 1441136524, "answer_id": 32339687, "question_id": 32338806, "link": "https://stackoverflow.com/questions/32338806/access-cucumber-feature-variable-in-a-step-defintion-with-json-spec/32339687#32339687", "title": "Access Cucumber feature variable in a step defintion with json_spec", "body": "<p>Yes there is.</p>\n\n<pre><code>JsonSpec.memory[:USER_1]\n</code></pre>\n\n<p>Will allow you to access the specific stored value. However this is not really documented as supported behaviour and as such constitutes an implementation detail that is subject to change. So i wouldn't rely on it.</p>\n\n<p>And additionally you should always be able to access the actual JSON as <code>last_json</code>, which is the method you need to provide for <em>json_spec</em> to work. If i needed to do something with the response (e.g. to issue additional requests) i would parse <code>last_json</code> myself.</p>\n\n<p>The code for the JsonSpec memory can be found <a href=\"https://github.com/collectiveidea/json_spec/blob/master/lib/json_spec/memory.rb\" rel=\"nofollow\">here</a>. And the usage of it during the step-definition can be seen <a href=\"https://github.com/collectiveidea/json_spec/blob/master/lib/json_spec/cucumber.rb#L10\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 5285178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7039d05bf94689edd181031cdefc977?s=128&d=identicon&r=PG&f=1", "display_name": "William Grove", "link": "https://stackoverflow.com/users/5285178/william-grove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 32339687, "answer_count": 1, "score": 1, "last_activity_date": 1441141963, "creation_date": 1441133068, "last_edit_date": 1441141963, "question_id": 32338806, "link": "https://stackoverflow.com/questions/32338806/access-cucumber-feature-variable-in-a-step-defintion-with-json-spec", "title": "Access Cucumber feature variable in a step defintion with json_spec", "body": "<p>I downloaded the <code>json_spec</code> gem and I'm trying to access a variable that was stored in my Cucumber feature file. From the json_spec <a href=\"https://github.com/collectiveidea/json_spec\" rel=\"nofollow\">readme</a> it shows that you can store a variable as follows; I keep the JSON response as \"USER_1\". Is there any way to access this \"USER_1\" variable for use in my step defintions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "versioning", "paper-trail-gem"], "comments": [{"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441135361, "post_id": 32338775, "comment_id": 52553083, "body": "Why are you trying to re-define it? Also, you have it improperly defined. You&#39;re returning <code>username</code> which is a string but the method expects the return value to be a user object. <a href=\"https://www.omniref.com/ruby/gems/paper_trail/1.5.0/symbols/PaperTrail::Controller/user_for_paper_trail\" rel=\"nofollow noreferrer\">omniref.com/ruby/gems/paper_trail/1.5.0/symbols/&hellip;</a>"}, {"owner": {"reputation": 1584, "user_id": 1128852, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/044021edd7412657dc35f37fb60d9f39?s=128&d=identicon&r=PG", "display_name": "Shail Patel", "link": "https://stackoverflow.com/users/1128852/shail-patel"}, "reply_to_user": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441138420, "post_id": 32338775, "comment_id": 52554755, "body": "@Nathan I&#39;m redefining it because I want to store <code>current_user.username</code> and not <code>current_user.id</code>. In the paper_trail docs, they say you can override that method to return a string of whatever you want. Here is their example:    <code>def user_for_paper_trail</code>     <code>logged_in? ? current_member.id : &#39;Public user&#39;  # or whatever</code>   <code>end</code>"}, {"owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 1, "creation_date": 1441146868, "post_id": 32338775, "comment_id": 52558348, "body": "Try putting something else in there other than <code>current_user.try(:username)</code>. For example, try putting in a string like <code>&quot;testing...123&quot;</code>. If that works your problem is not with the <code>use_for_paper_trail</code> method but <code>current_user.try(:username)</code> Likely you will need to use something like: <code>current_user.try(:username).present? ? current_user.username : &quot;Guest&quot;</code>"}, {"owner": {"reputation": 1584, "user_id": 1128852, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/044021edd7412657dc35f37fb60d9f39?s=128&d=identicon&r=PG", "display_name": "Shail Patel", "link": "https://stackoverflow.com/users/1128852/shail-patel"}, "reply_to_user": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441147690, "post_id": 32338775, "comment_id": 52558604, "body": "@Nathan yeah i tried that, still didn&#39;t work :( I added an <code>abort</code> even and it didn&#39;t even trigger that method"}, {"owner": {"reputation": 1584, "user_id": 1128852, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/044021edd7412657dc35f37fb60d9f39?s=128&d=identicon&r=PG", "display_name": "Shail Patel", "link": "https://stackoverflow.com/users/1128852/shail-patel"}, "reply_to_user": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 1, "creation_date": 1441213159, "post_id": 32338775, "comment_id": 52590768, "body": "@Nathan i figured out at least it&#39;s because <code>Shared::BaseController</code> isn&#39;t inheriting from <code>ActionController::Base</code>. I wonder what module in <code>ActionController::Base</code> I need to require. I rather not include all of <code>ActionController::Base</code> just to get this working..."}, {"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "reply_to_user": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "edited": false, "score": 0, "creation_date": 1441230397, "post_id": 32338775, "comment_id": 52599968, "body": "Good debug suggestion @Nathan"}], "owner": {"reputation": 1584, "user_id": 1128852, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/044021edd7412657dc35f37fb60d9f39?s=128&d=identicon&r=PG", "display_name": "Shail Patel", "link": "https://stackoverflow.com/users/1128852/shail-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441132944, "creation_date": 1441132944, "question_id": 32338775, "link": "https://stackoverflow.com/questions/32338775/user-for-paper-trail-defined-in-controller-not-working", "title": "user_for_paper_trail defined in controller not working", "body": "<pre><code>  class DemandControlsController &lt; Shared::BaseController\n     def user_for_paper_trail\n       current_user.try(:username)\n     end\n  end\n</code></pre>\n\n<p>I'm trying to define the user_for_paper_trail method directly in this DemandControls controller; I've also tried to define it in Shared::BaseController but the whodunnit column in my versions table keeps showing up as NULL. Does it specifically have to be defined as a method in the ApplicationController class?</p>\n"}, {"tags": ["ruby", "mongodb", "mongoid", "nosql"], "comments": [{"owner": {"reputation": 7017, "user_id": 2018812, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/69c00f983bf2d1256d91ef5b459b913c?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh", "link": "https://stackoverflow.com/users/2018812/yogesh"}, "edited": false, "score": 5, "creation_date": 1441133029, "post_id": 32338762, "comment_id": 52551812, "body": "use <a href=\"http://docs.mongodb.org/manual/reference/method/db.collection.distinct/\" rel=\"nofollow noreferrer\">distinct</a>"}, {"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "reply_to_user": {"reputation": 7017, "user_id": 2018812, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/69c00f983bf2d1256d91ef5b459b913c?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh", "link": "https://stackoverflow.com/users/2018812/yogesh"}, "edited": false, "score": 0, "creation_date": 1441133946, "post_id": 32338762, "comment_id": 52552318, "body": "@Yogesh - That would work, but the documentation does not show how efficient it is."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 5, "creation_date": 1441134741, "post_id": 32338762, "comment_id": 52552733, "body": "<a href=\"http://docs.mongodb.org/manual/reference/method/db.collection.distinct/#index-use\" rel=\"nofollow noreferrer\">&quot;When possible, <code>db.collection.distinct()</code> operations can use indexes&quot;</a> so (1) it is happening inside the database and (2) if you have an index, it will pull the list straight out of the index. <code>pluck</code> gives you an array and then <code>Array#uniq</code> is used, this is almost certainly going to be a lot slower than letting the database do the work."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 7017, "user_id": 2018812, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/69c00f983bf2d1256d91ef5b459b913c?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh", "link": "https://stackoverflow.com/users/2018812/yogesh"}, "edited": false, "score": 0, "creation_date": 1441193103, "post_id": 32338762, "comment_id": 52576659, "body": "@Yogesh: note that if <code>distinct</code> finds more data than fits into doc size limit, the operation will fail."}], "answers": [{"tags": [], "owner": {"reputation": 268112, "user_id": 1259510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0840e2c5392970ef26cbfef84a0e4903?s=128&d=identicon&r=PG", "display_name": "JohnnyHK", "link": "https://stackoverflow.com/users/1259510/johnnyhk"}, "is_accepted": true, "score": 2, "last_activity_date": 1441200897, "creation_date": 1441200897, "answer_id": 32354690, "question_id": 32338762, "link": "https://stackoverflow.com/questions/32338762/is-there-a-way-to-efficiently-find-all-unique-values-for-a-field-in-mongodb/32354690#32354690", "title": "Is there a way to efficiently find all unique values for a field in MongoDB?", "body": "<p>As indicated in the comments, you can efficiently get the unique values of a field over all docs in a collection using <a href=\"http://docs.mongodb.org/manual/reference/method/db.collection.distinct/\" rel=\"nofollow\"><code>distinct</code></a>.</p>\n\n<p>The documentation specifically mentions that indexes are used when possible, and that they can cover the distinct query. This means that only the supporting index needs to be loaded into memory to get the results.</p>\n\n<blockquote>\n  <p>When possible, <code>db.collection.distinct()</code> operations can use indexes.</p>\n  \n  <p>Indexes can also <a href=\"http://docs.mongodb.org/manual/core/query-optimization/#covered-queries\" rel=\"nofollow\">cover</a> <code>db.collection.distinct()</code> operations. See\n  <a href=\"http://docs.mongodb.org/manual/core/query-optimization/#covered-queries\" rel=\"nofollow\">Covered Query</a> for more information on queries covered by indexes.</p>\n</blockquote>\n\n<p>In Ruby, you would perform your distinct query as:</p>\n\n<pre><code>User.distinct(:name)\n</code></pre>\n"}], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "accepted_answer_id": 32354690, "answer_count": 1, "score": 0, "last_activity_date": 1498910490, "creation_date": 1441132897, "last_edit_date": 1506103282, "question_id": 32338762, "link": "https://stackoverflow.com/questions/32338762/is-there-a-way-to-efficiently-find-all-unique-values-for-a-field-in-mongodb", "title": "Is there a way to efficiently find all unique values for a field in MongoDB?", "body": "<p>Consider a collection of Users:</p>\n\n<pre><code>{ name: 'Jeff' }\n{ name: 'Joel' }\n</code></pre>\n\n<p>Is there a way to efficiently get all the unique values for <code>name</code>? </p>\n\n<pre><code>User.pluck(:name).uniq\n</code></pre>\n\n<p>To return </p>\n\n<pre><code>[ 'Jeff', 'Joel' ]\n</code></pre>\n\n<p>I think this would get the whole collection, so it would be inefficient. </p>\n\n<p>However, if there is an index on <code>name</code>, is there a way to get all the unique values without getting all the documents? </p>\n\n<p>Or is there another way to efficiently get the unique <code>names</code>?</p>\n"}]