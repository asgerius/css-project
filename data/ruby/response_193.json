[{"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 1, "creation_date": 1537431021, "post_id": 52414741, "comment_id": 91784016, "body": "Are they all destroyed, or all but one? You don&#39;t validate that they all have to be there, only that at least one has to."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1537449545, "post_id": 52414741, "comment_id": 91795226, "body": "@EmilKampp They are all deleted."}, {"owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1537455086, "post_id": 52414741, "comment_id": 91799122, "body": "Have you looked at the documentation for mass assigning nested attributes through <code>assign_attributes</code>? It seems that there may be a quirk there about deleting records being done without validations, and your validations are called only when you call <code>save!</code>."}, {"owner": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1537524513, "post_id": 52414741, "comment_id": 91825441, "body": "You could use <code>validates_associated :customer</code> in your <code>Location</code> model. This method runs the validation on the association. Though, i&#39;m not sure if this happens on delete."}], "answers": [{"comments": [{"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1537449750, "post_id": 52417258, "comment_id": 91795376, "body": "Thanks for looking at this, but I&#39;m not worried about deleting a customer. The issue is when I update a customer and pass an array of location ids. If I pass a <code>nil</code> array, then the customer is updated without any locations. I&#39;m trying to prevent the customer from having all of its location references destroyed."}], "tags": [], "owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "is_accepted": false, "score": 0, "last_activity_date": 1537414957, "creation_date": 1537414957, "answer_id": 52417258, "question_id": 52414741, "link": "https://stackoverflow.com/questions/52414741/validation-not-preventing-destroy-rails-5/52417258#52417258", "title": "Validation not preventing destroy - Rails 5", "body": "<p>Instead can you do this. For validations, we should be using <code>before_destory</code> callback. This should prevent the locations from deleting, when you're saving a customer when you have unchecked all locations.</p>\n\n<pre><code>class Customer &lt; ActiveRecord::Base\n  has_many :locations\n  before_destroy :check_for_locations?\n\n  private\n\n  def check_for_locations?\n    errors.add(:base, \"cannot delete customer with locations\") unless locations.count == 0\n    errors.blank?\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1535, "user_id": 1326518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PcaV1.jpg?s=128&g=1", "display_name": "Scott Matthewman", "link": "https://stackoverflow.com/users/1326518/scott-matthewman"}, "is_accepted": false, "score": 0, "last_activity_date": 1537457141, "creation_date": 1537457141, "answer_id": 52428506, "question_id": 52414741, "link": "https://stackoverflow.com/questions/52414741/validation-not-preventing-destroy-rails-5/52428506#52428506", "title": "Validation not preventing destroy - Rails 5", "body": "<p>I've found that ActiveRecord is more reliable in validating the existence of associated records by asking it to validate the length of the associated <code>*_ids</code> array. In your case:</p>\n\n<pre><code>class Customer &lt; ApplicationRecord\n  has_many :locations\n  validates :location_ids, length: { minimum: 1 }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12085, "user_id": 632688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c6e4e8117bbd27fd25e9e2ea350458?s=128&d=identicon&r=PG", "display_name": "Wizard of Ogz", "link": "https://stackoverflow.com/users/632688/wizard-of-ogz"}, "is_accepted": true, "score": 1, "last_activity_date": 1537512376, "last_edit_date": 1537512376, "creation_date": 1537507402, "answer_id": 52437088, "question_id": 52414741, "link": "https://stackoverflow.com/questions/52414741/validation-not-preventing-destroy-rails-5/52437088#52437088", "title": "Validation not preventing destroy - Rails 5", "body": "<p>This is a common problem which people run into with ActiveRecord.</p>\n\n<h2>The problem</h2>\n\n<p>The <code>location_ids=</code> setter method will immediately add/update/delete records, which is alluded to in the <a href=\"https://guides.rubyonrails.org/association_basics.html#methods-added-by-has-many-collection-singular-ids-ids\" rel=\"nofollow noreferrer\">ActiveRecord Associations guide</a>. That behavior often surprises developers and is often undesired. I almost always avoid it.</p>\n\n<p>In your code you are first calling <code>assign_attributes</code> which in turn calls <code>location_ids=</code>. Changes are immediately persisted to the records. Subsequently, when <code>save!</code> is called, it opens a new transaction. If a validation error occurs then only the changes in that transaction will be rolled back, and those exclude the already-persisted changes made by <code>location_ids=</code>.</p>\n\n<pre><code>@customer.assign_attributes(params...)  # location_ids are saved outside of the `save!` transaction.\n@customer.save!                         # validation errors will cause a rollback only to this point, excluding changes from the previous line.\n</code></pre>\n\n<h2>An Easy Solution</h2>\n\n<p>Use <code>update_attributes!</code> to replace both <code>assign_attributes</code> and <code>save!</code>. This will have the effect of wrapping all changes in a transaction such that a rollback will undo everything like you want. Yay!</p>\n\n<pre><code>@customer.update_attributes!(params.require(:customer).permit(:first_name, :middle_initial, :last_name, :location_ids =&gt; []))\n</code></pre>\n\n<h2>An Alternative Approach</h2>\n\n<p>Sometimes it might not be possible to avoid separate calls to <code>assign_attributes</code> and <code>save</code>. This makes things much more complicated. No option that I can think of for this case is trivial.</p>\n\n<p>One possible solution is to use nested attributes to update/destroy the child records.</p>\n\n<p><code>location_ids</code> is really a shortcut for updating each Location record associated with the given Customer. Instead of relying on that you can use nested attributes in your forms to update the locations. This method can take advantage of the <code>mark_for_destruction</code> (<a href=\"https://api.rubyonrails.org/classes/ActiveRecord/AutosaveAssociation.html\" rel=\"nofollow noreferrer\">link</a>) feature for autosave. Describing a full solution for this approach would be prohibitively lengthy, but it has proven to be very effective for me.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 52437088, "answer_count": 3, "score": 0, "last_activity_date": 1537512376, "creation_date": 1537394369, "question_id": 52414741, "link": "https://stackoverflow.com/questions/52414741/validation-not-preventing-destroy-rails-5", "title": "Validation not preventing destroy - Rails 5", "body": "<p>I have a <code>Customer</code> record with a many to many association with <code>Location</code>.</p>\n\n<p>I currently check/uncheck the locations I want for a specific customer on the edit customer page. When I uncheck all of the locations and hit submit, the locations are deleted from my model and an error is thrown from my validation. I would've expected the locations to not be deleted since I have the validation that requires they exist which is what I need. </p>\n\n<p>My validation in the <code>Customer</code> model.</p>\n\n<pre><code>validates :locations, presence: true\n</code></pre>\n\n<p>My view:</p>\n\n<pre><code>&lt;% @locations.each do |i| %&gt;\n      &lt;li class=\"list-group-item\"&gt;\n        &lt;%= hidden_field_tag \"customer[location_ids][]\", '' %&gt;\n        &lt;%= check_box_tag \"customer[location_ids][]\", i.id, @customer.location_ids.include?(i.id) %&gt;\n        &lt;%= i.name %&gt;\n      &lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My controller:</p>\n\n<pre><code>    @customer = Customer.find(params[:id])\n    @customer.assign_attributes(params.require(:customer).permit(:first_name, :middle_initial, :last_name, :location_ids =&gt; []))\n    @customer.save!\n</code></pre>\n\n<p><code>.save!</code> causes the following error:</p>\n\n<pre><code>error Locations can't be blank\n</code></pre>\n\n<p>However, when you refresh the page or review the database records, the location references are destroyed and I also see they are destroyed from the CLI. I don't understand why the validation doesn't prevent the location references from being destroyed. Thanks in advance.</p>\n"}, {"tags": ["ruby", "bash", "ffmpeg"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537391877, "post_id": 52414228, "comment_id": 91772390, "body": "It&#39;s not clear here how Ruby factors in. Are you running that from Ruby? If so, where&#39;s the Ruby code?"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537392039, "post_id": 52414228, "comment_id": 91772448, "body": "I don&#39;t see how <code>ruby</code> is the culprit as it&#39;s a system call from <code>ruby</code>, but I will edit the post."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1537392935, "post_id": 52414228, "comment_id": 91772736, "body": "If it&#39;s not a factor, then safer to just remove the tag. Remember that filenames can have spaces in them, so from Ruby you <i>must</i> call <a href=\"https://ruby-doc.org/stdlib-2.5.0/libdoc/shellwords/rdoc/String.html#method-i-shellescape\" rel=\"nofollow noreferrer\"><code>shellescape</code></a> when introducing those sorts of arguments. It&#39;s probably safer to launch using <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/open3/rdoc/Open3.html\" rel=\"nofollow noreferrer\">Open3</a> than the really weak backticks method. This way you can specify arguments specifically instead of leaving it up to the shell to parse them."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537393268, "post_id": 52414228, "comment_id": 91772857, "body": "OK, implemented <code>Shellwords.escape(item)</code> for the addition, but the sample files don&#39;t have spaces.  I still get the same error."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537393716, "post_id": 52414228, "comment_id": 91773013, "body": "@tadman Also used <code>open3</code> with the same error.  <code>stderr</code> is the same reported error."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537394615, "post_id": 52414228, "comment_id": 91773287, "body": "The good news about <code>open3</code> is it gives you more control over the process, you can see what it&#39;s doing before it&#39;s done, which is useful if you want to report status. If you have bad input data, though, no amount of Ruby can help you. Check that your files are valid."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537396044, "post_id": 52414228, "comment_id": 91773695, "body": "@tadman Yes, like I said it works just fine manually.  The very same syntax generated in the <code>ruby</code> script itself.  And the source files are valid as well.  That&#39;s why it&#39;s so confusing."}], "answers": [{"tags": [], "owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "is_accepted": false, "score": 3, "last_activity_date": 1537396088, "creation_date": 1537396088, "answer_id": 52414995, "question_id": 52414228, "link": "https://stackoverflow.com/questions/52414228/ffmpeg-invalid-data-found-when-processing-input/52414995#52414995", "title": "ffmpeg: Invalid data found when processing input", "body": "<p>I needed <code>f.close</code> to write the file so <code>ffmpeg</code> could read from it.  But the <code>shellwords</code> was also key.  Thank you . </p>\n"}], "owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4820, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537396088, "creation_date": 1537391237, "last_edit_date": 1537392095, "question_id": 52414228, "link": "https://stackoverflow.com/questions/52414228/ffmpeg-invalid-data-found-when-processing-input", "title": "ffmpeg: Invalid data found when processing input", "body": "<p>I have a situation where <code>ffmpeg</code> is throwing an error:</p>\n\n<pre><code>Invalid data found when processing input\n</code></pre>\n\n<p>I've reviewed other answers here, but my situation is different.  I generate in <code>Ruby</code>, a text file with a list of input files I want to concatenate together into one large video.  </p>\n\n<p>I generate in <code>Ruby</code>, the command meant for <code>bash</code>, which is also output for me to manually copy:</p>\n\n<pre><code>ffmpeg -y -f concat -safe 0 -i /Volumes/Dragon2/Yums/randoms.txt /Volumes/Dragon2/Yums/final.mp4\n</code></pre>\n\n<p>Throws an error:</p>\n\n<pre><code>/Volumes/Dragon2/Yums/randoms.txt: Invalid data found when processing input\n</code></pre>\n\n<p>Here is that file:</p>\n\n<pre><code>file '/Volumes/Dragon2/Yums/0CEDC3CA-4571-4271-9938-A161EC2A887B.mov'\nfile '/Volumes/Dragon2/Yums/0D25D907-D053-443B-AFC6-9F12B1711BBF.mov'\nfile '/Volumes/Dragon2/Yums/6A272808-7706-435D-801E-ACE6B42EC749.mov'\nfile '/Volumes/Dragon2/Yums/6E9BA2F1-C5E7-4C1C-B290-D116105732FA.mov'\nfile '/Volumes/Dragon2/Yums/0A41C7B7-74CE-484E-B029-3AE57B8BB4EA.mov'\n</code></pre>\n\n<p>When <code>bash</code> runs it, it complains about the input file <strong>randoms.txt</strong> having invalid data.  When I copy and paste the very same command in <code>bash</code>, it works fine.  I'm stumped as to how the two are different and why <code>ffmpeg</code> is not happy when initiated in the <code>shell</code>.  </p>\n\n<p>How can I get this to work?  What am I missing?  Cheers</p>\n\n<p>EDIT: Original <code>ruby</code> code:</p>\n\n<pre><code>`clear`\nrequire 'pathname'\nrequire 'pp'\n\ns = '/Volumes/Dragon2/Yums'\nfiles = []\n\nDir.foreach(s) do |path|\n  files &lt;&lt; \"#{ s }/#{ path }\"  \nend\n\nresult = files.sample(files.size)           # randomizer\n\nf = File.open(\"#{ s }/randoms.txt\", 'w+')\nresult.each_with_index do |item, i|\n  pp \"#{ i }: #{ item }\" if item.include?('mov')\n  f &lt;&lt; \"file '#{ item }'\\n\" if item.include?('mov')\nend\n\n`echo `\n\nFile.delete(\"#{ s }/final.mp4\") if File.exists?(\"#{ s }/final.mp4\")\ns = \"ffmpeg -y -f concat -safe 0 -i #{ s }/randoms.txt #{ s }/final.mp4\"\nputs s\n\nsleep 3\n`#{ s }`\n</code></pre>\n\n<p>I have also tried <code>system s</code> as well with the same error.  The syntax is generated fine, output fine, operates fine manually.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10387989, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L-OQAZfcKTE/AAAAAAAAAAI/AAAAAAAAAA8/EvRiikg-sms/photo.jpg?sz=128", "display_name": "Trs MTV", "link": "https://stackoverflow.com/users/10387989/trs-mtv"}, "edited": false, "score": 0, "creation_date": 1537552245, "post_id": 52414597, "comment_id": 91840560, "body": "When I click on the button it goes on the correct path, but an error appears. However, when you go over the same cops, everything works, I do not understand why"}], "tags": [], "owner": {"reputation": 504, "user_id": 4617655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Efg3l.jpg?s=128&g=1", "display_name": "Geralt", "link": "https://stackoverflow.com/users/4617655/geralt"}, "is_accepted": false, "score": 0, "last_activity_date": 1537393533, "creation_date": 1537393533, "answer_id": 52414597, "question_id": 52414138, "link": "https://stackoverflow.com/questions/52414138/pressing-the-button-transfers-the-data-to-the-controller/52414597#52414597", "title": "Pressing the button transfers the data to the controller", "body": "<p>Based on your code. Try this:</p>\n\n<pre><code>&lt;% for j in (1..9) %&gt;\n    &lt;%= link_to \"Button name\", path_to_your_action(id: j), :class =&gt; 'btn btn-secondary' %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10387989, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L-OQAZfcKTE/AAAAAAAAAAI/AAAAAAAAAA8/EvRiikg-sms/photo.jpg?sz=128", "display_name": "Trs MTV", "link": "https://stackoverflow.com/users/10387989/trs-mtv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537437270, "creation_date": 1537390746, "last_edit_date": 1537437270, "question_id": 52414138, "link": "https://stackoverflow.com/questions/52414138/pressing-the-button-transfers-the-data-to-the-controller", "title": "Pressing the button transfers the data to the controller", "body": "<p>I have buttons, which are numbered from 1 to 9. they are created and numbered in a loop.</p>\n\n<pre><code> &lt;% for j in (1..9) %&gt;\n        &lt;%= button_to j, xml_show1_url(:id =&gt; j), {class: \"btn btn-secondary\"} %&gt;\n   &lt;% end %&gt;\n</code></pre>\n\n<p>When you click on one of the buttons. For example, with value 1. you need to send this value to the function. This number is required for insertion into a string, and this line is a path to the file. Here is a function that parses the desired html file</p>\n\n<pre><code>def show\n   @some_params = params[:id]\n   @file = File.open(\"#{Rails.root}/app/data/home_work_#{@some_params}.xml\", \"r\")\n   @doc = Nokogiri::XML(@file)\n   @attributes = @doc.at('subject')['id']\n   @subjects = @doc.xpath(\"//subject\")\n   end\n</code></pre>\n\n<p>How do I implement it! Help! TY</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 4, "creation_date": 1537388345, "post_id": 52413592, "comment_id": 91770969, "body": "Unrelated, but meaningful variable names go a long way, e.g., <code>words</code> and <code>word</code> have much more meaning than <code>var_b</code> and <code>i</code>. In any case, you&#39;re returning from the function as soon as you hit the first word longer than <code>max_length</code>. And you don&#39;t want <code>map</code>, you want to gather only those elements that meet the requirement: <code>map</code> will create a value for every object in the array it&#39;s called on."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537388415, "post_id": 52413592, "comment_id": 91770996, "body": "Another thing is to use <code>split(&#47;\\s+&#47;)</code> to split on <i>one or more spaces</i> as well."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1537389258, "post_id": 52413592, "comment_id": 91771357, "body": "...and I think <code>min_length</code> would be a better choice for the variable name than <code>max_length</code>, since you want to select words whose length is at least a a given minimum value."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1537392123, "post_id": 52413592, "comment_id": 91772475, "body": "@tadman, or just <code>split</code> with no argument."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1537395557, "post_id": 52413592, "comment_id": 91773571, "body": "You state, &quot;...words which have more than 4 letters.&quot;. To be consistent with your code that should be  &quot;...words which have 4 or more letters.&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 10387815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d983763c0d811879e296fc0830ada974?s=128&d=identicon&r=PG&f=1", "display_name": "Krzynek", "link": "https://stackoverflow.com/users/10387815/krzynek"}, "edited": false, "score": 2, "creation_date": 1537389227, "post_id": 52413633, "comment_id": 91771346, "body": "Many thanks. All makes sense now (and of course works)"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1537388318, "creation_date": 1537388318, "answer_id": 52413633, "question_id": 52413592, "link": "https://stackoverflow.com/questions/52413592/how-to-return-the-whole-array-instead-of-a-single-string/52413633#52413633", "title": "How to return the whole array instead of a single string", "body": "<p>If you want to filter a list and select only certain kinds of entries, use the <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-select\" rel=\"nofollow noreferrer\"><code>select</code></a> method:</p>\n\n<pre><code>var_b.select do |i|\n  i.length &gt;= max_length\nend\n</code></pre>\n\n<p>Where that's all you need.</p>\n\n<p>The <code>return i</code> in the middle is confusing things, as that breaks out of the loop and returns a single value <em>from the method itself</em>. Remember that in Ruby, unlike others such as JavaScript, <code>return</code> is often implied and doesn't need to be spelled out explicitly.</p>\n\n<p>Blocks don't normally have <code>return</code> in them for this reason unless they need to interrupt the flow and break out of the method itself.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1537395383, "creation_date": 1537395383, "answer_id": 52414897, "question_id": 52413592, "link": "https://stackoverflow.com/questions/52413592/how-to-return-the-whole-array-instead-of-a-single-string/52414897#52414897", "title": "How to return the whole array instead of a single string", "body": "<p>You don't need to first extract all words from the string and then select those having at least four letters. Instead you can just extract the desired words using <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-scan\" rel=\"nofollow noreferrer\">String#scan</a> with a regular expression.</p>\n\n<pre><code>str = \"The Fox asked the stork, 'How is the soup?'? Tr\u00e8s bon?\"\n\nstr.scan /\\p{Alpha}{4,}/\n  #=&gt; [\"asked\", \"stork\", \"soup\", \"Tr\u00e8s\"]\n</code></pre>\n\n<p>The regular expression reads, \"Match strings containing 4 or more letters\". I've used <code>\\p{Alpha}</code> (same as <code>\\p{L}</code> and <code>[[:alpha:]]</code>) to match unicode letters. (These are documented in <a href=\"http://ruby-doc.org/core-2.5.1/Regexp.html\" rel=\"nofollow noreferrer\">Regexp</a>. Search for these expressions there.) You could replace <code>\\p{Alpha}</code> with <code>[a-zA-Z]</code>, but in that case \"Tr\u00e8s\" would not be matched.</p>\n\n<p>If you wish to also match digits, use <code>\\p{Alnum}</code> or <code>[[:alnum:]]</code> instead. While <code>\\w</code> also matches letters (English only) and digits, it also matches underscores, which you probably don't want in this situation.</p>\n\n<p>Punctuation can be a problem when words are extracted from the string by splitting on whitespace.</p>\n\n<pre><code>arr = \"That   is a cow.\".split\n  #=&gt; [\"That\", \"is\", \"a\", \"cow.\"]\narr.select { |word| word.size &gt;= 4 }\n  #=&gt; [\"That\", \"cow.\"]\n</code></pre>\n\n<p>but <code>\"cow\"</code> has only three letters. If you instead used <code>String#scan</code> to extract words from the string you obtain the desired result.</p>\n\n<pre><code>arr = \"That   is a cow?\".scan /\\p{Alpha}+/\n  #=&gt; [\"That\", \"is\", \"a\", \"cow\"]\narr.select { |word| word.size &gt;= 4 }\n  #=&gt; [\"That\"]\n</code></pre>\n\n<p>However, if you use <code>scan</code> you may as well use a regular expression to retrieve only words having at least 4 characters, and skip the extra step.</p>\n"}], "owner": {"reputation": 83, "user_id": 10387815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d983763c0d811879e296fc0830ada974?s=128&d=identicon&r=PG&f=1", "display_name": "Krzynek", "link": "https://stackoverflow.com/users/10387815/krzynek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 52413633, "answer_count": 2, "score": 2, "last_activity_date": 1537415048, "creation_date": 1537388174, "last_edit_date": 1537415048, "question_id": 52413592, "link": "https://stackoverflow.com/questions/52413592/how-to-return-the-whole-array-instead-of-a-single-string", "title": "How to return the whole array instead of a single string", "body": "<p>I am trying to return all words which have more than four letters in the below exercise.</p>\n\n<pre><code>def timed_reading(max_length, text)\n  var_b = text.split(\" \")\n\n  var_b.map do |i|\n    if i.length &gt;= max_length\n      return i\n    end\n  end\nend\n\nprint timed_reading(4,\"The Fox asked the stork, 'How is the soup?'\")\n# &gt;&gt; asked\n</code></pre>\n\n<p>I seem to get only one word.</p>\n"}, {"tags": ["ruby", "puppet", "rhel"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1537416169, "post_id": 52413162, "comment_id": 91777913, "body": "What version of Puppet have you installed?  No remotely recent version supports Ruby 1.8, or should be installed in such a directory.  The latest (fresh off the presses today) is Puppet 6.0.  Puppet 4 and 5 are both pretty common.  Puppet 3 persists, but should not be used for new installations, and I&#39;m not sure whether even it supports Puppet 1.8."}, {"owner": {"reputation": 5465, "user_id": 417291, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/eAXy2.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/417291/alex"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1537454131, "post_id": 52413162, "comment_id": 91798500, "body": "I use &quot;yum install puppet&quot;. Downloading packages: puppet-3.8.7-1.el6.noarch.rpm"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1537478526, "post_id": 52413162, "comment_id": 91810681, "body": "I urge you to instead choose a modern version of Puppet.  v6.0 is a little too fresh for my personal taste, though; I would choose v5.5.  Puppet, Inc. provides appropriate yum repositories, and ample documentation on how to install Puppet from them.  Start <a href=\"https://puppet.com/docs/puppet/5.5/puppet_platform.html\" rel=\"nofollow noreferrer\">here</a>."}], "owner": {"reputation": 5465, "user_id": 417291, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/eAXy2.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/417291/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537386103, "creation_date": 1537386103, "question_id": 52413162, "link": "https://stackoverflow.com/questions/52413162/how-to-permanently-add-the-new-installation-puppet-directory-to-the-ruby-load-pa", "title": "How to permanently add the new installation Puppet directory to the ruby LOAD_PATH on RHEL7?", "body": "<p>The puppet installation was successful but the command </p>\n\n<pre><code>sudo puppet apply /etc/puppet/manifests/site.pp\n</code></pre>\n\n<p>resulted in the error:</p>\n\n<pre><code>/usr/share/rubygems/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- puppet/util/command_line (LoadError)\nfrom /usr/share/rubygems/rubygems/core_ext/kernel_require.rb:55:in `require'\nfrom /bin/puppet:7:in `&lt;main&gt;'\n</code></pre>\n\n<p>As I understand the new puppet installation directory /usr/lib/ruby/site_ruby/1.8/ is not in the ruby LOAD_PATH. </p>\n\n<p>I tried manually change the LOAD_PATH using ruby -I or LOAD_PATH.unshift or RUBYLIB.  All of this did not result into the permanent change of LOAD_PATH, only the temporary change happened.</p>\n\n<p>The directories in the LOAD_PATH are [\"/usr/local/share/ruby/site_ruby\", \"/usr/local/lib64/ruby/site_ruby\", \"/usr/share/ruby/vendor_ruby\", \"/usr/lib64/ruby/vendor_ruby\", \"/usr/share/rubygems\", \"/usr/share/ruby\", \"/usr/lib64/ruby/\"]</p>\n"}, {"tags": ["ruby", "date-conversion"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1537391047, "post_id": 52413999, "comment_id": 91772088, "body": "<code>Time.new(&quot;1900-01-01&quot;) + ((43347.6625 - 2.00001) * 86400)</code> will return the same result."}, {"owner": {"reputation": 212, "user_id": 6335557, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fbf02acafda949bc64f8c4cb6ee40eb5?s=128&d=identicon&r=PG&f=1", "display_name": "MaciekR", "link": "https://stackoverflow.com/users/6335557/maciekr"}, "edited": false, "score": 0, "creation_date": 1537429786, "post_id": 52413999, "comment_id": 91783362, "body": "Thanks - but there is a small difference between both solutions: peter&#39;s solution returns 2018-09-04 15:53:59 +0200, engineersmnky&#39;s solution returns 2018-09-04 16:53:59 +0200 and <a href=\"https://planetcalc.com/7027/\" rel=\"nofollow noreferrer\">planetcalc.com/7027</a> returns 04/09/2018 16:29:59. When i calculated it manually my result was the same as peter&#39;s one....."}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1537390057, "creation_date": 1537390057, "answer_id": 52413999, "question_id": 52412885, "link": "https://stackoverflow.com/questions/52412885/ruby-how-to-convert-variant-date-to-datetime/52413999#52413999", "title": "Ruby: how to convert VARIANT DATE to datetime", "body": "<p>here a method to do the calculation, the date you give is not correct, it should be what this method is returning, check with <a href=\"https://planetcalc.com/7027/\" rel=\"nofollow noreferrer\">https://planetcalc.com/7027/</a></p>\n\n<pre><code>def variant2datetime variant\n  # number of days after 1-1-1900 minus 2 days for starting with 0\n  # and having a day that didn't exist because 1900 wasn't a leap year\n  date = Time.new(\"1900-01-01\") + (variant.to_i - 2) * 24 * 60 * 60\n  fraction = variant % 1\n  hours   = (fraction - fraction.to_i) * 24\n  minutes = (hours - hours.to_i) * 60\n  seconds = (minutes - minutes.to_i) * 60\n  Time.new(date.year, date.month, date.day, hours.to_i, minutes.to_i, seconds.to_i)\nend\n\nvariant2datetime 43347.6625 # 2018-09-04 15:53:59 +0200\n</code></pre>\n"}], "owner": {"reputation": 212, "user_id": 6335557, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fbf02acafda949bc64f8c4cb6ee40eb5?s=128&d=identicon&r=PG&f=1", "display_name": "MaciekR", "link": "https://stackoverflow.com/users/6335557/maciekr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 52413999, "answer_count": 1, "score": 1, "last_activity_date": 1537390057, "creation_date": 1537384794, "question_id": 52412885, "link": "https://stackoverflow.com/questions/52412885/ruby-how-to-convert-variant-date-to-datetime", "title": "Ruby: how to convert VARIANT DATE to datetime", "body": "<p>In my project i get from external system date&amp;time in VARIANT DATE type and need to convert it to datetime (i.e. 43347.6625 => 04/09/2018 16:29:59).</p>\n\n<p>Do you know how to do it in ruby? what is the best approach? I did not find any ruby built-in method to do such a conversion...</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 9, "creation_date": 1537379452, "post_id": 52411577, "comment_id": 91766828, "body": "because <code>&quot;any_string&quot;.to_i</code> =&gt; 0. <code>to_i</code> always return zero on strings that start with chars. <code>&quot;123foo&quot;.to_i</code> =&gt; 123 for instance"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537381537, "post_id": 52411577, "comment_id": 91767875, "body": "Is the goal here to capture an error when non-numerical input is provided? If so, can you define the sorts of values that you consider valid? Like is <code>-2</code> valid? <code>-0</code>? <code>939249359434593459435934966</code>?"}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 3, "creation_date": 1537382227, "post_id": 52411577, "comment_id": 91768171, "body": "You might want to use something like <a href=\"https://ruby-doc.org/core/Kernel.html#method-i-Integer\" rel=\"nofollow noreferrer\"><code>x = Integer(gets.chomp)</code></a> if you really want  an exception for non-numeric inputs."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 2, "creation_date": 1537384395, "post_id": 52411577, "comment_id": 91769163, "body": "@HolgerJust <code>Integer(gets)</code> is enough, trailing newline characters are ignored."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1537386304, "post_id": 52411577, "comment_id": 91770078, "body": "Your question is unclear. What exception are you referring to when you say that it is not rescuing &quot;this&quot; exception? What is &quot;this&quot;? Honestly, I don&#39;t even see how that code <i>could</i> raise an exception. So, please be specific: <i>what</i> exception is raised?"}, {"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "edited": false, "score": 3, "creation_date": 1537394415, "post_id": 52411577, "comment_id": 91773236, "body": "The downvotes are unwarranted. This is a reasonable question, as the behavior of #to_i vs #Integer is not well understood by most Ruby newcomers."}, {"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1537394475, "post_id": 52411577, "comment_id": 91773250, "body": "@Stefan Not just trailing ones, either. <code>Integer &quot;\\n1\\r&quot; #=&gt; 1</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1537426728, "post_id": 52411577, "comment_id": 91781779, "body": "Using <code>Integer()</code> as a safeguard for input is fine. But if dealing with non-numeric user input is a <i>normal</i> situation in your program, it might be better to not use exceptions at all. You could for example use a regular expression instead to check whether the input contains only digits and print a message otherwise. This would allow you to use exceptions for the <i>exceptional</i> situations."}], "answers": [{"comments": [{"owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "edited": false, "score": 0, "creation_date": 1537394442, "post_id": 52414676, "comment_id": 91773244, "body": "Thanks for the explanation!"}, {"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "reply_to_user": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "edited": false, "score": 2, "creation_date": 1537394614, "post_id": 52414676, "comment_id": 91773286, "body": "@Practical1 No thanks needed. Upvotes and accepted answers are the currency of appreciation on Stack Exchange. :) Comments are primarily for clarifications."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1537426143, "post_id": 52414676, "comment_id": 91781448, "body": "You can just call <code>raise</code> to re-raise the currently rescued exception. There&#39;s no need to pass it as an argument."}, {"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1537452160, "post_id": 52414676, "comment_id": 91797110, "body": "@Stefan You&#39;re right(ish). Raise by itself inside the rescue block will re-raise the original exception. However, it&#39;s not very explicit, and explicit helps new Rubyists. In fact, the OP&#39;s example only sends the exception to STDOUT instead of STDERR, so removing the rescue clause altogether makes more sense. There are also cases where raising a different exception or a modified exception after rescuing makes more sense than simply re-raising the original exception. I&#39;ve expanded the explanation, but incorporating your point strays from the OP&#39;s original question about triggering rescue blocks."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1537452242, "post_id": 52414676, "comment_id": 91797172, "body": "@ToddA.Jacobs <code>$stdin.gets</code> and <code>$stdout.puts</code> would also be more explicit \u2013 I think simplicity helps a lot, too ;-) If the program has to deal with invalid user input in more sophisticated ways than merely failing, exception handling might not be the right tool in the first place."}], "tags": [], "owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "is_accepted": true, "score": 5, "last_activity_date": 1537454406, "last_edit_date": 1537454406, "creation_date": 1537393948, "answer_id": 52414676, "question_id": 52411577, "link": "https://stackoverflow.com/questions/52411577/why-is-this-exception-not-being-caught-by-the-rescue-block/52414676#52414676", "title": "Why is this exception not being caught by the rescue block?", "body": "<h2>Behavior Differs Between String#to_i and Kernel#Integer</h2>\n\n<p>The reason your exception handler is never called is because <a href=\"https://ruby-doc.org/core-2.5.1/String.html#method-i-to_i\" rel=\"nofollow noreferrer\">String#to_i</a> doesn't raise an exception, even if it can't detect a valid integer within the String object. In such cases, it simply returns <code>0</code>.</p>\n\n<p>In comparison, the behavior of <a href=\"https://ruby-doc.org/core-2.5.1/Kernel.html#method-i-Integer\" rel=\"nofollow noreferrer\">Kernel#Integer</a> is more complex, but is expected to raise ArgumentError or TypeError if the contents of the string do not strictly conform to a numeric representation.</p>\n\n<p>So, to minimally refactor your existing code to raise an exception on non-numeric inputs:</p>\n\n<pre><code>begin\n  print 'Enter something: ' \n  x = Integer gets\nrescue =&gt; err\n  # Do something other than just print err on STDERR, which is the \n  # default behavior anyway. Perhaps send it to STDOUT instead.\n  puts \"I received an exception: #{err}\"\n\n  # After handling, re-raise the original exception with or without\n  # passing the original exception object. `raise` and `raise err` \n  # will do the same thing here.\n  raise\n\n  # For more advanced uses, you can also do something else like raise \n  # a different exception (e.g. TypeError), or modify the exception\n  # object stored in err and raise that modified object instead.\nend\n</code></pre>\n\n<p>The following user inputs will each convert cleanly:</p>\n\n<ul>\n<li><code>1</code></li>\n<li><code>2</code></li>\n<li><code>0xff</code></li>\n</ul>\n\n<p>The code will even handle initial/trailing spaces, newlines, and carriage returns in most cases, without any additional effort on your part. However:</p>\n\n<ul>\n<li><blockquote>\n  <p>Enter something: one<br>\n  ArgumentError: invalid value for Integer(): \"one\\n\"</p>\n</blockquote></li>\n<li><blockquote>\n  <p>Enter something: \"1\"<br>\n  ArgumentError: invalid value for Integer(): \"\\\"1\\\"\\n\"</p>\n</blockquote></li>\n<li><blockquote>\n  <p>Enter something: nil<br>\n  ArgumentError: invalid value for Integer(): \"nil\\n\"</p>\n</blockquote></li>\n</ul>\n\n<p>In general, you can rely on Kernel#Integer to raise an exception when necessary, which simplifies your code a lot. However, see caveats below.</p>\n\n<h2>Caveats</h2>\n\n<p>These examples don't require it, but you might also want to sanitize your input with #strip, #chomp, or other string transformations when necessary. Your mileage in this regard will vary greatly with your real-world use case, but while Kernel#Integer generally does the right thing, and Ruby encourages relying on exceptions to handle non-standard edge cases, it's often unwise to trust user-tainted inputs.</p>\n\n<p>It's also worth noting that both String#to_i and Kernel#Integer might operate on values other than user input, in which case know that <code>Integer(nil)</code> will raise:</p>\n\n<blockquote>\n  <p>Integer nil<br>\n  TypeError: can't convert nil into Integer</p>\n</blockquote>\n\n<p>This might be important. Again, your mileage may vary.</p>\n"}], "owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 52414676, "answer_count": 1, "score": 2, "last_activity_date": 1537454406, "creation_date": 1537379357, "last_edit_date": 1537415418, "question_id": 52411577, "link": "https://stackoverflow.com/questions/52411577/why-is-this-exception-not-being-caught-by-the-rescue-block", "title": "Why is this exception not being caught by the rescue block?", "body": "<p>I ran this code:</p>\n\n<pre><code>begin\n  print 'Enter something:'\n  x = gets.to_i          # Enter a string\nrescue =&gt; err\n  print(err.to_s)\nend\n</code></pre>\n\n<p>I don't get why the rescue block does not catch the exception. It always\nreturns zero when a string is input, and doesn't trigger the rescue block. I don't know why it isn't working. Can anyone please help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "activerecord"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537380042, "post_id": 52411498, "comment_id": 91767125, "body": "In which view file you have that code for adding rooms to floor?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10387184"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537380126, "post_id": 52411498, "comment_id": 91767168, "body": "@Pavan floors/index, and I want to make room forms there."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1537380717, "post_id": 52411498, "comment_id": 91767464, "body": "Note that <code>floor.rooms</code> is never going to be <code>nil</code>, because it will always return an ActiveRecord association of some kind. If the intent is to check if a <code>floor</code> has no <code>rooms</code>, you should use <code>floor.rooms.empty?</code>. Or it may be more clear to write <code>if floor.rooms.present?</code>."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1537388578, "post_id": 52411498, "comment_id": 91771054, "body": "Although this is not a solution, your current <code>floor_params</code> are at least faulty since it&#39;s an <i>has_many</i> association. <code>room_attributes: [:name]</code> should be <code>rooms_attributes: [:name]</code> (notice the plural form of room(s))"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10387184"}, "edited": false, "score": 0, "creation_date": 1537458641, "post_id": 52411498, "comment_id": 91801291, "body": "thanks everyone on your advices, I will implement them to my code"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10387184"}, "edited": false, "score": 0, "creation_date": 1537458659, "post_id": 52411935, "comment_id": 91801309, "body": "this is what I was looking for. Thank you!"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1537381603, "last_edit_date": 1537381603, "creation_date": 1537380881, "answer_id": 52411935, "question_id": 52411498, "link": "https://stackoverflow.com/questions/52411498/rails-form-for-child-object/52411935#52411935", "title": "Rails - form for child object", "body": "<p>So you want to create rooms for an existing floor, then you can't use <code>accepts_nested_attributes_for</code>. Instead you can use <em>nested resources</em> with <code>form_for</code> to create a room for that floor like so</p>\n\n<pre><code>&lt;%= form_for [floor, @room] do |f| %&gt;\n  --- code---\n&lt;% end %&gt;\n</code></pre>\n\n<p>In <code>floor_controller#index</code> add <code>@room = Room.new</code> and include the below in <code>routes.rb</code></p>\n\n<pre><code>#routes.rb\nresources :floors do\n  resources :rooms, only: [:create]\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10387184"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 52411935, "answer_count": 1, "score": 0, "last_activity_date": 1537381603, "creation_date": 1537378995, "question_id": 52411498, "link": "https://stackoverflow.com/questions/52411498/rails-form-for-child-object", "title": "Rails - form for child object", "body": "<p>I'm little bit confused about Rails forms. I know there are nested forms, but I need something else. I think. </p>\n\n<p>So, I have models floor and room. Every floor have many rooms, and every room belongs to one floor. (1-N association) </p>\n\n<p>On every floor I have button to add new room. (opens modal for form).</p>\n\n<p>How can I make form for that room with association to floor?</p>\n\n<hr>\n\n<p>View:</p>\n\n<pre><code>&lt;% @floors.each do |floor| %&gt;\n  &lt;div class=\"card\"&gt;\n    &lt;div class=\"card-content\"&gt;\n      &lt;span class=\"card-title\"&gt;&lt;b&gt; &lt;%= floor.name %&gt;&lt;/b&gt;&lt;/span&gt;\n      &lt;div class=\"row\"&gt;\n      &lt;% floor.rooms.each do |room| %&gt;\n          &lt;div class=\"input-field col s3 l3\"&gt;\n            &lt;div class=\"card\"&gt;\n              &lt;div class=\"card-content\"&gt;\n                &lt;span class=\"card-title\"&gt;&lt;b&gt; &lt;%= room.name %&gt;&lt;/b&gt;&lt;/span&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n      &lt;% end unless floor.rooms.nil?%&gt;\n        &lt;a class=\"waves-effect waves-light btn modal-trigger\" style=\"float: right\" href=\"#modal2\"&gt;Add room&lt;/a&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>Models:</p>\n\n<pre><code>class Floor &lt; ApplicationRecord\n  has_many :rooms\n  accepts_nested_attributes_for :rooms\nend\n\nclass Room &lt; ApplicationRecord\n  belongs_to :floor\nend\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>  def floor_params\n    params.require(:floor).permit(:name, :room_attributes =&gt; [:name])\n  end\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 0, "last_activity_date": 1537375861, "creation_date": 1537375861, "answer_id": 52410743, "question_id": 52410742, "link": "https://stackoverflow.com/questions/52410742/permutations-of-multiple-arrays/52410743#52410743", "title": "Permutations of multiple arrays", "body": "<p>Since each item, such as <code>[[:a, :c], :e]</code> is almost correct it can be flattened:</p>\n\n<pre><code>[[:a, :b], [:c, :d], [:e, :f]].reduce(&amp;:product).map(&amp;:flatten)\n# =&gt; [[:a, :c, :e], [:a, :c, :f], [:a, :d, :e], [:a, :d, :f] ...]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1537387285, "post_id": 52411699, "comment_id": 91770556, "body": "Or if your data is not stuck in one large array: <code>a1.product(a2, a3, ...)</code>"}], "tags": [], "owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "is_accepted": false, "score": 3, "last_activity_date": 1537379934, "creation_date": 1537379934, "answer_id": 52411699, "question_id": 52410742, "link": "https://stackoverflow.com/questions/52410742/permutations-of-multiple-arrays/52411699#52411699", "title": "Permutations of multiple arrays", "body": "<pre><code>data = [[:a, :b], [:c, :d], [:e, :f]]\ndata[0].product(*data[1..-1])\n# =&gt; [[:a, :c, :e], [:a, :c, :f], [:a, :d, :e], [:a, :d, :f], [:b, :c, :e], [:b, :c, :f], [:b, :d, :e], [:b, :d, :f]]\n</code></pre>\n\n<p>and you can extend your data with more arrays</p>\n"}], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1537379934, "creation_date": 1537375861, "question_id": 52410742, "link": "https://stackoverflow.com/questions/52410742/permutations-of-multiple-arrays", "title": "Permutations of multiple arrays", "body": "<p>Currently I can get all permutations of a two item array as such:</p>\n\n<pre><code>[[:a, :b], [:c, :d]].reduce(&amp;:product)\n# =&gt; [[:a, :c], [:a, :d], [:b, :c], [:b, :d]]\n</code></pre>\n\n<p>However when I try and do the same for a three item array I do not get the desired result:</p>\n\n<pre><code>[[:a, :b], [:c, :d], [:e, :f]].reduce(&amp;:product)\n# =&gt; [[[:a, :c], :e], [[:a, :c], :f], [[:a, :d], :e], [[:a, :d], :f]]\n</code></pre>\n\n<p>The expected result is:</p>\n\n<pre><code>[[:a, :c, :e], [:a, :c, :f], [:a, :d, :e], [:a, :d, :f] ...]\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2243, "user_id": 2860622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VDOcV.jpg?s=128&g=1", "display_name": "ouni", "link": "https://stackoverflow.com/users/2860622/ouni"}, "edited": false, "score": 0, "creation_date": 1537375649, "post_id": 52410677, "comment_id": 91765026, "body": "ruby 2.4.4p296 (2018-03-28 revision 63013) [x64-mingw32] on Windows"}, {"owner": {"reputation": 2243, "user_id": 2860622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VDOcV.jpg?s=128&g=1", "display_name": "ouni", "link": "https://stackoverflow.com/users/2860622/ouni"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1537376095, "post_id": 52410677, "comment_id": 91765252, "body": "True: then why is x nil inside the block?"}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1537376990, "post_id": 52410984, "comment_id": 91765665, "body": "Very good answer. You may want to add a sentence to the effect of &quot;the whole point of block-<i>local</i> variables is that they are <i>local</i> to the block and <i>do not</i> capture their lexical surrounding scope.&quot;"}, {"owner": {"reputation": 2243, "user_id": 2860622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VDOcV.jpg?s=128&g=1", "display_name": "ouni", "link": "https://stackoverflow.com/users/2860622/ouni"}, "edited": false, "score": 0, "creation_date": 1537377514, "post_id": 52410984, "comment_id": 91765901, "body": "Huh, so the only purpose of block variables in Ruby, is so that you don&#39;t need to rename a global <code>x</code> to a local <code>my_x</code> within the block?"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 2243, "user_id": 2860622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VDOcV.jpg?s=128&g=1", "display_name": "ouni", "link": "https://stackoverflow.com/users/2860622/ouni"}, "edited": false, "score": 1, "creation_date": 1537378413, "post_id": 52410984, "comment_id": 91766362, "body": "@ouni You should stop referring to <code>x</code> as a global variable here, it isn&#39;t. Global variables in Ruby start with a <code>$</code> sign, ie <code>$x</code>. The purpose of block variables is to define a variable scoped to the block, nothing more. It has nothing to do with variables already declared in the parent scope which happen to have the same name."}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": true, "score": 2, "last_activity_date": 1537377144, "last_edit_date": 1537377144, "creation_date": 1537376821, "answer_id": 52410984, "question_id": 52410677, "link": "https://stackoverflow.com/questions/52410677/ruby-how-do-to-initialize-the-value-of-a-block-variable/52410984#52410984", "title": "Ruby: How do to initialize the value of a block variable", "body": "<blockquote>\n  <p>I  would expect the x block variable to automatically capture the value of the x global variable, </p>\n</blockquote>\n\n<p>That is not how Ruby works, and there is no reason to expect it to behave that way. An inner variable never takes its value from a variable it is shadowing, in <em>any</em> language that I know of. That would be a horribly designed language, where unrelated outer context could be changed or introduced that breaks an inner scope in completely unanticipated ways. The entire purpose of <strong>scope</strong> is to <strong>prevent</strong> this kind of thing.</p>\n\n<p><code>x</code> is <code>nil</code>, because it's a newly introduced variable that you didn't assign a value to.</p>\n\n<blockquote>\n  <p>How do I initialize the value of a block variable in Ruby?</p>\n</blockquote>\n\n<p>You can check if it is <code>nil</code>, and then assign a value to it:</p>\n\n<pre><code>x = 10\n3.times do |i; x|\n  x ||= 0\n  x = x + 1\n  puts(\"inside block is #{x}\")\nend\nputs(\"outside block is #{x}\")\n</code></pre>\n\n<p>Note that this loop prints <code>\"inside block is 1\"</code>, three times. You're making a new <code>x</code> and setting it to 0 each time the block is invoked. If you want to accumulate state while you iterate, this is the wrong way to go about it. You either want to <em>not</em> shadow the outer <code>x</code>, or use a different Enumerable method like <code>inject</code> or <code>each.with_object</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2243, "user_id": 2860622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VDOcV.jpg?s=128&g=1", "display_name": "ouni", "link": "https://stackoverflow.com/users/2860622/ouni"}, "edited": false, "score": 0, "creation_date": 1537376994, "post_id": 52410986, "comment_id": 91765666, "body": "I&#39;m specifically trying to get the <code>| something, somethine_else; local_var |</code> syntax to work (with the semicolon).  The semicolon is not a block argument, it&#39;s a block variable, see <a href=\"https://viewsourcecode.org/why/redhanded/inspect/ruby20BlockLocalVariable.html\" rel=\"nofollow noreferrer\">viewsourcecode.org/why/redhanded/inspect/&hellip;</a>"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 2243, "user_id": 2860622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VDOcV.jpg?s=128&g=1", "display_name": "ouni", "link": "https://stackoverflow.com/users/2860622/ouni"}, "edited": false, "score": 0, "creation_date": 1537377293, "post_id": 52410986, "comment_id": 91765789, "body": "will update with the semicolon, the answer is the same for scope and the reason it is not working"}], "tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": false, "score": 0, "last_activity_date": 1537377301, "last_edit_date": 1537377301, "creation_date": 1537376827, "answer_id": 52410986, "question_id": 52410677, "link": "https://stackoverflow.com/questions/52410677/ruby-how-do-to-initialize-the-value-of-a-block-variable/52410986#52410986", "title": "Ruby: How do to initialize the value of a block variable", "body": "<p>This is because in ruby blocks do not create a new scope BUT they do create variables in their lookup table.</p>\n\n<p>Your block would have access to the global x BUT you are passing x as an argument to the block.  When times iterates it passes the i and x is set to nil because it is not passed a variable.  So in your block you have a new x that has a value of nil on each iteration.  If you pass in any other named variable it will work.</p>\n\n<pre><code>x = 10\n3.times do |i; y|\n  x = x + 1\n  puts(\"x block is #{x}\")\nend\nputs(\"outside block is #{x}\")\n</code></pre>\n\n<p>Or even better, don't define it with another argument unless you are wanting to override any globals</p>\n\n<pre><code>x = 10\n3.times do |i|\n  x = x + 1\n  puts(\"x block is #{x}\")\nend\nputs(\"outside block is #{x}\")\n</code></pre>\n"}], "owner": {"reputation": 2243, "user_id": 2860622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VDOcV.jpg?s=128&g=1", "display_name": "ouni", "link": "https://stackoverflow.com/users/2860622/ouni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 52410984, "answer_count": 2, "score": 1, "last_activity_date": 1537377301, "creation_date": 1537375624, "last_edit_date": 1537377216, "question_id": 52410677, "link": "https://stackoverflow.com/questions/52410677/ruby-how-do-to-initialize-the-value-of-a-block-variable", "title": "Ruby: How do to initialize the value of a block variable", "body": "<p>I am studying Ruby, and typed a piece of code to experiment with block-scoped variables:</p>\n\n<pre><code>x = 10\n3.times do |i; x|\n  x = x + 1\n  puts(\"inside block is #{x}\")\nend\nputs(\"outside block is #{x}\")\n</code></pre>\n\n<p>I would expect the x block variable to automatically capture the value of the x global variable, and then x inside the block to be 11 every time, and x outside the block to be protected, and stay at 10.  This \"shielding\" action is what is described in many Ruby tutorials found throughout the web.</p>\n\n<p>But instead, the script fails, telling me that x is nil and that it doesn't have a <code>+</code> function.  In other words, the x block variable hasn't been initialized with a value.</p>\n\n<p>The <strong>exact</strong> code above is in a file called <code>delete_me.rb</code>, and ran with:\n<code>ruby delete_me.rb</code></p>\n\n<p>When I run the script, I get the following error:</p>\n\n<pre><code>delete_me.rb:3:in `block in &lt;main&gt;': undefined method `+' for nil:NilClass (NoMethodError)\n    from delete_me.rb:2:in `times'\n    from delete_me.rb:2:in `&lt;main&gt;'\n</code></pre>\n\n<p>How do I initialize the value of a block variable in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537376014, "post_id": 52410629, "comment_id": 91765205, "body": "Try changing <code>device_used</code> to <code>device</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1537376774, "post_id": 52410759, "comment_id": 91765578, "body": "Still didn&#39;t work, are you saying I should use instance variable instead or a local variable?"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1537376982, "post_id": 52410759, "comment_id": 91765660, "body": "Did you do the alias after it was defined or before?  alias_method should be after the <code>device_used</code> is defined for the class to define it properly"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1537377906, "post_id": 52410759, "comment_id": 91766104, "body": "Thats what I have done, but it doesnt work. What goes to my template view maybe thats where the problem is?"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1537378481, "post_id": 52410759, "comment_id": 91766396, "body": "Hmmm, so going back to assumptions then, what is the <code>@traffic</code> is it an instance of a SignupHistory?"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1537379656, "post_id": 52410759, "comment_id": 91766917, "body": "It is an instance variable to show method logic, which shouldn&#39;t affect the solution I think"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1537383114, "post_id": 52410759, "comment_id": 91768603, "body": "Ah so i think that is it, your traffic isn&#39;t something that responds to device.  What is that things class?  If it isn&#39;t a SignupHistory then you will have to wire up the @traffic to be able to respond to device and delegate that call to the related SignupHistory"}], "tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": false, "score": 0, "last_activity_date": 1537375908, "creation_date": 1537375908, "answer_id": 52410759, "question_id": 52410629, "link": "https://stackoverflow.com/questions/52410629/showing-virtual-attributes-that-doesnt-exist-in-the-database-in-the-view-templa/52410759#52410759", "title": "Showing virtual attributes that doesn&#39;t exist in the database in the view template", "body": "<pre><code>class SignupHistory &lt; ActiveRecord::Base\n\n  attr_accessor(:device)\n\n  def device_used # This method returns the device used from User-Agent and mapped as either Desktop or Mobile\n    device = \"#{request.headers[\"User-Agent\"].match(/\\(.*?\\)/)[0].split('(')[1].split(';')[0]}\"\n    [:Macintosh, :Windows, :Linux, :Unix].include?(device) ? 'Desktop' : 'Mobile'\n  end\n</code></pre>\n\n<p>the <code>device</code> in your <code>device_used</code> method is a local variable, which is not accessible the way you are wanting, attr_accessor in this case is the same as writing this, which is why your column is blank</p>\n\n<pre><code>def device\nend\n</code></pre>\n\n<p>To accomplish what you want, you want to use an alias, you should add this to your class and will be good to go.</p>\n\n<p><code>alias_method :device, :device_used</code></p>\n"}], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537375908, "creation_date": 1537375456, "question_id": 52410629, "link": "https://stackoverflow.com/questions/52410629/showing-virtual-attributes-that-doesnt-exist-in-the-database-in-the-view-templa", "title": "Showing virtual attributes that doesn&#39;t exist in the database in the view template", "body": "<p>Am trying to show on the view template information not in the database but deduced out of logic, but it doesn't work for me.</p>\n\n<p>Here is what I have done:</p>\n\n<p><strong>models</strong></p>\n\n<pre><code>class SignupHistory &lt; ActiveRecord::Base\n\n  attr_accessor(:device)\n\n  def device_used # This method returns the device used from User-Agent and mapped as either Desktop or Mobile\n    device = \"#{request.headers[\"User-Agent\"].match(/\\(.*?\\)/)[0].split('(')[1].split(';')[0]}\"\n    [:Macintosh, :Windows, :Linux, :Unix].include?(device) ? 'Desktop' : 'Mobile'\n  end\nend\n</code></pre>\n\n<p><strong>template view</strong></p>\n\n<pre><code>.row\n  .panel.panel-primary\n    .panel-heading\n      span = t('admin_header.traffics')\n    .panel-body\n      = table_for(@traffic, class: 'table table-condensed table-hover') do |t|\n        - t.column :device, 'Devise Used', class: 'col-xs-2' # I want to output the returned value in device_used method here.\n</code></pre>\n\n<p>I dont want to create a new attribute in the database, I just wanna show that object in the view for all entries in the database.</p>\n\n<p>As you can see from the image below and it should show the result of device_used method, but doesn't show anything\n<a href=\"https://i.stack.imgur.com/N6sQ7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N6sQ7.png\" alt=\"template view picture\"></a></p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 1, "creation_date": 1537380283, "post_id": 52410357, "comment_id": 91767258, "body": "are you sure that this code causes the error?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10245513, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W-9TM5dhuhE/AAAAAAAAAAI/AAAAAAAABa4/5yqQBw4G934/photo.jpg?sz=128", "display_name": "Pavel Larionov", "link": "https://stackoverflow.com/users/10245513/pavel-larionov"}, "edited": false, "score": 1, "creation_date": 1537422876, "post_id": 52417711, "comment_id": 91780036, "body": "Thank you. Your reformat code fix my problem. I used Pony 1.12"}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 4, "last_activity_date": 1537418688, "last_edit_date": 1537418688, "creation_date": 1537418360, "answer_id": 52417711, "question_id": 52410357, "link": "https://stackoverflow.com/questions/52410357/error-when-send-mail-with-gem-pony-on-ruby/52417711#52417711", "title": "Error when send mail with gem pony on Ruby", "body": "<p>The answer is in the error message that you posted:</p>\n\n<pre><code>/home/fucc/.rvm/gems/ruby-2.5.1/gems/pony-1.11/lib/pony.rb:250:in `block in build_mail': undefined method `body' for Pony:Module (NoMethodError)\n</code></pre>\n\n<p>That means that in the gem's source code, in the file <code>lib/pony.rb</code> on line 250 there is an attempt to call the method <code>Pony.body</code>, but the module <code>Pony</code> does not have a method <code>body</code> so an exception is being raised.</p>\n\n<p>In cases like this, it helps to look at the source in <a href=\"https://github.com/benprew/pony\" rel=\"nofollow noreferrer\">the git repository for the gem</a>. The first thing to notice is that the latest version of that gem is 1.12 and you are using 1.11. So what changed between 1.11 and 1.12, and could it fix this issue?</p>\n\n<p>Looking at the <a href=\"https://github.com/benprew/pony/commits/master/lib/pony.rb\" rel=\"nofollow noreferrer\">history for <code>lib/pony.rb</code></a> I see there was an commit in November 2017 named '<a href=\"https://github.com/benprew/pony/commit/cde196f6fa7d805707e7d3c5c56b8aaaefe62249#diff-b4c9b7fff4d07a6b5b3d10a2a9470392\" rel=\"nofollow noreferrer\">Fix NoMethodError when pony is used with mail 2.7.0</a>'. This change modifies <code>lib/pony.rb</code> line 250 and changes the method call for <code>body</code>. This is the exact line of code and method call that raised the error you described.</p>\n\n<p>The solution is to update your copy of <code>pony</code>, for example with <code>gem update pony</code> or if you are using bundler then <code>bundle update</code>. And if the gem is defined in a Gemfile then make sure there is no version restriction on it.</p>\n\n<p>I noticed you said you're using 1.12 and that you've tried rolling the version forward and backward, but that's not accurate. You're using 1.11 and you can tell because the path in your error message is <code>gems/pony-1.11</code>. So however it is your application is configured, it is configured to use 1.11. If you still can't get your app to use 1.12 then please post a comment explaining how you are managing gems for your app.</p>\n\n<p>Finally, I recommend that you reformat your code to make it a little more readable:</p>\n\n<pre><code>def place\n  Pony.mail(\n    to: StoreApplication::Admin.email,\n    from: 'My store &lt;mail@gmail.com&gt;',\n    via: :smtp,\n    via_options: {\n      address: 'smtp.gmail.com',\n      port: '587',\n      user_name: 'mail@gmail.com',\n      password: '###########',\n      authentication: :plain,\n      domain: 'mail.google.com'\n    },\n    subject: 'New order',\n    body: 'Check your admin page'\n  )\nend\n</code></pre>\n\n<p>Changes made include:</p>\n\n<ul>\n<li>Change double quotes to single quotes (single quotes except when using string interpolation)</li>\n<li>Fix indentation (two spaces)</li>\n<li>Fix hash keys (don't use <code>:key =&gt; value</code>, use <code>key: value</code>)</li>\n<li>Fix spelling on <code>adress</code> to <code>address</code></li>\n<li>Remove extra spaces</li>\n<li>Properly align blocks and closures</li>\n</ul>\n\n<p>The <a href=\"https://github.com/rubocop-hq/ruby-style-guide\" rel=\"nofollow noreferrer\">Ruby Style Guide</a> can help with making sense of the recommended changes.</p>\n"}], "owner": {"reputation": 33, "user_id": 10245513, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W-9TM5dhuhE/AAAAAAAAAAI/AAAAAAAABa4/5yqQBw4G934/photo.jpg?sz=128", "display_name": "Pavel Larionov", "link": "https://stackoverflow.com/users/10245513/pavel-larionov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 52417711, "answer_count": 1, "score": 3, "last_activity_date": 1537418688, "creation_date": 1537374278, "question_id": 52410357, "link": "https://stackoverflow.com/questions/52410357/error-when-send-mail-with-gem-pony-on-ruby", "title": "Error when send mail with gem pony on Ruby", "body": "<p>On initialization .rb i take this error</p>\n\n<pre><code>/home/fucc/.rvm/gems/ruby-2.5.1/gems/pony-1.11/lib/pony.rb:250:in `block in build_mail': undefined method `body' for Pony:Module (NoMethodError)\n</code></pre>\n\n<p>Cod when i send mail </p>\n\n<pre><code>def place\n# Actually order\nPony.mail(:to =&gt; StoreApplication::Admin.email, \n            :from =&gt; \"My store &lt;mail@gmail.com&gt;\",\n            :via =&gt; :smtp,\n            :via_options =&gt; {\n            adress:             'smtp.gmail.com',\n            port:               '587',\n            user_name:          'mail@gmail.com',\n            password:           '###########',\n            authentication:     :plain,\n            domain:             \"mail.google.com\" },\n            subject: \"New order\", body: \"Check your admin page\")\nend\n</code></pre>\n\n<p>Ruby 2.5.1, Pony 1.12.\nI do:\n- update all gem's;\n- install again gem Pony;\n- down and up pony version</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mailer"], "comments": [{"owner": {"reputation": 3736, "user_id": 1031061, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/8IZUV.jpg?s=128&g=1", "display_name": "Pardeep Dhingra", "link": "https://stackoverflow.com/users/1031061/pardeep-dhingra"}, "edited": false, "score": 1, "creation_date": 1537371656, "post_id": 52409039, "comment_id": 91762877, "body": "You are not calling <code>deliver_now</code> in <code>no_order_today</code>"}, {"owner": {"reputation": 1411, "user_id": 6776035, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/33c72abeb78d3742e8c0064bed548b8e?s=128&d=identicon&r=PG", "display_name": "Uj Corb", "link": "https://stackoverflow.com/users/6776035/uj-corb"}, "reply_to_user": {"reputation": 3736, "user_id": 1031061, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/8IZUV.jpg?s=128&g=1", "display_name": "Pardeep Dhingra", "link": "https://stackoverflow.com/users/1031061/pardeep-dhingra"}, "edited": false, "score": 1, "creation_date": 1537376531, "post_id": 52409039, "comment_id": 91765457, "body": "Indeed... I was actually testing it first in the console... Make sense now. Thank you very much for your help @PardeepDhingra !"}], "answers": [{"tags": [], "owner": {"reputation": 1411, "user_id": 6776035, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/33c72abeb78d3742e8c0064bed548b8e?s=128&d=identicon&r=PG", "display_name": "Uj Corb", "link": "https://stackoverflow.com/users/6776035/uj-corb"}, "is_accepted": false, "score": 0, "last_activity_date": 1537431693, "creation_date": 1537431693, "answer_id": 52420651, "question_id": 52409039, "link": "https://stackoverflow.com/questions/52409039/object-doesnt-support-inspect-for-mailer-rails/52420651#52420651", "title": "(Object doesn&#39;t support #inspect) for mailer Rails", "body": "<p>as @Pardeep Dhingra mentionned in the comments, I need to call <code>deliver_now</code> so that the mail get sent. </p>\n\n<p>To run <code>RestaurantMailer.no_order_today(recipient, shift, meal)</code> in the console wont work either. So the right answer is: </p>\n\n<ul>\n<li><p><code>RestaurantMailer.no_order_today(recipient, shift, meal).deliver_now</code>\nto test in the console </p></li>\n<li><p><code>no_order_today(r, 'Pas de commandes Take a Meal aujourd\\'hui',\n@meal).deliver_now</code> in my code.</p></li>\n</ul>\n"}], "owner": {"reputation": 1411, "user_id": 6776035, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/33c72abeb78d3742e8c0064bed548b8e?s=128&d=identicon&r=PG", "display_name": "Uj Corb", "link": "https://stackoverflow.com/users/6776035/uj-corb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 412, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537431693, "creation_date": 1537369798, "question_id": 52409039, "link": "https://stackoverflow.com/questions/52409039/object-doesnt-support-inspect-for-mailer-rails", "title": "(Object doesn&#39;t support #inspect) for mailer Rails", "body": "<p>So I'm trying to create two emails. One is sent to a Restaurant when it has at least an order (orders_of_the_day), otherwise it sends the other ones (no_order_today). </p>\n\n<p>The orders_of_the_day case works great. The second does not: It get the following error when I run <code>RestaurantMailer.no_order_today</code> in local: </p>\n\n<blockquote>\n  <p>(Object doesn't support #inspect)</p>\n</blockquote>\n\n<p>Here is my restaurant_mailer.rb file: </p>\n\n<pre><code>class RestaurantMailer &lt; ApplicationMailer\n  default from: 'noreply@takeameal.fr'\n\n  def self.send_orders_of_the_day\n    @restaurants = Restaurant.where(vacation_mode: false)\n    @restaurants.each do |r|\n      @meal = Meal.find_by(restaurant_id: r[:id], week_day: Date.today.cwday)\n      @orders = Order.where(\"created_at &gt;= :start_time and meal_id = :meal\", start_time: DateTime.new(Date.today.year, Date.today.month, Date.today.day, 13, 0, 0).in_time_zone('Paris').prev_day, meal: @meal.id).order(:pick_up_time)\n      if !@orders.empty?\n        orders_of_the_day(r, '\u00c0 OUVRIR AVANT 11H30 : COMMANDES TAKE A MEAL ', @meal, @orders).deliver_now\n      else\n        no_order_today(r, 'Pas de commandes Take a Meal aujourd\\'hui', @meal)\n      end\n    end\n  end\n\n  def orders_of_the_day(recipient, shift, meal, orders)\n    @meal = meal\n    unless @meal.nil?\n      @orders = orders\n      emails = [recipient[:email], recipient[:email2], recipient[:email3]].delete_if { |email| email.empty? }\n      mail(to: emails, subject: shift)\n    end\n  end\n\n  def no_order_today(recipient,shift, meal)\n    @meal = meal\n    emails = [recipient[:email], recipient[:email2], recipient[:email3]].delete_if { |email| email.empty? }\n    mail(to: emails, subject: shift)\n  end\n\nend\n</code></pre>\n\n<p>Any idea on why I get this and how to solve it ?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "nomethoderror"], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "edited": false, "score": 0, "creation_date": 1537368755, "post_id": 52408516, "comment_id": 91761004, "body": "I&#39;d amend CourseModulesUser.find_by(id: params[:id]) to CourseModulesUser.find!(params[:id]) so that it raises a 404 error if the object isn&#39;t found."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537370880, "post_id": 52408516, "comment_id": 91762417, "body": "@B.J.B Update the question with the <code>params</code> that appear in the server log when you click the link to complete the <code>course_module</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8331511"}, "edited": false, "score": 0, "creation_date": 1537371073, "post_id": 52408516, "comment_id": 91762529, "body": "See edit #2 it seems to be using the friendly_id slug and not the numeric id"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537371276, "post_id": 52408516, "comment_id": 91762649, "body": "@B.J.B Are you using <code>friendly_id</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8331511"}, "edited": false, "score": 0, "creation_date": 1537371493, "post_id": 52408516, "comment_id": 91762782, "body": "I am, but obviously, I want to use the id not the slug"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537371591, "post_id": 52408516, "comment_id": 91762835, "body": "@B.J.B Ok, try changing <code>&lt;%= link_to complete_course_module_path(course_module), method: :put do %&gt;</code> to <code>&lt;%= link_to complete_course_module_path(course_module.id), method: :put do %&gt;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8331511"}, "edited": false, "score": 0, "creation_date": 1537372140, "post_id": 52408516, "comment_id": 91763139, "body": "Ah, that worked, awesome. However, the ticks still don&#39;t change based on the boolean value!"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537372384, "post_id": 52408516, "comment_id": 91763288, "body": "@B.J.B Thats another problem which is unrelated to the current problem. I will update my answer with the changes,so you can mark it as accepted. Btw, you can always post a question explaining the problem."}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1537372540, "last_edit_date": 1537372540, "creation_date": 1537368161, "answer_id": 52408516, "question_id": 52408362, "link": "https://stackoverflow.com/questions/52408362/nomethoderror-on-controller-method-rails-5/52408516#52408516", "title": "NoMethodError on controller method Rails 5", "body": "<p>The error says that <code>@course_modules_user</code> is <strong>nil</strong>, noting wrong with the <code>complete</code> method. So you have defined </p>\n\n<pre><code>@course_modules_user = CourseModulesUser.find_by(id: params[:id]) \n</code></pre>\n\n<p>Check the <code>params</code> and make sure you have a record with <code>params[:id]</code> value in the <code>course_modules_users</code> table, so that <code>@course_modules_user</code> is not nil.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>As you are using <code>friendly_id</code>, the value of <code>id</code> sent as <code>slug</code>. So tell Rails not to by changing the <code>link_to</code> like so</p>\n\n<pre><code>&lt;%= link_to complete_course_module_path(course_module.id), method: :put do %&gt;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8331511"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 52408516, "answer_count": 1, "score": 2, "last_activity_date": 1537372540, "creation_date": 1537367715, "last_edit_date": 1537371117, "question_id": 52408362, "link": "https://stackoverflow.com/questions/52408362/nomethoderror-on-controller-method-rails-5", "title": "NoMethodError on controller method Rails 5", "body": "<p><strong>Edit #2</strong></p>\n\n<p>Here is the server log when I click the tick</p>\n\n<pre><code>Started PUT \"/course_modules/module-1-understanding-email-marketing-basics/complete\" for 127.0.0.1 at 2018-09-19 16:29:42 +0100\nProcessing by CourseModulesUsersController#complete as HTML\n  Parameters: {\"authenticity_token\"=&gt;\"CfIM56PhiIRumytV99CE7GFK6tYumCgDvBwUS79jhbCr3zpXLfbJgvqUFkzwmKLXQiOxk1SmFvGoO4+M1z87wg==\", \"id\"=&gt;\"module-1-understanding-email-marketing-basics\"}\n  CourseModulesUser Load (0.7ms)  SELECT  \"course_modules_users\".* FROM \"course_modules_users\" WHERE \"course_modules_users\".\"id\" = $1 LIMIT $2  [[\"id\", 0], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/course_modules_users_controller.rb:3\nCompleted 500 Internal Server Error in 6ms (ActiveRecord: 0.7ms)\n\n\n\nNoMethodError (undefined method `complete=' for nil:NilClass):\n\napp/controllers/course_modules_users_controller.rb:4:in `complete'\n</code></pre>\n\n<p><strong>Edit #1</strong></p>\n\n<p>So here is where I'm at now.</p>\n\n<p>I can access the records using the rails console</p>\n\n<pre><code>irb(main):017:0&gt; @course_modules_users = CourseModulesUser.find_by(id: 1)\n  CourseModulesUser Load (0.4ms)  SELECT  \"course_modules_users\".* FROM \"course_modules_users\" WHERE \"course_modules_users\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n=&gt; #&lt;CourseModulesUser id: 1, course_module_id: 1, courses_user_id: 1, complete: false, created_at: \"2018-09-19 13:04:16\", updated_at: \"2018-09-19 14:58:17\"&gt;\nirb(main):018:0&gt; @course_modules_users.complete = true\n=&gt; true\n</code></pre>\n\n<p>If I try to check based on the boolean value like this</p>\n\n<pre><code>&lt;% if @course_modules_users.where(complete: true).nil? %&gt;\n  &lt;i class=\"fas fa-check text-green float-left mr-1\"&gt;&lt;/i&gt;\n  &lt;span class=\"text-xs mr-2\"&gt;Completed&lt;/span&gt;\n&lt;% else %&gt;\n  &lt;%= link_to complete_course_module_path(course_module), method: :put do %&gt;\n  &lt;i class=\"fas fa-check text-grey-darkest float-left mr-2\"&gt;&lt;/i&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The show as</p>\n\n<p><img src=\"https://i.gyazo.com/b0254db19013526502461aab49f2d709.png\" alt=\"image\"></p>\n\n<p>But if I manually change a record</p>\n\n<p><img src=\"https://i.gyazo.com/68c862cfde6ea77a2b91bd7304836a89.png\" alt=\"image\"></p>\n\n<p>nothing changes on the front-end</p>\n\n<p><img src=\"https://i.gyazo.com/b0254db19013526502461aab49f2d709.png\" alt=\"image\"></p>\n\n<p><strong>Original</strong></p>\n\n<p>Here is my error:</p>\n\n<p><img src=\"https://i.gyazo.com/026f7d2ef0d478b2922eb44a8da7f4c5.png\" alt=\"image\"></p>\n\n<p>So I currently have a route setup that once clicked triggers the following <code>complete</code> method with changes the record to true. However, as you can see it can't find the complete method.</p>\n\n<p>Here is the database</p>\n\n<p><img src=\"https://i.gyazo.com/aab19c6e5f70f86b06b3efdd1bbd5260.png\" alt=\"database\"></p>\n\n<p>I have tested this in the terminal and it can find the complete field</p>\n\n<p><img src=\"https://i.gyazo.com/5226dfb3782868eaa0d2704a2adc8702.png\" alt=\"termial\"></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "jwt"], "comments": [{"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1537381038, "post_id": 52407961, "comment_id": 91767628, "body": "If a user is not logged in, current_user will be nil, you always have to prepare for this and protect against it."}], "answers": [{"tags": [], "owner": {"reputation": 469, "user_id": 2191500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/064d3016db58b512fcb6cadb3129ad24?s=128&d=identicon&r=PG", "display_name": "matiasmasca", "link": "https://stackoverflow.com/users/2191500/matiasmasca"}, "is_accepted": false, "score": 1, "last_activity_date": 1568418730, "creation_date": 1568418730, "answer_id": 57931428, "question_id": 52407961, "link": "https://stackoverflow.com/questions/52407961/devise-and-knock-gem-current-user/57931428#57931428", "title": "Devise and Knock gem current_user", "body": "<p>Try this in your ApplicationController</p>\n\n<pre><code>   # JWT: Knock defines it's own current_user method unless one is already\n  # defined. As controller class is cached between requests, this method\n  # stays and interferes with a browser-originated requests which rely on\n  # Devise's implementation of current_user. As we define the method here,\n  # Knock does not reimplement it anymore but we have to do its thing\n  # manually.\n  def current_user\n    if token\n      @_current_user ||= begin\n        Knock::AuthToken.new(token: token).entity_for(User)\n      rescue\n        nil\n      end\n    else\n      super\n    end\n  end\n\n  private\n\n  # JWT: No need to try and load session as there is none in an API request\n  def skip_session\n    request.session_options[:skip] = true if token\n  end\n\n  # JWT: overriding Knock's method to manually trigger Devise's auth.\n  # When there is no token we assume the request comes from the browser so\n  # has a session (potentially with warden key) attached.\n  def authenticate_entity(entity_name)\n    if token\n      super(entity_name)\n    else\n      current_user\n    end\n  end\n</code></pre>\n"}], "owner": {"reputation": 2327, "user_id": 1253189, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/56aa566c099ed8007c7ecbecb48de061?s=128&d=identicon&r=PG", "display_name": "Tom Pinchen", "link": "https://stackoverflow.com/users/1253189/tom-pinchen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1568418730, "creation_date": 1537366480, "question_id": 52407961, "link": "https://stackoverflow.com/questions/52407961/devise-and-knock-gem-current-user", "title": "Devise and Knock gem current_user", "body": "<p>I have an application that is using both Devise and Knock. It is using Devise to power the authentication for Active Admin and Knock gem is providing the authentication for my API's</p>\n\n<p>The issue I have is that Knock can't seem to find <code>current_user</code> and I believe this is likely because I am using Devise in the same project. </p>\n\n<p>I have the following setup: </p>\n\n<p><strong>Api Controller</strong></p>\n\n<pre><code>class ApiController &lt; ActionController::API\n  include Knock::Authenticable\nend\n</code></pre>\n\n<p><strong>User Controller (for API not ActiveAdmin)</strong></p>\n\n<pre><code>module Api\n  module V1\n    class UsersController &lt; ApiController      \n      before_action :set_user, only: [:show, :update, :destroy]\n\n      # GET /users/1\n      def show\n        render json: @user\n      end\n\n      # POST /users\n      def create        \n        @user = User.new(user_params)               \n\n        if @user.save\n          render json: @user.id, status: :created\n        else\n          render json: @user.errors, status: :unprocessable_entity\n        end\n      end\n\n      # PATCH/PUT /users/1\n      def update\n        if @user.update(user_params)\n          render json: @user\n        else\n          render json: @user.errors, status: :unprocessable_entity\n        end\n      end\n\n      # DELETE /users/1\n      def destroy\n        @user.destroy\n      end\n\n      private\n      # Use callbacks to share common setup or constraints between actions.\n      def set_user\n        @user = User.find(params[:id])\n      end\n\n      # Only allow a trusted parameter \"white list\" through.\n      def user_params\n        params.require(:user).permit(:email, :password, :password_confirmation)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Auth Controller</strong></p>\n\n<pre><code>module Api\n  module V1\n    class AuthController &lt; ApiController      \n      def auth        \n        render json: { status: 200, user: current_user }\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><code>Current User</code> in this Auth controller returns nothing however in another project I have, without devise, this will correctly return the user. </p>\n\n<p>Is there a way to redefine what current_user is or assign it to something different for the purposes of using Knock? </p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": false, "score": 1, "last_activity_date": 1537365752, "creation_date": 1537365752, "answer_id": 52407735, "question_id": 52407615, "link": "https://stackoverflow.com/questions/52407615/modify-param-if-key-is-present-in-map/52407735#52407735", "title": "Modify param if key is present in MAP", "body": "<p>You can use <code>tap</code> here:</p>\n\n<pre><code>{ \n  payment_type:   payment_type,\n  currency:       currency,\n  country:        country,\n  amount:         amount_for(currency) \n}.tap do |params|\n  if FIXED_COUNTRY_TO_PHONE.has_key?(country)\n    params[:customer_phone] = FIXED_COUNTRY_TO_PHONE[country] \n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537365752, "creation_date": 1537365404, "question_id": 52407615, "link": "https://stackoverflow.com/questions/52407615/modify-param-if-key-is-present-in-map", "title": "Modify param if key is present in MAP", "body": "<p>I want to modify this hash only if key is present into MAP. I tried this:</p>\n\n<pre><code>FIXED_COUNTRY_TO_PHONE = { \n    'FI' =&gt; '+358501111',\n    'RU' =&gt; '4019900780', \n    'SE' =&gt; '+4672345678',\n    'UA' =&gt; '0123456789',\n    'KZ' =&gt; '0123456789'  \n  }.freeze\n\n\ndef base_params_for(payment_type)\n\n    { payment_type:   payment_type,  \n      currency:       currency,\n      country:        country,\n      amount:         amount_for(currency) }    \n\n    params[:customer_phone] = FIXED_COUNTRY_TO_PHONE[country] if FIXED_COUNTRY_TO_PHONE.has_key? 'FI'\nend\n</code></pre>\n\n<p>How I can modify the param <code>:customer_phone</code> only if the key is present?</p>\n"}, {"tags": ["arrays", "json", "ruby", "hash"], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "is_accepted": false, "score": 0, "last_activity_date": 1537368592, "creation_date": 1537368592, "answer_id": 52408651, "question_id": 52407556, "link": "https://stackoverflow.com/questions/52407556/ruby-print-all-the-hashes-subfield-in-one-row/52408651#52408651", "title": "Ruby, print all the hashes &quot;subfield&quot; in one row", "body": "<p>I solved it!</p>\n\n<p>I found this:</p>\n\n<pre><code>puts \"#{data.values}\" # Print all Values\n\nputs \"#{data.keys}\" # Print all Keys\n</code></pre>\n"}], "owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537368592, "creation_date": 1537365249, "question_id": 52407556, "link": "https://stackoverflow.com/questions/52407556/ruby-print-all-the-hashes-subfield-in-one-row", "title": "Ruby, print all the hashes &quot;subfield&quot; in one row", "body": "<p>I have a JSON array structured like this:</p>\n\n<pre><code>{\"elements\":[{\"ECL001\":{\"description\":\"First Element\", \"max_level\":3, \"size\":10}},{\"ECL002\":{\"description\":\"Second Element\", \"max_level\":4, \"size\":1}}]}\n</code></pre>\n\n<p>I'm parsing my structure and then I print data if condition are satisfied.</p>\n\n<pre><code>require 'json'\n\nx = JSON.parse(File.open('data_elements.dat').read)\n\nelements = x[\"elements\"]\n\nelements.each do |elem_specific|\n  elem_specific.each do |id, data|\n    if data['max_level'] &gt; 3\n       puts \"#{data['description']}, #{data['max_level']}, #{data[size]}\"\n    end\n  end\nend\n</code></pre>\n\n<p>It's work correctly, but is there a faster solution to prints data?</p>\n\n<p>I mean ... Is possible replace this</p>\n\n<pre><code>puts \"#{data['description']}, #{data['max_level']}, #{data[size]}\"\n</code></pre>\n\n<p>with something like</p>\n\n<pre><code>puts \"#{data[*ALL]}\"\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "exit-code"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1537368763, "post_id": 52407428, "comment_id": 91761010, "body": "What happens if you switch the order of <code>countSmileys</code> calls?"}, {"owner": {"reputation": 55, "user_id": 10304624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43521d982e2df2eadd2a76b8a1d5b95d?s=128&d=identicon&r=PG&f=1", "display_name": "rhea.rao", "link": "https://stackoverflow.com/users/10304624/rhea-rao"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1537369324, "post_id": 52407428, "comment_id": 91761387, "body": "I just pasted the calls up top when I made the post, when I run the program, the calls are below the actual codes...that&#39;s what you meant right?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1537370517, "post_id": 52407428, "comment_id": 91762190, "body": "No. I meant to change the order of the calls, then look at the exit code you get."}, {"owner": {"reputation": 340, "user_id": 9335023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UciBB.png?s=128&g=1", "display_name": "Maciej N\u0119dza", "link": "https://stackoverflow.com/users/9335023/maciej-n%c4%99dza"}, "edited": false, "score": 0, "creation_date": 1537371561, "post_id": 52407428, "comment_id": 91762818, "body": "Please include error message (content of STDERR) in your question."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1537377320, "post_id": 52407428, "comment_id": 91765803, "body": "An exit code of 1 means that something went wrong. You need to tell us <i>what</i> went wrong. What is the error message you are getting? What line does it point to?"}, {"owner": {"reputation": 55, "user_id": 10304624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43521d982e2df2eadd2a76b8a1d5b95d?s=128&d=identicon&r=PG&f=1", "display_name": "rhea.rao", "link": "https://stackoverflow.com/users/10304624/rhea-rao"}, "edited": false, "score": 0, "creation_date": 1537390826, "post_id": 52407428, "comment_id": 91772008, "body": "thanks guys, please see my edit"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1537394035, "post_id": 52407428, "comment_id": 91773105, "body": "I cannot reproduce your problem. There are <i>many</i> problems with your code (you call the method before you define it, which cannot possibly work, and you try to call it as <code>countSmileys</code>, but you define it as <code>count_smileys</code>, and the comment character in Ruby is <code>#</code> and not <code>&#47;&#47;</code>), but apart from <i>that</i> your code works perfectly. I get <code>2</code>, <code>3</code>, and <code>1</code>, and no exception."}, {"owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "edited": false, "score": 1, "creation_date": 1537394231, "post_id": 52407428, "comment_id": 91773170, "body": "I think everything before the <code>def</code> is a code sample Codewars provides. That&#39;s all javascript not ruby code."}], "answers": [{"tags": [], "owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "is_accepted": false, "score": 0, "last_activity_date": 1537392407, "creation_date": 1537392407, "answer_id": 52414418, "question_id": 52407428, "link": "https://stackoverflow.com/questions/52407428/ruby-count-smiley-face-exit-code-1/52414418#52414418", "title": "Ruby Count Smiley Face - Exit Code = 1", "body": "<p>As the message describes, there's no implicit conversion of nil to string. Explicit does exist though:</p>\n\n<pre><code>2.3.1 :001 &gt; nil.to_s\n=&gt; \"\" \n</code></pre>\n\n<p>You could parse your array for <code>nil</code> first, and then put it through the <code>select</code> method.</p>\n\n<pre><code>def count_smileys(arr)\n  first = \";:\"\n  second = \"-~\"\n  third = \")D\"\n\n  # parse your array for nil values here\n  arr.map {|x| x.nil? ? \"\" : x }\n\n  arr.select{|x|\n    third.include?(x[1]) or (second.include?(x[1]) &amp;&amp; third.include?(x[2].to_s)) \n  }.count\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 10304624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43521d982e2df2eadd2a76b8a1d5b95d?s=128&d=identicon&r=PG&f=1", "display_name": "rhea.rao", "link": "https://stackoverflow.com/users/10304624/rhea-rao"}, "is_accepted": true, "score": 0, "last_activity_date": 1537470212, "creation_date": 1537470212, "answer_id": 52431662, "question_id": 52407428, "link": "https://stackoverflow.com/questions/52407428/ruby-count-smiley-face-exit-code-1/52431662#52431662", "title": "Ruby Count Smiley Face - Exit Code = 1", "body": "<p>I realized what the problem is - there is a test <code>count_smileys([\";\", \")\", \";*\", \":$\", \"8-D\"])</code> where x[1] and x[2] would not be valid for the first 2 items in the array, so I need to fix the array inside the select method:</p>\n\n<pre><code>def count_smileys(arr)\n  first = \";:\"\n  second = \"-~\"\n  third = \")D\"\n  arr.select{|x|\n    x[1] = \" \" if x[1] == nil\n    x[2] = \"\" if x[2] == nil\n    (first.include?(x[0]) &amp;&amp; third.include?(x[1])) || (first.include?(x[0]) &amp;&amp; second.include?(x[1]) &amp;&amp; third.include?(x[2])) \n  }.count\nend\n</code></pre>\n\n<p>Joseph Cho was correct in the sense that nils need to be converted, but we should do it in the iteration, and common items x[1] should be set to an empty string with a space to avoid being counted, while x[2] is uncommon enough that an empty string would work.</p>\n"}], "owner": {"reputation": 55, "user_id": 10304624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43521d982e2df2eadd2a76b8a1d5b95d?s=128&d=identicon&r=PG&f=1", "display_name": "rhea.rao", "link": "https://stackoverflow.com/users/10304624/rhea-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 52431662, "answer_count": 2, "score": -1, "last_activity_date": 1537470212, "creation_date": 1537364811, "last_edit_date": 1537390807, "question_id": 52407428, "link": "https://stackoverflow.com/questions/52407428/ruby-count-smiley-face-exit-code-1", "title": "Ruby Count Smiley Face - Exit Code = 1", "body": "<p>The count smiley face question on Codewars, my codes passed all the tests, but an \"Exit Code = 1\" error message keeps popping up, what does that mean? What went wrong? </p>\n\n<pre><code>countSmileys([':)', ';(', ';}', ':-D']);       // should return 2;\ncountSmileys([';D', ':-(', ':-)', ';~)']);     // should return 3;\ncountSmileys([';]', ':[', ';*', ':$', ';-D']); // should return 1;\n\n    def count_smileys(arr)\n      first = \";:\"\n      second = \"-~\"\n      third = \")D\"\n      arr.select{|x|\n        third.include?(x[1]) or (second.include?(x[1]) &amp;&amp; third.include?(x[2].to_s)) \n      }.count\n    end\n</code></pre>\n\n<p><strong>EDIT:</strong>\nThe error message is as below:</p>\n\n<pre><code>main.rb:8:in `include?': no implicit conversion of nil into String (TypeError)\n    from main.rb:8:in `block in count_smileys'\n    from main.rb:7:in `select'\n    from main.rb:7:in `count_smileys'\n    from main.rb:16:in `block in &lt;main&gt;'\n    from /runner/frameworks/ruby/cw-2.rb:55:in `block in describe'\n    from /runner/frameworks/ruby/cw-2.rb:46:in `measure'\n    from /runner/frameworks/ruby/cw-2.rb:51:in `describe'\n    from main.rb:11:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 1, "creation_date": 1537365340, "post_id": 52406422, "comment_id": 91758801, "body": "your raise an error always, you need to do that only when you effectively run into a problem, comment out the raise and see what happens"}], "answers": [{"tags": [], "owner": {"reputation": 197, "user_id": 3703380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NrARm.jpg?s=128&g=1", "display_name": "Biasu", "link": "https://stackoverflow.com/users/3703380/biasu"}, "is_accepted": false, "score": 0, "last_activity_date": 1537468861, "last_edit_date": 1537468861, "creation_date": 1537468176, "answer_id": 52431184, "question_id": 52406422, "link": "https://stackoverflow.com/questions/52406422/get-content-from-yaml-file/52431184#52431184", "title": "Get content from yaml file", "body": "<p>it should be something like this:</p>\n\n<pre><code>def load_paysec_payment_type_with_base_params\n   begin\n      YAML.load_file(\"config/gateway_supported_trx_types.yml\")['paysec']['supported_trx_types']\n   rescue Exception =&gt; e  \n      \"\\n\\nMissing configuration for paysec in file config/gateway_supported_trx_types.yaml}. reason: \" + e.message\nend\n</code></pre>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537468861, "creation_date": 1537361855, "question_id": 52406422, "link": "https://stackoverflow.com/questions/52406422/get-content-from-yaml-file", "title": "Get content from yaml file", "body": "<p>I want to get the content from YALM file <code>qqpay, online_banking, bank_payout</code> using Ruby. I tried this:</p>\n\n<p>YAML File content:</p>\n\n<pre><code>paysec:\n  supported_trx_types: [qqpay, online_banking, bank_payout]\n</code></pre>\n\n<p>Ruby code:</p>\n\n<pre><code>def load_paysec_payment_type_with_base_params\n    YAML.load_file(\"config/gateway_supported_trx_types.yml\")['paysec']['supported_trx_types']\n    raise \"\\n\\nMissing configuration for paysec in file config/gateway_supported_trx_types.yaml}\"\n  end\n</code></pre>\n\n<p>Iterate into the file content:</p>\n\n<pre><code>load_paysec_payment_type_with_base_params.each do |factory_name|\n      process_trx([factory_name.to_s], GATEWAY_NAME, base_params_for(factory_name))\n    end\n</code></pre>\n\n<p>But I get exception:</p>\n\n<pre><code>sanity_checks.rb:32:in `execute':  (RuntimeError)\n\nMissing configuration for paysec in file config/gateway_supported_trx_types.yaml}\n</code></pre>\n\n<p>What is the proper way to get the content?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "faker"], "comments": [{"owner": {"reputation": 1227, "user_id": 1973735, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f2662932dbc7a607c5dda0896b45cbe6?s=128&d=identicon&r=PG", "display_name": "Rahul Sharma", "link": "https://stackoverflow.com/users/1973735/rahul-sharma"}, "edited": false, "score": 0, "creation_date": 1537363011, "post_id": 52406022, "comment_id": 91757249, "body": "Doesn&#39;t <code>Faker::Number.within(4..6)</code> fulfil what you&#39;re trying to achieve here?"}, {"owner": {"reputation": 2045, "user_id": 5157706, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w3SrF.jpg?s=128&g=1", "display_name": "Akash Agarwal", "link": "https://stackoverflow.com/users/5157706/akash-agarwal"}, "reply_to_user": {"reputation": 1227, "user_id": 1973735, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f2662932dbc7a607c5dda0896b45cbe6?s=128&d=identicon&r=PG", "display_name": "Rahul Sharma", "link": "https://stackoverflow.com/users/1973735/rahul-sharma"}, "edited": false, "score": 0, "creation_date": 1537363953, "post_id": 52406022, "comment_id": 91757880, "body": "@RahulSharma Hi Rahul. I&#39;ve edited the question. Hopefully, that clears out what I&#39;m trying to convey. The problem is that the set being used for randomness is different on both computers. 1, 2, 3 and 4, 5, 6 were just used as examples."}], "answers": [{"tags": [], "owner": {"reputation": 2045, "user_id": 5157706, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w3SrF.jpg?s=128&g=1", "display_name": "Akash Agarwal", "link": "https://stackoverflow.com/users/5157706/akash-agarwal"}, "is_accepted": true, "score": 0, "last_activity_date": 1537364403, "creation_date": 1537364403, "answer_id": 52407279, "question_id": 52406022, "link": "https://stackoverflow.com/questions/52406022/faker-mutually-deterministic-randomness-across-2-or-more-systems/52407279#52407279", "title": "Faker mutually deterministic randomness across 2 or more systems", "body": "<p>My bad, I didn't run pull the faker related changes on the remote machine. Everything works like a charm!</p>\n"}], "owner": {"reputation": 2045, "user_id": 5157706, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w3SrF.jpg?s=128&g=1", "display_name": "Akash Agarwal", "link": "https://stackoverflow.com/users/5157706/akash-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 52407279, "answer_count": 1, "score": 1, "last_activity_date": 1537364403, "creation_date": 1537360574, "last_edit_date": 1537363880, "question_id": 52406022, "link": "https://stackoverflow.com/questions/52406022/faker-mutually-deterministic-randomness-across-2-or-more-systems", "title": "Faker mutually deterministic randomness across 2 or more systems", "body": "<p>In my rails project, I've set <code>Faker::Config.random = Random.new(77)</code>, following the <a href=\"https://github.com/stympy/faker#deterministic-random\" rel=\"nofollow noreferrer\">guide</a>. While the randomness is the same every time for me on my computer and my peer's individually, the randomness is not mutually the same. </p>\n\n<p>For instance, the randomness generated by <code>Faker::Number.number(1)</code> on my computer is 4, 5, 6; and on my peer's computer is 1, 2, 3. All I'm trying to achieve is 4, 5, 6 on all the machines using the same seed.</p>\n\n<p>How can I achieve this? If it can't be done using that, I'd really appreciate someone suggesting me a workaround.</p>\n\n<p><strong>EDIT</strong>- The problem is not limited to numbers only. The set of strings and other variables being used to generate randomness is different as well, along with any other data type.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 5304, "user_id": 740394, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/796442b522b037319711277a81d775ca?s=128&d=identicon&r=PG", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/740394/rodrigo"}, "edited": false, "score": 0, "creation_date": 1537361403, "post_id": 52405846, "comment_id": 91756203, "body": "Please include in your question the callback for the <code>CoursesUser</code> which creates the CourseModulesUsers"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8331511"}, "reply_to_user": {"reputation": 5304, "user_id": 740394, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/796442b522b037319711277a81d775ca?s=128&d=identicon&r=PG", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/740394/rodrigo"}, "edited": false, "score": 0, "creation_date": 1537361959, "post_id": 52405846, "comment_id": 91756607, "body": "Please see edit #1 @Rodrigo hope this helps"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8331511"}, "edited": false, "score": 0, "creation_date": 1537362364, "post_id": 52406380, "comment_id": 91756871, "body": "That&#39;s spot on, thank you.  Would it be possible for you to example option one further so I can understand it more?"}], "tags": [], "owner": {"reputation": 1227, "user_id": 1973735, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f2662932dbc7a607c5dda0896b45cbe6?s=128&d=identicon&r=PG", "display_name": "Rahul Sharma", "link": "https://stackoverflow.com/users/1973735/rahul-sharma"}, "is_accepted": true, "score": 0, "last_activity_date": 1537361740, "creation_date": 1537361740, "answer_id": 52406380, "question_id": 52405846, "link": "https://stackoverflow.com/questions/52405846/add-multiple-records-to-database-on-product-purchase/52406380#52406380", "title": "Add multiple records to database on product purchase", "body": "<p>There are two ways that I could do this depending on how and when do I want the records for the <code>CourseModelUser</code> to be created:</p>\n\n<ol>\n<li><p>I want the records to be created along with the creation of <code>CourseUser</code> (if <code>CourseUser</code> doesn't get created due to any reason then <code>CourseModuleUser</code> shouldn't get created as well). This code goes along with the <code>CourseUser</code> creation in your payments controller.</p>\n\n<pre><code>ActiveRecord::Base.transaction do\n  CoursesUser.create(\n    course_id: @course.id,\n    user_id: @user.id,\n    complete: false\n  )\n  module_ids = CourseModule.where(course_id: @course.id).pluck(:id)\n  module_ids.each do |module_id|\n  CourseModuleUser.create(\n    course_module_id: module_id,\n    courses_user_id: @user.id,\n    completed: false\n  )\n  end\nend\n</code></pre></li>\n<li><p>I just want the <code>CourseModuleUser</code> to be created after the creation of <code>CourseUser</code> model. This code goes inside the <code>CourseUser</code> model.</p>\n\n<pre><code>after_commit :create_couser_module_user\n\ndef create_module_user\n  module_ids = CourseModule.where(course_id: self.course_id).pluck(:id)\n  module_ids.each do |module_id|\n  CourseModuleUser.create(\n    course_module_id: module_id,\n    courses_user_id: self.id,\n    completed: false\n  )\nend\n</code></pre></li>\n</ol>\n\n<p>Note: The answer assumes you've the following model structure:</p>\n\n<pre><code>class Course\n  ..\n  has_many :course_modules\n  ..\nend\n\nclass CourseModule\n  ..\n  belongs_to :course\n  ..\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8331511"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 52406380, "answer_count": 1, "score": 3, "last_activity_date": 1537361937, "creation_date": 1537359980, "last_edit_date": 1537361937, "question_id": 52405846, "link": "https://stackoverflow.com/questions/52405846/add-multiple-records-to-database-on-product-purchase", "title": "Add multiple records to database on product purchase", "body": "<p><strong>Edit #1</strong></p>\n\n<p>Here is what I am trying in the payments controller to create the CourseModulesUser</p>\n\n<pre><code>CourseModules.count do\n  CourseModulesUser.create.times(\n    course_module_id: @course_module_id,\n    courses_user_id: @courses_user_id,\n    complete: false\n  )\nend\n</code></pre>\n\n<p>I have a course modules but in order to create the users I need to be able to count the modules for the course bought and then create the records in the CourseModulesUser grabbing the course_user_id and also the course_module_id.</p>\n\n<p><img src=\"https://i.gyazo.com/68cf77f2a0dd83413f070c788d27af7e.png\" alt=\"image\"></p>\n\n<p><strong>Orginal Question</strong></p>\n\n<p>Scenario:</p>\n\n<p>I have courses and modules, and when a user purchases the course a user gets created for that course (kind of like an enrollment), however, when the course gets purchased I also want the modules to go into a separate table taking in the course_module_id and the courses_user_id.</p>\n\n<p>However, there are multiple modules per course, </p>\n\n<p>Here is the payments controller</p>\n\n<pre><code>class PaymentsController &lt; ApplicationController\n  before_action :authenticate_user!\n\n  def create\n    token = params[:stripeToken]\n    @course = Course.find(params[:course_id])\n    @user = current_user\n\n    begin\n      charge = Stripe::Charge.create(\n        amount: (@course.price*100).to_i,\n        currency: \"gbp\",\n        source: token,\n        description: params[:stripeEmail],\n        receipt_email: params[:stripeEmail]\n      )\n\n      if charge.paid\n        Order.create(\n          stripe_id: charge.id,\n          course_id: @course.id,\n          user_id: @user.id,\n          total: @course.price,\n          card_last4: charge.source.last4,\n          card_type: charge.source.brand,\n          card_exp_month: charge.source.exp_month,\n          card_exp_year: charge.source.exp_year\n        )\n\n        CoursesUser.create(\n          course_id: @course.id,\n          user_id: @user.id,\n          complete: false\n        )\n\n        flash[:success] = \"Your payment was processed successfully\"\n      end\n\n    rescue Stripe::CardError =&gt; e\n      body = e.json_body\n      err = body[:error]\n      flash[:error] = \"Unfortunately, there was an error processing your payment: #{err[:message]}\"\n    end\n\n    redirect_to course_path(@course)\n  end\nend\n</code></pre>\n\n<p>Here is where I have the course user being created</p>\n\n<pre><code>CoursesUser.create(\n  course_id: @course.id,\n  user_id: @user.id,\n  complete: false\n)\n</code></pre>\n\n<p>and this works</p>\n\n<p><img src=\"https://i.gyazo.com/50719207bf86f1e3f2d96c0fa3c79fb4.png\" alt=\"image\"></p>\n\n<p>But I have a separate table for course_modules_users</p>\n\n<p><img src=\"https://i.gyazo.com/59ad8972027ecf256081d31ad4e64a5c.png\" alt=\"image\"></p>\n\n<p>So let's say for example I have a course with two modules, and a course with the id of 1 and a user with the id of 1 I would ideally have something like this</p>\n\n<pre><code>id  course_module_id   courses_user_id   complete\n1   1                  1                 false\n2   2                  1                 false\n</code></pre>\n\n<p>So when a user purchases the course both modules should have records created in this table.</p>\n\n<p>Here is what I have for the model</p>\n\n<pre><code>class CourseModulesUser &lt; ApplicationRecord\n  belongs_to :course_module\n  belongs_to :courses_user\n\n  after_update :update_courses_user, if: :completed?\n\n  def siblings\n    self.class.where(courses_user_id: self.courses_user_id)\n  end\n\n  def completed!\n    self.update_attributes(complete: true)\n  end\n\n  def completed?\n    siblings.all?(&amp;:complete?)\n  end\n\n  def update_courses_user\n    self.courses_user.completed!\n  end\nend\n</code></pre>\n\n<p>But I assume this is just a simple edit to the PaymentsController.</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "edited": false, "score": 0, "creation_date": 1537358670, "post_id": 52405391, "comment_id": 91754635, "body": "Unfortunately I can&#39;t. Can you show me please solution with the current code?"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "edited": false, "score": 0, "creation_date": 1537358963, "post_id": 52405391, "comment_id": 91754804, "body": "Hmm, i would push very hard on changing the implementation to be like this in your situation.  It has 0 effect on the outside world.  If you absolutely must have load_environment_config, then i&#39;ll propose a way to do that with wrapping the other method in another method call"}], "tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": false, "score": 0, "last_activity_date": 1537359636, "last_edit_date": 1537359636, "creation_date": 1537358393, "answer_id": 52405391, "question_id": 52404649, "link": "https://stackoverflow.com/questions/52404649/stub-file-in-ruby/52405391#52405391", "title": "Stub file in Ruby", "body": "<p>I would change so that the instance variables are set based off a result of that function call and remove all instance_variables from that function as well.</p>\n\n<pre><code>  def load_environment_config(gateway, trx_type)\n    config = YAML.load_file(\"config/#{env}.yml\")[\"#{env.upcase}\"]\n    raise \"\\n\\nMissing gateway configuration for #{gateway} in file config/#{env}.yml!\\n\" unless config[gateway]\n    terminal = terminal_for(config, gateway, trx_type)\n    url = URI.parse(\"#{config['processing_url']}#{terminal['token']}\")\n    [ url, terminal,  config]\n  end\n\n  # Then whereever you call the loader becomes\n  @url, @terminal, @config = load_environment_config(some_gateway, some_trx)\n</code></pre>\n\n<p>With that change, the entire details of the load_environment_config can be stubbed or mocked</p>\n\n<pre><code>  expect(:your_instance).to_receive(:load_environment_config) { [url, terminal, config] }\n</code></pre>\n\n<p>You may want to go further and do to_receive with_arguments if you feel it is important to the spec </p>\n\n<hr>\n\n<p>Solution that does not change the functionality of load_environment_config</p>\n\n<pre><code>your_instance.stub(:load_environment_config)\nyour_instance.instance_variable_set(:@config, some_value)\nyour_instance.instance_variable_set(:@terminal, some_value)\nyour_instance.instance_variable_set(:@url, some_value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1136, "user_id": 5215927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w06Fv.jpg?s=128&g=1", "display_name": "mr_sudaca", "link": "https://stackoverflow.com/users/5215927/mr-sudaca"}, "is_accepted": false, "score": 0, "last_activity_date": 1537375716, "last_edit_date": 1537375716, "creation_date": 1537364713, "answer_id": 52407397, "question_id": 52404649, "link": "https://stackoverflow.com/questions/52404649/stub-file-in-ruby/52407397#52407397", "title": "Stub file in Ruby", "body": "<p>maybe you can use rails methods to get the proper env, like:</p>\n\n<pre><code>file_path = File.join(Rails.root, 'config', \"#{Rails.env}.yml\"\n@config = YAML.load_file(filepath)[\"#{Rails.env.upcase}\"]\n</code></pre>\n\n<p>so, you'll need at least three new files:</p>\n\n<pre><code>{root}/config/test.yml\n{root}/config/development.yml\n{root}/config/production.yml\n</code></pre>\n\n<p>with this you shouldn't need to stub file loading process</p>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 282, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1537375716, "creation_date": 1537355899, "question_id": 52404649, "link": "https://stackoverflow.com/questions/52404649/stub-file-in-ruby", "title": "Stub file in Ruby", "body": "<p>I have this ruby method that I would like to stub in rspec file:</p>\n\n<pre><code>  def load_environment_config(gateway, trx_type)\n    @config = YAML.load_file(\"config/#{env}.yml\")[\"#{env.upcase}\"]\n    raise \"\\n\\nMissing gateway configuration for #{gateway} in file config/#{env}.yml!\\n\" unless @config[gateway]\n    @terminal = terminal_for(@config, gateway, trx_type)\n    @url = URI.parse(\"#{@config['processing_url']}#{@terminal['token']}\")\n  end\n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code>let(:request_builder) { described_class.new(env: nil) } \n  let(:trx_types)       { ['davivienda'] }\n  let(:trx_type)        { 'davivienda' }\n  let(:gateway)         { 'girogate' }\n  let(:currency)        { 'USD' }\n  let(:base_params)     { request_builder.send(:base_params) }\n\n  before(:each) { allow(request_builder).to receive(:currency).and_return(currency) }\n\n  let(:yaml_file) { YAML::load(File.read(File.join('spec', 'fixtures', 'yaml', 'test_env.yml'))) }\n  let(:config)    { yaml_file['TEST_ENV'] }\n  let(:successful_response_file) { File.read(File.join('spec', 'fixtures', 'xml', 'successful_response.xml')) }\n\n  allow(request_builder).to receive(:currency).and_return('EUR') \n  allow(request_builder).to receive(:env).and_return('TEST_ENV') \n  allow(request_builder).to receive(:config).and_return(config) \n  allow(request_builder).to receive(:base_params).and_return(base_params)\n  allow(request_builder).to receive(:gateway).and_return(gateway)  \n  allow(request_builder).to receive(:request_builder)\n</code></pre>\n\n<p>But when I run the rspec code I get this:</p>\n\n<pre><code>Errno::ENOENT:\n       No such file or directory @ rb_sysopen - config/TEST_ENV.yml\n     # ./models/request_builder.rb:50:in `load_environment_config'\n     # ./models/request_builder.rb:45:in `filter_trx_types_list_for'\n     # ./models/request_performer.rb:8:in `process_trx'\n     # ./models/request_builders/girogate_request_builder.rb:81:in `block in submit!'\n     # ./models/request_builders/girogate_request_builder.rb:80:in `each'\n     # ./models/request_builders/girogate_request_builder.rb:80:in `submit!'\n     # ./spec/models/request_builders/girogate_request_builder_spec.rb:42:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>My idea is to stub the variable config and use yaml file located into spec directory. What is the proper way to override <code>@config</code>? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1537357642, "post_id": 52404421, "comment_id": 91754032, "body": "This looks nice to me. However, if I need to show only the platform without the parenthesis, such as <code>Macintosh</code> alone, how do I deal with that?"}], "tags": [], "owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "is_accepted": true, "score": 1, "last_activity_date": 1537355064, "creation_date": 1537355064, "answer_id": 52404421, "question_id": 52403985, "link": "https://stackoverflow.com/questions/52403985/how-to-show-a-specific-information-from-a-string-of-user-agents-string-saved-int/52404421#52404421", "title": "how to show a specific information from a string of User Agents string saved into my database", "body": "<p>How about using the <a href=\"https://github.com/gshutler/useragent\" rel=\"nofollow noreferrer\">user_agent gem</a>? </p>\n\n<p>In the specific example you gave you could use:</p>\n\n<pre><code>user_agent = request.env['HTTP_USER_AGENT']\nuser_agent.match(/\\(.*?\\)/)[0]\n</code></pre>\n\n<p>However that may not cover every case, and either using a <a href=\"https://github.com/gshutler/useragent\" rel=\"nofollow noreferrer\">gem</a> or <a href=\"https://stackoverflow.com/questions/10990224/find-the-operating-system-of-web-apps-client\">code</a> which accounts for the various options is your best bet.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 9247411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Iu7uOwMxffk/AAAAAAAAAAI/AAAAAAAALII/BnhI9ZFqPT8/photo.jpg?sz=128", "display_name": "Tanmay Jain", "link": "https://stackoverflow.com/users/9247411/tanmay-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1537355156, "creation_date": 1537355156, "answer_id": 52404442, "question_id": 52403985, "link": "https://stackoverflow.com/questions/52403985/how-to-show-a-specific-information-from-a-string-of-user-agents-string-saved-int/52404442#52404442", "title": "how to show a specific information from a string of User Agents string saved into my database", "body": "<p>You can use the scan method to get the string you need.\nExample: </p>\n\n<pre><code>user_agent = Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36\n</code></pre>\n\n<p>then,</p>\n\n<pre><code>user_agent.scan(/Mac.*_6/)\n</code></pre>\n\n<p>should give you your desired string. You can modify it as per your requirements.</p>\n"}], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 52404421, "answer_count": 2, "score": 0, "last_activity_date": 1537355602, "creation_date": 1537353662, "last_edit_date": 1537355602, "question_id": 52403985, "link": "https://stackoverflow.com/questions/52403985/how-to-show-a-specific-information-from-a-string-of-user-agents-string-saved-int", "title": "how to show a specific information from a string of User Agents string saved into my database", "body": "<p>I am working with Geolocation and I have a string of User Agent saved into my database as shown below: </p>\n\n<blockquote>\n  <p>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36</p>\n</blockquote>\n\n<p>In this case of the string above, the information I would like to output in my views is <code>Macintosh; Intel Mac OS X 10_13_6</code>. So, in the frontend/views, I <strong>don't</strong> want to output the whole data as its in the database. All I want to pick from this information is just to show the devise the user used to login into the application, and I do not know how I will show only what I want. Any help or pointer to what I should do will be appreciated.</p>\n\n<p><strong>view</strong></p>\n\n<pre><code>.row\n  .panel.panel-primary\n    .panel-heading\n      span = t('admin_header.traffics')\n    .panel-body\n      = table_for(@traffic, class: 'table table-condensed table-hover') do |t|\n        - t.column :ua, 'Device Used', class: 'col-xs-1' # But this shows all the string which I do not want, I only want specific details from it.\n</code></pre>\n\n<p>Here is the code that saves User Agent string into the Database:</p>\n\n<pre><code>  def save_signup_history(member_id)\n    SignupHistory.create(\n      member_id: member_id,\n      email: @member.email,\n      ip: request.remote_ip,\n      accept_language: request.headers[\"Accept-Language\"],\n      ua: request.headers[\"User-Agent\"], #Here is User Agent\n      login_location: get_ip_location\n    )\n  end\n</code></pre>\n\n<p>The only thing I can think of is to use <code>.remove</code> method, but I don't think its a best solution to my problem.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "nomethoderror"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8331511"}, "edited": false, "score": 0, "creation_date": 1537353824, "post_id": 52403852, "comment_id": 91751706, "body": "Oh ok, error on my part I&#39;m updating the attribute, I only want to check whether it&#39;s complete or not, updating the attribute I can use elsewhere but for this page, I only want to check if the course is marked as complete or not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8331511"}, "edited": false, "score": 0, "creation_date": 1537354043, "post_id": 52403852, "comment_id": 91751854, "body": "Yes but in the model it have <a href=\"https://gyazo.com/1778c52fd0d8a66da1d386b1bb2af4ac\" rel=\"nofollow noreferrer\">gyazo.com/1778c52fd0d8a66da1d386b1bb2af4ac</a> <code>self.update_attribute</code> this I can use elsewhere, but I want to check whether it&#39;s marked as true or not as it&#39;s marking all courses as complete now"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537354534, "post_id": 52403852, "comment_id": 91752173, "body": "@B.J.B If you want to check whether a course is complete, then try <code>&lt;% if cu.complete? %&gt;</code>"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 2, "last_activity_date": 1537353841, "last_edit_date": 1537353841, "creation_date": 1537353293, "answer_id": 52403852, "question_id": 52403717, "link": "https://stackoverflow.com/questions/52403717/nomethoderror-in-welcomeshow/52403852#52403852", "title": "NoMethodError in Welcome#show", "body": "<p>You have defined <code>@courses_user = CoursesUser.all</code>, so its a <strong>collection</strong> not a single object. And you <strong>can't call</strong> <code>complete!</code> on a collection, so is the error.</p>\n\n<p><strong>Solution:</strong></p>\n\n<p>Iterate through <code>@courses_user</code> and call <code>complete!</code> on each instance like so</p>\n\n<pre><code>&lt;% @courses_user.each do |cu| %&gt;\n  &lt;% if cu.complete! %&gt;\n    &lt;%= link_to \"Completed\", course, class: \"block text-lg w-full text-center text-white px-4 py-2 bg-green hover:bg-green-dark border-2 border-green-dark leading-none no-underline\" %&gt;\n  &lt;% else %&gt;\n    &lt;%= link_to \"View Modules\", course, class: \"block text-lg w-full text-center text-grey-dark hover:text-darker px-4 py-2 border-2 border-grey leading-none no-underline hover:border-2 hover:border-grey-dark\" %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>To avoid another potential error, you should change <code>complete!</code> to <code>completed!</code> as there is no method as <code>complete!</code> in your <code>CoursesUser</code> model. </p>\n\n<p>So the final code would be</p>\n\n<pre><code>&lt;% @courses_user.each do |cu| %&gt;\n  &lt;% if cu.completed! %&gt;\n    &lt;%= link_to \"Completed\", course, class: \"block text-lg w-full text-center text-white px-4 py-2 bg-green hover:bg-green-dark border-2 border-green-dark leading-none no-underline\" %&gt;\n  &lt;% else %&gt;\n    &lt;%= link_to \"View Modules\", course, class: \"block text-lg w-full text-center text-grey-dark hover:text-darker px-4 py-2 border-2 border-grey leading-none no-underline hover:border-2 hover:border-grey-dark\" %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8331511"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52403852, "answer_count": 1, "score": 1, "last_activity_date": 1537353841, "creation_date": 1537352838, "question_id": 52403717, "link": "https://stackoverflow.com/questions/52403717/nomethoderror-in-welcomeshow", "title": "NoMethodError in Welcome#show", "body": "<p>Here is the error I am getting:</p>\n\n<p><img src=\"https://i.gyazo.com/2d6e07c5934ff188731831f8dfb4d624.png\" alt=\"error\"></p>\n\n<p>Background:</p>\n\n<p>I am trying to display a button based on whether an action is complete or not. Here is my code</p>\n\n<pre><code>&lt;% if @courses_user.complete! %&gt;\n  &lt;%= link_to \"Completed\", course, class: \"block text-lg w-full text-center text-white px-4 py-2 bg-green hover:bg-green-dark border-2 border-green-dark leading-none no-underline\" %&gt;\n&lt;% else %&gt;\n  &lt;%= link_to \"View Modules\", course, class: \"block text-lg w-full text-center text-grey-dark hover:text-darker px-4 py-2 border-2 border-grey leading-none no-underline hover:border-2 hover:border-grey-dark\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In my courses_user model, I have</p>\n\n<pre><code>class CoursesUser &lt; ApplicationRecord\n  belongs_to :course\n  belongs_to :user\n\n  has_many :course_modules_users\n\n  def completed!\n    self.update_attributes(complete: true)\n  end\nend\n</code></pre>\n\n<p>and in the welcomeController I have</p>\n\n<pre><code>class WelcomeController &lt; ApplicationController\n  def show\n    @courses = Course.all.order(created_at: :asc)\n    @courses_user = CoursesUser.all\n  end\nend\n</code></pre>\n\n<p>But I'm getting a NoMethodError, any help is appreciated.</p>\n"}, {"tags": ["ruby", "rubygems", "version", "puppet", "rbenv"], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1537417736, "creation_date": 1537417736, "answer_id": 52417602, "question_id": 52402966, "link": "https://stackoverflow.com/questions/52402966/puppet-how-to-reload-enviroment-when-installing-gem-package-rbenv-version-is/52417602#52417602", "title": "Puppet: How to reload enviroment when installing gem package - rbenv version is not active", "body": "<blockquote>\n  <p>So my question is: Is there a possibility to run the package provider in a new subshell? Or do I have to use another exec running gem install?</p>\n</blockquote>\n\n<p>No. Providers run in the host Ruby instance.  They may launch external commands, including shells, but they themselves are not run that way.</p>\n\n<p>Furthermore, you said,</p>\n\n<blockquote>\n  <p>After logging out and in again, the puppet run is successful, because\n  the environment is successfully loaded again.</p>\n</blockquote>\n\n<p>If it really requires logging out and back in to make the rbenv reconfiguration active (which is unclear), then running the provider in a subshell wouldn't be effective anyway.  Neither would running <code>gem install</code> via an <code>Exec</code>, unless that <code>Exec</code> also expressly activated the desired Ruby environment.</p>\n\n<p>If you are using Puppet to swap out the system's default Ruby, out from under itself, then you need to be prepared for inconsistent behavior.  You may be able to work around it by employing an appropriate <code>Exec</code> to perform the gem installation.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1521595, "user_type": "registered", "profile_image": "https://graph.facebook.com/570914760/picture?type=large", "display_name": "Bryan English", "link": "https://stackoverflow.com/users/1521595/bryan-english"}, "is_accepted": false, "score": 0, "last_activity_date": 1550174500, "creation_date": 1550174500, "answer_id": 54698218, "question_id": 52402966, "link": "https://stackoverflow.com/questions/52402966/puppet-how-to-reload-enviroment-when-installing-gem-package-rbenv-version-is/54698218#54698218", "title": "Puppet: How to reload enviroment when installing gem package - rbenv version is not active", "body": "<p>I had this same problem and wrestled for a solution. I wanted my servers to provision successfully from scratch so running provision twice wasn't going to cut it.</p>\n\n<p>I fixed this by adding a symlink to the shim'ed gem. Puppet looks for the gem provider there. </p>\n\n<p>This worked for me...</p>\n\n<pre><code>  include rbenv\n\n  rbenv::plugin {'rbenv/ruby-build':}\n  -&gt; rbenv::build { '2.5.3':\n    global =&gt; true,\n  }\n  -&gt; file { '/usr/bin/gem':\n    ensure =&gt; link,\n    target =&gt; '/usr/local/rbenv/shims/gem',\n  }\n  -&gt; package {'passenger':\n    ensure   =&gt; '6.0.1',\n    provider =&gt; gem,\n  }\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 2286348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0123e7e7d7cf5f57c1a42a726bc73e15?s=128&d=identicon&r=PG&f=1", "display_name": "schulle877", "link": "https://stackoverflow.com/users/2286348/schulle877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 52417602, "answer_count": 2, "score": 0, "last_activity_date": 1550174500, "creation_date": 1537350496, "question_id": 52402966, "link": "https://stackoverflow.com/questions/52402966/puppet-how-to-reload-enviroment-when-installing-gem-package-rbenv-version-is", "title": "Puppet: How to reload enviroment when installing gem package - rbenv version is not active", "body": "<p>I have a running puppet server and want to do following steps on the puppet agent:</p>\n\n<ul>\n<li>download rbenv from git server to <code>/usr/local/rbenv</code> (success)</li>\n<li>download ruby-build from git server (success)</li>\n<li>create file rbenv.sh in <code>/etc/profile.d</code>, so that on every login then rbenv-environment ist loaded (success)</li>\n<li>install a specific ruby version using an exec-resource with <code>rbenv install</code> (success)</li>\n<li>activate the specific ruby version using an exec-resource with <code>rbenv global</code> (fail for current login)</li>\n<li>install a specific ruby gem (failed because of ruby version dependency)</li>\n</ul>\n\n<p>The problem is, <code>rbenv</code> started from an exec-resource in puppet switches the ruby version in a subshell, and stores that information somewhere. The ruby version for the current shell, where I startet <code>puppet agent --test</code> is not changed. After logging out and in again, the puppet run is successful, because the environment is successfully loaded again.</p>\n\n<p>So my question is: Is there a possibility to run the package provider in a new subshell? Or do I have to use another exec running <code>gem install</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 505, "user_id": 3617167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NQI1F.png?s=128&g=1", "display_name": "LolWalid", "link": "https://stackoverflow.com/users/3617167/lolwalid"}, "edited": false, "score": 0, "creation_date": 1537344468, "post_id": 52400977, "comment_id": 91745971, "body": "What is a relation between <code>Company</code> and <code>DotApplication</code>? Could you add example with some data"}, {"owner": {"reputation": 505, "user_id": 3617167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NQI1F.png?s=128&g=1", "display_name": "LolWalid", "link": "https://stackoverflow.com/users/3617167/lolwalid"}, "edited": false, "score": 0, "creation_date": 1537345295, "post_id": 52400977, "comment_id": 91746442, "body": "How can the <code>tasks.id</code> be <code>nil</code> ? I think you can improve this query a lot!"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "reply_to_user": {"reputation": 505, "user_id": 3617167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NQI1F.png?s=128&g=1", "display_name": "LolWalid", "link": "https://stackoverflow.com/users/3617167/lolwalid"}, "edited": false, "score": 0, "creation_date": 1537348265, "post_id": 52400977, "comment_id": 91748185, "body": "@LolWalid This way he gets <code>dot_applications</code> with no <code>tasks</code>"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1537348422, "post_id": 52400977, "comment_id": 91748297, "body": "<a href=\"https://guides.rubyonrails.org/active_record_querying.html#joining-multiple-associations\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1537349055, "post_id": 52400977, "comment_id": 91748688, "body": "I believe <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-left_joins\" rel=\"nofollow noreferrer\"><i>left_joins</i></a> is available since Rails 5.0. This would clean up your manual SQL query."}, {"owner": {"reputation": 505, "user_id": 3617167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NQI1F.png?s=128&g=1", "display_name": "LolWalid", "link": "https://stackoverflow.com/users/3617167/lolwalid"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1537352555, "post_id": 52400977, "comment_id": 91750906, "body": "@JohanWentholt FYI: If not using rails 5 the <code>includes(:articles).where(articles: {id: 1})</code> will also generate a left_join. But i don&#39;t know if it is something that every body know, I discover it randomly"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 505, "user_id": 3617167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NQI1F.png?s=128&g=1", "display_name": "LolWalid", "link": "https://stackoverflow.com/users/3617167/lolwalid"}, "edited": false, "score": 0, "creation_date": 1537364586, "post_id": 52400977, "comment_id": 91758300, "body": "@LolWalid Didn&#39;t know that, I find it less transparent though. I always thought it generated an inner join instead of an outer join. I mostly use sub-queries for these issues. For example to select all <b>posts with comments</b>: <code>Post.where(id: Comment.select(:post_id))</code> to select all <b>posts without comments</b>: <code>Post.where.not(id: Comment.select(:post_id))</code>"}, {"owner": {"reputation": 505, "user_id": 3617167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NQI1F.png?s=128&g=1", "display_name": "LolWalid", "link": "https://stackoverflow.com/users/3617167/lolwalid"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1537368181, "post_id": 52400977, "comment_id": 91760647, "body": "@JohanWentholt Sure it is more readable but when having large database <code>left joins</code> might be really faster"}], "answers": [{"tags": [], "owner": {"reputation": 505, "user_id": 3617167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NQI1F.png?s=128&g=1", "display_name": "LolWalid", "link": "https://stackoverflow.com/users/3617167/lolwalid"}, "is_accepted": false, "score": 0, "last_activity_date": 1537345242, "creation_date": 1537345242, "answer_id": 52401308, "question_id": 52400977, "link": "https://stackoverflow.com/questions/52400977/how-to-combine-two-joins-where-in-rails/52401308#52401308", "title": "How to combine two joins.where in rails", "body": "<p>You can join on nested associations like this <code>joins(company: :users)</code></p>\n\n<p>In your case this might do the job</p>\n\n<pre><code>DotApplication.joins(company: :user).where(users: { notification_for_active_prospects: true})\n</code></pre>\n\n<p>Or full version</p>\n\n<pre><code> DotApplication.all.joins(:current_stage_event, company: :user).where(current_stage_event: {event: \"prospect\"}).joins('LEFT JOIN tasks on tasks.subject_id = dot_applications.id').where(tasks: {id: nil}).where(users: { notification_for_active_prospects: true})\n</code></pre>\n\n<p>But I really don't recommand you to do this at it is totally unmaintainable</p>\n\n<p>You can read this post of you want to know more about joins <a href=\"https://www.learneroo.com/modules/137/nodes/768\" rel=\"nofollow noreferrer\">https://www.learneroo.com/modules/137/nodes/768</a></p>\n"}, {"tags": [], "owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "is_accepted": false, "score": 0, "last_activity_date": 1537351806, "creation_date": 1537351806, "answer_id": 52403408, "question_id": 52400977, "link": "https://stackoverflow.com/questions/52400977/how-to-combine-two-joins-where-in-rails/52403408#52403408", "title": "How to combine two joins.where in rails", "body": "<pre><code>Company.joins(:dot_applications)\n       .where(dot_appplications: DotApplication.joins(:current_stage_event)\n                                               .where(current_stage_event: {event: \"prospect\"})\n                                               .joins('LEFT JOIN tasks on tasks.subject_id = dot_applications.id')\n                                               .where(tasks: {id: nil}))\n       .joins(:users)\n       .where(users: { notification_for_active_prospects: true})\n</code></pre>\n\n<p>This should find all the companies meeting your requirements for the <code>DotApplication</code> and then query <em>those</em> companies for the <code>User</code> requirements</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10346789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537351806, "creation_date": 1537344106, "last_edit_date": 1537349872, "question_id": 52400977, "link": "https://stackoverflow.com/questions/52400977/how-to-combine-two-joins-where-in-rails", "title": "How to combine two joins.where in rails", "body": "<p>Help to join the query in one large, well, or grammatically, so that for each company there are dot applications in which</p>\n\n<p>Here are 2 separately working query strings.</p>\n\n<pre><code>DotApplication.all.joins(:current_stage_event).where(current_stage_event: {event: \"prospect\"}).joins('LEFT JOIN tasks on tasks.subject_id = dot_applications.id').where(tasks: {id: nil})\n\nCompany.all.joins(:users).where(users: { notification_for_active_prospects: true})\n</code></pre>\n\n<p>What i want:</p>\n\n<pre><code>Company.each do |company|\n  # For each company(with joins,where above), find all dot_applications as in the examples above\nend\n</code></pre>\n\n<hr>\n\n<p>The association between <em>Company</em> and <em>DotApplication</em> looks like this:</p>\n\n<pre><code># app/models/company.rb\nclass Comany &lt; ApplicationRecord\n  has_many :dot_aplications\nend\n</code></pre>\n\n<p></p>\n\n<pre><code># app/models/dot_application.rb\nclass DotApplication &lt; ApplicationRecord\n  belongs_to :company\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "swagger-ui"], "comments": [{"owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1537343191, "post_id": 52400039, "comment_id": 91745305, "body": "Can you add an example of how the actual user JSON supposed to look like?"}, {"owner": {"reputation": 60, "user_id": 9938200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2324108f0ed39128ad1d2467de3cffe?s=128&d=identicon&r=PG&f=1", "display_name": "ditojanelidze", "link": "https://stackoverflow.com/users/9938200/ditojanelidze"}, "reply_to_user": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1537344724, "post_id": 52400039, "comment_id": 91746113, "body": "I uploaded picture"}], "answers": [{"tags": [], "owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "is_accepted": false, "score": 0, "last_activity_date": 1537351398, "creation_date": 1537351398, "answer_id": 52403268, "question_id": 52400039, "link": "https://stackoverflow.com/questions/52400039/how-to-build-model-with-description-in-swagger/52403268#52403268", "title": "How to build model with description in swagger?", "body": "<p>If you want only string <code>first_name</code> for <code>user</code> object, then it should be:</p>\n\n<pre><code>parameter name: :user, in: :body, schema: {\n  type: :object,\n  required: [:first_name],\n  properties: {\n    first_name: { type: :string }      \n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 9938200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2324108f0ed39128ad1d2467de3cffe?s=128&d=identicon&r=PG&f=1", "display_name": "ditojanelidze", "link": "https://stackoverflow.com/users/9938200/ditojanelidze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537351398, "creation_date": 1537340774, "last_edit_date": 1537344700, "question_id": 52400039, "link": "https://stackoverflow.com/questions/52400039/how-to-build-model-with-description-in-swagger", "title": "How to build model with description in swagger?", "body": "<p>I want to build model with description in swagger like in <a href=\"https://i.stack.imgur.com/8CwSK.png\" rel=\"nofollow noreferrer\">image</a> <a href=\"https://i.stack.imgur.com/nDnNQ.png\" rel=\"nofollow noreferrer\">[json]</a> and i have something like <a href=\"https://i.stack.imgur.com/2gv7o.png\" rel=\"nofollow noreferrer\">this</a>. I want to have description title and data inside block. Here is code: </p>\n\n<pre><code>require 'swagger_helper'\ndescribe 'Users API' do\n  path '/register/first_step' do\n    post 'First step of Registration' do\n      tags 'registration'\n      consumes 'application/json', 'application/xml'\n      parameter name: :user, in: :body, schema: {\n          type: :object,\n          properties: {\n              first_name: {   \n              properties: \n              {\n                  type: :string,\n                  id: :integer\n              }    \n                },\n          }, required: [ :first_name ]\n      }\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "devise"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1537342230, "post_id": 52399784, "comment_id": 91744768, "body": "Why is this tagged as <code>ruby-on-rails-3</code> <b>and</b> <code>ruby-on-rails-4</code>? Which version are you actually using? (It doesn&#39;t really make a difference to the answer in this case, but it&#39;s still misleading to tag as a multiple versions.)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537342357, "post_id": 52399784, "comment_id": 91744834, "body": "I&#39;m confused why you want this behaviour. Why would you want the user to be <b>logged out</b> when they click the &quot;forgotten password&quot; link? This is not normal behaviour of websites - for example, notice that you remain logged in when opening this link in a new tab: <a href=\"https://stackoverflow.com/users/account-recovery\">stackoverflow.com/users/account-recovery</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1537342504, "post_id": 52399784, "comment_id": 91744924, "body": "It&#39;s also fundamentally not how browsers work, for a user to be logged in on one tab, and logged out on another tab. (Or similarly, to be simultaneously logged in as two different users, in different tabs). You can achieve this with multiple browsers, or an incognito session, but not with two tabs."}, {"owner": {"reputation": 508, "user_id": 5079711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-kCSuj4yBA38/AAAAAAAAAAI/AAAAAAAACR0/PK1hqIJ97Mk/photo.jpg?sz=128", "display_name": "Anand Jose", "link": "https://stackoverflow.com/users/5079711/anand-jose"}, "edited": false, "score": 1, "creation_date": 1537352950, "post_id": 52399784, "comment_id": 91751172, "body": "it&#39;s not a bug, this the way a browser work, Instead of localhost try with ur IP  eg: 192.169.3.10:3000 to get another session in the same browser."}], "owner": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537340795, "creation_date": 1537339817, "last_edit_date": 1537340795, "question_id": 52399784, "link": "https://stackoverflow.com/questions/52399784/user-clicks-on-forgot-password-links-ends-up-logging-into-application-if-some-ot", "title": "User clicks on forgot password links ends up logging into application if some other user is logged in on same browser", "body": "<p>I am using devise for authentication and using devise's default forgot password flow. When user clicks on forgot password link <code>http://localhost:3000/users/password/edit?reset_password_token=F1XrgcSTYs5nssRZrLqf</code>  then the user logs into application if some other user is already logged into the application on same browser. I understand It happens because devise checks <code>@current_user</code> in session and <code>@current_user</code> is the one who is logged in application on that browser.</p>\n\n<p>How can I change the behaviour, User who clicks on forgot password should not login and should be redirected to reset password page.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 656, "user_id": 1262904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/faff411a9ca427b444717ca9044a8e4f?s=128&d=identicon&r=PG", "display_name": "victorhazbun", "link": "https://stackoverflow.com/users/1262904/victorhazbun"}, "reply_to_user": {"reputation": 253873, "user_id": 9515207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34932d3e923ffad9a4a1423e30b1d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "CertainPerformance", "link": "https://stackoverflow.com/users/9515207/certainperformance"}, "edited": false, "score": 0, "creation_date": 1537339574, "post_id": 52399636, "comment_id": 91743394, "body": "CertainPerformance I tried <code>&#47;@\\w+&#47;</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1537365150, "post_id": 52399636, "comment_id": 91758682, "body": "The <a href=\"https://github.com/twitter/twitter-text\" rel=\"nofollow noreferrer\">twitter-text</a> gem can <a href=\"https://github.com/twitter/twitter-text/tree/master/rb#extraction\" rel=\"nofollow noreferrer\">extract</a> @-mentions."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571896673, "post_id": 52399636, "comment_id": 103392807, "body": "Still waiting for an answer that is deserving of the green checkmark?"}], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 1262904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/faff411a9ca427b444717ca9044a8e4f?s=128&d=identicon&r=PG", "display_name": "victorhazbun", "link": "https://stackoverflow.com/users/1262904/victorhazbun"}, "edited": false, "score": 0, "creation_date": 1537340083, "post_id": 52399728, "comment_id": 91743677, "body": "At the moment this is the best answer which fulfils the requirements. Can you please explain the <code>?&lt;=</code> in the regex? Thank you."}, {"owner": {"reputation": 971, "user_id": 9976846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uxw7E.png?s=128&g=1", "display_name": "Nambi_0915", "link": "https://stackoverflow.com/users/9976846/nambi-0915"}, "reply_to_user": {"reputation": 656, "user_id": 1262904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/faff411a9ca427b444717ca9044a8e4f?s=128&d=identicon&r=PG", "display_name": "victorhazbun", "link": "https://stackoverflow.com/users/1262904/victorhazbun"}, "edited": false, "score": 1, "creation_date": 1537340278, "post_id": 52399728, "comment_id": 91743787, "body": "<code>?&lt;=</code> is the look behind operator. It matches from the character next to it and not itself. <code>\\w+</code> will match the words or digits continuously without any space or anyother special characters"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1537341649, "post_id": 52399728, "comment_id": 91744480, "body": "Best to be precise. <code>(?&lt;=@)</code> is a <i>positive</i> look-behind expression. It means that the string <code>&quot;@&quot;</code> must immediately precede the match that follows, but is not part of the match. <code>\\w+</code> matches a sequence of one or more <i>word characters</i>, namely, letters (uppercase or lowercase), digits or underscores (<code>&quot;_&quot;</code>)."}], "tags": [], "owner": {"reputation": 971, "user_id": 9976846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uxw7E.png?s=128&g=1", "display_name": "Nambi_0915", "link": "https://stackoverflow.com/users/9976846/nambi-0915"}, "is_accepted": false, "score": 3, "last_activity_date": 1537339559, "creation_date": 1537339559, "answer_id": 52399728, "question_id": 52399636, "link": "https://stackoverflow.com/questions/52399636/ruby-regular-expression-to-get-users-names-after-symbol/52399728#52399728", "title": "Ruby regular expression to get users names after @ symbol", "body": "<p>Use look behind</p>\n\n<pre><code>(?&lt;=@)\\w+\n</code></pre>\n\n<p>this will leave @ symbol  <a href=\"https://regex101.com/r/xBpNip/1\" rel=\"nofollow noreferrer\">regex</a></p>\n"}, {"comments": [{"owner": {"reputation": 971, "user_id": 9976846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uxw7E.png?s=128&g=1", "display_name": "Nambi_0915", "link": "https://stackoverflow.com/users/9976846/nambi-0915"}, "edited": false, "score": 0, "creation_date": 1537339727, "post_id": 52399744, "comment_id": 91743484, "body": "It also matches the <code>,</code> at the end in <code>andrea,</code>"}, {"owner": {"reputation": 656, "user_id": 1262904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/faff411a9ca427b444717ca9044a8e4f?s=128&d=identicon&r=PG", "display_name": "victorhazbun", "link": "https://stackoverflow.com/users/1262904/victorhazbun"}, "edited": false, "score": 0, "creation_date": 1537339767, "post_id": 52399744, "comment_id": 91743499, "body": "I believe we don&#39;t want to include the <code>,</code>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 656, "user_id": 1262904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/faff411a9ca427b444717ca9044a8e4f?s=128&d=identicon&r=PG", "display_name": "victorhazbun", "link": "https://stackoverflow.com/users/1262904/victorhazbun"}, "edited": false, "score": 0, "creation_date": 1537339778, "post_id": 52399744, "comment_id": 91743505, "body": "@victorhazbun, but you wrote in the question: <i>everything between @ and space</i>."}, {"owner": {"reputation": 656, "user_id": 1262904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/faff411a9ca427b444717ca9044a8e4f?s=128&d=identicon&r=PG", "display_name": "victorhazbun", "link": "https://stackoverflow.com/users/1262904/victorhazbun"}, "edited": false, "score": 0, "creation_date": 1537339910, "post_id": 52399744, "comment_id": 91743576, "body": "Thanks @spickermann, I just updated the SO question description. Sorry."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 656, "user_id": 1262904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/faff411a9ca427b444717ca9044a8e4f?s=128&d=identicon&r=PG", "display_name": "victorhazbun", "link": "https://stackoverflow.com/users/1262904/victorhazbun"}, "edited": false, "score": 1, "creation_date": 1537339995, "post_id": 52399744, "comment_id": 91743628, "body": "@victorhazbun: Updated my answer to address your updated question."}, {"owner": {"reputation": 656, "user_id": 1262904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/faff411a9ca427b444717ca9044a8e4f?s=128&d=identicon&r=PG", "display_name": "victorhazbun", "link": "https://stackoverflow.com/users/1262904/victorhazbun"}, "edited": false, "score": 0, "creation_date": 1537340154, "post_id": 52399744, "comment_id": 91743718, "body": "@spickermann thanks for pointing out the &quot;look-behind regexp&quot; link."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1537339961, "last_edit_date": 1537339961, "creation_date": 1537339640, "answer_id": 52399744, "question_id": 52399636, "link": "https://stackoverflow.com/questions/52399636/ruby-regular-expression-to-get-users-names-after-symbol/52399744#52399744", "title": "Ruby regular expression to get users names after @ symbol", "body": "<p>I would go with:</p>\n\n<pre><code>message.scan(/(?&lt;=@)\\w+/)\n#=&gt; [\"victor\",\"andrea\",\"ghost\"]\n</code></pre>\n\n<p>You might want to read about <a href=\"https://stackoverflow.com/a/19947764/2483313\">look-behind regexp</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": false, "score": 1, "last_activity_date": 1537340157, "creation_date": 1537340157, "answer_id": 52399876, "question_id": 52399636, "link": "https://stackoverflow.com/questions/52399636/ruby-regular-expression-to-get-users-names-after-symbol/52399876#52399876", "title": "Ruby regular expression to get users names after @ symbol", "body": "<p>You could match the <code>@</code> and then capture one or more times a word character in a <a href=\"https://www.regular-expressions.info/refcapture.html\" rel=\"nofollow noreferrer\">capturing group</a></p>\n\n<p><code>@(\\w+)</code></p>\n\n<pre><code>username_pattern = /@(\\w+)/\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/y7dJnD/1\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 5129887, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/41d94c75c838dde47111f2430741a337?s=128&d=identicon&r=PG&f=1", "display_name": "anjali rai", "link": "https://stackoverflow.com/users/5129887/anjali-rai"}, "is_accepted": false, "score": 0, "last_activity_date": 1537344479, "creation_date": 1537344479, "answer_id": 52401090, "question_id": 52399636, "link": "https://stackoverflow.com/questions/52399636/ruby-regular-expression-to-get-users-names-after-symbol/52401090#52401090", "title": "Ruby regular expression to get users names after @ symbol", "body": "<p>Try this</p>\n\n<pre><code>irb(main):010:0&gt; message.scan(/@(\\w+)/m).flatten\n=&gt; [\"victor\", \"andrea\", \"ghost\"]\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 1262904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/faff411a9ca427b444717ca9044a8e4f?s=128&d=identicon&r=PG", "display_name": "victorhazbun", "link": "https://stackoverflow.com/users/1262904/victorhazbun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1537344479, "creation_date": 1537339213, "last_edit_date": 1537339864, "question_id": 52399636, "link": "https://stackoverflow.com/questions/52399636/ruby-regular-expression-to-get-users-names-after-symbol", "title": "Ruby regular expression to get users names after @ symbol", "body": "<p>How can I get the username without the @ symbol?\nThat's everything between @ and any non-word character.</p>\n\n<pre><code>message = &lt;&lt;-MESSAGE\nFrom @victor with love,\nTo @andrea,\nand CC goes to @ghost\nMESSAGE\n</code></pre>\n\n<p>Using a Ruby regular expression, I tried</p>\n\n<pre><code>username_pattern = /@\\w+/\n</code></pre>\n\n<p>I will like to get the following output</p>\n\n<pre><code>message.scan(username_pattern)\n#=&gt; [\"victor\", \"andrea\", \"ghost\"]\n</code></pre>\n"}, {"tags": ["ruby", "postgresql", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 0, "creation_date": 1537391680, "post_id": 52399334, "comment_id": 91772309, "body": "<code>based on last record of budget detail&#39;s balance attribute</code>  This phrase is confusing. An attribute can&#39;t have the last record. Only a table can have the last record having multiple attributes. Please, clarify the question"}, {"owner": {"reputation": 422, "user_id": 6569232, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3cdb78fe78ba0298886abe8931f602ee?s=128&d=identicon&r=PG&f=1", "display_name": "darshi kothari", "link": "https://stackoverflow.com/users/6569232/darshi-kothari"}, "reply_to_user": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 0, "creation_date": 1537422404, "post_id": 52399334, "comment_id": 91779820, "body": "I have more clarified post"}, {"owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 0, "creation_date": 1537434466, "post_id": 52399334, "comment_id": 91785852, "body": "If you need to apply sorting based on the last associated <code>budget_details</code> record, then the <code>budget_details.created_at</code> column should be somehow involved in the query to find the last created record. Don&#39;t you think so?"}], "answers": [{"comments": [{"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 6, "creation_date": 1537345717, "post_id": 52400475, "comment_id": 91746675, "body": "While this might answer the authors question, it lacks some explaining words and links to documentation. Raw code snippets are not very helpful without some phrases around it. You may also find <a href=\"https://stackoverflow.com/help/how-to-answer\">how to write a good answer</a> very helpful. Please edit your answer."}], "tags": [], "owner": {"reputation": 422, "user_id": 6569232, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3cdb78fe78ba0298886abe8931f602ee?s=128&d=identicon&r=PG&f=1", "display_name": "darshi kothari", "link": "https://stackoverflow.com/users/6569232/darshi-kothari"}, "is_accepted": false, "score": 0, "last_activity_date": 1537342272, "creation_date": 1537342272, "answer_id": 52400475, "question_id": 52399334, "link": "https://stackoverflow.com/questions/52399334/distinct-does-not-work-with-select-clause/52400475#52400475", "title": "Distinct does not work with select clause", "body": "<pre><code>DepartmentBudget.includes(:budget_details).order(\"budget_details.balance ASC\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1537392489, "creation_date": 1537392489, "answer_id": 52414430, "question_id": 52399334, "link": "https://stackoverflow.com/questions/52399334/distinct-does-not-work-with-select-clause/52414430#52414430", "title": "Distinct does not work with select clause", "body": "<p>It's not clear what your purpose is, but if we assume that your SQL is logically correct then you should use <code>GROP BY</code> clause and an aggregate function to achieve your purpose. </p>\n\n<pre><code>DepartmentBudget.joins(:budget_details)\n                .select('department_budgets.*, MIN(budget_details.balance)')\n                .group('department_budgets.id')\n                .order(\"MIN(budget_details.balance) ASC\")\n</code></pre>\n"}], "owner": {"reputation": 422, "user_id": 6569232, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3cdb78fe78ba0298886abe8931f602ee?s=128&d=identicon&r=PG&f=1", "display_name": "darshi kothari", "link": "https://stackoverflow.com/users/6569232/darshi-kothari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1537422356, "creation_date": 1537337916, "last_edit_date": 1537422356, "question_id": 52399334, "link": "https://stackoverflow.com/questions/52399334/distinct-does-not-work-with-select-clause", "title": "Distinct does not work with select clause", "body": "<p>I have 2 tables</p>\n\n<pre><code>class DepartmentBudget &lt; ApplicationRecord\n  has_many :budget_details, dependent: :destroy\nend\n\nclass BudgetDetail &lt; ApplicationRecord\n  belongs_to :department_budget\nend\n</code></pre>\n\n<p>Each department have budgets for specific period of time. and each department have many budget_details which consist of all credit and debit entries and maintains remaining balance.</p>\n\n<p>Issue is I want to apply sorting on department budget based on balance of latest budget detail.</p>\n\n<pre><code>DepartmentBudget\n  .joins(:budget_details)\n  .select('budget_details.balance, department_budgets.*')\n  .order(\"budget_details.balance ASC\")\n  .distinct\n</code></pre>\n\n<p>I have implemented above query but it's returning <strong>duplicate records</strong>. the issue is with <strong>select</strong> clause if I remove select then distinct works, but I have to use select with distinct.Any help will be appreciated.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 253873, "user_id": 9515207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34932d3e923ffad9a4a1423e30b1d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "CertainPerformance", "link": "https://stackoverflow.com/users/9515207/certainperformance"}, "edited": false, "score": 1, "creation_date": 1537337496, "post_id": 52399217, "comment_id": 91742401, "body": "Maybe you <i>could</i>, but given the <code>value</code>s in the question, it would probably be better to alternate only inside that non-capturing group there? (keep the regex DRY) End up with <code>(?:alpha|fox|foo|bar|.....|baz|delta)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 419, "user_id": 10242281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff314354a9784604814f64f822c1589e?s=128&d=identicon&r=PG&f=1", "display_name": "Mich28 ", "link": "https://stackoverflow.com/users/10242281/mich28"}, "edited": false, "score": 0, "creation_date": 1537594652, "post_id": 52400680, "comment_id": 91850559, "body": "Tx much CerPerf and Mr. Lord for your hints. I have real 2000 totally different vars I need to search for, they just prefixed by common &lt;dbname&gt;. Never though about <code>combining in non-capture groups</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 419, "user_id": 10242281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff314354a9784604814f64f822c1589e?s=128&d=identicon&r=PG&f=1", "display_name": "Mich28 ", "link": "https://stackoverflow.com/users/10242281/mich28"}, "edited": false, "score": 0, "creation_date": 1537600578, "post_id": 52400680, "comment_id": 91851504, "body": "You might have 2000 <i>values</i>, but there&#39;s no need to declare 2000 <i>variables</i> :)"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1537343014, "creation_date": 1537343014, "answer_id": 52400680, "question_id": 52399217, "link": "https://stackoverflow.com/questions/52399217/ruby-regex-union-2k-values-in-one-regex/52400680#52400680", "title": "Ruby regex: union 2K values in one regex,", "body": "<p>Declaring 2000 variables is highly unnecessary; you should define all values in a single array, then somehow loop through them.</p>\n\n<p>Also, the regular expression is highly repetitive - e.g. the use of <code>(?:dbName\\.[a-z]*\\.)</code> 2000 times. This can be simplified by grouping all of your values within the non-capture group as follows:</p>\n\n<pre><code>values = %w(alpha fox delta)\nregex = /(?&lt;=^|\\s)(?:dbName\\.[a-z]*\\.)?(?:#{Regexp.union(values)})(?=\\s|$)/\n</code></pre>\n\n<p>This is the result:</p>\n\n<pre><code>/(?&lt;=^|\\s)(?:dbName\\.[a-z]*\\.)?(?:(?-mix:alpha|fox|delta))(?=\\s|$)/\n</code></pre>\n\n<p>If you extend that <code>values</code> array to contain 2000 strings, the other code does not need to change.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1571901329, "creation_date": 1571901329, "answer_id": 58536074, "question_id": 52399217, "link": "https://stackoverflow.com/questions/52399217/ruby-regex-union-2k-values-in-one-regex/58536074#58536074", "title": "Ruby regex: union 2K values in one regex,", "body": "<p>Provided two conditions are met, I would do it as follows, which I think would be far more efficient than using a gigantic regular expression, which, by its nature, requires that a linear search of the \"bad words\" be performed for each word in the string, until a match is found or it is determined that there are no matches.</p>\n\n<p>We are given a file whose path is contained in a variable <code>fname</code> and an array of bad words:</p>\n\n<pre><code>arr = [\"alpha\", \"fox\", \"delta\", \"charlie\", \"mabel\"]\n</code></pre>\n\n<p>The first condition that I spoke of above is that, by way of example, <code>\"ALPHA\"</code> and <code>\"Alpha\"</code> match <code>\"alpha\"</code>, but <code>\"aLPha\"</code> does not (or some variant of that).</p>\n\n<p>The second condition is that there is a regular expression with a capture group that would capture a bad word if a bad word were present at the given location in a match. For example:</p>\n\n<pre><code>regex = (?&lt;=^|\\s)(?:dbName\\.[a-z]*\\.)?(\\p{Alpha}+)(?=\\s|$) \n</code></pre>\n\n<p>Wherever there is a match, the capture group <code>(\\p{Alpha}+)</code> would capture a string of one or more alphanumeric characters whose value is assigned to the global variable <code>$1</code>. We will then check to see if the value of <code>$1</code> is a bad word. (The regular expression might have other capture groups as well, in which case we might be looking for <code>$2</code> or <code>$3</code>, say, or a named capture group.)  </p>\n\n<p>If there were more than one such regular expression to check for, the code below could be executed for each of them until a match is found or it is determined that there are no more matches.</p>\n\n<p>The first step is to convert the array of bad words to a set:</p>\n\n<pre><code>require 'set'\n\nbad_words = arr.flat_map { |w| [w, w.capitalize, w.upcase] }.to_set\n  #=&gt; #&lt;Set: {\"alpha\", \"Alpha\", \"ALPHA\", \"fox\", \"Fox\", \"FOX\",\n  #           \"delta\", \"Delta\", \"DELTA\", \"charlie\", \"Charlie\", \"CHARLIE\",\n  #           \"mabel\", \"Mabel\", \"MABEL\"}&gt;\n</code></pre>\n\n<p>This allows very fast word lookups--much faster than stepping through an array. We may then search the file as follows.</p>\n\n<pre><code>rv = IO.foreach(fname).any? do |line|\n  line.gsub(regex).any? { bad_words.include?($1) }\nend\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.6.3/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\">IO::foreach</a> without a block is seen to return an enumerator. We can then chain that to <code>any?</code> to determine if there is a line that contains a match of the regular expression and the value of its capture group is contained in the set <code>bad_words</code>. If such a line is found the search terminates and <code>true</code> is returned; else, <code>false</code> is returned. </p>\n\n<p>It is seen that <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-gsub\" rel=\"nofollow noreferrer\">String#gsub</a> without a block returns an enumerator, which here I've chained to <code>any?</code>. This form of <code>gsub</code> has nothing to do with string replacements; it just generates matches. Those matches are passed to the block, but we are only interested in the contents of the capture group, which are held by <code>$1</code>. Hence the expression <code>bad_words.include?($1)</code>.</p>\n"}], "owner": {"reputation": 419, "user_id": 10242281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff314354a9784604814f64f822c1589e?s=128&d=identicon&r=PG&f=1", "display_name": "Mich28 ", "link": "https://stackoverflow.com/users/10242281/mich28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 52400680, "answer_count": 2, "score": 0, "last_activity_date": 1571901329, "creation_date": 1537337333, "question_id": 52399217, "link": "https://stackoverflow.com/questions/52399217/ruby-regex-union-2k-values-in-one-regex", "title": "Ruby regex: union 2K values in one regex,", "body": "<p>I code a process to process bunch of text files and capture its name if any of 2000 literals exists in it (1 or many).  So I'm thinking to combine that many values into one regex, do you think it's doable, I did test for 100 and looks like it's OK.  Tx all \nCode below depics my flow and sample code, just without looping.</p>\n\n<pre><code># 1. read regex value list as file [alpha,fox, delta]  # 2000 values\n# 2. read file into s                 #5000 files\n# 3. find if any of #1 values exists in each #2 file. *with regex tweaks to match format  dbname.dob.table\n\ns = '1 dbName.dbo.ALPHA  2 DBNAME.bcd.ALPHA  3 dbName..ALPHA   4 ALPHA 5x dbName.alphA  6x  alpha.XX  7x ###dbName.###a.alpha  --alpha\n       dbName..FOX  dbName.dbo.DELTA    clarity.aba..fox  '\n\nvalue1 = '(?&lt;=^|\\s)(?:dbName\\.[a-z]*\\.)?(?:alpha)(?=\\s|$)'\nvalue2 = '(?&lt;=^|\\s)(?:dbName\\.[a-z]*\\.)?(?:fox)(?=\\s|$)'\n##...\nvalue2000 = '(?&lt;=^|\\s)(?:dbName\\.[a-z]*\\.)?(?:delta)(?=\\s|$)'\n\nregex = /#{value1}|#{value2}|#{value2000}/i           ## can I union 2000 regex's ???\nputs 'reg1: ' + regex.to_s\nputs 'result: ' + s.scan(regex).to_s\nif s.scan(regex)  then  puts '...Match!!!d' end\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1537333378, "post_id": 52397635, "comment_id": 91740871, "body": "May be <a href=\"https://regex101.com/r/nn6lfn/2\" rel=\"nofollow noreferrer\">another alternative</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537341013, "post_id": 52397635, "comment_id": 91744151, "body": "You may wish to sharpen your statement of the question. My understanding is that you wish to obtain a substring of <code>text</code> that begins at the beginning of <code>text</code>, ends with a punctuation character and contains as few words as possible, but not less than 15 words. Also, the title should be changed to remove the reference to <code>&quot;280&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1537330250, "post_id": 52397682, "comment_id": 91740023, "body": "Thank you. Works very well. What if I wanted to add any sentence ending punctuation such as ? and ! Would it be ?:\\w+\\.\\?\\!?\\s+){15}(?:\\w+\\s?)*?\\.\\!\\?"}, {"owner": {"reputation": 253873, "user_id": 9515207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34932d3e923ffad9a4a1423e30b1d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "CertainPerformance", "link": "https://stackoverflow.com/users/9515207/certainperformance"}, "reply_to_user": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1537330324, "post_id": 52397682, "comment_id": 91740040, "body": "Use a character set instead of the <code>\\.</code> (which only matches a literal period)"}, {"owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1537330411, "post_id": 52397682, "comment_id": 91740056, "body": "(?:\\w+[\\.!?]?\\s+){15}(?:\\w+\\s?)*?[\\.!?] seems to work."}, {"owner": {"reputation": 253873, "user_id": 9515207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34932d3e923ffad9a4a1423e30b1d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "CertainPerformance", "link": "https://stackoverflow.com/users/9515207/certainperformance"}, "reply_to_user": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1537330576, "post_id": 52397682, "comment_id": 91740092, "body": "Looks good, though you don&#39;t need to escape periods inside a character set - there, they match the literal period by default."}, {"owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1537330825, "post_id": 52397682, "comment_id": 91740158, "body": "I think I need some adjustments. When I use a large text, it seems to select groups of 15 text, some of which is within the body of the text and not at the start. I just want to have the first match of 15 words starting from the beginning of the text."}, {"owner": {"reputation": 253873, "user_id": 9515207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34932d3e923ffad9a4a1423e30b1d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "CertainPerformance", "link": "https://stackoverflow.com/users/9515207/certainperformance"}, "reply_to_user": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1537330894, "post_id": 52397682, "comment_id": 91740179, "body": "Make sure not to use the global flag - that will return <i>all</i> matches, rather than just the first match. (like in the regex101 - see how there&#39;s no <code>&#47;g</code>)"}, {"owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1537331069, "post_id": 52397682, "comment_id": 91740239, "body": "Try the one in <a href=\"https://regex101.com/r/ardIQ7/1\" rel=\"nofollow noreferrer\">regex101.com/r/ardIQ7/1</a> with a large amount of text. It selects 15 words in the middle of the text. Any ideas? I really appreciate your help"}, {"owner": {"reputation": 253873, "user_id": 9515207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34932d3e923ffad9a4a1423e30b1d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "CertainPerformance", "link": "https://stackoverflow.com/users/9515207/certainperformance"}, "reply_to_user": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1537331596, "post_id": 52397682, "comment_id": 91740379, "body": "I can&#39;t reproduce the problem given the text input. It <i>should</i> match as soon as it can - it&#39;ll only backtrack and move on to the next position if the starting position fails, which I don&#39;t <i>think</i> should happen with a paragraph-like string with words, spaces, and <code>[.!?]</code>. If there are commas, you can probably manage them with <code>(?:\\w+[,.?!]?\\s+){15}(?:\\w+,?\\s+)*?\\w+\\.</code>. If that&#39;s not it, can you post a link to a regex101 that reproduces the issue?"}, {"owner": {"reputation": 253873, "user_id": 9515207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34932d3e923ffad9a4a1423e30b1d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "CertainPerformance", "link": "https://stackoverflow.com/users/9515207/certainperformance"}, "reply_to_user": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1537332358, "post_id": 52397682, "comment_id": 91740591, "body": "Yep, there are commas there. Include a comma in the first character set, and include an optional comma before the space when you&#39;re repeating words <i>after</i> the 15th word - see edit"}], "tags": [], "owner": {"reputation": 253873, "user_id": 9515207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34932d3e923ffad9a4a1423e30b1d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "CertainPerformance", "link": "https://stackoverflow.com/users/9515207/certainperformance"}, "is_accepted": true, "score": 1, "last_activity_date": 1537473164, "last_edit_date": 1537473164, "creation_date": 1537328544, "answer_id": 52397682, "question_id": 52397635, "link": "https://stackoverflow.com/questions/52397635/how-to-select-first-280-words-of-text-up-to-the-closest-period/52397682#52397682", "title": "How to select first 280 words of text up to the closest period?", "body": "<p>You can use</p>\n\n<pre><code>(?:\\w+[,.?!]?\\s+){14}(?:\\w+,?\\s+)*?\\w+[.?!]\n</code></pre>\n\n<p>Repeats a word, optional [comma/period/question mark/exclamation mark], and spaces, 14 times. Then, it lazy-repeats a word followed by a space, followed by another word and a period, ensuring that the pattern ends at the first period after 15 words from the start.</p>\n\n<p><a href=\"https://regex101.com/r/ardIQ7/4\" rel=\"nofollow noreferrer\">https://regex101.com/r/ardIQ7/4</a></p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1537338127, "creation_date": 1537338127, "answer_id": 52399388, "question_id": 52397635, "link": "https://stackoverflow.com/questions/52397635/how-to-select-first-280-words-of-text-up-to-the-closest-period/52399388#52399388", "title": "How to select first 280 words of text up to the closest period?", "body": "<pre><code>r = /\n    (?:           # begin a non-capture group\n      \\p{Alpha}+  # match one or more letters\n      [.!?]?      # optionally ('?' following ']') match one of the 3 punctuation chars\n      [ ]+        # match one or more spaces\n    )             # end non-capture group\n    {14,}?        # execute the preceding non-capture group at least 14 times, lazily ('?')\n    \\p{Alpha}+    # match one or more letters  \n    [.!?]         # match one of the three punctuation characters\n    /x            # free-spacing regex definition mode\n\ntext[r]\n  #=&gt; \"There was a very big cat that was sitting on the ledge. It was overlooking \n  #    the garden.\n</code></pre>\n\n<p>Free-spacing mode strips out spaces, which is why the space character above is in a character class (<code>[ ]+</code>). Written conventionally, the regex is as follows.</p>\n\n<pre><code>/(?:\\p{Alpha}+[.!?]? +){14,}?\\p{Alpha}+[.!?]/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79972, "user_id": 298607, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DVW9g.jpg?s=128&g=1", "display_name": "dawg", "link": "https://stackoverflow.com/users/298607/dawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1537378394, "last_edit_date": 1537378394, "creation_date": 1537377973, "answer_id": 52411273, "question_id": 52397635, "link": "https://stackoverflow.com/questions/52397635/how-to-select-first-280-words-of-text-up-to-the-closest-period/52411273#52411273", "title": "How to select first 280 words of text up to the closest period?", "body": "<p>You can do something along these lines:</p>\n\n<pre><code>text = \"There was a very big cat that was sitting on the ledge. It was  overlooking the garden. The dog next door watched with curiosity.\"\n\ntgt=15\nold_text=text.scan(/[^.]+\\.\\s?/)\nnew_text=[]\nwhile (old_text &amp;&amp; new_text.join.scan(/\\b\\p{Alpha}+\\b/).length&lt;=tgt) do\n   new_text &lt;&lt; old_text.shift\nend   \n\np new_text.join\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>\"There was a very big cat that was sitting on the ledge. It was  overlooking the garden. \"\n</code></pre>\n\n<p>That works with any length of normal sentences and will break as soon as 1 additional sentence exceeds the word target.</p>\n"}], "owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52397682, "answer_count": 3, "score": 2, "last_activity_date": 1537473164, "creation_date": 1537328133, "question_id": 52397635, "link": "https://stackoverflow.com/questions/52397635/how-to-select-first-280-words-of-text-up-to-the-closest-period", "title": "How to select first 280 words of text up to the closest period?", "body": "<p>I need to extract a shorter segment of text of a specified number of words from a longer one. I can do this using </p>\n\n<pre><code>text = \"There was a very big cat that was sitting on the ledge. It was  overlooking the garden. The dog next door watched with curiosity.\"\n\n    text.split[0..15].join(' ')\n    &gt;&gt;\"\"There was a very big cat that was sitting on the ledge. It was  overlooking\"\n</code></pre>\n\n<p>I would like to select the text up to the next period so I don't end up with a partial sentence.</p>\n\n<p>Is there a way possibly using a Regex to accomplish what I'm trying to do that will be able to get the text  up to and including the closest next period after the 15th word?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537331458, "post_id": 52396314, "comment_id": 91740343, "body": "Can you update the question with <code>_new_booking_extra_product.html.erb code</code>?"}, {"owner": {"reputation": 654, "user_id": 1319545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d925d70e121e9b8e1a7dd44155e2497?s=128&d=identicon&r=PG", "display_name": "thaleshcv", "link": "https://stackoverflow.com/users/1319545/thaleshcv"}, "edited": false, "score": 0, "creation_date": 1537364135, "post_id": 52396314, "comment_id": 91758006, "body": "It&#39;s undefined cause you are doing an ajax request from the client side. The &#39;f&#39; object exists only on server side during the first request."}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 4056267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1jA0.jpg?s=128&g=1", "display_name": "Dana Scheider", "link": "https://stackoverflow.com/users/4056267/dana-scheider"}, "is_accepted": false, "score": 0, "last_activity_date": 1537491580, "creation_date": 1537491580, "answer_id": 52435212, "question_id": 52396314, "link": "https://stackoverflow.com/questions/52396314/load-form-object-on-fetching-from-ajax/52435212#52435212", "title": "Load form object on fetching from ajax", "body": "<p>You'll want to render a partial view with the associated products server-side when the Ajax request is received. Then you can send the HTML from that partial as part of your response and use the Ajax <code>success</code> callback to attach the partial view to the DOM however you want it. Then you can have (in your controller) code something like this:</p>\n\n<pre><code>def fetch_extra_product\n\n  # Unless you're using @car_id in a view or something, I'd just\n  # just use a local variable instead of an instance variable\n  #\n  car_id = params[:car_id] || Car.all.order('id desc').first.id\n  @extra_products = Car.find(car_id).extra_products\n\n  respond_to do |format|\n    format.js { render partial: 'extra_products_div', status: :ok }\n  end\n</code></pre>\n\n<p>Then your partial code is something like this:</p>\n\n<pre><code>&lt;div class=\"extra-products\"&gt;\n  &lt;% @extra_products.each do |product| %&gt;\n    &lt;h2&gt;&lt;%= product.name %&gt;&lt;/h2&gt;\n    ...\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>That way, your JavaScript can then go along the lines of:</p>\n\n<pre><code>$.ajax(url, {\n  type: 'GET',\n  success: function(msg) {\n    $('#foo').attach(msg);\n  },\n  error: function(msg) {\n    console.log('Error!!!');\n  }\n});\n</code></pre>\n\n<p>One other comment: If your API is only going to get a request to this route via Ajax, you don't need the <code>respond_to</code> block. In that case you can just put the <code>render partial: 'extra_products_div', status: :ok</code> under the line where you\ndefine <code>@extra_products</code>.</p>\n"}], "owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537491580, "creation_date": 1537317107, "question_id": 52396314, "link": "https://stackoverflow.com/questions/52396314/load-form-object-on-fetching-from-ajax", "title": "Load form object on fetching from ajax", "body": "<p>I have a form that renders partial 'form'.</p>\n\n<pre><code>= form_for(@booking, :as =&gt; :booking, :url =&gt; admin_bookings_path, :html =&gt; { :multipart =&gt; true }) do |f|\n  = render partial: \"form\", locals: { f: f }\n</code></pre>\n\n<p>Inside the partial form again another partial is rendered based on new_record?.</p>\n\n<pre><code>- if f.object.new_record?\n  #extra-products\n    = render partial: 'new_booking_extra_product', locals: { f: f }\n- else\n  = render partial: 'extra_product', locals: { f: f }\n</code></pre>\n\n<p>In bookings#new, when the user selects particular car_id, I want to show associated products with it through ajax. For that I have used ajax to make a request to bookings#fetch_extra_product.</p>\n\n<pre><code># Ajax request to fetch product\n$('#booking_car_id').on('change', function(e){\n    var selectedCarId = $(\"#booking_car_id option:selected\").val();\n    var url = \"/admin/bookings/\" + selectedCarId + \"/fetch_extra_product\";\n\n    $.ajax(url,{\n      type: 'GET',\n      success: function(msg){\n      },\n      error: function(msg) {\n        console.log(\"Error!!!\");\n      }\n    });\n  });\n\n# Bookings#fetch_extra_product\ndef fetch_extra_product\n    @car_id = params[:car_id] || Car.all.order('id desc').first.id\n    @extra_product = Car.find(@car_id).extra_products\n\n    respond_to do |format|\n      format.js\n    end\nend\n</code></pre>\n\n<p>The fetch_extra_product.js.erb looks as follow:</p>\n\n<pre><code>$('#extra-products').html('$(\"&lt;%= j render(:partial =&gt; 'new_booking_extra_product', :locals =&gt; {:f =&gt; f}) %&gt;\")');\n</code></pre>\n\n<p>But the form object (f) is undefined on this state. What's the best way to fetch the object or the best way to get through this problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 6942847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lntXq.jpg?s=128&g=1", "display_name": "mxvx", "link": "https://stackoverflow.com/users/6942847/mxvx"}, "edited": false, "score": 0, "creation_date": 1537318293, "post_id": 52395746, "comment_id": 91737646, "body": "Thanks. It worked with &quot;render parital:&quot; instead of &quot;render_partial&quot;."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 323, "user_id": 6942847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lntXq.jpg?s=128&g=1", "display_name": "mxvx", "link": "https://stackoverflow.com/users/6942847/mxvx"}, "edited": false, "score": 0, "creation_date": 1537318414, "post_id": 52395746, "comment_id": 91737670, "body": "Oh, right. Sorry. <code>render_partial</code> is a custom method I use in my apps. Sorry about that."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1537318442, "last_edit_date": 1537318442, "creation_date": 1537312133, "answer_id": 52395746, "question_id": 52395567, "link": "https://stackoverflow.com/questions/52395567/ruby-rails-most-efficient-way-of-dividing-an-array-into-two-groups-based-on-a/52395746#52395746", "title": "Ruby / Rails- Most efficient way of dividing an array into two groups based on a parameter and displaying both", "body": "<p>All that html appears to be identical for each type of <code>event</code>. </p>\n\n<p>So, do something like: </p>\n\n<pre><code>&lt;% @accepted = @coin_events.select { |event| event.accepted == true } %&gt;\n&lt;% @pending = @coin_events.select { |event| event.accepted == false } %&gt;\n\n&lt;% @accepted.each do |event| %&gt;\n  render partial: 'event', locals: {event: event}\n&lt;% end %&gt;\n\n&lt;!-- OTHER STUFF HERE --&gt; \n\n&lt;% @pending.each do |event| %&gt;\n  render partial: 'event', locals: {event: event}\n&lt;% end %&gt;\n</code></pre>\n\n<p>And then put all your html into the <code>_event</code> partial. (Note: Untested, you may need to fiddle with it.)</p>\n\n<p>Also, please don't put:</p>\n\n<pre><code>&lt;% @accepted = @coin_events.select { |event| event.accepted == true } %&gt;\n&lt;% @pending = @coin_events.select { |event| event.accepted == false } %&gt;\n</code></pre>\n\n<p>In your view. That should be in your controller. </p>\n\n<p>And, in your controller, it seems like you should be able to do: </p>\n\n<pre><code>@accepted = @coin_events.where(accepted: true)\n@pending = @coin_events.where(accepted: false)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "edited": false, "score": 2, "creation_date": 1537355557, "post_id": 52399147, "comment_id": 91752697, "body": "This is the better answer as it will iterate over the data only once."}, {"owner": {"reputation": 323, "user_id": 6942847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lntXq.jpg?s=128&g=1", "display_name": "mxvx", "link": "https://stackoverflow.com/users/6942847/mxvx"}, "edited": false, "score": 0, "creation_date": 1537392901, "post_id": 52399147, "comment_id": 91772728, "body": "Thank you this is exactly what I was looking for!"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1537541465, "post_id": 52399147, "comment_id": 91835301, "body": "Learn something new every day hanging around you lot!"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "edited": false, "score": 0, "creation_date": 1537541912, "post_id": 52399147, "comment_id": 91835581, "body": "@TomDunning - (1) What do you mean &#39;iterate over the data only once&#39;? (2) Each answer is deficient (or &#39;good&#39;, depending on how you look at it) in complementary manners. The OP in fact poses two questions (most efficient way of #1 &#39;dividing an array&#39; and #2 &#39;displaying both&#39;). One answer removes ~20 lines of redundant code. The other removes one line of code and a query. Given they are complementary, how does one assess either as &#39;better&#39;?"}, {"owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1537565982, "post_id": 52399147, "comment_id": 91846031, "body": "@jvillian it&#39;s not a query as it&#39;s not calling a db, it&#39;s iterating through an enumerable. If you improve your answer by using <code>@accepted, @pending = @coin_events.partition(&amp;:accepted)</code> then I&#39;ll happily change my vote. However if Event is database driven then we&#39;d be better advising the use of a query."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 3, "last_activity_date": 1537596246, "last_edit_date": 1592644375, "creation_date": 1537337021, "answer_id": 52399147, "question_id": 52395567, "link": "https://stackoverflow.com/questions/52395567/ruby-rails-most-efficient-way-of-dividing-an-array-into-two-groups-based-on-a/52399147#52399147", "title": "Ruby / Rails- Most efficient way of dividing an array into two groups based on a parameter and displaying both", "body": "<p>There is the <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-partition\" rel=\"nofollow noreferrer\"><code>partition</code></a> method in Ruby that does exactly what you need.</p>\n<blockquote>\n<p><code>partition { |obj| block } \u2192 [ true_array, false_array ]</code></p>\n<p>Returns two arrays, the first containing the elements of enum for which the block evaluates to true, the second containing the rest.</p>\n</blockquote>\n<p>In your example <code>partition</code> can be used like this:</p>\n<pre><code>@accepted, @pending = @coin_events.partition(&amp;:accepted)\n</code></pre>\n<p>Furtheremore, it looks like both HTML blocks are identical. Then seems like a good oppurtunity to create a partial from one of theses blocks:</p>\n<pre><code># the new partial `_event.html.erb`\n&lt;ul&gt;&lt;b&gt;Event: &lt;/b&gt;&lt;%= event.content %&gt;&lt;/ul&gt;\n&lt;ul&gt;&lt;b&gt;Category: &lt;/b&gt;&lt;%= event.coin.currency_name %&gt;&lt;/ul&gt;\n&lt;ul&gt;&lt;b&gt;Link: &lt;/b&gt;&lt;%= event.link %&gt;&lt;/ul&gt;\n... ...\n    &lt;%= link_to &quot;Delete&quot;, coin_event_path(event.coin_id, event.id), method: :delete, data: { confirm: &quot;Do you want to delete this submission?&quot; }, class: &quot;btn btn-default&quot; %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n<p>And reuse this partial to render both collections:</p>\n<pre><code>&lt;%= render @accepted %&gt;\n&lt;!-- OTHER STUFF HERE --&gt; \n&lt;%= render @pending %&gt;\n</code></pre>\n<p>I advise reading about <a href=\"https://guides.rubyonrails.org/layouts_and_rendering.html#rendering-collections\" rel=\"nofollow noreferrer\">Partials in the Rails Guides</a>.</p>\n"}], "owner": {"reputation": 323, "user_id": 6942847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lntXq.jpg?s=128&g=1", "display_name": "mxvx", "link": "https://stackoverflow.com/users/6942847/mxvx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 52399147, "answer_count": 2, "score": 0, "last_activity_date": 1537596246, "creation_date": 1537310648, "question_id": 52395567, "link": "https://stackoverflow.com/questions/52395567/ruby-rails-most-efficient-way-of-dividing-an-array-into-two-groups-based-on-a", "title": "Ruby / Rails- Most efficient way of dividing an array into two groups based on a parameter and displaying both", "body": "<p>I have a 'Coin' model, which has a boolean parameter, 'accepted'. I want to first display all objects that are accepted, followed by a break, then display those which are not accepted (so I don't want to just sort them and display them all). What is the most efficient way of doing this? Below is how I currently have it, but I feel there must be a better way.</p>\n\n<pre><code>&lt;% @accepted = @coin_events.select { |event| event.accepted == true } %&gt;\n&lt;% @pending = @coin_events.select { |event| event.accepted == false } %&gt;\n\n&lt;% @accepted.each do |event| %&gt;\n  &lt;ul&gt;&lt;b&gt;Event: &lt;/b&gt;&lt;%= event.content %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Category: &lt;/b&gt;&lt;%= event.coin.currency_name %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Link: &lt;/b&gt;&lt;%= event.link %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Date: &lt;/b&gt;&lt;%= event.date.strftime('%a %b %d %Y') if defined?(event.date) %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Location: &lt;/b&gt;&lt;%= event.city %&gt;, &lt;%= event.state %&gt;, &lt;%= event.country %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Description: &lt;/b&gt;&lt;%= event.description %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Submitted by: &lt;/b&gt;&lt;%= event.user.username %&gt;&lt;/ul&gt;\n  &lt;% if can? :edit, Coin %&gt;\n    &lt;ul&gt;&lt;b&gt;Accepted: &lt;/b&gt;&lt;%= event.accepted %&gt;&lt;/ul&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"btn-group\" id=\"event-buttons\"&gt;    \n    &lt;% if can? :update, event and @coin.moderator == current_user or current_user.admin? %&gt;\n      &lt;%= link_to \"View Event\", coin_event_path(event.coin_id, event.id), class: \"btn btn-default\" %&gt;       \n      &lt;%= link_to \"Edit\", edit_coin_event_path(event.coin_id, event.id), class: \"btn btn-default\" %&gt;\n    &lt;% end %&gt;\n    &lt;% if can? :destroy, event and current_user.admin? %&gt;\n      &lt;%= link_to \"Delete\", coin_event_path(event.coin_id, event.id), method: :delete, data: { confirm: \"Do you want to delete this submission?\" }, class: \"btn btn-default\" %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;!-- OTHER STUFF HERE --&gt; \n\n&lt;% @pending.each do |event| %&gt;\n\n  &lt;ul&gt;&lt;b&gt;Event: &lt;/b&gt;&lt;%= event.content %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Category: &lt;/b&gt;&lt;%= event.coin.currency_name %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Link: &lt;/b&gt;&lt;%= event.link %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Date: &lt;/b&gt;&lt;%= event.date.strftime('%a %b %d %Y') if defined?(event.date) %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Location: &lt;/b&gt;&lt;%= event.city %&gt;, &lt;%= event.state %&gt;, &lt;%= event.country %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Description: &lt;/b&gt;&lt;%= event.description %&gt;&lt;/ul&gt;\n  &lt;ul&gt;&lt;b&gt;Submitted by: &lt;/b&gt;&lt;%= event.user.username %&gt;&lt;/ul&gt;\n  &lt;% if can? :edit, Coin %&gt;\n    &lt;ul&gt;&lt;b&gt;Accepted: &lt;/b&gt;&lt;%= event.accepted %&gt;&lt;/ul&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"btn-group\" id=\"event-buttons\"&gt;    \n    &lt;% if can? :update, event and @coin.moderator == current_user or current_user.admin? %&gt;\n      &lt;%= link_to \"View Event\", coin_event_path(event.coin_id, event.id), class: \"btn btn-default\" %&gt;       \n      &lt;%= link_to \"Edit\", edit_coin_event_path(event.coin_id, event.id), class: \"btn btn-default\" %&gt;\n    &lt;% end %&gt;\n    &lt;% if can? :destroy, event and current_user.admin? %&gt;\n      &lt;%= link_to \"Delete\", coin_event_path(event.coin_id, event.id), method: :delete, data: { confirm: \"Do you want to delete this submission?\" }, class: \"btn btn-default\" %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ruby-on-rails-5", "sprockets"], "answers": [{"comments": [{"owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "edited": false, "score": 0, "creation_date": 1537352984, "post_id": 52395158, "comment_id": 91751190, "body": "Thank you chumakoff. I will try today and let you know."}], "tags": [], "owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "is_accepted": false, "score": 1, "last_activity_date": 1537309126, "last_edit_date": 1537309126, "creation_date": 1537307895, "answer_id": 52395158, "question_id": 52394991, "link": "https://stackoverflow.com/questions/52394991/paperclip-default-url-image-isnt-working-in-rails-5/52395158#52395158", "title": "Paperclip default url image isn&#39;t working in Rails 5", "body": "<p><code>ActionController::Base.helpers.asset_path('folder1/logo/:style/default.jpg')</code> is equal to <code>\"/assets/folder1/logo/:style/default.jpg\"</code> by default. \nIt would work if the file were in <code>app/assets/images/assets/folder1/logo/:style/default.jpg</code> directory.</p>\n\n<p>You don't have to use <code>asset_path</code> method here. Just specify a relative path</p>\n\n<pre><code>has_attached_file :logo,\n                  :default_url =&gt; '/folder1/logo/:style/default.jpg'\n</code></pre>\n\n<p>Then the default image url will be <code>/assets/folder1/logo/:style/default.jpg</code> and the file will be found in the folder you put it into.</p>\n"}], "owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537309126, "creation_date": 1537307016, "question_id": 52394991, "link": "https://stackoverflow.com/questions/52394991/paperclip-default-url-image-isnt-working-in-rails-5", "title": "Paperclip default url image isn&#39;t working in Rails 5", "body": "<p>I am using Paperclip for image upload processing. I am trying to show default image when there is no image uploaded by User. Here is my code for <code>default_url</code> option :</p>\n\n<pre><code>  has_attached_file :logo,\n                    :styles =&gt; { square: \"200x200&gt;\", small: \"400x400&gt;\", profile: \"240x175&gt;\" },\n                    :default_url =&gt; ActionController::Base.helpers.asset_path('folder1/logo/:style/default.jpg')\n</code></pre>\n\n<p>Here is my code for how I am rendering image :\n<code>\n@my_model_instance.logo.url\n</code>\nMy image path in project is <code>app/assets/images/folder1/logo/original/default.jpg</code></p>\n\n<p>I have googled it but no luck. Default image is still not rendered on page.</p>\n\n<p>Any help will be appriciated.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby", "algorithm", "pdf"], "answers": [{"comments": [{"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1537369490, "post_id": 52395426, "comment_id": 91761493, "body": "The <code>PHONE_NUMBER_FIELD_IDS</code> array will have the values <code>[&quot;66563943&quot;, &quot;66563947&quot;]</code> which are the field ids that map to the phone numbers <code>[{:field=&gt;&quot;66563947&quot;, :value=&gt;&quot;(347) 222-2222&quot;}, {:field=&gt;&quot;66563943&quot;, :value=&gt;&quot;(201) 785-9896&quot;}]</code>"}], "tags": [], "owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "is_accepted": true, "score": 1, "last_activity_date": 1537309688, "creation_date": 1537309688, "answer_id": 52395426, "question_id": 52394303, "link": "https://stackoverflow.com/questions/52394303/unable-to-parse-multiple-phone-numbers-via-gsub-and-ruby-methods/52395426#52395426", "title": "unable to parse multiple phone numbers via gsub and ||= ruby methods", "body": "<p>Assuming I'm reading your code correctly, the problem is that an empty array is not falsey.</p>\n\n<pre><code>&gt; foo = []\n# =&gt; []\n&gt; foo ||= [1]\n# =&gt; []\n</code></pre>\n\n<p>So, after you've processed the first phone number, the second is never put into <code>@phone_number_sections</code> to be processed.</p>\n\n<p>What you probably need to do is add the new captures into the sections like so:</p>\n\n<pre><code>def parse_phone_number(phone_number)\n  @phone_number_sections ||= []\n  @phone_number_sections += phone_number.gsub(/\\D+/, \"\").match(/(...)(...)(....)/).captures\nend\n</code></pre>\n\n<p>Alternatively, since it looks like it may be possible for the number to be added multiple times, you may have to do this:</p>\n\n<pre><code>def parse_phone_number(phone_number)\n  if @phone_number_sections.nil? or @phone_number_sections.empty?\n    @phone_number_sections = phone_number.gsub(/\\D+/, \"\").match(/(...)(...)(....)/).captures\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 52395426, "answer_count": 1, "score": 0, "last_activity_date": 1537369167, "creation_date": 1537303197, "last_edit_date": 1537369167, "question_id": 52394303, "link": "https://stackoverflow.com/questions/52394303/unable-to-parse-multiple-phone-numbers-via-gsub-and-ruby-methods", "title": "unable to parse multiple phone numbers via gsub and ||= ruby methods", "body": "<p>I'm currently working on parsing phone numbers into a PDF form. I'm making use of the gem <code>pdf-form</code> which also user <code>pdftk</code>. The phone numbers are return as JSON when making a request of a form service I'm using <a href=\"https://developers.formstack.com/docs/submission-id-get\" rel=\"nofollow noreferrer\">FormStack</a>.</p>\n\n<p>I created a <code>DICTIONARY</code> to map the field id in the PDF form to the field id in the FormStack JSON response. So in that way I could iterate over them.</p>\n\n<pre><code>DICTIONARY = {\n    'Applicant Name'              =&gt; '66563757', #Name\n    'DATE OF BIRTH mmddyyyy'      =&gt; '66563844', #Date of Birth\n    ##\n    'TELEPHONE NUMBER area code 1'=&gt; '66563943', #Primary Phone - Area code (000)\n    'TELEPHONE NUMBER first 3 1'  =&gt; '66563943', #Primary Phone - (000) 000\n    'TELEPHONE NUMBER Last 4 1'   =&gt; '66563943', #Primary Phone - (000) 000-0000\n    'CELLPHONE NUMBER area code 1'=&gt; '66563947', #Secondary Phone - Area code (000)\n    'CELLPHONE NUMBER first 3 1'  =&gt; '66563947', #Secondary Phone - (000) 000\n    'CELLPHONE NUMBER Last 4 1'   =&gt; '66563947', #Secondary Phone - (000) 000-0000\n\n    'TELEPHONE NUMBER area code 2'=&gt; '66564485', #Phone - Area code (000)\n    'TELEPHONE NUMBER first 3 2'  =&gt; '66564485', #Phone - first 3 - (000) 000\n    'TELEPHONE NUMBER Last 4 2'   =&gt; '66564485', #Phone - last 4 - (000) 000-0000\n\n     }\n</code></pre>\n\n<p>As you see, the phone numbers are break into first 3 digits area code, second 3 digits and the last 4. I created a library to parse this phone numbers into the PDF form field. The values in the <code>DICTIONARY</code> hash are the fields in the digital form in FormStack. <a href=\"https://i.stack.imgur.com/PfS9P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PfS9P.png\" alt=\"enter image description here\"></a>\n<code>USER_DATA</code> is what is passed into <code>initialize(user_submission_data)</code> which is the users data when it fills the form.</p>\n\n<pre><code>class PdfScrie &lt; FillablePdfForm\n\n  def initialize(user_submission_data)\n    @user_submission_data = user_submission_data\n    super()\n  end\n\n  private\n\n  DICTIONARY = {\n\n  }\n\n  APPLICANT_ADDRESS_FORM_FIELD_ID = \"66563934\"\n  TENANT_REPRESENTATIVE_ADDRESS_FORM_FIELD_ID = \"66564487\"\n\n  TELEPHONE_NUMBER_1_id = \"66563943\"\n  CELLPHONE_NUMBER_1_id = \"66563947\"\n\n  ADDRESS_FIELD_IDS = [\n    APPLICANT_ADDRESS_FORM_FIELD_ID,\n    TENANT_REPRESENTATIVE_ADDRESS_FORM_FIELD_ID,\n  ].freeze\n\n  PHONE_NUMBER_FIELD_IDS = [\n    TELEPHONE_NUMBER_1_id,\n    CELLPHONE_NUMBER_1_id\n  ].freeze\n\n  def fill_out\n    form_fields.each do |field|\n      id = DICTIONARY[field]\n      @user_submission_data\n        .select {|fd| fd[:field] == id}\n        .each do |field_data|\n          if address_field?(field_data[:field])\n            break_address_into_state_city_zipcode(field_data[:value], field)\n          elsif phone_number?(field_data[:field])\n            parse_phone_number(field_data[:value])\n            fill(field, @phone_number_sections.shift)\n          else\n            fill(field, field_data[:value])\n          end\n        end\n    end\n  end\n\n  def address_field?(field)\n    ADDRESS_FIELD_IDS.include?(field.to_s)\n  end\n\n  def break_address_into_state_city_zipcode(address, field)\n    address_by_section = FormStack::Form.parse_formstack_nested_attrs(address)\n    address_by_section.each do |section,value|\n       fill(field, value) if form_field_has_section?(field, section)\n    end\n  end\n\n  def form_field_has_section?(form_field_name, address_section)\n    form_field_name.include? address_section.upcase\n  end\n\n  def parse_phone_number(phone_number)\n    @phone_number_sections ||= phone_number.gsub(/\\D+/, \"\").match(/(...)(...)(....)/).captures\n  end\n\n  def phone_number?(field)\n    PHONE_NUMBER_FIELD_IDS.include?(field.to_s)\n  end\nend\n</code></pre>\n\n<p>However, when iterating over the <code>PHONE_NUMBER_FIELD_IDS</code> only the first phone number is being parsed. When I run <code>binding.pry</code> <code>fill_out</code> method I'm able to see that the number in fact is the one I want to parse.</p>\n\n<pre><code>[2] pry(#&lt;PdfScrie&gt;)&gt; parse_phone_number(field_data[:value])\n=&gt; [\"201\", \"785\", \"9896\"]\n[3] pry(#&lt;PdfScrie&gt;)&gt; fill(field, @phone_number_sections.shift)\n=&gt; \"201\"\n</code></pre>\n\n<p>However <code>CELLPHONE_NUMBER_1_id</code> is not being parsed, and I can't understand why is not.<a href=\"https://i.stack.imgur.com/OMH6M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OMH6M.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the <code>fill</code> method thats on the other library that parses it into PDF.</p>\n\n<pre><code> def fill(key, value)\n    attributes[ key.to_s ] = value\n  end\n\n  def pdftk\n    @pdftk ||= PdfForms.new()\n  end\n</code></pre>\n"}, {"tags": ["ruby", "heroku", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 0, "creation_date": 1537304657, "post_id": 52393701, "comment_id": 91734230, "body": "I am not sure I understood you correctly, but you probably should put the codes into <code>public&#47;career</code> folder (create it first if it doesn&#39;t exist). Then it will be available at <code>mywebsite.com&#47;career&#47;</code> and the old Rails website will work as it&#39;s been."}, {"owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "edited": false, "score": 0, "creation_date": 1537355690, "post_id": 52393701, "comment_id": 91752780, "body": "If you&#39;re sticking a load of static files in the public folder anyway, why run rails at all?"}, {"owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "edited": false, "score": 0, "creation_date": 1537390906, "post_id": 52393701, "comment_id": 91772034, "body": "&gt; is that is there a way to turn off default page even though index.html. No there isn&#39;t. I&#39;m a rails contributor and that is pretty hard coded behavior. Instead you can rename it to something like <code>_index.html</code> which would prevent it from being loaded by default until someone visits yourapp.herokuapp.com/_index.html. In short, you need to change the name of the file."}, {"owner": {"reputation": 99, "user_id": 7517965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33b9edc4934f00ed1148919d11198e4?s=128&d=identicon&r=PG&f=1", "display_name": "carrey", "link": "https://stackoverflow.com/users/7517965/carrey"}, "edited": false, "score": 0, "creation_date": 1537407399, "post_id": 52393701, "comment_id": 91776006, "body": "@Scheneems  thanks for the tip."}], "owner": {"reputation": 99, "user_id": 7517965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33b9edc4934f00ed1148919d11198e4?s=128&d=identicon&r=PG&f=1", "display_name": "carrey", "link": "https://stackoverflow.com/users/7517965/carrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537300433, "creation_date": 1537300433, "question_id": 52393701, "link": "https://stackoverflow.com/questions/52393701/can-i-have-an-option-to-turn-off-default-page-under-public-folder", "title": "Can I have an option to turn off default page under public folder?", "body": "<p>I recently purchased a portal and I can get it into my website as outsourcing company provided codes.</p>\n\n<p>I'm not a web developer so I don't know much about web programming.</p>\n\n<p>After I put the files ( assets,fonts,scripts,styles, etc) under public folder, it does work fine, but it's set up as a default page. I guess it's because under public.</p>\n\n<p>My question is that is there a way to turn off default page even though index.html file is under public folder?? so the website is working as it's been and the new file will be under subdirectory  like  mywebsite.com/career/ </p>\n\n<p>I'm using ruby 2.3.7 and rails 5.2.0.\nThe website is hosted on Heroku if these are helpful.</p>\n"}, {"tags": ["javascript", "ruby", "watir", "custom-component"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1537297693, "post_id": 52393080, "comment_id": 91731350, "body": "Any chance this is on a public page (ie to make it easier to reproduce the problem)?"}, {"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1537309604, "post_id": 52393080, "comment_id": 91735850, "body": "Try doing things like <code>document.querySelector(&#39;[data-qa=&quot;dropdown-container&quot;]&#39;).cli&zwnj;&#8203;ck()</code> in your browser console"}, {"owner": {"reputation": 51, "user_id": 4132922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/116514ee1122866ad4817574ae9e2190?s=128&d=identicon&r=PG&f=1", "display_name": "evan", "link": "https://stackoverflow.com/users/4132922/evan"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1537658626, "post_id": 52393080, "comment_id": 91865503, "body": "@JustinKo I have an NDA, so I cannot disclose the website :/"}], "owner": {"reputation": 51, "user_id": 4132922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/116514ee1122866ad4817574ae9e2190?s=128&d=identicon&r=PG&f=1", "display_name": "evan", "link": "https://stackoverflow.com/users/4132922/evan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537297435, "creation_date": 1537297435, "question_id": 52393080, "link": "https://stackoverflow.com/questions/52393080/click-on-a-javascript-element-with-watir-selenium-anything", "title": "Click on a javascript element with Watir/Selenium/anything", "body": "<p><a href=\"https://i.stack.imgur.com/4h1cS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4h1cS.png\" alt=\"When Opened\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/IG8jo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IG8jo.png\" alt=\"When Closed\"></a></p>\n\n<p>The first one is when I open it up and select a value, and the second one is when I haven't selected a value and it is closed. It appears to only change the <code>&lt;span class=\"va-sm-m\"&gt;Size&lt;/span&gt;</code> tag, there are no other elements on the webpage related to this, and everything appears to be in this one component. They must be using like React/vue/etc. It is just a simple dropdown grid with a bunch of different sizes. Only the dropdown is actual html, all the options to select are not on the webpage during opening either. How would I select this. I already consulted the watir Slack, to no avail. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "algorithm"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 4, "creation_date": 1537295991, "post_id": 52392674, "comment_id": 91730587, "body": "What does that program do?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537296148, "post_id": 52392674, "comment_id": 91730649, "body": "Remember that Ruby doesn&#39;t really use <code>for</code> at all, the <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html\" rel=\"nofollow noreferrer\">Enumerable</a> library makes it totally worthless. The problem you&#39;re trying to solve here might be better tackled as one of testing various two-entry <a href=\"https://ruby-doc.org/core-2.5.0/Array.html#method-i-combination\" rel=\"nofollow noreferrer\"><code>combination</code></a> pairs. Your algorithm here, whatever it is, looks geometric, so it will get exponentially slower for large lists."}, {"owner": {"reputation": 95, "user_id": 6354357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a456434354ba82112523fa48c2edb6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gol. D Roger", "link": "https://stackoverflow.com/users/6354357/gol-d-roger"}, "edited": false, "score": 0, "creation_date": 1537296612, "post_id": 52392674, "comment_id": 91730853, "body": "yes its a geometric algorithm"}], "answers": [{"tags": [], "owner": {"reputation": 5800, "user_id": 4287733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835e993afb1e20c1981dd6b8b59ded2d?s=128&d=identicon&r=PG", "display_name": "Nermin", "link": "https://stackoverflow.com/users/4287733/nermin"}, "is_accepted": true, "score": 1, "last_activity_date": 1537297978, "creation_date": 1537297978, "answer_id": 52393198, "question_id": 52392674, "link": "https://stackoverflow.com/questions/52392674/how-to-optimize-the-program-with-two-for-loops/52393198#52393198", "title": "How to optimize the program with two for loops", "body": "<p>If I have understood the problem you are trying to solve (from code)</p>\n\n<pre><code>def calc_res(a)\n  last_index = a.length - 1\n  index = 0\n  while a[index] == a.last do\n    index = index + 1\n    break if index == last_index\n  end\n  last_index - index\nend\n</code></pre>\n\n<p>It checks items from start if they are equal to items from end, end it moves the index toward the last element. As I understood you search for max length between different elements.</p>\n\n<p>For you problem with [4, 6, 2, 2, 6, 6, 4] it will have one iteration and return 5, for the problem with [1...70000] it will have zero iterations and will return the difference in positions for those two (size of the array - 1)</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1537570227, "last_edit_date": 1537570227, "creation_date": 1537301545, "answer_id": 52393964, "question_id": 52392674, "link": "https://stackoverflow.com/questions/52392674/how-to-optimize-the-program-with-two-for-loops/52393964#52393964", "title": "How to optimize the program with two for loops", "body": "<p>A more rubyesque versions include:</p>\n\n<pre><code>def calc_res(a)\n  last = a.last\n  idx = a.find_index {|e| e != last }&amp;.+(1) || a.size\n  a.size - idx\nend\n\ndef calc_res(a)\n  last = a.last\n  a.size - a.each.with_index(1).detect(-&gt;{[a.size]}) {|e,_| e != last }.last \nend\n\ndef calc_res(a)\n  last = a.last\n  a.reduce(a.size) do |memo, e| \n    return memo unless e == last\n    memo -= 1\n  end\nend\n\ndef calc_res(a)\n  return 0 if b = a.uniq and b.size == 1\n  a.size - a.index(b[-1]).+(1)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1537325375, "last_edit_date": 1537325375, "creation_date": 1537304714, "answer_id": 52394580, "question_id": 52392674, "link": "https://stackoverflow.com/questions/52392674/how-to-optimize-the-program-with-two-for-loops/52394580#52394580", "title": "How to optimize the program with two for loops", "body": "<p>My understanding is that the problem is to find two unique elements in the array whose distance apart (difference in indices) is maximum, and to return the distance they are apart. I return <code>nil</code> if all elements are the same.</p>\n\n<p>My solution attempts to minimize the numbers of pairs of elements that must be examined before an optimal solution is identified. For the example given in the question only two pairs of elements need be considered.</p>\n\n<pre><code>def calc_res(a)\n  sz = a.size-1\n  sz.downto(2).find { |n| (0..sz-n).any? { |i| a[i] != a[i+n] } }\nend\n\na = [4,6,2,2,6,6,4]\ncalc_res a\n  #=&gt; 5\n</code></pre>\n\n<p>If <code>sz = a.size-1</code>, <code>sz</code> is the greatest possible distance two elements can be apart. If, for example, <code>a = [1,2,3,4]</code>, <code>sz = 3</code>, which is the number of positions <code>1</code> and <code>4</code> are apart.</p>\n\n<p>For <code>a</code>, <code>sz = a.size-1 #=&gt; 6</code>. I first determine if any pair of elements that are <code>n = sz</code> positions apart are unique. <code>[a[0], a[6]] #=&gt; [4,4]</code> is the only pair of elements <code>6</code> positions apart. Since they are not unique I reduce <code>n</code> by one (to <code>5</code>) and examine all pairs of elements <code>n</code> positions apart, looking for one whose elements are unique. There are two pairs <code>5</code> positions apart: <code>[a[0], a[5]] #=&gt; [4,6]</code> and <code>[a[1], a[6]] #=&gt; [6,4]</code>. Both of these meet the test, so we are finished, and return <code>n #=&gt; 5</code>. In fact we are finished after testing the first of these two pairs. Had neither these pairs contained unique values <code>n</code> would have been reduced by <code>1</code> to <code>4</code> and the three pairs <code>[a[0], a[4]] #=&gt; [4,6]</code>, <code>[a[1], a[5]] #=&gt; [6,6]</code> and <code>[a[2], a[6]] #=&gt; [2,6]</code> would have been searched for one with unique values, and so on.</p>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Integer.html#method-i-downto\" rel=\"nofollow noreferrer\">Integer#downto</a>, <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-find\" rel=\"nofollow noreferrer\">Enumerable#find</a> and <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-any-3F\" rel=\"nofollow noreferrer\">Enumerable#any?</a>.</p>\n"}], "owner": {"reputation": 95, "user_id": 6354357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a456434354ba82112523fa48c2edb6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gol. D Roger", "link": "https://stackoverflow.com/users/6354357/gol-d-roger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "accepted_answer_id": 52393198, "answer_count": 3, "score": 0, "last_activity_date": 1537570227, "creation_date": 1537295592, "last_edit_date": 1537298064, "question_id": 52392674, "link": "https://stackoverflow.com/questions/52392674/how-to-optimize-the-program-with-two-for-loops", "title": "How to optimize the program with two for loops", "body": "<p>I have a following programm</p>\n\n<pre><code>def calc_res(a)\n  n = a.length\n  result = 0\n  for i in 0 .. (n - 1)\n    for j in i .. (n - 1)\n      if (a[i] != a[j] &amp;&amp; j - i &gt; result) then\n        result = j - i\n      end\n    end\n  end\n  return result\nend\n</code></pre>\n\n<p>which return following output</p>\n\n<pre><code>irb(main):013:0&gt; calc_res([4, 6, 2, 2, 6, 6, 4])\n=&gt; 5\n</code></pre>\n\n<p>but it is taking time if array size is too large e.g. <code>[0,1,2,3,.....70000]</code></p>\n\n<p>can any one suggest me how can I optimize it.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1184, "user_id": 2852104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad8e5fe60519b1b16656edbbb236a8c?s=128&d=identicon&r=PG&f=1", "display_name": "pacuna", "link": "https://stackoverflow.com/users/2852104/pacuna"}, "edited": false, "score": 0, "creation_date": 1537294859, "post_id": 52392439, "comment_id": 91730049, "body": "you may have a .ruby-version file hanging around there ?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537294958, "post_id": 52392439, "comment_id": 91730104, "body": "Does <code>gem env</code> offer any insight into what might be wrong?"}, {"owner": {"reputation": 461, "user_id": 9040953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZat4.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/9040953/john"}, "edited": false, "score": 0, "creation_date": 1537295091, "post_id": 52392439, "comment_id": 91730173, "body": "That gives a fair amount of information. It says this <code>RUBY VERSION: 2.4.1 (2017-03-22 patchlevel 111) [x86_64-linux]</code>, among other things."}, {"owner": {"reputation": 461, "user_id": 9040953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZat4.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/9040953/john"}, "edited": false, "score": 0, "creation_date": 1537295109, "post_id": 52392439, "comment_id": 91730181, "body": "I do have a .ruby-version file. All it says is 2.4.1"}], "answers": [{"comments": [{"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537300360, "post_id": 52392585, "comment_id": 91732546, "body": "You should be aware that bundle update will update every gem possible, which, depending on how restrictive you set versions in your Gemfile might easily break your application."}], "tags": [], "owner": {"reputation": 10858, "user_id": 788700, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f02925eef8f737905a8702b9cc21ff07?s=128&d=identicon&r=PG", "display_name": "Adobe", "link": "https://stackoverflow.com/users/788700/adobe"}, "is_accepted": true, "score": 2, "last_activity_date": 1537296014, "last_edit_date": 1537296014, "creation_date": 1537295180, "answer_id": 52392585, "question_id": 52392439, "link": "https://stackoverflow.com/questions/52392439/your-version-is-2-3-4-but-your-gemfile-specified-2-4-1/52392585#52392585", "title": "Your version is 2.3.4, but your Gemfile specified 2.4.1", "body": "<p>Your last step should be <code>bundle update</code> instead of <code>bundle</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>rvm use ruby-2.4.1\nbundle update\n</code></pre>\n\n<p>I would not specify ruby in <code>Gemfile</code>, I'd rather specify it in <code>.rvmrc</code> of rails root, so that ruby version manager reads it; where as <code>Gemfile</code> is for gem versions.</p>\n"}], "owner": {"reputation": 461, "user_id": 9040953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZat4.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/9040953/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "closed_date": 1537333553, "accepted_answer_id": 52392585, "answer_count": 1, "score": 0, "last_activity_date": 1537471610, "creation_date": 1537294527, "last_edit_date": 1537471610, "question_id": 52392439, "link": "https://stackoverflow.com/questions/52392439/your-version-is-2-3-4-but-your-gemfile-specified-2-4-1", "closed_reason": "Duplicate", "title": "Your version is 2.3.4, but your Gemfile specified 2.4.1", "body": "<p>Note: This is not a duplicate of <a href=\"https://stackoverflow.com/questions/23039528/your-ruby-version-is-2-0-0-but-your-gemfile-specified-2-1-0\">this stack post</a>. The solution to my question is <code>bundle update</code>. The solution to the allegedly duplicate post is <code>gem update bundler</code>, which I tried and which did not work. It is a different command. Please remove the duplicate flag.  </p>\n\n<p>Rails application. I have looked at these stack posts:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/51311168/your-ruby-version-is-2-3-1-but-your-gemfile-specified-2-4-1-when-running-rails\">Your version is 2.3.1 but gemfile specified 2.4.1</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/35862231/your-ruby-version-is-2-2-4-but-your-gemfile-specified-2-3-0\">Your version is 2.2.4 but gemfile specified 2.3.0</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/23039528/your-ruby-version-is-2-0-0-but-your-gemfile-specified-2-1-0\">Your version is 2.0.0 but gemfile specified 2.1.0</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/37914702/how-to-fix-your-ruby-version-is-2-3-0-but-your-gemfile-specified-2-2-5-while\">Your version is 2.3.0 but gemfile specified 2.2.5</a></p>\n\n<p>Running <code>rails s</code> yields <code>Your version is 2.3.4, but your Gemfile specified 2.4.1.</code></p>\n\n<p>This is easily fixed by changing to <code>ruby '2.3.4'</code> in my <code>Gemfile</code>, but I would like to use the newer version.  </p>\n\n<p>I've run: </p>\n\n<pre><code>rvm use ruby-2.4.1\n\nrvm reinstall ruby-2.4.1\n\ngem update bundler\n\nbundle\n</code></pre>\n\n<p>Importantly: <code>ruby -v</code> yields <code>ruby 2.4.1p111</code></p>\n\n<p>So, why is it saying my version is <code>2.3.4</code>? What am I missing?  </p>\n\n<p>EDIT: Please see the answer below. The final step should be <code>bundle update</code>.  </p>\n"}, {"tags": ["json", "ruby", "rest-client", "dashing"], "comments": [{"owner": {"reputation": 3, "user_id": 10381333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f13341ab3825edfd399e96d1a0a02429?s=128&d=identicon&r=PG&f=1", "display_name": "thatdamntiffy", "link": "https://stackoverflow.com/users/10381333/thatdamntiffy"}, "reply_to_user": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "edited": false, "score": 0, "creation_date": 1537469313, "post_id": 52391551, "comment_id": 91806479, "body": "Yes. It&#39;s a blood sugar reading. I want to display the value of the SGV on a dashboard"}, {"owner": {"reputation": 3, "user_id": 10381333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f13341ab3825edfd399e96d1a0a02429?s=128&d=identicon&r=PG&f=1", "display_name": "thatdamntiffy", "link": "https://stackoverflow.com/users/10381333/thatdamntiffy"}, "reply_to_user": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "edited": false, "score": 0, "creation_date": 1537470419, "post_id": 52391551, "comment_id": 91806995, "body": "Something like:   current_nightscout = response[0][&quot;sgv&quot;]"}, {"owner": {"reputation": 3, "user_id": 10381333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f13341ab3825edfd399e96d1a0a02429?s=128&d=identicon&r=PG&f=1", "display_name": "thatdamntiffy", "link": "https://stackoverflow.com/users/10381333/thatdamntiffy"}, "reply_to_user": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "edited": false, "score": 0, "creation_date": 1537478301, "post_id": 52391551, "comment_id": 91810615, "body": "@user3788685 do you mind if we go through what happened there so I can use learn from this?  <code>JSON.parse(open(&quot;url&quot; </code> - <b>is this parsing the JSON and opening that actual URL?</b>  <code>:read_timeout =&gt; 4</code> - <b>I figured this was a read time out, but what does the =&gt; 4 equate to?</b>  <code>p test [0][&quot;sgv&quot;]</code> - <b>I figured this was performing the puts action on the variable test but I am not sure what the [0] part is doing?</b>  Thanks for all of your help"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 10381333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f13341ab3825edfd399e96d1a0a02429?s=128&d=identicon&r=PG&f=1", "display_name": "thatdamntiffy", "link": "https://stackoverflow.com/users/10381333/thatdamntiffy"}, "is_accepted": false, "score": 0, "last_activity_date": 1537478159, "creation_date": 1537478159, "answer_id": 52433438, "question_id": 52391551, "link": "https://stackoverflow.com/questions/52391551/extract-single-data-from-json-url-for-dashing-dashboard/52433438#52433438", "title": "Extract Single Data From JSON URL for Dashing Dashboard", "body": "<p>Here is the final code that made it work</p>\n\n<pre><code>require 'net/http'\nrequire 'json'\nrequire 'rest-client'\n\n# :first_in sets how long it takes before the job is first run. In this case, it is run immediately\ncurrent_nightscout = 0\n\nSCHEDULER.every '1m' do \n\ntest = JSON.parse(open(\"https://dnarnianbg.herokuapp.com/api/v1/entries/current.json\", :read_timeout =&gt; 4).read)\n\n\n  last_nightscout = current_nightscout\n  current_nightscout = p test[0][\"sgv\"]\n\n  send_event('nightscout', { current: current_nightscout, last: last_nightscout })\n end\n</code></pre>\n\n<p>I can probably eliminate <code>require 'rest-client'</code> since that is no longer being used, but it works right now and that is all that matters. </p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10381333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f13341ab3825edfd399e96d1a0a02429?s=128&d=identicon&r=PG&f=1", "display_name": "thatdamntiffy", "link": "https://stackoverflow.com/users/10381333/thatdamntiffy"}, "edited": false, "score": 0, "creation_date": 1537559241, "post_id": 52434081, "comment_id": 91843561, "body": "I can get it to do more than one at a time by removing the current.json and just doing entries.json. Thanks for helping me out with that!"}], "tags": [], "owner": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "is_accepted": true, "score": 0, "last_activity_date": 1537481710, "creation_date": 1537481710, "answer_id": 52434081, "question_id": 52391551, "link": "https://stackoverflow.com/questions/52391551/extract-single-data-from-json-url-for-dashing-dashboard/52434081#52434081", "title": "Extract Single Data From JSON URL for Dashing Dashboard", "body": "<p>You need something like <code>response[0][\"sgv\"]</code> which should return <code>52</code> if you end up with many items in the list you will need to iterate over them.</p>\n\n<p>The best thing you can do is to break your problem down into easier parts to debug. As you are having problems accessing some <code>JSON</code> via an API you should make a simple script which only does the function you want in order to test it and see where the problem is.</p>\n\n<p>Here is a short example you can put into a <code>.rb</code> file and run;</p>\n\n<pre><code>#!/usr/bin/ruby\n\nrequire 'open-uri'\nrequire 'json'\n\ntest = JSON.parse(open(\"https://dnarnianbg.herokuapp.com/api/v1/entries/current.json\", :read_timeout =&gt; 4).read)\n\nputs test[0][\"sgv\"]\n</code></pre>\n\n<p>That should return the value from <code>sgv</code></p>\n\n<p>I realise that short sweet example may be little use as a learner so here is a more verbose version with some comments;</p>\n\n<pre><code>#!/usr/bin/ruby\n\nrequire 'open-uri'\nrequire 'json'\n\n# Open the URL and read the result. Time out if this takes longer then 4 sec.\nget_data = open(\"https://dnarnianbg.herokuapp.com/api/v1/entries/current.json\", :read_timeout =&gt; 4).read\n\n# Parse the response (get_data) to JSON and put in variable output\noutput = JSON.parse(get_data)\n\n# Put the output to get the 'sgv figure'\np output[0][\"sgv\"]\n</code></pre>\n\n<p>It always pays to manually examine the data you get back, in your case the data looks like this (when make pretty)</p>\n\n<pre><code>[\n  {\n    \"_id\": \"5ba41a0fb8a1ee0aedf6eb2c\",\n    \"sgv\": 144,\n    \"date\": 1537481109000,\n    \"dateString\": \"2018-09-20T22:05:09.000Z\",\n    \"trend\": 4,\n    \"direction\": \"Flat\",\n    \"device\": \"share2\",\n    \"type\": \"sgv\"\n  }\n]\n</code></pre>\n\n<p>What you <em>actually</em> have is an <a href=\"https://docs.ruby-lang.org/en/2.0.0/Array.html\" rel=\"nofollow noreferrer\">Array</a>. Your server returns only 1 result, numbered '0' hence you need <code>[0]</code> in your <code>p</code> statement. Once you have accessed the array id then you can simply use the object you need as <code>[sgv]</code></p>\n\n<p>If your app ever returns more than one record then you will need to change your code to read all of the results and iterate over them in order to get all the values you need.</p>\n"}], "owner": {"reputation": 3, "user_id": 10381333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f13341ab3825edfd399e96d1a0a02429?s=128&d=identicon&r=PG&f=1", "display_name": "thatdamntiffy", "link": "https://stackoverflow.com/users/10381333/thatdamntiffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "accepted_answer_id": 52434081, "answer_count": 2, "score": 0, "last_activity_date": 1537481710, "creation_date": 1537290573, "last_edit_date": 1537382457, "question_id": 52391551, "link": "https://stackoverflow.com/questions/52391551/extract-single-data-from-json-url-for-dashing-dashboard", "title": "Extract Single Data From JSON URL for Dashing Dashboard", "body": "<p>I am trying to show the \"sgv\" value on a Dashing / Smashing dashboard widget. Ultimately I would also like to show the \"direction\" value as well. I am running into problems pulling that precise value down which changes every 3 to 5 minutes. I have already been able to mirror the exact string using the following:</p>\n\n<pre><code>require 'net/http'\nrequire 'rest-client'\nrequire 'json'\n\nurl = \"https://dnarnianbg.herokuapp.com/api/v1/entries/current.json\"\nresponse = RestClient.get(url)\nJSON.parse(response)\n\n# :first_in sets how long it takes before the job is first run. In this case, it is run immediately\ncurrent_nightscout = 0\n\nSCHEDULER.every '5m' do \n  last_nightscout = current_nightscout\n  current_nightscout = response\n\n  send_event('nightscout', { current: current_nightscout, last: last_nightscout })\n end\n</code></pre>\n\n<p>I have also searched the archives several times. I don't wish to write this to a file like <a href=\"https://stackoverflow.com/questions/14010133/how-to-grab-data-from-json-in-coffeescript\">this one</a> shows and the duplicate question has been deleted or moved. </p>\n\n<p>I realize that the JSON.parse(response) is just going to parse out whatever I tell it the response equals, but I don't know how to get that response to equal SGV. Maybe the solution isn't in the RestClient, but that is where I am lost.</p>\n\n<p>Here is the JSON URL: <a href=\"http://dnarnianbg.herokuapp.com/api/v1/entries/current.json\" rel=\"nofollow noreferrer\">http://dnarnianbg.herokuapp.com/api/v1/entries/current.json</a></p>\n\n<p>EDIT: The output of that link is something like this:</p>\n\n<p>[{\"_id\":\"5ba295ddb8a1ee0aede71822\",\"sgv\":87,\"date\":1537381813000,\"dateString\":\"2018-09-19T18:30:13.000Z\",\"trend\":4,\"direction\":\"Flat\",\"device\":\"share2\",\"type\":\"sgv\"}]</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "tesseract"], "comments": [{"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1537293464, "post_id": 52391419, "comment_id": 91729413, "body": "How do you start the console?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10381560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19eca33497b8ef2af609f1b02ecd5cf?s=128&d=identicon&r=PG&f=1", "display_name": "dj_dock", "link": "https://stackoverflow.com/users/10381560/dj-dock"}, "edited": false, "score": 1, "creation_date": 1537290479, "post_id": 52391501, "comment_id": 91728093, "body": "I have install all the dependencies earlier and now i have installed rmagick gem too but it throws the same error"}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "reply_to_user": {"reputation": 23, "user_id": 10381560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19eca33497b8ef2af609f1b02ecd5cf?s=128&d=identicon&r=PG&f=1", "display_name": "dj_dock", "link": "https://stackoverflow.com/users/10381560/dj-dock"}, "edited": false, "score": 0, "creation_date": 1537290705, "post_id": 52391501, "comment_id": 91728193, "body": "Imagemagick inturn needs some dependencies to be installed have you installed them"}, {"owner": {"reputation": 23, "user_id": 10381560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19eca33497b8ef2af609f1b02ecd5cf?s=128&d=identicon&r=PG&f=1", "display_name": "dj_dock", "link": "https://stackoverflow.com/users/10381560/dj-dock"}, "edited": false, "score": 1, "creation_date": 1537290747, "post_id": 52391501, "comment_id": 91728210, "body": "I am using imagemagick from quite some time so there will be no issues from that"}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "reply_to_user": {"reputation": 23, "user_id": 10381560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19eca33497b8ef2af609f1b02ecd5cf?s=128&d=identicon&r=PG&f=1", "display_name": "dj_dock", "link": "https://stackoverflow.com/users/10381560/dj-dock"}, "edited": false, "score": 0, "creation_date": 1537290920, "post_id": 52391501, "comment_id": 91728284, "body": "You need to have tessdata for the tesseract edited the answer regarding that please check it"}], "tags": [], "owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "is_accepted": true, "score": 0, "last_activity_date": 1537290877, "last_edit_date": 1537290877, "creation_date": 1537290349, "answer_id": 52391501, "question_id": 52391419, "link": "https://stackoverflow.com/questions/52391419/rtesseract-throws-error-after-installing-rtesseract-gem/52391501#52391501", "title": "Rtesseract throws error after installing rtesseract gem", "body": "<p>For RTesseract gem to work you need to install some dependencies like ImageMagick Leptonica and some gems like rmagick. you can install them using</p>\n\n<pre><code>sudo apt-get install imagemagick leptonica\n</code></pre>\n\n<p>and rmagick gem using</p>\n\n<pre><code>gem install rmagick\n</code></pre>\n\n<p>or by placing the same in your gem file</p>\n\n<p>You need to have tessdata folder in the  </p>\n\n<pre><code>/usr/local/share/tessdata\n</code></pre>\n\n<p>if you dont have the tessdata you need to download tessdata from tesseract repositry and copy them to the above path</p>\n"}], "owner": {"reputation": 23, "user_id": 10381560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19eca33497b8ef2af609f1b02ecd5cf?s=128&d=identicon&r=PG&f=1", "display_name": "dj_dock", "link": "https://stackoverflow.com/users/10381560/dj-dock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 52391501, "answer_count": 1, "score": 2, "last_activity_date": 1537290877, "creation_date": 1537289999, "question_id": 52391419, "link": "https://stackoverflow.com/questions/52391419/rtesseract-throws-error-after-installing-rtesseract-gem", "title": "Rtesseract throws error after installing rtesseract gem", "body": "<p>I need to user rtessract gem for my ruby on rails project for OCR. I have installed the gem rtesseract using</p>\n\n<pre><code>gem install rtesseract\n</code></pre>\n\n<p>but when i try to use that gem in my console it throws rtesseract not found error</p>\n\n<p>Can any one have any solution for that. I have also placed the same in gem file and ran bundle but it doesnt work</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "windows", "postgresql"], "comments": [{"owner": {"reputation": 1, "user_id": 10280371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ubBiTCQFqCQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO1YjdcUfJp9QTVQK8Ub0EAPzq9Rg/mo/photo.jpg?sz=128", "display_name": "kimor", "link": "https://stackoverflow.com/users/10280371/kimor"}, "edited": false, "score": 0, "creation_date": 1537291362, "post_id": 52391287, "comment_id": 91728485, "body": "Also I&#39;ve added postgres/bin to PATH"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10280371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ubBiTCQFqCQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO1YjdcUfJp9QTVQK8Ub0EAPzq9Rg/mo/photo.jpg?sz=128", "display_name": "kimor", "link": "https://stackoverflow.com/users/10280371/kimor"}, "edited": false, "score": 0, "creation_date": 1537351847, "post_id": 52392241, "comment_id": 91750425, "body": "Yes, I saw this solution, I just dont know how to do this in Windows."}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "reply_to_user": {"reputation": 1, "user_id": 10280371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ubBiTCQFqCQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO1YjdcUfJp9QTVQK8Ub0EAPzq9Rg/mo/photo.jpg?sz=128", "display_name": "kimor", "link": "https://stackoverflow.com/users/10280371/kimor"}, "edited": false, "score": 0, "creation_date": 1537357709, "post_id": 52392241, "comment_id": 91754069, "body": "Updated the answer for windows"}, {"owner": {"reputation": 1, "user_id": 10280371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ubBiTCQFqCQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO1YjdcUfJp9QTVQK8Ub0EAPzq9Rg/mo/photo.jpg?sz=128", "display_name": "kimor", "link": "https://stackoverflow.com/users/10280371/kimor"}, "edited": false, "score": 0, "creation_date": 1537435439, "post_id": 52392241, "comment_id": 91786485, "body": "I&#39;ve installed postgres from cmd and i still get the error while trying to install pg gem. About video - i did everytihng same way before trying to install gem the first time."}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "reply_to_user": {"reputation": 1, "user_id": 10280371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ubBiTCQFqCQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO1YjdcUfJp9QTVQK8Ub0EAPzq9Rg/mo/photo.jpg?sz=128", "display_name": "kimor", "link": "https://stackoverflow.com/users/10280371/kimor"}, "edited": false, "score": 0, "creation_date": 1537447728, "post_id": 52392241, "comment_id": 91793928, "body": "You need to install postgres client on your system,  please follow the link i have provided in the answer to install it in windows"}, {"owner": {"reputation": 1, "user_id": 10280371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ubBiTCQFqCQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO1YjdcUfJp9QTVQK8Ub0EAPzq9Rg/mo/photo.jpg?sz=128", "display_name": "kimor", "link": "https://stackoverflow.com/users/10280371/kimor"}, "edited": false, "score": 0, "creation_date": 1537554735, "post_id": 52392241, "comment_id": 91841742, "body": "I did it, also i specified path to config in options. I&#39;m asking this qustion after i did all of this."}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "reply_to_user": {"reputation": 1, "user_id": 10280371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ubBiTCQFqCQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO1YjdcUfJp9QTVQK8Ub0EAPzq9Rg/mo/photo.jpg?sz=128", "display_name": "kimor", "link": "https://stackoverflow.com/users/10280371/kimor"}, "edited": false, "score": 0, "creation_date": 1537554978, "post_id": 52392241, "comment_id": 91841838, "body": "may i know from which source have you downloaded the postgres"}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "reply_to_user": {"reputation": 1, "user_id": 10280371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ubBiTCQFqCQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO1YjdcUfJp9QTVQK8Ub0EAPzq9Rg/mo/photo.jpg?sz=128", "display_name": "kimor", "link": "https://stackoverflow.com/users/10280371/kimor"}, "edited": false, "score": 0, "creation_date": 1537555518, "post_id": 52392241, "comment_id": 91842025, "body": "Please check if you have libpq.dll file in the path c:\\program files\\postgresql\\YOUR_VERSION\\bin\\"}, {"owner": {"reputation": 1, "user_id": 10280371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ubBiTCQFqCQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO1YjdcUfJp9QTVQK8Ub0EAPzq9Rg/mo/photo.jpg?sz=128", "display_name": "kimor", "link": "https://stackoverflow.com/users/10280371/kimor"}, "edited": false, "score": 0, "creation_date": 1537612225, "post_id": 52392241, "comment_id": 91853922, "body": "<a href=\"https://www.enterprisedb.com/downloads/postgres-postgresql-downloads\" rel=\"nofollow noreferrer\">enterprisedb.com/downloads/postgres-postgresql-downloads</a> - the source from where i downloaded and installed postgres. Yes i do have libpq.dll in bin folder."}], "tags": [], "owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "is_accepted": false, "score": 0, "last_activity_date": 1537460005, "last_edit_date": 1537460005, "creation_date": 1537293622, "answer_id": 52392241, "question_id": 52391287, "link": "https://stackoverflow.com/questions/52391287/using-postgres-as-default-in-rails/52392241#52392241", "title": "Using postgres as default in rails", "body": "<p>Have you installed postgres package in your system You can install in linux using command</p>\n\n<pre><code>sudo apt-get install postgresql postgresql-contrib\n</code></pre>\n\n<p>if you are using debian system</p>\n\n<p>The error clearly states that that you need to install development tools so you may have likely missed installing some dependencies</p>\n\n<p>You can install through command line utitlities using the commands</p>\n\n<pre><code>     @powershell -NoProfile -ExecutionPolicy unrestricted -Command \"iex ((new-object net.webclient).DownloadString('https://s3.amazonaws.com/pgcentral/install.ps1'))\"\n     cd bigsql\n     pgc install pg10\n     pgc start pg10\n</code></pre>\n\n<p>Please follow this <a href=\"https://www.youtube.com/watch?v=rOdxApL0Fhc\" rel=\"nofollow noreferrer\">link</a> to configure postgress in windows</p>\n\n<p>To install postgres client, please refer to <a href=\"https://stackoverflow.com/questions/33854798/how-do-i-install-just-the-client-tools-for-postgresql-on-windows\">this</a> stackoverflow link and also try to install pg gem by specifying the path of pgconfig file you can refer to this \n<a href=\"https://stackoverflow.com/questions/52339221/rails-gem-error-while-installing-pg-1-1-3-and-bundler-cannot-continue/52342295#52342295\">link</a> for example</p>\n"}], "owner": {"reputation": 1, "user_id": 10280371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ubBiTCQFqCQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO1YjdcUfJp9QTVQK8Ub0EAPzq9Rg/mo/photo.jpg?sz=128", "display_name": "kimor", "link": "https://stackoverflow.com/users/10280371/kimor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537460005, "creation_date": 1537289427, "question_id": 52391287, "link": "https://stackoverflow.com/questions/52391287/using-postgres-as-default-in-rails", "title": "Using postgres as default in rails", "body": "<p>I'm a newbie in ruby and rails development. I know that rails uses sqlite3 as default, so I want to try using postgres as defalut. I've downloaded postgres, jruby, ruby 2.5.1, rails 5.2.1. I've intalled ruby devkit with ruby dk.rb init/install. I'm stumbled into the wall when I try to install pg gem, I get the following output:</p>\n\n<pre><code>Building native extensions.  This could take a while...\nC:/jruby-9.1.17.0/lib/ruby/stdlib/rubygems/ext/ext_conf_builder.rb:58: warning: Tempfile#unlink or delete called on open file; ignoring\nERROR:  Error installing pg:\n        ERROR: Failed to build gem native extension.\n    current directory: C:/jruby-9.1.17.0/lib/ruby/gems/shared/gems/pg-1.1.3/ext\nC:/jruby-9.1.17.0/bin/jruby.exe -r ./siteconf20180918-6200-16mdyzt.rb extconf.rb\nchecking for pg_config... yes\nUsing config values from C:\\postgres\\bin/pg_config.exe\nRuntimeError: The compiler failed to generate an executable file.\nYou have to install development tools first.\n\n     try_do at C:/jruby-9.1.17.0/lib/ruby/stdlib/mkmf.rb:456\n  try_link0 at C:/jruby-9.1.17.0/lib/ruby/stdlib/mkmf.rb:541\n   try_link at C:/jruby-9.1.17.0/lib/ruby/stdlib/mkmf.rb:556\n     &lt;main&gt; at extconf.rb:40\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/jruby-9.1.17.0/bin/jruby\n        --with-pg\n        --without-pg\n        --enable-windows-cross\n        --disable-windows-cross\n        --with-pg-config\n        --without-pg-config\n        --with-pg_config\n        --without-pg_config\n        --with-pg-dir\n        --without-pg-dir\n        --with-pg-include\n        --without-pg-include=${pg-dir}/include\n        --with-pg-lib\n        --without-pg-lib=${pg-dir}/lib\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n  C:/jruby-9.1.17.0/lib/ruby/gems/shared/extensions/universal-java-1.8/2.3.0/pg-1.1.3/mkmf.log\nextconf failed, exit code 1\nGem files will remain installed in C:/jruby-9.1.17.0/lib/ruby/gems/shared/gems/pg-1.1.3 for inspection.\nResults logged to C:/jruby-9.1.17.0/lib/ruby/gems/shared/extensions/universal-java-1.8/2.3.0/pg-1.1.3/gem_make.out\n</code></pre>\n\n<p>mkmf.log contains:</p>\n\n<pre><code>find_executable: checking for pg_config... -------------------- yes\n\n--------------------\n\n\" -o conftest.exe -I/include/universal-java1.8 -IC:/jruby-9.1.17.0/lib/ruby/include/ruby/backward -IC:/jruby-9.1.17.0/lib/ruby/include -I. -IC:/postgres/include     -fno-omit-frame-pointer -fno-strict-aliasing  -fexceptions  conftest.c  -L. -LC:/jruby-9.1.17.0/lib -LC:/postgres/lib  -LC:/jruby-9.1.17.0/lib/native/x86_64-Windows   -m64 -march=native -mtune=native      \"\nchecked program was:\n/* begin */\n1: #include \"ruby.h\"\n2: \n3: #include &lt;ruby.h&gt;\n4: int main(int argc, char **argv)\n5: {\n6:   return 0;\n7: }\n/* end */\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "model", "nested-attributes"], "comments": [{"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1537289407, "post_id": 52390997, "comment_id": 91727612, "body": "Is there a separate Message link for each conversation?  Or just one for all conversations?"}, {"owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "edited": false, "score": 0, "creation_date": 1537289802, "post_id": 52390997, "comment_id": 91727780, "body": "I guess you need to loop through each conversation. &quot;conversations.all.messages&quot; won&#39;t work as &quot;conversations.all&quot; would return an active relation object. ( On a side note using &quot;all&quot; should be avoided if there are many conversations. It will load all the conversations into memory causing high memory usage )"}], "answers": [{"comments": [{"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1537289420, "post_id": 52391187, "comment_id": 91727615, "body": "I don&#39;t think this will meet OP&#39;s intention.  If conversation 1 last message is from someone else and is unread but conversation 2 last message is from himself, he won&#39;t know there&#39;s a conversation where he hasn&#39;t seen the latest messages."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1537289653, "post_id": 52391187, "comment_id": 91727715, "body": "@SteveTurczyn, that&#39;s why I asked what is he trying to do with the line with invalid syntax, I was just clarifying why the syntax is wrong and a few ways to fix that but it was not clear for me what was his intention"}, {"owner": {"reputation": 43, "user_id": 8552077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149dbe6e43cb8bba880bf28f32d60bb4?s=128&d=identicon&r=PG&f=1", "display_name": "GabrielTheCoder", "link": "https://stackoverflow.com/users/8552077/gabrielthecoder"}, "edited": false, "score": 0, "creation_date": 1537290243, "post_id": 52391187, "comment_id": 91727983, "body": "Thanks for the fast response. SteveTurczyn is right. The line with \u201e.content\u201c was just to gibe an example that the one is working and the other is not. Instead ive should have wrote \u201e.read\u201c. I want to check if any of the messages of a conversation the current user is involved with, he is not the author of is read or not to display a hint that there is a new message. But since its in a partial im not able to access the \u201e.read\u201c boolean-values easily."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 43, "user_id": 8552077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149dbe6e43cb8bba880bf28f32d60bb4?s=128&d=identicon&r=PG&f=1", "display_name": "GabrielTheCoder", "link": "https://stackoverflow.com/users/8552077/gabrielthecoder"}, "edited": false, "score": 0, "creation_date": 1537292474, "post_id": 52391187, "comment_id": 91728933, "body": "@GabrielTheCoder, check my edit, with the <code>has_many :through</code> association you can query the messages to know if there&#39;s any message from a user other than current_user which is read=false."}, {"owner": {"reputation": 43, "user_id": 8552077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149dbe6e43cb8bba880bf28f32d60bb4?s=128&d=identicon&r=PG&f=1", "display_name": "GabrielTheCoder", "link": "https://stackoverflow.com/users/8552077/gabrielthecoder"}, "edited": false, "score": 0, "creation_date": 1537302524, "post_id": 52391187, "comment_id": 91733416, "body": "@arieljuod that fixed a bit of the headache, thanks for this. but now i have to iterate through the messages without displaying them. ill write some more tomorrow if my brain is cleared"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 43, "user_id": 8552077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149dbe6e43cb8bba880bf28f32d60bb4?s=128&d=identicon&r=PG&f=1", "display_name": "GabrielTheCoder", "link": "https://stackoverflow.com/users/8552077/gabrielthecoder"}, "edited": false, "score": 0, "creation_date": 1537303823, "post_id": 52391187, "comment_id": 91733933, "body": "@GabrielTheCoder why do you say you have to iterate through all the messages? <code>.any?</code> and <code>.count</code> are just one count database query, it does not iterate over them, not sure all the context though"}, {"owner": {"reputation": 43, "user_id": 8552077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149dbe6e43cb8bba880bf28f32d60bb4?s=128&d=identicon&r=PG&f=1", "display_name": "GabrielTheCoder", "link": "https://stackoverflow.com/users/8552077/gabrielthecoder"}, "edited": false, "score": 0, "creation_date": 1537304257, "post_id": 52391187, "comment_id": 91734081, "body": "@arieljuod my attempt is to iterate through every message of the current user and if there is a message with <code>.read == false</code> which the user is not the author of, it should display one highlighted link, if i try <code>.each do</code>, then rails is displaying this highlighted link as often as there is a message.. can you understand me ? :S also if i use <code>.any?</code> or <code>.count</code> i cant ask rails for certain attributes like &quot;count every message WHICH is not read yet.&quot;"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 43, "user_id": 8552077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149dbe6e43cb8bba880bf28f32d60bb4?s=128&d=identicon&r=PG&f=1", "display_name": "GabrielTheCoder", "link": "https://stackoverflow.com/users/8552077/gabrielthecoder"}, "edited": false, "score": 0, "creation_date": 1537304734, "post_id": 52391187, "comment_id": 91734263, "body": "@GabrielTheCoder but that&#39;s the <code>.where(read: false)</code> for, the quary already counts only messages with &quot;read = false&quot;, and with &quot;user_id != current_user.id&quot; by doing <code>where.not(user_id: current_user.id)</code>. <code>count</code> applies for the whole query, it does count only unread messages"}, {"owner": {"reputation": 43, "user_id": 8552077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149dbe6e43cb8bba880bf28f32d60bb4?s=128&d=identicon&r=PG&f=1", "display_name": "GabrielTheCoder", "link": "https://stackoverflow.com/users/8552077/gabrielthecoder"}, "edited": false, "score": 0, "creation_date": 1537305195, "post_id": 52391187, "comment_id": 91734443, "body": "@arieljoud ye i forgot one really big point. my fault :S if a user is sending multiple messages, then only the last one seen will set to <code>read = true</code> after visiting. so the counter wont be exact and therefore trigger the &quot;not read&quot; highlight on the messages link. double text would break the whole mechanic. but thank you very much! that helped me, i just forgot this existed. now the only thing i have to do is to set every message that exist until now to true."}, {"owner": {"reputation": 43, "user_id": 8552077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149dbe6e43cb8bba880bf28f32d60bb4?s=128&d=identicon&r=PG&f=1", "display_name": "GabrielTheCoder", "link": "https://stackoverflow.com/users/8552077/gabrielthecoder"}, "edited": false, "score": 0, "creation_date": 1537305525, "post_id": 52391187, "comment_id": 91734551, "body": "@arieljuod okay i got it to work by myself. THANK YOU for your incredible patience and help. i havent thought, that anyone would help me out with this so fast :D thank you very very much :)"}], "tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 1, "last_activity_date": 1537292400, "last_edit_date": 1537292400, "creation_date": 1537289084, "answer_id": 52391187, "question_id": 52390997, "link": "https://stackoverflow.com/questions/52390997/ruby-on-rails-accessing-nested-attributes-of-current-user/52391187#52391187", "title": "Ruby on Rails - accessing nested attributes of current user", "body": "<p>What are you trying to do with <code>current_user.conversations.all.messages.last.content</code>? because <code>conversations.all</code> is an association, it is NOT a Conversation, so <code>messages</code> is not an available method. <code>Conversation.last</code> IS a Conversation, that's why you can call <code>messages</code> on it.</p>\n\n<p>You can try <code>current_user.conversations.last.messages.last.content</code> to get the last message of the last conversation, or, you can use a \"has_many :through\" relationship on User</p>\n\n<pre><code>class User ...\n  has_many :conversations\n  has_many :messages, through: :conversations\nend\n</code></pre>\n\n<p>That way you can do <code>current_user.messages</code> if you want ALL user's messages and <code>current_user.messages.last</code> to get the last Message (even if it's not from the last conversation).</p>\n\n<p>I'd recommend you to read the Rails Guide about Associations <a href=\"https://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/association_basics.html#the-has-many-through-association</a></p>\n\n<p>EDIT: To know if the user has some unread message, you can use the <code>has_many :through</code> association and do something like</p>\n\n<pre><code>current_user.messages.where(read: false).where.not(user_id: current_user.id).any?\n</code></pre>\n\n<p>That will return <code>true</code> any message from the user's conversations with id != current_user.id is not read. And <code>false</code> otherwise.</p>\n\n<p>You can use <code>count</code> instead of <code>any?</code> if you wan't to know the actual number of unread messages.</p>\n"}], "owner": {"reputation": 43, "user_id": 8552077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149dbe6e43cb8bba880bf28f32d60bb4?s=128&d=identicon&r=PG&f=1", "display_name": "GabrielTheCoder", "link": "https://stackoverflow.com/users/8552077/gabrielthecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537292400, "creation_date": 1537288211, "question_id": 52390997, "link": "https://stackoverflow.com/questions/52390997/ruby-on-rails-accessing-nested-attributes-of-current-user", "title": "Ruby on Rails - accessing nested attributes of current user", "body": "<p>i am trying to access some nested attributes in a rails partial; let me explain my issue:</p>\n\n<p>i wrote a simple messaging service according to the tutorial of dana mulder i mentioned in another question of mine. a <code>user</code> has_many <code>conversations</code>, and a <code>conversation</code> has_many <code>messages</code>. every conversation has a recipient and a sender and every message has a boolean <code>read</code>, which is set to <code>false</code> by default. </p>\n\n<p>what i am trying to do is to write a simple function that iterates through every message a user got in a conversation he is involved in, checks if the last message a user recieved in a conversation is read == true and <strong>not</strong> send by himself to display a little knob beside the \"messages\" link in the navigation of my app.</p>\n\n<p>What i basically want to check is (multiple lines for better readability):</p>\n\n<pre><code>&lt;%= if current_user.conversations.all.messages.last.user_id != current_user.id &amp;&amp; current_user.conversations.all.messages.last.read == false %&gt;\n\n    Message link with bubble beside it\n\n&lt;% else %&gt;\n\n    Message link\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>This syntax does not work ..\nHow is it possible to iterate through every conversation a user is involved, check the last message of every conversation if its written by this user and if not if its already read? </p>\n\n<p>while something like <code>Conversation.last.messages.last.content</code> is working, \n<code>current_user.conversations.all.messages.last.content</code> is not.. i find it a bit confusing how the accessibility of rails models are working.</p>\n\n<p>thanks in advance! i hope i was explaining me well enough.</p>\n\n<p>Best Regards</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537287701, "post_id": 52390761, "comment_id": 91726738, "body": "How about you try something like this ? <code>MyEngine::Engine.routes.default_scope = { path: &quot;(:locale)&quot;, locale: &#47;en&#47; }</code> <code>mount MyEngine::Engine =&gt; &#39;&#47;&#39;</code>"}, {"owner": {"reputation": 13, "user_id": 5634055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b216c10681863f61f13e85df88ac60dc?s=128&d=identicon&r=PG", "display_name": "Alberto Sabaini", "link": "https://stackoverflow.com/users/5634055/alberto-sabaini"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537350019, "post_id": 52390761, "comment_id": 91749256, "body": "Thank you for your reply. By using your suggestion I get a routing error: Uninitialized constant \u201cController Name\u201d. It seems it can&#39;t find any controller in the mounted engine"}], "owner": {"reputation": 13, "user_id": 5634055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b216c10681863f61f13e85df88ac60dc?s=128&d=identicon&r=PG", "display_name": "Alberto Sabaini", "link": "https://stackoverflow.com/users/5634055/alberto-sabaini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537287394, "creation_date": 1537287394, "question_id": 52390761, "link": "https://stackoverflow.com/questions/52390761/rails-5-route-locale-in-mainapp-and-mounted-engine", "title": "rails 5 route locale in mainapp and mounted engine", "body": "<p>I'm build a rails 5 application and I configured the locale like so</p>\n\n<pre><code># config/routes.rb\nscope '/:locale' do\n  resources :organizations, except: [:delete] do\n    get 'settings'\n    mount MyEngine::Engine =&gt; '/', as: :myengine\n    end\n    IchE2bR3::Engine.routes.draw do\n    end\nend\n</code></pre>\n\n<p>Unfortunately, MyEngine routes also have the scope for locale. </p>\n\n<pre><code>MyEngine::Engine.routes.draw do\n  scope '/:locale' do\n  end\nend\n</code></pre>\n\n<p>Right now my URLs look like these</p>\n\n<pre><code>www.example.org\nwww.example.org/en/organizations/1/settings\nwww.example.org/en/organizations/1/en/myenginepath\n</code></pre>\n\n<p>As you can see in the third URL, en appears twice. Is there a way to mount engines and join/share the scope with the mainapp? Am I mounting the engine awkwardly/not in the right way?</p>\n\n<p>Thanks for the help</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1537287387, "post_id": 52390723, "comment_id": 91726571, "body": "Does the <code>.downvotes</code> value remain at zero in your database? What does your console output show?"}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537287443, "post_id": 52390723, "comment_id": 91726603, "body": "Also, what type has the downvotes_percentage database column?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10371906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/243f8a325c3378cf85cc8e1f5ae1a71b?s=128&d=identicon&r=PG&f=1", "display_name": "Luis V.F", "link": "https://stackoverflow.com/users/10371906/luis-v-f"}, "edited": false, "score": 0, "creation_date": 1537287661, "post_id": 52390772, "comment_id": 91726717, "body": "Worked perfectly. I&#39;m new to Ruby, didn&#39;t know this. Will accept as correct as soon as stack overflow will let me.  Thank you"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 33, "user_id": 10371906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/243f8a325c3378cf85cc8e1f5ae1a71b?s=128&d=identicon&r=PG&f=1", "display_name": "Luis V.F", "link": "https://stackoverflow.com/users/10371906/luis-v-f"}, "edited": false, "score": 0, "creation_date": 1537288235, "post_id": 52390772, "comment_id": 91727015, "body": "@LuisV.F This is not Ruby specific though. When calculating with integers you will get an <a href=\"http://ruby-doc.org/core-2.5.1/Integer.html\" rel=\"nofollow noreferrer\">integer</a> as result <code>3 &#47; 2 #=&gt; 1</code>. If one of the two values is a float the result will be a <a href=\"http://ruby-doc.org/core-2.5.1/Float.html\" rel=\"nofollow noreferrer\">float</a> <code>3.0 &#47; 2 #=&gt; 1.5</code>. If one of the two values is a rational you will get a <a href=\"http://ruby-doc.org/core-2.5.1/Rational.html\" rel=\"nofollow noreferrer\">rational</a> as result <code>3r &#47; 2 #=&gt; (3&#47;2)</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1537288352, "post_id": 52390772, "comment_id": 91727076, "body": "@JohanWentholt this <i>is</i> language-specific, though. For example, python 2 and 3 handle this differently."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1537289695, "post_id": 52390772, "comment_id": 91727736, "body": "@SergioTulentsev I agree with you that it is language specific, however that&#39;s not what I&#39;m saying. You will encounter the same behaviour in Java, C, C# and other languages."}], "tags": [], "owner": {"reputation": 3465, "user_id": 5946118, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/CbjEl.jpg?s=128&g=1", "display_name": "Rajkaran Mishra", "link": "https://stackoverflow.com/users/5946118/rajkaran-mishra"}, "is_accepted": true, "score": 1, "last_activity_date": 1537287789, "last_edit_date": 1537287789, "creation_date": 1537287432, "answer_id": 52390772, "question_id": 52390723, "link": "https://stackoverflow.com/questions/52390723/ror-class-method-not-taking-effect/52390772#52390772", "title": "RoR: Class method not taking effect", "body": "<p>Try <a href=\"https://ruby-doc.org/core-2.2.0/Float.html#method-i-to_f\" rel=\"nofollow noreferrer\">to_f</a>:</p>\n\n<pre><code>votes = (self.downvotes + self.upvotes).to_f\nself.downvotes_percentage = self.downvotes / votes\nself.upvotes_percentage = self.upvotes / votes\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10371906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/243f8a325c3378cf85cc8e1f5ae1a71b?s=128&d=identicon&r=PG&f=1", "display_name": "Luis V.F", "link": "https://stackoverflow.com/users/10371906/luis-v-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1537287994, "accepted_answer_id": 52390772, "answer_count": 1, "score": 0, "last_activity_date": 1537287789, "creation_date": 1537287235, "question_id": 52390723, "link": "https://stackoverflow.com/questions/52390723/ror-class-method-not-taking-effect", "closed_reason": "Duplicate", "title": "RoR: Class method not taking effect", "body": "<p>My api has Posts. Each post has a number of upvotes and downvotes. \nI wish to update the percentage of upvotes and downvotes each time an upvote/downvote is made.</p>\n\n<p>In my VotesController I have:</p>\n\n<pre><code>#PUT /downvote/:id\ndef downvote\n    @post = Post.find(params[:id])\n    @post.downvotes = @post.downvotes + 1\n    @post.recalculate_percentages()\n    @post.save\n    render json:@post\nend\n</code></pre>\n\n<p>In my Post model I have a method that refreshes these values:</p>\n\n<pre><code>def recalculate_percentages\n    self.downvotes_percentage = self.downvotes / (self.downvotes + self.upvotes)\n    self.upvotes_percentage = self.upvotes / (self.downvotes + self.upvotes)\nend\n</code></pre>\n\n<p>Why are these changes not having any effect. In the rendered JSON the values for the percentages remain at 0.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "vimeo", "vimeo-api"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537285664, "post_id": 52390243, "comment_id": 91725555, "body": "The <a href=\"https://github.com/thibaudgg/video_info/blob/68917647ee41dc2766952b2865bf45ec9fb5b826/lib/video_info/provider.rb#L82\" rel=\"nofollow noreferrer\">method</a> that is causing the error. I guess there is some problem while reading the uri. Line #105 <code>JSON.load(uri.read)</code>. Why don&#39;t you try overriding the method ?"}, {"owner": {"reputation": 764, "user_id": 552941, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HYsSP.jpg?s=128&g=1", "display_name": "Fernando Aureliano", "link": "https://stackoverflow.com/users/552941/fernando-aureliano"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537286260, "post_id": 52390243, "comment_id": 91725984, "body": "Thanks by help. Do you know any solution or alternative?"}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537286279, "post_id": 52390243, "comment_id": 91725999, "body": "The error basically means that the http request failed, but it is not very specific about why exactly. The link @KedarnagMukanahallipatna posted, shows that in case of a 400 http code, a message is written to log suggesting the api key is invalid. Did you check if that message appears in your log before the error? Otherwise I aggree, you could override the method for debugging, so you find more information about why (how) the request failed."}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537286407, "post_id": 52390243, "comment_id": 91726077, "body": "If everything else looks good, it is quite likely that your api key is not valid. I am not sure what vimeos client identifier is, but here are instructions for retrieving an api key: <a href=\"https://developer.vimeo.com/api/start\" rel=\"nofollow noreferrer\">developer.vimeo.com/api/start</a>"}, {"owner": {"reputation": 764, "user_id": 552941, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HYsSP.jpg?s=128&g=1", "display_name": "Fernando Aureliano", "link": "https://stackoverflow.com/users/552941/fernando-aureliano"}, "edited": false, "score": 0, "creation_date": 1537286659, "post_id": 52390243, "comment_id": 91726217, "body": "I&#39;ve tested the autorization with <a href=\"https://developer.vimeo.com/api/playground/oauth/verify\" rel=\"nofollow noreferrer\">developer.vimeo.com/api/playground/oauth/verify</a> Vimeo the name cliend_id as api_key"}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537286818, "post_id": 52390243, "comment_id": 91726303, "body": "Have you tried using their <code>API&#39;s</code> instead of the <code>gem</code> ? Looking at their documentation, they have detailed endpoints."}], "owner": {"reputation": 764, "user_id": 552941, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HYsSP.jpg?s=128&g=1", "display_name": "Fernando Aureliano", "link": "https://stackoverflow.com/users/552941/fernando-aureliano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537285417, "creation_date": 1537285417, "question_id": 52390243, "link": "https://stackoverflow.com/questions/52390243/rails-5-unexpected-network-error-while-fetching-information-about-the-video", "title": "Rails 5: unexpected network error while fetching information about the video", "body": "<p>I'm using <a href=\"https://github.com/thibaudgg/video_info\" rel=\"nofollow noreferrer\">video_info</a> gem to get informations about the vimeo videos. The account is private, the domain is declared on panel to load the videos. I have an initializer with the <code>VideoInfo.provider_api_keys</code>, just this line. From vimeo I use the <strong>cliente identifier</strong> as api key, I think it is ok.</p>\n\n<p>The problem is, when I tried to retrieve information about the video I get the error</p>\n\n<blockquote>\n  <p>unexpected network error while\n              fetching information about the video</p>\n</blockquote>\n\n<p><strong>initializers/vimeo_api.rb</strong></p>\n\n<pre><code>VideoInfo.provider_api_keys = { vimeo: 'xxxxxxxxxxxxxxxxxxxxxxxx' }\n</code></pre>\n\n<p>Someone got this error before?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 2, "creation_date": 1537283584, "post_id": 52389626, "comment_id": 91724312, "body": "<code>FIXED_COUNTRY_TO_PHONE[key] || FIXED_COUNTRY_TO_PHONE[&#39;*&#39;]</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537300302, "post_id": 52389626, "comment_id": 91732522, "body": "Your last sentence is confusing. I suggest something like, &quot;I would like <code>FIXED_COUNTRY_TO_PHONE[k]</code> to return a specified &quot;default value&quot; (say, <code>1234567&#39;</code>) if the hash does not have a key equal to <code>k</code>? How can I do that?"}], "answers": [{"comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1537284270, "post_id": 52389780, "comment_id": 91724770, "body": "Good one, since <code>FIXED_COUNTRY_TO_PHONE</code> is freezed"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537295549, "post_id": 52389780, "comment_id": 91730382, "body": "Almost as nice as your eyeglasses. Is <code>DEFAULT = &quot;1234567&quot;.freeze</code> different than <code>DEFAULT = &quot;1234567&quot;</code>? In both cases  the value of <code>DEFAULT</code> can be changed, in which case the same warning message is issued."}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537341964, "post_id": 52389780, "comment_id": 91744632, "body": "@CarySwoveland you can&#39;t modify frozen objects in Ruby. <code>DEFAULT = &quot;1234567&quot;.freeze</code> and <code>DEFAULT = &quot;1234567&quot;</code> are different in a way that for instance these operations won&#39;t work with frozen one: <code>DEFAULT[0] = &quot;9&quot;</code> <code>DEFAULT &lt;&lt; &quot;890&quot;</code> etc. You can&#39;t &quot;mutate&quot; frozen object. But you can reassign any variable of course. So you can reassign <code>DEFAULT</code> even if its value is frozen. Does it make sense?"}], "tags": [], "owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "is_accepted": false, "score": 4, "last_activity_date": 1537283735, "creation_date": 1537283735, "answer_id": 52389780, "question_id": 52389626, "link": "https://stackoverflow.com/questions/52389626/match-value-if-other-are-not-matched/52389780#52389780", "title": "Match value if other are not matched", "body": "<pre><code>FIXED_COUNTRY_TO_PHONE = Hash.new('1234567').merge({ \n    'FI' =&gt; '+358501111',\n    'RU' =&gt; '4019900780', \n    'SE' =&gt; '+4672345678',\n    'UA' =&gt; '0123456789',\n    'KZ' =&gt; '0123456789'  \n  }).freeze\n</code></pre>\n\n<p>But simple </p>\n\n<pre><code>DEFAULT = \"1234567\".freeze\nFIXED_COUNTRY_TO_PHONE[\"FI\"] || DEFAULT\n#=&gt; \"+358501111\"\nFIXED_COUNTRY_TO_PHONE[\"??\"] || DEFAULT\n#=&gt; \"1234567\"\n</code></pre>\n\n<p>Looks also nice</p>\n"}, {"comments": [{"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 1, "creation_date": 1537283945, "post_id": 52389824, "comment_id": 91724557, "body": "hm, <code>default</code>, nice"}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "edited": false, "score": 1, "creation_date": 1537284075, "post_id": 52389824, "comment_id": 91724633, "body": "Yes, but I get `default=&#39;: can&#39;t modify frozen Hash (RuntimeError)"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 1, "creation_date": 1537284750, "post_id": 52389824, "comment_id": 91725037, "body": "just add <code>hash.freeze</code> after setting default. I mean first set default, and freeze after."}], "tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": false, "score": 4, "last_activity_date": 1537283866, "creation_date": 1537283866, "answer_id": 52389824, "question_id": 52389626, "link": "https://stackoverflow.com/questions/52389626/match-value-if-other-are-not-matched/52389824#52389824", "title": "Match value if other are not matched", "body": "<p>You can use <code>Hash#default=</code> to set the default value:</p>\n\n<pre><code>hash =  {\n    'FI' =&gt; '+358501111',\n    'RU' =&gt; '4019900780', \n    'SE' =&gt; '+4672345678',\n    'UA' =&gt; '0123456789',\n    'KZ' =&gt; '0123456789'  \n  }\nhash.default = '1234567'\nhash['UK']\n#=&gt; '1234567'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1537301097, "last_edit_date": 1537301097, "creation_date": 1537298906, "answer_id": 52393405, "question_id": 52389626, "link": "https://stackoverflow.com/questions/52389626/match-value-if-other-are-not-matched/52393405#52393405", "title": "Match value if other are not matched", "body": "<p>There are two main ways of dealing with this problem. @llya assigns a default value to the hash, @fl00r applies the default when the hash is evaluated for a non-existing key, causing <code>nil</code> to be returned.</p>\n\n<p>llya shows one way of implementing the default value. It is very clear but uses a few lines of code. Two other ways of doing that deserve mention (though I am not suggesting they are in any sense better than how llya has done it).</p>\n\n<p><em>Set the default then add the key-value pairs:</em> </p>\n\n<pre><code>hash = Hash.new('1234567').\n            merge('FI'=&gt;'+358501111', 'RU'=&gt;'4019900780', 'SE'=&gt;'+4672345678',\n                  'UA'=&gt;'0123456789', 'KZ'=&gt;'0123456789').      \n            freeze\n\nhash['oh, my']\n  #=&gt; \"1234567\"\n</code></pre>\n\n<p><em>Use <a href=\"http://ruby-doc.org/core-2.5.1/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">Object#tap</a></em></p>\n\n<pre><code>hash = { 'FI'=&gt;'+358501111', 'RU'=&gt;'4019900780', 'SE'=&gt;'+4672345678',\n         'UA'=&gt;'0123456789', 'KZ'=&gt;'0123456789'\n       }.tap { |h| h.default = '1234567' }.\n         freeze\n\nhash['oh, my']\n  #=&gt; \"1234567\"\n</code></pre>\n\n<p>A variantof <code>fl00r</code>'s <code>|| DEFALULT</code> approach, which arguably reads better, is to use <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-fetch\" rel=\"nofollow noreferrer\">Hash#fetch</a>:</p>\n\n<pre><code>hash = { 'FI'=&gt;'+358501111', 'RU'=&gt;'4019900780', 'SE'=&gt;'+4672345678',\n         'UA'=&gt;'0123456789', 'KZ'=&gt;'0123456789' }\n\nDEFAULT = \"1234567\"\n\nhash.fetch('oh, my', DEFAULT)\n  #=&gt; \"1234567\"\n</code></pre>\n\n<p><code>hash[key] || DEFAULT</code> clearly cannot be used if <code>hash</code> has a key whose value may be <code>nil</code> or <code>false</code>, though that is not an issue here.</p>\n\n<p>Both approaches have pros and cons. Setting a default value avoids the need for the retrieval of values (which may be done in multiple places) to be concerned about whether the hash contains a particular key, but on the other hand readers of those parts of the code may not be aware (or have forgotten) that the hash was defined with a default value.  If the <code>|| DEFAULT</code> approach is used there is the possibility that the coder may forget to include <code>|| DEFAULT</code> in one or more places where the hash is referenced. In terms of code maintenance I would think it's a toss-up, provided the constant <code>DEFAULT</code> is defined in close proximity to the hash, and commented suitably.</p>\n\n<p>It seems to me that it's generally best to use a default value, and wherever the hash is referenced remind readers that it has a default value, either with a comment or a suggestive name for the hash (e.g., <code>applies_to_oranges_with_default</code>).</p>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1537301097, "creation_date": 1537283245, "question_id": 52389626, "link": "https://stackoverflow.com/questions/52389626/match-value-if-other-are-not-matched", "title": "Match value if other are not matched", "body": "<p>I have this Ruby map:</p>\n\n<pre><code>FIXED_COUNTRY_TO_PHONE = { \n    'FI' =&gt; '+358501111',\n    'RU' =&gt; '4019900780', \n    'SE' =&gt; '+4672345678',\n    'UA' =&gt; '0123456789',\n    'KZ' =&gt; '0123456789'  \n  }.freeze\n</code></pre>\n\n<p>How I can set some final value for example <code>'*' =&gt; '1234567'</code> if the other values are not matching?</p>\n"}, {"tags": ["ruby", "logging", "logstash"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1537276003, "post_id": 52387185, "comment_id": 91719031, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43356736/argumenterror-invalid-strptime-format-m-d-y-work-around\">ArgumentError: invalid strptime format - `%m/%d/%y&#39; work around</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 740394, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/796442b522b037319711277a81d775ca?s=128&d=identicon&r=PG", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/740394/rodrigo"}, "is_accepted": true, "score": 4, "last_activity_date": 1537276026, "creation_date": 1537276026, "answer_id": 52387319, "question_id": 52387185, "link": "https://stackoverflow.com/questions/52387185/convert-string-to-date-object-ruby/52387319#52387319", "title": "Convert String to Date Object Ruby", "body": "<p>remove the <code>9</code>, <code>%N</code> expects 9 digits bt default</p>\n\n<pre><code>Time.strptime('2018-09-18 11:42:50,286000201, '%Y-%m-%d %H:%M:%S,%N')\n</code></pre>\n\n<p>doc: <a href=\"http://ruby-doc.org/stdlib-2.1.1/libdoc/time/rdoc/Time.html#method-c-strptime\" rel=\"nofollow noreferrer\">http://ruby-doc.org/stdlib-2.1.1/libdoc/time/rdoc/Time.html#method-c-strptime</a></p>\n"}], "owner": {"reputation": 224, "user_id": 4051417, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-dv8ARvMLRtE/AAAAAAAAAAI/AAAAAAAAANM/rVwTUuUwVXw/photo.jpg?sz=128", "display_name": "Saram ali", "link": "https://stackoverflow.com/users/4051417/saram-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 52387319, "answer_count": 1, "score": 1, "last_activity_date": 1537276026, "creation_date": 1537275588, "question_id": 52387185, "link": "https://stackoverflow.com/questions/52387185/convert-string-to-date-object-ruby", "title": "Convert String to Date Object Ruby", "body": "<p>I'm trying to comvert a string in my logs to a date object. </p>\n\n<p>My string is <code>2018-09-18 11:42:50,286000201</code> which is the format <code>YYYY-MM-DD hh:mm:ss,nnnnnnnnn</code>\nI'm trying to convert in to an object using the time library in ruby. The function I am using is <code>Time.strptime('2018-09-18 11:42:50,286000201, '%Y-%m-%d %H:%M:%S,%9N')</code></p>\n\n<p>Ruby is giving me an invalid striptime format. Any help would be appreciated. Cheers. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1537276824, "post_id": 52387146, "comment_id": 91719625, "body": "Possible a duplicate of <a href=\"https://stackoverflow.com/questions/13424178/how-is-the-config-symbol-resolved-in-environments-rb\" title=\"how is the config symbol resolved in environments rb\">stackoverflow.com/questions/13424178/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 740394, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/796442b522b037319711277a81d775ca?s=128&d=identicon&r=PG", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/740394/rodrigo"}, "is_accepted": true, "score": 2, "last_activity_date": 1537275714, "creation_date": 1537275714, "answer_id": 52387226, "question_id": 52387146, "link": "https://stackoverflow.com/questions/52387146/rails-config-environments-where-is-config-defined/52387226#52387226", "title": "rails config/environments where is &#39;config&#39; defined?", "body": "<p>These classes include the <code>ActiveSupport::Configurable</code> module:</p>\n\n<p><a href=\"https://api.rubyonrails.org/classes/ActiveSupport/Configurable.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveSupport/Configurable.html</a></p>\n\n<p>Here is an alternative to implementing this behavior by yourself:</p>\n\n<p><a href=\"https://robots.thoughtbot.com/mygem-configure-block\" rel=\"nofollow noreferrer\">https://robots.thoughtbot.com/mygem-configure-block</a></p>\n"}], "owner": {"reputation": 12442, "user_id": 849697, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0c91f58ffa7bbf4151cae13b5c8b9ccd?s=128&d=identicon&r=PG", "display_name": "xxjjnn", "link": "https://stackoverflow.com/users/849697/xxjjnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 52387226, "answer_count": 1, "score": 4, "last_activity_date": 1537275714, "creation_date": 1537275486, "question_id": 52387146, "link": "https://stackoverflow.com/questions/52387146/rails-config-environments-where-is-config-defined", "title": "rails config/environments where is &#39;config&#39; defined?", "body": "<p>In <code>config/environments/production.rb</code> (and the other environments) there is:</p>\n\n<pre><code>config.eager_load = true\n</code></pre>\n\n<p>and a whole bunch of other <code>config.foobar</code> calls. But where does 'config' come from? Usually you have something like:</p>\n\n<pre><code>SomeClass.each do | block_variable |\n  block_variable.some_method\nend\n</code></pre>\n\n<p>but in the case of the mystical 'config' this is not the case, its like a block variable which is not declared anywhere. Opening rails console, when I do:</p>\n\n<pre><code>irb(main):001:0&gt; config\nNameError: undefined local variable or method `config' for main:Object\nDid you mean?  conf\n        from (irb):1\nirb(main):002:0&gt;\n</code></pre>\n\n<p>and the same result occurs for <code>app.config</code></p>\n\n<pre><code>irb(main):002:0&gt; app.config\nNoMethodError: undefined method `config' for #&lt;ActionDispatch::Integration::Session:0x00007fc898d02808&gt;\n        from (irb):2\n</code></pre>\n\n<p>How is it possible for ruby to allow calls on 'config'?</p>\n"}, {"tags": ["ruby", "windows", "cmd", "guard", "asciidoctor"], "answers": [{"comments": [{"owner": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1537271892, "post_id": 52385965, "comment_id": 91716346, "body": "Thank you. I see, my question have a lot of downvotes, so I should note that I already knew that I can&#39;t  simply run <code>require</code> in command prompt. The actual question is that I can&#39;t understand what is the correct way to run this <code>require</code>. What exactly steps?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1537272037, "post_id": 52385965, "comment_id": 91716443, "body": "This is Ruby code. You need to run it in a Ruby interpreter."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1537272117, "post_id": 52385965, "comment_id": 91716488, "body": "Actually, to be more precise: this is a DSL for a Ruby gem called <code>guard</code>. You need to run it with Guard, because the <code>Kernel#guard</code> method is provided by the Guard gem, it is not part of the Ruby core library."}, {"owner": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1537272509, "post_id": 52385965, "comment_id": 91716754, "body": "<b>&quot;You need to run it in a Ruby interpreter&quot;</b> - well, I tried to launch <code>ruby.exe require  &#39;asciidoctor&#39;</code> in my Ruby directory, but it doesn&#39;t work. I assumed that ruby.exe is actually an interpreter, but probably it&#39;s not correct? <b>&quot;Actually, to be more precise...&quot;</b> - so, in simple words, I can&#39;t run Guard for AsciiDoctor without physically creating Guardfile?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1537272893, "post_id": 52385965, "comment_id": 91717004, "body": "Like almost all interpreters (including <code>CMD.EXE</code>), the Ruby interpreter takes its input from stdin, not as commandline arguments. I am not familiar enough with Guard to answer your question, you&#39;ll have to check the documentation."}, {"owner": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1537274142, "post_id": 52385965, "comment_id": 91717804, "body": "<b>&quot;Like almost all interpreters (including <code>CMD.EXE</code>), the Ruby interpreter takes its input from stdin, not as commandline arguments.</b> - Could you show the code, please? I mean, how to launch Ruby interpreter with <code>require</code> correctly parsed?"}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "reply_to_user": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1537289471, "post_id": 52385965, "comment_id": 91727636, "body": "@johnc.j. You might want to have a look at <a href=\"https://github.com/guard/guard/blob/master/README.md#usage\" rel=\"nofollow noreferrer\">the documentation of guard</a>"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 2, "last_activity_date": 1537271456, "creation_date": 1537271456, "answer_id": 52385965, "question_id": 52385757, "link": "https://stackoverflow.com/questions/52385757/ruby-on-windows-require-is-not-recognized-as-an-internal-or-external-command/52385965#52385965", "title": "Ruby on Windows: Require is not recognized as an internal or external command", "body": "<p>Ruby and DOS Batch are two completely different programming languages that have absolutely nothing to do with each other. You simply cannot expect an interpreter for DOS Batch to be able to run Ruby code and vice versa. (Especially considering that Ruby didn't even exist when <code>CMD.EXE</code> was written, so how could <code>CMD.EXE</code> possibly know how to interpret Ruby code?)</p>\n\n<p>You need to run Ruby code in a Ruby interpreter (or use a Ruby compiler to compile it to something that you have an interpreter for).</p>\n"}], "owner": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 52385965, "answer_count": 1, "score": -3, "last_activity_date": 1537271456, "creation_date": 1537270670, "question_id": 52385757, "link": "https://stackoverflow.com/questions/52385757/ruby-on-windows-require-is-not-recognized-as-an-internal-or-external-command", "title": "Ruby on Windows: Require is not recognized as an internal or external command", "body": "<p>I'm trying to use Guard to monitor changes in AsciiDoctor file. Here is <em>Guardfile</em> from official docs:</p>\n\n<pre><code>require 'asciidoctor'\n\nguard 'shell' do\n  watch(/^mydoc\\.adoc$/) {|m|\n    Asciidoctor.convert_file m[0]\n  }\nend\n</code></pre>\n\n<p>It works for me. But now, I'm trying to launch the same things without creating Guardfile - i.e. I want simply write these commands in Windows cmd.exe.</p>\n\n<p>But when I write <code>require 'asciidoctor'</code> command prompt gives me an error:</p>\n\n<blockquote>\n  <p>'require' is not recognized as an internal or external command, operable program or batch file.</p>\n</blockquote>\n\n<p>Well, I know that such error messages are often have something with Windows <code>%Path%</code> environment variable. But I don't understand how to fix it in this particular case.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "factory-bot", "rspec-rails"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1537274736, "post_id": 52385642, "comment_id": 91718199, "body": "You could <code>extend</code> the <code>FactoryBot</code> module e.g. <code>module FactoryBot; extend FactoryBotFirstOrCreate; end</code> then <code>FactoryBot.first_or_create</code> will work. However I do not guarantee the rest of the methods are accessible in that context (didn&#39;t really look into it at all)"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1537274752, "post_id": 52385642, "comment_id": 91718209, "body": "When running a spec why don&#39;t you know if a record exists or not? Why do you need this method. It feels to me like your specs do not run in isolation."}, {"owner": {"reputation": 1061, "user_id": 1651458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DQZz9.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1651458/sam"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1537276058, "post_id": 52385642, "comment_id": 91719064, "body": "Thanks @engineersmnky -- that worked. If you submit an answer, I&#39;ll gladly accept."}, {"owner": {"reputation": 313, "user_id": 4056267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1jA0.jpg?s=128&g=1", "display_name": "Dana Scheider", "link": "https://stackoverflow.com/users/4056267/dana-scheider"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1537545520, "post_id": 52385642, "comment_id": 91837513, "body": "@spickermann&#39;s comment is bang-on, too, I&#39;d take it into consideration."}], "answers": [{"tags": [], "owner": {"reputation": 1061, "user_id": 1651458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DQZz9.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1651458/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1557397909, "creation_date": 1557397909, "answer_id": 56057459, "question_id": 52385642, "link": "https://stackoverflow.com/questions/52385642/how-can-i-add-a-function-to-factorybot-globally/56057459#56057459", "title": "How can I add a function to FactoryBot globally?", "body": "<p>Per @engineersmnky, <code>extend</code>ing FactoryBot works</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module FactoryBot\n  extend FactoryBotFirstOrCreate\nend\n</code></pre>\n\n<p>then this works</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>my_foo = first_or_create(:everything, is: :awesome, if_we: :work_together)\n</code></pre>\n"}], "owner": {"reputation": 1061, "user_id": 1651458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DQZz9.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1651458/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "accepted_answer_id": 56057459, "answer_count": 1, "score": 1, "last_activity_date": 1557397909, "creation_date": 1537270318, "last_edit_date": 1537275868, "question_id": 52385642, "link": "https://stackoverflow.com/questions/52385642/how-can-i-add-a-function-to-factorybot-globally", "title": "How can I add a function to FactoryBot globally?", "body": "<p>I have a class that extends FactoryBot to include functionality to copy Rails' <code>.first_or_create</code>. </p>\n\n<pre><code>module FactoryBotFirstOrCreate\n  def first(type, args)\n    klass = type.to_s.camelize.constantize\n\n    conditions = args.first.is_a?(Symbol) ? args[1] : args[0]\n\n    if !conditions.empty? &amp;&amp; conditions.is_a?(Hash)\n      klass.where(conditions).first\n    end\n  end\n\n  def first_or_create(type, *args)\n    first(type, args) || create(type, *args)\n  end\n\n  def first_or_build(type, *args)\n    first(type, args) || build(type, *args)\n  end\nend\n</code></pre>\n\n<p>I can add that to the <code>SyntaxRunner</code> class </p>\n\n<pre><code>module FactoryBot\n  class SyntaxRunner\n    include FactoryBotFirstOrCreate\n  end\nend\n</code></pre>\n\n<p>to access it in factories</p>\n\n<pre><code># ...\nafter(:create) do |thing, evaluator|\n  first_or_create(:other_thing, thing: thing)\nend\n</code></pre>\n\n<p>But when I attempt to employ this outside of factories, I can't access it...</p>\n\n<ul>\n<li><code>FactoryBot::SyntaxRunner.first_or_create</code> or <code>FactoryBot.first_or_create</code> doesn't help</li>\n<li><code>include</code>ing it in the FactoryBot module doesn't help</li>\n<li><code>config.include</code> in <code>RSpec.configure</code> doesn't help</li>\n<li>I can't even access it directly <code>FactoryBot::SyntaxHelper.first_or_create</code></li>\n</ul>\n\n<p>With all of those steps in place, I still get <code>NoMethodError: undefined method first_or_create</code></p>\n\n<p>What can I include or otherwise configure to allow this method to be as accessible to me as FactoryGirl's <code>create</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "namespaces", "single-table-inheritance"], "answers": [{"tags": [], "owner": {"reputation": 12085, "user_id": 632688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c6e4e8117bbd27fd25e9e2ea350458?s=128&d=identicon&r=PG", "display_name": "Wizard of Ogz", "link": "https://stackoverflow.com/users/632688/wizard-of-ogz"}, "is_accepted": true, "score": 2, "last_activity_date": 1537282411, "last_edit_date": 1537282411, "creation_date": 1537282094, "answer_id": 52389243, "question_id": 52384983, "link": "https://stackoverflow.com/questions/52384983/rails-4-sti-with-namespace/52389243#52389243", "title": "Rails 4 - STI with namespace", "body": "<p>The behavior you described is caused by the lazy loading of your Rails models in development mode (eager loading is disabled by default for developent). Before you run <code>Another::Child.first</code> for the first time <code>Another::Child</code> has not yet been loaded.</p>\n\n<p>You can enable eager loading in all environments by adding <code>Rails.application.config.eager_load = true</code> to an initializer file.</p>\n\n<p>The reason to <em>not</em> use eager loading in development is because the app can (re)load much faster. However, I've run into many problems when eager loading is disabled, especially with STI models like you are using. It can become quite a headache to manage, and it can lead to bugs since the development environment behaves differently than the production environment. For those reasons I typically recommend setting <code>eager_load = true</code>.</p>\n"}], "owner": {"reputation": 135, "user_id": 2705941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45240d9f4697e99dbc4ff5b102cbc413?s=128&d=identicon&r=PG&f=1", "display_name": "Kuzunoha", "link": "https://stackoverflow.com/users/2705941/kuzunoha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 52389243, "answer_count": 1, "score": 0, "last_activity_date": 1537282411, "creation_date": 1537268113, "last_edit_date": 1537268707, "question_id": 52384983, "link": "https://stackoverflow.com/questions/52384983/rails-4-sti-with-namespace", "title": "Rails 4 - STI with namespace", "body": "<p>If I have 3 classes like below:</p>\n\n<pre><code>class Parent &lt; ActiveRecord::Base\nend\n\nclass Child &lt; Parent\nend\n\nclass Another::Child &lt; ::Child\nend\n</code></pre>\n\n<p>All those 3 classes are located in different folders.</p>\n\n<p>In rails console, <code>Child.first</code> run this query <code>SELECT  parents.* FROM parents WHERE parents.type IN ('Child')  ORDER BY parents.id ASC LIMIT 1</code>.</p>\n\n<p>After that, I run <code>Another::Child.first</code> in rails console and this query is generated <code>SELECT  parents.* FROM parents WHERE parents.type IN ('Another::Child')  ORDER BY parents.id ASC LIMIT 1</code>.</p>\n\n<p>After I run both command in rails console, then I run <code>Child.first</code> again and the query became <code>SELECT  parents.* FROM parents WHERE parents.type IN ('Child', 'Another::Child')  ORDER BY parents.id ASC LIMIT 1</code>.</p>\n\n<p>What is the cause of that?</p>\n\n<p>How to consistently call the 3rd query whenever I run <code>Another::Child.first</code> considering <code>Another::Child</code> is a child class of <code>Child</code>?</p>\n"}, {"tags": ["ruby", "arduino", "serial-port"], "comments": [{"owner": {"reputation": 21, "user_id": 7646870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SCt5oiJA-k0/AAAAAAAAAAI/AAAAAAAAAHk/5OmBiaGHBeg/photo.jpg?sz=128", "display_name": "alptekin karabacak", "link": "https://stackoverflow.com/users/7646870/alptekin-karabacak"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1537268876, "post_id": 52384865, "comment_id": 91714381, "body": "I can not send data to serialport. I explained in my post."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1537269450, "post_id": 52384865, "comment_id": 91714736, "body": "Which operating system?"}, {"owner": {"reputation": 21, "user_id": 7646870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SCt5oiJA-k0/AAAAAAAAAAI/AAAAAAAAAHk/5OmBiaGHBeg/photo.jpg?sz=128", "display_name": "alptekin karabacak", "link": "https://stackoverflow.com/users/7646870/alptekin-karabacak"}, "edited": false, "score": 0, "creation_date": 1537269533, "post_id": 52384865, "comment_id": 91714784, "body": "Windows 10 and my ruby version is: 2.4.4"}, {"owner": {"reputation": 5508, "user_id": 794749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pfE2l.jpg?s=128&g=1", "display_name": "gre_gor", "link": "https://stackoverflow.com/users/794749/gre-gor"}, "edited": false, "score": 0, "creation_date": 1537299853, "post_id": 52384865, "comment_id": 91732336, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/51728813/serial-communication-between-arduino-and-matlab-is-losing-data\">Serial communication between Arduino and Matlab is losing data</a>"}], "owner": {"reputation": 21, "user_id": 7646870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SCt5oiJA-k0/AAAAAAAAAAI/AAAAAAAAAHk/5OmBiaGHBeg/photo.jpg?sz=128", "display_name": "alptekin karabacak", "link": "https://stackoverflow.com/users/7646870/alptekin-karabacak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537273830, "creation_date": 1537267699, "last_edit_date": 1537273830, "question_id": 52384865, "link": "https://stackoverflow.com/questions/52384865/cannot-send-data-to-serial-port", "title": "Cannot send data to serial port", "body": "<p>I am trying to send data to Arduino via serial port. Here is my Ruby code:</p>\n\n<pre><code>sp = SerialPort.new(\"COM4\",115200,8,1)\nsp.sync = true\nframing_array = [0x0, 0x33, 0x0, 0x0, 0x01, 0x02, 0x03, 0x04, 0x25]\nframing_array.each do|command|\n  sp.syswrite(command)\n  sp.flush()\nend\nputs \"data has sended\"\nread_data =\"\"\n\"in first loop\"\nloop do\n  puts \"in second loop\"\n  read_data_temp = sp.read(1)\n  puts \"data is readed\"\n  puts \"Temp data: #{read_data_temp}\"\n  if read_data_temp == nil\n    read_data_temp.to_s\n    puts \"comes nil\"\n    break\n  else\n    read_data = read_data + read_data_temp\n    read_data_hex = read_data\n    puts \"read_data: #{read_data_hex}\"\n  end\nend\nputs \"Exiting...\"\nexit\n</code></pre>\n\n<p>And my Arduino code is:</p>\n\n<pre><code>int incomingByte;\nvoid setup() {\n  Serial.begin(115200);\n\n}  \n\nvoid loop() {\n// send data only when arduino receives data: \n        if (Serial.available() &gt; 0) {\n                // read the incoming byte:\n               incomingByte = Serial.read();\n               Serial.print(\"He sends me this\");\n               Serial.print(incomingByte);\n        } \n}\n</code></pre>\n\n<p>I cannot send data. When I try to read data without sending, Arduino can send data via serial port, and I can display it in the terminal. But when I try to send and read data, it displays nothing. Arduino sends <code>nil</code>, then <code>elsif blog</code> runs and turns back to the start of the loop.</p>\n\n<p>Editting: I asked my friend and he said me It can be because of the timeout. Can timeout be my solution? If It does how can i set the timeout correctly?\nAny idea to solve the point?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1537264331, "post_id": 52383677, "comment_id": 91711631, "body": "Can you show <code>products#create</code> code?"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1537264408, "post_id": 52383677, "comment_id": 91711688, "body": "Is price string type on integer type column? check in you <code>schema.rb</code> file?"}, {"owner": {"reputation": 185, "user_id": 10097909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156305774400751/picture?type=large", "display_name": "Jacques", "link": "https://stackoverflow.com/users/10097909/jacques"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1537264754, "post_id": 52383677, "comment_id": 91711891, "body": "Of course.   class CreateProducts &lt; ActiveRecord::Migration[5.2]   def change     create_table :products do |t|       t.string :name       t.text :description       t.string :image_url       t.decimal :price       t.timestamps     end   end end"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537264780, "post_id": 52383677, "comment_id": 91711911, "body": "Please update the question with products_controller code"}, {"owner": {"reputation": 185, "user_id": 10097909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156305774400751/picture?type=large", "display_name": "Jacques", "link": "https://stackoverflow.com/users/10097909/jacques"}, "edited": false, "score": 0, "creation_date": 1537264889, "post_id": 52383677, "comment_id": 91711989, "body": "And the price in my products schema is as follows.  create_table &quot;products&quot;, force: :cascade do |t|     t.string &quot;name&quot;     t.text &quot;description&quot;     t.string &quot;image_url&quot;     t.decimal &quot;price&quot;     t.datetime &quot;created_at&quot;, null: false     t.datetime &quot;updated_at&quot;, null: false     t.string &quot;color&quot;   end"}, {"owner": {"reputation": 505, "user_id": 5909738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jNscA.jpg?s=128&g=1", "display_name": "Tashows", "link": "https://stackoverflow.com/users/5909738/tashows"}, "edited": false, "score": 0, "creation_date": 1537265239, "post_id": 52383677, "comment_id": 91712226, "body": "I don&#39;t see <code>:price</code> in the permitted params in your controller. Are you aware of this?"}], "answers": [{"tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 2, "last_activity_date": 1537266445, "last_edit_date": 1537266445, "creation_date": 1537265109, "answer_id": 52384072, "question_id": 52383677, "link": "https://stackoverflow.com/questions/52383677/cannot-fill-out-price-field-in-my-editing-section-using-ruby-on-rails/52384072#52384072", "title": "Cannot fill out price field in my editing section using Ruby on Rails", "body": "<blockquote>\n  <p>price 'cannot be blank'</p>\n</blockquote>\n\n<p>You should <em>whitelist</em> <code>price</code> in the <code>product_params</code> method to fix the validation error (i.e, <em>price 'cannot be blank'</em>) and to able to save the product with its price successfully.</p>\n\n<pre><code>def product_params\n  params.require(:product).permit(:name, :description, :image_url, :color, :price)\nend\n</code></pre>\n\n<p><strong>Reason for the error:</strong></p>\n\n<p>Since you didn't whitelisted <code>price</code> attribute, it will treated as <em>unpermitted params</em> and won't be included in the <code>params</code> hash while saving the <code>@product</code>. And as <code>save</code> triggers the validations, <code>@product</code> <strong>fails the validation check</strong> on <code>price</code> resulting in that error.</p>\n"}], "owner": {"reputation": 185, "user_id": 10097909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156305774400751/picture?type=large", "display_name": "Jacques", "link": "https://stackoverflow.com/users/10097909/jacques"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 52384072, "answer_count": 1, "score": 1, "last_activity_date": 1537266445, "creation_date": 1537263889, "last_edit_date": 1537264980, "question_id": 52383677, "link": "https://stackoverflow.com/questions/52383677/cannot-fill-out-price-field-in-my-editing-section-using-ruby-on-rails", "title": "Cannot fill out price field in my editing section using Ruby on Rails", "body": "<p>I have just recently tried to implement 'Stripe' to take payments on my website. However, I am have a certain issue trying to update the price on the products. </p>\n\n<p>This is my payments controller.</p>\n\n<pre><code>class PaymentsController &lt; ApplicationController\n  def create\n    token = params[:stripeToken]\n    @product = Product.find(params[:product_id])\n    @user = current_user\n\n    # Create the charge on Stripe's servers to charge the user's card\n    begin\n      charge = Stripe::Charge.create(\n        amount: (@product.price*100).to_i,\n        currency: \"eur\", \n        source: token,\n        description: params[:stripeEmail]\n      )\n\n      if charge.paid\n        Order.create!(product_id: @product.id, user_id: @user.id, total: @product.price.to_i)\n        UserMailer.order_placed(@user,@product).deliver_now\n      end\n\n    rescue Stripe::CardError =&gt; e\n      body = e.json_body\n      err = body[:error]\n      flash[:error] = \"Unfortunately, there was an error processing your payment: #{err[:message]}\"\n    end\n\n    redirect_to product_path(@product), notice: 'Thank you for your order!'\n  end\nend\n</code></pre>\n\n<p>My products model</p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  has_many :orders\n  has_many :comments\n  validates :name, presence: true\n  validates :price, presence: true\n\n  def price_show\n    \"\u20ac %.2f\" % (self[:price]/100.0)\n  end\n\n  def price\n    self[:price]\n  end\n\n  def self.search(search_term)\n   Product.where(\"name LIKE ?\", \"%#{search_term}%\")\nend\n\n# Called by &lt;%= @product.highest_rating_comment %&gt;\n  def highest_rating_comment\n   comments.rating_desc.first\n end\n\n def average_rating\n  comments.average(:rating).to_f\n end\nend\n</code></pre>\n\n<p>and my partial form.</p>\n\n<pre><code>&lt;%= form_with(model: @product, local: true) do |form| %&gt;\n  &lt;% if @product.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(product.errors.count, \"error\") %&gt; prohibited this product from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% product.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :name %&gt;\n    &lt;%= form.text_field :name %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :description %&gt;\n    &lt;%= form.text_area :description %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :image_url %&gt;\n    &lt;%= form.text_field :image_url %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n  &lt;%= form.label :color %&gt;&lt;br&gt;\n  &lt;%= form.text_field :color %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :price %&gt;\n    &lt;%= form.text_field :price %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= form.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem I am having is that when I enter in the price, I will be getting the 'undefined error\" on both of these lines, to which it will say \"did you mean @product?\".</p>\n\n<pre><code>div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(product.errors.count, \"error\") %&gt; prohibited this product from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% product.errors.full_messages.each do |message| %&gt;\n</code></pre>\n\n<p>I change both the lines accordingly, the page loads. However, when I try to enter the price on the page, I will get an error message, stating that the price 'cannot be blank', even though I am entering a numerical value in the field. </p>\n\n<p>My products controller code is as follows. </p>\n\n<pre><code>class ProductsController &lt; ApplicationController\n  before_action :set_product, only: [:show, :edit, :update, :destroy]\n\n  # GET /products\n  # GET /products.json\n  def index\n    if params[:q]\n      search_term = params[:q]\n      @products = Product.search(search_term)\n    else\n    @products = Product.limit(4)\n  end\nend\n  # GET /products/1\n  # GET /products/1.json\n  def show\n    @comments = @product.comments.order(\"created_at DESC\")\n    @comments = @comments.paginate(:page =&gt; params[:page], :per_page =&gt; 2)\n  end\n\n\n  # GET /products/new\n  def new\n    @product = Product.new\n  end\n\n  # GET /products/1/edit\n  def edit\n  end\n\n  # POST /products\n  # POST /products.json\n  def create\n    @product = Product.new(product_params)\n\n    respond_to do |format|\n      if @product.save\n        format.html { redirect_to @product, notice: 'Product was successfully created.' }\n        format.json { render :show, status: :created, location: @product }\n      else\n        format.html { render :new }\n        format.json { render json: @product.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /products/1\n  # PATCH/PUT /products/1.json\n  def update\n    respond_to do |format|\n      if @product.update(product_params)\n        format.html { redirect_to @product, notice: 'Product was successfully updated.' }\n        format.json { render :show, status: :ok, location: @product }\n      else\n        format.html { render :edit }\n        format.json { render json: @product.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /products/1\n  # DELETE /products/1.json\n  def destroy\n    @product.destroy\n    respond_to do |format|\n      format.html { redirect_to products_url, notice: 'Product was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_product\n      @product = Product.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def product_params\n      params.require(:product).permit(:name, :description, :image_url, :color)\n    end\nend\n</code></pre>\n\n<p>Am relatively new to rails so sorry if this is a silly question but any help would be greatly appreciated. </p>\n"}, {"tags": ["ruby", "batch-file"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 786371, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed23f67b9037486984b0cfdbbf94f7cb?s=128&d=identicon&r=PG", "display_name": "Shikamu", "link": "https://stackoverflow.com/users/786371/shikamu"}, "edited": false, "score": 0, "creation_date": 1537297572, "post_id": 52386896, "comment_id": 91731291, "body": "the problem is that I don&#39;t know the path to gem, the user can choose to install it wherever they please"}, {"owner": {"reputation": 5002, "user_id": 9012170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3225450779d6822dd7e376c02764b058?s=128&d=identicon&r=PG&f=1", "display_name": "michael_heath", "link": "https://stackoverflow.com/users/9012170/michael-heath"}, "reply_to_user": {"reputation": 331, "user_id": 786371, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed23f67b9037486984b0cfdbbf94f7cb?s=128&d=identicon&r=PG", "display_name": "Shikamu", "link": "https://stackoverflow.com/users/786371/shikamu"}, "edited": false, "score": 0, "creation_date": 1537329934, "post_id": 52386896, "comment_id": 91739947, "body": "The updated answer has a script with code to get the install path from the registry. This may solve the path issue with the command <code>gem</code>."}, {"owner": {"reputation": 331, "user_id": 786371, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed23f67b9037486984b0cfdbbf94f7cb?s=128&d=identicon&r=PG", "display_name": "Shikamu", "link": "https://stackoverflow.com/users/786371/shikamu"}, "edited": false, "score": 0, "creation_date": 1537347643, "post_id": 52386896, "comment_id": 91747817, "body": "perfect! all I had to do was to also add \\bin to the rubypath for it to be able to find gem :) thanks a lot!"}], "tags": [], "owner": {"reputation": 5002, "user_id": 9012170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3225450779d6822dd7e376c02764b058?s=128&d=identicon&r=PG&f=1", "display_name": "michael_heath", "link": "https://stackoverflow.com/users/9012170/michael-heath"}, "is_accepted": true, "score": 0, "last_activity_date": 1537348530, "last_edit_date": 1537348530, "creation_date": 1537274677, "answer_id": 52386896, "question_id": 52383428, "link": "https://stackoverflow.com/questions/52383428/batch-file-running-an-installer-that-appends-to-the-path-and-the-running-that/52386896#52386896", "title": "batch file - running an installer that appends to the PATH and the running that new application from the bat", "body": "\n\n<pre class=\"lang-none prettyprint-override\"><code>@echo off\nsetlocal\n\nrem Install Cucumber\n2&gt;nul gem install cucumber -v 2.4.0\n\nif %errorlevel% neq 9009 (\n    echo Cucumber install did not error code 9009.\n    exit /b 0\n)\n\nrem Get Ruby path.\ncall :query_rubypath\n\nif errorlevel 1 (\n    echo Installing Ruby.\n    rubyinstaller-2.5.1-2-x64.exe /verysilent\n    call :query_rubypath\n)\n\nrem Update PATH\nif defined rubypath (\n    if \"%path:~-1%\" == \";\" (\n        set \"path=%path%%rubypath%\\bin\"\n    ) else set \"path=%path%;%rubypath%\\bin\"\n) else (\n    &gt;&amp;2 echo Ruby path not found.\n    exit /b 1\n)\n\nrem Use command gem or command \"%rubypath%\\bin\\gem\"\n@rem \"%rubypath%\\bin\\gem\" install cucumber -v 2.4.0\ngem install cucumber -v 2.4.0\n\nif %errorlevel% == 9009 (\n    &gt;&amp;2 echo Cucumber error code 9009.\n    exit /b 1\n)\n\nexit /b\n\n:query_rubypath\nrem Get Ruby path from registry\nset \"rubypath=\"\n\nfor /f \"tokens=1,2,*\" %%A in ('\n reg query HKCU\\Software\\RubyInstaller\\MRI\\2.5.1\n /v InstallLocation\n 2^&gt;nul\n') do if /i \"%%~A\" == \"InstallLocation\" set \"rubypath=%%~C\"\n\nif not defined rubypath exit /b 1\nexit /b 0\n</code></pre>\n\n<p>The installer <code>rubyinstaller-2.5.1-2-x64.exe</code> is compiled with\n<code>Inno Setup version 5.5.9 (u)</code>.</p>\n\n<p>The installation can be handled by <a href=\"http://www.jrsoftware.org/ishelp/index.php?topic=setupcmdline\" rel=\"nofollow noreferrer\">Setup Command Line Parameters</a>.</p>\n\n<p>By default, components <code>ruby</code> is selected and <code>msys2</code> is deselected.\nIf reinstalled, the installer will read the uninstall entries\nto determine the state of the installed components to select\nif no <code>/COMPONENTS</code> parameter is specified.</p>\n\n<p>If unattended install, you can use for example:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>rubyinstaller-2.5.1-2-x64.exe /verysilent /COMPONENTS=\"ruby,msys2\"\n</code></pre>\n\n<p>The <code>/COMPONENTS</code> parameter is optional.</p>\n\n<p>The PATH envirionmental variable is updated with:</p>\n\n<blockquote>\n  <p>C:\\Ruby25-x64\\bin</p>\n</blockquote>\n\n<p>This would be the default install path on the <code>%systemdrive%</code>.\nThe script will locate the actual path from the registry.</p>\n\n<p>Important registry keys located are:</p>\n\n<blockquote>\n<pre>HKEY_CURRENT_USER\\Software\\RubyInstaller\\MRI\\2.5.1\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\RubyInstaller-2.5-x64-mingw32_is1</pre>\n</blockquote>\n\n<p>The code of <code>call :query_rubypath</code> will get the install path of Ruby.\nThe variable named <code>rubypath</code> will store the value if defined.</p>\n\n<p>How <em>Ruby</em> is installed is a preference as you mention.\nEither way, the script will handle much of the basic handling.</p>\n\n<ul>\n<li>The script will will locate the install path so\nthat the <code>gem</code> command can be executed.</li>\n<li>Ruby will be installed if the install path is not found.</li>\n</ul>\n\n<p>If you want Ruby installed even if the install path is found,\nthen remove the <code>if errorlevel 1</code> condition. Make changes as\nneeded for your environment.</p>\n"}], "owner": {"reputation": 331, "user_id": 786371, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed23f67b9037486984b0cfdbbf94f7cb?s=128&d=identicon&r=PG", "display_name": "Shikamu", "link": "https://stackoverflow.com/users/786371/shikamu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 52386896, "answer_count": 1, "score": 0, "last_activity_date": 1537348530, "creation_date": 1537263153, "last_edit_date": 1537272557, "question_id": 52383428, "link": "https://stackoverflow.com/questions/52383428/batch-file-running-an-installer-that-appends-to-the-path-and-the-running-that", "title": "batch file - running an installer that appends to the PATH and the running that new application from the bat", "body": "<p>I'm trying to setup a batch file that relies on \"gem\" which is a package manager for Ruby. Basically we want to run something like this:</p>\n\n<pre><code>gem install cucumber -v 2.4.0\n\nif %errorlevel% == 9009 (\n  rubyinstaller-2.5.1-2-x64.exe\n  gem install cucumber -v 2.4.0\n)\n</code></pre>\n\n<p>Basically if you don't have gem installed, the output is the following:</p>\n\n<pre><code>C:\\workspace\\3rdparty-svn\\CucumberCpp&gt;gem install cucumber -v 2.4.0\n'gem' is not recognized as an internal or external command,\noperable program or batch file.\n\nC:\\workspace\\3rdparty-svn\\CucumberCpp&gt;if 9009 == 9009 (\nrubyinstaller-2.5.1-2-x64.exe\n gem install cucumber -v 2.4.0\n)\n'gem' is not recognized as an internal or external command,\noperable program or batch file.\n\nC:\\workspace\\3rdparty-svn\\CucumberCpp&gt;pause\n</code></pre>\n\n<p>The if checks if gem exists, If it doesn't, Then we install ruby and then run gem again.\nThe problem is that this does not work because this is all run in the same instance of the command prompt and it doesn't seem to know about the new PATH which is set by the rubyinstaller.</p>\n\n<p>Is there any way to do this with a batch file? Of course if I run the batch file again, Then gem is detected and it will be able to run the first command, and then of course skip the if statement.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537262230, "post_id": 52382959, "comment_id": 91710316, "body": "<code>remote: https:&#47;&#47;@github.com&#47;Orga&#47;my_gem</code> --- It seems you didn&#39;t correctly set the <code>ENV[&#39;GITHUB_TOKEN&#39;]</code>. How are you setting it?"}, {"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537267007, "post_id": 52382959, "comment_id": 91713259, "body": "Yes I realize that the env var is not set properly. Because when I put directly the token in the gemfile, everything works properly.  I set it that way : I have a <code>.env&#39; file with </code>GITHUB_TOKEN=...` .  I also tried to put my env var in secrets.yml and call it with <code>Rails.application.secrets.github_token</code> but it doesn&#39;t work either. So how can I make this env var accessible from the gemfile ?"}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "edited": false, "score": 0, "creation_date": 1537262709, "post_id": 52383254, "comment_id": 91710601, "body": "Note, the source I noted above is GemFury, but this will work for any type of private repo."}, {"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 0, "creation_date": 1537444948, "post_id": 52383254, "comment_id": 91792146, "body": "It doesn&#39;t woks neither :/"}, {"owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "reply_to_user": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 0, "creation_date": 1537445002, "post_id": 52383254, "comment_id": 91792175, "body": "What error are you seeing? Can you please provide more details!"}], "tags": [], "owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "is_accepted": false, "score": 1, "last_activity_date": 1537262673, "creation_date": 1537262673, "answer_id": 52383254, "question_id": 52382959, "link": "https://stackoverflow.com/questions/52382959/how-to-use-private-repo-gem-in-rails-app/52383254#52383254", "title": "How to use private repo gem in Rails app?", "body": "<p>The best and most secure way of doing this is using bundle configuration</p>\n\n<p>In your Gemfile, you should have:</p>\n\n<pre><code>source 'https://gem.fury.io/youraccount/' do\n  gem \"your_service\", \"~&gt; 1.0.0\"\nend\n</code></pre>\n\n<p>And then, if you need to authenticate, this can be achieved by running the following terminal command:</p>\n\n<pre><code>bundle config https://gem.fury.io/youraccount/ yourauthtoken\n</code></pre>\n\n<p>I hope this helps answer your question!</p>\n\n<p>Ben</p>\n"}], "owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537267289, "creation_date": 1537261734, "last_edit_date": 1537267289, "question_id": 52382959, "link": "https://stackoverflow.com/questions/52382959/how-to-use-private-repo-gem-in-rails-app", "title": "How to use private repo gem in Rails app?", "body": "<p>I would like to load a private gem in my rails app (I'm using docker and rails 5).</p>\n\n<p>So first I add the gem in my <strong>gemfile</strong> :</p>\n\n<p><code>\ngem 'my_gem', '0.1.4', git: \"https://#{ENV['GITHUB_TOKEN']}@github.com/Orga/my_gem\"\n</code></p>\n\n<p>Then when I try to <code>docker-compose build</code>, this is what I get : </p>\n\n<blockquote>\n  <blockquote>\n    <p>fatal: could not read Username for '<a href=\"https://github.com\" rel=\"nofollow noreferrer\">https://github.com</a>': No such device or address</p>\n  </blockquote>\n</blockquote>\n\n<p>So  I tried <code>docker-compose run web bundle install</code>. They ask me for my login. I've got no error, but the gemfile is updated as below :</p>\n\n<pre><code>GIT\n  remote: https://@github.com/Orga/my_gem\n  revision: 391ae38ff06dfd360eb42a09256f4a5463fba559\n  specs:\n    my_gem (0.1.4)\n      rails (&gt;= 5.0.0.beta3, &lt; 5.1)\n      roo (~&gt; 2.1.0)\n\nGEM\n  remote: https://rubygems.org/\n  ...\n</code></pre>\n\n<ol>\n<li>This line seems really weird to me : <code>remote: https://@github.com/Orga/my_gem</code> .\nSo is it the good way to load a private gem ?</li>\n<li>When I <code>bundle install</code> it asks for my login, so it will probably cause trouble in production right ?</li>\n</ol>\n\n<h1>EDIT</h1>\n\n<p>When I put direclty the token into the gemfile everything works. \nSo the env var is not called properly. </p>\n\n<p>I tried :</p>\n\n<p><strong>.env</strong></p>\n\n<pre><code>GITHUB_TOKEN=...\n</code></pre>\n\n<p><strong>gemfile</strong></p>\n\n<pre><code>gem 'my_gem', '0.1.4', git: \"https://#{ENV['GITHUB_TOKEN']}@github.com/Orga/my_gem\"\n</code></pre>\n\n<p>AND also tried</p>\n\n<p><strong>secrets.yml</strong></p>\n\n<pre><code>development:\n  github_token: ...\n</code></pre>\n\n<p><strong>gemfile</strong></p>\n\n<pre><code>gem 'my_gem', '0.1.4', git: \"https://#{Rails.application.secrets.github_token}@github.com/Orga/my_gem\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1537261708, "post_id": 52382929, "comment_id": 91710005, "body": "There&#39;s no condition here."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1537261725, "post_id": 52382929, "comment_id": 91710020, "body": "Do you want to run the whole loop 6 times or what?"}, {"owner": {"reputation": 31, "user_id": 10376688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AndKop", "link": "https://stackoverflow.com/users/10376688/andkop"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1537261805, "post_id": 52382929, "comment_id": 91710067, "body": "Yes, I need to run it 6 times."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1537261835, "post_id": 52382929, "comment_id": 91710084, "body": "Wrap it in another loop then. <code>6.times do ...</code>"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537261996, "post_id": 52382929, "comment_id": 91710176, "body": "I&#39;m curious to know why you want to run this loop 6 times."}, {"owner": {"reputation": 31, "user_id": 10376688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AndKop", "link": "https://stackoverflow.com/users/10376688/andkop"}, "edited": false, "score": 0, "creation_date": 1537262133, "post_id": 52382929, "comment_id": 91710254, "body": "I&#39;m new, I have data in the database and I need to output random 6 values."}, {"owner": {"reputation": 31, "user_id": 10376688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AndKop", "link": "https://stackoverflow.com/users/10376688/andkop"}, "edited": false, "score": 0, "creation_date": 1537262409, "post_id": 52382929, "comment_id": 91710411, "body": "I want the loop to output only six values."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 3, "creation_date": 1537262443, "post_id": 52382929, "comment_id": 91710429, "body": "@AndKop <i>I need to output random 6 values</i> --This is a great example of <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\"><b>an XY problem</b></a>. It is always better to for what you&#39;re trying to <i>achieve</i>, not for help on a specific implementation blocker (but do also show what you&#39;ve tried so far!)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537262513, "post_id": 52382929, "comment_id": 91710472, "body": "What is <code>@portfolio</code>? Do you want 6 unique random values, or could there be repeats? If there are fewer than 6 items in <code>@portfolio</code>, then what result do you want?"}, {"owner": {"reputation": 31, "user_id": 10376688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AndKop", "link": "https://stackoverflow.com/users/10376688/andkop"}, "edited": false, "score": 0, "creation_date": 1537262693, "post_id": 52382929, "comment_id": 91710587, "body": "I have a database, it can have an unlimited number of values, I need to print only 6 of them and not more. If they are less than 6, then just output as much as there is, but there can not be less of them and forget that there may be less of them, there is no such condition."}, {"owner": {"reputation": 31, "user_id": 10376688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AndKop", "link": "https://stackoverflow.com/users/10376688/andkop"}, "edited": false, "score": 0, "creation_date": 1537262768, "post_id": 52382929, "comment_id": 91710646, "body": "@ portfolio is a variable that holds the values from the database, here it is in the controller, @portfolio = PortfolioItem.all"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537263203, "post_id": 52382929, "comment_id": 91710931, "body": "<code>@portfolio = PortfolioItem.all</code> --- Right, thank you. Please write that in the original question, as it is the most important piece of code you&#39;ve shown, yet it&#39;s buried in the comments."}], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 6078174, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-mSfmR5-qURA/AAAAAAAAAAI/AAAAAAAAAOU/4wPjvIHS-BQ/photo.jpg?sz=128", "display_name": "Raman Preet Singh", "link": "https://stackoverflow.com/users/6078174/raman-preet-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1537262009, "creation_date": 1537262009, "answer_id": 52383042, "question_id": 52382929, "link": "https://stackoverflow.com/questions/52382929/how-to-select-6-random-records-from-table/52383042#52383042", "title": "How to select 6 random records from table", "body": "<p>You can something like this :   </p>\n\n<pre><code> &lt;%(1..6).each do |i| %&gt;\n     &lt;% #your statements %&gt;\n &lt;%end%&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1537263049, "post_id": 52383344, "comment_id": 91710841, "body": "Yes, the second is much better."}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 0, "last_activity_date": 1537262924, "creation_date": 1537262924, "answer_id": 52383344, "question_id": 52382929, "link": "https://stackoverflow.com/questions/52382929/how-to-select-6-random-records-from-table/52383344#52383344", "title": "How to select 6 random records from table", "body": "<pre><code>&lt;% @portfolio.shuffle.each_with_index do |portfo, index| %&gt;\n  &lt;%if index &lt;= 6%&gt;\n    &lt;p&gt;&lt;%= portfo.title %&gt;&lt;/p&gt;\n  &lt;%end%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Or You can do it as</p>\n\n<pre><code>&lt;% @portfolio.shuffle.take(6).each do |portfo| %&gt;\n    &lt;p&gt;&lt;%= portfo.title %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 10376688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AndKop", "link": "https://stackoverflow.com/users/10376688/andkop"}, "edited": false, "score": 0, "creation_date": 1537273535, "post_id": 52384723, "comment_id": 91717420, "body": "Thanks, but there will not be much data, it will not affect the process in this project, but thanks, it will help me in the future."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1537267185, "creation_date": 1537267185, "answer_id": 52384723, "question_id": 52382929, "link": "https://stackoverflow.com/questions/52382929/how-to-select-6-random-records-from-table/52384723#52384723", "title": "How to select 6 random records from table", "body": "<p>Using <code>all</code>, followed by <code>shuffle</code>, is a bad solution for two reasons.</p>\n\n<p>A slight improvement would be to use <code>sample(6)</code> instead of <code>shuffle.first(6)</code>, as this removes a step from the process.</p>\n\n<p>However, the bigger issue here is that <code>Portfolio.all.&lt;something&gt;</code> (where the <code>&lt;something&gt;</code> method requires converting the data into a ruby <code>Array</code>) will fetch <strong>all</strong> of the data into memory - which is a bad idea. As the table grows, this will become a bigger performance issue.</p>\n\n<p>A better idea is to perform the \"random selection\" <strong>in SQL</strong> (with the <code>order</code> and <code>limit</code> methods), rather than in ruby. This avoids the need to fetch other data into memory.</p>\n\n<p>The exact solution is database-specific, unfortunately. For PostgreSQL and SQLite, use:</p>\n\n<pre><code>Portfolio.order('RANDOM()').limit(6).each do |portfolio|\n</code></pre>\n\n<p>Or for MySQL, use:</p>\n\n<pre><code>Portfolio.order('RAND()').limit(6).each do |portfolio|\n</code></pre>\n\n<p>You could define this as a helper in the <code>Portfolio</code> model - for example:</p>\n\n<pre><code>class Portfolio &lt; ApplicationRecord\n  # ...\n\n  scope :random_sample, -&gt;(n) { order('RANDOM()').limit(n) }\n\n  # ...\nend\n</code></pre>\n\n<p>And then in your view:</p>\n\n<pre><code>@portfolio.random_sample(6).each do |portfolio|\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10376688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AndKop", "link": "https://stackoverflow.com/users/10376688/andkop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 52384723, "answer_count": 3, "score": -2, "last_activity_date": 1537274678, "creation_date": 1537261651, "last_edit_date": 1537274678, "question_id": 52382929, "link": "https://stackoverflow.com/questions/52382929/how-to-select-6-random-records-from-table", "title": "How to select 6 random records from table", "body": "<p>My <code>portfolio_controller.rb</code> has an index method like this:</p>\n\n<pre><code>def index\n  @portfolio = PortfolioItem.all\nend\n</code></pre>\n\n<p>How can I specify in the condition that the code in this block should be executed 6 times? In other words, how can I access exactly 6 values from the <code>@portfolio</code> object in my view, using a loop? This is what I have so far:</p>\n\n<pre><code>&lt;% @portfolio.shuffle.each do |portfo| %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3.2"], "comments": [{"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 2, "creation_date": 1537259917, "post_id": 52382243, "comment_id": 91709011, "body": "If the output you receive is valid json, you should be able to do JSON.parse(volumes)[&#39;Volumes&#39;].map {|volume| volume[&quot;VolumeId&quot;] } to get an array of volume idw."}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 3809599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6j6Vb.png?s=128&g=1", "display_name": "shubhamgupta0122", "link": "https://stackoverflow.com/users/3809599/shubhamgupta0122"}, "is_accepted": true, "score": 1, "last_activity_date": 1537263169, "creation_date": 1537263169, "answer_id": 52383431, "question_id": 52382243, "link": "https://stackoverflow.com/questions/52382243/get-values-from-json-in-ruby/52383431#52383431", "title": "Get values from JSON in Ruby", "body": "<p>for getting just the <code>volume_ids</code> -></p>\n\n<pre><code>JSON.parse(volumes)['Volumes'].map{|v|v[\"VolumeId\"]}\n</code></pre>\n\n<p>for getting just the <code>states</code> -></p>\n\n<pre><code>JSON.parse(volumes)['Volumes'].map{|v|v[\"state\"]}\n</code></pre>\n\n<p>for getting a hash/map with volume-ids as keys and their states as values -></p>\n\n<pre><code>JSON.parse(volumes)['Volumes'].map{|v| [v[\"VolumeId\"],v[\"state\"]] }.to_h\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10008716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7NWGSSan85U/AAAAAAAAAAI/AAAAAAAAAOc/KG4eIedeVOM/photo.jpg?sz=128", "display_name": "Karthikraj", "link": "https://stackoverflow.com/users/10008716/karthikraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 52383431, "answer_count": 1, "score": 0, "last_activity_date": 1537263169, "creation_date": 1537259511, "question_id": 52382243, "link": "https://stackoverflow.com/questions/52382243/get-values-from-json-in-ruby", "title": "Get values from JSON in Ruby", "body": "<p>I am trying to get the VolumeId and State of the Volume attached to the machines using aws API .</p>\n\n<p>Code</p>\n\n<pre><code>#!/usr/local/bin/ruby\nrequire \"aws-sdk\"\nrequire \"rubygems\"\n\n\nlist=Aws::EC2::Client.new(region: \"us-east-1\")\nvolume=list.describe_volumes()\nvolumes=%x( aws ec2 describe-volumes --region='us-east-1' )\nputs volumes\n</code></pre>\n\n<p>Below is the sample output of the command \n<code>aws ec2 describe-volumes --region='us-east-1'</code> . \nPlease help to get  VolumeID and state from the below</p>\n\n<p>Sample Output of API(JSON):</p>\n\n<pre><code>{\n\"Volumes\": [\n    {\n        \"AvailabilityZone\": \"us-east-1d\", \n        \"Attachments\": [\n            {\n                \"AttachTime\": \"2015-02-02T07:31:36.000Z\", \n                \"InstanceId\": \"i-bca66353\", \n                \"VolumeId\": \"vol-892a2acd\", \n                \"State\": \"attached\", \n                \"DeleteOnTermination\": true, \n                \"Device\": \"/dev/sda1\"\n            }\n        ], \n        \"Encrypted\": false, \n        \"VolumeType\": \"gp2\", \n        \"VolumeId\": \"vol-892a2acd\", \n        \"State\": \"in-use\", \n        \"Iops\": 100, \n        \"SnapshotId\": \"snap-df910966\", \n        \"CreateTime\": \"2015-02-02T07:31:36.380Z\", \n        \"Size\": 8\n    }, \n ]\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537257236, "post_id": 52381548, "comment_id": 91707437, "body": "Can you update the question with full error message and the log that shows where the error is?"}, {"owner": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537257565, "post_id": 52381548, "comment_id": 91707636, "body": "@Pavan i have added the logs plz check."}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537257739, "post_id": 52381548, "comment_id": 91707734, "body": "The accepted answer here has a bunch of suggestions: <a href=\"https://stackoverflow.com/questions/46029084/rails-unable-to-convert-unpermitted-parameters-to-hash?rq=1\" title=\"rails unable to convert unpermitted parameters to hash\">stackoverflow.com/questions/46029084/&hellip;</a> - essentially newer rails version throw an error if you try to use params-object as a hash. I guess the easiest way for you is to think about which params you want to pass to your download-link and filter them with params.permit(..)"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537257794, "post_id": 52381548, "comment_id": 91707773, "body": "<code>params: params</code> doesn&#39;t make any sense. What are you trying to do? Shouldn&#39;t it be just <code>&lt;%= link_to &quot;CSV&quot;,  revenue_search_path(format: &quot;csv&quot; )</code> %&gt;"}, {"owner": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537257960, "post_id": 52381548, "comment_id": 91707847, "body": "@Pavan when i try this &lt;%= link_to &quot;CSV&quot;, revenue_search_path(format: &quot;csv&quot; ) %&gt; it throws error telling undefined method `[]&#39; for nil:NilClass for controller code date = &quot;1-#{params[&#39;date&#39;][&#39;month&#39;]}-#{params[&#39;date&#39;][&#39;year&#39;]}&quot;"}, {"owner": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537258056, "post_id": 52381548, "comment_id": 91707892, "body": "@Pavan sending only csv will show all the results , it should download only the search results, so we need to pass the params rite"}, {"owner": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "reply_to_user": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537258124, "post_id": 52381548, "comment_id": 91707945, "body": "@trueunlessfalse ok thanks il look into the link and try"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537258457, "post_id": 52381548, "comment_id": 91708160, "body": "@SushmaKv I agree but you cannot pass the <code>params</code> like this through the <code>link_to</code> if you want to send dynamic values of search results to the <code>revenue_search</code> method. You require a different approach."}, {"owner": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537258896, "post_id": 52381548, "comment_id": 91708422, "body": "@Pavan so what is that approach so that i would get those results in the csv"}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537259569, "post_id": 52381548, "comment_id": 91708778, "body": "Without testing I think revenue_search_path(params.permit(:query).merge(format: &#39;csv&#39;)) could work. (where you should replace :query with the params you actually need)"}, {"owner": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "reply_to_user": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537259879, "post_id": 52381548, "comment_id": 91708988, "body": "@trueunlessfalse that solves the error but i am still not able to download the csv. it tells undefined method `[]&#39; for nil:NilClass for this line in revenue_search action date = &quot;1-#{params[&#39;date&#39;][&#39;month&#39;]}-#{params[&#39;date&#39;][&#39;year&#39;]}&quot;"}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 1, "creation_date": 1537260022, "post_id": 52381548, "comment_id": 91709080, "body": "If you deal with nested parameters you need to specify that for permit, In you case something like that should work: params.permit(date: [:year, :month])"}, {"owner": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "reply_to_user": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537268922, "post_id": 52381548, "comment_id": 91714411, "body": "@trueunlessfalse thanks it worked by adding permit"}], "answers": [{"tags": [], "owner": {"reputation": 654, "user_id": 1319545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d925d70e121e9b8e1a7dd44155e2497?s=128&d=identicon&r=PG", "display_name": "thaleshcv", "link": "https://stackoverflow.com/users/1319545/thaleshcv"}, "is_accepted": false, "score": 4, "last_activity_date": 1554529752, "last_edit_date": 1554529752, "creation_date": 1537275866, "answer_id": 52387268, "question_id": 52381548, "link": "https://stackoverflow.com/questions/52381548/unable-to-convert-unpermitted-parameters-to-hash-rails/52387268#52387268", "title": "unable to convert unpermitted parameters to hash rails", "body": "<p>You can use <a href=\"https://www.rubydoc.info/github/rails/rails/ActionController%2FParameters:to_unsafe_h\" rel=\"nofollow noreferrer\" title=\"to_unsafe_h\">to_unsafe_h</a></p>\n\n<pre><code>revenue_search_path(format: \"csv\" , params: params.to_unsafe_h)\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3539, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1554529752, "creation_date": 1537257083, "last_edit_date": 1537257505, "question_id": 52381548, "link": "https://stackoverflow.com/questions/52381548/unable-to-convert-unpermitted-parameters-to-hash-rails", "title": "unable to convert unpermitted parameters to hash rails", "body": "<p>I was trying to add csv for my the search results but it throws error telling unpermitted params. What params should i pass in the csv link? So that csv would download the only the search results.</p>\n\n<p>ReportsController</p>\n\n<pre><code>def revenue_search\n  @bookings = Booking.complete.order(\"created_at DESC\")\n  date = \"1-#{params['date']['month']}-#{params['date']['year']}\"\n  date = Date.parse(date)\n  @bookings = @bookings.where(created_at: date.beginning_of_month..date.end_of_month)\n  @per_page = params[:per_page] || Booking.per_page || 20\n  @bookings = @bookings.paginate( :per_page =&gt; @per_page, :page =&gt; params[:page])\n  if params[:currency].present?\n    @bookings = @bookings.where(currency: params[:currency])\n  end\n  respond_to do |format|\n    format.html\n    format.csv { send_data @bookings.revenue_csv }\n  end\nend\n</code></pre>\n\n<p>Model</p>\n\n<pre><code>def self.revenue_csv\n  attributes = %w{ total value deposit balance }\n  CSV.generate(headers: true) do |csv|\n   csv &lt;&lt; attributes\n   all.each do |booking|\n    csv &lt;&lt; attributes.map{ |attr| booking.send(attr) }\n   end\n end\nend\n</code></pre>\n\n<p>revenue.html.erb</p>\n\n<pre><code>&lt;%= form_tag revenue_search_path, :method =&gt; 'get' do %&gt;\n   &lt;%= select_tag(:currency, options_for_select([\"USD\", \"GBP\"]), class: \"form-control custom-select\" , :prompt =&gt; 'By Office' ) %&gt;\n   &lt;%= select_month((@selected_date || Date.today), {}, class:\"custom-select\", :prompt =&gt; 'By Month')%&gt;\n   &lt;%= select_year((@selected_year || Date.today.year), {},  class:\"custom-select\" )%&gt;\n   &lt;%= submit_tag \"Search\", name: nil , class: \"btn btn-info\" %&gt;\n&lt;% end %&gt;\n\n&lt;table id=\"demo-foo-addrow\" class=\"table m-t-30 table-hover no-wrap contact-list no-paging footable-loaded footable\" data-page-size=\"2\"&gt;\n   &lt;thead&gt;\n     &lt;tr&gt;\n       &lt;th class=\"footable-sortable\"&gt;Total No of students&lt;span class=\"footable-sort-indicator\"&gt;&lt;/span&gt;&lt;/th&gt;\n       &lt;th class=\"footable-sortable\"&gt;Value of courses sold&lt;span class=\"footable-sort-indicator\"&gt;&lt;/span&gt;&lt;/th&gt;\n       &lt;th class=\"footable-sortable\"&gt;Total Deposits&lt;span class=\"footable-sort-indicator\"&gt;&lt;/span&gt;&lt;/th&gt;\n       &lt;th class=\"footable-sortable\"&gt;Balance payments&lt;span class=\"footable-sort-indicator\"&gt;&lt;/span&gt;&lt;/th&gt;\n      &lt;/tr&gt;\n     &lt;/thead&gt;\n    &lt;tbody&gt;\n     &lt;tr&gt;\n        &lt;td&gt;&lt;%= @bookings.count %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= @bookings.count %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= @bookings.sum{|x| (x.payment_gross.to_f)} %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= @bookings.sum{|x| (x.course&amp;.course_fee || x.event&amp;.course_fee).to_f - x.payment_gross.to_f  }.to_f %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n   &lt;/tbody&gt;         \n&lt;/table&gt;\n&lt;p&gt; Download: &lt;%= link_to \"CSV\",  revenue_search_path(format: \"csv\" , params: params ) %&gt; &lt;/p&gt;\n</code></pre>\n\n<p>logs:</p>\n\n<pre><code>ActionView::Template::Error (unable to convert unpermitted parameters to hash):\n42:         &lt;/div&gt;\n43:     &lt;/div&gt;\n44: &lt;/div&gt;\n45: &lt;p&gt; Download: &lt;%= link_to \"CSV\",  revenue_search_path(format: \"csv\" , params: params ) %&gt; &lt;/p&gt;\n\napp/views/reports/revenue_search.html.erb:45:in `_app_views_reports_revenue_search_html_erb___71501213_135144540'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "cocoon-gem", "rails-activestorage"], "comments": [{"owner": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1537265537, "post_id": 52380914, "comment_id": 91712382, "body": "This may help you: <a href=\"https://stackoverflow.com/questions/47752390/rails-5-2-active-storage-with-cocoon-forms\" title=\"rails 5 2 active storage with cocoon forms\">stackoverflow.com/questions/47752390/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 6201871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fabcf8037722b916e8e122da2863fe?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6201871/brian"}, "reply_to_user": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1537327367, "post_id": 52380914, "comment_id": 91739490, "body": "Thanks for the link. The author seems to had the same issue although he didn&#39;t actually resolve it and instead went to a different route by only upload image to an already saved nested object. I hope to find a solution to my problem as it will simplify the UI for my users."}, {"owner": {"reputation": 21, "user_id": 6201871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fabcf8037722b916e8e122da2863fe?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6201871/brian"}, "reply_to_user": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1537340325, "post_id": 52380914, "comment_id": 91743810, "body": "For some reason I can upload files with the code I have as is. Not sure why it wasn&#39;t working before... maybe I changed something I wasn&#39;t aware of \ud83d\ude15"}], "owner": {"reputation": 21, "user_id": 6201871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fabcf8037722b916e8e122da2863fe?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6201871/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1151, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537340366, "creation_date": 1537254912, "last_edit_date": 1537340366, "question_id": 52380914, "link": "https://stackoverflow.com/questions/52380914/how-to-upload-file-in-nested-form-using-activestorage", "title": "How to upload file in nested form using ActiveStorage?", "body": "<ul>\n<li>I have <code>Project</code> that has many <code>Tasks</code>.</li>\n<li>Each <code>Task</code> can have an image uploaded using ActiveStorage.</li>\n</ul>\n\n<p>In my Project new view I have dynamically created nested forms (via Cocoon) to create new tasks and file_field to upload an image per task. When the form is submitted I create a new Project along with new tasks from <code>project_params</code> in my Project controller. But how can I use ActiveStorage to attach each tasks' image after the Project is created?</p>\n\n<pre><code>class Project &lt; ApplicationRecord\n  has_many :tasks\nend\n\nclass Task &lt; ApplicationRecord\n  belongs_to :project\nend\n</code></pre>\n\n<p>Nested form view</p>\n\n<pre><code>&lt;%= form_for @project do |f| %&gt;\n    &lt;%= f.fields_for :tasks do |ff| %&gt;\n        &lt;%= ff.file_field :image %&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Project controller</p>\n\n<pre><code>class ProjectController\n  def create\n    @project = Project.new(project_params)\n    @project.save\n    ...\n    # How should I attach task images here?\n  end\nend\n</code></pre>\n\n<p>I can access individual images within params:</p>\n\n<pre><code>\"tasks_attributes\": {\n  \"0\": { \"image\": ... },\n  \"1\": { \"image\": ... }\n}\n</code></pre>\n\n<p>One way is to loop through each <code>@project.tasks</code> and call <code>.attach</code> on them with image from the params above in the same order. But that seems error prone since params doesn't give me task ID to match with the saved task, so I worry I won't be always attaching the image to the right task. If some of the tasks didn't save to db due to being invalid, the 1-to-1 matching breaks down making this approach even more brittle.</p>\n\n<p>Is there a better way?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>For some reason it's working now. I couldn't tell whether I changed something or it's the original code...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "canvas-lms"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1537253548, "post_id": 52380448, "comment_id": 91705329, "body": "Check your mail configuration in config/environments/production.rb with the given answer below"}, {"owner": {"reputation": 973, "user_id": 9989384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530602201f9551563176b0b648b7d50b?s=128&d=identicon&r=PG&f=1", "display_name": "Cryptex Technologies", "link": "https://stackoverflow.com/users/9989384/cryptex-technologies"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1537254211, "post_id": 52380448, "comment_id": 91705700, "body": "Did you ever work on canvas lms? @Gabbar"}], "answers": [{"comments": [{"owner": {"reputation": 973, "user_id": 9989384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530602201f9551563176b0b648b7d50b?s=128&d=identicon&r=PG&f=1", "display_name": "Cryptex Technologies", "link": "https://stackoverflow.com/users/9989384/cryptex-technologies"}, "edited": false, "score": 0, "creation_date": 1537253816, "post_id": 52380537, "comment_id": 91705483, "body": "Ok let me check once i have already tried similar solution but id does not work thanks for your valuable time @Gabbar"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 1, "last_activity_date": 1537253475, "creation_date": 1537253475, "answer_id": 52380537, "question_id": 52380448, "link": "https://stackoverflow.com/questions/52380448/not-able-to-deliver-the-mail-in-canvas-lms-what-configuration-setting-i-am-miss/52380537#52380537", "title": "Not able to deliver the mail in canvas lms? What configuration setting i am missing?", "body": "<p>In <code>config/environments/production.rb</code></p>\n\n<pre><code>  config.action_mailer.delivery_method = :smtp\n  config.action_mailer.default_url_options = { host:'your host', port: 'xxx' }\n  config.action_mailer.perform_deliveries = true\n  config.action_mailer.raise_delivery_errors = true\n  config.action_mailer.default :charset =&gt; \"utf-8\"\n  config.action_mailer.smtp_settings = {\n      :address =&gt; \"smtp.gmail.com\",\n      :port =&gt; 587,\n      :domain =&gt; 'abc.com',\n      :user_name =&gt; \"xxxx@mail.com\",\n      :password =&gt; \"xxxx\",\n      :authentication =&gt; :plain,\n      :enable_starttls_auto =&gt; true\n  } \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 973, "user_id": 9989384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530602201f9551563176b0b648b7d50b?s=128&d=identicon&r=PG&f=1", "display_name": "Cryptex Technologies", "link": "https://stackoverflow.com/users/9989384/cryptex-technologies"}, "is_accepted": true, "score": 2, "last_activity_date": 1537332285, "creation_date": 1537332285, "answer_id": 52398224, "question_id": 52380448, "link": "https://stackoverflow.com/questions/52380448/not-able-to-deliver-the-mail-in-canvas-lms-what-configuration-setting-i-am-miss/52398224#52398224", "title": "Not able to deliver the mail in canvas lms? What configuration setting i am missing?", "body": "<p>My SMTP settings are right but the in site admin settings there is feature option section there is an option \"Use remote service for notifications\"  is No so is if you use remote service like mailer etc. this option turns into off.\nAnd It's working fine. </p>\n\n<p><a href=\"https://i.stack.imgur.com/4hcly.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4hcly.png\" alt=\"feature option settings \"></a></p>\n"}], "owner": {"reputation": 973, "user_id": 9989384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530602201f9551563176b0b648b7d50b?s=128&d=identicon&r=PG&f=1", "display_name": "Cryptex Technologies", "link": "https://stackoverflow.com/users/9989384/cryptex-technologies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 52398224, "answer_count": 2, "score": 0, "last_activity_date": 1537332285, "creation_date": 1537253137, "question_id": 52380448, "link": "https://stackoverflow.com/questions/52380448/not-able-to-deliver-the-mail-in-canvas-lms-what-configuration-setting-i-am-miss", "title": "Not able to deliver the mail in canvas lms? What configuration setting i am missing?", "body": "<p>This is my outgoing_mail.yml files\nIf click on the forgot password link It is showing in the delayed_job.log\nMy email is deliver got stuck please help me.</p>\n\n<pre><code>production: \n    address: \"smtp.gmail.com\" \n    port: \"587\" \n    user_name: \"xxxxxx@gmail.com\" \n    password: \"password\" \n    authentication: \"plain\" # plain, login, or cram_md5 \n    domain: \"domain_name.com\" \n    outgoing_address: \"xxxxxx@gmail.com\" \n    default_name: \"Instructure Canvas\"\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 14421, "user_id": 836214, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8f33763395d06f0b8a68cb0cfa31a72d?s=128&d=identicon&r=PG", "display_name": "Krease", "link": "https://stackoverflow.com/users/836214/krease"}, "edited": false, "score": 2, "creation_date": 1537241031, "post_id": 52378402, "comment_id": 91701308, "body": "I think I\u2019m missing something - where does 9502 come from"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1537252751, "post_id": 52378402, "comment_id": 91704916, "body": "What are &quot;the two values&quot;?"}, {"owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "edited": false, "score": 0, "creation_date": 1537269565, "post_id": 52378402, "comment_id": 91714801, "body": "I made a correction.  The two values are <code>1234</code> and <code>CID</code>."}], "answers": [{"comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1537247878, "post_id": 52378431, "comment_id": 91702982, "body": "Just in case, it works also with <code>[{&quot;ID&quot;=&gt;&quot;FOO&quot;, &quot;Type&quot;=&gt;&quot;Name&quot;}, {&quot;ID&quot;=&gt;&quot;1234&quot;, &quot;Type&quot;=&gt;&quot;CID&quot;}, {&quot;ID&quot;=&gt;&quot;5678&quot;, &quot;Type&quot;=&gt;&quot;CID&quot;}]</code>, removing <code>.[0]</code>, it returns the array of strings."}], "tags": [], "owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "is_accepted": true, "score": 2, "last_activity_date": 1537248119, "last_edit_date": 1537248119, "creation_date": 1537241011, "answer_id": 52378431, "question_id": 52378402, "link": "https://stackoverflow.com/questions/52378402/combine-the-values-of-two-hash-keys-in-an-array-of-hashes/52378431#52378431", "title": "Combine the values of two hash keys in an array of hashes", "body": "<p>You can do it in one line using:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>a.select{|x| x['Type']=='CID'}\n  .map{|x| \"type=#{x['Type']},id=#{x['ID']}\"}[0]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537245349, "post_id": 52378515, "comment_id": 91702282, "body": "You are depending on the key-value pairs being in a particular order."}, {"owner": {"reputation": 106, "user_id": 10313230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21061b249a7307894515bfb911b5b657?s=128&d=identicon&r=PG&f=1", "display_name": "tekuri", "link": "https://stackoverflow.com/users/10313230/tekuri"}, "reply_to_user": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1537248055, "post_id": 52378515, "comment_id": 91703021, "body": "@GaganGami Thank you, I have fixed the syntax issue"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1537248651, "post_id": 52378515, "comment_id": 91703230, "body": "<code>detect</code> returns <code>nil</code> in case of no match, then <code>nil.values</code> returns an error.  What if the order in the hash is reversed, <code>{&quot;Type&quot;=&gt;&quot;CID&quot;, &quot;ID&quot;=&gt;&quot;5678&quot;}</code>? To fix the syntax need to remove the closed square bracket."}], "tags": [], "owner": {"reputation": 106, "user_id": 10313230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21061b249a7307894515bfb911b5b657?s=128&d=identicon&r=PG&f=1", "display_name": "tekuri", "link": "https://stackoverflow.com/users/10313230/tekuri"}, "is_accepted": false, "score": 1, "last_activity_date": 1537255027, "last_edit_date": 1537255027, "creation_date": 1537241534, "answer_id": 52378515, "question_id": 52378402, "link": "https://stackoverflow.com/questions/52378402/combine-the-values-of-two-hash-keys-in-an-array-of-hashes/52378515#52378515", "title": "Combine the values of two hash keys in an array of hashes", "body": "<p>You may try this:</p>\n\n<p>if we are not having multiple values of Type = \"CID\":</p>\n\n<pre><code>   a.select{|x| x[\"Type\"] == \"CID\"}.map{|x| x.values_at(\"Type\", \"ID\")}.join(\"=\")\n</code></pre>\n\n<p>if we have are having Type=\"CID\"</p>\n\n<pre><code>a.detect{|x| x[\"Type\"]==\"CID\"}.values_at(\"Type\", \"ID\").join(\"=\")\n</code></pre>\n\n<p>If we don't have Type=\"CID\" in above array will throw an error, be cautious.</p>\n\n<p>Need to work in all cases we need to do:</p>\n\n<pre><code> a.detect{|x| x[\"Type\"]==\"CID\"}.values_at(\"Type\", \"ID\").join(\"=\") if a.detect{|x| x[\"Type\"]==\"CID\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1537246172, "last_edit_date": 1537246172, "creation_date": 1537245289, "answer_id": 52379003, "question_id": 52378402, "link": "https://stackoverflow.com/questions/52378402/combine-the-values-of-two-hash-keys-in-an-array-of-hashes/52379003#52379003", "title": "Combine the values of two hash keys in an array of hashes", "body": "<pre><code>a.find { |h| h[\"Type\"] == \"CID\" }&amp;.values_at(\"Type\", \"ID\")&amp;.join(\"=\")\n  #=&gt;\"CID=1234\"\n\na.find { |h| h[\"Type\"] == \"cat\" }&amp;.values_at(\"Type\", \"ID\")&amp;.join(\"=\")\n  #=&gt; nil\n</code></pre>\n\n<p><code>&amp;</code> is Ruby's <a href=\"http://mitrev.net/ruby/2015/11/13/the-operator-in-ruby/\" rel=\"nofollow noreferrer\">safe navigation operator</a>, which made it's debut in Ruby v2.3. I added it to cause <code>nil</code> to be returned if there is no match on <code>h[\"Type\"]</code>.</p>\n"}], "owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 52378431, "answer_count": 3, "score": 0, "last_activity_date": 1537269413, "creation_date": 1537240805, "last_edit_date": 1537269413, "question_id": 52378402, "link": "https://stackoverflow.com/questions/52378402/combine-the-values-of-two-hash-keys-in-an-array-of-hashes", "title": "Combine the values of two hash keys in an array of hashes", "body": "<p>I have an array of hashes:</p>\n\n<pre><code>a = [{\"ID\"=&gt;\"FOO\", \"Type\"=&gt;\"Name\"}, {\"ID\"=&gt;\"1234\", \"Type\"=&gt;\"CID\"}]\n</code></pre>\n\n<p>I'm trying to extract the hash where the <code>Type=='CID'</code>, then combine the two values to result in <code>CID=1234</code>.</p>\n\n<p>I can do this in multiple steps:</p>\n\n<pre><code>h = a.find{|x| x['Type']=='CID'}\n# =&gt; {\"ID\"=&gt;\"1234\", \"Type\"=&gt;\"CID\"}\n\n\"#{h['Type']}=#{h['ID']}\"\n# =&gt; \"CID=1234\"\n</code></pre>\n\n<p>Is there a way to do this in a one liner?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2665, "user_id": 1258001, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/486162db0cc17ae06ab6ad29ecb3f699?s=128&d=identicon&r=PG", "display_name": "Polygon Pusher", "link": "https://stackoverflow.com/users/1258001/polygon-pusher"}, "edited": false, "score": 0, "creation_date": 1537302642, "post_id": 52376849, "comment_id": 91733460, "body": "I didn&#39;t realize the () meant it was optional, the @ was a red herring"}], "tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": true, "score": 2, "last_activity_date": 1537252740, "last_edit_date": 1537252740, "creation_date": 1537226197, "answer_id": 52376849, "question_id": 52376443, "link": "https://stackoverflow.com/questions/52376443/what-kind-of-rails-route-is-this-get-version-interfaceshome/52376849#52376849", "title": "What kind of rails route is this? get &#39;/(@:version)&#39; =&gt; &#39;interfaces#home&#39;", "body": "<p>That is a <strong>regex match</strong> on the route and will assign anything after the <code>@</code> sign to the variable <code>version</code> in your <code>interfaces_controller#home</code></p>\n\n<p>To hit the route, visit <code>/@foobarbaz</code> and the params hash will have a key of <code>:version</code> set to <code>foobarbaz</code></p>\n\n<p>To further drive home, you could do something like this in the routes</p>\n\n<pre><code>get '/(99:version)' =&gt; 'application#index', as: 'home'\n</code></pre>\n\n<p>and hit <code>/99foobarbaz</code> and it will set the same params key of <code>:version</code> with value of <code>foobarbaz</code></p>\n"}], "owner": {"reputation": 2665, "user_id": 1258001, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/486162db0cc17ae06ab6ad29ecb3f699?s=128&d=identicon&r=PG", "display_name": "Polygon Pusher", "link": "https://stackoverflow.com/users/1258001/polygon-pusher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 52376849, "answer_count": 1, "score": -1, "last_activity_date": 1537252740, "creation_date": 1537223115, "question_id": 52376443, "link": "https://stackoverflow.com/questions/52376443/what-kind-of-rails-route-is-this-get-version-interfaceshome", "title": "What kind of rails route is this? get &#39;/(@:version)&#39; =&gt; &#39;interfaces#home&#39;", "body": "<p>I just started a new project and I found a route in the rails router I've never seen before and I'm having a hard time identifying it. </p>\n\n<p>What is the <code>(@:version)</code> of this route? it looks like its being used dynamically as it shows up many times in this project's router.  </p>\n\n<p><code>get '/(@:version)' =&gt; 'interfaces#home', as: 'home'</code></p>\n"}, {"tags": ["ruby", "lint"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537223142, "post_id": 52375777, "comment_id": 91697619, "body": "Looks like a flaw in the (abandoned) library&#39;s design. <a href=\"https://github.com/YorickPeterse/ruby-lint/tree/87842ae295c2283d8e02d951781189486a7cc970/lib/ruby-lint/definitions/core\" rel=\"nofollow noreferrer\">The standard library constants were auto-generated by Rubinius 2.2.3, and are stored here</a>. Assuming those definitions are comprehensive (I didn&#39;t bother checking), my guess is that Rubinius 2.2.3 simply didn&#39;t have a <code>Syslog</code> class, whereas MRI <code>2.3.3</code> does?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537223281, "post_id": 52375777, "comment_id": 91697647, "body": "Regardless, the library seems quite flawed to me. For example, you can mention <code>DateTime</code> in your code and ruby-lint <a href=\"https://github.com/YorickPeterse/ruby-lint/blob/87842ae295c2283d8e02d951781189486a7cc970/lib/ruby-lint/definitions/core/date_time.rb#L7\" rel=\"nofollow noreferrer\">won&#39;t complain</a>, regardless of whether or not you actually <code>require &#39;date-time&#39;</code>. This tool is a <b>static</b> code analysis, so is not aware of the full context in which code is being executed."}], "owner": {"reputation": 13, "user_id": 9893149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad7980868715066d0046c21b9216f6f?s=128&d=identicon&r=PG&f=1", "display_name": "user70436", "link": "https://stackoverflow.com/users/9893149/user70436"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537218793, "creation_date": 1537218793, "question_id": 52375777, "link": "https://stackoverflow.com/questions/52375777/how-can-i-make-ruby-lint-not-report-false-positives-on-undefined-constants", "title": "How can I make ruby-lint not report false-positives on undefined constants?", "body": "<p>I'm trying to use ruby-lint, but have some false positive error.</p>\n\n<p>Versions:</p>\n\n<pre><code>=$ ruby --version\nruby 2.3.3p222 (2016-11-21) [x86_64-linux-gnu]\n\n=$ ruby-lint --version\nwarning: parser/current is loading parser/ruby23, which recognizes\nwarning: 2.3.7-compliant syntax, but you are running 2.3.3.\nwarning: please see https://github.com/whitequark/parser#compatibility-with-ruby-mri.\nruby-lint v2.3.1 on ruby 2.3.3p222 (2016-11-21) [x86_64-linux-gnu]\n</code></pre>\n\n<p>I have a script that does:</p>\n\n<pre><code>require 'syslog'\n</code></pre>\n\n<p>and later on uses Syslog::LOG_* constants.</p>\n\n<p>It works, and is all OK, but ruby-lint reports these as errors:</p>\n\n<pre><code>=$ ruby-lint pg_terminator.rb\n...\ntest.rb: error: line 23, column 23: undefined constant Syslog::LOG_AUTHPRIV\ntest.rb: error: line 23, column 23: undefined constant Syslog\ntest.rb: error: line 24, column 23: undefined constant Syslog::LOG_AUTH\n</code></pre>\n\n<p>and so on.</p>\n\n<p>Is there any way to \"explain\" to ruby-lint that required modules have some visible constants/classes?</p>\n"}, {"tags": ["ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10377046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c958b6347b1a5ae42a408f99a396aba?s=128&d=identicon&r=PG&f=1", "display_name": "reya", "link": "https://stackoverflow.com/users/10377046/reya"}, "edited": false, "score": 0, "creation_date": 1537277238, "post_id": 52382810, "comment_id": 91719913, "body": "Thanks Ben, we&#39;ll probably do that before we release the gem. The plan to eventually share this gem within our company. My question though is why is the gem install failing to recognize the already installed gems which are listed like this - json (2.1.0, default: 2.0.4) openssl (2.1.1, default: 2.0.5) rest-client (2.1.0.rc1)"}, {"owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "reply_to_user": {"reputation": 1, "user_id": 10377046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c958b6347b1a5ae42a408f99a396aba?s=128&d=identicon&r=PG&f=1", "display_name": "reya", "link": "https://stackoverflow.com/users/10377046/reya"}, "edited": false, "score": 0, "creation_date": 1537277590, "post_id": 52382810, "comment_id": 91720175, "body": "Did you require them?"}, {"owner": {"reputation": 1, "user_id": 10377046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c958b6347b1a5ae42a408f99a396aba?s=128&d=identicon&r=PG&f=1", "display_name": "reya", "link": "https://stackoverflow.com/users/10377046/reya"}, "edited": false, "score": 0, "creation_date": 1537278697, "post_id": 52382810, "comment_id": 91720935, "body": "This is just at the gem installation stage, I did require them in the actual code. The install fails to identify any gem which when listed is in the format - &quot;gemname&quot; (version, default: version) or &quot;gemname&quot; (default: version) or any pre-release version."}], "tags": [], "owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "is_accepted": false, "score": 0, "last_activity_date": 1537261280, "creation_date": 1537261280, "answer_id": 52382810, "question_id": 52375299, "link": "https://stackoverflow.com/questions/52375299/getting-an-error-for-ruby-gem-dependencies-in-a-custom-built-gem/52382810#52382810", "title": "Getting an error for ruby gem dependencies in a custom built gem", "body": "<p>You should create a Gemfile, as you would in a normal ruby application and add these gems in there. Once this is done, run <code>bundle install</code> and re-install the app. This should solve your problem!</p>\n\n<p>Hope this helps,</p>\n\n<p>Ben</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10377046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c958b6347b1a5ae42a408f99a396aba?s=128&d=identicon&r=PG&f=1", "display_name": "reya", "link": "https://stackoverflow.com/users/10377046/reya"}, "edited": false, "score": 0, "creation_date": 1537282557, "post_id": 52388402, "comment_id": 91723631, "body": "Yes Peter, I tried that for the gems which have the default versions installed like json and openssl and it still failed but again the intent is to allow users to use our gem and the custom gem is not dependent on any specific versions of these other gems. Whatever way we mention it in the gemspec, it fails to identify a gem which has a default version installed. Another thing I noticed is when I have two version of rest-client (2.1.0.rc1, 2.0.2) then there is no error for rest-client but for json (2.1.0, default: 2.0.4) and openssl (2.1.1, default: 2.0.5), I still get an error."}], "tags": [], "owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "is_accepted": false, "score": 0, "last_activity_date": 1537279499, "creation_date": 1537279499, "answer_id": 52388402, "question_id": 52375299, "link": "https://stackoverflow.com/questions/52375299/getting-an-error-for-ruby-gem-dependencies-in-a-custom-built-gem/52388402#52388402", "title": "Getting an error for ruby gem dependencies in a custom built gem", "body": "<p>Have you tried to specify the versions you want to be used? For example:</p>\n\n<pre><code>spec.add_runtime_dependency \"csv\"\nspec.add_runtime_dependency \"fileutils\"\nspec.add_runtime_dependency \"json\", \"~&gt; 2.04\"\nspec.add_runtime_dependency \"rest-client\", \"~&gt; 2.1.0.rc1\"\nspec.add_runtime_dependency \"openssl\", \"~&gt; 2.05\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10377046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c958b6347b1a5ae42a408f99a396aba?s=128&d=identicon&r=PG&f=1", "display_name": "reya", "link": "https://stackoverflow.com/users/10377046/reya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537279499, "creation_date": 1537216392, "question_id": 52375299, "link": "https://stackoverflow.com/questions/52375299/getting-an-error-for-ruby-gem-dependencies-in-a-custom-built-gem", "title": "Getting an error for ruby gem dependencies in a custom built gem", "body": "<p>I am new to ruby and gem creation and we are trying to build a simple gem and I have given the following dependencies in the gemspec:</p>\n\n<pre><code>spec.add_runtime_dependency \"csv\"\nspec.add_runtime_dependency \"fileutils\"\nspec.add_runtime_dependency \"json\"\nspec.add_runtime_dependency \"rest-client\"\nspec.add_runtime_dependency \"openssl\"\n</code></pre>\n\n<p>The gem install fails with the following error - Could not find a valid gem 'openssl' (>= 0). The same error occurs for json and rest-client as well but when I do a gem list, I can see the following:</p>\n\n<pre><code>csv (3.0.0)\nfileutils (1.1.0)\njson (2.1.0, default: 2.0.4)\nopenssl (2.1.1, default: 2.0.5)\nrest-client (2.1.0.rc1)\n</code></pre>\n\n<p>I tried a few things like uninstalling the above version of rest-client and installing the version 2.0.2, at which point I no longer see an error for rest-client. Could someone help me on how we can define dependencies which would consider default versions as well as versions like 2.1.0.rc1?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "parallel-testing"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1537215021, "post_id": 52374954, "comment_id": 91694798, "body": "<i>&quot;I have 2 sets of tests that can&#39;t run in parallel as they interfere with the state of some other tests&quot;</i> -- Can you elaborate on this point? Ideally, the best solution would be to simply change these tests to that they don&#39;t interfere with one another!"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537215505, "post_id": 52374954, "comment_id": 91694994, "body": "I&#39;m not clear whether running the tests in different processes would even solve the problem... (And so I&#39;m concerned you may be asking an XY problem)"}, {"owner": {"reputation": 251, "user_id": 2390047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dd37035180e1036a1e33c709c8049c9c?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2390047/rahul"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537215560, "post_id": 52374954, "comment_id": 91695025, "body": "@TomLord these are end to end tests. Test 1 goes to a school page and checks that a report is displayed with correct data for all students. Test 2 requires some students to be removed from the school and then go to the same page and check that the correct report is displayed for the remaining students. If these 2 tests are running at the same time and against the same school then the state of the report can&#39;t  be determined. Keeping these tests within a single process to ensure that they run one after the other and between each test the state of the school will be reset."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537218697, "post_id": 52374954, "comment_id": 91696338, "body": "A better solution, Rahul, is to run each each process <b>with a different database</b>. As you will see in <a href=\"https://github.com/grosser/parallel_tests#setup-for-rails\" rel=\"nofollow noreferrer\">the <code>parallel_tests</code> README</a>, it is recommended to define your test database name with <code>&lt;%= ENV[&#39;TEST_ENV_NUMBER&#39;] %&gt;</code> for precisely this reason."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537218815, "post_id": 52374954, "comment_id": 91696384, "body": "Each process uses a unique database. So for example if you run 10 processes then there will be 10 databases. Schools being added/edited/deleted within one process do not affect the other processes."}, {"owner": {"reputation": 251, "user_id": 2390047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dd37035180e1036a1e33c709c8049c9c?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2390047/rahul"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537263801, "post_id": 52374954, "comment_id": 91711288, "body": "Thanks @TomLord. Unfortunately I am testing end to end on an application that uses CosmosDB and I am not using a rails setup. I am not sure I have the option of doing what you are suggesting. It&#39;s not a test databased that I control."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537265690, "post_id": 52374954, "comment_id": 91712456, "body": "Oh...yeah, that makes things difficult. Again, I could ask &quot;why can&#39;t you be in control of the <i>test</i> database?&quot;, but I don&#39;t want to go down a rabbit hole here. You&#39;re going to hit all sorts of problems running tests against a third party, online database that you&#39;re not in control of. (For example, what happens when a second developer joins the project, and you try running tests at the same time??)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537266038, "post_id": 52374954, "comment_id": 91712656, "body": "Taking <a href=\"https://github.com/grosser/parallel_tests/blob/06656a00f5a18a5703e7728ed8614827d3ec0409/lib/parallel_tests/cli.rb#L186\" rel=\"nofollow noreferrer\">a quick glance at the source code</a>, I think you can just supply multiple <code>--single</code> options?? I.e. <code>parallel_rspec spec --single &#39;spec&#47;set_A&#39; --single &#39;spec&#47;set_B&#39;</code>?"}, {"owner": {"reputation": 251, "user_id": 2390047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dd37035180e1036a1e33c709c8049c9c?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2390047/rahul"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537267261, "post_id": 52374954, "comment_id": 91713379, "body": "Yep that&#39;s the first thing I tried. Even if I supply multiple --single flags it clubs all of those together in a single process not separate single processes. This is my actual question."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537267442, "post_id": 52374954, "comment_id": 91713492, "body": "<code>--isolate</code>? I&#39;m just going off the README here."}, {"owner": {"reputation": 251, "user_id": 2390047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dd37035180e1036a1e33c709c8049c9c?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2390047/rahul"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537267534, "post_id": 52374954, "comment_id": 91713544, "body": "Yeah, that just ensures that no other tests are run in that single process. It doesn&#39;t affect the tests that actually go in the process in the first place"}], "owner": {"reputation": 251, "user_id": 2390047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dd37035180e1036a1e33c709c8049c9c?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2390047/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537214707, "creation_date": 1537214707, "question_id": 52374954, "link": "https://stackoverflow.com/questions/52374954/how-to-run-non-parallel-in-more-than-one-process", "title": "How to run non-parallel in more than one process?", "body": "<p>I am using <code>parallel_tests</code> gem and more specifically <code>parallel_rspec</code>. I have 2 sets of tests that can't run in parallel as they interfere with the state of some other tests. </p>\n\n<p>Currently I am doing \n<code>parallel_rspec spec --single 'spec/set_A'</code></p>\n\n<p>I now have the need to also run <code>set_B</code> non-parallely but how do I ensure that it runs in its own process and not with <code>set_A's</code> process above?</p>\n\n<p>I have tried <code>parallel_rspec spec --single 'spec/set_A|set_B'</code> but it runs both sets in a single process which makes that process run for a really long time. Passing to separate <code>--single</code> flags also doesn't seem to achieve that.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "security", "actioncontroller", "brakeman"], "answers": [{"comments": [{"owner": {"reputation": 346, "user_id": 5331859, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ddfcdd5d8fc6e4d7cebc17d48a19600?s=128&d=identicon&r=PG&f=1", "display_name": "zasman", "link": "https://stackoverflow.com/users/5331859/zasman"}, "edited": false, "score": 1, "creation_date": 1537911685, "post_id": 52374726, "comment_id": 91954572, "body": "Sorry I forgot to answer sooner! This pretty much answered my question. Thanks"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 12, "last_activity_date": 1537214402, "last_edit_date": 1537214402, "creation_date": 1537213670, "answer_id": 52374726, "question_id": 52374655, "link": "https://stackoverflow.com/questions/52374655/ruby-on-rails-when-to-use-params-permit-and-how-to-replace-it/52374726#52374726", "title": "Ruby on Rails - When to use params.permit! and how to replace it", "body": "<p><code>params.permit!</code> whitelists <strong>all attributes</strong> leading to the vulnerabilities of mass assignment. The best way to get around this is by whitelisting only the <strong>necessary attributes</strong> like so</p>\n\n<pre><code>params.permit(:attr1,:attr2..)\n</code></pre>\n\n<p>Even better, use <a href=\"https://api.rubyonrails.org/classes/ActionController/Parameters.html#method-i-require\" rel=\"noreferrer\"><em><code>require</code></em></a> with <a href=\"https://api.rubyonrails.org/classes/ActionController/Parameters.html#method-i-permit\" rel=\"noreferrer\"><em><code>permit</code></em></a></p>\n\n<blockquote>\n  <p>Allows you to choose which attributes should be whitelisted for mass\n  updating and thus prevent accidentally exposing that which shouldn't\n  be exposed. Provides two methods for this purpose: require and permit.\n  The former is used to mark parameters as required. The latter is used\n  to set the parameter as permitted and limit which attributes should be\n  allowed for mass updating.</p>\n</blockquote>\n\n<pre><code>params.require(:key).permit(:attr1, :attr2..)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 346, "user_id": 5331859, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ddfcdd5d8fc6e4d7cebc17d48a19600?s=128&d=identicon&r=PG&f=1", "display_name": "zasman", "link": "https://stackoverflow.com/users/5331859/zasman"}, "edited": false, "score": 0, "creation_date": 1537215120, "post_id": 52374745, "comment_id": 91694847, "body": "That sounds like something that may have happened. So, params.permit(:attribute1, :attribute2) before each method?"}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "reply_to_user": {"reputation": 346, "user_id": 5331859, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ddfcdd5d8fc6e4d7cebc17d48a19600?s=128&d=identicon&r=PG&f=1", "display_name": "zasman", "link": "https://stackoverflow.com/users/5331859/zasman"}, "edited": false, "score": 0, "creation_date": 1537257037, "post_id": 52374745, "comment_id": 91707308, "body": "First, Pavans answer is more complete and quicker then mine. I would recommend to select it as the correct answer. Second: In most cases a crud-controller has only two actions using the params: update and create. Often (not always!) both actions are permitting the same parameters, so in a controller for a &#39;person&#39; defining &#39;person_params&#39; once should be enough."}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "reply_to_user": {"reputation": 346, "user_id": 5331859, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ddfcdd5d8fc6e4d7cebc17d48a19600?s=128&d=identicon&r=PG&f=1", "display_name": "zasman", "link": "https://stackoverflow.com/users/5331859/zasman"}, "edited": false, "score": 0, "creation_date": 1537257082, "post_id": 52374745, "comment_id": 91707337, "body": "I would recomend you to read the rails guide for strong parameters: <a href=\"https://edgeguides.rubyonrails.org/action_controller_overview.html#strong-parameters\" rel=\"nofollow noreferrer\">edgeguides.rubyonrails.org/&hellip;</a>"}], "tags": [], "owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "is_accepted": false, "score": 2, "last_activity_date": 1537213746, "creation_date": 1537213746, "answer_id": 52374745, "question_id": 52374655, "link": "https://stackoverflow.com/questions/52374655/ruby-on-rails-when-to-use-params-permit-and-how-to-replace-it/52374745#52374745", "title": "Ruby on Rails - When to use params.permit! and how to replace it", "body": "<p>I assume that someone added the params.permit! after a rails upgrade to avoid looking into \"strong parameters\" and setting it up correctly.</p>\n\n<p>The correct way to fix this is by going through every controller and reviewing what params you need and want to permit for every action, and then using params.permit (without the exclamation mark) to set up the whitelist for permitted paramters:</p>\n\n<p><a href=\"https://apidock.com/rails/ActionController/Parameters/permit\" rel=\"nofollow noreferrer\">https://apidock.com/rails/ActionController/Parameters/permit</a></p>\n"}, {"tags": [], "owner": {"reputation": 346, "user_id": 5331859, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ddfcdd5d8fc6e4d7cebc17d48a19600?s=128&d=identicon&r=PG&f=1", "display_name": "zasman", "link": "https://stackoverflow.com/users/5331859/zasman"}, "is_accepted": false, "score": 0, "last_activity_date": 1540824857, "creation_date": 1540824857, "answer_id": 53048111, "question_id": 52374655, "link": "https://stackoverflow.com/questions/52374655/ruby-on-rails-when-to-use-params-permit-and-how-to-replace-it/53048111#53048111", "title": "Ruby on Rails - When to use params.permit! and how to replace it", "body": "<p>I also found that using the <code>to_unsafe_hash</code> method on individual param calls will work and get around the Brakeman warning. Some info on the method here: <a href=\"https://apidock.com/rails/v4.2.7/ActionController/Parameters/to_unsafe_hash\" rel=\"nofollow noreferrer\">https://apidock.com/rails/v4.2.7/ActionController/Parameters/to_unsafe_hash</a></p>\n"}], "owner": {"reputation": 346, "user_id": 5331859, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ddfcdd5d8fc6e4d7cebc17d48a19600?s=128&d=identicon&r=PG&f=1", "display_name": "zasman", "link": "https://stackoverflow.com/users/5331859/zasman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5681, "favorite_count": 4, "accepted_answer_id": 52374726, "answer_count": 3, "score": 3, "last_activity_date": 1540824857, "creation_date": 1537213336, "question_id": 52374655, "link": "https://stackoverflow.com/questions/52374655/ruby-on-rails-when-to-use-params-permit-and-how-to-replace-it", "title": "Ruby on Rails - When to use params.permit! and how to replace it", "body": "<p>I'm working on a legacy rails application and the controllers have many instances of <code>params.permit!</code>. When running a Brakeman scan on it, <code>params.permit!</code> opens up the application to mass assignment vulnerabilities.</p>\n\n<p>My question is- what is the most effective way to get around this params.permit! vulnerability and replace it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis"], "answers": [{"tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": false, "score": 1, "last_activity_date": 1537214163, "creation_date": 1537214163, "answer_id": 52374832, "question_id": 52374229, "link": "https://stackoverflow.com/questions/52374229/error-connecting-to-redis-on-127-0-0-16379econnrefused-on-rails-application/52374832#52374832", "title": "Error connecting to Redis on 127.0.0.1:6379(ECONNREFUSED) on rails application", "body": "<p>Rails does not start a redis server.  The config you are providing there is merely setting up the redis client to communicate to a redis server.  You must install and start redis in order for it to have something to connect to.</p>\n\n<p><a href=\"https://redislabs.com/ebook/appendix-a/a-3-installing-on-windows/a-3-2-installing-redis-on-window/\" rel=\"nofollow noreferrer\">https://redislabs.com/ebook/appendix-a/a-3-installing-on-windows/a-3-2-installing-redis-on-window/</a></p>\n"}, {"tags": [], "owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "is_accepted": false, "score": 1, "last_activity_date": 1537256600, "creation_date": 1537256600, "answer_id": 52381403, "question_id": 52374229, "link": "https://stackoverflow.com/questions/52374229/error-connecting-to-redis-on-127-0-0-16379econnrefused-on-rails-application/52381403#52381403", "title": "Error connecting to Redis on 127.0.0.1:6379(ECONNREFUSED) on rails application", "body": "<p>As per the description mentioned in the post you were able to run redis commands on terminal after running the redis-server.</p>\n\n<blockquote>\n  <p>That's why when I run zadd hoge 1 1 and zrange hoge 0 -1 etc on\n  tarminal by using redis-cli after ruing redis-server, I got outsputs\n  without any problem.</p>\n</blockquote>\n\n<p>But when running a rails application it seems like your redis-server was not running that is why it is saying error connecting to localhost:6379</p>\n\n<p>Try running the below mentioned command in a new tab in parallel with rails server</p>\n\n<pre><code>redis-server \n</code></pre>\n\n<p>If server is already running then close it using below mentioned command and then start again</p>\n\n<pre><code>redis-cli    #shutdown #to stop the server\nredis-server #to start the server again\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10373026"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3493, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1537256600, "creation_date": 1537210983, "last_edit_date": 1537238866, "question_id": 52374229, "link": "https://stackoverflow.com/questions/52374229/error-connecting-to-redis-on-127-0-0-16379econnrefused-on-rails-application", "title": "Error connecting to Redis on 127.0.0.1:6379(ECONNREFUSED) on rails application", "body": "<p>By using Redis, I tried creating ranking system on Ruby on rails. </p>\n\n<p>My environments: windows10, vagrant, Ruby -v 2.2.3, rails -v 4.2.5, mysql2 -v 0.3.18...</p>\n\n<p>However I got the following error.</p>\n\n<p><strong>Error connecting to Redis on 127.0.0.1:6379 (ECONNREFUSED)</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/oByPh.jpg\" rel=\"nofollow noreferrer\">this is error pic on rails application...</a></p>\n\n<p>I guess that something is wrong with not code in app/posts_controller.rb but my other setting files.</p>\n\n<p>That's why when I run <code>zadd hoge 1 1</code> and <code>zrange hoge 0 -1</code> etc on tarminal by using <code>redis-cli</code> after ruing <code>redis-server</code>, I got outsputs without any problem. </p>\n\n<p>The following files which is related to my rails application:</p>\n\n<p><strong>gemfile.lock</strong></p>\n\n<p>First I run bundle install <code>gem 'redis'</code> and <code>gem 'redis-rails'</code>.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>GEM\n  remote: https://rubygems.org/\n  specs:\n    actionmailer (4.2.5)\n      actionpack (= 4.2.5)\n      actionview (= 4.2.5)\n      activejob (= 4.2.5)\n      mail (~&gt; 2.5, &gt;= 2.5.4)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n    actionpack (4.2.5)\n      actionview (= 4.2.5)\n      activesupport (= 4.2.5)\n      rack (~&gt; 1.6)\n      rack-test (~&gt; 0.6.2)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.2)\n    actionview (4.2.5)\n      activesupport (= 4.2.5)\n      builder (~&gt; 3.1)\n      erubis (~&gt; 2.7.0)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.2)\n    activejob (4.2.5)\n      activesupport (= 4.2.5)\n      globalid (&gt;= 0.3.0)\n    activemodel (4.2.5)\n      activesupport (= 4.2.5)\n      builder (~&gt; 3.1)\n    activerecord (4.2.5)\n      activemodel (= 4.2.5)\n      activesupport (= 4.2.5)\n      arel (~&gt; 6.0)\n    activesupport (4.2.5)\n      i18n (~&gt; 0.7)\n      json (~&gt; 1.7, &gt;= 1.7.7)\n      minitest (~&gt; 5.1)\n      thread_safe (~&gt; 0.3, &gt;= 0.3.4)\n      tzinfo (~&gt; 1.1)\n    arel (6.0.4)\n    bcrypt (3.1.12)\n    binding_of_caller (0.8.0)\n      debug_inspector (&gt;= 0.0.1)\n    builder (3.2.3)\n    byebug (10.0.2)\n    coderay (1.1.2)\n    coffee-rails (4.1.1)\n      coffee-script (&gt;= 2.2.0)\n      railties (&gt;= 4.0.0, &lt; 5.1.x)\n    coffee-script (2.4.1)\n      coffee-script-source\n      execjs\n    coffee-script-source (1.12.2)\n    concurrent-ruby (1.0.5)\n    crass (1.0.4)\n    debug_inspector (0.0.3)\n    devise (4.5.0)\n      bcrypt (~&gt; 3.0)\n      orm_adapter (~&gt; 0.1)\n      railties (&gt;= 4.1.0, &lt; 6.0)\n      responders\n      warden (~&gt; 1.2.3)\n    erubis (2.7.0)\n    execjs (2.7.0)\n    globalid (0.4.1)\n      activesupport (&gt;= 4.2.0)\n    hike (1.2.3)\n    i18n (0.9.5)\n      concurrent-ruby (~&gt; 1.0)\n    jbuilder (2.7.0)\n      activesupport (&gt;= 4.2.0)\n      multi_json (&gt;= 1.2)\n    jquery-rails (4.3.3)\n      rails-dom-testing (&gt;= 1, &lt; 3)\n      railties (&gt;= 4.2.0)\n      thor (&gt;= 0.14, &lt; 2.0)\n    json (1.8.6)\n    loofah (2.2.2)\n      crass (~&gt; 1.0.2)\n      nokogiri (&gt;= 1.5.9)\n    mail (2.7.0)\n      mini_mime (&gt;= 0.1.1)\n    method_source (0.9.0)\n    mini_mime (1.0.1)\n    mini_portile2 (2.3.0)\n    minitest (5.11.3)\n    multi_json (1.13.1)\n    mysql2 (0.3.18)\n    nokogiri (1.8.4)\n      mini_portile2 (~&gt; 2.3.0)\n    orm_adapter (0.5.0)\n    pry (0.11.3)\n      coderay (~&gt; 1.1.0)\n      method_source (~&gt; 0.9.0)\n    pry-rails (0.3.6)\n      pry (&gt;= 0.10.4)\n    rack (1.6.10)\n    rack-test (0.6.3)\n      rack (&gt;= 1.0)\n    rails (4.2.5)\n      actionmailer (= 4.2.5)\n      actionpack (= 4.2.5)\n      actionview (= 4.2.5)\n      activejob (= 4.2.5)\n      activemodel (= 4.2.5)\n      activerecord (= 4.2.5)\n      activesupport (= 4.2.5)\n      bundler (&gt;= 1.3.0, &lt; 2.0)\n      railties (= 4.2.5)\n      sprockets-rails\n    rails-deprecated_sanitizer (1.0.3)\n      activesupport (&gt;= 4.2.0.alpha)\n    rails-dom-testing (1.0.9)\n      activesupport (&gt;= 4.2.0, &lt; 5.0)\n      nokogiri (~&gt; 1.6)\n      rails-deprecated_sanitizer (&gt;= 1.0.1)\n    rails-html-sanitizer (1.0.4)\n      loofah (~&gt; 2.2, &gt;= 2.2.2)\n    railties (4.2.5)\n      actionpack (= 4.2.5)\n      activesupport (= 4.2.5)\n      rake (&gt;= 0.8.7)\n      thor (&gt;= 0.18.1, &lt; 2.0)\n    rake (12.3.1)\n    rdoc (4.3.0)\n    redis (3.2.0)\n    redis-actionpack (5.0.2)\n      actionpack (&gt;= 4.0, &lt; 6)\n      redis-rack (&gt;= 1, &lt; 3)\n      redis-store (&gt;= 1.1.0, &lt; 2)\n    redis-activesupport (5.0.7)\n      activesupport (&gt;= 3, &lt; 6)\n      redis-store (&gt;= 1.3, &lt; 2)\n    redis-rack (2.0.4)\n      rack (&gt;= 1.5, &lt; 3)\n      redis-store (&gt;= 1.2, &lt; 2)\n    redis-rails (5.0.2)\n      redis-actionpack (&gt;= 5.0, &lt; 6)\n      redis-activesupport (&gt;= 5.0, &lt; 6)\n      redis-store (&gt;= 1.2, &lt; 2)\n    redis-store (1.5.0)\n      redis (&gt;= 2.2, &lt; 5)\n    responders (2.4.0)\n      actionpack (&gt;= 4.2.0, &lt; 5.3)\n      railties (&gt;= 4.2.0, &lt; 5.3)\n    sass (3.2.19)\n    sass-rails (4.0.5)\n      railties (&gt;= 4.0.0, &lt; 5.0)\n      sass (~&gt; 3.2.2)\n      sprockets (~&gt; 2.8, &lt; 3.0)\n      sprockets-rails (~&gt; 2.0)\n    sdoc (0.4.2)\n      json (~&gt; 1.7, &gt;= 1.7.7)\n      rdoc (~&gt; 4.0)\n    spring (2.0.2)\n      activesupport (&gt;= 4.2)\n    sprockets (2.11.0)\n      hike (~&gt; 1.2)\n      multi_json (~&gt; 1.0)\n      rack (~&gt; 1.0)\n      tilt (~&gt; 1.1, != 1.3.0)\n    sprockets-rails (2.3.3)\n      actionpack (&gt;= 3.0)\n      activesupport (&gt;= 3.0)\n      sprockets (&gt;= 2.8, &lt; 4.0)\n    thor (0.20.0)\n    thread_safe (0.3.6)\n    tilt (1.4.1)\n    turbolinks (5.2.0)\n      turbolinks-source (~&gt; 5.2)\n    turbolinks-source (5.2.0)\n    tzinfo (1.2.5)\n      thread_safe (~&gt; 0.1)\n    uglifier (4.1.19)\n      execjs (&gt;= 0.3.0, &lt; 3)\n    warden (1.2.7)\n      rack (&gt;= 1.0)\n    web-console (2.3.0)\n      activemodel (&gt;= 4.0)\n      binding_of_caller (&gt;= 0.7.2)\n      railties (&gt;= 4.0)\n      sprockets-rails (&gt;= 2.0, &lt; 4.0)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  byebug\n  coffee-rails (~&gt; 4.1.0)\n  devise\n  jbuilder (~&gt; 2.0)\n  jquery-rails\n  mysql2 (= 0.3.18)\n  pry-rails\n  rails (= 4.2.5)\n  redis (= 3.2.0)\n  redis-rails\n  sass-rails (~&gt; 4.0.2)\n  sdoc (~&gt; 0.4.0)\n  spring\n  sprockets (= 2.11.0)\n  turbolinks\n  uglifier (&gt;= 1.3.0)\n  web-console (~&gt; 2.0)\n\nBUNDLED WITH\n   1.10.6\n</code></pre>\n\n\n\n<p><strong>config/initializes/redis.rb</strong></p>\n\n<p>Second, I created this file.\n</p>\n\n<pre><code>require 'redis'\n\nuri = URI.parse(ENV[\"REDIS\"])\nREDIS = Redis.new(host: uri.host, port: uri.port)\n</code></pre>\n\n\n\n<p><strong>config/environments/development.rb</strong></p>\n\n<p>Third, I added <code>ENV[\"REDIS\"] = \"localhost:6379\"</code> in the lowest line.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>Rails.application.configure do\n  # Settings specified here will take precedence over those in config/application.rb.\n\n  # In the development environment your application's code is reloaded on\n  # every request. This slows down response time but is perfect for development\n  # since you don't have to restart the web server when you make code changes.\n  config.cache_classes = false\n\n  # Do not eager load code on boot.\n  config.eager_load = false\n\n  # Show full error reports and disable caching.\n  config.consider_all_requests_local       = true\n  config.action_controller.perform_caching = false\n\n  # Don't care if the mailer can't send.\n  config.action_mailer.raise_delivery_errors = false\n\n  # Print deprecation notices to the Rails logger.\n  config.active_support.deprecation = :log\n\n  # Raise an error on page load if there are pending migrations.\n  config.active_record.migration_error = :page_load\n\n  # Debug mode disables concatenation and preprocessing of assets.\n  # This option may cause significant delays in view rendering with a large\n  # number of complex assets.\n  config.assets.debug = true\n\n  # Asset digests allow you to set far-future HTTP expiration dates on all assets,\n  # yet still be able to expire them through the digest params.\n  config.assets.digest = true\n\n  # Adds additional error checking when serving assets at runtime.\n  # Checks for improperly declared sprockets dependencies.\n  # Raises helpful error messages.\n  config.assets.raise_runtime_errors = true\n\n  # Raises error for missing translations\n  # config.action_view.raise_on_missing_translations = true\n\n  ENV[\"REDIS\"] = \"localhost:6379\"\nend\n</code></pre>\n\n\n\n<p><strong>app/controller/posts_controller.rb</strong></p>\n\n<p>Finally, I described new code in <strong>def index</strong> and <strong>def show</strong>.</p>\n\n<p><strong>ids = REDIS.zrevrange \"ranking\", 0, -1\n@ranking_posts = Post.where(id: ids)</strong></p>\n\n<p><strong>REDIS.zincrby \"ranking\", 1, \"#{@post.id}\"</strong></p>\n\n<p>By the way if I didn't describe two descriptions above,\nof course my rails application worked.\n</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n\n  def index\n    @posts = Post.all.order(id: :desc)\n\n\n    ids = REDIS.zrevrange \"ranking\", 0, -1\n    #the order of posts ranking\n    @ranking_posts = Post.where(id: ids)\n\n  end\n\n\n  def show\n    @post = Post.find_by(id: params[:id])\n\n    # update ranking\n    REDIS.zincrby \"ranking\", 1, \"#{@post.id}\"\n  end\n\n\n\n  def new\n  end\n\n  def create\n    Post.create(name: post_params[:name], text: post_params[:text], user_id: current_user.id)\n\n    redirect_to(\"/\")\n  end\n\n  def destroy\n    post = Post.find(params[:id])\n    if post.user_id == current_user.id\n      post.destroy\n    end\n    redirect_to(\"/\")\n</code></pre>\n\n\n\n<p>Please tell me how can I fix this error...\uff08\uff1b^\uff1b\uff09</p>\n"}, {"tags": ["ruby", "rspec", "sinatra", "rspec3"], "answers": [{"tags": [], "owner": {"reputation": 196, "user_id": 7111504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZuKH.jpg?s=128&g=1", "display_name": "Macro", "link": "https://stackoverflow.com/users/7111504/macro"}, "is_accepted": true, "score": 1, "last_activity_date": 1537213802, "creation_date": 1537213802, "answer_id": 52374760, "question_id": 52374139, "link": "https://stackoverflow.com/questions/52374139/mock-the-restclient-in-a-mixin/52374760#52374760", "title": "Mock the RestClient in a mixin", "body": "<p>You can use the <a href=\"https://github.com/bblimke/webmock\" rel=\"nofollow noreferrer\">Webmock Gem</a> to stub the request and return the body/status code you want.</p>\n\n<ul>\n<li>Add webmock gem to your gem file <code>gem webmock</code></li>\n<li>Add webmock to your spec helper <code>require 'webmock/rspec'</code></li>\n</ul>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'spec_helper'\nrequire File.expand_path('../../../lib/restable', __FILE__)\nDescribe Restable do\n\n  # create dummy object w/ mixin\n  before(:each) do\n    @test_obj = Object.new\n    @test_obj.extend(Restable)\n  end\n\n  url = 'http://domain.tld/'\n\n  context \"get\" do\n\n    it \"an anonymous GET request returns success\" do\n      WebMock.stub_request(:get, url).to_return(status: [200, 'OK'], body: { foo: 'bar' }.to_json)\n      response = @test_obj.get url\n      expect(response.code).to eq(200)\n    end\n\n    it \"a GET request returns success (200) when valid credentials are supplied to a protected resource\" do\n      url = 'http://domain.tld/private'\n      WebMock.stub_request(:get, url).with(basic_auth: ['valid_user', 'valid_pass']).to_return(status: [200, 'OK'], body: { foo: 'bar' }.to_json)\n      options = {user: 'valid_user', password: 'valid_password'}\n      response = @test_obj.get url, options\n      expect(response.code).to eq(200)\n    end\n\n    it \"a GET request returns FORBIDDEN (403) when invalid credentials are supplied to a protected resource\" do\n      url = 'http://domain.tld/private'\n      WebMock.stub_request(:get, url).with(basic_auth: ['valid_user', 'invalid_pass']).to_return(status: [403, 'OK'], body: { foo: 'bar' }.to_json)      \n      options = {user: 'valid_user', password: 'invalid_password'}\n      response = @test_obj.get url, {}\n      expect(response.code).to eq(403)\n    end\n\n  end # /context\nend # /describe\n</code></pre>\n"}], "owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 52374760, "answer_count": 1, "score": 0, "last_activity_date": 1537213802, "creation_date": 1537210545, "question_id": 52374139, "link": "https://stackoverflow.com/questions/52374139/mock-the-restclient-in-a-mixin", "title": "Mock the RestClient in a mixin", "body": "<p>I have a mixin that uses the <code>RestClient</code>:</p>\n\n<pre><code>module Restable\n  def get(url, options={})\n\n      response = RestClient::Request.new(\n        :method =&gt; :get,\n        :url =&gt; url,\n        :user =&gt; options[:user],\n        :password =&gt; options[:password],\n        :headers =&gt; { \n          :accept =&gt; :json,\n          :content_type =&gt; :json\n        }\n      ).execute\n    response\n\n  end # /get\nend # /Restable\n</code></pre>\n\n<p>I'd like to able to test the usage of the mixin with valid and invalid credentials.</p>\n\n<p>I'm having difficultly mocking the <code>RestClient</code>.  This approach generates errors (<code>warning: previous definition of RestClient was here</code>):</p>\n\n<pre><code>require 'spec_helper'\nrequire File.expand_path('../../../lib/restable', __FILE__)\nDescribe Restable do\n\n  # create dummy object w/ mixin\n  before(:each) do\n    @test_obj = Object.new\n    @test_obj.extend(Restable)\n  end\n\n  url = 'http://domain.tld/'\n\n  context \"get\" do\n\n    it \"an anonymous GET request returns success\" do\n\n      RestClient = double\n      client = double\n      client.stub(:code) { 200 }\n      RestClient.stub(:get) { client }\n\n      response = @test_obj.get url\n      expect(response.code).to eq(200)\n    end\n\n    it \"a GET request returns success (200) when valid credentials are supplied to a protected resource\" do\n\n      RestClient = double\n      client = double\n      client.stub(:code) { 200 }\n      RestClient.stub(:get) { client }\n\n      url = 'http://domain.tld/private'\n      options = {user: 'valid_user', password: 'valid_password'}\n      response = @test_obj.get url, options\n      expect(response.code).to eq(200)\n    end\n\n    it \"a GET request returns FORBIDDEN (403) when invalid credentials are supplied to a protected resource\" do\n\n      RestClient = double\n      client = double\n      client.stub(:code) { 403 }\n      RestClient.stub(:get) { client }\n\n      url = 'http://domain.tld/private'      \n      response = @test_obj.get url, {}\n      expect(response.code).to eq(403)\n    end\n\n  end # /context\nend # /describe\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537212484, "post_id": 52374129, "comment_id": 91693767, "body": "I believe that is the log that appeared when the  <code>show.html.erb</code> is loaded. Can you check once again by submiting the form."}, {"owner": {"reputation": 177, "user_id": 10095385, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQNUq2AuhX0/AAAAAAAAAAI/AAAAAAAACeM/W_ToTsU2GKw/photo.jpg?sz=128", "display_name": "Sachin", "link": "https://stackoverflow.com/users/10095385/sachin"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537213687, "post_id": 52374129, "comment_id": 91694247, "body": "Yup I checked again, that&#39;s what the server is doing upon hitting submit."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537213925, "post_id": 52374129, "comment_id": 91694357, "body": "Totally weird. If thats so, I wonder where is the <code>params</code> hash from the form"}, {"owner": {"reputation": 177, "user_id": 10095385, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQNUq2AuhX0/AAAAAAAAAAI/AAAAAAAACeM/W_ToTsU2GKw/photo.jpg?sz=128", "display_name": "Sachin", "link": "https://stackoverflow.com/users/10095385/sachin"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537215385, "post_id": 52374129, "comment_id": 91694946, "body": "Got it working!  Please close"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537215465, "post_id": 52374129, "comment_id": 91694987, "body": "Great! Go ahead and post an answer so that it will help someone in the future."}, {"owner": {"reputation": 177, "user_id": 10095385, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQNUq2AuhX0/AAAAAAAAAAI/AAAAAAAACeM/W_ToTsU2GKw/photo.jpg?sz=128", "display_name": "Sachin", "link": "https://stackoverflow.com/users/10095385/sachin"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537309565, "post_id": 52374129, "comment_id": 91735837, "body": "The solution was:"}], "answers": [{"tags": [], "owner": {"reputation": 177, "user_id": 10095385, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQNUq2AuhX0/AAAAAAAAAAI/AAAAAAAACeM/W_ToTsU2GKw/photo.jpg?sz=128", "display_name": "Sachin", "link": "https://stackoverflow.com/users/10095385/sachin"}, "is_accepted": true, "score": 0, "last_activity_date": 1537309866, "creation_date": 1537309866, "answer_id": 52395454, "question_id": 52374129, "link": "https://stackoverflow.com/questions/52374129/cannot-upload-user-profile-photos-rails-5-without-gems/52395454#52395454", "title": "Cannot upload user profile photos rails 5 (without gems)", "body": "<p>The solution was the changes in the bold:</p>\n\n<pre><code>def update\n        if current_user.id != @user_id\n            flash[:notice] = \"You cannot update this user\"\n        end\n        @user = User.find(params[:id])\n        **if @user.photo.attach(user_params[:photo])**\n          flash[:notice] = \"Profile updated\"\n          redirect_to @user\n\n        else\n          flash[:notice] = \"Not uploaded\"\n          redirect_to @user\n\n        end\nend\n</code></pre>\n\n<p>And comment_params adjusted to:</p>\n\n<pre><code>        def user_params\n            params.require(:user).permit(:username, :password, :photo, \n            :email)\n        end\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 10095385, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQNUq2AuhX0/AAAAAAAAAAI/AAAAAAAACeM/W_ToTsU2GKw/photo.jpg?sz=128", "display_name": "Sachin", "link": "https://stackoverflow.com/users/10095385/sachin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 52395454, "answer_count": 1, "score": 0, "last_activity_date": 1537309866, "creation_date": 1537210493, "last_edit_date": 1537217694, "question_id": 52374129, "link": "https://stackoverflow.com/questions/52374129/cannot-upload-user-profile-photos-rails-5-without-gems", "title": "Cannot upload user profile photos rails 5 (without gems)", "body": "<p>I'm trying to upload user photos in the user show page, relatively new to rails project.  I'm going to include my users show html erb page, as well as my user controllers and user model, along with what the server is doing when I press the \"update\" button.</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n    skip_before_action :verify_authentication, only: [:new, :create, :index]\n\n\n    def create \n        @user = User.new(user_params)\n\n        if @user.save\n            session[:user_id] = @user.id\n            redirect_to root_path, notice: \"User successfully created.\"\n        else\n            redirect_to new_user_path, notice: \"Something went wrong, please try again.\"\n        end\n    end\n    def index\n    end\n\n    def update\n        if current_user != @user_id\n            flash[:notice] = \"You cannot update this user\"\n        end\n        @user = User.find(params[:id])\n        if @user.update_attributes(user_params)\n          flash[:notice] = \"Profile updated\"\n          redirect_to @user\n        else\n          flash[:notice] = \"Not uploaded\"\n          redirect_to @user\n        end\n    end\n\n    def new\n        @user = User.new\n    end\n\n    def show\n        @user = User.find(params[:id])\n        @posts = @user.posts\n    end\n\n    def destroy\n        if current_user == @user\n            @user.destroy\n        else\n            render json: @user.errors, status: :unprocessable_entity\n        end\n    end\n\n    private\n        def user_params\n            params.permit(:username, :password, :photo)\n        end\nend\n</code></pre>\n\n<p>User model</p>\n\n<pre><code>class User &lt; ApplicationRecord\n    has_secure_token :api_token\n    has_secure_password\n    validates :username, uniqueness: true\n    validates :password, presence: true, length: {minimum: 5}\n    has_many :posts, dependent: :destroy\n    has_many :comments, dependent: :destroy\n    has_one_attached :photo\nend\n</code></pre>\n\n<p>Users show.html.erb page </p>\n\n<pre><code>    &lt;h1 class='h3 mt-5 mb-3 font-weight-normal text-center'&gt;&lt;%= @user.username %&gt;  &lt;/h1&gt;\n\n&lt;% if notice %&gt;\n&lt;p&gt;&lt;%= notice %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n\n\n&lt;% if @user.photo.attached? %&gt;\n  &lt;p&gt;\n    &lt;strong&gt; Profile Photo &lt;/strong&gt;\n      &lt;%= image_tag @user.photo, style: \"max-width: 100px, max-height: 100px\"  %&gt;\n  &lt;/p&gt;\n&lt;% end %&gt;\n\n&lt;div class=\"text-center\"&gt;\n&lt;p&gt; Upload a profile photo: &lt;/p&gt;\n  &lt;%= form_with model: @user, local:true do |form| %&gt;\n    &lt;%= form.label :photo %&gt;\n    &lt;%= form.file_field :photo %&gt;\n    &lt;%= form.submit %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n&lt;%= link_to 'Back', root_path %&gt;\n&lt;/div&gt;\n\n&lt;div&gt;\n&lt;% @posts.each do |post| %&gt;\n    &lt;div class=\"card border-secondary text-center\" style=\"width: 30rem;\"&gt;\n        &lt;div class=\"card-body\"&gt;\n          &lt;h3 class=\"card-title\"&gt;\n          &lt;%= post.question %&gt;\n          &lt;/h3&gt;\n        &lt;/div&gt;\n          &lt;p class=\"card-text\"&gt;\n          &lt;%= post.body %&gt;\n          &lt;/p&gt;\n          &lt;p class=\"card-text\"&gt;\n          &lt;%= link_to 'Show', post_path(post) %&gt;\n          &lt;/p&gt;\n  &lt;% end %&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>Lastly the server when I hit submit.</p>\n\n<pre><code>Started GET \"/users/180\" for 127.0.0.1 at 2018-09-17 14:45:03 -0400\nProcessing by UsersController#show as HTML\n  Parameters: {\"id\"=&gt;\"180\"}\n  User Load (0.2ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT ?  [[\"id\", 180], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/application_controller.rb:18\n  User Load (0.3ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT ?  [[\"id\", 180], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/users_controller.rb:37\n  Rendering users/show.html.erb within layouts/application\n  ActiveStorage::Attachment Load (0.2ms)  SELECT  \"active_storage_attachments\".* FROM \"active_storage_attachments\" WHERE \"active_storage_attachments\".\"record_id\" = ? AND \"active_storage_attachments\".\"record_type\" = ? AND \"active_storage_attachments\".\"name\" = ? LIMIT ?  [[\"record_id\", 180], [\"record_type\", \"User\"], [\"name\", \"photo\"], [\"LIMIT\", 1]]\n  \u21b3 app/views/users/show.html.erb:8\n  Post Load (0.2ms)  SELECT \"posts\".* FROM \"posts\" WHERE \"posts\".\"user_id\" = ?  [[\"user_id\", 180]]\n  \u21b3 app/views/users/show.html.erb:28\n  Rendered users/show.html.erb within layouts/application (4.5ms)\nCompleted 200 OK in 43ms (Views: 36.9ms | ActiveRecord: 0.9ms)\n</code></pre>\n\n<p>I know that it is hitting the update method in my userscontroller because the notice is flashing of \"Not Uploaded\", but the server log seems to suggest it's doing a get request instead of a put?  I would like to achieve this without any gems.</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "autocomplete"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537210313, "post_id": 52374020, "comment_id": 91692871, "body": "It should work with your code. Check whether the id attribute of <code>customer_name</code> <code>text_field</code> is <code>customer_name</code> or not."}, {"owner": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537222504, "post_id": 52374020, "comment_id": 91697475, "body": "It is, but the autocomplete list still seems to be empty. Do you have any idea of what else may be going wrong? Thanks a lot."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1537245906, "post_id": 52374020, "comment_id": 91702451, "body": "@Johnny A bit confusion with your code is the field name <code>customer_phone_number</code> or <code>phone_number</code> in <code>Customer</code> model?"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "edited": false, "score": 0, "creation_date": 1537248607, "post_id": 52379138, "comment_id": 91703211, "body": "In the Customer model, the field name is phone_number."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "edited": false, "score": 0, "creation_date": 1537248772, "post_id": 52379138, "comment_id": 91703274, "body": "@Johnny If its so then why are you using <code>customer_phone_number</code> in <code>form_for</code>?"}, {"owner": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "edited": false, "score": 0, "creation_date": 1537249289, "post_id": 52379138, "comment_id": 91703456, "body": "No particular reason. That&#39;s just how I&#39;m referencing it in another model, because I thought it would make it confusing to not have customer_, especially for the _name field. Wouldn&#39;t it?"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "edited": false, "score": 0, "creation_date": 1537250067, "post_id": 52379138, "comment_id": 91703741, "body": "ok, so Can you run your query at rails console <code>customer = Customer.order(:phone_number).where(&quot;phone_number like ?&quot;, &quot;%#{params[:term]}%&quot;).limit(5)</code> replace <code>params[:term]</code> with your <code>query param</code> and do you get any record there?"}, {"owner": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "edited": false, "score": 0, "creation_date": 1537260949, "post_id": 52379138, "comment_id": 91709583, "body": "No, it&#39;s not returning anything. The way I&#39;ve managed to make it work with one attribute was by using pluck:  render json: @owner.pluck(:phone_number)  When I try something similar with map, it doesn&#39;t work though."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "edited": false, "score": 0, "creation_date": 1537262719, "post_id": 52379138, "comment_id": 91710611, "body": "@Johnny <code>Customer.order(:phone_number).where(&quot;phone_number like ?&quot;, &quot;%#{params[:term]}%&quot;)</code> is it&#39;s not returning anything that is returns a blank array so you are not getting anything any autocomplete elements with that <code>params[:term]</code>, make sure you have some records with that <code>params[:term]</code> ."}, {"owner": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "edited": false, "score": 0, "creation_date": 1537264879, "post_id": 52379138, "comment_id": 91711981, "body": "I may be not passing the right command to the console.   If I go to &quot;localhost:3000/customers&quot;, it does show an array with five records. That makes me think that the array is being passed through by the Controller.  No data is displayed in the autocomplete list though. So, is there any chance that autocomplete is not interpreting the array properly?"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 0, "last_activity_date": 1537246221, "creation_date": 1537246221, "answer_id": 52379138, "question_id": 52374020, "link": "https://stackoverflow.com/questions/52374020/autocomplete-multiple-fields-with-jquery-in-rails-5/52379138#52379138", "title": "Autocomplete multiple fields with jquery in Rails 5", "body": "<p>Probably you are fetching wrong query as in form field name is <code>customer_phone_number</code> and in query its <code>phone_number</code></p>\n\n<p>Assuming in <code>Customer</code> model field name is <code>customer_phone_number</code> then query should be</p>\n\n<pre><code>def index\n    @customer = Customer.order(:customer_phone_number).where(\"customer_phone_number like ?\", \"%#{params[:term]}%\").limit(5)\n    render json: @customer.map{ |customer| { :phone_number =&gt; customer.customer_phone_number, :name =&gt; customer.name } }\n\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "is_accepted": true, "score": 0, "last_activity_date": 1542899053, "creation_date": 1542899053, "answer_id": 53433718, "question_id": 52374020, "link": "https://stackoverflow.com/questions/52374020/autocomplete-multiple-fields-with-jquery-in-rails-5/53433718#53433718", "title": "Autocomplete multiple fields with jquery in Rails 5", "body": "<p>I've managed to make it work using a different method with the rails-jquery-autocomplete gem:</p>\n\n<p><a href=\"https://github.com/risuiowa/rails-jquery-autocomplete/\" rel=\"nofollow noreferrer\">https://github.com/risuiowa/rails-jquery-autocomplete/</a></p>\n\n<p>Using the </p>\n\n<blockquote>\n  <p>autocomplete_field</p>\n</blockquote>\n\n<p>turned out to be much easier to implement.\nExample: </p>\n\n<pre><code>form_for @product do |f|\n  f.autocomplete_field :brand_name, autocomplete_brand_name_products_path\nend\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 763, "favorite_count": 0, "accepted_answer_id": 53433718, "answer_count": 2, "score": 0, "last_activity_date": 1542899053, "creation_date": 1537209978, "question_id": 52374020, "link": "https://stackoverflow.com/questions/52374020/autocomplete-multiple-fields-with-jquery-in-rails-5", "title": "Autocomplete multiple fields with jquery in Rails 5", "body": "<p>I am building an admin form where I am using Jquery's Autocomplete widget for one of the text fields.</p>\n\n<p>In a field called <em>customer_phone_number</em>, when someone types the phone number, autocomplete checks the database to see if it exists and lists the existing options. Once a phone number is selected, I want it to fill out another field called <em>customer_name</em>. I've managed to autocomplete the first one but not the other. Here's what my code looks like right now:</p>\n\n<p>This is the View:</p>\n\n<pre><code>&lt;div class=\"col-md-4 input\"&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;label&gt;Customer's Phone Number&lt;/label&gt;\n    &lt;%= f.text_field :customer_phone_number, class: \"form-control\", data: { autocomplete_source: customers_path }  %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"col-md-4 input\"&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;label&gt;Customer's Name&lt;/label&gt;\n    &lt;%= f.text_field :customer_name, class: \"form-control\", data: { autocomplete_source: customers_path }  %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The javascript file:</p>\n\n<pre><code>jQuery(function() {\n\n  return $('#customer_phone_number').autocomplete({\n    source: $('#customer_phone_number').data('autocomplete-source'),\n    select: function(event, ui) {\n      event.preventDefault(),\n      $(this).val(ui.item.phone_number),\n      $('#customer_name').val(ui.item.name);\n    }\n  });\n});\n</code></pre>\n\n<p>And Controller:</p>\n\n<pre><code>  def index\n    @customer = Customer.order(:phone_number).where(\"phone_number like ?\", \"%#{params[:term]}%\").limit(5)\n    render json: @customer.map{ |customer| { :phone_number =&gt; customer.phone_number, :name =&gt; customer.name } }\n    # render json: @customer.pluck(:phone_number, :name)\n\n  end\n</code></pre>\n\n<p>How can I pass the <em>:name</em> value to the <em>customer_name</em> field? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-api", "google-oauth"], "comments": [{"owner": {"reputation": 8677, "user_id": 9337071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52afdb783a619060eb2b0c0cb5766d3?s=128&d=identicon&r=PG&f=1", "display_name": "tehhowch", "link": "https://stackoverflow.com/users/9337071/tehhowch"}, "edited": false, "score": 0, "creation_date": 1537207898, "post_id": 52373141, "comment_id": 91691755, "body": "If you have the refresh URI, why not do what Google&#39;s client libraries do - attempt to refresh if expired, and raise / reprompt if no access is obtained."}, {"owner": {"reputation": 912, "user_id": 5992952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Vkiy.png?s=128&g=1", "display_name": "Matsumoto Kazuya", "link": "https://stackoverflow.com/users/5992952/matsumoto-kazuya"}, "reply_to_user": {"reputation": 8677, "user_id": 9337071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52afdb783a619060eb2b0c0cb5766d3?s=128&d=identicon&r=PG&f=1", "display_name": "tehhowch", "link": "https://stackoverflow.com/users/9337071/tehhowch"}, "edited": false, "score": 0, "creation_date": 1537236261, "post_id": 52373141, "comment_id": 91700403, "body": "Thank you techhowch. You mean Google client libraries automatically update token?"}, {"owner": {"reputation": 912, "user_id": 5992952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Vkiy.png?s=128&g=1", "display_name": "Matsumoto Kazuya", "link": "https://stackoverflow.com/users/5992952/matsumoto-kazuya"}, "reply_to_user": {"reputation": 8677, "user_id": 9337071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52afdb783a619060eb2b0c0cb5766d3?s=128&d=identicon&r=PG&f=1", "display_name": "tehhowch", "link": "https://stackoverflow.com/users/9337071/tehhowch"}, "edited": false, "score": 0, "creation_date": 1537243269, "post_id": 52373141, "comment_id": 91701817, "body": "I use this library <a href=\"https://github.com/zquestz/omniauth-google-oauth2\" rel=\"nofollow noreferrer\">github.com/zquestz/omniauth-google-oauth2</a> with rails  It means client library automatically update token with application process background, even if user doesn&#39;t access application for long time? &gt; handle refresh for you when the access token is no longer valid"}, {"owner": {"reputation": 8677, "user_id": 9337071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52afdb783a619060eb2b0c0cb5766d3?s=128&d=identicon&r=PG&f=1", "display_name": "tehhowch", "link": "https://stackoverflow.com/users/9337071/tehhowch"}, "edited": false, "score": 0, "creation_date": 1537267422, "post_id": 52373141, "comment_id": 91713477, "body": "That is not one of Google&#39;s client libraries"}, {"owner": {"reputation": 912, "user_id": 5992952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Vkiy.png?s=128&g=1", "display_name": "Matsumoto Kazuya", "link": "https://stackoverflow.com/users/5992952/matsumoto-kazuya"}, "reply_to_user": {"reputation": 8677, "user_id": 9337071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52afdb783a619060eb2b0c0cb5766d3?s=128&d=identicon&r=PG&f=1", "display_name": "tehhowch", "link": "https://stackoverflow.com/users/9337071/tehhowch"}, "edited": false, "score": 0, "creation_date": 1537280083, "post_id": 52373141, "comment_id": 91721882, "body": "ah sorry, I use this one <a href=\"https://github.com/googleapis/google-api-ruby-client\" rel=\"nofollow noreferrer\">github.com/googleapis/google-api-ruby-client</a>"}, {"owner": {"reputation": 912, "user_id": 5992952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Vkiy.png?s=128&g=1", "display_name": "Matsumoto Kazuya", "link": "https://stackoverflow.com/users/5992952/matsumoto-kazuya"}, "reply_to_user": {"reputation": 8677, "user_id": 9337071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52afdb783a619060eb2b0c0cb5766d3?s=128&d=identicon&r=PG&f=1", "display_name": "tehhowch", "link": "https://stackoverflow.com/users/9337071/tehhowch"}, "edited": false, "score": 0, "creation_date": 1537281233, "post_id": 52373141, "comment_id": 91722736, "body": "similar post here <a href=\"https://stackoverflow.com/questions/21707734/refresh-token-using-omniauth-oauth2-in-rails-application\" title=\"refresh token using omniauth oauth2 in rails application\">stackoverflow.com/questions/21707734/&hellip;</a>"}, {"owner": {"reputation": 8677, "user_id": 9337071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52afdb783a619060eb2b0c0cb5766d3?s=128&d=identicon&r=PG&f=1", "display_name": "tehhowch", "link": "https://stackoverflow.com/users/9337071/tehhowch"}, "edited": false, "score": 1, "creation_date": 1537281317, "post_id": 52373141, "comment_id": 91722792, "body": "If you have specific language and client libraries of relevance, consider adding those tags to your question to help your question find the correct audience."}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5992952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Vkiy.png?s=128&g=1", "display_name": "Matsumoto Kazuya", "link": "https://stackoverflow.com/users/5992952/matsumoto-kazuya"}, "is_accepted": false, "score": 0, "last_activity_date": 1537280589, "creation_date": 1537280589, "answer_id": 52388753, "question_id": 52373141, "link": "https://stackoverflow.com/questions/52373141/best-practice-to-manage-google-oauth-token/52388753#52388753", "title": "Best practice to manage google oauth token", "body": "<p>I've found docs about auto  on java</p>\n\n<p><a href=\"https://developers.google.com/api-client-library/java/google-api-java-client/oauth2\" rel=\"nofollow noreferrer\">https://developers.google.com/api-client-library/java/google-api-java-client/oauth2</a></p>\n\n<blockquote>\n  <p>An access token typically has an expiration date of 1 hour, after\n  which you will get an error if you try to use it. GoogleCredential\n  takes care of automatically \"refreshing\" the token, which simply means\n  getting a new access token</p>\n</blockquote>\n\n<p>I'm wondering Ruby also has the auto update.</p>\n\n<p><a href=\"https://developers.google.com/api-client-library/ruby/auth/web-app#exchange-authorization-code\" rel=\"nofollow noreferrer\">https://developers.google.com/api-client-library/ruby/auth/web-app#exchange-authorization-code</a></p>\n\n<blockquote>\n  <p>After a user grants offline access to the requested scopes, you can\n  continue to use the API client to access Google APIs on the user's\n  behalf when the user is offline. The client object will refresh the\n  access token as needed.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 912, "user_id": 5992952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Vkiy.png?s=128&g=1", "display_name": "Matsumoto Kazuya", "link": "https://stackoverflow.com/users/5992952/matsumoto-kazuya"}, "is_accepted": false, "score": 0, "last_activity_date": 1537984883, "creation_date": 1537984883, "answer_id": 52523678, "question_id": 52373141, "link": "https://stackoverflow.com/questions/52373141/best-practice-to-manage-google-oauth-token/52523678#52523678", "title": "Best practice to manage google oauth token", "body": "<p>Finally, I get answer by asking on Github issue</p>\n\n<p><a href=\"https://github.com/googleapis/google-api-ruby-client/issues/719\" rel=\"nofollow noreferrer\">https://github.com/googleapis/google-api-ruby-client/issues/719</a></p>\n"}], "owner": {"reputation": 912, "user_id": 5992952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Vkiy.png?s=128&g=1", "display_name": "Matsumoto Kazuya", "link": "https://stackoverflow.com/users/5992952/matsumoto-kazuya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537984883, "creation_date": 1537206054, "last_edit_date": 1537288868, "question_id": 52373141, "link": "https://stackoverflow.com/questions/52373141/best-practice-to-manage-google-oauth-token", "title": "Best practice to manage google oauth token", "body": "<p>I'm making web app using google <a href=\"https://developers.google.com/calendar/\" rel=\"nofollow noreferrer\">calendar api</a>.</p>\n\n<p>In this app, I request user to authorize Google Calendar Access with <a href=\"https://developers.google.com/identity/protocols/OAuth2\" rel=\"nofollow noreferrer\">Google Oauth2</a> on register. </p>\n\n<p>My problem is a token returned has expires in 1 hours, so users have to authorize everytime.</p>\n\n<p>I understand I can't change expire time in Google API.</p>\n\n<p>My question is how can I keep oauth token active?</p>\n\n<p>Do I have to make cron updating token with refresh token?</p>\n\n<p>thanks,</p>\n"}, {"tags": ["ruby", "unicode"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537206497, "post_id": 52372599, "comment_id": 91691053, "body": "In Ruby capital letters have significant meaning. Method and variable names should be lower-case only, so this method should be <code>explain</code>, not <code>Explain</code>. Capital letters are reserved for <code>ClassName</code> and <code>CONSTANT_NAME</code> situations."}, {"owner": {"reputation": 38158, "user_id": 2707792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hjDjB.png?s=128&g=1", "display_name": "Andrey Tyukin", "link": "https://stackoverflow.com/users/2707792/andrey-tyukin"}, "edited": false, "score": 0, "creation_date": 1537207610, "post_id": 52372599, "comment_id": 91691607, "body": "Ruby 2.3.1 produces <code>[&quot;x\u22613(mod4)&quot;, &quot;x\u22614(mod5)&quot;]</code>...?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6569828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45916db921db1ecc886556e0018d1175?s=128&d=identicon&r=PG&f=1", "display_name": "valoriedodge", "link": "https://stackoverflow.com/users/6569828/valoriedodge"}, "is_accepted": false, "score": 0, "last_activity_date": 1537205909, "creation_date": 1537205909, "answer_id": 52373111, "question_id": 52372599, "link": "https://stackoverflow.com/questions/52372599/understanding-when-ruby-changes-string-into-unicode-representation/52373111#52373111", "title": "Understanding when Ruby changes string into Unicode representation", "body": "<p>The conversion is happening when you call to_s on an array. It converts each of the values in the array to a uniform ascii based string. </p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 0, "last_activity_date": 1537206651, "creation_date": 1537206651, "answer_id": 52373289, "question_id": 52372599, "link": "https://stackoverflow.com/questions/52372599/understanding-when-ruby-changes-string-into-unicode-representation/52373289#52373289", "title": "Understanding when Ruby changes string into Unicode representation", "body": "<p>It's not \"changing to Unicode representation\", it's changing to <code>inspect</code> representation. <code>puts</code> calls <code>to_s</code> on the given argument(s) in order to present them, and by default Array just shows up in its \"raw\" form.</p>\n\n<p>Printing individual elements produces the desired behaviour because that's a simple string. Printing the array itself is problematic because the array will show up using <code>.inspect</code>.</p>\n\n<p>Try this:</p>\n\n<pre><code>puts equations.join(' ')\n</code></pre>\n\n<p>Where that combines them with a space and everything looks fine.</p>\n\n<p>Note: The <code>\\u...</code> notation is used when any non-ASCII characters appear in a string when a string is \"inspected\". The same goes for things like <code>\\n</code> and so on.</p>\n"}], "owner": {"reputation": 103, "user_id": 9826359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755b6aabe0a7a2f4774bd28f1eeecf27?s=128&d=identicon&r=PG&f=1", "display_name": "buddingprogrammer", "link": "https://stackoverflow.com/users/9826359/buddingprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 52373289, "answer_count": 2, "score": 0, "last_activity_date": 1537206651, "creation_date": 1537203738, "question_id": 52372599, "link": "https://stackoverflow.com/questions/52372599/understanding-when-ruby-changes-string-into-unicode-representation", "title": "Understanding when Ruby changes string into Unicode representation", "body": "<p>I'd like to know why Ruby is representing my returned value differently in the scenario below. I'm sending a function a list of equations and immediately returning it as is. If printed directly, \u2261 shows up as its Unicode sequence instead. If I index into the result, it shows as \u2261 again. I get <code>true</code> when testing if the Unicode sequence is equivalent to \u2261, so I'm not concerned the value changed. I'd just like to know why it prints differently to the screen.</p>\n\n<pre><code>def Explain(equations)\n  equations\nend\n\nequations = [\"x\u22613(mod4)\", \"x\u22614(mod5)\"]\n\nputs \"ORIGINAL LIST\"\nequations.each { |e| puts e }\n\nputs \"\\n\\nRETURNED AS A LIST\"\nputs Explain(equations).to_s\n\nputs \"\\n\\nRETURNED AND ACCESSED INDIVIDUALLY\"\nputs Explain(equations)[0]\nputs Explain(equations)[1]\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>ruby 2.5.0p0 (2017-12-25 revision 61468) [x86_64-linux]\n\nORIGINAL LIST\nx\u22613(mod4)\nx\u22614(mod5)\n\n\nRETURNED AS A LIST\n[\"x\\u22613(mod4)\", \"x\\u22614(mod5)\"]\n\n\nRETURNED AND ACCESSED INDIVIDUALLY\nx\u22613(mod4)\nx\u22614(mod5)\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1537211809, "post_id": 52372126, "comment_id": 91693480, "body": "Thank you for your answer Chris! :) Unfortunately, the <code>square.rb</code> file was a stand-in for any kind of file (even non-Ruby) that reads and writes STD IN and OUT, respectively. One that we don&#39;t have control over. The <code>backticks</code> to execute shell code idea was something I started using immediately after posting this question, but it&#39;s more Bash in Ruby that Ruby itself :).  Still a valid way to do it though, and thank you for help!"}], "tags": [], "owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "is_accepted": false, "score": 1, "last_activity_date": 1537201604, "creation_date": 1537201604, "answer_id": 52372126, "question_id": 52371419, "link": "https://stackoverflow.com/questions/52371419/how-do-i-run-a-program-via-ruby-and-access-its-standard-input-and-output/52372126#52372126", "title": "How do I run a program via Ruby and access its standard input and output", "body": "<p>The easiest way to test this would probably be to have your program look to see if it was passed any arguments first.  Something like this:</p>\n\n<pre><code>#!/usr/local/bin/ruby -w\n\ninput = ARGV[0] || STDIN.read\n\n# square it\nputs input.to_i ** 2\n</code></pre>\n\n<p>and then you can shell out to test it:</p>\n\n<pre><code>def pass_input_to_file(input)\n  `path/to/file #{input}`.to_i\nend\n</code></pre>\n\n<p>Otherwise, I would reach for something like <a href=\"https://linux.die.net/man/1/expect\" rel=\"nofollow noreferrer\">expect</a> to automate a subshell.</p>\n\n<hr>\n\n<p>As an aside, for more complicated programs, using <a href=\"https://ruby-doc.org/stdlib-2.4.2/libdoc/optparse/rdoc/OptionParser.html\" rel=\"nofollow noreferrer\">OptionParser</a> or a CLI gem is probably better than looking at ARGV directly.</p>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 7111504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZuKH.jpg?s=128&g=1", "display_name": "Macro", "link": "https://stackoverflow.com/users/7111504/macro"}, "is_accepted": true, "score": 2, "last_activity_date": 1537208625, "creation_date": 1537208625, "answer_id": 52373700, "question_id": 52371419, "link": "https://stackoverflow.com/questions/52371419/how-do-i-run-a-program-via-ruby-and-access-its-standard-input-and-output/52373700#52373700", "title": "How do I run a program via Ruby and access its standard input and output", "body": "<p>You can use the <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/open3/rdoc/Open3.html#method-c-capture2\" rel=\"nofollow noreferrer\">Ruby Open3 Library</a> to submit STDIN when calling a ruby script.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'open3'\n\ndef pass_input_to_file(input)\n  output, _status = Open3.capture2('path_to_script', :stdin_data =&gt; input)\n  output\nend\n</code></pre>\n"}], "owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 52373700, "answer_count": 2, "score": 0, "last_activity_date": 1537212001, "creation_date": 1537198934, "last_edit_date": 1537212001, "question_id": 52371419, "link": "https://stackoverflow.com/questions/52371419/how-do-i-run-a-program-via-ruby-and-access-its-standard-input-and-output", "title": "How do I run a program via Ruby and access its standard input and output", "body": "<p>I have a completely separate Ruby file that reads from Standard Input and writes to Standard Output.</p>\n\n<p>I have certain test cases that I want to try. How do I pass my inputs to Standard Input to the file, and then test the Standard Output against the expected results?</p>\n\n<hr>\n\n<p>As an example, here's the stuff I've already figured out:</p>\n\n<p>There's a file that reads a number from standard input, squares it, and writes it to standard input</p>\n\n<p><code>square.rb</code>:</p>\n\n<pre><code>#!/usr/local/bin/ruby -w\n\ninput = STDIN.read\n\n# square it\nputs input.to_i ** 2\n</code></pre>\n\n<p>Complete the <code>pass_input_to_file</code> method of <code>test.rb</code>:</p>\n\n<pre><code>require 'minitest/autorun'\n\ndef pass_input_to_file(input)\n  # complete code here\nend\n\nclass Test &lt; Minitest::Test\n  def test_file\n    assert_equal pass_input_to_file(2), 4\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "xml", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7643984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf96deaa4d5e87c86d7b5042b6005aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kayla Nelson", "link": "https://stackoverflow.com/users/7643984/kayla-nelson"}, "edited": false, "score": 0, "creation_date": 1537218565, "post_id": 52374137, "comment_id": 91696293, "body": "Hi Macro, thank you very much for your answer. Would you mind explaining the output of the examples? I am unsure of what the plus and minus is referencing to in the second example. I tried the first example to see if that would make it clearer, but it did not as there were a lot of spaces in between the plus and minus symbols. Also why is &lt;test&gt;&lt;/test&gt; is not showing up as a difference? Thank you for your time."}, {"owner": {"reputation": 196, "user_id": 7111504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZuKH.jpg?s=128&g=1", "display_name": "Macro", "link": "https://stackoverflow.com/users/7111504/macro"}, "reply_to_user": {"reputation": 53, "user_id": 7643984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf96deaa4d5e87c86d7b5042b6005aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kayla Nelson", "link": "https://stackoverflow.com/users/7643984/kayla-nelson"}, "edited": false, "score": 0, "creation_date": 1537446547, "post_id": 52374137, "comment_id": 91793159, "body": "The <code>+</code> represents additions and the <code>-</code> represents deletions. Not sure why the <code>&lt;test&gt;</code> node is not showing up in the diff."}, {"owner": {"reputation": 53, "user_id": 7643984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf96deaa4d5e87c86d7b5042b6005aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kayla Nelson", "link": "https://stackoverflow.com/users/7643984/kayla-nelson"}, "edited": false, "score": 0, "creation_date": 1537876975, "post_id": 52374137, "comment_id": 91935792, "body": "Do you know if there is a gem which formats these xnl differences in a html report? I know that when it comes to csv differences there is a gem called csv-diff which gives raw output and csv-diff-report which formats the differences from csv-diff into a html report. Is there a report gem like this for xml differences?"}, {"owner": {"reputation": 196, "user_id": 7111504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZuKH.jpg?s=128&g=1", "display_name": "Macro", "link": "https://stackoverflow.com/users/7111504/macro"}, "reply_to_user": {"reputation": 53, "user_id": 7643984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf96deaa4d5e87c86d7b5042b6005aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kayla Nelson", "link": "https://stackoverflow.com/users/7643984/kayla-nelson"}, "edited": false, "score": 0, "creation_date": 1537888173, "post_id": 52374137, "comment_id": 91943465, "body": "I added a new answer using the diffy gem."}], "tags": [], "owner": {"reputation": 196, "user_id": 7111504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZuKH.jpg?s=128&g=1", "display_name": "Macro", "link": "https://stackoverflow.com/users/7111504/macro"}, "is_accepted": false, "score": 1, "last_activity_date": 1537210530, "creation_date": 1537210530, "answer_id": 52374137, "question_id": 52371095, "link": "https://stackoverflow.com/questions/52371095/how-to-compare-two-xml-files-and-display-the-differences-in-html-format-using-ru/52374137#52374137", "title": "How to compare two XML files and display the differences in html format using Ruby", "body": "<p>There is a <a href=\"https://github.com/postmodern/nokogiri-diff\" rel=\"nofollow noreferrer\">nokogiri-diff gem</a> you can use to do this. It simply finds the differences and returns an <code>Enumerable</code> object.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'nokogiri/diff'\n\nxmlDoc1 = File.open(\"docOne.xml\") { |f| Nokogiri::XML(f) }\nxmlDoc2 = File.open(\"docTwo.xml\") { |f| Nokogiri::XML(f) }\n\nxmlDoc1.diff(xmlDoc2).each do |diff|\n  puts diff\nend\n</code></pre>\n\n\n\n<pre><code>#2nd example\ndoc1 = Nokogiri::XML(\"&lt;root&gt;&lt;aliens&gt;&lt;alien&gt;&lt;name&gt;Alf&lt;/name&gt;&lt;/alien&gt;&lt;/aliens&gt;&lt;/root&gt;\")\ndoc2 = Nokogiri::XML(\"&lt;root&gt;&lt;alienz&gt;&lt;alien&gt;&lt;name&gt;Alf&lt;/name&gt;&lt;/alien&gt;&lt;/alienz&gt;&lt;/root&gt;&lt;test&gt;&lt;/test&gt;\")\n\nxmlDoc1.diff(xmlDoc2).each do |diff|\n  puts diff\nend\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>#2nd example output\n&lt;root&gt;\n  &lt;aliens&gt;\n    &lt;alien&gt;\n      &lt;name&gt;Alf&lt;/name&gt;\n    &lt;/alien&gt;\n  &lt;/aliens&gt;\n&lt;/root&gt;\n-\n&lt;aliens&gt;\n  &lt;alien&gt;\n    &lt;name&gt;Alf&lt;/name&gt;\n  &lt;/alien&gt;\n&lt;/aliens&gt;\n+\n&lt;alienz&gt;\n  &lt;alien&gt;\n    &lt;name&gt;Alf&lt;/name&gt;\n  &lt;/alien&gt;\n&lt;/alienz&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 7643984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf96deaa4d5e87c86d7b5042b6005aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kayla Nelson", "link": "https://stackoverflow.com/users/7643984/kayla-nelson"}, "edited": false, "score": 0, "creation_date": 1537903262, "post_id": 52501424, "comment_id": 91951216, "body": "Thank you. This looks exactly what I am looking for. I am having some trouble using the gem. It does not seem to be picking up differences.  I have installed the gems diffy, rspec and diff-lcs. For me, the puts in your answer retuens:      &lt;div class=&quot;diff&quot;&gt;&lt;/div&gt;  no matter what xml files I supply as arguments. I also tried storing my xmls in string variables called doc1 and doc2 and I use the line: puts Diffy::Diff.new(doc1, doc2, :include_plus_and_minus_in_html =&gt; true).to_s(:html) but I got the same result. Do you know what the issue may be?"}, {"owner": {"reputation": 196, "user_id": 7111504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZuKH.jpg?s=128&g=1", "display_name": "Macro", "link": "https://stackoverflow.com/users/7111504/macro"}, "reply_to_user": {"reputation": 53, "user_id": 7643984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf96deaa4d5e87c86d7b5042b6005aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kayla Nelson", "link": "https://stackoverflow.com/users/7643984/kayla-nelson"}, "edited": false, "score": 0, "creation_date": 1537907427, "post_id": 52501424, "comment_id": 91952901, "body": "Could you provide a light or similar example of your xml documents?"}, {"owner": {"reputation": 53, "user_id": 7643984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf96deaa4d5e87c86d7b5042b6005aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kayla Nelson", "link": "https://stackoverflow.com/users/7643984/kayla-nelson"}, "edited": false, "score": 0, "creation_date": 1537910890, "post_id": 52501424, "comment_id": 91954277, "body": "I added snippets of the two xml files I am trying to compare to my original question. I tried puts Diffy::Diff.new(&#39;./doc1&#39;, &#39;./doc2&#39;, :source =&gt; &#39;files&#39;).to_s(:html). I also tried storing the above xmls in variables and then used puts Diffy::Diff.new(doc1, doc2, :include_plus_and_minus_in_html =&gt; true).to_s(:html) but both returned &lt;div class=&quot;diff&quot;&gt;&lt;/div&gt; indicating there are no differences. I also tried a basic test using the line puts Diffy::Diff.new(&quot;Hello how are you&quot;, &quot;Hello how are you\\nI&#39;m fine\\nThat&#39;s great\\n&quot;) but this line returned nothing but the strings are different."}, {"owner": {"reputation": 196, "user_id": 7111504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZuKH.jpg?s=128&g=1", "display_name": "Macro", "link": "https://stackoverflow.com/users/7111504/macro"}, "reply_to_user": {"reputation": 53, "user_id": 7643984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf96deaa4d5e87c86d7b5042b6005aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kayla Nelson", "link": "https://stackoverflow.com/users/7643984/kayla-nelson"}, "edited": false, "score": 0, "creation_date": 1537975788, "post_id": 52501424, "comment_id": 91982228, "body": "I think you are giving it an invalid path to your files. It returns an empty diff if both paths are invalid. <code>puts Diffy::Diff.new(&#39;.&#47;invalid_path_to_file.xml&#39;, &#39;invalid_path_to_file_2.xml&#39;, :source =&gt; &#39;files&#39;).to_s(:html)</code> &lt;div class=&quot;diff&quot;&gt;&lt;/div&gt;`"}, {"owner": {"reputation": 53, "user_id": 7643984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf96deaa4d5e87c86d7b5042b6005aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kayla Nelson", "link": "https://stackoverflow.com/users/7643984/kayla-nelson"}, "edited": false, "score": 0, "creation_date": 1537977767, "post_id": 52501424, "comment_id": 91983406, "body": "I could not see anything wrong with the file path so as a workaround, I stored the contents of the xml files in &#39;String&#39; variables and then wrote &#39;puts Diffy::Diff.new(doc1, doc2, :include_plus_and_minus_in_html =&gt; true).to_s(:html)&#39; where doc1 is the contents of the first xml document and doc2 is the contents of the second xml document but that still returned &#39;&lt;div class=&quot;diff&quot;&gt;&lt;/div&gt;&#39;. I also tried &#39;puts Diffy::Diff.new(&quot;Hello how are you&quot;, &quot;Hello how are you\\nI&#39;m fine\\nThat&#39;s great\\n&quot;)&#39; as a simple test to see if it was my xml string causing the problem but this test returned nothing."}], "tags": [], "owner": {"reputation": 196, "user_id": 7111504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZuKH.jpg?s=128&g=1", "display_name": "Macro", "link": "https://stackoverflow.com/users/7111504/macro"}, "is_accepted": true, "score": 2, "last_activity_date": 1537888150, "creation_date": 1537888150, "answer_id": 52501424, "question_id": 52371095, "link": "https://stackoverflow.com/questions/52371095/how-to-compare-two-xml-files-and-display-the-differences-in-html-format-using-ru/52501424#52501424", "title": "How to compare two XML files and display the differences in html format using Ruby", "body": "<p>An alternate solution using <a href=\"https://github.com/samg/diffy\" rel=\"nofollow noreferrer\">Diffy</a> to do the comparison. It is a flat string comparison but it does have an html formatted output.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'diffy'\n\nputs Diffy::Diff.new('./docOne.xml', './docTwo.xml', :source =&gt; 'files').to_s(:html)\n</code></pre>\n\n<pre class=\"lang-html prettyprint-override\"><code>#Example output\n&lt;div class=\"diff\"&gt;\n  &lt;ul&gt;\n    &lt;li class=\"unchanged\"&gt;&lt;span&gt;&amp;lt;root&amp;gt;&lt;/span&gt;&lt;/li&gt;\n    &lt;li class=\"del\"&gt;&lt;del&gt;test&lt;/del&gt;&lt;/li&gt;\n    &lt;li class=\"unchanged\"&gt;&lt;span&gt;&amp;lt;foo&amp;gt;&amp;lt;/foo&amp;gt;&lt;/span&gt;&lt;/li&gt;\n    &lt;li class=\"ins\"&gt;&lt;ins&gt;&amp;lt;bar&amp;gt;&amp;lt;/bar&amp;gt;&lt;/ins&gt;&lt;/li&gt;\n    &lt;li class=\"unchanged\"&gt;&lt;span&gt;&amp;lt;/root&amp;gt;&lt;/span&gt;&lt;/li&gt;\n  &lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7643984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf96deaa4d5e87c86d7b5042b6005aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kayla Nelson", "link": "https://stackoverflow.com/users/7643984/kayla-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1752, "favorite_count": 1, "accepted_answer_id": 52501424, "answer_count": 2, "score": 1, "last_activity_date": 1537910580, "creation_date": 1537197876, "last_edit_date": 1537910580, "question_id": 52371095, "link": "https://stackoverflow.com/questions/52371095/how-to-compare-two-xml-files-and-display-the-differences-in-html-format-using-ru", "title": "How to compare two XML files and display the differences in html format using Ruby", "body": "<p>I have a range of xml files stored on my PC. I stored the content of these files using the gem Nokogiri. I need to compare the content of these xmls two at a time. If there are differences between the xml files, I would like to display these differences in a pretty html report for others to view.</p>\n\n<p>Does anyone know how this can be done?</p>\n\n<p>First xml file I am comparing:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;SourceDetails&gt;\n    &lt;Origin&gt;Origin&lt;/Origin&gt;\n    &lt;Identifier&gt;Identifier&lt;/Identifier&gt;\n    &lt;Timestamp&gt;2001-12-31T12:00:00&lt;/Timestamp&gt;\n  &lt;/SourceDetails&gt;\n  &lt;AsOfDate&gt;2001-01-01&lt;/AsOfDate&gt;\n  &lt;Instrument&gt;\n    &lt;ASXExchangeSecurityIdentifier&gt;ASX&lt;/ASXExchangeSecurityIdentifier&gt;\n  &lt;/Instrument&gt;\n  &lt;Rate&gt;0.0&lt;/Rate&gt;\n</code></pre>\n\n<p>Second xml file I am comparing:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;SourceDetails&gt;\n        &lt;Origin&gt;FEED&lt;/Origin&gt;\n        &lt;Identifier&gt;IR&lt;/Identifier&gt;\n        &lt;Timestamp&gt;2017-01-01T02:11:01Z&lt;/Timestamp&gt;\n    &lt;/SourceDetails&gt;\n    &lt;AsOfDate&gt;2017-01-02&lt;/AsOfDate&gt;\n    &lt;Instrument&gt;\n        &lt;CommonCode&gt;GB0&lt;/CommonCode&gt;\n    &lt;/Instrument&gt;\n    &lt;Rate&gt;0.69&lt;/Rate&gt;\n</code></pre>\n"}, {"tags": ["java", "python", "ruby", "automated-tests", "getgauge"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1537199105, "post_id": 52370910, "comment_id": 91687434, "body": "This is a research question that is probably not really on topic here. For example, did you try &quot;guage test multi-language&quot; in your favourite web search?"}], "answers": [{"tags": [], "owner": {"reputation": 8597, "user_id": 326543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f882e1ef33bcbefabf8c2f9463fb1f7f?s=128&d=identicon&r=PG", "display_name": "Srikanth Venugopalan", "link": "https://stackoverflow.com/users/326543/srikanth-venugopalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1537233951, "creation_date": 1537233951, "answer_id": 52377661, "question_id": 52370910, "link": "https://stackoverflow.com/questions/52370910/does-the-guage-test-automation-framework-allow-multiple-languages-to-be-used-in/52377661#52377661", "title": "Does the Guage test automation framework allow multiple languages to be used in the same repo?", "body": "<p>Currently Gauge does not allow one test suite to have multiple language implementations. You can have multiple gauge test suites in a single repo thought. </p>\n\n<p>There is an open issue for this: <a href=\"https://github.com/getgauge/gauge/issues/827\" rel=\"nofollow noreferrer\">https://github.com/getgauge/gauge/issues/827</a></p>\n\n<p>Feel free to chat with the gauge team - <a href=\"https://gitter.im/getgauge/gauge\" rel=\"nofollow noreferrer\">https://gitter.im/getgauge/gauge</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9498516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRsq4.jpg?s=128&g=1", "display_name": "ksmo", "link": "https://stackoverflow.com/users/9498516/ksmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537233951, "creation_date": 1537197304, "question_id": 52370910, "link": "https://stackoverflow.com/questions/52370910/does-the-guage-test-automation-framework-allow-multiple-languages-to-be-used-in", "title": "Does the Guage test automation framework allow multiple languages to be used in the same repo?", "body": "<p>I've recently moved into a company that has several testing tools/frameworks/languages, and I'm looking to consolidate these as efficiently as possible.  Gauge is promising, but one question I'm already being asked is if Gauge will allow us to write implementation steps in Java for some tests and Ruby or Python for others.   </p>\n\n<p>Does anyone have an example of Gauge working with several different languages?</p>\n"}, {"tags": ["ruby", "network-programming", "sinatra", "puma", "foreman"], "answers": [{"tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": true, "score": 1, "last_activity_date": 1537198570, "creation_date": 1537198570, "answer_id": 52371314, "question_id": 52370749, "link": "https://stackoverflow.com/questions/52370749/sinatra-app-running-with-foreman-on-raspberry-not-reachable-in-home-network/52371314#52371314", "title": "Sinatra APP running with foreman on raspberry not reachable in Home-Network", "body": "<p>By default rackup binds to localhost.  You have to tell it to listen on 0.0.0.0</p>\n\n<p><code>rackup -p 10001 -o 0.0.0.0</code></p>\n\n<p>or</p>\n\n<p><code>rackup -p 10001 --host 0.0.0.0</code></p>\n\n<p>Related source here: <a href=\"https://github.com/rack/rack/blob/master/lib/rack/server.rb#L56\" rel=\"nofollow noreferrer\">https://github.com/rack/rack/blob/master/lib/rack/server.rb#L56</a></p>\n"}], "owner": {"reputation": 119, "user_id": 5410285, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ae559349444aceb28a26992de9acad4b?s=128&d=identicon&r=PG&f=1", "display_name": "Frost", "link": "https://stackoverflow.com/users/5410285/frost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 52371314, "answer_count": 1, "score": 0, "last_activity_date": 1537198570, "creation_date": 1537196825, "question_id": 52370749, "link": "https://stackoverflow.com/questions/52370749/sinatra-app-running-with-foreman-on-raspberry-not-reachable-in-home-network", "title": "Sinatra APP running with foreman on raspberry not reachable in Home-Network", "body": "<p>I have a question. Maybe this is easy and i just dont come behind it. \nI wrote a little Sinatra (ruby) WebApp. It is running with a puma server and is started with foreman. I now started it on my Raspberry (Raspian stretch). This is working. </p>\n\n<pre><code>14:28:45 web.1  | started with pid 10847\n14:28:52 web.1  | Puma starting in single mode...\n14:28:52 web.1  | * Version 3.12.0 (ruby 2.5.1-p57), codename: Llamas in Pajamas\n14:28:52 web.1  | * Min threads: 0, max threads: 16\n14:28:52 web.1  | * Environment: development\n14:28:52 web.1  | * Listening on tcp://localhost:10001\n14:28:52 web.1  | Use Ctrl-C to stop\n</code></pre>\n\n<p>I can access it locally on my raspberry. </p>\n\n<pre><code>curl localhost:10001\n</code></pre>\n\n<p>this is working.</p>\n\n<p>But I also want to reach it with my PC (Home network). And this is not working. \nI can ping the raspberry successfully. </p>\n\n<pre><code>ping 192.XXX.XXX.XX\n</code></pre>\n\n<p>but when i ping the port it is running on, it is not working (also try that with my browser). I have a fritzbox.</p>\n\n<pre><code>ping 192.XXX.XXX.XX:10001\n</code></pre>\n\n<p>Procfile:</p>\n\n<pre><code>web: bundle exec rackup -p 10001 -s puma\n</code></pre>\n\n<p>I am not sure what i am doing wrong :-( . </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "download", "zip"], "comments": [{"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 1, "creation_date": 1537196096, "post_id": 52370297, "comment_id": 91685548, "body": "I am not sure what your question is."}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537196221, "post_id": 52370297, "comment_id": 91685626, "body": "<i>I need to delete the older .zip file located in /tmp folder if exist when download the same report again.</i> can you reframe this part ? I think this part is his question. He wants to delete the zip file after it is downloaded if it exists ? Correct me If I&#39;m wrong."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "edited": false, "score": 0, "creation_date": 1537196348, "post_id": 52370297, "comment_id": 91685722, "body": "hi ! thanks for comment ! I need to delete the .zip that contain 2 pdf files when user download it again !"}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537197336, "post_id": 52370297, "comment_id": 91686425, "body": "Why not just delete the file after it is downloaded for the first time ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537197487, "post_id": 52370297, "comment_id": 91686513, "body": "@KedarnagMukanahallipatna good idea also, can you help I&#39;m just starting manipulate FileUtils for rails !"}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537197600, "post_id": 52370297, "comment_id": 91686595, "body": "One more thing, you&#39;re using <code>send_file</code> the request is sent to your HTTP server, when you try to delete the file, Rails won&#39;t know if the file is being used. You should be using <code>send_data</code> instead"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "edited": false, "score": 0, "creation_date": 1537197837, "post_id": 52370297, "comment_id": 91686749, "body": "when replace send_file by send_data , it download a file contain only the path : /home/../report_reference.zip !!"}], "answers": [{"tags": [], "owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "is_accepted": true, "score": 0, "last_activity_date": 1537198341, "creation_date": 1537198341, "answer_id": 52371241, "question_id": 52370297, "link": "https://stackoverflow.com/questions/52370297/ruby-on-rails-zip-and-download-pdf-files/52371241#52371241", "title": "Ruby on rails - zip and download pdf files", "body": "<p>You can do this to delete a file if it exists</p>\n\n<pre><code>File.delete(path_to_file) if File.exist?(path_to_file)\n</code></pre>\n\n<p>or using FileUtils</p>\n\n<pre><code>FileUtils.rm('path_to_file')\n</code></pre>\n\n<p>The difference between <code>File.delete</code> and <code>FileUtils.rm</code> is, <code>File.delete</code> will take filename(s) as arguments and returns number of files removed also will raise an exception on error, and <code>FileUtils.rm</code> takes a list of filename(s) and does not raise an exception.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 1, "accepted_answer_id": 52371241, "answer_count": 1, "score": 2, "last_activity_date": 1537198341, "creation_date": 1537195398, "question_id": 52370297, "link": "https://stackoverflow.com/questions/52370297/ruby-on-rails-zip-and-download-pdf-files", "title": "Ruby on rails - zip and download pdf files", "body": "<p>Working on a task that zip two pdf reports version of the same report_id.</p>\n\n<p>I need to put 2 pdf versions on a .zip file and download it, i generate the 2 pdf into a tmp directory, after that the zip will be created into the tmp folder and downloaded into the same folder and download directory of my computer.</p>\n\n<p>I need to delete the older .zip file located in /tmp folder if exist when download the same report again.</p>\n\n<p>here the report_controller.rb:</p>\n\n<pre><code>require 'date'\nclass Web::ReportsController &lt; Web::ApplicationController\n  load_and_authorize_resource\n\n  def generate_pdf\n    report = Report.find( params[ :id ] ).decorate\n    pdf_info = {\n      Author:       current_user.decorate.full_name,\n      Subject:      report.pdf_filename,\n      Creator:      \"Altagem Solution\",\n      CreationDate: Time.current\n    }\n\n    if version = params[ :version ]\n      pdf_info[ :Title ] =  \"#{I18n.t \"report.version.internal\" }\"\n    else\n      pdf_info[ :Title ] =  \"#{I18n.t \"report.version.customer\" }\"\n    end\n\n    pdf    = ReportPdf.new current_company, report, [], version , pdf_info\n\n\n    send_data pdf.generate, filename: report.pdf_filename,\n                                type: \"application/pdf\",\n                         disposition: 'inline'\n  end\n\n  def zip_it\n    report = Report.find( params[ :id ] ).decorate\n\n    report_date      = report.created_at.strftime(\"%y-%m-%d\")\n    contract_name    = report.activities()[0].contract.name\n    report_reference = report.reference\n\n    pdf_name         = contract_name + \"_\" + report_date + \"_\" + report_reference.to_s\n\n    public_pdf    = ReportPdf.new current_company, report, []\n    public_pdf.generate_pdf( report, pdf_name )\n\n    internal_pdf    = ReportPdf.new current_company, report, [], \"internal\"\n    internal_pdf.generate_pdf( report, pdf_name + \"_internal\"  )\n\n    zip_pdf( \"#{Rails.root}/tmp/pdf/reports/#{report.reference}\" )\n\n    send_file( \"#{Rails.root}/tmp/pdf/reports/#{report.reference}.zip\"  )\n\n  end\n\n  def zip_pdf( path )\n    archive = File.join( File.dirname(path), File.basename(path) )+'.zip'\n    Zip::ZipFile.open( archive, 'w' ) do |zipfile|\n      Dir[\"#{path}/**/**\"].reject{ |f|f==archive }.each do |file|\n        zipfile.add( file.sub( path +'/','' ),file)\n      end\n    end\n  end\n\nend\n</code></pre>\n\n<p>report_pdf.rb:</p>\n\n<pre><code>require 'fileutils'\nrequire 'open-uri'\nrequire 'prawn'\nrequire 'prawn/table'\n\nclass ReportPdf &lt; PdfBuilder\n  def initialize( company, report, recipients, version = '', pdf_info = nil )\n    phone = company.current_phones.where(label: \"work\")[0].try :value\n    fax   = company.current_phones.where(label: \"fax\")[0].try  :value\n    email = company.current_emails.where(label: \"company\")[0].try :value\n\n    @version = version\n    @company = OpenStruct.new(\n      name:      company.name.mb_chars.upcase,\n      logopath:  company.logo.url_or_path,\n      address:   company.address.try( :entered_by_user ),\n      phone:     phone,\n      fax:       fax,\n      email:     email,\n      display_default_avatar: company.display_default_avatar\n    )\n\n    @declarant    = format_technician( report.declarant )\n    @team_members = report.teammates.map { |teammate| format_technician( teammate ) }\n\n    @report = OpenStruct.new(\n      reference:  report.reference,\n      date:       report.date,\n      type:       report.activity_type,\n      site:                 report.site,\n      address:              report.intervention_address,\n      sheets:               report.sheets,\n      fragment_color:       company.report_fragment_color[1..6], # Select 6 first number of hexadecimal color\n      activities:           report.activities,\n      intervention_type?:   report.intervention_type?\n    )\n\n\n    @pdf = Prawn::Document.new( info: pdf_info )\n  end\n\n  def draw()\n    ReportPdf::RegisterFont.new( @pdf )\n\n    ReportPdf::Header.new(  @pdf, @company ).draw\n    ReportPdf::Content.new( @pdf, @report, @declarant, @team_members, @version, @company ).draw\n    ReportPdf::Footer.new(  @pdf ).draw\n  end\n\n  def generate\n    draw\n    @pdf.render\n  end\n\n  def generate_file(filename)\n    draw\n    FileUtils.mkdir_p 'tmp/pdf'\n    @pdf.render_file \"#{ Rails.root }/tmp/pdf/#{ filename }\"\n  end\n\n  def generate_pdf(report, version)\n    draw\n    path = \"tmp/pdf/reports/#{report.reference}\"\n    pdf_filename = report.decorate.attachment_pdf_filename\n    # Remove old directory\n\n    FileUtils.mkdir_p( path )  # Create a new directory\n    @pdf.render_file \"#{ Rails.root }/#{path}/#{ version }\"\n  end\n\n\n  def format_technician(technician)\n    default_avatar = Rails.root + 'app/assets/images/default_avatar.png'\n    OpenStruct.new(\n      name:   technician.decorate.format_name,\n      avatar: technician.avatar.try( :url_or_path ) || default_avatar\n    )\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537198462, "post_id": 52369807, "comment_id": 91687104, "body": "Does this work? <code>stub_request(:post, &#47;.*&#47;).with(body: &#47;zimpler&#47;)</code>"}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537270786, "post_id": 52369807, "comment_id": 91715608, "body": "Yes, but only the post request. The body is not working for some reason."}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537193735, "creation_date": 1537193735, "question_id": 52369807, "link": "https://stackoverflow.com/questions/52369807/stub-request-if-it-contains-keyword", "title": "Stub request if it contains keyword", "body": "<p>I want to stub requests from rspec file if it contains the keyword <code>zimpler</code> no matter what is the POST address and the content.</p>\n\n<pre><code>  stub_request(:post, \"http://www.example.com/\").\n             with(body: \"zimpler\")\n             to_return(:status =&gt; 200, :body =&gt; xml_file, :headers =&gt; {})\n</code></pre>\n\n<p>is there a way to implement this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actioncable"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1537191019, "post_id": 52368799, "comment_id": 91682145, "body": "I guess the error points to a file and line number, right?"}, {"owner": {"reputation": 187, "user_id": 2030396, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/9a8599064c68d4d7c337bb7f809b5838?s=128&d=identicon&r=PG", "display_name": "Mi\u0161el Ademi", "link": "https://stackoverflow.com/users/2030396/mi%c5%a1el-ademi"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1537191093, "post_id": 52368799, "comment_id": 91682199, "body": "@arieljuod this is my full error: <code>NoMethodError: undefined method &#39;debug&#39; for nil:NilClass \tfrom (irb):12</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537191195, "post_id": 52368799, "comment_id": 91682252, "body": "@Mi\u0161elAdemi That&#39;s not a full error. That&#39;t <i>one line</i> of the error. Can you please <a href=\"https://stackoverflow.com/posts/52368799/edit\">edit the question</a> with the <b>full</b> error, and show which part of your code actually triggers this?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537191279, "post_id": 52368799, "comment_id": 91682309, "body": "Since this seems to be a &quot;vanilla&quot; rails setup, it shouldn&#39;t be too hard to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of the problem. How can I reproduce the error on my machine, from scratch?"}, {"owner": {"reputation": 187, "user_id": 2030396, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/9a8599064c68d4d7c337bb7f809b5838?s=128&d=identicon&r=PG", "display_name": "Mi\u0161el Ademi", "link": "https://stackoverflow.com/users/2030396/mi%c5%a1el-ademi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537191315, "post_id": 52368799, "comment_id": 91682341, "body": "@TomLord I run the code from console, so I run from console that one line and it return error to me."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537191362, "post_id": 52368799, "comment_id": 91682374, "body": "OK @Mi\u0161elAdemi, so what would be the complete reproduction steps for this? Run <code>rails new</code>, add a config file (??), then run that command from <code>rails console</code>?"}, {"owner": {"reputation": 187, "user_id": 2030396, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/9a8599064c68d4d7c337bb7f809b5838?s=128&d=identicon&r=PG", "display_name": "Mi\u0161el Ademi", "link": "https://stackoverflow.com/users/2030396/mi%c5%a1el-ademi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537191692, "post_id": 52368799, "comment_id": 91682587, "body": "@TomLord I added code a wrote for channel. Yes I added a config/cable.yml file and then from console I am trying to trigger broadcast message."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537192084, "post_id": 52368799, "comment_id": 91682865, "body": "(1) You still haven&#39;t shown the <code>config&#47;cable.yml</code> file. (2) You still haven&#39;t shown the full error."}, {"owner": {"reputation": 187, "user_id": 2030396, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/9a8599064c68d4d7c337bb7f809b5838?s=128&d=identicon&r=PG", "display_name": "Mi\u0161el Ademi", "link": "https://stackoverflow.com/users/2030396/mi%c5%a1el-ademi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537192407, "post_id": 52368799, "comment_id": 91683083, "body": "@TomLord I added config file also, what you mean by full error, I showed you all lines console frints?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537194748, "post_id": 52368799, "comment_id": 91684656, "body": "But at a glance, is the error simply that you haven&#39;t indented lines 2 and 3 in the <code>config&#47;cable.yml</code> properly?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537199872, "post_id": 52368799, "comment_id": 91687877, "body": "My guess is: Since the indentation is wrong, you haven&#39;t actually defined an <code>adapter</code>. And if you print the full stack trace, you&#39;ll see that there&#39;s a <code>nil</code> adapter object somewhere; and the library is trying to call <code>adapter.debug</code>, where <code>adapter == nil</code>."}], "owner": {"reputation": 187, "user_id": 2030396, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/9a8599064c68d4d7c337bb7f809b5838?s=128&d=identicon&r=PG", "display_name": "Mi\u0161el Ademi", "link": "https://stackoverflow.com/users/2030396/mi%c5%a1el-ademi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537192344, "creation_date": 1537190557, "last_edit_date": 1537192344, "question_id": 52368799, "link": "https://stackoverflow.com/questions/52368799/rails-actioncable-undefined-method-debug-for-nilnilclass", "title": "Rails ActionCable undefined method `debug&#39; for nil:NilClass", "body": "<p>I am trying to implement ActionCable to rails 5.2.1 app. I added congif/cable.yml file because it was missing and I generated channel but shen I try to broadcast message from rails console using commant</p>\n\n<pre><code>ActionCable.server.broadcast 'comments:1', { asd: true }\n</code></pre>\n\n<p>it returns me error message:</p>\n\n<pre><code>undefined method `debug' for nil:NilClass\n</code></pre>\n\n<p>channels/comments_channel.rb</p>\n\n<pre><code>class CommentsChannel &lt; ApplicationCable::Channel\n  def subscribed\n    stream_from \"comments:1\"\n  end\n\n  def unsubscribed\n    stop_all_streams\n  end\nend\n</code></pre>\n\n<p>assets/javascripts/channels/comments.js</p>\n\n<pre><code>App.comments = App.cable.subscriptions.create(\"CommentsChannel\", {\n  connected: function() {\n    // Called when the subscription is ready for use on the server\n  },\n\n  disconnected: function() {\n    // Called when the subscription has been terminated by the server\n  },\n\n  received: function(data) {\n    console.log(data)\n  }\n});\n</code></pre>\n\n<p>config/cable.yml</p>\n\n<pre><code>development:\n adapter: redis\n url: redis://localhost:6379/1\n\ntest:\n  adapter: async\n\nproduction:\n  adapter: redis\n  url: redis://localhost:6379/1\n</code></pre>\n"}, {"tags": ["ruby", "memcached"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1537190501, "post_id": 52368647, "comment_id": 91681788, "body": "Hard to say without some code to see but if your hash is called memhash: memhash.each { |key, value| memhash.delete(key) if key.include?(&#39;flushable&#39;) }"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1537195142, "post_id": 52368647, "comment_id": 91684908, "body": "Memcached doesn&#39;t have an <code>each</code> method that works like this, as far as I can see.  It doesn&#39;t store everything as a hash, it&#39;s via its own internal (black box) workings."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1537212389, "post_id": 52368647, "comment_id": 91693719, "body": "@Mark, if it were a simple hash, it would be better to use <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-reject\" rel=\"nofollow noreferrer\">Hash#reject</a> (or <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-reject-21\" rel=\"nofollow noreferrer\">Hasj#reject!</a> if you want to mutate the hash) so you aren&#39;t deleting elements of the hash (key-value pairs) that are being enumerated."}], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537190039, "creation_date": 1537190039, "question_id": 52368647, "link": "https://stackoverflow.com/questions/52368647/memcached-how-to-clear-all-keys-with-flushable-in-the-name", "title": "memcached: how to clear all keys with &quot;flushable&quot; in the name", "body": "<p>I'm using Memcached 1.4.14-0ubuntu9.3 with a ruby project.  I want a way to clear all keys that have the string \"flushable\" in them.  The only way I've come up with so far is a script which telnets onto the port to read the keys:  I can then grep those for the substring, and call an individual <code>delete</code> call for each.  But, this feels rather inelegant to say the least.  </p>\n\n<p>Is there a way to do it more elegantly within my connection from Ruby?  I access memcache via an object called CACHE.</p>\n"}, {"tags": ["ruby", "performance"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1537186191, "post_id": 52366705, "comment_id": 91679013, "body": "What do you mean by difference? Speed, the order of execution, or something else ?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 5, "creation_date": 1537191456, "post_id": 52366705, "comment_id": 91682429, "body": "Option 1 creates a temporary array containing the elements satisfying <code>p_1</code> and then filters that (smaller) array again, returning elements which (also) satisfy <code>p_2</code>. Option 2 on the other hand does both checks at once (<code>&amp;&amp;</code> short-circuits), thus eliminating the need for a temporary array. Unless <code>arr</code> is really huge, I think it&#39;s more a matter of style / preference / readability."}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1537197296, "post_id": 52366705, "comment_id": 91686407, "body": "@Stefan +1, in both situations costly <code>p2</code> will be executed the same amount of times. Each <code>select</code> will create an intermediate array, so this has some overhead, at least from a memory perspective. If you are willing to chain a number of this kind of filters and you want to keep this &quot;chain&quot; readability you could think of using transducers (if there are in Ruby ^^)."}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1537197653, "post_id": 52366705, "comment_id": 91686627, "body": "<a href=\"https://medium.com/@baweaver/understanding-transducers-in-ruby-209766372c39\" rel=\"nofollow noreferrer\">medium.com/@baweaver/&hellip;</a>"}, {"owner": {"reputation": 501, "user_id": 4681998, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e983411d6b657a245740031a55ed4b3?s=128&d=identicon&r=PG", "display_name": "preferred_anon", "link": "https://stackoverflow.com/users/4681998/preferred-anon"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1537266571, "post_id": 52366705, "comment_id": 91712979, "body": "@Viktor I tagged this as performance, but I guess that&#39;s not really what I mean. It&#39;s obviously a very small change and in ordinary usage the difference in speeds will be miniscule. I knew that the <code>&amp;&amp;</code> would stop immediately if <code>p_1</code> was false, and therefore the number of predicate executions was the same. But they&#39;re clearly not <i>exactly</i> the same. So I suppose I was just curious to see exactly what they did differently, and whether this had any important consequences. It&#39;s possible that Stefan&#39;s comment answers the question, I did not know in advance what the answer would be."}], "answers": [{"tags": [], "owner": {"reputation": 11603, "user_id": 234593, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/8e2ee1b00d372ad8f6ed5e87385ffef5?s=128&d=identicon&r=PG", "display_name": "Kache", "link": "https://stackoverflow.com/users/234593/kache"}, "is_accepted": false, "score": 0, "last_activity_date": 1593838316, "creation_date": 1593838316, "answer_id": 62725472, "question_id": 52366705, "link": "https://stackoverflow.com/questions/52366705/ruby-performance-chaining-selects-vs-and-ing-predicates/62725472#62725472", "title": "Ruby Performance: Chaining selects vs AND-ing predicates?", "body": "<p>It looks like you're already aware of both the performance characteristics your predicates and the shape of your data, which is great!</p>\n<p>Is there a difference? Simply put, yes -- the evaluation order is different:</p>\n<pre class=\"lang-rb prettyprint-override\"><code># Option 1\narr[0].p_1\narr[1].p_1\narr[2].p_1\n...\narr[n].p_1\narr[0].p_2\narr[1].p_2\narr[2].p_2\n...\narr[n].p_2\n</code></pre>\n<p>versus</p>\n<pre class=\"lang-rb prettyprint-override\"><code># Option 2\narr[0].p_1\narr[0].p_2\narr[1].p_1\narr[1].p_2\narr[2].p_1\narr[2].p_2\n...\narr[n].p_1\narr[n].p_2\n</code></pre>\n<p>Now, <em>does it matter</em>? That depends on very situational and contextual side-effects. Just as examples, let's explore a few scenarios:</p>\n<h2>Blocking, Buffered I/O</h2>\n<p>Suppose the reason <code>p_2</code> was much more expensive is because it does some I/O like write to disk. It may be the case that this output operation is buffered, and while the Ruby runtime may return from the <code>p_2</code> call, the output is still flushing by the time <code>p_2</code> is called again, blocking it.</p>\n<p>In this particular case, Option 2 is faster because <code>p_1</code> computation can continue in the interim between the <code>p_2</code> calls that block each other.</p>\n<h2>Cache Misses</h2>\n<p>Suppose the reason <code>p_1</code> is fast is because its computation can be cached. Let's also suppose that calling <code>p_2</code> disrupts that cache somehow in a way that make subsequent <code>p_1</code> calls get cache misses:</p>\n<ul>\n<li>maybe it also adds to the cache, and the cache fills up, evicting values</li>\n<li>maybe the cache is time-evicted, and the cached data is evicted between <code>p_1</code> calls because <code>p_2</code> just takes too long</li>\n</ul>\n<p>In this particular case, Option 1 is faster because the grouped <code>p_1</code> calls are able to take advantage of the cache.</p>\n<h2>Sharing Limited Memory</h2>\n<p>Suppose both <code>p_1</code> and <code>p_2</code> calls require a lot of memory. Perhaps by interleaving them, resources needed by both have to be made readily available the entire time, hitting the memory limits of the system, hurting performance.</p>\n<p>In this case, Option 1 is faster because once all <code>p_1</code> calls are done, the memory used to hold its resources can be freed for use by the later <code>p_2</code> calls.</p>\n"}], "owner": {"reputation": 501, "user_id": 4681998, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e983411d6b657a245740031a55ed4b3?s=128&d=identicon&r=PG", "display_name": "preferred_anon", "link": "https://stackoverflow.com/users/4681998/preferred-anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 2, "answer_count": 1, "score": 7, "last_activity_date": 1593838790, "creation_date": 1537183718, "last_edit_date": 1593838790, "question_id": 52366705, "link": "https://stackoverflow.com/questions/52366705/ruby-performance-chaining-selects-vs-and-ing-predicates", "title": "Ruby Performance: Chaining selects vs AND-ing predicates?", "body": "<p>If I want to select all elements of an array <code>arr</code> satisfying both predicates <code>p_1</code> and <code>p_2</code>, then I have two options for implementation:  </p>\n\n<p>Option 1: </p>\n\n<pre><code>arr.select{|x| x.p_1}.select{|x| x.p_2}\n</code></pre>\n\n<p>Option 2: </p>\n\n<pre><code>arr.select{|x| x.p_1 &amp;&amp; x.p_2}\n</code></pre>\n\n<p>Is there a significant difference between the two? In my use case the predicate <code>p_1</code> reduces the list much more than <code>p_2</code>, and <code>p_2</code> is more expensive than <code>p_1</code>. So I suspect putting <code>p_1</code> before <code>p_2</code> makes it quicker. But do either of the options above make a difference?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1537182360, "post_id": 52366054, "comment_id": 91676752, "body": "Please update your question with the form 1 and form 2"}, {"owner": {"reputation": 106, "user_id": 7041431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a2bba00d63c1a5ece36d4933c175df?s=128&d=identicon&r=PG&f=1", "display_name": "Ken Nguyen", "link": "https://stackoverflow.com/users/7041431/ken-nguyen"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537183821, "post_id": 52366054, "comment_id": 91677574, "body": "Hi @Pavan  in form 1, when i input any text it won&#39;t show the popup as the above image."}, {"owner": {"reputation": 106, "user_id": 7041431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a2bba00d63c1a5ece36d4933c175df?s=128&d=identicon&r=PG&f=1", "display_name": "Ken Nguyen", "link": "https://stackoverflow.com/users/7041431/ken-nguyen"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537183968, "post_id": 52366054, "comment_id": 91677653, "body": "the both form are the same code"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537184111, "post_id": 52366054, "comment_id": 91677748, "body": "You need to show us the code for both form1 and form2 to understand how they are structured. It help us to reproduce the problem."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1537184403, "post_id": 52366054, "comment_id": 91677904, "body": "Not only the <code>text_field_tag</code> is important but also its enclosing form. For example, validation could fail if the tag is not enclosed in a <code>&lt;form&gt;</code> tag or if the form has a <code>novalidate</code> attribute. Show your code, please."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1537184749, "post_id": 52366054, "comment_id": 91678129, "body": "BTW, if you are rendering a model related form, you should use <code>form_for</code> and <code>text_field</code>, e.g. <code>&lt;%= form_for @user do |f| %&gt;</code> and <code>&lt;%= f.text_field :first_name %&gt;</code>. See <a href=\"https://guides.rubyonrails.org/form_helpers.html#binding-a-form-to-an-object\" rel=\"nofollow noreferrer\">Binding a Form to an Object</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 4, "creation_date": 1537182441, "post_id": 52366173, "comment_id": 91676796, "body": "It is always good to have model validations, but this doesn&#39;t answer the question <i>why <code>required :true</code> didn&#39;t worked?</i>"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 3, "last_activity_date": 1537181813, "creation_date": 1537181813, "answer_id": 52366173, "question_id": 52366054, "link": "https://stackoverflow.com/questions/52366054/ruby-on-rails-required-true-dont-work/52366173#52366173", "title": "Ruby on Rails : &quot;required: true&quot; Don&#39;t work", "body": "<p>It's best to deal with things like this in the model. In your app/models/user.rb file, add:</p>\n\n<pre><code>validates_presence_of :first_name\n</code></pre>\n\n<p>This will mean updating the record without a first_name present will cause the save to fail. You then need to render the edit page again, which should show the user the relevant error messages.</p>\n"}], "owner": {"reputation": 106, "user_id": 7041431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a2bba00d63c1a5ece36d4933c175df?s=128&d=identicon&r=PG&f=1", "display_name": "Ken Nguyen", "link": "https://stackoverflow.com/users/7041431/ken-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1537237166, "creation_date": 1537181415, "last_edit_date": 1537237166, "question_id": 52366054, "link": "https://stackoverflow.com/questions/52366054/ruby-on-rails-required-true-dont-work", "title": "Ruby on Rails : &quot;required: true&quot; Don&#39;t work", "body": "<p>I have already fixed it</p>\n\n<p>Closed</p>\n\n<p>[![enter image description here][1]][1]    &lt;%= text_field_tag(:first_name, @user['first_name'], class: \"user-input\", required: true) %></p>\n\n<p>I have 2 forms </p>\n\n<p>In form 1, I'm trying to make required some fields but it is not working.</p>\n\n<p>when i input any text ,it don't show the popup as the above image</p>\n\n<p>In form 2, it is working</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 1875, "user_id": 4991626, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/GZ6rj.jpg?s=128&g=1", "display_name": "ashwintastic", "link": "https://stackoverflow.com/users/4991626/ashwintastic"}, "edited": false, "score": 0, "creation_date": 1537181119, "post_id": 52365858, "comment_id": 91676068, "body": "seems like you are trying to get id in <code>controller2#new</code>  if someone clicks <code>anchor</code> tag ?"}, {"owner": {"reputation": 23, "user_id": 10356888, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JMQwVmIq5jc/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPRoE8gNYXBMxxxeXS-0bF4j2ie-Q/mo/photo.jpg?sz=128", "display_name": "Niraj Pal", "link": "https://stackoverflow.com/users/10356888/niraj-pal"}, "reply_to_user": {"reputation": 1875, "user_id": 4991626, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/GZ6rj.jpg?s=128&g=1", "display_name": "ashwintastic", "link": "https://stackoverflow.com/users/4991626/ashwintastic"}, "edited": false, "score": 0, "creation_date": 1537181432, "post_id": 52365858, "comment_id": 91676214, "body": "Yes I need parameter of controller1 in the new action of controller2"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10356888, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JMQwVmIq5jc/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPRoE8gNYXBMxxxeXS-0bF4j2ie-Q/mo/photo.jpg?sz=128", "display_name": "Niraj Pal", "link": "https://stackoverflow.com/users/10356888/niraj-pal"}, "edited": false, "score": 0, "creation_date": 1537183803, "post_id": 52366130, "comment_id": 91677559, "body": ":href =&gt; &quot;/controller2/new?controller1_id=#{parameteroffirst.id}&quot;, :role =&gt; &quot;button&quot;  It is not working"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1537183409, "last_edit_date": 1537183409, "creation_date": 1537181643, "answer_id": 52366130, "question_id": 52365858, "link": "https://stackoverflow.com/questions/52365858/how-to-send-parameter-to-the-action-of-another-controller-through-url-in-rails/52366130#52366130", "title": "how to send parameter to the action of another controller through url in rails?", "body": "<p>If you really want to write it out like this, try changing:</p>\n\n<pre><code>:href =&gt; \"/controller2/new/#{parameteroffirst.id}\", :controller1_id @controller1.id\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>:href =&gt; \"/controller2/new?controller1_id=#{parameteroffirst.id}\"\n</code></pre>\n\n<p>But it's really worth your reading up on how links are supposed to work in ruby / rails:</p>\n\n<p><a href=\"https://api.rubyonrails.org/v5.2.1/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/v5.2.1/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to</a></p>\n"}, {"tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 0, "last_activity_date": 1537190343, "creation_date": 1537190343, "answer_id": 52368739, "question_id": 52365858, "link": "https://stackoverflow.com/questions/52365858/how-to-send-parameter-to-the-action-of-another-controller-through-url-in-rails/52368739#52368739", "title": "how to send parameter to the action of another controller through url in rails?", "body": "<p>A good practice in rails is to use named routes instead of string urls.</p>\n\n<pre><code>%a.btn-general{href: url_for(controller: :controller2, action: :new, id: parameteroffirst.id, controller1_id: @controller1.id), role: \"button\"} Add the first\n</code></pre>\n\n<p>It will generate an url like <code>/controller2/new/#{parameteroffirst.id}?controller1_id=#{@controller1.id}</code>. but you can change the route tomorrow without the need to go all over your code changing the hardcoded links.</p>\n"}], "owner": {"reputation": 23, "user_id": 10356888, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JMQwVmIq5jc/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPRoE8gNYXBMxxxeXS-0bF4j2ie-Q/mo/photo.jpg?sz=128", "display_name": "Niraj Pal", "link": "https://stackoverflow.com/users/10356888/niraj-pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537190343, "creation_date": 1537180786, "last_edit_date": 1537182753, "question_id": 52365858, "link": "https://stackoverflow.com/questions/52365858/how-to-send-parameter-to-the-action-of-another-controller-through-url-in-rails", "title": "how to send parameter to the action of another controller through url in rails?", "body": "<p>How to send parameter to the action of another controller through url in rails?</p>\n\n<p>controller1:</p>\n\n<pre><code>def show\n  @controller1.id = params[:controller1_id]\nend\n</code></pre>\n\n<p>in the view of controller1:</p>\n\n<pre><code>%a.btn-general{:href =&gt; \"/controller2/new/#{parameteroffirst.id}\", :controller1_id @controller1.id,  :role =&gt; \"button\"} Add the first\n</code></pre>\n\n<p>how to send <code>controller1.id</code> to <code>new</code> action of <code>controller2</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-2.5"], "answers": [{"tags": [], "owner": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "is_accepted": false, "score": 0, "last_activity_date": 1537180878, "creation_date": 1537180878, "answer_id": 52365885, "question_id": 52365299, "link": "https://stackoverflow.com/questions/52365299/ruby-2-5-on-ubuntulatest-error-assetsprecompile/52365885#52365885", "title": "ruby 2.5 on ubuntu:latest error assets:precompile", "body": "<p>If you are on production environment, try <code>RAILS_ENV=production rake assets:precompile</code></p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 10254997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TP2Gw.jpg?s=128&g=1", "display_name": "Ivan Ivanov", "link": "https://stackoverflow.com/users/10254997/ivan-ivanov"}, "edited": false, "score": 0, "creation_date": 1537181883, "post_id": 52365948, "comment_id": 91676479, "body": "Thank you, Can the problem be due to the fact that I use Node.js to compile assets."}, {"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "reply_to_user": {"reputation": 143, "user_id": 10254997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TP2Gw.jpg?s=128&g=1", "display_name": "Ivan Ivanov", "link": "https://stackoverflow.com/users/10254997/ivan-ivanov"}, "edited": false, "score": 0, "creation_date": 1537182409, "post_id": 52365948, "comment_id": 91676780, "body": "Definitely not, it&#39;s a Ruby runtime error related to ActiveSupport. Is this the full trace of the error (did you use <code>--trace</code> when you ran <code>rake assets:precompile</code>)?"}], "tags": [], "owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "is_accepted": false, "score": 0, "last_activity_date": 1537181073, "creation_date": 1537181073, "answer_id": 52365948, "question_id": 52365299, "link": "https://stackoverflow.com/questions/52365299/ruby-2-5-on-ubuntulatest-error-assetsprecompile/52365948#52365948", "title": "ruby 2.5 on ubuntu:latest error assets:precompile", "body": "<p>I think you should stick with Ruby 2.3, you could experience many runtime errors with 2.5 (like this one you reported)</p>\n"}], "owner": {"reputation": 143, "user_id": 10254997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TP2Gw.jpg?s=128&g=1", "display_name": "Ivan Ivanov", "link": "https://stackoverflow.com/users/10254997/ivan-ivanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537181073, "creation_date": 1537178824, "question_id": 52365299, "link": "https://stackoverflow.com/questions/52365299/ruby-2-5-on-ubuntulatest-error-assetsprecompile", "title": "ruby 2.5 on ubuntu:latest error assets:precompile", "body": "<p>I support Rails 4.2.5 application on Ruby 2.5. Packages and rails are ok, but when I run <code>rake assets:precompile</code> I have error.</p>\n\n<pre><code>eric&gt;'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/subscriber.rb:80:in `join'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/subscriber.rb:80:in `initialize'\n/var/lib/gems/2.5.0/gems/activerecord-4.2.5/lib/active_record/log_subscriber.rb:19:in `initialize'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/subscriber.rb:33:in `new'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/subscriber.rb:33:in `attach_to'\n/var/lib/gems/2.5.0/gems/activerecord-4.2.5/lib/active_record/log_subscriber.rb:75:in `&lt;top (required)&gt;'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `require'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `block in require'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:240:in `load_dependency'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `require'\n/var/lib/gems/2.5.0/gems/activerecord-4.2.5/lib/active_record/railties/controller_runtime.rb:2:in `&lt;top (required)&gt;'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `require'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `block in require'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:240:in `load_dependency'\n/var/lib/gems/2.5.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `require'\n/var/lib/gems/2.5.0/gems/activerecord-4.2.5/lib/active_record/railtie.rb:138:in `block in &lt;class:Railtie&gt;'\n/var/lib/gems/2.5.0/gems/railties-4.2.5/lib/rails/initializable.rb:30:in `instance_exec'\n/var/lib/gems/2.5.0/gems/railties-4.2.5/lib/rails/initializable.rb:30:in `run'\n/var/lib/gems/2.5.0/gems/railties-4.2.5/lib/rails/initializable.rb:55:in `block in run_initializers'\n/var/lib/gems/2.5.0/gems/railties-4.2.5/lib/rails/initializable.rb:54:in `run_initializers'\n/var/lib/gems/2.5.0/gems/railties-4.2.5/lib/rails/application.rb:352:in `initialize!'\n/var/lib/gems/2.5.0/gems/railties-4.2.5/lib/rails/railtie.rb:194:in `public_send'\n/var/lib/gems/2.5.0/gems/railties-4.2.5/lib/rails/railtie.rb:194:in `method_missing'\n/wealthoz/config/environment.rb:5:in `&lt;top (required)&gt;'\n/var/lib/gems/2.5.0/gems/railties-4.2.5/lib/rails/application.rb:328:in `require'\n/var/lib/gems/2.5.0/gems/railties-4.2.5/lib/rails/application.rb:328:in `require_environment!'\n/var/lib/gems/2.5.0/gems/railties-4.2.5/lib/rails/application.rb:457:in `block in run_tasks_blocks'\n/var/lib/gems/2.5.0/gems/sprockets-rails-2.3.3/lib/sprockets/rails/task.rb:64:in `block (2 levels) in define'\nTasks: TOP =&gt; environment\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>I don't deploy intro docker containers on ruby 2.5 image.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "url", "routes"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1537176492, "post_id": 52364555, "comment_id": 91673322, "body": "You can use different subdomain for multiple users like, school1.golbalschool.com, instead of separate domain"}, {"owner": {"reputation": 476, "user_id": 5682238, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/872df0dc333fcc53aa31a7f681b77051?s=128&d=identicon&r=PG&f=1", "display_name": "Nischay Namdev", "link": "https://stackoverflow.com/users/5682238/nischay-namdev"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 1, "creation_date": 1537176568, "post_id": 52364555, "comment_id": 91673364, "body": "I know that, but what I want is to use different URLs not subdomains!"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1537177059, "post_id": 52364555, "comment_id": 91673682, "body": "Do you know, you have to purchase domain for every school ? are you aware about that ?"}, {"owner": {"reputation": 476, "user_id": 5682238, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/872df0dc333fcc53aa31a7f681b77051?s=128&d=identicon&r=PG&f=1", "display_name": "Nischay Namdev", "link": "https://stackoverflow.com/users/5682238/nischay-namdev"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 1, "creation_date": 1537177165, "post_id": 52364555, "comment_id": 91673733, "body": "of course .. .."}], "answers": [{"comments": [{"owner": {"reputation": 476, "user_id": 5682238, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/872df0dc333fcc53aa31a7f681b77051?s=128&d=identicon&r=PG&f=1", "display_name": "Nischay Namdev", "link": "https://stackoverflow.com/users/5682238/nischay-namdev"}, "edited": false, "score": 0, "creation_date": 1537178063, "post_id": 52364618, "comment_id": 91674343, "body": "should I use  <b>resolv</b>  ?"}, {"owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "reply_to_user": {"reputation": 476, "user_id": 5682238, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/872df0dc333fcc53aa31a7f681b77051?s=128&d=identicon&r=PG&f=1", "display_name": "Nischay Namdev", "link": "https://stackoverflow.com/users/5682238/nischay-namdev"}, "edited": false, "score": 0, "creation_date": 1537178120, "post_id": 52364618, "comment_id": 91674384, "body": "What&#39;s resolv? Can you please share a link to clarify."}, {"owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "reply_to_user": {"reputation": 476, "user_id": 5682238, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/872df0dc333fcc53aa31a7f681b77051?s=128&d=identicon&r=PG&f=1", "display_name": "Nischay Namdev", "link": "https://stackoverflow.com/users/5682238/nischay-namdev"}, "edited": false, "score": 1, "creation_date": 1537178672, "post_id": 52364618, "comment_id": 91674772, "body": "Ahh, thanks for the clarification. I&#39;ll amend my answer to provide more detail on how i&#39;d implement this."}, {"owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "reply_to_user": {"reputation": 476, "user_id": 5682238, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/872df0dc333fcc53aa31a7f681b77051?s=128&d=identicon&r=PG&f=1", "display_name": "Nischay Namdev", "link": "https://stackoverflow.com/users/5682238/nischay-namdev"}, "edited": false, "score": 0, "creation_date": 1537179542, "post_id": 52364618, "comment_id": 91675249, "body": "@nnd if this answers your question i&#39;d really appreciate it if you mark the answer as correct!"}, {"owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "reply_to_user": {"reputation": 476, "user_id": 5682238, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/872df0dc333fcc53aa31a7f681b77051?s=128&d=identicon&r=PG&f=1", "display_name": "Nischay Namdev", "link": "https://stackoverflow.com/users/5682238/nischay-namdev"}, "edited": false, "score": 0, "creation_date": 1537179682, "post_id": 52364618, "comment_id": 91675310, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/180193/discussion-between-ben-toogood-and-nnd\">continue this discussion in chat</a>."}, {"owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "reply_to_user": {"reputation": 476, "user_id": 5682238, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/872df0dc333fcc53aa31a7f681b77051?s=128&d=identicon&r=PG&f=1", "display_name": "Nischay Namdev", "link": "https://stackoverflow.com/users/5682238/nischay-namdev"}, "edited": false, "score": 0, "creation_date": 1537260497, "post_id": 52364618, "comment_id": 91709343, "body": "@nnd Hey, if this answer helped, I&#39;d really appreciate if you marked it as correct! Thanks in advance \ud83d\ude01"}], "tags": [], "owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "is_accepted": false, "score": 1, "last_activity_date": 1537179500, "last_edit_date": 1537179500, "creation_date": 1537176564, "answer_id": 52364618, "question_id": 52364555, "link": "https://stackoverflow.com/questions/52364555/how-to-have-different-url-for-each-model-instance-in-rails-app/52364618#52364618", "title": "How to have different URL for each Model instance in rails app", "body": "<p>Doing custom domains will be a bit difficult as you'll need to manage the domains and DNS manually. However, it is possible. You would setup multiple domains, and point them all to your application. Then, in your controller you would check which School matches the <code>request.host</code>.</p>\n\n<p>An easier solution is setting up each School with a subdomain. This won't require custom configuration and is outlined very well in this article: <a href=\"https://mythoughts.io/managing-dynamic-domains-with-rails-b6ab1040dc8c\" rel=\"nofollow noreferrer\">https://mythoughts.io/managing-dynamic-domains-with-rails-b6ab1040dc8c</a>.</p>\n\n<p>I hope this helps answer your question,</p>\n\n<p>Ben</p>\n\n<hr>\n\n<p><strong>Update to provide specific implementation details:</strong> </p>\n\n<p>On your <code>School</code> object, I would add a <code>domain</code> attribute of type string. This should be validated for both uniqueness and presence:</p>\n\n<pre><code># Within School.rb:\nvalidates :domain, presence: true, uniqueness: true\n</code></pre>\n\n<p>Next, within your ApplicationController, implement a <code>before_action</code> lookup to find the School based on the requesting URL. This will be in the format school1.com or school2.com. Note, using the <code>!</code> will automatically raise a 404 error if the School isn't found. </p>\n\n<pre><code>before_action :find_school\n\nprivate\n\ndef find_school\n  @school = School.find_by_domain!(request.host)\nend \n</code></pre>\n\n<p>To test this locally, you can edit your hosts file using the following command:</p>\n\n<pre><code>sudo nano /etc/hosts\n</code></pre>\n\n<p>Add the following lines:</p>\n\n<pre><code>127.0.0.1 school1.com\n127.0.0.1 school2.com\n</code></pre>\n\n<p>You can then access your appliation via your web browser using school1.com:3000 and school2.com:3000. (You need to use port 3000 as this is the port your rails application will be using by default).</p>\n"}], "owner": {"reputation": 476, "user_id": 5682238, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/872df0dc333fcc53aa31a7f681b77051?s=128&d=identicon&r=PG&f=1", "display_name": "Nischay Namdev", "link": "https://stackoverflow.com/users/5682238/nischay-namdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537179500, "creation_date": 1537176318, "question_id": 52364555, "link": "https://stackoverflow.com/questions/52364555/how-to-have-different-url-for-each-model-instance-in-rails-app", "title": "How to have different URL for each Model instance in rails app", "body": "<p>I was curious that how we can create different URLs for each of the model instances.</p>\n\n<p><em>for e.g.</em> </p>\n\n<p>If I have a model <strong>School</strong> which has many associated models with it like <strong>departments, classes, students etc.</strong>  Now what I want is that whenever User registers a new school, it should have its own URL. [ <strong><em>New School form ask users for URL and name of the school</em></strong>]</p>\n\n<p><em>e.g.</em></p>\n\n<p>www.school1.com/classes/1</p>\n\n<p>OR </p>\n\n<p>www.school2.com/students/2</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "aws-sdk"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1537172354, "post_id": 52363467, "comment_id": 91671056, "body": "The issue was already reported: <a href=\"https://github.com/fog/fog-aws/issues/466\" rel=\"nofollow noreferrer\">github.com/fog/fog-aws/issues/466</a>"}, {"owner": {"reputation": 83, "user_id": 6590939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2s7sc.jpg?s=128&g=1", "display_name": "Rajnik", "link": "https://stackoverflow.com/users/6590939/rajnik"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1537173502, "post_id": 52363467, "comment_id": 91671647, "body": "I see but How I can fix in my system"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1537174124, "post_id": 52363467, "comment_id": 91671988, "body": "@Rajnik the issue has not been resolved, yet. There is an <a href=\"https://github.com/fog/fog-aws/pull/467\" rel=\"nofollow noreferrer\">open PR</a> which is supposed to fix the deprecation warnings by renaming the affected constants."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1537187027, "post_id": 52363467, "comment_id": 91679486, "body": "If you <i>really</i> want to &quot;fix&quot; the problem immediately, you could point your <code>Gemfile</code> at that fork: <a href=\"https://github.com/jaredbeck/fog-aws/tree/fix_cdn_dpr_warn\" rel=\"nofollow noreferrer\">github.com/jaredbeck/fog-aws/tree/fix_cdn_dpr_warn</a> ... But I wouldn&#39;t recommend this. The <i>deprecation warning</i> is only a <i>warning</i>; nothing is actually <i>broken</i>. I would advise simply waiting patiently for the official library update that resolves the warning; <i>probably</i> by merging the above PR."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1537343261, "post_id": 52363467, "comment_id": 91745345, "body": "FYI \u2013 the bug was fixed in v3.3.0 (Sep 18)"}, {"owner": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1563351521, "post_id": 52363467, "comment_id": 100666745, "body": "@Stefan I am using <code>fog-aws-3.5.1</code> but still getting these warnings."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6498632, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SfcCzMczktg/AAAAAAAAAAI/AAAAAAAAAPU/eP0bgXXnF80/photo.jpg?sz=128", "display_name": "Vincent Simon", "link": "https://stackoverflow.com/users/6498632/vincent-simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1542993344, "creation_date": 1542993344, "answer_id": 53450717, "question_id": 52363467, "link": "https://stackoverflow.com/questions/52363467/after-upgrading-rails-from-5-1-to-5-2-i-got-following-warning-messages/53450717#53450717", "title": "After upgrading Rails from 5.1 to 5.2 I got following warning messages", "body": "<p>I've got the same bug with <code>fog-openstack</code>.<br>\nIt seems like the latest version of fog is not totally clean (see source below).<br>\nI solved this bug by downgrading <code>fog-openstack</code> to the previous version (ie <code>gem \"fog-openstack\", '~&gt;0.1.23'</code>).</p>\n\n<p>Source <a href=\"https://github.com/fog/fog/issues/4014\" rel=\"nofollow noreferrer\">https://github.com/fog/fog/issues/4014</a></p>\n"}, {"comments": [{"owner": {"reputation": 4101, "user_id": 1482055, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f4D9p.jpg?s=128&g=1", "display_name": "Milind", "link": "https://stackoverflow.com/users/1482055/milind"}, "edited": false, "score": 0, "creation_date": 1611260163, "post_id": 56516798, "comment_id": 116401252, "body": "I resolved this issue by downgrading fog-core from 2.2.3 to 2.1.0"}], "tags": [], "owner": {"reputation": 101, "user_id": 6369268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WuXwz.jpg?s=128&g=1", "display_name": "Alex Kinsbrunner", "link": "https://stackoverflow.com/users/6369268/alex-kinsbrunner"}, "is_accepted": false, "score": 4, "last_activity_date": 1560100864, "creation_date": 1560100864, "answer_id": 56516798, "question_id": 52363467, "link": "https://stackoverflow.com/questions/52363467/after-upgrading-rails-from-5-1-to-5-2-i-got-following-warning-messages/56516798#56516798", "title": "After upgrading Rails from 5.1 to 5.2 I got following warning messages", "body": "<p>I have solved it by adding gem fog-core 2.1.0 :)</p>\n"}], "owner": {"reputation": 83, "user_id": 6590939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2s7sc.jpg?s=128&g=1", "display_name": "Rajnik", "link": "https://stackoverflow.com/users/6590939/rajnik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1175, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1560100864, "creation_date": 1537172270, "last_edit_date": 1537173471, "question_id": 52363467, "link": "https://stackoverflow.com/questions/52363467/after-upgrading-rails-from-5-1-to-5-2-i-got-following-warning-messages", "title": "After upgrading Rails from 5.1 to 5.2 I got following warning messages", "body": "<p>After upgrading Rails from 5.1 to 5.2 I got the following warning messages.</p>\n\n<pre><code>[fog][DEPRECATION] Unable to load Fog::AWS::CDN\n[fog][DEPRECATION] The format Fog::CDN::AWS is deprecated\n[fog][DEPRECATION] Unable to load Fog::AWS::Compute\n[fog][DEPRECATION] The format Fog::Compute::AWS is deprecated\n[fog][DEPRECATION] Unable to load Fog::AWS::DNS\n[fog][DEPRECATION] The format Fog::DNS::AWS is deprecated\n[fog][DEPRECATION] Unable to load Fog::AWS::Storage\n[fog][DEPRECATION] The format Fog::Storage::AWS is deprecated\n</code></pre>\n\n<p>Gemfile</p>\n\n<pre><code>gem 'rails', '~&gt; 5.2'\ngem 'aws-sdk', '~&gt; 2'\ngem 'fog-aws'\n</code></pre>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "timeout", "rack"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537172795, "post_id": 52363431, "comment_id": 91671264, "body": "I&#39;m not sure if this will help, but <a href=\"https://devcenter.heroku.com/articles/request-timeout#debugging-request-timeouts\" rel=\"nofollow noreferrer\">this</a> what heroku suggests."}], "answers": [{"tags": [], "owner": {"reputation": 29107, "user_id": 122080, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6fa1cdda524d49996a8bc6917328de3d?s=128&d=identicon&r=PG", "display_name": "Damien MATHIEU", "link": "https://stackoverflow.com/users/122080/damien-mathieu"}, "is_accepted": true, "score": 6, "last_activity_date": 1537172879, "creation_date": 1537172879, "answer_id": 52363614, "question_id": 52363431, "link": "https://stackoverflow.com/questions/52363431/timeout-not-working-on-heroku-for-rails-application/52363614#52363614", "title": "Timeout not working on heroku for Rails application", "body": "<p>An <a href=\"https://devcenter.heroku.com/articles/error-codes#h12-request-timeout\" rel=\"noreferrer\">H12</a> is a timeout given by Heroku, not raised by your app.\nHeroku doesn't give you a way to increase that timeout.</p>\n\n<p>You should move this to be async anyway. One way could be to trigger a request which creates a \"job\" object with a status. Then, everything you need to do is performed on the background.\nOnce the action is finished, you update the status value from \"pending\" to \"success\".</p>\n\n<p>The client can fetch the job to know the advancement of that async action.</p>\n"}], "owner": {"reputation": 1091, "user_id": 1523227, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fcec017c701e996c8d47f7c187ace339?s=128&d=identicon&r=PG", "display_name": "ZeeAzmat", "link": "https://stackoverflow.com/users/1523227/zeeazmat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 52363614, "answer_count": 1, "score": 0, "last_activity_date": 1537172879, "creation_date": 1537172146, "question_id": 52363431, "link": "https://stackoverflow.com/questions/52363431/timeout-not-working-on-heroku-for-rails-application", "title": "Timeout not working on heroku for Rails application", "body": "<p>I tried increasing timeout, I have app running in production and it's deployed on heroku. I have some requests which takes more than 30 seconds. And those requests are insertion in database. Due to requirements i can't move those insertions to background job. I increased timeout to 60 seconds and later i increased this to 80 seconds and it was working fine. But recently it stopped running no matter what i do it's not letting me increase timeout. This works perfectly fine on development environment but not on production. And gem i used is <strong>rack-timout</strong></p>\n\n<p><strong>I used these options:</strong></p>\n\n<pre><code>Rack::Timeout.timeout = 60  # seconds\nRack::Timeout.wait_timeout = 60\nRack::Timeout.wait_overtime = 60\nRack::Timeout.service_timeout = 60\nRack::Timeout.service_past_wait = true\n</code></pre>\n\n<p>Initially i was using only timeout option and it used to work fine. But later i tried adding more option hoping any of them will work.</p>\n\n<p><strong>Server Output:</strong></p>\n\n<pre><code>    2018-09-17T08:00:32.163182+00:00 heroku[router]: at=error code=H12 desc=\"Request timeout\"\nmethod=POST path=\"/organizations/53/events\" host=HOST_NAME \nrequest_id=abbd22bf-5298-4480-m027-aa00a52a0587 fwd=\"103.7.79.236\" dyno=web.1\nconnect=1ms service=30135ms status=503 bytes=0 protocol=https\n</code></pre>\n\n<p>Any help would be appreciated. Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "date"], "answers": [{"comments": [{"owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "edited": false, "score": 0, "creation_date": 1537184089, "post_id": 52364123, "comment_id": 91677726, "body": "This way I can list out the Modal A with Model B expiry date, however, my concern is bit different. I want to order the Modal A list with the days difference of expiry date and  current date"}, {"owner": {"reputation": 1905, "user_id": 232838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8342950f34a66d9ec7cfe10b33d5494c?s=128&d=identicon&r=PG", "display_name": "koffeinfrei", "link": "https://stackoverflow.com/users/232838/koffeinfrei"}, "reply_to_user": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "edited": false, "score": 0, "creation_date": 1537186106, "post_id": 52364123, "comment_id": 91678955, "body": "@SantoshAryal What&#39;s the difference? Sorting by the expire date in descending order is the same as sorting on the date difference in ascending order."}], "tags": [], "owner": {"reputation": 1905, "user_id": 232838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8342950f34a66d9ec7cfe10b33d5494c?s=128&d=identicon&r=PG", "display_name": "koffeinfrei", "link": "https://stackoverflow.com/users/232838/koffeinfrei"}, "is_accepted": false, "score": 0, "last_activity_date": 1537174829, "creation_date": 1537174829, "answer_id": 52364123, "question_id": 52363372, "link": "https://stackoverflow.com/questions/52363372/order-model-by-the-date-difference-of-its-has-many-model/52364123#52364123", "title": "Order Model by the date difference of its has_many model", "body": "<p>assuming:</p>\n\n<pre><code>class Foo &lt; ActiveRecord::Base\n  belongs_to :bar\nend\n\nclass Bar &lt; ActiveRecord::Base\n  has_many :foos\nend\n</code></pre>\n\n<p>You should be able to sort on the database level using a join statement on the <code>Bar</code>s table:</p>\n\n<pre><code>Foo.joins(:bar).order(bars: { expired_at: :desc })\n</code></pre>\n\n<p>Explanation:</p>\n\n<blockquote>\n  <p>ascending order with the difference of its associated Modal 'B' last record expiry date and today date</p>\n</blockquote>\n\n<p>This means that the newest date should be first, so a simple <code>ORDER BY expired_at DESC</code> should do what you need.</p>\n\n<p>The <code>join</code> is necessary so you can use the <code>Bar</code>s <code>expired_at</code> column.</p>\n\n<p>The hash syntax in the <code>order</code> method is needed to access the join table's attribute.</p>\n"}, {"comments": [{"owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "edited": false, "score": 0, "creation_date": 1537182670, "post_id": 52364611, "comment_id": 91676917, "body": "I checked the difference because I need to show the total remaining days in Modal A list, and also I need to short the Modal A list based on the last expiry date of Modal B getting the expiry date from the last record of Modal B."}], "tags": [], "owner": {"reputation": 1035, "user_id": 5891503, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/830569e0fa440b692ab80005ef9b00cb?s=128&d=identicon&r=PG", "display_name": "reiallenramos", "link": "https://stackoverflow.com/users/5891503/reiallenramos"}, "is_accepted": false, "score": 0, "last_activity_date": 1537176533, "creation_date": 1537176533, "answer_id": 52364611, "question_id": 52363372, "link": "https://stackoverflow.com/questions/52363372/order-model-by-the-date-difference-of-its-has-many-model/52364611#52364611", "title": "Order Model by the date difference of its has_many model", "body": "<p>Checking the difference <code>Time.zone.now - model_b_object.expiry_date</code> is an unnecessary step. Just go directly to the ordering part. This will show the model B records that expired nearest to Today's date.</p>\n\n<p><code>ModelB.all.order(\"expiry_date ASC\")</code></p>\n"}], "owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537176533, "creation_date": 1537171860, "question_id": 52363372, "link": "https://stackoverflow.com/questions/52363372/order-model-by-the-date-difference-of-its-has-many-model", "title": "Order Model by the date difference of its has_many model", "body": "<p>I don't know this is the exact and simple way I am implementing. I have a two model. Modal 'A' belongs to Modal 'B' and 'B' has many to Modal 'A'. I have a date field 'expiry date' in Model B. </p>\n\n<p>Now I want to list out records the Modal 'A'. The list should be in ascending order with the difference of its associated Modal 'B' last record expiry date and today date. I calculated the date difference in view, but still confused to order it. </p>\n\n<pre><code>diff = (f.bill_histories.last.ndate.to_date - DateTime.now.to_date).to_i\n</code></pre>\n\n<p>I tried and google it, but still didn't find suggestion. Please suggest me.</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537171864, "post_id": 52363326, "comment_id": 91670818, "body": "What is <code>config</code> and <code>yaml_file</code> returning ?"}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537172012, "post_id": 52363326, "comment_id": 91670889, "body": "They return very long string <code>{&quot;processing_url&quot;=&gt;&quot;https:&#47;&#47;local&#47;process&#47;&quot;, ........ }</code>"}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537172479, "post_id": 52363326, "comment_id": 91671116, "body": "Can you check value of <code>config</code>, from the error I think it&#39;s a hash, hence the error."}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537172603, "post_id": 52363326, "comment_id": 91671172, "body": "How I have to check it?"}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537172655, "post_id": 52363326, "comment_id": 91671203, "body": "You can use a debugger such as <code>binding.pry</code> and put that before the line <code>allow(request_builder).to receive(config).and_return(config)</code> and see what is the value of <code>config</code>."}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537172839, "post_id": 52363326, "comment_id": 91671296, "body": "Here is the output <a href=\"https://pastebin.com/FDEmXjQd\" rel=\"nofollow noreferrer\">pastebin.com/FDEmXjQd</a>"}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "reply_to_user": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "edited": false, "score": 0, "creation_date": 1537172926, "post_id": 52363326, "comment_id": 91671339, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/180182/discussion-between-kedarnag-mukanahallipatna-and-peter-penzov\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "is_accepted": false, "score": 2, "last_activity_date": 1537182580, "last_edit_date": 1537182580, "creation_date": 1537178620, "answer_id": 52365242, "question_id": 52363326, "link": "https://stackoverflow.com/questions/52363326/undefined-method-to-sym-when-yaml-file-is-stubbed/52365242#52365242", "title": "undefined method `to_sym&#39; when yaml file is stubbed", "body": "<p>You've passed in <code>config</code> rather than <code>:config</code> to the expected call.</p>\n\n<p>It should be:</p>\n\n<pre><code>allow(request_builder)\n  .to receive(:config)\n  .and_return(config)\n</code></pre>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537182580, "creation_date": 1537171732, "question_id": 52363326, "link": "https://stackoverflow.com/questions/52363326/undefined-method-to-sym-when-yaml-file-is-stubbed", "title": "undefined method `to_sym&#39; when yaml file is stubbed", "body": "<p>I have this rspec task which I would like to implement with stubbed config file:</p>\n\n<pre><code>let(:request_builder) { described_class.new(env: nil) } \n  let(:trx_types)       { ['davivienda'] }\n  let(:trx_type)        { 'davivienda' }\n  let(:gateway)         { 'girogate' }\n  let(:currency)        { 'USD' }\n  let(:base_params)     { request_builder.send(:base_params) }\n\n  before(:each) { allow(request_builder).to receive(:currency).and_return('USD') }\n\n  let(:yaml_file) { YAML::load(File.read(File.join('spec', 'fixtures', 'yaml', 'env.yml'))) }\n  let(:config)    { yaml_file['SOF_DEV'] }\n\n  context '#submit!' do\n\n    it \"sends test transactions\" do\n\n      allow(request_builder).to receive(config).and_return(config) \n      request_builder.submit!\n\n      PAYMENT_TYPE_WITH_BASE_PARAMS.each do |x|\n        expect(request_builder).te receive(:process_trx).with(factory(x), :gateway, :base_params)\n      end\n    end\n  end\n</code></pre>\n\n<p>I get error at this line:</p>\n\n<pre><code>allow(request_builder).to receive(config).and_return(config) \n\n\nNoMethodError:\n       undefined method `to_sym' for #&lt;Hash:0x007f86484eb440&gt;\n</code></pre>\n\n<p>Do you know how I can fix this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "paperclip"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537171193, "post_id": 52363057, "comment_id": 91670491, "body": "Are you sure its <code>application&#47;zip</code>? If so just add it to the <code>content_type</code>"}, {"owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537171495, "post_id": 52363057, "comment_id": 91670640, "body": "yeah, its application.zip , I have allowed application.zip but while downloading I received the same file without any extension"}], "answers": [{"comments": [{"owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "edited": false, "score": 0, "creation_date": 1537424866, "post_id": 52405669, "comment_id": 91780843, "body": "My syntax is also correct, when I add application/zip, it works but after downloading, it gives the file without any extension"}], "tags": [], "owner": {"reputation": 408, "user_id": 8051788, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/fYT2M.jpg?s=128&g=1", "display_name": "Akash Kinwad", "link": "https://stackoverflow.com/users/8051788/akash-kinwad"}, "is_accepted": false, "score": 0, "last_activity_date": 1537359352, "creation_date": 1537359352, "answer_id": 52405669, "question_id": 52363057, "link": "https://stackoverflow.com/questions/52363057/upload-docx-file-downloaded-from-google-drive-using-paperclip/52405669#52405669", "title": "Upload docx file downloaded from google drive using paperclip", "body": "<p>The problem is in below line,</p>\n\n<pre><code>validates_attachment :initial_document, content_type: {content_type:\n</code></pre>\n\n<p>here, content_type is repeated, which is not correct syntax.</p>\n\n<p>replace above with</p>\n\n<pre><code>validates_attachment :initial_document, \n  content_type: %w(\n    application/vnd.openxmlformats-officedocument.wordprocessingml.document\n    application/pdf\n    application/msword\n    application/word\n    application/x-msword\n    application/x-word\n    application/zip\n    text/plain\n    image/jpeg \n    image/jpg \n    image/png \n  )\n</code></pre>\n\n<p>Here <strong>application/zip</strong> is important for the .docx file</p>\n\n<p>I have tested with above changes and document object is created successfully as below</p>\n\n<pre><code>    #&lt;Document:0x0d0bd8f0&gt; {\n                                :id =&gt; 1,\n           :document_list_file_name =&gt; \"sample-document.docx\",\n        :document_list_content_type =&gt; \"application/zip\",\n           :document_list_file_size =&gt; 12711,\n          :document_list_updated_at =&gt; Wed, 19 Sep 2018 11:56:02 UTC +00:00\n    }\n</code></pre>\n\n<p>Hope, this will solve your issue.</p>\n"}], "owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537359352, "creation_date": 1537170542, "question_id": 52363057, "link": "https://stackoverflow.com/questions/52363057/upload-docx-file-downloaded-from-google-drive-using-paperclip", "title": "Upload docx file downloaded from google drive using paperclip", "body": "<p>I want to upload docx file downloaded from google drive using <strong>gem paperclip</strong> but I am getting <strong>Invalid content type error</strong>. Below is my code</p>\n\n<pre><code>has_attached_file :initial_document\nvalidates_attachment :initial_document, content_type: {content_type: %w(image/jpeg image/jpg image/png application/pdf application/msword application/vnd.openxmlformats-officedocument.wordprocessingml.document)}\n</code></pre>\n\n<p>I am able to upload file created from ms word but not from google drive.\nDuring debugging, I found that the content type of the .docx file is <strong>application/zip</strong> I am using <strong>Rails 5.0 and paperclip 5.1</strong></p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "hash", "ruby-hash"], "comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1537166106, "post_id": 52361763, "comment_id": 91668115, "body": "@J&#246;rg W Mittag whats the problem if it&#39;s a duplicate question, there may be chance of other creative answer ,eh?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1537167290, "post_id": 52361763, "comment_id": 91668613, "body": "@Rajagopalan, this is not the place to debate SO policies. Note one can always add an answer to the earlier question."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537168938, "post_id": 52361763, "comment_id": 91669391, "body": "@Cary Swoveland Okay, thanks."}], "owner": {"reputation": 307, "user_id": 9363586, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/27c44ffbdbf38cea037d2a3dc0446294?s=128&d=identicon&r=PG&f=1", "display_name": "summu", "link": "https://stackoverflow.com/users/9363586/summu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1537165956, "answer_count": 0, "score": 0, "last_activity_date": 1537165471, "creation_date": 1537165051, "question_id": 52361763, "link": "https://stackoverflow.com/questions/52361763/how-to-merge-hash-of-hash-with-same-keys-in-ruby", "closed_reason": "Duplicate", "title": "how to merge hash of hash with same keys in ruby", "body": "<p>I have a two 2nd level hash , and i have to merge both hashes</p>\n\n<pre><code>hash1 = {\"brands\"=&gt;{\"likes\"=&gt;[\"gucci\", \"ck\", \"armani\", \"heyo\"], \"dislikes\"=&gt;[\"lv\", \"tods\", \"pols\"]}}\n\nhash2 = {\"brands\"=&gt;{\"likes\"=&gt;[\"bampam\",\"plot\"], \"dislikes\"=&gt;[\"pom\", \"ui\"]}}\n</code></pre>\n\n<p>output should be </p>\n\n<pre><code> hash1 = {\"brands\"=&gt;{\"likes\"=&gt;[\"gucci\", \"ck\", \"armani\", \"heyo\",\"bampam\",\"plot\"], \"dislikes\"=&gt;[\"lv\", \"tods\", \"pols\",\"pom\",\"ui\"]}}\n</code></pre>\n\n<p>I have tried this code</p>\n\n<pre><code>hash1.merge!(hash2) { |k, o, n| o + n }\n</code></pre>\n\n<p>But this works for 1st level hash, not for 2nd level hash, hash inside hash</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537164116, "post_id": 52361524, "comment_id": 91667294, "body": "You&#39;re having the <code>render</code> in a loop. Are you trying to display all the articles which are bookmarked ? What is the relation b/w <code>favourite</code> and <code>article</code> ?"}, {"owner": {"reputation": 11, "user_id": 9907315, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5X2l3uIeLYU/AAAAAAAAAAI/AAAAAAAAABQ/IdNk4gv2IQw/photo.jpg?sz=128", "display_name": "Tanmay Bhawsar", "link": "https://stackoverflow.com/users/9907315/tanmay-bhawsar"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537164561, "post_id": 52361524, "comment_id": 91667471, "body": "Yes, I am trying to display all the articles which are bookmarked.favourite contains id of articles which are bookmarked."}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 3, "creation_date": 1537164699, "post_id": 52361524, "comment_id": 91667527, "body": "Then in your controller, you&#39;ll have to just do <code>@articles = Article.where(bookmarked: true)</code>. This will return all the articles which are bookmarked only, and then in your view <code>index.html.erb</code>, you can use that instance variable <code>@articles</code> and do the looping."}, {"owner": {"reputation": 1035, "user_id": 5891503, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/830569e0fa440b692ab80005ef9b00cb?s=128&d=identicon&r=PG", "display_name": "reiallenramos", "link": "https://stackoverflow.com/users/5891503/reiallenramos"}, "edited": false, "score": 0, "creation_date": 1537176879, "post_id": 52361524, "comment_id": 91673574, "body": "what is the name of the column that tells an article it is bookmarked? Is it <code>bookmarked</code>? as the previous comment assumed?"}], "owner": {"reputation": 11, "user_id": 9907315, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5X2l3uIeLYU/AAAAAAAAAAI/AAAAAAAAABQ/IdNk4gv2IQw/photo.jpg?sz=128", "display_name": "Tanmay Bhawsar", "link": "https://stackoverflow.com/users/9907315/tanmay-bhawsar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537165296, "creation_date": 1537163978, "last_edit_date": 1537165296, "question_id": 52361524, "link": "https://stackoverflow.com/questions/52361524/how-to-render-records-in-loop", "title": "how to render records in loop", "body": "<p>I am trying to render all the record of articles having true bookmarked. but it is showing this error : </p>\n\n<blockquote>\n  <p>Render and/or redirect were called multiple times in this action.\n  Please note that you may only call render OR redirect, and at most\n  once per action. Also note that neither redirect nor render terminate\n  execution of the action, so if you want to exit an action after\n  redirecting, you need to do something like \"redirect_to(...) and\n  return\".</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>def index\n  # Also we are showing all showcased articles\n  if params[:bookmarked]==\"true\"\n    @favourite=Favourite.all\n    @favourite.map do |f|\n      article_id = f.item_id\n      @article = Article.find_by_id(article_id)\n      render :json =&gt; @article\n    end \n  end\nend  \n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537166785, "post_id": 52361520, "comment_id": 91668388, "body": "<code>[1,2,3,4,5]</code> is the value of the instance variable <code>@tweets</code> for a particular instance of the class <code>TimeLine</code>. Instances of a child class of <code>TimeLine</code> cannot determine the instances, if any, of its parent, so there is no way to access that information from the child class (even if their were only a single instance of the parent class)."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10373336, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hAr-wQTHYM0/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPc3M8b-Y40n5KA8i8R1spG4bHFOg/mo/photo.jpg?sz=128", "display_name": "Leroy Dupuis", "link": "https://stackoverflow.com/users/10373336/leroy-dupuis"}, "edited": false, "score": 0, "creation_date": 1537164688, "post_id": 52361550, "comment_id": 91667523, "body": "Thanks. Well May I ask you one doubt, How to deligate task from one object to another?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 5, "user_id": 10373336, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hAr-wQTHYM0/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPc3M8b-Y40n5KA8i8R1spG4bHFOg/mo/photo.jpg?sz=128", "display_name": "Leroy Dupuis", "link": "https://stackoverflow.com/users/10373336/leroy-dupuis"}, "edited": false, "score": 0, "creation_date": 1537165184, "post_id": 52361550, "comment_id": 91667726, "body": "You can use <code>Forwardable</code>, described here: <a href=\"https://medium.com/whynotio/delegating-with-forwardable-in-ruby-82b2fe382d0e\" rel=\"nofollow noreferrer\">medium.com/whynotio/&hellip;</a>"}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 1, "last_activity_date": 1537164106, "creation_date": 1537164106, "answer_id": 52361550, "question_id": 52361520, "link": "https://stackoverflow.com/questions/52361520/how-to-get-parent-instance-value-in-to-child-class-in-ruby/52361550#52361550", "title": "How to get parent instance value in to child class in ruby?", "body": "<p>It's because you initialize it with empty array, you don't pass any argument to <code>AuthenticateTimeLine.new</code>, so default <code>[]</code> is taken (compare your <code>TimeLine#initialize</code> method). If you passed your array as argument, it would work:</p>\n\n<pre><code>authenticate_timeline = AuthenticatateTimeLine.new([1,2,3,4,5])\nauthenticate_timeline.print\n# 'Works' now!\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10373336, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hAr-wQTHYM0/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPc3M8b-Y40n5KA8i8R1spG4bHFOg/mo/photo.jpg?sz=128", "display_name": "Leroy Dupuis", "link": "https://stackoverflow.com/users/10373336/leroy-dupuis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 52361550, "answer_count": 1, "score": 0, "last_activity_date": 1537164106, "creation_date": 1537163959, "question_id": 52361520, "link": "https://stackoverflow.com/questions/52361520/how-to-get-parent-instance-value-in-to-child-class-in-ruby", "title": "How to get parent instance value in to child class in ruby?", "body": "<p>I'm not able to get the instance values of parent class to the child class, My code is like this.</p>\n\n<pre><code>class TimeLine\n    attr_accessor :tweets\n    def initialize(tweets=[])\n        @tweets = tweets\n    end\n    def print\n        puts tweets.join(\"\\n\")\n    end\nend\n\nclass AuthenticateTimeLine &lt; TimeLine\n    def print\n        authenticate!\n        super\n    end\n    def authenticate!\n        puts \"authenticated!\"\n    end\nend\nTimeLine.new([1,2,3,4,5])\nauthenticate_timeline = AuthenticateTimeLine.new\nauthenticate_timeline.print\n</code></pre>\n\n<p>When I call super on the child class, I'm getting empty array.</p>\n"}, {"tags": ["ruby", "hash", "diff", "cumulative-sum", "accumulator"], "comments": [{"owner": {"reputation": 3, "user_id": 3414783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/coNa5.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3414783/brian"}, "edited": false, "score": 0, "creation_date": 1537164432, "post_id": 52361406, "comment_id": 91667403, "body": "As I described, expected output is Domain name and its cumulative utime, in other words: how much of CPUs utime all PHP processes for particular domain consume during a run of this script."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3414783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/coNa5.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3414783/brian"}, "edited": false, "score": 0, "creation_date": 1537167125, "post_id": 52361754, "comment_id": 91668537, "body": "Thank you @Chiranjib, your code looks very useful. Can I ask you adjust hashes structure in your code to be same as mine? I updated my post and I specified a little bit more how hashes look like. Thank you!"}, {"owner": {"reputation": 1529, "user_id": 2717158, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Ddi3c.jpg?s=128&g=1", "display_name": "Chiranjib", "link": "https://stackoverflow.com/users/2717158/chiranjib"}, "reply_to_user": {"reputation": 3, "user_id": 3414783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/coNa5.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3414783/brian"}, "edited": false, "score": 0, "creation_date": 1537168000, "post_id": 52361754, "comment_id": 91668956, "body": "Hey @Brian, changed it a bit. You should grasp the idea and try implementing the logic yourself. Also, please accept the answer if it helps."}, {"owner": {"reputation": 3, "user_id": 3414783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/coNa5.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3414783/brian"}, "edited": false, "score": 0, "creation_date": 1537170057, "post_id": 52361754, "comment_id": 91669950, "body": "Thanks one more time. I mean hash structure, not it names. For example this is my hash: &quot;domain1&quot; =&gt; [ {:pid =&gt; XXX, :utime =&gt; ZZZ }, {:pid =&gt; XXX1, :utime =&gt; ZZZ1 } ], &quot;domain2&quot; =&gt; [ {:pid =&gt; XXX, :utime =&gt; ZZZ }, {:pid =&gt; XXX1, :utime =&gt; ZZZ1 } ] and yours looks little bit different. As well my h1 hash looks little bit different. Sorry for this, Im really ruby beginner. I really appreciate your help."}, {"owner": {"reputation": 1529, "user_id": 2717158, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Ddi3c.jpg?s=128&g=1", "display_name": "Chiranjib", "link": "https://stackoverflow.com/users/2717158/chiranjib"}, "reply_to_user": {"reputation": 3, "user_id": 3414783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/coNa5.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3414783/brian"}, "edited": false, "score": 0, "creation_date": 1537174224, "post_id": 52361754, "comment_id": 91672042, "body": "I thought you wanted cumulative utimes for a domain, looks like you also want to collect pid information for the domain? The question is very unclear here. In the comment above, &#39;domain1&#39; is not a hash, but array of hashes. If this is the case, then h1 should have structure like h1 = {:domain1 =&gt; [...], :domain2 =&gt; [...]}"}, {"owner": {"reputation": 3, "user_id": 3414783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/coNa5.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3414783/brian"}, "edited": false, "score": 0, "creation_date": 1537175606, "post_id": 52361754, "comment_id": 91672810, "body": "Yes, but for knowing cumulative utime for a domain I need to know also pids and its utime and to know, if which process is new or which is gone and based on this I can sum its utime to total utime count. Your example is fine but not fully correspond to my hashes and array of hashes. I updated my post one more time. h2 and h3 should looks like {&quot;domain1&quot;=&gt;[{:pid=&gt;2, :utime=&gt;20}, {:pid=&gt;1, :utime=&gt;10}], &quot;domain2&quot;=&gt;[{:pid=&gt;1, :utime=&gt;10}, {:pid=&gt;3, :utime=&gt;30}]} Please, check my codes example in my post one more time. Apologize for my unclear description"}, {"owner": {"reputation": 1529, "user_id": 2717158, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Ddi3c.jpg?s=128&g=1", "display_name": "Chiranjib", "link": "https://stackoverflow.com/users/2717158/chiranjib"}, "reply_to_user": {"reputation": 3, "user_id": 3414783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/coNa5.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3414783/brian"}, "edited": false, "score": 0, "creation_date": 1537342314, "post_id": 52361754, "comment_id": 91744814, "body": "Changed my answer one more time, feels like I am writing your code for you now. Please close this question. Your problem seems more specific to application logic, and not related to Ruby (or any other language for that matter) Hope it helps!"}], "tags": [], "owner": {"reputation": 1529, "user_id": 2717158, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Ddi3c.jpg?s=128&g=1", "display_name": "Chiranjib", "link": "https://stackoverflow.com/users/2717158/chiranjib"}, "is_accepted": true, "score": 0, "last_activity_date": 1537342211, "last_edit_date": 1537342211, "creation_date": 1537165026, "answer_id": 52361754, "question_id": 52361406, "link": "https://stackoverflow.com/questions/52361406/ruby-diff-two-hashes-and-merge-in-loop-with-cumulative-sum/52361754#52361754", "title": "Ruby diff two hashes and merge in loop with cumulative sum", "body": "<p>I will not try to implement your logic, but dealing with hashes is what I will try to elucidate. For the sake of simplicity, I haven't looped, but just dealt with test data</p>\n\n<pre><code>domains = ['domain1','domain2','domain3']\n\nh1 = {}\nh2 = {}\n# generate blank template for each domain\ndomains.each { |vhostname|\n  h1[vhostname] ||= { :utime =&gt; 0, :last_seen =&gt; 0, :process_count =&gt; 0, :process_count_avg =&gt; 0 }\n  h2[vhostname] ||= {}\n}\n\n# dummy loop\n1.upto(5) {\n  h3={}\n  # start collecting data for each domain\n  domains.each { |vhostname|\n    # TEST DATA\n    h3[vhostname] ||= {}\n    1.upto(5) {\n      _pid = rand(1..10)\n      h3[vhostname][:\"#{_pid}\"] ||= {:utime =&gt; rand(9999)}\n    }\n    # TEST DATA\n\n    h2[vhostname].merge!(h3[vhostname])\n    h2[vhostname].each { |proc, details|\n      unless h3[vhostname].key?(proc)\n        h1[vhostname][:utime] = h1[vhostname][:utime] + details[:utime]\n      end\n    }\n    h2[vhostname] = h2[vhostname].keep_if { |proc| h3[vhostname].key?(proc)}\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3414783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/coNa5.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3414783/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 52361754, "answer_count": 1, "score": 0, "last_activity_date": 1537342211, "creation_date": 1537163226, "last_edit_date": 1537188732, "question_id": 52361406, "link": "https://stackoverflow.com/questions/52361406/ruby-diff-two-hashes-and-merge-in-loop-with-cumulative-sum", "title": "Ruby diff two hashes and merge in loop with cumulative sum", "body": "<p>help with ruby needed! </p>\n\n<p>I have loop in with I collect data about PHP processes (PID, utimes). I have two hashes. First 'h1' looks like:</p>\n\n<pre><code>\"domain1\" =&gt; { :utime =&gt; 0, :last_seen =&gt; 0, :process_count =&gt; 0, :process_count_avg =&gt; 0 },\n\"domain2\" =&gt; { :utime =&gt; 0, :last_seen =&gt; 0, :process_count =&gt; 0, :process_count_avg =&gt; 0 }\n</code></pre>\n\n<p>This is code for it:</p>\n\n<pre><code>h1[vhostname] ||= { :utime =&gt; 0, :last_seen =&gt; 0, :process_count =&gt; 0, :process_count_avg =&gt; 0 }\nh1[vhostname][:utime] += utime_proc \nh1[vhostname][:last_seen] = 0\n</code></pre>\n\n<p>'vhostname' is string containing domain name. \n'utime_proc' is a utime value. </p>\n\n<p>In every loop I sum all utimes for all processes of specific domain and output is Domain and its summed utime. But this distorts the real state.</p>\n\n<p>What I need to do is to make cummulative sum of utimes for specific domain. To be the sum of utime for all current processes, but to add the sum of utime for all processes that have already ended. I will probably have to store pid processes for each subdomain utime, and if this process disappears, its last utime is added to the default value (the 'h1' hash): utime at that domain.</p>\n\n<p>So, I create the two more hashes: 'h2' and 'h3'. The value of 'h3' is reseting in every loop round and this stores all PIDs for (sub)domain with its utimes like this: </p>\n\n<pre><code>h3[vhostname] = []\nh3[vhostname] &lt;&lt; {:pid =&gt; pid, :utime =&gt; utime_proc}\n</code></pre>\n\n<p>the 'h2' hash stores PIDs from all loop rounds before, same like 'h3' but its not reseting:</p>\n\n<pre><code>if not h2.key?(vhostname)\nh2[vhostname] = []\nh2[vhostname] &lt;&lt; {:pid =&gt; pid, :utime =&gt; utime_proc}\nend\n</code></pre>\n\n<p>The output hash should looks like:</p>\n\n<pre><code>{\"domain1\"=&gt;[{:pid=&gt;2, :utime=&gt;20}, {:pid=&gt;1, :utime=&gt;10}], \"domain2\"=&gt;[{:pid=&gt;1, :utime=&gt;10}, {:pid=&gt;3, :utime=&gt;30}]}\n</code></pre>\n\n<p>Now I need to help with: \n1. probably diff these two hashes and if PID for disseapear I need to remove them from 'h2' hash and its last utime value sum to utime value stored in 'h1'. \n2. I new PID appears for domain (in 'h3' is new pid and in 'h2' not yet), add this PID to 'h2' with its utime to particular domain. </p>\n\n<p>And these are points what Im not able to do. I know I can simply do:</p>\n\n<p>'h2-h3' or 'h3-h2' but I dont know what to do with the result and how to handle it.</p>\n\n<p>Guys, can you help me, please? Short version of my code is bellow. Im still ruby-newbie. </p>\n\n<pre><code>h1 = {}\n# Hash to collect PID and its utimes\nh2 = {}\n\nloop do  \n\n# Hash to temporarly store PID and its utimes - in each cycle is reseting\nh3 = {}\n\n# Here I collect processes\n#############\n#############\n\n# Collect PIDs and its utimes\n# Store PIDs and its utimes temporarly - only for this loop round\nh3[vhostname] = []\nh3[vhostname] &lt;&lt; {:pid =&gt; pid, :utime =&gt; utime_proc}\n\n# is h2 empty? if so, this is probably first loop round\nif not h2.key?(vhostname)\nh2[vhostname] = []\nh2[vhostname] &lt;&lt; {:pid =&gt; pid, :utime =&gt; utime_proc}\nelse\n# h2 is not empty, we can diff and sum\n# PROBABLY PLACE I NEED TO HELP WITH\n\nend\n# Here I do some more magic with h1 and output the result with some delay\nend\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I changed the h2 and h3 hash structure to:</p>\n\n<pre><code>{:domain =&gt; \"domain1.com\", :pid =&gt; XXXX, :utime =&gt; YYYYY}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "parsing", "spreadsheet", "roo-gem"], "comments": [{"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "edited": false, "score": 0, "creation_date": 1538070222, "post_id": 52360918, "comment_id": 92024788, "body": "Did anything help?"}], "answers": [{"comments": [{"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1537460284, "post_id": 52421741, "comment_id": 91802194, "body": "My mistake, I&#39;m using roo-xls but I neglected to say that in the question. Unfortunately the excel file is proprietary, but I&#39;ll try to recreate the error with a non-proprietary file."}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1537465448, "post_id": 52421741, "comment_id": 91804664, "body": "@JoeMorano please do so, nobody has crystal ball :)."}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1537529952, "post_id": 52421741, "comment_id": 91828526, "body": "@JoeMorano Also it would help to have minimal working example - <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1537806946, "post_id": 52421741, "comment_id": 91908879, "body": "@JoeMorano do you have both gems in the require? Only the <code>roo-xls</code> gem is not enough!"}, {"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1538026341, "post_id": 52421741, "comment_id": 91999243, "body": "I do have both gems required. I&#39;ve been trying to create another .xls file that causes the same error, but I can&#39;t...the original file was generated by third-party POS software. I can&#39;t share it in its present form because it&#39;s not my intellectual property, but if I make any changes and save it, it no longer causes the error. If you had access to it, how would you analyze it? Would you check the metadata or binary or something like that?"}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1538036857, "post_id": 52421741, "comment_id": 92004507, "body": "@JoeMorano I know it can be hard to reproduce the error (could you do an extraction with some dummy data, from some testing platform?).  First I would check if the file is actually a correctly created <code>*.xls</code> file (perhaps a <code>*.csv</code> file named <code>*.xls</code>?).  From your post it appears that it is not.  I would view it with a text file editor to see what is actually inside.  Then I would try to extract meta-data via some extractor like - <a href=\"http://meta-extractor.sourceforge.net/\" rel=\"nofollow noreferrer\">meta-extractor.sourceforge.net</a> to see if there are any discrepancies."}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1538122491, "post_id": 52421741, "comment_id": 92041029, "body": "@JoeMorano I have found out that there is even a ruby way to read the meta data using <i>yomu</i>- <a href=\"https://github.com/yomurb/yomu\" rel=\"nofollow noreferrer\">github.com/yomurb/yomu</a>.  You may try that."}], "tags": [], "owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "is_accepted": false, "score": 2, "last_activity_date": 1537436504, "last_edit_date": 1537436504, "creation_date": 1537435537, "answer_id": 52421741, "question_id": 52360918, "link": "https://stackoverflow.com/questions/52360918/ole2-signature-is-invalid-when-trying-to-parse-xls-file/52421741#52421741", "title": "&quot;OLE2 signature is invalid&quot; when trying to parse XLS file", "body": "<p>The issue is that <code>roo</code> reads only:</p>\n\n<ul>\n<li>Excel 2007 - 2013 formats (xlsx, xlsm) </li>\n<li>LibreOffice / OpenOffice.org formats (ods)</li>\n<li>CSV</li>\n</ul>\n\n<p>For <strong>xls</strong> only you need to use <a href=\"https://github.com/roo-rb/roo-xls\" rel=\"nofollow noreferrer\">roo-xls</a> gem.</p>\n\n<p>If you need any details further, I would need a copy of the excel file.</p>\n\n<p>you should have:</p>\n\n<pre><code>require 'roo'\nrequire 'roo-xls'\n</code></pre>\n\n<p>Then it will work.</p>\n"}, {"comments": [{"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1538025995, "post_id": 52490873, "comment_id": 91999100, "body": "How can I view the binary of a file?"}, {"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "reply_to_user": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1538180612, "post_id": 52490873, "comment_id": 92066373, "body": "I would use BeyondCompare to compare the two files"}], "tags": [], "owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "is_accepted": false, "score": 1, "last_activity_date": 1537851619, "creation_date": 1537851619, "answer_id": 52490873, "question_id": 52360918, "link": "https://stackoverflow.com/questions/52360918/ole2-signature-is-invalid-when-trying-to-parse-xls-file/52490873#52490873", "title": "&quot;OLE2 signature is invalid&quot; when trying to parse XLS file", "body": "<p>Here's a suggestion. Might not be pretty, but should work, assuming the differences are the same for any file with the problem.</p>\n\n<ol>\n<li>Manually perform a binary compare of the file before and after it's 're-saved'. Note the differences.</li>\n<li>Read the uploaded file from the user. See if it's missing the noted difference from earlier, and modify the file accordingly.</li>\n<li>Send the 'modified' file to <code>roo-xls</code> </li>\n</ol>\n"}], "owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1537851619, "creation_date": 1537159802, "last_edit_date": 1537460171, "question_id": 52360918, "link": "https://stackoverflow.com/questions/52360918/ole2-signature-is-invalid-when-trying-to-parse-xls-file", "title": "&quot;OLE2 signature is invalid&quot; when trying to parse XLS file", "body": "<p>I'm trying to upload and parse an .XLS file. I've tried with <a href=\"https://github.com/roo-rb/roo-xls\" rel=\"noreferrer\">roo-xls</a> and <a href=\"https://github.com/zdavatz/spreadsheet\" rel=\"noreferrer\">Spreadsheet</a>, but with both, I'm getting this error:</p>\n\n<pre><code>Ole::Storage::FormatError in UploadController#upload\nOLE2 signature is invalid\n</code></pre>\n\n<p>I found a few resources about this error, and the only answer ever given is to re-save the document as .XLS, because although the original is <em>labeled</em> as .XLS, it actually isn't.</p>\n\n<p>Unfortunately this isn't really an option, because I have users uploading files, so it's important that it work without requiring a re-save.</p>\n\n<p>For the record, I tried re-saving the file and now it works, but I'm at a loss as to <em>why</em> it works, because the file's format before and after the re-save looks to be the exact same. This is what was listed under \"type of file\" in Excel, before and after: </p>\n\n<blockquote>\n  <p>Microsoft Excel 97-2003 Worksheet (.xls)\"</p>\n</blockquote>\n\n<p>And this is what is listed under \"Type\" in Libreoffice, before and after:</p>\n\n<blockquote>\n  <p>Microsoft Excel Worksheet (application/vnd.ms-excel)</p>\n</blockquote>\n\n<p>What's going on?</p>\n\n<p><strong>Also, here's my simple upload code:</strong></p>\n\n<p>form</p>\n\n<pre><code>&lt;%= form_tag(upload_path, multipart: true) do %&gt;\n  &lt;%= file_field_tag :file %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>controller</p>\n\n<pre><code>file = params[:file].path\n\n#Roo Attempt\ndoc = Roo::Excel.new(file)\n\n#Spreadsheet Attempt\nrequire 'spreadsheet'\nSpreadsheet.client_encoding = 'UTF-8'\ndoc = Spreadsheet.open(file).worksheets\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-console"], "answers": [{"comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "reply_to_user": {"reputation": 13, "user_id": 10305511, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-74E5Dsv0iV8/AAAAAAAAAAI/AAAAAAAAAAc/xNx5P_fe8m4/photo.jpg?sz=128", "display_name": "Mr. Kidney", "link": "https://stackoverflow.com/users/10305511/mr-kidney"}, "edited": false, "score": 0, "creation_date": 1537157903, "post_id": 52360668, "comment_id": 91665710, "body": "I have added the file name <code>~&#47;.irbrc</code>"}, {"owner": {"reputation": 13, "user_id": 10305511, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-74E5Dsv0iV8/AAAAAAAAAAI/AAAAAAAAAAc/xNx5P_fe8m4/photo.jpg?sz=128", "display_name": "Mr. Kidney", "link": "https://stackoverflow.com/users/10305511/mr-kidney"}, "edited": false, "score": 1, "creation_date": 1537158136, "post_id": 52360668, "comment_id": 91665757, "body": "Oh... got it. You are my lifesaver. Thanks!"}], "tags": [], "owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "is_accepted": true, "score": 1, "last_activity_date": 1537157724, "creation_date": 1537157724, "answer_id": 52360668, "question_id": 52360624, "link": "https://stackoverflow.com/questions/52360624/rails-console-permission-denied-rb-sysopen-error/52360668#52360668", "title": "Rails console Permission denied @ rb_sysopen Error", "body": "<p>This should solve the problem. <strong><em>edit/create</em></strong> <code>~/.irbrc</code></p>\n\n<pre><code>require 'irb/ext/save-history'\nIRB.conf[:SAVE_HISTORY] = 10000\nIRB.conf[:HISTORY_FILE] = \"#{ENV['HOME']}/.irb-history\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10305511, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-74E5Dsv0iV8/AAAAAAAAAAI/AAAAAAAAAAc/xNx5P_fe8m4/photo.jpg?sz=128", "display_name": "Mr. Kidney", "link": "https://stackoverflow.com/users/10305511/mr-kidney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "accepted_answer_id": 52360668, "answer_count": 1, "score": 1, "last_activity_date": 1537157724, "creation_date": 1537157245, "question_id": 52360624, "link": "https://stackoverflow.com/questions/52360624/rails-console-permission-denied-rb-sysopen-error", "title": "Rails console Permission denied @ rb_sysopen Error", "body": "<p>When I exit rails console, terminal creates this error.</p>\n\n<pre><code>/usr/local/rvm/rubies/ruby-2.4.1/lib/ruby/2.4.0/open-uri.rb:37:in `initialize': \nPermission denied @ rb_sysopen - /usr/local/rvm/rubies/ruby-2.4.1/.irbrc_history (Errno::EACCES)\n</code></pre>\n\n<p>At first I don't care about this error message, but soon I realized that my active record update in rails console was not applied.</p>\n\n<p>How can I solve this problem?</p>\n"}, {"tags": ["ruby", "testing", "rspec", "functional-programming", "capybara"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1537150949, "post_id": 52360011, "comment_id": 91664413, "body": "Check if this class can be useful: <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/logger/rdoc/Logger.html\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.5.1/libdoc/logger/rdoc/Logger.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1539943062, "post_id": 52373925, "comment_id": 92692645, "body": "This answer helped me a lot,upvoted, thanks. Can you please let me know Is there any way to find out how much time a testcase executed, or how much time <code>it</code> block executed?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1539979021, "post_id": 52373925, "comment_id": 92710613, "body": "@Rajagopalan RSpec has built-in profiling -- <a href=\"https://relishapp.com/rspec/rspec-core/docs/configuration/profile-examples\" rel=\"nofollow noreferrer\">relishapp.com/rspec/rspec-core/docs/configuration/&hellip;</a> -- If that&#39;s not enough you can always just use an <code>around</code> hook and do it manually."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1540010599, "post_id": 52373925, "comment_id": 92716529, "body": "Hi Thanks, This is not what I am asking, I am asking whether Rspec let us know how long a particular <code>it</code> has been executed?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1540013185, "post_id": 52373925, "comment_id": 92716858, "body": "@Rajagopalan That&#39;s exactly what profiling will tell you -- If that&#39;s not what you want you&#39;ll need to explain why it doesn&#39;t meet your needs - or do it manually with an around hook"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1540014939, "post_id": 52373925, "comment_id": 92717089, "body": "I will tell you what my requirement is. Each and every it block is my each test case, after running each test case I need to know how much time test case has taken to complete, do you say it&#39;s can be done with the help of profiling ?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1540231756, "post_id": 52373925, "comment_id": 92779701, "body": "@Rajagopalan So you can either set <code>profile_examples</code> to a number larger than the number of tests you have, or (as mentioned) you can use an around example hook to do the timing yourself (save start time, run example, calculate total time), or you can use an after context or suite hook to access the timing RSpec has stored on each example in it&#39;s <code>execution_result</code> member.  This has got away from the OPs original question though, so if you need further details ask your own question."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 1, "last_activity_date": 1540231705, "last_edit_date": 1540231705, "creation_date": 1537209638, "answer_id": 52373925, "question_id": 52360011, "link": "https://stackoverflow.com/questions/52360011/checking-if-test-failed-and-giving-console-output-accordingly/52373925#52373925", "title": "Checking if test failed and giving console output accordingly", "body": "<p>The <code>after</code> hook receives the test that was run as a parameter so you can do</p>\n\n<pre><code>after do |example|\n  if example.exception\n    puts \"Error: Microservice A currently is down\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10372795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb44aaf622171d2774baa5119e6beb7?s=128&d=identicon&r=PG&f=1", "display_name": "kiwiso", "link": "https://stackoverflow.com/users/10372795/kiwiso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540231705, "creation_date": 1537150656, "last_edit_date": 1537154301, "question_id": 52360011, "link": "https://stackoverflow.com/questions/52360011/checking-if-test-failed-and-giving-console-output-accordingly", "title": "Checking if test failed and giving console output accordingly", "body": "<p>I am new to ruby and would like to add a step in my ruby/capybara test where \n\"if Test A failed,\nlog this message in the console: \"Microservice A is currently down.\"</p>\n\n<p>Should this be done in the after hook or inside the test? Also, what would the commands be?</p>\n\n<pre><code>describe 'Test Description' do\n\n  before (:each) do\n    login   end\n\n  after (:each) do\n    logout\n    if test fail do\n      console.log (\"Error: Microservice A currently is down\")\n    end   \n  end\n\n  it 'Check Page X Loads', :retry =&gt; 3, :retry_wait =&gt; 3 do\n    page.should have_content 'Frisbee'\n    navigate_to_menu 'Toys'\n    page.has_content?(\"Frisbee\")\n    expect(page).to have_content('Buy Frisbee')   end\n\nend\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "regex", "scope", "iterator", "yield"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1537237558, "post_id": 52359278, "comment_id": 91700638, "body": "This question, imo, deserves upvotes."}, {"owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537271283, "post_id": 52359278, "comment_id": 91715939, "body": "@CarySwoveland Thanks. I think I understand the background exactly now at last \u2013 I have posted a fairly comprehensive (though long) answer to summarise it."}, {"owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1539360201, "post_id": 52359278, "comment_id": 92487810, "body": "@CarySwoveland In fact I have found a way! I have made a major update in my answer to explain it."}], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "is_accepted": true, "score": 2, "last_activity_date": 1539358346, "last_edit_date": 1539358346, "creation_date": 1537271063, "answer_id": 52385870, "question_id": 52359278, "link": "https://stackoverflow.com/questions/52359278/how-to-pass-regexp-last-match-to-a-block-in-ruby/52385870#52385870", "title": "How to pass Regexp.last_match to a block in Ruby", "body": "<p>Here is a way as per the question (Ruby 2).  It is not pretty, and is not quite 100% perfect in all aspects, but does the job.</p>\n\n<pre><code>def newsub(str, *rest, &amp;bloc)\n  str =~ rest[0]  # =&gt; ArgumentError if rest[0].nil?\n  bloc.binding.tap do |b|\n    b.local_variable_set(:_, $~)\n    b.eval(\"$~=_\")\n  end if bloc\n  str.sub(*rest, &amp;bloc)\nend\n</code></pre>\n\n<p>With this, the result is as follows:</p>\n\n<pre><code>_ = (/(xyz)/ =~ 'xyz')\np $1  # =&gt; \"xyz\"\np _   # =&gt; 0\n\np newsub(\"abcd\", /ab(c)/, '\\1')        # =&gt; \"cd\"\np $1  # =&gt; \"xyz\"\np _   # =&gt; 0\n\np newsub(\"abcd\", /ab(c)/){|m| $1}      # =&gt; \"cd\"\np $1  # =&gt; \"c\"\np _                 # =&gt; #&lt;MatchData \"abc\" 1:\"c\"&gt;\n\nv, _ = $1, newsub(\"efg\", /ef(g)/){$1.upcase}\np [v, _]  # =&gt; [\"c\", \"G\"]\np $1  # =&gt; \"g\"\np Regexp.last_match # =&gt; #&lt;MatchData \"efg\" 1:\"g\"&gt;\n</code></pre>\n\n<h3>In-depth analysis</h3>\n\n<p>In the above-defined method <code>newsub</code>, when a block is given, the local variables $1 etc in the caller's thread are (re)set, after the block is executed, which is consistent with <code>String#sub</code>.  However, when a block is not given, the local variables $1 etc are <strong>not</strong> reset, whereas in <code>String#sub</code>, $1 etc are always reset regardless of whether a block is given or not.</p>\n\n<p>Also, the caller's local variable <code>_</code> is reset in this algorithm.  In Ruby's convention, the local variable <code>_</code> is used as a dummy variable and its value should not be read or referred to.  Therefore, this should not cause any practical problems.  If the statement <code>local_variable_set(:$~, $~)</code> was valid, no temporary local variables would be needed.  However, it is not, in Ruby (as of Version 2.5.1 at least).  See a comment (in Japanese) by Kazuhiro NISHIYAMA in <a href=\"http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-list/50708\" rel=\"nofollow noreferrer\">[ruby-list:50708]</a>.</p>\n\n<h2>General background (Ruby's specification) explained</h2>\n\n<p>Here is a simple example to highlight Ruby's specification related to this issue:</p>\n\n<pre><code>s = \"abcd\"\n/b(c)/ =~ s\np $1     # =&gt; \"c\"\n1.times do |i|\n  p s    # =&gt; \"abcd\"\n  p $1   # =&gt; \"c\"\nend\n</code></pre>\n\n<p>The special variables of <code>$&amp;</code>, <code>$1</code>, <code>$2</code>, etc, (related, <code>$~</code> (<code>Regexp.last_match</code>), <code>$'</code> and alike)\nwork in the local scope.  In Ruby, a local scope inherits the variables of the same names in the parent scope.\nIn the example above, the variable <code>s</code> is <em>inherited</em>, and so is <code>$1</code>.\nThe <code>do</code> block is <em>yield</em>-ed by <code>1.times</code>, and the method <code>1.times</code> has no control over the variables inside the block except for the block parameters (<code>i</code> in the example above; <em>n.b.</em>, although <code>Integer#times</code> does not provide any block parameters, to attempt to receive one(s) in a block would be silently ignored).</p>\n\n<p>This means a method that <em>yield</em>-s a block has no control over <code>$1</code>, <code>$2</code>, etc in the block, which are local variables (even though they may look like global variables).</p>\n\n<h3>Case of String#sub</h3>\n\n<p>Now, let us analyse how <code>String#sub</code> with the block works:</p>\n\n<pre><code>'abc'.sub(/.(.)./){ |m| $1 }\n</code></pre>\n\n<p>Here, the method <code>sub</code> first performs a Regexp match, and hence the local variables like <code>$1</code> are automatically set.  Then, they (the variables like <code>$1</code>) are inherited in the block, <em>because this block is in the same scope as the method \"sub\"</em>.  They are <strong>not passed</strong> from <code>sub</code> to the block, being different from the block parameter <code>m</code> (which is a matched String, or equivalent to <code>$&amp;</code>).</p>\n\n<p>For that reason, if the method <code>sub</code> is defined in a <em>different scope</em> from the block, the <code>sub</code> method has no control over local variables inside the block, including <code>$1</code>.  A <em>different scope</em> means the case where the <code>sub</code> method is written and defined with a Ruby code, or in practice, all the Ruby methods except some of those written not in Ruby but in the same language as used to write the Ruby interpreter.</p>\n\n<p>Ruby's <a href=\"https://ruby-doc.org/core-2.5.1/String.html#method-i-sub\" rel=\"nofollow noreferrer\">official document (Ver.2.5.1)</a> explains in the section of <code>String#sub</code>:</p>\n\n<blockquote>\n  <p>In the block form, the current match string is passed in as a parameter, and variables such as $1, $2, $`, $&amp;, and $' will be set appropriately.</p>\n</blockquote>\n\n<p>Correct.  In practice, the methods that can and do set the Regexp-match-related special variables such as $1, $2, etc are limited to some built-in methods, including <code>Regexp#match</code>, <code>Regexp#=~</code>,  <code>Regexp#===</code>,<code>String#=~</code>, <code>String#sub</code>,  <code>String#gsub</code>, <code>String#scan</code>,  <code>Enumerable#all?</code>, and <code>Enumerable#grep</code>.<br>\nTip 1: <code>String#split</code> seems to reset <code>$~</code> nil always.<br>\nTip 2: <code>Regexp#match?</code> and <code>String#match?</code> do not update <code>$~</code> and hence are much faster.</p>\n\n<p>Here is a little code snippet to highlight how the scope works:</p>\n\n<pre><code>def sample(str, *rest, &amp;bloc)\n  str.sub(*rest, &amp;bloc)\n  $1    # non-nil if matches\nend\n\nsample('abc', /(c)/){}  # =&gt; \"c\"\np $1    # =&gt; nil\n</code></pre>\n\n<p>Here, <code>$1</code> <em>in the method sample()</em> is set by <code>str.sub</code> in the same scope.  That implies the method <code>sample()</code> would not be able to (simply) refer to <code>$1</code> in the block given to it.</p>\n\n<p>I point out the statement in the <a href=\"https://ruby-doc.org/core-2.5.1/doc/regexp_rdoc.html#class-Regexp-label-3D~+operator\" rel=\"nofollow noreferrer\">section of Regular expression</a> of Ruby's official document (Ver.2.5.1)</p>\n\n<blockquote>\n  <p>Using <code>=~</code> operator with a String and Regexp the <code>$~</code> global variable is set after a successful match.</p>\n</blockquote>\n\n<p>is rather misleading, because</p>\n\n<ol>\n<li><code>$~</code> is a <em>pre-defined local-scope</em> variable (<strong>not</strong> global variable), and </li>\n<li><code>$~</code> is set (maybe nil) regardless of whether the last attempted match is successful or not.</li>\n</ol>\n\n<p>The fact the variables like <code>$~</code> and <code>$1</code> are not global variables may be slightly confusing.  But hey, they are useful notations, aren't they?</p>\n"}], "owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 52385870, "answer_count": 1, "score": 3, "last_activity_date": 1539358346, "creation_date": 1537141195, "last_edit_date": 1537142290, "question_id": 52359278, "link": "https://stackoverflow.com/questions/52359278/how-to-pass-regexp-last-match-to-a-block-in-ruby", "title": "How to pass Regexp.last_match to a block in Ruby", "body": "<p>Is there any way to pass the <strong>last match</strong> (practically <code>Regexp.last_match</code>) to a block (iterator) in Ruby?</p>\n\n<p>Here is a sample method as a kind of wrapper of <code>Srring#sub</code> to demonstrate the problem. It accepts both the standard arguments and a block:</p>\n\n<pre><code>def newsub(str, *rest, &amp;bloc)\n  str.sub(*rest, &amp;bloc)\nend\n</code></pre>\n\n<p>It works in the standard arguments-only case and it can take a block; however the positional special variable like $1, $2, etc are not usable inside the block.  Here are some examples:</p>\n\n<pre><code>newsub(\"abcd\", /ab(c)/, '\\1')        # =&gt; \"cd\"\nnewsub(\"abcd\", /ab(c)/){|m| $1}      # =&gt; \"d\"  ($1 == nil)\nnewsub(\"abcd\", /ab(c)/){$1.upcase}   # =&gt; NoMethodError\n</code></pre>\n\n<p>The reason the block does not work in the same way as <code>String#sub(/..(.)/){$1}</code> is I suppose something to do with the scope; the special variables $1, $2 etc are local variables (so is <code>Regexp.last_match</code>).</p>\n\n<p>Is there any way to solve this?  I would like to make the method <code>newsub</code> work just as <code>String#sub</code> does, in the sense $1, $2, etc are usable in the supplied block.</p>\n\n<p>EDIT: According to <a href=\"https://stackoverflow.com/questions/18550434/using-1-2-etc-global-variables-inside-method-definition\">some past answers</a>, there may not be a way to achieve this\u2026</p>\n"}]