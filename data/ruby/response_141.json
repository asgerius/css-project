[{"tags": ["ruby", "algorithm", "mathematical-optimization"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505949911, "post_id": 46333125, "comment_id": 79627091, "body": "If this is a linear equation, can you just solve it?"}, {"owner": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505951087, "post_id": 46333125, "comment_id": 79627362, "body": "That would be great, but the system ends up being not very linear.  :)  Assuming a = 3, b = 2, and d = 2, you end up with the system (3 + j) * (2 + k) = c and j + k = d.  The first equation can be reduced to 3k + 2j + jk - c = -6 ... which is not linear."}, {"owner": {"reputation": 27269, "user_id": 2320035, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/83d5a6d76755c6a987dd59495698dcfe?s=128&d=identicon&r=PG", "display_name": "sascha", "link": "https://stackoverflow.com/users/2320035/sascha"}, "edited": false, "score": 0, "creation_date": 1505951509, "post_id": 46333125, "comment_id": 79627447, "body": "Are <code>j</code> and <code>k</code> nonnegative?"}, {"owner": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "edited": false, "score": 0, "creation_date": 1505951540, "post_id": 46333125, "comment_id": 79627451, "body": "Yes ... I will add that to the problem description to make it more obvious."}, {"owner": {"reputation": 10888, "user_id": 5625534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d4mCF.jpg?s=128&g=1", "display_name": "Erwin Kalvelagen", "link": "https://stackoverflow.com/users/5625534/erwin-kalvelagen"}, "edited": false, "score": 1, "creation_date": 1506013155, "post_id": 46333125, "comment_id": 79659090, "body": "Note that there are solvers that can solve these kinds of problems (but larger ones) directly. This would be a MIQP problem (Mixed Integer Quadratic Programming)."}], "answers": [{"comments": [{"owner": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "edited": false, "score": 0, "creation_date": 1505952729, "post_id": 46333397, "comment_id": 79627721, "body": "Thanks ... it&#39;s been years since my calculus classes in college.  :) However, I need an integer solution.  Assuming that a = 3, b = 2, and d = 2, assuming I&#39;m using your solution correctly, I&#39;d get j = (2 + 2 - 3) / 2 = 1/2.  I know from brute forcing that there are two maximum solutions for this a, b, and d where c = 12:  j = 0, k = 2 and j = 1, k = 1"}, {"owner": {"reputation": 1879, "user_id": 5955745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/309ya.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5955745/marco"}, "reply_to_user": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "edited": false, "score": 0, "creation_date": 1505952886, "post_id": 46333397, "comment_id": 79627756, "body": "@ArkieCoder Again, I&#39;d choose the easy way... If you get <code>1&#47;2</code> then take its <i>floor</i> (<code>0</code>) and its <i>ceil</i> (<code>1</code>) and see when <code>c</code> is greater. I&#39;m updating the answer."}, {"owner": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "edited": false, "score": 0, "creation_date": 1505955815, "post_id": 46333397, "comment_id": 79628364, "body": "Thanks for updating your solution. Very pretty! I am testing it now."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1505968870, "post_id": 46333397, "comment_id": 79631151, "body": "Suppose  <code>a = 2</code>, <code>b = 7</code>, <code>d = 3</code>. Then  <code>max_alloc(2, 7, 3)  =&gt; [4, -1]</code>, but the variables must be non-negative."}, {"owner": {"reputation": 1879, "user_id": 5955745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/309ya.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5955745/marco"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1505985958, "post_id": 46333397, "comment_id": 79640010, "body": "@CarySwoveland that&#39;s not a big deal... Just check <code>j</code> and if it&#39;s negative set it ti <code>0</code>. Thanks anyway, I&#39;ve added it to the code"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1506006486, "post_id": 46333397, "comment_id": 79655035, "body": "&quot;Thanks anyway&quot;? For informing you that your code was incorrect? Moreover, you haven&#39;t shown <i>why</i> the point <code>j*</code> at which the slope is zero is the maximum value of the function. How do we know it&#39;s not the minimum value or an inflexion point? Also, you haven&#39;t shown <i>why</i> the maximum value occurs at <code>j = 0</code> if <code>j* &lt; 0</code> and at <code>j = d</code> if <code>j* &gt; d</code>."}, {"owner": {"reputation": 1879, "user_id": 5955745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/309ya.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5955745/marco"}, "edited": false, "score": 0, "creation_date": 1506007065, "post_id": 46333397, "comment_id": 79655418, "body": "I say <i>&quot;study the sign of it&#39;s derivative&quot;</i> and that&#39;s how you know that <code>j*</code> is maximum. The <i>&quot;Thanks anyway&quot;</i> was ment as a polite thanks, I apologize for my poor english :) About the second part you are right, I&#39;m updating"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1506015020, "post_id": 46333397, "comment_id": 79660120, "body": "The sign of the derivative is plus for some <code>j</code> and minus for others. It&#39;s the second derivative you need to examine (which I&#39;m sure you know)."}, {"owner": {"reputation": 1879, "user_id": 5955745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/309ya.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5955745/marco"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1506015538, "post_id": 46333397, "comment_id": 79660382, "body": "@CarySwoveland I&#39;m sorry but this time I have to contradict you. The sign of the first derivative is enough to determine maxmium and minimum of functions."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1506016126, "post_id": 46333397, "comment_id": 79660719, "body": "If <code>f(x) = 2 + 6x - x^2</code>, <code>f&#39;(x) = 6 - 2x = 0</code> so the slope is zero at <code>x = 3</code>, is positive for <code>x &lt; 3</code> and is negative for <code>x &gt; 3</code>. So what is the sign of the derivative here? Of interest is whether the derivative is increasing (implies a maximum) or decreasing (a minumum) with <code>x</code>, which is equivalent to the second derivative (<code>f&#39;&#39;(x) = -2</code>) being negative or positive."}, {"owner": {"reputation": 1879, "user_id": 5955745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/309ya.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5955745/marco"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1506016229, "post_id": 46333397, "comment_id": 79660769, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/155032/discussion-between-busy-beaver-and-cary-swoveland\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1879, "user_id": 5955745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/309ya.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5955745/marco"}, "is_accepted": true, "score": 3, "last_activity_date": 1518348540, "last_edit_date": 1518348540, "creation_date": 1505951933, "answer_id": 46333397, "question_id": 46333125, "link": "https://stackoverflow.com/questions/46333125/optimization-of-profit-in-ruby/46333397#46333397", "title": "Optimization of profit in Ruby", "body": "<p>Do you really need an algorithm to do that?\nThis is a simple maximum/minimum optimization problem.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8GMr4.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8GMr4.gif\" alt=\"\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/RRs2F.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RRs2F.gif\" alt=\"\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/WKY21.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WKY21.gif\" alt=\"\"></a></p>\n\n<p>Now consider the equation</p>\n\n<p><a href=\"https://i.stack.imgur.com/vIZqD.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vIZqD.gif\" alt=\"\"></a></p>\n\n<p>It is a function of <code>j</code>, so let's call it <code>f(j)</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6ygtl.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6ygtl.gif\" alt=\"\"></a></p>\n\n<p>You want to find <code>j</code> such that <code>c = f(j)</code> is maximum... so you want to study the sign of it's derivative</p>\n\n<p><a href=\"https://i.stack.imgur.com/u0TJN.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u0TJN.gif\" alt=\"\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/18D9j.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/18D9j.gif\" alt=\"\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/FELhc.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FELhc.gif\" alt=\"\"></a></p>\n\n<p>Now you can draw the table of signs</p>\n\n<p><a href=\"https://i.stack.imgur.com/veWKA.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/veWKA.gif\" alt=\"\"></a></p>\n\n<p>There you have it! A maximum for</p>\n\n<p><a href=\"https://i.stack.imgur.com/fr9dk.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fr9dk.gif\" alt=\"\"></a></p>\n\n<p>this means the <code>j, k</code> pair you are looking for is</p>\n\n<p><a href=\"https://i.stack.imgur.com/OIqvJ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OIqvJ.gif\" alt=\"\"></a></p>\n\n<p>and for such values you'll have the maximum value of <code>c</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3HH0x.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3HH0x.gif\" alt=\"\"></a></p>\n\n<hr>\n\n<h2>In Ruby</h2>\n\n<pre><code>def max_alloc(a, b, d)\n    j = (-a + b + d) / 2.0\n    j = j.round # round to prevent Float, explained at the end of this answer\n    if j &lt; 0\n        j = 0 # prevent from negative values\n    elsif j &gt; d\n        j = d # prevent from values greater than d\n    end\n    [j, d - j]\nend\n</code></pre>\n\n<p>Or even shorter</p>\n\n<pre><code>def max_alloc(a, b, d)\n    j = ((-a + b + d) / 2.0).round\n    j = [0, [j, d].min].max # make sure j is in range 0..d\n    [j, d - j]\nend\n</code></pre>\n\n<p>A one-liner too if you like</p>\n\n<pre><code>def max_alloc(a, b, d)\n    [[0, [((-a + b + d) / 2.0).round, d].min].max, d - [0, [((-a + b + d) / 2.0).round, d].min].max]\nend\n</code></pre>\n\n<hr>\n\n<h2>An in-depth look at the cases <code>j &lt; 0</code> and <code>j &gt; d</code></h2>\n\n<p>Let's start from the bounds that <code>j</code> must satisfy:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mCYyy.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mCYyy.gif\" alt=\"\"></a></p>\n\n<p>So <code>j*</code> is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Rk23L.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rk23L.gif\" alt=\"\"></a></p>\n\n<p>Now, since <code>f(j)</code> is <strong>always</strong> a parabola opened downward, the absolute maximum will be it's vertex, so, as discovered before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3P95h.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3P95h.gif\" alt=\"\"></a></p>\n\n<p>But what if this point is outside the given range for <code>j</code>? You'll have to decide wheter to chose <code>j* = 0, k* = d</code> or <code>j* = d, k* = 0</code>.</p>\n\n<p>Since <code>f(j)</code> is strictly increasing for <code>j &lt; j*</code> and strictly descreasing for <code>j &gt; j*</code>, the closer you get to <code>j*</code>, the greater would be <code>f(j)</code> value.</p>\n\n<p>Therefore, if <code>j* &gt; d</code> the choose <code>j* = d</code>, if <code>j* &lt; 0</code> then choose <code>j = 0</code>.</p>\n\n<p>Here I show some plots just to see this in action:</p>\n\n<p><a href=\"https://i.stack.imgur.com/euD7a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/euD7a.png\" alt=\"j* inside the range... nothing to do\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/pewvg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pewvg.png\" alt=\"j* &lt; 0... the highest in range is when j = 0\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/xGb3q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xGb3q.png\" alt=\"j* &gt; d... the highest in range is when j = d\"></a></p>\n\n<hr>\n\n<h2>Why <code>j.round</code>?</h2>\n\n<p>As you just learned <code>f(j)</code> is a parabola, and parabolas have an axis of symmetry. If <code>j*</code> is an integer, you are done, otherwise for what integer value is <code>f(j)</code> maximized? Well... for the integer value closest to the vertex; i.e., <code>j.round</code>.</p>\n\n<p><strong>Note:</strong> If <code>a, b</code> and <code>d</code> are integers, then <code>j*</code> can only be an integer or <code>xxx.5</code>. So <code>f(j)</code> would be the same for <code>j.ceil</code> and <code>j.floor</code>... You choose.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1506017362, "last_edit_date": 1506017362, "creation_date": 1505968376, "answer_id": 46335538, "question_id": 46333125, "link": "https://stackoverflow.com/questions/46333125/optimization-of-profit-in-ruby/46335538#46335538", "title": "Optimization of profit in Ruby", "body": "<p>For given constants <code>a</code> and <code>b</code>, let</p>\n\n<pre><code>f(j,k) = (a + j) * (b + k)\n</code></pre>\n\n<p>We wish to maximize <code>f(j,k)</code> subject to three requirements:</p>\n\n<ul>\n<li><code>j + k = d</code>, for a given constant <code>d</code></li>\n<li><code>j &gt;= 0</code></li>\n<li><code>k &gt;= 0</code></li>\n</ul>\n\n<p>We can substitute out <code>k</code> (or <code>j</code>) to by replacing <code>k</code> with</p>\n\n<pre><code>k = d - j\n</code></pre>\n\n<p>This changes <code>f</code> to:</p>\n\n<pre><code>f(j) = (a + j) * (b + d - j)\n     = a*(b + d) + (b + d - a)*j -j**2\n</code></pre>\n\n<p>The problem is now to maximize <code>f</code> subject to:</p>\n\n<pre><code>0 &lt;= j &lt;= d\n</code></pre>\n\n<p>The second part of this inequality follows from <code>k = d - j &gt;= 0</code>. If <code>d = 0</code>, <code>j = k = 0</code> is the only solution that satisfies the requirement that the variables are non-negative. If <code>d &lt; 0</code> there is no feasible solution. These two cases should be checked for but I will assume <code>d &gt; 0</code>.</p>\n\n<p>We first set the derivative of <code>f</code> to zero and solve for <code>j</code> to determine where <code>f</code>'s slope is zero:</p>\n\n<pre><code>f'(j) = b + d - a - 2*j = 0\n</code></pre>\n\n<p>so</p>\n\n<pre><code>j* = (b + d - a)/2\n</code></pre>\n\n<p>As the second derivative of <code>f</code> is</p>\n\n<pre><code>f''(j) = -2 &lt; 0\n</code></pre>\n\n<p>we know <code>f</code> is concave, so <code>j*</code> is a maximum (rather than a minimum were it convex). Convex and concave functions are shown here<sup>1</sup>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/v1re3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v1re3.png\" alt=\"Convex and Concave Functions\"></a></p>\n\n<p>Consider the graph of the concave function. Values of <code>j</code> are on the horizontal axis. Since <code>j*</code> must be between <code>0</code> and <code>d</code> to be feasible (both variables have non-negative values), let the points <code>a</code>, <code>c</code> and <code>b</code> on the graph equal <code>0</code>, <code>j*</code> and <code>d</code>, respectively.</p>\n\n<p>There are three possibilities:</p>\n\n<ul>\n<li><code>0 &lt;= j* &lt;= d</code>, in which case that is a feasible solution (since <code>k = d - j* &gt;= 0</code>).</li>\n<li><code>j* &lt; 0</code>, in which case the largest feasible value of <code>f</code> is where <code>j = 0</code>.</li>\n<li><code>j* &gt; d</code>, in which case the largest feasible value of <code>f</code> is where <code>j = d</code>.</li>\n</ul>\n\n<p>Once the optimum value of <code>j</code> has been determined, <code>k = d - j</code></p>\n\n<p>Here are some examples.</p>\n\n<p><em>Ex. 1: <code>a = 2</code>, <code>b = 3</code>, <code>d = 5</code></em></p>\n\n<pre><code>j* = (b + d - a)/2 = (3 + 5 - 2)/2 = 3\n</code></pre>\n\n<p>Since <code>0 &lt;= 3 &lt;= 5</code>, <code>j = 3</code>, <code>k = 5 - 3 = 2</code> are the optimum values of <code>j</code> and <code>k</code> and <code>f(3) = 25</code> is the optimum value.</p>\n\n<p><em>Ex. 2: <code>a = 6</code>, <code>b = 1</code>, <code>d = 3</code></em></p>\n\n<pre><code>j* = (b + d - a)/2 = (1 + 3 - 6)/2 = -1\n</code></pre>\n\n<p>Since <code>-1 &lt; 0</code>, <code>j = 0</code>, <code>k = 3 - 0 = 3</code> are the optimum values of <code>j</code> and <code>k</code> and <code>f(0) = 24</code> is the optimum value.</p>\n\n<p><em>Ex. 3: <code>a = 2</code>, <code>b = 7</code>, <code>d = 3</code></em></p>\n\n<pre><code>j* = (b + d - a)/2 = (7 + 3 - 2)/2 = 4\n</code></pre>\n\n<p>Since <code>4 &lt; 3</code>, <code>j = 3</code>, <code>k = 3 - 3 = 0</code> is the optimum value of <code>j</code> and <code>f(3) = 35</code> is the optimum value.</p>\n\n<p>If <code>j</code> and <code>k</code> must be integer-valued at the maximum value of <code>f</code>, we can assume <code>a</code>, <code>b</code> and <code>d</code> are integer-valued. (If <code>a</code> and <code>b</code> are not, <code>a</code> can be rounded up and <code>b</code> rounded down.) Let <code>j*</code> now be the value of <code>j</code> satisfying <code>0 &lt;= j &lt;= d</code> for which is <code>f(j)</code> is a maximum (but <code>j*</code> is not necessarily an integer). Because <code>f</code> is concave, if <code>j*</code> is not integer, the optimal value of <code>j</code> is <code>J*.floor</code> if <code>f(j*.floor) &gt;= f(j*.ceil)</code> and <code>j*.ceil</code> otherwise.</p>\n\n<p><sup>1 A function <code>f</code> is concave if, for all <code>a</code> and <code>b</code>, <code>a &lt; b</code>, and all <code>x</code>, <code>a &lt;= x &lt;= b</code>, <code>f(x) &gt;= g(x)</code>, where <code>g</code> is the linear function having the property that <code>g(a) = f(a)</code> and <code>g(b) = f(b)</code>.</sup></p>\n"}], "owner": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 46333397, "answer_count": 2, "score": 3, "last_activity_date": 1518348540, "creation_date": 1505949757, "last_edit_date": 1505951648, "question_id": 46333125, "link": "https://stackoverflow.com/questions/46333125/optimization-of-profit-in-ruby", "title": "Optimization of profit in Ruby", "body": "<p>I'm using Ruby, but for the purposes of this problem it doesn't really matter.</p>\n\n<p>Let's say I have two different kinds of resources, the quantities of which are denoted by <code>a</code> and <code>b</code>.  I can allocate <code>d</code> new resources, and since <code>a</code> and <code>b</code> are of equal cost and equal value to production, I can choose to allocate resources in whatever way is most profitable.</p>\n\n<p>This might best be explained like so: <code>(a + j) * (b + k) = c</code>, where <code>j + k = d</code>.  I want to maximize <code>c</code> by the best allocation of resources, with the understanding that the cost of the two different types of resources and their value to production are the same.  All variables are positive integers, with <code>a</code> and <code>b</code> being greater than 0. Here's my naive brute force method:</p>\n\n<pre><code>def max_alloc(a, b, d)\n  max_j = 0\n  max_k = 0\n  max_c = 0\n  (0..d).each do |j|\n    k = d - j\n    c = (a + j) * (b + k)\n    if c &gt; max_c\n      max_c = c\n      max_j = j\n      max_k = k\n    end\n  end\n  [max_j, max_k]\nend\n</code></pre>\n\n<p>I'm hoping that there's some sort of mathematical or algorithmic \"trick\" I'm missing that will keep me from having to resort to brute force.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "answers": [{"tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1506081718, "creation_date": 1506081718, "answer_id": 46364342, "question_id": 46333001, "link": "https://stackoverflow.com/questions/46333001/how-to-check-the-collection-radio-buttons-selected-for-if-condition-rails/46364342#46364342", "title": "how to check the collection_radio_buttons selected for if condition? Rails", "body": "<p>This should work, assuming that jQuery is included in your assets.</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n  $(document).ready(function(){\n    $('.radio').click(function(){\n      $('#data_fim').val($(this).val());\n    });\n  });\n&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 8146233, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-SFPhjuZYlMU/AAAAAAAAAAI/AAAAAAAAAEE/8hm6u4cj7ME/photo.jpg?sz=128", "display_name": "Jorge Miguel", "link": "https://stackoverflow.com/users/8146233/jorge-miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506081718, "creation_date": 1505948782, "question_id": 46333001, "link": "https://stackoverflow.com/questions/46333001/how-to-check-the-collection-radio-buttons-selected-for-if-condition-rails", "title": "how to check the collection_radio_buttons selected for if condition? Rails", "body": "<p>I have this form</p>\n\n<pre><code> &lt;div class=\"form-group\"&gt;\n      &lt;%= f.label :status %&gt;\n        &lt;%= f.collection_radio_buttons(:status, options_for_status, :id, :description) do |b| %&gt;\n          &lt;div class=\"radio\"&gt;\n            &lt;%= b.label { b.radio_button + b.value} %&gt;                \n          &lt;/div&gt;\n          &lt;% end %&gt;\n    &lt;/div&gt;\n\n    if ??\n    #&lt;% f.hidden_field :data_fim, :value =&gt; Date.today %&gt;\n</code></pre>\n\n<p>When the user selects a specific radiobuton, he must execute hiden_field.</p>\n\n<pre><code>STATUS = {:Aguardando =&gt; 1, :'Em atendimento' =&gt; 2, :Finalizado =&gt; 3}\n</code></pre>\n\n<p>These are the options present for the user, I want to set set date_fim when the user select the radio </p>\n\n<blockquote>\n  <p>:Finalizado => 3</p>\n</blockquote>\n\n<p>Would JS be my only option? Someone to help a noob in ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "memory-leaks", "garbage-collection"], "owner": {"reputation": 7036, "user_id": 1740079, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Xp2ab.png?s=128&g=1", "display_name": "nicooga", "link": "https://stackoverflow.com/users/1740079/nicooga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1506623599, "creation_date": 1505948123, "last_edit_date": 1506623599, "question_id": 46332900, "link": "https://stackoverflow.com/questions/46332900/ruby-is-comparing-gc-stat-allocation-delta-to-rss-a-valid-method-to-prove-a-m", "title": "Ruby: is comparing `GC.stat` allocation delta to RSS a valid method to prove a memory leak in garbage collection?", "body": "<p>I have a memory leak in a Rails API, there's no doubt about it.</p>\n\n<p>The first thing I want to know is whether the leak is related to garbage collection or not. If that's not the case, I'd have to go deeper and search for the cause in C native extensions.</p>\n\n<p>I've put my API under an stress test using <a href=\"https://linux.die.net/man/1/siege\" rel=\"nofollow noreferrer\"><code>siege</code></a> and stored the ouput of <a href=\"https://ruby-doc.org/core-2.4.1/GC.html#method-c-stat\" rel=\"nofollow noreferrer\"><code>GC.stat</code></a> into an ELK stack. Then graphed what would be <code>GC.stat[:total_allocated_objects] - GC.stat[:total_freed_objects]</code> in the left side and RSS in the right side. This are the results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/N6tze.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N6tze.png\" alt=\"enter image description here\"></a></p>\n\n<p>The upward tendency in the RSS proves the leak, but the \"allocation/freeing delta\" does not show growth (the small valley matches a short time when the siege command failed and I got to restart it).</p>\n\n<p>Should I take this as a proof that the leak is not due to garbage collection issues?</p>\n\n<p>Or, putting this in a more general perspective, <strong>is comparing <code>GC.stat[:total_allocated_objects] - GC.stat[:total_freed_objects]</code> to <code>RSS</code> a reliable method to determine whether is there a leak in garbage collection due to misuse of the language?</strong></p>\n"}, {"tags": ["ruby", "methods", "tokenize", "letters", "alphabet"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1505949429, "post_id": 46332888, "comment_id": 79626963, "body": "What have you tried so far? This is going to be really complicated and so if you can limit it to just a specific area you need help with I think you&#39;ll have better luck here. As it stands, there are a ton of edge cases that those who don&#39;t natively speak your language (and maybe those that do speak it) aren&#39;t going to be able to work through...for instance if I see <code>dzs</code> in a string, that could be <code>[&quot;dzs&quot;]</code>, or <code>[&quot;d&quot;, &quot;zs&quot;]</code> or <code>[&quot;dz&quot;, &quot;s&quot;]</code> or <code>[&quot;d&quot;, &quot;z&quot;, &quot;s&quot;]</code> and without a dictionary of words (or knowing a lot about this language), I don&#39;t think we&#39;ll be able to determine which is correct"}, {"owner": {"reputation": 2537, "user_id": 1596686, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/bb0df9d59647054dda587a38d1612a78?s=128&d=identicon&r=PG", "display_name": "Konstantin", "link": "https://stackoverflow.com/users/1596686/konstantin"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1505949672, "post_id": 46332888, "comment_id": 79627026, "body": "This is why I sorted the letters in the alphabet: if a letter appears earlier, then it should be recognized instead of its simple letters. When a word contains &quot;dzs&quot; it should be considered to &quot;dzs&quot; and not to &quot;d&quot; and &quot;zs&quot;. It would give some false results in rare cases, but the majority of the decompositions would work. I don&#39;t know how to do it efficiently. Maybe some built in string tokenizer, or something."}], "answers": [{"comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 1, "creation_date": 1505960859, "post_id": 46333621, "comment_id": 79629402, "body": "In general <code>Regexp.union</code> is safer than <code>join(&quot;|&quot;)</code>, but it may not matter in this case, since we&#39;re only dealing with word chars."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1505961054, "post_id": 46333621, "comment_id": 79629442, "body": "Ah, yeah good point, don&#39;t deal with dynamic regexes very much and completely forgot <code>union</code> existed. Updated"}, {"owner": {"reputation": 2537, "user_id": 1596686, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/bb0df9d59647054dda587a38d1612a78?s=128&d=identicon&r=PG", "display_name": "Konstantin", "link": "https://stackoverflow.com/users/1596686/konstantin"}, "edited": false, "score": 0, "creation_date": 1505997532, "post_id": 46333621, "comment_id": 79648134, "body": "Yes, it works as expected, I typed wrong result in the example, now I fixed it."}, {"owner": {"reputation": 2537, "user_id": 1596686, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/bb0df9d59647054dda587a38d1612a78?s=128&d=identicon&r=PG", "display_name": "Konstantin", "link": "https://stackoverflow.com/users/1596686/konstantin"}, "edited": false, "score": 0, "creation_date": 1505999243, "post_id": 46333621, "comment_id": 79649499, "body": "String#scan is the winner, and Regexp.union, however the order of the keys counts, when tokenizing, because some of the regex patterns are prefixes of others."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1506020656, "post_id": 46333621, "comment_id": 79663069, "body": "<code>abc.keys</code> should return the keys in insertion order for recent versions of Ruby (&gt; 2.0, possibly earlier), so order of the keys should be honored"}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 2, "last_activity_date": 1505961110, "last_edit_date": 1505961110, "creation_date": 1505953861, "answer_id": 46333621, "question_id": 46332888, "link": "https://stackoverflow.com/questions/46332888/decompose-words-into-letters-with-ruby/46333621#46333621", "title": "Decompose words into letters with Ruby", "body": "<p>You might be able to get started looking at <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-scan\" rel=\"nofollow noreferrer\"><code>String#scan</code></a>, which appears to be giving decent results for your examples:</p>\n\n<pre><code>\"csoboly\u00f3\".scan(Regexp.union(abc.keys))\n# =&gt; [\"cs\", \"o\", \"b\", \"o\", \"ly\", \"\u00f3\"]\n\"nyiretty\u0171\".scan(Regexp.union(abc.keys))\n# =&gt; [\"ny\", \"i\", \"r\", \"e\", \"tty\", \"\u0171\"]\n\"dzsesszmuzsikus\".scan(Regexp.union(abc.keys))\n# =&gt; [\"dzs\", \"e\", \"ssz\", \"m\", \"u\", \"zs\", \"i\", \"k\", \"u\", \"s\"]\n</code></pre>\n\n<p>The last case doesn't match your expected output, but it matches <a href=\"https://stackoverflow.com/questions/46332888/decompose-words-into-letters-with-ruby#comment79627026_46332888\">your statement in the comments</a></p>\n\n<blockquote>\n  <p>I sorted the letters in the alphabet: if a letter appears earlier, then it should be recognized instead of its simple letters. When a word contains \"dzs\" it should be considered to \"dzs\" and not to \"d\" and \"zs\"</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1247, "user_id": 4087989, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72c9108f519b175d408da0142014d421?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Praveen", "link": "https://stackoverflow.com/users/4087989/siva-praveen"}, "is_accepted": false, "score": 1, "last_activity_date": 1505953868, "creation_date": 1505953868, "answer_id": 46333622, "question_id": 46332888, "link": "https://stackoverflow.com/questions/46332888/decompose-words-into-letters-with-ruby/46333622#46333622", "title": "Decompose words into letters with Ruby", "body": "<p>I didn't use the preference in which you sorted, rather I used higher character word will have higher preference than lower character word.</p>\n\n<pre><code>def spell word\n  abc=[*%w{tty ccs lly ggy ssz nny dzs zzs sz zs cs gy ny dz ty ly q w r t z p l k j h g f d s x c v b n m y}.map{|z| [z,\"c\"]},*\"e\u00e9uio\u00f6\u00fc\u00f3\u0151\u00fa\u0171\u00e1\u00eda\".split(//).map{|z| [z,\"v\"]}].to_h\n  current_position = 0\n  maximum_current_position = 2\n  maximum_possible_position = word.length\n  split_word = []\n  while current_position &lt; maximum_possible_position do \n    current_word = set_current_word word, current_position, maximum_current_position\n    if abc[current_word] != nil\n      current_position, maximum_current_position = update_current_position_and_max_current_position current_position, maximum_current_position\n      split_word.push(current_word)\n    else\n      maximum_current_position = update_max_current_position maximum_current_position\n      current_word = set_current_word word, current_position, maximum_current_position\n      if abc[current_word] != nil\n        current_position, maximum_current_position = update_current_position_and_max_current_position current_position, maximum_current_position\n        split_word.push(current_word)\n      else\n        maximum_current_position = update_max_current_position maximum_current_position\n        current_word = set_current_word word, current_position, maximum_current_position\n        if abc[current_word] != nil\n          current_position, maximum_current_position = update_current_position_and_max_current_position current_position, maximum_current_position          \n          split_word.push(current_word)\n        else\n          puts 'This word cannot be formed in the current language'\n          break\n        end\n      end\n    end\n  end\n  split_word\nend\n\ndef update_max_current_position max_current_position\n    max_current_position = max_current_position - 1\nend\n\ndef update_current_position_and_max_current_position current_position,max_current_position\n    current_position = max_current_position + 1\n    max_current_position = current_position + 2\n    return current_position, max_current_position\nend\n\ndef set_current_word word, current_position, max_current_position\n  word[current_position..max_current_position]\nend\n\nputs \"csoboly\u00f3 =&gt; #{spell(\"csoboly\u00f3\")}\"\nputs \"nyiretty\u0171 =&gt; #{spell(\"nyiretty\u0171\")}\"\nputs \"dzsesszmuzsikus =&gt; #{spell(\"dzsesszmuzsikus\")}\"\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>csoboly\u00f3 =&gt; [\"cs\", \"o\", \"b\", \"o\", \"ly\", \"\u00f3\"]\nnyiretty\u0171 =&gt; [\"ny\", \"i\", \"r\", \"e\", \"tty\", \"\u0171\"]\ndzsesszmuzsikus =&gt; [\"dzs\", \"e\", \"ssz\", \"m\", \"u\", \"zs\", \"i\", \"k\", \"u\", \"s\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2537, "user_id": 1596686, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/bb0df9d59647054dda587a38d1612a78?s=128&d=identicon&r=PG", "display_name": "Konstantin", "link": "https://stackoverflow.com/users/1596686/konstantin"}, "is_accepted": false, "score": 0, "last_activity_date": 1506014566, "creation_date": 1506014566, "answer_id": 46349788, "question_id": 46332888, "link": "https://stackoverflow.com/questions/46332888/decompose-words-into-letters-with-ruby/46349788#46349788", "title": "Decompose words into letters with Ruby", "body": "<p>Meanwhile I managed to write a method which works, but 5x slower than String#scan:</p>\n\n<pre><code>abc=[*%w{tty ccs lly ggy ssz nny dzs zzs sz zs cs gy ny dz ty ly q w r t z p l k j h g f d s x c v b n m y}.map{|z| [z,\"c\"]},*\"e\u00e9uio\u00f6\u00fc\u00f3\u0151\u00fa\u0171\u00e1\u00eda\".split(//).map{|z| [z,\"v\"]}].to_h\n\ndef spell(w,abc)\n\n\n    s=w.split(//)\n    p=\"\"\n    t=[]\n\n    for i in 0..s.size-1 do\n      p &lt;&lt; s[i]\n      if i&gt;=s.size-2 then\n\n       if abc[p]!=nil then\n          t.push p\n          p=\"\"\n\n       elsif abc[p[0..-2]]!=nil then\n          t.push p[0..-2]\n          p=p[-1]\n\n       elsif abc[p[0]]!=nil then\n          t.push p[0]\n          p=p[1..-1]\n\n       end \n\n      elsif p.size==3 then\n       if abc[p]!=nil then\n          t.push p\n          p=\"\"\n\n       elsif abc[p[0..-2]]!=nil then\n          t.push p[0..-2]\n          p=p[-1]\n\n       elsif abc[p[0]]!=nil then\n          t.push p[0]\n          p=p[1..-1]\n       end\n      end\n    end\n\n    if p.size&gt;0 then\n        if abc[p]!=nil then\n          t.push p\n          p=\"\"\n\n       elsif abc[p[0..-2]]!=nil then\n          t.push p[0..-2]\n          p=p[-1]\n      end\n    end\n\n    if p.size&gt;0 then\n      t.push p\n    end\n    return t\nend\n</code></pre>\n"}], "owner": {"reputation": 2537, "user_id": 1596686, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/bb0df9d59647054dda587a38d1612a78?s=128&d=identicon&r=PG", "display_name": "Konstantin", "link": "https://stackoverflow.com/users/1596686/konstantin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 46333621, "answer_count": 3, "score": 2, "last_activity_date": 1506014566, "creation_date": 1505948013, "last_edit_date": 1505997444, "question_id": 46332888, "link": "https://stackoverflow.com/questions/46332888/decompose-words-into-letters-with-ruby", "title": "Decompose words into letters with Ruby", "body": "<p>In my language there are composite or compound letters, which consists of more than one character, eg \"ty\", \"ny\" and even \"tty\" and \"nny\". I would like to write a Ruby method (spell) which tokenize words into letters, according to this alphabet:</p>\n\n<pre><code>abc=[*%w{tty ccs lly ggy ssz nny dzs zzs sz zs cs gy ny dz ty ly q w r t z p l k j h g f d s x c v b n m y}.map{|z| [z,\"c\"]},*\"e\u00e9uio\u00f6\u00fc\u00f3\u0151\u00fa\u0171\u00e1\u00eda\".split(//).map{|z| [z,\"v\"]}].to_h\n</code></pre>\n\n<p>The resulting hash keys shows the existing letters / composite letters of the alphabet and also shows which letter is a consonant (\"c\") and which one is a vowel (\"v\"), becase later I would like to use this hash to decompose words into syllables. Cases of compound words when accidentally composite letters are formed at the words common boundary shoudn't be resolved by the method of course.</p>\n\n<p>Examples:</p>\n\n<pre><code>spell(\"csoboly\u00f3\") =&gt; [ \"cs\", \"o\", \"b\", \"o\", \"ly\", \"\u00f3\" ]\nspell(\"nyiretty\u0171\") =&gt; [ \"ny\", \"i\", \"r\", \"e\", \"tty\", \"\u0171\" ]\nspell(\"dzsesszmuzsikus\") =&gt; [ \"dzs\", \"e\", \"ssz\", \"m\", \"u\", \"zs\", \"i\", \"k\", \"u\", \"s\" ]\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax", "render"], "answers": [{"comments": [{"owner": {"reputation": 1069, "user_id": 986711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/8ERmO.jpg?s=128&g=1", "display_name": "MingMan", "link": "https://stackoverflow.com/users/986711/mingman"}, "edited": false, "score": 0, "creation_date": 1506002995, "post_id": 46338879, "comment_id": 79652477, "body": "Thanks for all the information Fabizio Bertoglio!  As i said above, I have the route working, and the view rendering perfectly when i don&#39;t use locals.  If i just hardcode some test values in the partial and don&#39;t pass locals, it looks great!  I read though your comments and tried to find something that I missed but i think i&#39;m good! From the view to call all of this i&#39;m using a javascript ajax post request!"}], "tags": [], "owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "is_accepted": false, "score": 1, "last_activity_date": 1505982558, "last_edit_date": 1505982558, "creation_date": 1505982107, "answer_id": 46338879, "question_id": 46332868, "link": "https://stackoverflow.com/questions/46332868/how-to-add-locals-to-a-render-call-within-a-js-erb-file/46338879#46338879", "title": "How to add locals to a render call within a js.erb file", "body": "<p>You did not specify how you are calling <code>js.erb</code>, but the best approach I suggest is the following.</p>\n\n<p>STEP 1 - BUILDING THE VIEW</p>\n\n<p>Either start by including a link, form or button with the <code>remote: true</code> option in your view</p>\n\n<p>for example</p>\n\n<pre><code>&lt;%= form_with(model: @invitation) do |f| %&gt;\n...\n&lt;% end %&gt;\n</code></pre>\n\n<p>STEP 2 - UNDERSTANDING THE ROUTING</p>\n\n<p>The resources routes in <code>route.rb</code> for <code>:invitations</code> generates the following routes:</p>\n\n<pre><code>new_invitation GET  /invitations/new(.:format) invitations#new                           \n               POST /invitations(.:format)     invitations#create                                      \n</code></pre>\n\n<p>and your form in your view <code>invitations/new.html.erb</code> on submit will perform a <code>POST</code> request to the <strong>url</strong> <code>/invitations</code>.</p>\n\n<p>EXPLANATION OF AJAX </p>\n\n<p>In webdevelopment you can do 2 types of requests between Server and Client, \n<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Synchronous_and_Asynchronous_Requests\" rel=\"nofollow noreferrer\"><strong>Synchronous</strong> or <strong>asynchronous</strong> requests</a>. In a Synchronous request, the client/browser will perform an HTTP <code>request</code> to the backend server, which will answer with a <code>response</code>. The browser will stop and start loading until he does receive the full response.</p>\n\n<p>In a asynchronous request, the <code>request and response</code> cycle will not include the browser stopping to load.  </p>\n\n<p>Your <code>javascript</code> file is just one file included in the <strong>client/browser</strong> asset pipeline, which are all the <code>js</code>, <code>css</code>, <code>images</code> and <code>fonts</code> that are downloaded by the browser when the user go to visit your page at <code>http://yourwebsite.xyz</code> and performs a <code>get</code> request to that <code>url</code>. Your server performs a response that include all those information.</p>\n\n<p>So that <code>js</code> file can not find your variable which is from your <code>server</code> application or from a query in your <code>database</code>. The two things are separated, one is your server and the other is the client.</p>\n\n<p>If you want to have that variable and add it to the <strong>client/browser</strong> dynamically and <code>asynchronously</code>, then you need to use <code>AJAX</code>.</p>\n\n<p>A <code>get</code> request needs to be performed from your client to your backend server, the response will include the <code>@invitation</code> variable in the <code>json</code> format </p>\n\n<p>STEP 3 - BUILDING YOUR CONTROLLER</p>\n\n<p>The Rails router receives a <code>POST</code> request at <code>/invitations</code> and redirects the request to the controller <code>invitations</code> action <code>create</code>. The parameters are passed through the <code>ActionController::Parameters</code> object <code>params</code>.</p>\n\n<p>The Server running Ruby on Rails responds to the request with 3 different formats:\nHTML to render the view\nJS to execute script code on the front end. The JS file <code>invitations/create.js.erb</code> was already downloaded by the client through the asset pipeline, this is just a command to execute it.\nJSON to send the <code>@invitation</code> object in <code>json</code> format, it will be available at <code>/invitations.json</code></p>\n\n<pre><code># app/controllers/invitations_controller.rb\n# ......\ndef create\n  @invitation = Invitation.new(params[:invitation])\n\n  respond_to do |format|\n    if @invitation.save\n      format.html { redirect_to @invitation, notice: 'Invitation was successfully created.' }\n      format.js\n      format.json { render json: @invitation, status: :created, location: @invitation }\n    else\n      format.html { render action: \"new\" }\n      format.json { render json: @invitation.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>STEP 4 - APPENDING RESULT ASYNCHRONOUSLY TO THE PAGE</p>\n\n<p>In <code>invitations/create.js.erb</code> you can include your js code and you can use the instance variable from the <code>invitations#create</code> action</p>\n\n<pre><code>$(\"&lt;%= escape_javascript(render @invitation) %&gt;\").appendTo(\"#invitations\");\n</code></pre>\n\n<p><a href=\"http://%20http://guides.rubyonrails.org/working_with_javascript_in_rails.html#server-side-concerns\" rel=\"nofollow noreferrer\">more info about working with AJAX and Rails</a></p>\n"}, {"tags": [], "owner": {"reputation": 1069, "user_id": 986711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/8ERmO.jpg?s=128&g=1", "display_name": "MingMan", "link": "https://stackoverflow.com/users/986711/mingman"}, "is_accepted": true, "score": 1, "last_activity_date": 1506006604, "creation_date": 1506006604, "answer_id": 46347467, "question_id": 46332868, "link": "https://stackoverflow.com/questions/46332868/how-to-add-locals-to-a-render-call-within-a-js-erb-file/46347467#46347467", "title": "How to add locals to a render call within a js.erb file", "body": "<p>I found the answer.  It is simple actually</p>\n\n<p>render partial 'view' locals: {k1: v1, k2:v2} does not give you a local hash.  It simply defines the local variables k1 and k2 for use in your partial.  You do not need to extract them from 'locals' hash.</p>\n\n<p>render 'view' locals: {k1: v1, k2:v2} does give you a local hash with k1, v2 inside.  They are not defined until you extract them.  This inconsistency threw me off. my code was prepared for them to be inside the locals hash.</p>\n"}], "owner": {"reputation": 1069, "user_id": 986711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/8ERmO.jpg?s=128&g=1", "display_name": "MingMan", "link": "https://stackoverflow.com/users/986711/mingman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "accepted_answer_id": 46347467, "answer_count": 2, "score": 1, "last_activity_date": 1506006604, "creation_date": 1505947859, "last_edit_date": 1506002416, "question_id": 46332868, "link": "https://stackoverflow.com/questions/46332868/how-to-add-locals-to-a-render-call-within-a-js-erb-file", "title": "How to add locals to a render call within a js.erb file", "body": "<p>I have my js.erb file called remotely from my Rails 5.0.4 app.</p>\n\n<pre><code>&lt;% if @admin_invitation.present? &amp;&amp; @admin_invitation.valid? %&gt;\n&lt;%my_view = j (render partial: \"shared/invitation_card\",:user =&gt; @admin_invitation.invited_id, :email =&gt; @admin_invitation.invited_email, :type =&gt; \"admin\" ) %&gt;\n$(\".invites.admins .row\").prepend(\"&lt;%=my_view %&gt;\");\n&lt;% end %&gt;\n\nApp.refresh( \"&lt;%= j(render 'shared/alerts') %&gt;\" );\n</code></pre>\n\n<p>It works as expected when i hardcode the values in the partial, but when i feed them in as locals from this js.erb file, they dont come through (nil).  Worth noting that I render the partial from a a non-remote haml view and it works just fine.</p>\n\n<p>Here are the ways of rendering i have tried (I know some are outdated, but just for a sanity check)</p>\n\n<pre><code>render partial: \"shared/invitation_card\", :locals=&gt; { :email =&gt; \"admin@gmail.com\", :type =&gt; \"admin\" }\nrender partial: \"shared/invitation_card\", object: \"admin@gmail.com\", as: \"email\"\nrender partial: \"shared/invitation_card\", email: \"admin@gmail.com\", type:\"admin\"\nrender partial: \"shared/invitation_card\", locals: { email: \"admin@gmail.com\", type: \"admin\" }\n</code></pre>\n\n<p>Anyone else have issues with <em>rendering haml partials from a js.erb in rails 5</em>?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here is the controller method calling the js.erb above.</p>\n\n<pre><code>def create\n    if params[:invited_status] == \"temporary_invitation_user\"\n      result = CreateGroupInvitation.call(invitation_model: GroupFollowInvitation, group_id: params[:group_id], inviter: current_user, invited_email: params[:invited_email], notification: \"created_group_follow_email_invitation\")\n    else\n      result = CreateGroupInvitation.call(invitation_model: GroupFollowInvitation, group_id: params[:group_id], inviter: current_user, invited_id: params[:invited_id] , notification: \"created_group_follow_invitation\")\n    end\n\n    if result.success?\n      @invitation = result.invitation\n      @invited = params[:invited_id] == \"null\" ? params[:invited_email] : User.find(params[:invited_id])\n      flash.now[:success] = \"Your follow invitation was sent\"\n    else\n      if result.error_message.present?\n        flash.now[:info] = result.error_message\n      else\n        flash.now[:error] = \"An error happend\"\n      end\n    end\n\n    respond_to do |format|\n      format.js { render layout: false }\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "drop-down-menu"], "comments": [{"owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "edited": false, "score": 0, "creation_date": 1505947891, "post_id": 46332823, "comment_id": 79626556, "body": "can you upload your model schema for this form (my_object)"}, {"owner": {"reputation": 384, "user_id": 4753286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lOZjyFpingw/AAAAAAAAAAI/AAAAAAAAABE/iGhrsGFbKgw/photo.jpg?sz=128", "display_name": "Oscar Luza", "link": "https://stackoverflow.com/users/4753286/oscar-luza"}, "edited": false, "score": 0, "creation_date": 1505948380, "post_id": 46332823, "comment_id": 79626674, "body": "var_to_save_to is the attribute of my_object where is gonna be stored the value of the drop-down. So you should check if that attribute exists in your model checking your database"}, {"owner": {"reputation": 584, "user_id": 1736531, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/51dd1349c4296bd27318e4d4ebf22262?s=128&d=identicon&r=PG", "display_name": "picklechips", "link": "https://stackoverflow.com/users/1736531/picklechips"}, "reply_to_user": {"reputation": 384, "user_id": 4753286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lOZjyFpingw/AAAAAAAAAAI/AAAAAAAAABE/iGhrsGFbKgw/photo.jpg?sz=128", "display_name": "Oscar Luza", "link": "https://stackoverflow.com/users/4753286/oscar-luza"}, "edited": false, "score": 0, "creation_date": 1505954666, "post_id": 46332823, "comment_id": 79628108, "body": "@OscarLuza How can I check it exists?"}, {"owner": {"reputation": 384, "user_id": 4753286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lOZjyFpingw/AAAAAAAAAAI/AAAAAAAAABE/iGhrsGFbKgw/photo.jpg?sz=128", "display_name": "Oscar Luza", "link": "https://stackoverflow.com/users/4753286/oscar-luza"}, "edited": false, "score": 1, "creation_date": 1505955195, "post_id": 46332823, "comment_id": 79628242, "body": "check your database in schema.rb or the migration file, also you can test it with rails console and enter MyObject.new"}, {"owner": {"reputation": 584, "user_id": 1736531, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/51dd1349c4296bd27318e4d4ebf22262?s=128&d=identicon&r=PG", "display_name": "picklechips", "link": "https://stackoverflow.com/users/1736531/picklechips"}, "reply_to_user": {"reputation": 384, "user_id": 4753286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lOZjyFpingw/AAAAAAAAAAI/AAAAAAAAABE/iGhrsGFbKgw/photo.jpg?sz=128", "display_name": "Oscar Luza", "link": "https://stackoverflow.com/users/4753286/oscar-luza"}, "edited": false, "score": 0, "creation_date": 1505969936, "post_id": 46332823, "comment_id": 79631442, "body": "@OscarLuza So i checked it with the console, and it definitely doesn&#39;t exist.. However it&#39;s used in the model, so why does it not exist in the DB? How can I add it to the DB?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1505983354, "post_id": 46332823, "comment_id": 79638310, "body": "You can create a migration and add such attribute, try with <code>rails g migration add_attribute_to_model attribute:datatype</code> tweaking with your needed values."}, {"owner": {"reputation": 584, "user_id": 1736531, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/51dd1349c4296bd27318e4d4ebf22262?s=128&d=identicon&r=PG", "display_name": "picklechips", "link": "https://stackoverflow.com/users/1736531/picklechips"}, "edited": false, "score": 0, "creation_date": 1506019310, "post_id": 46332823, "comment_id": 79662344, "body": "Awesome, got it all sorted out. Thanks guys!"}], "owner": {"reputation": 584, "user_id": 1736531, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/51dd1349c4296bd27318e4d4ebf22262?s=128&d=identicon&r=PG", "display_name": "picklechips", "link": "https://stackoverflow.com/users/1736531/picklechips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505947582, "creation_date": 1505947582, "question_id": 46332823, "link": "https://stackoverflow.com/questions/46332823/ruby-on-rails-form-select-undefined-method", "title": "Ruby on rails form.select &quot;undefined method&quot;", "body": "<p>In an erb file I'm trying to create a drop-down menu and save the selection to the database upon submission. I have this chunk of code:</p>\n\n<pre><code>&lt;% form_for my_object do |form|%&gt;\n\n  &lt;% option_pairs = values.map { |val| [val.id, val.id] } %&gt;\n  &lt;%= form.select :var_to_save_to, options_for_select(option_pairs) %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>However, when I try loading the page I get an error saying <code>undefined method 'var_to_save_to' for #&lt;MyObjectClass&gt;</code></p>\n\n<p>Does anyone know what might be causing this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "regex", "string"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505946674, "post_id": 46332669, "comment_id": 79626219, "body": "I don&#39;t know the Ruby syntax, but use a regular expression that matches a capital letter, 1 or more lowercase letters, then a digit. Put the letters in a capture group and the number in a capture group, then replace them with the 2 back-references separated by a space."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1505946773, "post_id": 46332669, "comment_id": 79626238, "body": "Try <a href=\"https://ideone.com/XNwnRY\" rel=\"nofollow noreferrer\"><code>s.sub(&#47;\\A([A-Z][a-zA-Z]*[a-z])(\\d+)\\z&#47;, &#39;\\1 \\2&#39;)</code></a> or <a href=\"https://ideone.com/JLyfnB\" rel=\"nofollow noreferrer\"><code>s.sub(&#47;\\A(\\p{Lu}\\p{L}*\\p{Ll})(\\d+)\\z&#47;, &#39;\\1 \\2&#39;)</code></a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1506004389, "post_id": 46332669, "comment_id": 79653564, "body": "Hi @Wiktor, You&#39;re solution (I tried the second one) worked for me."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1506004777, "post_id": 46332669, "comment_id": 79653831, "body": "@Natalia I posted an answer with explanation."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1506061906, "post_id": 46332669, "comment_id": 79676130, "body": "@Natalia If my answer proved helpful to you, please also consider upvoting it."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1505948053, "creation_date": 1505948053, "answer_id": 46332896, "question_id": 46332669, "link": "https://stackoverflow.com/questions/46332669/how-do-i-insert-a-space-before-a-number-in-a-string-if-it-matches-a-regular-expr/46332896#46332896", "title": "How do I insert a space before a number in a string if it matches a regular expression?", "body": "<p>You can always do it roughly this way:</p>\n\n<pre><code>%w[\n  Bdefg23\n  Ptannex95\n  BigX901\n  littleX902\n  CS101\n  xx900\n].each do |example|\n  puts '%s -&gt; %s' % [\n    example,\n    example.sub(/\\A([A-Z][a-z]+)(\\d+)\\z/, '\\1 \\2')\n  ]\nend\n</code></pre>\n\n<p>Which gives you output like:</p>\n\n<pre><code>Bdefg23 -&gt; Bdefg 23\nPtannex95 -&gt; Ptannex 95\nBigX901 -&gt; BigX901\nlittleX902 -&gt; littleX902\nCS101 -&gt; CS101\nxx900 -&gt; xx900\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 0, "last_activity_date": 1506004731, "creation_date": 1506004731, "answer_id": 46346861, "question_id": 46332669, "link": "https://stackoverflow.com/questions/46332669/how-do-i-insert-a-space-before-a-number-in-a-string-if-it-matches-a-regular-expr/46346861#46346861", "title": "How do I insert a space before a number in a string if it matches a regular expression?", "body": "<p>You may use</p>\n\n<pre><code>s.sub(/\\A(\\p{Lu}\\p{L}*\\p{Ll})(\\d+)\\z/, '\\1 \\2')\n</code></pre>\n\n<p>See the <a href=\"https://ideone.com/JLyfnB\" rel=\"nofollow noreferrer\">Ruby demo</a>.</p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>\\A</code> - start of string</li>\n<li><code>(\\p{Lu}\\p{L}*\\p{Ll})</code> - Group 1:\n\n<ul>\n<li><code>\\p{Lu}</code> - any Unicode uppercase letter</li>\n<li><code>\\p{L}*</code> - any 0+ Unicode letters</li>\n<li><code>\\p{Ll}</code> - any lowercase Unicode letter</li>\n</ul></li>\n<li><code>(\\d+)</code> - Group 2: one or more digits</li>\n<li><code>\\z</code> - end of string.</li>\n</ul>\n\n<p>The <code>\\1 \\2</code> replacement pattern replaces the whole match with the contents of Group 1, then a space, and then the contents of Group 2.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 46346861, "answer_count": 2, "score": 1, "last_activity_date": 1506004731, "creation_date": 1505946516, "question_id": 46332669, "link": "https://stackoverflow.com/questions/46332669/how-do-i-insert-a-space-before-a-number-in-a-string-if-it-matches-a-regular-expr", "title": "How do I insert a space before a number in a string if it matches a regular expression?", "body": "<p>I want to insert a space before a number in a string if my string has a capital letter, one or more lower case letters, and then a number right after it.  That is, if I have</p>\n\n<pre><code>Bdefg23\n</code></pre>\n\n<p>I want to insert a space between the \"g\" and the \"23\" making the above string</p>\n\n<pre><code>Bdefg 23\n</code></pre>\n\n<p>So this string would not get changed</p>\n\n<pre><code>BabcdD55\n</code></pre>\n\n<p>because there is a capital letter before \"55\".  I tried this below</p>\n\n<pre><code>str.split(/([A-Z][a-z]+)/).delete_if(&amp;:empty?).join(' ')\n</code></pre>\n\n<p>but it works too well.  That is, if my string is</p>\n\n<pre><code>Ptannex..\n</code></pre>\n\n<p>it will turn it into</p>\n\n<pre><code>Ptannex ..\n</code></pre>\n\n<p>How can I adjust what I have to make it work for only the condition I outlined?  Btw, I'm using Ruby 2.4.</p>\n"}, {"tags": ["ruby", "rvm", "ruby-on-rails-5", "rbenv"], "answers": [{"tags": [], "owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "is_accepted": false, "score": 0, "last_activity_date": 1505946772, "creation_date": 1505946772, "answer_id": 46332710, "question_id": 46332633, "link": "https://stackoverflow.com/questions/46332633/getting-rbenv-error-on-site-that-uses-rvm/46332710#46332710", "title": "Getting Rbenv Error on Site That Uses RVM", "body": "<p>This was dumb. I just ran rvm use 2.4.1 even though it said that was what it was using, but it worked. Bundler ran fine after that.</p>\n"}], "owner": {"reputation": 1038, "user_id": 708964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gIRPQ.png?s=128&g=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/708964/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505946772, "creation_date": 1505946241, "question_id": 46332633, "link": "https://stackoverflow.com/questions/46332633/getting-rbenv-error-on-site-that-uses-rvm", "title": "Getting Rbenv Error on Site That Uses RVM", "body": "<p>I have a Rails 5.1.3 project I have been working on for quite some time, but had to take a little time off. I came back to it today to do some more work on it, but it's giving me a rbenv error. The strange thing is I have never used rbenv with this site, only rvm. Here is the error, which comes up when I run bundle install:</p>\n\n<pre><code>rbenv: version `2.4.1' is not installed\n</code></pre>\n\n<p>I have no idea why this would come up. When I run \"which ruby\" I get this (which is obviously pointing to my rvm):</p>\n\n<pre><code>/Users/username/.rvm/rubies/ruby-2.4.1/bin/ruby\n</code></pre>\n\n<p>This is the correct version of Ruby for this project. I'm not sure what is happening. I am running this on a MacOS Sierra.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 96, "user_id": 5945430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6RoBd.png?s=128&g=1", "display_name": "Ranjan", "link": "https://stackoverflow.com/users/5945430/ranjan"}, "edited": false, "score": 0, "creation_date": 1505946017, "post_id": 46332493, "comment_id": 79625986, "body": "hey, but your code inside merge part is missing, how should it fetch <code>network.pic.url</code> if you <code>map</code> it by <code>|post|</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 96, "user_id": 5945430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6RoBd.png?s=128&g=1", "display_name": "Ranjan", "link": "https://stackoverflow.com/users/5945430/ranjan"}, "edited": false, "score": 0, "creation_date": 1505946219, "post_id": 46332493, "comment_id": 79626042, "body": "It&#39;ll work just the same as <code>network</code> is valid in that context. It&#39;s only removed for brevity."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1505946244, "last_edit_date": 1505946244, "creation_date": 1505945341, "answer_id": 46332493, "question_id": 46332467, "link": "https://stackoverflow.com/questions/46332467/undefined-method-merge-for-array/46332493#46332493", "title": "Undefined method `merge&#39; for Array", "body": "<p>The <code>as_json</code> method is not obligated to return a Hash. It can return anything it wants, a string, a number, a boolean value, or even, as in this case, an array. Assuming it supports <code>merge</code> is a mistake.</p>\n\n<p>Since this appears to be operating on a collection (<code>network.posts</code>) that will be an array. Merging that in isn't practical. You could merge in on each record's <code>as_json</code> result:</p>\n\n<pre><code>network.posts.map do |post|\n   post.as_json.merge(...)\nend\n</code></pre>\n"}], "owner": {"reputation": 96, "user_id": 5945430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6RoBd.png?s=128&g=1", "display_name": "Ranjan", "link": "https://stackoverflow.com/users/5945430/ranjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2649, "favorite_count": 0, "accepted_answer_id": 46332493, "answer_count": 1, "score": 0, "last_activity_date": 1533839616, "creation_date": 1505945205, "last_edit_date": 1533839616, "question_id": 46332467, "link": "https://stackoverflow.com/questions/46332467/undefined-method-merge-for-array", "title": "Undefined method `merge&#39; for Array", "body": "<p>I am getting undefined method <code>#merge</code> however <code>#merge</code> method works good in the second block. What's wrong with Block 1?</p>\n\n<pre><code># Block 1\nnetwork_posts = []\n@networks.each do |network|\n  network_posts &lt;&lt; network.posts.as_json.merge('pic' =&gt; network.pic.url) \nend\n</code></pre>\n\n\n\n<pre><code># Block 2\nnetwork = []\n@networks.each do |network|\n  network &lt;&lt; network.as_json.merge('pic' =&gt; network.pic.url) \nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1505944082, "post_id": 46332167, "comment_id": 79625248, "body": "That shouldn&#39;t work, it&#39;s not valid Ruby code."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 1, "creation_date": 1505944458, "post_id": 46332167, "comment_id": 79625391, "body": "I tried your code after the edit in irb and it works fine"}, {"owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1505947615, "post_id": 46332167, "comment_id": 79626484, "body": "@Ursus Figured out why it wasn&#39;t working. Was a bug in other code that created the hash that someone else wrote. I never used ruby before so I thought maybe copying sub-hashes wasn&#39;t allowed. Thanks for your help."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1505947673, "post_id": 46332167, "comment_id": 79626501, "body": "No problem, I knew this code was fine :)"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1505944131, "post_id": 46332232, "comment_id": 79625264, "body": "Yeah, <code>&quot;a&quot;: 1</code> and <code>a: 1</code> are identical, even though that&#39;s counter-intuitive."}, {"owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "edited": false, "score": 0, "creation_date": 1505944345, "post_id": 46332232, "comment_id": 79625348, "body": "the first block wasn&#39;t my actual code, I just wrote it on the spot (in json-like representation to show an example of what I wanted to do. I&#39;ll edit original post."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 3, "last_activity_date": 1505944002, "creation_date": 1505944002, "answer_id": 46332232, "question_id": 46332167, "link": "https://stackoverflow.com/questions/46332167/how-do-i-assign-part-of-a-hash-to-another-variable/46332232#46332232", "title": "How do I assign part of a hash to another variable?", "body": "<p>If you want string keys you have to use this syntax</p>\n\n<pre><code>hash = {\n    \"cupcake\" =&gt; {\n        \"a\" =&gt; 1\n    },\n    \"muffin\" =&gt; {\n        \"b\" =&gt; 2\n    }\n}\n</code></pre>\n\n<p>Syntax with colons is for symbol keys</p>\n\n<pre><code>hash = {\n  cupcake: {\n    a: 1\n  },\n  muffin: {\n    b: 2\n  }\n}\n\ncupcake = hash[:cupcake]\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505944387, "creation_date": 1505943650, "last_edit_date": 1505944387, "question_id": 46332167, "link": "https://stackoverflow.com/questions/46332167/how-do-i-assign-part-of-a-hash-to-another-variable", "title": "How do I assign part of a hash to another variable?", "body": "<p>Trying to assign part of a has to another variable. I have a hash. Something like:</p>\n\n<pre><code>hash = {\n    \"cupcake\" =&gt; {\n        \"a\" =&gt; 1\n    },\n    \"muffin\" =&gt; {\n        \"b\" =&gt; 2\n    }\n}\n</code></pre>\n\n<p>When I do something like:</p>\n\n<pre><code>cupcake = hash[\"cupcake\"]\n</code></pre>\n\n<p><strong>cupcake</strong> is <strong>nil</strong> after this code.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 4, "creation_date": 1505940652, "post_id": 46331519, "comment_id": 79623864, "body": "What characters would you consider <i>three letters right</i> of <code>&gt;</code>,  <code>?</code> or <code>@</code>?"}, {"owner": {"reputation": 21, "user_id": 8266373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249c312d2aa8248d8d9aeb05a0585e2e?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan Cook", "link": "https://stackoverflow.com/users/8266373/morgan-cook"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1506029379, "post_id": 46331519, "comment_id": 79666999, "body": "@spickermann Hi! I&#39;m using the ASCii codes for each symbol. Using that, &gt; is equal to 62, ? is equal to 63, and @ is equal to 64. Adding 3 to each would gives us 65 (&quot;A&quot;), 66 (&quot;B&quot;) and 67 (&quot;C&quot;)."}], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 4753286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lOZjyFpingw/AAAAAAAAAAI/AAAAAAAAABE/iGhrsGFbKgw/photo.jpg?sz=128", "display_name": "Oscar Luza", "link": "https://stackoverflow.com/users/4753286/oscar-luza"}, "is_accepted": false, "score": 1, "last_activity_date": 1505943625, "creation_date": 1505943625, "answer_id": 46332160, "question_id": 46331519, "link": "https://stackoverflow.com/questions/46331519/creating-a-cipher-code-in-ruby/46332160#46332160", "title": "Creating a Cipher Code in Ruby", "body": "<p>You should create an alphabet variable, just think in if you use both ends then you will have 2 problems: negative numbers and an ASCii number that doesn't exist. You can handle this with module operator % or with a single subtraction.</p>\n\n<pre><code>alphabet = \"abcde\"\n\ntext_to_cipher= \"aaee\" =&gt; 0044 #number based in his position at aphabet var\nkey = 3\n</code></pre>\n\n<p>result will be 3377 => dd\u00a1? or any other symbol since 7 is out of the string length \"abcde\" same happens with ASCii at its ends.\nWith module operator, you can restrict that.</p>\n\n<pre><code>size_of_your_alphabet = 5 # For this case\n7%size_of_your_alphabet = 2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1506108540, "last_edit_date": 1506108540, "creation_date": 1505960114, "answer_id": 46334376, "question_id": 46331519, "link": "https://stackoverflow.com/questions/46331519/creating-a-cipher-code-in-ruby/46334376#46334376", "title": "Creating a Cipher Code in Ruby", "body": "<p>The Ruby builtin <code>tr</code> is ideal to implement substitution ciphers.</p>\n\n<p><strong>Step 1: assemble the characters you wish to transform.</strong></p>\n\n<pre><code>chars = [\"A\"..\"Z\", \"a\"..\"z\", \"&gt;\"..\"@\"].flat_map(&amp;:to_a)\n</code></pre>\n\n<p><strong>Step 2: create a 1:1 array of the transformed characters</strong></p>\n\n<pre><code>transformed = chars.map{|c| (c.ord + 3).chr}\n</code></pre>\n\n<p><strong>Step 3: apply <code>tr</code> to transform the string.</strong></p>\n\n<pre><code>str.tr(chars.join, transformed.join)\n</code></pre>\n\n<p><strong>Full working example:</strong></p>\n\n<pre><code>def caesar_cipher(str, num)\n  chars = [\"A\"..\"Z\", \"a\"..\"z\", \"&gt;\"..\"@\"].flat_map(&amp;:to_a)\n  transformed = chars.map{|c| (c.ord + num).chr}\n  str.tr(chars.join, transformed.join)\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&gt; caesar_cipher(\"Am I ill-prepared for this challenge?\", 3)\n#=&gt; \"Dq L mpp-tvitevih jsv xlmw gleppirkiC\"\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<ul>\n<li>Most substitution ciphers actually rely on letter rotation, not ASCII values. My inital assumption was that you wanted a rotation, e.g. <code>(\"a\"..\"z\").to_a.rotate(num)</code>. See prior edit for a working example of that.</li>\n<li>You can use ranges in <code>tr()</code> to create a really simple Caesar cipher: <code>str.tr('A-Za-z','B-ZAb-za')</code></li>\n<li>Edit: Also, because of the range specification feature, the <code>\\</code> is an escape character so that you can use literals like <code>-</code>. See <a href=\"https://stackoverflow.com/a/5926633/182590\">this SO answer</a> for details. I think the above exhibits a bug due to this, because it contains a <code>\\</code> which should be escaped by another <code>\\</code>.</li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 8266373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249c312d2aa8248d8d9aeb05a0585e2e?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan Cook", "link": "https://stackoverflow.com/users/8266373/morgan-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1506108540, "creation_date": 1505940506, "question_id": 46331519, "link": "https://stackoverflow.com/questions/46331519/creating-a-cipher-code-in-ruby", "title": "Creating a Cipher Code in Ruby", "body": "<p>I'm tasked with creating a Caesar cipher for a project I am working on. A Caesar cipher takes each letter in a string of text and replaces it with a letter a fixed number of places away from it (dictated by the cipher key). For instance if my text is \"cat\" and my cipher key is 3, my new word would be \"fdw\" (I'm assuming positive numbers move the letters to the right). I've been able to get my code to solve correctly for most strings of text, but I am finding that if my string includes > ? or @ it will not work. Their ASCii codes are 62,63 and 64 if that helps. Any input is appreciated!</p>\n\n<pre><code>def caesar_cipher(str, num)\nstrArray = str.split('')\n\ncipherArray = strArray.collect do |letter|\n letter = letter.ord\n\n  if (65...90).include?(letter + num) || (97...122).include?(letter + num)\n    letter = letter + num\n  elsif (91...96).include?(letter + num) || (123...148).include?(letter + num)\n    letter = (letter - 26) + num\n  else\n    letter\n  end\n\nend\n\n cipherArray = cipherArray.collect {|x| x.chr}\n cipher = cipherArray.join('')\n\nend\n\n\ncaesar_cipher(\"Am I ill-prepared for this challenge?\", 3)\n#ord 62-64 DON'T work &gt;, ?, @\n</code></pre>\n"}, {"tags": ["ruby", "variables", "reference"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 5474201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1ac3d0de5e843f37adb85d742695a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Spectator6", "link": "https://stackoverflow.com/users/5474201/spectator6"}, "edited": false, "score": 0, "creation_date": 1505941292, "post_id": 46331573, "comment_id": 79624154, "body": "Thank you very much Max! I never thought of duplicating the variable to essentially create a new object. That&#39;s brilliant!"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 313, "user_id": 5474201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1ac3d0de5e843f37adb85d742695a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Spectator6", "link": "https://stackoverflow.com/users/5474201/spectator6"}, "edited": false, "score": 1, "creation_date": 1505941437, "post_id": 46331573, "comment_id": 79624222, "body": "You&#39;re welcome. Though to be clear, this is duplicating the <i>object pointed to</i> by the variable. Not the variable itself. Ruby doesn&#39;t have variable references like some other programming languages."}, {"owner": {"reputation": 313, "user_id": 5474201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1ac3d0de5e843f37adb85d742695a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Spectator6", "link": "https://stackoverflow.com/users/5474201/spectator6"}, "edited": false, "score": 0, "creation_date": 1505942383, "post_id": 46331573, "comment_id": 79624633, "body": "Thank you for clarifying! So by calling dup, it&#39;s essentially forcing a new pointer object to be made each time, thereby giving it &quot;room&quot; to store unique string values? <i>mind blown</i>"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 313, "user_id": 5474201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1ac3d0de5e843f37adb85d742695a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Spectator6", "link": "https://stackoverflow.com/users/5474201/spectator6"}, "edited": false, "score": 1, "creation_date": 1506003228, "post_id": 46331573, "comment_id": 79652664, "body": "It doesn&#39;t just make a new pointer, it duplicates the string object and returns a pointer to that new object. It&#39;s not really about having &quot;room&quot; either. Anything that &quot;stores&quot; an object (a variable, array, hash, instance variable, constant, etc.) just stores a pointer to that object without caring what object is being pointed to."}, {"owner": {"reputation": 313, "user_id": 5474201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1ac3d0de5e843f37adb85d742695a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Spectator6", "link": "https://stackoverflow.com/users/5474201/spectator6"}, "edited": false, "score": 0, "creation_date": 1506130130, "post_id": 46331573, "comment_id": 79709573, "body": "Your answers got me reading about pointers and now what you&#39;re saying now makes perfect sense! Thank you for teaching me something Max, much appreciated!"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1505940767, "creation_date": 1505940767, "answer_id": 46331573, "question_id": 46331376, "link": "https://stackoverflow.com/questions/46331376/how-to-properly-reference-a-particular-state-in-a-changing-array-value/46331573#46331573", "title": "How to properly reference a particular state in a changing array value?", "body": "<p>There is no way to do this without changing the way you use your objects. Ruby references objects using pointers which are passed by value. So in your example the VM does the following</p>\n\n<ol>\n<li>Allocate an object for <code>\"String\"</code>, store a pointer to it in the variable <code>a</code></li>\n<li>Copy the pointer from <code>a</code> and add it to the end of <code>collection_of_strings</code></li>\n<li>Repeat previous two more times</li>\n</ol>\n\n<p>So at the end you get an array containing three identical pointers all pointing at the same object. If <code>some_additive_method</code> modifies that object in place, you will see the change reflected across every pointer to that object: <code>a</code> and all the elements of <code>collection_of_strings</code>. You have to change your code so that you end up with references to different objects e.g.</p>\n\n<pre><code>collection_of_strings = []\na = \"String\"\ncollection_of_strings &lt;&lt; a.dup\na.some_additive_method\ncollection_of_strings &lt;&lt; a.dup\na.some_other_additive_method\ncollection_of_strings &lt;&lt; a.dup\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 5474201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1ac3d0de5e843f37adb85d742695a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Spectator6", "link": "https://stackoverflow.com/users/5474201/spectator6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 46331573, "answer_count": 1, "score": 0, "last_activity_date": 1505940767, "creation_date": 1505939862, "question_id": 46331376, "link": "https://stackoverflow.com/questions/46331376/how-to-properly-reference-a-particular-state-in-a-changing-array-value", "title": "How to properly reference a particular state in a changing array value?", "body": "<p>In Ruby, how can the state of a referenced object be saved without it being updated along with the original object? As a rough example...</p>\n\n<pre><code>collection_of_strings = []\na = \"String\"\ncollection_of_strings &lt;&lt; a\na.some_additive_method              #=&gt; \"New String\"\ncollection_of_strings &lt;&lt; a \na.some_other_additive_method        #=&gt; \"Another New String\"\ncollection_of_strings &lt;&lt; a\n\ncollection_of_strings.each do |s|\n  puts s\nend\n\n#=&gt; [\"Another New String\", \"Another New String\", \"Another New String\"]\n</code></pre>\n\n<p>Instead, I'm wondering how can the state be preserved each time so that the final result becomes </p>\n\n<pre><code>#=&gt; [\"String\", \"New String\", \"Another New String\"]\n</code></pre>\n\n<p>I know this is an awfully generic question, so if there are any books are resources that address this, that'd be great too! Thank you in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1505942178, "post_id": 46331034, "comment_id": 79624551, "body": "Not sure what you&#39;re trying to do here. Are you trying to generate the url to download the image?"}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1505946787, "post_id": 46331034, "comment_id": 79626245, "body": "you can get the image link with helper <code>image_url</code> or <code>image_path</code> if you don&#39;t need an absolute link. Then you can allow the user to click on the image using the helper <code>link_to</code> and first element is an <code>&#236;mage_tag</code> and second element is an <code>&#236;mage_url</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1105, "user_id": 391122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/63c655bc5282d3f343574aef29de460a?s=128&d=identicon&r=PG", "display_name": "Jared", "link": "https://stackoverflow.com/users/391122/jared"}, "is_accepted": true, "score": 2, "last_activity_date": 1506374200, "creation_date": 1506374200, "answer_id": 46414321, "question_id": 46331034, "link": "https://stackoverflow.com/questions/46331034/get-public-asset-image-link-from-rails-5/46414321#46414321", "title": "Get Public Asset Image Link From Rails 5", "body": "<p>You can use \n<code>asset_url('my_image.png', type: :image)</code> or <code>image_url('my_image.png')</code> to get the hashed URL for your assets.</p>\n\n<p>If it is not giving you the hash after the asset then Rails did not find that asset.  Either you have a typo in your string or the asset does not exist.\n<code>image_url('my_iamge.png')</code> will link to <code>localhost:3000/assets/my_iamge.png</code>\nSo double check those if you are still not getting the compiled asset you expect.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1846, "favorite_count": 0, "accepted_answer_id": 46414321, "answer_count": 1, "score": 1, "last_activity_date": 1506374200, "creation_date": 1505938408, "last_edit_date": 1506102661, "question_id": 46331034, "link": "https://stackoverflow.com/questions/46331034/get-public-asset-image-link-from-rails-5", "title": "Get Public Asset Image Link From Rails 5", "body": "<p>I'm trying to generate an xml file for Google Product Feed. In the xml file I want to display a link to the product image. The code</p>\n\n<pre><code>image_tag(\"image.png\") \n</code></pre>\n\n<p>works fine in my view to display the image in the browser. However I need to get the link to the asset. After running</p>\n\n<pre><code>rake assets:precompile\n</code></pre>\n\n<p>rails 5 generates the assets folder in my public folder with the image renamed with a hash. So going to mydomain.com/assets/image.png doesn't work However going to mydomain.com/assets/imagewithhash.png does work. </p>\n\n<p>I've tried using </p>\n\n<pre><code>image_path(\"image.png\") \n</code></pre>\n\n<p>to get the hashed image name but this doesn't work. This returns </p>\n\n<pre><code>/assets/image.png\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>/assets/imagewithhash.png\n</code></pre>\n\n<p>which is what I need. Can anyone help with this issue? </p>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "selenium", "rubygems"], "comments": [{"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 1, "creation_date": 1505944343, "post_id": 46330780, "comment_id": 79625346, "body": "See: <a href=\"https://meta.stackoverflow.com/questions/253069/whats-the-appropriate-new-current-close-reason-for-how-do-i-do-x\">How do I do X?</a> The expectation on SO is that the user asking a question not only does research to answer their own question but also shares that research, code attempts, and results. This demonstrates that you\u2019ve taken the time to try to help yourself, it saves us from reiterating obvious answers, and most of all it helps you get a more specific and relevant answer! See also: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1505939040, "post_id": 46330829, "comment_id": 79623166, "body": "<code>watir-webdriver</code> is deprcated.  Here&#39;s a link to <code>watir</code>: <a href=\"https://github.com/watir/watir\" rel=\"nofollow noreferrer\">github.com/watir/watir</a>"}, {"owner": {"reputation": 13, "user_id": 7842065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e606bb4a16c8b42c7bfb9cda0cb7612?s=128&d=identicon&r=PG&f=1", "display_name": "alkanulutas", "link": "https://stackoverflow.com/users/7842065/alkanulutas"}, "edited": false, "score": 0, "creation_date": 1506033485, "post_id": 46330829, "comment_id": 79668339, "body": "thank you. when i install last version of watir and selenium, it is fixed."}, {"owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "reply_to_user": {"reputation": 13, "user_id": 7842065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e606bb4a16c8b42c7bfb9cda0cb7612?s=128&d=identicon&r=PG&f=1", "display_name": "alkanulutas", "link": "https://stackoverflow.com/users/7842065/alkanulutas"}, "edited": false, "score": 0, "creation_date": 1506079799, "post_id": 46330829, "comment_id": 79686471, "body": "@alkanulutas Don&#39;t forget to mark a question as answered, there is a sign <code>V</code> under the answer&#39;s score."}], "tags": [], "owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "is_accepted": false, "score": 2, "last_activity_date": 1505937897, "last_edit_date": 1505937897, "creation_date": 1505937568, "answer_id": 46330829, "question_id": 46330780, "link": "https://stackoverflow.com/questions/46330780/i-got-fixnum-is-deprecated-when-i-ran-ruby-project/46330829#46330829", "title": "I got Fixnum is deprecated when I ran Ruby project", "body": "<p><code>Fixnum</code> is deprecated indeed.</p>\n\n<p>Ruby 2.4 unifies <code>Fixnum</code> and <code>Bignum</code> into <code>Integer</code>.</p>\n\n<p>It seems gem <code>watir-webdriver</code> is not adapted to Ruby 2.4.</p>\n\n<p>In fact last release is <strong>0.9.9</strong> from <strong>November 09, 2016</strong>.</p>\n"}], "owner": {"reputation": 13, "user_id": 7842065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e606bb4a16c8b42c7bfb9cda0cb7612?s=128&d=identicon&r=PG&f=1", "display_name": "alkanulutas", "link": "https://stackoverflow.com/users/7842065/alkanulutas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505937897, "creation_date": 1505937371, "question_id": 46330780, "link": "https://stackoverflow.com/questions/46330780/i-got-fixnum-is-deprecated-when-i-ran-ruby-project", "title": "I got Fixnum is deprecated when I ran Ruby project", "body": "<p>When I run my project, i got these warning. Do you have any idea about that?</p>\n\n<p>Thanks</p>\n\n<p>It has more than 100 rows, i just added one.</p>\n\n<p>C:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/watir-webdriver-0.9.9/lib/watir-webdriver/elements/html_elements.rb:17: warning: constant ::Fixnum is deprecated</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 423285, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e8965f41bb8b1d760c20f5dd999a09b9?s=128&d=identicon&r=PG", "display_name": "mpelzsherman", "link": "https://stackoverflow.com/users/423285/mpelzsherman"}, "edited": false, "score": 0, "creation_date": 1533520639, "post_id": 46330265, "comment_id": 90360773, "body": "Thanks, I ran into the exact same issue today, nearly a year later. Did you ever file an issue with the Rails team? I wonder if this has been fixed in Rails 5?"}], "tags": [], "owner": {"reputation": 4342, "user_id": 30952, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/545ad00b18225ed91a355f2ab2460d09?s=128&d=identicon&r=PG", "display_name": "executor21", "link": "https://stackoverflow.com/users/30952/executor21"}, "is_accepted": false, "score": 9, "last_activity_date": 1505935444, "creation_date": 1505935444, "answer_id": 46330265, "question_id": 46330264, "link": "https://stackoverflow.com/questions/46330264/creating-new-ruby-on-rails-app-in-existing-directory/46330265#46330265", "title": "Creating new Ruby on Rails app in existing directory", "body": "<p>After fruitless online searches for the same problem, I went straight to the reported source: Line 97 of /Library/Ruby/Gems/2.0.0/gems/railties-4.0.2/lib/rails/generators/app_base.rb. That line looks like this:</p>\n\n<p><code>FileUtils.cd(destination_root) unless options[:pretend]</code></p>\n\n<p>According to the error message, it can't find <code>FileUtils</code>, treating it as an uninitialized constant. This line is also the only place in the app_base.rb file that uses <code>FileUtils</code>. </p>\n\n<p>I went to the top of the file and added <code>require 'fileutils'</code> to its requirements. I saved it (this required the admin password), and <code>rails new .</code> worked perfectly.</p>\n\n<p>While this fixes the immediate problem, I still have questions. Was this always there, and I haven't noticed, or did it appear after an upgrade as I surmised (most likely from Ruby 1.8 or 1.9 to Ruby 2.0). What changed to cause it?</p>\n"}], "owner": {"reputation": 4342, "user_id": 30952, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/545ad00b18225ed91a355f2ab2460d09?s=128&d=identicon&r=PG", "display_name": "executor21", "link": "https://stackoverflow.com/users/30952/executor21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2176, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1548988465, "creation_date": 1505935444, "question_id": 46330264, "link": "https://stackoverflow.com/questions/46330264/creating-new-ruby-on-rails-app-in-existing-directory", "title": "Creating new Ruby on Rails app in existing directory", "body": "<p>I've been away from Ruby on Rails development for sometime, going through several system updates. This occurred on Mac OS X Sierra, with its system version of Ruby (2.0.0p648), and Rails 4.0.2.</p>\n\n<p>Creating a new app (<code>rails new appname</code>) works fine when the <code>appname</code> directory doesn't exist---the command creates the app and populates it as it should. However, despite what all the guidebooks and tutorials say, it fails when such a directory exists (even when it's empty). You also can't create an empty directory, cd into it, and run <code>rails new .</code></p>\n\n<p>The output of the failed command looks like this:</p>\n\n<blockquote>\n  <p>exist<br>\n  /Library/Ruby/Gems/2.0.0/gems/railties-4.0.2/lib/rails/generators/app_base.rb:97:in\n  <code>create_root': uninitialized constant\n  Rails::Generators::AppBase::FileUtils (NameError)     from (eval):1:in\n  </code>create_root'     from\n  /Library/Ruby/Gems/2.0.0/gems/thor-0.20.0/lib/thor/command.rb:27:in\n  <code>run'     from\n  /Library/Ruby/Gems/2.0.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in\n  </code>invoke_command'  from\n  /Library/Ruby/Gems/2.0.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in\n  <code>block in invoke_all'     from\n  /Library/Ruby/Gems/2.0.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in\n  </code>each'    from\n  /Library/Ruby/Gems/2.0.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in\n  <code>map'     from\n  /Library/Ruby/Gems/2.0.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in\n  </code>invoke_all'  from\n  /Library/Ruby/Gems/2.0.0/gems/thor-0.20.0/lib/thor/group.rb:232:in\n  <code>dispatch'    from\n  /Library/Ruby/Gems/2.0.0/gems/thor-0.20.0/lib/thor/base.rb:466:in\n  </code>start'   from\n  /Library/Ruby/Gems/2.0.0/gems/railties-4.0.2/lib/rails/commands/application.rb:43:in\n  <code>&lt;top (required)&gt;'    from\n  /Library/Ruby/Site/2.0.0/rubygems/core_ext/kernel_require.rb:68:in\n  </code>require'     from\n  /Library/Ruby/Site/2.0.0/rubygems/core_ext/kernel_require.rb:68:in\n  <code>require'     from\n  /Library/Ruby/Gems/2.0.0/gems/railties-4.0.2/lib/rails/cli.rb:15:in\n  </code>'    from\n  /Library/Ruby/Site/2.0.0/rubygems/core_ext/kernel_require.rb:68:in\n  <code>require'     from\n  /Library/Ruby/Site/2.0.0/rubygems/core_ext/kernel_require.rb:68:in\n  </code>require'     from\n  /Library/Ruby/Gems/2.0.0/gems/railties-4.0.2/bin/rails:9:in <code>&lt;top\n  (required)&gt;'  from /usr/bin/rails:22:in</code>load'    from\n  /usr/bin/rails:22:in `'</p>\n</blockquote>\n\n<p>How do I get rails to be able to create the app in an existing directory?</p>\n"}, {"tags": ["ruby", "jruby"], "comments": [{"owner": {"reputation": 1, "user_id": 1899552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94ef202948c832e0a22499ebb69e928c?s=128&d=identicon&r=PG", "display_name": "Shiv", "link": "https://stackoverflow.com/users/1899552/shiv"}, "edited": false, "score": 0, "creation_date": 1505936016, "post_id": 46330247, "comment_id": 79621592, "body": "UPDATE: the following approach worked: System.out.println((engine.eval(&quot;Test::update(a,b)&quot;, bindings)));"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1505942294, "post_id": 46330247, "comment_id": 79624601, "body": "you can make your own answer."}], "owner": {"reputation": 1, "user_id": 1899552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94ef202948c832e0a22499ebb69e928c?s=128&d=identicon&r=PG", "display_name": "Shiv", "link": "https://stackoverflow.com/users/1899552/shiv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505936098, "creation_date": 1505935394, "last_edit_date": 1505936098, "question_id": 46330247, "link": "https://stackoverflow.com/questions/46330247/calling-ruby-modules-method-from-java", "title": "Calling ruby module&#39;s method from java", "body": "<p>Have a simple ruby module code like this in test.rb:</p>\n\n<pre><code>module Test\ndef self.update(a,b)\n  \"Hello world\"+a+b\nend\nend\n</code></pre>\n\n<p>then I wrote java code like this:</p>\n\n<pre><code>public static void main(String[] args) throws FileNotFoundException, ScriptException, NoSuchMethodException {\n\nSystem.setProperty(\"org.jruby.embed.localvariable.behavior\", \"transient\");\nScriptEngineManager manager = new ScriptEngineManager();\nScriptEngine engine = manager.getEngineByName(\"jruby\");\nReader reader = new FileReader(\"/temp/test.rb\");\nObject receiver = engine.eval(reader);\nSystem.out.println((engine.eval(\"Test::update\")));\n}\n</code></pre>\n\n<p>This code printed \"Hello World\" as expected but I tried various ways to pass the parameters to the method like:</p>\n\n<pre><code>SimpleBindings bindings = new SimpleBindings();\nbindings.put(\"a\", 1);\nbindings.put(\"b\", 2);\nSystem.out.println((engine.eval(\"Test::update\", bindings)));\n</code></pre>\n\n<p>I could not able to pass arguments, how do we pass arguments to a module's method from java? </p>\n\n<p>UPDATE: The following approached worked:</p>\n\n<pre><code>System.out.println((engine.eval(\"Test::update(a,b)\", bindings)));\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash", "hashmap", "hashtable"], "comments": [{"owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "edited": false, "score": 1, "creation_date": 1505935438, "post_id": 46330186, "comment_id": 79621301, "body": "Obviously you need to create a new hash. How do you imagine it could work otherwise?"}, {"owner": {"reputation": 189, "user_id": 3978752, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e66d75a76c4af053305b0e2021788e7?s=128&d=identicon&r=PG&f=1", "display_name": "Rares R", "link": "https://stackoverflow.com/users/3978752/rares-r"}, "reply_to_user": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "edited": false, "score": 0, "creation_date": 1505935530, "post_id": 46330186, "comment_id": 79621350, "body": "@DanilSperansky well I thought that we can work with the initial hash and just modify 1 key."}, {"owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "edited": false, "score": 1, "creation_date": 1505935642, "post_id": 46330186, "comment_id": 79621403, "body": "But you want to have an array with 5 different hashes in the end. They have to be created somehow at some point."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1505935720, "post_id": 46330186, "comment_id": 79621441, "body": "You can&#39;t magically create a bunch of pointers to a &quot;slightly different&quot; object in Ruby. Either you have a reference to the exact same object or you have 5 different objects."}, {"owner": {"reputation": 189, "user_id": 3978752, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e66d75a76c4af053305b0e2021788e7?s=128&d=identicon&r=PG&f=1", "display_name": "Rares R", "link": "https://stackoverflow.com/users/3978752/rares-r"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1505936017, "post_id": 46330186, "comment_id": 79621593, "body": "@max Is is very logical... data is referencing to the same hash, doesn&#39;t matter if we modify it. We have an array with 5 hash (the same hashes)."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1505936334, "post_id": 46330186, "comment_id": 79621750, "body": "Thats not how it works. I can&#39;t really see why you be outputting a hash in api response anyways that was big enough for this to be a problem."}], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1505937177, "creation_date": 1505937177, "answer_id": 46330723, "question_id": 46330186, "link": "https://stackoverflow.com/questions/46330186/ruby-hash-key-reference/46330723#46330723", "title": "Ruby Hash Key Reference", "body": "<p>You can't.</p>\n\n<p>References in Ruby (and in almost every other programming language) point to a single object in memory.</p>\n\n<pre><code>irb(main):004:0&gt; h = { foo: :bar }\n=&gt; {:foo=&gt;:bar}\nirb(main):005:0&gt; h.object_id\n=&gt; 70125571572420\n</code></pre>\n\n<p>As long as I mutate <code>h</code> I'm still working with same reference:</p>\n\n<pre><code>irb(main):006:0&gt; h[:bar] = 'baz'\n=&gt; \"baz\"\nirb(main):007:0&gt; h.object_id\n=&gt; 70125571572420\n</code></pre>\n\n<p>If I want a slightly different version of <code>h</code> without changing <code>h</code> it will be stored as a separate object of course:</p>\n\n<pre><code>h.merge(x: 2).object_id\n=&gt; 70125567041320\n</code></pre>\n\n<p><code>.merge</code> in this case duplicates the hash and returns the result of merging it with args. </p>\n\n<p>There is no way around this. Hashes in Ruby cannot \"inherit\" from a reference.</p>\n"}], "owner": {"reputation": 189, "user_id": 3978752, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e66d75a76c4af053305b0e2021788e7?s=128&d=identicon&r=PG&f=1", "display_name": "Rares R", "link": "https://stackoverflow.com/users/3978752/rares-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1040, "favorite_count": 0, "accepted_answer_id": 46330723, "answer_count": 1, "score": 0, "last_activity_date": 1505937177, "creation_date": 1505935196, "last_edit_date": 1505935448, "question_id": 46330186, "link": "https://stackoverflow.com/questions/46330186/ruby-hash-key-reference", "title": "Ruby Hash Key Reference", "body": "<p>Hello I have a custom Hash that needs to be returned in an API. But currently I'm struggling to find a good way to do so. The following example will describe the problem.</p>\n\n<p>Lets say we have the following code:</p>\n\n<pre><code>data = {name: \"Jon\", value: \"13\"}\nresults = []\n\n[1, 2, 3, 4, 5].each do |i|\n  data[:id] = i\n  results &lt;&lt; data\nend\n\n# output \n# results = [{name: \"Jon\", value: \"13\", id: 5}, {name: \"Jon\", value: \"13\", id: 5}, {name: \"Jon\", value: \"13\", id: 5}, {name: \"Jon\", value: \"13\", id: 5}, {name: \"Jon\", value: \"13\", id: 5}]\n</code></pre>\n\n<p>I expected something like this:</p>\n\n<pre><code># results = [{name: \"Jon\", value: \"13\", id: 1}, {name: \"Jon\", value: \"13\", id: 2}, {name: \"Jon\", value: \"13\", id: 3}, {name: \"Jon\", value: \"13\", id: 4}, {name: \"Jon\", value: \"13\", id: 5}]\n</code></pre>\n\n<p>How can I achieve this format efficiently (memory usage)?\nThe following code fixes the reference issue (because it creates a new hash) but is inefficient, because my initial hash 'data' is really big.</p>\n\n<pre><code># inefficient but working\n[1, 2, 3, 4, 5].each do |i|\n  data[:id] = i\n  results &lt;&lt; data.dup\nend\n\n# output\n# results = [{name: \"Jon\", value: \"13\", id: 1}, {name: \"Jon\", value: \"13\", id: 2}, {name: \"Jon\", value: \"13\", id: 3}, {name: \"Jon\", value: \"13\", id: 4}, {name: \"Jon\", value: \"13\", id: 5}]\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby", "loops"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1505935795, "post_id": 46329883, "comment_id": 79621481, "body": "Your question is unclear. You wrote an infinite loop, then you complain &quot;the loop never finishes&quot; (Yes, of course, it doesn&#39;t finish, it is an <i>infinite</i> loop), and then you say you want the command to be executed every 10 minutes, which means that you don&#39;t want the loop to finish?"}, {"owner": {"reputation": 37, "user_id": 8544981, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/97a54206de23e202b0641b7a71d3cc4e?s=128&d=identicon&r=PG&f=1", "display_name": "flow daguerre", "link": "https://stackoverflow.com/users/8544981/flow-daguerre"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1505941543, "post_id": 46329883, "comment_id": 79624257, "body": "Yes i miss some crucial point in my question sorry.I just want to be able to do the same code in ruby like in my bash code.Call a command every 10 minutes but without problem following the others commands in the script.Sorry again."}], "answers": [{"comments": [{"owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "edited": false, "score": 0, "creation_date": 1506347259, "post_id": 46330005, "comment_id": 79771183, "body": "@flowdaguerre Does it help?"}], "tags": [], "owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "is_accepted": false, "score": 0, "last_activity_date": 1505934573, "creation_date": 1505934573, "answer_id": 46330005, "question_id": 46329883, "link": "https://stackoverflow.com/questions/46329883/ruby-netx-command-after-while-loop/46330005#46330005", "title": "Ruby netx command after while loop", "body": "<p>If I understand right you want to create a thread:</p>\n\n<pre><code>Thread.new do\n  while true\n    sleep(1)\n    puts 'inside'\n  end\nend\n\nputs 'outside'\nsleep(3)\n</code></pre>\n\n<p>And output:</p>\n\n<pre><code>outside\ninside\ninside\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8544981, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/97a54206de23e202b0641b7a71d3cc4e?s=128&d=identicon&r=PG&f=1", "display_name": "flow daguerre", "link": "https://stackoverflow.com/users/8544981/flow-daguerre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505935451, "creation_date": 1505934123, "question_id": 46329883, "link": "https://stackoverflow.com/questions/46329883/ruby-netx-command-after-while-loop", "title": "Ruby netx command after while loop", "body": "<p>I try to launch one command using while loop and the continue my script, but the loop never finish.Condition is <code>true</code> i don't want to put <code>false</code> because the command has to be executed every 10 minutes.</p>\n\n<pre><code>while true\n  pid = spawn('xterm -e command')\nsleep 600\nProcess.kill('TERM', pid)\n end\n</code></pre>\n\n<p>The same bash code work fine because i can execute the next commands of the script using <code>&amp;</code> after <code>done</code></p>\n\n<pre><code>while : ; do\n        xterm -e command ; sleep 600 ; done &amp;\n        echo $! &gt;/tmp/mycommand.pid\n</code></pre>\n\n<p>In ruby does the end statement block the script in my loop ? or the <code>true</code> value is not appropriate here ? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "rspec"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1505934918, "post_id": 46329809, "comment_id": 79621033, "body": "The CSS selector <code>&#39;g:shipping_weight&#39;</code> is not valid as <code>:</code> is used for psuedo-selectors such as <code>:hover</code>. I&#39;m not aware of any way to target such custom XML elements with css selectors. You might want to try using find_xpath instead."}], "answers": [{"tags": [], "owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "is_accepted": false, "score": 0, "last_activity_date": 1506040554, "creation_date": 1506040554, "answer_id": 46355165, "question_id": 46329809, "link": "https://stackoverflow.com/questions/46329809/how-to-match-a-custom-tag-name-with-special-characters/46355165#46355165", "title": "how to match a custom tag name with special characters?", "body": "<p>I hit this problem a few months ago and spent hours Googling before I found the solution. Assuming you are parsing with Nokogiri here, you should able to access the text of this attribute as follows:</p>\n\n<pre><code>response.body.at_css(\"g|shipping_weight\").text\n</code></pre>\n\n<p>That's right, you use a pipe, <code>|</code>, in place of the colon. I don't think I ever found documentation of this, and I can't now find the example that led me to try this. But it works!</p>\n\n<p>(Note that you will have had to define the <code>g</code> namespace at the start of the XML document.)</p>\n"}], "owner": {"reputation": 135, "user_id": 1647512, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fhTwL.jpg?s=128&g=1", "display_name": "gerald", "link": "https://stackoverflow.com/users/1647512/gerald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506040554, "creation_date": 1505933861, "question_id": 46329809, "link": "https://stackoverflow.com/questions/46329809/how-to-match-a-custom-tag-name-with-special-characters", "title": "how to match a custom tag name with special characters?", "body": "<p>I'm trying to add an rspec to test an xml file i am building.  In the actual xml code, i have:</p>\n\n<pre><code>&lt;g:shipping_weight&gt;5 lb&lt;/g:shipping_weight&gt;\n</code></pre>\n\n<p>I just want to make sure that the value is as i am expecting, but rspec just can't match the tag if it has special characters in it.  a snippet from my spec:</p>\n\n<pre><code>context 'verify weight' do\n  subject { response.body }\n  it { is_expected.to have_css('g:shipping_weight', text: '12.34 lb')}\nend\n</code></pre>\n\n<p><code>have_selector</code> and <code>have_tag</code> do not match the selector either, so i am relying on using <code>match</code> which works, but i'm sure there's a better way?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 5, "last_activity_date": 1505931653, "last_edit_date": 1505931653, "creation_date": 1505931187, "answer_id": 46329074, "question_id": 46328986, "link": "https://stackoverflow.com/questions/46328986/check-if-date-in-range/46329074#46329074", "title": "Check if date in range", "body": "<p>It works if you make it a date. Basically you are comparing <code>Time</code>s and <code>Date</code>s.</p>\n\n<pre><code>Range.new(Date.today, Date.today + 7).include?(date_time.to_date)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "is_accepted": false, "score": 2, "last_activity_date": 1505932708, "last_edit_date": 1505932708, "creation_date": 1505931200, "answer_id": 46329078, "question_id": 46328986, "link": "https://stackoverflow.com/questions/46328986/check-if-date-in-range/46329078#46329078", "title": "Check if date in range", "body": "<p>I think it's because you use <code>Time</code> and <code>Date</code> together.</p>\n\n<p>If time is important use this:</p>\n\n<pre><code>datetime = Time.new(2017, 9, 21, 15, 30)\n(Time.now..Time.now + 7.days).include?(datetime)\n</code></pre>\n\n<p>Otherwise use:</p>\n\n<pre><code>date = Date.new(2017, 9, 21)\n(Date.today..Date.today + 7).include?(date)\n</code></pre>\n\n<p>Note that you can use <code>7.days</code> only with included <code>ActiveSupport</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2090, "user_id": 5113690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cbKBX.png?s=128&g=1", "display_name": "m3characters", "link": "https://stackoverflow.com/users/5113690/m3characters"}, "is_accepted": false, "score": 0, "last_activity_date": 1505934701, "last_edit_date": 1505934701, "creation_date": 1505934330, "answer_id": 46329946, "question_id": 46328986, "link": "https://stackoverflow.com/questions/46328986/check-if-date-in-range/46329946#46329946", "title": "Check if date in range", "body": "<p>What you wrote would not check if the date is in this week, even if working, instead it would check if the date is between today and the next seven days?</p>\n\n<p>To check if the date is inside the \"week\" (as defined from monday to sunday) you could do:</p>\n\n<pre><code>date_to_check = Time.utc(2017, 9, 21, 15, 30)\nweek_start = Time.now.utc.beginning_of_week\nweek_end = Time.now.utc.end_of_week\n\ndate_to_check &gt;= week_start &amp;&amp; date_to_check &lt;= week_end\n=&gt; true\n</code></pre>\n\n<p>Using utc but you could omit it. On <code>Time.utc</code> using <code>Time.new</code> instead and then on <code>week_start &amp; end</code> omitting <code>.utc</code>.</p>\n"}], "owner": {"reputation": 85, "user_id": 6856433, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3afcf20c6c643637b597f9f1429b8335?s=128&d=identicon&r=PG&f=1", "display_name": "john samcock", "link": "https://stackoverflow.com/users/6856433/john-samcock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1505934701, "creation_date": 1505930857, "last_edit_date": 1505932163, "question_id": 46328986, "link": "https://stackoverflow.com/questions/46328986/check-if-date-in-range", "title": "Check if date in range", "body": "<p>I am trying to check if the date <code>2017-09-21 15:30:00 -0400</code> is in the range of this week.</p>\n\n<p>Here is the code below: I am trying to output true or false but Its not outputting the right answer. In theory this should work.</p>\n\n<pre><code> dateTime = Time.new(2017, 9, 21, 15, 30) =&gt; 2017-09-21 15:30:00 -0400 \n\n Range.new((Date.today), (Date.today+7.days)).include?(dateTime)\n</code></pre>\n\n<p>Basically i am trying to check if the dateTime variable is within this week. But i initialize it using Time.new</p>\n"}, {"tags": ["ruby", "gcc", "rvm"], "comments": [{"owner": {"reputation": 1564, "user_id": 755421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71312ffca1775d45c43afabf53358838?s=128&d=identicon&r=PG", "display_name": "bitsapien", "link": "https://stackoverflow.com/users/755421/bitsapien"}, "edited": false, "score": 0, "creation_date": 1505932602, "post_id": 46328852, "comment_id": 79619829, "body": "What OS are you on ?"}, {"owner": {"reputation": 353, "user_id": 868386, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd36809d743930686b88bd3c7cf84900?s=128&d=identicon&r=PG", "display_name": "user868386", "link": "https://stackoverflow.com/users/868386/user868386"}, "edited": false, "score": 0, "creation_date": 1505939472, "post_id": 46328852, "comment_id": 79623338, "body": "have you tried <code>rvm --trace install 2.2.3</code>? might only print same information in log, but may be useful."}, {"owner": {"reputation": 1205, "user_id": 5192013, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/8jL3u.jpg?s=128&g=1", "display_name": "Jaswinder", "link": "https://stackoverflow.com/users/5192013/jaswinder"}, "edited": false, "score": 0, "creation_date": 1505988678, "post_id": 46328852, "comment_id": 79642106, "body": "My OS is ubuntu 14.04 and I have got the same log with trace"}], "owner": {"reputation": 1205, "user_id": 5192013, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/8jL3u.jpg?s=128&g=1", "display_name": "Jaswinder", "link": "https://stackoverflow.com/users/5192013/jaswinder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505930393, "creation_date": 1505930393, "question_id": 46328852, "link": "https://stackoverflow.com/questions/46328852/rvm-install-ruby-2-3-3-not-working", "title": "RVM install ruby 2.3.3 not working", "body": "<p>Not just its ruby 2.3.3 ,rvm breaks with installing any ruby version. here is the terminal log:</p>\n\n<pre><code>Error running '__rvm_make -j2'\n</code></pre>\n\n<p>Complete log is found under <code>/.rvm/log/1505929982_ruby-2.4.1/make.log</code></p>\n\n<pre><code>class.c:599:1: internal compiler error: in mark_irreducible_loops, at cfgloopanal.c:152\n rb_define_class_id(ID id, VALUE super)\n</code></pre>\n\n<p>It seems to be gcc compiler error but no solution found as gcc is latest version.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "deployment", "capistrano", "capistrano3"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 7438959, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-oTIyL0JubPE/AAAAAAAAAAI/AAAAAAAAAWY/0416SyDI6zw/photo.jpg?sz=128", "display_name": "Luis Mejia", "link": "https://stackoverflow.com/users/7438959/luis-mejia"}, "edited": false, "score": 0, "creation_date": 1505929536, "post_id": 46328411, "comment_id": 79618178, "body": "I already had the gem installed, i forgot to add my gem file to the post, i&#39;ve edited and added the relevant portions."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1505928807, "creation_date": 1505928807, "answer_id": 46328411, "question_id": 46328375, "link": "https://stackoverflow.com/questions/46328375/trying-to-deploy-on-digitalocean-receiving-error-with-capistrano/46328411#46328411", "title": "Trying to deploy on Digitalocean, receiving error with Capistrano", "body": "<p>You need to install <a href=\"https://github.com/capistrano/rbenv\" rel=\"nofollow noreferrer\">that dependency</a> by adding it to your <code>Gemfile</code>:</p>\n\n<pre><code>gem 'capistrano-rbenv'\n</code></pre>\n\n<p>Then <code>bundle install</code>.</p>\n\n<p>Capistrano has started to shunt some of the lesser used features to optional modules lately.</p>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 7438959, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-oTIyL0JubPE/AAAAAAAAAAI/AAAAAAAAAWY/0416SyDI6zw/photo.jpg?sz=128", "display_name": "Luis Mejia", "link": "https://stackoverflow.com/users/7438959/luis-mejia"}, "edited": false, "score": 0, "creation_date": 1506024226, "post_id": 46346148, "comment_id": 79664819, "body": "I was following the tutorial as mentioned originally and they stated it wasn&#39;t needed at the moment. Also, it&#39;s not related to my error and isn&#39;t relevant to my question."}], "tags": [], "owner": {"reputation": 1112, "user_id": 5892163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Tfz7.jpg?s=128&g=1", "display_name": "Hackman", "link": "https://stackoverflow.com/users/5892163/hackman"}, "is_accepted": false, "score": 1, "last_activity_date": 1506002869, "creation_date": 1506002869, "answer_id": 46346148, "question_id": 46328375, "link": "https://stackoverflow.com/questions/46328375/trying-to-deploy-on-digitalocean-receiving-error-with-capistrano/46346148#46346148", "title": "Trying to deploy on Digitalocean, receiving error with Capistrano", "body": "<p>You forgot to require capistrano/passenger in your Capfile.</p>\n"}, {"tags": [], "owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "is_accepted": false, "score": 1, "last_activity_date": 1506051814, "creation_date": 1506051814, "answer_id": 46356485, "question_id": 46328375, "link": "https://stackoverflow.com/questions/46328375/trying-to-deploy-on-digitalocean-receiving-error-with-capistrano/46356485#46356485", "title": "Trying to deploy on Digitalocean, receiving error with Capistrano", "body": "<p>First, this is not directly causing your problem, but you have a mistake in your Capfile. If you look at <a href=\"https://github.com/capistrano/rbenv#usage\" rel=\"nofollow noreferrer\">the official documentation for capistrano-rbenv</a>, the <code>set</code> commands are supposed to go in <code>deploy.rb</code>, not in <code>Capfile</code>. I suggest removing those lines and moving them to deploy.rb.</p>\n\n<pre><code># Move to deploy.rb\nset :rbenv_type, :user\nset :rbenv_ruby, '2.4.1'\n</code></pre>\n\n<hr>\n\n<p>In any case, the error you are getting is likely due to the fact that the gem <code>capistrano-rbenv</code> can't be loaded. Here's what I would try:</p>\n\n<ol>\n<li>Run <code>bundle exec cap production deploy</code>. All cap commands must be prefixed with <code>bundle exec</code>. Otherwise there is no guarantee that the Gemfile will be used.</li>\n<li>If that doesn't work, run <code>bundle config without</code> to see if the <code>development</code> group of your Gemfile is being excluded by bundler. If so, remove that setting by running <code>bundle config --delete without</code>.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2465, "user_id": 3042016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6kVHc.jpg?s=128&g=1", "display_name": "will_in_wi", "link": "https://stackoverflow.com/users/3042016/will-in-wi"}, "is_accepted": false, "score": 0, "last_activity_date": 1506169133, "creation_date": 1506169133, "answer_id": 46379491, "question_id": 46328375, "link": "https://stackoverflow.com/questions/46328375/trying-to-deploy-on-digitalocean-receiving-error-with-capistrano/46379491#46379491", "title": "Trying to deploy on Digitalocean, receiving error with Capistrano", "body": "<p>Run Capistrano with <code>bundle exec cap production deploy</code>, in addition to making sure that the <code>capistrano-rbenv</code> gem is in your Gemfile, and <code>capistrano/rbenv</code> is in your Capfile as outlined in the other answers.</p>\n"}], "owner": {"reputation": 87, "user_id": 7438959, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-oTIyL0JubPE/AAAAAAAAAAI/AAAAAAAAAWY/0416SyDI6zw/photo.jpg?sz=128", "display_name": "Luis Mejia", "link": "https://stackoverflow.com/users/7438959/luis-mejia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1506169133, "creation_date": 1505928675, "last_edit_date": 1506024313, "question_id": 46328375, "link": "https://stackoverflow.com/questions/46328375/trying-to-deploy-on-digitalocean-receiving-error-with-capistrano", "title": "Trying to deploy on Digitalocean, receiving error with Capistrano", "body": "<p>I have been following Gorail's tutorial to deploy on DigitalOcean. <a href=\"https://gorails.com/deploy/ubuntu/16.04#capistrano\" rel=\"nofollow noreferrer\">See Here</a> and <a href=\"https://www.youtube.com/watch?time_continue=467&amp;v=WBPV4vjzcjQ\" rel=\"nofollow noreferrer\">Here also</a>.</p>\n\n<p>I've reached the part where I am using the cap production deploy in the command line, but I am getting the following error below, I am not understanding how this error is occuring:</p>\n\n<pre><code>luis@luis-Inspiron-7559:~/Desktop/mls2$ cap production deploy --trace\ncap aborted!\nLoadError: cannot load such file -- capistrano/rbenv\n/usr/local/lib/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/usr/local/lib/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/home/luis/Desktop/mls2/Capfile:31:in `&lt;top (required)&gt;'\n/usr/lib/ruby/vendor_ruby/rake/rake_module.rb:28:in `load'\n/usr/lib/ruby/vendor_ruby/rake/rake_module.rb:28:in `load_rakefile'\n/usr/lib/ruby/vendor_ruby/rake/application.rb:689:in `raw_load_rakefile'\n/usr/lib/ruby/vendor_ruby/rake/application.rb:94:in `block in load_rakefile'\n/usr/lib/ruby/vendor_ruby/rake/application.rb:176:in `standard_exception_handling'\n/usr/lib/ruby/vendor_ruby/rake/application.rb:93:in `load_rakefile'\n/usr/lib/ruby/vendor_ruby/rake/application.rb:77:in `block in run'\n/usr/lib/ruby/vendor_ruby/rake/application.rb:176:in `standard_exception_handling'\n/usr/lib/ruby/vendor_ruby/rake/application.rb:75:in `run'\n/usr/lib/ruby/vendor_ruby/capistrano/application.rb:15:in `run'\n/usr/bin/cap:3:in `&lt;main&gt;'\n</code></pre>\n\n<p>This is my cap file:</p>\n\n<pre><code># Load DSL and set up stages\nrequire \"capistrano/setup\"\n\n\n# Include default deployment tasks\nrequire \"capistrano/deploy\"\n\n# Load the SCM plugin appropriate to your project:\n#\n# require \"capistrano/scm/hg\"\n# install_plugin Capistrano::SCM::Hg\n# or\n# require \"capistrano/scm/svn\"\n# install_plugin Capistrano::SCM::Svn\n# or\n# require \"capistrano/scm/git\"\n# install_plugin Capistrano::SCM::Git\n\n# Include tasks from other gems included in your Gemfile\n#\n# For documentation on these, see for example:\n#\n#   https://github.com/capistrano/rvm\n#   https://github.com/capistrano/rbenv\n#   https://github.com/capistrano/chruby\n#   https://github.com/capistrano/bundler\n#   https://github.com/capistrano/rails\n#   https://github.com/capistrano/passenger\n#\n# require \"capistrano/rvm\"\nrequire \"capistrano/rbenv\"\nset :rbenv_type, :user\nset :rbenv_ruby, '2.4.1'\n\nrequire \"capistrano/bundler\"\nrequire 'capistrano/rails'\n\n# require \"capistrano/chruby\"\n# require \"capistrano/rails/assets\"\n# require \"capistrano/rails/migrations\"\n# require \"capistrano/passenger\"\n\n# Load custom tasks from `lib/capistrano/tasks` if you have any defined\nDir.glob(\"lib/capistrano/tasks/*.rake\").each { |r| import r }\n</code></pre>\n\n<p>and my production.rb :</p>\n\n<pre><code>set :production\nserver 'xxx.xxx.xxx.xxx', user: 'USER', roles: %w{app db web}\n</code></pre>\n\n<p>and my gemfile, i've already added the capistrano gems in the development group as suggested in the video:</p>\n\n<pre><code>...    \ngroup :development do\n      # Access an IRB console on exception pages or by using &lt;%= console %&gt; anywhere in the code.\n      gem 'web-console', '&gt;= 3.3.0'\n      gem 'listen', '~&gt; 3.0.5'\n      # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n      gem 'spring'\n      gem 'spring-watcher-listen', '~&gt; 2.0.0'\n      gem 'capistrano', '~&gt; 3.9', '&gt;= 3.9.1'\n      gem 'capistrano-rails', '~&gt; 1.3'\n      gem 'capistrano-passenger', '~&gt; 0.2.0'\n      gem 'capistrano-rbenv', '~&gt; 2.1', '&gt;= 2.1.1'\n    end\n...\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "testing"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1505930847, "post_id": 46328335, "comment_id": 79618841, "body": "you are not validating the <code>Url</code> in this case maybe take a look at <a href=\"http://api.rubyonrails.org/v5.1/classes/ActiveRecord/Validations/ClassMethods.html#method-i-validates_associated\" rel=\"nofollow noreferrer\"><code>validates_associated</code></a>"}, {"owner": {"reputation": 613, "user_id": 2252927, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kEOQw.jpg?s=128&g=1", "display_name": "Oxfist", "link": "https://stackoverflow.com/users/2252927/oxfist"}, "edited": false, "score": 0, "creation_date": 1505931467, "post_id": 46328335, "comment_id": 79619185, "body": "engineersmnky was right to point out that what you want is validating the URL associated with the link, which in this case is just an instance of <code>Url</code> with no data. I&#39;d like to add that you could add the following assertion to enforce the proper association <code>assert_true link.url.valid?</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 613, "user_id": 2252927, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kEOQw.jpg?s=128&g=1", "display_name": "Oxfist", "link": "https://stackoverflow.com/users/2252927/oxfist"}, "edited": false, "score": 0, "creation_date": 1505932261, "post_id": 46328335, "comment_id": 79619644, "body": "@Oxfist that assumes a guaranteed binding between <code>link</code> and <code>url</code> if a link can exist without a <code>url</code> then that assertion is error prone."}, {"owner": {"reputation": 613, "user_id": 2252927, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kEOQw.jpg?s=128&g=1", "display_name": "Oxfist", "link": "https://stackoverflow.com/users/2252927/oxfist"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1505935694, "post_id": 46328335, "comment_id": 79621428, "body": "@engineersmnky that is true but given the context of the question and the test code provided that could be a valid solution to properly validate the <code>Url</code> instance."}, {"owner": {"reputation": 629, "user_id": 7116039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-W1XRU2i8SxQ/AAAAAAAAAAI/AAAAAAAAAHs/ceXJf5aD9w4/photo.jpg?sz=128", "display_name": "olegario", "link": "https://stackoverflow.com/users/7116039/olegario"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505942061, "post_id": 46328335, "comment_id": 79624501, "body": "Thanks @engineersmnky that exactly I was looking for. Please answer the question so I can give the credits to you."}], "owner": {"reputation": 629, "user_id": 7116039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-W1XRU2i8SxQ/AAAAAAAAAAI/AAAAAAAAAHs/ceXJf5aD9w4/photo.jpg?sz=128", "display_name": "olegario", "link": "https://stackoverflow.com/users/7116039/olegario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505935808, "creation_date": 1505928527, "last_edit_date": 1505935808, "question_id": 46328335, "link": "https://stackoverflow.com/questions/46328335/how-to-validate-an-object-before-saving-in-rails", "title": "How to validate an object before saving in Rails?", "body": "<p>I'm very new in Rails, and I have the following problem. I have this class  <code>Url</code> that has its own validations:</p>\n\n<pre><code>class Url\n  validates :ipaddress, :format =&gt; {\n    :with =&gt; Resolv::IPv4::Regex,\n    :message =&gt; 'Deve ser um endereco IP valido'\n  }\n\n  validates :domain, :format =&gt; {\n    :with =&gt; URI.regexp,\n    :message =&gt; 'Deve ser um dominio valido'\n  }\nend\n</code></pre>\n\n<p>I have another class <code>Link</code> that has an <code>Url</code>. The validations are:</p>\n\n<pre><code>class Link\n  validates :path, :format =&gt; {\n    :with =&gt; /\\A[\\S]+\\Z/,\n    :message =&gt; 'Deve conter uma path valida'\n  }\nend\n</code></pre>\n\n<p>But the problem is when I run this test:</p>\n\n<pre><code>test 'test a link with a valid path' do\n  link = Link.new()\n  link.url = Url.new()\n  link.path = 'this/is/my/favorite/path'\n  assert_equal(true, link.valid?, 'Test a valid path')\nend\n</code></pre>\n\n<p>The test says that everything is okay, but the validation of the URL is not occurring. How can I force Rails to validate the URL too?</p>\n"}, {"tags": ["arrays", "ruby", "multidimensional-array"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505924876, "post_id": 46327169, "comment_id": 79615391, "body": "<code>p x</code> is intended to be used for debugging, it&#39;s the equivalent of <code>puts x.inspect</code>. You should be displaying prompts with <code>puts</code>, that avoids the quotes."}, {"owner": {"reputation": 21, "user_id": 7763873, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/573bb3a445a93685de86205cc1b987e2?s=128&d=identicon&r=PG&f=1", "display_name": "TheLemonSong", "link": "https://stackoverflow.com/users/7763873/thelemonsong"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1506011192, "post_id": 46327169, "comment_id": 79658016, "body": "Hey @tadman, thanks for your input. I was just using &#39;p&#39; as a quick way to throw the contents of the arrays to screen. Thanks again for looking at this:)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7763873, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/573bb3a445a93685de86205cc1b987e2?s=128&d=identicon&r=PG&f=1", "display_name": "TheLemonSong", "link": "https://stackoverflow.com/users/7763873/thelemonsong"}, "edited": false, "score": 1, "creation_date": 1506012353, "post_id": 46327418, "comment_id": 79658651, "body": "Hey again @tadman. Great answer:) What you mention with the pointers makes complete sense now. I thought each iteration of storing the &#39;command&#39; variable would be stored in a separate location in memory in the &#39;command_array&#39;, which it doesn&#39;t, just the pointer to the data&#39;s source.  The &#39;p @command_array.map(&amp;:object_id)&#39; line of code is really useful too, I&#39;ll be sure to use it again. Must remember all this stuff sits somewhere in memory when called;) Thanks again, a really informative and well articulated answer!:)"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1505925319, "creation_date": 1505925319, "answer_id": 46327418, "question_id": 46327169, "link": "https://stackoverflow.com/questions/46327169/2d-array-overwritten-when-it-shouldnt-be/46327418#46327418", "title": "2D Array Overwritten When It Shouldn&#39;t Be", "body": "<p>The problem is you've gone out of your way to recycle the same array for each line you parse. Remember in Ruby that <code>Array#push</code> puts an object reference (pointer) to the array you're pushing so any modifications to that object will impact all references to it.</p>\n\n<p>A more minimal form of your program is:</p>\n\n<pre><code>class Reader\n  def initialize\n    @command_array = [ ]\n  end\n\n  def run(file)\n    @command_array = File.readlines(file).map do |line|\n      line.chomp.split(' ')\n    end\n  end\nend\n</code></pre>\n\n<p>Your initial assignment to <code>Array.new { Array.new }</code> isn't really useful, the second argument is the default which is never used since you only <code>push</code> things into it. There's no need in Ruby to strongly type things this way. An array is just an array, a hash is just a hash, they don't need to be initialized in any particular form to be used in any particular fashion. <code>array[0]['hash_key']</code> can be valid at the same time as <code>array[1][2]</code> on the same object.</p>\n\n<p>Whenever you're having problems with objects behaving like clones, where they're somehow <em>entangled</em> and changes to one impact others, you're probably using the same object inadvertently. To see what Ruby perceives your array as use:</p>\n\n<pre><code>p @command_array.map(&amp;:object_id)\n</code></pre>\n\n<p>Which will show which object identifiers are in there. In your case they'd all be identical.</p>\n"}], "owner": {"reputation": 21, "user_id": 7763873, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/573bb3a445a93685de86205cc1b987e2?s=128&d=identicon&r=PG&f=1", "display_name": "TheLemonSong", "link": "https://stackoverflow.com/users/7763873/thelemonsong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 46327418, "answer_count": 1, "score": 0, "last_activity_date": 1505925319, "creation_date": 1505924542, "question_id": 46327169, "link": "https://stackoverflow.com/questions/46327169/2d-array-overwritten-when-it-shouldnt-be", "title": "2D Array Overwritten When It Shouldn&#39;t Be", "body": "<p>I'm writing some code that reads input from a file.</p>\n\n<p>My code parses the input file's contents and stores the data as a 2D array, e.g.</p>\n\n<p>The input is (please see input file below for correct formatting, I can't get the formatting to work here):</p>\n\n<hr>\n\n<p>ABC</p>\n\n<p>DEF</p>\n\n<p>G</p>\n\n<hr>\n\n<p>After parsing the 2D array should look like this...\n[['A','B','C',],['D','E','F'],['G']]</p>\n\n<p>The problem I have is that somehow the previous elements are being written over in the 2D array with subsequent entries, e.g.</p>\n\n<p>[['G'],['G'],['G']]</p>\n\n<p>I've looked through it but can't see how this is happening, as writes to the 2D array should only occur once per new entry, and then they should only happen with appending the new data to the 2D array, and not overwrite previous entries.</p>\n\n<p>I'm a bit stuck, do any of you have any ideas as to why this is happening?</p>\n\n<p>Thanks!:)</p>\n\n<h1>Code</h1>\n\n<pre><code>    class Reader\n\n    def initialize\n        @command_array = Array.new { Array.new } # 2D array\n\n    end\n\n      def run(file)\n        return puts \"please provide correct file\" if file.nil? || !File.exists?(file)\n\n        command_line = Array.new            #Temp array\n        p \"----------------------------------------------------------------\"\n        File.open(file).each do |line|     \n          p \"looking at a line of commands...\"\n          line.split(' ').each do |command| \n            p \"storing the command #{command} in temp array\"\n            command_line.push(command)\n            p command_line\n          end\n\n          p \"Storing the temp array as an element in the 2d array...\"\n          @command_array.push(command_line)\n          p @command_array\n\n          p \"Clearing the temp array...\"\n          p \"----------------------------------------------------------------\"\n          command_line.clear\n        end\n      end\n    end\n</code></pre>\n\n#\n\n<h1>Input File</h1>\n\n<pre><code>A B C\nD E F\nG\n</code></pre>\n\n#\n\n<h1>Output</h1>\n\n<pre><code>    \"looking at a line of commands...\"\n    \"storing the command A in temp array\"\n    [\"A\"]\n    \"storing the command B in temp array\"\n    [\"A\", \"B\"]\n    \"storing the command C in temp array\"\n    [\"A\", \"B\", \"C\"]\n    \"Storing the temp array as an element in the 2d array...\"\n    [[\"A\", \"B\", \"C\"]]\n    \"Clearing the temp array...\"\n    \"----------------------------------------------------------------\"\n    \"looking at a line of commands...\"\n    \"storing the command D in temp array\"\n    [\"D\"]\n    \"storing the command E in temp array\"\n    [\"D\", \"E\"]\n    \"storing the command F in temp array\"\n    [\"D\", \"E\", \"F\"]\n    \"Storing the temp array as an element in the 2d array...\"\n    [[\"D\", \"E\", \"F\"], [\"D\", \"E\", \"F\"]]\n    \"Clearing the temp array...\"\n    \"----------------------------------------------------------------\"\n    \"looking at a line of commands...\"\n    \"storing the command G in temp array\"\n    [\"G\"]\n    \"Storing the temp array as an element in the 2d array...\"\n    [[\"G\"], [\"G\"], [\"G\"]]\n    \"Clearing the temp array...\"\n</code></pre>\n\n#\n"}, {"tags": ["arrays", "ruby", "boolean", "iteration"], "answers": [{"tags": [], "owner": {"reputation": 4446, "user_id": 6079412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5e6c2756113d7289e80bed137251db?s=128&d=identicon&r=PG&f=1", "display_name": "larz", "link": "https://stackoverflow.com/users/6079412/larz"}, "is_accepted": false, "score": 0, "last_activity_date": 1505925037, "creation_date": 1505925037, "answer_id": 46327337, "question_id": 46327027, "link": "https://stackoverflow.com/questions/46327027/boolean-array-change-in-ruby/46327337#46327337", "title": "Boolean Array change in Ruby", "body": "<pre><code>def cats_in_hats\n  cats = []\n\n  i = 0\n  while i &lt; 100\n    cats &lt;&lt; false \n    i = i + 1 \n  end \n\n  p cats \n\n  round = 1;\n\n  while round &lt; 100\n\n  cats = cats.collect!.with_index do |cat, idx|\n    idx % round == 0 ? !cat : cat\n  end\n\n  round = round + 1 \n\n  end \n\n  p cats \n\nend\n\nputs \"------Cats in Hats------\"\nputs cats_in_hats\n</code></pre>\n\n<p>The problem with your initial code is that you were never \"doing\" anything in your <code>each_with_index</code> block.  when you used <code>cat = !cat</code> you were only changing that item within the scope of the loop and never creating a new array.  Using <code>.collect!.with_index</code><a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-map\" rel=\"nofollow noreferrer\">map/collect!.with_index(to get the index)</a> you can perform an operation on each item in an array and return a new array with every iteration.  This is similar to how JavaScript's <code>map</code> function works.  Let me know if you need further explanation.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1505929512, "post_id": 46327639, "comment_id": 79618167, "body": "Don&#39;t forget <code>cats.count(&amp;:has_hat?)</code> as a short-hand for same."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1505929560, "post_id": 46327639, "comment_id": 79618189, "body": "@tadman I would have but <i>&quot;New to Ruby from JS&quot;</i> caused me to use a more explicit block syntax"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505929694, "post_id": 46327639, "comment_id": 79618254, "body": "Not as a first step, you&#39;ve got the right idea unpacking it slowly, but as an example of how Ruby can really minify solutions without over-complicating things. <code>cats.count(function(cat) { return cat.has_hat() })</code> is now <code>cats.count(cat =&gt; cat.has_hat())</code> in ES6, so there&#39;s a lot of similarity these days."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1505930027, "post_id": 46327639, "comment_id": 79618438, "body": "@tadman added for edification. Although I find that the real complication for people is the preceding <code>&amp;:</code> notation"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505930126, "post_id": 46327639, "comment_id": 79618492, "body": "An even better explanation, nice!"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1505936064, "post_id": 46327639, "comment_id": 79621615, "body": "Note: your method names violate standard Ruby style. Bangs are only used for the more surprising version of a pair of methods. In your case, there is only one method, so it shouldn&#39;t have a bang."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1505936424, "post_id": 46327639, "comment_id": 79621806, "body": "@J&#246;rgWMittag very astute of you it was borrowed, more or less, from the way <code>rails</code> uses <code>#toggle!(attribute)</code> but I have updated the code to more accurately reflect a stateful mutation (still not perfect but it gets the point across)"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1505936527, "post_id": 46327639, "comment_id": 79621881, "body": "Yeah, Rails&#39; coding conventions differ from Ruby&#39;s. (I remember that for a long time, they advocated <code>for</code> / <code>in</code> oder <code>#each</code>, for example, whereas Ruby is the other way around.)"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1505936650, "post_id": 46327639, "comment_id": 79621946, "body": "@J&#246;rgWMittag I would be perfectly fine to only have a bang method that modifies the object, when a non-bang method makes no sense. But having both works too."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1505936887, "post_id": 46327639, "comment_id": 79622043, "body": "@MarkThomas: Of course, there is nothing <i>wrong</i> with that, it just doesn&#39;t conform to the Coding Style used by the core library, standard libraries and the majority of the Ruby community. (DSLs or the Rails community are a different matter, though.)"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1505993292, "post_id": 46327639, "comment_id": 79645277, "body": "@J&#246;rgWMittag What&#39;s bigger, the Rails community or rubyists <i>not</i> in the Rails Community? ;)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1505999277, "post_id": 46327639, "comment_id": 79649529, "body": "@MarkThomas To paraphrase <b>John Lennon</b> and <i>Jeremy Hillary Boob, PhD</i>: <b>You [write ruby]?</b> <i>Old [ruby], middle, a dialect, pure.</i> <b>Well, do you [write ruby]?</b> <i>You know, I&#39;m not sure!</i> - Yellow Submarine (1968)"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 3, "last_activity_date": 1505949750, "last_edit_date": 1505949750, "creation_date": 1505926051, "answer_id": 46327639, "question_id": 46327027, "link": "https://stackoverflow.com/questions/46327027/boolean-array-change-in-ruby/46327639#46327639", "title": "Boolean Array change in Ruby", "body": "<p>Welcome to ruby. Someone nicely provided an explanation of what the issues were with your code. I thought I would give you a quick run down on the power of objects in ruby instead. </p>\n\n<p>Let's start with <code>Cat</code>. What can it do? Well:</p>\n\n<ul>\n<li>It can have a hat</li>\n<li>It starts out without a hat </li>\n<li>It can put on and take off the hat </li>\n</ul>\n\n<p>Okay so lets make an <code>Object</code> for that:</p>\n\n<pre><code>class Cat\n  def initialize\n    @hat = false # start out without a hat\n  end\n  def toggle_hat\n    !@hat   # in case you just want to tip your hat in salutation to J\u00f6rgWMittag\n  end\n  def toggle_hat!\n    @hat = toggle_hat # @hat equals not(@hat) e.g. @hat = not(true) to take off the hat\n  end\n  def has_hat?\n    @hat # does it have a hat true or false\n  end\nend\n</code></pre>\n\n<p>Perfect there is a <code>Cat</code>. Now let's look at the problem. </p>\n\n<p>We need to loop through 100 <code>cats</code>. Okay</p>\n\n<pre><code>cats = Array.new(100) { Cat.new }\n</code></pre>\n\n<p>Now we have 100 cats. Let's start looping </p>\n\n<pre><code>#loop from 1 up to 100 providing the loop number (n)\n1.upto(100).each do |n| \n  # for each n we skip over the preceding n and step by n\n  (n..100).step(n) do |idx| \n    # pick the appropriate cat (ruby indexes start at 0) \n    # toggle his hat\n    cats[idx - 1].toggle_hat!\n  end\nend \n</code></pre>\n\n<p>Great all our <code>Cat</code>s have been looped through and toggled now lets count the ones with hats on</p>\n\n<pre><code># will count each cat where has_hat? is true\ncats.count {|cat| cat.has_hat? }\n#=&gt; 10 \n</code></pre>\n\n<p>This would generally be expressed more idiomatically as <code>cats.count(&amp;:has_hat?)</code>. This uses ruby's <code>Symbol#to_proc</code> sugar and means call the method <code>has_hat?</code> on each element yielded to the block as shown more explicitly above.</p>\n\n<p>We can also collect them </p>\n\n<pre><code>cats.map.with_index {|cat,idx| idx + 1 if cat.has_hat? }.compact\n#=&gt; [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]\n</code></pre>\n\n<p>Tada <code>Object</code>s are amazing and make for fantastically readable simplistic code. <a href=\"https://repl.it/LXK4/2\" rel=\"nofollow noreferrer\">Full Example</a></p>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1505929691, "creation_date": 1505929691, "answer_id": 46328684, "question_id": 46327027, "link": "https://stackoverflow.com/questions/46327027/boolean-array-change-in-ruby/46328684#46328684", "title": "Boolean Array change in Ruby", "body": "<pre><code>cats = cats.each_with_index do |cat, idx|\n  # ...\n  cat = !cat\nend\n</code></pre>\n\n<p>This is the problem. All objects in Ruby are represented in memory by pointers, and these pointers are copied around to pass objects to methods/blocks/etc. So when you do <code>each_with_index</code>, Ruby copies the pointer of each element into your block-local variable <code>cat</code> one at a time.</p>\n\n<p>Now when you say <code>cat = !cat</code>, this is what Ruby does</p>\n\n<ol>\n<li>Find the <code>!</code> method for the object pointed to by <code>cat</code> and call it. This returns a pointer to the object <code>true</code> or the object <code>false</code></li>\n<li>Overwrite the block-local variable <code>cat</code> with that new pointer</li>\n</ol>\n\n<p>At no point does that new pointer end up in your <code>cats</code> array!</p>\n\n<p>I can think of two main solutions to this problem:</p>\n\n<ol>\n<li>Instead of storing Boolean objects (which are immutable), store mutable objects in <code>cats</code>. Then you can call a method on each <code>cat</code> that tells it to mutate its state (this is what @engineersmnky's code does)</li>\n<li>Instead of using your block-local variable <code>cat</code>, tell Ruby to copy the new pointer directly into the array: <code>cats[idx] = !cat</code></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 5698815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c643c1edf17e7bb18554478d79ec374?s=128&d=identicon&r=PG&f=1", "display_name": "sartra", "link": "https://stackoverflow.com/users/5698815/sartra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1505949750, "creation_date": 1505924017, "question_id": 46327027, "link": "https://stackoverflow.com/questions/46327027/boolean-array-change-in-ruby", "title": "Boolean Array change in Ruby", "body": "<p>I am stuck on this code problem - I need to iterate through an array of booleans 100 times. Instructions: </p>\n\n<p>Cats in hats</p>\n\n<p>You have 100 cats.  Your rules are simple: whenever you visit a cat, you toggle it's hat status (if it already has a hat, you remove it.. if it does not have a hat, you put one on). All of the cats start hat-less. You cycle through 100 rounds of visiting cats. In the 1st round, you visit every cat. In the second round, you visit every other cat. In the nth round, you visit every nth cat.. until the 100th round, in which you only visit the 100th cat.  At the end of 100 rounds, which cats have hats?</p>\n\n<p>New to Ruby from JS and stuck on how to implement this. I think my logic is right, I just can't get it to change the value of the booleans in the array. </p>\n\n<p>Any advice much appreciated! </p>\n\n<p>Thanks</p>\n\n<pre><code>def cats_in_hats\n\n cats = []\n\n i = 0\n while i&lt; 100\n cats &lt;&lt; false \n i = i + 1 \n end \n\n puts cats \n\n\n round = 1;\n\n while round &lt; 10\n\n  # \n  cats = cats.each_with_index do |cat, idx|\n    if idx % round == 0\n      puts \"toggle index #{idx} divisible by round #{round}\"\n      cat = !cat\n      puts cat \n    end\n  end\n\n  round = round + 1 \n\n end \n\nputs cats \n\nend\n\nputs \"------Cats in Hats------\"\nputs cats_in_hats == [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "deployment"], "comments": [{"owner": {"reputation": 1480, "user_id": 5872935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpdFh.jpg?s=128&g=1", "display_name": "Mshka", "link": "https://stackoverflow.com/users/5872935/mshka"}, "edited": false, "score": 0, "creation_date": 1505925009, "post_id": 46326819, "comment_id": 79615479, "body": "Are you running <code>RAILS_ENV=production rails s</code> command from your rails root directory? did the bundle install run successfully?"}, {"owner": {"reputation": 1615, "user_id": 2779792, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gHE8l.png?s=128&g=1", "display_name": "Matthew James Briggs", "link": "https://stackoverflow.com/users/2779792/matthew-james-briggs"}, "reply_to_user": {"reputation": 1480, "user_id": 5872935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpdFh.jpg?s=128&g=1", "display_name": "Mshka", "link": "https://stackoverflow.com/users/5872935/mshka"}, "edited": false, "score": 0, "creation_date": 1505925148, "post_id": 46326819, "comment_id": 79615561, "body": "Yes this is being run from the root, e.g. rails create myapp; cd myapp; running bundle install does run successfully."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1505925659, "post_id": 46326819, "comment_id": 79615884, "body": "try. <code>RAILS_ENV=production bundle exec rails c</code> once."}, {"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1505925734, "post_id": 46326819, "comment_id": 79615927, "body": "Your app is trying to load <code>..&#47;..&#47;config&#47;environment.rb</code> but couldn&#39;t find it. It seems to be specific to your production env, so probably set in your /config/environment/production.rb or some other production-specific configurations."}, {"owner": {"reputation": 1615, "user_id": 2779792, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gHE8l.png?s=128&g=1", "display_name": "Matthew James Briggs", "link": "https://stackoverflow.com/users/2779792/matthew-james-briggs"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1505925786, "post_id": 46326819, "comment_id": 79615956, "body": "@kiddorails your command produced the same error <code>OtheymWifi:req mjb$ pwd &#47;Users&#47;mjb&#47;iq&#47;req OtheymWifi:req mjb$ RAILS_ENV=production bundle exec rails c &#47;usr&#47;local&#47;lib&#47;ruby&#47;gems&#47;2.4.0&#47;gems&#47;activesupport-5.1.4&#47;lib&#47;&zwnj;&#8203;active_support&#47;depen&zwnj;&#8203;dencies.rb:292:in </code>require&#39;: No such file to load -- ../../config/environment.rb (LoadError)`"}, {"owner": {"reputation": 1615, "user_id": 2779792, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gHE8l.png?s=128&g=1", "display_name": "Matthew James Briggs", "link": "https://stackoverflow.com/users/2779792/matthew-james-briggs"}, "reply_to_user": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1505925982, "post_id": 46326819, "comment_id": 79616087, "body": "@EJ2015 I may have other problems related to the secret key, but I don&#39;t see anything related to file paths in production.rb.  I think I need to get past the file path issues before I can figure out the secret key stuff."}, {"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1505926250, "post_id": 46326819, "comment_id": 79616228, "body": "can you grep <code>..&#47;..&#47;config&#47;environment.rb</code>? It&#39;s likely set somewhere and called only in production env."}, {"owner": {"reputation": 1615, "user_id": 2779792, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gHE8l.png?s=128&g=1", "display_name": "Matthew James Briggs", "link": "https://stackoverflow.com/users/2779792/matthew-james-briggs"}, "reply_to_user": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1505926501, "post_id": 46326819, "comment_id": 79616376, "body": "@EJ2015 I can find that in only one place.  It&#39;s a script, unrelated to the rails app itself.  I wrote it to extract data from an xml file during the dev process, the script is called <code>xml.rb</code>.  The <code>xml.rb</code> script is not called from anywhere within the rails app, it&#39;s just a dev helper."}, {"owner": {"reputation": 1615, "user_id": 2779792, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gHE8l.png?s=128&g=1", "display_name": "Matthew James Briggs", "link": "https://stackoverflow.com/users/2779792/matthew-james-briggs"}, "reply_to_user": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1505926615, "post_id": 46326819, "comment_id": 79616441, "body": "@EJ2015 I do think you&#39;re on the right track though, surely I have messed up a config file somehow.  Rails is tough because there is config all over the place (albeit largely contained to config/* and db/*)."}, {"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1505926847, "post_id": 46326819, "comment_id": 79616574, "body": "What happens if you remove xml.rb? Just to make sure."}, {"owner": {"reputation": 1615, "user_id": 2779792, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gHE8l.png?s=128&g=1", "display_name": "Matthew James Briggs", "link": "https://stackoverflow.com/users/2779792/matthew-james-briggs"}, "edited": false, "score": 0, "creation_date": 1505927067, "post_id": 46326819, "comment_id": 79616684, "body": "Wow, that totally worked.  Amazing.  I think I partially understand why.  I had this file in <code>railsroot&#47;app&#47;models</code> so rails must do some introspection there, but only in production?  And the relative path is good anyway.  Very strange."}, {"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "reply_to_user": {"reputation": 1615, "user_id": 2779792, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gHE8l.png?s=128&g=1", "display_name": "Matthew James Briggs", "link": "https://stackoverflow.com/users/2779792/matthew-james-briggs"}, "edited": false, "score": 0, "creation_date": 1505927248, "post_id": 46326819, "comment_id": 79616786, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/154926/discussion-between-ej2015-and-matthew-james-briggs\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "is_accepted": true, "score": 1, "last_activity_date": 1505934327, "last_edit_date": 1505934327, "creation_date": 1505928376, "answer_id": 46328292, "question_id": 46326819, "link": "https://stackoverflow.com/questions/46326819/rails-require-no-such-file-to-load-error-when-running-in-production/46328292#46328292", "title": "Rails Require `No Such File to Load` Error When Running in Production", "body": "<p>Your app is trying to load <code>../../config/environment.rb</code> but couldn't find it. It seems to be specific to your production env, so probably set in your /config/environment/production.rb or some other production-specific configurations/files, which are initialized at startup.</p>\n\n<p>Another problem is that <code>#require</code> needs an absolute path. For creating absolute path from relative paths, use </p>\n\n<p><code>require_relative \"../config/environment\"</code> </p>\n\n<p>or something like </p>\n\n<p><code>require File.expand_path('../../config/environment', __FILE__)</code></p>\n\n<p>Edit: with some more specifics.  The offensive <code>require '../../config/environment'</code> was in a side script of the OP's own making, e.g. it was not a model, view, controller or other file created by Rails and was not referenced by the Rails application.  However, it appears the Rails, only in production mode, introspected the rb files in its directories including this custom script and raised the error.  The fixes are twofold.</p>\n\n<ol>\n<li>Don't put any custom non-app-specific files in Rails' special folders (such as <code>myapp/app/model</code>, instead create your own directory under the app root for such things.</li>\n<li>use <code>require_relative</code> instead of <code>require</code> when specifying a relative path.</li>\n</ol>\n"}], "owner": {"reputation": 1615, "user_id": 2779792, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gHE8l.png?s=128&g=1", "display_name": "Matthew James Briggs", "link": "https://stackoverflow.com/users/2779792/matthew-james-briggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1231, "favorite_count": 0, "accepted_answer_id": 46328292, "answer_count": 1, "score": 0, "last_activity_date": 1505934327, "creation_date": 1505923301, "last_edit_date": 1505926137, "question_id": 46326819, "link": "https://stackoverflow.com/questions/46326819/rails-require-no-such-file-to-load-error-when-running-in-production", "title": "Rails Require `No Such File to Load` Error When Running in Production", "body": "<p>My rails app works when running locally in <code>development</code> mode.  When I try to run it in <code>production</code> mode, I get this problem both locally and when I tried to set up an AWS Ubuntu server.</p>\n\n<pre><code>RAILS_ENV=production rails s\n=&gt; Booting Puma\n=&gt; Rails 5.1.4 application starting in production \n=&gt; Run `rails server -h` for more startup options\nExiting\n/usr/local/lib/ruby/gems/2.4.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:292:in `require': No such file to load -- ../../config/environment.rb (LoadError)\n</code></pre>\n\n<p>I can't understand exactly what that relative path is relative to.  There is a file at <code>myrailsapp/config/environment.rb</code> which states <code>require_relative 'application'</code>.  There is a file in the same directory named <code>application.rb</code>.</p>\n\n<p>I can't understand what ruby is looking for, or why it cannot find it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 4, "creation_date": 1505923383, "post_id": 46326738, "comment_id": 79614466, "body": "If <code>e</code> was <code>nil?</code> then <code>e.reload</code> would have raisen an error. Can you please clarify what you expect <code>nil!</code> (if it was existing) to do? Delete the record and nillify the current instance? Or destroy the record? Or just set some attribute (like <code>bar</code> in your question) to <code>nil</code>?"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 1, "creation_date": 1505927234, "post_id": 46326738, "comment_id": 79616778, "body": "Do you mean you want to set <code>e.bar</code> to nil? If so, you can do <code>e.update(bar: nil)</code>. That will set the attribute and save all in one step."}, {"owner": {"reputation": 517, "user_id": 796283, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6454292803d9f216fc8c65b9e5715850?s=128&d=identicon&r=PG", "display_name": "Shobhit", "link": "https://stackoverflow.com/users/796283/shobhit"}, "edited": false, "score": 0, "creation_date": 1505929762, "post_id": 46326738, "comment_id": 79618285, "body": "What is the use case for it?"}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 3341972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4c97cadaffeb09e32312d37dd31dd6?s=128&d=identicon&r=PG", "display_name": "apanzerj", "link": "https://stackoverflow.com/users/3341972/apanzerj"}, "edited": false, "score": 0, "creation_date": 1505932449, "post_id": 46327935, "comment_id": 79619749, "body": "I think you are missing my point. The Foo.new and etc.. is just to demonstrate we have an object with an value. The functionality I&#39;m asking about is to nil out the value of that one specific attribute and save."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 395, "user_id": 3341972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4c97cadaffeb09e32312d37dd31dd6?s=128&d=identicon&r=PG", "display_name": "apanzerj", "link": "https://stackoverflow.com/users/3341972/apanzerj"}, "edited": false, "score": 0, "creation_date": 1505935823, "post_id": 46327935, "comment_id": 79621500, "body": "@apanzerj I&#39;m basing this on your exact code, and in that code there is no attribute. If there was you&#39;d be saying <code>e.bar = nil</code>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1505927119, "creation_date": 1505927119, "answer_id": 46327935, "question_id": 46326738, "link": "https://stackoverflow.com/questions/46326738/is-there-a-method-to-set-a-value-in-rails-to-nil-and-save/46327935#46327935", "title": "Is there a method to set a value in rails to nil and save?", "body": "<p>You can't save a <code>nil</code> to the database, and furthermore, once an object has been created as a particular class you can never change that. It can only be converted by creating a new object, something an in-place modifier like this hypothetical <code>nil!</code> does.</p>\n\n<p>The closest thing you can get is:</p>\n\n<pre><code>e = Foo.new\ne.bar = \"hello\"\ne.save\ne.reload\ne.delete!\n\ne.reload\ne.destroyed? # =&gt; true\n\nf = Foo.find_by(id: e.id)\nf.nil? # =&gt; true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 906, "user_id": 7933325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4181aecdacd635102e337da145eafe9?s=128&d=identicon&r=PG", "display_name": "Tom Copeland", "link": "https://stackoverflow.com/users/7933325/tom-copeland"}, "is_accepted": false, "score": 0, "last_activity_date": 1505943325, "creation_date": 1505943325, "answer_id": 46332102, "question_id": 46326738, "link": "https://stackoverflow.com/questions/46326738/is-there-a-method-to-set-a-value-in-rails-to-nil-and-save/46332102#46332102", "title": "Is there a method to set a value in rails to nil and save?", "body": "<p>Maybe something like:</p>\n\n<pre><code>module ActiveRecord\n  class Base\n    def nil!(*names)\n      unless persisted?\n        raise ActiveRecordError, &lt;&lt;-MSG.squish\n          cannot nil on a new or destroyed record object. Consider using\n          persisted?, new_record?, or destroyed? before nilling\n        MSG\n      end\n\n      unless names.empty?\n        changes = {}\n\n        names.each do |column|\n          column = column.to_s\n          changes[column] = write_attribute(column, nil)\n        end\n\n        primary_key = self.class.primary_key\n        scope = self.class.unscoped.where(primary_key =&gt; _read_attribute(primary_key))\n\n        if locking_enabled?\n          locking_column = self.class.locking_column\n          scope = scope.where(locking_column =&gt; _read_attribute(locking_column))\n          changes[locking_column] = increment_lock\n        end\n\n        clear_attribute_changes(changes.keys)\n        result = scope.update_all(changes) == 1\n\n        if !result &amp;&amp; locking_enabled?\n          raise ActiveRecord::StaleObjectError.new(self, \"nil\")\n        end\n\n        @_trigger_update_callback = result\n        result\n      else\n        true\n      end      \n    end\n  end\nend\n</code></pre>\n\n<p>Put that in an initializer and it'll let you null out the title of a comment with <code>Comment.last.nil!(:title)</code>.</p>\n"}], "owner": {"reputation": 395, "user_id": 3341972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4c97cadaffeb09e32312d37dd31dd6?s=128&d=identicon&r=PG", "display_name": "apanzerj", "link": "https://stackoverflow.com/users/3341972/apanzerj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1506025020, "creation_date": 1505922992, "last_edit_date": 1506025020, "question_id": 46326738, "link": "https://stackoverflow.com/questions/46326738/is-there-a-method-to-set-a-value-in-rails-to-nil-and-save", "title": "Is there a method to set a value in rails to nil and save?", "body": "<p>What I'm thinking of is something where I can say:</p>\n\n<pre><code>e = Foo.new\ne.bar = \"hello\"\ne.save\ne.reload\ne.bar.nil!\ne.reload\ne.bar.nil?  =&gt; true\n</code></pre>\n\n<p>Kind of #touch but sets nil and saves.</p>\n\n<p>EDIT</p>\n\n<p>Super sorry guys. I mean this:</p>\n\n<pre><code>e = Foo.new\ne.bar = \"hello\"\ne.save\ne.reload\ne.bar.nil!\ne.reload\ne.bar.nil?  =&gt; true\n</code></pre>\n"}, {"tags": ["ruby", "checkbox", "watir"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1505925933, "post_id": 46325585, "comment_id": 79616053, "body": "Any chance you can create an example page? Using <code>browser.label(for: &#39;zrs&#39;).click</code> and <code>browser.radio(id: &#39;zrs&#39;).click</code> worked for me. I&#39;m guessing there is some CSS/JavaScript that makes a difference."}, {"owner": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1505951719, "post_id": 46325585, "comment_id": 79627497, "body": "I think you are confusing two different types of input controls.   A Checkbox is a single independent thing that can be set or unset regardless of other controls around it.   A Radio control is an analog of the old push-button radios that used to be in cars, where there are a set of selections, but only one can be enabled at once, and enabling one causes any others that were enabled to be disabled.   If you try to address a radio control as a checkbox in watir it&#39;s bound to fail, as they are different control types."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1505925871, "post_id": 46326562, "comment_id": 79616023, "body": "The <code>input</code> element is actually of type &quot;radio&quot;, so <code>checkbox</code> would need to be <code>radio</code>."}, {"owner": {"reputation": 3493, "user_id": 1323481, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4825c6c1cdfd05c2af6fb8db0d492f73?s=128&d=identicon&r=PG", "display_name": "StandardNerd", "link": "https://stackoverflow.com/users/1323481/standardnerd"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1505925951, "post_id": 46326562, "comment_id": 79616063, "body": "oh yeah, you&#39;re right! I was misleaded by mentioning checkbox in the original post."}, {"owner": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1505952156, "post_id": 46326562, "comment_id": 79627582, "body": "I considered editing the original post to reference the proper control type, but decided against it as then it would be very unclear as to his issue.  Also, if he&#39;s confused, others are likely as well.   I suspect it is becoming increasingly common for people working with these controls to have never been exposed to the hardware on which the &#39;radio&#39; control is modeled.  The name for the control likely makes no sense to them.  (if this is you, do an image search for &#39;push button car radio&#39;, it may help your understanding)"}, {"owner": {"reputation": 269, "user_id": 2295727, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e8fbcd763892ea63982f5860e805cd56?s=128&d=identicon&r=PG", "display_name": "Boikot", "link": "https://stackoverflow.com/users/2295727/boikot"}, "edited": false, "score": 0, "creation_date": 1505976111, "post_id": 46326562, "comment_id": 79633865, "body": "The problem cames locating the element , if i try browser.radio(id: &#39;zrs&#39;) on the irb console i get located false, but if i try with the .set? is shows a false , so i m getting confused at this point because seems i can t find properly the element. Even with the xpath of the radio or the xpath of the input i ve got located false."}], "tags": [], "owner": {"reputation": 3493, "user_id": 1323481, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4825c6c1cdfd05c2af6fb8db0d492f73?s=128&d=identicon&r=PG", "display_name": "StandardNerd", "link": "https://stackoverflow.com/users/1323481/standardnerd"}, "is_accepted": false, "score": 1, "last_activity_date": 1505925993, "last_edit_date": 1505925993, "creation_date": 1505922596, "answer_id": 46326562, "question_id": 46325585, "link": "https://stackoverflow.com/questions/46325585/ruby-watir-radio-checkbox/46326562#46326562", "title": "Ruby Watir radio checkbox", "body": "<p>How about</p>\n\n<pre><code>radio = browser.radio(id: 'zrs')\nradio.set?        #=&gt; false\nradio.set\nradio.set?        #=&gt; true\n</code></pre>\n\n<p>See <a href=\"http://www.rubydoc.info/gems/watir-webdriver/Watir/Radio\" rel=\"nofollow noreferrer\">http://www.rubydoc.info/gems/watir-webdriver/Watir/Radio</a></p>\n"}, {"comments": [{"owner": {"reputation": 269, "user_id": 2295727, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e8fbcd763892ea63982f5860e805cd56?s=128&d=identicon&r=PG", "display_name": "Boikot", "link": "https://stackoverflow.com/users/2295727/boikot"}, "edited": false, "score": 0, "creation_date": 1506062242, "post_id": 46351752, "comment_id": 79676266, "body": "Thanks it works like a charm , but i m confused as i tried this on the irb and didn t work , shouldn t be any difference doing it from irb or rubymine, anyway , thanks for the help"}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 3, "last_activity_date": 1506021894, "creation_date": 1506021894, "answer_id": 46351752, "question_id": 46325585, "link": "https://stackoverflow.com/questions/46325585/ruby-watir-radio-checkbox/46351752#46351752", "title": "Ruby Watir radio checkbox", "body": "<p>Given the way that the radio button is implemented, it will not be considered visible. You will get an exception trying to set it directly:</p>\n\n<pre><code>browser.radio(id: 'zrs').set\n#=&gt; element located, but timed out after 2 seconds, waiting for #&lt;Watir::Radio: located: true; {:id=&gt;\"zrs\", :tag_name=&gt;\"input\", :type=&gt;\"radio\"}&gt; to be present (Watir::Exception::UnknownObjectException)\n</code></pre>\n\n<p>Instead of setting it directly, you can click its associated label, which is what an actual user would do:</p>\n\n<pre><code>browser = Watir::Browser.new\nbrowser.goto('https://pricing-calculator.bluekiri.cloud/')\np browser.radio(id: 'zrs').set?\n#=&gt; false\nbrowser.label(for: 'zrs').click\np browser.radio(id: 'zrs').set?\n#=&gt; true\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 2295727, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e8fbcd763892ea63982f5860e805cd56?s=128&d=identicon&r=PG", "display_name": "Boikot", "link": "https://stackoverflow.com/users/2295727/boikot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 46351752, "answer_count": 2, "score": 2, "last_activity_date": 1506098760, "creation_date": 1505919805, "last_edit_date": 1506098760, "question_id": 46325585, "link": "https://stackoverflow.com/questions/46325585/ruby-watir-radio-checkbox", "title": "Ruby Watir radio checkbox", "body": "<p>i m trying to set the checkbox on a radio control with the .set? option. it returns false but I'm unable to set the checkbox.</p>\n\n<pre><code>&lt;div class=\"\"&gt;\n&lt;input name=\"radiostorage\" id=\"zrs\" value=\"2\" type=\"radio\"&gt;\n&lt;label for=\"zrs\"&gt;Zone-redundant storage (ZRS)&lt;/label&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>have tried with label(for: 'zrs').set .click .parent.click .parent.set, also directly trying to click on the input , but nothing happens, any clue on that</p>\n\n<p>TIA</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord", "rails-i18n"], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 5542252, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hIb6B.jpg?s=128&g=1", "display_name": "David B.", "link": "https://stackoverflow.com/users/5542252/david-b"}, "edited": false, "score": 0, "creation_date": 1505922918, "post_id": 46326185, "comment_id": 79614143, "body": "It does not work. I&#39;m using <code>rails 5.1.3</code> if that can be of any help."}, {"owner": {"reputation": 51, "user_id": 8640071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kxZcH.png?s=128&g=1", "display_name": "Nenad Miloradovic", "link": "https://stackoverflow.com/users/8640071/nenad-miloradovic"}, "reply_to_user": {"reputation": 656, "user_id": 5542252, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hIb6B.jpg?s=128&g=1", "display_name": "David B.", "link": "https://stackoverflow.com/users/5542252/david-b"}, "edited": false, "score": 0, "creation_date": 1505982297, "post_id": 46326185, "comment_id": 79637666, "body": "By Rails guides it is stile the same: <a href=\"http://guides.rubyonrails.org/i18n.html#overview-of-other-built-in-methods-that-provide-i18n-support\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>  ActiveModel::Errors#full_messages prepends the attribute name to the error message using a separator that will be looked up from errors.format (and which defaults to &quot;%{attribute} %{message}&quot;).  As you can see here:  <a href=\"https://github.com/rails/rails/blob/master/activemodel/lib/active_model/locale/en.yml\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/master/activemodel/lib/active_mo&zwnj;&#8203;del/&hellip;</a>"}], "tags": [], "owner": {"reputation": 51, "user_id": 8640071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kxZcH.png?s=128&g=1", "display_name": "Nenad Miloradovic", "link": "https://stackoverflow.com/users/8640071/nenad-miloradovic"}, "is_accepted": true, "score": 2, "last_activity_date": 1505983321, "last_edit_date": 1505983321, "creation_date": 1505921441, "answer_id": 46326185, "question_id": 46325571, "link": "https://stackoverflow.com/questions/46325571/activerecord-validations-string-added-to-error-message-in-locales/46326185#46326185", "title": "ActiveRecord Validations : String added to error message in locales", "body": "<p>You can just add:</p>\n\n<pre><code>errors:\n  format: \"%{message}\"\n</code></pre>\n\n<p>This way you will just show error message with out attribute name.</p>\n\n<p>Edit: this should be added to <code>config/locales/fr.yml</code> and not <code>config/locales/activerecord.fr.yml</code> (which also has <code>errors:</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1505928314, "creation_date": 1505928314, "answer_id": 46328271, "question_id": 46325571, "link": "https://stackoverflow.com/questions/46325571/activerecord-validations-string-added-to-error-message-in-locales/46328271#46328271", "title": "ActiveRecord Validations : String added to error message in locales", "body": "<p>Found a <a href=\"https://github.com/nanamkim/custom-err-msg\" rel=\"nofollow noreferrer\">gem</a> which will solve your purpose</p>\n\n<p>With the help of this gem, You just need to start the locale message with a caret and it shouldn't display the attribute name in the message.</p>\n\n<p>A model defined as:</p>\n\n<pre><code>class Item &lt; ApplicationRecord\n  validates :name, presence: true\nend\n</code></pre>\n\n<p>with the following en.yml:</p>\n\n<pre><code>en:\n  activerecord:\n    errors:\n      models:\n        item:\n          attributes:\n            name:\n              blank: \"^You can't create an item without a name.\"\n</code></pre>\n\n<p><code>item.errors.full_messages</code> will display:</p>\n\n<pre><code>#You can't create an item without a name\n</code></pre>\n\n<p>instead of the usual</p>\n\n<pre><code>#Name You can't create an item without a name\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 678, "user_id": 1876625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71046152bb2e7018ac20ff446aa178d4?s=128&d=identicon&r=PG", "display_name": "ehoffmann", "link": "https://stackoverflow.com/users/1876625/ehoffmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1505929088, "creation_date": 1505929088, "answer_id": 46328502, "question_id": 46325571, "link": "https://stackoverflow.com/questions/46325571/activerecord-validations-string-added-to-error-message-in-locales/46328502#46328502", "title": "ActiveRecord Validations : String added to error message in locales", "body": "<p>You could simply use:</p>\n\n<pre><code>@address.errors.messages[:zip_code] # or @address.errors[:zip_code]\n#=&gt; ['Some message']\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 5542252, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hIb6B.jpg?s=128&g=1", "display_name": "David B.", "link": "https://stackoverflow.com/users/5542252/david-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 1, "accepted_answer_id": 46326185, "answer_count": 3, "score": 1, "last_activity_date": 1505983321, "creation_date": 1505919771, "question_id": 46325571, "link": "https://stackoverflow.com/questions/46325571/activerecord-validations-string-added-to-error-message-in-locales", "title": "ActiveRecord Validations : String added to error message in locales", "body": "<p>I'm trying customize validation error messages using i18n.</p>\n\n<p>Let's say I have an Address model that validates the presence of a <code>zip_code</code>.<br>\nMy <code>config/locales/activerecord.fr.yml</code> looks like this</p>\n\n<pre><code>fr:\n  activerecord:\n    errors:\n      models:\n        address:\n          attributes:\n            civility:\n              blank: \"Some message\"\n</code></pre>\n\n<p>The issue if I fail the validation, the error message I'l have in <code>@address.errors.full_messages</code> will be:</p>\n\n<p><code>\"Zip code Some message\"</code></p>\n\n<p>Why does <code>Zip code</code> gets added to my error message ? And how can I avoid this behaviour ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5", "activerecord-relation"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4874925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205825799278143/picture?type=large", "display_name": "dmitryck", "link": "https://stackoverflow.com/users/4874925/dmitryck"}, "edited": false, "score": 0, "creation_date": 1505922897, "post_id": 46326360, "comment_id": 79614125, "body": "<b>Yes, it works, thanx!</b> I search &quot;context&quot; and &quot;scope&quot; and other thing and can not find anything about my situation. I suspected that there is a similar method, but is difficult to formulate this problem for google it. Ps. Yes, i agree, it is unexpected behavior, but it is.. at least in my case"}, {"owner": {"reputation": 61, "user_id": 4874925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205825799278143/picture?type=large", "display_name": "dmitryck", "link": "https://stackoverflow.com/users/4874925/dmitryck"}, "edited": false, "score": 0, "creation_date": 1505924807, "post_id": 46326360, "comment_id": 79615342, "body": "UPD. <code>unscoped</code> work well in some simple cases, but when query is bigger and many methods applies on model from other gems (like closure tree) - it is still some additional condition to summary sql query, depend from start Relation context... strange.. ok, thank you very match!"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "reply_to_user": {"reputation": 61, "user_id": 4874925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205825799278143/picture?type=large", "display_name": "dmitryck", "link": "https://stackoverflow.com/users/4874925/dmitryck"}, "edited": false, "score": 0, "creation_date": 1505926776, "post_id": 46326360, "comment_id": 79616537, "body": "This is weird and confusing, I&#39;ll definitely investigate this when I have some rails project to work on."}, {"owner": {"reputation": 61, "user_id": 4874925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205825799278143/picture?type=large", "display_name": "dmitryck", "link": "https://stackoverflow.com/users/4874925/dmitryck"}, "edited": false, "score": 1, "creation_date": 1505930106, "post_id": 46326360, "comment_id": 79618482, "body": "Thank you. So, as a temporary solution for all cases, for now, i create a &quot;mirrow&quot; AR class, based on same table with same config as first one - <code>User::Mirrow</code> for example, and if some independent query needs inside of ActiveRecord::Relation scope of User model - i use it mirrow class. Very strage solution, but what else can i do)"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "reply_to_user": {"reputation": 61, "user_id": 4874925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205825799278143/picture?type=large", "display_name": "dmitryck", "link": "https://stackoverflow.com/users/4874925/dmitryck"}, "edited": false, "score": 0, "creation_date": 1505998588, "post_id": 46326360, "comment_id": 79648977, "body": "@dmitryck Ok. I managed to do some tests, and I updated my answer - you may be interested."}, {"owner": {"reputation": 61, "user_id": 4874925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205825799278143/picture?type=large", "display_name": "dmitryck", "link": "https://stackoverflow.com/users/4874925/dmitryck"}, "edited": false, "score": 0, "creation_date": 1506022502, "post_id": 46326360, "comment_id": 79663983, "body": "yes, thanx, I will read thoughtfully your updated answer tomorrow, and reply to it"}], "tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 1, "last_activity_date": 1521020438, "last_edit_date": 1521020438, "creation_date": 1505921954, "answer_id": 46326360, "question_id": 46325534, "link": "https://stackoverflow.com/questions/46325534/independent-activerecord-query-inside-activerecordrelation-context/46326360#46326360", "title": "Independent ActiveRecord query inside ActiveRecord::Relation context", "body": "<p>This is very weird and unexpected (unfortunately I can't confirm that, because my computer crashed, and have no rails projects at hand).</p>\n\n<p>I would expect </p>\n\n<pre><code>User.all \n</code></pre>\n\n<p>to create a new scope (or as you call it - context) </p>\n\n<p>Try working around this with </p>\n\n<pre><code>User.unscoped.all\n</code></pre>\n\n<p>Edit: </p>\n\n<p>I tried it out on my project and on clean rails repo, and the results are consistent. </p>\n\n<p>And after thinking a bit - this is maybe not even an issue - I think your approach could be faulty. </p>\n\n<p>In what scenario would you chain <code>User.limit(2).all_users_count</code> ?? I can't think of any. Because either you need all users count, and you call <code>User.all_usert_count</code> (or just <code>User.count</code>)</p>\n\n<p>... or you need something else and you call <code>User.limit(2).where(...)</code> - there's no point in calling <code>all_users_count</code> in that chain, is it?</p>\n\n<p>And, when you think of it, it makes sense. Imagine you had some different method like <code>count_retired</code>, what would you expect from such call: </p>\n\n<p><code>User.limit(2).count_retired</code> ?</p>\n\n<p>The number of retired users not bigger than 2, or the number of all retired users in the system? I would expect the former. </p>\n\n<p>So I think one of two possibilities here: </p>\n\n<ul>\n<li>either you implemented it wrong and should do it in a different way (as described above in the edit section)</li>\n<li>or you have some more complex issue, but you boiled your examples down to a point where they don't make much sense anymore (please follow up with another question if you please, and please, ping me in the comment with a link if you do, because it sounds interesting)</li>\n</ul>\n"}], "owner": {"reputation": 61, "user_id": 4874925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205825799278143/picture?type=large", "display_name": "dmitryck", "link": "https://stackoverflow.com/users/4874925/dmitryck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1521020438, "creation_date": 1505919672, "last_edit_date": 1505920311, "question_id": 46325534, "link": "https://stackoverflow.com/questions/46325534/independent-activerecord-query-inside-activerecordrelation-context", "title": "Independent ActiveRecord query inside ActiveRecord::Relation context", "body": "<p><br>\nThere is some ruby on rails code</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  def self.all_users_count\n    User.all\n  end\nend\n</code></pre>\n\n<p><code>User.all_users_count</code> <br>\nreturns, for example, <strong>100</strong></p>\n\n<p><code>User.limit(5).all_users_count</code> <br>\nNow it return <strong>5</strong> because of ActiveRecord::Relation context, in despite of i wroute name of class <code>User.all</code> instead simple <code>all</code><br>\n(.to_sql show that query always contains <code>limit</code> or <code>where id</code> or other things in other cases)<br></p>\n\n<p>So, how can i make context-independent AR queries inside model methods? like <code>User.all</code> and others?</p>\n\n<p>Thank you!<br></p>\n\n<p>Ps. Or maybe my code has an error or something like this, and in fact <code>User.all</code> inside any methods and context always must returns correct rows count of this model table</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1505919970, "post_id": 46325490, "comment_id": 79611853, "body": "&quot;but it didn&#39;t work&quot; - of course. You&#39;ll need to call <code>split</code> on individual elements."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505920674, "post_id": 46325490, "comment_id": 79612410, "body": "<code>split</code> always returns an array, the <code>to_a</code> is superfluous."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505920898, "post_id": 46325675, "comment_id": 79612620, "body": "You don&#39;t mention <code>map</code> in your explanation, although it&#39;s the essential part."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505921410, "post_id": 46325675, "comment_id": 79613000, "body": "Sorry, now yes @Stefan."}, {"owner": {"reputation": 47, "user_id": 6810869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209196679667634/picture?type=large", "display_name": "Charalambos Pouroutides", "link": "https://stackoverflow.com/users/6810869/charalambos-pouroutides"}, "edited": false, "score": 0, "creation_date": 1505921414, "post_id": 46325675, "comment_id": 79613003, "body": "I did this way because i the phrase will change but i get an undefined method for split def translate word \t \tsentense=word.split \tsentense.split.map(&amp;:chars) \t\tputs split \tend \ttranslate(&quot;I have this phrase&quot;)"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 47, "user_id": 6810869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209196679667634/picture?type=large", "display_name": "Charalambos Pouroutides", "link": "https://stackoverflow.com/users/6810869/charalambos-pouroutides"}, "edited": false, "score": 0, "creation_date": 1505921585, "post_id": 46325675, "comment_id": 79613163, "body": "You&#39;re using split as a variable, but you haven&#39;t defined it @CharalambosPouroutides. And the second split isn&#39;t needed if you&#39;ve initialized sentences as word.split, try <code>def translate word; sentense = word.split; sentense.map(&amp;:chars); end; p translate(&quot;I have this phrase&quot;)</code>."}, {"owner": {"reputation": 47, "user_id": 6810869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209196679667634/picture?type=large", "display_name": "Charalambos Pouroutides", "link": "https://stackoverflow.com/users/6810869/charalambos-pouroutides"}, "edited": false, "score": 0, "creation_date": 1505921755, "post_id": 46325675, "comment_id": 79613296, "body": "Now it works Thank you Sebastian                                                              def translate word;   sentense = word.split;   sentense.map(&amp;:chars);   end;   p translate(&quot;I have this phrase&quot;)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 47, "user_id": 6810869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209196679667634/picture?type=large", "display_name": "Charalambos Pouroutides", "link": "https://stackoverflow.com/users/6810869/charalambos-pouroutides"}, "edited": false, "score": 1, "creation_date": 1505921903, "post_id": 46325675, "comment_id": 79613394, "body": "@CharalambosPouroutides you can omit the temporary variable and simply write <code>word.split.map(&amp;:chars)</code>"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 6, "last_activity_date": 1505921329, "last_edit_date": 1505921329, "creation_date": 1505920073, "answer_id": 46325675, "question_id": 46325490, "link": "https://stackoverflow.com/questions/46325490/how-to-split-an-already-split-array-ruby/46325675#46325675", "title": "How to split an already split array ruby", "body": "<p>You could use <a href=\"https://ruby-doc.org/core-2.4.1/String.html#method-i-split\" rel=\"nofollow noreferrer\"><code>String#split</code></a>, <a href=\"https://ruby-doc.org/core-2.4.1/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\"><code>Enumerable#map</code></a> and <a href=\"https://ruby-doc.org/core-2.4.1/String.html#method-i-chars\" rel=\"nofollow noreferrer\"><code>String#chars</code></a>:</p>\n\n<pre><code>p \"this is a test phrase\".split.map(&amp;:chars)\n#\u00a0=&gt; [[\"t\", \"h\", \"i\", \"s\"], [\"i\", \"s\"], [\"a\"], [\"t\", \"e\", \"s\", \"t\"], [\"p\", \"h\", \"r\", \"a\", \"s\", \"e\"]]\n</code></pre>\n\n<p><code>string.split(' ')</code> could be written as <code>string.split</code>, so you can omit passing the whitespace in parenthesis. </p>\n\n<p>And this also gives you an array, there's no need to use <code>to_a</code>, you'll have an array like <code>[\"this\", \"is\", \"a\", \"test\", \"phrase\"]</code>, so you can use map to get a new array and for each element inside an array of its characters by using <code>.split('')</code> or <code>.chars</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1505946445, "post_id": 46330733, "comment_id": 79626142, "body": "I would use @Sebasti&#225;n&#39;s answer, but thought mine might be of interest."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1505937201, "creation_date": 1505937201, "answer_id": 46330733, "question_id": 46325490, "link": "https://stackoverflow.com/questions/46325490/how-to-split-an-already-split-array-ruby/46330733#46330733", "title": "How to split an already split array ruby", "body": "<pre><code>def chop_up(str)\n  str.strip.each_char.with_object([[]]) { |c,a| c == ' ' ? (a &lt;&lt; []) : a.last &lt;&lt; c }\nend\n\nchop_up \"fee fi fo fum\"\n  #=&gt; [[\"f\", \"e\", \"e\"], [\"f\", \"i\"], [\"f\", \"o\"], [\"f\", \"u\", \"m\"]]\nchop_up \" fee fi fo fum \"\n  #=&gt; [[\"f\", \"e\", \"e\"], [\"f\", \"i\"], [\"f\", \"o\"], [\"f\", \"u\", \"m\"]]\nchop_up \"feefifofum \"\n  #=&gt; [[\"f\", \"e\", \"e\", \"f\", \"i\", \"f\", \"o\", \"f\", \"u\", \"m\"]]\nchop_up \"\"\n  #=&gt; [[]]\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6810869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209196679667634/picture?type=large", "display_name": "Charalambos Pouroutides", "link": "https://stackoverflow.com/users/6810869/charalambos-pouroutides"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 46325675, "answer_count": 2, "score": 2, "last_activity_date": 1505937201, "creation_date": 1505919546, "last_edit_date": 1505919871, "question_id": 46325490, "link": "https://stackoverflow.com/questions/46325490/how-to-split-an-already-split-array-ruby", "title": "How to split an already split array ruby", "body": "<p>I have this function in Ruby</p>\n\n<pre><code>def translate word  \n  vowels=[\"a\",\"e\",\"I\",\"O\",\"U\"]  \n  i=1.to_i\n  sentense=word.split(\" \").to_a     \n  puts sentense if sentense.length &gt;=1\n  sentense.split(\"\")        \n  puts sentense     \nend\n</code></pre>\n\n<p>I have this phrase \"this is a test phrase \" and at first I want to create an array that looks like:</p>\n\n<pre><code>[\"this\",\"is\",\"a\", \"test\", \"phrase\"]\n</code></pre>\n\n<p>Then I want to create another array  it to look like:\n<code>[[\"t\",\"h\",\"i\",\"s\"],[\"i\",\"s\"],[\"a\"],[\"t\",\"e\",\"s\",\"t\"],[\"p\",\"h\",\"r\",\"a\",\"s\",\"e\"]</code>.</p>\n\n<p>I tried </p>\n\n<pre><code>sentense=word.split(\" \").to_a\nnew_array=sentense.split(\"\").to_a\n</code></pre>\n\n<p>but it didn't work</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-2.4"], "comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1505928050, "post_id": 46325271, "comment_id": 79617264, "body": "Please post code snippets instead of screenshots"}, {"owner": {"reputation": 1, "user_id": 6229471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e86bcc8731fab6f1e61a38bf164f1b5f?s=128&d=identicon&r=PG&f=1", "display_name": "khush", "link": "https://stackoverflow.com/users/6229471/khush"}, "reply_to_user": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1505996281, "post_id": 46325271, "comment_id": 79647199, "body": "@NickM Please see my edited post"}], "answers": [{"tags": [], "owner": {"reputation": 3493, "user_id": 1323481, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4825c6c1cdfd05c2af6fb8db0d492f73?s=128&d=identicon&r=PG", "display_name": "StandardNerd", "link": "https://stackoverflow.com/users/1323481/standardnerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1505922783, "creation_date": 1505922783, "answer_id": 46326626, "question_id": 46325271, "link": "https://stackoverflow.com/questions/46325271/ruby-on-rails-after-rails-s-is-entered/46326626#46326626", "title": "Ruby on Rails - after rails_s is entered", "body": "<p>The error message indicates that SQLite is not installed or properly configured.\nTry starting rails server after installing SQLite first.</p>\n\n<p>Maybe this tutorial is helpful to get SQLite up and running:</p>\n\n<p><a href=\"http://www.sqlitetutorial.net/download-install-sqlite/\" rel=\"nofollow noreferrer\">http://www.sqlitetutorial.net/download-install-sqlite/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6229471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e86bcc8731fab6f1e61a38bf164f1b5f?s=128&d=identicon&r=PG&f=1", "display_name": "khush", "link": "https://stackoverflow.com/users/6229471/khush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505996298, "creation_date": 1505918987, "last_edit_date": 1505996298, "question_id": 46325271, "link": "https://stackoverflow.com/questions/46325271/ruby-on-rails-after-rails-s-is-entered", "title": "Ruby on Rails - after rails_s is entered", "body": "<p>I am learning Ruby on Rails and still unfamilar with some of parts of the language. </p>\n\n<p>I am trying to get a rails project to display on Firefox however as soon as I enter the command \"rails s\" I am presented with the following error:\n<a href=\"https://i.stack.imgur.com/e9G0q.jpg\" rel=\"nofollow noreferrer\">Rails S Error </a> \nThe source code is : </p>\n\n<p>C:\\Sites\\weeks_1_-_15\\week_1\\bookshop1a>rails s\nC:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/activesupport-4.0.2/lib/act\nive_support/values/time_zone.rb:282: warning: circular argument reference - now\nC:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/sqlite3-1.3.10-x86-mingw32/\nlib/sqlite3.rb:6:in <code>require': cannot load such file -- sqlite3/sqlite3_native (\nLoadError)\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/sqlite3-1.3.10\n-x86-mingw32/lib/sqlite3.rb:6:in</code>rescue in '\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/sqlite3-1.3.10\n-x86-mingw32/lib/sqlite3.rb:2:in <code>&lt;top (required)&gt;'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/bundler-1.13.6\n/lib/bundler/runtime.rb:91:in</code>require'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/bundler-1.13.6\n/lib/bundler/runtime.rb:91:in <code>block (2 levels) in require'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/bundler-1.13.6\n/lib/bundler/runtime.rb:86:in</code>each'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/bundler-1.13.6\n/lib/bundler/runtime.rb:86:in <code>block in require'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/bundler-1.13.6\n/lib/bundler/runtime.rb:75:in</code>each'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/bundler-1.13.6\n/lib/bundler/runtime.rb:75:in <code>require'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/bundler-1.13.6\n/lib/bundler.rb:106:in</code>require'\n        from C:/Sites/weeks_1_-_15/week_1/bookshop1a/config/application.rb:7:in\n<code>&lt;top (required)&gt;'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/railties-4.0.2\n/lib/rails/commands.rb:74:in</code>require'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/railties-4.0.2\n/lib/rails/commands.rb:74:in <code>block in &lt;top (required)&gt;'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/railties-4.0.2\n/lib/rails/commands.rb:71:in</code>tap'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/railties-4.0.2\n/lib/rails/commands.rb:71:in <code>&lt;top (required)&gt;'\n        from script/rails:6:in</code>require'\n        from script/rails:6:in `'</p>\n\n<p>Any help would be much appreciated!</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby", "function", "hash", "key"], "comments": [{"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1506636937, "post_id": 46324955, "comment_id": 79913226, "body": "What happens if in your example the key <code>&quot;aab&quot;</code> exists?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "edited": false, "score": 0, "creation_date": 1505940940, "post_id": 46329465, "comment_id": 79623994, "body": "I&#39;m returning &quot;1&quot; because that&#39;s what&#39;s in my example.  If I ahd put in &quot;55&quot; then the example would have returned &quot;55&quot;.  Anyway when you say &quot;go through all candidates (at least those having the same length +-1) stored in the hash to evaluate whether they match&quot;, you&#39;re essentially restating my question.  I seek an answer to how to do that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "edited": false, "score": 0, "creation_date": 1506029770, "post_id": 46329465, "comment_id": 79667157, "body": "Thanks for your expanded answer.  I&#39;m a little slow when it omes to all this, so when you say &quot;The same can basically be done using a Hash as the superclass&quot;, what methods am I overriding to make the hash lookup work in the way I describe?"}, {"owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "edited": false, "score": 0, "creation_date": 1506032338, "post_id": 46329465, "comment_id": 79667995, "body": "I added the Hash implementation"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "edited": false, "score": 0, "creation_date": 1506382033, "post_id": 46329465, "comment_id": 79788933, "body": "thanks but this didn&#39;t quite work out.  If I set &quot;hash[&quot;abc&quot;] = 1&quot; and then ran &quot;hash[&quot;abb&quot;]&quot;, I got back &quot;ab&quot;.  However I should be getting &quot;1&quot; because per the function I listed in my question -- str_almost_equal(&quot;abc&quot;, &quot;abb&quot;) evaluates to true."}, {"owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "edited": false, "score": 0, "creation_date": 1506405333, "post_id": 46329465, "comment_id": 79794871, "body": "@Natalia, I altered the <code>VariantsHash</code> to correctly return the value set for any of the variants. <code>hash[&quot;abb&quot;]</code> will now return 1 as specified. Thanks for pointing out the bug."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "edited": false, "score": 0, "creation_date": 1506441590, "post_id": 46329465, "comment_id": 79819340, "body": "Still a coupel of bumps.  Setting &quot;hash[&quot;aab&quot;] = 1&quot; and then calling &quot;hash[&quot;baa&quot;]&quot; produces 1 instead of nil.  Per my function, str_almost_equal, &quot;aab&quot; and &quot;baa&quot; would evaluate to false.  Is there anyway to incorporate my function into the custom hash?  That might simplify things."}, {"owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "edited": false, "score": 0, "creation_date": 1506459476, "post_id": 46329465, "comment_id": 79828577, "body": "Updated again @Natalia to include a placeholder so that your scenario is covered now. Incorporating your function would be possible but doing so would increase the time necessary to fetch an item from O(1) to O(n). One might be able to optimize this but it would never be as fast as accessing a hash is supposed to be."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "edited": false, "score": 0, "creation_date": 1506540175, "post_id": 46329465, "comment_id": 79866957, "body": "Ok this is looking pretty good.  Setting &#39;hash[&quot;aaa&quot;] = 1&#39; returns &quot;1&quot; if I call &quot; hash[&quot;aab&quot;]&quot;.  The problem is if I run &quot;hash.delete(&quot;aaa&quot;)&quot; and then call &#39;hash[&quot;aab&quot;]&#39;, it still returns 1, even though my hash is empty at this point, and should return nothing."}, {"owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "edited": false, "score": 0, "creation_date": 1506542361, "post_id": 46329465, "comment_id": 79868113, "body": "@Natalia fixed that problem"}], "tags": [], "owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "is_accepted": false, "score": 2, "last_activity_date": 1506542253, "last_edit_date": 1506542253, "creation_date": 1505932634, "answer_id": 46329465, "question_id": 46324955, "link": "https://stackoverflow.com/questions/46324955/how-do-i-create-a-custom-hash-in-which-the-key-lookup-is-based-on-a-function-i-d/46329465#46329465", "title": "How do I create a custom hash in which the key lookup is based on a function I define?", "body": "<p>You can define your own class inheriting from <code>Hash</code> and override the <code>[](key)</code> method to your liking. So e.g. </p>\n\n<pre><code>class MyHash &lt; Hash\n  def [](key)\n    # do something to return the appropriate value\n  end\nend\n</code></pre>\n\n<p>Based on other methods of the Hash interface your calling code requires, you may need to override additional methods.</p>\n\n<p>However, given your use case I doubt that you will be able to implement that method in a very efficient way as you would have to go through all candidates (at least those having the same length +-1) stored in the hash to evaluate whether they match. Of course, if there are not a lot of candidates in the hash, you might get away with it.</p>\n\n<p>On top of that, I don't think that the behaviour of returning 1 when providing a key for lookup in a hash is a very hash like behaviour. I'd rather return the match. Returning 1 will violate the principle of least surprise IMO. </p>\n\n<hr>\n\n<p><strong>Addition after OP's comment</strong> </p>\n\n<p>Without knowing your exact use case, so maybe I am off, I would sacrifice speed at insertion time and space for the sake of speed at lookup time. That means that I would precalculate all variants of a key at insertion time and insert those into the object used for storing. </p>\n\n<pre><code>class VariantsSet &lt; Set \n\n  PLACEHOLDER = '_' # Use a character that will not be used in your keys\n\n  def add_variants(string)\n    merge(all_variants(string))\n  end \n\n  def delete(string)\n    all_variants(string).each { |variant| super(variant) }\n  end\n\n  def includes_any_variant?(string)\n    all_variants(string).any? { |variant| include?(variant) }\n  end\n\n  private\n\n  def all_variants(string)\n    downcase_string = string.downcase\n    string_length = string.length\n\n    variants = [downcase_string]\n\n    string_length.times do |i|\n      variants &lt;&lt; downcase_string[0, i] + PLACEHOLDER + downcase_string[i + 1 , string_length]\n    end\n\n    variants\n  end\nend\n</code></pre>\n\n<p>Usage would then be as follows:</p>\n\n<pre><code>2.4.2 :026 &gt; s = VariantsSet.new\n =&gt; #&lt;VariantsSet: {}&gt; \n2.4.2 :027 &gt; s.add_variants('foobar')\n =&gt; #&lt;VariantsSet: {\"foobar\", \"_oobar\", \"f_obar\", \"fo_bar\", \"foo_ar\", \"foob_r\", \"fooba_\"}&gt; \n2.4.2 :028 &gt; s.includes_any_variant?('foobaz')\n =&gt; true \n2.4.2 :029 &gt; s.includes_any_variant?('blubs')\n =&gt; false \n</code></pre>\n\n<p>Depending on the number of keys you want to store, this might require quite some RAM so if it gets out of hand, you might have to employ e.g. a database to store the values. But I would still recommend precalculating the variants.</p>\n\n<p>The same can basically be done using a Hash as the superclass if that is more to your liking. </p>\n\n<hr>\n\n<p><strong>Expanded to show hash implementation</strong></p>\n\n<pre><code>class VariantsHash &lt; Hash\n\n  PLACEHOLDER = '_' # Use a character that will not be used in your keys\n\n  def []=(string, value)\n    all_variants(string).each do |variant|\n      super(variant, value)\n    end\n  end \n\n  def delete(string)\n    all_variants(string).each do |variant|\n      super(variant)\n    end\n  end \n\n  def [](string)\n    match = all_variants(string).detect do |variant|\n      super(variant)\n    end\n\n    super(match) if match\n  end\n\n  private\n\n  def all_variants(string)\n    downcase_string = string.downcase\n    string_length = string.length\n\n    variants = [downcase_string]\n\n    string_length.times do |i|\n      variants &lt;&lt; downcase_string[0, i] + PLACEHOLDER + downcase_string[i + 1 , string_length]\n    end\n\n    variants\n  end\nend \n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "edited": false, "score": 0, "creation_date": 1506541564, "post_id": 46442139, "comment_id": 79867688, "body": "Why do you have both &quot;Hash&quot; and &quot;NewHash&quot; classes?  Shouldn&#39;t I only need just your &quot;NewHash&quot; class?  I don&#39;t want to hcange the underlying functionality of all hashes, just create a new one with different functionality."}, {"owner": {"reputation": 100, "user_id": 1386970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4dba251f8bf039aa3f83b984228db4?s=128&d=identicon&r=PG", "display_name": "Kapuzzi", "link": "https://stackoverflow.com/users/1386970/kapuzzi"}, "edited": false, "score": 0, "creation_date": 1506568623, "post_id": 46442139, "comment_id": 79875835, "body": "I just listed 3 solutions for you. So if you dont want to change <code>Hash</code>, just use <code>NewHash</code>."}], "tags": [], "owner": {"reputation": 100, "user_id": 1386970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4dba251f8bf039aa3f83b984228db4?s=128&d=identicon&r=PG", "display_name": "Kapuzzi", "link": "https://stackoverflow.com/users/1386970/kapuzzi"}, "is_accepted": true, "score": 0, "last_activity_date": 1506498152, "creation_date": 1506498152, "answer_id": 46442139, "question_id": 46324955, "link": "https://stackoverflow.com/questions/46324955/how-do-i-create-a-custom-hash-in-which-the-key-lookup-is-based-on-a-function-i-d/46442139#46442139", "title": "How do I create a custom hash in which the key lookup is based on a function I define?", "body": "<p>This might not the best answer, but I think it can help you</p>\n\n<p>Use new class</p>\n\n<pre><code>class NewHash &lt; Hash\n  def [](key)\n    if keys.include?(key)\n      super\n    else\n      found = keys.find { |k| compare_almost(k, key) }\n      self[found] if found\n    end\n  end\n\n  private\n\n  def compare_almost(a, b)\n    a.downcase == b.downcase ||\n      (a.size == b.size &amp;&amp; a.downcase.chars.map.with_index{|c, i| c == b.downcase[i]}.count(false) == 1)\n  end\nend\n\nhash = NewHash.new\nhash['aaa'] = 1\np hash['aab'] # =&gt; 1\np hash['acs'] # =&gt; nil\n</code></pre>\n\n<p>Use module for each object</p>\n\n<pre><code>module CompareAlmost\n  def [](key)\n    if keys.include?(key)\n      super\n    else\n      found = keys.find { |k| compare_almost(k, key) }\n      self[found] if found\n    end\n  end\n\n  private\n\n  def compare_almost(a, b)\n    a.downcase == b.downcase ||\n      (a.size == b.size &amp;&amp; a.downcase.chars.map.with_index{|c, i| c == b.downcase[i]}.count(false) == 1)\n  end\nend\n\nhash = {'aaa' =&gt; 2}\nhash.extend CompareAlmost\np hash['aab'] # =&gt; 2\n</code></pre>\n\n<p>replace origin Hash class</p>\n\n<pre><code>class Hash\n  def [](key)\n    if keys.include?(key)\n      fetch key\n    else\n      found = keys.find { |k| compare_almost(k, key) }\n      self[found] if found\n    end\n  end\n\n  private\n\n  def compare_almost(a, b)\n    a.downcase == b.downcase ||\n      (a.size == b.size &amp;&amp; a.downcase.chars.map.with_index{|c, i| c == b.downcase[i]}.count(false) == 1)\n  end\nend\n\nhash = { 'aaa' =&gt; 3 }\np hash['aab'] # =&gt; 3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "is_accepted": false, "score": 0, "last_activity_date": 1506646631, "last_edit_date": 1506646631, "creation_date": 1506646161, "answer_id": 46480231, "question_id": 46324955, "link": "https://stackoverflow.com/questions/46324955/how-do-i-create-a-custom-hash-in-which-the-key-lookup-is-based-on-a-function-i-d/46480231#46480231", "title": "How do I create a custom hash in which the key lookup is based on a function I define?", "body": "<p>It's not clear from your question what is your use case, specifically, what should happen if the key already exists. Assuming you only want to use your custom function to look up a value when the key does not exist, then it's just setting a custom default value to the hash. If that's the case, the solution is pretty simple:</p>\n\n<pre><code>## your custom function, changed to a Proc so it can be passed to a method\nstr_almost_equal = Proc.new do |a,b|\n    a.downcase == b.downcase || (a.size == b.size &amp;&amp; a.downcase.chars.map.with_index{|c, i| c == b.downcase[i]}.count(false) == 1)\n  end\n\n## iterator to run all values through your function\ndef check_all(a, array, func)\n  array.each do |n|\n    return n if func.call(a, n)\n  end\nend\n\n## Hash with custom default value\nh = Hash.new do |h,k| \n  if k.is_a? String\n    key = check_all(k, h.keys, str_almost_equal) \n    h[key] if key\n  end\n\nh[\"aaa\"]    ## nil\nh[\"aaa\"] = 3\nh[\"aab\"]    ## 3\nh[\"bab\"]    ## nil\nh[\"aab\"] = 4\nh[\"aab\"]    ## 4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1738, "user_id": 3353322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13ac896746c0573667cd0190c621b53d?s=128&d=identicon&r=PG", "display_name": "Jack Noble", "link": "https://stackoverflow.com/users/3353322/jack-noble"}, "is_accepted": false, "score": 0, "last_activity_date": 1506719915, "creation_date": 1506719915, "answer_id": 46497035, "question_id": 46324955, "link": "https://stackoverflow.com/questions/46324955/how-do-i-create-a-custom-hash-in-which-the-key-lookup-is-based-on-a-function-i-d/46497035#46497035", "title": "How do I create a custom hash in which the key lookup is based on a function I define?", "body": "<p>For user created types Hash look-up uses two methods <code>#eql?</code> and <code>#hash</code>. This is the canonical way to override Hash behavior.</p>\n\n<pre><code>class StringWrapper\n  attr_reader :string\n\n  def initialize(string)\n    @string = string\n  end\n\n  def eql?(other)\n    string.downcase == other.string.downcase ||\n    (string.size == other.string.size &amp;&amp; \n     string.downcase.chars.map.with_index{|c, i| c == \n     other.string.downcase[i]}.count(false) == 1\n    )\n  end\n\n  def hash\n    # never actually do this part\n    0\n  end\nend\n\nhash = {}\nhash[StringWrapper.new(\"aaa\")] = 1\nhash[StringWrapper.new(\"aab\")] # =&gt; 1\n</code></pre>\n\n<p>But the reason to use Hash instead of other datatypes is that no matter how much data you have the time it takes to look up a key normally does not grow. But in our implementation above we've broken that. To see how let's look at how hashes work. Under the hood your data is being stored roughly like this<sup>1</sup>:</p>\n\n<pre><code>|0  |1  |2  |3  |4  |5  |6  |7  |8  |9  |10 |\n|   |   |   |aaa|   |   |aad|   |   |   |aab|\n|   |   |   |aae|   |   |   |   |   |   |   |\n</code></pre>\n\n<p>When you look up a key in your hash Ruby doesn't compare it to all the keys that are already there. If it did that then look-up would get slower and slower the more keys you added. Instead it generates a hash for the key -- generally a big pseudo-random number. On my computer <code>\"aaa\".hash</code> returns 2707793439826082248 for example. <code>2707793439826082248 % 11</code> is <code>3</code> so it get's put in bucket number 3. Then when we need to look it up the process happens again and Ruby knows which bucket to check. Now instead of checking every key it only has to check those stored in bucked 3. Here is what we did when we defined <code>#hash</code> to always return 0. </p>\n\n<pre><code>|0  |1  |2  |3  |4  |5  |6  |7  |8  |9  |10 |\n|aaa|   |   |   |   |   |   |   |   |   |   |\n|aab|   |   |   |   |   |   |   |   |   |   |\n|aac|   |   |   |   |   |   |   |   |   |   |\n|aad|   |   |   |   |   |   |   |   |   |   |\n</code></pre>\n\n<p>Every object gets stored in the same bucket so we've broken Hash look-up performance. When defining a custom hash method you need something that can that is the same every time you calculate it and appears random so the modulo operation spread your data evenly across the buckets. But the hash method must also respect your implementation of <code>#eql?</code>. If it doesn't you'll end up looking in the wrong bucket most of the time. For example if you wanted a hash that treated objects starting with the same letter as equal that would be easy.</p>\n\n<pre><code> def hash\n   string[0].hash\n end\n</code></pre>\n\n<p>The problem with what you're asking for is that one can construct a series of look-ups in which every string is equal to every other. \"foo\" === \"boo\". \"boo\" == \"bao\". \"bao\" == \"bar\". For the program to respect your definition of equality all of those strings would need to be in the same hash bucket. That means in order for your hash to behave the way you describe <em>every string</em> needs to have the same hash bucket. And that by definition isn't a true Hash. So I think you should step back and consider what problem it is you're trying to solve and whether or not a hash is really the right way to go.</p>\n\n<p>You could certainly do what ulferts suggests at the cost of using more memory but what happens with</p>\n\n<pre><code>hash = { \"aaa\" =&gt; 1 }\nhash[\"cab\"] = 2\nhash[\"aab\"]\n</code></pre>\n\n<p><sup>1</sup>: Ruby hashes with a small number of items are actually implemented as arrays, at least in MRI. These diagrams are hopefully helpful for explaining how hash tables work at a high level, not for actually showing how a given Ruby has implemented them. I'm sure there are any number of inaccuracies with them.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1145, "favorite_count": 0, "accepted_answer_id": 46442139, "answer_count": 4, "score": 0, "last_activity_date": 1506719915, "creation_date": 1505918109, "question_id": 46324955, "link": "https://stackoverflow.com/questions/46324955/how-do-i-create-a-custom-hash-in-which-the-key-lookup-is-based-on-a-function-i-d", "title": "How do I create a custom hash in which the key lookup is based on a function I define?", "body": "<p>I'm using Ruby 2.4.  How can I create a custom hash where the lookup function for the key is something I define?  I have this function ...</p>\n\n<pre><code>  def str_almost_equal(a, b)\n    a.downcase == b.downcase || (a.size == b.size &amp;&amp; a.downcase.chars.map.with_index{|c, i| c == b.downcase[i]}.count(false) == 1)\n  end\n</code></pre>\n\n<p>and I would like my hash to lookup keys if both the classes of the keys are Strings and they match the method above.  So for instance, if I have</p>\n\n<pre><code>hash = []\nhash[\"aaa\"] = 1\n</code></pre>\n\n<p>Then I want hash[\"aab\"] to return 1, because \"aaa\" and \"aab\" evaluate to true using the function I have defined.</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7185665, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205756490870963/picture?type=large", "display_name": "Alvin Senjaya", "link": "https://stackoverflow.com/users/7185665/alvin-senjaya"}, "edited": false, "score": 0, "creation_date": 1505957669, "post_id": 46325379, "comment_id": 79628718, "body": "Thank you! that really helps a lot. Plus the tips you gave me really useful to simplified parameters name."}], "tags": [], "owner": {"reputation": 764, "user_id": 3941583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8491782c07722842e31ab6fd3c68c12?s=128&d=identicon&r=PG", "display_name": "Peter Toth - Toma", "link": "https://stackoverflow.com/users/3941583/peter-toth-toma"}, "is_accepted": true, "score": 0, "last_activity_date": 1505919274, "creation_date": 1505919274, "answer_id": 46325379, "question_id": 46322772, "link": "https://stackoverflow.com/questions/46322772/first-attempt-in-ruby-rspec/46325379#46325379", "title": "First attempt in Ruby Rspec", "body": "<p>You can access the type in the constructor simply: <code>question_answer[:question].type</code>, or later in object level methods: <code>@question.type</code>.</p>\n\n<p>You can't access it like <code>question_answer[:question][:type]</code> because the <code>double</code> method in the test creates a classic like object rather than a hash.</p>\n\n<p>A tip: when a method accepts parameters as a single hash you can simply name that as <code>options</code> or <code>params</code> but if you have only 3-4 params, you can use separate variables for params instead of a hash</p>\n"}], "owner": {"reputation": 29, "user_id": 7185665, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205756490870963/picture?type=large", "display_name": "Alvin Senjaya", "link": "https://stackoverflow.com/users/7185665/alvin-senjaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 46325379, "answer_count": 1, "score": 0, "last_activity_date": 1505919274, "creation_date": 1505912336, "question_id": 46322772, "link": "https://stackoverflow.com/questions/46322772/first-attempt-in-ruby-rspec", "title": "First attempt in Ruby Rspec", "body": "<p>I am new to Ruby and Rspec, and so I happened to found this bit of code:<br>\nHere is my Specification:</p>\n\n<pre><code>RSpec.describe Surveyor::Answer, '03: Answer validations' do\n\ncontext \"for a free text question\" do\n  let(:question) { double(Surveyor::Question, type: 'free_text') }\n\n  # NOTE: The rating validations should not apply for 'free_text' questions.\n  subject { described_class.new(question: question, value: 'anything') }\n  it { should be_valid }\nend\n</code></pre>\n\n<p>Here is my Class:<br></p>\n\n<pre><code>module Surveyor\n  class Answer\n    def initialize(question_answer)\n      @question = question_answer[:question]\n      @answer = question_answer[:value]\n    end\n\n    def question_type\n      # I want to check what is the type of question here.\n      # 'free_text' or 'rating'\n      # if free_text \n      #   print question type\n      # else \n      #   do something\n    end\nend\n</code></pre>\n\n<p>My question is how can I print(puts) the type of question (free_text/rating) in Answer class?<br></p>\n\n<p>When I tried using <code>print question_answer[:question]</code>it only gave me <code>#&lt;Double Surveyor::Question&gt;</code><br>\nSo I could not use <code>question_answer[:question][:type]</code></p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "is_accepted": false, "score": 0, "last_activity_date": 1505915902, "last_edit_date": 1505915902, "creation_date": 1505912947, "answer_id": 46322960, "question_id": 46322491, "link": "https://stackoverflow.com/questions/46322491/comparing-2-tables-in-rails-5/46322960#46322960", "title": "Comparing 2 tables in rails 5", "body": "<p>If you have a lot of data the solution of plucking <code>practice_id</code> and subtracting them is poorly performing. Instead I suggest:</p>\n\n<p><strong>Okish:</strong></p>\n\n<pre><code>LatestPractice.where.not(practice_id: ExistingPractice.select(:practice_id).map(&amp;:practice_id))\n</code></pre>\n\n<p><strong>better:</strong> </p>\n\n<pre><code>LatestPractice.where.not(\"EXISTS(SELECT 1 from existing_practices where latest_practices.practice_id = existing_practices.practice_id)\")\n</code></pre>\n\n<p><strong>much better:</strong></p>\n\n<pre><code>LatestPractice.where('practice_id NOT IN(SELECT DISTINCT(practice_id) FROM existing_practices)')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1505913170, "post_id": 46323022, "comment_id": 79606747, "body": "I say that&#39;s more like ruby way, but I wouldn&#39;t commit that code to production."}, {"owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "reply_to_user": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1505914648, "post_id": 46323022, "comment_id": 79607901, "body": "@radubogdan  he is asking in rails way only. by the way you are fetching table row but he asked id as array. first read question properly"}, {"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "reply_to_user": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1505914844, "post_id": 46323022, "comment_id": 79608043, "body": "@krishnar First of all the only question he has is <code>Can anyone help?</code>. Second of all he is only showing what he did, that doesn&#39;t mean you need to follow it. Third of all this solution does not perform well for M of records. Cheers."}, {"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "reply_to_user": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1505915372, "post_id": 46323022, "comment_id": 79608498, "body": "@krishnar and he&#39;s trying to substract arrays of ActiveRecords, obviously he wants to end up with a relation or array of ActiveRecords :)"}, {"owner": {"reputation": 1050, "user_id": 2487790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxzEQ.jpg?s=128&g=1", "display_name": "Moustafa Sallam", "link": "https://stackoverflow.com/users/2487790/moustafa-sallam"}, "reply_to_user": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1505915508, "post_id": 46323022, "comment_id": 79608583, "body": "@radubogdan this is just a different answer no one says it is better, your solutions could much be better, but it doesn&#39;t mean it is the only solutions."}], "tags": [], "owner": {"reputation": 1050, "user_id": 2487790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxzEQ.jpg?s=128&g=1", "display_name": "Moustafa Sallam", "link": "https://stackoverflow.com/users/2487790/moustafa-sallam"}, "is_accepted": false, "score": 0, "last_activity_date": 1505920510, "last_edit_date": 1505920510, "creation_date": 1505913121, "answer_id": 46323022, "question_id": 46322491, "link": "https://stackoverflow.com/questions/46322491/comparing-2-tables-in-rails-5/46323022#46323022", "title": "Comparing 2 tables in rails 5", "body": "<p>You can use sql directly for better performance.</p>\n\n<pre><code>new_practices_id = ActiveRecord::Base.connection.execute(\"SELECT DISTINCT latest_practices.practice_id FROM latest_practices LEFT JOIN existing_practices ON latest_practices.practice_id =\nexisting_practices.practice_id WHERE existing_practices.practice_id IS NULL\")\n</code></pre>\n\n<p>This will return an array of the <code>practice_id</code> that doesn't exist at the <code>existing_practices</code> table.</p>\n\n<p>here is the fiddle example <a href=\"http://sqlfiddle.com/#!9/755594/3\" rel=\"nofollow noreferrer\" title=\"compare two tables\">company two columns or tables</a></p>\n\n<p>you can do it like this with <code>pluck</code></p>\n\n<pre><code>new_practices = LatestPractice.pluck(:practice_id) - ExistingPractice.pluck(:practice_id)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "is_accepted": true, "score": 2, "last_activity_date": 1505914467, "creation_date": 1505914467, "answer_id": 46323554, "question_id": 46322491, "link": "https://stackoverflow.com/questions/46322491/comparing-2-tables-in-rails-5/46323554#46323554", "title": "Comparing 2 tables in rails 5", "body": "<p><strong>pluck</strong> used to fetch column value as array</p>\n\n<pre><code>new_practices = LatestPractice.pluck(:practice_id) - ExistingPractice.pluck(:practice_id)\n</code></pre>\n"}], "owner": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 46323554, "answer_count": 3, "score": 0, "last_activity_date": 1505920510, "creation_date": 1505911504, "question_id": 46322491, "link": "https://stackoverflow.com/questions/46322491/comparing-2-tables-in-rails-5", "title": "Comparing 2 tables in rails 5", "body": "<p>I have 2 tables \"existing_practices\" &amp; \"latest_practices\", both contain a column \"practice_id\"</p>\n\n<p>What I want to do is compare latest_practices with the existing_practices to find which practices are on the latest_practices table that I don't have on my existing_practices (in other words I need to find the new practices)</p>\n\n<p>Example:</p>\n\n<pre><code>existing_practices      latest_practices\n------------------      ------------------\npractice_id             practice_id\nA123                    A123\nB123                    B123\nC123                    C123\n                        D123\n</code></pre>\n\n<p>So given the 2 above tables I would need to identify that \"D123\" is a new practice.</p>\n\n<p>I have tried the following but it doesn't seem to work:</p>\n\n<pre><code>existing_practices = ExistingPractice.select(:practice_id).all\nlatest_practices = LatestPractice.select(:practice_id).all\n\nnew_practices = latest_practices.to_a - existing_practices.to_a\n</code></pre>\n\n<p>I'm thinking the easiest way is to just write the raw sql but i want to do it the rails way (if there is one).</p>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "testing"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 4, "creation_date": 1505911034, "post_id": 46322276, "comment_id": 79605254, "body": "Because two <code>validates</code> clauses are \u201c<b>each</b>,\u201d not \u201c<b>either</b>.\u201d Please show the test itself."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1505912219, "post_id": 46322276, "comment_id": 79606063, "body": "You get errors precisely because new restrictions <b>do not</b> override/cancel old ones."}], "answers": [{"tags": [], "owner": {"reputation": 1050, "user_id": 2487790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxzEQ.jpg?s=128&g=1", "display_name": "Moustafa Sallam", "link": "https://stackoverflow.com/users/2487790/moustafa-sallam"}, "is_accepted": true, "score": 1, "last_activity_date": 1505911936, "creation_date": 1505911936, "answer_id": 46322627, "question_id": 46322276, "link": "https://stackoverflow.com/questions/46322276/why-the-validates-overrides-old-restrictions/46322627#46322627", "title": "Why the validates overrides old restrictions", "body": "<p>You are validating Both <code>domain</code> and <code>IP</code> <strong>Both of them not Either one.</strong></p>\n\n<p>The first test for the ip address would fail and return false even if you provide a valid ip address.</p>\n\n<p>I think the right tests should be as the following </p>\n\n<pre><code>test 'test an url with a IP address containing characters' do\n  url = Url.new()\n  url.ipaddress = '192.168.2.AAA'\n  url.domain = 'http://google.com'\n  assert_equal(false, url.valid?, 'Test a invalid IP address')\nend\n\ntest 'test url using a valid domain' do\n  url = Url.new()\n  url.ipaddress = '192.168.2.1'\n  url.domain = 'http://google.com'\n  assert_equal(true, url.valid?, 'Test a valid domain')\nend \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1505912491, "post_id": 46322645, "comment_id": 79606256, "body": "Also I really don&#39;t see why you would create such a model in the first place when Ruby has a <a href=\"https://docs.ruby-lang.org/en/2.1.0/URI.html\" rel=\"nofollow noreferrer\">URI module</a> for this very purpose."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1505912422, "last_edit_date": 1505912422, "creation_date": 1505912006, "answer_id": 46322645, "question_id": 46322276, "link": "https://stackoverflow.com/questions/46322276/why-the-validates-overrides-old-restrictions/46322645#46322645", "title": "Why the validates overrides old restrictions", "body": "<p>Your testing methodology and assumptions about validations are wrong. The <code>.valid?</code> method runs all of the validations in the model. The resulting errors are added to the errors hash in the model instance. If the errors hash is empty then it returns true (it is valid) otherwise false.</p>\n\n<p>Therefore testing validations by asserting that <code>.valid?</code> is true/false is error prone since each test must take every other validation into consideration. </p>\n\n<p>To test a single validation in isolation you should write assertions about the errors hash:</p>\n\n<pre><code>test 'test an url with a IP address containing characters' do\n  url = Url.new(ipaddress: '192.168.2.AAA')\n  url.valid? # runs the validations\n  assert_true(url.errors.has_key?(:ipaddress))\n  assert_contains(url.errors][:ipaddress], 'Deve ser um endereco IP valido')\nend\n\ntest 'test an url with a valid ip' do\n  url = Url.new(ipaddress: '192.168.2.1')\n  url.valid? # runs the validations\n  assert_false(url.errors.has_key?(:ipaddress))\nend\n</code></pre>\n"}], "owner": {"reputation": 629, "user_id": 7116039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-W1XRU2i8SxQ/AAAAAAAAAAI/AAAAAAAAAHs/ceXJf5aD9w4/photo.jpg?sz=128", "display_name": "olegario", "link": "https://stackoverflow.com/users/7116039/olegario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 46322627, "answer_count": 2, "score": 0, "last_activity_date": 1505912422, "creation_date": 1505910904, "last_edit_date": 1505911265, "question_id": 46322276, "link": "https://stackoverflow.com/questions/46322276/why-the-validates-overrides-old-restrictions", "title": "Why the validates overrides old restrictions", "body": "<p>I very new in Rails, but my problem I have is:</p>\n\n<p>When I just the type the following code:</p>\n\n<pre><code>  validates :ipaddress, :format =&gt; {\n    :with =&gt; Resolv::IPv4::Regex,\n    :message =&gt; 'Deve ser um endereco IP valido'\n  }\n</code></pre>\n\n<p>All my tests works with no problem. But when I add:</p>\n\n<pre><code>  validates :ipaddress, :format =&gt; {\n    :with =&gt; Resolv::IPv4::Regex,\n    :message =&gt; 'Deve ser um endereco IP valido'\n  }\n\n  validates :domain, :format =&gt; {\n    :with =&gt; URI.regexp,\n    :message =&gt; 'Deve ser um dominio valido'\n  }\n</code></pre>\n\n<p>The tests starts to failure and say:</p>\n\n<pre><code>F\n\nFailure:\nUrlTest#test_test_url_with_valid_IP_address \n[/home/olegario/infracrawler/test/models/url_test.rb:7]:\nTest a valid IP address.\nExpected: true\nActual: false\n\n\nbin/rails test test/models/url_test.rb:4\n\n..F\n\nFailure:\nUrlTest#test_test_url_using_a_valid_domain [/home/olegario/infra-\ncrawler/test/models/url_test.rb:19]:\nTest a valid domain.\nExpected: true\nActual: false\n</code></pre>\n\n<p>Why this is happening?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>This is the code of my tests:</p>\n\n<pre><code>test 'test an url with a IP address containing characters' do\n  url = Url.new()\n  url.ipaddress = '192.168.2.AAA'\n  assert_equal(false, url.valid?, 'Test a invalid IP address')\nend\n\ntest 'test url using a valid domain' do\n  url = Url.new()\n  url.domain = 'http://google.com'\n  assert_equal(true, url.valid?, 'Test a valid domain')\nend \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1719, "user_id": 1950763, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/NzirI.jpg?s=128&g=1", "display_name": "Caffeine Coder", "link": "https://stackoverflow.com/users/1950763/caffeine-coder"}, "edited": false, "score": 0, "creation_date": 1505908450, "post_id": 46321326, "comment_id": 79603387, "body": "what are you trying to attempt here"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1505908441, "creation_date": 1505908441, "answer_id": 46321360, "question_id": 46321326, "link": "https://stackoverflow.com/questions/46321326/select-elements-in-array-rails/46321360#46321360", "title": "Select elements in array rails", "body": "<p>Try this one instead.</p>\n\n<pre><code>x[1..-1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1505911101, "last_edit_date": 1505911101, "creation_date": 1505908515, "answer_id": 46321379, "question_id": 46321326, "link": "https://stackoverflow.com/questions/46321326/select-elements-in-array-rails/46321379#46321379", "title": "Select elements in array rails", "body": "<p><a href=\"https://ruby-doc.org/core/Array.html#method-i-5B-5D\" rel=\"nofollow noreferrer\"><code>Array#[]</code></a> accepts a <a href=\"https://ruby-doc.org/core/Range.html\" rel=\"nofollow noreferrer\"><code>Range</code></a> instance, and the right boundary can be negative, specifying the amount of elements <em>from the end</em>:</p>\n\n<pre><code>x[1..-1]\n</code></pre>\n"}], "owner": {"reputation": 6386, "user_id": 2950593, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c2a48d4e4bc7b3acde3023813cec112b?s=128&d=identicon&r=PG&f=1", "display_name": "user2950593", "link": "https://stackoverflow.com/users/2950593/user2950593"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1505908878, "accepted_answer_id": 46321379, "answer_count": 2, "score": -7, "last_activity_date": 1505911185, "creation_date": 1505908355, "last_edit_date": 1505911185, "question_id": 46321326, "link": "https://stackoverflow.com/questions/46321326/select-elements-in-array-rails", "closed_reason": "Needs details or clarity", "title": "Select elements in array rails", "body": "<pre><code>x = [1, 2, 3, 4]\n\nx[1, x.size - 1]\n#=&gt; [2, 3, 4]\n</code></pre>\n\n<p>How do I rewrite this code to make it more elegant.\nI would like something like</p>\n\n<pre><code>x[1, -1]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "twilio"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1505908530, "post_id": 46321134, "comment_id": 79603433, "body": "<a href=\"http://info.voicebase.com/request-api-key\" rel=\"nofollow noreferrer\">info.voicebase.com/request-api-key</a>"}, {"owner": {"reputation": 29, "user_id": 4671735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ptFe2.png?s=128&g=1", "display_name": "Fast Learner", "link": "https://stackoverflow.com/users/4671735/fast-learner"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1505908739, "post_id": 46321134, "comment_id": 79603583, "body": "So my API key will not be tied to my Twilio account or the Twilio Add-on directly? Then how does VoiceBase handle billing? Also, the link you shared requires me to apply for the API key. It looks like this is not for people who are using it through Twilio."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1505909394, "post_id": 46321134, "comment_id": 79604001, "body": "Ask the customer support instead of Stackoverflow"}], "answers": [{"tags": [], "owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "is_accepted": true, "score": 2, "last_activity_date": 1506596619, "creation_date": 1506596619, "answer_id": 46467572, "question_id": 46321134, "link": "https://stackoverflow.com/questions/46321134/using-twilio-voicebase-add-on-voicebase-api-key-needed/46467572#46467572", "title": "Using Twilio VoiceBase Add-On, VoiceBase API Key Needed?", "body": "<p>Twilio developer evangelist here.</p>\n\n<p>If you are making the request to VoiceBase conditionally after the call has been made then it is not handled by the Twilio intergration and you will need your own VoiceBase API key and billing account.</p>\n\n<p>If you want all calls transcribed automatically by the VoiceBase Add-on to Twilio, then the billing is handled through Twilio and you don't need to make any other accounts, you just need to enable the <a href=\"https://www.twilio.com/console/add-ons\" rel=\"nofollow noreferrer\">Add-on in your Twilio console</a>.</p>\n\n<p>Let me know if that helps at all.</p>\n"}], "owner": {"reputation": 29, "user_id": 4671735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ptFe2.png?s=128&g=1", "display_name": "Fast Learner", "link": "https://stackoverflow.com/users/4671735/fast-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 46467572, "answer_count": 1, "score": 0, "last_activity_date": 1506596619, "creation_date": 1505907788, "last_edit_date": 1505908162, "question_id": 46321134, "link": "https://stackoverflow.com/questions/46321134/using-twilio-voicebase-add-on-voicebase-api-key-needed", "title": "Using Twilio VoiceBase Add-On, VoiceBase API Key Needed?", "body": "<p>I am recording a phone call in my app. AFTER the call is done the user can choose to have the recording transcribed by clicking a button. Then we send the transcription request to VoiceBase.</p>\n\n<p>I've tried the <a href=\"https://github.com/popuparchive/voicebase-client-ruby\" rel=\"nofollow noreferrer\">VoiceBase API ruby gem</a> and the documentation from <a href=\"https://www.twilio.com/blog/2015/02/voicebase.html\" rel=\"nofollow noreferrer\">this post</a> on Twilio's blog and VoiceBase's <a href=\"https://www.voicebase.com/twilio-integration/\" rel=\"nofollow noreferrer\">page dedicated to the Twilio integration</a>.</p>\n\n<p>It's pretty easy to send the curl request to reference the recording hosted by Twilio, but my requests are not accepted because I do not have an API key for VoiceBase. Where do I get the API key?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1505900399, "post_id": 46318360, "comment_id": 79598100, "body": "It&#39;s better to <a href=\"https://webaim.org/techniques/css/invisiblecontent/\" rel=\"nofollow noreferrer\">hide the label with css</a> and add a placeholder for accessibility. Or you can position the label on the input."}, {"owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 0, "creation_date": 1505902063, "post_id": 46318360, "comment_id": 79599202, "body": "Just add <code>label: false</code> and try: <code>&lt;%= f.input :email, placeholder: &quot;e-mail&quot;, required: false, autofocus: true, label: false %&gt;</code>"}, {"owner": {"reputation": 31, "user_id": 8573609, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e52374602f6b8dae371844ff9df9ea22?s=128&d=identicon&r=PG&f=1", "display_name": "joshua", "link": "https://stackoverflow.com/users/8573609/joshua"}, "reply_to_user": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 0, "creation_date": 1505902348, "post_id": 46318360, "comment_id": 79599393, "body": "@Deep Thank you!It worked!!"}], "answers": [{"tags": [], "owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "is_accepted": true, "score": 4, "last_activity_date": 1505902390, "creation_date": 1505902390, "answer_id": 46319301, "question_id": 46318360, "link": "https://stackoverflow.com/questions/46318360/how-do-i-erase-the-label-and-just-have-a-placeholder-in-the-input-box/46319301#46319301", "title": "How do I erase the label and just have a placeholder in the input box?", "body": "<p>Just add <code>label: false</code> like this: </p>\n\n<pre><code>&lt;%= f.input :email, placeholder: \"e-mail\", required: false, autofocus: true, label: false %&gt;\n</code></pre>\n\n<p>This will remove the label.</p>\n"}], "owner": {"reputation": 31, "user_id": 8573609, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e52374602f6b8dae371844ff9df9ea22?s=128&d=identicon&r=PG&f=1", "display_name": "joshua", "link": "https://stackoverflow.com/users/8573609/joshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 46319301, "answer_count": 1, "score": 1, "last_activity_date": 1505902390, "creation_date": 1505899975, "question_id": 46318360, "link": "https://stackoverflow.com/questions/46318360/how-do-i-erase-the-label-and-just-have-a-placeholder-in-the-input-box", "title": "How do I erase the label and just have a placeholder in the input box?", "body": "<p>I have been poking around with this form for a while but I am unable to erase the label that goes on the left hand corner above the input box and just have the placeholder text inside an input box. With the code below, the input box gets filled with the placeholder value but the label becomes the argument of the input method on the variable f.</p>\n\n<p>I would like to just have to value of the placeholder inside the input box with no labels.</p>\n\n<pre><code>&lt;%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %&gt;\n        &lt;%= f.error_notification %&gt;\n        &lt;div class=\"field\"&gt;\n            &lt;%= f.input :email, placeholder: \"e-mail\", required: false, autofocus: true %&gt;\n            &lt;%= f.input :password, placeholder: \"password\",required: false, hint: (\"#{@minimum_password_length}\u6587\u5b57\u4ee5\u4e0a\u3067\uff01\" if @minimum_password_length) %&gt;\n            &lt;%= f.input :password_confirmation, placeholder: \"password\", required: false %&gt;  \n        &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "selenium", "watir"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1505899985, "post_id": 46318011, "comment_id": 79597797, "body": "Is the link visible on the page, or does it have <code>style=&quot;display:none;&quot;</code>? You may need to pass <code>visible: false</code> as a parameter."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1505900206, "post_id": 46318011, "comment_id": 79597964, "body": "@TomLord Link is visible. No, this style tag is not able <code>style=&quot;display:none;&quot;</code> , I have attached the corresponding code in the beginning. It&#39;s clicking while I use link, but it&#39;s not clicking while I use id.  That&#39;s why question is!"}, {"owner": {"reputation": 11632, "user_id": 8582353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2e22a564c1d0e098316210a2ec4fb1?s=128&d=identicon&r=PG&f=1", "display_name": "yong", "link": "https://stackoverflow.com/users/8582353/yong"}, "edited": false, "score": 0, "creation_date": 1505902419, "post_id": 46318011, "comment_id": 79599440, "body": "Did you confirm there is only one element will be found by:  browser.link(:id, &quot;17235-SL-GN-0&quot;) on page?"}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 11632, "user_id": 8582353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2e22a564c1d0e098316210a2ec4fb1?s=128&d=identicon&r=PG&f=1", "display_name": "yong", "link": "https://stackoverflow.com/users/8582353/yong"}, "edited": false, "score": 0, "creation_date": 1505906485, "post_id": 46318011, "comment_id": 79602002, "body": "@yong Yeah, you got the point, Yes, you are right, there is two element with this id and the first one is not pointing out the element which I wanted to click but second one does but since selenium uses the second one, it fails . Thank you."}, {"owner": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1505952543, "post_id": 46318011, "comment_id": 79627666, "body": "having duplicated ID values technically means your page has INVALID HTML.. at least according to the spec.   most browsers won&#39;t care, but it&#39;s still not good practice to use invalid html.    if it were me I&#39;d file a bug on that"}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1505973507, "post_id": 46318011, "comment_id": 79632609, "body": "@ChuckvanderLinden Did you down vote my question?"}, {"owner": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1506099113, "post_id": 46318011, "comment_id": 79698756, "body": "nope, wasn&#39;t me..   I usually only downvote if a question has neither sample HTML nor sample code that they tried to use (e.g. shows very litte effort and amounts to a &#39;do my work for me&#39; request)..   yours might have a little funky grammar, but you provide html, code, and the error..   Grammar I wrote off to someone who may not be a native english speaker, and it this is not a creative writing class, so I have no reason to downvote."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "edited": false, "score": 0, "creation_date": 1507198402, "post_id": 46318011, "comment_id": 80118987, "body": "@ChuckvanderLinden Okay."}], "answers": [{"comments": [{"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1505906235, "post_id": 46319533, "comment_id": 79601832, "body": "I know that I can click through Javascript, Javascript doesn&#39;t check the visibility condition but the question is why selenium click can&#39;t be performed on the element using Id locator while it can click through <code>link</code> locator."}], "tags": [], "owner": {"reputation": 1077, "user_id": 4170608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EAWl.png?s=128&g=1", "display_name": "unickq", "link": "https://stackoverflow.com/users/4170608/unickq"}, "is_accepted": false, "score": 0, "last_activity_date": 1505903032, "creation_date": 1505903032, "answer_id": 46319533, "question_id": 46318011, "link": "https://stackoverflow.com/questions/46318011/locating-using-id-fails-but-using-link-it-succeeds-to-click/46319533#46319533", "title": "Locating using id fails but using link it succeeds to click", "body": "<p>If link is not visible for regular Click() use jsClick:</p>\n\n<pre><code>\"arguments[0].click();\"\n</code></pre>\n\n<p>I'm not sure how it looks like in Ruby, but C#, Java looks simillar to: </p>\n\n<pre><code>JavascriptExecutor executor = (JavaScriptExecutor) driver;\nexecutor.executeScript(\"arguments[0].click();\", element);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 1, "creation_date": 1505911093, "post_id": 46320736, "comment_id": 79605288, "body": "We added the visible parameter for cases such as these: <code>browser.link(id: &#39;17235-SL-GN-0&#39;, visible: true).click</code>"}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1505911122, "post_id": 46320736, "comment_id": 79605311, "body": "Also, someone mentioned recently that they were having difficulties locating elements by ids that started with a number (which didn&#39;t used to be allowed). I&#39;ve been meaning to write a spec to check it out, but haven&#39;t had time. That might also cause a problem (if you used <code>element</code> instead of <code>link</code>)"}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1505916641, "post_id": 46320736, "comment_id": 79609430, "body": "@titusfortner To your first comment, okay. Actually I have forgotten to use visible locator. And to your second comment, Why using element is problematic while link is not a problem when I use id?"}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1505916650, "post_id": 46320736, "comment_id": 79609438, "body": "The former will convert it to xpath in Watir the latter to css in selenium. Oh, but that&#39;s only in W3C code which you don&#39;t use. Json wire protocol shouldn&#39;t matter."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1505917017, "post_id": 46320736, "comment_id": 79609698, "body": "@titusfortner I know of this very well, That&#39;s why I haven&#39;t written the code <code>b.link(text: &#39;Book Now&#39;).click</code> because it goes on to form the xpath, So I have written this code <code>b.element(link: &#39;Book Now&#39;).click</code>, this code uses the selenium locator <code>link:</code>  And I don&#39;t understand what do you mean by later to css in selenium, what does that mean? Is there somethere WATIR creates the css equivalent? I haven&#39;t seen any so far."}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1505917416, "post_id": 46320736, "comment_id": 79609985, "body": "No, both of those translate into XPath (or would if &#39;link&#39; were a valid parameter). ID is the only one that has a short circuit in the Watir code."}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1505917517, "post_id": 46320736, "comment_id": 79610057, "body": "I&#39;m saying I don&#39;t think this has been tested with an id that starts with a number: <a href=\"https://github.com/SeleniumHQ/selenium/blob/master/rb/lib/selenium/webdriver/remote/w3c/bridge.rb#L547\" rel=\"nofollow noreferrer\">github.com/SeleniumHQ/selenium/blob/master/rb/lib/selenium/&hellip;</a>"}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1505918285, "post_id": 46320736, "comment_id": 79610612, "body": "@titusfortner OH MY GOD! I am amazed that you do not know! This is absolutely not true. If given locator is available in selenium locator list, WATIR doesn&#39;t go to form xpath, If the given locator is not selenium list, then it goes on to form the xpath. So Link locator is available in the selenium list, so it doesn&#39;t. Read the condition here <code>if WD_FINDERS.include?(how) wd_find_first_by(how, what) else find_first_by_multiple end</code>"}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1505919573, "post_id": 46320736, "comment_id": 79611564, "body": "Oh right, yes, that&#39;s how it works. I&#39;d forgotten it was a Selenium locator. :) But I still think you are missing out by not having the extra encapsulation since the overhead is minimal."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1505921205, "post_id": 46320736, "comment_id": 79612831, "body": "@titusfortner  \t No, you said only id is the only locator does the short circuit. NO again, There are few places b.link(text:&#39;something&#39;) won&#39;t work but b.element(link: &#39;something&#39;) works properly. And also another advantage is, If more than one link present with the same name, then you are in need of passing visible: true additionally but selenium automatically picks up the visible one when you use link locator."}, {"owner": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "reply_to_user": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1506099377, "post_id": 46320736, "comment_id": 79698906, "body": "@titusfortner  that was me who mentioned the thing about ID values starting with a numeral.  Prior to HTML5 that was not allowed.  It&#39;s allowed now, but CSS selection (you can test this easily via browser console) will not work selecting an ID that starts with a numeral unless you &#39;escape&#39; the first character.  (which is I guess a trick to get around that CSS limitation)   So if your selection method in watir is rendered into a CSS selection under the covers, and selecting by ID, for an ID like the one above, I&#39;d expect it to fail, while rendered to xcopy selection would work."}], "tags": [], "owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "is_accepted": true, "score": 0, "last_activity_date": 1505906625, "creation_date": 1505906625, "answer_id": 46320736, "question_id": 46318011, "link": "https://stackoverflow.com/questions/46318011/locating-using-id-fails-but-using-link-it-succeeds-to-click/46320736#46320736", "title": "Locating using id fails but using link it succeeds to click", "body": "<p>I found the solution to my question from @yong comment</p>\n\n<p>Actually there are two element present in the page with same id and the first one is invisible and the second one is actual element which I wanted to click, that's what it's throwing the error.</p>\n\n<p>Here is the html file</p>\n\n<pre><code>&lt;td style=\"padding-top:3px\" align=\"center\"&gt;\nGNWL203/WL105\n&lt;br/&gt;\n**&lt;a id=\"17235-SL-GN-0\" href=\"javascript:jpBook($('#17235-SL-GN-0'),'17235','HSRA','SRT','22-9-2017','SL','GN',3,false,0,0,'S');\" tabindex=\"1\"&gt;Book Now&lt;/a&gt;**\n&lt;/td&gt;\n&lt;td style=\"padding-top:3px\" align=\"center\"&gt;\n&lt;td style=\"padding-top:3px\" align=\"center\"&gt;\n&lt;td style=\"padding-top:3px\" align=\"center\"&gt;\n&lt;td style=\"padding-top:3px\" align=\"center\"&gt;\n&lt;td style=\"padding-top:3px\" align=\"center\"&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;span style=\"font:11px arial;color:red;float:right\"&gt;* CURR_AVBL : Current Booking Available | RAC : Reservation Against Cancellation | WL # : Wait List | REGRET/WL : No more booking allowed | AVAILABLE : Available | NOT AVAILABLE : Not Available&lt;/span&gt;\n&lt;br/&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div id=\"j_idt413\" class=\"rf-p \"&gt;\n&lt;div id=\"enqpanelid1\" class=\"rf-p \"&gt;\n&lt;/div&gt;\n&lt;/span&gt;\n&lt;form id=\"avlAndFareForm\" name=\"avlAndFareForm\" method=\"post\" action=\"/eticketing/trainbetweenstns.jsf\" enctype=\"application/x-www-form-urlencoded\"&gt;\n&lt;input name=\"avlAndFareForm\" value=\"avlAndFareForm\" type=\"hidden\"/&gt;\n&lt;div id=\"avlAndFareForm:trainSchedPanel\" style=\"visibility: hidden;\"&gt;\n&lt;div id=\"avlAndFareForm:j_idt480\" class=\"rf-p \" style=\"min-height:383px;width:99%;\"&gt;\n&lt;div id=\"avlAndFareForm:j_idt480_body\" class=\"rf-p-b \"&gt;\n&lt;ul id=\"tabul\"&gt;\n&lt;div id=\"tabcontent\"&gt;\n&lt;div id=\"c1\" class=\"container-div\"&gt;\n&lt;div id=\"j_idt382\" class=\"rf-p \"&gt;\n&lt;div id=\"j_idt382_header\" class=\"rf-p-hdr \"&gt;\n&lt;div id=\"j_idt382_body\" class=\"rf-p-b \"&gt;\n&lt;table class=\"t1\" cellspacing=\"0\" cellpadding=\"4px\"&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;td style=\"text-align: left;padding-left: 1em;\"&gt;\n&lt;td style=\"padding-top:3px\" align=\"center\"&gt;\nGNWL203/WL105\n&lt;br/&gt;\n**&lt;a id=\"17235-SL-GN-0\" href=\"javascript:jpBook($('#17235-SL-GN-0'),'17235','HSRA','SRT','22-9-2017','SL','GN',3,false,0,0,'S');\" tabindex=\"1\"&gt;Book Now&lt;/a&gt;**\n&lt;/td&gt; \n</code></pre>\n"}], "owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 46320736, "answer_count": 2, "score": 0, "last_activity_date": 1505906625, "creation_date": 1505899064, "question_id": 46318011, "link": "https://stackoverflow.com/questions/46318011/locating-using-id-fails-but-using-link-it-succeeds-to-click", "title": "Locating using id fails but using link it succeeds to click", "body": "<p>For the following link, </p>\n\n<pre><code>&lt;td style=\"padding-top:3px\" align=\"center\"&gt;\nGNWL200/WL102\n&lt;br/&gt;\n&lt;a id=\"17235-SL-GN-0\" href=\"javascript:jpBook($('#17235-SL-GN-0'),'17235','HSRA','SRT','22-9-2017','SL','GN',3,false,0,0,'S');\" tabindex=\"1\"&gt;Book Now&lt;/a&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>If I uses the link as shown below, it succeeds to click</p>\n\n<pre><code>browser.element(link: \"Book Now\").click\n</code></pre>\n\n<p>But if I uses the id as shown below it says element is not visible(not present). May I know why?</p>\n\n<pre><code>browser.link(:id, \"17235-SL-GN-0\").click\n</code></pre>\n\n<p>Error</p>\n\n<pre><code>Uncaught exception: element located, but timed out after 30 seconds, waiting for #&lt;Watir::Anchor: located: true; {:id=&gt;\"17235-SL-GN-0\", :tag_name=&gt;\"a\"}&gt; to be present\n    C:/Ruby23/lib/ruby/gems/2.3.0/gems/watir-6.8.4/lib/watir/elements/element.rb:633:in `raise_present'\n    C:/Ruby23/lib/ruby/gems/2.3.0/gems/watir-6.8.4/lib/watir/elements/element.rb:672:in `rescue in element_call'\n    C:/Ruby23/lib/ruby/gems/2.3.0/gems/watir-6.8.4/lib/watir/elements/element.rb:684:in `element_call'\n    C:/Ruby23/lib/ruby/gems/2.3.0/gems/watir-6.8.4/lib/watir/elements/element.rb:136:in `click'\n    C:/Users/rajagopalan.m/RubymineProjects/SeleniumLearning/Rest/TrainTicketBooking.rb:18:in `&lt;top (required)&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 1572, "user_id": 894864, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c735d33e92ad0f1b5a9452fc27b93317?s=128&d=identicon&r=PG", "display_name": "Marcelo", "link": "https://stackoverflow.com/users/894864/marcelo"}, "is_accepted": true, "score": 0, "last_activity_date": 1505899867, "creation_date": 1505899867, "answer_id": 46318321, "question_id": 46317069, "link": "https://stackoverflow.com/questions/46317069/bundler-misses-gems-on-mac/46318321#46318321", "title": "Bundler misses gems on Mac", "body": "<p>For some reason the gems were installed inside inside vendor/bundle, but not all of them. Removing <code>rm -rf .bundle vendor/bundle &amp;&amp; bundle install</code> did it. </p>\n\n<p>The content of .bundle/config was:</p>\n\n<pre><code>---\nBUNDLE_WITHOUT: \"development:related\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1572, "user_id": 894864, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c735d33e92ad0f1b5a9452fc27b93317?s=128&d=identicon&r=PG", "display_name": "Marcelo", "link": "https://stackoverflow.com/users/894864/marcelo"}, "edited": false, "score": 0, "creation_date": 1505997074, "post_id": 46321381, "comment_id": 79647793, "body": "Thanks for your answer. It was actually the bundle config (as I answered above). The gems were in the correct group. In fact, I also had  tried outside of  the groups, with rack-cors."}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "reply_to_user": {"reputation": 1572, "user_id": 894864, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c735d33e92ad0f1b5a9452fc27b93317?s=128&d=identicon&r=PG", "display_name": "Marcelo", "link": "https://stackoverflow.com/users/894864/marcelo"}, "edited": false, "score": 0, "creation_date": 1506006368, "post_id": 46321381, "comment_id": 79654961, "body": "@Marcelo Replied in post."}], "tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1506006313, "last_edit_date": 1506006313, "creation_date": 1505908520, "answer_id": 46321381, "question_id": 46317069, "link": "https://stackoverflow.com/questions/46317069/bundler-misses-gems-on-mac/46321381#46321381", "title": "Bundler misses gems on Mac", "body": "<p>TL;DR; Try to move <code>spring-commands-rspec</code> to <code>test</code> group in <code>Gemfile</code>:</p>\n\n<pre><code>group :development\n  # ...\n  # ...\nend\ngroup :test do\n# ...\n  gem 'spring-commands-rspec'\nend\n</code></pre>\n\n<p>OR <code>group :development, :test do</code> if you need the gem not only for tests.</p>\n\n<p><strong>In short</strong>: There is <code>Environment</code> concept, when you run something in Rails. Loaded gems are also depend on it through <code>Gemfile</code> - <code>Bundler</code> loads common gems and gems from corresponding groups. The <em>default</em> environment is <strong>development</strong>, but <code>rspec</code> uses <strong>test</strong> one. So, gems from group <em>development</em> are not loaded when you run <code>rspec ...</code> if they are not listed in group <em>test</em> also.</p>\n\n<p><strong>UPDATE</strong>:\nIt seems you have set up your app <em>in server mode</em>(may be you get install command from deploy script). Because it's pretty typical to have <code>.bundle</code> dir and <code>vendor/bundle</code> when deploy Rails app on the <em>staging/production</em> server(i.e. gems are installed locally with app).<br>\nBut in that case you <code>.bundle/config</code> should include <code>BUNDLE_PATH</code> at least:</p>\n\n<pre><code>BUNDLE_FROZEN: \"1\"\nBUNDLE_PATH: \"./vendor/bundle\"\nBUNDLE_WITHOUT: \"development:test\"\nBUNDLE_DISABLE_SHARED_GEMS: \"true\"\n</code></pre>\n"}], "owner": {"reputation": 1572, "user_id": 894864, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c735d33e92ad0f1b5a9452fc27b93317?s=128&d=identicon&r=PG", "display_name": "Marcelo", "link": "https://stackoverflow.com/users/894864/marcelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 46318321, "answer_count": 2, "score": 0, "last_activity_date": 1506006313, "creation_date": 1505896243, "last_edit_date": 1505899244, "question_id": 46317069, "link": "https://stackoverflow.com/questions/46317069/bundler-misses-gems-on-mac", "title": "Bundler misses gems on Mac", "body": "<p>I have problems loading gems with bundler. Happens only in my mac environment. The gem cannot be found via bundler, but when I install the gem globally via <code>gem install #{gem}</code> it works.</p>\n\n<p>I suppose this is something environment specific, but I am not sure how to debug it. I have the same versions of ruby, ruby-install and chruby and bundler on a Ubuntu box, but it works just fine.</p>\n\n<p>So far I had this problem with the gems spring-comands-rspec and rack-cors.</p>\n\n<p>Broken environment (Mac):</p>\n\n<pre><code>OS: Darwin nb-mjacobus2 16.7.0 Darwin Kernel Version 16.7.0: Thu Jun 15 17:36:27 PDT 2017; root:xnu-3789.70.16~2/RELEASE_X86_64 x86_64\nBundler: 1.15.4\nruby-install: 0.6.1\nchruby: 0.3.9\nruby: ruby 2.4.1p111 (2017-03-22 revision 58053) [x86_64-darwin16]\n</code></pre>\n\n<h2>Exposing the error:</h2>\n\n<p>Gemfile</p>\n\n<pre><code>group :development do\n  # ...\n  gem 'spring-commands-rspec'\n  # ...\nend\n</code></pre>\n\n<p>Running tests</p>\n\n<pre><code>./bin/rspec spec/controller/some_controller_spec.rb:8\n/$HOME/.rubies/ruby-2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- spring-commands-rspec (LoadError)\n        from /$HOME/.rubies/ruby-2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n        from /$HOME/.spring.rb:2:in `&lt;top (required)&gt;'\n        from /$HOME/.rubies/ruby-2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n        from /$HOME/.rubies/ruby-2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n        from /$HOME/.gem/ruby/2.4.1/gems/spring-2.0.2/lib/spring/commands.rb:29:in `&lt;module:Spring&gt;'\n        from /$HOME/.gem/ruby/2.4.1/gems/spring-2.0.2/lib/spring/commands.rb:4:in `&lt;top (required)&gt;'\n        from /$HOME/.rubies/ruby-2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n        from /$HOME/.rubies/ruby-2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n        from /$HOME/.gem/ruby/2.4.1/gems/spring-2.0.2/lib/spring/server.rb:9:in `&lt;top (required)&gt;'\n        from /$HOME/.rubies/ruby-2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n        from /$HOME/.rubies/ruby-2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n        from /$HOME/.gem/ruby/2.4.1/gems/spring-2.0.2/lib/spring/client/server.rb:9:in `call'\n        from /$HOME/.gem/ruby/2.4.1/gems/spring-2.0.2/lib/spring/client/command.rb:7:in `call'\n        from /$HOME/.gem/ruby/2.4.1/gems/spring-2.0.2/lib/spring/client.rb:30:in `run'\n        from /$HOME/.gem/ruby/2.4.1/gems/spring-2.0.2/bin/spring:49:in `&lt;main&gt;'\n</code></pre>\n\n<p>Manually installing the gem solves the problem....</p>\n\n<pre><code>gem install spring-commands-rspec\nFetching: spring-commands-rspec-1.0.4.gem (100%)\nSuccessfully installed spring-commands-rspec-1.0.4\nParsing documentation for spring-commands-rspec-1.0.4\nInstalling ri documentation for spring-commands-rspec-1.0.4\nDone installing documentation for spring-commands-rspec after 0 seconds\n1 gem installed\n</code></pre>\n\n<p>... BUT I get this warnings:</p>\n\n<pre><code>./bin/rspec spec/pattern_library_controller_spec.rb\nWARN: Unresolved specs during Gem::Specification.reset:\n      minitest (~&gt; 5.1)\nWARN: Clearing out unresolved specs.\nPlease report a bug if this causes problems.\nWARN: Unresolved specs during Gem::Specification.reset:\n      minitest (~&gt; 5.1)\nWARN: Clearing out unresolved specs.\nPlease report a bug if this causes problems.\nRunning via Spring preloader in process 53164\nRun options: include {:focus=&gt;true}\n\nAll examples were filtered out; ignoring {:focus=&gt;true}\n\nRandomized with seed 5284\n\nSomeController\n  should respond with a success status code (2xx)\n\nFinished in 0.13193 seconds (files took 0.66951 seconds to load)\n1 example, 0 failures\n\nRandomized with seed 5284\n</code></pre>\n\n<p>Any idea what the problem could be?</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe"], "comments": [{"owner": {"reputation": 30536, "user_id": 400222, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75febe3a9bd5b1ad9cb63fceccb6aa31?s=128&d=identicon&r=PG", "display_name": "StephenKing", "link": "https://stackoverflow.com/users/400222/stephenking"}, "edited": false, "score": 1, "creation_date": 1505897212, "post_id": 46317025, "comment_id": 79595961, "body": "Use some ruby code to sum it up?"}, {"owner": {"reputation": 741, "user_id": 7110786, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vngfXUuqxTA/AAAAAAAAAAI/AAAAAAAAAME/lSKUDaikZJM/photo.jpg?sz=128", "display_name": "Saif Ahmad", "link": "https://stackoverflow.com/users/7110786/saif-ahmad"}, "reply_to_user": {"reputation": 30536, "user_id": 400222, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75febe3a9bd5b1ad9cb63fceccb6aa31?s=128&d=identicon&r=PG", "display_name": "StephenKing", "link": "https://stackoverflow.com/users/400222/stephenking"}, "edited": false, "score": 1, "creation_date": 1505897328, "post_id": 46317025, "comment_id": 79596027, "body": "@StephenKing Thanks for the reply! Yeah I could do that, but is there another way? I could even execute a command to get the total size by this command <code>df | grep &#39;^&#47;dev&#47;[hs]d&#39; | awk &#39;{s+=$2} END {print s&#47;1048576}</code> but  I wanted to make use of ohai."}, {"owner": {"reputation": 2285, "user_id": 4519500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/FRdEr.jpg?s=128&g=1", "display_name": "Sergiu", "link": "https://stackoverflow.com/users/4519500/sergiu"}, "edited": false, "score": 0, "creation_date": 1505930523, "post_id": 46317025, "comment_id": 79618698, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14286709/how-can-i-find-the-disk-available-in-a-chef-recipe\">How can I find the disk available in a Chef recipe?</a>"}, {"owner": {"reputation": 741, "user_id": 7110786, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vngfXUuqxTA/AAAAAAAAAAI/AAAAAAAAAME/lSKUDaikZJM/photo.jpg?sz=128", "display_name": "Saif Ahmad", "link": "https://stackoverflow.com/users/7110786/saif-ahmad"}, "reply_to_user": {"reputation": 2285, "user_id": 4519500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/FRdEr.jpg?s=128&g=1", "display_name": "Sergiu", "link": "https://stackoverflow.com/users/4519500/sergiu"}, "edited": false, "score": 1, "creation_date": 1506060847, "post_id": 46317025, "comment_id": 79675615, "body": "@Sergiu Not a duplicate question, as I&#39;m looking to find the total available,  not individual device on the disk. That&#39;s why I&#39;ve specifically mentioned <b>Total</b>"}], "answers": [{"comments": [{"owner": {"reputation": 3420, "user_id": 1824868, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9b06898ce25659bc5600453c3f21c991?s=128&d=identicon&r=PG", "display_name": "jayhendren", "link": "https://stackoverflow.com/users/1824868/jayhendren"}, "edited": false, "score": 0, "creation_date": 1505951173, "post_id": 46330305, "comment_id": 79627378, "body": "Looping over all mounted devices will also pick up remote mounts (NFS, SSHFS, etc.) and bind mounts and countless other things.  So yeah, probably a terrible idea to loop over all mounted devices."}, {"owner": {"reputation": 741, "user_id": 7110786, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vngfXUuqxTA/AAAAAAAAAAI/AAAAAAAAAME/lSKUDaikZJM/photo.jpg?sz=128", "display_name": "Saif Ahmad", "link": "https://stackoverflow.com/users/7110786/saif-ahmad"}, "edited": false, "score": 1, "creation_date": 1506061132, "post_id": 46330305, "comment_id": 79675764, "body": "@coderanger Thanks for your reply.I actually wanted a generic answer that could work on all OS. But for now I ended up using a shell command get the total available space.                                                            <code>df | grep &#39;^&#47;dev&#47;[hs]d&#39; | awk &#39;{s+=$4} END {print s&#47;1048576}</code>"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1506086932, "post_id": 46330305, "comment_id": 79691378, "body": "That <code>^&#47;dev&#47;[hs]d</code> as a filter pattern is very specific to Linux, and not even all Linux (many cloud systems these days use <code>xd</code> drivers)."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1505935605, "creation_date": 1505935605, "answer_id": 46330305, "question_id": 46317025, "link": "https://stackoverflow.com/questions/46317025/how-to-find-the-total-disk-space-in-chef/46330305#46330305", "title": "How to find the total disk space in chef?", "body": "<p>There is no specific answer because that's not a concept that your OS understands. You could do the simple answer of loop over all devices and add up free space, but that would probably end up with incorrect data because of things like virtual devices (procfs, devfs, sysfs, etc), tempfs devices, loopback mounts, etc. What you <em>probably</em> want is to loop over all devices matching some name pattern but the specifics of that pattern depend on your OS and hardware: <code>node['filesystem'].select {|k, v| k =~ /something/ }.map {|k, v| v['kb_available'] }.sum</code></p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 1758297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2571286cd01f5b332e0e84cd4e13b5a0?s=128&d=identicon&r=PG", "display_name": "vini", "link": "https://stackoverflow.com/users/1758297/vini"}, "is_accepted": false, "score": 0, "last_activity_date": 1591157402, "creation_date": 1591157402, "answer_id": 62165092, "question_id": 46317025, "link": "https://stackoverflow.com/questions/46317025/how-to-find-the-total-disk-space-in-chef/62165092#62165092", "title": "How to find the total disk space in chef?", "body": "<p>you can use the command df -Th --total and last line of this command print the total assigned space and total used.</p>\n"}], "owner": {"reputation": 741, "user_id": 7110786, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vngfXUuqxTA/AAAAAAAAAAI/AAAAAAAAAME/lSKUDaikZJM/photo.jpg?sz=128", "display_name": "Saif Ahmad", "link": "https://stackoverflow.com/users/7110786/saif-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1591157402, "creation_date": 1505896138, "last_edit_date": 1505897218, "question_id": 46317025, "link": "https://stackoverflow.com/questions/46317025/how-to-find-the-total-disk-space-in-chef", "title": "How to find the total disk space in chef?", "body": "<p>I wanted to find the <strong>total disk space</strong> available in the machine through chef. I could find a way to find individual partition space via node['filesystem']['device_name'], but is there any way to find total disk space? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "carrierwave", "fog"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1505912200, "post_id": 46315607, "comment_id": 79606046, "body": "Why do you even want this in a helper? Wouldn&#39;t it make more sense to just place it in the needed class? If you need to use it multiple places then create your own module and include it as needed.Placing it in  ApplicationHelper will cause the method to bleed through the application for no reason."}, {"owner": {"reputation": 1319, "user_id": 5060959, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2d7af66fc79160e5872515869fad813c?s=128&d=identicon&r=PG&f=1", "display_name": "thedudecodes", "link": "https://stackoverflow.com/users/5060959/thedudecodes"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505971772, "post_id": 46315607, "comment_id": 79632013, "body": "@engineersmnky this makes sense and actually I did like this but still not able to upload files to s3. I made a module common_uploader.rb but . i want to fetch the credetials from db of the user but dont know how to do it"}], "owner": {"reputation": 1319, "user_id": 5060959, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2d7af66fc79160e5872515869fad813c?s=128&d=identicon&r=PG&f=1", "display_name": "thedudecodes", "link": "https://stackoverflow.com/users/5060959/thedudecodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505893870, "creation_date": 1505891954, "question_id": 46315607, "link": "https://stackoverflow.com/questions/46315607/how-can-i-call-applicationhelper-methods-inside-avataruplaoder-rails", "title": "How can I call ApplicationHelper Methods inside AvatarUplaoder rails", "body": "<p>I am using carrierwave and fog gem for uploading files to s3.</p>\n\n<p>In my app user can select their own aws credentials for saving their files.\nso I cant use initializer. All the credentials will be saved on database with their user ID.</p>\n\n<p>I have made a check in AvatarUplaoder to set the storage type.</p>\n\n<pre><code>     def self.call_set_storage_type\n       active_type=UploadManagement.find_by_is_active(1)\n       if active_type.nil?\n        :file\n       else\n        if active_type.provider == \"aws\"\n         :fog\n        else \n         :file\n        end\n       end\n    end\n   storage call_set_storage_type\n</code></pre>\n\n<p>I want to make a method in ApplicationHelper or ApplicationController\nso that I can call it on AvatarUploader.\nI tried incuding application_helper in avatar_uploader but it didn't worked.</p>\n\n<p>I want to make method in application_helper or applciation_controller because I need that method at many places and also I have other uploaders also\nto make code DRY I need to call but I am not able to think it. </p>\n\n<p>I checked the documentation also <a href=\"https://github.com/carrierwaveuploader/carrierwave/wiki/How-to:-Define-different-storage-configuration-for-each-Uploader.\" rel=\"nofollow noreferrer\">different storage for each uplaoder</a></p>\n\n<p>Please guide me how can I do that or any alternate solutions are also welcome.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1505893516, "post_id": 46315044, "comment_id": 79593655, "body": "You have to accept answers that helped."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1506423489, "post_id": 46315144, "comment_id": 79806223, "body": "JFYI, it&#39;s <code>&lt;br&#47;&gt;</code>, not <code>&lt;&#47;br&gt;</code> :)"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 0, "last_activity_date": 1506423477, "last_edit_date": 1506423477, "creation_date": 1505890384, "answer_id": 46315144, "question_id": 46315044, "link": "https://stackoverflow.com/questions/46315044/format-xml-data/46315144#46315144", "title": "Format XML data", "body": "<p>Actually, the output you've received is a properly formatted XML output. Note that <code>\\n</code> in the string. The only thing that remains is to print it.</p>\n\n<p>The following code:</p>\n\n<pre><code>puts modify_trx_id(body)\n</code></pre>\n\n<p>will print something like</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;payment_transaction&gt;\n   &lt;transaction_type&gt;sale&lt;/transaction_type&gt;\n</code></pre>\n\n<p>Or, for example, if you need to display it as HTML, there are methods (in <code>Rails</code> at least) which convert <code>\\n</code>'s to <code>&lt;br/&gt;</code> and print the content pretty.</p>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506423477, "creation_date": 1505889999, "question_id": 46315044, "link": "https://stackoverflow.com/questions/46315044/format-xml-data", "title": "Format XML data", "body": "<p>I'm using this code to format XML data into shell:</p>\n\n<pre><code>def modify_trx_id(request_body)\n    doc = Nokogiri::XML(request_body)\n    puts \"XML content:\"\n    doc.to_xml\n  end\n</code></pre>\n\n<p>But the output is not very  structured:</p>\n\n<pre><code>\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\\n&lt;payment_transaction&gt;\\n   &lt;transaction_type&gt;sale&lt;/transaction_type&gt;\\n\n</code></pre>\n\n<p>How I can structure it into properly formatted XML output?</p>\n"}, {"tags": ["ruby", "selenium"], "answers": [{"comments": [{"owner": {"reputation": 601, "user_id": 4218660, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f66990dc14a1b7bbaaa5a988b277d7b5?s=128&d=identicon&r=PG&f=1", "display_name": "djadam", "link": "https://stackoverflow.com/users/4218660/djadam"}, "edited": false, "score": 0, "creation_date": 1506598729, "post_id": 46466532, "comment_id": 79891191, "body": "Thanks Acko, let me check"}], "tags": [], "owner": {"reputation": 11, "user_id": 5135800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20c4700d061ac22802005bdf3f5756d6?s=128&d=identicon&r=PG&f=1", "display_name": "Acko", "link": "https://stackoverflow.com/users/5135800/acko"}, "is_accepted": false, "score": 0, "last_activity_date": 1506593457, "creation_date": 1506593457, "answer_id": 46466532, "question_id": 46314859, "link": "https://stackoverflow.com/questions/46314859/seleniumwebdrivererrorwebdrivererror-unexpected-response-code-404-conte/46466532#46466532", "title": "Selenium::WebDriver::Error::WebDriverError: unexpected response, code=404, content-type=&quot;&quot;", "body": "<p>I had similar (if not the same) issue. I'm not sure what is your exact error (next row), because you haven't added it, mine was <code>Unable to load Atom 'execute_script' from file './third_party/webdriver-atoms/execute_script.js'</code>. And resolution was just to update <code>phantomjs</code>, which I did just by running <code>npm install -g phantomjs</code>.</p>\n\n<p>That was it. Hope this helps</p>\n"}], "owner": {"reputation": 601, "user_id": 4218660, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f66990dc14a1b7bbaaa5a988b277d7b5?s=128&d=identicon&r=PG&f=1", "display_name": "djadam", "link": "https://stackoverflow.com/users/4218660/djadam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 852, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506593457, "creation_date": 1505889331, "question_id": 46314859, "link": "https://stackoverflow.com/questions/46314859/seleniumwebdrivererrorwebdrivererror-unexpected-response-code-404-conte", "title": "Selenium::WebDriver::Error::WebDriverError: unexpected response, code=404, content-type=&quot;&quot;", "body": "<p>I am trying to execute some tests using <strong>archani</strong> for auto login plugin and intermittently I see this error Has anyone else also experienced this issue? If yes, what are possible ways of resolving?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1505898869, "post_id": 46314826, "comment_id": 79597076, "body": "<i>&quot;here have a solution, but I don&#39;t know why?&quot;</i> --- I can&#39;t really explain why this &quot;solution&quot; works, without knowing the question! What is an &quot;ugly&quot; number defined as?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1505898950, "post_id": 46314826, "comment_id": 79597106, "body": "Is <a href=\"https://leetcode.com/problems/ugly-number/description/\" rel=\"nofollow noreferrer\">this</a> the question? &quot;Ugly numbers are positive numbers whose prime factors only include 2, 3, 5&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1505889413, "creation_date": 1505889413, "answer_id": 46314880, "question_id": 46314826, "link": "https://stackoverflow.com/questions/46314826/ugly-number-in-ruby/46314880#46314880", "title": "Ugly Number in Ruby", "body": "<p>Both <code>if</code> and <code>while</code> are so-called postfix (short) forms.</p>\n\n<p>Try these:</p>\n\n<pre><code>puts \"yes\" if true\n</code></pre>\n\n<p>and</p>\n\n<pre><code>puts \"yes\" if false\n</code></pre>\n\n<p>It is basically the same as:</p>\n\n<pre><code>if true\n  puts \"yes\"\nend\n</code></pre>\n\n<hr>\n\n<p>for <code>while</code>:</p>\n\n<pre><code>num /= i while (num % i == 0) \n</code></pre>\n\n<p>is exactly the same as</p>\n\n<pre><code>while (num % i == 0)\n  num = num / i\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8638769, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RUE5gGVjk2s/AAAAAAAAAAI/AAAAAAAAA5E/PrMgfOqSQIw/photo.jpg?sz=128", "display_name": "Zarek Chung", "link": "https://stackoverflow.com/users/8638769/zarek-chung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 46314880, "answer_count": 1, "score": 0, "last_activity_date": 1505889413, "creation_date": 1505889222, "question_id": 46314826, "link": "https://stackoverflow.com/questions/46314826/ugly-number-in-ruby", "title": "Ugly Number in Ruby", "body": "<p>I am a beginner in learning Ruby Language.\nI am studying it from leetcode.</p>\n\n<p>here have a solution, but I don't know why?\nI would like to know what is structure in the solution</p>\n\n<p>Ugly Number\nsolution:</p>\n\n<pre><code>def is_ugly(num)\n   (2..5).each { |i| num /= i while (num % i == 0) } if num &gt; 0 \n   num == 1\nend   \n</code></pre>\n\n<ol>\n<li><p>I don't know why 'if' have to behind '}'</p>\n\n<p>It will be error if I delete 'if'statement</p>\n\n<blockquote>\n  <p>syntax error, unexpected end-of-input, expecting keyword_end</p>\n</blockquote></li>\n</ol>\n\n<p>and </p>\n\n<ol start=\"2\">\n<li><p><code>while (num % i == 0)</code>\nI can't understand this statement</p>\n\n<p>From what I Know while seems like :</p></li>\n</ol>\n\n<p>eg. </p>\n\n<pre><code>while conditional [do]\n     code\nend\n</code></pre>\n\n<p>thanks a lot</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "google-analytics"], "comments": [{"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1505891705, "post_id": 46314712, "comment_id": 79592523, "body": "The code you are showing is for classic Google analytics you should upgrade to Universal analytics. <a href=\"https://support.google.com/analytics/answer/2790010?hl=en\" rel=\"nofollow noreferrer\">support.google.com/analytics/answer/2790010?hl=en</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3493, "user_id": 1323481, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4825c6c1cdfd05c2af6fb8db0d492f73?s=128&d=identicon&r=PG", "display_name": "StandardNerd", "link": "https://stackoverflow.com/users/1323481/standardnerd"}, "is_accepted": true, "score": 6, "last_activity_date": 1505889383, "creation_date": 1505889383, "answer_id": 46314871, "question_id": 46314712, "link": "https://stackoverflow.com/questions/46314712/google-analytics-with-rails-5-not-working/46314871#46314871", "title": "Google analytics with rails 5 not working", "body": "<p>The article you are referring to is quite old (in Rails Land). Did you try </p>\n\n<p><a href=\"https://gist.github.com/esBeee/545653241530f8f2c2e16371bec56f20\" rel=\"noreferrer\">https://gist.github.com/esBeee/545653241530f8f2c2e16371bec56f20</a></p>\n\n<p>?</p>\n\n<p>In application.html.erb:</p>\n\n  \n\n<pre><code>    &lt;script type=\"text/javascript\"&gt;\n      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\n      ga('create', 'UA-XXXXXXXX-X', 'auto');\n    &lt;/script&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Put this file into your assets/javascripts/ folder and assure it gets loaded by checking or editing your assets/javascripts/application.js file as appropriate</p>\n\n<pre><code>document.addEventListener 'turbolinks:load', (event) -&gt;\n  if typeof ga is 'function'\n    ga('set', 'location', event.data.url)\n    ga('send', 'pageview')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 13498086, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gjp8qO6yIs1fWOqCdRjbk0dGxXjaFHK9J6AQ_2N=k-s128", "display_name": "Juan Luis Orozco Villalobos", "link": "https://stackoverflow.com/users/13498086/juan-luis-orozco-villalobos"}, "is_accepted": false, "score": 2, "last_activity_date": 1590147571, "creation_date": 1590147571, "answer_id": 61954175, "question_id": 46314712, "link": "https://stackoverflow.com/questions/46314712/google-analytics-with-rails-5-not-working/61954175#61954175", "title": "Google analytics with rails 5 not working", "body": "<p>I tried the following on Rails 6 with Turbolinks and Webpacker and it works, I hope it helps someone.</p>\n\n<p>Add this to the layout file's head:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;script async src=\"https://www.googletagmanager.com/gtag/js?id=YY-XXXXXXXXX-Z\"&gt;&lt;/script&gt;\n&lt;script&gt;\n  window.dataLayer = window.dataLayer || [];\n  function gtag(){dataLayer.push(arguments);}\n  gtag('js', new Date());\n&lt;/script&gt;\n</code></pre>\n\n<p>And then add this to your application.js file:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>$(document).on(\"turbolinks:load\", function() {\n  gtag('config', 'YY-XXXXXXXXX-Z', {'page_location': event.data.url});\n})\n</code></pre>\n\n<p>Replace <code>YY-XXXXXXXXX-Z</code> with your own tag and you are done.</p>\n"}], "owner": {"reputation": 77, "user_id": 8048092, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh5.googleusercontent.com/-3kq0QJUBaxw/AAAAAAAAAAI/AAAAAAAAAGQ/2gB7ozjeDI4/photo.jpg?sz=128", "display_name": "shahana hamza", "link": "https://stackoverflow.com/users/8048092/shahana-hamza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 918, "favorite_count": 0, "accepted_answer_id": 46314871, "answer_count": 2, "score": 1, "last_activity_date": 1590147571, "creation_date": 1505888773, "last_edit_date": 1505899637, "question_id": 46314712, "link": "https://stackoverflow.com/questions/46314712/google-analytics-with-rails-5-not-working", "title": "Google analytics with rails 5 not working", "body": "<p>I am trying to implement Google analytics with rails 5. Since i wanted to keep my turbolinks, i am following <a href=\"http://railsapps.github.io/rails-google-analytics.html\" rel=\"nofollow noreferrer\">http://railsapps.github.io/rails-google-analytics.html</a> this method. Added app/assets/javascripts/google_analytics.js.coffee:</p>\n\n<pre><code>class @GoogleAnalytics\n\n  @load: -&gt;\n    # Google Analytics depends on a global _gaq array. window is the global \n     scope.\n    window._gaq = []\n    window._gaq.push [\"_setAccount\", GoogleAnalytics.analyticsId()]\n\n    # Create a script element and insert it in the DOM\n    ga = document.createElement(\"script\")\n    ga.type = \"text/javascript\"\n    ga.async = true\n    ga.src = ((if \"https:\" is document.location.protocol then \n    \"https://ssl\" else \"http://www\")) + \".google-analytics.com/ga.js\"\n    firstScript = document.getElementsByTagName(\"script\")[0]\n    firstScript.parentNode.insertBefore ga, firstScript\n\n    # If Turbolinks is supported, set up a callback to track pageviews \n     on page:change.\n    # If it isn't supported, just track the pageview now.\n    if typeof Turbolinks isnt 'undefined' and Turbolinks.supported\n      document.addEventListener \"page:change\", (-&gt;\n      GoogleAnalytics.trackPageview()\n      ), true\n    else\n      GoogleAnalytics.trackPageview()\n\n  @trackPageview: (url) -&gt;\n  unless GoogleAnalytics.isLocalRequest()\n    if url\n      window._gaq.push [\"_trackPageview\", url]\n    else\n      window._gaq.push [\"_trackPageview\"]\n      window._gaq.push [\"_trackPageLoadTime\"]\n\n  @isLocalRequest: -&gt;\n    GoogleAnalytics.documentDomainIncludes \"local\"\n\n  @documentDomainIncludes: (str) -&gt;\n    document.domain.indexOf(str) isnt -1\n\n  @analyticsId: -&gt;\n    # your google analytics ID(s) here...\n    'UA-XXXXXXX-XX'\n\nGoogleAnalytics.load()\n</code></pre>\n\n<p>This doesnt work. I tried to debug it using Google analytics debugger.but its only showing</p>\n\n<pre><code>_gaq.push processing \"_setAccount\" for args: \"[UA-XXXXXXX-XX]\": \n</code></pre>\n\n<p>this in the console. When i tried calling directly</p>\n\n<pre><code>GoogleAnalytics.trackPageview()\n</code></pre>\n\n<p>I am getting data in my analytics account. \nBut throwing this</p>\n\n<pre><code>Method _trackPageLoadTime is deprecated. _trackPageLoadTime is deprecated. Site Speed tracking is enabled by default with trackPageview call at 1% sampling. Use _setSiteSpeedSampleRate for changing sample rate.\n</code></pre>\n\n<p>error in my console.\nWhat is the issue? Please help.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505912686, "post_id": 46314179, "comment_id": 79606382, "body": "Additionally to the answer you can clean up the load using <code>@all_hash_values = File.foreach(&quot;inputmd5.txt&quot;).map {|row| row.chomp }</code>. <code>File#foreach</code> returns an <code>Enumerator</code> then <code>Enumerator#map</code> will return a new <code>Array</code> based on the return values in the block and <code>String#chomp</code> will remove the trailing new line character. Right now you are creating an <code>Array</code> using <code>File#readlines</code> just to place the values into another <code>Array</code> (<code>@all_hash_values</code>) which will have performance impacts as well."}, {"owner": {"reputation": 51, "user_id": 7240147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agJNz.png?s=128&g=1", "display_name": "Roman77", "link": "https://stackoverflow.com/users/7240147/roman77"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1505921330, "post_id": 46314179, "comment_id": 79612929, "body": "@engineersmnky thanks for helping me out on that one! huge difference! Loading a inputmd5.txt with 10&#39;000&#39;000 lines, used to take around 40 seconds. Using your code, I&#39;m done in 9 sec!"}], "answers": [{"tags": [], "owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "is_accepted": false, "score": 1, "last_activity_date": 1505887007, "creation_date": 1505887007, "answer_id": 46314277, "question_id": 46314179, "link": "https://stackoverflow.com/questions/46314179/ruby-hashes-vs-arrays-quickest-way-to-find-an-item/46314277#46314277", "title": "Ruby Hashes vs. Arrays: quickest way to find an item?", "body": "<p><code>Array#include?</code> is O(N).</p>\n\n<p>Instead, since the array is already sorted, you could use <a href=\"http://ruby-doc.org/core-2.4.1/Array.html#method-i-bsearch\" rel=\"nofollow noreferrer\"><code>Array#bsearch</code></a>, which is O(lgN).</p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1505887264, "post_id": 46314334, "comment_id": 79590190, "body": "<code>O(1)</code> for hashes is obviously for <i>search by key</i>, not by value."}, {"owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1505887519, "post_id": 46314334, "comment_id": 79590306, "body": "I at least meant to have written that it would require the md5 to serve as the key."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1505887790, "post_id": 46314334, "comment_id": 79590418, "body": "And what would you suggest to serve as a value? If nothing, it would be <code>Set</code> as [correctly] suggested by Sergio in the top answer."}, {"owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1505887999, "post_id": 46314334, "comment_id": 79590511, "body": "You are right and that is why I upvoted his solution. At the time of writing the solution wasn&#39;t yet proposed and I wasn&#39;t aware of <code>Set</code> (keep on forgetting them). Just wanted to clarify my intend to not confuse later readers."}], "tags": [], "owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "is_accepted": false, "score": 1, "last_activity_date": 1505887207, "creation_date": 1505887207, "answer_id": 46314334, "question_id": 46314179, "link": "https://stackoverflow.com/questions/46314179/ruby-hashes-vs-arrays-quickest-way-to-find-an-item/46314334#46314334", "title": "Ruby Hashes vs. Arrays: quickest way to find an item?", "body": "<p>Didn't check for the implementation details in ruby (and if you absolutely rely upon it you would have to benchmark) but from what I learned in my CS classes this should boil down to:</p>\n\n<ul>\n<li><p>Array: O(n) or O(log n) based on method used</p></li>\n<li><p>Hash (assuming the md5 is the key): O(1)</p></li>\n</ul>\n\n<p>So I'd go with the Hash. </p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 7240147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agJNz.png?s=128&g=1", "display_name": "Roman77", "link": "https://stackoverflow.com/users/7240147/roman77"}, "edited": false, "score": 0, "creation_date": 1507096113, "post_id": 46314348, "comment_id": 80069443, "body": "Thanks Sergio. In the first step where I load thousands of hashvalues in either a set or an array, they are pretty much the same speed. Overall it&#39;s very fast: I load 10&#39;000&#39;000 MD5 hashvalues into a set/array in 10seconds! Using a set during the lookup part of the script, where I ask IF a certain hashvalue is in the set, has proven to be a bit faster then using an array. Thanks!"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 5, "last_activity_date": 1505888326, "last_edit_date": 1505888326, "creation_date": 1505887257, "answer_id": 46314348, "question_id": 46314179, "link": "https://stackoverflow.com/questions/46314179/ruby-hashes-vs-arrays-quickest-way-to-find-an-item/46314348#46314348", "title": "Ruby Hashes vs. Arrays: quickest way to find an item?", "body": "<p>Yes, you could use an array, which would be <code>O(logN)</code> at best, but it is both faster and semantically better to use a set.</p>\n\n<pre><code>require 'set'\n\nhashes = Set.new\nhashes &lt;&lt; 'foo'\nhashes &lt;&lt; 'bar'\nhashes.include?('bar') # =&gt; true\n</code></pre>\n\n<p>In ruby sets are implemented with hashtables, so lookups are <code>O(1)</code>.</p>\n"}], "owner": {"reputation": 51, "user_id": 7240147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agJNz.png?s=128&g=1", "display_name": "Roman77", "link": "https://stackoverflow.com/users/7240147/roman77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 46314348, "answer_count": 3, "score": 0, "last_activity_date": 1505890350, "creation_date": 1505886600, "last_edit_date": 1505890350, "question_id": 46314179, "link": "https://stackoverflow.com/questions/46314179/ruby-hashes-vs-arrays-quickest-way-to-find-an-item", "title": "Ruby Hashes vs. Arrays: quickest way to find an item?", "body": "<p>I'm loading large TXT files into an array or hash using ruby. The input file contains more than 1'000'000 MD5 hash values, alphabetically sorted, no duplicates.</p>\n\n<p>What is the fastest way in Ruby, to find out if a certain hash value is present in my array or hash? Currently I use an array and \"include?\".</p>\n\n<pre><code>def loadhashlist\n@all_hash_values = Array.new\n    f = File.readlines(\"inputmd5.txt\").each do |row|\n    @all_hash_values.push(row.gsub(\"\\n\",\"\"))\n    end\nend\n\nloadhashlist\n\ndef hashlookup(file)\nmd5 = file.getMd5\n    if @all_hash_values.include? md5\n    #code goes here\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "controller"], "comments": [{"owner": {"reputation": 1564, "user_id": 755421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71312ffca1775d45c43afabf53358838?s=128&d=identicon&r=PG", "display_name": "bitsapien", "link": "https://stackoverflow.com/users/755421/bitsapien"}, "edited": false, "score": 0, "creation_date": 1505888741, "post_id": 46313779, "comment_id": 79590861, "body": "Please also show the method definition of <code>series_params</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "is_accepted": false, "score": 0, "last_activity_date": 1505892673, "creation_date": 1505892673, "answer_id": 46315841, "question_id": 46313779, "link": "https://stackoverflow.com/questions/46313779/multiple-select-form-on-rails-polymorphic-associations/46315841#46315841", "title": "Multiple select form on rails polymorphic associations", "body": "<p>You need to follow this instructions for <a href=\"http://guides.rubyonrails.org/form_helpers.html#building-complex-forms\" rel=\"nofollow noreferrer\">building complex forms</a>. </p>\n\n<p>This way you can create a form that has the input values for creating <code>@serie</code>, but also for creating <code>@serie.tags</code>.</p>\n\n<p>You need to read that guide, but in synthesis you need to do the following 3 steps:</p>\n\n<ol>\n<li>Configure the model and allow <code>nested_attributes</code></li>\n<li>Build a nested form</li>\n<li>In the controller, configure your strong params for the nested object</li>\n<li>Instanciate the variable <code>@serie</code> in the controller with your strong_params, so that it will create the associated object</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 8638523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd5ee9d806e4d5fb80c6be000f667ad?s=128&d=identicon&r=PG&f=1", "display_name": "user8638523", "link": "https://stackoverflow.com/users/8638523/user8638523"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 647, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1505949500, "creation_date": 1505884520, "last_edit_date": 1505949500, "question_id": 46313779, "link": "https://stackoverflow.com/questions/46313779/multiple-select-form-on-rails-polymorphic-associations", "title": "Multiple select form on rails polymorphic associations", "body": "<p>The association is working fine since I can play with it on IRB. Also I can <strong>edit</strong> existing books to add tags but I <strong>can't</strong> create and assign a tag at the same time (\"Tags is invalid\" validation error). I suppose it's a form / controller issue, I think I have to .build it but I can't figure it out how.</p>\n\n<pre><code>## Tag model (:tags)\nbelongs_to :genre                                                              \nbelongs_to :taggable, polymorphic: true\n\n## Genre model (:genres)\nhas_many :tags                                                                 \nhas_many :taggables, through: :tags   \n\n## Serie model (:series)\nhas_many :tags, as: :taggable, dependent: :destroy                             \nhas_many :genres, through: :tags \n\n## Book model (:books)\nhas_many :tags, as: :taggable, dependent: :destroy                             \nhas_many :genres, through: :tags \n</code></pre>\n\n<p>Series_Controller</p>\n\n<pre><code>before_action :select_genre\n\n[...]\n\ndef new                                                                        \n  @series = current_user.series.build                                           \nend\n\ndef edit\nend\n\ndef create                                                                     \n  @serie = current_user.series.build series_params                              \n  @serie.save                                                               \n    redirect_to admin_series_path         \n  end                                                             \nend \n\n[...]\n# Useful\ndef select_genre                                                                \n  @genres = Genre.all                                                        \nend \n</code></pre>\n\n<p>Form</p>\n\n<pre><code>&lt;select name=\"serie[genre_ids][]\" multiple=\"multiple\"&gt;\n  &lt;% @series.each do |serie| %&gt;                                            \n    &lt;option value=\"&lt;%= serie.id %&gt;\"&gt;&lt;%= serie.name %&gt;&lt;/option&gt;\n  &lt;% end %&gt;                                                                \n&lt;/select&gt;                                                                  \n</code></pre>\n\n<hr>\n\n<hr>\n\n<p><strong>Edit: Thank you @Fabrizio Bertoglio, it works fine for single options but I couldn't make it work for multiple genres.</strong></p>\n\n<pre><code># SERIES CONTROLLER\ndef new\n  @series = current_user.series.build                                           \n  @series.tags.build                                                            \nend\n\n# PARAMS\nparams.require(:serie).permit ...... tags_attributes: [ :genre_id ]\n\n# GENRE MODEL\n** adding 'optional: true' to 'belongs_to :taggable' **\n</code></pre>\n\n<p>Form</p>\n\n<pre><code>&lt;select name=\"serie[tags_attributes][0][genre_id]\"&gt;\n  &lt;% @series.each do |serie| %&gt;                                            \n    &lt;option value=\"&lt;%= serie.id %&gt;\"&gt;&lt;%= serie.name %&gt;&lt;/option&gt;\n  &lt;% end %&gt;                                                                \n&lt;/select&gt;\n</code></pre>\n\n<p>As I said before it works fine but if I swap <code>genre_id</code> with <code>genre_ids</code> it stop working instead allowing the user to select multiple genres and create multiple tags.</p>\n\n<pre><code># CONTROLLER\nparams.require(:serie).permit ...... tags_attributes: [ { genre_ids: [] } ]    \n\n# FORM\n&lt;select name=\"serie[tags_attributes][0][genre_ids][]\" multiple=\"multiple\"&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "ruby-on-rails-4", "ruby-on-rails-3.2"], "comments": [{"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1505891261, "post_id": 46313402, "comment_id": 79592270, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 I deleted both answers, because they are both wrong. Sorry"}, {"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1505891704, "post_id": 46313402, "comment_id": 79592522, "body": "what is the ajax code for? you are using <code>turbolinks</code>? why are you using <code>$(document).ready()</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "is_accepted": false, "score": 1, "last_activity_date": 1505892729, "last_edit_date": 1505892729, "creation_date": 1505892280, "answer_id": 46315705, "question_id": 46313402, "link": "https://stackoverflow.com/questions/46313402/making-an-ajax-call-to-get-data-from-a-search-form-result-to-render/46315705#46315705", "title": "Making an AJAX call to get data from a search form result to render.", "body": "<p>What is happening in your case when you call <code>render partial: 'lookup'</code> in your controller action it is giving the code in response you can check that on browser's developer console but it doesn't know what to do of that response like either append it prepend it replace any HTML from the DOM etc etc. </p>\n\n<p>Try this:</p>\n\n<p>In your controller action write this:</p>\n\n<pre><code>def search\n  if params[:stock]\n    @stock = Stock.find_by_ticker(params[:stock])\n    @stock ||= Stock.new_from_lookup(params[:stock])\n  end\n  respond_to do |format|\n    format.js\n  end\nend\n</code></pre>\n\n<p>In your <code>app/views/stocks</code> create a file <code>search.js.erb</code> and in it write the code:</p>\n\n<pre><code>&lt;% if @stock %&gt;\n  $('body').html(\"&lt;%= j render partial: 'lookup' %&gt;\");\n&lt;% end %&gt;\n</code></pre>\n\n<p>You will definetely need to change <code>$('body').html</code> to some relevant selector in your application.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 377, "user_id": 8076132, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/3d1ca0dd757a47cbddb2ab6dcd9fa957?s=128&d=identicon&r=PG&f=1", "display_name": "jdip88", "link": "https://stackoverflow.com/users/8076132/jdip88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 831, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1505892729, "creation_date": 1505882303, "question_id": 46313402, "link": "https://stackoverflow.com/questions/46313402/making-an-ajax-call-to-get-data-from-a-search-form-result-to-render", "title": "Making an AJAX call to get data from a search form result to render.", "body": "<p>I am making a stock application and basically the user needs to enter a ticker and after going through the ajax call it will return the instance variable containing the price, ticker, and name. It will also render right below the search bar.</p>\n\n<p>here is a pic of the UI\n<a href=\"https://i.stack.imgur.com/5N8sO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5N8sO.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the model</p>\n\n<pre><code>&lt;div id=\"stock-lookup\"&gt;\n    &lt;h3&gt;Search for Stocks&lt;/h3&gt;\n    &lt;%= form_tag search_stocks_path, remote: true, method: :get, id: 'stock-lookup-form' do %&gt;\n    &lt;div class=\"form-group row no-padding text-center col-md-12\"&gt;\n        &lt;div class=\"col-md-10\"&gt;\n        &lt;%= text_field_tag :stock,\n        params[:stock],\n        placeholder: 'Stock Ticker Symbol',\n        autofocus: true,\n        class: 'form-control search-box input-lg' %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-md-2\"&gt;\n        &lt;%= button_tag(type: :submit, class: 'btn btn-lg btn-success') do %&gt;\n            &lt;i class='fa fa-search'&gt;&lt;/i&gt; Look up a stock\n        &lt;% end %&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n&lt;% if @stock %&gt;\n&lt;div id=\"stock-lookup-results\" class=\"well results-block\"&gt;\n    &lt;strong&gt;Symbol:&lt;/strong&gt; &lt;%= @stock.ticker %&gt;\n    &lt;strong&gt;Name:&lt;/strong&gt; &lt;%= @stock.name %&gt;\n    &lt;strong&gt;Price:&lt;/strong&gt; &lt;%= @stock.price %&gt;\n&lt;/div&gt;\n&lt;div id=\"stock-lookup-errors\"&gt;&lt;/div&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Here is the controller </p>\n\n<pre><code>class StocksController &lt; ApplicationController\n\n    def search\n        if params[:stock]\n            @stock = Stock.find_by_ticker(params[:stock])\n            @stock ||= Stock.new_from_lookup(params[:stock])\n        end\n        if @stock\n            puts @stock.price\n            render partial: 'lookup'\n        else\n            render status: :not_found, nothing: true\n        end\n    end\n\nend\n</code></pre>\n\n<p>when I puts puts @stock.price, I am getting the information I want. It then proceeds to render the page I want, but it doesnt seem to get me the information which is rendered in an erb file with an if condition that says if @stock, render the necessary information.</p>\n\n<p>here is the view to give you an idea of what I am talking about.</p>\n\n<pre><code>&lt;div id=\"stock-lookup\"&gt;\n    &lt;h3&gt;Search for Stocks&lt;/h3&gt;\n    &lt;%= form_tag search_stocks_path, remote: true, method: :get, id: 'stock-lookup-form' do %&gt;\n    &lt;div class=\"form-group row no-padding text-center col-md-12\"&gt;\n        &lt;div class=\"col-md-10\"&gt;\n        &lt;%= text_field_tag :stock,\n        params[:stock],\n        placeholder: 'Stock Ticker Symbol',\n        autofocus: true,\n        class: 'form-control search-box input-lg' %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-md-2\"&gt;\n        &lt;%= button_tag(type: :submit, class: 'btn btn-lg btn-success') do %&gt;\n            &lt;i class='fa fa-search'&gt;&lt;/i&gt; Look up a stock\n        &lt;% end %&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n&lt;% if @stock %&gt;\n&lt;div id=\"stock-lookup-results\" class=\"well results-block\"&gt;\n    &lt;strong&gt;Symbol:&lt;/strong&gt; &lt;%= @stock.ticker %&gt;\n    &lt;strong&gt;Name:&lt;/strong&gt; &lt;%= @stock.name %&gt;\n    &lt;strong&gt;Price:&lt;/strong&gt; &lt;%= @stock.price %&gt;\n&lt;/div&gt;\n&lt;div id=\"stock-lookup-errors\"&gt;&lt;/div&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I also am making an ajax call in a separate js file which seems to be doing its job.</p>\n\n<pre><code>var init_stock_lookup;\n\ninit_stock_lookup = function() {\n    $('#stock-lookup-form').on('ajax:success', function(event, data, status) {\n         $('#stock-lookup').append(data);\n         init_stock_lookup();\n    })\n}\n\n    $('#stock-lookupform').on('ajax:error',function(event, xhr, status, error){\n        $('#stock-lookup-results').replaceWith(' ');\n        $('#stock-lookup-errors').replaceWith('Stock was not found.')\n    });\n\n$(document).ready( function(){\n    init_stock_lookup();\n})\n</code></pre>\n\n<p>def not a rails or ruby master, so any help would be much appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5288580, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d017f196b031a1a5858572531e55e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "Bjornn Borg", "link": "https://stackoverflow.com/users/5288580/bjornn-borg"}, "edited": false, "score": 0, "creation_date": 1505910105, "post_id": 46314529, "comment_id": 79604539, "body": "Thanks. The last one I read before posting. I will read again... But I`m still missing why @@var got the same for all including classes (so, I got &#39;invalid field&#39; errors) instead of becoming available for each including class. If I understood correctly, @@var was created and maintained inside the &quot;InnerModule&quot;, therefore, was shared to all. Is it what happened? I got this right? Is there a way to make one @@var to each including class?"}, {"owner": {"reputation": 21, "user_id": 5288580, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d017f196b031a1a5858572531e55e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "Bjornn Borg", "link": "https://stackoverflow.com/users/5288580/bjornn-borg"}, "edited": false, "score": 0, "creation_date": 1505910183, "post_id": 46314529, "comment_id": 79604598, "body": "&quot;Must be initialized at creation time&quot; means I need to do something in my including class? It includes the module, class de class method, and inside this class method @@var should be set. Is it ok as &quot;initialize at creation time&quot;?"}], "tags": [], "owner": {"reputation": 2124, "user_id": 839787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f330a19645ff0895459fce9ca810b3ce?s=128&d=identicon&r=PG", "display_name": "Stephane Paquet", "link": "https://stackoverflow.com/users/839787/stephane-paquet"}, "is_accepted": false, "score": 0, "last_activity_date": 1505887960, "creation_date": 1505887960, "answer_id": 46314529, "question_id": 46313218, "link": "https://stackoverflow.com/questions/46313218/ruby-variables-visibility-inside-modules/46314529#46314529", "title": "Ruby variables visibility inside modules", "body": "<p>Read the following articles on Ruby variables:</p>\n\n<ul>\n<li><a href=\"http://www.techotopia.com/index.php/Ruby_Variable_Scope\" rel=\"nofollow noreferrer\">Ruby Variable Scope</a></li>\n<li><a href=\"https://www.sitepoint.com/understanding-scope-in-ruby/\" rel=\"nofollow noreferrer\">Understanding Scope in Ruby</a></li>\n</ul>\n\n<p>quick reminder: <code>@@title_fields</code>, class variable, must be initialized at creation time, while <code>@title_fields</code>, instance variable, hasn't such requirement.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5288580, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d017f196b031a1a5858572531e55e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "Bjornn Borg", "link": "https://stackoverflow.com/users/5288580/bjornn-borg"}, "edited": false, "score": 0, "creation_date": 1505910226, "post_id": 46314887, "comment_id": 79604642, "body": "This &quot;thing&quot; with class_attribute reminds (the idea) me of the way (wrong) I tried with just &#39;@&#39;var. I will try to modify my code to match yours and see what happens. But, &#39;@&#39;var var shouldn&#39;t be made available inside my including object? Or @@var made visible just like class_attribute?"}, {"owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "reply_to_user": {"reputation": 21, "user_id": 5288580, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d017f196b031a1a5858572531e55e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "Bjornn Borg", "link": "https://stackoverflow.com/users/5288580/bjornn-borg"}, "edited": false, "score": 0, "creation_date": 1505931210, "post_id": 46314887, "comment_id": 79619039, "body": "You will not be able to make the <code>@@var</code> (class variables) available in the including class&#39; instances directly. <code>@var</code> (instance  variables) you can access but you will not be able to assign values to it via a class method.    Strictly speaking you could wrap the class variable inside a class method e.g. <code>def text_fields @@text_fields end</code> and access it via <code>self.class.text_fields</code> in an instance but this would leave you with the problem of one including class overriding the values of another&#39;s including class."}], "tags": [], "owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "is_accepted": false, "score": 0, "last_activity_date": 1505889441, "creation_date": 1505889441, "answer_id": 46314887, "question_id": 46313218, "link": "https://stackoverflow.com/questions/46313218/ruby-variables-visibility-inside-modules/46314887#46314887", "title": "Ruby variables visibility inside modules", "body": "<p>Instead of relying on class variables I recommend using class side instance variables. Class variables will easily be overwritten between individual models including the module. Class side instance variables however are save.</p>\n\n<p>Using some of the syntactic sugar (namely <a href=\"http://api.rubyonrails.org/v5.1/classes/ActiveSupport/Concern.html\" rel=\"nofollow noreferrer\">concern</a> and <a href=\"https://apidock.com/rails/Class/class_attribute\" rel=\"nofollow noreferrer\">class_attribute</a>) rails offers you could write something like </p>\n\n<pre><code>module ElasticFakeIndexing\n  extend ActiveSupport::Concern\n\n  included do\n    class_attribute :title_fields, \n                    :description_fields,\n                    :extra_args\n  end\n\n  class_methods do\n    def elastic_fake(options = {})\n      ...\n      self.title_fields = Array(options[:title])\n      ...\n    end\n  end\n\n  def build_index_data\n    ...\n    title: self.class.title_fields ...\n    ...\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5288580, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d017f196b031a1a5858572531e55e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "Bjornn Borg", "link": "https://stackoverflow.com/users/5288580/bjornn-borg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 555, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505889441, "creation_date": 1505881053, "question_id": 46313218, "link": "https://stackoverflow.com/questions/46313218/ruby-variables-visibility-inside-modules", "title": "Ruby variables visibility inside modules", "body": "<p><strong>TL;DR;</strong>\nI need to make some @@vars of a static method (extends) in one module visible to a instance method in another module(includes). </p>\n\n<p>How to accomplish that once only setting @@var=value was not enough to make it visible?</p>\n\n<p>Maybe you can just read my capitalized comment bellow and jump to question 4.</p>\n\n<hr>\n\n<p>Hi, I would like to add an method to my models to index some data in a mysql table with some full text search fields.</p>\n\n<p>In order to accomplish that, I created the following module:</p>\n\n<pre><code>module ElasticFakeIndexing\n\n  module IndexingTarget\n\n    #instance method to be called on model to get data to save\n    def build_index_data\n      {\n        entity_id: self.id, \n        entity_type: self.class.name, \n\n        #UNABLE TO ACCESS IF SET ONLY WITH @@var=value. Why?\n        #AND ALMOST SURE THAT USING class_variable_set IS THE CAUSE OF CONFIGURATION OF ONE MODULE MESSING UP WITH ANOTHER'S\n        title: @@title_fields.collect{|prop| self.send(prop.to_sym)}.join(\" || \"), \n        description: @@description_fields.collect{|prop| self.send(prop.to_sym)}.join(\" || \"),\n      }\n    end\n\n    def self.included(base)\n      base.extend ClassMethods\n    end\n\n    module ClassMethods\n\n      #class method to declare/call at a given model\n      def elastic_fake(options = {})\n        #Make sure we always get an array so we can use 'join'\n        title_arg = Array(options[:title])\n        ElasticFakeIndexing::IndexingTarget.class_variable_set(:@@title_fields, title_arg)\n        description_arg = Array(options[:description])\n        ElasticFakeIndexing::IndexingTarget.class_variable_set(:@@description_fields, description_arg)\n        extra_arg =  Array(options[:extra])\n        ElasticFakeIndexing::IndexingTarget.class_variable_set(:@@extra_args, extra_arg)\n\n      end\n\n    end\n\n  end\n\nend\n</code></pre>\n\n<p>And I use it this way at my models:</p>\n\n<pre><code>class SomeModel &lt; ApplicationRecord\n  #includes the module\n  include ElasticFakeIndexing::IndexingTarget\n\n  ...\n\n  # 'static' method call to configure to all classes of this model\n  elastic_fake(title: \"prop_a\", description: [\"prop_b\", \"prop_c\", \"prop_d\"])\nend\n</code></pre>\n\n<p>And at some point of my code something like this will be called:</p>\n\n<pre><code>index_data = some_model_instance.build_index_data\nsave_on_mysql_text_search_fields(index_data)\n</code></pre>\n\n<p>But I got some problems. And have some questions:</p>\n\n<ol>\n<li><p>when I use/include my module in a second model, looks like the configuration of one model is being visible to the other. And I got 'invalid fields' like errors. I guess it happens because of this, for example:\nElasticFakeIndexing::IndexingTarget.class_variable_set(:@@title_fields, title_arg)</p></li>\n<li><p>But I got to this this because only set @@title_fields wasn't enough to make title_fields visible at build_index_data instance method. Why?</p></li>\n<li>Why using only @title_fields isn't enough too to make it visible at build_index_data?</li>\n<li>How to design it in a way that the set of fields are set in a 'static' variable for each model, and visible inside the instance method build_index_data? Or as a possible solution, the fields could live in a instance variable and be visible. But I think it should live in a 'static' variable because the fields will not change from one instance of the model to another...</li>\n</ol>\n\n<p>Any thoughts? What am I missing about the variables scopes/visibility?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "import", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "is_accepted": true, "score": 1, "last_activity_date": 1506565695, "creation_date": 1506565695, "answer_id": 46460035, "question_id": 46313181, "link": "https://stackoverflow.com/questions/46313181/spreadsheet-import-validation-with-persisted-import-model/46460035#46460035", "title": "Spreadsheet import validation with persisted import model", "body": "<p>So after posting this question with no responses, I decided to brush up on my Ruby IRB skills to work my way through the process and analyze the data every step of the way. \nAfter much trial and error, I've finally completed this task! </p>\n\n<p>To provide a brief overview of my final process: </p>\n\n<p>Following the methodology of the answer in this SO question, <a href=\"https://stackoverflow.com/a/38856987/7286108\">Ruby on Rails: Validate CSV file</a>, I decided to </p>\n\n<ol>\n<li>Break out the validations into its own Ruby class.</li>\n<li>Using <a href=\"https://github.com/roo-rb/roo\" rel=\"nofollow noreferrer\">Roo's <code>Parse</code> method</a>, I passed each row as a Hash to <code>OrderImportValidator.new()</code></li>\n<li>Pass the <code>row[:property]</code> pair through my <code>import_address_parse</code> method.</li>\n<li>Instantiate both <code>row[:property] &amp;&amp; row[:owner]</code> using <code>.find_or_initialize_by</code> method to their respective models.</li>\n<li>Pair up each <code>:property</code> and <code>:owner</code> objects into a hash within a <code>OrderImportValidator</code> instance variable (<code>@order_objects</code>) and allow access to it from my <code>OrderImport</code> model via a method (very similar to how the <code>@errors</code> is returned in the linked SO CSV question).</li>\n<li>Verify validation of all values (instantiated objects) in the returned hash.</li>\n<li>If all were good, then I called <code>save</code> on each, create the correct associations, and appropriate <code>order</code> for each pair.</li>\n<li>Added a custom <code>validate :import_error_check, on: :create</code> to my <code>OrderImport</code> model.</li>\n<li>Run through <code>each.with_index</code>, check if errors exist, clear the errors on the object and add my custom message to <code>errors[:base]</code> of <code>Order Import</code> with their appropriate <code>index</code> and display them on the page.</li>\n</ol>\n\n<p>Pretty pumped I figured it out and have furthered my knowledge of data manipulation, objects, and ruby syntax. Maybe the outline of my process will help someone else one day. Cheers.</p>\n"}], "owner": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 46460035, "answer_count": 1, "score": 0, "last_activity_date": 1506565695, "creation_date": 1505880836, "question_id": 46313181, "link": "https://stackoverflow.com/questions/46313181/spreadsheet-import-validation-with-persisted-import-model", "title": "Spreadsheet import validation with persisted import model", "body": "<p>I've been struggling the last couple days trying to create an import process for users to upload CSV/Excel files. I have been trying to imitate the process done in this <a href=\"http://railscasts.com/episodes/396-importing-csv-and-excel?view=asciicast\" rel=\"nofollow noreferrer\">Railscast</a> episode. However, my requirements are a bit more complex so I have been trying to modify what has been done there but I have hit a wall when it comes to enforcing model validation to ensure against any bad data.</p>\n\n<p>I am trying to use <a href=\"https://github.com/roo-rb/roo\" rel=\"nofollow noreferrer\">Roo</a> to allow my users the ability to upload CSV or Excel files. I also would like to <strong>save</strong> the <code>OrderImport</code> model with the uploaded spreadsheet and some other information for historical reference and what not.</p>\n\n<p><strong>Models</strong></p>\n\n<pre><code>property.rb\n  has_many :owners\n  has_many :orders\n\nowner.rb\n  belongs_to :property\n\norder.rb\n  belongs_to :property\n  has_many :owners, through: :property\n\norder_import.rb\n  #no assications\n  #uses paperclip to save the attached file\n</code></pre>\n\n<p><strong>Order Import process in <code>order_import.rb</code></strong></p>\n\n<pre><code>def load_imported_orders(file, cid, uid) #loads file from controller along with client_id and user_id for use in order creation\n  spreadsheet = Roo::Spreadsheet.open(file.path)\n  header = spreadsheet.row(1)\n  order_imports = (2..spreadsheet.last_row).map do |i|\n    row = Hash[[header, spreadsheet.row(i)].transpose]\n    property = row[\"address\"]\n    propparse = import_address_parse(property) #to parse submitted address\n    newprop = if Property.exists?(propparse)\n                Property.find_by(propparse)\n              else\n                Property.new(propparse)\n              end\n    owner = row[\"owner\"]\n    newowner = Owner.find_or_initialize_by(name: owner)\n    newprop.owners &lt;&lt; newowner #creates new property/owner association\n    neworder = Order.new(property_id: newprop.id,\n                         client_id: cid,\n                         task: \"Property Report\",\n                         submitted_by: uid)\n    neworder\n    newprop\n    newowner\n  end\n  @imported_orders = order_imports\nend\n\ndef import_address_parse(property)\n  address = StreetAddress::US.parse(property)\n  if address.blank?\n    new_blank_prop = { address1: nil,\n                       city: nil,\n                       state: nil,\n                       zipcode: nil }\n  else\n    new_prop = { address1: address.to_s(:line1),\n                 city: address.city,\n                 state: address.state_name,\n                 zipcode: address.postal_code}\n  end\nend\n\ndef save\n  if @imported_orders.map(&amp;:valid?).all?\n    @imported_orders.each(&amp;:save!)\n    true\n  else\n    @imported_orders.each_with_index do |order, index|\n      if order.instance_of?(Property) #needed to reduce the amount of errors shown on the form\n        errors.add :base, \"Row #{index+2}: Please re-check the Address of your Property.\"\n      else\n        order.errors.full_messages.each do |message| #shows any errors not related to property\n          errors.add :base, \"Row #{index+2}: #{message} | #{order}\"\n        end\n      end\n    end\n    false\n  end\nend\n</code></pre>\n\n<p><strong><code>order_import controller</code></strong></p>\n\n<pre><code>def create\n  @order_import = OrderImport.new(params[:order_import_params])\n  @order_import.load_imported_orders(params[:order_import][:document], params[:order_import][:client_id], params[:order_import][:submitted_by])\n  if @order_import.save\n    redirect_to external_client_orders_path(current_user.client_id), notice: \"Imported Orders successfully.\"\n  else\n    render :new\n  end\nend    \n</code></pre>\n\n<p>So as you can see, the <code>load_imported_orders()</code> method gets called from the controller and parses the spreadsheet. Then a <code>property &amp; owner</code> are found (if they happen to exist already) or initialized and then an <code>order</code> is initialized from the items in that row. (I've tried using something like a <code>:before_create</code> filter in my <code>OrderImport</code> model but I have no idea how these different guides are opening files passed through <code>OrderImport.new(params[:order_import_params])</code> without the model being saved first - and of course I don't want to save unless everything imports correctly).</p>\n\n<p>The purpose for the <code>import_address_parse</code> method is because the address is submitted as one line (555 test rd, testington, tt, 55555) but is comprised of <code>address1, city, state, zipcode</code> in my database. The <a href=\"https://github.com/street-address-rb/street-address\" rel=\"nofollow noreferrer\">StreetAddress gem</a> will return <code>nil</code> if it cannot parse the entire address string so I have put that catch in there to return a nil object in hopes to fail the <code>property</code> model validations when <code>Property.new</code> is initialized with all nil values in those fields. </p>\n\n<p><strong>The problems</strong></p>\n\n<p>For some reason the <code>Property</code> validation does not fail on its own, I am  only alerted when <code>owners</code> go to be saved and associated to the <code>new property</code> in the <code>save</code> method. <code>Property.exists?()</code> with all nil attributes still loads a <code>property</code> for some reason instead of initializing <code>Property.new</code> and I can't for the life of me figure out why.</p>\n\n<p>The <code>order</code> validation fails because a no <code>property.id</code> exists since the <code>new property</code> hasn't been saved yet, which I understand, but I'm not sure how create the <code>Order</code> association/creation from the <code>save</code> method (i.e. outside of the <code>load_import_orders</code> method which is parsing the import data).</p>\n\n<p>I think my understanding of the entire validation side of importing bulk records is <strong>fundamentally wrong</strong>, especially since I cannot get the <code>OrderImport</code> record to save correctly even when adding <code>create_or_update</code> (<a href=\"https://apidock.com/rails/v1.2.6/ActiveRecord/Base/save\" rel=\"nofollow noreferrer\">Rails API docs)</a> to my <code>save</code> method, which overwrites the default rails save method for the model.</p>\n\n<p>This may be easier than I'm making it out to be but I would consider myself to still be an amateur Rails developer (having taught myself everything through tutorials, SO posts, guides/articles) and am diving into what I think is complex methodology so if someone could take the time to assist me with refining this process so that I can achieve what my goal is here and attain a deeper understanding of rails in general.</p>\n\n<p>Added caveat, if I change all the <code>find_or_initialize_by / new</code> calls to <code>create!</code> and ONLY use data I know would pass all validations then this process works as intended but we all know thats not realistic in a real-world environment. I think since that part works its throwing me off from re-engineering this a bit (it's not the end of the world if using built in rails <code>CSV.parse</code> instead of Roo is the way to go but I'd like to provide the option of being able to import from excel but its not a necessary one).</p>\n\n<p>Thank you to anyone who takes the time to break this down and help me out. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 458, "user_id": 2126488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed2133ec38735ac8b559897c58cd3d0?s=128&d=identicon&r=PG", "display_name": "bishal", "link": "https://stackoverflow.com/users/2126488/bishal"}, "edited": false, "score": 0, "creation_date": 1505879466, "post_id": 46312632, "comment_id": 79587653, "body": "I think it comes down to personal preference. But a general personal preference of most people (including me) seems to be: Indent using spaces with Tab Width: 2, at least for Ruby.  While there is no real problem in the app, but using 2 spaces is more readable and might avoid conflicts when working with others. Also saves you from that look from older devs."}, {"owner": {"reputation": 257, "user_id": 6642551, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1145135395532946/picture?type=large", "display_name": "Jacob Moore", "link": "https://stackoverflow.com/users/6642551/jacob-moore"}, "reply_to_user": {"reputation": 458, "user_id": 2126488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed2133ec38735ac8b559897c58cd3d0?s=128&d=identicon&r=PG", "display_name": "bishal", "link": "https://stackoverflow.com/users/2126488/bishal"}, "edited": false, "score": 0, "creation_date": 1505880190, "post_id": 46312632, "comment_id": 79587797, "body": "So other than the full tab I used to indent, the code is indented in the correct areas? I&#39;ve been under the assumption that you on indent after anything with a &quot;do, end&quot;"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1505880506, "post_id": 46312632, "comment_id": 79587897, "body": "Here&#39;s a style guide you can check through <a href=\"https://github.com/bbatsov/ruby-style-guide\" rel=\"nofollow noreferrer\">github.com/bbatsov/ruby-style-guide</a>, but in general it&#39;s less an issue of 2 spaces vs 4 spaces or hard tabs vs soft tabs so much as some lines are indented when they shouldn&#39;t be and others aren&#39;t indented when they should and that ends up with code that looks like a <code>do</code> without an <code>end</code> or an <code>end</code> that doesn&#39;t appear to be lined up or closing anything obvious and then it just gets hard to tell what scope you&#39;re in and a whole host of issues can creep in un-noticed"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1505880737, "post_id": 46312632, "comment_id": 79587963, "body": "There&#39;s nothing huge with this code sample, but in <a href=\"https://github.com/jmooree30/Knights_Travels/blob/master/knights_travels.rb\" rel=\"nofollow noreferrer\">this one</a> posted in your <a href=\"https://stackoverflow.com/questions/46187888/keeping-track-of-the-path-knights-travel\">most recent question</a>, if someone is glancing through that code and then are asked what the <code>end</code> on line 32 is closing, I feel like more people would get it wrong than correct, until they sit down and start kind of manually indenting things to notice that it actually closes <code>class Knight</code> and <code>shortest_path</code> is intentionally defined outside the class"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1505881175, "post_id": 46312632, "comment_id": 79588060, "body": "So, in summary, just need to make sure you&#39;re <code>end</code> is at the same indentation level as whatever it&#39;s closing, whether it&#39;s a <code>class</code>, <code>def</code>, <code>if</code>, <code>do</code>, etc."}, {"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1505883974, "post_id": 46312632, "comment_id": 79588920, "body": "This mostly looks fine, except: your lowest (left-most) level of indention is 2 spaces, when it should be 0.  The different levels of indentation in your code are separated by 4 spaces, but the widely-accepted style in the Ruby community is to use 2 spaces.  I&#39;d suggest reading more Ruby code; like find a gem you use and just read the source code of it."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1505888662, "post_id": 46312632, "comment_id": 79590808, "body": "The easiest way to format your code correctly is to not format your code. Any halfway-decent editor has code formatting for Ruby builtin that follows the Community Coding Style Guidelines. Don&#39;t manually perform a task that a machine can do. (That&#39;s pretty much what it means to be a programmer.)"}], "answers": [{"tags": [], "owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "is_accepted": true, "score": -1, "last_activity_date": 1505883548, "creation_date": 1505883548, "answer_id": 46313618, "question_id": 46312632, "link": "https://stackoverflow.com/questions/46312632/is-this-indentation-correct/46313618#46313618", "title": "Is this indentation correct?", "body": "<p>Here is the good link to follow all the rules of the indentation</p>\n\n<p><a href=\"https://github.com/github/rubocop-github/blob/master/STYLEGUIDE.md\" rel=\"nofollow noreferrer\">https://github.com/github/rubocop-github/blob/master/STYLEGUIDE.md</a></p>\n"}], "owner": {"reputation": 257, "user_id": 6642551, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1145135395532946/picture?type=large", "display_name": "Jacob Moore", "link": "https://stackoverflow.com/users/6642551/jacob-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 46313618, "answer_count": 1, "score": 0, "last_activity_date": 1505883548, "creation_date": 1505876998, "question_id": 46312632, "link": "https://stackoverflow.com/questions/46312632/is-this-indentation-correct", "title": "Is this indentation correct?", "body": "<p>I thought I understood the rules on indenting but almost every question I ask on S/O ends up with a comment \"indent your code correctly\". Just want to clear this up once and for all. This is a snippet from a project I am working on. What's indented correctly and what isn't?</p>\n\n<pre><code>  def display\n      print \"   1     2     3     4     5     6     7\"\n      @board.each do |i|\n          print \"\\n\"\n          @draw = \"+-----+-----+-----+-----+-----+-----+-----+\"\n          puts @draw\n          i.each do |n|\n              print \"|  #{n}  \"\n          end\n          print \"|\"\n      end \n      print \"\\n\"\n      print @draw\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 3, "creation_date": 1505885266, "post_id": 46312767, "comment_id": 79589348, "body": "Rails has a method <code>1.week</code> you can use instead of the &#39;magic&#39; numbers: <code>1.week == (7 * 24 * 60 * 60)</code>"}], "tags": [], "owner": {"reputation": 1371, "user_id": 623316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2761ad1bad1ee4f56dd5c3514dd765?s=128&d=identicon&r=PG", "display_name": "Jon Wolski", "link": "https://stackoverflow.com/users/623316/jon-wolski"}, "is_accepted": true, "score": 3, "last_activity_date": 1505920169, "last_edit_date": 1505920169, "creation_date": 1505878008, "answer_id": 46312767, "question_id": 46312542, "link": "https://stackoverflow.com/questions/46312542/given-a-timestamp-how-to-determine-how-many-weeks-ago/46312767#46312767", "title": "Given a timestamp, how to determine how many weeks ago?", "body": "<p>If you just want to build a human-friendly string, I believe <code>time_ago_in_words</code> is what you are after.</p>\n\n<p><a href=\"https://apidock.com/rails/ActionView/Helpers/DateHelper/time_ago_in_words\" rel=\"nofollow noreferrer\">https://apidock.com/rails/ActionView/Helpers/DateHelper/time_ago_in_words</a></p>\n\n<p>Otherwise, I would resort to something like the following:</p>\n\n<pre><code>(Time.new - user.created_at) / 1.week\n</code></pre>\n\n<p>If you want a more elegant solution, <a href=\"https://stackoverflow.com/questions/2852605/subtract-dates-in-ruby-and-get-the-difference-in-minutes\">Subtract dates in Ruby and get the difference in minutes</a> mentions <a href=\"https://rubygems.org/gems/time_difference\" rel=\"nofollow noreferrer\">the Time Difference gem for Ruby</a>.</p>\n\n<p>e.g.</p>\n\n<pre><code>TimeDifference.between(user.created_at.to_time, Time.now).in_weeks\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1505885293, "post_id": 46313108, "comment_id": 79589360, "body": "Rails has a method 1.week you can use instead of the &#39;magic&#39; number: <code>1.week == 604800</code>"}], "tags": [], "owner": {"reputation": 384, "user_id": 4753286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lOZjyFpingw/AAAAAAAAAAI/AAAAAAAAABE/iGhrsGFbKgw/photo.jpg?sz=128", "display_name": "Oscar Luza", "link": "https://stackoverflow.com/users/4753286/oscar-luza"}, "is_accepted": false, "score": 1, "last_activity_date": 1505880352, "creation_date": 1505880352, "answer_id": 46313108, "question_id": 46312542, "link": "https://stackoverflow.com/questions/46312542/given-a-timestamp-how-to-determine-how-many-weeks-ago/46313108#46313108", "title": "Given a timestamp, how to determine how many weeks ago?", "body": "<p>I would use:</p>\n\n<pre><code>Time.current\n =&gt; Wed, 20 Sep 2017 03:56:15 UTC +00:00 \n</code></pre>\n\n<p>Then</p>\n\n<pre><code>((Time.current - person.created_at)/604800).to_i\n</code></pre>\n\n<p>the subtraction gives you the number of seconds then divide it by <code>604800</code> which is the number of seconds in a week.</p>\n"}], "owner": {"reputation": 97172, "user_id": 149080, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/685eca46bfebf9233cc276b415a74ddb?s=128&d=identicon&r=PG", "display_name": "AnApprentice", "link": "https://stackoverflow.com/users/149080/anapprentice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 46312767, "answer_count": 2, "score": 1, "last_activity_date": 1555936213, "creation_date": 1505876417, "last_edit_date": 1555936213, "question_id": 46312542, "link": "https://stackoverflow.com/questions/46312542/given-a-timestamp-how-to-determine-how-many-weeks-ago", "title": "Given a timestamp, how to determine how many weeks ago?", "body": "<p>I'm looking to return the number of weeks since a user was created in my app..</p>\n\n<p>My model is User.rb (id, created_at)</p>\n\n<p>Given <code>user.created_at</code>:</p>\n\n<pre><code>2.4.0 :008 &gt; user.created_at\n =&gt; Mon, 14 Aug 2017 15:51:23 UTC +00:00 \n</code></pre>\n\n<p>How can I do something like: <code>user.created_at.weeks_ago</code> where it returns some integer which represents the number of weeks since the user was created?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "routes"], "comments": [{"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1505876379, "post_id": 46312389, "comment_id": 79586941, "body": "duplicate of <a href=\"https://stackoverflow.com/questions/6557311/no-route-matches-users-sign-out-devise-rails-3#6557627\" title=\"no route matches users sign out devise rails 3%236557627\">stackoverflow.com/questions/6557311/&hellip;</a>"}, {"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1505876412, "post_id": 46312389, "comment_id": 79586948, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6557311/no-route-matches-users-sign-out-devise-rails-3\">No route matches &quot;/users/sign_out&quot; devise rails 3</a>"}, {"owner": {"reputation": 41, "user_id": 8637931, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DW_K9fTAzx8/AAAAAAAAAAI/AAAAAAAAFmw/BNpXBl2dt2Q/photo.jpg?sz=128", "display_name": "James Chou", "link": "https://stackoverflow.com/users/8637931/james-chou"}, "reply_to_user": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1505965298, "post_id": 46312389, "comment_id": 79630386, "body": "Tried both of those and no dice. I have &#39;    &lt;%= javascript_include_tag &#39;application&#39;, &#39;data-turbolinks-track&#39;: &#39;reload&#39; %&gt;&#39; in my application.html.erb and changing it to     &lt;%= javascript_include_tag :default %&gt; errors out as well."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8637931, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DW_K9fTAzx8/AAAAAAAAAAI/AAAAAAAAFmw/BNpXBl2dt2Q/photo.jpg?sz=128", "display_name": "James Chou", "link": "https://stackoverflow.com/users/8637931/james-chou"}, "edited": false, "score": 0, "creation_date": 1505965333, "post_id": 46312425, "comment_id": 79630394, "body": "That change still gives me the same error &quot;No route matches [GET] &quot;/users/sign_out&quot;&quot;"}], "tags": [], "owner": {"reputation": 560, "user_id": 7721999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bRWQu.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7721999/andy"}, "is_accepted": false, "score": 1, "last_activity_date": 1505875583, "creation_date": 1505875583, "answer_id": 46312425, "question_id": 46312389, "link": "https://stackoverflow.com/questions/46312389/no-route-matches-for-devise-sessions-destroy-path/46312425#46312425", "title": "No route matches for devise sessions destroy path", "body": "<p>I believe <code>&lt;%= link_to 'Logout', destroy_user_session_path, method: :delete %&gt;</code> is what you're looking for</p>\n"}], "owner": {"reputation": 41, "user_id": 8637931, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DW_K9fTAzx8/AAAAAAAAAAI/AAAAAAAAFmw/BNpXBl2dt2Q/photo.jpg?sz=128", "display_name": "James Chou", "link": "https://stackoverflow.com/users/8637931/james-chou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505875583, "creation_date": 1505875249, "question_id": 46312389, "link": "https://stackoverflow.com/questions/46312389/no-route-matches-for-devise-sessions-destroy-path", "title": "No route matches for devise sessions destroy path", "body": "<p>I have installed devise to my rails app and was originally able to sign out using <code>&lt;%= link_to('Logout', destroy_user_session_path) %&gt;</code></p>\n\n<p>However, somewhere along the line after adding more code and a few gems (paperclip, act_as_votable, social_share_button) I was not able to use the same link. When I click the link_to I receive the error </p>\n\n<p><strong>No route matches [GET] \"/users/sign_out\"</strong></p>\n\n<p>I have also tried adding   <code>config.sign_out_via = :get</code> to my devise.rb file but still got the same error. What have I done wrong?</p>\n\n<p>routes.rb</p>\n\n<pre><code>    Rails.application.routes.draw do\n\n  devise_for :users, controllers: { registrations: 'users/registrations', sessions: 'users/sessions' }\n\n\n  root to:'ideas#index'\n\n  get  \"/page\", to: 'pages#index'\n\n  resources :ideas, only: [:index, :show, :create, :destroy, :new] do\n    member do\n      put \"like\", to: \"ideas#upvote\"\n      put \"dislike\", to: \"ideas#downvote\"\n    end\n  end\n\n  resources :comments, only: [:create]\nend\n</code></pre>\n\n<p>sessions controller</p>\n\n<pre><code>    class Users::SessionsController &lt; Devise::SessionsController\n\n  def new\n    super\n  end\n\n\n  def create\n    super\n  end\n\n\n  def destroy\n    super\n  end\n\n\n\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1505874499, "post_id": 46312285, "comment_id": 79586559, "body": "Can you think of a way to make an array with <code>true</code> where the strings\u2019 characters are equal and <code>false</code> where they aren\u2019t, like <code>[true, true, false]</code> for <code>&#39;zzz&#39;</code> and <code>&#39;zza&#39;</code>?"}, {"owner": {"reputation": 7036, "user_id": 1740079, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Xp2ab.png?s=128&g=1", "display_name": "nicooga", "link": "https://stackoverflow.com/users/1740079/nicooga"}, "edited": false, "score": 0, "creation_date": 1505875271, "post_id": 46312285, "comment_id": 79586716, "body": "The first guard is easy <code>return false unless str1.size == str2.size</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": true, "score": 2, "last_activity_date": 1505876190, "creation_date": 1505876190, "answer_id": 46312514, "question_id": 46312285, "link": "https://stackoverflow.com/questions/46312285/how-do-i-write-a-string-equals-function-that-allows-for-at-most-one-letter-of-no/46312514#46312514", "title": "How do I write a string equals function that allows for at most one letter of not being equal?", "body": "<p>This should work for your given cases:</p>\n\n<pre><code>def str_equal(a, b)\n  a == b || (a.size == b.size &amp;&amp; a.chars.map.with_index{|c, i| c == b[i]}.count(false) == 1)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1505886878, "post_id": 46312518, "comment_id": 79590031, "body": "You can improve that a bit by doing <code>matches = str1.chars.zip(str2.chars).count{ |(x, y)| x == y }</code> (no need for map, then count - just count it immediatelly)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1505913252, "post_id": 46312518, "comment_id": 79606803, "body": "That&#39;s alot of intermediary <code>Array</code>s"}], "tags": [], "owner": {"reputation": 1171, "user_id": 86185, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d8ab8c7b30515df850171d8e9c7c4c4e?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/86185/zack"}, "is_accepted": false, "score": 1, "last_activity_date": 1505911702, "last_edit_date": 1505911702, "creation_date": 1505876213, "answer_id": 46312518, "question_id": 46312285, "link": "https://stackoverflow.com/questions/46312285/how-do-i-write-a-string-equals-function-that-allows-for-at-most-one-letter-of-no/46312518#46312518", "title": "How do I write a string equals function that allows for at most one letter of not being equal?", "body": "<p>Using Ryan's and nicooga's comments, plus the necessary missing parts:</p>\n\n<p><strong>Updated</strong> using meta\u2019s advice</p>\n\n<pre><code>def close_enough(str1, str2)\n    return false unless str1.size == str2.size\n\n    mismatches = str1\n        .chars\n        .zip(str2.chars)\n        .count{ |(x, y)| x != y }\n\n    (mismatches &lt;= 1)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505915624, "post_id": 46314033, "comment_id": 79608671, "body": "I like the short circuit although it might read better as <code>str1 == str2 || str1.size.times.one? {|i| str1[i] != str2[i]}</code> and it cuts the footprint down to 2 lines. Additionally you are the only person that did not create unnecessary intermediary <code>Arrays</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505922085, "post_id": 46314033, "comment_id": 79613548, "body": "@engineersmnky, that does read well but of course does not short-circuit."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505922251, "post_id": 46314033, "comment_id": 79613654, "body": "it does short circuit just like <code>all?</code> and <code>any?</code> and <code>none?</code> <a href=\"https://repl.it/LWxC\" rel=\"nofollow noreferrer\">repl.it/LWxC</a> that&#39;s why it is perfect for this solution :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505929014, "post_id": 46314033, "comment_id": 79617879, "body": "@engineersmnky, you are right, of course.  That&#39;s an improvement, so I edited. Thanks."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1505928943, "last_edit_date": 1505928943, "creation_date": 1505885846, "answer_id": 46314033, "question_id": 46312285, "link": "https://stackoverflow.com/questions/46312285/how-do-i-write-a-string-equals-function-that-allows-for-at-most-one-letter-of-no/46314033#46314033", "title": "How do I write a string equals function that allows for at most one letter of not being equal?", "body": "<p>When the two strings differ in size or differ by more than one character, the method below returns <code>false</code>. I designed the method to short-circuit the calculations as soon as it is determined that <code>false</code> is to be returned, but still have an efficient determination of a <code>true</code> return value.</p>\n\n<pre><code>def at_most_one_character_different?(str1, str2)\n  str1.size == str2.size &amp;&amp;\n    (str1 == str2 || str1.size.times.one? { |i| str1[i] != str2[i] })\nend\n\nat_most_one_character_different? \"\", \"\"               #=&gt; true\nat_most_one_character_different? \"humpty\", \"humpty\"   #=&gt; true\nat_most_one_character_different? \"humpty\", \"dumpty\"   #=&gt; true\nat_most_one_character_different? \"humpty\", \"dumbty\"   #=&gt; false\nat_most_one_character_different? \"humpty\", \"humptye\"  #=&gt; false\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 0, "last_activity_date": 1505907713, "creation_date": 1505907713, "answer_id": 46321108, "question_id": 46312285, "link": "https://stackoverflow.com/questions/46312285/how-do-i-write-a-string-equals-function-that-allows-for-at-most-one-letter-of-no/46321108#46321108", "title": "How do I write a string equals function that allows for at most one letter of not being equal?", "body": "<p>You can pass difference count as parameter:</p>\n\n<pre><code>def str_compare_by_diff_count(a, b, diff_count)\n  (a.size == b.size) &amp;&amp; a.chars.select.with_index { |v, i| v != b[i] }.count &lt;= diff_count\nend\n\nstr_compare_by_diff_count(\"wonder\", \"wander\", 1)   #=&gt; true\nstr_compare_by_diff_count(\"wonder\", \"wandor\", 1)   #=&gt; false\nstr_compare_by_diff_count(\"wonder\", \"wandor\", 2)   #=&gt; true\nstr_compare_by_diff_count(\"wonder\", \"wanbor\", 2)   #=&gt; false\nstr_compare_by_diff_count(\"wonder\", \"wanderr\", 1)  #=&gt; false\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1505916415, "creation_date": 1505916415, "answer_id": 46324301, "question_id": 46312285, "link": "https://stackoverflow.com/questions/46312285/how-do-i-write-a-string-equals-function-that-allows-for-at-most-one-letter-of-no/46324301#46324301", "title": "How do I write a string equals function that allows for at most one letter of not being equal?", "body": "<p>If you are certain that there are no unicode or other multi-byte charactes you can get a small performance boost by comparing bytes instead of the actual characters. (Just because all the other quality answers were taken)</p>\n\n<pre><code> def at_most_one_byte_diff?(str1, str2)\n   return false if str1.size != str2.size\n   str1 == str2 || str1.each_byte.with_index.one? { |b,i| b != str2.getbyte(i) }\n end \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 46312514, "answer_count": 5, "score": 0, "last_activity_date": 1505928943, "creation_date": 1505874386, "last_edit_date": 1505893112, "question_id": 46312285, "link": "https://stackoverflow.com/questions/46312285/how-do-i-write-a-string-equals-function-that-allows-for-at-most-one-letter-of-no", "title": "How do I write a string equals function that allows for at most one letter of not being equal?", "body": "<p>I'm using Ruby 2.4.  I want to write a function that will compare strings and declare them \"equal\" if all characters match or if both strings have the same number of characters and all characters except one match.  So for example, by that logic, these strings would match</p>\n\n<pre><code>wonder\nwander\n</code></pre>\n\n<p>Above the only difference is the \"o\" and the \"a\".  These would also match</p>\n\n<pre><code>zzz\nzza\n</code></pre>\n\n<p>But these would not match</p>\n\n<pre><code>abcdef\nabcdef1\n</code></pre>\n\n<p>because the above do not have the same amount of characters.  How do I write such a function?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1505910518, "post_id": 46312246, "comment_id": 79604861, "body": "In the dropdown, how do you diferentiate beween products and vendors, etc?"}, {"owner": {"reputation": 107, "user_id": 2789880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f344596c6b586e6abd62c003856eaebe?s=128&d=identicon&r=PG&f=1", "display_name": "user2789880", "link": "https://stackoverflow.com/users/2789880/user2789880"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1505911185, "post_id": 46312246, "comment_id": 79605352, "body": "I can access the value the value selected by the user using the params object at runtime(params[:dropdown_selections]). Also, products and vendors are models. Not sure if that was what you were asking."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1505911524, "post_id": 46312246, "comment_id": 79605582, "body": "I meant if the value selected comes from a dropdown and you want to redirect to different path you need check which path corresponds to the selected value."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2789880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f344596c6b586e6abd62c003856eaebe?s=128&d=identicon&r=PG&f=1", "display_name": "user2789880", "link": "https://stackoverflow.com/users/2789880/user2789880"}, "edited": false, "score": 0, "creation_date": 1505929027, "post_id": 46322462, "comment_id": 79617887, "body": "I&#39;ll try to use your suggestion since its purely rails solution, I&#39;ll try to see if I can get it to work and will mark it as the answer after confirming it since it doesn&#39;t involve any js code. Thanks for you help!"}, {"owner": {"reputation": 107, "user_id": 2789880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f344596c6b586e6abd62c003856eaebe?s=128&d=identicon&r=PG&f=1", "display_name": "user2789880", "link": "https://stackoverflow.com/users/2789880/user2789880"}, "edited": false, "score": 0, "creation_date": 1505952388, "post_id": 46322462, "comment_id": 79627637, "body": "hey @Sebasti&#225;n Palma, I tried to implement as you suggested but i&#39;m not having any success. This is my routes file:                                                    get   &#39;/result/all&#39;,            to: &#39;static_pages#all_result_page&#39;   get   &#39;/result/products&#39;,       to: &#39;products#index&#39;   get   &#39;/result/manufacturers&#39;,  to: &#39;manufacturers#index&#39;   get   &#39;/result/vendors&#39;,        to: &#39;vendors#index&#39;                                                            added the search function but the page is not redirecting properly."}, {"owner": {"reputation": 107, "user_id": 2789880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f344596c6b586e6abd62c003856eaebe?s=128&d=identicon&r=PG&f=1", "display_name": "user2789880", "link": "https://stackoverflow.com/users/2789880/user2789880"}, "edited": false, "score": 0, "creation_date": 1505972327, "post_id": 46322462, "comment_id": 79632186, "body": "your answer was spot on for my question with only a slight change to the form. I was using a form_tag with only one path(&lt;%= form_tag products_path, :method =&gt; &#39;get&#39;, id: &quot;search-form&quot; do %&gt;). Instead, I needed to use the url_for method to specify the controller and action for the form to use and in that controller(&lt;%= form_tag url_for(:controller =&gt; &#39;search&#39;, :action =&gt; &#39;primary_search&#39;), :method =&gt; &#39;get&#39;, id: &quot;search-form&quot; do %&gt;). After that I was able to render pages based on the user&#39;s dropdown selection in my primary_search action in my search controller."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 107, "user_id": 2789880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f344596c6b586e6abd62c003856eaebe?s=128&d=identicon&r=PG&f=1", "display_name": "user2789880", "link": "https://stackoverflow.com/users/2789880/user2789880"}, "edited": false, "score": 0, "creation_date": 1505978967, "post_id": 46322462, "comment_id": 79635510, "body": "That&#39;s great, I tried to use the same names as in the routes, in order then just to use then as a symbol to create the route. Glad it worked."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1505915813, "last_edit_date": 1505915813, "creation_date": 1505911445, "answer_id": 46322462, "question_id": 46312246, "link": "https://stackoverflow.com/questions/46312246/rails-5-how-to-set-multiple-paths-for-a-search-bar/46322462#46322462", "title": "Rails 5 - How to set multiple paths for a search bar", "body": "<p>I think you can do it just checking some params that you can send depending on the user selection, this way you don't have to add multiples routes, but, check in the controller the params and redirect depending on this value.</p>\n\n<p>Maybe something like:</p>\n\n<pre><code>&lt;%= form_tag search_path, method: 'get', id: 'search-form' do %&gt;\n  ...\n</code></pre>\n\n<p>If the user selects some value you can identify as vendor, then you redirect to vendor, products, etc:</p>\n\n<pre><code>def search\n  #\u00a0vendor redirection\n  if params[:dropdown_selections] == ...\n    redirect_to vendors_path\n  else\n    redirect_to another_path\n  ...\n</code></pre>\n\n<hr>\n\n<p>With your answer I've came to a possible solution.</p>\n\n<p>The form points to the created GET path, this is</p>\n\n<pre><code>get 'search', to: 'home#search'\n</code></pre>\n\n<p>Plus all the other routes where to redirect.</p>\n\n<pre><code>&lt;%= form_tag 'search', method: :get do %&gt;\n  &lt;%= select_tag :dropdown_selection, options_for_select(['products', 'vendors', 'manufacturers', 'others']) %&gt;\n  &lt;%= submit_tag 'Send' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In the options for select there are all the possible values the user can select, this will be the way to create the route where to redirect in the controller:</p>\n\n<pre><code>def search\n  options           = ['products', 'vendors', 'manufacturers']\n  selection         = params[:dropdown_selection]\n  known_path        = options.any?(&amp;selection.method(:==))\n  route_to_redirect = known_path ? selection.to_sym : root_path\n  redirect_to route_to_redirect\nend\n</code></pre>\n\n<ul>\n<li><code>options</code> are the same used in the select tag.</li>\n<li><code>selection</code> stores the value selected by the user.</li>\n<li><code>known_path</code> checks if the value selected is any in the options array.</li>\n<li><code>route</code> checks if the known_path variable is true, if so, then transforms the value selected to its representation as a symbol to use it as the route. If is isn't, then redirect to the root_path.</li>\n<li><code>redirect_to</code> uses the created route to redirect.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1505915842, "post_id": 46323482, "comment_id": 79608830, "body": "I&#39;ve updated the answer with a possible Rails solution."}], "tags": [], "owner": {"reputation": 107, "user_id": 2789880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f344596c6b586e6abd62c003856eaebe?s=128&d=identicon&r=PG&f=1", "display_name": "user2789880", "link": "https://stackoverflow.com/users/2789880/user2789880"}, "is_accepted": false, "score": 1, "last_activity_date": 1505973066, "last_edit_date": 1505973066, "creation_date": 1505914259, "answer_id": 46323482, "question_id": 46312246, "link": "https://stackoverflow.com/questions/46312246/rails-5-how-to-set-multiple-paths-for-a-search-bar/46323482#46323482", "title": "Rails 5 - How to set multiple paths for a search bar", "body": "<p>Thanks Sebasti\u00e0n, I'm new to rails and I was stuck on this problem for a while so I decided to solve it to with jquery. To help someone in the future, here's the steps I used.</p>\n\n<p>Step 1: define all paths I want to redirect from the dropdown in my routes file.\nStep 2: implement the functionality via jquery.</p>\n\n<pre><code>var searched_text;\n  var main_search_selections;\n\n  // 1 - get selection values on change first\n  $('select').change(function() {\n    main_search_selections = $(this).val().toLowerCase();\n  });\n\n  // 2 - take user to a page based on their selection\n  $('#home-page-search-button').click(function(){\n    // if the dropdown selection is vendors when searching\n    if(main_search_selections == \"vendors\") {\n      // go to vendors result page\n      window.location.href='/result/vendors';\n    }\n    // if the dropdown selection is products when searching\n    else if (main_search_selections == \"products\") {\n      // go to products result page\n      window.location.href='/result/products';\n    }\n    // if the dropdown selection is manufacturers when searching\n    else if (main_search_selections == \"manufacturers\") {\n      // go to the manufacturers result page\n      window.location.href='/result/manufacturers';\n    }\n    // else if the only selection left would be all\n    else {\n      // go to the all result page\n      window.location.href='/result/all';\n    }\n  });\n</code></pre>\n\n<p><strong>Edit:</strong>\nThe above solution only works for simply redirecting the user to the proper pages. I wasn't able to use the params[:search] in order to perform my search logic. Using @Sebasti\u00e0's answer, I was able to solve my issue.</p>\n\n<p><strong>Step-1: Updated the search Form:</strong> used url_for(:controller => controller_name, :action => action_name)</p>\n\n<pre><code>&lt;%= form_tag url_for(:controller =&gt; 'search', :action =&gt; 'primary_search'), :method =&gt; 'get', id: \"search-form\" do %&gt;\n        &lt;div class=\"ui action input\" id=\"home-page-search-textbox-container\"&gt;\n          &lt;!-- SEARCH TEXTBOX--&gt;\n          &lt;%= text_field_tag(:search, params[:search],\n              placeholder: 'Products, Manufacturers, Vendors...')\n          %&gt;\n          &lt;!-- SEARCH DROPDOWN SELECTION --&gt;\n          &lt;%= select_tag :dropdown_selection,\n              options_for_select(@dropdown_selections),\n              {:class =&gt; \"ui selection dropdown\",}\n          %&gt;\n          &lt;!-- SEARCH BUTTON --&gt;\n          &lt;div id=\"home-page-search-button\"&gt;\n            &lt;%= button_tag(\"Search\", :class =&gt; \"ui button\", :name =&gt; nil) %&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n</code></pre>\n\n<p><strong>Step-2: Created a search controller</strong></p>\n\n<p><strong>Step-3: Created an action to handle all search logic</strong></p>\n\n<pre><code>    def primary_search\n        @dropdown_selections   = ['All', 'Products', 'Manufacturers', 'Vendors']\n        @product_categories    = Product.all.map { |p| p.category }.sort.uniq\n        @product_manufacturers = Manufacturer.all.map {|m| m.name }.uniq\n        @product_vendors       = Vendor.all.map {|v| v.name }.uniq\n\n        if params[:search].present?\n          if params[:dropdown_selection].to_s.downcase == 'all'\n            @products = Product.search_all(params[:search])\n            render \"/static_pages/all_result_page\"\n          elsif params[:dropdown_selection].to_s.downcase == 'products'\n            @products = Product.search_products(params[:search])\n            render \"products_result_page\"\n          elsif params[:dropdown_selection].to_s.downcase == 'manufacturers'\n            @products = Product.search_manufacturers(params[:search])\n            render \"/manufacturers/manufacturers_result_page\"\n          elsif params[:dropdown_selection].to_s.downcase == 'vendors'\n            @products = Product.search_vendors(params[:search])\n            render \"/vendors/vendors_result_page\"\n          end\n        else\n          @products = Product.all\n          render \"/static_pages/all_result_page\"\n        end\n      end\nend\n</code></pre>\n\n<p><strong>Step-4: create a route for the search controller</strong></p>\n\n<pre><code>get   '/search', to: 'search#primary_search'\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2789880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f344596c6b586e6abd62c003856eaebe?s=128&d=identicon&r=PG&f=1", "display_name": "user2789880", "link": "https://stackoverflow.com/users/2789880/user2789880"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 46322462, "answer_count": 2, "score": 1, "last_activity_date": 1505973066, "creation_date": 1505874027, "question_id": 46312246, "link": "https://stackoverflow.com/questions/46312246/rails-5-how-to-set-multiple-paths-for-a-search-bar", "title": "Rails 5 - How to set multiple paths for a search bar", "body": "<p>I'm new to rails and was trying to create a search bar with a simple textfield, dropdown selection, and a search button. This is the view code:</p>\n\n<pre><code>&lt;div&gt;\n  &lt;%= form_tag [products_path,vendors_path...], :method =&gt; 'get', id: \"search-form\" do %&gt;\n    &lt;div class=\"ui action input\" id=\"home-page-search-textbox-container\"&gt;\n      &lt;!-- SEARCH TEXTBOX--&gt;\n      &lt;%= text_field_tag(:search, params[:search],\n          placeholder: 'Products, Manufacturers, Vendors...')\n      %&gt;\n      &lt;!-- SEARCH DROPDOWN SELECTION --&gt;\n      &lt;%= select_tag :dropdown_selection,\n          options_for_select(@dropdown_selections),\n          {:class =&gt; \"ui selection dropdown\",}\n      %&gt;\n      &lt;!-- SEARCH BUTTON --&gt;\n      &lt;div&gt;\n        &lt;%= button_tag(\"Search\", :class =&gt; \"ui button\", :name =&gt; nil) %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>What i'm trying to achieve is that depending on what the user selected in the dropdown, direct the user to that specific page. </p>\n\n<p><strong>Example</strong>: If the user selected products when searching, I want the the user to be directed to the products page. If the user selected vendors when searching, then direct the user to the vendors page and so on. The form_tag accepts a single path and it would work for that view but since multiple views are involved with the search bar, how can I pass the path depending on the user's dropdown selection? any help would be appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 13948, "user_id": 283342, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e3ef6dbec3a443e7cda5b5624311ca08?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/283342/adrian"}, "edited": false, "score": 1, "creation_date": 1505867363, "post_id": 46311387, "comment_id": 79584874, "body": "You should do whatever is most convenient for your application, there isn&#39;t just one answer for this."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1505884802, "post_id": 46311387, "comment_id": 79589182, "body": "If I had to use a fixed category like that, then I would simply create that category if it doesn&#39;t exist at runtime on a particular system with <code>category = Category.where(name: &#39;Transfer&#39;).first_or_create</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "is_accepted": false, "score": 0, "last_activity_date": 1505872836, "last_edit_date": 1505872836, "creation_date": 1505869800, "answer_id": 46311778, "question_id": 46311387, "link": "https://stackoverflow.com/questions/46311387/ruby-when-is-the-time-to-raise-exception/46311778#46311778", "title": "Ruby When is The Time to Raise Exception?", "body": "<p>This is something that can be easily handled with a conditional:</p>\n\n<pre><code>if Category.exists?(name: 'Transfer')\n  ##process category\nelse\n  ##handle error\nend\n</code></pre>\n\n<p>Your intention is also clear here. So I won't use exception here. </p>\n\n<p>But one place where you do want to raise exceptions is inside your transaction, because transactions rely on exceptions to trigger roll back. So, for example, you don't want to use <code>#save</code>. Instead, use <code>#save!</code>, which raises exceptions when fails. And you'll want to catch these exceptions because they'll bubble up:</p>\n\n<pre><code>begin\n  Account.transaction do\n    debit = Debit.new(amount: amount, account: self, category: category)                                                                                   \n    debit.save!                                                                                                                                        \n\n    credit = Credit.new(amount: amount, account: account, category: category)                                                                              \n    credit.save!                                                                                                                                      \n  end \nrescue StandardError, ActiveRecord::RecordInvalid, ActiveRecord::RecordNotSaved =&gt; e\n  ##send error to my email\nend\n</code></pre>\n\n<p>And if this is an action that's exposed to users, you'll also want to handle the exceptions so users are shown a proper page and gets the correct error messages.</p>\n"}, {"comments": [{"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1505882078, "post_id": 46311931, "comment_id": 79588311, "body": "I think the choice should not be decided by how severe the error is, but rather which best suits the purpose. In this case there&#39;s probably not much difference either way. Important thing is the error is caught and properly handled."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1505906714, "post_id": 46311931, "comment_id": 79602215, "body": "@EJ2015 - &quot;Important thing is the error is caught and properly handled&quot;, I totally agree. I believe the question of Exception throwing is exactly that. Is an Exception the &quot;proper&quot; way to handle the error? I don&#39;t really factor in the fact that an error code or error response could be used instead of an Exception. However, when the application&#39;s reasonable expectations are ignored (i.e., a missing method, a missing database table, a core missing core data structure), an Exception might be the suitable way to handle the error."}], "tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 1, "last_activity_date": 1505871084, "creation_date": 1505871084, "answer_id": 46311931, "question_id": 46311387, "link": "https://stackoverflow.com/questions/46311387/ruby-when-is-the-time-to-raise-exception/46311931#46311931", "title": "Ruby When is The Time to Raise Exception?", "body": "<p>I would offer a counter opinion to the one offered by EJ2105.</p>\n\n<p>In this specific situation (and I'm offering opinion more than any sound advice), I would choose to raise an exception (and maybe kill the program and report a critical error).</p>\n\n<p>The category <code>\"Transfer\"</code> is hard coded in your application. The fact that it can't be found is a serious error that probably reflects a database critical failure, such as a missing migration or a seeding error.</p>\n\n<p>As for handling any <code>#save</code> errors, I would probably inform the user that the transaction didn't go through. This seems to be an possible and expected (if not happy) outcome.</p>\n"}], "owner": {"reputation": 1058, "user_id": 1224718, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d6b40ad0c1934651afa0d293ec822d22?s=128&d=identicon&r=PG", "display_name": "Agung Setiawan", "link": "https://stackoverflow.com/users/1224718/agung-setiawan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505872836, "creation_date": 1505866048, "question_id": 46311387, "link": "https://stackoverflow.com/questions/46311387/ruby-when-is-the-time-to-raise-exception", "title": "Ruby When is The Time to Raise Exception?", "body": "<p>If <code>category</code> is not found, should I return <code>false</code> and so return <code>true</code> when the transfer done. Or should I raise exception instead?</p>\n\n<p>I'm still not clear when to raise exception. </p>\n\n<pre><code>    def transfer(amount, account)\n      category = Category.find_by(name: 'Transfer')\n\n      Account.transaction do\n        debit = Debit.new(amount: amount, account: self, category: category)                                                                                   \n        debit.save                                                                                                                                        \n\n        credit = Credit.new(amount: amount, account: account, category: category)                                                                              \n        credit.save                                                                                                                                       \n      end                                                                                                                                                 \n    end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "edited": false, "score": 1, "creation_date": 1505863725, "post_id": 46311099, "comment_id": 79584041, "body": "@CD-RUM You&#39;re welcome -- I also updated with a comment about <code>use_transactional_examples</code>"}, {"owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "edited": false, "score": 0, "creation_date": 1505863753, "post_id": 46311099, "comment_id": 79584049, "body": "Doubly-helpful. Thanks heaps."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1505863495, "creation_date": 1505863495, "answer_id": 46311099, "question_id": 46310923, "link": "https://stackoverflow.com/questions/46310923/rails-5-1-rspec-cant-see-capybara-features/46311099#46311099", "title": "Rails 5.1: Rspec can&#39;t see Capybara features", "body": "<p>Your files need to end in <code>_spec.rb</code> in order for RSpec to load them when specifying a directory.  So rename to <code>specs/features/canvas_integration_spec.rb</code></p>\n\n<p>Also note that in Rails 5.1 database cleaner is probably not necessary (if you're using one of the usual databases) - so you should be able to remove/comment out that and re-enable transactional testing.  Additionally <code>use_transactional_examples</code> is an alias of <code>use_transactional_fixtures</code> so specifying both doesn't make sense.</p>\n"}, {"comments": [{"owner": {"reputation": 591, "user_id": 8502555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gysjl.jpg?s=128&g=1", "display_name": "e_a_o", "link": "https://stackoverflow.com/users/8502555/e-a-o"}, "edited": false, "score": 0, "creation_date": 1505863896, "post_id": 46311135, "comment_id": 79584087, "body": "Oh, posted and just refreshed to notice that you got an answer already :)"}], "tags": [], "owner": {"reputation": 591, "user_id": 8502555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gysjl.jpg?s=128&g=1", "display_name": "e_a_o", "link": "https://stackoverflow.com/users/8502555/e-a-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1505863751, "creation_date": 1505863751, "answer_id": 46311135, "question_id": 46310923, "link": "https://stackoverflow.com/questions/46310923/rails-5-1-rspec-cant-see-capybara-features/46311135#46311135", "title": "Rails 5.1: Rspec can&#39;t see Capybara features", "body": "<p>I think your test spec filename should be <code>specs/features/canvas_integration_spec.rb</code> instead of <code>specs/features/canvas_integration.rb</code></p>\n\nWhy?\n\n<p>The files read by the <a href=\"https://github.com/rspec/rspec-rails\" rel=\"nofollow noreferrer\"><code>rspec-rails</code></a> gem are those that end in <code>_spec.rb</code></p>\n"}], "owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 46311099, "answer_count": 2, "score": 0, "last_activity_date": 1505863751, "creation_date": 1505862218, "question_id": 46310923, "link": "https://stackoverflow.com/questions/46310923/rails-5-1-rspec-cant-see-capybara-features", "title": "Rails 5.1: Rspec can&#39;t see Capybara features", "body": "<p>I have some feature specs in my project that look roughly like this:</p>\n\n<pre><code># specs/features/canvas_integration.rb\nrequire 'spec_helper'\n\nfeature 'Routes to default page' do\n  let!(:mode) { create(:mode) }\n\n  scenario 'as anyone' do\n    visit root_path\n    expect(page).to have_content('Your home')\n  end\nend\n</code></pre>\n\n<p>But running the specs results in nothing:</p>\n\n<pre><code>rspec spec/features\nNo examples found.\n</code></pre>\n\n<p>My <code>spec_helper.rb</code> looks like this:</p>\n\n<pre><code># frozen_string_literal: true\n\nrequire 'simplecov'\nSimpleCov.start 'rails'\nrequire File.expand_path('../../config/environment', __FILE__)\nrequire 'codeclimate-test-reporter'\nrequire 'rspec/rails'\nrequire 'webmock/rspec'\nrequire 'devise'\nrequire 'codeship'\nrequire 'capybara/rspec'\nrequire 'capybara/rails'\n\nWebMock.disable_net_connect!(allow_localhost: true)\nDir[Rails.root.join('spec/support/**/*.rb')].each { |f| require f }\n\nRSpec.configure do |config|\n  config.include Devise::Test::ControllerHelpers, type: :controller\n  config.include Devise::Test::ControllerHelpers, type: :view\n  config.include FactoryGirl::Syntax::Methods\n  config.extend ControllerMacros, type: :controller\n  config.include Macros\n\n  config.color = true\n  config.fixture_path = \"#{::Rails.root}/spec/factories/fixtures\"\n  config.infer_spec_type_from_file_location!\n  config.infer_base_class_for_anonymous_controllers = false\n  config.order = 'random'\n  config.warnings = false\n  config.default_formatter = 'doc' if config.files_to_run.one?\n  config.profile_examples = 10\n  config.use_transactional_examples = false\n  config.use_transactional_fixtures = false\n\n  config.before(:suite) do\n    DatabaseCleaner.strategy = :transaction\n    DatabaseCleaner.clean_with(:truncation)\n  end\n\n  # config.before(:each, type: :system) { driven_by :rack_test }\n\n  config.mock_with :rspec do |mocks|\n    mocks.verify_doubled_constant_names = true\n  end\n\n  config.expect_with :rspec do |c|\n    c.syntax = :expect\n  end\nend\n</code></pre>\n\n<p>Why can't Rspec find my features?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ubuntu"], "comments": [{"owner": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "edited": false, "score": 0, "creation_date": 1505860981, "post_id": 46310613, "comment_id": 79583315, "body": "Somebody helps please. It&#39;s very urgent!"}, {"owner": {"reputation": 343, "user_id": 3840725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5un6e.jpg?s=128&g=1", "display_name": "jpheos", "link": "https://stackoverflow.com/users/3840725/jpheos"}, "edited": false, "score": 1, "creation_date": 1505861199, "post_id": 46310613, "comment_id": 79583369, "body": "did you try <code>gem install rails</code> without <code>sudo</code>?"}, {"owner": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "reply_to_user": {"reputation": 343, "user_id": 3840725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5un6e.jpg?s=128&g=1", "display_name": "jpheos", "link": "https://stackoverflow.com/users/3840725/jpheos"}, "edited": false, "score": 0, "creation_date": 1505861471, "post_id": 46310613, "comment_id": 79583449, "body": "@djothefou I tried and I got a &quot;You don&#39;t have write permissions for the /var/lib/gems/2.3.0 directory.&quot;"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1505861479, "post_id": 46310613, "comment_id": 79583452, "body": "DONT use sudo !! You need to restart your terminal, close it and open it again"}, {"owner": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1505861523, "post_id": 46310613, "comment_id": 79583466, "body": "@MrYoshiji It said I do not have write permissions without sudo"}, {"owner": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1505861697, "post_id": 46310613, "comment_id": 79583521, "body": "@MrYoshiji I did what you said but it&#39;s still the same"}, {"owner": {"reputation": 384, "user_id": 4753286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lOZjyFpingw/AAAAAAAAAAI/AAAAAAAAABE/iGhrsGFbKgw/photo.jpg?sz=128", "display_name": "Oscar Luza", "link": "https://stackoverflow.com/users/4753286/oscar-luza"}, "edited": false, "score": 0, "creation_date": 1505864175, "post_id": 46310613, "comment_id": 79584151, "body": "<a href=\"https://stackoverflow.com/questions/37720892/you-dont-have-write-permissions-for-the-var-lib-gems-2-3-0-directory\" title=\"you dont have write permissions for the var lib gems 2 3 0 directory\">stackoverflow.com/questions/37720892/&hellip;</a> , instead of rbenv try to remove and install again according of rvm docs"}], "answers": [{"comments": [{"owner": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "edited": false, "score": 0, "creation_date": 1505862326, "post_id": 46310902, "comment_id": 79583696, "body": "Actually I had this line in my .bash_profile. I tried rvm repair all and restarted my terminal, but it does not work."}, {"owner": {"reputation": 589, "user_id": 678908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bede8bef4ece35ac047c3501b396829?s=128&d=identicon&r=PG", "display_name": "Alexander Zinchenko", "link": "https://stackoverflow.com/users/678908/alexander-zinchenko"}, "reply_to_user": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "edited": false, "score": 0, "creation_date": 1505862453, "post_id": 46310902, "comment_id": 79583725, "body": "@XINDILI Did you run <code>rvm use &lt;installed_ruby_version&gt; --default</code> before installing rails gem? What is your output of <code>which gem</code> command in terminal?"}, {"owner": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "edited": false, "score": 0, "creation_date": 1505864519, "post_id": 46310902, "comment_id": 79584227, "body": "I reinstalled everything and runned rvm use &lt;installed_ruby_version&gt; --default. Now it works. Thank you so much"}, {"owner": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "edited": false, "score": 0, "creation_date": 1505865783, "post_id": 46310902, "comment_id": 79584515, "body": "But I run bash --login in order to run rvm use. So now every time I open the console, I have to run bash --login. And then I can use rails. That&#39;s a problem"}, {"owner": {"reputation": 589, "user_id": 678908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bede8bef4ece35ac047c3501b396829?s=128&d=identicon&r=PG", "display_name": "Alexander Zinchenko", "link": "https://stackoverflow.com/users/678908/alexander-zinchenko"}, "reply_to_user": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "edited": false, "score": 0, "creation_date": 1505887857, "post_id": 46310902, "comment_id": 79590453, "body": "@XINDILI Well, you need to use &quot;--login&quot; option to run shell interactively. Try to add <code>[[ -s &quot;$HOME&#47;.rvm&#47;scripts&#47;rvm&quot; ]] &amp;&amp; source &quot;$HOME&#47;.rvm&#47;scripts&#47;rvm&quot;</code> to .bashrc or .profile instead of .bash_profile."}, {"owner": {"reputation": 589, "user_id": 678908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bede8bef4ece35ac047c3501b396829?s=128&d=identicon&r=PG", "display_name": "Alexander Zinchenko", "link": "https://stackoverflow.com/users/678908/alexander-zinchenko"}, "reply_to_user": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "edited": false, "score": 0, "creation_date": 1505889114, "post_id": 46310902, "comment_id": 79591050, "body": "@XINDILI Also look here <a href=\"https://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html#Bash-Startup-Files\" rel=\"nofollow noreferrer\">gnu.org/software/bash/manual/html_node/&hellip;</a>"}], "tags": [], "owner": {"reputation": 589, "user_id": 678908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bede8bef4ece35ac047c3501b396829?s=128&d=identicon&r=PG", "display_name": "Alexander Zinchenko", "link": "https://stackoverflow.com/users/678908/alexander-zinchenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1505862143, "creation_date": 1505862143, "answer_id": 46310902, "question_id": 46310613, "link": "https://stackoverflow.com/questions/46310613/rails-the-program-rails-is-currently-not-installed-on-ubuntu-16-04/46310902#46310902", "title": "Rails: The program &#39;rails&#39; is currently not installed on Ubuntu 16.04", "body": "<p>Probably you forgot to add rvm script to your .bash_profile:</p>\n\n<p><code>[[ -s \"$HOME/.rvm/scripts/rvm\" ]] &amp;&amp; source \"$HOME/.rvm/scripts/rvm\"</code></p>\n\n<p>Try running <code>rvm repair all</code> and then restart your terminal.</p>\n"}, {"tags": [], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1579006723, "creation_date": 1579006723, "answer_id": 59734270, "question_id": 46310613, "link": "https://stackoverflow.com/questions/46310613/rails-the-program-rails-is-currently-not-installed-on-ubuntu-16-04/59734270#59734270", "title": "Rails: The program &#39;rails&#39; is currently not installed on Ubuntu 16.04", "body": "<p>I faced a similar issue for <strong>Rails 5.2</strong> and <strong>Ubuntu 18.04</strong>. I had an already setup server with Ruby and Rails installed, but I couldn't access them.</p>\n\n<p>The error output was:</p>\n\n<blockquote>\n  <p>The program 'rails' is currently not installed. You can install it by typing:\n  sudo apt install ruby-railties</p>\n</blockquote>\n\n<p>The issue is simply caused by the rails executable not being globally accessible by programs.</p>\n\n<p><strong>Here's how I solved it</strong></p>\n\n<p><strong>Note:</strong> If you are working on a production server, endeavour to make a backup of your database before trying out the solution below to avoid data loss.</p>\n\n<p>For my case, my version manager was <strong>rbenv</strong> and not <strong>rvm</strong></p>\n\n<p>Re-install <strong>rbenv</strong> itself. Clone the <strong>rbenv</strong> repository from GitHub into the directory ~/.rbenv:</p>\n\n<p><code>git clone https://github.com/rbenv/rbenv.git ~/.rbenv</code></p>\n\n<p>Next, add <code>~/.rbenv/bin</code> to your <code>$PATH</code> so that you can use the rbenv command line utility. Do this by altering your ~/.bashrc file so that it affects future login sessions:</p>\n\n<p><code>echo 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' &gt;&gt; ~/.bashrc</code></p>\n\n<p>Then add the command eval \"$(rbenv init -)\" to your ~/.bashrc file so rbenv loads automatically:</p>\n\n<p><code>echo 'eval \"$(rbenv init -)\"' &gt;&gt; ~/.bashrc</code></p>\n\n<p>Next, apply the changes you made to your ~/.bashrc file to your current shell session:</p>\n\n<p><code>source ~/.bashrc</code></p>\n\n<p>Verify that <strong>rbenv</strong> is set up properly by using the type command, which will display more information about the <strong>rbenv</strong> command:</p>\n\n<p><code>type rbenv</code></p>\n\n<p>Your terminal window will display the following:</p>\n\n<pre><code>rbenv is a function\nrbenv ()\n{\n    local command;\n    command=\"${1:-}\";\n    if [ \"$#\" -gt 0 ]; then\n        shift;\n    fi;\n    case \"$command\" in\n        rehash | shell)\n            eval \"$(rbenv \"sh-$command\" \"$@\")\"\n        ;;\n        *)\n            command rbenv \"$command\" \"$@\"\n        ;;\n    esac\n}\n</code></pre>\n\n<p>If everything worked right, running the command below will display the versions of <strong>Ruby</strong> and <strong>Rails</strong> previously installed on your machine:</p>\n\n<pre><code>ruby -v\nrails -v\n</code></pre>\n\n<p>Else, run a fresh installation of <strong>Ruby</strong> and <strong>Rails</strong> on your machine.</p>\n\n<p>That's all</p>\n\n<p><strong>I hope this helps</strong></p>\n"}], "owner": {"reputation": 417, "user_id": 7749267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/649a3857c1c8cfb5fae023ef0c1bbabb?s=128&d=identicon&r=PG&f=1", "display_name": "XINDI LI", "link": "https://stackoverflow.com/users/7749267/xindi-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1206, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1580311255, "creation_date": 1505860204, "last_edit_date": 1580311255, "question_id": 46310613, "link": "https://stackoverflow.com/questions/46310613/rails-the-program-rails-is-currently-not-installed-on-ubuntu-16-04", "title": "Rails: The program &#39;rails&#39; is currently not installed on Ubuntu 16.04", "body": "<p>I installed rvm ruby and gem. \nWhen I used gem to install rails, it's like this:</p>\n\n<pre><code>woyuxuxu123@ubuntu:~$ sudo gem install rails\n[sudo] password for woyuxuxu123: \nSuccessfully installed rails-5.1.4\nParsing documentation for rails-5.1.4\nDone installing documentation for rails after 0 seconds\n1 gem installed\n</code></pre>\n\n<p>But when I enter rails -v, I got:</p>\n\n<pre><code>woyuxuxu123@ubuntu:~$ rails -v\nThe program 'rails' is currently not installed. You can install it by typing:\nsudo apt install ruby-railties\n</code></pre>\n\n<p>I tried some solutions, but did not work for me, such as</p>\n\n<pre><code>source ~/.rvm/scripts/rvm\n</code></pre>\n\n<p>Someone mentioned the path. Here is how it looks</p>\n\n<pre><code>RubyGems Environment:\nEXECUTABLE DIRECTORY: /usr/local/bin\n\nwoyuxuxu123@ubuntu:~$ echo $PATH\n/home/woyuxuxu123/bin:/home/woyuxuxu123/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/woyuxuxu123/.rvm/bin:/home/woyuxuxu123/.rvm/bin\n</code></pre>\n\n<p>What should I do?</p>\n"}, {"tags": ["ruby", "rspec", "rubymine"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1505859064, "post_id": 46310375, "comment_id": 79582764, "body": "Given that your folder is called <code>spec</code>, not <code>test</code>, I presume that you need to <code>-Ispec</code>, not <code>-Itest</code>."}, {"owner": {"reputation": 16775, "user_id": 442945, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/TovHM.png?s=128&g=1", "display_name": "Nathaniel Ford", "link": "https://stackoverflow.com/users/442945/nathaniel-ford"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1505860837, "post_id": 46310375, "comment_id": 79583278, "body": "@TomLord That was it! Thank you. I didn&#39;t realize that was the meaning of that flag. If you want to put an answer I&#39;ll accept it."}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 2, "last_activity_date": 1505898173, "creation_date": 1505898173, "answer_id": 46317681, "question_id": 46310375, "link": "https://stackoverflow.com/questions/46310375/rubymine-ide-cannot-find-spec-files-in-spec-directory/46317681#46317681", "title": "RubyMine IDE Cannot Find Spec Files in Spec directory", "body": "<p>Given that your folder is called <code>spec</code>, not <code>test</code>, you need to <code>-Ispec</code>, not <code>-Itest</code>.</p>\n\n<p>In other words, your RubyMine arguments should be:</p>\n\n<pre><code>-e $stdout.sync=true;$stderr.sync=true;load($0=ARGV.shift) -Ispec\n</code></pre>\n\n<p>From the <a href=\"https://linux.die.net/man/1/ruby\" rel=\"nofollow noreferrer\">ruby man page</a>:</p>\n\n<pre><code>-I directory   Used to tell Ruby where to load the library scripts.\n               Directory path will be added to the load-path variable ($:)\n</code></pre>\n"}], "owner": {"reputation": 16775, "user_id": 442945, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/TovHM.png?s=128&g=1", "display_name": "Nathaniel Ford", "link": "https://stackoverflow.com/users/442945/nathaniel-ford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 46317681, "answer_count": 1, "score": 0, "last_activity_date": 1505898173, "creation_date": 1505858630, "question_id": 46310375, "link": "https://stackoverflow.com/questions/46310375/rubymine-ide-cannot-find-spec-files-in-spec-directory", "title": "RubyMine IDE Cannot Find Spec Files in Spec directory", "body": "<p>I have loaded a Ruby project into RubyMine, that has it's spec files located in a <code>spec</code> directory, as usual. Right-clicking and selecting 'run' on any single spec file correctly runs it. Right-clicking and selecting 'run all' on the <code>specs</code> directory causes every test to fail with the following message:</p>\n\n<blockquote>\n  <p>Fail to load: /Users/nathaniel/repos/close-web/spec/compositions/analysis/analysis_data_spec.rb:1\n        Exception message: cannot load such file -- spec_helper</p>\n</blockquote>\n\n<p>Inside the launch configuration, the 'Tests folder' seems to be set correctly:</p>\n\n<pre><code>/Users/nathaniel/repos/close-web/spec\n</code></pre>\n\n<p>And the working directory as well:</p>\n\n<pre><code>/Users/nathaniel/repos/close-web\n</code></pre>\n\n<p>The Ruby arguments are set like this:</p>\n\n<pre><code>-e $stdout.sync=true;$stderr.sync=true;load($0=ARGV.shift) -Itest\n</code></pre>\n\n<p>(There is some indication on the RubyMine website that <code>-Itest</code> is required.) Under the Bundler tab 'Run the script in the context of the bundle' is checked as well. I'm unclear what else RubyMine might need to be able to recursively find and execute the tests. Running them from the command line works fine:</p>\n\n<pre><code>~repos/closeweb $ bundle exec rspec spec\n... (all the tests running)\n\nFinished in 6 minutes 27 seconds (files took 13.39 seconds to load)\n1054 examples, 0 failures, 108 pending\n</code></pre>\n\n<p>What configuration is wrong here that all the tests won't run?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "parameters", "edit"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4536120"}, "edited": false, "score": 0, "creation_date": 1505857204, "post_id": 46310093, "comment_id": 79582173, "body": "Thanks for the quick response. The first suggestion returns the error <code>First argument in form cannot contain nil or be empty</code> and the second returns <code>Couldn&#39;t find Submission without an ID</code>"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1505857391, "post_id": 46310093, "comment_id": 79582241, "body": "Yeah but the first error is another problem and it&#39;s not in the code we see, it should be in a form. And probably even the second one"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4536120"}, "edited": false, "score": 0, "creation_date": 1505857635, "post_id": 46310093, "comment_id": 79582336, "body": "My submissions form starts with <code>&lt;%= form_for([project, submission]) do |f| %&gt;</code> and I call the instance variables on the render <code>&lt;%= render &#39;form&#39;, project: @project, submission: @submission %&gt;</code>"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1505857837, "post_id": 46310093, "comment_id": 79582402, "body": "Shouldn&#39;t be <code>&lt;%= render &#39;form&#39;, locals: {project: @project, submission: @submission} %&gt;</code>?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1505858201, "post_id": 46310093, "comment_id": 79582532, "body": "It was just <code>id</code>. I updated my answer. You should use on of the two lines in the answer anyway."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4536120"}, "edited": false, "score": 0, "creation_date": 1505858343, "post_id": 46310093, "comment_id": 79582570, "body": "Ah that did it, thank you so much!! I also updated the method to your suggestion as well. Thanks!"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1505858375, "post_id": 46310093, "comment_id": 79582580, "body": "My pleasure Sir :)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 0, "last_activity_date": 1505858160, "last_edit_date": 1505858160, "creation_date": 1505856985, "answer_id": 46310093, "question_id": 46309916, "link": "https://stackoverflow.com/questions/46309916/editing-an-item-from-a-list-only-pulls-values-from-first-entry-in-rails/46310093#46310093", "title": "Editing an item from a list only pulls values from first entry in Rails", "body": "<p>The issue is in the <code>set_submission</code> method. It should be</p>\n\n<pre><code>def set_submission\n  @submission = @project.submissions.find_by(id: params[:id])\nend\n</code></pre>\n\n<p>or</p>\n\n<pre><code>def set_submission\n  @submission = @project.submissions.find(params[:id])\nend\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4536120"}, "edited": false, "score": 0, "creation_date": 1505858093, "post_id": 46310256, "comment_id": 79582490, "body": "Ah it&#39;s just ID <code>Parameters: {&quot;project_id&quot;=&gt;&quot;11&quot;, &quot;id&quot;=&gt;&quot;28&quot;}</code>"}], "tags": [], "owner": {"reputation": 462, "user_id": 1861079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bf11889c19e93f8775fa2d9673b910e?s=128&d=identicon&r=PG", "display_name": "Maruf Hasan Bulbul", "link": "https://stackoverflow.com/users/1861079/maruf-hasan-bulbul"}, "is_accepted": false, "score": 2, "last_activity_date": 1505857781, "creation_date": 1505857781, "answer_id": 46310256, "question_id": 46309916, "link": "https://stackoverflow.com/questions/46309916/editing-an-item-from-a-list-only-pulls-values-from-first-entry-in-rails/46310256#46310256", "title": "Editing an item from a list only pulls values from first entry in Rails", "body": "<p>I think the problem in params attributes name. Check the server log when you click the edit button. Is it submission_id or just id?</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4536120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 46310093, "answer_count": 2, "score": 0, "last_activity_date": 1505858160, "creation_date": 1505855987, "last_edit_date": 1505856549, "question_id": 46309916, "link": "https://stackoverflow.com/questions/46309916/editing-an-item-from-a-list-only-pulls-values-from-first-entry-in-rails", "title": "Editing an item from a list only pulls values from first entry in Rails", "body": "<p>I haven't been able to find an answer on SO or through Google searching.</p>\n\n<p>I have a list of submissions being displayed on the index page, made from the user's project show page. Url shows correct ID's and the data being entered is successful.</p>\n\n<p>But, when I click on 'edit' for a particular submission, it jumps to the edit form with the correct url (ID's), but shows the first submission's values that were entered for the project. When you delete a submission it successfully deletes that submission. If you delete the first submission, the next submission's values will show and reflect on all other submissions, when edit is clicked. I'm at a loss here - appreciate the help!</p>\n\n<p>Submission Index page:</p>\n\n<pre><code>&lt;div class=\"row wrapper\"&gt;\n  &lt;h2 class=\"color-blue\"&gt;&lt;%= @project.title %&gt; Submissions&lt;/h2&gt;\n  &lt;% if @project.submissions.present? %&gt;\n    &lt;% @project.submissions.each do |submission| %&gt;\n      &lt;div class=\"submission\"&gt;\n        &lt;ul&gt;\n          &lt;li class=\"title\"&gt;\n            &lt;%= link_to submission.request_title, project_submission_path(@project, submission) %&gt;\n          &lt;/li&gt;\n          &lt;li class=\"actions\"&gt;\n            &lt;span class=\"edit\"&gt;\n              &lt;%= link_to 'edit', edit_project_submission_path(@project, submission), class: 'color-orange' %&gt; |\n            &lt;/span&gt;\n            &lt;span class=\"delete\"&gt;\n              &lt;%= link_to 'delete', project_submission_path(@project, submission), method: :delete, data: { confirm: 'Are you sure?' }, class: 'color-red' %&gt;\n            &lt;/span&gt; |\n            &lt;span class=\"send\"&gt;\n              &lt;%= link_to 'send request', '#', class: 'color-atlantis' %&gt;\n            &lt;/span&gt;\n          &lt;/li&gt;\n            &lt;/li&gt;\n        &lt;/ul&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n  &lt;br&gt;\n  &lt;%= link_to \"Back to #{@project.title} project\", @project, class: 'color-clue' %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Submissions controller:</p>\n\n<pre><code>class SubmissionsController &lt; ApplicationController\n\n  before_action :authenticate_user!\n  before_action :set_project\n  before_action :set_submission, only: [:destroy, :update, :edit, :create, :show]\n\n  def index\n  end\n\n  def show\n  end\n\n  def new\n    @submission = @project.submissions.new\n  end\n\n  def edit\n\n  end\n\n  def create\n    @submission = @project.submissions.new(submission_params)\n    @submission.user = current_user\n\n    if @submission.save\n      redirect_to @project, notice: 'Music submission was successfully sent.'\n    else\n      render :new\n    end\n  end\n\n  def update\n    if @submission.update(submission_params)\n      redirect_to project_submissions_path(@project), notice: 'Music submission was successfully updated.'\n    else\n      render :edit\n    end\n  end\n\n  def destroy\n    @submission.destroy\n    redirect_to project_submissions_path(@project), notice: 'Music submission was successfully deleted.'\n  end\n\n  private\n\n    def set_project\n      @project = current_user.projects.find(params[:project_id])\n    end\n\n    def set_submission\n      @submission = @project.submissions.find_by(params[:submission_id])\n    end\n\n    def submission_params\n      params.require(:submission).permit(:request_title, :request_music, :notes, :terms)\n    end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "testing", "rspec", "minitest"], "answers": [{"tags": [], "owner": {"reputation": 1844, "user_id": 5662805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c45a62036fef674591172e904bad55e9?s=128&d=identicon&r=PG&f=1", "display_name": "wuarmin", "link": "https://stackoverflow.com/users/5662805/wuarmin"}, "is_accepted": true, "score": 0, "last_activity_date": 1515932957, "creation_date": 1515932957, "answer_id": 48249591, "question_id": 46309054, "link": "https://stackoverflow.com/questions/46309054/whats-the-counterpart-of-rspecs-instance-double-in-minitest/48249591#48249591", "title": "What&#39;s the counterpart of RSpecs instance_double in Minitest?", "body": "<p>Minitest is designed intentionally to have very rudimentary implementations of mocks and stubs. Following link could be interesting: <a href=\"https://martinfowler.com/articles/mocksArentStubs.html\" rel=\"nofollow noreferrer\">https://martinfowler.com/articles/mocksArentStubs.html</a>. </p>\n\n<p>So conclusion is that there's no truly counterpart of rspec's instance_double at Minitest. </p>\n\n<p>In the meantime I'm a fan of classical testing. That means: try to avoid mocks as much as possible. But there are cases where mocking is inevitable. If that is the case I would recommend the minitest integration of respec-mocks: <a href=\"https://relishapp.com/rspec/rspec-mocks/docs/outside-rspec/integrate-with-minitest\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-mocks/docs/outside-rspec/integrate-with-minitest</a></p>\n"}], "owner": {"reputation": 1844, "user_id": 5662805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c45a62036fef674591172e904bad55e9?s=128&d=identicon&r=PG&f=1", "display_name": "wuarmin", "link": "https://stackoverflow.com/users/5662805/wuarmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 48249591, "answer_count": 1, "score": 1, "last_activity_date": 1516451295, "creation_date": 1505852100, "last_edit_date": 1516451295, "question_id": 46309054, "link": "https://stackoverflow.com/questions/46309054/whats-the-counterpart-of-rspecs-instance-double-in-minitest", "title": "What&#39;s the counterpart of RSpecs instance_double in Minitest?", "body": "<p>I'm searching for the \"minitest-way\" to double expensive objects in a safe manner.</p>\n\n<p>I know mocks, stubs and use them, but the problem is that simple doubles are not waterproof. If the api of the real objects change, the tests pass, but the real implementation fails. </p>\n\n<p>I found rspec's instance_double-feature. I create my tests with Minitest. Can you point me in the right direction?\nThx</p>\n"}, {"tags": ["python", "ruby", "string", "slice", "reverse"], "comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1505855163, "post_id": 46308479, "comment_id": 79581417, "body": "Ruby strings have a <code>slice</code> <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-slice\" rel=\"nofollow noreferrer\">method</a>, which is aliased as <code>[]</code>.It is used to slice a string in various ways. It can not be used to reverse a string however. To reverse a string use its <code>reverse</code> method"}, {"owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "edited": false, "score": 0, "creation_date": 1505855172, "post_id": 46308479, "comment_id": 79581419, "body": "Doesn&#39;t look like you can reverse a string by slicing. There are <a href=\"https://apidock.com/ruby/String/slice\" rel=\"nofollow noreferrer\">quite a few options</a> but providing a range where the upper boundary is before the lower boundary will result in <code>&quot;&quot;</code> (empty string) being returned."}, {"owner": {"reputation": 6105, "user_id": 4002659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11c2eb99f1668b4d442780e34fc983d?s=128&d=identicon&r=PG&f=1", "display_name": "dp7", "link": "https://stackoverflow.com/users/4002659/dp7"}, "reply_to_user": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "edited": false, "score": 0, "creation_date": 1505856002, "post_id": 46308479, "comment_id": 79581736, "body": "@ulferts yes, exactly negative offeset returns <code>&quot;&quot;</code> when we do something like this <code>&quot;foobar&quot;.[-1..3]</code> and seems there is no way to have a <code>step</code> counter to move in reverse direction."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1505891165, "post_id": 46308479, "comment_id": 79592222, "body": "@dp7 What is the use case that <code>reverse</code> can&#39;t deal with? Why do you insist on slicing (especially if it is clear it does not do the same thing as in Python)?"}, {"owner": {"reputation": 6105, "user_id": 4002659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11c2eb99f1668b4d442780e34fc983d?s=128&d=identicon&r=PG&f=1", "display_name": "dp7", "link": "https://stackoverflow.com/users/4002659/dp7"}, "edited": false, "score": 0, "creation_date": 1505910093, "post_id": 46308479, "comment_id": 79604533, "body": "Can we reverse a string <code>hello</code> to return a string compose of even positioned characters i.e <code>olh</code> using <code>reverse</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 6105, "user_id": 4002659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11c2eb99f1668b4d442780e34fc983d?s=128&d=identicon&r=PG&f=1", "display_name": "dp7", "link": "https://stackoverflow.com/users/4002659/dp7"}, "edited": false, "score": 0, "creation_date": 1505851238, "post_id": 46308523, "comment_id": 79579642, "body": "Thanks for the response, but I was not looking for a string reverse solution using <code>reverse</code> method rather I was interested to know if there is any slicing operator in Ruby like Python. I could not find that answer after searching, so asked this question."}], "tags": [], "owner": {"reputation": 4320, "user_id": 3922099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZHBBc.jpg?s=128&g=1", "display_name": "Dan Kreiger", "link": "https://stackoverflow.com/users/3922099/dan-kreiger"}, "is_accepted": false, "score": 2, "last_activity_date": 1505849848, "creation_date": 1505849848, "answer_id": 46308523, "question_id": 46308479, "link": "https://stackoverflow.com/questions/46308479/is-there-a-way-in-ruby-to-reverse-a-string-like-python-slicing/46308523#46308523", "title": "Is there a way in Ruby to reverse a string like Python slicing?", "body": "<p>You can use the <a href=\"https://apidock.com/ruby/String/reverse\" rel=\"nofollow noreferrer\"><code>reverse</code></a> method in ruby:</p>\n\n<pre><code>\"foobar\".reverse #=&gt; \"raboof\"\n</code></pre>\n"}], "owner": {"reputation": 6105, "user_id": 4002659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11c2eb99f1668b4d442780e34fc983d?s=128&d=identicon&r=PG&f=1", "display_name": "dp7", "link": "https://stackoverflow.com/users/4002659/dp7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "closed_date": 1505849845, "answer_count": 1, "score": 0, "last_activity_date": 1505850011, "creation_date": 1505849665, "last_edit_date": 1505850011, "question_id": 46308479, "link": "https://stackoverflow.com/questions/46308479/is-there-a-way-in-ruby-to-reverse-a-string-like-python-slicing", "closed_reason": "Duplicate", "title": "Is there a way in Ruby to reverse a string like Python slicing?", "body": "<p>Python does have a slicing operator to reverse a string or list.</p>\n\n<p>Example:</p>\n\n<pre><code>\"foobar\"[::-1]   # raboof\n</code></pre>\n\n<p>Is there such a way exist in Ruby where we can step in reverse order ?</p>\n\n<p><strong>EDIT:</strong>  I am not looking for a string reverse solution using Ruby <code>reverse</code> or <code>reverse!</code> or any other logic. I only wanted to know if there is any slicing operator exists in Ruby like Python.\nSo it is not duplicate of <a href=\"https://stackoverflow.com/questions/3057967/reverse-a-string-in-ruby\">String Reverse Question </a>.</p>\n\n<p>Any insight about this in Ruby would be appreciated. Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 4320, "user_id": 3922099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZHBBc.jpg?s=128&g=1", "display_name": "Dan Kreiger", "link": "https://stackoverflow.com/users/3922099/dan-kreiger"}, "edited": false, "score": 0, "creation_date": 1505849595, "post_id": 46308405, "comment_id": 79578835, "body": "This <a href=\"https://stackoverflow.com/questions/5714375/check-system-dependencies-for-a-gem\">answer</a> might be helpful."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1505852731, "post_id": 46308405, "comment_id": 79580325, "body": "What is your definition of <i>system dependencies</i>? Operation system? System Libraries? Other gems? Can you name an example gem and the expected output?"}], "owner": {"reputation": 11, "user_id": 5032215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34534e564486288404ab12ebb827b095?s=128&d=identicon&r=PG&f=1", "display_name": "mahmoud soliman", "link": "https://stackoverflow.com/users/5032215/mahmoud-soliman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505849446, "creation_date": 1505849446, "question_id": 46308405, "link": "https://stackoverflow.com/questions/46308405/find-system-level-dependencies-of-certain-ruby-gem", "title": "Find system level dependencies of certain ruby gem", "body": "<p>I need to make a web api that takes the name of local gem in my project and returns a list of system dependencies that need to be installed, but i don't know how to start</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "controller"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1505849415, "creation_date": 1505849415, "answer_id": 46308398, "question_id": 46308275, "link": "https://stackoverflow.com/questions/46308275/selecting-random-record-in-rails/46308398#46308398", "title": "Selecting random record in rails", "body": "<p>If you need to track usage then what you need is some kind of sequence column, populate that with random values, and NULL them out as you use them up. When they're all NULL, re-seed with random values and do it all over again.</p>\n"}, {"comments": [{"owner": {"reputation": 2114, "user_id": 442637, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0fd3f116897f75ec1de34a4ec77cac88?s=128&d=identicon&r=PG", "display_name": "Grocery", "link": "https://stackoverflow.com/users/442637/grocery"}, "edited": false, "score": 0, "creation_date": 1505957039, "post_id": 46309180, "comment_id": 79628605, "body": "<code>order(&quot;RAND()&quot;)</code> will set fire to your database server if that table is reasonably large... or you&#39;re hitting it that query often enough."}], "tags": [], "owner": {"reputation": 2027, "user_id": 3206935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2a4aca251933f2cac77579282b640?s=128&d=identicon&r=PG&f=1", "display_name": "ulferts", "link": "https://stackoverflow.com/users/3206935/ulferts"}, "is_accepted": true, "score": 0, "last_activity_date": 1505852523, "creation_date": 1505852523, "answer_id": 46309180, "question_id": 46308275, "link": "https://stackoverflow.com/questions/46308275/selecting-random-record-in-rails/46309180#46309180", "title": "Selecting random record in rails", "body": "<p>You'll need a separate spot to store the records being displayed already outside of your current process. The process might die or you will have multiple processes running (if it is meant for production purposes, that should definitely be the case). </p>\n\n<p>As opposed to what <a href=\"https://stackoverflow.com/a/46308398/3206935\">tadman proposed</a> I wouldn't recommend storing the sequence in the db as this will make adding new records more complicated. </p>\n\n<p>Instead, I would add a simple <code>displayed</code> (boolean) column (or separate table) and <a href=\"https://stackoverflow.com/questions/17372886/whats-the-rails-4-way-of-finding-some-number-of-random-records\">rely on what has been proposed in a different thread</a> but flavored to your specific use case. So the query might be like this:</p>\n\n<pre><code>@qotd = Quote.where(displayed: false).order(\"RAND()\").limit(1)\n</code></pre>\n\n<p>and of course a </p>\n\n<pre><code>@qotd.update_attribute :displayed, true\n</code></pre>\n\n<p>later on.</p>\n\n<p>The <code>displayed</code> column for all records will have to be reset if no candidate is found. All this, (query, update and reset) should probably happen within a single method. </p>\n"}, {"tags": [], "owner": {"reputation": 3725, "user_id": 458968, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f47eea36e65fd8b99ff494fc2e6059b9?s=128&d=identicon&r=PG", "display_name": "you786", "link": "https://stackoverflow.com/users/458968/you786"}, "is_accepted": false, "score": 0, "last_activity_date": 1505854375, "creation_date": 1505854375, "answer_id": 46309591, "question_id": 46308275, "link": "https://stackoverflow.com/questions/46308275/selecting-random-record-in-rails/46309591#46309591", "title": "Selecting random record in rails", "body": "<p>My suggestion is to add a column like \"display_count\" to your table. When you want to get a random item to display, you can simply issue a query like the following:</p>\n\n<pre><code>quote = Quote.where(\n  display_count: Quote.select(\"MIN(display_count)\")\n  ).order(\"RANDOM()\")\nquote.update_attribute(:display_count, quote.display_count + 1)\n</code></pre>\n\n<p>That way you always select an item that has been displayed the least, and increment it after you retrieve it. That should (almost) guarantee that every time you run this code, you get a new item.</p>\n"}], "owner": {"reputation": 5, "user_id": 7586878, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7CSwvSkEwxE/AAAAAAAAAAI/AAAAAAAAABQ/AXCj0xn6vqw/photo.jpg?sz=128", "display_name": "Devanshu Matlawala", "link": "https://stackoverflow.com/users/7586878/devanshu-matlawala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 46309180, "answer_count": 3, "score": 0, "last_activity_date": 1505854375, "creation_date": 1505848845, "question_id": 46308275, "link": "https://stackoverflow.com/questions/46308275/selecting-random-record-in-rails", "title": "Selecting random record in rails", "body": "<p>I am trying to randomly select a record from the database and display it in my view. The catch is I don't want the selected random record to repeat until all the records are selected at least once. For instance, let's say my table has 10 records, so I want to pick any one random record and make sure that, that randomly selected record is not selected again until the other nine records are selected at least once.</p>\n\n<p>snippet:</p>\n\n<pre><code>    offset = rand(Quote.count)\n\n    @qotd = Rails.cache.fetch( \"term\", :expires_in =&gt; 6.seconds){ Quote.offset(offset).first }\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 2276, "user_id": 4164651, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/100004012909097/picture?type=large", "display_name": "Edmund Lee", "link": "https://stackoverflow.com/users/4164651/edmund-lee"}, "edited": false, "score": 0, "creation_date": 1505847161, "post_id": 46307654, "comment_id": 79577485, "body": "Thanks. Forgot to mention this works, but I need to stub some methods in the libraries I am using. It&#39;d be nice if I don&#39;t do any stubbing, especially considering those are implementation details in the library. Any other alternative?"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1505846457, "creation_date": 1505846457, "answer_id": 46307654, "question_id": 46307558, "link": "https://stackoverflow.com/questions/46307558/test-if-a-method-takes-a-block/46307654#46307654", "title": "Test if a method takes a block", "body": "<blockquote>\n  <p>How can I verify if <code>Foobar#some_method</code> takes a block.</p>\n</blockquote>\n\n<p><em>Every</em> method in ruby takes (can take) a block. It may simply choose not to yield. So that's what you need to check, I think: if the method yielded or not.</p>\n\n<p>RSpec has a number of yield expectations: <a href=\"https://relishapp.com/rspec/rspec-expectations/docs/built-in-matchers/yield-matchers\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-expectations/docs/built-in-matchers/yield-matchers</a></p>\n\n<pre><code>RSpec.describe \"yield_control matcher\" do\n  specify { expect { |b| MyClass.yield_once_with(1, &amp;b) }.to yield_control }\n  specify { expect { |b| MyClass.dont_yield(&amp;b) }.not_to yield_control }\n  specify { expect { |b| MyClass.yield_twice_with(1, &amp;b) }.to yield_control.twice }\n  specify { expect { |b| MyClass.yield_twice_with(1, &amp;b) }.to yield_control.exactly(2).times }\n  specify { expect { |b| MyClass.yield_twice_with(1, &amp;b) }.to yield_control.at_least(1) }\n  specify { expect { |b| MyClass.yield_twice_with(1, &amp;b) }.to yield_control.at_most(3).times }\n\nend\n</code></pre>\n\n<p>So for your case it should be something like this:</p>\n\n<pre><code>expect{ foobar.some_method }.to yield_control\n</code></pre>\n"}], "owner": {"reputation": 2276, "user_id": 4164651, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/100004012909097/picture?type=large", "display_name": "Edmund Lee", "link": "https://stackoverflow.com/users/4164651/edmund-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 46307654, "answer_count": 1, "score": 1, "last_activity_date": 1505856457, "creation_date": 1505846107, "last_edit_date": 1505856457, "question_id": 46307558, "link": "https://stackoverflow.com/questions/46307558/test-if-a-method-takes-a-block", "title": "Test if a method takes a block", "body": "<p>How can I verify if <code>Foobar#some_method</code> takes a block. Something simliar to <code>Foobar.new.respond_to?(:some_method)</code></p>\n\n<pre><code>class Foobar\n  def some_method\n    yield\n  end\nend\n</code></pre>\n\n<p><strong>Why?</strong></p>\n\n<p>This is useful for testing contract interface. Ensuring the method I stub has an unchanged API.</p>\n\n<p><strong>Ways I've tried</strong></p>\n\n<pre><code>mth = Foobar.new.method(:some_method)\nmth.parameters\n</code></pre>\n\n<p>this returns a list of parameters (what Rspec uses essentially). It works if I have an argument as block like this:</p>\n\n<pre><code>def some_method(&amp;blk)\nend\n</code></pre>\n\n<p>But if a method uses <code>yield</code> instead, I got nothing from <code>#parameters</code>.</p>\n\n<p>This is for adding specs for ensuring the interface with the ugly outside world. So I know how a method is used. But if there is an API change, I'd like specs to fail.</p>\n"}, {"tags": ["arrays", "json", "ruby"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1505846052, "post_id": 46307387, "comment_id": 79576831, "body": "That looks like YAML to me. You can just <code>select</code> the keys you want and then dump it to YAML."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1505849334, "creation_date": 1505849334, "answer_id": 46308385, "question_id": 46307387, "link": "https://stackoverflow.com/questions/46307387/is-there-a-clever-way-to-format-a-json-object-to-be-displayed/46308385#46308385", "title": "Is there a clever way to format a json object to be displayed?", "body": "<p>Simple:</p>\n\n<pre><code>YAML.dump(JSON.load(data))\n</code></pre>\n\n<p>You'll get something 95% similar for almost no cost.</p>\n"}], "owner": {"reputation": 3884, "user_id": 904278, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c9d3545273e0142f4e524139612c7446?s=128&d=identicon&r=PG", "display_name": "isea", "link": "https://stackoverflow.com/users/904278/isea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505849334, "creation_date": 1505845488, "question_id": 46307387, "link": "https://stackoverflow.com/questions/46307387/is-there-a-clever-way-to-format-a-json-object-to-be-displayed", "title": "Is there a clever way to format a json object to be displayed?", "body": "<p>Lets say I have an array of JSON objects that looks like this:</p>\n\n<pre><code>[\n  {\"id\": 1234,\n   \"organization_id\": 12,\n   \"name\": \"Susan Taylor\",\n   \"created_at\": 2016-07-28T05:29:25 -10:00,\n   \"role\": \"Admin\"},\n  {\"id\": 1235,\n   \"organization_id\": 12,\n   \"name\": \"Jeff Scott\",\n   \"created_at\": 2016-07-28T05:29:25 -10:00,\n   \"role\": \"Admin\"}\n] \n</code></pre>\n\n<p>But I only want to show certain fields in a certain order?</p>\n\n<pre><code>name: Susan Taylor \nrole: Admin \norganization_id: 12\n\nname: Jeff Scott \nrole: Admin \norganization_id: 12\n</code></pre>\n\n<p>I can think of some ugly ways to do it, but I was thinking there might be some really cool way I'm unaware of.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sinatra"], "answers": [{"tags": [], "owner": {"reputation": 21499, "user_id": 19839, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/971cfac6afb23c0f0fd3623284a02a81?s=128&d=identicon&r=PG", "display_name": "csexton", "link": "https://stackoverflow.com/users/19839/csexton"}, "is_accepted": false, "score": 0, "last_activity_date": 1505845717, "creation_date": 1505845717, "answer_id": 46307443, "question_id": 46306684, "link": "https://stackoverflow.com/questions/46306684/automatic-reloading-of-sinatra-app-mounted-inside-rails-app/46307443#46307443", "title": "Automatic Reloading of Sinatra App mounted inside Rails App", "body": "<p>Just like with a Sinatra app on it's own, a Sinatra app mounted inside o rails will not automatically reload as you make changes. Typically in Sinatra people would use external tools to help solve this problem, so they might set up something like <a href=\"https://github.com/rtomayko/shotgun\" rel=\"nofollow noreferrer\">Shotgun</a> to watch the directory and restart the server any time a change has happened.</p>\n\n<p>But, like most things in Rails, there is a way hook into it's functionatly for your own programming benefit.</p>\n\n<h3>ActiveSupport::FileUpdateChecker</h3>\n\n<p>Rails has a handy <code>ActiveSupport::FileUpdateChecker</code> that can watch a file, or a list of files. When they change it will call back to a block. You can use this to reload the Sinatra app -- or anything else for that matter.</p>\n\n<p>In your case you might want to add the following to <code>config/environments/development.rb</code> in the config block for the application:</p>\n\n<pre><code>Rails.application.configure do\n  # ...\n\n  sinatra_reloader = ActiveSupport::FileUpdateChecker.new(Dir[\"path/to/sinatra/app/**\"]) do\n    Rails.application.reload_routes!\n  end\n\n  config.to_prepare do\n    sinatra_reloader.execute_if_updated\n  end\nend\n</code></pre>\n\n<hr>\n\n<p>Robert Mosolgo has a good write up on his blog: <a href=\"http://rmosolgo.github.io/blog/2017/04/12/watching-files-during-rails-development/\" rel=\"nofollow noreferrer\">Watching Files During Rails Development</a>. His approach is a little more thorough, but more complicated.</p>\n"}], "owner": {"reputation": 1, "user_id": 5754641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_IBKJgtSY0s/AAAAAAAAAAI/AAAAAAAAMm0/kLP-3vtPWdQ/photo.jpg?sz=128", "display_name": "mwdeez", "link": "https://stackoverflow.com/users/5754641/mwdeez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505845717, "creation_date": 1505842748, "question_id": 46306684, "link": "https://stackoverflow.com/questions/46306684/automatic-reloading-of-sinatra-app-mounted-inside-rails-app", "title": "Automatic Reloading of Sinatra App mounted inside Rails App", "body": "<p>I've run into what I hope is an easy-ish fix for someone more experienced than me when adding a Sinatra app to an existing Rails app.</p>\n\n<p>I currently have a large rails monolith that I am planning to break apart into an SPA backed by a JSON API. Since I will still need to support the monolith until the API is completed I would like to mount the API (written in Sinatra) inside the existing Rails app as I port functionality over with a goal of removing the Rails app itself in a few months. The reason I've mounted the Sinatra app inside Rails instead of setting it up as a separate service was that I wanted easy code sharing between the two as I intend to continue using ActiveRecord as my ORM in Sinatra once the migration is complete.</p>\n\n<p>I've mounted the Sinatra mockup inside the Rails app without any issues using the Rails routes.rb file as:</p>\n\n<pre><code>Rails.application.routes.draw do\n  mount API::Core, at: '/api'\n...\nend\n</code></pre>\n\n<p>I'm not doing any work with config.ru as mounting the API inside the routes.rb file seemed to suit my needs. If I need to put in some more legwork to get this running properly that is not an issue.</p>\n\n<p>The entrypoint for the sinatra app is also fairly simple with just a couple controllers loaded in to segment the routing:</p>\n\n<pre><code>require 'sinatra/base'\nrequire 'sinatra/json'\n\nrequire_relative 'controllers/first_controller'\nrequire_relative 'controllers/second_controller'\n\nmodule API\n  class Core &lt; Sinatra::Base\n    register Sinatra::FirstControllerApi\n    register Sinatra::SecondControllerApi\n\n  end\nend\n</code></pre>\n\n<p>The problem I'm running into is one I expected with Sinatra but haven't been able to flex my google-fu enough to find a solution. Rails automatically reloads code on each change/request as expected but Sinatra does not. Every time I change controller code in the Sinatra API I need to restart the entire Rails server to serve the new content. Since my dev environment runs in docker containers this can take a while to start up each time and is becoming cumbersome.</p>\n\n<p>Is there a 'canonical' solution to the problem of automagically reloading the Sinatra app mounted inside the Rails app or am I just over-complicating the problem? I know there are some gems for Sinatra that apply to this space but I haven't seen any info in how to get them working in this 'odd' edge case.</p>\n\n<p>Please let me know if you need any more info, hopefully I've provided enough for someone to comprehend my issues.</p>\n"}, {"tags": ["ruby", "reduce"], "comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 1, "creation_date": 1505840874, "post_id": 46306085, "comment_id": 79574270, "body": "Please, read about <code>String#+</code>"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1505841192, "post_id": 46306085, "comment_id": 79574421, "body": "Docs at <a href=\"https://ruby-doc.org/core-2.1.0/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.1.0/Enumerable.html#method-i-reduce</a> include description of behavior and source code"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1505852437, "post_id": 46306085, "comment_id": 79580187, "body": "<code>String#+</code> is non-commutative, it&#39;s really not surprising that the result changes. For the same reason, <code>&#39;Hello&#39; + &#39;World&#39;</code> is not the same as <code>&#39;World&#39; + &#39;Hello&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6772117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51901a779462a941aeb25681503da301?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment LaFontaine", "link": "https://stackoverflow.com/users/6772117/cl%c3%a9ment-lafontaine"}, "edited": false, "score": 1, "creation_date": 1505841485, "post_id": 46306154, "comment_id": 79574533, "body": "That makes sense. I mistakenly thought the latter one is the one on which results &quot;collapse&quot; on. Thanks for the tip."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1505841518, "last_edit_date": 1505841518, "creation_date": 1505840886, "answer_id": 46306154, "question_id": 46306085, "link": "https://stackoverflow.com/questions/46306085/different-working-mechanism-of-reduce-method-in-ruby/46306154#46306154", "title": "Different working mechanism of reduce method in Ruby", "body": "<p>The first parameter of the block is the memo, the object on which is build the solution, the latter is the \"current item\" of your collection. So, in the first example you are concatenating the items after your memo, in the second example before the memo. Both the ways are legits. In the end it depends what you have to do.</p>\n"}, {"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 1, "last_activity_date": 1505841936, "creation_date": 1505841936, "answer_id": 46306458, "question_id": 46306085, "link": "https://stackoverflow.com/questions/46306085/different-working-mechanism-of-reduce-method-in-ruby/46306458#46306458", "title": "Different working mechanism of reduce method in Ruby", "body": "<p>Print each step to see what's going on.</p>\n\n<pre><code>a = %w{1 2 3}\na.reduce {|memo, obj|\n  puts \"memo is #{memo} and obj is #{obj}\"\n  puts \"new memo is #{memo + obj}\", \"=\"*23\n  memo + obj\n}\n\n#memo is 1 and obj is 2\n#new memo is 12\n#=======================\n#memo is 12 and obj is 3\n#new memo is 123\n#=======================\n\na.reduce {|memo, obj|\n  puts \"memo is #{memo} and obj is #{obj}\"\n  puts \"new memo is #{obj + memo}\", \"=\"*23\n  obj + memo\n}\n\n#memo is 1 and obj is 2\n#new memo is 21\n#=======================\n#memo is 21 and obj is 3\n#new memo is 321\n#=======================\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6772117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51901a779462a941aeb25681503da301?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment LaFontaine", "link": "https://stackoverflow.com/users/6772117/cl%c3%a9ment-lafontaine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1505841936, "creation_date": 1505840654, "last_edit_date": 1505840729, "question_id": 46306085, "link": "https://stackoverflow.com/questions/46306085/different-working-mechanism-of-reduce-method-in-ruby", "title": "Different working mechanism of reduce method in Ruby", "body": "<p>So I recently noticed that the order of you put in parameters in ruby's reduce method influenced the results.</p>\n\n<pre><code>a = [\"1\", \"2\", \"3\"]\na.reduce {|val, con| val + con}\na = [\"123\"]\n</code></pre>\n\n<p>However</p>\n\n<pre><code>a.reduce {|val, con| con + val}\na = [\"321\"]\n</code></pre>\n\n<p>I think it only matters how you give order to |val, con| pair, which means if con shows at the latter position, the result of every step is always gonna be stored in con. And these two should yield the same result. But obviously not here. </p>\n\n<p>Anyone could provide some tips? Thanks. Any explanation of how these two methods are implemented in Ruby would hugely help.</p>\n"}, {"tags": ["java", "ruby", "algorithm"], "comments": [{"owner": {"reputation": 1379, "user_id": 2101252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXPjA.jpg?s=128&g=1", "display_name": "s1mpl3", "link": "https://stackoverflow.com/users/2101252/s1mpl3"}, "edited": false, "score": 0, "creation_date": 1505843211, "post_id": 46305883, "comment_id": 79575421, "body": "If that is not an academic exercise you can always do [1, 2, 3].permutation.to_a"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1505858006, "post_id": 46305883, "comment_id": 79582463, "body": "It&#39;s just &quot;Ruby&quot; and &quot;Java&quot;. They&#39;re not acronyms, they&#39;re not all-caps."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 6101835, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/977576222279327/picture?type=large", "display_name": "Srikiran Sistla", "link": "https://stackoverflow.com/users/6101835/srikiran-sistla"}, "edited": false, "score": 0, "creation_date": 1505844261, "post_id": 46306874, "comment_id": 79575976, "body": "Thank you so much! your simple hack just worked like charm! :) and thanks for letting me know about <code>permutation.to_a</code>"}], "tags": [], "owner": {"reputation": 309, "user_id": 2903331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a941909ef227991b23f2bc99249067c2?s=128&d=identicon&r=PG&f=1", "display_name": "Sofa", "link": "https://stackoverflow.com/users/2903331/sofa"}, "is_accepted": true, "score": 3, "last_activity_date": 1505843457, "creation_date": 1505843457, "answer_id": 46306874, "question_id": 46305883, "link": "https://stackoverflow.com/questions/46305883/permutations-program-using-backtracking-not-working-in-ruby/46306874#46306874", "title": "Permutations program using backtracking not working in Ruby", "body": "<p>It's wierd, but I had untangled your code:)</p>\n\n<p>What you need is just make clone of your temp_list, before appending it to res:\n<code>\nres &lt;&lt; temp_list.dup\n</code></p>\n\n<p>JFYI, you could save some time by just calling standard Array#permutation:\n<code>\n[1,2,3].permutation.to_a # =&gt; [[1, 2, 3], [1, 3, 2], [2, 1, 3], [2, 3, 1], [3, 1, 2], [3, 2, 1]]\n</code></p>\n"}], "owner": {"reputation": 65, "user_id": 6101835, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/977576222279327/picture?type=large", "display_name": "Srikiran Sistla", "link": "https://stackoverflow.com/users/6101835/srikiran-sistla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 46306874, "answer_count": 1, "score": 0, "last_activity_date": 1505858044, "creation_date": 1505839960, "last_edit_date": 1505858044, "question_id": 46305883, "link": "https://stackoverflow.com/questions/46305883/permutations-program-using-backtracking-not-working-in-ruby", "title": "Permutations program using backtracking not working in Ruby", "body": "<p>I am fairly new to Ruby programming and I am trying to write a Ruby code which will take a list of numbers in certain order and will return all the possible permutation in a list of permutation lists. I wrote this program successfully in Java a while ago and it worked and when I was trying to implement same logic in Ruby I am just getting list of empty lists instead of permutations. By initial debugging, I could observe that each permutation is being successfully built in temp_list list by backtrack method but somehow res is not retaining the pushed permutations properly. I think there is something wrong with my coding style in Ruby. Can someone please point out what the issue might be. I am attaching both my Ruby and Java codes.</p>\n\n<p>My Ruby code goes here:</p>\n\n<pre><code># @param [Object] nums : List of numbers Example: [1, 2, 3]\n# @return [Object] res : List of all permutation lists Example [[1, 2, 3], [1, 3, 2]....]\ndef permute(nums)\n  res = []\n  temp_list = []\n  backtrack(res, temp_list, nums)\n  res\nend\n\n# @param [Object] res : List of all permutation lists Example [[1, 2, 3], [1, 3, 2]....]\n# @param [Object] temp_list : List of permutation which is being built\n# @param [Object] nums : Original nums list given to the permute method\ndef backtrack(res, temp_list, nums)\n  if temp_list.size == nums.size\n    res &lt;&lt; temp_list\n  else\n    nums.each do |n|\n      next if temp_list.include? n\n      temp_list &lt;&lt; n\n      backtrack(res, temp_list, nums)\n      temp_list.pop\n    end\n  end\nend\n</code></pre>\n\n<p>My JAVA Code goes here:</p>\n\n<pre><code>import java.util.ArrayList;\nimport java.util.List;\n\n/**\n * Created by Srikiran Sistla on 4/3/2017.\n */\npublic class Q46 {\n    public List&lt;List&lt;Integer&gt;&gt; permute(int[] num) {\n        List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();\n        List&lt;Integer&gt; tempList = new ArrayList&lt;&gt;();\n        backtrack(res, tempList, num);\n        return res;\n    }\n\n    private void backtrack(List&lt;List&lt;Integer&gt;&gt; res, List&lt;Integer&gt; tempList, int[] num) {\n        if (tempList.size() == num.length) res.add(new ArrayList&lt;&gt;(tempList));\n        else {\n            for (int n : num){\n                if (tempList.contains(n)) continue;\n                tempList.add(n);\n                backtrack(res, tempList, num);\n                tempList.remove(tempList.size()-1);\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1505911135, "post_id": 46305511, "comment_id": 79605315, "body": "I can&#39;t associate articles with category like this: &quot;Category.articles&quot;, because i am using a has-many through association for the category model. Instead, i use &quot;Category.includes(:articles), but the same issue occurs."}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "reply_to_user": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1505914418, "post_id": 46305511, "comment_id": 79607725, "body": "try : <code>Category.joins(:articles)</code>"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "reply_to_user": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1505915169, "post_id": 46305511, "comment_id": 79608350, "body": "Can you post the issue that appears?"}, {"owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1505917871, "post_id": 46305511, "comment_id": 79610289, "body": "Changing it to joins now stops the ajax button from working, and the same category name is repeated twice. I have added a screenshot. Basically, i have 5 categories, eg &quot;A&quot; and &quot;B&quot; shows on page initial load, when i click load more, &quot;C&quot; and D&quot; should show, but currently &quot;A&quot; and &quot;B&quot; gets repeated again and again each time the load more button appears."}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "reply_to_user": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1505918815, "post_id": 46305511, "comment_id": 79611015, "body": "Okay, I have an idea. Can you tell me how you&#39;re calling in your view? And I&#39;ll update my answer."}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "reply_to_user": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1505919360, "post_id": 46305511, "comment_id": 79611419, "body": "I think that this limit (2) will always bring the first two records. Then you could use kaminari to leave only the first two records. Return the category index to normal. So, <code>@categories = Category.all</code> .  In the view when you are going to call the union of the two, do <code>@category.articles</code> and the kaminari will limit on the page."}], "tags": [], "owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "is_accepted": false, "score": 1, "last_activity_date": 1505840712, "last_edit_date": 1505840712, "creation_date": 1505838603, "answer_id": 46305511, "question_id": 46305320, "link": "https://stackoverflow.com/questions/46305320/ruby-on-rails-only-display-category-on-index-page-if-it-contains-any-articles/46305511#46305511", "title": "Ruby on Rails: only display category on index page if it contains any articles", "body": "<p>Try this:</p>\n\n<pre><code>def index\n  @categories = Category.articles.order('name ASC').limit(2)\n  respond_to do |format|\n    format.html\n    format.js\n  end\nend\n</code></pre>\n\n<p>I think this will resolve and you can remove from model <code>category</code> the function <code>with_articles</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1505908587, "post_id": 46306000, "comment_id": 79603471, "body": "This did not work for me.. the same 2 category names keep on rendering and adds on below the existing categories each time i click the load more button."}, {"owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "reply_to_user": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1505909641, "post_id": 46306000, "comment_id": 79604190, "body": "Did you used <code>offset</code> and sent it as a param ?"}, {"owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1505910177, "post_id": 46306000, "comment_id": 79604591, "body": "I copied and pasted your code above to my controller"}], "tags": [], "owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1505840728, "last_edit_date": 1505840728, "creation_date": 1505840338, "answer_id": 46306000, "question_id": 46305320, "link": "https://stackoverflow.com/questions/46305320/ruby-on-rails-only-display-category-on-index-page-if-it-contains-any-articles/46306000#46306000", "title": "Ruby on Rails: only display category on index page if it contains any articles", "body": "<p>you are missing the <code>offset</code> thing. You need to maintain a <code>param</code> say <code>offset</code> and send it every ajax request\nOffset lets you get the <code>n - the number of records</code> as passed in limit function after skipping - the number of records<code>passed in</code>offset` function.</p>\n\n<p>So, Ideally After fetching first two records from Database you need to get other two records by skipping first two records so you need to pass <code>offset</code> as 2 in your params</p>\n\n<pre><code>def index\n  if params[:name]\n    @categories = Category.with_articles.order(:name).where('name&gt; ?', params[:name]).limit(2).offset(params[:offset].to_i)\n  else\n    @categories = Category.with_articles.order(:name).limit(2).offset(params[:offset].to_i)\n  end\n  respond_to do |format|\n    format.html\n    format.js\n  end\nend\n</code></pre>\n\n<p>Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 945, "user_id": 5269750, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/478621712312068/picture?type=large", "display_name": "Sai Ram Reddy", "link": "https://stackoverflow.com/users/5269750/sai-ram-reddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1505844265, "creation_date": 1505844265, "answer_id": 46307093, "question_id": 46305320, "link": "https://stackoverflow.com/questions/46305320/ruby-on-rails-only-display-category-on-index-page-if-it-contains-any-articles/46307093#46307093", "title": "Ruby on Rails: only display category on index page if it contains any articles", "body": "<p>Your code looks fine but it seems to be like you are making it more complex.</p>\n\n<pre><code>def index\n  @categories = Category.articles.where('articles.id &gt; ?',params[:id]).order('name ASC').limit(2)\n  respond_to do |format|\n    format.html\n    format.js\n  end\nend\n</code></pre>\n\n<p>In Ajax call you can send the <code>id</code> of the last article. Hope it works!</p>\n"}], "owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1505917989, "creation_date": 1505837891, "last_edit_date": 1505917989, "question_id": 46305320, "link": "https://stackoverflow.com/questions/46305320/ruby-on-rails-only-display-category-on-index-page-if-it-contains-any-articles", "title": "Ruby on Rails: only display category on index page if it contains any articles", "body": "<p>I'm trying to create an index page showing all categories <strong>in alphabetical order</strong>, but only if an article has been tagged to that category. An article can have many categories.</p>\n\n<p>When index page is first loaded, it will only show 2 categories. There is a \"load more\" ajax button at the bottom of the index page to load the next 2 categories. </p>\n\n<p>I think there is an error with how i am assigning the categories variable. The ajax button works, but the same 2 category names are being shown (eg. \"A\" and \"B\", instead of the next 2 (eg \"C\" &amp; \"D\").</p>\n\n<p><strong>Categories controller</strong></p>\n\n<pre><code>  def index\n    if params[:name]\n      @categories = Category.with_articles.order('name ASC').where('name&gt; ?', params[:name]).limit(2)\n    else\n      @categories = Category.with_articles.order('name ASC').limit(2)\n    end\n    respond_to do |format|\n      format.html\n      format.js\n    end\n  end\n</code></pre>\n\n<p><strong>category/index.html.erb</strong></p>\n\n<pre><code>&lt;%= render @categories %&gt;\n</code></pre>\n\n<p><strong>schema.rb</strong></p>\n\n<pre><code>  create_table \"categories\", force: :cascade do |t|\n    t.string \"name\"\n  end\n\n  create_table \"article_categories\", force: :cascade do |t|\n    t.integer \"article_id\"\n    t.integer \"category_id\"\n  end\n</code></pre>\n\n<p><strong>models/category.rb</strong></p>\n\n<pre><code>class Category &lt; ApplicationRecord\n  has_many :article_categories\n  has_many :articles, through: :article_categories\n\n  def self.with_articles\n    includes(:articles).where.not(articles: { id: nil })\n  end\n\nend\n</code></pre>\n\n<p><strong>EDIT:</strong>\n<strong>models/article_category.rb</strong></p>\n\n<pre><code>class ArticleCategory &lt; ActiveRecord::Base\n\nbelongs_to :article\nbelongs_to :category\n\nend\n</code></pre>\n\n<p><strong>models/article.rb</strong></p>\n\n<pre><code>class Article &lt; ApplicationRecord\n  has_many :article_categories\n  has_many :categories, through: :article_categories\nend**\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Pp7C5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pp7C5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 4104, "user_id": 1136008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KEcK1.png?s=128&g=1", "display_name": "A.D.", "link": "https://stackoverflow.com/users/1136008/a-d"}, "edited": false, "score": 0, "creation_date": 1505843965, "post_id": 46305279, "comment_id": 79575803, "body": "Depending on the OS you can use system tools like <code>sed</code>, <code>awk</code> etc. F.e.: <code>tail -n +2 file.cvs | cut -d, -f 1</code> Sometimes it&#39;s handy."}], "answers": [{"tags": [], "owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "is_accepted": true, "score": 3, "last_activity_date": 1505840073, "last_edit_date": 1505840073, "creation_date": 1505838045, "answer_id": 46305365, "question_id": 46305279, "link": "https://stackoverflow.com/questions/46305279/how-to-remove-headers-and-second-column-in-csv-in-ruby/46305365#46305365", "title": "How to remove headers and second column in CSV in ruby?", "body": "<p>You can read your file as an array and ignore the first row like this: </p>\n\n<pre><code>data = CSV.read(\"dataset.csv\")[1 .. -1]\n</code></pre>\n\n<p>This way you can remove the header.</p>\n\n<p>Regarding the column, you can delete a column like this:</p>\n\n<pre><code>data = CSV.read(\"dataset.csv\")[1 .. -1]\ndata.delete(\"is_user_unsubscribed\")\ndata.to_csv # =&gt; The new CSV in string format\n</code></pre>\n\n<p>Check this for more info: <a href=\"http://ruby-doc.org/stdlib-1.9.2/libdoc/csv/rdoc/CSV/Table.html\" rel=\"nofollow noreferrer\">http://ruby-doc.org/stdlib-1.9.2/libdoc/csv/rdoc/CSV/Table.html</a></p>\n\n<p><a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">http://ruby-doc.org/stdlib-2.0.0/libdoc/csv/rdoc/CSV.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 5839077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b78692a9deff6b07c64b8abb32b5c1?s=128&d=identicon&r=PG&f=1", "display_name": "D. Wood", "link": "https://stackoverflow.com/users/5839077/d-wood"}, "is_accepted": false, "score": 1, "last_activity_date": 1505839534, "last_edit_date": 1592644375, "creation_date": 1505839183, "answer_id": 46305684, "question_id": 46305279, "link": "https://stackoverflow.com/questions/46305279/how-to-remove-headers-and-second-column-in-csv-in-ruby/46305684#46305684", "title": "How to remove headers and second column in CSV in ruby?", "body": "<p>My recommendation would be to read in a line from your file as a string, then split the String that you get by commas (there is a comma separating your columns).</p>\n<p>Splitting a Ruby String:\n<a href=\"https://code-maven.com/ruby-split\" rel=\"nofollow noreferrer\">https://code-maven.com/ruby-split</a></p>\n<pre><code>require 'pp'\nline_num=0\ntext=File.open('myfile.csv').read\ntext.each_line do |line|\ntextArray = line.split\ntextIWant = textArray[0]\nline_num = line_num + 1\n   print &quot;#{textIWant}&quot;\nend\n</code></pre>\n<p>In this code we open a text file, and read line by line. Each line we split into the text we want by choosing the text from the first column (zeroth item in the array), then print it.</p>\n<p>If you do not want the headers, when line_num = 0, add an if statement to not pick up the data. Even better use <code>unless</code>.</p>\n<p>Just rewrite a new file with your new data.</p>\n"}, {"tags": [], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "is_accepted": false, "score": 1, "last_activity_date": 1505840042, "creation_date": 1505840042, "answer_id": 46305906, "question_id": 46305279, "link": "https://stackoverflow.com/questions/46305279/how-to-remove-headers-and-second-column-in-csv-in-ruby/46305906#46305906", "title": "How to remove headers and second column in CSV in ruby?", "body": "<p>I wound up doing this. Is this kosher?</p>\n\n<pre><code>user_ids = []\n[]\nCSV.foreach(\"eds_users_sept15.csv\", headers:true) do |row|\n    user_ids &lt;&lt; row['user_id']\n end\n  nil\nuser_ids.count\n322101\n\nCSV.open('some_new_file.csv', 'w') do |c|\n    user_ids.each do |id|\n       c &lt;&lt; [id]\n    end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1505842028, "last_edit_date": 1505842028, "creation_date": 1505841433, "answer_id": 46306304, "question_id": 46305279, "link": "https://stackoverflow.com/questions/46305279/how-to-remove-headers-and-second-column-in-csv-in-ruby/46306304#46306304", "title": "How to remove headers and second column in CSV in ruby?", "body": "<p>I'm guessing that you plan to convert each string that precedes a comma to an integer. If so,</p>\n\n<pre><code>CSV.read(\"dataset.csv\").drop(1).map(:to_i)\n</code></pre>\n\n<p>is all you need. (For example, <code>\"131072,1\".to_i #=&gt; 131072</code>.)</p>\n\n<p>If you want strings, you could write</p>\n\n<pre><code>   CSV.read(\"dataset.csv\").drop(1).map { |s| s[/d+/] }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 62179, "user_id": 163203, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/354dbc60f05bbc3ea25cdf2c14540caf?s=128&d=identicon&r=PG", "display_name": "Harish Shetty", "link": "https://stackoverflow.com/users/163203/harish-shetty"}, "edited": false, "score": 0, "creation_date": 1510468148, "post_id": 46306387, "comment_id": 81442572, "body": "The 3rd method is supported by CSV library, i.e: <code>CSV.foreach(&#39;input.csv&#39;) do |line|</code>"}, {"owner": {"reputation": 1879, "user_id": 5955745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/309ya.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5955745/marco"}, "reply_to_user": {"reputation": 62179, "user_id": 163203, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/354dbc60f05bbc3ea25cdf2c14540caf?s=128&d=identicon&r=PG", "display_name": "Harish Shetty", "link": "https://stackoverflow.com/users/163203/harish-shetty"}, "edited": false, "score": 0, "creation_date": 1510480526, "post_id": 46306387, "comment_id": 81445080, "body": "@HarishShetty I used it in first method... Third method only shows <code>File</code> is way faster than <code>CSV</code>."}, {"owner": {"reputation": 62179, "user_id": 163203, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/354dbc60f05bbc3ea25cdf2c14540caf?s=128&d=identicon&r=PG", "display_name": "Harish Shetty", "link": "https://stackoverflow.com/users/163203/harish-shetty"}, "edited": false, "score": 0, "creation_date": 1510544383, "post_id": 46306387, "comment_id": 81464391, "body": "My fault, tunnel vision strikes again! I didn&#39;t read your option 1. Though the comparison between 1 and 3 would be fair with <code>headers: false</code> for option 1. Cost of creating hashes for each row adds up. To ignore headers, user can skip the first row."}], "tags": [], "owner": {"reputation": 1879, "user_id": 5955745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/309ya.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5955745/marco"}, "is_accepted": false, "score": 1, "last_activity_date": 1505842326, "last_edit_date": 1505842326, "creation_date": 1505841704, "answer_id": 46306387, "question_id": 46305279, "link": "https://stackoverflow.com/questions/46305279/how-to-remove-headers-and-second-column-in-csv-in-ruby/46306387#46306387", "title": "How to remove headers and second column in CSV in ruby?", "body": "<blockquote>\n  <p>I have 330,000 rows...</p>\n</blockquote>\n\n<p>So I guess speed matters, right?</p>\n\n<p>I took your method and the other 2 that was proposed, tested them on a 330,000 rows csv file and made a benchmark to show you something interesting.</p>\n\n<pre><code>require 'csv'\nrequire 'benchmark'\n\nBenchmark.bm(10) do |bm|\n    bm.report(\"Method 1:\") {\n        data = Array.new\n        CSV.foreach(\"input.csv\", headers:true) do |row|\n            data &lt;&lt; row['user_id']\n        end\n    }\n    bm.report(\"Method 2:\") {\n        data = CSV.read(\"input.csv\")[1 .. -1]\n        data.delete(\"is_user_unsubscribed\")\n    }\n    bm.report(\"Method 3:\") {\n        data = Array.new\n        File.open('input.csv').read.each_line do |line|\n            data &lt;&lt; line.split(',')[0]\n        end\n        data.shift # =&gt; remove headers\n    }\nend\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>                 user     system      total        real\nMethod 1:    3.110000   0.010000   3.120000 (  3.129409)\nMethod 2:    1.990000   0.010000   2.000000 (  2.004016)\nMethod 3:    0.380000   0.010000   0.390000 (  0.383700)\n</code></pre>\n\n<p>As you can see handling the CSV file as a simple text file, splitting the lines and pushing them into the array is <strong>~5 times faster</strong> than using CSV Module. Of course it has some disadvantages too; i.e., if you'll ever add columns in the input file you'll have to review the code.</p>\n\n<p>It's up to you if you prefer lightspeed code or easier scalability.</p>\n"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 0, "accepted_answer_id": 46305365, "answer_count": 5, "score": 2, "last_activity_date": 1505842326, "creation_date": 1505837787, "question_id": 46305279, "link": "https://stackoverflow.com/questions/46305279/how-to-remove-headers-and-second-column-in-csv-in-ruby", "title": "How to remove headers and second column in CSV in ruby?", "body": "<p>I have a CSV that looks like this:</p>\n\n<pre><code>user_id,is_user_unsubscribed\n131072,1\n7077888,1\n11010048,1\n12386304,1\n327936,1\n2228480,1\n6553856,1\n9830656,1\n10158336,1\n10486016,1\n10617088,1\n11010304,1\n11272448,1\n393728,1\n7012864,1\n8782336,1\n11338240,1\n11928064,1\n4326144,1\n8127232,1\n11862784,1\n</code></pre>\n\n<p>but I want the data to look like this:</p>\n\n<pre><code>131072\n7077888\n11010048\n12386304\n327936\n...\n</code></pre>\n\n<p>any ideas on what to do? I have 330,000 rows...</p>\n"}, {"tags": ["ruby", "chef-infra"], "owner": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505837786, "creation_date": 1505837786, "question_id": 46305277, "link": "https://stackoverflow.com/questions/46305277/ruby-function-in-chef-source-code-reads-argument-incorrectly", "title": "Ruby function in Chef source code reads argument incorrectly", "body": "<p>My code makes a function call <a href=\"https://github.com/chef/chef/blob/master/lib/chef/resource/package.rb\" rel=\"nofollow noreferrer\">in Chef</a> that takes in some parameters:</p>\n\n<pre><code>property :version, [ String, Array ]\n</code></pre>\n\n<p>The <a href=\"https://github.com/chef/chef/blob/master/lib/chef/mixin/properties.rb\" rel=\"nofollow noreferrer\">function</a> called is defined like this:</p>\n\n<pre><code>def property(name, type = NOT_PASSED, **options)\n      #below is debugging code I added\n      if name==:version\n        raise \"type: #{type}, options: #{options}, caller: #{caller}\"\n      end\n</code></pre>\n\n<p>The debugging code you see above, when executed, spits out some parameters and the call-stack:</p>\n\n<pre><code>type: {String=&gt;nil, Array=&gt;nil}, options: {}, caller: [\"[a-secret-path]/chef-12.9.38/lib/chef/resource/package.rb:38:in `&lt;class:Package&gt;'...\n</code></pre>\n\n<p>As you can see, even though the function call passes in [String, Array], the function interprets the \"type\" variable as {String => nil, Array => nil}. Why does this happen?</p>\n\n<h2>OPTIONAL READING BELOW</h2>\n\n<p>My hypotheses and what I've done to test them:</p>\n\n<p>1) I thought the property() function might be called from somewhere other than the place I identify. However, printing out the caller shows it is called from the line I cite: \"property :version, [ String, Array ]\"</p>\n\n<p>2) I thought the default argument for \"type\" might be interacting in a strange way with the \"double splat\" argument \"**options,\" so I wrote a test file:</p>\n\n<pre><code>def take_in_double_splat(name, type = NOT_PASSED, **options)\n  puts \"type: #{type}, options: #{options}\"\nend\n\ntake_in_double_splat :version, [ String, Array ]\n</code></pre>\n\n<p>Executing the file produces the expected output:</p>\n\n<pre><code>type: [String, Array], options: {}\n</code></pre>\n\n<p>Two final experiments I did are worth noting:</p>\n\n<p>1) Removing the default value from the argument in the Chef code fixes the problem, allowing us to read in [String, Array] rather than {String => nil, Array => nil}. I do this like so:</p>\n\n<pre><code>def property(name, type, **options)\n</code></pre>\n\n<p>2) Adding an argument to the function call also fixes the problem. For example: </p>\n\n<pre><code>property :version, [ String, Array ], random: 'hi'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "is_accepted": true, "score": 1, "last_activity_date": 1505835533, "creation_date": 1505835533, "answer_id": 46304545, "question_id": 46303903, "link": "https://stackoverflow.com/questions/46303903/rails-5-accepts-nested-attributes-for/46304545#46304545", "title": "Rails 5: accepts nested attributes for", "body": "<p>I had to add the controller to <code>routes.rb</code> <code>devise_for :users</code></p>\n\n<pre><code>devise_for :users, controllers: {registrations: 'users/registrations'}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 945, "user_id": 5269750, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/478621712312068/picture?type=large", "display_name": "Sai Ram Reddy", "link": "https://stackoverflow.com/users/5269750/sai-ram-reddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1505849044, "creation_date": 1505849044, "answer_id": 46308315, "question_id": 46303903, "link": "https://stackoverflow.com/questions/46303903/rails-5-accepts-nested-attributes-for/46308315#46308315", "title": "Rails 5: accepts nested attributes for", "body": "<p>You can use <strong><em>cocoon</em></strong> gem for nested attributes. It will make handling nested attributes lot more easier</p>\n"}], "owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 46304545, "answer_count": 2, "score": 0, "last_activity_date": 1505849044, "creation_date": 1505833610, "last_edit_date": 1505845309, "question_id": 46303903, "link": "https://stackoverflow.com/questions/46303903/rails-5-accepts-nested-attributes-for", "title": "Rails 5: accepts nested attributes for", "body": "<p>I'm trying to implement <code>accepts_nested_attributes_for</code> on my app. When I add  <code>accepts_nested_attributes_for :account</code> to the <code>user.rb</code> the nested fields disappear. When I delete <code>accepts_nested_attributes_for :account</code> the fields appear but no data is being saved when I click on <code>submit</code>.</p>\n\n<p>Any ideas why this is happening?</p>\n\n<p>I have two models with appropriate associations added: </p>\n\n<p>user.rb</p>\n\n<pre><code>has_one :account\nhas_many :items\naccepts_nested_attributes_for :account\n</code></pre>\n\n<p>account.rb</p>\n\n<pre><code>belongs_to :user\n</code></pre>\n\n<p>app/controllers/users/registrations.controller.rb</p>\n\n<pre><code>before_action :configure_permitted_parameters, if: :devise_controller?\n\ndef new\n\n  build_resource({})\n  resource.build_account\n  respond_with self.resource\n  session[:registration_params] = request.query_parameters\nend\n\nprotected\n\n   def configure_permitted_parameters\n     devise_parameter_sanitizer.permit(:sign_up) { |u|\n       u.permit(:email, :password, :password_confirmation, :remember_me,\n                :account_attributes =&gt; [:first_name, :last_name, :buisness_name,\n                                    :buisness_description, :web_site, :phone_number,\n                                    :street, :city, :state, :zip_code, :country])\n }\n   end\n</code></pre>\n\n<p>new.html.erb</p>\n\n<pre><code>&lt;h2&gt;Sign up&lt;/h2&gt;\n\n&lt;%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :email %&gt;&lt;br /&gt;\n    &lt;%= f.email_field :email, autofocus: true %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :password %&gt;\n    &lt;% if @minimum_password_length %&gt;\n    &lt;em&gt;(&lt;%= @minimum_password_length %&gt; characters minimum)&lt;/em&gt;\n    &lt;% end %&gt;&lt;br /&gt;\n    &lt;%= f.password_field :password, autocomplete: \"off\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :password_confirmation %&gt;&lt;br /&gt;\n    &lt;%= f.password_field :password_confirmation, autocomplete: \"off\" %&gt;\n &lt;/div&gt;\n\n&lt;%= f.fields_for :account do |form| %&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :first_name %&gt;\n      &lt;%= form.text_field :first_name, id: :account_first_name %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :last_name %&gt;\n      &lt;%= form.text_field :last_name, id: :account_last_name %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :buisness_name %&gt;\n      &lt;%= form.text_field :buisness_name, id: :account_buisness_name %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :buisness_description %&gt;\n      &lt;%= form.text_field :buisness_description, id: :account_buisness_description %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :web_site %&gt;\n      &lt;%= form.text_field :web_site, id: :account_web_site %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :phone_number %&gt;\n      &lt;%= form.text_field :phone_number, id: :account_phone_number %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :street %&gt;\n      &lt;%= form.text_field :street, id: :account_street %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :city %&gt;\n      &lt;%= form.text_field :city, id: :account_city %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :state %&gt;\n      &lt;%= form.text_field :state, id: :account_state %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :zip_code %&gt;\n      &lt;%= form.text_field :zip_code, id: :account_zip_code %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= form.label :country %&gt;\n      &lt;%= form.text_field :country, id: :account_country %&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;\n\n &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit \"Sign up\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n\n"}, {"tags": ["ruby", "csv", "nokogiri", "watir"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 2, "creation_date": 1505831959, "post_id": 46303228, "comment_id": 79568945, "body": "CSV files are not really designed for images. You might want to look at generating Excel (or similar) files instead."}, {"owner": {"reputation": 558, "user_id": 6215116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b198ac2a78c0f380fca7cc3dbc8a270?s=128&d=identicon&r=PG", "display_name": "Michal Polovka", "link": "https://stackoverflow.com/users/6215116/michal-polovka"}, "edited": false, "score": 1, "creation_date": 1505832119, "post_id": 46303228, "comment_id": 79569069, "body": "You can insert image in base64 text format, however, graphical way is not possible with CSV."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1505832129, "post_id": 46303228, "comment_id": 79569074, "body": "CSV is a text format. It can&#39;t have any images. You could put image urls, though."}, {"owner": {"reputation": 65, "user_id": 8125349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/swnsg.jpg?s=128&g=1", "display_name": "Vincent Cheloudiakoff", "link": "https://stackoverflow.com/users/8125349/vincent-cheloudiakoff"}, "edited": false, "score": 0, "creation_date": 1505832445, "post_id": 46303228, "comment_id": 79569317, "body": "Thank you for your fast answer, that&#39;s help me a lot !"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1505837563, "post_id": 46303228, "comment_id": 79572613, "body": "If you&#39;re doing this in an <b>xlsx</b> file (not CSV), then this answer will probably help: <a href=\"https://stackoverflow.com/a/10721392/1954610\">stackoverflow.com/a/10721392/1954610</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "is_accepted": false, "score": 0, "last_activity_date": 1505869830, "creation_date": 1505869830, "answer_id": 46311781, "question_id": 46303228, "link": "https://stackoverflow.com/questions/46303228/insert-image-into-a-csv-column-ruby/46311781#46311781", "title": "Insert image into a csv column ruby", "body": "<p>A CSV (Comma Separated Values) file is a TEXT file which as the name implies has various values separated by commas, expressed using plain ASCII, or sometimes unicode.  It is intended as a light weight way to transfer tabular data between different computer systems or programs.  You can use it to spit out a table in a database, or the VALUES in something like a spreadsheet.  The normal convention is for the first row(line) of the file to contain names or labels that represent what that column contains, and then data in the subsequent rows.</p>\n\n<p>As such, there really is no practical way to embed an image within a CSV file.  This is not a limitation of Ruby or Watir, but a limitation of textfiles which spans pretty much all languages and operating systems.</p>\n\n<p>To do what you want you would be better off to save the images into a specific directory using unique filenames and insert those filenames into the CSV file.</p>\n"}], "owner": {"reputation": 65, "user_id": 8125349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/swnsg.jpg?s=128&g=1", "display_name": "Vincent Cheloudiakoff", "link": "https://stackoverflow.com/users/8125349/vincent-cheloudiakoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505869830, "creation_date": 1505831704, "last_edit_date": 1505831961, "question_id": 46303228, "link": "https://stackoverflow.com/questions/46303228/insert-image-into-a-csv-column-ruby", "title": "Insert image into a csv column ruby", "body": "<p>I'm currently doing a crawler for a website, and my goal is to have a CSV, with a name in the first column and an image the second one, which is inserted with a Ruby script using the <code>CSV#open</code> method.</p>\n\n<p>I have already used this method but I don't know, and I don't find information about the problematic that is to insert an image into a column.</p>\n\n<p>Is it really possible? If not, which functionality would you use to have a list with string + image after crawling?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 517, "user_id": 796283, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6454292803d9f216fc8c65b9e5715850?s=128&d=identicon&r=PG", "display_name": "Shobhit", "link": "https://stackoverflow.com/users/796283/shobhit"}, "edited": false, "score": 0, "creation_date": 1505831224, "post_id": 46303007, "comment_id": 79568444, "body": "What seems to be the problem? This should work."}, {"owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "reply_to_user": {"reputation": 517, "user_id": 796283, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6454292803d9f216fc8c65b9e5715850?s=128&d=identicon&r=PG", "display_name": "Shobhit", "link": "https://stackoverflow.com/users/796283/shobhit"}, "edited": false, "score": 0, "creation_date": 1505833511, "post_id": 46303007, "comment_id": 79570077, "body": "Could not parse that string properly"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1505831249, "creation_date": 1505831249, "answer_id": 46303063, "question_id": 46303007, "link": "https://stackoverflow.com/questions/46303007/how-to-split-the-i18n-keys-over-multiple-lines/46303063#46303063", "title": "How to split the I18n keys over multiple lines", "body": "<p>Try use heredoc </p>\n\n<pre><code>t_key = &lt;&lt;-KEY\n  group1\\\n  .group2\\\n  .bla_bla_bla_bla\nKEY\nerrors.add(:model, I18n.t(t_key))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2072, "user_id": 853065, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aa14452cb8fbbc5b22c10c567ce710d8?s=128&d=identicon&r=PG", "display_name": "yoones", "link": "https://stackoverflow.com/users/853065/yoones"}, "is_accepted": true, "score": 1, "last_activity_date": 1505831323, "creation_date": 1505831323, "answer_id": 46303090, "question_id": 46303007, "link": "https://stackoverflow.com/questions/46303007/how-to-split-the-i18n-keys-over-multiple-lines/46303090#46303090", "title": "How to split the I18n keys over multiple lines", "body": "<p>I would go for a simple:</p>\n\n<pre><code>errors.add(:model, I18n.t(\"group1\" \\\n                         \".group2\" \\\n                         \".bla_bla_bla_bla\"))\n</code></pre>\n\n<p>But then you could also go the <code>join</code> way:</p>\n\n<pre><code>errors.add(:model, I18n.t([\"group1\",\n                           \"group2\",\n                           \"bla_bla_bla_bla\"].join(\".\")))\n</code></pre>\n\n<p>It really depends on the specific error rubocop gives you.</p>\n"}, {"tags": [], "owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1505842241, "creation_date": 1505842241, "answer_id": 46306549, "question_id": 46303007, "link": "https://stackoverflow.com/questions/46303007/how-to-split-the-i18n-keys-over-multiple-lines/46306549#46306549", "title": "How to split the I18n keys over multiple lines", "body": "<p>Alternative you can use new syntax of <code>scope</code> for I18n</p>\n\n<p><code>I18n.t(:blah_blah_blash, scope: [:group1, :group2])</code></p>\n"}], "owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 46303090, "answer_count": 3, "score": 0, "last_activity_date": 1505842241, "creation_date": 1505831076, "question_id": 46303007, "link": "https://stackoverflow.com/questions/46303007/how-to-split-the-i18n-keys-over-multiple-lines", "title": "How to split the I18n keys over multiple lines", "body": "<p>I want to do something like this</p>\n\n<pre><code>errors.add(:model, I18n.t(\"group1\\\n                         .group2\\\n                         .bla_bla_bla_bla\"))\n</code></pre>\n\n<p>The reason I want to do this is rubocop is giving me line length is too long, So I would like to split it over multiple lines</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash", "multiple-assignment"], "comments": [{"owner": {"reputation": 517, "user_id": 796283, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6454292803d9f216fc8c65b9e5715850?s=128&d=identicon&r=PG", "display_name": "Shobhit", "link": "https://stackoverflow.com/users/796283/shobhit"}, "edited": false, "score": 0, "creation_date": 1505830819, "post_id": 46302832, "comment_id": 79568159, "body": "How many keys do you have?"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1505830907, "creation_date": 1505830907, "answer_id": 46302947, "question_id": 46302832, "link": "https://stackoverflow.com/questions/46302832/is-it-possible-to-use-parallel-assignment-for-keys-in-ruby-hash/46302947#46302947", "title": "Is it possible to use parallel assignment for keys in Ruby hash?", "body": "<p>What about this one?</p>\n\n<pre><code>sample.merge!(alpha: 0, beta: 0, gamma: 0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505835795, "post_id": 46302956, "comment_id": 79571542, "body": "Since <code>0</code> is immutable, it&#39;s safe to use <code>Hash.new(0)</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505836929, "post_id": 46302956, "comment_id": 79572256, "body": "Ah yep, I forgot that&#39;s valid too. Thanks @Stefan, I updated the answer."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1505836817, "last_edit_date": 1505836817, "creation_date": 1505830924, "answer_id": 46302956, "question_id": 46302832, "link": "https://stackoverflow.com/questions/46302832/is-it-possible-to-use-parallel-assignment-for-keys-in-ruby-hash/46302956#46302956", "title": "Is it possible to use parallel assignment for keys in Ruby hash?", "body": "<p>Firstly, this does not work as you expect:</p>\n\n<pre><code>sample = {}\nsample[:alpha], sample[:beta], sample[:gamma] = 0\n</code></pre>\n\n<p>This will result in:</p>\n\n<pre><code>sample == { alpha: 0, beta: nil, gamma: nil }\n</code></pre>\n\n<p>To get the desired result, you could instead use <a href=\"https://stackoverflow.com/a/2895989/1954610\">parallel assignment</a>:</p>\n\n<pre><code>sample[:alpha], sample[:beta], sample[:gamma] = 0, 0, 0\n</code></pre>\n\n<p>Or, <a href=\"https://ruby-doc.org/core/Array.html#method-i-each\" rel=\"nofollow noreferrer\">loop through the keys</a> to assign each one separately:</p>\n\n<pre><code>[:alpha, :beta, :gamma].each { |key| sample[key] = 0 }\n</code></pre>\n\n<p>Or, <a href=\"https://apidock.com/ruby/Hash/merge!\" rel=\"nofollow noreferrer\">merge</a> the original hash with your new attributes:</p>\n\n<pre><code>sample.merge!(alpha: 0, beta: 0, gamma: 0)\n</code></pre>\n\n<hr>\n\n<p>Depending on what you're actually trying to do here, you may wish to consider giving your hash a <a href=\"https://ruby-doc.org/core/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">default value</a>. For example:</p>\n\n<pre><code>sample = Hash.new(0)\n\nputs sample[:alpha] # =&gt; 0\nsample[:beta] += 1  # Valid since this defaults to 0, not nil\n\nputs sample         # =&gt; {:beta=&gt;1}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 517, "user_id": 796283, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6454292803d9f216fc8c65b9e5715850?s=128&d=identicon&r=PG", "display_name": "Shobhit", "link": "https://stackoverflow.com/users/796283/shobhit"}, "is_accepted": false, "score": 0, "last_activity_date": 1505831048, "creation_date": 1505831048, "answer_id": 46302994, "question_id": 46302832, "link": "https://stackoverflow.com/questions/46302832/is-it-possible-to-use-parallel-assignment-for-keys-in-ruby-hash/46302994#46302994", "title": "Is it possible to use parallel assignment for keys in Ruby hash?", "body": "<p>There is nothing like the thing you've described but you can run a loop with all the and assign the value.</p>\n\n<pre><code>keys = [:alpha, :beta, :gamma, :theta, ...]\nkeys.each {|key| sample[key] = 0}\n</code></pre>\n\n<p>Reduces the number of extra keystrokes, and very easy to change the keys array.</p>\n"}], "owner": {"reputation": 107, "user_id": 6459313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7981367d97dee6535ab7fb25d428e842?s=128&d=identicon&r=PG&f=1", "display_name": "Dwarakanath Thoppe", "link": "https://stackoverflow.com/users/6459313/dwarakanath-thoppe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 0, "accepted_answer_id": 46302956, "answer_count": 3, "score": 0, "last_activity_date": 1505836817, "creation_date": 1505830573, "last_edit_date": 1505831221, "question_id": 46302832, "link": "https://stackoverflow.com/questions/46302832/is-it-possible-to-use-parallel-assignment-for-keys-in-ruby-hash", "title": "Is it possible to use parallel assignment for keys in Ruby hash?", "body": "<p>Given that it is an immutable object, ruby allows paraller assignments as this: </p>\n\n<pre><code>sample[:alpha] = sample[:beta] = sample[:gamma] = 0\n</code></pre>\n\n<p>But is there any other simple way to do this? , something like :</p>\n\n<pre><code>sample[alpha:, beta:, gamma: =&gt; 0]\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>sample[:alpha, :beta, :gamma] =&gt; 0, 0, 0 \n</code></pre>\n"}, {"tags": ["ruby", "unit-testing", "sinatra", "rack-test"], "answers": [{"tags": [], "owner": {"reputation": 581, "user_id": 1743995, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/43e6ac349c2f8d8bd9f8b0ab97b24d83?s=128&d=identicon&r=PG", "display_name": "codeadventurer", "link": "https://stackoverflow.com/users/1743995/codeadventurer"}, "is_accepted": true, "score": 0, "last_activity_date": 1505838336, "creation_date": 1505838336, "answer_id": 46305441, "question_id": 46302386, "link": "https://stackoverflow.com/questions/46302386/mocking-a-post-request-with-binary-data-in-sinatra/46305441#46305441", "title": "Mocking a post request with binary data in Sinatra", "body": "<p>The answer is that the only way to post the body is where I was adding the params in the rack test helper. I needed to take the <code>params</code> and move them into the query string of the URL in the request, and then only add the binary as the <code>body</code> of the <code>post</code> request in the test helper. </p>\n\n<pre><code>  let(:url) { \"http://example.com/post_data?host=&gt;#{host}&amp;verification=#{verification}\" } \n  it \"should return a json response\" do\n    post(url, my_binary)\n\n    expect(last_response.status).to eq(200)\n    expect(last_response.content_type).to eq(\"application/json\")\n  end\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 1743995, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/43e6ac349c2f8d8bd9f8b0ab97b24d83?s=128&d=identicon&r=PG", "display_name": "codeadventurer", "link": "https://stackoverflow.com/users/1743995/codeadventurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 46305441, "answer_count": 1, "score": 0, "last_activity_date": 1505838336, "creation_date": 1505829347, "question_id": 46302386, "link": "https://stackoverflow.com/questions/46302386/mocking-a-post-request-with-binary-data-in-sinatra", "title": "Mocking a post request with binary data in Sinatra", "body": "<p>I have an endpoint in my Sinatra application that will be receiving binary data as part of the body. The other application sending it data will have a Faraday request that looks like this:</p>\n\n<pre><code>    connection = Faraday.new(url: \"https://example.com/post_data\") do |conn|\n      conn.request :multipart\n      conn.adapter :net_http\n      conn.headers['Content-Type'] = 'octet/stream'\n    end\n\n    @response ||= connection.post do |req|\n      req.params = { :host =&gt; host,\n                     :verification =&gt; \"false\"}\n      req.body = my_base64_encoded_binary\n    end\n</code></pre>\n\n<p>Then, in Sinatra, I will have an endpoint that receives those request parameters and binary data and passes it along to a model, like so:</p>\n\n<pre><code>post '/post_data' do\n  request.body.rewind\n  payload = request.body.read\n\n  raise Sinatra::NotFound unless payload and params[:host]\n  output = MyOutput.new(params, payload)\n\n  content_type 'application/json'\n  body output.data\nend\n</code></pre>\n\n<p>When I try to test this endpoint using <code>Rack::Test</code> helpers, I end up in a weird situation. I can't seem to create the proper mock in order to test this endpoint properly. Based on some manual testing with PostMan, I'm pretty certain my endpoint works properly. It's just the test that's holding me up. Here is the spec:</p>\n\n<pre><code> it \"should return a json response\" do\n    post(url, :host =&gt; host, :verification =&gt; \"false\") do |req|\n      req.body = [my_binary]\n      req.content_type = \"application/octet-stream\"\n    end\n\n    expect(last_response.status).to eq(200)\n    expect(last_response.content_type).to eq(\"application/json\")\n  end\n</code></pre>\n\n<p>And when I inspect what the incoming request looks like in the test, it does not contain a proper body. <code>params</code> is properly set to the <code>host</code> and <code>verification</code> settings I set, but the body is also being set to the params (inspected through <code>payload = request.body.read</code>) instead of the binary.</p>\n\n<p>Is there a different way to set up the mock so that the binary properly is set to the body of the request, and the parameters are still set to the request parameters properly?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 4882906, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/J8X5A.jpg?s=128&g=1", "display_name": "Bernardo Loureiro", "link": "https://stackoverflow.com/users/4882906/bernardo-loureiro"}, "edited": false, "score": 0, "creation_date": 1505830524, "post_id": 46302444, "comment_id": 79567978, "body": "Great! Did you name it as <code>counter</code> instead of <code>count</code> to avoid reserved methods? Just curious."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 313, "user_id": 4882906, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/J8X5A.jpg?s=128&g=1", "display_name": "Bernardo Loureiro", "link": "https://stackoverflow.com/users/4882906/bernardo-loureiro"}, "edited": false, "score": 0, "creation_date": 1505830599, "post_id": 46302444, "comment_id": 79568020, "body": "I did not think about that but it&#39;s probably a good idea avoid count :)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 3, "last_activity_date": 1505829869, "last_edit_date": 1505829869, "creation_date": 1505829489, "answer_id": 46302444, "question_id": 46302355, "link": "https://stackoverflow.com/questions/46302355/rails-5-cant-order-after-group-and-count/46302444#46302444", "title": "Rails 5: can&#39;t order after group and count", "body": "<p>It works but your subscriber objects don't have that aggregated field (and you are not extracting the others). Give it a name</p>\n\n<pre><code>subscribers = Subscriber.select(\"email, COUNT(*) AS counter\").group(:email).order(\"COUNT (*) desc\")\n</code></pre>\n\n<p>Extract these fields</p>\n\n<pre><code>subscribers.each { |s| puts s.email, s.counter }\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 4882906, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/J8X5A.jpg?s=128&g=1", "display_name": "Bernardo Loureiro", "link": "https://stackoverflow.com/users/4882906/bernardo-loureiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 46302444, "answer_count": 1, "score": 1, "last_activity_date": 1505829869, "creation_date": 1505829256, "question_id": 46302355, "link": "https://stackoverflow.com/questions/46302355/rails-5-cant-order-after-group-and-count", "title": "Rails 5: can&#39;t order after group and count", "body": "<p>In my <code>subscribers</code> table I have duplicate emails, so I want to count these. I'm doing this in the Rails console:</p>\n\n<p><code>Subscriber.select(\"email, count(*)\").group(:email).order(\"count (*) desc\")</code></p>\n\n<p>This results in the following query to my <code>PostgreSQL</code> db:</p>\n\n<p><code>SELECT email, count(*) FROM \"subscribers\" GROUP BY \"subscribers\".\"email\" ORDER BY count (*) desc</code></p>\n\n<p>The strange thing is, although this query works fine when run directly from the db, it doesn't work in the Rails console, which returns:</p>\n\n<p><code>#&lt;ActiveRecord::Relation [#&lt;Subscriber id: nil, email: \"a@a.com\"&gt;, #&lt;Subscriber id: nil, email: \"b@b.com\"&gt;, #&lt;Subscriber id: nil, email: \"c@c.com\"&gt;]&gt;</code></p>\n\n<p>Any ideas why?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1505827902, "post_id": 46301705, "comment_id": 79566102, "body": "Right now your code is clear in what it does. How do you benefit from less code? Less code != Better code. You want code to be clear and maintainable. If you sacrifice that to save a few lines of code (or in this case: characters of code), you are only going to give your future self (or worse, someone else) problems when they need to maintain or change your code."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505828295, "post_id": 46301705, "comment_id": 79566395, "body": "You should post this on <a href=\"https://codereview.stackexchange.com\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 91, "user_id": 8385606, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10210010301119748/picture?type=large", "display_name": "Brian Ruff", "link": "https://stackoverflow.com/users/8385606/brian-ruff"}, "edited": false, "score": 0, "creation_date": 1505847662, "post_id": 46301705, "comment_id": 79577764, "body": "True Dbz, I had not considered that."}], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 2, "last_activity_date": 1505830327, "last_edit_date": 1505830327, "creation_date": 1505828709, "answer_id": 46302153, "question_id": 46301705, "link": "https://stackoverflow.com/questions/46301705/improved-way-make-sentence-using-ruby-hashes/46302153#46302153", "title": "Improved Way Make sentence using Ruby Hashes", "body": "<p>If you make the <code>Hash</code> keys symbols e.g.</p>\n\n<pre><code>person = {name: \"Randy\", \n          age: 28, \n          hometown: \"Jamesville\", \n          favorite_food: \"Chicken\"}\n</code></pre>\n\n<p>You could use <a href=\"https://ruby-doc.org/core-2.2.0/Kernel.html#method-i-sprintf\" rel=\"nofollow noreferrer\"><code>Kernel#sprintf</code></a>  instead e.g. </p>\n\n<pre><code>sentence = \"I am %{name}. I am %{age}-years-old.\n       I'm from %{hometown} and my favorite food is %{favorite_food}\"\nsprintf sentence, person\n#=&gt;  \"I am Randy. I am 28-years-old.\\nI'm from Jamesville and my favorite food is Chicken\"\n</code></pre>\n\n<p>or you could use <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-25\" rel=\"nofollow noreferrer\"><code>String#%</code></a></p>\n\n<pre><code>puts sentence % person\n# I am Randy. I am 28-years-old.\n#       I'm from Jamesville and my favorite food is Chicken\n#=&gt; nil\n</code></pre>\n\n<p>both of these methods rely on symbolized keys though (which by the way is the preferred syntax for a <code>Hash</code>) </p>\n"}], "owner": {"reputation": 91, "user_id": 8385606, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10210010301119748/picture?type=large", "display_name": "Brian Ruff", "link": "https://stackoverflow.com/users/8385606/brian-ruff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 46302153, "answer_count": 1, "score": 0, "last_activity_date": 1505830327, "creation_date": 1505827511, "last_edit_date": 1505829026, "question_id": 46301705, "link": "https://stackoverflow.com/questions/46301705/improved-way-make-sentence-using-ruby-hashes", "title": "Improved Way Make sentence using Ruby Hashes", "body": "<p>I am creating a hash that contain data related to Name, Age, Hometown, and Favorite Food. I am taking that information and then making a sentence out of it. I have successfully got my code to work, yet I wonder if their is a way to do it that is shorter.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>person = {\"Name\" =&gt; \"Randy\", \"Age\" =&gt; 28, \"Hometown\" =&gt; \"Jamesville\", \n\"Favorite Food\" =&gt; \"Chicken\"}\n\nputs \"I am #{person.fetch(\"Name\")}. I am #{person.fetch(\"Age\")}-years-old. \nI'm from #{person.fetch(\"Hometown\")} and my favorite food is #\n{person.fetch(\"Favorite Food\")}\"\n</code></pre>\n\n<p>Which will print</p>\n\n<pre><code>I am Randy. I am 28-years-old. I'm from Jamesville and my favorite food is \nChicken.\n</code></pre>\n"}, {"tags": ["ruby", "pdf", "prawn"], "answers": [{"tags": [], "owner": {"reputation": 373, "user_id": 1482916, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/029830d20670653e572da07f32226659?s=128&d=identicon&r=PG", "display_name": "Florent L.", "link": "https://stackoverflow.com/users/1482916/florent-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1506328801, "creation_date": 1506328801, "answer_id": 46400937, "question_id": 46301390, "link": "https://stackoverflow.com/questions/46301390/bounding-box-across-multiple-pages-with-prawn-pdf/46400937#46400937", "title": "Bounding box across multiple pages with Prawn PDF", "body": "<p>I failed to do that with boundig boxes. May be this is not the best solution, but you can do this with tables :</p>\n\n<pre><code>data = []\n500.times do |i|\n    data.push [i.to_s]\nend\n\ntable(data, width: bounds.width) do |t|\n  t.cells.border_width = 0 # We don't want to see a table\n  t.before_rendering_page do |page|\n    page.row(0).border_top_width = 1\n    page.row(-1).border_bottom_width = 1\n    page.column(0).border_left_width = 1\n    page.column(-1).border_right_width = 1\n  end\nend\n</code></pre>\n\n<p>source : <a href=\"http://prawnpdf.org/prawn-table-manual.pdf\" rel=\"nofollow noreferrer\">http://prawnpdf.org/prawn-table-manual.pdf</a> (page 17)</p>\n\n<p>Check your margins to have the continuation on the top of the next page</p>\n"}, {"tags": [], "owner": {"reputation": 1247, "user_id": 165387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8625424680d8f2d2d94380639b1a689?s=128&d=identicon&r=PG", "display_name": "dmkash", "link": "https://stackoverflow.com/users/165387/dmkash"}, "is_accepted": false, "score": 1, "last_activity_date": 1507414902, "creation_date": 1507414902, "answer_id": 46625674, "question_id": 46301390, "link": "https://stackoverflow.com/questions/46301390/bounding-box-across-multiple-pages-with-prawn-pdf/46625674#46625674", "title": "Bounding box across multiple pages with Prawn PDF", "body": "<p>You may be looking for <a href=\"http://www.rubydoc.info/github/sandal/prawn/Prawn%2FDocument%3Aspan\" rel=\"nofollow noreferrer\"><code>span</code></a>:</p>\n\n<pre><code>def to_pdf\n  pdf.move_down 200\n\n  2.times do\n    pdf.span(pdf.bounds.width) do\n      pdf.text (50.times.map { |i| i.to_s }.join(\"\\n\"))\n      pdf.stroke_bounds\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 1467848, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d984c27d3345be31a07a0de84215e218?s=128&d=identicon&r=PG", "display_name": "Samuel Sim&#245;es", "link": "https://stackoverflow.com/users/1467848/samuel-sim%c3%b5es"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1357, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1507414902, "creation_date": 1505826617, "question_id": 46301390, "link": "https://stackoverflow.com/questions/46301390/bounding-box-across-multiple-pages-with-prawn-pdf", "title": "Bounding box across multiple pages with Prawn PDF", "body": "<p>I'm trying to create a document with Prawn Ruby PDF generator, but I'm facing the following problem:</p>\n\n<p>The image below shows what structure I'm trying to do.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Hsdj7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Hsdj7.png\" alt=\"enter image description here\"></a></p>\n\n<p>And this is the example code that tries to mimics my real scenario with the way that I'm trying to achieve this. The <code>2.times</code> and <code>(50.times.map { |i| i.to_s }.join(\"\\n\"))</code> mimics dynamic data.</p>\n\n<pre><code>require 'prawn'\n\nclass MyPdf\n  def self.to_pdf(*args)\n    new(*args).to_pdf\n  end\n\n  def to_pdf\n    pdf.move_down 200\n\n    2.times do\n      pdf.bounding_box(\n        [0, pdf.cursor],\n        width: pdf.bounds.width\n      ) do\n        pdf.text (50.times.map { |i| i.to_s }.join(\"\\n\"))\n        pdf.stroke_bounds\n      end\n    end\n\n    pdf\n  end\n\n  def pdf\n    @pdf ||= Prawn::Document.new(page_size: 'A4')\n  end\nend\n</code></pre>\n\n<p>But I'm having a lot of trouble with the dynamic bounding box placing.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hHTaa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hHTaa.png\" alt=\"enter image description here\"></a></p>\n\n<p>Do you people know a way to achieve this with or without bounding boxes?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1505824853, "post_id": 46300596, "comment_id": 79563699, "body": "You can directly call .where method on model. Why again you are defining a method for it?"}, {"owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1507633684, "post_id": 46300596, "comment_id": 80278586, "body": "@user2950593 if the answer was fine, you can close this question by choosing it. If you have any further doubt, please comment"}], "answers": [{"comments": [{"owner": {"reputation": 6386, "user_id": 2950593, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c2a48d4e4bc7b3acde3023813cec112b?s=128&d=identicon&r=PG&f=1", "display_name": "user2950593", "link": "https://stackoverflow.com/users/2950593/user2950593"}, "edited": false, "score": 0, "creation_date": 1505825805, "post_id": 46300753, "comment_id": 79564403, "body": "Thanks! another quetion: how do I define method for instance of model? For example I have <code>cr= ConversionRate.new;  cr.param = &quot;123&quot;; I want to write cr.find_another_param</code>"}, {"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1505826250, "post_id": 46300753, "comment_id": 79564742, "body": "Or <code>def self.find_something(param)</code>"}, {"owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1505826683, "post_id": 46300753, "comment_id": 79565107, "body": "I guess that this is another question.. it would be a little confusing to add to the same answer. You can close this one and open another to keep the topic distinguished"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1505839634, "post_id": 46300753, "comment_id": 79573704, "body": "@mabe02 - what&#39;s the advantage of the singleton method, rather than using a standard class method (i.e. @mahemoff&#39;s <code>def self.find_something </code>) or your scope? Asking out of curiosity.... not suggesting you&#39;re wrong or anything."}, {"owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1505912899, "post_id": 46300753, "comment_id": 79606551, "body": "this pretty outdated answer provides a good overview <a href=\"https://stackoverflow.com/a/11816412/5687152\">stackoverflow.com/a/11816412/5687152</a> With <code>scope</code> you return a subset of an ActiveRecord::Relation, with a self.something method you can return what you prefer. I prefer to enclose class methods inside <code>class &lt;&lt; self ; end</code> for clarity, but there is no difference with several <code>def self.something; end</code>"}, {"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1505914106, "post_id": 46300753, "comment_id": 79607455, "body": "<code>class &lt;&lt; self</code> can be useful if you want to group several class methods together. (I do find Ruby&#39;s <code>class &lt;&lt;</code> syntax conceptually weird and confusing though, just my opinion.)"}, {"owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "reply_to_user": {"reputation": 6386, "user_id": 2950593, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c2a48d4e4bc7b3acde3023813cec112b?s=128&d=identicon&r=PG&f=1", "display_name": "user2950593", "link": "https://stackoverflow.com/users/2950593/user2950593"}, "edited": false, "score": 0, "creation_date": 1505920696, "post_id": 46300753, "comment_id": 79612429, "body": "@user2950593 can we consider your problem solved? In case, you can tick this answer"}], "tags": [], "owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "is_accepted": false, "score": 2, "last_activity_date": 1505824947, "creation_date": 1505824947, "answer_id": 46300753, "question_id": 46300596, "link": "https://stackoverflow.com/questions/46300596/write-controllers-code-in-model-rails/46300753#46300753", "title": "write controllers code in model rails", "body": "<p>It seems that you have already found your solution:</p>\n\n<pre><code>class ConversionRate &lt; ActiveRecord::Base\n class &lt;&lt; self\n    def find_something(param)\n     where(:param=&gt; param)\n    end\n  end\nend\n</code></pre>\n\n<p>An alternative could be to use a <a href=\"http://guides.rubyonrails.org/active_record_querying.html#scopes\" rel=\"nofollow noreferrer\">scope</a>:</p>\n\n<pre><code>class ConversionRate &lt; ActiveRecord::Base\n  scope :find_something, -&gt;(param) { where(param: param) }\nend\n</code></pre>\n\n<p>Then you can call it from the controller like <code>ConversionRate.find_something(params)</code></p>\n\n<p>I would encourage the first approach if you need to perform some validation on your <code>param</code>, otherwise the second is very straightforward.</p>\n"}], "owner": {"reputation": 6386, "user_id": 2950593, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c2a48d4e4bc7b3acde3023813cec112b?s=128&d=identicon&r=PG&f=1", "display_name": "user2950593", "link": "https://stackoverflow.com/users/2950593/user2950593"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505831172, "creation_date": 1505824500, "last_edit_date": 1505831172, "question_id": 46300596, "link": "https://stackoverflow.com/questions/46300596/write-controllers-code-in-model-rails", "title": "write controllers code in model rails", "body": "<p>I have a <code>ConversionRate</code> model </p>\n\n<pre><code>class ConversionRate &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>I want to move to model my controller method <code>find_something</code></p>\n\n<pre><code>class ConversionRatesController &lt; ActionController::Base\n  #....\n  def find_something (param)\n    rate = ConversionRate.where(:param=&gt; param)\n  end\n end\n</code></pre>\n\n<p>How do I do this? I am thinking of something like this</p>\n\n<pre><code>class ConversionRate &lt; ActiveRecord::Base\n def self.find_something(param)\n   return self.where(:param=&gt; param)\nend\n</code></pre>\n"}, {"tags": ["ruby", "google-chrome", "selenium", "capybara"], "comments": [{"owner": {"reputation": 5470, "user_id": 2568849, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/UxtGh.png?s=128&g=1", "display_name": "Mesut GUNES", "link": "https://stackoverflow.com/users/2568849/mesut-gunes"}, "edited": false, "score": 0, "creation_date": 1505825006, "post_id": 46300397, "comment_id": 79563808, "body": "I think there is not <code>loggingPrefs</code> option. What do yo want to do?"}, {"owner": {"reputation": 201, "user_id": 8626450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200e77d7cdbc1fed17289ffea98bbbd1?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek Khurana", "link": "https://stackoverflow.com/users/8626450/vivek-khurana"}, "reply_to_user": {"reputation": 5470, "user_id": 2568849, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/UxtGh.png?s=128&g=1", "display_name": "Mesut GUNES", "link": "https://stackoverflow.com/users/2568849/mesut-gunes"}, "edited": false, "score": 0, "creation_date": 1505825373, "post_id": 46300397, "comment_id": 79564069, "body": "I am trying to get console logs using Ruby &amp; Capybara/Selenium. Someone suggested to use this method, but     browser_options = ::Selenium::WebDriver::Chrome::Options.new gives out the error as stated in the question. I am able to access <code>Selenium::WebDriver::Chrome</code> module hierarchy but on scope-resoluting <code>Options</code> it gives out the NameSpaceError. I also looked into the selenium files and saw for myself <code>Options</code> definition but couldn&#39;t use it in my code <a href=\"https://github.com/SeleniumHQ/selenium/blob/master/rb/lib/selenium/webdriver/chrome/options.rb\" rel=\"nofollow noreferrer\">github.com/SeleniumHQ/selenium/blob/master/rb/lib/selenium/&hellip;</a>&zwnj;&#8203;."}], "answers": [{"tags": [], "owner": {"reputation": 5470, "user_id": 2568849, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/UxtGh.png?s=128&g=1", "display_name": "Mesut GUNES", "link": "https://stackoverflow.com/users/2568849/mesut-gunes"}, "is_accepted": false, "score": 0, "last_activity_date": 1505826764, "creation_date": 1505826764, "answer_id": 46301447, "question_id": 46300397, "link": "https://stackoverflow.com/questions/46300397/uninitialized-constant-seleniumwebdriverchromeoptions-nameerror/46301447#46301447", "title": "uninitialized constant Selenium::WebDriver::Chrome::Options (NameError)", "body": "<p>It seems that you need to <code>Capybara</code> for declaring <code>browser_options</code>. see the below:</p>\n\n<pre><code>Capybara.register_driver :logging_selenium_chrome do |app|\n  caps = Selenium::WebDriver::Remote::Capabilities.chrome(loggingPrefs:\n  {browser: 'ALL'})\n  browser_options = Capybara::Selenium::WebDriver::Chrome::Options.new()\n  Capybara::Selenium::Driver.new(app, browser: :chrome, options: \n  browser_options, desired_capabilities: caps)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 6, "last_activity_date": 1505838646, "creation_date": 1505838646, "answer_id": 46305526, "question_id": 46300397, "link": "https://stackoverflow.com/questions/46300397/uninitialized-constant-seleniumwebdriverchromeoptions-nameerror/46305526#46305526", "title": "uninitialized constant Selenium::WebDriver::Chrome::Options (NameError)", "body": "<p><code>::Selenium::WebDriver::Chrome::Options</code> was added in selenium-webdriver 3.4.1 -  Upgrade to the latest <code>selenium-webdriver</code> gem (3.5.2 currently)</p>\n"}], "owner": {"reputation": 201, "user_id": 8626450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200e77d7cdbc1fed17289ffea98bbbd1?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek Khurana", "link": "https://stackoverflow.com/users/8626450/vivek-khurana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4283, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1505838646, "creation_date": 1505823870, "last_edit_date": 1505826419, "question_id": 46300397, "link": "https://stackoverflow.com/questions/46300397/uninitialized-constant-seleniumwebdriverchromeoptions-nameerror", "title": "uninitialized constant Selenium::WebDriver::Chrome::Options (NameError)", "body": "<p>Needed to execute the below set of code. Please refer my code:</p>\n\n<pre><code>Capybara.register_driver :logging_selenium_chrome do |app|\n  caps = Selenium::WebDriver::Remote::Capabilities.chrome(loggingPrefs:\n  {browser: 'ALL'})\n  browser_options = ::Selenium::WebDriver::Chrome::Options.new()\n  Capybara::Selenium::Driver.new(app, browser: :chrome, options: \n  browser_options, desired_capabilities: caps)\nend\n</code></pre>\n\n<p>but keeps on getting </p>\n\n<blockquote>\n  <p><strong>uninitialized constant Selenium::WebDriver::Chrome::Options (NameError)</strong></p>\n</blockquote>\n\n<p>Anyone having any idea what might be causing this!!!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "visual-studio-code"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505825962, "post_id": 46300148, "comment_id": 79564529, "body": "Any reason for using visual studio for this? RubyMine is built specifically for ruby and has a lot of nice code exploration and completion at a very affordable cost."}, {"owner": {"reputation": 321, "user_id": 1660935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e223bc5df2a4f9024a30c557023f134?s=128&d=identicon&r=PG", "display_name": "xenover", "link": "https://stackoverflow.com/users/1660935/xenover"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505827809, "post_id": 46300148, "comment_id": 79566021, "body": "Just to test it out as a free alternative to sublime text 3."}, {"owner": {"reputation": 4243, "user_id": 4638378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pGqPN.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4638378/brian"}, "edited": false, "score": 0, "creation_date": 1505836028, "post_id": 46300148, "comment_id": 79571697, "body": "Atom (<a href=\"https://atom.io/\" rel=\"nofollow noreferrer\">atom.io</a>) will autocomplete <code>do</code>...<code>enter</code>."}, {"owner": {"reputation": 321, "user_id": 1660935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e223bc5df2a4f9024a30c557023f134?s=128&d=identicon&r=PG", "display_name": "xenover", "link": "https://stackoverflow.com/users/1660935/xenover"}, "edited": false, "score": 1, "creation_date": 1505891431, "post_id": 46300148, "comment_id": 79592358, "body": "Yes, I am aware of that but I asked specifically if vscode could do that too somehow."}, {"owner": {"reputation": 101, "user_id": 5095772, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ElkVYK9OmXA/AAAAAAAAAAI/AAAAAAAAADY/iGjk-9Czq20/photo.jpg?sz=128", "display_name": "Tyler Amos", "link": "https://stackoverflow.com/users/5095772/tyler-amos"}, "edited": false, "score": 2, "creation_date": 1562778699, "post_id": 46300148, "comment_id": 100487403, "body": "This vscode extension seems to do the trick: <a href=\"https://github.com/kaiwood/vscode-endwise\" rel=\"nofollow noreferrer\">github.com/kaiwood/vscode-endwise</a>"}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 1660935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e223bc5df2a4f9024a30c557023f134?s=128&d=identicon&r=PG", "display_name": "xenover", "link": "https://stackoverflow.com/users/1660935/xenover"}, "edited": false, "score": 5, "creation_date": 1505824592, "post_id": 46300241, "comment_id": 79563502, "body": "Yes, I have it installed. It does not include it unfortunately."}, {"owner": {"reputation": 118, "user_id": 1590134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba8932acb001f3713ae810b2d029dcc1?s=128&d=identicon&r=PG", "display_name": "rtrojanowski", "link": "https://stackoverflow.com/users/1590134/rtrojanowski"}, "edited": false, "score": 3, "creation_date": 1569388589, "post_id": 46300241, "comment_id": 102575697, "body": "It&#39;s disabled by default. Code &gt; Preferences &gt; Settings &gt; Extensions &gt; Ruby: Code Completion. Works well with methods, classes, and modules."}, {"owner": {"reputation": 2310, "user_id": 1760776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a06b0ee4ca4d278a813cadb1e0735b7?s=128&d=identicon&r=PG", "display_name": "tgf", "link": "https://stackoverflow.com/users/1760776/tgf"}, "reply_to_user": {"reputation": 118, "user_id": 1590134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba8932acb001f3713ae810b2d029dcc1?s=128&d=identicon&r=PG", "display_name": "rtrojanowski", "link": "https://stackoverflow.com/users/1590134/rtrojanowski"}, "edited": false, "score": 0, "creation_date": 1578275378, "post_id": 46300241, "comment_id": 105375663, "body": "@rtrojanowski near as I can tell that Code Completion setting does not work with blocks as the op requested"}], "tags": [], "owner": {"reputation": 3493, "user_id": 1323481, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4825c6c1cdfd05c2af6fb8db0d492f73?s=128&d=identicon&r=PG", "display_name": "StandardNerd", "link": "https://stackoverflow.com/users/1323481/standardnerd"}, "is_accepted": false, "score": 2, "last_activity_date": 1505823383, "creation_date": 1505823383, "answer_id": 46300241, "question_id": 46300148, "link": "https://stackoverflow.com/questions/46300148/how-to-make-vscode-automatically-insert-end-on-enter-press-after-do/46300241#46300241", "title": "How to make VSCode automatically insert &#39;end&#39; on enter press after &#39;do&#39;", "body": "<p>Did you try <a href=\"https://github.com/rubyide/vscode-ruby\" rel=\"nofollow noreferrer\">https://github.com/rubyide/vscode-ruby</a> ?\nIt states that </p>\n\n<blockquote>\n  <p>This extension provides rich Ruby language and debugging support for\n  VS Code.</p>\n</blockquote>\n\n<p>including Autocomplete. Maybe worth a try.</p>\n"}, {"comments": [{"owner": {"reputation": 17379, "user_id": 1836143, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/8ddoM.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/1836143/alexander"}, "edited": false, "score": 2, "creation_date": 1558003071, "post_id": 46338094, "comment_id": 98959840, "body": "Thank you very much for your answer, it helped me and this question is NOT off-topic, but a very relevant one."}], "tags": [], "owner": {"reputation": 321, "user_id": 1660935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e223bc5df2a4f9024a30c557023f134?s=128&d=identicon&r=PG", "display_name": "xenover", "link": "https://stackoverflow.com/users/1660935/xenover"}, "is_accepted": true, "score": 10, "last_activity_date": 1505979496, "creation_date": 1505979496, "answer_id": 46338094, "question_id": 46300148, "link": "https://stackoverflow.com/questions/46300148/how-to-make-vscode-automatically-insert-end-on-enter-press-after-do/46338094#46338094", "title": "How to make VSCode automatically insert &#39;end&#39; on enter press after &#39;do&#39;", "body": "<p>I found a workaround that suffices for now.\nUsing Code -> Preferences -> User Snippers -> Ruby I added the following snippets</p>\n\n<pre><code>\"Do block\": {\n    \"prefix\": \"dob\",\n    \"body\": [\n        \"do\",\n        \"\\t$0\",\n        \"end\"\n    ],\n    \"description\": \"Do block\"\n},\n\"Do block with params\": {\n    \"prefix\": \"dobwp\",\n    \"body\": [\n        \"do |${1:param}|\",\n        \"\\t$0\",\n        \"end\"\n    ],\n    \"description\": \"Do block with params\"\n}\n</code></pre>\n\n<p>The first one inserts a</p>\n\n<pre><code>do\n\nend\n</code></pre>\n\n<p>without any parameters.\nThe second one inserts a</p>\n\n<pre><code>do |param|\n\nend\n</code></pre>\n\n<p>and you can choose the param value.</p>\n\n<p>The downside is that when writing do you have to move down and choose dob or dobwp and it's not the default behaviour of do like in sublime.</p>\n"}], "owner": {"reputation": 321, "user_id": 1660935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e223bc5df2a4f9024a30c557023f134?s=128&d=identicon&r=PG", "display_name": "xenover", "link": "https://stackoverflow.com/users/1660935/xenover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1970, "favorite_count": 2, "closed_date": 1547023261, "accepted_answer_id": 46338094, "answer_count": 2, "score": 8, "last_activity_date": 1546957580, "creation_date": 1505823103, "last_edit_date": 1505979619, "question_id": 46300148, "link": "https://stackoverflow.com/questions/46300148/how-to-make-vscode-automatically-insert-end-on-enter-press-after-do", "closed_reason": "Not suitable for this site", "title": "How to make VSCode automatically insert &#39;end&#39; on enter press after &#39;do&#39;", "body": "<p>I wanted to try out visual studio code for writing ruby/rails and came across this issue that when I write 'do' in the editor and then hit enter then 'end' is not automatically added to the next line.</p>\n\n<p>Writing 'def' + enter works fine. 'begin' + enter works fine too, but not 'do' + enter.</p>\n\n<p>I haven't found any extension that would make it work yet and google has not been much help either. Maybe there's a way to define the snipper myself?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["mysql", "sql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1505821285, "post_id": 46299447, "comment_id": 79561180, "body": "What you tried?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1505821345, "post_id": 46299447, "comment_id": 79561229, "body": "E.g. <code>ActiveRecord::Base.connection.execute &quot;SELECT * FROM Table1 WHERE Table1.principal NOT IN (SELECT principal FROM table2)&quot;</code>."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1505821349, "post_id": 46299447, "comment_id": 79561232, "body": "Have a look at the Guides (<a href=\"http://guides.rubyonrails.org/active_record_querying.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/active_record_querying.html</a>) come back when this does not help and show what you have tried."}], "answers": [{"comments": [{"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 2, "creation_date": 1505821488, "post_id": 46299549, "comment_id": 79561313, "body": "Use <code>#pluck</code> instead of <code>all.map</code>, also you can use <code>where.not</code> instead of SQL fragment."}, {"owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "reply_to_user": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1505821757, "post_id": 46299549, "comment_id": 79561491, "body": "@pascalbetz thanks for the suggestions , i updated the answer."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505826387, "post_id": 46299549, "comment_id": 79564873, "body": "Since you have gone with <code>where.not</code> I would caveat that with rails &gt; 5 and add back in the sql fragment for lower versions. It makes this answer more complete in my opinion"}], "tags": [], "owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "is_accepted": false, "score": 1, "last_activity_date": 1505821572, "last_edit_date": 1505821572, "creation_date": 1505821399, "answer_id": 46299549, "question_id": 46299447, "link": "https://stackoverflow.com/questions/46299447/ruby-on-rails-command-equal-to-data-retrieved-by-this-sql-query/46299549#46299549", "title": "ruby on rails command equal to data retrieved by this sql query", "body": "<p>You can try something like that</p>\n\n<pre><code>Table1.where.not(principal: Table2.pluck(:principal))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 6507275, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a3d4c07b9fcb38f037c3da4c1e46cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen M", "link": "https://stackoverflow.com/users/6507275/stephen-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1505823421, "creation_date": 1505823421, "answer_id": 46300260, "question_id": 46299447, "link": "https://stackoverflow.com/questions/46299447/ruby-on-rails-command-equal-to-data-retrieved-by-this-sql-query/46300260#46300260", "title": "ruby on rails command equal to data retrieved by this sql query", "body": "<p>Try this.</p>\n\n<pre><code>Table1.where([\"principal not in (?)\",Table2.select(:principal)])\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8505287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ec258077d0c6e9cab00d37582876f3?s=128&d=identicon&r=PG&f=1", "display_name": "Hacker621", "link": "https://stackoverflow.com/users/8505287/hacker621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1505823421, "creation_date": 1505821082, "last_edit_date": 1505821198, "question_id": 46299447, "link": "https://stackoverflow.com/questions/46299447/ruby-on-rails-command-equal-to-data-retrieved-by-this-sql-query", "title": "ruby on rails command equal to data retrieved by this sql query", "body": "<p>Can someone say the equivalent command for below query to retrieve in ruby on rails controller </p>\n\n<pre><code>SELECT * FROM Table1 WHERE Table1.principal NOT IN (SELECT principal FROM table2)\n</code></pre>\n\n\n"}, {"tags": ["ruby", "rss"], "comments": [{"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1505826513, "post_id": 46297354, "comment_id": 79564968, "body": "You might also want to use a library with direct support for iTunes RSS, e.g. <a href=\"https://github.com/feedjira/feedjira\" rel=\"nofollow noreferrer\">github.com/feedjira/feedjira</a>"}, {"owner": {"reputation": 1567, "user_id": 1751977, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/W3ldI.jpg?s=128&g=1", "display_name": "Ashbury", "link": "https://stackoverflow.com/users/1751977/ashbury"}, "reply_to_user": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1506651626, "post_id": 46297354, "comment_id": 79916482, "body": "I was trying to avoid gems like feedjira since sometimes people add their own custom data to feeds that I&#39;d want to capture as well."}, {"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1506680744, "post_id": 46297354, "comment_id": 79928076, "body": "Okay, but for the record, Feedjira does let you configure custom tags in both the feed and its items. (e.g. Feedjira::Feed.add_common_feed_element &quot;image&quot;, as: :the_image`)"}], "owner": {"reputation": 1567, "user_id": 1751977, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/W3ldI.jpg?s=128&g=1", "display_name": "Ashbury", "link": "https://stackoverflow.com/users/1751977/ashbury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505826317, "creation_date": 1505814912, "question_id": 46297354, "link": "https://stackoverflow.com/questions/46297354/unable-to-get-certain-elements-from-rss-feed", "title": "Unable to get certain elements from RSS feed", "body": "<p>I'm having trouble with the default ruby rss parser, specifically getting a couple elements from the Rogan podcast feed:</p>\n\n<blockquote>\n  <p><a href=\"http://joeroganexp.joerogan.libsynpro.com/rss\" rel=\"nofollow noreferrer\">http://joeroganexp.joerogan.libsynpro.com/rss</a></p>\n</blockquote>\n\n<pre><code>open(url) do |rss|\n  feed = RSS::Parser.parse(rss)\n</code></pre>\n\n<p>Now when I look at <code>feed</code>, I can't find the following:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;rss version=\"2.0\" xmlns:atom=\"http://www.w3.org/2005/Atom\" xmlns:cc=\"http://web.resource.org/cc/\" xmlns:itunes=\"http://www.itunes.com/dtds/podcast-1.0.dtd\" xmlns:media=\"http://search.yahoo.com/mrss/\" xmlns:content=\"http://purl.org/rss/1.0/modules/content/\" xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"&gt;\n</code></pre>\n\n<p>And strangely enough I can get all the channel data except the last one (itunes:type):</p>\n\n<pre><code>    &lt;itunes:type&gt;episodic&lt;/itunes:type&gt;\n</code></pre>\n"}, {"tags": ["ruby", "aws-sdk", "amazon-sqs"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1505820710, "post_id": 46296847, "comment_id": 79560804, "body": "Did you have a look at the <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v2/developer-guide/sqs-example-send-and-receive-messages.html\" rel=\"nofollow noreferrer\">examples for the Ruby SDK</a>?"}, {"owner": {"reputation": 309, "user_id": 4517341, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000867481103/picture?type=large", "display_name": "Kumar Siva", "link": "https://stackoverflow.com/users/4517341/kumar-siva"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1505834414, "post_id": 46296847, "comment_id": 79570644, "body": "I need fifo queue. Aws::SQS::Errors::MissingParameter (The request must contain the parameter MessageGroupId.):"}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 4517341, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000867481103/picture?type=large", "display_name": "Kumar Siva", "link": "https://stackoverflow.com/users/4517341/kumar-siva"}, "edited": false, "score": 0, "creation_date": 1505977947, "post_id": 46334080, "comment_id": 79634852, "body": "In SDK v1, there is a method poll to poll from the queue infinitely. How can i achieve that in V2? @robbie-chiha"}, {"owner": {"reputation": 359, "user_id": 1877781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6774a18c0e51fcd95da09c60d86350?s=128&d=identicon&r=PG", "display_name": "Robbie Chiha", "link": "https://stackoverflow.com/users/1877781/robbie-chiha"}, "reply_to_user": {"reputation": 309, "user_id": 4517341, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000867481103/picture?type=large", "display_name": "Kumar Siva", "link": "https://stackoverflow.com/users/4517341/kumar-siva"}, "edited": false, "score": 0, "creation_date": 1506251224, "post_id": 46334080, "comment_id": 79736096, "body": "v2: <a href=\"http://docs.aws.amazon.com/sdkforruby/api/Aws/SQS/QueuePoller.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/sdkforruby/api/Aws/SQS/QueuePoller.html</a> v3: <a href=\"http://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/SQS/QueuePoller.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/SQS/&hellip;</a>"}], "tags": [], "owner": {"reputation": 359, "user_id": 1877781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6774a18c0e51fcd95da09c60d86350?s=128&d=identicon&r=PG", "display_name": "Robbie Chiha", "link": "https://stackoverflow.com/users/1877781/robbie-chiha"}, "is_accepted": false, "score": 2, "last_activity_date": 1505957964, "creation_date": 1505957964, "answer_id": 46334080, "question_id": 46296847, "link": "https://stackoverflow.com/questions/46296847/how-to-get-aws-sqs-client-and-send-a-message-to-queue/46334080#46334080", "title": "How to get aws sqs client and send a message to queue?", "body": "<p>From the <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v2/developer-guide/sqs-example-send-and-receive-messages.html\" rel=\"nofollow noreferrer\">AWS Developer Guide</a></p>\n\n<pre><code>require 'aws-sdk'\n\nsqs = Aws::SQS::Client.new(region: 'us-east-1')\n\n# Send a message to a queue.\nqueue_name = \"my-queue\"\n\nbegin\n  queue_url = sqs.get_queue_url(queue_name: queue_name).queue_url\n\n  # Create a message with three custom attributes: Title, Author, and WeeksOn.\n  send_message_result = sqs.send_message({\n    queue_url: queue_url, \n    message_body: \"Information about current NY Times fiction bestseller for week of 2016-12-11.\",\n    message_attributes: {\n      \"Title\" =&gt; {\n        string_value: \"The Whistler\",\n        data_type: \"String\"\n      },\n      \"Author\" =&gt; {\n        string_value: \"John Grisham\",\n        data_type: \"String\"\n      },\n      \"WeeksOn\" =&gt; {\n        string_value: \"6\",\n        data_type: \"Number\"\n      }\n    }\n  })\nrescue Aws::SQS::Errors::NonExistentQueue\n  puts \"A queue named '#{queue_name}' does not exist.\"\n  exit(false)\nend\n\nputs send_message_result.message_id\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 4517341, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000867481103/picture?type=large", "display_name": "Kumar Siva", "link": "https://stackoverflow.com/users/4517341/kumar-siva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505957964, "creation_date": 1505813581, "last_edit_date": 1505820235, "question_id": 46296847, "link": "https://stackoverflow.com/questions/46296847/how-to-get-aws-sqs-client-and-send-a-message-to-queue", "title": "How to get aws sqs client and send a message to queue?", "body": "<p>How to get aws sqs client and send a message to queue in ruby sdk?</p>\n\n<pre><code>$sqs = Aws::SQS::Client.new(\n  :access_key_id =&gt; SQS_CONFIG[:access_key_id], \n  :secret_access_key =&gt; SQS_CONFIG[:secret_access_key], \n  :region =&gt; 'us-east-1'\n)\n</code></pre>\n\n<p>After this how to push message to a queue?</p>\n"}, {"tags": ["ruby", "stripe-payments", "stripe-connect"], "answers": [{"tags": [], "owner": {"reputation": 10598, "user_id": 371137, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/JAV6o.jpg?s=128&g=1", "display_name": "Perseids", "link": "https://stackoverflow.com/users/371137/perseids"}, "is_accepted": false, "score": 3, "last_activity_date": 1505812329, "creation_date": 1505812329, "answer_id": 46296375, "question_id": 46296374, "link": "https://stackoverflow.com/questions/46296374/how-can-i-get-the-original-charge-and-refund-ids-of-an-automatic-payout/46296375#46296375", "title": "How can I get the original charge and refund ids of an automatic payout", "body": "<p>I've had an extensive exchange with Stripe's support team and there are several puzzle pieces necessary to get there:</p>\n\n<h2>Payouts are scoped by accounts</h2>\n\n<p>If you <a href=\"https://stripe.com/docs/api#list_payouts\" rel=\"nofollow noreferrer\">query stripe for a list of payouts</a>, you will only receive the payout objects that you, the platform owner, get from stripe. To get the payout objects of a specific account you can use the normal authentication for the platform, but <a href=\"https://stripe.com/docs/connect/authentication#authentication-via-the-stripe-account-header\" rel=\"nofollow noreferrer\">send the stripe account id as a header</a>. So the code snippet to get the last payout looks like this (I'll use ruby snippets as examples for the rest of the answer):</p>\n\n<pre><code>Stripe::Payout.list({limit: 1}, {stripe_account: 'acct_0000001234567890aBcDeFgH'})\n=&gt; #&lt;Stripe::ListObject:0x0123456789ab&gt; JSON: {\n  \"object\": \"list\",\n  \"data\": [\n    {\"id\":\"po_1000001234567890aBcDeFgH\",\n     \"object\":\"payout\",\n     \"amount\":53102,\n     \"arrival_date\":1504000000,\n     \"balance_transaction\":\"txn_2000001234567890aBcDeFgH\",\n     \"created\":1504000000,\n     \"currency\":\"eur\",\n     \"description\":\"STRIPE TRANSFER\",\n     \"destination\":\"ba_3000001234567890aBcDeFgH\",\n     \"failure_balance_transaction\":null,\n     \"failure_code\":null,\n     \"failure_message\":null,\n     \"livemode\":true,\"metadata\":{},\n     \"method\":\"standard\",\n     \"source_type\":\"card\",\n     \"statement_descriptor\":\"[\u2026]\",\n     \"status\":\"paid\",\n     \"type\":\"bank_account\"\n    }\n  ],\n  \"has_more\": true,\n  \"url\": \"/v1/payouts\"\n}\n</code></pre>\n\n<p>Having the payout id, we can query the list of <a href=\"https://stripe.com/docs/api#balance_history\" rel=\"nofollow noreferrer\">balance transactions, scoped to a payout</a>: </p>\n\n<pre><code>Stripe::BalanceTransaction.all({\n    payout: 'po_1000001234567890aBcDeFgH',\n    limit: 2,\n}, {\n    stripe_account: 'acct_0000001234567890aBcDeFgH'\n})\n</code></pre>\n\n<h2>Objects viewed as an account are stripped of most information, compared to those viewed as a platform owner</h2>\n\n<p>Even though you now have the payout id, the object is still scoped to the account and you cannot retrieve it as platform owner. But viewed as an account, the payout only shows pseudo charge and refund objects like these (notice the second transaction has a <code>py_7000001234567890aBcDeFgH</code> object as a source instead of a regular <code>ch_</code> charge object):</p>\n\n<pre><code>Stripe::BalanceTransaction.all({\n    payout: 'po_1000001234567890aBcDeFgH',\n    limit: 2,\n}, {\n    stripe_account: 'acct_0000001234567890aBcDeFgH'\n})\n=&gt; {\n    :object =&gt; \"list\",\n    :data =&gt; [\n        {\n            :id =&gt; \"txn_4000001234567890aBcDeFgH\",\n            :object =&gt; \"balance_transaction\",\n            :amount =&gt; -53102,\n            :available_on =&gt; 1504000000,\n            :created =&gt; 1504000000,\n            :currency =&gt; \"eur\",\n            :description =&gt; \"STRIPE TRANSFER\",\n            :fee =&gt; 0,\n            :fee_details =&gt; [],\n            :net =&gt; -53102,\n            :source =&gt; \"po_5000001234567890aBcDeFgH\",\n            :status =&gt; \"available\",\n            :type =&gt; \"payout\"\n        },\n        {\n            :id =&gt; \"txn_6000001234567890aBcDeFgH\",\n            :object =&gt; \"balance_transaction\",\n            :amount =&gt; 513,\n            :available_on =&gt; 1504000000,\n            :created =&gt; 1504000000,\n            :currency =&gt; \"eur\",\n            :description =&gt; nil,\n            :fee =&gt; 0,\n            :fee_details =&gt; [],\n            :net =&gt; 513,\n            :source =&gt; \"py_7000001234567890aBcDeFgH\",\n            :status =&gt; \"available\",\n            :type =&gt; \"payment\"\n        }\n    ],\n    :has_more =&gt; true,\n    :url =&gt; \"/v1/balance/history\"\n}\n</code></pre>\n\n<h2>You can let stripe automatically expand objects in the response</h2>\n\n<p><a href=\"https://stripe.com/docs/api#expanding_objects\" rel=\"nofollow noreferrer\">As an additional parameter, you can give stripe paths of objects which you want stripe to expand in their response.</a> Thus we can walk from the pseudo objects back to the original charge objects via the transfers:</p>\n\n<pre><code>Stripe::BalanceTransaction.all({\n    payout: 'po_1000001234567890aBcDeFgH',\n    limit: 2,\n    expand:['data.source.source_transfer',]\n}, {\n    stripe_account: 'acct_0000001234567890aBcDeFgH'\n}).data.second.source.source_transfer.source_transaction\n=&gt; \"ch_8000001234567890aBcDeFgH\"\n</code></pre>\n\n<p>And if you want to process the whole list you need disambiguate between the <code>source.object</code> attribute:</p>\n\n<pre><code>Stripe::BalanceTransaction.all({\n    payout: 'po_1000001234567890aBcDeFgH',\n    limit: 2,\n    expand:['data.source.source_transfer',]\n}, {\n    stripe_account: 'acct_0000001234567890aBcDeFgH'\n}).data.map do |bt| \n  if bt.source.object == 'charge'\n    ['charge', bt.source.source_transfer.source_transaction]\n  else\n    [bt.source.object]\n  end\nend\n=&gt; [[\"payout\"], [\"charge\", \"ch_8000001234567890aBcDeFgH\"]]\n</code></pre>\n\n<h2>Refunds have no connecting object path back to the original ids</h2>\n\n<p>Unfortunately, there is currently no way to get the original <code>re_</code> objects from the pseudo <code>pyr_</code> that are returned by the BalanceTransaction list call for refund transactions. The best alternative I've found is to go via the <code>data.source.charge.source_transfer.source_transaction</code> path to get the charge id of the charge on which the refund was issued and use that in combination with the <code>created</code> attribute of the <code>pyr_</code> to match our database refund object. I'm not sure, though, how stable that method really is. The code to extract that data:</p>\n\n<pre><code>Stripe::BalanceTransaction.all({\n    payout: 'po_1000001234567890aBcDeFgH',\n    limit: 100, # max page size, the code to iterate over all pages is TBD\n    expand: [\n        'data.source.source_transfer', # For charges\n        'data.source.charge.source_transfer', # For refunds\n    ]\n}, {\n    stripe_account: 'acct_0000001234567890aBcDeFgH'\n}).data.map do |bt|\n  res = case bt.source.object\n    when 'charge'\n      {\n          charge_id: bt.source.source_transfer.source_transaction\n      }\n    when 'refund'\n      {\n          charge_id: bt.source.charge.source_transfer.source_transaction\n      }\n    else\n      {}\n  end\n  res.merge(type: bt.source.object, amount: bt.amount, created: bt.created)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1776, "user_id": 167369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bca845de2e02e2cdae5aded1d898658?s=128&d=identicon&r=PG", "display_name": "eremite", "link": "https://stackoverflow.com/users/167369/eremite"}, "is_accepted": false, "score": 1, "last_activity_date": 1556308861, "creation_date": 1556308861, "answer_id": 55874260, "question_id": 46296374, "link": "https://stackoverflow.com/questions/46296374/how-can-i-get-the-original-charge-and-refund-ids-of-an-automatic-payout/55874260#55874260", "title": "How can I get the original charge and refund ids of an automatic payout", "body": "<p>It is now possible to get the refund ids via a \"transfer reversal\" object:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Stripe::BalanceTransaction.list({\n  payout: 'po_1000001234567890aBcDeFgH',\n  expand: [\n    'data.source.source_transfer', # For charges\n    'data.source.transfer_reversal', # For refunds\n  ]\n}, {\n  stripe_account: 'acct_0000001234567890aBcDeFgH'\n}).auto_paging_each do |balance_transaction|\n  case balance_transaction.type\n    when 'payment'\n      charge_id = balance_transaction.source.source_transfer.source_transaction\n    when 'payment_refund'\n      refund_id = balance_transaction.source.charge.source_transfer.source_transaction\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 10598, "user_id": 371137, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/JAV6o.jpg?s=128&g=1", "display_name": "Perseids", "link": "https://stackoverflow.com/users/371137/perseids"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1556308861, "creation_date": 1505812329, "question_id": 46296374, "link": "https://stackoverflow.com/questions/46296374/how-can-i-get-the-original-charge-and-refund-ids-of-an-automatic-payout", "title": "How can I get the original charge and refund ids of an automatic payout", "body": "<p>Stripe connect accounts are configurable to coalesce payouts in a regular <a href=\"https://stripe.com/docs/connect/payouts#payout-schedule\" rel=\"nofollow noreferrer\">payout schedule</a>, e.g. for monthly payouts in our case. For these monthly payouts we need to explain the account owners which of the transactions on our platform (bookings and refunds in our case) produced the overall amount they receive. We store the stripe charge id (resp. refund id) in the booking (resp refund) objects in our database. Thus the question boils down to:</p>\n\n<p><strong>Given a stripe account id, how can you get the list of stripe charge and refund ids that contributed to the last payout?</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 1, "creation_date": 1505814806, "post_id": 46296039, "comment_id": 79556792, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10349606/where-to-override-current-user-helper-method-of-devise-gem\">Where to override current_user helper method of devise gem</a>"}, {"owner": {"reputation": 1743, "user_id": 5225464, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ea5cbf4d96e89178c880f25cfed6b8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/5225464/pavel"}, "reply_to_user": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1505944370, "post_id": 46296039, "comment_id": 79625360, "body": "I want to override User to different class, but always got User class"}, {"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1505980480, "post_id": 46296039, "comment_id": 79636444, "body": "If not getting a user class this is nor a devise problem, but probably a problem in your User retrieval logic. Can you show how you coded these subclasses and the user class? How are their relations?"}, {"owner": {"reputation": 1743, "user_id": 5225464, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ea5cbf4d96e89178c880f25cfed6b8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/5225464/pavel"}, "reply_to_user": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1505984621, "post_id": 46296039, "comment_id": 79639096, "body": "<a href=\"https://gist.github.com/anonymous/d1e09453c6cc3dd0c17e4faec1aca271\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/d1e09453c6cc3dd0c17e4faec1aca271</a>"}, {"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1505990461, "post_id": 46296039, "comment_id": 79643308, "body": "So you do have a <code>type</code> column which determines the <code>User</code> class?"}, {"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1506214646, "post_id": 46296039, "comment_id": 79729171, "body": "Just be clear, the problem is <code>#detect_role</code> does not return a user of the right class, which should be one of the subclasses based on the roles, right?  How do you know it&#39;s not working? The log you showed didn&#39;t hit the correct branch."}], "answers": [{"comments": [{"owner": {"reputation": 1743, "user_id": 5225464, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ea5cbf4d96e89178c880f25cfed6b8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/5225464/pavel"}, "edited": false, "score": 0, "creation_date": 1505826182, "post_id": 46297677, "comment_id": 79564695, "body": "Added <code>super</code> but it did not help log: <a href=\"https://gist.github.com/anonymous/688eeb1568f359bd2ad98e735d4972e7\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/688eeb1568f359bd2ad98e735d4972e7</a>"}], "tags": [], "owner": {"reputation": 1463, "user_id": 1776255, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/caf8d27b5a86675785da57a67fe450b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1776255/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1505815722, "creation_date": 1505815722, "answer_id": 46297677, "question_id": 46296039, "link": "https://stackoverflow.com/questions/46296039/devise-override-current-user-set-different-class-for-user/46297677#46297677", "title": "Devise: override current_user (set different Class for user)", "body": "<p>Use </p>\n\n<blockquote>\n  <p>super</p>\n</blockquote>\n\n<p>keyword and then right your override code like this;</p>\n\n<pre><code>def current_user\n  super\n  ----your code goes here ---\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1743, "user_id": 5225464, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ea5cbf4d96e89178c880f25cfed6b8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/5225464/pavel"}, "is_accepted": true, "score": 2, "last_activity_date": 1506034864, "creation_date": 1506034864, "answer_id": 46354407, "question_id": 46296039, "link": "https://stackoverflow.com/questions/46296039/devise-override-current-user-set-different-class-for-user/46354407#46354407", "title": "Devise: override current_user (set different Class for user)", "body": "<p>This helped me:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  alias_method :devise_current_user, :current_user\n\n  private\n\n  def current_user\n    user = if params[:user].blank?\n             devise_current_user\n           else\n             User.find_by(email: params[:user][:email])\n           end\n    detect_role(user) if !user.blank?\n  end\n\n  def detect_role(user)\n    roles = user.roles_name\n    user = if roles.include?(\"mentor\")\n             user.becomes(Mentor)\n           elsif !roles.include?(\"admin\") &amp;&amp; !roles.include?(\"mentor\")\n             user.becomes(Student)\n           else\n             user\n           end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1743, "user_id": 5225464, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ea5cbf4d96e89178c880f25cfed6b8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/5225464/pavel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 0, "accepted_answer_id": 46354407, "answer_count": 2, "score": 4, "last_activity_date": 1506034864, "creation_date": 1505811333, "last_edit_date": 1505827162, "question_id": 46296039, "link": "https://stackoverflow.com/questions/46296039/devise-override-current-user-set-different-class-for-user", "title": "Devise: override current_user (set different Class for user)", "body": "<p>I want to do this:</p>\n\n<p>application_controller.rb:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  alias_method :devise_current_user, :current_user\n\n  private\n\n  def current_user\n    if params[:user].blank?\n      puts \"!found user\"\n      devise_current_user\n    else\n      puts \"found user\"\n      user = User.find_by(email: params[:user][:email])\n      return detect_role(user)\n    end\n  end\n\n  def detect_role(user)\n    roles = user.roles_name\n    user = if roles.include?(\"mentor\")\n             user.becomes(Mentor)\n           elsif !roles.include?(\"admin\") &amp;&amp; !roles.include?(\"mentor\")\n             user.becomes(Student)\n           else\n             user\n           end\n  end\nend\n</code></pre>\n\n<p>but still does not go out to override current_user</p>\n\n<p>log:\n<a href=\"https://gist.github.com/anonymous/e0a5fb593b020b16a0cd2ae9d539b92a\" rel=\"nofollow noreferrer\">https://gist.github.com/anonymous/e0a5fb593b020b16a0cd2ae9d539b92a</a></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1505811132, "post_id": 46295887, "comment_id": 79554272, "body": "Where are you stuck?"}, {"owner": {"reputation": 199, "user_id": 568730, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/1404e066b9ec254e5e1b1d6734abd8dc?s=128&d=identicon&r=PG", "display_name": "webs86", "link": "https://stackoverflow.com/users/568730/webs86"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1505811696, "post_id": 46295887, "comment_id": 79554674, "body": "I have updated my question. Thank you"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1505812088, "post_id": 46295887, "comment_id": 79554910, "body": "is the desired output correct? should category 2 be a subelement of category 1 ?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505812256, "post_id": 46295887, "comment_id": 79555022, "body": "<i>&quot;but key is not single category&quot;</i> \u2013 could you show the (wrong) result, please?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505812361, "post_id": 46295887, "comment_id": 79555082, "body": "BTW, your expected result seems to be a hash, but is expressed as an array literal, i.e. you are using <code>[key =&gt; value]</code> instead of <code>{ key =&gt; value }</code>. Please fix that to avoid confusion."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1505818502, "post_id": 46295887, "comment_id": 79559272, "body": "@DoktorOSwaldo: it&#39;s not a subelement. It is just misleadingly indented as such."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1505815827, "post_id": 46296384, "comment_id": 79557460, "body": "You are abusing <code>each</code> with preliminary local variable. Please use <code>each_with_object</code> instead."}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1505817875, "post_id": 46296384, "comment_id": 79558847, "body": "@mudasobwa that&#39;s true, it was more a statement, that he should have be able to solve this with easy methods. It was not the idea to show the best way. Anyway your solution is quite good, always glad to read something like this ;-)"}], "tags": [], "owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "is_accepted": false, "score": 1, "last_activity_date": 1505812357, "creation_date": 1505812357, "answer_id": 46296384, "question_id": 46295887, "link": "https://stackoverflow.com/questions/46295887/ruby-array-group-by-sub-elements/46296384#46296384", "title": "ruby - Array group_by sub elements", "body": "<p>Do you need a group_by? Why not an easy nested loop?</p>\n\n<pre><code>result = {}\narticels.each do |article|\n  article.categories.each do |cat|\n    result[cat] ||= []\n    result[cat] &lt;&lt; article\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1505818152, "last_edit_date": 1505818152, "creation_date": 1505816062, "answer_id": 46297813, "question_id": 46295887, "link": "https://stackoverflow.com/questions/46295887/ruby-array-group-by-sub-elements/46297813#46297813", "title": "ruby - Array group_by sub elements", "body": "<p>It seems, in this case, the plain old good reducer would suit your needs better:</p>\n\n<pre><code>articles.each_with_object({}) do |article, acc|\n  acc.merge! article.categories.map { |c| [c, article] }.to_h\nend\n</code></pre>\n\n<p>or even:</p>\n\n<pre><code>articles.map do |article|\n  article.categories.map { |c| [c, article] }.to_h\nend.reduce(&amp;:merge)\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 568730, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/1404e066b9ec254e5e1b1d6734abd8dc?s=128&d=identicon&r=PG", "display_name": "webs86", "link": "https://stackoverflow.com/users/568730/webs86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505818152, "creation_date": 1505810863, "last_edit_date": 1505813629, "question_id": 46295887, "link": "https://stackoverflow.com/questions/46295887/ruby-array-group-by-sub-elements", "title": "ruby - Array group_by sub elements", "body": "<p>I need to group this YAML strutcture by array elements.</p>\n\n<p>This is example of my YAML structure:</p>\n\n<pre><code>articles:\n  - title: 'Title 1'\n    url: 'https://example.com'\n    data: July 21, 2017\n    categories:\n      - 'category 1'\n      - 'category 2'\n  - title: 'Title 2'\n    url: 'https://example.com'\n    data: July 23, 2017\n    categories:\n      - 'category 2'\n</code></pre>\n\n<p>Result I need is this or similar:</p>\n\n<pre><code>['category 1' =&gt; \n    [\n        {title: 'Title 1', url: 'https://example.com', data: July 21, 2017, categories: ['category 1', 'category 2']}\n    ], \n    'category 2' =&gt; [\n        {title: 'Title 1', url: 'https://example.com', data: July 21, 2017, categories: ['category 1', 'category 2']},\n        {title: 'Title 2', url: 'https://example.com', data: July 23, 2017, categories: ['category 2']}\n    ]\n]\n</code></pre>\n\n<p>Can you help me? Thank you in advance</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I have tried this:</p>\n\n<pre><code>articles.group_by(&amp;:categories).map{|v, a| [v, a] }\n</code></pre>\n\n<p>but key is not single category, but categories elements. I think I need a more loop but after some trials I haven't get the result.</p>\n\n<p>Sorry for this, but I newbie for ruby</p>\n\n<p><strong>UPDATE 2:</strong>\nWrong result is:</p>\n\n<pre><code>[\n  [\n    [\n      \"category 1\",\n      \"category 2\"\n    ],\n    [\n      {\n        \"title\": \"Title 1\",\n        \"url\": \"https://example.com\",\n        \"data\": \"July 21, 2017\",\n        \"categories\": [\n          \"category 1\",\n          \"category 2\"\n        ]\n      }\n    ]\n  ],\n  [\n    [\n      \"category 2\"\n    ],\n    [\n      {\n        \"title\": \"Title 2\",\n        \"url\": \"https://example.com\",\n        \"data\": \"July 23, 2017\",\n        \"categories\": [\n          \"category 2\"\n        ]\n      }\n    ]\n  ]\n]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "devise"], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "is_accepted": true, "score": 5, "last_activity_date": 1522139771, "last_edit_date": 1522139771, "creation_date": 1505812305, "answer_id": 46296362, "question_id": 46295808, "link": "https://stackoverflow.com/questions/46295808/sqlite3constraintexception-unique-constraint-failed-users-email-insert-into/46296362#46296362", "title": "SQLite3::ConstraintException: UNIQUE constraint failed: users.email: INSERT INTO &quot;users&quot;", "body": "<p>I found the solution! I had to change the <code>test/fixtures/users.yml</code> file to this:</p>\n\n<pre><code>one:\n  email: test1@test.com\n\ntwo:\n  email: test2@test.com\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1682, "favorite_count": 0, "accepted_answer_id": 46296362, "answer_count": 1, "score": 2, "last_activity_date": 1522139771, "creation_date": 1505810617, "question_id": 46295808, "link": "https://stackoverflow.com/questions/46295808/sqlite3constraintexception-unique-constraint-failed-users-email-insert-into", "title": "SQLite3::ConstraintException: UNIQUE constraint failed: users.email: INSERT INTO &quot;users&quot;", "body": "<p>I just installed the devise gem and I'm getting the following error:</p>\n\n<pre><code>Error:\nAccountsControllerTest#test_should_update_account:\nActiveRecord::RecordNotUnique: SQLite3::ConstraintException: UNIQUE  constraint failed: users.email: INSERT INTO \"users\" (\"created_at\", \"updated_at\", \"id\") VALUES ('2017-09-19 08:32:47.975048', '2017-09-19 08:32:47.975048', 298486374)\n</code></pre>\n\n<p>This is the procedure I followed: </p>\n\n<pre><code>gem 'devise'\nbundle install\nrails generate devise:install\nconfig.action_mailer.default_url_options = { host: 'localhost', port: 3000 }\nrails generate devise user\ndevise_for :users, path: 'users'\nconfig.scoped_views = true\nrails g devise:views users\nrails generate devise:controllers users\n</code></pre>\n\n<p>Any idea what might be wrong?</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ruby-on-rails-4", "rails-api"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6550354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kmqukZSB0bc/AAAAAAAAAAI/AAAAAAAAABI/RP8fcA5ADKw/photo.jpg?sz=128", "display_name": "Nell David Soledad", "link": "https://stackoverflow.com/users/6550354/nell-david-soledad"}, "edited": false, "score": 0, "creation_date": 1505810678, "post_id": 46295780, "comment_id": 79553996, "body": "It worked! Thank you very much :) Will choose this as the accepted answer in 10 minutes"}, {"owner": {"reputation": 1132, "user_id": 1154044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b042060fc12ff39b4fbe94dcec7d8598?s=128&d=identicon&r=PG", "display_name": "cnnr", "link": "https://stackoverflow.com/users/1154044/cnnr"}, "reply_to_user": {"reputation": 5, "user_id": 6550354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kmqukZSB0bc/AAAAAAAAAAI/AAAAAAAAABI/RP8fcA5ADKw/photo.jpg?sz=128", "display_name": "Nell David Soledad", "link": "https://stackoverflow.com/users/6550354/nell-david-soledad"}, "edited": false, "score": 0, "creation_date": 1505810842, "post_id": 46295780, "comment_id": 79554096, "body": "Glad to help you )"}], "tags": [], "owner": {"reputation": 1132, "user_id": 1154044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b042060fc12ff39b4fbe94dcec7d8598?s=128&d=identicon&r=PG", "display_name": "cnnr", "link": "https://stackoverflow.com/users/1154044/cnnr"}, "is_accepted": true, "score": 0, "last_activity_date": 1505810540, "creation_date": 1505810540, "answer_id": 46295780, "question_id": 46295715, "link": "https://stackoverflow.com/questions/46295715/rails-4-raises-argumenterror-wrong-number-of-arguments-2-for-1-when-updatin/46295780#46295780", "title": "Rails 4 raises ArgumentError (wrong number of arguments (2 for 1)): when updating through AJAX POST", "body": "<p>Change your <code>create</code> method to this:</p>\n\n<pre><code>def create\n  Notification.update_all(status: \"read\", user_id: current_user.id)\nend\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6550354, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kmqukZSB0bc/AAAAAAAAAAI/AAAAAAAAABI/RP8fcA5ADKw/photo.jpg?sz=128", "display_name": "Nell David Soledad", "link": "https://stackoverflow.com/users/6550354/nell-david-soledad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 46295780, "answer_count": 1, "score": 0, "last_activity_date": 1505819688, "creation_date": 1505810333, "last_edit_date": 1505819688, "question_id": 46295715, "link": "https://stackoverflow.com/questions/46295715/rails-4-raises-argumenterror-wrong-number-of-arguments-2-for-1-when-updatin", "title": "Rails 4 raises ArgumentError (wrong number of arguments (2 for 1)): when updating through AJAX POST", "body": "<p>I want to update the <code>status</code> of the notifications to <code>read</code> whenever I want the user clicks on the notification dropdown of the app.</p>\n\n<p>Here is the controller code:</p>\n\n<pre><code>class Api::V1::NotificationsController &lt; ApiController\n  before_action :authenticate_user!\n\n  def index\n    @notifications = Notification.where(user_id: current_user.id).order(created_at: :desc)\n\n    render_success @notifications\n  end\n\n  def create\n    Notification.update_all({status: \"read\"}, {user_id: current_user.id})\n  end\n\nend\n</code></pre>\n\n<p>and the jQuery code that should trigger the <code>create</code> method for the controller:</p>\n\n<pre><code>$('.notifications-menu').on('shown.bs.dropdown', function () {\n  console.log('Opened notifications');\n  $.post('/api/v1/notifications');\n})\n</code></pre>\n\n<p>Unfortunately, it returns this error:</p>\n\n<pre><code>Started POST \"/api/v1/notifications\" for ::1 at 2017-09-19 16:27:53 +0800\nProcessing by Api::V1::NotificationsController#create as */*\n  User Load (0.6ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1  ORDER BY \"users\".\"id\" ASC LIMIT 1  [[\"id\", 13]]\nCompleted 500 Internal Server Error in 6ms (ActiveRecord: 0.6ms)\n\nArgumentError (wrong number of arguments (2 for 1)):\n  app/controllers/api/v1/notifications_controller.rb:11:in `create'\n</code></pre>\n"}, {"tags": ["mysql", "ruby", "sequel"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505827226, "post_id": 46295076, "comment_id": 79565550, "body": "I believe this <code>Sequel.expr(:bit_column).sql_number &amp; 1</code> can be <code>Sequel[:bit_column].sql_number &amp; 1</code> instead and should create <code>&quot;bit_column&quot; &amp; 1</code> <a href=\"https://github.com/jeremyevans/sequel/blob/master/doc/sql.rdoc#bitwise-mathematical-operators------\" rel=\"nofollow noreferrer\">Sequel Docs for Bitwise operators</a>"}], "answers": [{"tags": [], "owner": {"reputation": 643, "user_id": 1463572, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/01bfce085158b21e02684c6531fc364b?s=128&d=identicon&r=PG", "display_name": "tpei", "link": "https://stackoverflow.com/users/1463572/tpei"}, "is_accepted": false, "score": 0, "last_activity_date": 1505909485, "last_edit_date": 1505909485, "creation_date": 1505825336, "answer_id": 46300904, "question_id": 46295076, "link": "https://stackoverflow.com/questions/46295076/mysql-bitwise-operators-in-sequel-gem/46300904#46300904", "title": "MySQL bitwise operators in Sequel gem", "body": "<p>Ok, so I managed to get this working by using Sequel.lit.\n<code>Sequel.lit(\"bit_column &amp; 1\") &amp; Sequel.expr('bit_column' =&gt; 1)</code> returns <code>\"SELECT * FROM 'users' WHERE (cars_owned &amp; 20 AND ('device' = 8))\"</code> and that is  the correct query and works. </p>\n\n<p>I'm still sure that there's a better way using proper bitwise mathematical operators, so I'm gonna keep this open.</p>\n"}], "owner": {"reputation": 643, "user_id": 1463572, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/01bfce085158b21e02684c6531fc364b?s=128&d=identicon&r=PG", "display_name": "tpei", "link": "https://stackoverflow.com/users/1463572/tpei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505909485, "creation_date": 1505808175, "last_edit_date": 1505909449, "question_id": 46295076, "link": "https://stackoverflow.com/questions/46295076/mysql-bitwise-operators-in-sequel-gem", "title": "MySQL bitwise operators in Sequel gem", "body": "<p>I am trying to work with bitwise operators using the Sequel gem and I was wondering if there was a natively supported way to do this.\nRight now what I can do of course is </p>\n\n<pre><code>MySequelModel.where('bitcolumn &amp; ?', '0001010')\n</code></pre>\n\n<p>However, what I am doing is merging a lot of sequel expressions that I have generated, a bit like so:</p>\n\n<pre><code>sequel_query = queries.inject(Neutral) do |expression, a_hash|\n  expression &amp; generate_query_from(a_hash)\nend\n</code></pre>\n\n<p><code>generate_query_from(...)</code> would then always return a Sequel Expression object. Now this will of course not work anymore when a possible return value could also be <code>\"bitcolumn &amp; '100010'\"</code> instead.</p>\n\n<p>I tried creating a Sequel expresison like <code>Sequel.expr(\"bitcolumn &amp; '10001'\")</code> or <code>Sequel.expr(:bit_column) &amp; Sequel.expr(value)</code> but that both causes a Sequel::Error: Invalid filter expression even though the latter works using the > etc operators.</p>\n\n<p>UPDATE:\nInterestingly, it is actually possible to merge a Sequel expression with a query string, however it does not create the \"correct\" query. Instead of creating e.g:</p>\n\n<pre><code>\"SELECT * FROM `users` WHERE ((`bitcolumn` = '000001') AND bitcolumn &amp; '000001')\"\n</code></pre>\n\n<p>it creates:</p>\n\n<pre><code>\"SELECT * FROM `users` WHERE ((`bitcolumn` = '000001') AND 'bitcolumn &amp; \\\\'000001\\\\'')\"\n</code></pre>\n\n<p>which doesn't work.</p>\n\n<p>But maybe my usage: <code>Sequel.expr(bitcolumn: '000001') &amp; \"bitcolumn &amp; '000001'\"</code> is not correct and could be fixed. \nAdditionally if my first returned query is a string: <code>query_string &amp; sequel_expression</code> will of course fail.</p>\n\n<p>UPDATE 2:</p>\n\n<p>I now found <a href=\"http://sequel.jeremyevans.net/rdoc/files/doc/sql_rdoc.html#label-Bitwise+Mathematical+Operators+-28-26+-7C+-5E+-3C-3C+-3E-3E+-7E-29\" rel=\"nofollow noreferrer\">http://sequel.jeremyevans.net/rdoc/files/doc/sql_rdoc.html#label-Bitwise+Mathematical+Operators+-28-26+-7C+-5E+-3C-3C+-3E-3E+-7E-29</a> which seems like the most appropriate thing, but doing:</p>\n\n<pre><code>[54] pry(main)&gt; exp = Sequel.expr(:bit_column).sql_number &amp; 1\n=&gt; #&lt;Sequel::SQL::NumericExpression @op=&gt;:&amp;, @args=&gt;[#&lt;Sequel::SQL::Identifier @value=&gt;\"bit_column\"&gt;, 1]&gt;\n[55] pry(main)&gt; User.where(exp).sql\n</code></pre>\n\n<p>causes an error as well</p>\n\n<pre><code>Sequel::Error: Invalid filter expression: #&lt;Sequel::SQL::NumericExpression @op=&gt;:&amp;, @args=&gt;[#&lt;Sequel::SQL::Identifier @value=&gt;\"bit_column\"&gt;, 1]&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505807864, "post_id": 46294378, "comment_id": 79552377, "body": "<i>&quot;I understand why it&#39;s looping without end&quot;</i> \u2013 what do you think why it doesn&#39;t end?"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 5723002, "user_type": "registered", "profile_image": "https://graph.facebook.com/1098879440142200/picture?type=large", "display_name": "Abhishek Madan", "link": "https://stackoverflow.com/users/5723002/abhishek-madan"}, "is_accepted": false, "score": 0, "last_activity_date": 1505806361, "creation_date": 1505806361, "answer_id": 46294556, "question_id": 46294378, "link": "https://stackoverflow.com/questions/46294378/generate-random-numbers-until-a-certain/46294556#46294556", "title": "Generate Random Numbers Until a certain", "body": "<p>Try this out</p>\n\n<pre><code>$num = 0\nwhile $num != 7\n    $num = rand(1..10)\n    print $num.to_s + \"\\n\"\nend\nputs \"over\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3394, "user_id": 948169, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/109adf7a75c28e8955c31684b772ca27?s=128&d=identicon&r=PG", "display_name": "Mohanraj", "link": "https://stackoverflow.com/users/948169/mohanraj"}, "is_accepted": false, "score": 0, "last_activity_date": 1505806456, "creation_date": 1505806456, "answer_id": 46294588, "question_id": 46294378, "link": "https://stackoverflow.com/questions/46294378/generate-random-numbers-until-a-certain/46294588#46294588", "title": "Generate Random Numbers Until a certain", "body": "<p>You have to assign the <strong>rand</strong> generated value into num variable,</p>\n\n<pre><code>$ num = ''\n$ while num != 7\n$   num = rand(1..10)\n$   print num\n$ end\n$ # 6168510267=&gt; nil\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1505806518, "creation_date": 1505806518, "answer_id": 46294610, "question_id": 46294378, "link": "https://stackoverflow.com/questions/46294378/generate-random-numbers-until-a-certain/46294610#46294610", "title": "Generate Random Numbers Until a certain", "body": "<p>There are many ways to do it, for example:</p>\n\n<pre><code>loop do\n  num = rand(1..10)\n  print num\n  break if num == 7\nend\n</code></pre>\n\n<p>Also, to make your code work:</p>\n\n<pre><code>num = \"\"\nwhile num != '7'\n    num = rand(1..10).to_s\n    print num\nend\nputs \"over\"\n</code></pre>\n\n<p>reason in that you convert <code>num</code> to string and compare it with <code>integer</code></p>\n"}, {"comments": [{"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1505806827, "post_id": 46294656, "comment_id": 79551760, "body": "You should pre-define <code>number</code> in this case :)"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 1, "creation_date": 1505806965, "post_id": 46294656, "comment_id": 79551845, "body": "@AlexGolubenko, fixed :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505808383, "post_id": 46294656, "comment_id": 79552696, "body": "<code>to_i</code> is superfluous. And it might be cleaner to express the OP&#39;s requirement <i>&quot;until the number 7&quot;</i> as <code>until number == 7</code> ;-)"}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": false, "score": 2, "last_activity_date": 1505808471, "last_edit_date": 1505808471, "creation_date": 1505806666, "answer_id": 46294656, "question_id": 46294378, "link": "https://stackoverflow.com/questions/46294378/generate-random-numbers-until-a-certain/46294656#46294656", "title": "Generate Random Numbers Until a certain", "body": "<pre><code>puts (number = rand(1..10)) until number == 7\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 8385606, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10210010301119748/picture?type=large", "display_name": "Brian Ruff", "link": "https://stackoverflow.com/users/8385606/brian-ruff"}, "edited": false, "score": 1, "creation_date": 1505808092, "post_id": 46294773, "comment_id": 79552525, "body": "Thanks for the added lesson in there. Lot&#39;s of good answers on this, but I like that you added in that extra bit. You get the answer."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1505808733, "post_id": 46294773, "comment_id": 79552893, "body": "Shouldn&#39;t you increment <code>try</code> somewhere?"}, {"owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1505810302, "post_id": 46294773, "comment_id": 79553778, "body": "Sorry I forget to update, try in each loop pass, thanks @Stefan"}], "tags": [], "owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "is_accepted": true, "score": 0, "last_activity_date": 1505810275, "last_edit_date": 1505810275, "creation_date": 1505807073, "answer_id": 46294773, "question_id": 46294378, "link": "https://stackoverflow.com/questions/46294378/generate-random-numbers-until-a-certain/46294773#46294773", "title": "Generate Random Numbers Until a certain", "body": "<p>The problem for this code is that you generate an infinite loop because num is always \"\", you need to update the variable num inside the while loop like this:</p>\n\n<pre><code>num = \"\"\nwhile num != 7\n  num = rand(1..10)\n  puts num\nend\nputs \"over\"\n</code></pre>\n\n<p>in this case, you do not know when the loop will stop, but in each loop it can stop with probability 1/10, this is not a good practice, you nedd to know when the loop stops, so will be better to add a variable for maximum number of tries like this. And also you do not need to transform dthe number to string to print it:</p>\n\n<pre><code>num = 0\nmax_tries = 100\ntry = 1\nguess = 7\n\nwhile (try &lt; max_tries &amp;&amp; num != guess)\n  num = rand(1..10)\n  try = try + 1\n  puts num\nend\n\nif (try &gt;= max_tries)\n  puts \"you do not get the guess\"\nelse\n  puts \"over\"\nend\n</code></pre>\n\n<p>and you get this:</p>\n\n<pre><code>[4] pry(main)&gt; 9\n9\n3\n4\n9\n6\n9\n8\n4\n5\n9\n10\n4\n3\n7\nover\n=&gt; true\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 8385606, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10210010301119748/picture?type=large", "display_name": "Brian Ruff", "link": "https://stackoverflow.com/users/8385606/brian-ruff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1240, "favorite_count": 0, "accepted_answer_id": 46294773, "answer_count": 5, "score": 0, "last_activity_date": 1505810275, "creation_date": 1505805870, "last_edit_date": 1505806421, "question_id": 46294378, "link": "https://stackoverflow.com/questions/46294378/generate-random-numbers-until-a-certain", "title": "Generate Random Numbers Until a certain", "body": "<p>I am trying to write some code (using a while loop) that will generate random numbers (between 1 and 10) until the number 7 is generated.</p>\n\n<p>Here is what I've got so far, but it's just stuck in a loop of printing random numbers between 1 and 10.</p>\n\n<pre><code>num = \"\"\nwhile num != 7\n    print rand(1..10).to_s\nend\nputs \"over\"\n</code></pre>\n\n<p>I understand why it's looping without end, but I'm unsure of how else to generate the random numbers and still end the loop when a 7 appears.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 847, "user_id": 1963964, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/MLMKT.jpg?s=128&g=1", "display_name": "Roshan", "link": "https://stackoverflow.com/users/1963964/roshan"}, "edited": false, "score": 0, "creation_date": 1505805357, "post_id": 46294097, "comment_id": 79550734, "body": "show your current params."}, {"owner": {"reputation": 85, "user_id": 7141066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iYpXd.jpg?s=128&g=1", "display_name": "Vivek Dabhi", "link": "https://stackoverflow.com/users/7141066/vivek-dabhi"}, "reply_to_user": {"reputation": 847, "user_id": 1963964, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/MLMKT.jpg?s=128&g=1", "display_name": "Roshan", "link": "https://stackoverflow.com/users/1963964/roshan"}, "edited": false, "score": 0, "creation_date": 1505805820, "post_id": 46294097, "comment_id": 79551091, "body": "yes but time limitation error generate.  Unpermitted parameters: lat, lng  Geocoding API not responding fast enough (use Geocoder.configure(:timeout =&gt; ...) to set limit)."}, {"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1505806998, "post_id": 46294097, "comment_id": 79551872, "body": "What about setting a bigger <code>timeout</code>(as the message says) to see if u get a proper response, or try to measure how much time the request is really taking to see if there`s no problem if your code."}, {"owner": {"reputation": 159, "user_id": 6808888, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3f0a82e76ef385975db788e15b384b7c?s=128&d=identicon&r=PG&f=1", "display_name": "Harsha", "link": "https://stackoverflow.com/users/6808888/harsha"}, "edited": false, "score": 0, "creation_date": 1505813100, "post_id": 46294097, "comment_id": 79555607, "body": "Show your config"}], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 10161978, "user_type": "registered", "profile_image": "https://graph.facebook.com/716372562027755/picture?type=large", "display_name": "Linda Kadz", "link": "https://stackoverflow.com/users/10161978/linda-kadz"}, "is_accepted": false, "score": 1, "last_activity_date": 1542612879, "creation_date": 1542612879, "answer_id": 53370143, "question_id": 46294097, "link": "https://stackoverflow.com/questions/46294097/geocoding-api-not-responding-fast-enough-timeout-issue/53370143#53370143", "title": "Geocoding API not responding fast enough timeout issue", "body": "<p>This is late but it may help someone, create a file in config/initializers called geocoder.rb and add this line </p>\n\n<blockquote>\n  <p>Geocoder::Configuration.timeout = 15</p>\n</blockquote>\n"}], "owner": {"reputation": 85, "user_id": 7141066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iYpXd.jpg?s=128&g=1", "display_name": "Vivek Dabhi", "link": "https://stackoverflow.com/users/7141066/vivek-dabhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542612879, "creation_date": 1505804978, "question_id": 46294097, "link": "https://stackoverflow.com/questions/46294097/geocoding-api-not-responding-fast-enough-timeout-issue", "title": "Geocoding API not responding fast enough timeout issue", "body": "<p>Geocoding API not responding fast enough (use Geocoder.configure(:timeout => ...) to set limit).</p>\n\n<p>I have search by address that time API through I got a Latitude and Longitude but now generate unpermitted parameters for Latitude and Longitude.</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "sweetalert"], "comments": [{"owner": {"reputation": 550, "user_id": 7719205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lJjRz.jpg?s=128&g=1", "display_name": "Anand Choudhary", "link": "https://stackoverflow.com/users/7719205/anand-choudhary"}, "edited": false, "score": 0, "creation_date": 1505803022, "post_id": 46293457, "comment_id": 79549356, "body": "first, you need to add in gem file how to do that please refer to this link [<a href=\"https://github.com/mois3x/sweet-alert-rails-confirm]\" rel=\"nofollow noreferrer\">github.com/mois3x/sweet-alert-rails-confirm]</a>"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 8505287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ec258077d0c6e9cab00d37582876f3?s=128&d=identicon&r=PG&f=1", "display_name": "Hacker621", "link": "https://stackoverflow.com/users/8505287/hacker621"}, "edited": false, "score": 0, "creation_date": 1505804004, "post_id": 46293530, "comment_id": 79549894, "body": "I was asking how to make the item delete only when i confirm it on sweetalert . As of now , the item is getting deleted when i click on the trash icon ( used inside ruby tag ) without getting a confirmation from the sweetalert ( sweetalert box appears but it doesn&#39;t wait for my deletion confirmation ). My exact question was asked and solved in this link <a href=\"https://stackoverflow.com/questions/40579520/delete-method-with-sweet-alert-in-laravel\" title=\"delete method with sweet alert in laravel\">stackoverflow.com/questions/40579520/&hellip;</a> but its in laravel framework ."}, {"owner": {"reputation": 6190, "user_id": 2542525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SJz4a.jpg?s=128&g=1", "display_name": "Himanshu Upadhyay", "link": "https://stackoverflow.com/users/2542525/himanshu-upadhyay"}, "reply_to_user": {"reputation": 47, "user_id": 8505287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ec258077d0c6e9cab00d37582876f3?s=128&d=identicon&r=PG&f=1", "display_name": "Hacker621", "link": "https://stackoverflow.com/users/8505287/hacker621"}, "edited": false, "score": 0, "creation_date": 1505804148, "post_id": 46293530, "comment_id": 79549987, "body": "You have not posted the code which deletes the item. But what I can suggest you is, you call that delete item function inside <code>if (isConfirm) {}</code> so it will be called only if user clicks OK on sweet alert and if user clicks Cancel, the delete item function will not be called."}], "tags": [], "owner": {"reputation": 6190, "user_id": 2542525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SJz4a.jpg?s=128&g=1", "display_name": "Himanshu Upadhyay", "link": "https://stackoverflow.com/users/2542525/himanshu-upadhyay"}, "is_accepted": false, "score": 0, "last_activity_date": 1505804216, "last_edit_date": 1505804216, "creation_date": 1505803103, "answer_id": 46293530, "question_id": 46293457, "link": "https://stackoverflow.com/questions/46293457/delete-method-with-sweetalert-in-ruby-on-rails/46293530#46293530", "title": "Delete method with sweetalert in ruby on rails", "body": "<p>Here is the perfect example how you should use Sweet alert.</p>\n\n<pre><code>            swal({\n                title: \"Are you sure?\",\n                text: \"You will not be able to recover this imaginary file!\",\n                type: \"warning\",\n                showCancelButton: true,\n                confirmButtonClass: 'btn-danger',\n                confirmButtonText: 'Yes, delete it!',\n                cancelButtonText: \"No, cancel plx!\",\n                closeOnConfirm: false,\n                closeOnCancel: false\n            },\n            function (isConfirm) {\n                if (isConfirm) {\n                    // Call your delete item function here.\n                    swal(\"Deleted!\", \"Your imaginary file has been ted!\", \"success\");\n                } else {\n                swal(\"Cancelled\", \"Your imaginary file is safe :)\", \"error\");\n                }\n            });\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8505287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ec258077d0c6e9cab00d37582876f3?s=128&d=identicon&r=PG&f=1", "display_name": "Hacker621", "link": "https://stackoverflow.com/users/8505287/hacker621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 787, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505804216, "creation_date": 1505802863, "question_id": 46293457, "link": "https://stackoverflow.com/questions/46293457/delete-method-with-sweetalert-in-ruby-on-rails", "title": "Delete method with sweetalert in ruby on rails", "body": "<p>Hi I am new in using sweet alert js to make my alert box more fancy. I am using the normal javascript alert confirmation to delete a specific data in my table. However when I try to run a sweet alert confirmation before deleting it deletes the file without the confirmation popping up.</p>\n\n<p>Here is the code in my JS below.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>$(\".delete-alert\").click(function(event) {\r\n  event.preventDefault();\r\n  swal({\r\n  title: 'Are you sure?',\r\n  text: \"You won't be able to revert this!\",\r\n  type: 'warning',\r\n  showCancelButton: true,\r\n  confirmButtonColor: '#3085d6',\r\n  cancelButtonColor: '#d33',\r\n  confirmButtonText: 'Yes, delete it!'\r\n}).then(function () {\r\n  swal(\r\n    'Deleted!',\r\n    'Your file has been deleted.',\r\n    'success'\r\n  )\r\n});\r\n});</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>this is my ruby on rails with HTML which calls the above js when clicking on trash icon </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;%= link_to raw('&lt;i class=\"fa fa-trash delete-alert\"&gt;&lt;/i&gt;'), candidate_path(f.id),method: :delete %&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "class", "oop"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1505802553, "post_id": 46293304, "comment_id": 79549071, "body": "<a href=\"https://ruby-doc.org/core/Module.html#method-i-module_function\" rel=\"nofollow noreferrer\"><code>module_function :A</code></a> :: <i>Sidenote:</i> you should not call methods capitalized; there is nothing preventing you of doing so, but ruby has a convention to use capitalized names for very specific cases, like <code>Kernel#Integer</code> and family."}, {"owner": {"reputation": 303, "user_id": 6234188, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ee7757cab97d62eef070eb269f3bc96a?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ed7 Ti\u1ebfn", "link": "https://stackoverflow.com/users/6234188/%c4%90%e1%bb%97-ti%e1%ba%bfn"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1505803605, "post_id": 46293304, "comment_id": 79549683, "body": "Cold you please re-answer my question as a separate post so I can accept your answer?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1505803907, "post_id": 46293304, "comment_id": 79549843, "body": "<code>extend</code> only brings in the module&#39;s instance methods (yes, that is what they are called, even though modules don&#39;t have instances) as class methods. <code>extend</code> does nothing with the module&#39;s class methods (nor does <code>include</code>). Therefore, if  <code>A</code> (let&#39;s call it <code>a</code>) is the module&#39;s only instance method, there&#39;s nothing to do."}], "answers": [{"comments": [{"owner": {"reputation": 36888, "user_id": 293280, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6e6e22d81a1f4f394f62301be40c2e20?s=128&d=identicon&r=PG", "display_name": "Joshua Pinter", "link": "https://stackoverflow.com/users/293280/joshua-pinter"}, "edited": false, "score": 0, "creation_date": 1523198117, "post_id": 46293725, "comment_id": 86450829, "body": "<code>module_function</code> is a great find. It&#39;s particularly useful because I&#39;ll often have modules that <i>only</i> have &quot;module_functions&quot; so I just plop <code>module_function</code> at the top of the module and all the methods defined are accessed at the class level with having to use <code>module_function</code> or <code>self.</code> individually. Nice one."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 36888, "user_id": 293280, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6e6e22d81a1f4f394f62301be40c2e20?s=128&d=identicon&r=PG", "display_name": "Joshua Pinter", "link": "https://stackoverflow.com/users/293280/joshua-pinter"}, "edited": false, "score": 1, "creation_date": 1523201516, "post_id": 46293725, "comment_id": 86451918, "body": "@JoshuaPinter if you need a static module that defines class methods only, you\u2019d better use <code>class &lt;&lt; self ... end</code> around the methods, since <code>module_function</code> makes an instance method to be doubled as a class method as well, <i>leaving</i> an instance method inplace. It\u2019s basically the same as <code>extend self</code> in the very end of the module definition."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 9, "last_activity_date": 1523198052, "last_edit_date": 1523198052, "creation_date": 1505803818, "answer_id": 46293725, "question_id": 46293304, "link": "https://stackoverflow.com/questions/46293304/is-there-a-way-to-use-class-method-in-a-module-without-extend-it-in-rails/46293725#46293725", "title": "Is there a way to use class method in a module without extend it in rails?", "body": "<p>Use <a href=\"https://ruby-doc.org/core/Module.html#method-i-module_function\" rel=\"nofollow noreferrer\"><code>Module#module_function</code></a> to make a single function to be a module function:</p>\n\n<pre><code>module M\n  def m1; puts \"m1\"; end\n  def m2; puts \"m2\"; end\n  module_function :m2\nend\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>module M\n  def m1; puts \"m1\"; end\nmodule_function # from now on all functions are defined as module_functions\n  def m2; puts \"m2\"; end\nend\n\nM.m1 #\u21d2 NoMethodError: undefined method `m1' for M:Module\nM.m2 #\u21d2 \"m2\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3394, "user_id": 948169, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/109adf7a75c28e8955c31684b772ca27?s=128&d=identicon&r=PG", "display_name": "Mohanraj", "link": "https://stackoverflow.com/users/948169/mohanraj"}, "is_accepted": false, "score": 1, "last_activity_date": 1505826671, "last_edit_date": 1505826671, "creation_date": 1505803822, "answer_id": 46293727, "question_id": 46293304, "link": "https://stackoverflow.com/questions/46293304/is-there-a-way-to-use-class-method-in-a-module-without-extend-it-in-rails/46293727#46293727", "title": "Is there a way to use class method in a module without extend it in rails?", "body": "<p>Yes, you can define it as a <strong>module_function</strong>, then you should be able to access it using module name.</p>\n\n<p>Ex:</p>\n\n<pre><code>module Mod\n  def my_method\n    100\n  end\n\n  def self.my_method_1\n    200\n  end\n  module_function :my_method\nend\n\nMod.my_method\n# =&gt; 100\nMod.my_method_1\n# =&gt; 200\n</code></pre>\n\n<p>Note: No need to add the <strong>self defined methods in module_function</strong>, they are accessible directly. But it's needed for <strong>methods defined without self</strong></p>\n"}], "owner": {"reputation": 303, "user_id": 6234188, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ee7757cab97d62eef070eb269f3bc96a?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ed7 Ti\u1ebfn", "link": "https://stackoverflow.com/users/6234188/%c4%90%e1%bb%97-ti%e1%ba%bfn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 0, "accepted_answer_id": 46293725, "answer_count": 2, "score": 3, "last_activity_date": 1523198052, "creation_date": 1505802301, "question_id": 46293304, "link": "https://stackoverflow.com/questions/46293304/is-there-a-way-to-use-class-method-in-a-module-without-extend-it-in-rails", "title": "Is there a way to use class method in a module without extend it in rails?", "body": "<p>currently I have a module like this:</p>\n\n<pre><code>module MyModule\n  def A\n\n  end\n\n  .....\n\nend\n</code></pre>\n\n<p>and I have a model that I want to use that method A as a class method. However, the thing is I only need that A method. If I extend it, I am gonna extend the other unnecessary class methods into my model. Therefore, is there a way for me to do sth like MyModule.A without rewriting the module like this:</p>\n\n<pre><code>module MyModule\n  def A\n    ...\n  end\n\n  def self.A\n    ...\n  end\n\n  .....\n\nend\n</code></pre>\n\n<p>It is kind of repeating myself if I do it that way. I still feel there is a better way to do it in Rails.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "koala", "faraday"], "comments": [{"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1505808134, "post_id": 46293030, "comment_id": 79552552, "body": "Your net http call is timing out... the site you&#39;re accessing is taking more than 5 seconds to respond.  What are you trying to http to?"}, {"owner": {"reputation": 1259, "user_id": 361060, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/liuk3.png?s=128&g=1", "display_name": "Heisenberg", "link": "https://stackoverflow.com/users/361060/heisenberg"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1505842641, "post_id": 46293030, "comment_id": 79575149, "body": "I am trying to get an access token from facebook with oauth:       oauth = Koala::Facebook::OAuth.new(Rails.application.config.facebook&zwnj;&#8203;_app_id,                                        Rails.application.config.facebook_app_secret,                                        nil)"}, {"owner": {"reputation": 1259, "user_id": 361060, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/liuk3.png?s=128&g=1", "display_name": "Heisenberg", "link": "https://stackoverflow.com/users/361060/heisenberg"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1505843091, "post_id": 46293030, "comment_id": 79575367, "body": "I edited the code to include the code snippet, timeout is either getting access token or debug token, seems to have started 4pm PDT on Sept 13, also logged issue with facebook but wonder if there is also issue with gems"}], "answers": [{"tags": [], "owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "is_accepted": false, "score": 1, "last_activity_date": 1505880685, "creation_date": 1505880685, "answer_id": 46313159, "question_id": 46293030, "link": "https://stackoverflow.com/questions/46293030/rails-koala-faraday-gems-execution-expired-error/46313159#46313159", "title": "Rails - Koala / Faraday Gems Execution Expired Error", "body": "<p>This is <a href=\"https://github.com/lostisland/faraday/blob/master/lib/faraday/adapter/net_http.rb#L75\" rel=\"nofollow noreferrer\"><code>/lib/faraday/adapter/net_http.rb:82:in 'perform_request' method</code></a> where the execution is expired</p>\n\n<pre><code>  def perform_request(http, env)\n    if :get == env[:method] and !env[:body]\n      # prefer `get` to `request` because the former handles gzip (ruby 1.9)\n      http.get env[:url].request_uri, env[:request_headers]\n    else\n      # In your case you execture http.request\n      http.request create_request(env)\n    end\n  end\n</code></pre>\n\n<p>This is the Ruby Documentation <a href=\"http://ruby-doc.org/stdlib-2.4.1/libdoc/net/http/rdoc/Net/HTTP.html#method-i-request\" rel=\"nofollow noreferrer\">Net::HTTP.request</a> method, I underline</p>\n\n<blockquote>\n  <p><strong>Returns an HTTPResponse object.</strong> </p>\n</blockquote>\n\n<p>which is the <code>res</code> in the method and will be based on the <a href=\"http://ruby-doc.org/stdlib-2.4.1/libdoc/net/http/rdoc/Net/HTTPResponse.html\" rel=\"nofollow noreferrer\"><code>Net::HTTPResponse</code> ruby class</a></p>\n\n<p>Also I would focus on how the <code>request</code> is made, because I believe some parameters are being passed incorrectly and this is the reason the response take so long. So we should focus on the request body, header and all the other information.</p>\n\n<pre><code># File net/http.rb, line 1421\ndef request(req, body = nil, &amp;block)  # :yield: +response+\n  unless started?\n    start {\n      req['connection'] ||= 'close'\n      return request(req, body, &amp;block)\n    }\n  end\n  if proxy_user()\n    req.proxy_basic_auth proxy_user(), proxy_pass() unless use_ssl?\n  end\n  req.set_body_internal body\n  res = transport_request(req, &amp;block)\n  if sspi_auth?(res)\n    sspi_auth(req)\n    res = transport_request(req, &amp;block)\n  end\n  res\nend\n</code></pre>\n\n<p>So what about printing some additional log information in your production server log, you can open this files <code>/usr/lib/ruby/1.9.2/net/http.rb:1168:in 'request'</code> and <code>/usr/lib/ruby/gems/1.9.2/gems/faraday-0.9.2/lib/faraday/adapter/net_http.rb:82:in 'perform_request'</code>, to write some <code>puts</code> statements on some variable that should output in your production log.</p>\n\n<p>You also need to make sure that the rails app log is configured to print them.</p>\n"}], "owner": {"reputation": 1259, "user_id": 361060, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/liuk3.png?s=128&g=1", "display_name": "Heisenberg", "link": "https://stackoverflow.com/users/361060/heisenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505880685, "creation_date": 1505801329, "last_edit_date": 1505842867, "question_id": 46293030, "link": "https://stackoverflow.com/questions/46293030/rails-koala-faraday-gems-execution-expired-error", "title": "Rails - Koala / Faraday Gems Execution Expired Error", "body": "<p>I am working on a rails application that uses Koala gem (v2.2) and Faraday (0.9.2). It seems like a lot of the facebook requests are erroring out with execution required and Im not sure why. Here is a stack trace. I would be grateful on help on how to troubleshoot this issue,</p>\n\n<p>Here is the code snippet, it either fails on oauth.get_app_access_token or app_graph.debug_token</p>\n\n<pre><code>oauth = Koala::Facebook::OAuth.new(Rails.application.config.facebook_app_id,\n                                   Rails.application.config.facebook_app_secret,\n                                   nil)\n\napp_access_token = oauth.get_app_access_token # fails here\napp_graph = Koala::Facebook::API.new(app_access_token)\ntoken_info = app_graph.debug_token(atoken) # or fails here\n</code></pre>\n\n<p>Here is the error:</p>\n\n<pre><code>ERROR: execution expired \n /usr/lib/ruby/1.9.2/net/http.rb:644:in `initialize' \n /usr/lib/ruby/1.9.2/net/http.rb:644:in `open' \n /usr/lib/ruby/1.9.2/net/http.rb:644:in `block in connect' \n /usr/lib/ruby/1.9.2/net/http.rb:644:in `connect' \n /usr/lib/ruby/1.9.2/net/http.rb:637:in `do_start' \n /usr/lib/ruby/1.9.2/net/http.rb:626:in `start' \n /usr/lib/ruby/1.9.2/net/http.rb:1168:in `request' \n /usr/lib/ruby/gems/1.9.2/gems/faraday-0.9.2/lib/faraday/adapter/net_http.rb:82:in `perform_request' \n /usr/lib/ruby/gems/1.9.2/gems/faraday-0.9.2/lib/faraday/adapter/net_http.rb:40:in `block in call' \n /usr/lib/ruby/gems/1.9.2/gems/faraday-0.9.2/lib/faraday/adapter/net_http.rb:87:in `with_net_http_connection' \n /usr/lib/ruby/gems/1.9.2/gems/faraday-0.9.2/lib/faraday/adapter/net_http.rb:32:in `call' \n /usr/lib/ruby/gems/1.9.2/gems/faraday-0.9.2/lib/faraday/request/url_encoded.rb:15:in `call' \n /usr/lib/ruby/gems/1.9.2/gems/faraday-0.9.2/lib/faraday/request/multipart.rb:14:in `call' \n /usr/lib/ruby/gems/1.9.2/gems/faraday-0.9.2/lib/faraday/rack_builder.rb:139:in `build_response' \n /usr/lib/ruby/gems/1.9.2/gems/faraday-0.9.2/lib/faraday/connection.rb:377:in `run_request' \n /usr/lib/ruby/gems/1.9.2/gems/faraday-0.9.2/lib/faraday/connection.rb:177:in `post' \n /usr/lib/ruby/gems/1.9.2/gems/koala-2.2.0/lib/koala/http_service.rb:113:in `make_request' \n /usr/lib/ruby/gems/1.9.2/gems/koala-2.2.0/lib/koala.rb:64:in `make_request' \n /usr/lib/ruby/gems/1.9.2/gems/koala-2.2.0/lib/koala/oauth.rb:306:in `fetch_token_string' \n /usr/lib/ruby/gems/1.9.2/gems/koala-2.2.0/lib/koala/oauth.rb:258:in `get_token_from_server' \n /usr/lib/ruby/gems/1.9.2/gems/koala-2.2.0/lib/koala/oauth.rb:189:in `get_app_access_token_info' \n /usr/lib/ruby/gems/1.9.2/gems/koala-2.2.0/lib/koala/oauth.rb:199:in `get_app_access_token' \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"tags": [], "owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "is_accepted": true, "score": 6, "last_activity_date": 1505797878, "creation_date": 1505797878, "answer_id": 46292275, "question_id": 46292192, "link": "https://stackoverflow.com/questions/46292192/undefined-method-skip-before-action-when-skipping-authentication-in-devise/46292275#46292275", "title": "undefined method `skip_before_action&#39; when skipping authentication in Devise", "body": "<p>Please try the below</p>\n\n<p><code>skip_before_action</code> is should be out side of the <code>index</code> method scope. As <code>before_action</code> or <code>skip_before_action</code> is a class method. Should not call it inside in an instance method(index)</p>\n\n<pre><code>class DevController &lt; ApplicationController\n skip_before_action :authenticate_user!, :only =&gt; [:index]\n\n  def index\n  end\nend\n</code></pre>\n\n<p>Please <a href=\"https://apidock.com/rails/v4.0.2/AbstractController/Callbacks/ClassMethods/skip_before_action\" rel=\"noreferrer\">refer</a></p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1505830587, "post_id": 46302460, "comment_id": 79568009, "body": "Can you explain why this answer offers anything in addition to the one posted 9 hours earlier?"}], "tags": [], "owner": {"reputation": 467, "user_id": 6863652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ee89337e6aead8c5203cbac4fccc5aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mansi Shah", "link": "https://stackoverflow.com/users/6863652/mansi-shah"}, "is_accepted": false, "score": 1, "last_activity_date": 1505834993, "last_edit_date": 1505834993, "creation_date": 1505829555, "answer_id": 46302460, "question_id": 46292192, "link": "https://stackoverflow.com/questions/46292192/undefined-method-skip-before-action-when-skipping-authentication-in-devise/46302460#46302460", "title": "undefined method `skip_before_action&#39; when skipping authentication in Devise", "body": "<p>As <code>skip_before_action</code> is a Class method, it can't be called from instance method.<br>\nIt's also known as callback method, <a href=\"http://api.rubyonrails.org/v5.1/classes/AbstractController/Callbacks/ClassMethods.html\" rel=\"nofollow noreferrer\">here</a> are other methods.                 </p>\n\n<p>You can update code as,</p>\n\n<pre><code>class DevController &lt; ApplicationController\n  skip_before_action :authenticate_user!, :only =&gt; [:index]\n\n  def index\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 945, "user_id": 5269750, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/478621712312068/picture?type=large", "display_name": "Sai Ram Reddy", "link": "https://stackoverflow.com/users/5269750/sai-ram-reddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1505848785, "creation_date": 1505848785, "answer_id": 46308260, "question_id": 46292192, "link": "https://stackoverflow.com/questions/46292192/undefined-method-skip-before-action-when-skipping-authentication-in-devise/46308260#46308260", "title": "undefined method `skip_before_action&#39; when skipping authentication in Devise", "body": "<p>If <code>skip_before_action</code> seems to be confusing you can use <code>before_action</code> like below</p>\n\n<pre><code>  before_action :authenticate_user! , except:[index]\n</code></pre>\n"}], "owner": {"reputation": 587, "user_id": 1473641, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2e1f431cce8a104400fc6ef5f3da497a?s=128&d=identicon&r=PG", "display_name": "Prox", "link": "https://stackoverflow.com/users/1473641/prox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1667, "favorite_count": 0, "accepted_answer_id": 46292275, "answer_count": 3, "score": 0, "last_activity_date": 1505848785, "creation_date": 1505797449, "question_id": 46292192, "link": "https://stackoverflow.com/questions/46292192/undefined-method-skip-before-action-when-skipping-authentication-in-devise", "title": "undefined method `skip_before_action&#39; when skipping authentication in Devise", "body": "<p>I am using this guide for setting up Devise in Rails:\n<a href=\"http://codepany.com/blog/rails-5-user-accounts-with-3-types-of-roles-devise-rails_admin-cancancan/\" rel=\"nofollow noreferrer\">http://codepany.com/blog/rails-5-user-accounts-with-3-types-of-roles-devise-rails_admin-cancancan/</a></p>\n\n<p>It says to place this on your home controller to keep Devise from requesting authentication on your home page:</p>\n\n<pre><code>skip_before_action :authenticate_user!, :only =&gt; [:index]\n</code></pre>\n\n<p>My home controller is called dev so my dev_controller.rb looks like this:</p>\n\n<pre><code>class DevController &lt; ApplicationController\n  def index\n\n  skip_before_action :authenticate_user!, :only =&gt; [:index]\n\n  end\nend\n</code></pre>\n\n<p>Now when I visit my website, I get this error:</p>\n\n<pre><code>undefined method `before_action' for #&lt;MenuController:0xb193b640&gt;\n</code></pre>\n\n<p>Any ideas on why I get this error?</p>\n"}]