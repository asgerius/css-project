[{"tags": ["ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 32, "user_id": 8163153, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/9fPEg.png?s=128&g=1", "display_name": "giarcnappel", "link": "https://stackoverflow.com/users/8163153/giarcnappel"}, "edited": false, "score": 0, "creation_date": 1497509503, "post_id": 44558174, "comment_id": 76110259, "body": "Thanks for the help"}, {"owner": {"reputation": 32, "user_id": 8163153, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/9fPEg.png?s=128&g=1", "display_name": "giarcnappel", "link": "https://stackoverflow.com/users/8163153/giarcnappel"}, "edited": false, "score": 0, "creation_date": 1497510112, "post_id": 44558174, "comment_id": 76110586, "body": "This worked but all items were entered with nil values. I think my issue is as you have said getting the variables declared however the variables are a function of the loop so its not coming from the view but needs to be done in the model.     usdzar_id =&gt; usdzar.id,     smoothval_id =&gt; smoothval.id,     smprice =&gt; 99 will this not declare and assign?"}, {"owner": {"reputation": 584, "user_id": 7159326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3bce136965a79ceb3a45f93bdbac3c?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane El Kesri", "link": "https://stackoverflow.com/users/7159326/othmane-el-kesri"}, "reply_to_user": {"reputation": 32, "user_id": 8163153, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/9fPEg.png?s=128&g=1", "display_name": "giarcnappel", "link": "https://stackoverflow.com/users/8163153/giarcnappel"}, "edited": false, "score": 0, "creation_date": 1497510296, "post_id": 44558174, "comment_id": 76110701, "body": "why  don&#39;t you run this method on your controller, and avoid using before_save. This solution might generate an infinite loop"}, {"owner": {"reputation": 32, "user_id": 8163153, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/9fPEg.png?s=128&g=1", "display_name": "giarcnappel", "link": "https://stackoverflow.com/users/8163153/giarcnappel"}, "edited": false, "score": 0, "creation_date": 1497510702, "post_id": 44558174, "comment_id": 76110948, "body": "The maths is going to be very complex as I still need to do this, was just trying to get the loop to work. The smoothing is going to start with the difference between the price and the price the day before and apply a percentage (fval) then be added to the day before price. Then the second smoothing using the output of the first (((worked price - worked out price day before)*sval) + day before 1st smoothed price) is done so it will be very long. Maybe its best to do a trigger in PSQL? Will try this in controller and let you know"}, {"owner": {"reputation": 584, "user_id": 7159326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3bce136965a79ceb3a45f93bdbac3c?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane El Kesri", "link": "https://stackoverflow.com/users/7159326/othmane-el-kesri"}, "reply_to_user": {"reputation": 32, "user_id": 8163153, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/9fPEg.png?s=128&g=1", "display_name": "giarcnappel", "link": "https://stackoverflow.com/users/8163153/giarcnappel"}, "edited": false, "score": 0, "creation_date": 1497510982, "post_id": 44558174, "comment_id": 76111122, "body": "My point is that you can test this loop by calling it in your controller, without the before_save callback. Because, we don&#39;t, generally, create objects on a before_save"}, {"owner": {"reputation": 32, "user_id": 8163153, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/9fPEg.png?s=128&g=1", "display_name": "giarcnappel", "link": "https://stackoverflow.com/users/8163153/giarcnappel"}, "edited": false, "score": 0, "creation_date": 1498073404, "post_id": 44558174, "comment_id": 76353605, "body": "Thanks Othmane : I have added into the controller and got it all to work. I will try and update it to show you. New at this need to read more about how to use SO."}], "tags": [], "owner": {"reputation": 584, "user_id": 7159326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3bce136965a79ceb3a45f93bdbac3c?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane El Kesri", "link": "https://stackoverflow.com/users/7159326/othmane-el-kesri"}, "is_accepted": false, "score": 0, "last_activity_date": 1497498326, "creation_date": 1497498326, "answer_id": 44558174, "question_id": 44556398, "link": "https://stackoverflow.com/questions/44556398/creating-rows-in-table-related-to-2-others/44558174#44558174", "title": "Creating rows in table related to 2 others", "body": "<p>In your <code>create_smoothings</code> method, the variable usdzar is not defined. The problem  is in your upto loop, change your method to this :</p>\n\n<pre><code>def create_smoothings\n smoothval = Smoothval.find(smoothval_id) \n Usdzar.all.each do |usdzar|\n  Smoothing.create!(\n    usdzar_id =&gt; usdzar.id,\n    smoothval_id =&gt; smoothval.id,\n    smprice =&gt; 99\n    )\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32, "user_id": 8163153, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/9fPEg.png?s=128&g=1", "display_name": "giarcnappel", "link": "https://stackoverflow.com/users/8163153/giarcnappel"}, "is_accepted": false, "score": 0, "last_activity_date": 1497811907, "creation_date": 1497811907, "answer_id": 44618392, "question_id": 44556398, "link": "https://stackoverflow.com/questions/44556398/creating-rows-in-table-related-to-2-others/44618392#44618392", "title": "Creating rows in table related to 2 others", "body": "<p>The solution I got to using controller: I will move it to model but got it working for now</p>\n\n<p># POST /smoothings\n  def create</p>\n\n<pre><code>@sv = Smoothval.find(smoothing_params[:smoothval_id])\n\nUsdzar.all.each do |usdzar|\n    Smoothing.create!(\n    usdzar_id: usdzar.id,\n    smoothval_id: @sv.id,\n    smprice: 99\n    )\nend\nredirect_to smoothings_url, notice: 'Smoothings successfully created.'\n</code></pre>\n\n<p>end</p>\n\n<h1>Not using  nested attributes_for</h1>\n"}, {"tags": [], "owner": {"reputation": 32, "user_id": 8163153, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/9fPEg.png?s=128&g=1", "display_name": "giarcnappel", "link": "https://stackoverflow.com/users/8163153/giarcnappel"}, "is_accepted": false, "score": 0, "last_activity_date": 1498073811, "creation_date": 1498073811, "answer_id": 44684896, "question_id": 44556398, "link": "https://stackoverflow.com/questions/44556398/creating-rows-in-table-related-to-2-others/44684896#44684896", "title": "Creating rows in table related to 2 others", "body": "<p>Done in the Controller</p>\n\n<p># POST /smoothings\n  def create</p>\n\n<pre><code>sv = Smoothval.find(smoothing_params[:smoothval_id])\nfval = sv.fval\nsval = sv.sval\n\n\n\nUsdzar.all.each do |usdzar|\n\n    if usdzar.id == 1\n      prevusdzar = usdzar.price\n      prevfirstsmprice = usdzar.price\n    else\n      previd = (usdzar.id) - 1\n      prevusdzar = Usdzar.find(previd).price\n      prevfirstsmprice = Smoothing.find(previd).firstsmprice\n    end\n\n    firstsmprice = (((fval * usdzar.delta)/100) + prevusdzar)\n\n    firstsmdelta = firstsmprice - prevfirstsmprice\n\n    finalsmprice = (((sval * firstsmdelta)/100) + prevfirstsmprice)\n\n    Smoothing.create!(\n      usdzar_id: usdzar.id,\n      smoothval_id: sv.id,\n      firstsmprice: firstsmprice,\n      firstsmdelta: firstsmdelta,\n      finalsmprice: finalsmprice\n    )\nend\n\n\nredirect_to smoothings_url, notice: 'Smoothings successfully created.'\n</code></pre>\n\n<p>end</p>\n\n<p>If I were to add it to the model what action would I use before the save?\nI am not finished doing calculation so its getting quite long, probable need some comments.  </p>\n"}], "owner": {"reputation": 32, "user_id": 8163153, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/9fPEg.png?s=128&g=1", "display_name": "giarcnappel", "link": "https://stackoverflow.com/users/8163153/giarcnappel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1498073811, "creation_date": 1497484213, "last_edit_date": 1497486223, "question_id": 44556398, "link": "https://stackoverflow.com/questions/44556398/creating-rows-in-table-related-to-2-others", "title": "Creating rows in table related to 2 others", "body": "<p>Have models:</p>\n\n<pre><code>class Usdzar &lt; ActiveRecord::Base\n    has_many :smoothings\n    has_many :smoothvals, through: :smoothings\nend\n\nclass Smoothval &lt; ActiveRecord::Base\n    has_many :smoothprices\n    has_many :usdzars, through: :smoothings\nend\n\nclass Smoothing &lt; ActiveRecord::Base\n\n    belongs_to :usdzar\n    belongs_to :smoothval\n\n    accepts_nested_attributes_for :smoothval\n    accepts_nested_attributes_for :usdzar\n\n    before_save :create_smoothings\n\n    def create_smoothings\n    smoothval = Smoothval.find(smoothval_id) \n    1.upto(Usdzar.count) do\n      Smoothing.create!(\n        usdzar_id =&gt; usdzar.id,\n        smoothval_id =&gt; smoothval.id,\n        smprice =&gt; 99\n        )\n    end\nend\n</code></pre>\n\n<p>Using the smoothings controller I am from the view action setting the value of the smoothval and then from the entries in this table want to perform calculations on every row in the usdzar table on price. The output I want to insert into smoothing table. Every price id should then end up with a smprice id calculated from fval and sval.</p>\n\n<p>My method was a test just to get the loop working but it is failing.</p>\n\n<p>Migrations:</p>\n\n<pre><code>class CreateSmoothings &lt; ActiveRecord::Migration\n  def change\n    create_table :smoothings do |t|\n      t.decimal :smprice,   :precision =&gt; 8, :scale =&gt; 5\n      t.references :usdzar, index: true, foreign_key: true\n      t.references :smoothval, index: true, foreign_key: true\n\n      t.timestamps null: false\n    end\n    add_index :smoothings, :smprice\n  end\nend\n\nclass CreateSmoothvals &lt; ActiveRecord::Migration\n  def change\n    create_table :smoothvals do |t|\n      t.decimal :fval, :precision =&gt; 2, :scale =&gt; 0\n      t.decimal :sval, :precision =&gt; 2, :scale =&gt; 0\n      t.string :name\n      t.string :nickname\n\n      t.timestamps null: false\n    end\n    add_index :smoothvals, :name\n  end\nend\n\nclass CreateUsdzars &lt; ActiveRecord::Migration\n  def change\n    create_table :usdzars do |t|\n      t.date :day\n      t.decimal :price,   :precision =&gt; 8, :scale =&gt; 5\n      t.decimal :delta,   :precision =&gt; 8, :scale =&gt; 5\n\n      t.timestamps null: false\n    end\n    add_index :usdzars, :day\n    add_index :usdzars, :price\n  end\nend\n</code></pre>\n\n<p>'localhost:3000/smoothings/new' (I am selecting the smoothval to be used to perform the calculations from a DD list:</p>\n\n<pre><code>&lt;%= form_for(@smoothing) do |f| %&gt;\n  &lt;% if @smoothing.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@smoothing.errors.count, \"error\") %&gt; prohibited this smoothing from being saved:&lt;/h2&gt;\n      &lt;ul&gt;\n      &lt;% @smoothing.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :smoothvals %&gt;&lt;br&gt;\n    &lt;%= f.collection_select :smoothval_id, Smoothval.all, :id, :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When submitting I get:</p>\n\n<pre><code>undefined method `id' for nil:NilClass\n\n      Smoothing.create!(\n        usdzar_id =&gt; usdzar.id,\n        smoothval_id =&gt; smoothval.id,\n        smprice =&gt; 99\n      )\n</code></pre>\n\n<p>My strong params:</p>\n\n<pre><code>params.require(:smoothing).permit(:smprice, :usdzar_id, :smoothval_id, :usdzars_attributes =&gt; [:id, :price, :delta])\n</code></pre>\n\n<p>Can someone let give me an idea why its doing this and what a better approach may be? </p>\n"}, {"tags": ["ruby", "linux", "ubuntu", "rvm", "ubuntu-16.04"], "answers": [{"comments": [{"owner": {"reputation": 1095, "user_id": 5004690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6LQZv.jpg?s=128&g=1", "display_name": "TamerB", "link": "https://stackoverflow.com/users/5004690/tamerb"}, "reply_to_user": {"reputation": 400, "user_id": 3280918, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/L2ZAY.jpg?s=128&g=1", "display_name": "Plavookac", "link": "https://stackoverflow.com/users/3280918/plavookac"}, "edited": false, "score": 1, "creation_date": 1515864326, "post_id": 44557636, "comment_id": 83467112, "body": "I&#39;m Glade it helped :)"}, {"owner": {"reputation": 57, "user_id": 2452196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXhqG.png?s=128&g=1", "display_name": "fcfeitosa", "link": "https://stackoverflow.com/users/2452196/fcfeitosa"}, "edited": false, "score": 0, "creation_date": 1610556744, "post_id": 44557636, "comment_id": 116173510, "body": "For MAC just replace apt-get to brew"}], "tags": [], "owner": {"reputation": 1095, "user_id": 5004690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6LQZv.jpg?s=128&g=1", "display_name": "TamerB", "link": "https://stackoverflow.com/users/5004690/tamerb"}, "is_accepted": true, "score": 33, "last_activity_date": 1497494338, "creation_date": 1497494338, "answer_id": 44557636, "question_id": 44555760, "link": "https://stackoverflow.com/questions/44555760/cant-install-ruby-rvm-on-ubuntu-16-04-due-to-gpg-bug/44557636#44557636", "title": "Can&#39;t install Ruby rvm on Ubuntu 16.04 due to gpg bug", "body": "<p>After trying many ways. I did succeed to install rails as follows:</p>\n\n<pre><code>$ \\curl -sSL https://get.rvm.io | bash\n$ source /home/&lt;user&gt;/.rvm/scripts/rvm\n$ rvm -v\n$ rvm install ruby\n$ ruby -v\n$ sudo apt-get install rubygems\n$ gem update\n$ sudo apt-get install ruby-dev zlib1g-dev liblzma-dev build-essential patch\n$ rvm gemset list\n$ gem install rails\n$ rails -v\n</code></pre>\n\n<p>Where \"user\" is my username</p>\n"}, {"comments": [{"owner": {"reputation": 1095, "user_id": 5004690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6LQZv.jpg?s=128&g=1", "display_name": "TamerB", "link": "https://stackoverflow.com/users/5004690/tamerb"}, "edited": false, "score": 0, "creation_date": 1512726672, "post_id": 47213481, "comment_id": 82383258, "body": "I tried this approach too first. But, for some reason, it didn&#39;t work for me on Ubuntu 16.04 LTS. Good to know that it works on Debian :)"}], "tags": [], "owner": {"reputation": 480, "user_id": 3298688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b1348e9018824e2e418fac9b361615?s=128&d=identicon&r=PG&f=1", "display_name": "FaithoftheFallen", "link": "https://stackoverflow.com/users/3298688/faithofthefallen"}, "is_accepted": false, "score": 2, "last_activity_date": 1510270905, "creation_date": 1510270905, "answer_id": 47213481, "question_id": 44555760, "link": "https://stackoverflow.com/questions/44555760/cant-install-ruby-rvm-on-ubuntu-16-04-due-to-gpg-bug/47213481#47213481", "title": "Can&#39;t install Ruby rvm on Ubuntu 16.04 due to gpg bug", "body": "<p>I had the same issue but on Debian and I took an alternate approach. In the error message, it says this: \"Try to install GPG v2 and then fetch the public key:\" with a <code>gpg2</code> command after it. I went and installed gpg2 first and ran the command it told me to and it worked for me.</p>\n\n<pre><code>sudo apt-get install gnupg2\nsudo apt-get install dirmngr\ngpg2 --recv-keys &lt;key&gt;\n# &lt;Run curl command to install rvm&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2695, "user_id": 6488361, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QLWMu.jpg?s=128&g=1", "display_name": "Kaka Ruto", "link": "https://stackoverflow.com/users/6488361/kaka-ruto"}, "edited": false, "score": 4, "creation_date": 1548096213, "post_id": 51279281, "comment_id": 95412475, "body": "For Mac users who find themselves on this page, use <code>brew install gpg gpg2</code>"}, {"owner": {"reputation": 1798, "user_id": 2636454, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FyyQr.png?s=128&g=1", "display_name": "GDP2", "link": "https://stackoverflow.com/users/2636454/gdp2"}, "edited": false, "score": 1, "creation_date": 1548707628, "post_id": 51279281, "comment_id": 95630621, "body": "This was the solution that worked for me, due to releases being signed by Piotr Kuczynski instead of Michal Papis. <a href=\"https://github.com/rvm/rvm/issues/4520\" rel=\"nofollow noreferrer\">See this ticket</a> in the RVM repository."}, {"owner": {"reputation": 35167, "user_id": 46194, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4eca63bc630dcac855080d2871f73ee7?s=128&d=identicon&r=PG", "display_name": "Klas Mellbourn", "link": "https://stackoverflow.com/users/46194/klas-mellbourn"}, "edited": false, "score": 2, "creation_date": 1549665999, "post_id": 51279281, "comment_id": 95998846, "body": "The key server suggested did not work for me, but the following did work: <code>gpg --keyserver hkp:&#47;&#47;pool.sks-keyservers.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB</code>"}], "tags": [], "owner": {"reputation": 401, "user_id": 7562451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15309228645175e3511490021c59d862?s=128&d=identicon&r=PG&f=1", "display_name": "Vigneshwaran Sivalingam", "link": "https://stackoverflow.com/users/7562451/vigneshwaran-sivalingam"}, "is_accepted": false, "score": 28, "last_activity_date": 1531292979, "creation_date": 1531292979, "answer_id": 51279281, "question_id": 44555760, "link": "https://stackoverflow.com/questions/44555760/cant-install-ruby-rvm-on-ubuntu-16-04-due-to-gpg-bug/51279281#51279281", "title": "Can&#39;t install Ruby rvm on Ubuntu 16.04 due to gpg bug", "body": "<p>I am just posting an update solution for it as I faced the same issue in Ubuntu 18.04 while trying to fetch keys for RVM.</p>\n\n<p>The following method is provided by RVM.</p>\n\n<pre><code>gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB\n</code></pre>\n\n<p>If it doesn't work out and you try to install rvm directly, the process will fail and provides three suggestions to receive keys. One of which have a step to receive the keys with gpg2.</p>\n\n<p>Install gpg2 in your system before that.</p>\n\n<pre><code>sudo apt install gnupg2\n</code></pre>\n\n<p>The command is</p>\n\n<pre><code>gpg2 --recv-keys 7D2BAF1CF37B13E2069D6956105BD0E739499BDB\n</code></pre>\n\n<p>But this command too will not work.\nSo here's an alternative. Just replace the gpg from the older command to gpg2 which worked for me.</p>\n\n<pre><code>gpg2 --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 689, "user_id": 6875032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-pEpLGvyz1dY/AAAAAAAAAAI/AAAAAAAAACA/4gszqmSfyJU/photo.jpg?sz=128", "display_name": "JSnow", "link": "https://stackoverflow.com/users/6875032/jsnow"}, "is_accepted": false, "score": 4, "last_activity_date": 1536746730, "creation_date": 1536746730, "answer_id": 52292596, "question_id": 44555760, "link": "https://stackoverflow.com/questions/44555760/cant-install-ruby-rvm-on-ubuntu-16-04-due-to-gpg-bug/52292596#52292596", "title": "Can&#39;t install Ruby rvm on Ubuntu 16.04 due to gpg bug", "body": "<p>In addition to the previous answers, if you are behind a firewall, the following command might not work for you.</p>\n\n<pre><code>gpg2 --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB\n</code></pre>\n\n<p>In that case, you can use the following command to get the keys -</p>\n\n<p><code>sudo apt-key adv --keyserver hkp://keys.gnupg.net:80 --recv-keys &lt;&lt;key&gt;&gt; &lt;&lt;key&gt;&gt;</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12437823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAWwQ1GqGfpVr2MsdkQzePH3u1E80iOvpskI7cSIQ=k-s128", "display_name": "Manoj Mirji", "link": "https://stackoverflow.com/users/12437823/manoj-mirji"}, "is_accepted": false, "score": 0, "last_activity_date": 1595835402, "creation_date": 1595835402, "answer_id": 63110714, "question_id": 44555760, "link": "https://stackoverflow.com/questions/44555760/cant-install-ruby-rvm-on-ubuntu-16-04-due-to-gpg-bug/63110714#63110714", "title": "Can&#39;t install Ruby rvm on Ubuntu 16.04 due to gpg bug", "body": "<p>I had issues in receiving the server keys and switched the key server to an alternative list mentioned in <a href=\"https://rvm.io/rvm/security\" rel=\"nofollow noreferrer\">https://rvm.io/rvm/security</a></p>\n<ol>\n<li>hkp://ipv4.pool.sks-keyservers.net</li>\n<li>hkp://pgp.mit.edu</li>\n<li>hkp://keyserver.pgp.com</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14732706, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f4460f58dfd4d858d3d57d23a171d51a?s=128&d=identicon&r=PG", "display_name": "user14732706", "link": "https://stackoverflow.com/users/14732706/user14732706"}, "is_accepted": false, "score": 0, "last_activity_date": 1606712235, "last_edit_date": 1606712235, "creation_date": 1606709489, "answer_id": 65068016, "question_id": 44555760, "link": "https://stackoverflow.com/questions/44555760/cant-install-ruby-rvm-on-ubuntu-16-04-due-to-gpg-bug/65068016#65068016", "title": "Can&#39;t install Ruby rvm on Ubuntu 16.04 due to gpg bug", "body": "<p>This appear a port issue, Try this:</p>\n<pre><code>gpg --keyserver hkp://keys.gnupg.net:80 --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3\n</code></pre>\n"}], "owner": {"reputation": 1095, "user_id": 5004690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6LQZv.jpg?s=128&g=1", "display_name": "TamerB", "link": "https://stackoverflow.com/users/5004690/tamerb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13340, "favorite_count": 12, "accepted_answer_id": 44557636, "answer_count": 6, "score": 17, "last_activity_date": 1606712235, "creation_date": 1497479672, "last_edit_date": 1548957505, "question_id": 44555760, "link": "https://stackoverflow.com/questions/44555760/cant-install-ruby-rvm-on-ubuntu-16-04-due-to-gpg-bug", "title": "Can&#39;t install Ruby rvm on Ubuntu 16.04 due to gpg bug", "body": "<p>I'm trying to install Ruby on Ubuntu 16.04. However when I enter to following command to terminal:</p>\n\n<pre><code>$ \\curl -sSL https://get.rvm.io | bash -s stable --ruby\n</code></pre>\n\n<p>I get the following:</p>\n\n<pre><code>Downloading https://github.com/rvm/rvm/archive/1.29.1.tar.gz\nDownloading https://github.com/rvm/rvm/releases/download/1.29.1/1.29.1.tar.gz.asc\ngpg: Signature made 19 \u0641\u0628\u0631, 2017 EET 10:02:47 \u0645 using RSA key ID ********\ngpg: Can't check signature: No public key\nWarning, RVM 1.26.0 introduces signed releases and automated check of signatures when GPG software found. Assuming you trust Michal Papis import the mpapis public key (downloading the signatures).\n\nGPG signature verification failed for '/home/tamer/.rvm/archives/rvm-1.29.1.tgz' - 'https://github.com/rvm/rvm/releases/download/1.29.1/1.29.1.tar.gz.asc'! Try to install GPG v2 and then fetch the public key:\n\ngpg2 --keyserver hkp://keys.gnupg.net --recv-keys ****************************************\n\nor if it fails:\n\ncommand curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -\n\nthe key can be compared with:\n\nhttps://rvm.io/mpapis.asc\nhttps://keybase.io/mpapis\n\nNOTE: GPG version 2.1.17 have a bug which cause failures during fetching keys from remote server. Please downgrade or upgrade to newer version (if available) or use the second method described above.\n</code></pre>\n\n<p>When I tried any rvm command I got 'command not found'.</p>\n\n<p>I tried requesting <a href=\"https://rvm.io/mpapis.asc\" rel=\"noreferrer\">https://rvm.io/mpapis.asc</a> through the browser. Then running the following:</p>\n\n<pre><code>$ gpg --import mpapis.asc\n</code></pre>\n\n<p>but I got the following:</p>\n\n<pre><code>gpg: fatal: can't open `/home/tamer/.gnupg/trustdb.gpg': Permission denied\nsecmem usage: 1408/1408 bytes in 2/2 blocks of pool 1408/65536\n</code></pre>\n\n<p>I'm not used to do something that I don't understand, so I stopped their and didn't try sudo.</p>\n\n<p>So how can I install Ruby?</p>\n\n<p><strong>Update</strong></p>\n\n<p>I also tried installing gpg2 using:</p>\n\n<pre><code>$ sudo apt-get install gnupg2 -y\n</code></pre>\n\n<p>and then I tried</p>\n\n<pre><code>$ gpg2 --keyserver hkp://keys.gnupg.net --recv-keys &lt;key&gt;\n</code></pre>\n\n<p>and also</p>\n\n<pre><code>$ curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -\n</code></pre>\n\n<p>But still, the same result when I try install rvm with the first command.</p>\n\n<p>n.b. I noticed that I have gpg v1.4.20 and gpg2 v2.1.11</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1497476870, "post_id": 44555182, "comment_id": 76100943, "body": "Did you generate two migrations??"}, {"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "reply_to_user": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1497477202, "post_id": 44555182, "comment_id": 76101095, "body": "Hey @AlejandroMontilla! It actually stops before migrating"}, {"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "reply_to_user": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1497477250, "post_id": 44555182, "comment_id": 76101119, "body": "here is what I get in the terminal after rails db:migrate --trace:  &#39;** Invoke db:migrate (first_time) ** Invoke environment (first_time) ** Execute environment ** Invoke db:load_config (first_time) ** Execute db:load_config ** Execute db:migrate == 20170614155451 CreateAttachinaryTables: migrating ========================== -- create_table(:attachinary_files) rails aborted! StandardError: An error has occurred, this and all later migrations canceled: Index name &#39;index_attachinary_files_on_attachinariable_type_and_attachi&zwnj;&#8203;nariable_id&#39; on table &#39;attachinary_files&#39; is too long..&#39;"}, {"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1497477568, "post_id": 44555182, "comment_id": 76101272, "body": "Please list all the files in the <code>&#47;app&#47;db&#47;migrate&#47;</code> directory. Add that information to the Question (with the edit link)."}, {"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "reply_to_user": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1497477933, "post_id": 44555182, "comment_id": 76101418, "body": "Don&#39;t have any doublon in it only on related to this specific migration"}, {"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1497478226, "post_id": 44555182, "comment_id": 76101522, "body": "Ok, Let me try to explain myself.. I think you have two migration pending (the first one with the name too long, and the second with the shorter name), that is what in asking you about the files in that directory."}, {"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "reply_to_user": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1497478432, "post_id": 44555182, "comment_id": 76101593, "body": "Alright so if that is the case I should have two migration files in <code>&#47;db&#47;migrate</code> am I right? Cause I only have one regarding this migration :/"}, {"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1497478581, "post_id": 44555182, "comment_id": 76101642, "body": "Ok.. and you are sure that you save your work in that file?"}, {"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "reply_to_user": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 1, "creation_date": 1497478927, "post_id": 44555182, "comment_id": 76101753, "body": "All sure.. I found a lot of stuff regarding this problem but it always says that to avoid it you have to add a proper name to the index. Which I tried several time but maybe I&#39;m missing something cause it has a name already. Gonna add the code that is inside the migration file to my post"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "edited": false, "score": 0, "creation_date": 1497510987, "post_id": 44555984, "comment_id": 76111129, "body": "Hi Archana! It worked perfectly thanks so much. Can you tell me a bit more about my problem? I&#39;ve made some researches on the web and I didn&#39;t find anyone with this issue (related to this particular gem). The file was generate after typing <code>rails attachinary:install:migrations</code> so I didn&#39;t really choose anything. Why would it happen to me? Also the &quot;name&quot; parameter that is already in the &quot;add_index&quot; line isn&#39;t supposed to be the index name?  Anyway thanks again!!"}, {"owner": {"reputation": 1224, "user_id": 1170266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2db3460298af8f4a585f95cf556874?s=128&d=identicon&r=PG", "display_name": "archana", "link": "https://stackoverflow.com/users/1170266/archana"}, "reply_to_user": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "edited": false, "score": 0, "creation_date": 1497550332, "post_id": 44555984, "comment_id": 76137203, "body": "@ThomasCailhol Whenever there is a <code>reference</code> (a foreign key) in migration rails creates an index by default. There should always be index on foreign keys. In case of polymorphic association it tries to create index on id and type column and in your case they both combined were too long. I hope this explains the issue."}], "tags": [], "owner": {"reputation": 1224, "user_id": 1170266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2db3460298af8f4a585f95cf556874?s=128&d=identicon&r=PG", "display_name": "archana", "link": "https://stackoverflow.com/users/1170266/archana"}, "is_accepted": true, "score": 4, "last_activity_date": 1497481109, "creation_date": 1497481109, "answer_id": 44555984, "question_id": 44555182, "link": "https://stackoverflow.com/questions/44555182/index-name-too-long-attachinary-postgresql/44555984#44555984", "title": "Index name too long attachinary/postgresql", "body": "<p>You are getting the error due to this line in the migration:</p>\n\n<pre><code>t.references :attachinariable, polymorphic: true\n</code></pre>\n\n<p>By default index is true. If you don't want this index (which seems like is the case as you are adding scope also later on in the index) then make index: false:</p>\n\n<pre><code>t.references :attachinariable, polymorphic: true, index: false\n</code></pre>\n\n<p>Or add a name:</p>\n\n<pre><code>t.references :attachinariable, polymorphic: true, index: {name: 'name of your choice here'}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 1, "accepted_answer_id": 44555984, "answer_count": 1, "score": 3, "last_activity_date": 1539423618, "creation_date": 1497476466, "last_edit_date": 1497482106, "question_id": 44555182, "link": "https://stackoverflow.com/questions/44555182/index-name-too-long-attachinary-postgresql", "title": "Index name too long attachinary/postgresql", "body": "<p>I keep getting this error after installing the ruby gem for <code>Attachinary</code> and trying to run <code>db:migrate</code>:</p>\n\n<pre><code>Index name 'index_attachinary_files_on_attachinariable_type_and_attachinariable_id' on table 'attachinary_files' is too long; the limit is 63 characters\n</code></pre>\n\n<p>I've been searching and searching for a solution and of course heard about giving a name to the index to avoid the generated one but it doesn't seem to be working. There is actually a name field already that says:</p>\n\n<pre><code>'name: by_scoped_parent'\n</code></pre>\n\n<p>Here is the full line in my migrate file:</p>\n\n<pre><code>add_index :attachinary_files, [:attachinariable_type, :attachinariable_id, :scope], name: 'by_scoped_parent'\n</code></pre>\n\n<p>Here is the content of the migration file:</p>\n\n<pre><code>class CreateAttachinaryTables &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :attachinary_files do |t|\n      t.references :attachinariable, polymorphic: true\n      t.string :scope\n\n      t.string :public_id\n      t.string :version\n      t.integer :width\n      t.integer :height\n      t.string :format\n      t.string :resource_type\n      t.timestamps\n    end\n\n    add_index :attachinary_files, [:attachinariable_type, :attachinariable_id, :scope], name: 'by_scoped_parent'\n  end\nend\n</code></pre>\n\n<p>Note: Don't have any doublon in my <em>db/migrate</em> folder. The last migration files went perfectly well. </p>\n\n<p>I'm currently learning Rails so I hope someone can help and forgive me if it's a silly question \ud83d\ude07.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 5033222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dbeab43944d10c83509ff5f998a8d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Meletis", "link": "https://stackoverflow.com/users/5033222/meletis"}, "edited": false, "score": 0, "creation_date": 1497476556, "post_id": 44555163, "comment_id": 76100791, "body": "Well,  this is probably the least destructive way. If there is no better option i will go with it. Its just that i wanted to utilize this ActiveRecord magic"}], "tags": [], "owner": {"reputation": 1224, "user_id": 1170266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2db3460298af8f4a585f95cf556874?s=128&d=identicon&r=PG", "display_name": "archana", "link": "https://stackoverflow.com/users/1170266/archana"}, "is_accepted": false, "score": 0, "last_activity_date": 1497476353, "creation_date": 1497476353, "answer_id": 44555163, "question_id": 44554975, "link": "https://stackoverflow.com/questions/44554975/rails-activerecord-access-record-through-has-many-association-using-a-different/44555163#44555163", "title": "Rails ActiveRecord access record through has_many association using a different key", "body": "<p>You can Run 2 separate queries:</p>\n\n<pre><code>user = User.find(1)\ngames = Games.where(player: user.stream_id)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": true, "score": 4, "last_activity_date": 1497499737, "last_edit_date": 1497499737, "creation_date": 1497476866, "answer_id": 44555258, "question_id": 44554975, "link": "https://stackoverflow.com/questions/44554975/rails-activerecord-access-record-through-has-many-association-using-a-different/44555258#44555258", "title": "Rails ActiveRecord access record through has_many association using a different key", "body": "<p>Try specifying the <code>primary_key</code> in the association:</p>\n\n<p><code>User</code> model:</p>\n\n<pre><code>has_many :games, primary_key: 'steam_id', foreign_key: 'player'\n</code></pre>\n\n<p><code>Game</code> model:</p>\n\n<pre><code>belongs_to :user, primary_key: 'steam_id', foreign_key: 'player'\n</code></pre>\n\n<p>Now you should be able use <code>User.find(1).games</code>, which will query for user's games using <code>steam_id</code> instead of <code>id</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 475, "user_id": 1149661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f352b6d53391fd7e5080e8486cd26f5?s=128&d=identicon&r=PG", "display_name": "Aaganja", "link": "https://stackoverflow.com/users/1149661/aaganja"}, "is_accepted": false, "score": 0, "last_activity_date": 1497489892, "last_edit_date": 1497489892, "creation_date": 1497488632, "answer_id": 44556940, "question_id": 44554975, "link": "https://stackoverflow.com/questions/44554975/rails-activerecord-access-record-through-has-many-association-using-a-different/44556940#44556940", "title": "Rails ActiveRecord access record through has_many association using a different key", "body": "<p>User class:</p>\n\n<pre><code>has_many :games, :foreign_key =&gt; 'player'\n</code></pre>\n\n<p>Game class:</p>\n\n<pre><code>belongs_to :player, class_name: 'User'\n</code></pre>\n\n<p>This might help you give a try.</p>\n"}], "owner": {"reputation": 85, "user_id": 5033222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dbeab43944d10c83509ff5f998a8d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Meletis", "link": "https://stackoverflow.com/users/5033222/meletis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 44555258, "answer_count": 3, "score": 2, "last_activity_date": 1497499737, "creation_date": 1497475551, "last_edit_date": 1497482374, "question_id": 44554975, "link": "https://stackoverflow.com/questions/44554975/rails-activerecord-access-record-through-has-many-association-using-a-different", "title": "Rails ActiveRecord access record through has_many association using a different key", "body": "<h1>Scenario</h1>\n\n<p>I'm building an admin panel in Rails for an old app that i wrote a while ago therefore the database is not designed to work with <em>ActiveRecord</em>.</p>\n\n<h1>The design</h1>\n\n<p><img src=\"https://i.stack.imgur.com/kB8KI.png\" alt=\"enter image description here\"></p>\n\n<p>As you can see the foreign key which is used by the <code>Game</code> and <code>Refferal</code> table is NOT the <code>id</code> of the <code>User</code> but instead a column on the <code>User</code> which is called <code>steam_id</code></p>\n\n<p>The Rails Model:</p>\n\n<ul>\n<li><code>User</code> class\n\n<ul>\n<li><code>has_many :games, :foreign_key =&gt; 'player'</code></li>\n</ul></li>\n</ul>\n\n<h1>The problem</h1>\n\n<p>When i'm trying the following command:</p>\n\n<p><code>User.find(1).games</code></p>\n\n<p>the ActiveRecord is producing the following queries: </p>\n\n<pre><code>User Load (0.0ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1\nGame Load (1012.0ms)  SELECT `games`.* FROM `games` WHERE `games`.`player` = '1'\n</code></pre>\n\n<p>As you can see on the second query it tries to find a game where the <code>player</code> column is equal to <strong><code>1</code></strong>.</p>\n\n<p>Obviously this is not what I want. I want to get the game where the <strong><code>game.player</code></strong> is equal to <strong><code>user.steam_id</code></strong> </p>\n\n<p>How can i fix that? And most importantly how can i also fix the <code>belongs_to</code> association?</p>\n\n<h1>Considerations</h1>\n\n<p>The main website is already live and with active users. I cant just start redesigning the entire DB and the codebase itself.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authentication", "hash", "md5"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1497474064, "post_id": 44554118, "comment_id": 76099628, "body": "One thing to strive towards is killing off MD5 passwords as quickly as possible. Remember, when someone logs in and you verify their password as correct you have an opportunity to update their user record with a properly hashed (e.g. bcrypt) version of same, no need to harass the user to change their password."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497474135, "post_id": 44554118, "comment_id": 76099664, "body": "To help people with your problem can you given an example of how a password like &quot;testing&quot; or &quot;example&quot; is saved so others can verify your code is working correctly?"}, {"owner": {"reputation": 11, "user_id": 8162411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8ffd74f5993ae53718ad466de595f2?s=128&d=identicon&r=PG&f=1", "display_name": "bearmettle", "link": "https://stackoverflow.com/users/8162411/bearmettle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497475717, "post_id": 44554118, "comment_id": 76100408, "body": "Thanks, the idea is that once they are authenticated and logged in, the MD5 hash is removed from the database and the password is hashed in bcrypt etc.  I will check on what the final hashed results are for &quot;testing&quot; and &quot;example&quot; in the PHP application and update this question with the answer as soon as I can.  Just to add, the &quot;salt&quot; that I need to target here would have a field name in the database of legacy_salt, not &quot;salt&quot;. Would I need to define this somewhere as it is not the default &quot;salt&quot; used by digest for MD5?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1497476192, "post_id": 44554118, "comment_id": 76100623, "body": "If this was done properly, and I&#39;m using the term very loosely here since this style of hashing was obsolete in the early 1990s, then the salt would be some random value stored in a separate field."}, {"owner": {"reputation": 11, "user_id": 8162411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8ffd74f5993ae53718ad466de595f2?s=128&d=identicon&r=PG&f=1", "display_name": "bearmettle", "link": "https://stackoverflow.com/users/8162411/bearmettle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497476453, "post_id": 44554118, "comment_id": 76100747, "body": "Hi tadman, yes, that is the case. The salt in this instance is a random value stored in a seperate field, which is unique to each user. I know that MD5 is terrible, but it was what I inherited. I am eager to rid the new application of MD5 as quickly as possible!"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497476566, "post_id": 44554118, "comment_id": 76100797, "body": "Good luck slaying this dragon. Your users will appreciate it."}, {"owner": {"reputation": 11, "user_id": 8162411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8ffd74f5993ae53718ad466de595f2?s=128&d=identicon&r=PG&f=1", "display_name": "bearmettle", "link": "https://stackoverflow.com/users/8162411/bearmettle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1497477550, "post_id": 44554118, "comment_id": 76101258, "body": "Thanks tadman. The alternative is a mass password-reset mailout, which I would LOVE to avoid."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497478724, "post_id": 44554431, "comment_id": 76101686, "body": "This can be extended to recognize newer-format hashes like <code>&quot;$2a$10$....&quot;</code> and handle it with Bcrypt as well."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1497474198, "last_edit_date": 1497474198, "creation_date": 1497473049, "answer_id": 44554431, "question_id": 44554118, "link": "https://stackoverflow.com/questions/44554118/specific-md5-hashing-scheme-in-rails/44554431#44554431", "title": "Specific md5 hashing scheme in Rails", "body": "<p>I would do something like this:</p>\n\n<pre><code>def valid_password?(password)\n  secret = if salt.present?\n             [password, salt].map { |part| ::Digest::MD5.hexdigest(part) }.join\n           else\n             password\n           end\n\n stored_hash == ::Digest::MD5.hexdigest(secret)\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8162411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8ffd74f5993ae53718ad466de595f2?s=128&d=identicon&r=PG&f=1", "display_name": "bearmettle", "link": "https://stackoverflow.com/users/8162411/bearmettle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497474198, "creation_date": 1497471870, "question_id": 44554118, "link": "https://stackoverflow.com/questions/44554118/specific-md5-hashing-scheme-in-rails", "title": "Specific md5 hashing scheme in Rails", "body": "<p>I have looked for an answer in an existing question, but found nothing which covers this hashing scheme in Rails.</p>\n\n<p>I am currently migrating a PHP project over to Ruby-on-Rails, which I am still learning. I am struggling to port over an MD5 (I know, it's only temporary...) hashing scheme for hashing user passwords. I have plain MD5 working, but cannot find the correct syntax for the hashing scheme I need.</p>\n\n<p>The mechanics of the hashing scheme in the PHP project are:</p>\n\n<p>Create MD5 hash of password.\nCreate MD5 hash of salt.\nConcatenate password_hash with salt_hash.\nCreate MD5 hash of concatenated_string.\nCompare stored_hash to concatenated_string</p>\n\n<p>The PHP for the hash creation is:</p>\n\n<pre><code>function fn_generate_salted_password($password, $salt)\n{\n    $_pass = '';\n\n    if (empty($salt)) {\n        $_pass = md5($password);\n    } else {\n        $_pass = md5(md5($password) . md5($salt));\n    }\n\n    return $_pass;\n}\n</code></pre>\n\n<p>The (pathetic) attempt I have for this section in Rails so far is:</p>\n\n<pre><code>Spree::User.class_eval do\n  def valid_password?(password)\n    if self.salt.present\n      if ::Digest::MD5.hexdigest((::Digest::MD5.hexdigest(password)).(::Digest::MD5.hexdigest(salt))) == self.stored_hash\n        *# Do some stuff*\n      else\n        false\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "sqlite"], "comments": [{"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 0, "creation_date": 1497470526, "post_id": 44553424, "comment_id": 76097809, "body": "are you searching for an id that fits a format, or will you always have the full id?"}, {"owner": {"reputation": 161, "user_id": 7705189, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/06587ae42507bc7c5e34e15e829bb9b6?s=128&d=identicon&r=PG", "display_name": "Hima Chhag", "link": "https://stackoverflow.com/users/7705189/hima-chhag"}, "reply_to_user": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 0, "creation_date": 1497470792, "post_id": 44553424, "comment_id": 76097950, "body": "Hi @MichaelGorman.. I will always have a category_id."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 7705189, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/06587ae42507bc7c5e34e15e829bb9b6?s=128&d=identicon&r=PG", "display_name": "Hima Chhag", "link": "https://stackoverflow.com/users/7705189/hima-chhag"}, "edited": false, "score": 0, "creation_date": 1497471820, "post_id": 44553787, "comment_id": 76098462, "body": "It does exactly what I need.And much simpler way than what I expected. Thanks a lot for the solution."}], "tags": [], "owner": {"reputation": 378, "user_id": 6130770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dcaea19f2bced3c51f9f43f067eb894?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Cristobal", "link": "https://stackoverflow.com/users/6130770/hans-cristobal"}, "is_accepted": true, "score": 1, "last_activity_date": 1497470667, "creation_date": 1497470667, "answer_id": 44553787, "question_id": 44553424, "link": "https://stackoverflow.com/questions/44553424/using-model-method-in-sqlite3-and-postgresql/44553787#44553787", "title": "Using Model method in SQlite3 and PostgreSQL", "body": "<p>You can put a conditional on</p>\n\n<pre><code>ActiveRecord::Base.connection.instance_values[\"config\"][:adapter]\n</code></pre>\n\n<p>Like</p>\n\n<pre><code>if ActiveRecord::Base.connection.instance_values[\"config\"][:adapter] == \"postgresql\"\n  puts \"I'm using postgres!\"\nelsif ActiveRecord::Base.connection.instance_values[\"config\"][:adapter] == \"sqlite3\"\n  puts \"I'm using sqlite!\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "is_accepted": false, "score": 0, "last_activity_date": 1497470970, "creation_date": 1497470970, "answer_id": 44553872, "question_id": 44553424, "link": "https://stackoverflow.com/questions/44553424/using-model-method-in-sqlite3-and-postgresql/44553872#44553872", "title": "Using Model method in SQlite3 and PostgreSQL", "body": "<p>Let the database adapter do the work for you</p>\n\n<pre><code>def self.search(search)\n  where(category_id: search)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 7705189, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/06587ae42507bc7c5e34e15e829bb9b6?s=128&d=identicon&r=PG", "display_name": "Hima Chhag", "link": "https://stackoverflow.com/users/7705189/hima-chhag"}, "edited": false, "score": 0, "creation_date": 1497539071, "post_id": 44553957, "comment_id": 76130618, "body": "Hi @spickermann, thanks a lot for your suggestion. Your suggested format looks really clean. But can we call this from the controllers? Because I do call class method search from two different controllers. Is it possible with this too?"}, {"owner": {"reputation": 161, "user_id": 7705189, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/06587ae42507bc7c5e34e15e829bb9b6?s=128&d=identicon&r=PG", "display_name": "Hima Chhag", "link": "https://stackoverflow.com/users/7705189/hima-chhag"}, "edited": false, "score": 0, "creation_date": 1497903154, "post_id": 44553957, "comment_id": 76264226, "body": "Sorry, for being late, it was a really busy weekend. But thanks a lot for your tips. Tried it. It works like a charm! Very short and to the point!"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1497909354, "last_edit_date": 1497909354, "creation_date": 1497471266, "answer_id": 44553957, "question_id": 44553424, "link": "https://stackoverflow.com/questions/44553424/using-model-method-in-sqlite3-and-postgresql/44553957#44553957", "title": "Using Model method in SQlite3 and PostgreSQL", "body": "<p>Perhaps it is just me, but IMO there is not point in using <code>LIKE</code> on columns that contain an integer. Therefore I would just use a normal <code>=</code>:</p>\n\n<pre><code>def self.search(search)\n  where(\"category_id = ?\", search)\nend\n</code></pre>\n\n<p>Because that doesn't follow common Rails idiom, let's simplify this to  <code>where</code> with the hash syntax and use a scope instead of a class method:</p>\n\n<pre><code>scope :search, -&gt;(search) { where(category_id: search) }\n</code></pre>\n\n<p>Which can be called from your controller like this:</p>\n\n<pre><code>Habit.search(params[:xyz])\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 7705189, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/06587ae42507bc7c5e34e15e829bb9b6?s=128&d=identicon&r=PG", "display_name": "Hima Chhag", "link": "https://stackoverflow.com/users/7705189/hima-chhag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 44553787, "answer_count": 3, "score": 0, "last_activity_date": 1497909354, "creation_date": 1497469404, "last_edit_date": 1497470695, "question_id": 44553424, "link": "https://stackoverflow.com/questions/44553424/using-model-method-in-sqlite3-and-postgresql", "title": "Using Model method in SQlite3 and PostgreSQL", "body": "<p>In my Rails app, I do have SQlite3 for development and PostgreSQL for production. I have a habit class with belongs to category and Category has many habits. So, to let user search any category to see associated habits, I have developed a class method in habit model which goes into database and find all the habits according to searched category.</p>\n\n<p>So, if I write,</p>\n\n<pre><code>def self.search(search)\n  where(\"category_id LIKE ?\", search)\nend\n</code></pre>\n\n<p>It works perfectly fine in development but PostgreSQL gives 500 error in production saying:</p>\n\n<blockquote>\n  <p>\"No operator matches the given name and argument type(s). You might\n  need to add explicit type casts.\"</p>\n</blockquote>\n\n<p>So, I googled about it and found solution (<a href=\"https://stackoverflow.com/questions/42149496/pgsql-error-you-might-need-to-add-explicit-type-casts\">Pgsql error: You might need to add explicit type casts</a>) and edited my method accordingly:</p>\n\n<pre><code>def self.search(search)\n  where(\"category_id::text LIKE ?\", search)\nend\n</code></pre>\n\n<p>Now, it works perfectly fine in preoduction but SQlite gives me an error in development saying:</p>\n\n<blockquote>\n  <p>\"SQLite3::SQLException: unrecognized token: \":\": SELECT \"habits\".*\n  FROM \"habits\" WHERE \"habits\".\"user_id\" = ? AND (category_id::text LIKE\n  '4')\"</p>\n</blockquote>\n\n<p>Tried a lot but couldn't solve this. Is there any way I can modify this method to work with both of the databases? or maybe is there any way I can tell my app to use which method in which environment?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "mongoid", "delayed-job"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1497471601, "post_id": 44553417, "comment_id": 76098352, "body": "Can you please elaborate on what you mean with <i>autoscale workers</i>? Start more servers? Start more threads? Start more workers? How many? Why don&#39;t you configure run more worker all the time?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497479170, "post_id": 44553417, "comment_id": 76101818, "body": "Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; including the linked pages. You&#39;re asking us to recommend solutions, which is off-topic."}], "answers": [{"tags": [], "owner": {"reputation": 505, "user_id": 63516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0885ba9442ca4515dd4b235319278b8b?s=128&d=identicon&r=PG", "display_name": "tmarkiewicz", "link": "https://stackoverflow.com/users/63516/tmarkiewicz"}, "is_accepted": false, "score": 2, "last_activity_date": 1498671669, "creation_date": 1498671669, "answer_id": 44809276, "question_id": 44553417, "link": "https://stackoverflow.com/questions/44553417/scale-delayed-job-workers/44809276#44809276", "title": "Scale delayed Job workers", "body": "<p>Since <a href=\"https://github.com/collectiveidea/delayed_job\" rel=\"nofollow noreferrer\">Delayed::Job</a> stores all your jobs in the database, I'd just monitor the existing number in the MongoDB collection queue. You'll then have a baseline of what a normal number of jobs should be and when the queue reaches some percentage greater/less than what is normal, you can launch/stop new workers.</p>\n\n<p>In order to stop selected workers you'll need to grab the pids from the <code>/tmp/pids</code> directory to know which ones to stop when you're done with them.</p>\n"}], "owner": {"reputation": 702, "user_id": 2813483, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a806405fb6823e63f56544a44d1323b1?s=128&d=identicon&r=PG&f=1", "display_name": "tessie", "link": "https://stackoverflow.com/users/2813483/tessie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "closed_date": 1498671864, "answer_count": 1, "score": -1, "last_activity_date": 1498671669, "creation_date": 1497469365, "last_edit_date": 1497638593, "question_id": 44553417, "link": "https://stackoverflow.com/questions/44553417/scale-delayed-job-workers", "closed_reason": "Needs more focus", "title": "Scale delayed Job workers", "body": "<p>I have been using delayed_job_mongoid in my rails 4.2.7 application.I am trying for a solution to run or add more  workers on a production severs depending on queue size.I like to increase the number of workers if there is a spike in queue messages.I have seen solutions like workless which is specifically designed for heroku.Is there any solution that works for any servers </p>\n\n<p>Is there any working solutions </p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1497471996, "post_id": 44553091, "comment_id": 76098545, "body": "Since in *nix system the presence of any extension or no extension at all has no bearing the execution properties of the file itself why not make it a <code>.rb</code> file so that it works on windows through file association and works on *nix systems based strictly on execution rights."}, {"owner": {"reputation": 2050, "user_id": 4488070, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/343f7e053fbfad125f237b9178e5b688?s=128&d=identicon&r=PG&f=1", "display_name": "varro", "link": "https://stackoverflow.com/users/4488070/varro"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497475721, "post_id": 44553091, "comment_id": 76100411, "body": "Yes, I can do that, but it seems unnatural - that would <i>require</i> that that the user type in &quot;someprog.rb&quot;, and that seems unnatural in a POSIX-type environment where one typically invokes <i>name</i> without knowing, or <b>caring</b>, whether <i>name</i> is a binary executable, a script, or a tcl/perl/python/ruby/&amp;c program."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497476686, "post_id": 44553091, "comment_id": 76100847, "body": "No, it doesn&#39;t require the user to add the extension if you provide an alias or link to your command. That alias or link would be what is actually called."}], "answers": [{"tags": [], "owner": {"reputation": 2050, "user_id": 4488070, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/343f7e053fbfad125f237b9178e5b688?s=128&d=identicon&r=PG&f=1", "display_name": "varro", "link": "https://stackoverflow.com/users/4488070/varro"}, "is_accepted": false, "score": 0, "last_activity_date": 1497562710, "creation_date": 1497562710, "answer_id": 44577436, "question_id": 44553091, "link": "https://stackoverflow.com/questions/44553091/convention-for-including-executable-in-gem-both-unix-and-windows/44577436#44577436", "title": "Convention for including executable in gem, both Unix and Windows", "body": "<p>It turns out that I don't have a problem after all - I can simply use the Unix convention of naming the executable <code>someprog</code> with a shebang* and without an extension and it will work on both Unix-type and Windows platforms.  Apparently, the gem installation process results in a \"facilitator\" script being installed that calls the actual script under both types of OS's.</p>\n\n<p>*Presumably, I don't even need the shebang under Unix, but I like to have it anyway.</p>\n"}], "owner": {"reputation": 2050, "user_id": 4488070, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/343f7e053fbfad125f237b9178e5b688?s=128&d=identicon&r=PG&f=1", "display_name": "varro", "link": "https://stackoverflow.com/users/4488070/varro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497562710, "creation_date": 1497468209, "question_id": 44553091, "link": "https://stackoverflow.com/questions/44553091/convention-for-including-executable-in-gem-both-unix-and-windows", "title": "Convention for including executable in gem, both Unix and Windows", "body": "<p>I am writing a gem intended to be used on both Unix-type platforms and Windows and that includes an executable.  How should the executable be named?  Under Unix-type platforms it would normally have the form <code>someprog</code> and contain a shebang \"#!/usr/bin/env ruby\"; under Windows it would normally have the form <code>someprog.rb</code>, and rely on a file association of the \".rb\" extension with Ruby.  But for a gem that is meant for both platforms, what is the proper way of handling it?</p>\n"}, {"tags": ["ruby", "graphics", "centos7", "jupyterhub", "iruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497476830, "post_id": 44552756, "comment_id": 76100916, "body": "&quot;I&#39;m a Ruby n00b.&quot;? Don&#39;t say that. We don&#39;t care what your expertise is, we want you to research your problem, try many times, then write a clear and concise question. See &quot;<a href=\"http://meta.stackoverflow.com/questions/261592\">How much research effort is expected of Stack Overflow users?</a>&quot; and &quot;<a href=\"http://catb.org/esr/faqs/smart-questions.html#idm46227255999488\" rel=\"nofollow noreferrer\">Grovelling is not a substitute for doing your homework</a>&quot;. It&#39;s obvious you tried, but the approach could be improved."}, {"owner": {"reputation": 43, "user_id": 2816181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61c5b53edc8bcc8a74c846e97d6775dd?s=128&d=identicon&r=PG&f=1", "display_name": "William Seligman", "link": "https://stackoverflow.com/users/2816181/william-seligman"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497540681, "post_id": 44552756, "comment_id": 76131782, "body": "I did do my homework, or at least I thought I did. The only other reference I could find for a similar problem did not seem to offer a solution I could use, for the reason I noted above: <a href=\"https://groups.google.com/forum/#!topic/sciruby-dev/wcnFC824nJg\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/sciruby-dev/wcnFC824nJg</a>  There are no error messages in any log I could find in my system, no handle I could use to trace execution, no other behavior I could see that would be a hook into tracing what&#39;s wrong. Is there some other area of research that I&#39;ve overlooked?"}], "answers": [{"tags": [], "owner": {"reputation": 676, "user_id": 9344150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13c12af25a724e0c1fd61cdb45fdca2?s=128&d=identicon&r=PG&f=1", "display_name": "kojix2", "link": "https://stackoverflow.com/users/9344150/kojix2"}, "is_accepted": false, "score": 1, "last_activity_date": 1568387888, "creation_date": 1568387888, "answer_id": 57926301, "question_id": 44552756, "link": "https://stackoverflow.com/questions/44552756/nyaplot-generates-no-plot-in-iruby-running-in-jupyterhub/57926301#57926301", "title": "Nyaplot generates no plot in iruby running in jupyterhub", "body": "<p>I don't know much about JupyterHub. \nBut Nyaplot has not been updated for several years.</p>\n\n<p>If you want to generate plot in iruby, try these projects. </p>\n\n<ul>\n<li><a href=\"https://github.com/ruby-numo/numo-gnuplot\" rel=\"nofollow noreferrer\">https://github.com/ruby-numo/numo-gnuplot</a></li>\n<li><a href=\"https://github.com/zach-capalbo/iruby-plotly\" rel=\"nofollow noreferrer\">https://github.com/zach-capalbo/iruby-plotly</a></li>\n<li><a href=\"https://github.com/SciRuby/daru-view\" rel=\"nofollow noreferrer\">https://github.com/SciRuby/daru-view</a></li>\n</ul>\n\n<p>Following projects are experimental.</p>\n\n<ul>\n<li><a href=\"https://github.com/red-data-tools/charty\" rel=\"nofollow noreferrer\">https://github.com/red-data-tools/charty</a></li>\n<li><a href=\"https://github.com/SciRuby/rubyplot\" rel=\"nofollow noreferrer\">https://github.com/SciRuby/rubyplot</a></li>\n</ul>\n"}], "owner": {"reputation": 43, "user_id": 2816181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61c5b53edc8bcc8a74c846e97d6775dd?s=128&d=identicon&r=PG&f=1", "display_name": "William Seligman", "link": "https://stackoverflow.com/users/2816181/william-seligman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 3, "answer_count": 1, "score": 4, "last_activity_date": 1568387888, "creation_date": 1497467078, "last_edit_date": 1497507405, "question_id": 44552756, "link": "https://stackoverflow.com/questions/44552756/nyaplot-generates-no-plot-in-iruby-running-in-jupyterhub", "title": "Nyaplot generates no plot in iruby running in jupyterhub", "body": "<p>I'm trying to set up a Ruby kernel within an existing multi-user jupyterhub installation. It works in all of my tests, except that plots created by nyaplot (the only plotting package I could find that works within iruby) don't show up in the notebook. For example, the following code (from one of the Nyaplot tutorials) gives no error (not even in the syslog file) but no plot:</p>\n\n<pre><code>require 'nyaplot'\nplot = Nyaplot::Plot.new\nsc = plot.add(:scatter, [0,1,2,3,4], [-1,2,-3,4,-5])\ncolor = Nyaplot::Colors.qual\nsc.color(color)\nplot.show # show plot on IRuby notebook\n</code></pre>\n\n<h2>Background:</h2>\n\n<p>Here's how I set up iruby to run in jupyterhub. I'm giving the entire process so (a) you can spot if anything is missing, and (b) so you know that if you say something like \"add [this] to the Gemfile\" you're going to have to tell me where to put the Gemfile, since jupyterhub is not running iruby out of a particular directory. </p>\n\n<p>The OS is CentOS 7.3. Since its default version of ruby is too old to run iruby, I installed a version of ruby using ruby-install:</p>\n\n<pre><code>wget -O ruby-install-0.6.1.tar.gz https://github.com/postmodern/ruby-install/archive/v0.6.1.tar.gz\ntar -xzvf ruby-install-0.6.1.tar.gz \ncd ruby-install-0.6.1\nmake\nmake install\nruby-install ruby 2.3.4\n</code></pre>\n\n<p>(I used ruby 2.3, instead of 2.4, because it turned out that at least one component of sciruby-full doesn't work with 2.4 yet.) After the installation, a message says that ruby is installed in /opt/rubies/ruby-2.3.4. </p>\n\n<h2>Next come the package installations.</h2>\n\n<p>I had to make sure that nothing was installed in my home directory, because in a multi-user system the other users don't have access to my home directory's files. I'm listing below all the packages I eventually installed to try to solve this problem:</p>\n\n<pre><code>export RUBYDIR=/opt/rubies/ruby-2.3.4\nexport PATH=${RUBYDIR}/bin:$PATH\nexport LD_LIBRARY_PATH=${RUBYDIR}/lib:$LD_LIBRARY_PATH\nexport GEM_HOME=${RUBYDIR}\nexport GEM_PATH=${RUBYDIR}\ngem install --no-user-install cztop rbczmq iruby\ngem install --no-user-install pry pry-doc awesome_print gnuplot rubyvis nyaplot\ngem install --no-user-install sciruby-full\ngem install --no-user-install zeromq ffi-rzmq gnuplotrb\n</code></pre>\n\n<h2>Next comes installing the iruby kernel into jupyterhub.</h2>\n\n<p>After looking at the results of \"<code>iruby register --force</code>\",<br>I created the file <code>/usr/local/share/jupyter/kernels/ruby</code>:</p>\n\n<pre><code>{\"argv\":[\n         \"/usr/local/bin/jupyter-ruby-env.sh\",\n         \"{connection_file}\"\n          ],\n \"display_name\":\"Ruby\",\n \"language\":\"ruby\"\n}\n</code></pre>\n\n<p>In /usr/local/bin/jupyter-ruby-env.sh:</p>\n\n<pre><code>#!/usr/bin/bash -l                                                                                                                                    \nexport RUBYDIR=/opt/rubies/ruby-2.3.4\nexport PATH=${RUBYDIR}/bin:$PATH\nexport LD_LIBRARY_PATH=${RUBYDIR}/lib:$LD_LIBRARY_PATH\nexport GEM_HOME=${RUBYDIR}\nexport GEM_PATH=${RUBYDIR}\nexec ${RUBYDIR}/bin/iruby kernel $@\n</code></pre>\n\n<p>As I said, all of this works as far as basic ruby is concerned: I can run code I found in the Ruby tutorials. The only thing I don't get are plots. All of the other jupyterhub kernels I've installed (e.g., python, SageMath, Julia) have no problems plotting. </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "web-scraping", "api-design"], "comments": [{"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 6, "creation_date": 1497467162, "post_id": 44552719, "comment_id": 76096057, "body": "There is a middle ground,  where you create a <code>resorts</code> table in your database, with the fields you want plus an <code>expire_datetime</code>. When you try to access a <code>resort</code> you don&#39;t have, or is <code>expired</code> you make an api request to Expedia, caching the results in your database, and updating the <code>expire_datetime</code>."}, {"owner": {"reputation": 5102, "user_id": 327694, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/affc703514153388019ab26f0eb6ab7d?s=128&d=identicon&r=PG", "display_name": "Josep Valls", "link": "https://stackoverflow.com/users/327694/josep-valls"}, "reply_to_user": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 0, "creation_date": 1497467262, "post_id": 44552719, "comment_id": 76096106, "body": "comment by @MichaelGorman IS the answer to this question."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 0, "creation_date": 1497470719, "post_id": 44552719, "comment_id": 76097917, "body": "@MichaelGorman I agree with Josep, you should post your comment as an answer."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 0, "creation_date": 1497477229, "post_id": 44552719, "comment_id": 76101108, "body": "In addition to @MichaelGorman&#39;s comment and answer, you need a task that periodically sweeps the table and confirms/updates/purges records otherwise it will only grow and will contain stale information. <code>rails runner</code> would be a good way to fire off jobs for that."}, {"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497477446, "post_id": 44552719, "comment_id": 76101214, "body": "@theTinMan yes that would be a good optimization, something like any <code>resort</code> that has an <code>expire_date &gt; 1.month</code> (hasn&#39;t been touched for at least a month) gets <code>deleted</code> (note this would need to be delete not destroy as destroy would initialize the record, and attempt an update)"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497472819, "post_id": 44554106, "comment_id": 76098944, "body": "Any reason we are not using <code>find_or_create_by(expedia_id: expedia_id)</code>. it just seems like you are duplicating a lot of out of the box <code>rails</code> code"}, {"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497473271, "post_id": 44554106, "comment_id": 76099228, "body": "I remember having issues with <code>find_or_create_by</code> not firing the <code>after_initialize</code> callback, but that may have been on the older rails environments I find my self in most of the time"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497473571, "post_id": 44554106, "comment_id": 76099400, "body": "Very well. It keeps the model thinner but after reflection I think the transparency here makes more sense as a formal answer. Well Done"}, {"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497473730, "post_id": 44554106, "comment_id": 76099467, "body": "thanks, if we can be sure <code>find_or_create_by</code> or <code>find_or_initialize_by</code> does hit the <code>after_initialize</code> call back it would make the code alot cleaner."}, {"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1497474099, "post_id": 44554106, "comment_id": 76099640, "body": "A little research suggests that it should always hit the callback, so I added the condensed version, with the full one to help explain what is going on"}], "tags": [], "owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "is_accepted": true, "score": 5, "last_activity_date": 1497474045, "last_edit_date": 1497474045, "creation_date": 1497471837, "answer_id": 44554106, "question_id": 44552719, "link": "https://stackoverflow.com/questions/44552719/scrape-an-entire-api-or-rely-heavily-on-it/44554106#44554106", "title": "Scrape an entire API or rely heavily on it?", "body": "<p>The middle ground would be the best solution.\nCreate a table and model that would locally store the active resorts.  Expiring your local copy after a certain period (determined by how frequently the resorts change on Expedia) and only pinging the api on a new to your system resort, or loading a resort that has been expired</p>\n\n<p>This would be a basic example of how this might be done</p>\n\n<pre><code>class Resort &lt; ApplicationRecord #for Rails &lt;=4 do ActiveRecord::Base\n  after_find :maybe_update_from_expedia\n  ExpirationTime = 1.day #change to fit what is needed\n\n  def self.find_by_expedia_id(expedia_id)\n    result = self.where(expedia_id: expedia_id).first\n    result || self.create_by_expedia_id(expedia_id)\n  end\n\n  def maybe_update_from_expedia\n    update_from_expedia if expire_at.nil? || expire_at &lt; Time.now\n  end\n\n  private\n  def self.create_by_expedia_id(expedia_id)\n    record = new(expedia_id: expedia_id)\n    record.maybe_update_from_expedia\n    record\n  end\n\n  def update_from_expedia\n    #fetch record from expedia\n    #update local data\n    self.expire_time = Time.now + ExpirationTime\n    self.save\n  end\nend\n</code></pre>\n\n<p>As suggested by <a href=\"https://stackoverflow.com/users/1978251/engineersmnky\">engineersmnky</a> this can be condensed to</p>\n\n<pre><code>class Resort &lt; ApplicationRecord #for Rails &lt;=4 do ActiveRecord::Base\n  after_initialize :maybe_update_from_expedia\n  ExpirationTime = 1.day #change to fit what is needed\n\n  private\n\n  def maybe_update_from_expedia\n    update_from_expedia if expire_at.nil? || expire_at &lt; Time.now\n  end\n\n  def update_from_expedia\n    #fetch record from expedia\n    #update local data\n    self.expire_time = Time.now + ExpirationTime\n    self.save\n  end\nend\n</code></pre>\n\n<p>If all fetch requests use <code>Resort.find_or_create_by(expedia_id: expedia_id)</code></p>\n"}], "owner": {"reputation": 416, "user_id": 4381225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aec91934b189d3d6738211b322cf2acb?s=128&d=identicon&r=PG&f=1", "display_name": "mycellius", "link": "https://stackoverflow.com/users/4381225/mycellius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 44554106, "answer_count": 1, "score": 2, "last_activity_date": 1497474045, "creation_date": 1497466979, "question_id": 44552719, "link": "https://stackoverflow.com/questions/44552719/scrape-an-entire-api-or-rely-heavily-on-it", "title": "Scrape an entire API or rely heavily on it?", "body": "<p>I'm building a resort review site in rails. Currently, a <code>User</code> has many reviews, and each <code>Review</code> belongs to a <code>User</code>. </p>\n\n<p>The reviews table contains an <code>expedia_id</code> field. All data - the hotel name, images, description, etc. are pulled dynamically from the Expedia API, using lookups against this id. For example, when hitting the <code>show</code> action in a controller, it makes a request to Expedia <strong>and</strong> my db using the <code>expedia_id</code> to get all of the reviews and content, and renders everything on one page. Requests will also made to populate the home page (I'm thinking a <code>Featured</code> table with an <code>expedia_id</code> column)</p>\n\n<p>Since my entire website relies heavily on an API and I don't have a <code>Resort</code> table, plus the fact that given a large amount of users, <strong>a lot</strong> of requests would be made to the Expedia API, would it make sense to scrape and write the results to my database, creating records for later use?</p>\n"}, {"tags": ["ruby", "gcc", "cygwin"], "answers": [{"tags": [], "owner": {"reputation": 423, "user_id": 2063044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gsZSs.png?s=128&g=1", "display_name": "JetStream", "link": "https://stackoverflow.com/users/2063044/jetstream"}, "is_accepted": false, "score": 1, "last_activity_date": 1497478381, "creation_date": 1497478381, "answer_id": 44555550, "question_id": 44551786, "link": "https://stackoverflow.com/questions/44551786/cant-install-gems-using-cygwin-undefined-reference-to-libiconv/44555550#44555550", "title": "Can&#39;t install gems using Cygwin -- undefined reference to `libiconv&#39;", "body": "<p>My suggestion would be to run <code>cygwin-setup.exe</code> / use <code>apt-cyg</code> to install <code>libiconv-devel</code> package </p>\n\n<p>and rerun <code>bundle install awsudo</code></p>\n\n<p>Just a guess. I believe I encountered a similar issue while installing nokogiri with native extensions. Unfortunately, I don't have access to the system now to look at the logs to get the specific details. HTH</p>\n"}], "owner": {"reputation": 12150, "user_id": 1143724, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/47fa5f1bc077c8158fe5ad1287105381?s=128&d=identicon&r=PG", "display_name": "MrDuk", "link": "https://stackoverflow.com/users/1143724/mrduk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1497478381, "creation_date": 1497463687, "last_edit_date": 1497464048, "question_id": 44551786, "link": "https://stackoverflow.com/questions/44551786/cant-install-gems-using-cygwin-undefined-reference-to-libiconv", "title": "Can&#39;t install gems using Cygwin -- undefined reference to `libiconv&#39;", "body": "<p>I'm getting the following output when trying to <code>gem install awsudo</code>:</p>\n\n<pre><code>/home/ctote/.gem/ruby/2.3.0/gems/mini_portile2-2.2.0/lib/mini_portile2/mini_portile.rb:83:in `apply_patch': Failed to complete patch task; patch(1) or git(1) is required. (RuntimeError)\n        from /home/ctote/.gem/ruby/2.3.0/gems/mini_portile2-2.2.0/lib/mini_portile2/mini_portile.rb:91:in `block in patch'\n        from /home/ctote/.gem/ruby/2.3.0/gems/mini_portile2-2.2.0/lib/mini_portile2/mini_portile.rb:89:in `each'\n        from /home/ctote/.gem/ruby/2.3.0/gems/mini_portile2-2.2.0/lib/mini_portile2/mini_portile.rb:89:in `patch'\n        from /home/ctote/.gem/ruby/2.3.0/gems/mini_portile2-2.2.0/lib/mini_portile2/mini_portile.rb:151:in `cook'\n        from extconf.rb:365:in `block (2 levels) in process_recipe'\n        from extconf.rb:257:in `block in chdir_for_build'\n        from extconf.rb:256:in `chdir'\n        from extconf.rb:256:in `chdir_for_build'\n        from extconf.rb:364:in `block in process_recipe'\n        from extconf.rb:262:in `tap'\n        from extconf.rb:262:in `process_recipe'\n        from extconf.rb:548:in `&lt;main&gt;'\n</code></pre>\n\n<p>The <code>mkmf.log</code> has:</p>\n\n<pre><code>have_iconv?: checking for iconv... -------------------- yes\n\n\"gcc -o conftest.exe -I/usr/include/ruby-2.3.0 -I/usr/include/ruby-2.3.0/ruby/backward -I/usr/include/ruby-2.3.0 -I.    -ggdb -O2 -pipe -Wimplicit-function-declaration    -g -DXP_UNIX -Wall -Wcast-qual -Wwrite-strings -Wconversion -Wmissing-noreturn -Winline conftest.c  -L. -L/usr/lib -L. -fstack-protector     -lruby230  -lpthread -lgmp -ldl -lcrypt   \"\n/tmp/ccP5llv3.o: In function `main':\n/home/ctote/.gem/ruby/2.3.0/gems/nokogiri-1.8.0/ext/nokogiri/conftest.c:8: undefined reference to `libiconv_open'\n/home/ctote/.gem/ruby/2.3.0/gems/nokogiri-1.8.0/ext/nokogiri/conftest.c:8:(.text.startup+0x14): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `libiconv_open'\n/home/ctote/.gem/ruby/2.3.0/gems/nokogiri-1.8.0/ext/nokogiri/conftest.c:9: undefined reference to `libiconv'\n/home/ctote/.gem/ruby/2.3.0/gems/nokogiri-1.8.0/ext/nokogiri/conftest.c:9:(.text.startup+0x2d): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `libiconv'\ncollect2: error: ld returned 1 exit status\nchecked program was:\n/* begin */\n 1: #include \"ruby.h\"\n 2:\n 3: #include &lt;stdlib.h&gt;\n 4: #include &lt;iconv.h&gt;\n 5:\n 6: int main(void)\n 7: {\n 8:     iconv_t cd = iconv_open(\"\", \"\");\n 9:     iconv(cd, NULL, NULL, NULL, NULL);\n10:     return EXIT_SUCCESS;\n11: }\n/* end */\n\n\"gcc -o conftest.exe -I/usr/include/ruby-2.3.0 -I/usr/include/ruby-2.3.0/ruby/backward -I/usr/include/ruby-2.3.0 -I.    -ggdb -O2 -pipe -Wimplicit-function-declaration    -g -DXP_UNIX -Wall -Wcast-qual -Wwrite-strings -Wconversion -Wmissing-noreturn -Winline conftest.c  -L. -L/usr/lib -L. -fstack-protector     -lruby230 -liconv -lpthread -lgmp -ldl -lcrypt   \"\nchecked program was:\n/* begin */\n 1: #include \"ruby.h\"\n 2:\n 3: #include &lt;stdlib.h&gt;\n 4: #include &lt;iconv.h&gt;\n 5:\n 6: int main(void)\n 7: {\n 8:     iconv_t cd = iconv_open(\"\", \"\");\n 9:     iconv(cd, NULL, NULL, NULL, NULL);\n10:     return EXIT_SUCCESS;\n11: }\n/* end */\n\n--------------------\n</code></pre>\n\n<p>But I'm not really sure what to make of it.\nI'm using Cygwin for this; not sure what to do next.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 1, "creation_date": 1497463099, "post_id": 44551581, "comment_id": 76093837, "body": "can you comment the line at which the error is raised ?"}, {"owner": {"reputation": 21, "user_id": 6763176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19641cabaaa86879cb096a806a6f668c?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Bariak", "link": "https://stackoverflow.com/users/6763176/martin-bariak"}, "reply_to_user": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 0, "creation_date": 1497469402, "post_id": 44551581, "comment_id": 76097205, "body": "Added comment for the line that should be causing the error."}], "answers": [{"comments": [{"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 0, "creation_date": 1497463501, "post_id": 44551658, "comment_id": 76094073, "body": "by the way did you notice that OP is accessing this url : <a href=\"http://siteurl.com/ratings.php?sex=M&amp;division=#\" rel=\"nofollow noreferrer\">siteurl.com/ratings.php?sex=M&amp;division=#</a>{division}&amp;pageID=1 from his code but the url returns 404 ;)"}, {"owner": {"reputation": 127444, "user_id": 492405, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SSPGk.png?s=128&g=1", "display_name": "vcsjones", "link": "https://stackoverflow.com/users/492405/vcsjones"}, "reply_to_user": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 1, "creation_date": 1497463580, "post_id": 44551658, "comment_id": 76094116, "body": "I assume the OP changed the URL in the question to mask the actual page being scraped."}], "tags": [], "owner": {"reputation": 127444, "user_id": 492405, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SSPGk.png?s=128&g=1", "display_name": "vcsjones", "link": "https://stackoverflow.com/users/492405/vcsjones"}, "is_accepted": true, "score": 1, "last_activity_date": 1497463235, "creation_date": 1497463235, "answer_id": 44551658, "question_id": 44551581, "link": "https://stackoverflow.com/questions/44551581/undefined-method-text-for-nilclass/44551658#44551658", "title": "undefined method text for NilClass", "body": "<p>You're calling <code>.text</code> on something that has no value, or <code>nil</code>.</p>\n\n<p>Based on the error message, it's on line 29, which makes me beleive this line is the culprit:</p>\n\n<pre><code>a = page.parser.xpath('//a[@title=\"last page\"]').first.text\n</code></pre>\n\n<p>It looks like when <code>xpath(...)</code> doesn't match on any elements, it returns an empty enumeration. So <code>first</code> can't find anything, so it returns nil.</p>\n\n<p>The solution is to check for <code>nil</code>. There is a lot of guidance and resource for checking for nil in Ruby, such as <a href=\"https://stackoverflow.com/questions/6143652/ruby-check-if-object-is-nil\">this question</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 6763176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19641cabaaa86879cb096a806a6f668c?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Bariak", "link": "https://stackoverflow.com/users/6763176/martin-bariak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "accepted_answer_id": 44551658, "answer_count": 1, "score": 1, "last_activity_date": 1497463471, "creation_date": 1497462950, "last_edit_date": 1497463471, "question_id": 44551581, "link": "https://stackoverflow.com/questions/44551581/undefined-method-text-for-nilclass", "title": "undefined method text for NilClass", "body": "<p>I have a simple crawler written in Ruby that should crawl specific site and save data into a CSV file. When I am trying to run the script, I keep getting undefined method error :</p>\n\n<pre><code>boxers.rb:29:in `&lt;main&gt;': undefined method `text' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>This is the code of script I'm trying to run:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'csv'\nrequire 'mechanize'\n\nagent = Mechanize.new{ |agent| agent.history.max_size=0 }\nagent.user_agent = 'Mozilla/5.0'\n\nbase = \"http://siteurl.com/\"\n\ndivision = ARGV[0]\n\nsearch_url = \"http://siteurl.com/ratings.php?sex=M&amp;division=#{division}&amp;pageID=\"\n\npath='//*[@id=\"mainContent\"]/table/tr[position()&gt;2]'\n\nboxers = CSV.open(\"csv/file.csv\",\"w\")\n\nurl = search_url+\"1\"\n\nbegin\n  page = agent.get(url)\nrescue\n  print \"  -&gt; error, retrying\\n\"\n  retry\nend\n\n// propably the line that causes error\na = page.parser.xpath('//a[@title=\"last page\"]').first.text\na.gsub!(\"[\",\"\")\na.gsub!(\"]\",\"\")\n\nlast = a.to_i\n\n(1..last).each do |page|\n\n  url = search_url+page.to_s\n\n  begin\n    page = agent.get(url)\n  rescue\n    print \"  -&gt; error, retrying\\n\"\n    retry\n  end\n\n  page.parser.xpath(path).each do |tr|\n    row = [division]\n    tr.xpath(\"td\").each_with_index do |td,j|\n      case j\n      when 0,11\n        next\n      when 2\n        text = td.text.strip\n        a = td.xpath(\"a\").first\n        href = base+a.attributes[\"href\"].value.strip\n        human_id = href.split(\"=\")[1].split(\"&amp;\")[0]\n        cat = href.split(\"=\")[2]\n        row += [human_id, cat, text, href]\n      when 4\n        text = td.text.strip\n        record = text.split(\"-\")\n        wins = record[0]\n        wko = wins.split(\"(\")[1].split(\")\")[0] rescue 0\n        wins = wins.split(\"(\")[0]\n        losses = record[1]\n        lko = losses.split(\"(\")[1].split(\")\")[0] rescue 0\n        losses = losses.split(\"(\")[0]\n        draws = record[2]\n        row += [wins, wko, losses, lko, draws, text]\n      when 5\n        last6 = []\n        td.xpath(\"table/tr/td\").each do |td2|\n          outcome = td2.attributes[\"class\"].value.strip rescue nil\n          last6 += [outcome]\n        end\n        last6 = last6.to_s.gsub(\"[\",\"{\").gsub(\"]\",\"}\")\n        row += [last6]\n      when 9\n        div = td.xpath(\"div\").first\n        flag = div.attributes[\"class\"].value.strip rescue nil\n        title = div.attributes[\"title\"].value.strip rescue nil\n        row += [flag,title]\n      else\n        text = td.text.strip\n        row += [text]\n      end\n    end\n    if (row.size&gt;2)\n      boxers &lt;&lt; row\n    end\n  end\n  boxers.flush\n\nend\n\nboxers.close\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1497461888, "post_id": 44551227, "comment_id": 76093129, "body": "I haven&#39;t tried, however I think you check this <a href=\"https://gorails.com/episodes/api-auth-with-json-web-tokens-and-knock\" rel=\"nofollow noreferrer\">GoRails video</a> on API auth on JWT."}, {"owner": {"reputation": 114, "user_id": 5245132, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6f004e91e164ad823070480a9354a516?s=128&d=identicon&r=PG&f=1", "display_name": "Chet", "link": "https://stackoverflow.com/users/5245132/chet"}, "reply_to_user": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1497466228, "post_id": 44551227, "comment_id": 76095533, "body": "im using doorkeeper gem for oauth"}], "answers": [{"tags": [], "owner": {"reputation": 7875, "user_id": 2833516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9RQMa.jpg?s=128&g=1", "display_name": "Rahul Gupta", "link": "https://stackoverflow.com/users/2833516/rahul-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1497500992, "creation_date": 1497500992, "answer_id": 44558580, "question_id": 44551227, "link": "https://stackoverflow.com/questions/44551227/how-to-secure-web-pages-with-token-based-authentication/44558580#44558580", "title": "How to secure web pages with token based authentication?", "body": "<p>Now as you have stored the <code>token</code> in the <code>localStorage</code>, <strong>you will need to pass this token with the request to the page where you want to restrict access</strong> and check if the user is authorized to access the page or not.</p>\n"}, {"tags": [], "owner": {"reputation": 1150, "user_id": 4292713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abc34bb1f558a9b2177d0347269a11c?s=128&d=identicon&r=PG&f=1", "display_name": "joepin", "link": "https://stackoverflow.com/users/4292713/joepin"}, "is_accepted": false, "score": 0, "last_activity_date": 1497501803, "creation_date": 1497501803, "answer_id": 44558709, "question_id": 44551227, "link": "https://stackoverflow.com/questions/44551227/how-to-secure-web-pages-with-token-based-authentication/44558709#44558709", "title": "How to secure web pages with token based authentication?", "body": "<p>TL;DR: there is no standard method or library for this; you must implement such functionality as you see fit. </p>\n\n<p>I'm assuming you're using some sort of front end framework like react; if so, then any request to change the current view should be terminated if there is no valid token in localStorage. Check out <a href=\"https://facebook.github.io/react/docs/conditional-rendering.html\" rel=\"nofollow noreferrer\">this post</a> regarding conditional rendering in React; if you're using something else, the methodology is still pretty much the same. </p>\n\n<p>Otherwise, I would build a small script to include in the beginning of every page that checks whether or not there is a valid token and if there isn't, calls <code>window.history.back()</code> to return the user to the previous page. </p>\n\n<p>(Another way of doing it is to intercept every call to a static HTML file on the server, check if there's a token, and send the file if there is. Otherwise, you can send a custom error page or whatever). </p>\n"}], "owner": {"reputation": 114, "user_id": 5245132, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6f004e91e164ad823070480a9354a516?s=128&d=identicon&r=PG&f=1", "display_name": "Chet", "link": "https://stackoverflow.com/users/5245132/chet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1497501803, "creation_date": 1497461606, "question_id": 44551227, "link": "https://stackoverflow.com/questions/44551227/how-to-secure-web-pages-with-token-based-authentication", "title": "How to secure web pages with token based authentication?", "body": "<p>I'm building a website using ruby on rails which is hosted separately which makes requests to another backend api rails app which is again hosted separately. Obviously i've setup the backend api with token based oauth authentication.</p>\n\n<p>Now since im not dealing with sessions, and it being stateless n all, How can I stop users from accessing certain view pages in my front end web app? For example, I have a consumer/booking page. I don't want the user to access this page without being logged in. But anyone can just enter the url and open any page they want right now.</p>\n\n<p>On user login (ajax call from .js.erb files), im getting the token and storing it in localStorage variable for every future request to the api. I know I should use this token somehow to stop users from access restricted pages. But I just dont know how.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "mysql2"], "comments": [{"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 0, "creation_date": 1497457969, "post_id": 44550062, "comment_id": 76090891, "body": "It looks like you have your ducks in a row, so this is probably a redundant question, but: Have you verified that it is this specific migration causing the problem, by, for example, putting debug code in the migration, or using an environment variable to cause just the one migration to be run?  What shows up in the log file, when you run the migration, that is related to this table?"}, {"owner": {"reputation": 2202, "user_id": 3607039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8Bj3I.jpg?s=128&g=1", "display_name": "Bustikiller", "link": "https://stackoverflow.com/users/3607039/bustikiller"}, "edited": false, "score": 1, "creation_date": 1497459010, "post_id": 44550062, "comment_id": 76091474, "body": "Try running <code>rake db:migrate:status</code> to see the migrations that have been applied to the database. Maybe you find out you are connecting to a different schema, or you discover that the migration that is failing is not the one you think is causing the failure."}], "answers": [{"comments": [{"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 1, "creation_date": 1497460639, "post_id": 44550735, "comment_id": 76092383, "body": "Interesting.  Might be a bug in the adapter.  Anyhow, Thanks for recording the resolution.  This may help someone else having the same problem."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497467626, "post_id": 44550735, "comment_id": 76096276, "body": "<code>t.references :author, references: :user, foreign_key: true</code> this may be your issue too because you are passing <code>references: :user</code> as a <code>option</code> to the column definition. This may be a case of a bubble up error resulting in the message you mentioned. (Although looking through the <code>active_record</code> source I cannot see a reason why this would not just be ignored as an <code>option</code>)"}, {"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497469379, "post_id": 44550735, "comment_id": 76097193, "body": "@engineersmnky I did consider that.  I tested removing that <code>reference</code> line altogether which left only the simple reference line of: <code>t.references :user, foreign_key: true</code>.  Unfortunately it still errored out."}], "tags": [], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "is_accepted": true, "score": 5, "last_activity_date": 1497459775, "creation_date": 1497459775, "answer_id": 44550735, "question_id": 44550062, "link": "https://stackoverflow.com/questions/44550062/migration-to-create-table-raises-mysql2error-table-doesnt-exist/44550735#44550735", "title": "Migration to create table raises Mysql2::Error: Table doesn&#39;t exist", "body": "<p>I figured out a work around, but it is still very puzzling to me.  </p>\n\n<p>The error message in the log file was not exactly pointing to the issue.  For some reason, it might be <code>rails 5.1.1</code> or it might be <code>mysql2 0.4.6</code>, but it doesn't like using <code>references</code> within the <code>create_table</code> block for some reason. Very odd because it has worked for me in the past.</p>\n\n<p>So I changed the migration from this:</p>\n\n<pre><code>class CreateTableSomeTable &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :some_tables do |t|\n      t.references :user, foreign_key: true\n      t.references :author, references: :user, foreign_key: true\n      t.text :summary\n    end\n  end\nend\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>class CreateTableSomeTable &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :some_tables do |t|\n      t.integer :user_id\n      t.integer :author_id\n      t.text :summary\n    end\n  end\nend\n</code></pre>\n\n<p>And it worked.  </p>\n\n<p>It is very odd because <code>references</code> works just fine with <code>sqlite3</code> (I  tested this by generating a dummy app, ran a scaffold command with a <code>references</code> column, and ran <code>rails db:migrate</code> and it all worked). </p>\n"}, {"tags": [], "owner": {"reputation": 351, "user_id": 1564884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c60eafd9c06cf8d5e5e4ebcbfb577f2?s=128&d=identicon&r=PG", "display_name": "Marcis Viskints", "link": "https://stackoverflow.com/users/1564884/marcis-viskints"}, "is_accepted": false, "score": 33, "last_activity_date": 1503430234, "creation_date": 1503430234, "answer_id": 45825566, "question_id": 44550062, "link": "https://stackoverflow.com/questions/44550062/migration-to-create-table-raises-mysql2error-table-doesnt-exist/45825566#45825566", "title": "Migration to create table raises Mysql2::Error: Table doesn&#39;t exist", "body": "<p>I got a similar error when trying to create a new model that has a reference to an existing model that was created before migrating to Rails 5.1.</p>\n\n<p>Although the error message was not very clear about that, in my case it turned out that the problem was data type mismatch between the primary key of the old model and the foreign key of the new model (MySQL does not permit that). It was so because since Rails 5.1 the default data type of all the primary and foreign keys is bigint, but for the old model the primary key type was still integer.</p>\n\n<p>I solved this by converting all the primary and foreign keys of the current models to bigint, so I can use the Rails new defaults and forget about it. </p>\n\n<p>A workaround could also be specifying integer type for the new foreign keys so that they match the primary keys type of the old models. Something like the following:</p>\n\n<pre><code>class CreateUserImages &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :user_images do |t|\n      t.references :user, type: :integer, foreign_key: true\n      t.string :url\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 5874744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8aada350a8187a11198b33ea9f98344?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ehven", "link": "https://stackoverflow.com/users/5874744/adam-ehven"}, "is_accepted": false, "score": 0, "last_activity_date": 1513125070, "last_edit_date": 1513125070, "creation_date": 1513123274, "answer_id": 47783526, "question_id": 44550062, "link": "https://stackoverflow.com/questions/44550062/migration-to-create-table-raises-mysql2error-table-doesnt-exist/47783526#47783526", "title": "Migration to create table raises Mysql2::Error: Table doesn&#39;t exist", "body": "<p>This drove me nuts, I think I was seeing a different reason for this than what others suggested.  In my case it happened because my migration file names didn't exactly match the migration class therein.  For example, I had a migration file named <code>20171205232654_bonus.rb</code> but inside the class was declared as <code>class CreateBonus &lt; ActiveRecord::Migration[5.1]</code>.  Once I changed the file name to <code>20171205232654_create_bonus.rb</code> everything worked.</p>\n\n<p>This might have something to do with the fact that I've been creating migrations only, not full scaffolds, and maybe I did something wrong.  I really don't know how I wound up with that mismatch. </p>\n"}, {"comments": [{"owner": {"reputation": 195, "user_id": 2332965, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cca3ab246e1e4776d2229d21db5f16e1?s=128&d=identicon&r=PG", "display_name": "Wellington1993", "link": "https://stackoverflow.com/users/2332965/wellington1993"}, "edited": false, "score": 0, "creation_date": 1527710623, "post_id": 48062923, "comment_id": 88235111, "body": "It&#39;s it, but I think the error should be more explicit, because I can&#39;t see the tips to the solution reading the message. But thanks!"}], "tags": [], "owner": {"reputation": 260, "user_id": 2672545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf114c9a8be3e5a818331fcabc29ea5b?s=128&d=identicon&r=PG", "display_name": "helmutrs", "link": "https://stackoverflow.com/users/2672545/helmutrs"}, "is_accepted": false, "score": 13, "last_activity_date": 1514904105, "creation_date": 1514904105, "answer_id": 48062923, "question_id": 44550062, "link": "https://stackoverflow.com/questions/44550062/migration-to-create-table-raises-mysql2error-table-doesnt-exist/48062923#48062923", "title": "Migration to create table raises Mysql2::Error: Table doesn&#39;t exist", "body": "<p>The big issue with the ActiveRecord migration 5.1 is that now the id are expected to be BIGINT instead of INT, so when you adding a column referring another table created before rails 5.1 it expect the column type to be BIGINT but instead is just an INT, hence the error.\nThe best solution is just modify your migration and change the type of the column to int.</p>\n\n<pre><code>class CreateTableSomeTable &lt; ActiveRecord::Migration[5.1]\n def change\n  create_table :some_tables do |t|\n   t.references :user, foreign_key: true, type: :int\n   t.references :author, references: :user, foreign_key: true\n   t.text :summary\n  end\nend\n</code></pre>\n\n<p>that should work.</p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7420, "favorite_count": 5, "accepted_answer_id": 44550735, "answer_count": 4, "score": 21, "last_activity_date": 1514904105, "creation_date": 1497457525, "last_edit_date": 1497457831, "question_id": 44550062, "link": "https://stackoverflow.com/questions/44550062/migration-to-create-table-raises-mysql2error-table-doesnt-exist", "title": "Migration to create table raises Mysql2::Error: Table doesn&#39;t exist", "body": "<p>I wrote a migration with the following:</p>\n\n<pre><code>class CreateTableSomeTable &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :some_tables do |t|\n      t.references :user, foreign_key: true\n      t.references :author, references: :user, foreign_key: true\n      t.text :summary\n    end\n  end\nend\n</code></pre>\n\n<p>It is a basic migration that is creating a database table.  However: when I run <code>rails db:migrate</code> a very odd error message aborts the migration:</p>\n\n<blockquote>\n  <p>Mysql2::Error: Table 'my_database.some_tables' doesn't exist: SHOW FULL FIELDS FROM 'some_tables'</p>\n</blockquote>\n\n<p>It is as if the error is saying it can't create the table because the table does exist, which doesn't make sense.  </p>\n\n<p>Things I have looked at and tried:</p>\n\n<ul>\n<li>reviewed the database.yml which seems fine.  Nothing has changed, and I have recently run other migrations just fine (though no migrations that created database tables)</li>\n<li>ran <code>bundle</code> to ensure all gems were installed</li>\n<li>deleted the <code>schema.rb</code> file, recreated the database with data from another copy, and I ran <code>rake db:schema:dump</code> to recreate the <code>schema.rb</code> file.  I attempted to run the migration again and still got the same error. </li>\n</ul>\n\n<p>I am using <code>rails 5.1.1</code> as well as <code>mysql2 0.4.6</code></p>\n\n<p>Any tips on how I can get the migration to run?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 438, "user_id": 4903634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a1f8f4d9bda0ced27257e548c1cbdcc?s=128&d=identicon&r=PG&f=1", "display_name": "Artem Ankudovich", "link": "https://stackoverflow.com/users/4903634/artem-ankudovich"}, "edited": false, "score": 0, "creation_date": 1497455394, "post_id": 44549077, "comment_id": 76089356, "body": "Suresh you are assessing for too many activities for a single test. The error its getting is on line 53 as you only posted 32 lines its hard to say which is causing wrong out put can you please let us know which is line 53"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1497455845, "post_id": 44549077, "comment_id": 76089669, "body": "One of the <code>assert_not</code>s is failing. More specifically, if you read the error message, it&#39;s the one on line <code>53</code>. However, there is <b>way too much</b> going on in this test! You should split it out into <i>at least</i> 5 separate tests! Remember that a test will &quot;abort&quot; upon the <b>first</b> assertion failure. This means if something fails near the top of your test, the other &quot;scenarios&quot; won&#39;t even be attempted."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1497456045, "post_id": 44549077, "comment_id": 76089810, "body": "As a rule of thumb (not something to be taken as gospel, but more of a guideline), you should aim to only have <b>one assertion per test</b>. having more is OK if they are <i>closely related</i>, or <i>sanity checks</i>. But not for testing totally different features like &quot;sending an email on account create&quot; vs &quot;checking which template is loaded after logging in&quot; vs &quot;checking non-activated accounts can&#39;t log in&quot;."}, {"owner": {"reputation": 333, "user_id": 7803610, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7677e30ad1d3a9c2e571c1f655f451a8?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/7803610/suresh"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1497493437, "post_id": 44549077, "comment_id": 76105161, "body": "Hi @TomLord thx for your feedback. Btw i have updated my above post.  I am not sure why the error is coming from line 53."}, {"owner": {"reputation": 333, "user_id": 7803610, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7677e30ad1d3a9c2e571c1f655f451a8?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/7803610/suresh"}, "edited": false, "score": 0, "creation_date": 1497497522, "post_id": 44549077, "comment_id": 76106024, "body": "I think the test is failing because on Line 53 assert_not is_logged_in? It&#39;s returning true instead of false or nil. And i am using assert_not which expects to be false or nil. Am i right?"}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 7803610, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7677e30ad1d3a9c2e571c1f655f451a8?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/7803610/suresh"}, "edited": false, "score": 0, "creation_date": 1497525510, "post_id": 44562722, "comment_id": 76120812, "body": "But the thing is assert_not is_logged_in? is returning true instead of false. So how i do solve this problem? The log_in_as(user) is working fine."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 333, "user_id": 7803610, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7677e30ad1d3a9c2e571c1f655f451a8?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/7803610/suresh"}, "edited": false, "score": 0, "creation_date": 1497525717, "post_id": 44562722, "comment_id": 76120936, "body": "Like I said above: The issue is not that <code>log_in_as</code> <i>does not work</i>; the issue is that this is <b>faking</b> the log-in by just setting the <code>session[:user_id]</code> directly. In order for this test to pass, you will need to simulate a <b>real</b> login-in."}, {"owner": {"reputation": 333, "user_id": 7803610, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7677e30ad1d3a9c2e571c1f655f451a8?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/7803610/suresh"}, "edited": false, "score": 0, "creation_date": 1497528027, "post_id": 44562722, "comment_id": 76122425, "body": "Hi Tom, I have attempted what you have told earlier on below"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 333, "user_id": 7803610, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7677e30ad1d3a9c2e571c1f655f451a8?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/7803610/suresh"}, "edited": false, "score": 0, "creation_date": 1497542538, "post_id": 44562722, "comment_id": 76132940, "body": "@Suresh I have updated my answer with one final attempt to show you how this could be done... I also found <a href=\"https://www.railstutorial.org/book/sign_up#sec-a_test_for_valid_submission\" rel=\"nofollow noreferrer\">the online workbook</a> you have been following!"}, {"owner": {"reputation": 333, "user_id": 7803610, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7677e30ad1d3a9c2e571c1f655f451a8?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/7803610/suresh"}, "edited": false, "score": 0, "creation_date": 1497543948, "post_id": 44562722, "comment_id": 76133699, "body": "Hi thank you Tom. I would like to ask you, do you know any best books for rails testing? As far as i am concern the rails tutorial doesn&#39;t teach you testing from stretch."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 0, "last_activity_date": 1497542480, "last_edit_date": 1497542480, "creation_date": 1497515916, "answer_id": 44562722, "question_id": 44549077, "link": "https://stackoverflow.com/questions/44549077/valid-signup-information-with-account-activation-error-expected-true-to-be-ni/44562722#44562722", "title": "valid signup information with account activation - Error: Expected true to be nil or false", "body": "<p>Let's take a look at what each step of your test is actually doing, to understand the error.</p>\n\n<p>First, you \"sign up\" a user - most likely at the <code>UsersController#create</code> action (or whatever else your <code>routes.rb</code> file defines):</p>\n\n<pre><code>post users_path, params: {user: {name: \"Example User\",\n                                 email: \"user@example.com\",\n                                 password: \"password\",\n                                 password_confirmation: \"password\"}}\n</code></pre>\n\n<p>Doing this creates a new <code>User</code> record, where <code>user.disabled == true</code>:</p>\n\n<pre><code>assert_difference 'User.count', 1\nassert_not user.activated?\n</code></pre>\n\n<p><strong>Next, you wanted to test that a disabled user cannot log in</strong>. The logic that dictates this is will be <em>within the login controller action</em>. My guess is that it will be in <code>SessionsController#create</code>, if such a thing exists in your application. It could also be placed somewhere more generic, like as a <code>before_action</code> in the <code>ApplicationController</code>.</p>\n\n<p>In order to test this, you need to simulate a <strong>real</strong> sign-in action. I cannot say for sure what code this will require without seeing the rest of your application, but for example it could be something like:</p>\n\n<pre><code>post sessions_path, params: {user: {email: \"user@example.com\",\n                                 password: \"password\"}}\n</code></pre>\n\n<p>Or if you want to make this a <em>true</em> integration test, you could even simulate filling in the form and clicking the \"log in\" button. What you have here currently is more akin to a controller test, not an integration test.</p>\n\n<hr>\n\n<p>The method you were using previously:</p>\n\n<pre><code>def log_in_as(user)\n  session[:user_id] = user.id\nend\n</code></pre>\n\n<p>Is fine to use in tests that don't care about simulating a \"real\" login. But for tests that <em>do</em> care about the login being \"real\", you need to it the relevant controller action.</p>\n\n<p>In this case, your logic for \"not letting disabled users log in\" was never actually being invoked; hence the failure.</p>\n\n<p>If you want to make the error message clearer when using assertions like this, you can <a href=\"https://apidock.com/rails/ActiveSupport/Testing/Assertions/assert_not\" rel=\"nofollow noreferrer\">include the error message</a> like so:</p>\n\n<pre><code>assert_not is_logged_in?, 'Disabled user was able to log in'\n</code></pre>\n\n<hr>\n\n<p><strong>Below is a complete example of what the tests could look like</strong>. You may need to tweak the implementation slightly, depending on how your controllers are defined.</p>\n\n<pre><code>test \"valid signup information with account activation\" do \n  get signup_path\n  assert_difference 'User.count', 1 do \n    post users_path, params: {user: {name: \"Example User\",\n                                     email: \"user@example.com\",\n                                     password: \"password\",\n                                     password_confirmation: \"password\"}}\n\n    end\n  assert_equal 1, ActionMailer::Base.deliveries.size\n  user = assigns(:user)\n  assert_not user.activated?\nend\n\n\ntest \"cannot log in with disabled account\" do\n  user = user.create!(name: \"Example User\",\n                      email: \"user@example.com\",\n                      password: \"password\",\n                      password_confirmation: \"password\")\n\n  post login_path, params: { session: { email: \"user@example.com\",\n                                        password: \"password\" } }\n\n  assert_not is_logged_in?, 'Disabled user was able to log in'\nend\n\ntest \"cannot login with invalid activation token\" do\n  # ...\nend\n\ntest \"can login with valid activation token\" do\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 7803610, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7677e30ad1d3a9c2e571c1f655f451a8?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/7803610/suresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 44562722, "answer_count": 1, "score": 1, "last_activity_date": 1497542480, "creation_date": 1497454520, "last_edit_date": 1497493234, "question_id": 44549077, "link": "https://stackoverflow.com/questions/44549077/valid-signup-information-with-account-activation-error-expected-true-to-be-ni", "title": "valid signup information with account activation - Error: Expected true to be nil or false", "body": "<p>Can someone please try to help me out in this error? I don't really understand what the error means to me.</p>\n\n<pre><code>test \"valid signup information with account activation\" do \n  get signup_path\n  assert_difference 'User.count', 1 do \n    post users_path, params: {user: {name: \"Example User\",\n                                     email: \"user@example.com\",\n                                     password: \"password\",\n                                     password_confirmation: \"password\"}}\n\n    end\n  assert_equal 1, ActionMailer::Base.deliveries.size\n  user = assigns(:user)\n  assert_not user.activated?\n\n  #Try to log in before actication.\n  log_in_as(user)\n  assert_not is_logged_in?\n\n  #Invalid activation token with valid email\n  get edit_account_activation_path('invalid token',email: user.email)\n  assert_not is_logged_in?\n\n  #Valid activation token with invalid email\n  get edit_account_activation_path(user.activation_token, email: 'wrong')\n  assert_not is_logged_in?\n\n  #Valid activation token with valid email\n  get edit_account_activation_path(user.activation_token,email: user.email)\n  assert user.reload.activated?\n  follow_redirect!\n  assert_template 'users/show'\n  assert is_logged_in?\n end\n</code></pre>\n\n<p>This test is keep failing because of this error:</p>\n\n<pre><code>Failure:\nUsersSignupTest#test_valid_signup_information_with_account_activation [D:/RubyOnRails/RailsProjects/sample_app/test/integration/users_signup_test.rb:53]:\nExpected true to be nil or false\n</code></pre>\n\n<p>The Error on line 53 is coming from here.</p>\n\n<pre><code>Line 52 log_in_as(user)\nLine 53 assert_not is_logged_in?\n</code></pre>\n\n<p>This is my methods</p>\n\n<pre><code>def is_logged_in?\n   !session[:user_id].nil?\nend\n\ndef log_in_as(user)\nsession[:user_id] = user.id\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "factory-bot"], "comments": [{"owner": {"reputation": 3247, "user_id": 2304517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Wv4Xe.png?s=128&g=1", "display_name": "Xero", "link": "https://stackoverflow.com/users/2304517/xero"}, "edited": false, "score": 0, "creation_date": 1497454508, "post_id": 44548897, "comment_id": 76088797, "body": "It&#39;s seems that the answer is &quot;sequence :email do |n|     &quot;person#{n}@example.com&quot;   end&quot; but I don&#39;t get it"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1497454524, "post_id": 44548897, "comment_id": 76088808, "body": "Do you clear your database between test runs?"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 1, "creation_date": 1497456867, "post_id": 44548897, "comment_id": 76090280, "body": "@sergey-mell provided good answer, but actually you just forgot to use <b>block</b> <code>email { each_time_code }</code> so code <code>&quot;#{SecureRandom.hex}@test.com&quot;</code> executed <b>one</b> time and factory tries to create a guest with same constant email each time."}], "answers": [{"tags": [], "owner": {"reputation": 6624, "user_id": 4896493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/197888927236621/picture?type=large", "display_name": "Sergey Mell", "link": "https://stackoverflow.com/users/4896493/sergey-mell"}, "is_accepted": true, "score": 5, "last_activity_date": 1497454548, "creation_date": 1497454548, "answer_id": 44549088, "question_id": 44548897, "link": "https://stackoverflow.com/questions/44548897/factorygirl-email-already-taken/44549088#44549088", "title": "FactoryGirl Email already taken", "body": "<p>Use sequence in your factory</p>\n\n<pre><code>FactoryGirl.define do\n  factory :guest do\n    sequence(:email) { |n| \"name_#{n}@example.com\" }\n</code></pre>\n\n<p>Or in combination with Faker</p>\n\n<pre><code>FactoryGirl.define do\n  factory :guest do\n    sequence(:email) { |n| Faker::Internet.unique.email(\"Nancy_#{n}\") }\n</code></pre>\n"}], "owner": {"reputation": 3247, "user_id": 2304517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Wv4Xe.png?s=128&g=1", "display_name": "Xero", "link": "https://stackoverflow.com/users/2304517/xero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 44549088, "answer_count": 1, "score": 1, "last_activity_date": 1497454548, "creation_date": 1497454046, "question_id": 44548897, "link": "https://stackoverflow.com/questions/44548897/factorygirl-email-already-taken", "title": "FactoryGirl Email already taken", "body": "<p>I'm trying to instanciate with FactoryGirl multiple object (guests who have unique email)</p>\n\n<pre><code>  guests = create_list(:guest, 3)\n</code></pre>\n\n<p>But I get error :</p>\n\n<pre><code> Failure/Error: guests = create_list(:guest, 3)\n\n ActiveRecord::RecordInvalid:\n   Validation failed: Email has already been taken\n</code></pre>\n\n<p>Here my factory :</p>\n\n<pre><code>FactoryGirl.define do\n  factory :guest do\n    email Faker::Internet.unique.email\n    firstname 'John'\n    lastname  'Doe'\n    password 'test'\n    password_confirmation 'test'\n\n    factory :guest_with_bookings do\n      email \"#{SecureRandom.hex}@test.com\"\n      transient do\n        bookings_count 2\n      end\n      after(:create) do |guest, evaluator|\n        create_list(:booking, evaluator.bookings_count, guests: [guest])\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Even with Faker::Internet.unique.email, it's don't working when I try to create more than 1 guest</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "carrierwave"], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 3041553, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/584dd1ff1a7c9340076b912cdc130249?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Satyarth", "link": "https://stackoverflow.com/users/3041553/arun-satyarth"}, "edited": false, "score": 0, "creation_date": 1497621049, "post_id": 44548854, "comment_id": 76169477, "body": "I was trying to introduce a caching layer by saving the records in  Redis. Loading from db would  defeat the purpose. If there is a way to assign a url back to a carrierwave uploader field, thats what I am looking for...."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 383, "user_id": 3041553, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/584dd1ff1a7c9340076b912cdc130249?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Satyarth", "link": "https://stackoverflow.com/users/3041553/arun-satyarth"}, "edited": false, "score": 0, "creation_date": 1497622323, "post_id": 44548854, "comment_id": 76170510, "body": "Is your Database for a simple query like that slower than Redis? Why? Indexes missing?"}, {"owner": {"reputation": 383, "user_id": 3041553, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/584dd1ff1a7c9340076b912cdc130249?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Satyarth", "link": "https://stackoverflow.com/users/3041553/arun-satyarth"}, "edited": false, "score": 0, "creation_date": 1497627191, "post_id": 44548854, "comment_id": 76173797, "body": "This was mostly so that I could benchmark  for myself how &quot;blazingly fast&quot; redis is than mysql especially with different kinds of where clauses on the User model."}, {"owner": {"reputation": 383, "user_id": 3041553, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/584dd1ff1a7c9340076b912cdc130249?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Satyarth", "link": "https://stackoverflow.com/users/3041553/arun-satyarth"}, "edited": false, "score": 0, "creation_date": 1497627265, "post_id": 44548854, "comment_id": 76173852, "body": "Temporarily I did it with the following  workaround. I added the following in User model attr_accessor :picture and while creating User object from json, I just read from user[:profilepic][:url] and assign to picture  Then I read from picture in the views..."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1503045648, "last_edit_date": 1503045648, "creation_date": 1497453909, "answer_id": 44548854, "question_id": 44548640, "link": "https://stackoverflow.com/questions/44548640/how-to-cache-a-activerecord-model-object-which-contains-carrierwave-uploader-to/44548854#44548854", "title": "How to cache a ActiveRecord model object which contains carrierwave uploader to Redis", "body": "<p>Instead of storing an <code>ActiveRecord::Base</code> in Redis, you should just store its <code>id</code> and reload the object from the database when needed.</p>\n\n<p>The reason is pretty simple: It is not possible to regenerate an instance of <code>ActiveRecord::Base</code> by serializing it to JSON and restoring it with <code>Model.new(json_data)</code>. Because <code>to_json</code> might not serialize all attributes and <code>Model.new</code> might not restore the instances internal state.</p>\n\n<p>In your example, the specific problem is that <code>User.new</code> expects a file object for the <code>profilepic</code>. But <code>to_json</code> method is not able to render a file object into the JSON, instead, it renders a hash containing a URL.</p>\n"}], "owner": {"reputation": 383, "user_id": 3041553, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/584dd1ff1a7c9340076b912cdc130249?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Satyarth", "link": "https://stackoverflow.com/users/3041553/arun-satyarth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 735, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1503045648, "creation_date": 1497453319, "question_id": 44548640, "link": "https://stackoverflow.com/questions/44548640/how-to-cache-a-activerecord-model-object-which-contains-carrierwave-uploader-to", "title": "How to cache a ActiveRecord model object which contains carrierwave uploader to Redis", "body": "<p>I have a user model which has a carrierwave uploader for storing ths users profile picture</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    mount_uploader :profilepic, LogoUploaderUploader\n</code></pre>\n\n<p>I want to cache this User object in redis. While caching I call the to_json method on the activerecord object which converts the profilepic field in the user object to a hash containing the url of the image</p>\n\n<pre><code>user={id:1, username: \"sam\", profilepic: {url:\"path_to_image.jpg\"}}\n</code></pre>\n\n<p>This part is fine and I can store it in redis. But the trouble comes when I retrieve the data from redis and try to convert it to a ActiveRecord object like the following</p>\n\n<pre><code>user=User.new(json_data)\n</code></pre>\n\n<p>The profilepic field comes null. Looks like it is not able to deserialize the profilepic hash <code>profilepic: {url:\"path_to_image.jpg\"}</code>to a proper value.</p>\n\n<p>Is there anyway I can get back the proper value for profilepic after saving to redis.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "initialization", "instance-variables"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1497452236, "creation_date": 1497452236, "answer_id": 44548265, "question_id": 44548175, "link": "https://stackoverflow.com/questions/44548175/object-is-nil-when-initialized-as-instance-variable/44548265#44548265", "title": "Object is nil when initialized as instance variable", "body": "<p>Put that in a constructor. In your snippet that assignment expression is executed but in another scope that you don't have in the <code>send_email</code> method</p>\n\n<pre><code>class EmailService\n  include SendGrid\n\n  def initialize\n    @send_grid = SendGrid::API.new(api_key: ENV['SENDGRID_API_KEY'])\n  end\n\n  def send_email\n    from = Email.new(email: 'test@example.com')\n    to = Email.new(email: 'test@example.com')\n    subject = 'Sending with SendGrid is Fun'\n    content = Content.new(type: 'text/plain', value: 'and easy to do anywhere, even with Ruby')\n    mail = Mail.new(from, subject, to, content)\n\n    response = @send_grid.client.mail._('send').post(request_body: mail.to_json)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2317, "user_id": 5961990, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/971b4e854947e71931bf6dee307b59c0?s=128&d=identicon&r=PG&f=1", "display_name": "garci560", "link": "https://stackoverflow.com/users/5961990/garci560"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497452236, "creation_date": 1497452011, "question_id": 44548175, "link": "https://stackoverflow.com/questions/44548175/object-is-nil-when-initialized-as-instance-variable", "title": "Object is nil when initialized as instance variable", "body": "<p>I'm new to Ruby, and to Rails. I'm failing to understand why the following happens. I'm using SendGrid to send emails. I've defined a class and a method:</p>\n\n<pre><code>class EmailService\n  include SendGrid\n\n  def send_email\n    from = Email.new(email: 'test@example.com')\n    to = Email.new(email: 'test@example.com')\n    subject = 'Sending with SendGrid is Fun'\n    content = Content.new(type: 'text/plain', value: 'and easy to do anywhere, even with Ruby')\n    mail = Mail.new(from, subject, to, content)\n\n    response = sg.client.mail._('send').post(request_body: mail.to_json)\n  end\n\nend\n</code></pre>\n\n<p>This works perfectly. However, I think it'd be better to initialize the client only once, and not every time the method is called. So I've extracted it as an instance variable.</p>\n\n<pre><code>class EmailService\n  include SendGrid\n\n  @send_grid = SendGrid::API.new(api_key: ENV['SENDGRID_API_KEY'])\n\n  def send_email\n    from = Email.new(email: 'test@example.com')\n    to = Email.new(email: 'test@example.com')\n    subject = 'Sending with SendGrid is Fun'\n    content = Content.new(type: 'text/plain', value: 'and easy to do anywhere, even with Ruby')\n    mail = Mail.new(from, subject, to, content)\n\n    response = @send_grid.client.mail._('send').post(request_body: mail.to_json)\n  end\n\nend\n</code></pre>\n\n<p>Now I get <code>#&lt;NoMethodError: undefined method 'client' for nil:NilClass&gt;</code>. By bebugging I see that <code>@send_grid</code> is nil.</p>\n\n<p>I'm invoking the method with <code>EmailService.new.send_email</code>. To my understanding, <code>@send_grid</code> is an instance variable and should be initialized with the class.</p>\n\n<p>Why does this happen?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "edited": false, "score": 0, "creation_date": 1497452177, "post_id": 44548103, "comment_id": 76087073, "body": "Cuz docs (<a href=\"https://www.ruby-lang.org/en/documentation/installation/#yum\" rel=\"nofollow noreferrer\">ruby-lang.org/en/documentation/installation/#yum</a>) say: <code>The installed version is typically the latest version of Ruby available at the release time of the specific distribution version.</code>   try to play with repos: <a href=\"https://wiki.centos.org/AdditionalResources/Repositories\" rel=\"nofollow noreferrer\">wiki.centos.org/AdditionalResources/Repositories</a> to make sure You&#39;ve enabled latest centos repo"}, {"owner": {"reputation": 942, "user_id": 279125, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1519d374763b9f2fd5a11106f98cb121?s=128&d=identicon&r=PG", "display_name": "wsaxton", "link": "https://stackoverflow.com/users/279125/wsaxton"}, "reply_to_user": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "edited": false, "score": 1, "creation_date": 1497452293, "post_id": 44548103, "comment_id": 76087150, "body": "This is a self-imposed limitation though.  Why wouldn&#39;t they make the latest version available in, say, their own repo??"}, {"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "edited": false, "score": 0, "creation_date": 1497452318, "post_id": 44548103, "comment_id": 76087182, "body": "updated my comment (:"}, {"owner": {"reputation": 942, "user_id": 279125, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1519d374763b9f2fd5a11106f98cb121?s=128&d=identicon&r=PG", "display_name": "wsaxton", "link": "https://stackoverflow.com/users/279125/wsaxton"}, "reply_to_user": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "edited": false, "score": 1, "creation_date": 1497452855, "post_id": 44548103, "comment_id": 76087531, "body": "Every single ruby/centos search I do leads me to RVM installation instructions.  This has lead me to assume that that is the ONLY way to install it.  Maybe if I have the time I&#39;ll try playing the repo guessing game!"}, {"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "edited": false, "score": 0, "creation_date": 1497452893, "post_id": 44548103, "comment_id": 76087563, "body": "use <code>ArchLinux</code> (:"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1497453052, "post_id": 44548103, "comment_id": 76087712, "body": "<code>rvm</code> or <code>rb_env</code> are probably a better choice anyway as they allow multiple ruby versions to coexist nicely in a single environment. P.S. GO BIRDS!"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 1, "creation_date": 1497453392, "post_id": 44548103, "comment_id": 76087987, "body": "Because <code>yum</code>&#39;s maintainers have better things to do than stalk Ruby for new releases. Also it&#39;s better if <code>yum</code> gives you a version that is considered stable as opposed to the latest."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497462753, "post_id": 44548103, "comment_id": 76093646, "body": "&quot;some arduous process&quot;? Your definition of arduous is different than mine."}], "answers": [{"comments": [{"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1497459813, "post_id": 44548679, "comment_id": 76091954, "body": "Good answer, but don&#39;t forget Vagrant and Docker alongside the options of rbenv and rvm."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1497462590, "post_id": 44548679, "comment_id": 76093569, "body": "also building from source"}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": false, "score": 5, "last_activity_date": 1497461878, "last_edit_date": 1497461878, "creation_date": 1497453438, "answer_id": 44548679, "question_id": 44548103, "link": "https://stackoverflow.com/questions/44548103/why-cant-i-just-install-the-latest-version-of-ruby-with-yum/44548679#44548679", "title": "Why can&#39;t I just install the latest version of ruby with yum?", "body": "<p>Things change between Ruby versions. With the release of Ruby 2.4.0, many gems and applications needed to be updated in order to be compatible without breaking, including JSON, Rails, Nokogiri and others.</p>\n\n<p>Now, with a OS distribution, people usually expect two things:</p>\n\n<ol>\n<li>relative stability over its release cycle, so, things which worked yesterday continue to work tomorrow</li>\n<li>that all shipped packages are compatible to each other.</li>\n</ol>\n\n<p>If the CentOS maintainers were to upgrade their Ruby version mid-release, they would have to ensure that all other software they ship which depends on Ruby is also compatible with this new version, probably by also updating it. This leads to a maintenance nightmare since, often, these updates also change features which break the first point of requiring stability.</p>\n\n<p>Because of that distributions usually ship a single version of Ruby (or Python or Perl) and only fix necessary bugs by backporting the fixes to their versions. Major updates are usually only done with a complete new OS release. How often this happens depends on the distribution you use. CentOS/RHEL tend to be very slow, Debian is so-so, Ubuntu has slower-to-update LTS releases and quicker-to-update regular releases.</p>\n\n<p>In general, you trade stability for bleeding edge. And for their base OS, most people running servers tend to favor stability.</p>\n\n<p>To use a newer version of Ruby for your own apps, you can still use rbenv, RVM, or any of the other Ruby installers. You can install these custom Ruby versions along the OS version and configure your own applications to use these versions.</p>\n"}], "owner": {"reputation": 942, "user_id": 279125, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1519d374763b9f2fd5a11106f98cb121?s=128&d=identicon&r=PG", "display_name": "wsaxton", "link": "https://stackoverflow.com/users/279125/wsaxton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497462521, "creation_date": 1497451784, "last_edit_date": 1497462521, "question_id": 44548103, "link": "https://stackoverflow.com/questions/44548103/why-cant-i-just-install-the-latest-version-of-ruby-with-yum", "title": "Why can&#39;t I just install the latest version of ruby with yum?", "body": "<p>I am frustrated: I want to <code>yum install ruby</code> and install Ruby 2.4.1 or 2.3.0.  Instead it seems that I have to use RVM or rbenv to get any version after 2.0.0 and both of those tools require some arduous process.</p>\n\n<p>Why is this so complicated?  Shouldn't I be able to install Ruby with a single yum command and use '/usr/bin/ruby' like I would '/usr/bin/java'?</p>\n"}, {"tags": ["ruby", "debugging"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497453183, "post_id": 44548084, "comment_id": 76087799, "body": "you could place them on separate lines <code>ruby</code> does not mind this. If the previous line ends with a dot (<code>.</code>), or the next line starts with one, the next line will pick up as if they were inline. <b>caveat: IRB does not like the next line starting with a dot portion but in file code it will perform fine</b>"}, {"owner": {"reputation": 890, "user_id": 1412133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/703fbc991fd63e0e1db54dca9ea31b53?s=128&d=identicon&r=PG", "display_name": "lab419", "link": "https://stackoverflow.com/users/1412133/lab419"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497462355, "post_id": 44548084, "comment_id": 76093428, "body": "as far as I know @engineersmnky &#39;s solution is the only one which is a hassle, especially when stepping through library code"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497479350, "post_id": 44548084, "comment_id": 76101871, "body": "Your question is too broad. We don&#39;t know what you are using to debug. And, you are asking us for tools to do it, which is asking for recommendations, which is off-topic."}, {"owner": {"reputation": 3967, "user_id": 1751321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/62f4ca296fd86fffa81987e5ace94b86?s=128&d=identicon&r=PG", "display_name": "Daniel Garmoshka", "link": "https://stackoverflow.com/users/1751321/daniel-garmoshka"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497784465, "post_id": 44548084, "comment_id": 76215119, "body": "Respected mr. @theTinMan , if you don&#39;t understand question - it doesn&#39;t always mean, that question is too broad.  I&#39;m using ruby to debug ruby scripts and asking for ways, to solve specific clearly marked task - either with standard debugger or some library (if any exists).  Please, read &quot;What is a recommendation question?&quot; in meta, and cancel your down-vote on this topic"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497891066, "post_id": 44548084, "comment_id": 76257652, "body": "I understand the question, and use debuggers in all languages I write in, because single-stepping is essential to understanding a problem in code. I also understand what SO wants in questions."}], "answers": [{"tags": [], "owner": {"reputation": 3967, "user_id": 1751321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/62f4ca296fd86fffa81987e5ace94b86?s=128&d=identicon&r=PG", "display_name": "Daniel Garmoshka", "link": "https://stackoverflow.com/users/1751321/daniel-garmoshka"}, "is_accepted": false, "score": 0, "last_activity_date": 1497944337, "creation_date": 1497944337, "answer_id": 44646779, "question_id": 44548084, "link": "https://stackoverflow.com/questions/44548084/ruby-debugging-how-to-step-over-inline-breakpoints/44646779#44646779", "title": "Ruby debugging: how to step over inline breakpoints", "body": "<p>Debug library which allows to step into function by name with <code>step func_name</code>:</p>\n\n<p><a href=\"https://github.com/garmoshka-mo/pry-moves\" rel=\"nofollow noreferrer\">https://github.com/garmoshka-mo/pry-moves</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/4vm4F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4vm4F.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>here <code>s</code> is shortcut for <code>step</code></em></p>\n"}], "owner": {"reputation": 3967, "user_id": 1751321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/62f4ca296fd86fffa81987e5ace94b86?s=128&d=identicon&r=PG", "display_name": "Daniel Garmoshka", "link": "https://stackoverflow.com/users/1751321/daniel-garmoshka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1497944337, "creation_date": 1497451738, "question_id": 44548084, "link": "https://stackoverflow.com/questions/44548084/ruby-debugging-how-to-step-over-inline-breakpoints", "title": "Ruby debugging: how to step over inline breakpoints", "body": "<p>How to step over pieces of single line while debugging in ruby?</p>\n\n<p><em>What I'm looking for - is ability to step by commands while executing line, move over line parts, calling its separate methods, function by function. Ability to separately step over multiple functions in line.</em></p>\n\n<p>Like in javascript (screenshot from Chrome console):</p>\n\n<p><a href=\"https://i.stack.imgur.com/1EgQY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1EgQY.png\" alt=\"enter image description here\"></a></p>\n\n<p>For example, here I don't need to step into previously chained method call <code>all(promises)</code>, but need to go right into <code>then</code>.</p>\n\n<p>Seems to be essential functionality for modern programming language, though can't find how to do it in ruby. For now I have to <strong>step into</strong> each function in line and <strong>finish</strong> it's execution to trap into next function call - repeating it till I get into needed chained function - it's monkey job now :).</p>\n\n<p>Disclaimer: There could be opinions, that I could avoid methods chaining, but it <strong>is</strong> convenient. (Generally, looking for convenient ways of work and tools for it)</p>\n"}, {"tags": ["ios", "ruby", "fastlane", "xcconfig"], "answers": [{"tags": [], "owner": {"reputation": 409, "user_id": 2617857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6d56a75e75c354d91463cc0ea39199?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2617857/thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1497602626, "creation_date": 1497602626, "answer_id": 44584724, "question_id": 44548017, "link": "https://stackoverflow.com/questions/44548017/how-to-read-xcconfig-file-constants-with-ruby-to-use-them-as-fastlane-lane-vari/44584724#44584724", "title": "How to read .xcconfig file constants with ruby to use them as Fastlane lane variables?", "body": "<p>What about directly open Xcode project and loop through targets/configurations to find the correct one:</p>\n\n<pre><code>lane :development do |options|\n\n    # Getting lane settings\n\n    #adding lane_name to the options\n    options = options.merge(lane_name: 'development')\n\n    project = '../PATH_TO_XCODE_PROJ'\n    target = 'TARGET'\n    buildConfiguration = 'BUILD_CONFIGURATION'\n    app_identifier = ''\n\n    project = Xcodeproj::Project.open(project)\n    project.targets.each do |mtarget|\n        if mtarget.name == target\n            mtarget.build_configurations.each do |mbuild|\n                if mbuild.name == buildConfiguration\n                    app_identifier = mbuild.build_settings['PRODUCT_BUNDLE_IDENTIFIER']\n                end\n            end\n        end\n    end\n\n    pilot(skip_submission: true)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 271, "user_id": 4626276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/78nY4.jpg?s=128&g=1", "display_name": "fedulvtubudul", "link": "https://stackoverflow.com/users/4626276/fedulvtubudul"}, "is_accepted": false, "score": 5, "last_activity_date": 1513068624, "creation_date": 1513068624, "answer_id": 47768475, "question_id": 44548017, "link": "https://stackoverflow.com/questions/44548017/how-to-read-xcconfig-file-constants-with-ruby-to-use-them-as-fastlane-lane-vari/47768475#47768475", "title": "How to read .xcconfig file constants with ruby to use them as Fastlane lane variables?", "body": "<p>I've been working on a similar task and have found a solution that seems to work. Answering your question, we can open the .xcconfig file and read a value by key. </p>\n\n<pre><code>lane :development do |options|\n    fastlane_require 'Xcodeproj'\n\n    # Compose .xcconfig file path\n    configuration_file = \"../Brand\" + options[:brand_name] + \"Configs/config.xcconfig\"\n\n    # Read values from the .xcconfig file\n    configuration = Xcodeproj::Config.new(configuration_file)\n    app_identifier = configuration.attributes['PRODUCT_BUNDLE_IDENTIFIER']\n\n    ... \nend\n</code></pre>\n\n<p>But I find it as a quite dirty solution, as there is still some duplication: we've specified a config file for target/configuration in the Xcode project, and now we manually specifying it again.</p>\n\n<p>There are even more issues appear as soon as we begin to \"inherit\" (include) configuration files from each other. It can be useful in case you have lots of build configurations and most of them share same settings, but only <em>some</em> settings differ across configurations.</p>\n\n<p>The right way to achieve what you most likely need is to get the flag value by merging all applicable sources: project, target, configuration, configuration files. This can be done by getting build settings from your <em>configuration</em>, not from the .xcconfig itself.</p>\n\n<pre><code>lane :development do |options|\n    fastlane_require 'Xcodeproj'\n\n\n    # Here we can define some hardcoded values,\n    # or read them from lane options,\n    # or read them from environment variables...\n    project_name = '../XXX.xcodeproj'\n    target_name = 'YYY'\n    configuration_name = 'ZZZ'\n\n    # Read values from the configuration,\n    # specified in project settings for a specific target.\n    project = Xcodeproj::Project.open(project_name)\n    target = project.native_targets.find {|s| s.name == target_name }\n    configuration = target.build_configurations.find {|s| s.name == configuration_name}\n    app_identifier = configuration.resolve_build_setting('PRODUCT_BUNDLE_IDENTIFIER')\n\n    ...\n\nend\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 1164078, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05e2fce0b45a4a79a70cd20b98d45aac?s=128&d=identicon&r=PG", "display_name": "BastienPenalba", "link": "https://stackoverflow.com/users/1164078/bastienpenalba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1861, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1513068624, "creation_date": 1497451534, "question_id": 44548017, "link": "https://stackoverflow.com/questions/44548017/how-to-read-xcconfig-file-constants-with-ruby-to-use-them-as-fastlane-lane-vari", "title": "How to read .xcconfig file constants with ruby to use them as Fastlane lane variables?", "body": "<p>I'm trying to deploy my iOS apps with Fastlane with the current configuration: a single project with multiple targets and multiple environments (using .xccconfig files). I created 3 lanes: development, beta, distribution. Theses lanes takes a \"brand_name\" as parameter so I can use the same lane for every targets.</p>\n\n<p>What I'm trying to achieve is to \"read\" the constants in the target's .xcconfig file (e.g <code>PRODUCT_BUNDLE_IDENTIFIER</code>) and use it as a variable in my lane. I managed to do this by creating and reading a yaml file containing the target's bundle id, but since I'm already using .xcconfig files I would like to avoid duplication. I did some searching to find an answer but since I'm fairly new to ruby I'm stuck right now. Is there a way to achieve this please?</p>\n\n<p>If it helps, here is a working lane I'm currently using with a comment on the part I want to replace using a .xcconfig file instead of a yaml file :</p>\n\n<pre><code>lane :development do |options|\n\n    # Getting lane settings\n\n    #adding lane_name to the options\n    options = options.merge(lane_name: 'development') \n\n    # THIS IS THE PART I'D LIKE TO REPLACE WITH .XCCONFIG FILE INSTEAD OF YAML\n    #fastlane config path\n    config = YAML.load_file(File.join(File.dirname(__FILE__),\"../Brand\", options[:brand_name],\"Configs/fastlane_config.yaml\"))\n    settings = OpenStruct.new(config)\n    lane_settings = settings[options[:lane_name]]\n\n    # Settings the App Identifier\n    app_identifier = lane_settings[\"bundle_identifier\"]\n\n    pilot(skip_submission: true)\nend\n</code></pre>\n\n<p>Thank you </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "youtube-dl"], "comments": [{"owner": {"reputation": 254, "user_id": 2374041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652e1bfe2d4f6f68ad132d80b65e14f6?s=128&d=identicon&r=PG", "display_name": "jmschles", "link": "https://stackoverflow.com/users/2374041/jmschles"}, "edited": false, "score": 0, "creation_date": 1497469459, "post_id": 44547419, "comment_id": 76097235, "body": "I just installed the gem and ran your code in both a new IRB shell and a Rails console, and got identical results (aside from unique strings). Both matched the shorter Rails console version in your question. Could there be some sort of config option you have set in your IRB shell that&#39;s resulting in additional data?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6107987"}, "edited": false, "score": 1, "creation_date": 1499523150, "post_id": 44987120, "comment_id": 76948339, "body": "Yes, thanks. It&#39;s true. I&#39;m removed youtube-dl lib from laptop and installed youtube-dl.rb from my fork with updated library. Now it&#39;s the same."}], "tags": [], "owner": {"reputation": 38, "user_id": 8275274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c6108396b9e851eb5e073be1fe96bee?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Funin", "link": "https://stackoverflow.com/users/8275274/oleg-funin"}, "is_accepted": true, "score": 1, "last_activity_date": 1499522806, "creation_date": 1499522806, "answer_id": 44987120, "question_id": 44547419, "link": "https://stackoverflow.com/questions/44547419/different-result-from-rails-and-irb-for-youtubedl-get/44987120#44987120", "title": "Different result from rails and irb for YoutubeDL.get", "body": "<p>Try to check youtube-dl.rb version inside your rails app and inside your machine enviro</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6107987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 44987120, "answer_count": 1, "score": 0, "last_activity_date": 1499522806, "creation_date": 1497449999, "question_id": 44547419, "link": "https://stackoverflow.com/questions/44547419/different-result-from-rails-and-irb-for-youtubedl-get", "title": "Different result from rails and irb for YoutubeDL.get", "body": "<p>I'm using gem 'youtube-dl.rb'.</p>\n\n<p>From irb, I can get full result, about video, but at the rails 4.2 - I can't.</p>\n\n<p>irb</p>\n\n<pre><code>require 'youtube-dl.rb'     \na = YoutubeDL.get \"https://www.youtube.com/watch?v=5dsGWM5XGdg\", {skip_download: true}\n</code></pre>\n\n<p>Result <a href=\"https://pastebin.com/9SLbs5GF\" rel=\"nofollow noreferrer\">https://pastebin.com/9SLbs5GF</a> (With a lot of data).</p>\n\n<p>rails c </p>\n\n<pre><code>require 'youtube-dl.rb'     \na = YoutubeDL.get \"https://www.youtube.com/watch?v=5dsGWM5XGdg\", {skip_download: true}\n</code></pre>\n\n<p>Result from rails console have only this:</p>\n\n<pre><code> =&gt; #&lt;YoutubeDL::Video:0x007fbc29de1498 @url=\"https://www.youtube.com/watch?v=5dsGWM5XGdg\", @options=#&lt;YoutubeDL::Options:0x007fbc29de1448 @store={:skip_download=&gt;true}&gt;, @download_options=#&lt;YoutubeDL::Options:0x007fbc29de1150 @store={:color=&gt;false, :progress=&gt;false, :skip_download=&gt;true}&gt;, @last_download_output=\"[youtube] 5dsGWM5XGdg: Downloading webpage\\n[youtube] 5dsGWM5XGdg: Downloading video info webpage\\n[youtube] 5dsGWM5XGdg: Extracting video information\\n[youtube] 5dsGWM5XGdg: Downloading MPD manifest\\n\"&gt; \n</code></pre>\n\n<p>How I Can get the same result for RoR?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "axlsx"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 6366329, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6e577e7348ffd7d41f05bbf8332eb306?s=128&d=identicon&r=PG&f=1", "display_name": "singard", "link": "https://stackoverflow.com/users/6366329/singard"}, "edited": false, "score": 0, "creation_date": 1497538752, "post_id": 44562571, "comment_id": 76130370, "body": "Thanks for this. Do you know if it&#39;s possible to assign the formulas to the whole column. So in your case, all C columns will be the addition of corresponding A and B columns"}], "tags": [], "owner": {"reputation": 445, "user_id": 8018505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b91738cee0a49bbbf95faf11cf9bc5a?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Coleman", "link": "https://stackoverflow.com/users/8018505/paul-coleman"}, "is_accepted": true, "score": 3, "last_activity_date": 1497599363, "last_edit_date": 1497599363, "creation_date": 1497515531, "answer_id": 44562571, "question_id": 44546985, "link": "https://stackoverflow.com/questions/44546985/ruby-axlsx-gem-assign-formula-to-axlsx-worksheet-without-using-add-row/44562571#44562571", "title": "ruby axlsx gem: assign formula to axlsx worksheet without using add-row", "body": "<p>Here is an example of adding a formula to an existing cell.</p>\n\n<pre><code>pk = Axlsx::Package.new\nwb = pk.workbook\nsheet = wb.add_worksheet(name: 'Test')\nsheet.add_row(['First', 'Second', 'Third'])\nsheet.add_row([1, 1, 1])\nsheet.add_row([2, 2, 2])\nsheet.add_row([3, 3, 0])    # we will be updating the last cell in this row (C4)\nsheet.add_row([4, 4, 4])\n\ncell = sheet['C4']\ncell.type = :string         # it is important to ensure the type of the cell is set before adding the formula\ncell.value = '=A3+A4'\n\npk.serialize(\"example.xlsx\")\n</code></pre>\n\n<p>Here is an example to dynamically update the cell formula:</p>\n\n<pre><code>pk = Axlsx::Package.new\nwb = pk.workbook\nsheet = wb.add_worksheet(name: 'Test')\nsheet.add_row(['First', 'Second', 'Third'])\nsheet.add_row([1, 1, 1])\nsheet.add_row([2, 2, 2])\nsheet.add_row([3, 3, 3])\nsheet.add_row([4, 4, 4])\n\ncells = sheet[\"C2:C5\"]  # select an array of cells\n\ncells.each do |cell|\n  row_index = cell.row.index + 1\n  cell.type = :string\n  cell.value = \"=SUM(A#{row_index}:B#{row_index})\"\nend\n\npk.serialize(\"example2.xlsx\")\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 6366329, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6e577e7348ffd7d41f05bbf8332eb306?s=128&d=identicon&r=PG&f=1", "display_name": "singard", "link": "https://stackoverflow.com/users/6366329/singard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2829, "favorite_count": 2, "accepted_answer_id": 44562571, "answer_count": 1, "score": 1, "last_activity_date": 1497599363, "creation_date": 1497448814, "question_id": 44546985, "link": "https://stackoverflow.com/questions/44546985/ruby-axlsx-gem-assign-formula-to-axlsx-worksheet-without-using-add-row", "title": "ruby axlsx gem: assign formula to axlsx worksheet without using add-row", "body": "<p>According to the official examples, it is possible to assign formulas to sheets during add_row <a href=\"https://github.com/randym/axlsx/blob/master/examples/example.rb#L355\" rel=\"nofollow noreferrer\">https://github.com/randym/axlsx/blob/master/examples/example.rb#L355</a></p>\n\n<p>My question is is it possible to assign formulas to columns when the table is filled up?</p>\n"}, {"tags": ["ruby", "class", "setter", "instance-variables"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1497457006, "post_id": 44546784, "comment_id": 76090355, "body": "@DaveNewton that is a confusing statement."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1497458368, "post_id": 44546784, "comment_id": 76091120, "body": "@DaveNewton <i>&quot;it&#39;s not a class method if you&#39;re referencing <code>self</code>&quot;</i> this makes very little sense to me. <code>self</code> can reference a <code>Class</code> just as it can reference an instance of a <code>Class</code> and if we are being technical about this all methods are <code>instance_methods</code> because everything is an instance."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1497485764, "post_id": 44546784, "comment_id": 76103598, "body": "Just out of curiosity: is the error message really that hard to understand? Can you give any hints as to how it could be improved for future readers?"}, {"owner": {"reputation": 233, "user_id": 8149371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cb7da58594625cf366befdba7d29f29?s=128&d=identicon&r=PG&f=1", "display_name": "user2309843", "link": "https://stackoverflow.com/users/8149371/user2309843"}, "edited": false, "score": 0, "creation_date": 1497535236, "post_id": 44546784, "comment_id": 76127694, "body": "I&#39;m really new to Ruby, so I didn&#39;t know what the solution was. In hindsight, the error message made perfect sense."}], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 8149371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cb7da58594625cf366befdba7d29f29?s=128&d=identicon&r=PG&f=1", "display_name": "user2309843", "link": "https://stackoverflow.com/users/8149371/user2309843"}, "edited": false, "score": 1, "creation_date": 1497449473, "post_id": 44546933, "comment_id": 76085030, "body": "I tried the interpolation method and it works with double quotes but not single quotes, do you know why that is?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 233, "user_id": 8149371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cb7da58594625cf366befdba7d29f29?s=128&d=identicon&r=PG&f=1", "display_name": "user2309843", "link": "https://stackoverflow.com/users/8149371/user2309843"}, "edited": false, "score": 1, "creation_date": 1497451088, "post_id": 44546933, "comment_id": 76086262, "body": "@achang27 it&#39;s because, well ... string interpolation works within double quotes but not within single quotes. That&#39;s the way <a href=\"http://ruby-doc.org/core-2.4.1/doc/syntax/literals_rdoc.html#label-Strings\" rel=\"nofollow noreferrer\">string literals</a> work in Ruby."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497451563, "post_id": 44546933, "comment_id": 76086629, "body": "Regarding <code>:</code> \u2013 if you want to pass the instance variable&#39;s name as a symbol (as shown in the <a href=\"http://ruby-doc.org/core-2.4.1/Object.html#method-i-instance_variable_set\" rel=\"nofollow noreferrer\">docs</a>), the <a href=\"http://ruby-doc.org/core-2.4.1/doc/syntax/literals_rdoc.html#label-Symbols\" rel=\"nofollow noreferrer\">syntax</a> is <code>:&quot;@#{key}&quot;</code>. With <code>key = &#39;table&#39;</code>, it returns the symbol <code>:@table</code>"}], "tags": [], "owner": {"reputation": 1543, "user_id": 5801853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1b0fbad41fb9e1ee84161ebff1ddbbc?s=128&d=identicon&r=PG", "display_name": "yzalavin", "link": "https://stackoverflow.com/users/5801853/yzalavin"}, "is_accepted": true, "score": 5, "last_activity_date": 1497448940, "last_edit_date": 1497448940, "creation_date": 1497448668, "answer_id": 44546933, "question_id": 44546784, "link": "https://stackoverflow.com/questions/44546784/ruby-set-instance-variable-inside-class-method-from-string/44546933#44546933", "title": "Ruby - set instance variable inside class method from string", "body": "<p>Remove <code>:</code> from your method.</p>\n\n<p><code>self.instance_variable_set('@' + key, val)</code></p>\n\n<p>Moreover, <code>self</code> can be redundant here. Try <code>instance_variable_set('@' + key, val)</code>.</p>\n\n<p>And prefer to use interpolation over concatenation. <code>instance_variable_set(\"@#{key}\", val)</code></p>\n"}], "owner": {"reputation": 233, "user_id": 8149371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cb7da58594625cf366befdba7d29f29?s=128&d=identicon&r=PG&f=1", "display_name": "user2309843", "link": "https://stackoverflow.com/users/8149371/user2309843"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1659, "favorite_count": 0, "accepted_answer_id": 44546933, "answer_count": 1, "score": 2, "last_activity_date": 1497448940, "creation_date": 1497448322, "question_id": 44546784, "link": "https://stackoverflow.com/questions/44546784/ruby-set-instance-variable-inside-class-method-from-string", "title": "Ruby - set instance variable inside class method from string", "body": "<p>I have a class with a method <code>register(key, val)</code>. I am trying to add <code>key</code> as a instance variable of the class and set it equal to <code>val</code>. Right now I'm trying to use <code>self.instance_variable_set(':@' + key, val)</code> but I'm getting this error:</p>\n\n<pre><code>in `instance_variable_set': `:@table' is not allowed as an instance variable name (NameError)\n</code></pre>\n\n<p>I am calling <code>register('table',  {'key' =&gt; 'value'})</code></p>\n\n<p>Any idea how to do this properly? Thanks!</p>\n"}, {"tags": ["ruby", "multithreading", "net-ssh"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 1848642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29232a884d37a7d4d7ba80451ed860a?s=128&d=identicon&r=PG", "display_name": "user1848642", "link": "https://stackoverflow.com/users/1848642/user1848642"}, "is_accepted": false, "score": 0, "last_activity_date": 1497528052, "creation_date": 1497528052, "answer_id": 44566954, "question_id": 44545647, "link": "https://stackoverflow.com/questions/44545647/threaded-output-not-displayed-when-run-from-command-works-from-irb/44566954#44566954", "title": "Threaded output not displayed when run from command (works from irb)", "body": "<p>I am not sure exactly why but it seems the method call was exiting (not waiting on the threads despite the thread joins) and thus killing the threads.  As such, the Net::SSH module did not have time to get/return data.</p>\n\n<p>I added the following unless statement near the end of the code to force the method to wait for the threads to complete and now output is displayed as desired.  Also reduced the amount of code a bit.</p>\n\n<pre><code>unless @threads.each.map {|t| t.alive?}.none?\n    sleep 1\nend\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 1848642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29232a884d37a7d4d7ba80451ed860a?s=128&d=identicon&r=PG", "display_name": "user1848642", "link": "https://stackoverflow.com/users/1848642/user1848642"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497528052, "creation_date": 1497445438, "question_id": 44545647, "link": "https://stackoverflow.com/questions/44545647/threaded-output-not-displayed-when-run-from-command-works-from-irb", "title": "Threaded output not displayed when run from command (works from irb)", "body": "<p>I decided to rewrite a ruby script I did as a gem/module with an executable component.  The original works fine, but as a gem it is easier to maintain/install with all dependencies.</p>\n\n<p>The command takes an array of hosts and a command, and runs it on the hosts via threads.  The problem I am now having though is that the output of the command is not displayed on the terminal.  Executing the module code from within IRB however produces the output. </p>\n\n<p>The module code is as follows:</p>\n\n<pre><code>require \"rcmd/version\"\nrequire 'net/ssh'\nrequire 'thread'\nmodule Rcmd\n  @queue = Queue.new\n  class &lt;&lt; self\n    attr_accessor :nthreads\n    attr_accessor :user\n    attr_accessor :quiet\n    attr_accessor :command\n    attr_accessor :host_list\n    attr_accessor :threads\n  end\n  # Built in function called by each thread for executing the command on individual hosts\n  def Rcmd.run_command_on_host(conn_options)\n    begin\n      # Create ssh session to host\n      Net::SSH.start(conn_options[:host], conn_options[:user], :password =&gt; conn_options[:passwd]) do |session|\n        # Open channel for input/output control\n        session.open_channel do |channel|\n          channel.on_data do |ch, data|\n            # Print recieved data if quiet is not true\n            puts \"#{conn_options[:host]} :: #{data}\" unless conn_options[:quiet]\n          end\n          channel.on_extended_data do |ch,type,data|\n            # Always print stderr data\n            puts \"#{conn_options[:host]} :: ERROR :: #{data}\"\n          end\n          # Execute command\n          channel.exec @command\n        end\n        # Loop until command completes\n        session.loop\n    end\n    rescue\n      puts \"#{conn_options[:host]} :: CONNECT ERROR :: Unable to connect to host!\\n\"\n    end\n  end\n  # Main method of module for starting the execution of the specified command on provided hosts\n  def Rcmd.run_command()\n    if not @command\n      raise ArgumentError.new(\"No command set for execution\")\n    end\n    if not @host_list.count &gt;= 1\n      raise ArgumentError.new(\"host_list must contain at least one system\")\n    end\n    @host_list.each do |host|\n      @queue &lt;&lt; host\n    end\n    until @queue.empty?\n      # Don't start more threads then hosts.\n      num_threads = @nthreads &lt;= @host_list.count ? @nthreads : @host_list.count\n      # Prepare threads\n      @threads = { }\n      num_threads.times do |i|\n        @threads[i] = Thread.new {\n          conn_options = { :user =&gt; @user, :host =&gt; @queue.pop, :password =&gt; nil, :quiet =&gt; @quiet}\n          unless conn_options[:host].nil?\n            self.run_command_on_host(conn_options)\n          end\n        }\n      end\n      # Execute threads\n      @threads.each(&amp;:join)\n    end\n  end\nend\n</code></pre>\n\n<p>Test snippet:</p>\n\n<pre><code>require 'rcmd'\nRcmd.host_list= [\"localhost\", \"dummy-host\"]\nRcmd.nthreads= 2\nRcmd.user= 'root'\nRcmd.command= \"hostname -f\"\nRcmd.run_command\n</code></pre>\n\n<p>Running the above in IRB produces:</p>\n\n<pre><code>dummy-host :: CONNECT ERROR :: Unable to connect to host!\nlocalhost :: darkstar.lan\n</code></pre>\n\n<p>As expected.  However, Running the same from a script file (the gem command) or in ruby directly results in no output:</p>\n\n<pre><code>ruby-newb@darkstar:~/repos/rcmd$ rcmd -n localhost,dummy-host -c 'hostname -f'\nruby-newb@darkstar:~/repos/rcmd$ \n</code></pre>\n\n<p>Previously I used $stdout.puts and $stderr.puts as well as the constants variants but in desperation moved it to just puts.  I have also tried with print and various other ways to include handing the streams to the threads and printing all output once the thread finished , but to no avail.</p>\n\n<p>After adding tons of 'p' statements through out the code, when running from the command the output stops just before the Net::SSH.start call in the run_command_on_host method.</p>\n\n<p>I have also tried having that entire method within the thread creations but then it failed to execute completely.  Hence having two methods. One for creating the threads, and one used by the threads for executing the ssh session and command.</p>\n\n<p>Failing in both ruby-2.3.3 and ruby-2.0.0-p648 so I think I am just doing something stupid.</p>\n\n<p>If someone could find it in their hearts to tell this Ruby newbie where he has gone wrong it would be very appreciated.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "edited": false, "score": 0, "creation_date": 1497445722, "post_id": 44545632, "comment_id": 76081991, "body": "First off, make sure no other session to DB is open. Then try what @puneet mentioned."}, {"owner": {"reputation": 1440, "user_id": 4282529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/dW8oZ.jpg?s=128&g=1", "display_name": "kdweber89", "link": "https://stackoverflow.com/users/4282529/kdweber89"}, "reply_to_user": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "edited": false, "score": 0, "creation_date": 1497445999, "post_id": 44545632, "comment_id": 76082205, "body": "how do you check to see if there are no other sessions to the DB that are open? Is that done by running <code>ps -aef | grep rails</code> and killing off any xtra pids?"}, {"owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "edited": false, "score": 0, "creation_date": 1497866111, "post_id": 44545632, "comment_id": 76240346, "body": "Manually check all <code>rails c</code>, <code>rails s</code>, command line psql sessions etc and close them. If you still face the issue, checkout <a href=\"https://www.devopsderek.com/blog/2012/11/13/list-and-disconnect-postgresql-db-sessions/\" rel=\"nofollow noreferrer\">devopsderek.com/blog/2012/11/13/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 4, "creation_date": 1497446732, "post_id": 44545711, "comment_id": 76082813, "body": "This will completely wipe the database and start from scratch.  If you are in a development environment with only test data this is fine. but do not do this in a live environment as you will lose all the data."}], "tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": true, "score": 0, "last_activity_date": 1497445587, "creation_date": 1497445587, "answer_id": 44545711, "question_id": 44545632, "link": "https://stackoverflow.com/questions/44545632/pgundefinedtable-error-relation-caves-does-not-exist/44545711#44545711", "title": "PG::UndefinedTable: ERROR: relation &#39;caves&#39; does not exist", "body": "<p>try below steps:</p>\n\n<pre><code>1. rake db:drop\n2. rake db:create\n3. rake db:migrate\n</code></pre>\n"}], "owner": {"reputation": 1440, "user_id": 4282529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/dW8oZ.jpg?s=128&g=1", "display_name": "kdweber89", "link": "https://stackoverflow.com/users/4282529/kdweber89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "accepted_answer_id": 44545711, "answer_count": 1, "score": 1, "last_activity_date": 1497445587, "creation_date": 1497445398, "question_id": 44545632, "link": "https://stackoverflow.com/questions/44545632/pgundefinedtable-error-relation-caves-does-not-exist", "title": "PG::UndefinedTable: ERROR: relation &#39;caves&#39; does not exist", "body": "<p>I've ran into a problem in which I'm not sure how to get out of this. Working on creating a rails view, and after populating my view and editing my controller, i've ran into an error that states <code>PG::UndefinedTable: ERROR: relation 'caves'  does not exist</code></p>\n\n<p>Looking into what I did, I realized that I created my model as <code>cafe</code> but when I populated my schema tables, I accidentally created a table called <code>caves</code> instead of <code>cafes</code>.</p>\n\n<p>Here's what I did to try to resolve this.</p>\n\n<ol>\n<li>I first tried creating a migration to just rename the table from <code>caves</code> to <code>cafes</code> -- still ran into the same error</li>\n<li>I then tried deleting the schema table all together and creating a new one all together called <code>cafe</code> - still ran into the same error</li>\n<li>I then tried dropping my database all together, thinking if I just wiped the whole thing and started over (i just started on this rails project). I ran <code>rake db:reset</code> only to come into a new error telling me <code>ActiveRecord::StatementInvalid: PG::ObjectInUse: ERROR:  database \"cafe_database\" is being accessed by other users</code></li>\n<li>By this point, I tried restarted my postgress and ran <code>sudo service postgresql restart</code>....but my machine doesn't recognize <code>service</code></li>\n</ol>\n\n<p>Does anybody have an idea what I can do to figure this problem out? I'm running out of ideas. </p>\n"}, {"tags": ["python", "ruby", "node.js"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497479408, "post_id": 44545631, "comment_id": 76101884, "body": "Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;. It&#39;s off-topic to ask us to recommend code or libraries."}], "answers": [{"tags": [], "owner": {"reputation": 1212, "user_id": 3732793, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/uobgC.jpg?s=128&g=1", "display_name": "user3732793", "link": "https://stackoverflow.com/users/3732793/user3732793"}, "is_accepted": false, "score": 0, "last_activity_date": 1497448050, "creation_date": 1497448050, "answer_id": 44546670, "question_id": 44545631, "link": "https://stackoverflow.com/questions/44545631/python-or-js-equivalent-of-rubys-servicemanager/44546670#44546670", "title": "python or js equivalent of ruby&#39;s ServiceManager", "body": "<p>not sure for which environment you are searching...</p>\n\n<p>when it's about node.js you should look at pm2</p>\n"}, {"comments": [{"owner": {"reputation": 2268, "user_id": 5203563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/41147e6bce5c1d9c053e05f8ab87207c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex028502", "link": "https://stackoverflow.com/users/5203563/alex028502"}, "edited": false, "score": 0, "creation_date": 1497461321, "post_id": 44546753, "comment_id": 76092779, "body": "have you used it?  I am having trouble making sense of the documentation."}, {"owner": {"reputation": 4151, "user_id": 2018369, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/wgGbD.png?s=128&g=1", "display_name": "running.t", "link": "https://stackoverflow.com/users/2018369/running-t"}, "reply_to_user": {"reputation": 2268, "user_id": 5203563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/41147e6bce5c1d9c053e05f8ab87207c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex028502", "link": "https://stackoverflow.com/users/5203563/alex028502"}, "edited": false, "score": 0, "creation_date": 1497567181, "post_id": 44546753, "comment_id": 76145221, "body": "No I did not, but I noticed that this project has wiki with <a href=\"https://github.com/hmrc/service-manager/wiki/Real-World-Usage\" rel=\"nofollow noreferrer\">Real Word Usage examples</a>. I hope it will help."}], "tags": [], "owner": {"reputation": 4151, "user_id": 2018369, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/wgGbD.png?s=128&g=1", "display_name": "running.t", "link": "https://stackoverflow.com/users/2018369/running-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1497448219, "creation_date": 1497448219, "answer_id": 44546753, "question_id": 44545631, "link": "https://stackoverflow.com/questions/44545631/python-or-js-equivalent-of-rubys-servicemanager/44546753#44546753", "title": "python or js equivalent of ruby&#39;s ServiceManager", "body": "<p>I think for python you can find... well... <a href=\"https://github.com/hmrc/service-manager\" rel=\"nofollow noreferrer\">ServiceManager</a></p>\n"}], "owner": {"reputation": 2268, "user_id": 5203563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/41147e6bce5c1d9c053e05f8ab87207c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex028502", "link": "https://stackoverflow.com/users/5203563/alex028502"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1497500874, "creation_date": 1497445394, "last_edit_date": 1497500874, "question_id": 44545631, "link": "https://stackoverflow.com/questions/44545631/python-or-js-equivalent-of-rubys-servicemanager", "title": "python or js equivalent of ruby&#39;s ServiceManager", "body": "<p>Does anybody know if there is any equivalent of <a href=\"https://github.com/leadtune/service_manager\" rel=\"nofollow noreferrer\">https://github.com/leadtune/service_manager</a> for python or node?</p>\n\n<p>i need to start executables in the background when i start my tests and the automatically quit them all when the tests end.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 3, "creation_date": 1497443961, "post_id": 44544575, "comment_id": 76080596, "body": "It is advised to use <code>.dup</code> instead of <code>.clone</code>, for simple usage like this. There difference between them is very subtle (<code>.clone</code> copies the singleton methods and maintains the <code>frozen?</code> status of the object) -- but for 99% of usages, like this, the methods are equivalent, but <code>.dup</code> is slightly faster."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497445733, "post_id": 44544575, "comment_id": 76082002, "body": "<i>&quot;b references to a&quot;</i> \u2013 nitpicking, but that sounds like chained variables: <code>b \u2192 a \u2192 obj</code>. It&#39;s actually more like <code>a \u2192 obj \u2190 b</code>, i.e. both reference the same object, not each other."}, {"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1497446418, "post_id": 44544575, "comment_id": 76082563, "body": "@TomLord and Stefan: Your are right. I updated my answer. Thx"}], "tags": [], "owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "is_accepted": false, "score": 7, "last_activity_date": 1497446320, "last_edit_date": 1497446320, "creation_date": 1497442606, "answer_id": 44544575, "question_id": 44544506, "link": "https://stackoverflow.com/questions/44544506/ruby-shift-how-to-shift-an-array-without-shifting-an-array-that-it-was-assigne/44544575#44544575", "title": "ruby shift - how to shift an array without shifting an array that it was assigned to", "body": "<p>That's because <code>b</code> and <code>a</code> references to the same object in the memory:</p>\n\n<pre><code>a = ['who','let','the','dogs','out']\nb = a\na.object_id == b.object_id\n# =&gt; true\n</code></pre>\n\n<p><code>b</code> needs to be another array object, so I would create a clone of <code>a</code>:</p>\n\n<pre><code>a = ['who','let','the','dogs','out']\nb = a.dup\na.object_id == b.object_id\n# =&gt; false\n\nb.shift\n# =&gt; \"who\"\nb\n# =&gt; [\"let\", \"the\", \"dogs\", \"out\"]\na\n# =&gt; [\"who\", \"let\", \"the\", \"dogs\", \"out\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "is_accepted": false, "score": 1, "last_activity_date": 1497457411, "last_edit_date": 1497457411, "creation_date": 1497443239, "answer_id": 44544805, "question_id": 44544506, "link": "https://stackoverflow.com/questions/44544506/ruby-shift-how-to-shift-an-array-without-shifting-an-array-that-it-was-assigne/44544805#44544805", "title": "ruby shift - how to shift an array without shifting an array that it was assigned to", "body": "<p>When you say:</p>\n\n<pre><code>b = a\n</code></pre>\n\n<p>You are saying let <code>b</code> point to the same object as <code>a</code>. You are not saying copy the contents of <code>a</code> into <code>b</code>. For that you would need to use the method <code>clone</code>.\nIn addition to guitarman's answer, there is an array method that will return the rest of the array after shifting without changing the original array. This only works if you don't care what you are shifting/dropping off the array and are only concerned about the remaining items.</p>\n\n<pre><code>1 &gt; a = ['who','let','the','dogs','out']\n =&gt; [\"who\", \"let\", \"the\", \"dogs\", \"out\"] \n2 &gt; b = a.drop(1)\n =&gt; [\"let\", \"the\", \"dogs\", \"out\"] \n3 &gt; a\n =&gt; [\"who\", \"let\", \"the\", \"dogs\", \"out\"] \n4 &gt; b\n =&gt; [\"let\", \"the\", \"dogs\", \"out\"] \n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7684580, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/af396dea390d97c6e4857c1482e29e63?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Holly", "link": "https://stackoverflow.com/users/7684580/daniel-holly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1497457411, "creation_date": 1497442435, "question_id": 44544506, "link": "https://stackoverflow.com/questions/44544506/ruby-shift-how-to-shift-an-array-without-shifting-an-array-that-it-was-assigne", "title": "ruby shift - how to shift an array without shifting an array that it was assigned to", "body": "<p>I assign one array to another:</p>\n\n<pre><code>a = ['who','let','the','dogs','out']\nb = a\nb.shift\n</code></pre>\n\n<p>b and a now both are </p>\n\n<pre><code>[\"let\", \"the\", \"dogs\", \"out\"].\n</code></pre>\n\n<p>I would like for a to still be</p>\n\n<pre><code>[\"who\",\"let\", \"the\", \"dogs\", \"out\"]\n</code></pre>\n\n<p>How can you mutate b without mutating a?</p>\n\n<p>Also, why does this happen?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "stripe-payments"], "comments": [{"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1497442522, "post_id": 44544496, "comment_id": 76079546, "body": "What does your heroku log say about the error?"}, {"owner": {"reputation": 75, "user_id": 7294640, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a391de80da94a6f8d4f5552d271d5084?s=128&d=identicon&r=PG&f=1", "display_name": "Ryu Nishida", "link": "https://stackoverflow.com/users/7294640/ryu-nishida"}, "reply_to_user": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1497443713, "post_id": 44544496, "comment_id": 76080405, "body": "there is nothing error in my heroku log."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1497443808, "post_id": 44544496, "comment_id": 76080484, "body": "The first thing to do when you see <b>any</b> error like this is to <b>look at the log</b>. Perhaps <code>Stripe::Event.retrieve(...)</code> failed? Perhaps <code>event.data.object</code> failed? Perhaps <code>User.find_by(..)</code> returned <code>nil</code>? There <i>will</i> be an error in the log; you must be looking in the wrong place."}, {"owner": {"reputation": 75, "user_id": 7294640, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a391de80da94a6f8d4f5552d271d5084?s=128&d=identicon&r=PG&f=1", "display_name": "Ryu Nishida", "link": "https://stackoverflow.com/users/7294640/ryu-nishida"}, "edited": false, "score": 0, "creation_date": 1497444373, "post_id": 44544496, "comment_id": 76080921, "body": "Anyway ,I know if there was nothing code,i could send test webhock to app ,and could  get some  responses from app through my experiment."}, {"owner": {"reputation": 75, "user_id": 7294640, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a391de80da94a6f8d4f5552d271d5084?s=128&d=identicon&r=PG&f=1", "display_name": "Ryu Nishida", "link": "https://stackoverflow.com/users/7294640/ryu-nishida"}, "edited": false, "score": 0, "creation_date": 1497444395, "post_id": 44544496, "comment_id": 76080936, "body": "so i think heroku is wrong or rails&#39;s protect_from_forgery is wrong."}, {"owner": {"reputation": 75, "user_id": 7294640, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a391de80da94a6f8d4f5552d271d5084?s=128&d=identicon&r=PG&f=1", "display_name": "Ryu Nishida", "link": "https://stackoverflow.com/users/7294640/ryu-nishida"}, "edited": false, "score": 0, "creation_date": 1497444415, "post_id": 44544496, "comment_id": 76080960, "body": "Off course, i checked my heroku log."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1497444486, "post_id": 44544496, "comment_id": 76081002, "body": "Are you telling me that <b>nothing</b> is being logged <b>anywhere</b>, when the rails app responds with a 500 error? I find that very hard to believe."}, {"owner": {"reputation": 75, "user_id": 7294640, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a391de80da94a6f8d4f5552d271d5084?s=128&d=identicon&r=PG&f=1", "display_name": "Ryu Nishida", "link": "https://stackoverflow.com/users/7294640/ryu-nishida"}, "edited": false, "score": 0, "creation_date": 1497444695, "post_id": 44544496, "comment_id": 76081181, "body": "Sorry I mistook,I believed that activity is log."}], "owner": {"reputation": 75, "user_id": 7294640, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a391de80da94a6f8d4f5552d271d5084?s=128&d=identicon&r=PG&f=1", "display_name": "Ryu Nishida", "link": "https://stackoverflow.com/users/7294640/ryu-nishida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497446496, "creation_date": 1497442410, "last_edit_date": 1497445142, "question_id": 44544496, "link": "https://stackoverflow.com/questions/44544496/an-error-appeared-when-i-send-test-webhock-to-myapp-on-stripe", "title": "An error appeared when I send test webhock to myapp on Stripe", "body": "<h1>An error appeared when I send test webhock to <a href=\"https://xxxxx.herokuapp.com/webhock\" rel=\"nofollow noreferrer\">https://xxxxx.herokuapp.com/webhock</a> on Stripe.</h1>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;hash&gt;\n  &lt;status&gt;500&lt;/status&gt;\n  &lt;error&gt;Internal Server Error&lt;/error&gt;\n&lt;/hash&gt;\n</code></pre>\n\n<h2>Code</h2>\n\n<pre><code>class WebhockController&lt; ApplicationController\n  protect_from_forgery except: :create\n\n def create\n   event = Stripe::Event.retrieve(params[:id])\n\n   case event.type\n   when 'customer.subscription.updated'\n       subscription = event.data.object\n        user = User.find_by(stripe_subscription_id: subscription.id)\n        user.update_subscription(subscription)\n   end\n    head :ok\n end\nend\n</code></pre>\n\n<p>// routes.rb</p>\n\n<pre><code>post \"webhock\"=&gt;\"webhock#create\"\n</code></pre>\n\n<h2>Environment</h2>\n\n<ul>\n<li>ruby 2.4</li>\n<li>Ruby on Rails4</li>\n<li>Heroku\n\n<h2>log</h2></li>\n</ul>\n\n<p>2017-06-14T12:56:32.470036+00:00 app[web.1]: Completed 500 Internal Server Error in 696ms (ActiveRecord: 0.0ms)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75, "user_id": 4637619, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dffcc7898473ccda57837eac2146260f?s=128&d=identicon&r=PG&f=1", "display_name": "ccca", "link": "https://stackoverflow.com/users/4637619/ccca"}, "edited": false, "score": 0, "creation_date": 1497446813, "post_id": 44544269, "comment_id": 76082882, "body": "I solved it by reinstalling Ruby and Rails again"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 4637619, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dffcc7898473ccda57837eac2146260f?s=128&d=identicon&r=PG&f=1", "display_name": "ccca", "link": "https://stackoverflow.com/users/4637619/ccca"}, "edited": false, "score": 0, "creation_date": 1497442586, "post_id": 44544514, "comment_id": 76079604, "body": "Thank you. However, the error is not about the parameter but the command itself, even if I use without the parameter &quot;rails g scaffold product name price:decimal&quot; , does not work as well."}], "tags": [], "owner": {"reputation": 376, "user_id": 5471935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4905041241f7b4a300d37b7afd45119b?s=128&d=identicon&r=PG", "display_name": "Thadeu Esteves Jr.", "link": "https://stackoverflow.com/users/5471935/thadeu-esteves-jr"}, "is_accepted": false, "score": 0, "last_activity_date": 1497442452, "creation_date": 1497442452, "answer_id": 44544514, "question_id": 44544269, "link": "https://stackoverflow.com/questions/44544269/ruby-on-rails-error-using-rails-methods/44544514#44544514", "title": "Ruby on Rails Error Using Rails Methods", "body": "<p>Use </p>\n\n<pre><code>rails g scaffold product name price:decimal --no-stylesheets\n</code></pre>\n\n<p>instead --skip</p>\n\n<p>You can do also in config/application.rb something like this.</p>\n\n<pre><code>config.generators do |g|\n  g.stylesheets false\nend\n</code></pre>\n\n<p>You can see more details here <a href=\"http://guides.rubyonrails.org/configuring.html#configuring-generators\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/configuring.html#configuring-generators</a></p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 4637619, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dffcc7898473ccda57837eac2146260f?s=128&d=identicon&r=PG&f=1", "display_name": "ccca", "link": "https://stackoverflow.com/users/4637619/ccca"}, "edited": false, "score": 0, "creation_date": 1497444314, "post_id": 44544539, "comment_id": 76080872, "body": "I added it, and installed the gem as well, however still the same result"}], "tags": [], "owner": {"reputation": 1, "user_id": 8160358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84e1a09a3197dc5ee837b6f08e8c99b8?s=128&d=identicon&r=PG&f=1", "display_name": "webdevneil", "link": "https://stackoverflow.com/users/8160358/webdevneil"}, "is_accepted": false, "score": -1, "last_activity_date": 1497448420, "last_edit_date": 1497448420, "creation_date": 1497442508, "answer_id": 44544539, "question_id": 44544269, "link": "https://stackoverflow.com/questions/44544269/ruby-on-rails-error-using-rails-methods/44544539#44544539", "title": "Ruby on Rails Error Using Rails Methods", "body": "<p>Add this line to <code>config/application.rb</code>:</p>\n\n<pre><code>require 'neo4j/railtie'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": false, "score": 0, "last_activity_date": 1497444961, "creation_date": 1497444961, "answer_id": 44545450, "question_id": 44544269, "link": "https://stackoverflow.com/questions/44544269/ruby-on-rails-error-using-rails-methods/44545450#44545450", "title": "Ruby on Rails Error Using Rails Methods", "body": "<p>Try following steps:</p>\n\n<pre><code>1. rails new demo\n\n2. cd demo\n\n3. rake db:create\n\n4. rails g scaffold product name:string price:float\n\n5. rake db:migrate\n\n6. rails server\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 4637619, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dffcc7898473ccda57837eac2146260f?s=128&d=identicon&r=PG&f=1", "display_name": "ccca", "link": "https://stackoverflow.com/users/4637619/ccca"}, "is_accepted": true, "score": 0, "last_activity_date": 1497446887, "creation_date": 1497446887, "answer_id": 44546223, "question_id": 44544269, "link": "https://stackoverflow.com/questions/44544269/ruby-on-rails-error-using-rails-methods/44546223#44546223", "title": "Ruby on Rails Error Using Rails Methods", "body": "<p>I solved it by reinstalling Ruby and Rails again </p>\n"}], "owner": {"reputation": 75, "user_id": 4637619, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dffcc7898473ccda57837eac2146260f?s=128&d=identicon&r=PG&f=1", "display_name": "ccca", "link": "https://stackoverflow.com/users/4637619/ccca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 44546223, "answer_count": 4, "score": 0, "last_activity_date": 1497448420, "creation_date": 1497441805, "question_id": 44544269, "link": "https://stackoverflow.com/questions/44544269/ruby-on-rails-error-using-rails-methods", "title": "Ruby on Rails Error Using Rails Methods", "body": "<p>I currently have started learning Ruby On Rails. I have Ruby 2.3.1 and Rails 5.1.1 on my Debian Linux. I was following the instructions here : <a href=\"http://railscasts.com/episodes/417-foundation?view=asciicast\" rel=\"nofollow noreferrer\">http://railscasts.com/episodes/417-foundation?view=asciicast</a>\nHowever, when I try to use the method <code>rails g scaffold product name price:decimal --skip-stylesheets</code>. I get this error; </p>\n\n<pre><code>\"/usr/lib/ruby/vendor_ruby/rails/railtie/configuration.rb:95:in `method_missing': undefined method `load_defaults' for #&lt;Rails::Application::Configuration:0x000000016b9058&gt; (NoMethodError)\nfrom /root/Desktop/RubyOnRails/store/config/application.rb:12:in `&lt;class:Application&gt;'\nfrom /root/Desktop/RubyOnRails/store/config/application.rb:10:in `&lt;module:Store&gt;'\nfrom /root/Desktop/RubyOnRails/store/config/application.rb:9:in `&lt;top (required)&gt;'\nfrom /usr/lib/ruby/vendor_ruby/spring/application.rb:82:in `require'\nfrom /usr/lib/ruby/vendor_ruby/spring/application.rb:82:in `preload'\nfrom /usr/lib/ruby/vendor_ruby/spring/application.rb:143:in `serve'\nfrom /usr/lib/ruby/vendor_ruby/spring/application.rb:131:in `block in run'\nfrom /usr/lib/ruby/vendor_ruby/spring/application.rb:125:in `loop'\nfrom /usr/lib/ruby/vendor_ruby/spring/application.rb:125:in `run'\nfrom /usr/lib/ruby/vendor_ruby/spring/application/boot.rb:18:in `&lt;top (required)&gt;'\nfrom /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\nfrom /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\"\n</code></pre>\n\n<p>I get the error, also when I try to generate a controller or model. Because of this error, I can not follow any tutorial. I have tried to reinstall Rails but did not work.How can I solve this? Thank you in advanced.</p>\n"}, {"tags": ["json", "ruby", "parsing", "decimal", "point"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1497441177, "post_id": 44543946, "comment_id": 76078483, "body": "According to the JSON specification, <code>56.</code> is an invalid number: a <code>.</code> must be followed by a digit."}, {"owner": {"reputation": 23, "user_id": 720745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8366fdef7e6c1fde4a13a8050e0a3b7c?s=128&d=identicon&r=PG", "display_name": "muwlgr", "link": "https://stackoverflow.com/users/720745/muwlgr"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497441585, "post_id": 44543946, "comment_id": 76078821, "body": "56. is supported at least by C and Fortran. So it is not surprising that NodeJS(v8) supports it as well. In Ruby this is problematic as there could be a method call after the point, like 56.abs. But what JSON.parse expects as its input, is JSON, not Ruby code"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497441944, "post_id": 44543946, "comment_id": 76079126, "body": "<i>&quot;what JSON.parse expects as its input, is JSON&quot;</i> \u2013 yes, exactly. It expects JSON, not C or Fortran or JavaScript. And <code>56.</code> is not valid in JSON, whether or not it may be valid syntax in other languages."}], "owner": {"reputation": 23, "user_id": 720745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8366fdef7e6c1fde4a13a8050e0a3b7c?s=128&d=identicon&r=PG", "display_name": "muwlgr", "link": "https://stackoverflow.com/users/720745/muwlgr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497441353, "creation_date": 1497440916, "last_edit_date": 1497441353, "question_id": 44543946, "link": "https://stackoverflow.com/questions/44543946/ruby-json-parse-fails-on-decimal-numbers-with-point-but-without-fractions", "title": "ruby JSON.parse fails on decimal numbers with point but without fractions", "body": "<p>I have a json string like this :</p>\n\n<pre><code>{\"weight\": 56.}\n</code></pre>\n\n<p>I can enter this string into NodeJS interpreter and get a parsed hash as a result:</p>\n\n<pre><code>$ js\n&gt; {\"Weight\":56.}\n{ Weight: 56 }\n&gt; {\"Weight\":56}\n{ Weight: 56 }\n</code></pre>\n\n<p>as you see, NodeJS accepts both inputs with identical result</p>\n\n<p>But in Ruby, for the same string I get </p>\n\n<blockquote>\n  <p>JSON::ParserError: ... unexpected token</p>\n</blockquote>\n\n<p>until I remove '.' after the number</p>\n\n<p>sample session :</p>\n\n<pre><code>irb...&gt; s='{\"Weight\":56.}'\n=&gt; \"{\\\"Weight\\\":56.}\"\nirb...&gt; JSON.parse(s)\nJSON::ParserError: 784: unexpected token at '{\"Weight\":56.}'\n</code></pre>\n\n<p>...</p>\n\n<pre><code>irb...&gt; s='{\"Weight\":56}'\n=&gt; \"{\\\"Weight\\\":56}\"\nirb...&gt; JSON.parse(s)\n=&gt; {\"Weight\"=&gt;56}\n</code></pre>\n\n<p>Can anything be done to Ruby JSON library to improve its conformance to JS ?</p>\n\n<p>Now I have to filter these stray dec.points by regular expressions before parsing them as JSON</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8154446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37404804e841ebeabdb4936908e6d4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Frederick Nielsen", "link": "https://stackoverflow.com/users/8154446/frederick-nielsen"}, "edited": false, "score": 0, "creation_date": 1497456338, "post_id": 44548900, "comment_id": 76089996, "body": "I have one morer problem now. I don&#39;t remember my password. I don&#39;t even remember setting one. Can you help me out?"}, {"owner": {"reputation": 505, "user_id": 63516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0885ba9442ca4515dd4b235319278b8b?s=128&d=identicon&r=PG", "display_name": "tmarkiewicz", "link": "https://stackoverflow.com/users/63516/tmarkiewicz"}, "reply_to_user": {"reputation": 13, "user_id": 8154446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37404804e841ebeabdb4936908e6d4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Frederick Nielsen", "link": "https://stackoverflow.com/users/8154446/frederick-nielsen"}, "edited": false, "score": 0, "creation_date": 1497456603, "post_id": 44548900, "comment_id": 76090154, "body": "You&#39;ll need to reset the root password on MySQL: <a href=\"https://www.howtoforge.com/setting-changing-resetting-mysql-root-passwords\" rel=\"nofollow noreferrer\">howtoforge.com/setting-changing-resetting-mysql-root-passwor&zwnj;&#8203;ds</a>"}], "tags": [], "owner": {"reputation": 505, "user_id": 63516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0885ba9442ca4515dd4b235319278b8b?s=128&d=identicon&r=PG", "display_name": "tmarkiewicz", "link": "https://stackoverflow.com/users/63516/tmarkiewicz"}, "is_accepted": false, "score": 0, "last_activity_date": 1497454056, "creation_date": 1497454056, "answer_id": 44548900, "question_id": 44543902, "link": "https://stackoverflow.com/questions/44543902/bin-rake-dbcreate-error-on-macos-sierra/44548900#44548900", "title": "bin/rake db:create error on MacOS Sierra", "body": "<p>You need to provide the root password for your MySQL installation, not the password for the database you're creating.</p>\n\n<p>When you installed MySQL on your local machine, you created a password for the root user for the entire install. This is the password it's asking for as Rails is trying to create the new database for you.</p>\n\n<p>The credentials you provide in the database.yml are for the new database you're creating for the sugar install only.</p>\n"}], "owner": {"reputation": 13, "user_id": 8154446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37404804e841ebeabdb4936908e6d4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Frederick Nielsen", "link": "https://stackoverflow.com/users/8154446/frederick-nielsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497454806, "creation_date": 1497440800, "last_edit_date": 1497450032, "question_id": 44543902, "link": "https://stackoverflow.com/questions/44543902/bin-rake-dbcreate-error-on-macos-sierra", "title": "bin/rake db:create error on MacOS Sierra", "body": "<p>Currently working on installing the sugar forum in ruby on rails, and running it on localhost:3000. I'm having trouble on running the db:create command without getting errors ran the following command:</p>\n\n<pre><code>bin/rake db:create\n</code></pre>\n\n<p>I provided my password and got this error:</p>\n\n<pre><code>Access denied for user 'rails'@'localhost' (using password: YES)Please provide the root password for your MySQL installation\n</code></pre>\n\n<p>I provided the password that I have in my database.yml file under the 'mysql' section. My file looks like this:</p>\n\n<pre><code>mysql: &amp;mysql\n  adapter: mysql2\n  encoding: utf8mb4\n  collation: utf8mb4_unicode_ci\n  username: &lt;%= ENV['SUGAR_DB_USERNAME'] || \"rails\" %&gt;\n  password: &lt;%= ENV['SUGAR_DB_PASSWORD'] || \"rails\" %&gt;\n  database: &lt;%= ENV['SUGAR_DB_DATABASE'] || \"sugar_#{Rails.env}\" %&gt;\n</code></pre>\n\n<p>All I did was just follow the installation guide in the git repo of 'sugar'.</p>\n\n<p>Repo URL:</p>\n\n<ul>\n<li><a href=\"https://github.com/elektronaut/sugar\" rel=\"nofollow noreferrer\">https://github.com/elektronaut/sugar</a></li>\n</ul>\n\n<p>I hope somebody can help me with this since it's so frustrating and wasting my time.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "interface"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1497439503, "post_id": 44542549, "comment_id": 76077261, "body": "Your question seems similar to this one: <a href=\"https://stackoverflow.com/a/41618988/2483313\">stackoverflow.com/a/41618988/2483313</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "is_accepted": false, "score": 1, "last_activity_date": 1497438969, "creation_date": 1497438969, "answer_id": 44543215, "question_id": 44542549, "link": "https://stackoverflow.com/questions/44542549/ensuring-interface-compliance-in-ruby/44543215#44543215", "title": "Ensuring interface compliance in Ruby?", "body": "<p>I think what you are looking at is a Dependency injection, instead of hard coding <code>SomeClass.new.get_data</code> in your method <code>foo</code></p>\n\n<p><strong>It's a level of trust that class A has</strong>, <em>that an object initializing A should pass an argument</em>, which is an object of SomeClass like this. </p>\n\n<p>object_a = A.new(SomeClass.new). </p>\n\n<p>So if you want to check explicitly if @obj can can respond to the message <code>get_data</code> you can use ruby's <code>respond_to?(:method_name)</code></p>\n\n<p>So your code becomes this</p>\n\n<pre><code>   def foo\n     # Do something with @obj\n     if @obj.respond_to?(:get_data)\n       var = @obj.get_data\n     end\n     ...\n   end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1497444069, "post_id": 44543285, "comment_id": 76080691, "body": "There is no pre-defined constant <code>NoSuchMethodError</code> in Ruby. Do you mean <code>NoMethodError</code>?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1497444194, "post_id": 44543285, "comment_id": 76080785, "body": "<code>method_defined?</code> checks whether a method is defined in a <code>Module</code>. Presumably, <code>obj</code> is not a <code>Module</code>, so <code>obj.method_defined?</code> will simply <code>raise</code> a <code>NoMethodError</code>. And even if <code>obj</code> <i>were</i> a <code>Module</code>, then the fact that the method is defined in that module, does not mean that it can be called on <code>obj</code>, it only means that it can be called on <i>instances</i> of <code>obj</code>. Presumably, you want <code>obj.method(:get_data).nil?</code> or something like that. But even that will fail, because it is perfectly possible for an object to respond to a message without having a corresponding method."}, {"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1497452864, "post_id": 44543285, "comment_id": 76087540, "body": "@J&#246;rgWMittag fixed, thanks , what do you mean by &quot;it is perfectly possible for an object to respond to a message without having a corresponding method&quot; ? are you talking about the case where <code>get_data</code> is defined on <code>obj</code> but not on <code>obj</code>&#39;s class ?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1497482440, "post_id": 44543285, "comment_id": 76102795, "body": "<code>class Foo; def method_missing(meth, *args) puts &quot;Echoing #{meth} with (#{args.join(&#39; &#39;)})&quot; end; def respond_to_missing?(*) true end end; foo = Foo.new; foo.hello(42); foo.method(:hello).nil? == true; foo.respond_to?(:hello) == true</code>."}], "tags": [], "owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "is_accepted": false, "score": -1, "last_activity_date": 1497452774, "last_edit_date": 1497452774, "creation_date": 1497439142, "answer_id": 44543285, "question_id": 44542549, "link": "https://stackoverflow.com/questions/44542549/ensuring-interface-compliance-in-ruby/44543285#44543285", "title": "Ensuring interface compliance in Ruby?", "body": "<p>Ruby is a dynamically typed language and it's also duck-typed, when you decide to use duck-typing features you should probably just mention it in documentation and call it, if it's not there it will crash, think about it carefully, pretend you could check that <code>get_data</code> exists(and you could as we shall see later), what do you want to do ?   </p>\n\n<p>Do you want to return <code>nil</code> ? if <code>foo</code> should return a value you could return <code>nil</code> but you'll risk your users a <code>NoSuchMethodError for nil:NilClass</code>, if <code>foo</code> is meant to return nothing(semantically void) then <code>nil</code> is no option to you, do you want to <code>raise</code> an Error ? well probably the very reason you want to check that <code>get_data</code> exists is to protect against type errors but now you raise another error, maybe you want to raise a specific error but honestly <code>NoSuchMethodError : method get_data missing in someObject:SomeClass</code> is specific enough in my opinion.  </p>\n\n<p>With that in my mind I'm going to show you how to check for it anyway, there are many ways, a very simple way :  </p>\n\n<pre><code>def foo\n   begin\n      var = @obj.get_data\n   rescue NoMethodError\n      // handle the case where get_data does not exist\n   end\nend\n</code></pre>\n\n<p>A probably better way is to check that <code>obj</code> has <code>get_data</code> in <code>initialize</code> using the above way or this :  </p>\n\n<pre><code>def initialize(obj)\n    if(!obj.respond_to? :get_data)\n       //handle the case where get_data is not defined\n    end\nend\n</code></pre>\n\n<p>The problem with the last code is that all you check is <code>obj</code> having <code>get_data</code>, you don't check whether it has proper signature, if you want to check that you can :  </p>\n\n<pre><code>def initialize(obj)\n  unless(!obj.respond_to? :get_data) \n     params = obj.method(:get_data).parameters\n     //if get_data for example takes x,y then params will be `[[:req,:x],[:req,:y]]`         \n  end\nend\n</code></pre>\n\n<p>Of course you can't check that get_data accepts specific types because ruby is dynamically typed.   </p>\n\n<p>If you also want to check the method's return type after you check for its existence and parameters you can call it because it's safe and check the return type like this :  </p>\n\n<pre><code>a=obj.get_data\nif(a.is_a? SomeClass)\n   //good\nend\n</code></pre>\n\n<p>If you want to check that get_data returns nothing(semantically void method), well in ruby returning <code>nil</code> is analogous to void but so is the failure to return a value so you can't check for that.</p>\n"}], "owner": {"reputation": 883, "user_id": 2119522, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/pxIsJ.jpg?s=128&g=1", "display_name": "Boon", "link": "https://stackoverflow.com/users/2119522/boon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1497452774, "creation_date": 1497437124, "last_edit_date": 1497437573, "question_id": 44542549, "link": "https://stackoverflow.com/questions/44542549/ensuring-interface-compliance-in-ruby", "title": "Ensuring interface compliance in Ruby?", "body": "<p>I really like Ruby but I'm confused over how exactly I should implement an interface. In the example shown below, a class A calls a method <code>get_data</code> on an object that is passed in as a constructor argument. What is the best practice for ensuring that <code>obj</code> is of the correct type and implements the method <code>get_data</code>? I have seen code that simply \"specifies the required interface\" in the RDoc for the class's <code>initialize</code> method: \"Argument must include module Bar\", \"Argument must be of type Blah\" or \"Argument must have the method 'get_data'\". Is there a better <em>programmatic</em> way of doing this?</p>\n\n<pre><code>class A\n\n   def initialize(obj)\n     @obj = obj\n   end\n\n   def foo\n     # Do something with @obj\n     var = @obj.get_data\n     ...\n   end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "cookies"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497436721, "post_id": 44542215, "comment_id": 76075129, "body": "You can provide a secure value via <code>cookies.encrypted[:valid_until] = ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 861, "user_id": 7805374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pjsTe.jpg?s=128&g=1", "display_name": "l.varga", "link": "https://stackoverflow.com/users/7805374/l-varga"}, "is_accepted": false, "score": 0, "last_activity_date": 1497440998, "creation_date": 1497440998, "answer_id": 44543968, "question_id": 44542215, "link": "https://stackoverflow.com/questions/44542215/can-you-tamper-with-the-cookie-expiration-date-of-a-signed-cookie-in-rails/44543968#44543968", "title": "Can you tamper with the cookie expiration date of a signed cookie in Rails?", "body": "<p>Yes, it is possible to only tamper with a cookie's expiration date for an encrypted/signed cookie, unless you provide additional security.</p>\n\n<p>Seeing how the value is encrypted anyway, you could always add additional information to the cookie value - eg. the expiration date (and store the entire value in an array form, with element index 0 being the value and element index 1 being the cookie expiration date, for instance, or use some query within that string and split the string to get the value). Then, in your controller, parse the cookie value into an array and check the value of expiration date (eg if it should've already expired, in that case raise an error) and set the cookie's expiration date back to the correct, non-tampered value for the client. That way, every time you require a value of that cookie, you can always check whether the cookie should still even be present or whether the expiration date had been tampered with. </p>\n\n<p>I should think you needn't do this often and the application of it is for a quite specific controller method. It's a hackish way, sure, but it's the only way to be really sure both the cookie value and the cookie expiration date hadn't been tampered with.</p>\n"}, {"comments": [{"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1536739319, "post_id": 51389124, "comment_id": 91528322, "body": "This does not answer the question, the question is about already set cookies. The method you are explaining is for new cookies only in rails code."}], "tags": [], "owner": {"reputation": 1, "user_id": 10095612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LuEDV.jpg?s=128&g=1", "display_name": "Madrid", "link": "https://stackoverflow.com/users/10095612/madrid"}, "is_accepted": false, "score": -1, "last_activity_date": 1531912233, "last_edit_date": 1531912233, "creation_date": 1531856721, "answer_id": 51389124, "question_id": 44542215, "link": "https://stackoverflow.com/questions/44542215/can-you-tamper-with-the-cookie-expiration-date-of-a-signed-cookie-in-rails/51389124#51389124", "title": "Can you tamper with the cookie expiration date of a signed cookie in Rails?", "body": "<p>yes, you surely can.</p>\n\n<p>cookies.signed[:ssid] = { value: '', expires: Time.now + <strong><em>30.minutes</em></strong> } OR\ncookies.signed[:ssid] = { value: '', expires: Time.now + <strong><em>60.years</em></strong> }</p>\n\n<p>Here value can be a string or an array.\nWith this you can set the cookie expiry as far in the future you want.</p>\n"}], "owner": {"reputation": 1394, "user_id": 4214184, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b4c95b51ca86c3a27f1a6515b11557e?s=128&d=identicon&r=PG", "display_name": "anemaria20", "link": "https://stackoverflow.com/users/4214184/anemaria20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1531912233, "creation_date": 1497436331, "question_id": 44542215, "link": "https://stackoverflow.com/questions/44542215/can-you-tamper-with-the-cookie-expiration-date-of-a-signed-cookie-in-rails", "title": "Can you tamper with the cookie expiration date of a signed cookie in Rails?", "body": "<p>As far as I'm aware, once a cookie is sent as a response (and the cookie includes an expiration date), the expiration date is not sent back with the request, just the cookie content.</p>\n\n<p>Thus, even if a cookie is signed in Rails, is it possible to just tamper with its expiration date and set it way far in the future than it actually is?</p>\n"}, {"tags": ["ruby", "selenium", "inheritance"], "comments": [{"owner": {"reputation": 5041, "user_id": 7305183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109a1b8acbf5d01c41e8e725b08411ba?s=128&d=identicon&r=PG&f=1", "display_name": "Murthi", "link": "https://stackoverflow.com/users/7305183/murthi"}, "edited": false, "score": 0, "creation_date": 1497436396, "post_id": 44542173, "comment_id": 76074898, "body": "you have to import the file/class using require statement"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1497437106, "post_id": 44542173, "comment_id": 76075449, "body": "Please inline the relevant code and error in the question and remove the image. This makes sure that all the necessary context for future readers will be here, even if the link stops working. Also makes it easier to copy-paste."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1497449558, "post_id": 44542173, "comment_id": 76085084, "body": "You have to require <code>launch.rb</code> in <code>compare.rb</code>. Still, please take a look at the <a href=\"https://stackoverflow.com/tour\">tour</a> and <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> pages."}, {"owner": {"reputation": 11, "user_id": 8058441, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gkhxDtZTY4A/AAAAAAAAAAI/AAAAAAAAAeU/7zDIUa1x1N4/photo.jpg?sz=128", "display_name": "Preeti Kumari", "link": "https://stackoverflow.com/users/8058441/preeti-kumari"}, "edited": false, "score": 0, "creation_date": 1497502555, "post_id": 44542173, "comment_id": 76107297, "body": "I have tried this using require as well. But using that method mention in compare class is not executing only launch class is executed."}], "owner": {"reputation": 11, "user_id": 8058441, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gkhxDtZTY4A/AAAAAAAAAAI/AAAAAAAAAeU/7zDIUa1x1N4/photo.jpg?sz=128", "display_name": "Preeti Kumari", "link": "https://stackoverflow.com/users/8058441/preeti-kumari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497439211, "creation_date": 1497436218, "last_edit_date": 1497439211, "question_id": 44542173, "link": "https://stackoverflow.com/questions/44542173/unable-to-inherit-class-from-one-to-other-testcase-file-in-selenium-ruby", "title": "Unable to inherit class from one to other testcase file in selenium - ruby", "body": "<p>I'm not able to inherit class from one to another testcase file in selenium - ruby environment .</p>\n\n<p>Please check below attached image</p>\n\n<p><a href=\"https://i.stack.imgur.com/7EJv4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7EJv4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here I have inherit <code>launch.rb</code> in <code>compare.rb</code>. But its not working.</p>\n"}, {"tags": ["ruby", "macos", "sass", "openssl", "homebrew"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1497433765, "post_id": 44541180, "comment_id": 76073016, "body": "Also see <a href=\"http://stackoverflow.com/q/38670295\">Homebrew refusing to link OpenSSL</a>, <a href=\"http://stackoverflow.com/q/15185661\">Update OpenSSL on OS X with Homebrew</a>, <a href=\"http://stackoverflow.com/q/35129977\">How to install latest version of openssl Mac OS X El Capitan</a>, <a href=\"http://apple.stackexchange.com/q/126830\">How to upgrade OpenSSL in OS X?</a>, <a href=\"http://superuser.com/q/486389\">Openssl installation using HomeBrew fails</a>, etc."}, {"owner": {"reputation": 649, "user_id": 6061997, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-pOcjvpF8WY4/AAAAAAAAAAI/AAAAAAAAAjU/6j75Mz9XBPo/photo.jpg?sz=128", "display_name": "astropringles", "link": "https://stackoverflow.com/users/6061997/astropringles"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1497433953, "post_id": 44541180, "comment_id": 76073156, "body": "@jww I already tried all of these links. But the main problem was installing Homebrew.."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1497434165, "post_id": 44541180, "comment_id": 76073306, "body": "You could try an updated <code>cacert.pem</code>. See cURL&#39;s <a href=\"https://curl.haxx.se/docs/caextract.html\" rel=\"nofollow noreferrer\">CA certificates extracted from Mozilla</a>. You could also try one of the <a href=\"https://github.com/Homebrew/brew/blob/master/docs/Installation.md#installation\" rel=\"nofollow noreferrer\">Alternative Installs</a> for it. <code>mkdir homebrew &amp;&amp; curl -L https:&#47;&#47;github.com&#47;Homebrew&#47;brew&#47;tarball&#47;master | tar xz --strip 1 -C homebrew</code> looks like a good alternative. You can also tell <code>curl</code> to ignore certificate errors due to an old <code>cacerts.pem</code>."}, {"owner": {"reputation": 649, "user_id": 6061997, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-pOcjvpF8WY4/AAAAAAAAAAI/AAAAAAAAAjU/6j75Mz9XBPo/photo.jpg?sz=128", "display_name": "astropringles", "link": "https://stackoverflow.com/users/6061997/astropringles"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1497435063, "post_id": 44541180, "comment_id": 76073986, "body": "@jww I tried the alternative install mkdir... and it said &#39;mkdir:homebrew: FIle exists&#39; but when I try to brew install... it did a command not found"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1497435792, "post_id": 44541180, "comment_id": 76074484, "body": "You should probably move this question to a site like <a href=\"http://apple.stackexchange.com/\">Apple Stack Exchange</a> or <a href=\"http://unix.stackexchange.com/\">Unix &amp; Linux Stack Exchange</a>. You seem to be having trouble with basic commands, like <code>mkdir</code> and <code>rm</code>; and how to use <code>curl</code>. There&#39;s nothing related to programming or development here."}, {"owner": {"reputation": 649, "user_id": 6061997, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-pOcjvpF8WY4/AAAAAAAAAAI/AAAAAAAAAjU/6j75Mz9XBPo/photo.jpg?sz=128", "display_name": "astropringles", "link": "https://stackoverflow.com/users/6061997/astropringles"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1497497329, "post_id": 44541180, "comment_id": 76105980, "body": "@jww all of the links you gave me were from this site. :/"}], "answers": [{"tags": [], "owner": {"reputation": 649, "user_id": 6061997, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-pOcjvpF8WY4/AAAAAAAAAAI/AAAAAAAAAjU/6j75Mz9XBPo/photo.jpg?sz=128", "display_name": "astropringles", "link": "https://stackoverflow.com/users/6061997/astropringles"}, "is_accepted": false, "score": 0, "last_activity_date": 1497496907, "creation_date": 1497496907, "answer_id": 44557969, "question_id": 44541180, "link": "https://stackoverflow.com/questions/44541180/unable-to-install-homebrew-on-mac/44557969#44557969", "title": "Unable to install HomeBrew on Mac", "body": "<p>Just in case someone had this problem.. It's due to proxy. Just use http. Thanks. </p>\n"}], "owner": {"reputation": 649, "user_id": 6061997, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-pOcjvpF8WY4/AAAAAAAAAAI/AAAAAAAAAjU/6j75Mz9XBPo/photo.jpg?sz=128", "display_name": "astropringles", "link": "https://stackoverflow.com/users/6061997/astropringles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497496907, "creation_date": 1497433670, "last_edit_date": 1497433807, "question_id": 44541180, "link": "https://stackoverflow.com/questions/44541180/unable-to-install-homebrew-on-mac", "title": "Unable to install HomeBrew on Mac", "body": "<p>I just really need to install Sass. But then it led to this error:</p>\n\n<pre><code>ERROR:  Could not find a valid gem 'sass' (&gt;= 0), here is why:\n      Unable to download data from https://rubygems.org/ - SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (https://rubygems.org/latest_specs.4.8.gz)\n</code></pre>\n\n<p>my ruby version is :</p>\n\n<pre><code>ruby 2.0.0p648 (2015-12-16 revision 53162) [universal.x86_64-darwin16]\n</code></pre>\n\n<p>my rubygem version is: </p>\n\n<pre><code>2.0.14.1\n</code></pre>\n\n<p>while my openssl version is:</p>\n\n<pre><code>OpenSSL 0.9.8zh 14 Jan 2016\n</code></pre>\n\n<p>so I tried researching about the error, and then it led me to this  <a href=\"http://railsapps.github.io/openssl-certificate-verify-failed.html\" rel=\"nofollow noreferrer\">link</a>, there was a lot about installing RVM but I couldn't due to curl(60) error - so I checked another probable cause which described a diagnosis that I should upgrade my openssl. So... </p>\n\n<ol>\n<li><p>I tried to install homebrew so that it would let me update openssl, created a .bash_profile with this <code>PATH=\"/usr/local/bin:$PATH\"</code></p></li>\n<li><p>executed this to terminal <code>/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"</code></p></li>\n</ol>\n\n<p>and then another error occured:</p>\n\n<pre><code>curl: (60) SSL certificate problem: Invalid certificate chain\nMore details here: https://curl.haxx.se/docs/sslcerts.html\n\ncurl performs SSL certificate verification by default, using a \"bundle\"\n of Certificate Authority (CA) public keys (CA certs). If the default\n bundle file isn't adequate, you can specify an alternate file\n using the --cacert option.\nIf this HTTPS server uses a certificate signed by a CA represented in\n the bundle, the certificate verification probably failed due to a\n problem with the certificate (it might be expired, or the name might\n not match the domain name in the URL).\nIf you'd like to turn off curl's verification of the certificate, use\n the -k (or --insecure) option.\n</code></pre>\n\n<p>I already checked my certificates and there are no expired ones.</p>\n\n<p>If there are still any other details you need to know to help me please let me know. I'm really desperate already... I just want to move on and learn SASS. T_T</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 1223, "user_id": 3012473, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/gSYLc.png?s=128&g=1", "display_name": "buncis", "link": "https://stackoverflow.com/users/3012473/buncis"}, "edited": false, "score": 0, "creation_date": 1497433503, "post_id": 44540895, "comment_id": 76072792, "body": "is there any code that validates the country presence? <code>validates :country, presence: true</code> or <code>validates :country_id, presence: true</code> if yes then you need to make a instance of country model and assign in to the model that need country"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1497434249, "post_id": 44540895, "comment_id": 76073373, "body": "1) &quot;Countries&quot; can&#39;t be blank? or &quot;Country can&#39;t be blank?&quot; 2) You said that when you run the test, you get that validation error message? Then most likely the error stemmed out from a factory creation, probably <code>FactoryGirl.create(:projects_user)</code>. 3) Show the stack trace of the error, and show the corresponding code that invoked the error. This would help us inspect the problem."}, {"owner": {"reputation": 1, "user_id": 7778905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137c4a5aa05370703348a826bc11677d?s=128&d=identicon&r=PG&f=1", "display_name": "siks6666", "link": "https://stackoverflow.com/users/7778905/siks6666"}, "edited": false, "score": 0, "creation_date": 1497435421, "post_id": 44540895, "comment_id": 76074233, "body": "icemelt there is validates :countries presnece: true in project.rb model"}], "answers": [{"tags": [], "owner": {"reputation": 19325, "user_id": 67505, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/094c0ec476b95ed7619d6a4cb918da78?s=128&d=identicon&r=PG", "display_name": "Chen Kinnrot", "link": "https://stackoverflow.com/users/67505/chen-kinnrot"}, "is_accepted": false, "score": 0, "last_activity_date": 1497442140, "creation_date": 1497442140, "answer_id": 44544384, "question_id": 44540895, "link": "https://stackoverflow.com/questions/44540895/ruby-on-rails-validation-failed-countries-cant-be-blank/44544384#44544384", "title": "Ruby on rails, Validation failed: Countries can&#39;t be blank", "body": "<p>The problem is within the </p>\n\n<pre><code>  projects_user = FactoryGirl.create(:projects_user)\n</code></pre>\n\n<p>the creation code (where you defined this factory) does not set a country and this is why you get an error.</p>\n"}], "owner": {"reputation": 1, "user_id": 7778905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137c4a5aa05370703348a826bc11677d?s=128&d=identicon&r=PG&f=1", "display_name": "siks6666", "link": "https://stackoverflow.com/users/7778905/siks6666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 694, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497452571, "creation_date": 1497432968, "last_edit_date": 1497452571, "question_id": 44540895, "link": "https://stackoverflow.com/questions/44540895/ruby-on-rails-validation-failed-countries-cant-be-blank", "title": "Ruby on rails, Validation failed: Countries can&#39;t be blank", "body": "<pre><code>it \"renders index page\" do\n  projects_user = FactoryGirl.create(:projects_user)\n  get :index, id: projects_user.id\n  expect(response).to render_template :index\nend\n</code></pre>\n\n<p>this is my controller test, when i run it it says:        Validation failed: Countries can't be blank</p>\n\n<p>I am new to stackoverflow and ruby soo any help i get is great</p>\n\n<p>FilesController:</p>\n\n<pre><code>class FilesController &lt; ApplicationController\n  before_filter :authenticate_user!\n\n  def index\n    @pu = ProjectsUser.find(params[:id])\n    debugger\n    @files = UserFile.includes(:user).where(project_id: @pu.id)\n  end\n\n  def new\n    @file = UserFile.new\n  end\n\n  def create\n    @file = UserFile.new(file_params)\n    if @file.save\n      flash[:success] = \"File successfully uploaded!\"\n      redirect_to files_path\n    else\n      @files = UserFile.includes(:user).where(user_id: current_user.id)\n      render :index\n    end\n  end\n\n  def destroy\n    @file = UserFile.find(params[:file_id])\n    if @file.destroy\n      flash[:success] = \"File successfully deleted!\"\n      redirect_to files_path\n    else\n      flash[:error] = \"File could not be deleted.\"\n      redirect_to files_path\n    end\n  end\n\n  protected\n\n  def file_params\n    params.require(:user_file).permit(:file, :user_id, :created_at, :updated_at, :project_id)\n  end\nend\n</code></pre>\n\n<p>Country controller:</p>\n\n<pre><code>class CountriesController &lt; ApplicationController\n  def states\n    @states = State.where(country_id: params[:id]).all\n    return render :json =&gt; {success: true, status: 200, data: @states}\n  end\nend\n</code></pre>\n\n<p>Country model: </p>\n\n<pre><code>class Country &lt; ActiveRecord::Base\n  validates :name, presence: true\n  has_many :states\n  has_many :users\n  has_and_belongs_to_many :projects\n\n  validates :name, presence: true\nend\n</code></pre>\n\n<p>Factory for country:</p>\n\n<pre><code>require 'ffaker'\n\nFactoryGirl.define do \n  factory :country do\n    name {FFaker::AddressUS.country}\n  end\nend\n</code></pre>\n\n<p>output of error: </p>\n\n<pre><code>           ActiveRecord::RecordInvalid:\n   Validation failed: Countries can't be blank\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib       /factory_girl/configuration.rb:18:in `block in initialize'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/evaluation.rb:15:in `[]'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/evaluation.rb:15:in `create'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/strategy/create.rb:12:in `block in result'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/strategy/create.rb:9:in `tap'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/strategy/create.rb:9:in `result'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/factory.rb:42:in `run'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/factory_runner.rb:29:in `block in run'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/factory_runner.rb:28:in `run'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/strategy/create.rb:5:in `association'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/evaluator.rb:33:in `association'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/attribute/association.rb:19:in `block in to_proc'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/evaluator.rb:77:in `instance_exec'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/evaluator.rb:77:in `block in define_attribute'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/attribute_assigner.rb:56:in `get'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/attribute_assigner.rb:16:in `block (2 levels) in object'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/attribute_assigner.rb:15:in `each'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/attribute_assigner.rb:15:in `block in object'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/attribute_assigner.rb:14:in `tap'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/attribute_assigner.rb:14:in `object'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/evaluation.rb:12:in `object'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/strategy/create.rb:9:in `result'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/factory.rb:42:in `run'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/factory_runner.rb:29:in `block in run'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/factory_runner.rb:28:in `run'\n # /home/nemanja/.rvm/gems/ruby-2.1.2/gems/factory_girl-4.8.0/lib/factory_girl/strategy_syntax_method_registrar.rb:20:in `block in define_singular_strategy_method'\n # ./spec/controllers/files_controllers_spec.rb:31:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>Factory for project, project has_and_belongs_to_many countries</p>\n\n<pre><code>    require 'ffaker'\n\nFactoryGirl.define do\n  factory :project do\n    sponsor_name \"John Pare\"\n    title \"Anea\"\n    start_date Date.new(2016, 5, 7)\n    end_date Date.new(2017, 3, 6)\n    description {FFaker::Lorem.paragraph}\n    number_of_sites_planned \"5\"\n    estimated_enrollment \"24\"\n    feasibility_questionnaire File.open(\"#{Rails.root}/spec/internal_spec_files/app.pdf\")\n    association :disease_type\n    association :disease_condition\n    association :user\n    association :project_category\n    association :project_subcategory\n    after(:create) do |m|\n       m.countries &lt;&lt; build(:country)\n    end\n end\n</code></pre>\n\n<p>end</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497432231, "post_id": 44540410, "comment_id": 76071887, "body": "<i>&quot;is it nicer to define a Proc (or similar), and pass that into the block?&quot;</i> \u2013 You don&#39;t have to call the proc within the block manually, you can pass it <i>instead</i> of a block, e.g. <code>filter = -&gt; (p) { p[:age] &gt; 11 }</code> and invoke it via <code>my_array.select(&amp;filter)</code>"}, {"owner": {"reputation": 166, "user_id": 3177310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0e457fb3ebf0ea43ed2bb443fc28b2?s=128&d=identicon&r=PG&f=1", "display_name": "Poilon", "link": "https://stackoverflow.com/users/3177310/poilon"}, "edited": false, "score": 0, "creation_date": 1497432744, "post_id": 44540410, "comment_id": 76072231, "body": "I find your first code chaining one-line blocks with braces perfect"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 166, "user_id": 3177310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0e457fb3ebf0ea43ed2bb443fc28b2?s=128&d=identicon&r=PG&f=1", "display_name": "Poilon", "link": "https://stackoverflow.com/users/3177310/poilon"}, "edited": false, "score": 1, "creation_date": 1497432959, "post_id": 44540410, "comment_id": 76072389, "body": "@Poilon but that only works for one-liners. The question is how to deal with more complex logic, i.e. one that doesn&#39;t fit into a single line."}, {"owner": {"reputation": 976, "user_id": 4003671, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BHAz6.jpg?s=128&g=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/4003671/alec"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497433332, "post_id": 44540410, "comment_id": 76072657, "body": "@Stefan yes sorry I phrased that badly - your example is what I meant. Is that a preferred pattern? It obviously makes the stream cleaner, but moves all of the logic away from the action (but I don&#39;t think that&#39;s the worst thing in the world)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1497465332, "post_id": 44540410, "comment_id": 76095029, "body": "Interesting question, nicely stated."}], "answers": [{"comments": [{"owner": {"reputation": 976, "user_id": 4003671, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BHAz6.jpg?s=128&g=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/4003671/alec"}, "edited": false, "score": 1, "creation_date": 1497433702, "post_id": 44541163, "comment_id": 76072955, "body": "Yes, certainly an option, although as a rule I try to avoid mutating objects if it can be avoided (although obviously this will depend on the exact implementation details, and so forth)."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 976, "user_id": 4003671, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BHAz6.jpg?s=128&g=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/4003671/alec"}, "edited": false, "score": 0, "creation_date": 1497433784, "post_id": 44541163, "comment_id": 76073030, "body": "@Alec <code>new_array = my_array.dup</code> creates a copy beforehand."}, {"owner": {"reputation": 976, "user_id": 4003671, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BHAz6.jpg?s=128&g=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/4003671/alec"}, "edited": false, "score": 0, "creation_date": 1497433851, "post_id": 44541163, "comment_id": 76073082, "body": "Aha yes missed that."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 976, "user_id": 4003671, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BHAz6.jpg?s=128&g=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/4003671/alec"}, "edited": false, "score": 0, "creation_date": 1497433944, "post_id": 44541163, "comment_id": 76073151, "body": "@Alec you could also replace that with <code>new_array = my_array.select { ... }</code>, but I wanted to keep the blocks as similar as possible."}, {"owner": {"reputation": 976, "user_id": 4003671, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BHAz6.jpg?s=128&g=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/4003671/alec"}, "edited": false, "score": 0, "creation_date": 1497434011, "post_id": 44541163, "comment_id": 76073205, "body": "Yeah, I think a real-world solution would probably look like you suggest in your comment."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 976, "user_id": 4003671, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BHAz6.jpg?s=128&g=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/4003671/alec"}, "edited": false, "score": 0, "creation_date": 1497434128, "post_id": 44541163, "comment_id": 76073285, "body": "@Alec depends on your programming style I guess. I&#39;d prefer modular code that I can easily reorder and / or comment in and out ;-)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1497465824, "post_id": 44541163, "comment_id": 76095285, "body": "How would you compare that with: 1) <code>arr = my_array.select do |person|; # Do something complex; end</code> then <code>arr == arr.map do |person|..</code>? Alternatively, <code>arr = m1(my_array); arr = m2(arr), ...</code> or <code>m3(m2(m1(my_array)))</code>, recognizing that in the last case you can still test <code>m1</code>, <code>m2</code> and <code>m3</code> separately."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 4, "last_activity_date": 1497433811, "last_edit_date": 1497433811, "creation_date": 1497433635, "answer_id": 44541163, "question_id": 44540410, "link": "https://stackoverflow.com/questions/44540410/whats-the-cleanest-way-of-chaining-stream-functions-in-ruby/44541163#44541163", "title": "What&#39;s the cleanest way of chaining stream functions in Ruby?", "body": "<p>You could create a copy and use destructive methods instead:</p>\n\n<pre><code>new_array = my_array.dup\n\nnew_array.select! do |person|\n  # Do something complex\nend\n\nnew_array.map! do |person|\n  # More complex stuff\nend\n\nnew_array.sort_by! do |person|\n  # Yet more complex stuff\nend\n</code></pre>\n"}], "owner": {"reputation": 976, "user_id": 4003671, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BHAz6.jpg?s=128&g=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/4003671/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 44541163, "answer_count": 1, "score": 4, "last_activity_date": 1497433811, "creation_date": 1497431590, "question_id": 44540410, "link": "https://stackoverflow.com/questions/44540410/whats-the-cleanest-way-of-chaining-stream-functions-in-ruby", "title": "What&#39;s the cleanest way of chaining stream functions in Ruby?", "body": "<p>Let's say I have an array of stuff that I want to perform all sorts of wacky operations on. For example:</p>\n\n<pre><code>my_array = [\n  { name: 'Lyra', age: 12 },\n  { name: 'Harry', age: 11 },\n  { name: 'Kestrel', age: 13},\n]\n</code></pre>\n\n<p>I want to filter out anyone under the age of 12, change all names to symbols, and then sort them by age (say).</p>\n\n<p>This can be achieved with:</p>\n\n<pre><code>new_array = my_array.\n  select { |person| person[:age] &gt; 11 }.\n  map { |person| person.merge(name: person[:name].to_sym) }.\n  sort_by { |person| person[:age] }\n</code></pre>\n\n<p>So that's all dandy. But what if I have arbitrarily complex logic I need to do my selecting/mapping/sorting/etc.?</p>\n\n<p>Standard practice says that multi-line blocks with braces are to be avoided (and some linters even outright forbid it). Yet, the alternative is to start chaining <code>do..end</code> blocks, which looks even ickier:</p>\n\n<pre><code>new_array = my_array.\n  select do |person|\n    # Do something complex\n  end.\n  map do |person|\n    # More complex stuff\n  end.\n  sort_by do |person|\n    # Yet more complex stuff\n  end\n</code></pre>\n\n<p>Does the Ruby community have any advice on best practice for chaining this sort of thing? For example, is it nicer to define a <code>Proc</code> (or similar), and pass that into the block?</p>\n"}, {"tags": ["ruby", "ui-automation", "calabash-android"], "comments": [{"owner": {"reputation": 1150, "user_id": 1312415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4cccdbada1d0879e21b5f8f0f58b8bb6?s=128&d=identicon&r=PG", "display_name": "Mani", "link": "https://stackoverflow.com/users/1312415/mani"}, "edited": false, "score": 0, "creation_date": 1497779659, "post_id": 44540116, "comment_id": 76213901, "body": "are you able access adb on command line ?"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 6469070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51845aba0f5025a06e58bc330e09bcd9?s=128&d=identicon&r=PG&f=1", "display_name": "grinpic", "link": "https://stackoverflow.com/users/6469070/grinpic"}, "is_accepted": false, "score": 0, "last_activity_date": 1498198389, "creation_date": 1498198389, "answer_id": 44714260, "question_id": 44540116, "link": "https://stackoverflow.com/questions/44540116/how-to-execute-adb-shell-command-in-ruby/44714260#44714260", "title": "how to execute adb shell command in ruby?", "body": "<p>You can try use command system()\nexample:\n<code>irb</code></p>\n\n<p><code>2.3.1 :001 &gt; system(\"adb devices\")</code></p>\n\n<p>print:\n<code>List of devices attached</code></p>\n"}], "owner": {"reputation": 411, "user_id": 4252313, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/567208cb2687d981c3b35447f45f08b4?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/4252313/zzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498198389, "creation_date": 1497430768, "question_id": 44540116, "link": "https://stackoverflow.com/questions/44540116/how-to-execute-adb-shell-command-in-ruby", "title": "how to execute adb shell command in ruby?", "body": "<p>I am trying to execute calabash-android test, in which i have one scenario that uses adb shell..and hence i have created method for the same in ruby as follows:</p>\n\n<pre><code>def mock_barcode_scan(barcode = '676767')\n    adb \"shell am broadcast -a com.zz.zz.MockBarcodeReadEvent -e BARCODE #{barcode}\"\n  end\n</code></pre>\n\n<p>now when i try to access this method, NO action is performed .. and scenario fails for this step ... note: i am using windows 7 and executing this test using git bash..</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mechanize"], "answers": [{"comments": [{"owner": {"reputation": 1977, "user_id": 6727030, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f95eb6d3502a06352809f5f843815b44?s=128&d=identicon&r=PG&f=1", "display_name": "PrepareFor", "link": "https://stackoverflow.com/users/6727030/preparefor"}, "edited": false, "score": 0, "creation_date": 1497436042, "post_id": 44541800, "comment_id": 76074654, "body": "Oh!! Thanks a lot! It works! :) is there any docs about that rule?"}, {"owner": {"reputation": 580, "user_id": 6497747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-7m1lKtA-hXA/AAAAAAAAAAI/AAAAAAAAAGo/WHmHUYtYtIw/photo.jpg?sz=128", "display_name": "Mohamed Rafiq P", "link": "https://stackoverflow.com/users/6497747/mohamed-rafiq-p"}, "reply_to_user": {"reputation": 1977, "user_id": 6727030, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f95eb6d3502a06352809f5f843815b44?s=128&d=identicon&r=PG&f=1", "display_name": "PrepareFor", "link": "https://stackoverflow.com/users/6727030/preparefor"}, "edited": false, "score": 0, "creation_date": 1497439024, "post_id": 44541800, "comment_id": 76076891, "body": "@Dongkun Lee  Refer this docs. I think this will help you <a href=\"http://www.rubydoc.info/gems/mechanize/Mechanize\" rel=\"nofollow noreferrer\">rubydoc.info/gems/mechanize/Mechanize</a>"}, {"owner": {"reputation": 1977, "user_id": 6727030, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f95eb6d3502a06352809f5f843815b44?s=128&d=identicon&r=PG&f=1", "display_name": "PrepareFor", "link": "https://stackoverflow.com/users/6727030/preparefor"}, "edited": false, "score": 0, "creation_date": 1497445131, "post_id": 44541800, "comment_id": 76081511, "body": "Despite of your helpful comments, I think it&#39;s not working. login form of the site above, it&#39;s ridiculous. submit code like this   &lt;span class=&quot;mm&quot;&gt;&lt;a href=&quot;javascript:login.loginCheck()&quot;&gt;&lt;img src=&quot;../images/n_btn_login.png&quot; alt=&quot;\ub85c\uadf8\uc778\ubc84\ud2bc&quot;&gt;&lt;/a&gt;&lt;/span&gt;   that korean means  &quot;login button&quot; i heard mechanize is impossible to input value by js function is there any other way to auto login"}, {"owner": {"reputation": 580, "user_id": 6497747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-7m1lKtA-hXA/AAAAAAAAAAI/AAAAAAAAAGo/WHmHUYtYtIw/photo.jpg?sz=128", "display_name": "Mohamed Rafiq P", "link": "https://stackoverflow.com/users/6497747/mohamed-rafiq-p"}, "reply_to_user": {"reputation": 1977, "user_id": 6727030, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f95eb6d3502a06352809f5f843815b44?s=128&d=identicon&r=PG&f=1", "display_name": "PrepareFor", "link": "https://stackoverflow.com/users/6727030/preparefor"}, "edited": false, "score": 0, "creation_date": 1497446721, "post_id": 44541800, "comment_id": 76082798, "body": "you can&#39;t, mechanize doesn&#39;t run javascript. use selenium or phantom"}, {"owner": {"reputation": 580, "user_id": 6497747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-7m1lKtA-hXA/AAAAAAAAAAI/AAAAAAAAAGo/WHmHUYtYtIw/photo.jpg?sz=128", "display_name": "Mohamed Rafiq P", "link": "https://stackoverflow.com/users/6497747/mohamed-rafiq-p"}, "reply_to_user": {"reputation": 1977, "user_id": 6727030, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f95eb6d3502a06352809f5f843815b44?s=128&d=identicon&r=PG&f=1", "display_name": "PrepareFor", "link": "https://stackoverflow.com/users/6727030/preparefor"}, "edited": false, "score": 0, "creation_date": 1497447642, "post_id": 44541800, "comment_id": 76083571, "body": "I think this will help you. <a href=\"https://gist.github.com/huangzhichong/3284966\" rel=\"nofollow noreferrer\">gist.github.com/huangzhichong/3284966</a>"}], "tags": [], "owner": {"reputation": 580, "user_id": 6497747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-7m1lKtA-hXA/AAAAAAAAAAI/AAAAAAAAAGo/WHmHUYtYtIw/photo.jpg?sz=128", "display_name": "Mohamed Rafiq P", "link": "https://stackoverflow.com/users/6497747/mohamed-rafiq-p"}, "is_accepted": true, "score": 3, "last_activity_date": 1497435215, "creation_date": 1497435215, "answer_id": 44541800, "question_id": 44539840, "link": "https://stackoverflow.com/questions/44539840/ruby-mechanize-cannot-find-any-content-from-the-site-what-i-want-to-check/44541800#44541800", "title": "Ruby : Mechanize cannot find any content from the site what i want to check", "body": "<p>That page has two <code>iframes</code> so you need to click the iframe first, then only you can find the elements.</p>\n\n<pre><code>require 'rubygems'\nrequire 'mechanize'\n\na = Mechanize.new\npage = a.get('http://lms.kyonggi.ac.kr/')\np = page.frames[1].click\nputs p.search(\"div\")\n</code></pre>\n"}], "owner": {"reputation": 1977, "user_id": 6727030, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f95eb6d3502a06352809f5f843815b44?s=128&d=identicon&r=PG&f=1", "display_name": "PrepareFor", "link": "https://stackoverflow.com/users/6727030/preparefor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 44541800, "answer_count": 1, "score": 0, "last_activity_date": 1497442723, "creation_date": 1497430037, "last_edit_date": 1497442723, "question_id": 44539840, "link": "https://stackoverflow.com/questions/44539840/ruby-mechanize-cannot-find-any-content-from-the-site-what-i-want-to-check", "title": "Ruby : Mechanize cannot find any content from the site what i want to check", "body": "<p>i want use auto login for specific web site</p>\n\n<p>so i decided to use \"Mechanize\"</p>\n\n<p>In example, like google.com, It works!</p>\n\n<pre><code>require 'rubygems'\nrequire 'mechanize'\n\na = Mechanize.new { |agent|\n    agent.user_agent_alias =\"Windows Chrome\"\n}\n\npage = a.get('http://www.google.com/')\n\nputs page.search(\"div\")\n</code></pre>\n\n<p>but when set url to <a href=\"http://lms.kyonggi.ac.kr/\" rel=\"nofollow noreferrer\">http://lms.kyonggi.ac.kr/</a></p>\n\n<p>I cannot find any content</p>\n\n<p>I tried several functions like </p>\n\n<ul>\n<li><code>page.links</code></li>\n<li><code>page.search(:id=&gt;\"wrap_login\")</code></li>\n<li><code>page.search(\".loginfrom\")</code>....</li>\n</ul>\n\n<p>But I cannot catch any content in this site</p>\n\n<p>How can I get login contents from the site <a href=\"http://lms.kyonggi.ac.kr/\" rel=\"nofollow noreferrer\">http://lms.kyonggi.ac.kr/</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cassandra", "cql"], "answers": [{"comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1497444617, "post_id": 44541286, "comment_id": 76081101, "body": "You can accept your own answer to close the question."}], "tags": [], "owner": {"reputation": 63, "user_id": 7655595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-13AeiKgpaUM/AAAAAAAAAAI/AAAAAAAAK_E/0HeH7qWUogc/photo.jpg?sz=128", "display_name": "Saksham Bassi", "link": "https://stackoverflow.com/users/7655595/saksham-bassi"}, "is_accepted": true, "score": 1, "last_activity_date": 1497433929, "creation_date": 1497433929, "answer_id": 44541286, "question_id": 44539007, "link": "https://stackoverflow.com/questions/44539007/cequel-invalidschemamigration/44541286#44541286", "title": "Cequel:: InvalidSchemaMigration", "body": "<p>I solved with <code>rake cequel:reset</code> which drops keyspace if exists, then create and migrate. Hence, shape log table was configured.</p>\n"}, {"tags": [], "owner": {"reputation": 328, "user_id": 7062272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMrN7.jpg?s=128&g=1", "display_name": "somenickname", "link": "https://stackoverflow.com/users/7062272/somenickname"}, "is_accepted": false, "score": 0, "last_activity_date": 1524351285, "creation_date": 1524351285, "answer_id": 49960890, "question_id": 44539007, "link": "https://stackoverflow.com/questions/44539007/cequel-invalidschemamigration/49960890#49960890", "title": "Cequel:: InvalidSchemaMigration", "body": "<p>Be careful doing this. Check if you are connecting to the desired keyspace.</p>\n\n<p>Since apparently there already exists such keyspace, you can run <code>rake cequel:keyspace:create</code>, which will fail because the keyspace already exists, and see what keyspace you are connecting to from the error message.</p>\n"}], "owner": {"reputation": 63, "user_id": 7655595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-13AeiKgpaUM/AAAAAAAAAAI/AAAAAAAAK_E/0HeH7qWUogc/photo.jpg?sz=128", "display_name": "Saksham Bassi", "link": "https://stackoverflow.com/users/7655595/saksham-bassi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 44541286, "answer_count": 2, "score": 0, "last_activity_date": 1524351285, "creation_date": 1497427613, "question_id": 44539007, "link": "https://stackoverflow.com/questions/44539007/cequel-invalidschemamigration", "title": "Cequel:: InvalidSchemaMigration", "body": "<p>I am new to Cequel and got this error <code>Cequel::InvalidSchemaMigration: Type changes are not allowed</code> on <code>rake cequel:migrate</code> for configuring Shape Log table. </p>\n\n<p>My shape_log.rb file is: </p>\n\n<pre><code>class ShapeLog\n   include Cequel::Record\n   key :shape_id, :bigint\n   key :id, :uuid, auto: true\n   column :controller, :text\n   column :action, :text\n   map :change_set, :text, :text\n   map :object, :text,:text\n   column :remark, :text\n   column :updated_by, :text\n   timestamps\n end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "gemfile"], "answers": [{"comments": [{"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1497433253, "post_id": 44539400, "comment_id": 76072607, "body": "The warning doesn&#39;t know about the <code>bundle-only</code> gem which is used to install only gems listed under a given namespace."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1497433629, "post_id": 44539400, "comment_id": 76072893, "body": "That&#39;s besides the point. There is still no need for you to list the gems more than once. Doing so goes against bundler&#39;s guidelines (hence the warning above), and nor is it recommended in <a href=\"https://github.com/MOZGIII/bundle-only\" rel=\"nofollow noreferrer\">the <code>bundle-only</code> README</a>. By listing the <code>slack-notifier</code> gem twice, you are creating an unnecessary risk of future version conflicts - e.g. when running a standard <code>bundle install</code> command."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1497433695, "post_id": 44539400, "comment_id": 76072948, "body": "If you would like more specific advice on how to structure your whole <code>Gemfile</code>, you could include it in your post - and I will take a look."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1497428837, "creation_date": 1497428837, "answer_id": 44539400, "question_id": 44538961, "link": "https://stackoverflow.com/questions/44538961/bundler-and-bundler-only-suppress-duplicate-gem-warning/44539400#44539400", "title": "Bundler and bundler-only - suppress duplicate gem warning", "body": "<p>Don't list gems more than once. That warning is there for good reason.</p>\n\n<p>You can group gems under multiple namespaces at once within a <code>Gemfile</code>, like so:</p>\n\n<pre><code>group :deploy, :somethingelse do\n  gem 'slack-notifier'\nend\n\ngroup :deploy do\n  # Deploy-ONLY gems\nend\n\ngroup :somethingelse\n  # Somethingelse-ONLY gems\nend\n</code></pre>\n\n<p>Or if you prefer, you can do this grouping inline:</p>\n\n<pre><code>gem 'slack-notifier', group: [:deploy, :somethingelse]\n</code></pre>\n\n<p>For more information, read the <a href=\"http://bundler.io/groups.html\" rel=\"nofollow noreferrer\">bundler documentation</a> on Gemfile groups.</p>\n"}, {"tags": [], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "is_accepted": true, "score": 0, "last_activity_date": 1497433927, "creation_date": 1497433927, "answer_id": 44541282, "question_id": 44538961, "link": "https://stackoverflow.com/questions/44538961/bundler-and-bundler-only-suppress-duplicate-gem-warning/44541282#44541282", "title": "Bundler and bundler-only - suppress duplicate gem warning", "body": "<p>One alternative is to maintain a list of all <code>groups</code>, and systematically include <code>, groups: groups</code></p>\n\n<pre><code># Gemfile\ngroups = [:deploy, :x, :y, :z, ...] # Maintain this list as you add groups\n\n# Gems needed except in deploy\ngem :a\ngem :b\n...\n\n# Gems that are also required for deploy\ngem :d1, groups: groups\ngem :d2, groups: groups\n\n# Gems that are required ONLY in deploy\n\ngroup :deploy do \n  gem :dep_only1\n  gem :dep_only2\nend\n</code></pre>\n\n<p>So the following works without warning</p>\n\n<pre><code>bundle --without deploy # Will ignore deploy group\nbundle-only deploy # Will install only deploy gems including those that are also needed by the app\n</code></pre>\n"}], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 44541282, "answer_count": 2, "score": 1, "last_activity_date": 1497434007, "creation_date": 1497427470, "last_edit_date": 1497434007, "question_id": 44538961, "link": "https://stackoverflow.com/questions/44538961/bundler-and-bundler-only-suppress-duplicate-gem-warning", "title": "Bundler and bundler-only - suppress duplicate gem warning", "body": "<p>I am using bundler on my gemfile for executing the application, and found it convenient to use <code>bundler-only</code> to be able to pick only a subset of gems that are needed for deployments only.</p>\n\n<p>So on my deployment machine, I use <code>bundle-only</code> that will only install gems namespaced under the <code>deploy</code> group.</p>\n\n<p>However, because of this I need to duplicate some gem (eg. my deployments need to send a notification to slack, so I have some notifier gems both in my global namespace and my :deploy-only namespace.\nThis cause several warnings </p>\n\n<blockquote>\n  <p>Your Gemfile lists the gem slack-notifier (>= 0) more than once. You\n  should probably keep only one of them. While it's not a problem now,\n  it could cause errors if you change the version of one of them later</p>\n</blockquote>\n\n<p>Is there a way to suppress the warnings ? (if possible those gems only)</p>\n"}, {"tags": ["ruby", "set"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497430068, "post_id": 44538881, "comment_id": 76070259, "body": "What are you trying to do exactly?"}, {"owner": {"reputation": 117, "user_id": 6843119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T-cW5DKQzeA/AAAAAAAAAAI/AAAAAAAAAUo/jOCPA32_Y5Y/photo.jpg?sz=128", "display_name": "hsinewu", "link": "https://stackoverflow.com/users/6843119/hsinewu"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497430575, "post_id": 44538881, "comment_id": 76070662, "body": "@sagarpandya82 combinations of arbitrary length"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497431160, "post_id": 44538881, "comment_id": 76071108, "body": "So you want <code>#&lt;Set: {[[1], [2], [3]], [[1, 2], [1, 3], [2, 3]], [[1, 2, 3]]}&gt;</code>?"}, {"owner": {"reputation": 117, "user_id": 6843119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T-cW5DKQzeA/AAAAAAAAAAI/AAAAAAAAAUo/jOCPA32_Y5Y/photo.jpg?sz=128", "display_name": "hsinewu", "link": "https://stackoverflow.com/users/6843119/hsinewu"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497431225, "post_id": 44538881, "comment_id": 76071160, "body": "@sagarpandya82 I want <code>#&lt;Set: {[1], [1, 2], [2], [1, 3], [1, 2, 3], [2, 3], [3]}&gt;</code>"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1497431457, "post_id": 44538881, "comment_id": 76071326, "body": "If <code>arr = [1,2,3]</code> then this will work <code>arr.map.with_index(1) {|_,i| arr.combination(i).entries }.flatten(1).to_set</code>. But hold out, someone may post a better way."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1497431561, "post_id": 44538881, "comment_id": 76071388, "body": "yup, someone like Stefan:)"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 6843119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T-cW5DKQzeA/AAAAAAAAAAI/AAAAAAAAAUo/jOCPA32_Y5Y/photo.jpg?sz=128", "display_name": "hsinewu", "link": "https://stackoverflow.com/users/6843119/hsinewu"}, "edited": false, "score": 0, "creation_date": 1497430982, "post_id": 44539713, "comment_id": 76070971, "body": "So it&#39;s because of push method changing element value, thus break the state? What&#39;s the proper way to do it, instead of push?"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 7, "last_activity_date": 1497431609, "last_edit_date": 1497431609, "creation_date": 1497429734, "answer_id": 44539713, "question_id": 44538881, "link": "https://stackoverflow.com/questions/44538881/ruby-set-isnt-unique/44539713#44539713", "title": "ruby set isn&#39;t unique", "body": "<p>You are effectively altering the objects within the set, which is not allowed.</p>\n\n<p>From the <a href=\"http://ruby-doc.org/stdlib-2.4.1/libdoc/set/rdoc/Set.html\" rel=\"noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>Set assumes that the identity of each element does not change while it is stored. Modifying an element of a set will render the set to an unreliable state.</p>\n</blockquote>\n\n<hr>\n\n<p>Regarding your <a href=\"https://stackoverflow.com/questions/44538881/ruby-set-isnt-unique/44539713?noredirect=1#comment76071160_44538881\">comment</a></p>\n\n<blockquote>\n  <p>I want <code>#&lt;Set: {[1], [1, 2], [2], [1, 3], [1, 2, 3], [2, 3], [3]}&gt;</code></p>\n</blockquote>\n\n<p>You could use <a href=\"http://ruby-doc.org/core-2.4.1/Array.html#method-i-combination\" rel=\"noreferrer\"><code>Array#combination</code></a>:</p>\n\n<pre><code>a = [1, 2, 3]\n\n(1..a.size).flat_map { |n| a.combination(n).to_a }\n#=&gt; [[1], [2], [3], [1, 2], [1, 3], [2, 3], [1, 2, 3]]\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 6843119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T-cW5DKQzeA/AAAAAAAAAAI/AAAAAAAAAUo/jOCPA32_Y5Y/photo.jpg?sz=128", "display_name": "hsinewu", "link": "https://stackoverflow.com/users/6843119/hsinewu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 2, "accepted_answer_id": 44539713, "answer_count": 1, "score": 6, "last_activity_date": 1497431609, "creation_date": 1497427247, "last_edit_date": 1497431142, "question_id": 44538881, "link": "https://stackoverflow.com/questions/44538881/ruby-set-isnt-unique", "title": "ruby set isn&#39;t unique", "body": "<p>For some reason the following code produce a set with duplicate values.<br>\nI'm not sure how uniqueness of an array in ruby is defined so maybe this is somehow expectable?</p>\n\n<pre><code>require 'set'\nxs = [1, 2, 3]\nxss = Set.new []\nxs.each do |x|\n  xss.merge xss.to_a.map{|xs| xs.push x}\n  xss.add [x]\n  p xss\nend\n</code></pre>\n\n<p>will prints</p>\n\n<pre><code>#&lt;Set: {[1]}&gt;\n#&lt;Set: {[1, 2], [1, 2], [2]}&gt;\n#&lt;Set: {[1, 2, 3, 3], [1, 2, 3, 3], [2, 3], [1, 2, 3, 3], [2, 3], [3]}&gt;\n</code></pre>\n\n<p>What's wrong?</p>\n\n<p>EDIT<br>\nchange <code>xs.push x</code> to <code>xs + [x]</code> will fix it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1497426373, "post_id": 44538460, "comment_id": 76067818, "body": "do you added <code>require &#39;rspec&#47;rails&#39;</code> in spec_helper"}, {"owner": {"reputation": 1183, "user_id": 7719817, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/116f667a410c2ab6f070d88680eca001?s=128&d=identicon&r=PG&f=1", "display_name": "cloud_cloud", "link": "https://stackoverflow.com/users/7719817/cloud-cloud"}, "reply_to_user": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1497426521, "post_id": 44538460, "comment_id": 76067918, "body": "Yes, I added. After I ran <code>bin&#47;rspec</code>, it works! Do you know why?"}, {"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1497426597, "post_id": 44538460, "comment_id": 76067961, "body": "bin/rspec will require and load all the files through spring ...."}, {"owner": {"reputation": 1183, "user_id": 7719817, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/116f667a410c2ab6f070d88680eca001?s=128&d=identicon&r=PG&f=1", "display_name": "cloud_cloud", "link": "https://stackoverflow.com/users/7719817/cloud-cloud"}, "reply_to_user": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1497426698, "post_id": 44538460, "comment_id": 76068031, "body": "Anyway, this method works well. But why the system <code>rspec</code> not work, I don&#39;t know now."}, {"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1497426766, "post_id": 44538460, "comment_id": 76068072, "body": "<code>require &#39;rspec&#47;rails&#39;     Rails.application.env_config[&#39;action_dispatch.show_detailed_&zwnj;&#8203;exceptions&#39;] = false</code> add in the above sequence then run"}, {"owner": {"reputation": 1183, "user_id": 7719817, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/116f667a410c2ab6f070d88680eca001?s=128&d=identicon&r=PG&f=1", "display_name": "cloud_cloud", "link": "https://stackoverflow.com/users/7719817/cloud-cloud"}, "reply_to_user": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1497427347, "post_id": 44538460, "comment_id": 76068472, "body": "Then got a new error: <code>&#47;home&#47;user&#47;.rbenv&#47;versions&#47;2.3.1&#47;lib&#47;ruby&#47;gems&#47;2.3.0&#47;gems&#47;ac&zwnj;&#8203;tionview-5.0.3&#47;lib&#47;a&zwnj;&#8203;ction_view&#47;template&#47;&zwnj;&#8203;handlers&#47;erb.rb:90:i&zwnj;&#8203;n </code>&lt;class:ERB&gt;&#39;: uninitialized constant ActionView::Template::Handlers::ERB::ENCODING_FLAG (NameError)`"}, {"owner": {"reputation": 1183, "user_id": 7719817, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/116f667a410c2ab6f070d88680eca001?s=128&d=identicon&r=PG&f=1", "display_name": "cloud_cloud", "link": "https://stackoverflow.com/users/7719817/cloud-cloud"}, "reply_to_user": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1497429528, "post_id": 44538460, "comment_id": 76069893, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/146619/discussion-between-cloud-cloud-and-rajarshi-das\">continue this discussion in chat</a>."}], "owner": {"reputation": 1183, "user_id": 7719817, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/116f667a410c2ab6f070d88680eca001?s=128&d=identicon&r=PG&f=1", "display_name": "cloud_cloud", "link": "https://stackoverflow.com/users/7719817/cloud-cloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 641, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497426021, "creation_date": 1497426021, "question_id": 44538460, "link": "https://stackoverflow.com/questions/44538460/rspec-uninitialized-constant-rails-nameerror-a-new-case", "title": "rspec - uninitialized constant Rails (NameError) - a new case", "body": "<p>Off course I read this:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/19692297/rspec-testing-throws-uninitialized-constant-rails-nameerror\">rspec testing throws Uninitialized constant Rails (NameError)</a></p>\n\n<p>But I am sure that there is nothing wrong with my code.</p>\n\n<p>Just because of the operation system! (Thread?)</p>\n\n<p>Here is the error message when ran <code>rspec</code>:</p>\n\n<pre><code>/home/user/testapp/spec/spec_helper.rb:26:in `block in &lt;top (required)&gt;': uninitialized constant Rails (NameError)\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core.rb:98:in `configure'\n    from /home/user/testapp/spec/spec_helper.rb:22:in `&lt;top (required)&gt;'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/configuration.rb:1394:in `block in requires='\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/configuration.rb:1394:in `each'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/configuration.rb:1394:in `requires='\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/configuration_options.rb:112:in `block in process_options_into'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/configuration_options.rb:111:in `each'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/configuration_options.rb:111:in `process_options_into'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/configuration_options.rb:21:in `configure'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/runner.rb:99:in `setup'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/runner.rb:86:in `run'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/runner.rb:71:in `run'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib/rspec/core/runner.rb:45:in `invoke'\n    from /home/user/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/exe/rspec:4:in `&lt;top (required)&gt;'\n    from /home/user/.rbenv/versions/2.3.1/bin/rspec:23:in `load'\n    from /home/user/.rbenv/versions/2.3.1/bin/rspec:23:in `&lt;main&gt;'\n</code></pre>\n\n<p>The L26 of the spec_helper file is:</p>\n\n<pre><code>Rails.application.env_config['action_dispatch.show_detailed_exceptions'] = false\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 7860227, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-qN1NEHkBOBA/AAAAAAAAAAI/AAAAAAAAALo/y0oIg4wr_o8/photo.jpg?sz=128", "display_name": "codebreeze", "link": "https://stackoverflow.com/users/7860227/codebreeze"}, "is_accepted": false, "score": 0, "last_activity_date": 1497463591, "creation_date": 1497463591, "answer_id": 44551757, "question_id": 44538244, "link": "https://stackoverflow.com/questions/44538244/testfirst-org-learn-ruby-course-rspec-issue-unresolved/44551757#44551757", "title": "Testfirst.org - Learn ruby course - Rspec issue unresolved", "body": "<p>After 2 days of searching i found a solution from The Odin Project.</p>\n\n<p>They have a Test First - Rspec 3 edition..</p>\n\n<p>If your having the same issue go to their repo <a href=\"https://github.com/TheOdinProject/learn_ruby\" rel=\"nofollow noreferrer\">https://github.com/TheOdinProject/learn_ruby</a>.</p>\n\n<p>Read through the readme file, fork that repo, clone your version of the repo, cd into it and bundle install..</p>\n\n<p>All works fine now..</p>\n"}], "owner": {"reputation": 47, "user_id": 7860227, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-qN1NEHkBOBA/AAAAAAAAAAI/AAAAAAAAALo/y0oIg4wr_o8/photo.jpg?sz=128", "display_name": "codebreeze", "link": "https://stackoverflow.com/users/7860227/codebreeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497463591, "creation_date": 1497425371, "last_edit_date": 1497463173, "question_id": 44538244, "link": "https://stackoverflow.com/questions/44538244/testfirst-org-learn-ruby-course-rspec-issue-unresolved", "title": "Testfirst.org - Learn ruby course - Rspec issue unresolved", "body": "<p>I would like to do the testfirst.org exercises although can't seem to get to the starting line due to a version issue/lack of knowledge on my part as well..</p>\n\n<p>At the begining you have to run the test $rake</p>\n\n<p>i got following error..</p>\n\n<pre><code>(in /home/arno/learn_ruby)\nrake aborted!\nGem::MissingSpecError: Could not find 'rspec' (~&gt; 2) among 94 total \ngem(s)\nChecked in \n'GEM_PATH=/home/arno/.gem/ruby/2.4.0:/home/arno/.rbenv/\nversions/2.4.0/lib/ruby/gems/2.4.0', execute `gem env` for more \ninformation\n/home/arno/learn_ruby/Rakefile:2:in `&lt;top (required)&gt;'\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>I then tried to uninstall rspec.  I then tried to install a version less than 3. That also did not work. Now I have version 2.9 and 3.2 installed but the same error persisted..</p>\n\n<p>I then did bundle install and bundle update...something changed although still not working..</p>\n\n<p>Here is the latest error when i run the test $rake..</p>\n\n<pre><code>(in /home/arno/learn_ruby)\nrake aborted!\nNoMethodError: undefined method `last_comment' for #\n&lt;Rake::Application:0x00564ff13bf4b0&gt;\n/home/arno/learn_ruby/Rakefile:8:in `new'\n/home/arno/learn_ruby/Rakefile:8:in `&lt;top (required)&gt;'\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>Here is the rakefile..</p>\n\n<pre><code># This Rakefile has all the right settings to run the tests inside \neach lab\ngem 'rspec', '~&gt;2'\nrequire 'rspec/core/rake_task'\n\ntask :default =&gt; :spec\n\ndesc \"run tests for this lab\"\nRSpec::Core::RakeTask.new do |task|\n  lab = Rake.application.original_dir\n  task.pattern = \"#{lab}/*_spec.rb\"\n  task.rspec_opts = [ \"-I#{lab}\", \"-I#{lab}/solution\", '-f \ndocumentation', '-r ./rspec_config']\n  task.verbose = false\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "linux", "rubygems"], "comments": [{"owner": {"reputation": 628, "user_id": 4643970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwK4h.jpg?s=128&g=1", "display_name": "Mahmoud Sayed", "link": "https://stackoverflow.com/users/4643970/mahmoud-sayed"}, "edited": false, "score": 1, "creation_date": 1497426608, "post_id": 44538186, "comment_id": 76067973, "body": "Does this question relate ? <a href=\"https://stackoverflow.com/questions/5177634/list-of-installed-gems\" title=\"list of installed gems\">stackoverflow.com/questions/5177634/list-of-installed-gems</a> If I understood what you mean by <code>collect</code>, so it may be helpful. Also you can use <code>bundle show</code> or <code>bundle list</code>. did you try that?"}], "answers": [{"comments": [{"owner": {"reputation": 637, "user_id": 7691380, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/6P9kk.jpg?s=128&g=1", "display_name": "Moustafa Elkady", "link": "https://stackoverflow.com/users/7691380/moustafa-elkady"}, "edited": false, "score": 0, "creation_date": 1497691012, "post_id": 44571824, "comment_id": 76192952, "body": "this gives all gems in the system, i want to parse specifc GemFile"}], "tags": [], "owner": {"reputation": 2045, "user_id": 7852682, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/846c3df5348d19c9aa28e61e35d11498?s=128&d=identicon&r=PG&f=1", "display_name": "slal", "link": "https://stackoverflow.com/users/7852682/slal"}, "is_accepted": false, "score": 1, "last_activity_date": 1497541682, "creation_date": 1497541682, "answer_id": 44571824, "question_id": 44538186, "link": "https://stackoverflow.com/questions/44538186/building-a-ruby-gem-to-collect-all-local-gems-in-a-project/44571824#44571824", "title": "Building a Ruby gem to collect all local gems in a project", "body": "<p>You can parse your Gemfile using <code>Gem::Specification</code>. The class contains all information of the gem.  </p>\n\n<pre><code>Gem::Specification.map {|gem| gem.name}\n</code></pre>\n"}], "owner": {"reputation": 637, "user_id": 7691380, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/6P9kk.jpg?s=128&g=1", "display_name": "Moustafa Elkady", "link": "https://stackoverflow.com/users/7691380/moustafa-elkady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497541682, "creation_date": 1497425190, "question_id": 44538186, "link": "https://stackoverflow.com/questions/44538186/building-a-ruby-gem-to-collect-all-local-gems-in-a-project", "title": "Building a Ruby gem to collect all local gems in a project", "body": "<p>I want to build a Ruby gem to collect all local gems in a project, I don't know the best practice for that.</p>\n\n<p>should i parse the Gemfile somehow and get the gems list from it? or there are libraries to make that?</p>\n\n<p>also, How can i make my gem global, just like Linux commands, what i mean is if my gem name is <code>gemlocator</code> and i put it on specific place in my Linux environment, it will enable me to open the terminal and <code>cd</code> to my Ruby project then write <code>gemlocator</code> to list the gems used in the project.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 1, "creation_date": 1497423408, "post_id": 44537508, "comment_id": 76065859, "body": "Please share the code you&#39;ve written so far and where you got stuck. Stack Overflow isn&#39;t a good place to ask other people to write code for you."}, {"owner": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497423461, "post_id": 44537508, "comment_id": 76065907, "body": "Sure, I will update the code. Thank you so much for your support. I do appreciate your kind help."}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1497426450, "post_id": 44537508, "comment_id": 76067864, "body": "If array is <b>sorted</b> and you really need <b>efficient</b> solution, just iterate it with <code>each_with_index</code> and check if <code>a[i]</code> equals to <code>a[i-1]</code> or <code>a[i+1]</code>. Best speed/memory solution."}], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1497424580, "post_id": 44537922, "comment_id": 76066603, "body": "it&#39;s be faster to build <code>uniq_elements</code> like this: <code>array.reduce(Hash.new(0)) { |memo, x| memo[x] += 1; memo }.select { |k,v| v &gt; 0 }.keys</code>"}, {"owner": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "edited": false, "score": 0, "creation_date": 1497425547, "post_id": 44537922, "comment_id": 76067300, "body": "I must process all items so  I have to loop thru all of them and for each one act differently according to the fact that the element is unique or now (see updated code above)."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497434341, "post_id": 44537922, "comment_id": 76073434, "body": "@GaganGami &quot;Unique B / Duplicate B&quot; should be the other way round, i.e. &quot;Duplicate B&quot; and then &quot;Unique B&quot;. &quot;Unique&quot; means that no similar element is coming afterwards."}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497434421, "post_id": 44537922, "comment_id": 76073505, "body": "@Stefan : ok got it"}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497434898, "post_id": 44537922, "comment_id": 76073873, "body": "@Stefan : now ?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497434976, "post_id": 44537922, "comment_id": 76073917, "body": "Nice one, I like splats :-) Even shorter: <code>.each do |key, (*duplicate, uniq)|</code>. And you can even remove that unused <code>key</code> argument if you replace <code>group_by { |e| e }</code> with <code>chunk_while(&amp;:==)</code>"}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497435256, "post_id": 44537922, "comment_id": 76074124, "body": "@Stefan : yes I was not knowing about this way, but I guess it is easy to understand, in block people might get confused, what is happening"}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497440947, "post_id": 44537922, "comment_id": 76078305, "body": "@Stefan: I learn new thing <code>chunk_while(&amp;:==)</code> great, updated my answer with same ;)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1497474009, "post_id": 44537922, "comment_id": 76099605, "body": "<a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a> returns a hash with key-value pairs <code>k=&gt;arr</code>. Do we know if the ordering of the keys is consistent with their ordering in the receiver, of if the ordering of the elements of each value <code>arr</code> are similarly consistent. I expect both are, but the doc is mute on that. Also, the last key of a group is to be removed."}], "tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 4, "last_activity_date": 1497440844, "last_edit_date": 1497440844, "creation_date": 1497424439, "answer_id": 44537922, "question_id": 44537508, "link": "https://stackoverflow.com/questions/44537508/processing-array-with-duplicates/44537922#44537922", "title": "processing array with duplicates", "body": "<p>Simple way:</p>\n\n<pre><code>array = [\"A\", \"B\", \"B\", \"C\", \"D\", \"D\"]\n\narray.group_by{|e| e}.each do |key,value| \n  *duplicate,  uniq = value\n  duplicate.map do |e|\n    puts \"Duplicate #{e}\"\n  end\n  puts \"Unique #{uniq}\"\nend\n</code></pre>\n\n<p>As per <strong><a href=\"https://stackoverflow.com/questions/44537508/processing-array-with-duplicates/44537922#comment-76073917\">Stefan's comment</a></strong> and suggestion, shorter way is:</p>\n\n<pre><code>array.chunk_while(&amp;:==).each do |*duplicate, uniq|\n  duplicate.map do |e|\n    puts \"Duplicate #{e}\"\n  end\n  puts \"Unique #{uniq}\"\nend\n\n\n# Above both will give the same Output:\n---------------------------------------\nUnique A\nDuplicate B\nUnique B\nUnique C\nDuplicate D\nUnique D\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497427822, "post_id": 44538993, "comment_id": 76068789, "body": "<code>for i in 0...a.length do</code> can be expressed as <code>a.each_index do |i|</code>"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497427902, "post_id": 44538993, "comment_id": 76068835, "body": "Thanks, @Stefan. I&#39;ve edited the code. I don&#39;t write much Ruby, so I definitely appreciate the pointer!"}], "tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": false, "score": 1, "last_activity_date": 1497428000, "last_edit_date": 1497428000, "creation_date": 1497427536, "answer_id": 44538993, "question_id": 44537508, "link": "https://stackoverflow.com/questions/44537508/processing-array-with-duplicates/44538993#44538993", "title": "processing array with duplicates", "body": "<p>Based on your code and expected output, I think this is an efficient way to do what you're looking for:</p>\n\n<pre><code>a = ['A', 'B', 'B', 'C', 'D', 'D']\n\na.each_index do |i|\n  if i &lt; a.length - 1 &amp;&amp; a[i+1] == a[i]\n    puts \"This is not the last occurrence of #{a[i]}\"\n  else\n    puts \"This is the last occurrence of #{a[i]}\"\n  end\nend\n\n# Output:\n# This is the last occurrence of A\n# This is not the last occurrence of B\n# This is the last occurrence of B\n# This is the last occurrence of C\n# This is not the last occurrence of D\n# This is the last occurrence of D\n</code></pre>\n\n<p>But I want to reiterate the importance of the wording in my output versus yours. This is not about whether the value is unique or not in the input. It seems to be about whether the value is the <em>last</em> occurrence within the input or not.</p>\n"}, {"tags": [], "owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "is_accepted": false, "score": 1, "last_activity_date": 1497592820, "last_edit_date": 1497592820, "creation_date": 1497437459, "answer_id": 44542689, "question_id": 44537508, "link": "https://stackoverflow.com/questions/44537508/processing-array-with-duplicates/44542689#44542689", "title": "processing array with duplicates", "body": "<p>Quite similar to the answer of @GaganGami but using <a href=\"https://ruby-doc.org/core-2.4.1/Enumerable.html#method-i-chunk_while\" rel=\"nofollow noreferrer\"><code>chunk_while</code></a>.</p>\n\n<pre><code>a.chunk_while { |a,b| a == b }\n .each do |*list,last|\n   list.each { |e| puts \"duplicate #{e}\" }\n   puts \"unique #{last}\"\n end\n</code></pre>\n\n<p><code>chunk_while</code>splits the array into sub arrays when the element changes.</p>\n\n<pre><code>['A', 'B', 'B', 'C', 'D', 'D'].chunk_while { |a,b| a == b }.to_a\n# =&gt; [[\"A\"], [\"B\", \"B\"], [\"C\"], [\"D\", \"D\"]] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1497629223, "last_edit_date": 1497629223, "creation_date": 1497470934, "answer_id": 44553861, "question_id": 44537508, "link": "https://stackoverflow.com/questions/44537508/processing-array-with-duplicates/44553861#44553861", "title": "processing array with duplicates", "body": "<p>The OP stated that the elements of <code>a</code> are sorted, but that is not required by the method I propose. It also maintains array-order, which could be important for the \"do something\" code performed for each element to be removed. It does so with no performance penalty over the case where the array is already sorted.</p>\n\n<p>For the array</p>\n\n<pre><code>['A', 'B', 'D', 'C', 'B', 'D']\n</code></pre>\n\n<p>I assume that some code is to be executed for <code>'A'</code>, <code>'C'</code> the second <code>'B'</code> and the second <code>'D'</code>, <em>in that order</em>, after which a new array   </p>\n\n<pre><code>['B', 'D']\n</code></pre>\n\n<p>is returned.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def do_something(e) end\n\ndef process_last_dup(a)    \n  a.dup.\n    tap do |b|\n      b.each_with_index.\n        reverse_each.\n        uniq(&amp;:first).\n        reverse_each { |_,i| do_something(a[i]) }.\n        each { |_,i| b.delete_at(i) }\n    end\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>a = ['A', 'B', 'B', 'C', 'D', 'D']\n\nprocess_last_dup(a)\n  #=&gt; [\"B\", \"D\"]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>b = a.dup\n  #=&gt; [\"A\", \"B\", \"B\", \"C\", \"D\", \"D\"]\nc = b.each_with_index\n  #=&gt; #&lt;Enumerator: [\"A\", \"B\", \"B\", \"C\", \"D\", \"D\"]:each_with_index&gt;\nd = c.reverse_each\n  #=&gt; #&lt;Enumerator: #&lt;Enumerator: [\"A\",..., \"D\"]:each_with_index&gt;:reverse_each&gt;\n</code></pre>\n\n<p>Notice that <code>d</code> can be thought of as a \"compound\" enumerator. We can convert it to an array to see the elements it will generate and pass to <code>uniq</code>.</p>\n\n<pre><code>d.to_a\n  #=&gt; [[\"D\", 5], [\"D\", 4], [\"C\", 3], [\"B\", 2], [\"B\", 1], [\"A\", 0]]\n</code></pre>\n\n<p>Continuing,</p>\n\n<pre><code>e = d.uniq(&amp;:first)\n  #=&gt; [[\"D\", 5], [\"C\", 3], [\"B\", 2], [\"A\", 0]]\ne.reverse_each { |_,i| do_something(a[i]) }\n</code></pre>\n\n<p><code>reverse_each</code> is used so that <code>do_something</code> is first executed for <code>'A'</code>, then for the second <code>'B'</code>, and so on.</p>\n\n<pre><code>e.each { |_,i| b.delete_at(i) }\nb #=&gt; [\"B\", \"D\"]\n</code></pre>\n\n<p>If <code>a</code> is to be modified in place replace <code>a.dup.</code> with <code>a.</code>.</p>\n\n<p>Readers may have noticed that the code I gave at the beginning used <a href=\"http://ruby-doc.org/core-2.4.0/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">Object#tap</a> so that <code>tap</code>'s block variable <code>b</code>, which initially equals <code>a.dup</code>, will be returned after it has been modified within <code>tap</code>'s block, rather than explicitly setting <code>b = a.sup</code> at the beginning and <code>b</code> at the end, as I've done in my step-by-step explanation. Both approaches yield the same result, of course.  </p>\n\n<p>The doc for <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-uniq\" rel=\"nofollow noreferrer\">Enumerable#uniq</a> does not specify whether the first element is kept, but it does reference <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-uniq\" rel=\"nofollow noreferrer\">Array.uniq</a>, which does keep the first. If there is any uneasiness about that one could always replace <code>reverse_each</code> with <code>reverse</code> so that <code>Array.uniq</code> would be used.</p>\n"}], "owner": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1497629223, "creation_date": 1497423160, "last_edit_date": 1497452169, "question_id": 44537508, "link": "https://stackoverflow.com/questions/44537508/processing-array-with-duplicates", "title": "processing array with duplicates", "body": "<p>I have an array</p>\n\n<pre><code>a = ['A', 'B', 'B', 'C', 'D', 'D']\n</code></pre>\n\n<p>and I have to go thru all the elements, do something depending on whether the is the last occurance or not, and remove the element after processing it.</p>\n\n<p>The elements are already sorted if that matters.</p>\n\n<p>I'm looking for something efficient. Any suggestions?</p>\n\n<p>Her what I have until now. THIS WORKS AS EXPECTED but not sure it is very efficient.</p>\n\n<pre><code>    a = ['A', 'B', 'B', 'C', 'D', 'D']\n\nwhile !a.empty?\n  b = a.shift\n\n  unless a.count(b) &gt; 0\n    p \"unique #{b}\"\n  else\n    p \"duplicate #{b}\"\n  end\nend\n</code></pre>\n\n<p>and it produces</p>\n\n<pre><code>\"unique A\"\n\"duplicate B\"\n\"unique B\"\n\"unique C\"\n\"duplicate D\"\n\"unique D\"\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1497423129, "post_id": 44537327, "comment_id": 76065713, "body": "Is there a conference_result email template in the <code>user_mailer</code> forlder?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6656910, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1025827820857406/picture?type=large", "display_name": "Tej Narayan", "link": "https://stackoverflow.com/users/6656910/tej-narayan"}, "edited": false, "score": 0, "creation_date": 1497424255, "post_id": 44537531, "comment_id": 76066384, "body": "Thank you for your help.Gmail is sending a mail but  the mail containing,Google just blocked someone from signing into your Google Account . How to overcome this"}], "tags": [], "owner": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "is_accepted": false, "score": 0, "last_activity_date": 1497423235, "creation_date": 1497423235, "answer_id": 44537531, "question_id": 44537327, "link": "https://stackoverflow.com/questions/44537327/sending-mail-using-mail-gem-and-smtp-delivery-method-rails/44537531#44537531", "title": "Sending mail using mail gem and smtp delivery method rails", "body": "<p>It seems you're missing the mail template itself. If you haven't got it, that explains the error - Otherwise I'd make sure it's in the right folder, probably <code>app/views/user_mailer/conference_result.html.erb</code> and <code>.text.erb</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 6656910, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1025827820857406/picture?type=large", "display_name": "Tej Narayan", "link": "https://stackoverflow.com/users/6656910/tej-narayan"}, "edited": false, "score": 0, "creation_date": 1497424194, "post_id": 44537545, "comment_id": 76066343, "body": "Thank you for your help,gmail is sending a mail but it the mail,Google just blocked someone from signing into your Google Account . How to overcome this."}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "reply_to_user": {"reputation": 45, "user_id": 6656910, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1025827820857406/picture?type=large", "display_name": "Tej Narayan", "link": "https://stackoverflow.com/users/6656910/tej-narayan"}, "edited": false, "score": 0, "creation_date": 1497424343, "post_id": 44537545, "comment_id": 76066432, "body": "go here with your account logged in and enable access to less secure apps <a href=\"https://www.google.com/settings/security/lesssecureapps\" rel=\"nofollow noreferrer\">google.com/settings/security/lesssecureapps</a>"}, {"owner": {"reputation": 45, "user_id": 6656910, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1025827820857406/picture?type=large", "display_name": "Tej Narayan", "link": "https://stackoverflow.com/users/6656910/tej-narayan"}, "edited": false, "score": 0, "creation_date": 1497424592, "post_id": 44537545, "comment_id": 76066614, "body": "Thank you,i had done it.The content which i am sending is not geeting displayed in a proper format.I am getting something like this in mail                        ---==_mimepart_5940e1d369d8f_282d2658644331d6 Content-Type: text/plain; charset=UTF-8 Content-Transfer-Encoding: 7bit ----==_mimepart_5940e1d369d8f_282d2658644331d6 Content-Type: text/html; charset=UTF-8 Content-Transfer-Encoding: quoted-printable"}, {"owner": {"reputation": 45, "user_id": 6656910, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1025827820857406/picture?type=large", "display_name": "Tej Narayan", "link": "https://stackoverflow.com/users/6656910/tej-narayan"}, "edited": false, "score": 0, "creation_date": 1497424638, "post_id": 44537545, "comment_id": 76066636, "body": "Angad: Yes, he should have. Leave all this, how is your projects going= on?&lt;br&gt;Tej: yes&lt;br&gt;Tej: yes i agree with angad.&lt;br&gt;"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "reply_to_user": {"reputation": 45, "user_id": 6656910, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1025827820857406/picture?type=large", "display_name": "Tej Narayan", "link": "https://stackoverflow.com/users/6656910/tej-narayan"}, "edited": false, "score": 0, "creation_date": 1497424874, "post_id": 44537545, "comment_id": 76066843, "body": "what you see in email entirely depends on the view you create. you should not ask multiple questions on same/irrelevant posts. You are welcome to create another question :)"}], "tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": true, "score": 3, "last_activity_date": 1497423269, "creation_date": 1497423269, "answer_id": 44537545, "question_id": 44537327, "link": "https://stackoverflow.com/questions/44537327/sending-mail-using-mail-gem-and-smtp-delivery-method-rails/44537545#44537545", "title": "Sending mail using mail gem and smtp delivery method rails", "body": "<p>As the error says, <strong>Missing template user_mailer/conference_result</strong>.</p>\n\n<p>You need to create a template <code>app/views/user_mailer/conference_result.html.erb</code></p>\n"}, {"tags": [], "owner": {"reputation": 653, "user_id": 8036445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb5ed1c3c2b3b03d10f179fb8f4078c?s=128&d=identicon&r=PG", "display_name": "Velusamy Venkatraman", "link": "https://stackoverflow.com/users/8036445/velusamy-venkatraman"}, "is_accepted": false, "score": 0, "last_activity_date": 1497437960, "creation_date": 1497437960, "answer_id": 44542880, "question_id": 44537327, "link": "https://stackoverflow.com/questions/44537327/sending-mail-using-mail-gem-and-smtp-delivery-method-rails/44542880#44542880", "title": "Sending mail using mail gem and smtp delivery method rails", "body": "<pre><code>https://myaccount.google.com/u/0/lesssecureapps\n</code></pre>\n\n<p>login your email then open above link.\nenable lesssecure app.</p>\n"}], "owner": {"reputation": 45, "user_id": 6656910, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1025827820857406/picture?type=large", "display_name": "Tej Narayan", "link": "https://stackoverflow.com/users/6656910/tej-narayan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 44537545, "answer_count": 3, "score": 0, "last_activity_date": 1497437960, "creation_date": 1497422632, "last_edit_date": 1497422883, "question_id": 44537327, "link": "https://stackoverflow.com/questions/44537327/sending-mail-using-mail-gem-and-smtp-delivery-method-rails", "title": "Sending mail using mail gem and smtp delivery method rails", "body": "<p>I am trying to send a mail using smtp method whose configration i had done in <strong>development.rb</strong> file,here it is</p>\n\n<pre><code>    Rails.application.configure do\n    config.action_mailer.raise_delivery_errors = true\n    config.action_mailer.delivery_method = :smtp\n      config.action_mailer.smtp_settings = {\n       address:              'smtp.gmail.com',\n       port:                 587,\n       domain:               'example.com',\n       user_name:            'angad1@gmail.com',\n       password:             xxxxxxxx,\n       authentication:       'plain',\n       enable_starttls_auto: true  \n    }\n</code></pre>\n\n<p>Here is the UserMailer which is present under the mailers folder, here i am getting the parameters value from a controller and parameter is assigned to a varible ,so that it can be available to the view\n    <strong>UserMailer.rb</strong></p>\n\n<pre><code>    class UserMailer &lt; ApplicationMailer\n        default from: 'angad1@gmail.com'\n        layout 'mailer'\n        def conference_result(email,proposal,acknowledgement,positive,negative,chart)\n            @email = email\n            @proposal = proposal\n            @acknowledgement = acknowledgement\n            @positive = positive\n            @negative = negative\n            @chart = chart\n            mail(to: @email , subject: 'Result for Your conference meeting' , content_type: \"text/html\")\n        end\n    end\n</code></pre>\n\n<p>Here is the content which i want to deliver in the mail,\n    <strong>mailer.html.erb</strong></p>\n\n<pre><code>    &lt;body&gt;\n        &lt;%= yield %&gt;\n            &lt;h3 class=\"text-center\" id=\"proposalhead\"&gt;Proposal&lt;/h3&gt;\n            &lt;div style=\"border:1px solid rgba(0,0,0,0.3);background-color: rgba(255,255,255,0.1);margin-top:10px;margin-bottom:10px;\" class=\"text-center\"&gt;\n                &lt;%= @proposal %&gt;\n            &lt;/div&gt;\n            &lt;h3 class=\"text-center hidden\" id =\"acknowledgementhead\"&gt;Acknowledgement&lt;/h3&gt;\n            &lt;div style=\"border:1px solid rgba(0,0,0,0.3);background-color: rgba(255,255,255,0.1);margin-top:20px;margin-bottom:20px;\" id =\"Acknowledgement\" class=\"text-center\"&gt;\n                &lt;%= @acknowledgement %&gt;\n            &lt;/div&gt;\n            &lt;h3 class=\"text-center hidden\" id =\"positivehead\"&gt;Positive&lt;/h3&gt;\n            &lt;div style=\"border:1px solid rgba(0,0,0,0.3);background-color: rgba(255,255,255,0.1);margin-top:10px;margin-bottom:10px;\" id =\"Positive\" class=\"text-center\"&gt;\n                &lt;%= @positive %&gt;\n            &lt;/div&gt;\n            &lt;h3 class=\"text-center hidden\" id =\"negativehead\"&gt;Negative&lt;/h3&gt;\n            &lt;div style=\"border:1px solid rgba(0,0,0,0.3);background-color: rgba(255,255,255,0.1);margin-top:10px;margin-bottom:20px\" id = \"Negative\" class=\"text-center\"&gt;\n                &lt;%= @negative %&gt;\n            &lt;/div&gt;\n            &lt;div id=\"chart_div\" style=\"width:100%;margin-bottom: 15px;margin-top:15px;\" class=\"text-center\"&gt;\n                &lt;%= @chart %&gt;\n            &lt;/div&gt;      \n      &lt;/body&gt;\n</code></pre>\n\n<p>When i trying to send the mail, it is showing following error</p>\n\n<blockquote>\n  <p>ActionView::MissingTemplate (Missing template user_mailer/conference_result with \"mailer\". Searched in:* \"user_mailer\")</p>\n</blockquote>\n\n<p>Please help me out,i am new to ruby .</p>\n"}, {"tags": ["ruby", "proxy", "user-agent"], "comments": [{"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1497422037, "post_id": 44536674, "comment_id": 76065155, "body": "Pass 10 as string not integer value"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497478418, "post_id": 44536674, "comment_id": 76101590, "body": "Nokogiri doesn&#39;t know anything about user-agents, proxies, or any other HTTP related issues because it isn&#39;t an HTTP client so this isn&#39;t a Nokogiri question. Notice that in the trace that Nokogiri isn&#39;t mentioned at all?"}, {"owner": {"reputation": 1, "user_id": 7688352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2fa2a6abf842175f60b4151c832526?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/7688352/denis"}, "edited": false, "score": 0, "creation_date": 1497500684, "post_id": 44536674, "comment_id": 76106767, "body": "strange but I open my host with script and in logs I see normal UA. Maybe not proxy. But UA."}, {"owner": {"reputation": 1, "user_id": 7688352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2fa2a6abf842175f60b4151c832526?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/7688352/denis"}, "edited": false, "score": 0, "creation_date": 1497500710, "post_id": 44536674, "comment_id": 76106770, "body": "What HPP client you recomend to me to use together with proxy and UA?"}], "owner": {"reputation": 1, "user_id": 7688352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2fa2a6abf842175f60b4151c832526?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/7688352/denis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497478438, "creation_date": 1497420269, "last_edit_date": 1497478438, "question_id": 44536674, "link": "https://stackoverflow.com/questions/44536674/error-with-nokogiri-proxy-and-user-agent", "title": "Error with Nokogiri proxy and user agent", "body": "<p>I take code from, because I need get content with US proxy and good user agent.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/24383940/how-to-get-a-url-with-user-agent-and-timeout-through-some-proxy-in-ruby\">How to GET a URL with User-Agent and timeout through some Proxy in Ruby?</a></p>\n\n<pre><code>require 'rubygems'\nrequire 'nokogiri'\nrequire 'open-uri'\n\n    user_agent = \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_0) AppleWebKit/535.2 (KHTML, like Gecko) Chrome/15.0.854.0 Safari/535.2\"\n\n    url = \"google.com\"\n\n    @doc = Nokogiri::HTML(open(url, 'User-Agent' =&gt; user_agent, 'read_timeout' =&gt; 10 ), nil, \"UTF-8\")\n</code></pre>\n\n<p>But I got error:</p>\n\n<pre><code>/usr/lib/ruby/2.3.0/net/http/header.rb:18:in `block in initialize_http_header': undefined method `strip' for 10:Fixnum (NoMethodError)\n    from /usr/lib/ruby/2.3.0/net/http/header.rb:16:in `each'\n    from /usr/lib/ruby/2.3.0/net/http/header.rb:16:in `initialize_http_header'\n    from /usr/lib/ruby/2.3.0/net/http/generic_request.rb:44:in `initialize'\n    from /usr/lib/ruby/2.3.0/net/http/request.rb:15:in `initialize'\n    from /usr/lib/ruby/2.3.0/open-uri.rb:320:in `new'\n    from /usr/lib/ruby/2.3.0/open-uri.rb:320:in `block in open_http'\n    from /usr/lib/ruby/2.3.0/net/http.rb:853:in `start'\n    from /usr/lib/ruby/2.3.0/open-uri.rb:319:in `open_http'\n    from /usr/lib/ruby/2.3.0/open-uri.rb:737:in `buffer_open'\n    from /usr/lib/ruby/2.3.0/open-uri.rb:212:in `block in open_loop'\n    from /usr/lib/ruby/2.3.0/open-uri.rb:210:in `catch'\n    from /usr/lib/ruby/2.3.0/open-uri.rb:210:in `open_loop'\n    from /usr/lib/ruby/2.3.0/open-uri.rb:151:in `open_uri'\n    from /usr/lib/ruby/2.3.0/open-uri.rb:717:in `open'\n    from /usr/lib/ruby/2.3.0/open-uri.rb:35:in `open'\n    from work6.rb:10:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "oauth", "uber-api"], "answers": [{"tags": [], "owner": {"reputation": 857, "user_id": 8132772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5841034d6cac3e0676a0ebfa9cdedf?s=128&d=identicon&r=PG&f=1", "display_name": "Sasa Jovanovic", "link": "https://stackoverflow.com/users/8132772/sasa-jovanovic"}, "is_accepted": false, "score": 0, "last_activity_date": 1497566673, "creation_date": 1497566673, "answer_id": 44578130, "question_id": 44536587, "link": "https://stackoverflow.com/questions/44536587/i-cannot-get-a-response-from-uber-auth/44578130#44578130", "title": "I cannot get a response from uber auth", "body": "<p>First you should double check if you set the correct redirect url in the dashboard. \nSecond your request to '<a href=\"https://login.uber.com/oauth/v2/authorize\" rel=\"nofollow noreferrer\">https://login.uber.com/oauth/v2/authorize</a>' seems to contain invalid payload. Please follow the steps of the <a href=\"https://developer.uber.com/docs/riders/guides/authentication/introduction\" rel=\"nofollow noreferrer\">authentication guide</a>. Briefly, you need to:</p>\n\n<ul>\n<li>Send user to  authorize url </li>\n<li>Receive the redirect with a <code>authorization code</code> </li>\n<li>make a POST call to: <code>https://login.uber.com/oauth/v2/token</code></li>\n<li>Store access and refresh token for future use </li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 8158388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddadc8226fe0ecc128dc62a0c143a7e1?s=128&d=identicon&r=PG&f=1", "display_name": "austinhendrix", "link": "https://stackoverflow.com/users/8158388/austinhendrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497566673, "creation_date": 1497420001, "question_id": 44536587, "link": "https://stackoverflow.com/questions/44536587/i-cannot-get-a-response-from-uber-auth", "title": "I cannot get a response from uber auth", "body": "<p>I am trying to integrate Uber with my web app following their oauth guides. I currently have a redirect from my website to my server, where I make a request to <code>https://login.uber.com/oauth/v2/authorize</code> and get a 302. However, I am not ever getting a response back from uber with the <code>access_token</code> and <code>refresh_token</code>. </p>\n\n<p>I have a server running at <a href=\"https://mobilius-app.herokuapp.com\" rel=\"nofollow noreferrer\">https://mobilius-app.herokuapp.com</a> and a front-end at <a href=\"http://mobilius-website.herokuapp.com\" rel=\"nofollow noreferrer\">http://mobilius-website.herokuapp.com</a>. I am currently sending a request to <code>https://login.uber.com/oauth/v2/authorize</code> with payload of </p>\n\n<pre><code>{\n    'client_secret' =&gt; UBER_CLIENT_SECRET,\n    'client_id' =&gt; UBER_CLIENT_ID,\n    'grant_type' =&gt; 'authorization_code',\n    'redirect_uri' =&gt; `https://mobilius-app.herokuapp.com/api/uber_tokens`,\n    'code' =&gt; [the auth code]\n  }\n</code></pre>\n\n<p><code>https://mobilius-app.herokuapp.com/api/uber_tokens</code> never gets a response from uber with the auth token and refresh token, however. Any help is much appreciated!</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1497420160, "post_id": 44536537, "comment_id": 76064161, "body": "I (and I expect others) cannot infer your question from an example. Please edit to state your question in words, then, if necessary, give one or more examples, each with the desired result. Also, please double-check your values."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497420604, "post_id": 44536537, "comment_id": 76064394, "body": "This seems clumsy and not sure if it&#39;s robust <code>((a &amp; b).sort_by {|e| a.index(e)}) + (b - (a &amp; b)).sort #=&gt; [1, 2, 13, 4, 10, 23, 44, 55]</code>"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1497421520, "post_id": 44536537, "comment_id": 76064869, "body": "Please provide more information on your logic for sorting. It&#39;s not clear as to why expected output has to be <code>[1, 2, 13, 4, 10, 23, 44, 55]</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1497423176, "post_id": 44537410, "comment_id": 76065735, "body": "I feel that complexity can be improved here. Perhaps by hashifying the order array, as attempted in the question. But this, as it is, certainly should work, yes."}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 4, "last_activity_date": 1497423340, "last_edit_date": 1497423340, "creation_date": 1497422877, "answer_id": 44537410, "question_id": 44536537, "link": "https://stackoverflow.com/questions/44536537/sort-the-array-with-reference-to-another-array/44537410#44537410", "title": "Sort the array with reference to another array", "body": "<p>Comparing arrays checks the first value, if it's equal goes to the second value and so on. Hence this will compare by the order of occurrence in <code>a</code> and then by the actual value for the ones not in <code>a</code>:</p>\n\n<pre><code>b.sort_by { |e| [a.index(e) || a.size, e] }\n</code></pre>\n\n<hr>\n\n<p>To keep O(nlogn), you could:</p>\n\n<pre><code>ai = a.each_with_index.to_h\nb.sort_by { |e| [ai[e] || a.size, e] }\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 6306144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ae8469ba39227a0f73e89bf4d52cf80e?s=128&d=identicon&r=PG&f=1", "display_name": "Natsu", "link": "https://stackoverflow.com/users/6306144/natsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 44537410, "answer_count": 1, "score": 0, "last_activity_date": 1497423340, "creation_date": 1497419793, "last_edit_date": 1497421862, "question_id": 44536537, "link": "https://stackoverflow.com/questions/44536537/sort-the-array-with-reference-to-another-array", "title": "Sort the array with reference to another array", "body": "<p>I have two different arrays. Let's say:</p>\n\n<pre><code>a = [1, 2, 13, 4, 10, 11, 43]\nb = [44, 23, 1, 4, 10, 2, 55, 13]\n</code></pre>\n\n<p>Now I have to sort the array <code>b</code> by referring to the array <code>a</code>. I tried the following solution:</p>\n\n<pre><code>lookup = {}\na.each_with_index do |item, index|\n  lookup[item] = index\nend\n\nb.sort_by do |item|\n  lookup.fetch(item)\nend\n</code></pre>\n\n<p>But I'm getting the <code>KeyError: key not found: 44</code> error. Can anyone help me find a solution?</p>\n\n<p>Expected output is <code>[1, 2, 13, 4, 10, 23, 44, 55]</code>.</p>\n"}, {"tags": ["ruby", "azure", "azure-hub"], "answers": [{"tags": [], "owner": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "is_accepted": true, "score": 2, "last_activity_date": 1497507495, "creation_date": 1497507495, "answer_id": 44559963, "question_id": 44536437, "link": "https://stackoverflow.com/questions/44536437/what-is-the-correct-syntax-to-pass-a-base64-instead-of-a-url-to-microsoft-azure/44559963#44559963", "title": "What is the correct syntax to pass a base64 instead of a url to Microsoft Azure Computer vision API using Ruby", "body": "<p>It sounds like you want to pass an image file to Azure Computer Vision API via <code>application/octet-stream</code> content type in Ruby, so you need to pass binary image data to <code>response.body</code>, not pass the base64 string of an image.</p>\n\n<p>Please use the code below instead of the current one to make it works.</p>\n\n<pre><code># Supported image formats: JPEG, PNG, GIF, BMP.\nrequest.body = File.binread(\"&lt;your image file name&gt;\") \n# Or `request.body = File.open(\"&lt;your image file name&gt;\") {|io| io.read}` also works\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7787304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56895d72aee18e303e20c360d4d3b47e?s=128&d=identicon&r=PG&f=1", "display_name": "Kamal Paneru", "link": "https://stackoverflow.com/users/7787304/kamal-paneru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 797, "favorite_count": 1, "accepted_answer_id": 44559963, "answer_count": 1, "score": 4, "last_activity_date": 1497507495, "creation_date": 1497419404, "last_edit_date": 1497425861, "question_id": 44536437, "link": "https://stackoverflow.com/questions/44536437/what-is-the-correct-syntax-to-pass-a-base64-instead-of-a-url-to-microsoft-azure", "title": "What is the correct syntax to pass a base64 instead of a url to Microsoft Azure Computer vision API using Ruby", "body": "<pre><code>require 'net/http'\n\nuri = URI('https://westcentralus.api.cognitive.microsoft.com/vision/v1.0/ocr')\nuri.query = URI.encode_www_form({\n\n    'language' =&gt; 'unk',\n    'detectOrientation ' =&gt; 'true'\n})\n\nrequest = Net::HTTP::Post.new(uri.request_uri)\n\nrequest['Content-Type'] = 'application/octet-stream'\n\nrequest['Ocp-Apim-Subscription-Key'] = 'MY_SUBSCRIPTION_KEY'\n\nrequest.body = \"raw_image_binary\"\n\n\nresponse = Net::HTTP.start(uri.host, uri.port, :use_ssl =&gt; uri.scheme == 'https') do |http|\n    http.request(request)\nend\n\nputs response.body\n</code></pre>\n\n<p>I got this as a response.</p>\n\n<p>{\"code\":\"InvalidImageFormat\",\"requestId\":\"3aee7147-2acc-4f64-b1c6-8453815eda38\",\"message\":\"Input data is not a valid image.\"}</p>\n\n<p>HELP!!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 323, "user_id": 1994629, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/212f0a4c5383480957f00943f96ef718?s=128&d=identicon&r=PG", "display_name": "Wax", "link": "https://stackoverflow.com/users/1994629/wax"}, "edited": false, "score": 0, "creation_date": 1497418212, "post_id": 44536079, "comment_id": 76063270, "body": "Check this <a href=\"https://stackoverflow.com/questions/1402757/how-to-break-out-from-a-ruby-block\" title=\"how to break out from a ruby block\">stackoverflow.com/questions/1402757/&hellip;</a>. Talks about breaking loops."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1497419005, "post_id": 44536079, "comment_id": 76063580, "body": "The normal approach is to use <code>loop do &lt;your code&gt; end</code> and then break out of the loop (<code>break</code> or <code>break x</code>) if all is well. In other words, assume that you will have to repeat unless it&#39;s not necessary to do so."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 8158227, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GRXZ_YdbdWE/AAAAAAAAAAI/AAAAAAAAQwk/KBvT8azLkh4/photo.jpg?sz=128", "display_name": "Juan Carlos Garfias Tovar", "link": "https://stackoverflow.com/users/8158227/juan-carlos-garfias-tovar"}, "edited": false, "score": 0, "creation_date": 1497454167, "post_id": 44536466, "comment_id": 76088571, "body": "hank you very much!! this solved my problem completely \ud83d\ude03"}], "tags": [], "owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "is_accepted": true, "score": -2, "last_activity_date": 1497433458, "last_edit_date": 1497433458, "creation_date": 1497419508, "answer_id": 44536466, "question_id": 44536079, "link": "https://stackoverflow.com/questions/44536079/how-can-i-make-the-loop-end-when-user-writes-stop-and-to-start-a-new-number-in-t/44536466#44536466", "title": "How can i make the loop end when user writes stop and to start a new number in the loop?", "body": "<p>Here is a code solution I produced for this problem. Try it out and see if it is to your liking:</p>\n\n<p><a href=\"https://gist.github.com/BKSpurgeon/1a2346e278836d5b4448424cb93fd0e9\" rel=\"nofollow noreferrer\">https://gist.github.com/BKSpurgeon/1a2346e278836d5b4448424cb93fd0e9</a></p>\n\n<pre><code> class NumberGuessingGame    \n\n    def initialize\n        welcome\n    end\n\n    def welcome\n        puts \"Welcome to Guess the Number \\n Human VS Machine\"         \n    end\n\n def guess \n    loop do       \n        @number= rand(0..9)\n        p \"Write a number between 0 and 9\"\n        numer = -1\n        while numer != @number\n            numer = gets.chomp.to_i            \n            if numer&lt;@number                \n                p \"Too low\"\n            elsif numer&gt;@number                 \n                p \"Too high\"\n            elsif numer == @number                \n                p \"You got it!\"\n                puts \"WOOOOW!! Very Impresive. Want to defeat the machine again? If not write stop otherwise press any key.\"\n                break\n            end\n        end\n        answer = gets.chomp # The Critical Line to break out of the Loop is here:\n        break if answer.downcase == \"stop\"\n    end\n\n\n end\nend\n</code></pre>\n\n<p>and you'd call it like this:</p>\n\n<pre><code>g = NumberGuessingGame.new\ng.guess\n</code></pre>\n\n<p>that escapes if you write 'stop'. i made minor modifications of the functionality. The loop is broken if the \"stop\" answer is detected. that is the critical line. </p>\n\n<p>I can't see a good reason for client code to be doing this type of thing:</p>\n\n<pre><code>game = NumberGuessingGame.new\n# Pruebas\na = \"\"\np \"Welcome to Guess the Number\"\np \"Human VS Machine\"\nwhile a != \"Stop\"\n    x = \"\"\nwhile x != \"you got it!\" \n    p\"Write a number between 0 and 9\"\n    y = gets.chomp.to_i\n    p x = game.guess(y)\nend\np \"WOOOOW!! Very Impresive. Want to defeat the machine again? If not write \n  stop or guess the new number\"\n  NumberGuessingGame\n  a = gets.chomp\nend\n</code></pre>\n\n<p>ideally you want to let all the methods in a class to do all the work - you should not have to write 'welcome to the game etc' from outside the class - that should be the responsibility of the NumberGuessingGame class.</p>\n\n<p>hope this helps.</p>\n"}], "owner": {"reputation": 79, "user_id": 8158227, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GRXZ_YdbdWE/AAAAAAAAAAI/AAAAAAAAQwk/KBvT8azLkh4/photo.jpg?sz=128", "display_name": "Juan Carlos Garfias Tovar", "link": "https://stackoverflow.com/users/8158227/juan-carlos-garfias-tovar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1497454175, "accepted_answer_id": 44536466, "answer_count": 1, "score": 2, "last_activity_date": 1497433458, "creation_date": 1497417890, "question_id": 44536079, "link": "https://stackoverflow.com/questions/44536079/how-can-i-make-the-loop-end-when-user-writes-stop-and-to-start-a-new-number-in-t", "closed_reason": "Duplicate", "title": "How can i make the loop end when user writes stop and to start a new number in the loop?", "body": "<p>How can I make the following loop end when the user writes stop, otherwise if they answer correctly how can it call the method again so that the number to be guessed is different?\nThe idea of the game is that the user tries to get the number from the class, if they get it correctly then the game asks if they want to guess a new number generated by the class or if they want to stop;if so they write Stop and the game would end.\nThanks in advance for the help</p>\n\n<pre><code>class NumberGuessingGame\n    #clase NumberGuessingGame\n    def initialize\n        #metodo que inicia\n        @number= rand(0..9)\n        #number es igual a un numero random entre 0 y 9\n    end\n\ndef guess(numer)\n        #metodo guess que dice que hay una condicion dada por el usuario, si no se da entonces se pide que el usuario la escriba manualmente\n        if numer&lt;@number\n            #si el numero es mas peque\u00f1o que el numero entonces \"Too low\"\n            \"Too low\"\n        elsif numer&gt;@number \n            #si el numero es mayor a el numero entonces \"too high\"\n            \"Too high\"\n        elsif numer == @number\n            #si el numero es igual al numero random que pone la computadora entonces \"you got it!\"\n            \"you got it!\"\n        end\n    end\nend\n\n\ngame = NumberGuessingGame.new\n# Pruebas\na = \"\"\np \"Welcome to Guess the Number\"\np \"Human VS Machine\"\nwhile a != \"Stop\"\n    x = \"\"\nwhile x != \"you got it!\" \n    p\"Write a number between 0 and 9\"\n    y = gets.chomp.to_i\n    p x = game.guess(y)\nend\np \"WOOOOW!! Very Impresive. Want to defeat the machine again? If not write \n  stop or guess the new number\"\n  NumberGuessingGame\n  a = gets.chomp\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 1, "creation_date": 1497415681, "post_id": 44535623, "comment_id": 76062318, "body": "your params doesn&#39;t have any key named <code>group</code>, post your params in the question"}, {"owner": {"reputation": 121, "user_id": 5995397, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cfe165e03fc63e9596abbe5fd786457?s=128&d=identicon&r=PG&f=1", "display_name": "Aldo", "link": "https://stackoverflow.com/users/5995397/aldo"}, "reply_to_user": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1497415796, "post_id": 44535623, "comment_id": 76062376, "body": "@Md.FarhanMemon I didn&#39;t understand, what do you mean with posting my params in the question?"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1497416067, "post_id": 44535623, "comment_id": 76062470, "body": "Do you have form to submit? You will see some hash in the server log  when you hit the submit button. Please update the question with that hash"}, {"owner": {"reputation": 121, "user_id": 5995397, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cfe165e03fc63e9596abbe5fd786457?s=128&d=identicon&r=PG&f=1", "display_name": "Aldo", "link": "https://stackoverflow.com/users/5995397/aldo"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1497416310, "post_id": 44535623, "comment_id": 76062569, "body": "@Pavan I am trying to display the form but the exception is shown before I can hit the submit button"}], "answers": [{"comments": [{"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 1, "creation_date": 1497416765, "post_id": 44535822, "comment_id": 76062716, "body": "You got this (y). and see @Aldo, it very much helps.. :)"}, {"owner": {"reputation": 121, "user_id": 5995397, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cfe165e03fc63e9596abbe5fd786457?s=128&d=identicon&r=PG&f=1", "display_name": "Aldo", "link": "https://stackoverflow.com/users/5995397/aldo"}, "edited": false, "score": 1, "creation_date": 1497416977, "post_id": 44535822, "comment_id": 76062781, "body": "@Pavan OMG! It wokrs!! Thank you a lot!! Can u explain to me a little bit why my code was not working? I&#39;m kind of new with Rails."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 121, "user_id": 5995397, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cfe165e03fc63e9596abbe5fd786457?s=128&d=identicon&r=PG&f=1", "display_name": "Aldo", "link": "https://stackoverflow.com/users/5995397/aldo"}, "edited": false, "score": 0, "creation_date": 1497417681, "post_id": 44535822, "comment_id": 76063031, "body": "@Aldo If you see the <code>params</code> hash while displaying the form you won&#39;t see any any <code>:group</code> key. Since you are calling <code>group_params</code> in the <code>new</code> method and the <a href=\"http://edgeapi.rubyonrails.org/classes/ActionController/Parameters.html#method-i-require\" rel=\"nofollow noreferrer\"><i>require</i></a> will <i>raise an exception when the key is not present</i>,so is the error. And by convention you should call such method(called as <a href=\"http://edgeapi.rubyonrails.org/classes/ActionController/StrongParameters.html\" rel=\"nofollow noreferrer\"><i>strong params</i></a>) in <code>create</code> method for creating a record not in the <code>new</code> method. Hope you understood :)"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 2, "last_activity_date": 1497418196, "last_edit_date": 1592644375, "creation_date": 1497416667, "answer_id": 44535822, "question_id": 44535623, "link": "https://stackoverflow.com/questions/44535623/ruby-param-is-missing-or-the-value-is-empty-group/44535822#44535822", "title": "Ruby param is missing or the value is empty: group", "body": "<blockquote>\n<p>param is missing or the value is empty: group</p>\n<p>I am trying to display the form but the exception is shown before I\ncan hit the submit button</p>\n</blockquote>\n<p>Well then you are calling <code>group_params</code> in the <em>wrong method</em>. You should call it in <code>create</code> method. Let me clear up your code which should resolve your problem.</p>\n<pre><code>def new\n  @group = current_user.groups.build\nend\n\ndef create\n  @group = current_user.groups.build(group_params)\n  if @group.save\n    flash[:success] = &quot;Group created!&quot;\n    redirect_to root_url\n  else\n    @feed_items = []\n    render 'static_pages/home'\n  end\nend\n\nprivate\ndef group_params\n  params.require(:group).permit(:name, :hashtag)\nend\n</code></pre>\n<p><em><strong>Explanation to the error:</strong></em></p>\n<p>If you see the <code>params</code> hash while displaying the form you won't see any  <code>:group</code> key. Since you are calling <code>group_params</code> in the <code>new</code> method, the <a href=\"http://edgeapi.rubyonrails.org/classes/ActionController/Parameters.html#method-i-require\" rel=\"nofollow noreferrer\"><em>require</em></a> <em>will raise an exception when the key is not present</em>,so is the error.</p>\n"}], "owner": {"reputation": 121, "user_id": 5995397, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cfe165e03fc63e9596abbe5fd786457?s=128&d=identicon&r=PG&f=1", "display_name": "Aldo", "link": "https://stackoverflow.com/users/5995397/aldo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 44535822, "answer_count": 1, "score": 0, "last_activity_date": 1497418196, "creation_date": 1497415513, "last_edit_date": 1497417110, "question_id": 44535623, "link": "https://stackoverflow.com/questions/44535623/ruby-param-is-missing-or-the-value-is-empty-group", "title": "Ruby param is missing or the value is empty: group", "body": "<p>I'm developing an app with Ruby on Rails. Here is my controller action:</p>\n\n<pre><code>def new\n@group = current_user.groups.build(group_params)\nif @group.save\n  flash[:success] = \"Group created!\"\n  redirect_to root_url\nelse\n  @feed_items = []\n  render 'static_pages/home'\nend\nend\n</code></pre>\n\n<p>My form:</p>\n\n<pre><code>&lt;%= form_for(@group) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_area :name, placeholder: \"Group's name\" %&gt;\n    &lt;%= f.text_area :hashtag, placeholder: \"Category\" %&gt;\n  &lt;/div&gt;\n  &lt;%= f.submit \"Create\", class: \"btn btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I try to use:</p>\n\n<pre><code>private\n\n    def group_params\n      params.require(:group).permit(:name, :hashtag)\n    end\n</code></pre>\n\n<p>I get the following exception:</p>\n\n<pre><code>param is missing or the value is empty: group\n</code></pre>\n\n<p>I've tried to change :group in require but nothing seems to be working. Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-maps", "geocoding", "geokit"], "comments": [{"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1497414588, "post_id": 44535413, "comment_id": 76061933, "body": "What&#39;s the error here? what&#39;s your question?"}, {"owner": {"reputation": 4839, "user_id": 265683, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9cfc3a929b053ff4abac9fb0e7a0daa8?s=128&d=identicon&r=PG", "display_name": "RenegadeAndy", "link": "https://stackoverflow.com/users/265683/renegadeandy"}, "reply_to_user": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1497415084, "post_id": 44535413, "comment_id": 76062105, "body": "Woops! added in - sorry!"}], "answers": [{"comments": [{"owner": {"reputation": 4839, "user_id": 265683, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9cfc3a929b053ff4abac9fb0e7a0daa8?s=128&d=identicon&r=PG", "display_name": "RenegadeAndy", "link": "https://stackoverflow.com/users/265683/renegadeandy"}, "edited": false, "score": 0, "creation_date": 1497448944, "post_id": 44544686, "comment_id": 76084659, "body": "I see the puts in the log - and it says &#39;distance in leg is: 0.0&#39;"}, {"owner": {"reputation": 1319, "user_id": 550226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2f1bf5b4855960d2994b3b30a08e04?s=128&d=identicon&r=PG", "display_name": "Frankie Roberto", "link": "https://stackoverflow.com/users/550226/frankie-roberto"}, "reply_to_user": {"reputation": 4839, "user_id": 265683, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9cfc3a929b053ff4abac9fb0e7a0daa8?s=128&d=identicon&r=PG", "display_name": "RenegadeAndy", "link": "https://stackoverflow.com/users/265683/renegadeandy"}, "edited": false, "score": 0, "creation_date": 1497602452, "post_id": 44544686, "comment_id": 76157059, "body": "@RenegadeAndy can you debug what the latitude and longitude values of the origin and destination are? I can&#39;t recreate this at all."}], "tags": [], "owner": {"reputation": 1319, "user_id": 550226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2f1bf5b4855960d2994b3b30a08e04?s=128&d=identicon&r=PG", "display_name": "Frankie Roberto", "link": "https://stackoverflow.com/users/550226/frankie-roberto"}, "is_accepted": false, "score": 1, "last_activity_date": 1497442908, "creation_date": 1497442908, "answer_id": 44544686, "question_id": 44535413, "link": "https://stackoverflow.com/questions/44535413/calculating-the-distance-between-2-latitude-and-longitude-locations-in-a-rails-p/44544686#44544686", "title": "Calculating the distance between 2 latitude and longitude locations in a rails project", "body": "<p>Do you see your <code>puts \"distance in leg is:\"+distance.to_s</code> line in the logs?</p>\n\n<p>If not, then the error is down to <code>if(origin.present? &amp;&amp; destination.present?)</code> returning false.</p>\n"}, {"tags": [], "owner": {"reputation": 4839, "user_id": 265683, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9cfc3a929b053ff4abac9fb0e7a0daa8?s=128&d=identicon&r=PG", "display_name": "RenegadeAndy", "link": "https://stackoverflow.com/users/265683/renegadeandy"}, "is_accepted": true, "score": 0, "last_activity_date": 1497740870, "creation_date": 1497740870, "answer_id": 44610235, "question_id": 44535413, "link": "https://stackoverflow.com/questions/44535413/calculating-the-distance-between-2-latitude-and-longitude-locations-in-a-rails-p/44610235#44610235", "title": "Calculating the distance between 2 latitude and longitude locations in a rails project", "body": "<p>This was complete user error. The code I have posted in this question is actually entirely correct.</p>\n\n<p>Due to several underlying issues in the models and controllers the values in latitude and longitude columns were not being persisted.</p>\n\n<p>All fixed :)</p>\n"}], "owner": {"reputation": 4839, "user_id": 265683, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9cfc3a929b053ff4abac9fb0e7a0daa8?s=128&d=identicon&r=PG", "display_name": "RenegadeAndy", "link": "https://stackoverflow.com/users/265683/renegadeandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1275, "favorite_count": 0, "accepted_answer_id": 44610235, "answer_count": 2, "score": 1, "last_activity_date": 1497740870, "creation_date": 1497414401, "last_edit_date": 1497415076, "question_id": 44535413, "link": "https://stackoverflow.com/questions/44535413/calculating-the-distance-between-2-latitude-and-longitude-locations-in-a-rails-p", "title": "Calculating the distance between 2 latitude and longitude locations in a rails project", "body": "<p>I am using the </p>\n\n<blockquote>\n  <p>geokit-rails</p>\n</blockquote>\n\n<p>gem to calculate the distance between 2 objets which contain latitude and longitude fields: <a href=\"https://github.com/geokit/geokit-rails\" rel=\"nofollow noreferrer\">https://github.com/geokit/geokit-rails</a></p>\n\n<p>I have a Leg object - which contains both 1 Origin object and 1 Destination object.</p>\n\n<p>Origin looks like this :</p>\n\n<pre><code>class Origin &lt; ApplicationRecord\n  belongs_to :leg\n\n  validates :name, presence: true\n  validates :longitude, presence: true\n  validates :latitude, presence: true\n  validates :type, presence: true\n\n  acts_as_mappable :default_units =&gt; :miles,\n                   :default_formula =&gt; :sphere,\n                   :distance_field_name =&gt; :distance,\n                   :lat_column_name =&gt; :latitude,\n                   :lng_column_name =&gt; :longitude\n\nend\n</code></pre>\n\n<p>The destination model looks like this:</p>\n\n<pre><code>class Destination &lt; ApplicationRecord\n  belongs_to :leg\n\n  validates :name, presence: true\n  validates :longitude, presence: true\n  validates :latitude, presence: true\n  validates :type, presence: true\n\n  acts_as_mappable :default_units =&gt; :miles,\n                   :default_formula =&gt; :sphere,\n                   :distance_field_name =&gt; :distance,\n                   :lat_column_name =&gt; :latitude,\n                   :lng_column_name =&gt; :longitude\nend\n</code></pre>\n\n<p>Then I call this line in my Leg object, to get a distance between an origin and destination. Both the origin and destination records exist - with valid latitude and longitude values in the DB.</p>\n\n<pre><code>def distance\n    if(origin.present? &amp;&amp; destination.present?)\n        distance = origin.distance_from(destination, :units=&gt;:miles)\n        puts \"distance in leg is:\"+distance.to_s\n        return distance\n    else\n        return 0\n    end\n  end\n</code></pre>\n\n<p>The distance returned is always 0.0, despite using valid origin / destination objects which have appropriate values in the latitude and longitude columns. </p>\n\n<p>Am I using this wrong? Can anybody help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oauth", "doorkeeper"], "answers": [{"tags": [], "owner": {"reputation": 4991, "user_id": 441935, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/24e14a302cb155b103f4f203f06a65a4?s=128&d=identicon&r=PG", "display_name": "Daniel Nill", "link": "https://stackoverflow.com/users/441935/daniel-nill"}, "is_accepted": false, "score": 0, "last_activity_date": 1497591269, "creation_date": 1497591269, "answer_id": 44581518, "question_id": 44535303, "link": "https://stackoverflow.com/questions/44535303/doorkeeper-auth-flow-not-working/44581518#44581518", "title": "doorkeeper auth flow not working", "body": "<p>I have updated the wiki I linked above, but incase others come across this question, per the rfc, the parameters on the token request must be form urlencoded.</p>\n\n<pre><code>curl -XPOST http://localhost:3000/oauth/token\n  -F \"client_id=CLIENT_ID\"\n  -F \"client_secret=CLIENT_SECRET\" \n  -F \"redirect_uri=https://galaiojniedmogfplghkjnmcfnlbpbpg.chromiumapp.org/\"\n  -F \"grant_type=authorization_code\"\n  -F \"code=eb775dba8811f605c672a0aac8472972eabaae87446ac957e2b71c57b0b10e6e\" \n</code></pre>\n"}], "owner": {"reputation": 4991, "user_id": 441935, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/24e14a302cb155b103f4f203f06a65a4?s=128&d=identicon&r=PG", "display_name": "Daniel Nill", "link": "https://stackoverflow.com/users/441935/daniel-nill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 529, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497591269, "creation_date": 1497413690, "question_id": 44535303, "link": "https://stackoverflow.com/questions/44535303/doorkeeper-auth-flow-not-working", "title": "doorkeeper auth flow not working", "body": "<p>I am trying to perform the oauth2 flow as described by <a href=\"https://github.com/doorkeeper-gem/doorkeeper/wiki/Interacting-as-an-OAuth-client-with-Doorkeeper#writing-a-raw-oauth-client\" rel=\"nofollow noreferrer\">https://github.com/doorkeeper-gem/doorkeeper/wiki/Interacting-as-an-OAuth-client-with-Doorkeeper#writing-a-raw-oauth-client</a>, but I get a 401 when \nI try to retrieve the access token.  Here is what I am doing</p>\n\n<p>1) click the authorize button on the application as seen here <a href=\"https://i.stack.imgur.com/GGSsn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GGSsn.png\" alt=\"enter image description here\"></a>\n2) I authorize the application on the next screen and I'm given a url of the form <code>chromiumapp.org/?code=eb775dba8811f605c672a0aac8472972eabaae87446ac957e2b71c57b0b10e6e</code></p>\n\n<p>3) Given this code I perform</p>\n\n<pre><code>curl -XPOST http://localhost:3000/oauth/token -d '{ \n  \"client_id\": CLIENT_ID,\n  \"client_secret\": CLIENT_SECRET, \n  \"redirect_uri\": \"https://galaiojniedmogfplghkjnmcfnlbpbpg.chromiumapp.org/\", \n  \"grant_type\": \"authorization_code\", \n  \"code\": \"eb775dba8811f605c672a0aac8472972eabaae87446ac957e2b71c57b0b10e6e\" \n}`\n</code></pre>\n\n<p>However this returns <code>{\"error\":\"invalid_request\",\"error_description\":\"The request is missing a required parameter, includes an unsupported parameter value, or is otherwise malformed.\"}</code></p>\n\n<p>Is there some part of the flow that I'm missing or is there something incorrect in the documentation?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8116786"}, "edited": false, "score": 0, "creation_date": 1497411688, "post_id": 44534981, "comment_id": 76061132, "body": "My plan was to avoid using active records but im still debating with my colleagues the best way to go"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1497411757, "post_id": 44534981, "comment_id": 76061142, "body": "I see, so the answer makes sense to you?"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1497412067, "post_id": 44534981, "comment_id": 76061206, "body": "just replace your code from <code>conn =...</code> to <code>conn.close</code> with mine, you have to think about how you will pass the user input(params)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8116786"}, "edited": false, "score": 0, "creation_date": 1497412469, "post_id": 44534981, "comment_id": 76061297, "body": "quick question though : Ive got this into terminal undefined local variable or method `params&#39; for main:Object (NameError). How to fix ?"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1497412656, "post_id": 44534981, "comment_id": 76061352, "body": "exactly, that&#39;s what I meant by passing user input here, for the time being you can hard code your <code>zipcode</code> replacing <code>#{params[:zip_code]}</code>. I assume you might be having a form where user inputs the <code>zipcode</code> as params, that parameter needs to be passed here as argument"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8116786"}, "edited": false, "score": 0, "creation_date": 1497412773, "post_id": 44534981, "comment_id": 76061391, "body": "okay so #{params[:zip_code]} should be in fact user input ? sorry for the dummy qquestions. Still into the learning curve"}], "tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": true, "score": -1, "last_activity_date": 1497411433, "creation_date": 1497411433, "answer_id": 44534981, "question_id": 44534904, "link": "https://stackoverflow.com/questions/44534904/how-to-query-postgresql-database-to-check-if-a-value-exist/44534981#44534981", "title": "How to query postgreSQL database to check if a value exist ?", "body": "<p>Your query would be,</p>\n\n<pre><code>conn = PGconn.connect(:hostaddr=&gt;\"127.0.01\", :port=&gt;5432, :dbname=&gt;\"wp-app\", :user=&gt;\"postgres\", :password=&gt;'Password2017')\nsql = \"SELECT \\\"us_cities\\\".* FROM \\\"us_cities\\\" WHERE \\\"us_cities\\\".\\\"zip_codes\\\" = #{params[:zip_code]}\"\nres = conn.exec(sql)\np res.present?\nconn.close\n</code></pre>\n\n<p>I just wonder, inspite on rails, you are not using <code>activerecord</code>, if you do, you simply do,</p>\n\n<pre><code>UsCity.where(zip_codes: params[:zip_code]).exists?\n#=&gt; true/false\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8116786"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 44534981, "answer_count": 1, "score": 0, "last_activity_date": 1497411433, "creation_date": 1497410932, "question_id": 44534904, "link": "https://stackoverflow.com/questions/44534904/how-to-query-postgresql-database-to-check-if-a-value-exist", "title": "How to query postgreSQL database to check if a value exist ?", "body": "<p>Hi everyone and thanks for the great job here.</p>\n\n<p>I am building an application with ruby on rails and postgresql. I have sucessfuly connected to my database and I can query the database and visualise the response in the console with no problem.</p>\n\n<p>My database contains all zip-codes and cities in the US( 45k + rows ). The next setp will be to get an input from the users , query the zip-code column to see if the zipcode exist and return (yes) if it does and (no) if does not.</p>\n\n<p>Here is my code : </p>\n\n<pre><code>class PgGem_test\n    @failmess = \"Error : the postgreSQL gem has not been loaded correctly\"\n    begin\n        @var_pg = require 'pg'\n    rescue LoadError\n        puts \"#@var_pg | #@failmess\"\n    end\nend\n\nconn = PGconn.connect(:hostaddr=&gt;\"127.0.01\", :port=&gt;5432, :dbname=&gt;\"wp-app\", :user=&gt;\"postgres\", :password=&gt;'Password2017')\n\nres = conn.exec(\"select * from us_cities\")\n\nres.each { |row|\n    id = res[0]['id']\n    name = res[0]['name']\n    zip_codes = res[0]['zip_codes']\n\n\n    puts \"id=\"+row['id']+ \" | name=\"+row['name']+ \" | zip code=\"+row['zip_codes']\n}\n\nconn.close\n</code></pre>\n\n<p>and it return something like that </p>\n\n<pre><code>id=45395 | name=West Hamlin | zip code=25506 25571\nid=45396 | name=West Liberty | zip code=26003 26074\nid=45397 | name=West Logan | zip code=25601\nid=45398 | name=West Milford | zip code=26451\nid=45399 | name=Weston | zip code=26452\nid=45400 | name=Westover | zip code=26501\nid=45401 | name=West Union | zip code=26456\nid=45402 | name=Wheeling | zip code=26003\nid=45403 | name=White Hall | zip code=26554\nid=45404 | name=White Sulphur Springs | zip code=24925 24986\nid=45405 | name=Whitesville | zip code=25209\nid=45406 | name=Whitmer | zip code=26296\nid=45407 | name=Wiley Ford | zip code=26753 26767\nid=45408 | name=Williamson | zip code=25661\nid=45409 | name=Williamstown | zip code=26187\nid=45410 | name=Windsor Heights | zip code=26075\nid=45411 | name=Winfield | zip code=25213\nid=45412 | name=Wolf Summit | zip code=26422 26426\nid=45413 | name=Womelsdorf (Coalton) | zip code=26257\n</code></pre>\n\n<p>I would like to get input from the user ( zipcode ) query the zipcode column-only to check if the zipcode exits and return a response. </p>\n\n<p>I dont know where to start and would appreciate some help.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "sinatra", "rack"], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 6831572, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d0bdcbb13d6f5b35393b736e4d030f44?s=128&d=identicon&r=PG&f=1", "display_name": "Zonet", "link": "https://stackoverflow.com/users/6831572/zonet"}, "edited": false, "score": 0, "creation_date": 1497411153, "post_id": 44534750, "comment_id": 76061006, "body": "I realise I used <code>.each</code> incorrectly here. If I said <code>print user.name</code>, that would be fine though, right? (I&#39;m not saying it would have resolved this particular error). Thanks for your help, Max."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 172, "user_id": 6831572, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d0bdcbb13d6f5b35393b736e4d030f44?s=128&d=identicon&r=PG&f=1", "display_name": "Zonet", "link": "https://stackoverflow.com/users/6831572/zonet"}, "edited": false, "score": 0, "creation_date": 1497411353, "post_id": 44534750, "comment_id": 76061043, "body": "Yeah if you wanted to print each line that would make sense. But its not clear what you were trying to do in the original code."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 4, "last_activity_date": 1497409750, "creation_date": 1497409750, "answer_id": 44534750, "question_id": 44534709, "link": "https://stackoverflow.com/questions/44534709/why-does-this-code-throw-an-error-when-used-inside-the-controller-but-not-the-v/44534750#44534750", "title": "Why does this code throw an error when used inside the controller, but not the view?", "body": "<p>At the end of the day, your controller needs to return a string. <code>erb :'users/all'</code> returns a string.</p>\n\n<p>Let's back up a sec and look at your existing code though, specifically this:</p>\n\n<pre><code>  @users.each do |user|\n    user.name\n  end\n</code></pre>\n\n<p>The block here basically has no effect; <code>each</code> does <em>not</em> return a modified array (maybe you were looking for <code>map</code>?)</p>\n\n<p>Although you already have the right idea to move this logic into the view, I'm just pointing out that the original code was wrong in more ways than one. </p>\n"}], "owner": {"reputation": 172, "user_id": 6831572, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d0bdcbb13d6f5b35393b736e4d030f44?s=128&d=identicon&r=PG&f=1", "display_name": "Zonet", "link": "https://stackoverflow.com/users/6831572/zonet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497409750, "creation_date": 1497409386, "question_id": 44534709, "link": "https://stackoverflow.com/questions/44534709/why-does-this-code-throw-an-error-when-used-inside-the-controller-but-not-the-v", "title": "Why does this code throw an error when used inside the controller, but not the view?", "body": "<p>I have the following model: </p>\n\n<pre><code>class User\n\ninclude DataMapper::Resource\n\nproperty :id,     Serial\nproperty :name,   String, required: true\nproperty :email,   String, required: true, unique: true\nproperty :password_digest, Text\nattr_reader :password\nattr_accessor :password_confirmation\n\nvalidates_confirmation_of :password\nvalidates_format_of :email, as: :email_address\n\nhas n, :victories\n</code></pre>\n\n<p>This works fine, and allows for people to sign-up to the website. However, I then defined the following route: </p>\n\n<pre><code>get 'users/all' do\n  @users = User.all\n  @users.each do |user|\n    user.name\n  end\nend\n</code></pre>\n\n<p>Now, the application will still run but when I attempt to visit '/users/all', I am greeted with \"This site can't be reached\" and the following terminal error: </p>\n\n<pre><code>ERROR Rack::Lint::LintError: Body yielded non-string value #&lt;User @id=1 @name=\"Iain K\" @email=\"test@googlemail.com\" @password_digest=&lt;not loaded&gt;&gt;\n</code></pre>\n\n<p>When I wrap this logic in a view however, it works: </p>\n\n<pre><code>get 'users/all' do\n  @users = User.all\n  erb(:'users/all')\nend\n</code></pre>\n\n<p>Inside users/all.erb:</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt;\n&lt;li&gt;\n  Name: &lt;%= user.name %&gt;\n&lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Why is this? </p>\n\n<p>All help is appreciated.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "edited": false, "score": 0, "creation_date": 1497405388, "post_id": 44534153, "comment_id": 76059657, "body": "Show something that you have tried already"}, {"owner": {"reputation": 283, "user_id": 7197373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-8cxs3f-Mnnc/AAAAAAAAAAI/AAAAAAAAAFM/dixBEFMr-90/photo.jpg?sz=128", "display_name": "RamJet", "link": "https://stackoverflow.com/users/7197373/ramjet"}, "reply_to_user": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "edited": false, "score": 0, "creation_date": 1497405581, "post_id": 44534153, "comment_id": 76059700, "body": "I haven&#39;t tried anything. I can easily generate the code to do this myself but I&#39;m looking for a Ruby way using ruby array methods."}, {"owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "edited": false, "score": 1, "creation_date": 1497405774, "post_id": 44534153, "comment_id": 76059749, "body": "It would have been much nicer, if you would have shown the code that could easily generate, and asked what is the ruby way of doing it."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497409430, "post_id": 44534153, "comment_id": 76060658, "body": "@RamJet I&#39;ve updated my answer so now it works for arrays like: <code>[1,2,1,3,5,6] #=&gt; [4,11]</code>, it would fail previously."}, {"owner": {"reputation": 283, "user_id": 7197373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-8cxs3f-Mnnc/AAAAAAAAAAI/AAAAAAAAAFM/dixBEFMr-90/photo.jpg?sz=128", "display_name": "RamJet", "link": "https://stackoverflow.com/users/7197373/ramjet"}, "edited": false, "score": 0, "creation_date": 1497412710, "post_id": 44534153, "comment_id": 76061372, "body": "Downvoter - What&#39;s the problem?"}], "answers": [{"comments": [{"owner": {"reputation": 283, "user_id": 7197373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-8cxs3f-Mnnc/AAAAAAAAAAI/AAAAAAAAAFM/dixBEFMr-90/photo.jpg?sz=128", "display_name": "RamJet", "link": "https://stackoverflow.com/users/7197373/ramjet"}, "edited": false, "score": 1, "creation_date": 1497406111, "post_id": 44534214, "comment_id": 76059832, "body": "each_cons is the method I was looking for. Thanks"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497407009, "post_id": 44534214, "comment_id": 76060041, "body": "If <code>a = [1, 2, 6, 10, 11, 12]</code> then your technique returns <code>[3,21,23]</code>. I think it should return return <code>[3,33]</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497407011, "post_id": 44534214, "comment_id": 76060042, "body": "Could be a bit less confusing with <code>do |a, b|</code> and avoiding the array refs."}, {"owner": {"reputation": 283, "user_id": 7197373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-8cxs3f-Mnnc/AAAAAAAAAAI/AAAAAAAAAFM/dixBEFMr-90/photo.jpg?sz=128", "display_name": "RamJet", "link": "https://stackoverflow.com/users/7197373/ramjet"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497407439, "post_id": 44534214, "comment_id": 76060131, "body": "@sagarpandya82 that&#39;s right. I didn&#39;t consider that. So how do you do it?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1497407495, "post_id": 44534214, "comment_id": 76060143, "body": "Shouldn&#39;t it be <code>[3,21,23]</code> @sagarpandya82? it says &quot;I want to return a new array, (b), containing the sum of <i>adjacent</i> elements that differ by one&quot;"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497407837, "post_id": 44534214, "comment_id": 76060223, "body": "@Sebasti&#225;nPalma RamJet seems to agree with me. <i>adjacent elements that differ by one</i> can be more than two elements in a row. I don&#39;t think <code>each_cons</code> can be used here."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 283, "user_id": 7197373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-8cxs3f-Mnnc/AAAAAAAAAAI/AAAAAAAAAFM/dixBEFMr-90/photo.jpg?sz=128", "display_name": "RamJet", "link": "https://stackoverflow.com/users/7197373/ramjet"}, "edited": false, "score": 0, "creation_date": 1497410930, "post_id": 44534214, "comment_id": 76060961, "body": "@RamJet, I had to update the answer, take a look, thanks everyone."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497411316, "post_id": 44534214, "comment_id": 76061037, "body": "Nice update. I also suggest you use <code>(a-b).abs != 1</code> as your block condition, so that <code>[1,2,1,7,6] #=&gt; [4,13]</code>. I only realised this afterwards but &#39;difference by one&#39; could be negative of course."}, {"owner": {"reputation": 283, "user_id": 7197373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-8cxs3f-Mnnc/AAAAAAAAAAI/AAAAAAAAAFM/dixBEFMr-90/photo.jpg?sz=128", "display_name": "RamJet", "link": "https://stackoverflow.com/users/7197373/ramjet"}, "edited": false, "score": 1, "creation_date": 1497412333, "post_id": 44534214, "comment_id": 76061264, "body": "Both sagarpandya82 and @Sebasti&#225;n Palma have answers that are correct. Thanks to both of you. Only one problem. I&#39;m using ruby 1.9.3 and both of these methods need a later version of ruby to work."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1497418835, "post_id": 44534214, "comment_id": 76063515, "body": "There&#39;s a good argument for your interpretation of &quot;sum of adjacent elements&quot;. Given that interpretation, using <code>each_cons(2)</code> is a good choice."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 4, "last_activity_date": 1497410886, "last_edit_date": 1497410886, "creation_date": 1497405574, "answer_id": 44534214, "question_id": 44534153, "link": "https://stackoverflow.com/questions/44534153/create-a-new-array-based-on-a-relationship-between-elements-in-an-existing-array/44534214#44534214", "title": "Create a new array based on a relationship between elements in an existing array in ruby", "body": "<p>You can initialize a <code>b</code> variable and use <code>each_cons</code>, taking two consecutive elements from the array, then use <code>map</code>, inside you can get the sum of those two values per array if the substraction of both values is equal to 1, as you'll get <code>nil</code> values then you can compact the \"mapped\" result:</p>\n\n<pre><code>a = [1, 2, 6, 10, 11]\nb = a.each_cons(2).map do |value|\n  value.reduce(:+) if value[1] - value[0] == 1\nend.compact\n# =&gt; [3, 21]\n</code></pre>\n\n<p>Here's an update, you can use <code>slice_when</code> and convert to array the enumerator that you get as result, then to map the <code>sum</code> of each array element that has more than one value inside, and the compact in order to remove <code>nil</code> elements:</p>\n\n<pre><code>p arr.slice_when{|a, b| b != a.next}.to_a\n# =&gt; [[1, 2], [6], [10, 11, 12]]\np arr.slice_when{|a, b| b != a.next}.to_a.map{|e| e.sum if e.size &gt; 1}\n# =&gt; [3, nil, 33]\np arr.slice_when{|a, b| b != a.next}.to_a.map{|e| e.sum if e.size &gt; 1}.compact\n#\u00a0=&gt; [3, 33]\n</code></pre>\n\n<p>But this looks better using <code>select</code> and mapping the <code>sum</code> of elements at the end:</p>\n\n<pre><code>p arr.slice_when{|a, b| b != a.next}.to_a.select{|e| e.size &gt; 1}.map(&amp;:sum)\n</code></pre>\n\n<p>A benchmark:</p>\n\n<pre><code>arr = [1, 2, 6, 10, 11, 12]\n\nBenchmark.bm do |bm|\n  bm.report do\n    iterations.times do\n      arr.slice_when{|a, b| b != a.next}.to_a.map{|e| e.sum if e.size &gt; 1}.compact\n    end\n  end\n\n  bm.report do\n    iterations.times do\n      arr.slice_when{|a, b| b != a.next}.to_a.select{|e| e.size &gt; 1}.map(&amp;:sum)\n    end\n  end\n\n  bm.report do\n    iterations.times do\n      arr.chunk_while { |a,b| b == a.next }.select{ |a| a.size &gt; 1 }.map{|e| e.reduce(:+)}\n    end\n  end\nend\n\n    user     system      total         real\n0.920000   0.010000   0.930000 (  0.942134)\n0.920000   0.010000   0.930000 (  0.939316)\n0.940000   0.010000   0.950000 (  0.964895)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 283, "user_id": 7197373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-8cxs3f-Mnnc/AAAAAAAAAAI/AAAAAAAAAFM/dixBEFMr-90/photo.jpg?sz=128", "display_name": "RamJet", "link": "https://stackoverflow.com/users/7197373/ramjet"}, "edited": false, "score": 0, "creation_date": 1497412503, "post_id": 44534348, "comment_id": 76061305, "body": "I have ruby 1.9.3. chunk_while doesn&#39;t work with that version of ruby. Any suggestions?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 283, "user_id": 7197373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-8cxs3f-Mnnc/AAAAAAAAAAI/AAAAAAAAAFM/dixBEFMr-90/photo.jpg?sz=128", "display_name": "RamJet", "link": "https://stackoverflow.com/users/7197373/ramjet"}, "edited": false, "score": 0, "creation_date": 1497415568, "post_id": 44534348, "comment_id": 76062277, "body": "@RamJet Go with Cary&#39;s answer:) Looks good."}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 3, "last_activity_date": 1497410028, "last_edit_date": 1497410028, "creation_date": 1497406754, "answer_id": 44534348, "question_id": 44534153, "link": "https://stackoverflow.com/questions/44534153/create-a-new-array-based-on-a-relationship-between-elements-in-an-existing-array/44534348#44534348", "title": "Create a new array based on a relationship between elements in an existing array in ruby", "body": "<p>You can use <code>chunk_while</code>. It 'chunks' adjacent elements if they differ by <code>1</code> (using the test @Sebasti\u00e1nPalma has but with <code>abs</code>). See <a href=\"http://ruby-docs.org\" rel=\"nofollow noreferrer\">Ruby documentation</a> for more information about these methods.</p>\n\n<pre><code>a.chunk_while { |x,y| (x-y).abs == 1 }.select{ |a| a.size &gt; 1 }.map(&amp;:sum)\n#=&gt; [3, 21]\n</code></pre>\n\n<p>Note: <a href=\"http://ruby-doc.org/core-2.4.1/Array.html#method-i-sum\" rel=\"nofollow noreferrer\"><code>Array#sum</code></a> can only be used in Ruby >= 2.4. Use <code>inject(&amp;:+)</code> otherwise:</p>\n\n<pre><code>a.chunk_while {|x,y| (x-y).abs == 1 }.select{|a| a.size &gt; 1}.map {|a| a.inject(&amp;:+)}\n</code></pre>\n\n<h3>Steps</h3>\n\n<pre><code>a.chunk_while {|x,y| (x-y).abs == 1 }  #actually returns an enumerator.\n#=&gt; [[1, 2], [6], [10, 11]]\n\na.chunk_while {|x,y| (x-y).abs == 1 }.select{|a| a.size &gt; 1}\n#=&gt; [[1, 2], [10, 11]]\n\na.chunk_while {|x,y| (x-y).abs == 1 }.select{|a| a.size &gt; 1}.map(&amp;:sum)\n#=&gt; [3, 21]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4320, "user_id": 5103620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8ae06ea53a316cc879b9100b3ff25bfc?s=128&d=identicon&r=PG", "display_name": "Sebastian Lenartowicz", "link": "https://stackoverflow.com/users/5103620/sebastian-lenartowicz"}, "edited": false, "score": 0, "creation_date": 1497448386, "post_id": 44535079, "comment_id": 76084188, "body": "When you write an answer, you should also include some indication of what the code <i>does</i>. Otherwise, it&#39;s up to a (potentially novice) reader to try and decipher it, which isn&#39;t terribly useful."}, {"owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "reply_to_user": {"reputation": 4320, "user_id": 5103620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8ae06ea53a316cc879b9100b3ff25bfc?s=128&d=identicon&r=PG", "display_name": "Sebastian Lenartowicz", "link": "https://stackoverflow.com/users/5103620/sebastian-lenartowicz"}, "edited": false, "score": 0, "creation_date": 1497453630, "post_id": 44535079, "comment_id": 76088169, "body": "thanks, updated answer with description."}], "tags": [], "owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "is_accepted": false, "score": 1, "last_activity_date": 1497453239, "last_edit_date": 1497453239, "creation_date": 1497412136, "answer_id": 44535079, "question_id": 44534153, "link": "https://stackoverflow.com/questions/44534153/create-a-new-array-based-on-a-relationship-between-elements-in-an-existing-array/44535079#44535079", "title": "Create a new array based on a relationship between elements in an existing array in ruby", "body": "<p>iterate through each element, initialize var 'sum' to elem if sum is nil. When difference between elem and next is one, add next elem to sum and store in sum, increment seq so we know there was at-least one with diff as 1. </p>\n\n<p>Do this until the diff b/t elem and next is not 1, when diff is not 1 push the sum to res array if seq > 0 and reset sum to nil and seq to 0. This only takes O(n).</p>\n\n<pre><code>a.each_with_object([]).with_index do |(x, res), i|\n     sum ||= x \n     if a[i+1] &amp;&amp; (x - a[i+1]).abs == 1 \n       seq += 1\n       sum += a[i+1]\n     else\n       res &lt;&lt; sum if seq &gt; 0\n       sum = nil\n       seq = 0\n     end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 283, "user_id": 7197373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-8cxs3f-Mnnc/AAAAAAAAAAI/AAAAAAAAAFM/dixBEFMr-90/photo.jpg?sz=128", "display_name": "RamJet", "link": "https://stackoverflow.com/users/7197373/ramjet"}, "edited": false, "score": 0, "creation_date": 1497417654, "post_id": 44535398, "comment_id": 76063019, "body": "That&#39;s a clever answer for Ruby v1.9+. I should point out that Sebasti&#225;n Palma answer works with Ruby 2.2+ and sagarpandya82 answer works with Ruby 2.4.1+"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1497416572, "last_edit_date": 1497416572, "creation_date": 1497414313, "answer_id": 44535398, "question_id": 44534153, "link": "https://stackoverflow.com/questions/44534153/create-a-new-array-based-on-a-relationship-between-elements-in-an-existing-array/44535398#44535398", "title": "Create a new array based on a relationship between elements in an existing array in ruby", "body": "<p>This will work with Ruby v1.9+.</p>\n\n<pre><code>arr = [1, 2, 6, 6, 10, 11, 12]\n\narr.drop(1).\n    each_with_object([[arr.first]]) { |n,a| (a.last.last - n).abs == 1 ?\n      a.last.push(n) : a.push([n]) }.\n    reject { |a| a.size == 1 }.\n    map(&amp;:sum)\n  #=&gt; [3, 33]\n</code></pre>\n\n<p>Here's a variant that allows us to skip the step <code>reject { |a| a.size == 1 }</code>. (I thought this might be of interest even though I don't think I'd advocate it.)</p>\n\n<pre><code>e = (arr + [Float::INFINITY]).to_enum\na = [[e.next]]\nloop do\n  n = e.next\n  (a.last.last-n).abs==1 ? a.last.push(n) : (a.push([n]) if (n-e.peek).abs==1)\nend\na.map(&amp;:sum)\n  #=&gt; [3, 33]\n</code></pre>\n\n<p>When the iterator is at the end and <code>n #=&gt; Float::INFINITY</code>, <code>e.peek</code> raises a <code>StopIteration</code> exception which <a href=\"http://ruby-doc.org/core-2.4.0/Kernel.html#method-i-loop\" rel=\"nofollow noreferrer\">Kernel#loop</a> handles by breaking out of the loop.</p>\n"}], "owner": {"reputation": 283, "user_id": 7197373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-8cxs3f-Mnnc/AAAAAAAAAAI/AAAAAAAAAFM/dixBEFMr-90/photo.jpg?sz=128", "display_name": "RamJet", "link": "https://stackoverflow.com/users/7197373/ramjet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "closed_date": 1497434448, "accepted_answer_id": 44535398, "answer_count": 4, "score": -1, "last_activity_date": 1499749047, "creation_date": 1497405093, "last_edit_date": 1499749047, "question_id": 44534153, "link": "https://stackoverflow.com/questions/44534153/create-a-new-array-based-on-a-relationship-between-elements-in-an-existing-array", "closed_reason": "Not suitable for this site", "title": "Create a new array based on a relationship between elements in an existing array in ruby", "body": "<p>I have the following array:</p>\n\n<pre><code>a = [1, 2, 6, 10, 11]\n</code></pre>\n\n<p>and I want to return a new array <code>b</code> that consists of the sums of adjacent elements that differ by one. In this case, the returned array would be:</p>\n\n<pre><code>b = [3, 21]\n</code></pre>\n\n<p>i.e. <code>a[0]</code> and <code>a[1]</code> differ by one, so sum them and add <code>3</code> to <code>b</code>. </p>\n\n<p><code>a[3]</code> and <code>a[4]</code> differ by one, so sum them and add <code>21</code> to <code>b</code>.</p>\n\n<p>Update</p>\n\n<p>I've made a mistake:</p>\n\n<pre><code>a = [1, 2, 6, 10, 11, 12]\n</code></pre>\n\n<p>It should return:</p>\n\n<pre><code>b = [3, 33]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rbenv"], "answers": [{"comments": [{"owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "edited": false, "score": 0, "creation_date": 1497402507, "post_id": 44533799, "comment_id": 76059030, "body": "You answered like 13 seconds earlier to me ;)"}, {"owner": {"reputation": 710, "user_id": 7551699, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/01X66.jpg?s=128&g=1", "display_name": "Belder", "link": "https://stackoverflow.com/users/7551699/belder"}, "edited": false, "score": 0, "creation_date": 1497402921, "post_id": 44533799, "comment_id": 76059109, "body": "Ok...great, and thanks for the response.  I guess my only confusion now is that I don&#39;t seem to have a file named <code>.ruby_version</code> in my project directory.  Where would I find this and might it be named something else?"}, {"owner": {"reputation": 34077, "user_id": 1249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ed9686d6910478914966ec99bbcaa069?s=128&d=identicon&r=PG", "display_name": "Adam Lassek", "link": "https://stackoverflow.com/users/1249/adam-lassek"}, "edited": false, "score": 0, "creation_date": 1497403802, "post_id": 44533799, "comment_id": 76059288, "body": "That&#39;s <code>.ruby-version</code> not <code>.ruby_version</code>"}], "tags": [], "owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "is_accepted": false, "score": 2, "last_activity_date": 1497833282, "last_edit_date": 1497833282, "creation_date": 1497402366, "answer_id": 44533799, "question_id": 44533717, "link": "https://stackoverflow.com/questions/44533717/understanding-rbenv-switching-ruby-versions-locally/44533799#44533799", "title": "Understanding RBENV: Switching Ruby Versions Locally", "body": "<p><code>$ rbenv local 2.3.1</code> will do exactly as you surmised. The project specific version of Ruby is set via a <code>.ruby-version</code> file in the project directory. This setting takes precedence over any use of <code>rbenv global</code> that would set the Ruby version where otherwise unspecified.</p>\n"}, {"comments": [{"owner": {"reputation": 710, "user_id": 7551699, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/01X66.jpg?s=128&g=1", "display_name": "Belder", "link": "https://stackoverflow.com/users/7551699/belder"}, "edited": false, "score": 0, "creation_date": 1497403532, "post_id": 44533803, "comment_id": 76059216, "body": "Ah, didn&#39;t notice your response...thank you.  As I commented to @MarsAtomic, I don&#39;t seem to have a file named <code>.ruby_version</code>.  I&#39;m wondering why I wouldn&#39;t have that in my project?"}, {"owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "reply_to_user": {"reputation": 710, "user_id": 7551699, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/01X66.jpg?s=128&g=1", "display_name": "Belder", "link": "https://stackoverflow.com/users/7551699/belder"}, "edited": false, "score": 1, "creation_date": 1497403702, "post_id": 44533803, "comment_id": 76059261, "body": "Well, if you don&#39;t find it, just create one in the same hierarchy as .git :) and the content of the file should be the version of the ruby the project is using @BrandonElder"}], "tags": [], "owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "is_accepted": false, "score": 1, "last_activity_date": 1497402379, "creation_date": 1497402379, "answer_id": 44533803, "question_id": 44533717, "link": "https://stackoverflow.com/questions/44533717/understanding-rbenv-switching-ruby-versions-locally/44533803#44533803", "title": "Understanding RBENV: Switching Ruby Versions Locally", "body": "<p><strong>Rbenv uses a file .ruby-version to detect the ruby version project is using</strong>. So are you having that file?</p>\n\n<p>Based on the version of the ruby your project uses, just write a number in your file.</p>\n\n<p>example: <code>2.3.0</code></p>\n"}, {"comments": [{"owner": {"reputation": 710, "user_id": 7551699, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/01X66.jpg?s=128&g=1", "display_name": "Belder", "link": "https://stackoverflow.com/users/7551699/belder"}, "edited": false, "score": 0, "creation_date": 1497403810, "post_id": 44533954, "comment_id": 76059291, "body": "Ahh... that explains it!  So not necessarily necessary when switching versions.  Is it good practice to keep track &amp; use the latest patchlevels when switching versions then?  Thanks Adam."}, {"owner": {"reputation": 34077, "user_id": 1249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ed9686d6910478914966ec99bbcaa069?s=128&d=identicon&r=PG", "display_name": "Adam Lassek", "link": "https://stackoverflow.com/users/1249/adam-lassek"}, "reply_to_user": {"reputation": 710, "user_id": 7551699, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/01X66.jpg?s=128&g=1", "display_name": "Belder", "link": "https://stackoverflow.com/users/7551699/belder"}, "edited": false, "score": 0, "creation_date": 1497404260, "post_id": 44533954, "comment_id": 76059383, "body": "@BrandonElder generally you want to target a <code>MINOR</code> version, e.g. <code>2.3</code>, and then there is usually some wiggle room with the <code>TEENY</code> version. Some production environments are more strict, so YMMV. If in doubt, choose whatever version is running in production. Since the policy change for 2.1 I linked, you won&#39;t see a separate patchlevel number in a release."}], "tags": [], "owner": {"reputation": 34077, "user_id": 1249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ed9686d6910478914966ec99bbcaa069?s=128&d=identicon&r=PG", "display_name": "Adam Lassek", "link": "https://stackoverflow.com/users/1249/adam-lassek"}, "is_accepted": true, "score": 1, "last_activity_date": 1497404599, "last_edit_date": 1497404599, "creation_date": 1497403607, "answer_id": 44533954, "question_id": 44533717, "link": "https://stackoverflow.com/questions/44533717/understanding-rbenv-switching-ruby-versions-locally/44533954#44533954", "title": "Understanding RBENV: Switching Ruby Versions Locally", "body": "<p>To answer your other question,</p>\n\n<blockquote>\n  <p>Rbenv's github page uses <code>$ rbenv local 1.9.3-p327</code> as an example command of how to do this. What I want to know is what the <code>-p327</code> refers to...</p>\n</blockquote>\n\n<p>The old versioning policy for Ruby was <code>MAJOR</code>.<code>MINOR</code>.<code>TEENY</code>-<code>PATCH</code></p>\n\n<p><code>p327</code> simply refers to patchlevel, which is basically a number that gets incremented for each accepted patch after the increment of a <code>MINOR</code> number. <a href=\"https://www.ruby-lang.org/en/news/2013/12/21/ruby-version-policy-changes-with-2-1-0/\" rel=\"nofollow noreferrer\">Prior to Ruby 2.1</a>, security fixes did not increment the <code>TEENY</code> version, so some releases specify the patchlevel.</p>\n"}], "owner": {"reputation": 710, "user_id": 7551699, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/01X66.jpg?s=128&g=1", "display_name": "Belder", "link": "https://stackoverflow.com/users/7551699/belder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 44533954, "answer_count": 3, "score": 1, "last_activity_date": 1497833282, "creation_date": 1497401596, "question_id": 44533717, "link": "https://stackoverflow.com/questions/44533717/understanding-rbenv-switching-ruby-versions-locally", "title": "Understanding RBENV: Switching Ruby Versions Locally", "body": "<p>After upgrading my Ruby version, I've (as expected) run in to some trouble getting my server up and running with older projects. I'm curious about how to switch Ruby versions locally for a specific project.  Rbenv's github page uses <code>$ rbenv local 1.9.3-p327</code>as an example command of how to do this.  What I want to know is what the <code>-p327</code> refers to, what it should be in my case, and if it's even necessary.  Can I just run <code>$ rbenv local 2.3.1</code> for example?</p>\n\n<p>(In my case, I am currently using Ruby -v 2.4.0 want to go back to an earlier version to avoid a Devise Gem error that I can't seem to get past.)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497398948, "post_id": 44533382, "comment_id": 76058298, "body": "What happened when you tried using <code>dig</code>? Can you guarantee the &quot;resq&quot; array will always be in that order?"}, {"owner": {"reputation": 82, "user_id": 7407963, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3e73972f9df8fd02cea426c6b6d582d8?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Silson", "link": "https://stackoverflow.com/users/7407963/ron-silson"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497399120, "post_id": 44533382, "comment_id": 76058336, "body": "Yes, I can. <code>dig</code> doesn&#39;t seem to play well with embedded hashes with arrays... I couldn&#39;t figure out the correct format."}, {"owner": {"reputation": 82, "user_id": 7407963, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3e73972f9df8fd02cea426c6b6d582d8?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Silson", "link": "https://stackoverflow.com/users/7407963/ron-silson"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497399470, "post_id": 44533382, "comment_id": 76058420, "body": "Any suggestions? @theTinMan"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1497399769, "post_id": 44533382, "comment_id": 76058494, "body": "If you know it&#39;s always in that order, then <code>hash_v[&#39;brand&#39;].first[&#39;resq&#39;].first[&#39;error_body&#39;] # =&gt; [{&quot;message&quot;=&gt;[&quot;Error&quot;]}]</code>. <code>map</code> is the wrong tool for this. The data structure isn&#39;t very clean. Every hash value is an array containing something else. If you&#39;re generating it I&#39;d recommend rethinking it as it&#39;s not clean."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497399877, "post_id": 44533507, "comment_id": 76058513, "body": "Show how it works. Hint: <code>hash_v.keys.include?(&quot;error_body&quot;) # =&gt; false</code>"}, {"owner": {"reputation": 584, "user_id": 7159326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3bce136965a79ceb3a45f93bdbac3c?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane El Kesri", "link": "https://stackoverflow.com/users/7159326/othmane-el-kesri"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497414120, "post_id": 44533507, "comment_id": 76061787, "body": "I updated my answer. Sorry, i misunderstood the question"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497460490, "post_id": 44533507, "comment_id": 76092289, "body": "Converting to a string could yield false positives if <code>to_s[&quot;error_body&quot;]</code> matched on a sub-string. You could use <code>&#47;\\berror_body\\b&#47;</code> to match whole-words... but it could also then match inside a string value that happened to exist somewhere else in the hash. There are ifs to all that, but determining whether the key exists needs to be accurate. <code>dig</code> is probably a better idea as long as the order of the hashes and arrays are consistent."}], "tags": [], "owner": {"reputation": 584, "user_id": 7159326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3bce136965a79ceb3a45f93bdbac3c?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane El Kesri", "link": "https://stackoverflow.com/users/7159326/othmane-el-kesri"}, "is_accepted": false, "score": -1, "last_activity_date": 1497460587, "last_edit_date": 1497460587, "creation_date": 1497399830, "answer_id": 44533507, "question_id": 44533382, "link": "https://stackoverflow.com/questions/44533382/cleanest-way-to-check-if-a-key-exists-on-an-embedded-hash-inside-an-embedded-arr/44533507#44533507", "title": "Cleanest way to check if a key exists on an embedded hash inside an embedded array", "body": "<p>I'm not sure if using <code>dig</code> is the cleanest way to check if a key exists on an embedded hashes with arrays, but this solution may work :</p>\n\n<pre><code> hash_v.dig(\"brand\", 0, \"resq\", 0, \"error_body\")\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 7407963, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3e73972f9df8fd02cea426c6b6d582d8?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Silson", "link": "https://stackoverflow.com/users/7407963/ron-silson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497460587, "creation_date": 1497398841, "question_id": 44533382, "link": "https://stackoverflow.com/questions/44533382/cleanest-way-to-check-if-a-key-exists-on-an-embedded-hash-inside-an-embedded-arr", "title": "Cleanest way to check if a key exists on an embedded hash inside an embedded array", "body": "<p>I'm trying to figure out a good way to find whether or not an <code>error_body</code> is present on the <code>resq</code> in this hash.</p>\n\n<pre><code>hash_v = {\"brand\"=&gt;[{ \"model_id\"=&gt;[\"1\"], \"resq\"=&gt;[{\"error_body\"=&gt;[{\"message\"=&gt;[\"Error\"]}]}]}]}\n</code></pre>\n\n<p>This is the cleanest way that I've seen so far, but I'm wondering if there's a better way, perhaps by using <code>dig</code>, to make this a bit cleaner.</p>\n\n<pre><code>hash_v['brand'].map { |m| m['resq'].first['error_body'] }\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1497397963, "post_id": 44533252, "comment_id": 76058080, "body": "See &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. Well, we can&#39;t help very well because we don&#39;t have visibility into your disk and you didn&#39;t tell us enough. Have you checked to see if the &quot;csv&quot; directory exists? Do you have permissions to write and create files in that directory? Reduce your code in the question to the bare minimum necessary to demonstrate the problem. Odds are good that means it&#39;s only the <code>open</code> statement."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497398835, "post_id": 44533252, "comment_id": 76058275, "body": "As written, the code <i>should</i> create &quot;file.csv&quot; in the &quot;csv&quot; sub-directory of the local directory. If &quot;csv&quot; doesn&#39;t exist it won&#39;t be created and the code will fail with a message like you&#39;re getting. I&#39;d recommend using the block form of <code>open</code> so that it&#39;ll automatically close the file after the block exits. And, as displayed, the code will fail because there is an extra trailing <code>end</code> statement. Fix that as it&#39;s a syntax error and is cause for closing the question."}, {"owner": {"reputation": 21, "user_id": 6763176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19641cabaaa86879cb096a806a6f668c?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Bariak", "link": "https://stackoverflow.com/users/6763176/martin-bariak"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1497462378, "post_id": 44533252, "comment_id": 76093444, "body": "Fixed the problem, there was just inattention of mine (folder that should be called csv was called cvs). Thanks for your replies."}], "owner": {"reputation": 21, "user_id": 6763176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19641cabaaa86879cb096a806a6f668c?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Bariak", "link": "https://stackoverflow.com/users/6763176/martin-bariak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 345, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497398608, "creation_date": 1497397698, "last_edit_date": 1497398608, "question_id": 44533252, "link": "https://stackoverflow.com/questions/44533252/ruby-script-cant-find-csv-file", "title": "Ruby script can&#39;t find CSV file", "body": "<p>I have a simple crawler written in Ruby that should crawl specific sites and save data into a CSV file, but, when running it from the Windows command line I get this error:</p>\n\n<pre><code>C:/Ruby24-x64/lib/ruby/2.4.0/csv.rb:1282:in `initialize': No such file or directory @ rb_sysopen - csv/boxers.csv (Errno::ENOENT)\n    from C:/Ruby24-x64/lib/ruby/2.4.0/csv.rb:1282:in `open'\n    from C:/Ruby24-x64/lib/ruby/2.4.0/csv.rb:1282:in `open'\n    from boxers.rb:18:in `&lt;main&gt;'\n</code></pre>\n\n<p>This is the script:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'csv'\nrequire 'mechanize'\n\nagent = Mechanize.new{ |agent| agent.history.max_size=0 }\nagent.user_agent = 'Mozilla/5.0'\n\nbase = \"http://baseurl.com/\"\n\ndivision = ARGV[0]\n\nsearch_url = \"http://baseurl.com/ratings.php?sex=M&amp;division=#{division}&amp;pageID=\"\n\npath='//*[@id=\"mainContent\"]/table/tr[position()&gt;2]'\n\nboxers = CSV.open(\"csv/file.csv\",\"w\")\n\nurl = search_url+\"1\"\n\nbegin\n  page = agent.get(url)\nrescue\n  print \"  -&gt; error, retrying\\n\"\n  retry\nend\n\n\nend\n\nboxers.close\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1497400075, "post_id": 44533518, "comment_id": 76058569, "body": "The authenticity token is not in the generated HTML. <code>protect_from_forgery</code> is located in application_controller.rb as I stated in the question. I tried adding <code>prepend: true</code> but it had no effect. In other words, thanks but this didn&#39;t work."}], "tags": [], "owner": {"reputation": 82, "user_id": 7407963, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3e73972f9df8fd02cea426c6b6d582d8?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Silson", "link": "https://stackoverflow.com/users/7407963/ron-silson"}, "is_accepted": false, "score": 0, "last_activity_date": 1497399916, "creation_date": 1497399916, "answer_id": 44533518, "question_id": 44533177, "link": "https://stackoverflow.com/questions/44533177/shouldnt-protect-from-forgery-with-exception-raise-an-error-if-i-dont-includ/44533518#44533518", "title": "Shouldn&#39;t protect_from_forgery with: :exception raise an error if I don&#39;t include an authenticity token?", "body": "<p>Is the authenticity token present on your form when you inspect it? Which point is <code>protect_from_forgery</code> inserted in your application?</p>\n\n<p>Rails 4=>5 changed the default behaviour to be inserted wherever in the chain it is called, opposed to the previous where it was called first. If you want it to be called before any other action, try using the <code>prepend: true</code> flag.</p>\n"}, {"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1497423187, "post_id": 44537005, "comment_id": 76065742, "body": "thanks very much for the detailed answer. Unfortunately, the <code>prepend: true</code> simply has no effects. I will have to mess with it a bit more."}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1497421506, "creation_date": 1497421506, "answer_id": 44537005, "question_id": 44533177, "link": "https://stackoverflow.com/questions/44533177/shouldnt-protect-from-forgery-with-exception-raise-an-error-if-i-dont-includ/44537005#44537005", "title": "Shouldn&#39;t protect_from_forgery with: :exception raise an error if I don&#39;t include an authenticity token?", "body": "<p>I believe it is something to do with the <strong><em>Rails 5</strong> changed the <code>protect_from_forgery</code> execution order</em>. From this <a href=\"http://blog.bigbinary.com/2016/04/06/rails-5-default-protect-from-forgery-prepend-false.html\" rel=\"nofollow noreferrer\"><em>blog</em></a></p>\n\n<p><strong>What</strong></p>\n\n<p>If we generate a brand new Rails application in <em>Rails 4.x</em> then <code>application_controller</code> will look like this.</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\nend\n</code></pre>\n\n<p>Looking it at the code it does not look like <code>protect_from_forgery</code> is a <code>before_action</code> call but in reality that\u2019s what it is. Since protect_from_forgery is a before_action call it should follow the order of how other <code>before_action</code> are executed. But this one is special in the sense that <code>protect_from_forgery</code> is executed first in the series of <code>before_action</code> no matter where <code>protect_from_forgery</code> is mentioned. Let\u2019s see an example.</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  before_action :load_user\n  protect_from_forgery with: :exception\nend\n</code></pre>\n\n<p>In the above case even though protect_from_forgery call is made after <code>load_user</code>, the protection execution happens first. And we can\u2019t do anything about it. We can\u2019t pass any option to stop Rails from doing this.</p>\n\n<p><strong><em>Rails 5</strong> changes this behavior by introducing a boolean option called prepend</em>. Default value of this option is <code>false</code>. What it means is, now <code>protect_from_forgery</code> gets executed in order of call. Of course, this can be overridden by passing <code>prepend: true</code> as shown below and now protection call will happen first just like <em>Rails 4.x</em>.</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  before_action :load_user\n  protect_from_forgery with: :exception, prepend: true\nend\n</code></pre>\n\n<p><strong>Why</strong></p>\n\n<p><em>There isn\u2019t any real advantage in forcing <code>protect_from_forgery</code> to be the first filter in the chain of filters to be executed</em>. On the flip side, there are cases where output of other <code>before_action</code> should decide the execution of <code>protect_from_forgery</code>. Let\u2019s see an example.</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  before_action :authenticate\n  protect_from_forgery unless: -&gt; { @authenticated_by.oauth? }\n\n  private\n    def authenticate\n      if oauth_request?\n        # authenticate with oauth\n        @authenticated_by = 'oauth'.inquiry\n      else\n        # authenticate with cookies\n        @authenticated_by = 'cookie'.inquiry\n      end\n    end\nend\n</code></pre>\n\n<p>Above code would fail in <em>Rails 4.x</em>, as <code>protect_from_forgery</code>, though called after <code>:authenticate</code>, actually gets executed before it. Due to which we would not have <code>@authenticated_by</code> set properly.</p>\n\n<p>Whereas in <strong><em>Rails 5</em></strong>, <code>protect_from_forgery</code> gets executed after <code>:authenticate</code> and gets skipped if authentication is oauth</p>\n"}], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 44537005, "answer_count": 2, "score": 1, "last_activity_date": 1497421506, "creation_date": 1497397006, "question_id": 44533177, "link": "https://stackoverflow.com/questions/44533177/shouldnt-protect-from-forgery-with-exception-raise-an-error-if-i-dont-includ", "title": "Shouldn&#39;t protect_from_forgery with: :exception raise an error if I don&#39;t include an authenticity token?", "body": "<p>It's my understanding that <code>protect_from_forgery with: :exception</code> which is the default in Rails, will cause an error if forms are submitted and they don't have the <code>authenticity_token</code> input.</p>\n\n<p>However it seems like this is not the case anymore. This is a Rails 5 app, and I've mostly done Rails 4 in the past, so I wonder if something has changed.</p>\n\n<p>In application_controller.rb I have <code>protect_from_forgery with: :exception</code></p>\n\n<p>My form is like this (using slim)</p>\n\n<pre><code>form#spreadsheet-form{\n  action='/submit_spreadsheet'\n}\n  textarea.spreadsheet-input{\n    name='instructions'\n    style=\"width: 200px; height: 200px\"\n  }\n  br\n  input.spreadsheet-submit{\n    type=\"submit\"\n    value=\"submit\"\n  }\n</code></pre>\n\n<p>The main issue in my eyes is why this doesn't raise an error. In the past I've had to include a hidden input with <code>form_authencicity_token</code> as the value. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 1, "creation_date": 1497393797, "post_id": 44532583, "comment_id": 76057060, "body": "your seeds are wrong. One of the things you can do is to fix <code>band_data </code> and <code>musician_data</code> arrays to contain hashes instead of arrays. For instance <code>band_data = [{name:&quot;band 1&quot;, description: &quot;band 1 description&quot;},..</code> and in your loop: <code>band_data.each{|data| Band.create(name: data[:name], description: data[:desc])}</code>. And do the same for <code>music_data</code> array."}, {"owner": {"reputation": 133, "user_id": 6942042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed8e144a7cd109e2e2aac75a7140080d?s=128&d=identicon&r=PG&f=1", "display_name": "FigletNewton", "link": "https://stackoverflow.com/users/6942042/figletnewton"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1497393873, "post_id": 44532583, "comment_id": 76057080, "body": "You&#39;re right, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 34077, "user_id": 1249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ed9686d6910478914966ec99bbcaa069?s=128&d=identicon&r=PG", "display_name": "Adam Lassek", "link": "https://stackoverflow.com/users/1249/adam-lassek"}, "is_accepted": true, "score": 1, "last_activity_date": 1497395781, "last_edit_date": 1497395781, "creation_date": 1497395466, "answer_id": 44532975, "question_id": 44532583, "link": "https://stackoverflow.com/questions/44532583/outputting-object-attributes-in-ruby-on-rails-view/44532975#44532975", "title": "Outputting object attributes in Ruby on Rails view", "body": "<p>Because you are using <code>key: value</code> syntax inside square brackets, Ruby is assuming you want a hash inside an array. There are many situations where curly brackets can be left out and Ruby will parse it as a hash anyway.</p>\n\n<p>Also, you can pass an array of attribute to <code>Model::create</code> and it will create multiple rows at once. Usually not that useful, except for seed data.</p>\n\n<pre><code>Band.create [{name:\"band 1\", description: \"band 1 description\"},\n             {name:\"band 2\", description: \"band 2 description\"},\n             {name:\"band 3\", description: \"band 3 description\"},\n             {name:\"band 4\", description: \"band 4 description\"}]\n\nMusician.create [{name:\"musician 1\", instrument:\"instrument 1\"},\n                 {name:\"musician 2\", instrument:\"instrument 2\"},\n                 {name:\"musician 3\", instrument:\"instrument 3\"},\n                 {name:\"musician 4\", instrument:\"instrument 4\"},\n                 {name:\"musician 5\", instrument:\"instrument 1\"},\n                 {name:\"musician 6\", instrument:\"instrument 5\"},\n                 {name:\"musician 7\", instrument:\"instrument 1\"},\n                 {name:\"musician 8\", instrument:\"instrument 2\"},\n                 {name:\"musician 9\", instrument:\"instrument 3\"},\n                 {name:\"musician 10\", instrument:\"instrument 1\"},\n                 {name:\"musician 11\", instrument:\"instrument 4\"},\n                 {name:\"musician 12\", instrument:\"instrument 1\"},\n                 {name:\"musician 13\", instrument:\"instrument 2\"}]\n</code></pre>\n\n<p>So the answer is that you are actually rendering the view correctly, it was the seed data that was getting messed up.</p>\n\n<p>If you get confused about why something is being rendered a particular way, an easy way to debug this is drop a <code>&lt;% console %&gt;</code> into the view and Rails will give you an interactive console at that location when it executes, allowing you to directly inspect the runtime environment.</p>\n"}], "owner": {"reputation": 133, "user_id": 6942042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed8e144a7cd109e2e2aac75a7140080d?s=128&d=identicon&r=PG&f=1", "display_name": "FigletNewton", "link": "https://stackoverflow.com/users/6942042/figletnewton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 44532975, "answer_count": 1, "score": 1, "last_activity_date": 1497395781, "creation_date": 1497392878, "last_edit_date": 1497393662, "question_id": 44532583, "link": "https://stackoverflow.com/questions/44532583/outputting-object-attributes-in-ruby-on-rails-view", "title": "Outputting object attributes in Ruby on Rails view", "body": "<p>I'm creating a simple application to manage a database of bands and musicians in Rails, and I've been having an issue printing object attribute values in a view file. </p>\n\n<p>The models are Band, Musician, which are connected by a join table to make a HABTM relationship. Here is my schema file:</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20170613125004) do\n\n  create_table \"band_musicians\", force: :cascade do |t|\n    t.integer \"band_id\"\n    t.integer \"musician_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"band_id\"], name: \"index_band_musicians_on_band_id\"\n    t.index [\"musician_id\"], name: \"index_band_musicians_on_musician_id\"\n  end\n\n  create_table \"bands\", force: :cascade do |t|\n    t.string \"name\"\n    t.string \"description\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"musicians\", force: :cascade do |t|\n    t.string \"name\"\n    t.string \"instrument\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\nend\n</code></pre>\n\n<p>I then inserted some seed data using the following seeds.rb script, which seemed to work fine.</p>\n\n<pre><code>band_data = [[name:\"band 1\", description: \"band 1 description\"],\n             [name:\"band 2\", description: \"band 2 description\"],\n             [name:\"band 3\", description: \"band 3 description\"],\n             [name:\"band 4\", description: \"band 4 description\"]]\n\nmusician_data = [[name:\"musician 1\", instrument:\"instrument 1\"],\n                 [name:\"musician 2\", instrument:\"instrument 2\"],\n                 [name:\"musician 3\", instrument:\"instrument 3\"],\n                 [name:\"musician 4\", instrument:\"instrument 4\"],\n                 [name:\"musician 5\", instrument:\"instrument 1\"],\n                 [name:\"musician 6\", instrument:\"instrument 5\"],\n                 [name:\"musician 7\", instrument:\"instrument 1\"],\n                 [name:\"musician 8\", instrument:\"instrument 2\"],\n                 [name:\"musician 9\", instrument:\"instrument 3\"],\n                 [name:\"musician 10\", instrument:\"instrument 1\"],\n                 [name:\"musician 11\", instrument:\"instrument 4\"],\n                 [name:\"musician 12\", instrument:\"instrument 1\"],\n                 [name:\"musician 13\", instrument:\"instrument 2\"]]\n\nband_data.each{|name, desc| Band.create(name:name, description:desc)}\nmusician_data.each{|name, instr| Musician.create(name:name, instrument:instr)}\n\nbands = Band.all()\nmusicians = Musician.all()\n\nbands.each do |b|\n  r = Random.new\n  bandSize = r.rand(2..5)\n  bandSize.times do\n    m = r.rand(0...musicians.length)\n    b.band_musicians.create(musician_id: musicians[m].id)\n  end\nend\n</code></pre>\n\n<p>I then wanted to output the data to a view, so I created a Band controller:</p>\n\n<pre><code>class BandsController &lt; ApplicationController\n  def index\n    @band_data = Band.includes(:musicians).all\n    @musician_data = Musician.all\n  end\n</code></pre>\n\n<p>And this index.html.erb Band view:</p>\n\n<pre><code>&lt;% @band_data.each do |b| %&gt;\n    &lt;p&gt;\n      &lt;%= b.name %&gt;\n      &lt;br&gt;\n      &lt;%= b.description %&gt;\n    &lt;ul&gt;\n      &lt;% b.musicians.each do |m| %&gt;\n          &lt;li&gt;\n            &lt;%= m.name %&gt;\n          &lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;/ul&gt;\n    &lt;/p&gt;\n    &lt;hr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The database appears to have been seeded properly, but a Hash representation of each object is being output rather than the attribute values. \nThis is what I'm getting:</p>\n\n<pre><code>{:name=&gt;\"band 1\", :description=&gt;\"band 1 description\"} \n{:name=&gt;\"musician 12\", :instrument=&gt;\"instrument 1\"} \n{:name=&gt;\"musician 1\", :instrument=&gt;\"instrument 1\"} \n{:name=&gt;\"musician 10\", :instrument=&gt;\"instrument 1\"} \n</code></pre>\n\n<p>When I want something more like:</p>\n\n<pre><code>band 1\nband 1 description\n - musician 12\n - musician 1\n - musician 10\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["ruby", "python-3.x", "paramiko", "net-ssh"], "owner": {"reputation": 11, "user_id": 5875614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xp0ItlKsTms/AAAAAAAAAAI/AAAAAAAAABE/zI7V0tCupgI/photo.jpg?sz=128", "display_name": "Vansh Shah", "link": "https://stackoverflow.com/users/5875614/vansh-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 390, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1497397898, "creation_date": 1497391473, "last_edit_date": 1497397898, "question_id": 44532353, "link": "https://stackoverflow.com/questions/44532353/how-to-do-open-channel-in-python-paramiko", "title": "How to do open_channel in python paramiko?", "body": "<p>How to convert this ruby piece to python?</p>\n\n<pre><code>Net::SSH.start(machine, \"ubuntu\", {:keys =&gt; [ssh_key]}) do |ssh|\n  ssh.open_channel do |ch|\n    sent_cmd = false\n    ch.request_pty do |ch,success|\n      ch.exec( \"sudo su -\" ) do |ch, success|\n        raise \"fail\" if( !success )\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I have done this so far:</p>\n\n<pre><code>ssh_key1 = paramiko.RSAKey.from_private_key_file( ssh_key, 'r' )\n\n\nsession = paramiko.SSHClient()\nsession.set_missing_host_key_policy( paramiko.AutoAddPolicy() )\n\nsession.connect( machine, port = 22, username = 'ABC', pkey = ssh_key1 )\n</code></pre>\n\n<p><strong>How to do open.channel in python?</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "payment-gateway", "spree"], "owner": {"reputation": 123, "user_id": 8011165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bc5877d4b2dbd8aebd4d243abb3ec44?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro de Albuquerque", "link": "https://stackoverflow.com/users/8011165/pedro-de-albuquerque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1497471487, "creation_date": 1497391230, "last_edit_date": 1497471487, "question_id": 44532304, "link": "https://stackoverflow.com/questions/44532304/gateway-error-on-spree", "title": "Gateway Error on Spree", "body": "<p>I have just integrated the pagar.me gateway into the spree, I have already set the API and Encryption keys, however, whenever I try to make the payment, it does not complete and the following error occurs:</p>\n\n<p>Gateway Error<br>\n  ---! Ruby / object: ActiveMerchant :: Billing :: Response<br>\nParams<br>\n  Errors:<br>\n  - parameter_name: customer [name]<br>\n    Type: invalid_parameter<br>\n    Message: name is missing<br>\n  - parameter_name: customer [email]<br>\n    Type: invalid_parameter<br>\n    Message: email is missing<br>\n  - parameter_name: customer [document_number]<br>\n    Type: invalid_parameter<br>\n    Message: document number is missing<br>\n  - parameter_name: customer [address] [zipcode]<br>\n    Type: invalid_parameter<br>\n    Message: Zip code is missing<br>\n  - parameter_name: customer [address] [neighborhood]<br>\n    Type: invalid_parameter<br>\n    Message: neighborhood is missing<br>\n  - parameter_name: customer [address] [street]<br>\n    Type: invalid_parameter<br>\n    Message: street is missing<br>\n  - parameter_name: customer [address] [street_number]<br>\n    Type: invalid_parameter<br>\n    Message: street number is missing<br>\n  - parameter_name: customer [phone] [number]<br>\n    Type: invalid_parameter<br>\n    Message: phone number is missing<br>\n  - parameter_name: customer [phone] [ddd]<br>\n    Type: invalid_parameter<br>\n    Message: DDD is missing<br>\n  Url: \"/ transactions\"<br>\n  Method: post<br>\nMessage: name is missing<br>\nSuccess: false<br>\nTest: true<br>\nAuthorization:<br>\nFraud_review:<br>\nError_code: processing_error<br>\nEmv_authorization:<br>\nAvs_result:<br>\n  Code<br>\n  Message:<br>\n  Street_match:<br>\n  Postal_match:<br>\nCvv_result:<br>\n  Code<br>\n  Message:</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "is_accepted": false, "score": 2, "last_activity_date": 1497390572, "creation_date": 1497390572, "answer_id": 44532159, "question_id": 44532108, "link": "https://stackoverflow.com/questions/44532108/ruby-on-rails-display-model-column-names-as-part-of-a-table/44532159#44532159", "title": "Ruby on Rails display model column names as part of a table", "body": "<p>Try this:</p>\n\n<pre><code>&lt;% Terminology.column_names.each do |c| %&gt;\n&lt;th&gt; &lt;%= c.humanize %&gt; &lt;/th&gt; \n&lt;% end %&gt;\n</code></pre>\n\n<p>Check this related <a href=\"https://stackoverflow.com/a/7996827/6780663\">post</a></p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 4271788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0504576a2b37e74ecf470c308e1ac102?s=128&d=identicon&r=PG&f=1", "display_name": "jgolfman", "link": "https://stackoverflow.com/users/4271788/jgolfman"}, "edited": false, "score": 0, "creation_date": 1497390808, "post_id": 44532165, "comment_id": 76056039, "body": "This works, but now the array is still visible above the table, and in the HTML, it is in the same position as before. How do I get rid of this?"}, {"owner": {"reputation": 1258, "user_id": 1852651, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/rfKGa.jpg?s=128&g=1", "display_name": "Graham S.", "link": "https://stackoverflow.com/users/1852651/graham-s"}, "reply_to_user": {"reputation": 43, "user_id": 4271788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0504576a2b37e74ecf470c308e1ac102?s=128&d=identicon&r=PG&f=1", "display_name": "jgolfman", "link": "https://stackoverflow.com/users/4271788/jgolfman"}, "edited": false, "score": 0, "creation_date": 1497390884, "post_id": 44532165, "comment_id": 76056067, "body": "I edited my post probably before you tried again. Did you remove the <code>=</code> in <code>&lt;%= Terminology.column_names.each do |c| %&gt;</code>?"}, {"owner": {"reputation": 43, "user_id": 4271788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0504576a2b37e74ecf470c308e1ac102?s=128&d=identicon&r=PG&f=1", "display_name": "jgolfman", "link": "https://stackoverflow.com/users/4271788/jgolfman"}, "edited": false, "score": 0, "creation_date": 1497391076, "post_id": 44532165, "comment_id": 76056142, "body": "Thanks, I didn&#39;t realize there was a difference between the different tags. I thought the &lt;%= was just to open a script like in PHP."}, {"owner": {"reputation": 1258, "user_id": 1852651, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/rfKGa.jpg?s=128&g=1", "display_name": "Graham S.", "link": "https://stackoverflow.com/users/1852651/graham-s"}, "reply_to_user": {"reputation": 43, "user_id": 4271788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0504576a2b37e74ecf470c308e1ac102?s=128&d=identicon&r=PG&f=1", "display_name": "jgolfman", "link": "https://stackoverflow.com/users/4271788/jgolfman"}, "edited": false, "score": 0, "creation_date": 1497391262, "post_id": 44532165, "comment_id": 76056211, "body": "Glad I could help. And yes, in Rails, <code>&lt;%= some_var %&gt;</code> actually prints the value to the screen, whereas <code>&lt;% some_var %&gt;</code> will not. And actually, the new PHP syntax now optionally follows this pattern I believe with the same consequences <code>&lt;?= $some_var; ?&gt;</code> prints and <code>&lt;? $some_var; ?&gt;</code> does not."}], "tags": [], "owner": {"reputation": 1258, "user_id": 1852651, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/rfKGa.jpg?s=128&g=1", "display_name": "Graham S.", "link": "https://stackoverflow.com/users/1852651/graham-s"}, "is_accepted": true, "score": 4, "last_activity_date": 1497390616, "creation_date": 1497390616, "answer_id": 44532165, "question_id": 44532108, "link": "https://stackoverflow.com/questions/44532108/ruby-on-rails-display-model-column-names-as-part-of-a-table/44532165#44532165", "title": "Ruby on Rails display model column names as part of a table", "body": "<p>I believe your missing the <code>=</code> sign in <code>&lt;% c.humanize %&gt;</code>.</p>\n\n<p>Should be <code>&lt;%= c.humanize %&gt;</code>. The <code>=</code> will display the value.</p>\n\n<p>Also, you need to remove the <code>=</code> in <code>&lt;%= Terminology.column_names.each do |c| %&gt;</code>.</p>\n\n<p>That should be <code>&lt;% Terminology.column_names.each do |c| %&gt;</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 653, "user_id": 8036445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb5ed1c3c2b3b03d10f179fb8f4078c?s=128&d=identicon&r=PG", "display_name": "Velusamy Venkatraman", "link": "https://stackoverflow.com/users/8036445/velusamy-venkatraman"}, "is_accepted": false, "score": 2, "last_activity_date": 1497438598, "creation_date": 1497438598, "answer_id": 44543100, "question_id": 44532108, "link": "https://stackoverflow.com/questions/44532108/ruby-on-rails-display-model-column-names-as-part-of-a-table/44543100#44543100", "title": "Ruby on Rails display model column names as part of a table", "body": "<p>Try This</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;table&gt;\r\n    &lt;tr&gt;\r\n        &lt;%@variable_name.column_names.each do |c| %&gt;\r\n        &lt;th&gt; &lt;%= c.humanize %&gt; &lt;/th&gt; \r\n        &lt;% end %&gt;\r\n    &lt;/tr&gt;\r\n&lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 43, "user_id": 4271788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0504576a2b37e74ecf470c308e1ac102?s=128&d=identicon&r=PG&f=1", "display_name": "jgolfman", "link": "https://stackoverflow.com/users/4271788/jgolfman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "accepted_answer_id": 44532165, "answer_count": 3, "score": 0, "last_activity_date": 1497438598, "creation_date": 1497390390, "question_id": 44532108, "link": "https://stackoverflow.com/questions/44532108/ruby-on-rails-display-model-column-names-as-part-of-a-table", "title": "Ruby on Rails display model column names as part of a table", "body": "<p>I am trying to display the columns of a model as part of a table that shows the results of a query. I want to do this dynamically with an each loop in Ruby. </p>\n\n<pre><code>&lt;table&gt;\n    &lt;tr&gt;\n        &lt;%= Terminology.column_names.each do |c| %&gt;\n        &lt;th&gt; &lt;% c.humanize %&gt; &lt;/th&gt; \n        &lt;% end %&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>When I display this, it shows 30 or so empty header tags, then the array of column names is put between the last header and the end of the row. What is going on here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497389990, "post_id": 44531981, "comment_id": 76055703, "body": "Creating three controllers sounds wrong if these are simply different records in the same table. Why not one controller with a parameter in the URL that leads to the right page?"}, {"owner": {"reputation": 41, "user_id": 8111621, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10203282189011761/picture?type=large", "display_name": "Shofi", "link": "https://stackoverflow.com/users/8111621/shofi"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497391499, "post_id": 44531981, "comment_id": 76056281, "body": "yeah but how can I choose a specific page while creating new post? Suppose I wants to add a new post which I wants to appear on &quot;Kids Bike&quot; page. how can I do that?"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497402399, "post_id": 44533552, "comment_id": 76059009, "body": "There&#39;s different schools of thinking here: Fat models and thin controllers versus thin models and fat controllers. Both are valid depending on your approach, so it&#39;s often a very subjective thing."}], "tags": [], "owner": {"reputation": 505, "user_id": 63516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0885ba9442ca4515dd4b235319278b8b?s=128&d=identicon&r=PG", "display_name": "tmarkiewicz", "link": "https://stackoverflow.com/users/63516/tmarkiewicz"}, "is_accepted": false, "score": 1, "last_activity_date": 1497400186, "creation_date": 1497400186, "answer_id": 44533552, "question_id": 44531981, "link": "https://stackoverflow.com/questions/44531981/choosing-controllers-as-post-category-in-rails/44533552#44533552", "title": "Choosing controllers as post category in rails", "body": "<p>To expand on the comments - you don't want three controllers. \"Bikes\", \"Kids Bike\" and \"Accessories\" all sound like types of products you're selling in the cycling store. These would all be categories of the products. So maybe a product model with a reference to categories. Categories would be a foreign key in your product model. Then each category would be in this reference table.</p>\n\n<p>You'd then have a products controller and this would take care of your standard REST actions for the model (in your case the various pages/posts you want to show). So each product's page would be managed by the products controller. If you then wanted to display all products that were \"Accessories\", there are a variety of ways you could handle this. </p>\n\n<p>To show all products in a category, you could either pass a category parameter and then filter your search in the show method to just return those products as mentioned by @tadman in the comments.</p>\n\n<p>Overall, albeit very over simplified, try to think of your controllers as actions and your models as the things. The controllers should not contain the business logic.</p>\n"}], "owner": {"reputation": 41, "user_id": 8111621, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10203282189011761/picture?type=large", "display_name": "Shofi", "link": "https://stackoverflow.com/users/8111621/shofi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497427962, "creation_date": 1497389815, "last_edit_date": 1497427962, "question_id": 44531981, "link": "https://stackoverflow.com/questions/44531981/choosing-controllers-as-post-category-in-rails", "title": "Choosing controllers as post category in rails", "body": "<p>I want to create my first rails app. I am creating a cycling store app where there will be 3 different pages. \"Bikes\", \"Kids Bike\" and \"Accessories\". My question is how can I choose one of these three category while creating a new post in my app. I was planning to create 3 different controllers called \"Bikes\", \"Kids Bike\" and \"Accessories\" and there will be a <code>f.select</code> syntax to select the controller but I am not sure if it's possible or not. Can someone please tell me if I can implement this idea or if there is any better way then please tell me. Thanks in advance. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "vue.js", "erb", "webpacker"], "comments": [{"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 1, "creation_date": 1497389146, "post_id": 44531746, "comment_id": 76055295, "body": "can you show us offending file&#39;s contents ?"}, {"owner": {"reputation": 21, "user_id": 8157061, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TXvcmK_NGww/AAAAAAAAAAI/AAAAAAAAA-s/ttyzZvXeARY/photo.jpg=k-s128", "display_name": "Yorch", "link": "https://stackoverflow.com/users/8157061/yorch"}, "reply_to_user": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 0, "creation_date": 1497397958, "post_id": 44531746, "comment_id": 76058079, "body": "yes shure the code is this"}, {"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 0, "creation_date": 1497437203, "post_id": 44531746, "comment_id": 76075518, "body": "the erb parser probably can&#39;t understand <code>&lt;template&gt;</code> but I don&#39;t know how to solve the problem, sorry"}], "owner": {"reputation": 21, "user_id": 8157061, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TXvcmK_NGww/AAAAAAAAAAI/AAAAAAAAA-s/ttyzZvXeARY/photo.jpg=k-s128", "display_name": "Yorch", "link": "https://stackoverflow.com/users/8157061/yorch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1497398217, "creation_date": 1497388775, "last_edit_date": 1497398217, "question_id": 44531746, "link": "https://stackoverflow.com/questions/44531746/trouble-with-erb-loader-is-not-working-with-vue-erb-files", "title": "trouble with erb-loader, is not working with .vue.erb files", "body": "<p>im working with vue and everything going great, but at the moment to compile with erb, the console shows me a error: </p>\n\n<pre><code>ERROR in ./app/javascript/packs/onboarding/HomeForm.vue.erb\nModule parse failed: /Users/yorch/SitesRails/homie/node_modules/rails-erb-\nloader/index.js??ref--3!/Users/yorch/SitesRails/homie/app/javascript/packs/onboarding/HomeForm.vue.erb \nUnexpected token (1:0)\nYou may need an appropriate loader to handle this file type.\n&lt;template&gt;\n&lt;div&gt;\n&lt;form action=\"/\" style=\"margin-top: 50px;\" @submit.prevent=\"login\"&gt;\nerror Command failed with exit code 2.\ninfo Visit https://yarnpkg.com/en/docs/cli/run for documentation about this \ncommand.\n</code></pre>\n\n<p>please, hope can help me! </p>\n\n<p>thanks</p>\n\n<pre><code>&lt;template&gt;\n&lt;div&gt;\n       &lt;form action=\"/\" style=\"margin-top: 50px;\" @submit.prevent=\"login\"&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;label for=\"name\"&gt;Name&lt;/label&gt;\n            &lt;input type=\"text\" class=\"form-control\" id=\"name\" v model=\"home.name\"&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;input type=\"submit\" class=\"btn btn-primary\" value=\"Login\"&gt;\n        &lt;/div&gt;\n\n        &lt;label&gt;{{greeting}}&lt;/label&gt;\n    &lt;/form&gt;\n\n&lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n   export default {\n    props: [\n        'user'\n    ],\n    data() {\n        return {\n            home: {\n                name: ''\n            },\n        }\n    },\n    computed: {\n        greeting() {\n            return `${this.home.name} ${this.user}`\n        }\n    },\n    methods: {\n        login() {\n            alert('login');\n        }\n    }\n}\n&lt;/script&gt;\n</code></pre>\n\n<p>this is the content of the file.\nat the moment only is html and plane js, but with erb extension the compile y not working</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497403797, "post_id": 44531548, "comment_id": 76059285, "body": "Whatever glade is, you probably need to install that as well."}, {"owner": {"reputation": 1, "user_id": 7655209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211059044407943/picture?type=large", "display_name": "Amr ElTayeb", "link": "https://stackoverflow.com/users/7655209/amr-eltayeb"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497455619, "post_id": 44531548, "comment_id": 76089515, "body": "It&#39;s already installed. I installed it as well as the gtk gem related to it."}], "owner": {"reputation": 1, "user_id": 7655209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211059044407943/picture?type=large", "display_name": "Amr ElTayeb", "link": "https://stackoverflow.com/users/7655209/amr-eltayeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497387853, "creation_date": 1497387853, "question_id": 44531548, "link": "https://stackoverflow.com/questions/44531548/cant-edit-the-glade-file-in-visual-ruby", "title": "Can&#39;t edit the glade file in visual ruby", "body": "<p>I've just installed visual ruby. When I create a new project called coinflip and try to edit the glade file the following message:</p>\n\n<pre><code>The following command couldn't run\nglade C:/Users/Asd/visualruby/coinflip/src/glade/MyClass.glade\nCheck the path in Tools &gt; Settings\nIn MS Windows you may need to add the 'start' command i.e. 'start glade'\n</code></pre>\n\n<p>When I opened the settings and changed the glade command line to 'start glade', the following window appeared:</p>\n\n<pre><code>Windows cannot find 'glade'. Make sure you typed the name correctly, and \nthen try again.\n</code></pre>\n\n<p>any help ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 1, "creation_date": 1497387058, "post_id": 44531274, "comment_id": 76054209, "body": "Apparently <code>params</code> does not contain <code>purchase</code> key. Can you show your logs? Also show the form that sends the parameters."}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1497387711, "post_id": 44531274, "comment_id": 76054593, "body": "Thans for the reply @Gerry.. please check out update 1 for more info."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 1, "creation_date": 1497387876, "post_id": 44531274, "comment_id": 76054663, "body": "You are just sending <code>&quot;payment_method_nonce&quot;=&gt;&quot;bf7458d2-d3a4-02c9-2593-526174f5082&zwnj;&#8203;2&quot;}</code> in your params, no <code>purchase</code>. Please share your form, the problem should be there."}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1497388420, "post_id": 44531274, "comment_id": 76054947, "body": "I updated again, providing more info"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1497388632, "post_id": 44531274, "comment_id": 76055049, "body": "By form i meant the <i>view</i> that sends the parameters to your controller, can you show it?"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1497388964, "post_id": 44531274, "comment_id": 76055218, "body": "@Gerry... Update 2 again, is this what you&#39;re looking for?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1497389355, "post_id": 44531274, "comment_id": 76055382, "body": "Doesn&#39;t seem to be any <code>purchase</code> params."}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1497389602, "post_id": 44531274, "comment_id": 76055512, "body": "@Dave Newton... do you mean inside the view?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1497392603, "post_id": 44531274, "comment_id": 76056706, "body": "I mean you&#39;re not sending any purchase params as shown by the params being logged. You&#39;re declaring then as required but not sending any."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1497392913, "post_id": 44531274, "comment_id": 76056819, "body": "@Theopap Yes, but i&#39;m not sure that&#39;s the correct form, are you using javascript to set the values to be sent?"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1497421822, "post_id": 44531274, "comment_id": 76065029, "body": "Yes, that is correct @Gerry!"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1497421931, "post_id": 44531274, "comment_id": 76065084, "body": "Can you update the question with that javascript code?"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497422838, "post_id": 44531274, "comment_id": 76065547, "body": "Sure @Pavan...I&#39;m using only this inside transactions.coffee $ -&gt;   unless typeof gon is &#39;undefined&#39;     braintree.setup(gon.client_token, &#39;dropin&#39;, { container: &#39;dropin&#39; });"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497422879, "post_id": 44531274, "comment_id": 76065570, "body": "To be more specific I used the following tutorial to implement braintree checkout: <a href=\"https://www.sitepoint.com/integrate-braintree-payments-rails/\" rel=\"nofollow noreferrer\">sitepoint.com/integrate-braintree-payments-rails</a>"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497422892, "post_id": 44531274, "comment_id": 76065578, "body": "Step 2: Initialize Braintree"}], "owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497388917, "creation_date": 1497386883, "last_edit_date": 1497388917, "question_id": 44531274, "link": "https://stackoverflow.com/questions/44531274/param-is-missing-or-the-value-is-empty-purchase", "title": "param is missing or the value is empty: purchase", "body": "<p>I'm trying to pass the following inside a def create method. The create method is in the transactions controller.</p>\n\n<pre><code>@purchases = current_shop.purchases.build(purchase_params)\n@purchases.save!\n\nprivate\n\ndef purchase_params\n  params.require(:purchase).permit(:shop_id, :subscription_id, :created_at)\nend\n</code></pre>\n\n<p>And returns this error:</p>\n\n<pre><code>ActionController::ParameterMissing in TransactionsController#create\nparam is missing or the value is empty: purchase\n</code></pre>\n\n<p><strong>Update 1</strong></p>\n\n<p>Logs:</p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"aJWUUEwgtG0o52MEHSOcNETj1Ueo+4NvLBD+y5LMPHxtHnOEe1Zgs3IMADdv5y+dbl7Ecgr8LMEjIG6sws9kqg==\", \"payment_method_nonce\"=&gt;\"bf7458d2-d3a4-02c9-2593-526174f50822\"}\n  Cart Load (0.1ms)  SELECT  \"carts\".* FROM \"carts\" WHERE \"carts\".\"id\" = ? LIMIT ?  [[\"id\", 93], [\"LIMIT\", 1]]\n  Shop Load (0.3ms)  SELECT  \"shops\".* FROM \"shops\" WHERE \"shops\".\"id\" = ? ORDER BY \"shops\".\"id\" ASC LIMIT ?  [[\"id\", 13], [\"LIMIT\", 1]]\n  LineItem Load (0.4ms)  SELECT \"line_items\".* FROM \"line_items\" WHERE \"line_items\".\"cart_id\" = ?  [[\"cart_id\", 93]]\n  Subscription Load (0.1ms)  SELECT  \"subscriptions\".* FROM \"subscriptions\" WHERE \"subscriptions\".\"id\" = ? LIMIT ?  [[\"id\", 2], [\"LIMIT\", 1]]\nCompleted 400 Bad Request in 2899ms (ActiveRecord: 1.1ms) \n\nActionController::ParameterMissing (param is missing or the value is empty: purchase):\n\napp/controllers/transactions_controller.rb:60:in purchase_params'\napp/controllers/transactions_controller.rb:31:in create'\n</code></pre>\n\n<p><strong>Update 2</strong></p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n&lt;script src=\"https://js.braintreegateway.com/v2/braintree.js\"&gt;&lt;/script&gt;\n\n&lt;div class=\"form-container radius-box glassy-bg small-10 small-centered medium-8 large-6 columns\"&gt;\n  &lt;h2 class=\"mbs\"&gt;New Transaction&lt;/h2&gt;\n  &lt;%= form_tag transactions_path do%&gt;\n    &lt;p&gt;Please enter your payment details:&lt;/p&gt;\n    &lt;div id=\"dropin\"&gt;&lt;/div&gt;\n    &lt;%=submit_tag \"Pay #{@cart.total_price}$\", class: \"button mt1\" %&gt;\n  &lt;%end%&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "single-table-inheritance"], "comments": [{"owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 3, "creation_date": 1497387260, "post_id": 44531131, "comment_id": 76054320, "body": "Set <code>foreign_key</code> option for <code>has_many :orders</code> association in the <code>Tailor</code> class. Now it expects that the foreign key is the <code>tailor_id</code> column in the <code>orders</code> table, which in your case is something different."}, {"owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 0, "creation_date": 1497388692, "post_id": 44531131, "comment_id": 76055078, "body": "Do you have a column in the <code>orders</code> table which points to the <code>Tailor</code> it belongs to ?"}, {"owner": {"reputation": 531, "user_id": 4859818, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/26c8b231855a82a9de1aa2819b5f8899?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/4859818/jared"}, "reply_to_user": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 0, "creation_date": 1497397185, "post_id": 44531131, "comment_id": 76057904, "body": "@chumakoff it works! perfect thank you"}], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 4859818, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/26c8b231855a82a9de1aa2819b5f8899?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/4859818/jared"}, "edited": false, "score": 0, "creation_date": 1497397336, "post_id": 44531530, "comment_id": 76057941, "body": "the db schema for orders does have a provider_id column, which is necessary in our case since tailors wouldnt be the only store that fulfills it"}], "tags": [], "owner": {"reputation": 380, "user_id": 4781518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jtiKY.jpg?s=128&g=1", "display_name": "ydaniju", "link": "https://stackoverflow.com/users/4781518/ydaniju"}, "is_accepted": false, "score": 0, "last_activity_date": 1497387756, "creation_date": 1497387756, "answer_id": 44531530, "question_id": 44531131, "link": "https://stackoverflow.com/questions/44531131/rails-activerecord-associations-collectionproxy-with-single-table-inheritance/44531530#44531530", "title": "Rails ActiveRecord_Associations_CollectionProxy with Single Table Inheritance", "body": "<p>Create a migration for <code>AddTailorToOrders</code>. It should be like this </p>\n\n<p><code>rails g migration AddTailorToOrders tailor:references</code></p>\n\n<p><code>class AddTailorReferenceToOrders &lt; ActiveRecord::Migration\n def change\n   add_reference :orders, :tailor, index: true\n end\nend\n</code></p>\n\n<p>That would create a column <code>tailor_id</code> in Order table which references Tailor.</p>\n"}, {"tags": [], "owner": {"reputation": 531, "user_id": 4859818, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/26c8b231855a82a9de1aa2819b5f8899?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/4859818/jared"}, "is_accepted": true, "score": 1, "last_activity_date": 1497397262, "creation_date": 1497397262, "answer_id": 44533207, "question_id": 44531131, "link": "https://stackoverflow.com/questions/44531131/rails-activerecord-associations-collectionproxy-with-single-table-inheritance/44533207#44533207", "title": "Rails ActiveRecord_Associations_CollectionProxy with Single Table Inheritance", "body": "<p>Thought I would just post the solution here in case anyone else runs into this. Per @chumakoff's comment, I simply adjusted the Tailor class like so: </p>\n\n<p>Before</p>\n\n<pre><code>class Tailor &lt; Store \n  has_many :orders\nend\n</code></pre>\n\n<p>After</p>\n\n<pre><code>class Tailor &lt; Store\n  has_many :orders, foreign_key: \"provider_id\"\nend\n</code></pre>\n"}], "owner": {"reputation": 531, "user_id": 4859818, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/26c8b231855a82a9de1aa2819b5f8899?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/4859818/jared"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "accepted_answer_id": 44533207, "answer_count": 2, "score": 2, "last_activity_date": 1497511766, "creation_date": 1497386383, "question_id": 44531131, "link": "https://stackoverflow.com/questions/44531131/rails-activerecord-associations-collectionproxy-with-single-table-inheritance", "title": "Rails ActiveRecord_Associations_CollectionProxy with Single Table Inheritance", "body": "<p>I used Single Table Inheritance to model out Stores, Tailors, Orders, and TailorOrders. Orders belong to a tailor, but I am not able to access the orders of a tailor in the rails console. There are multiple types of stores, and in the database the order has a <code>requester_id</code> and a <code>provider_id</code>. The tailor's relationship to an order will ALWAYS be a provider. The inheritance model looks like:</p>\n\n<pre><code>class Store\nend\n\nclass Tailor &lt; Store \n  has_many :orders\nend\n\nclass Order \n  has_many :items\nend \n\nclass TailorOrders\n   belongs_to :tailor, class_name: \"Tailor\", foreign_key: \"provider_id\"\nend\n\nclass Item \n  belongs_to :order\nend\n</code></pre>\n\n<p>I am able to get items that belong to an order, like so:</p>\n\n<pre><code>Order.first.items\n#=&gt;  [#&lt;Item:0x007fe9f0cc8f58\n  id: 1,\n  order_id: 1,\n  name: \"Grey Pants\",\n  created_at: Tue, 13 Jun 2017 17:50:57 UTC +00:00,\n  updated_at: Tue, 13 Jun 2017 17:50:57 UTC +00:00,\n  type_id: 1&gt;]\n</code></pre>\n\n<p>And, I am able to get the tailor from the order:</p>\n\n<pre><code>Order.first.tailor\n#=&gt; #&lt;Tailor:0x007fe9f214b8b8\n id: 3,\n company_id: 3,\n primary_contact_id: 3,\n phone: \"2121468958\",\n street1: \"640 Bennie Way\",\n street2: \"Apt. 533\",\n city: \"Carliefurt\",\n state: \"New Mexico\",\n zip: \"42439-4809\",\n country: \"Ukraine\",\n created_at: Tue, 13 Jun 2017 17:50:56 UTC +00:00,\n updated_at: Tue, 13 Jun 2017 17:50:56 UTC +00:00,\n type: \"Tailor\",\n name: \"Joe's on Main Street\"&gt;\n</code></pre>\n\n<p>But, I CANT get the orders that belong to a tailor:</p>\n\n<pre><code>Tailor.first.orders \n#=&gt; #&lt;Order::ActiveRecord_Associations_CollectionProxy:0x3ff4f786e9e0&gt;\n\nTailor.first.orders.first\n#=&gt; ActiveRecord::StatementInvalid: PG::UndefinedColumn: ERROR:  column orders.tailor_id does not exist\nLINE 1: SELECT  \"orders\".* FROM \"orders\" WHERE \"orders\".\"tailor_id\" ...\n</code></pre>\n\n<p>This error seems related to the database layout, as I described above, where the class Tailor is always a <code>provider</code> in order's db table. </p>\n\n<p>Is there a way to access the orders through a tailor (a type of store, also a provider in orders table)? What I also want to accomplish is something along the lines of <code>Stores.first.orders.first.items</code>. Any help would be appreciated thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 34077, "user_id": 1249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ed9686d6910478914966ec99bbcaa069?s=128&d=identicon&r=PG", "display_name": "Adam Lassek", "link": "https://stackoverflow.com/users/1249/adam-lassek"}, "edited": false, "score": 0, "creation_date": 1497392645, "post_id": 44532502, "comment_id": 76056721, "body": "STI base classes store their class name in the <code>type</code> column, same as any child class."}, {"owner": {"reputation": 554, "user_id": 2627121, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19db1b0378deb105b44f7319fa60d1b7?s=128&d=identicon&r=PG", "display_name": "Leaf", "link": "https://stackoverflow.com/users/2627121/leaf"}, "edited": false, "score": 0, "creation_date": 1497426475, "post_id": 44532502, "comment_id": 76067885, "body": "Thanks for explanation @chumakoff! Makes a lot of sense. Just&#39;d like to clarify one thing, does it mean, that to use such architecture properly there should be some base class and both List and Show should be inherited from it?"}, {"owner": {"reputation": 554, "user_id": 2627121, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19db1b0378deb105b44f7319fa60d1b7?s=128&d=identicon&r=PG", "display_name": "Leaf", "link": "https://stackoverflow.com/users/2627121/leaf"}, "edited": false, "score": 0, "creation_date": 1497428234, "post_id": 44532502, "comment_id": 76069070, "body": "The other question is how it shoud&#39;ve been done in proper way?  I think there should be  has_many :lists, -&gt; { where(&#39;lists.type = \\&#39;List\\&#39;&#39;) }, through: :joined_tables has_many :shows, -&gt; { where(&#39;lists.type = \\&#39;Show\\&#39;&#39;) }, through: :joined_tables, source: :list in Work and belongs_to :list, foreign_key: &#39;listable_id&#39; in joined table which lets us not to use polymorphism in joined table and works properly. Maybe you have a better approach @chumakoff?"}, {"owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 1, "creation_date": 1497434037, "post_id": 44532502, "comment_id": 76073226, "body": "You don&#39;t need a separate base class for List and Show in your case, but I think that if you had it, that would be better and might save a lot of time and nerves in the future.  I edited the answer and added a working solution. Please, read it again from the beginning to the end."}], "tags": [], "owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "is_accepted": true, "score": 1, "last_activity_date": 1497434345, "last_edit_date": 1497434345, "creation_date": 1497392354, "answer_id": 44532502, "question_id": 44530440, "link": "https://stackoverflow.com/questions/44530440/polymorphic-has-many-though-with-sti-in-rails/44532502#44532502", "title": "Polymorphic has many though with STI in rails", "body": "<p><code>Work.first.lists</code> doesn't generate <code>lists.type</code> because <code>List</code> is the base class in the hierarchy, so lists are all records of all types in the <code>lists</code> table. Also, keep in mind that all <code>List</code> records will have <code>type = nil</code> in DB, since <code>List</code> is the base class.</p>\n\n<p>Furthermore, when you use polymorphic association with STI, it by default always assigns the name of the base class to the <code>*_type</code> column of polymorphic association. In your case <code>listable_type</code> of <code>JoinedTable</code> will always be <code>\"List\"</code></p>\n\n<p>The second problem is because when you do <code>Work.first.lists</code> first, Rails doesn't know that there is the child <code>Show</code> class, since it hasn't been loaded yet at that moment. You should whether make it autoload by accessing it (it happened when you did <code>Work.first.shows</code>), or use something like <code>require_dependency</code>. </p>\n\n<p>Here is a working solution for you:</p>\n\n<pre><code>class Work &lt; ApplicationRecord\n  has_many :joined_tables, dependent: :destroy\n  has_many :lists, -&gt; { where(type: nil) }, through: :joined_tables, source: :listable, source_type: \"List\"\n  has_many :shows, -&gt; { where(type: \"Show\") }, through: :joined_tables, source: :listable, source_type: \"List\"\nend\n</code></pre>\n"}], "owner": {"reputation": 554, "user_id": 2627121, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19db1b0378deb105b44f7319fa60d1b7?s=128&d=identicon&r=PG", "display_name": "Leaf", "link": "https://stackoverflow.com/users/2627121/leaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 44532502, "answer_count": 1, "score": 1, "last_activity_date": 1497434345, "creation_date": 1497383941, "question_id": 44530440, "link": "https://stackoverflow.com/questions/44530440/polymorphic-has-many-though-with-sti-in-rails", "title": "Polymorphic has many though with STI in rails", "body": "<p>I've faced unusual situation with rails association and created simple sample to show that. \nAssume we have 4 models:\n1) list.rb </p>\n\n<pre><code>class List &lt; ApplicationRecord;end\n</code></pre>\n\n<p>2) show.rb</p>\n\n<pre><code>class Show &lt; List;end\n</code></pre>\n\n<p>3) joined_table.rb</p>\n\n<pre><code>class JoinedTable &lt; ApplicationRecord\n  belongs_to :listable, polymorphic: true\n  belongs_to :work\nend\n</code></pre>\n\n<p>4) work.rb</p>\n\n<pre><code>class Work &lt; ApplicationRecord\n  has_many :joined_tables, dependent: :destroy\n  has_many :lists, through: :joined_tables, source: :listable, source_type: 'List'\n  has_many :shows, through: :joined_tables, source: :listable, source_type: 'Show'\nend\n</code></pre>\n\n<p>Thus we have next schema.rb</p>\n\n<pre><code>create_table \"joined_tables\", force: :cascade do |t|\n  t.integer  \"listable_id\"\n  t.string   \"listable_type\"\n  t.integer  \"work_id\"\n  t.datetime \"created_at\",    null: false\n  t.datetime \"updated_at\",    null: false\nend\n\ncreate_table \"lists\", force: :cascade do |t|\n  t.string   \"type\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n\ncreate_table \"works\", force: :cascade do |t|\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n</code></pre>\n\n<p>Now when you got all the info, could anybody explain me why when I'm trying</p>\n\n<pre><code>Work.first.shows\n</code></pre>\n\n<p>it generates</p>\n\n<pre><code> Show Load (0.2ms)  SELECT \"lists\".* FROM \"lists\" INNER JOIN \"joined_tables\" ON \"lists\".\"id\" = \"joined_tables\".\"listable_id\" WHERE \"lists\".\"type\" IN ('Show') AND \"joined_tables\".\"work_id\" = ? AND \"joined_tables\".\"listable_type\" = ?  [[\"work_id\", 1], [\"listable_type\", \"Show\"]]\n</code></pre>\n\n<p>that looks like a proper request, but when I'm trying to do </p>\n\n<pre><code>Work.first.lists\n</code></pre>\n\n<p>it generates</p>\n\n<pre><code>  List Load (0.1ms)  SELECT \"lists\".* FROM \"lists\" INNER JOIN \"joined_tables\" ON \"lists\".\"id\" = \"joined_tables\".\"listable_id\" WHERE \"joined_tables\".\"work_id\" = ? AND \"joined_tables\".\"listable_type\" = ?  [[\"work_id\", 1], [\"listable_type\", \"List\"]]\n</code></pre>\n\n<p>which IS NOT THE SAME and missing checking lists.type.</p>\n\n<p>I know that is poor architecture and one probably should use scope on associations in Work leaving aside polymorphism in JoinedTable, but that's just something I've faced in project that came up to me. Also I'd love to hear alternative solutions to that, but most of all I'd like to know why rails generates different queries.</p>\n\n<p>P.S. In example I'm using rails 5 and SQLite. But in real project using rails 4 and postgres it's even worse. If I do first Work.first.shows and then Work.first.lists it generates</p>\n\n<pre><code>  List Load (0.4ms)  SELECT \"lists\".* FROM \"lists\" INNER JOIN \"list_works\" ON \"lists\".\"id\" = \"list_works\".\"listable_id\" WHERE \"list_works\".\"work_id\" = $1 AND \"list_works\".\"listable_type\" IN ('List', 'Show')  [[\"work_id\", 50]]\n</code></pre>\n\n<p>but if I do Work.first.lists at once it generates </p>\n\n<pre><code>  List Load (0.8ms)  SELECT \"lists\".* FROM \"lists\" INNER JOIN \"list_works\" ON \"lists\".\"id\" = \"list_works\".\"listable_id\" WHERE \"list_works\".\"work_id\" = $1 AND \"list_works\".\"listable_type\" = 'List'  [[\"work_id\", 50]]\n</code></pre>\n\n<p>Thank you for help!</p>\n"}, {"tags": ["html", "ruby"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 5, "creation_date": 1497383710, "post_id": 44530377, "comment_id": 76052496, "body": "Learn about escaping."}, {"owner": {"reputation": 21412, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "edited": false, "score": 3, "creation_date": 1497383887, "post_id": 44530377, "comment_id": 76052602, "body": "It&#39;s worse than you think. Never mind apostrophes - what happens if someone puts in <code>xxx&#39;&gt;&lt;script type=&#39;text&#47;javascript&#39;&gt;alert(&quot;You&#39;ve been hacked!&quot;);&lt;&#47;script&gt;</code> ?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1497384420, "post_id": 44530377, "comment_id": 76052871, "body": "This value needs to be HTML escaped."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497399172, "post_id": 44530377, "comment_id": 76058352, "body": "If you&#39;re sure someone will mark it as a duplicate then you probably shouldn&#39;t ask it, or, you should show where you searched and explain why those didn&#39;t help, which helps us help you by reducing the number of places we have to look."}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 7756955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2556cac9a475709d3c560fd3632e3622?s=128&d=identicon&r=PG", "display_name": "StuntHacks", "link": "https://stackoverflow.com/users/7756955/stunthacks"}, "reply_to_user": {"reputation": 33, "user_id": 7753034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5b683446fe579dd853e4e56b6d72e5?s=128&d=identicon&r=PG&f=1", "display_name": "athill16", "link": "https://stackoverflow.com/users/7753034/athill16"}, "edited": false, "score": 0, "creation_date": 1497463173, "post_id": 44530651, "comment_id": 76093884, "body": "No problem :) @athill16"}], "tags": [], "owner": {"reputation": 427, "user_id": 7756955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2556cac9a475709d3c560fd3632e3622?s=128&d=identicon&r=PG", "display_name": "StuntHacks", "link": "https://stackoverflow.com/users/7756955/stunthacks"}, "is_accepted": true, "score": 0, "last_activity_date": 1497384654, "creation_date": 1497384654, "answer_id": 44530651, "question_id": 44530377, "link": "https://stackoverflow.com/questions/44530377/how-to-ignore-apostrophes-in-html-tag/44530651#44530651", "title": "How to ignore apostrophes in html tag?", "body": "<p>You can escape the variable to html entities:</p>\n\n<pre><code>camp_name.gsub(\"'\", \"&amp;apos;\")\n</code></pre>\n\n<p>You should do that for other characters as well, because, as mentioned by a comment, the user could simply insert an HTML tag in your page with your current script. Probably the most important ones are the following:</p>\n\n<pre><code>camp_name.gsub(\"&lt;\", \"&amp;lt;\")\ncamp_name.gsub(\"&gt;\", \"&amp;gt;\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1475, "user_id": 1743874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/vQYev.png?s=128&g=1", "display_name": "Piccolo", "link": "https://stackoverflow.com/users/1743874/piccolo"}, "is_accepted": false, "score": 0, "last_activity_date": 1497385659, "creation_date": 1497385659, "answer_id": 44530927, "question_id": 44530377, "link": "https://stackoverflow.com/questions/44530377/how-to-ignore-apostrophes-in-html-tag/44530927#44530927", "title": "How to ignore apostrophes in html tag?", "body": "<p>If you're using Rack (which would definitely be in use if you're using Rails or Sinatra, and it might be there even if you're not), there is a builtin for escaping HTML for just this kind of thing. Calling <a href=\"http://www.rubydoc.info/gems/rack/Rack/Utils#escape_html-class_method\" rel=\"nofollow noreferrer\"><code>Rack::Utils#escape_html</code></a> will replace ampersands, brackets, and quotes with their HTML entities (e.g. <code>&amp;apos;</code> instead of <code>'</code>). </p>\n\n<p>In your case, you'd want the following code:</p>\n\n<pre><code> &lt;input type=\"text\" class=\"form-control\" name=\"campaign_name\" required value='&lt;%= Rack::Utils.escape_html(camp_name) %&gt;'&gt;\n</code></pre>\n\n<p>This would evaluate to:</p>\n\n<pre><code>&lt;input type=\"text\" class=\"form-control\" name=\"campaign_name\" required value='abc&amp;apos;d'&gt;\n</code></pre>\n\n<p>which is the proper way of displaying an apostrophe in HTML.</p>\n\n<p>Just as a side note, displaying user-submitted text without escaping on a website is a <em>very</em> bad idea, because malicious users can add arbitrary Javascript that could render your site useless, add advertisements, and more. You should definitely get into the habit of escaping any text that users can submit before displaying it, either by <code>gsub</code>ing manually or using a helper method like this.</p>\n"}], "owner": {"reputation": 33, "user_id": 7753034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5b683446fe579dd853e4e56b6d72e5?s=128&d=identicon&r=PG&f=1", "display_name": "athill16", "link": "https://stackoverflow.com/users/7753034/athill16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 44530651, "answer_count": 2, "score": -1, "last_activity_date": 1497385659, "creation_date": 1497383657, "question_id": 44530377, "link": "https://stackoverflow.com/questions/44530377/how-to-ignore-apostrophes-in-html-tag", "title": "How to ignore apostrophes in html tag?", "body": "<p>I'm sure someone will mark this as a duplicate question but no other answers worked for me. </p>\n\n<p>I am using ruby and passing a variable into my html page. Let's say my variable \"camp_name\" is equal to \"abc'd\" </p>\n\n<pre><code> &lt;%=camp_name%&gt;\n</code></pre>\n\n<p>This outputs  \"abc'd\" which is what I want.</p>\n\n<pre><code> &lt;input type=\"text\" class=\"form-control\" name=\"campaign_name\" required value='&lt;%=camp_name%&gt;'&gt;\n</code></pre>\n\n<p>The value in the field is now \"abc\" because of the single apostrophe. How do i get it to ignore apostrophes? Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1497383809, "post_id": 44530252, "comment_id": 76052554, "body": "can you do a search for just the string <code>price</code> and not <code>def price</code>? It may come from <code>method_missing</code> or even something buried in a gem."}, {"owner": {"reputation": 2513, "user_id": 1414596, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/68952cca8d9631003516ac20e2b39f25?s=128&d=identicon&r=PG", "display_name": "roxxypoxxy", "link": "https://stackoverflow.com/users/1414596/roxxypoxxy"}, "edited": false, "score": 1, "creation_date": 1497383962, "post_id": 44530252, "comment_id": 76052643, "body": "Since ruby is dynamic method, it can be possible that s/he could have created a dynamic method or meta-programmed or defined it in some modules that is being included in the model."}, {"owner": {"reputation": 343, "user_id": 3840725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5un6e.jpg?s=128&g=1", "display_name": "jpheos", "link": "https://stackoverflow.com/users/3840725/jpheos"}, "edited": false, "score": 1, "creation_date": 1497384186, "post_id": 44530252, "comment_id": 76052742, "body": "has you tried this? <code>p item.method(:price)</code> ?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1497385222, "post_id": 44530252, "comment_id": 76053263, "body": "Answers belong in an answer, not in the question."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1497384466, "creation_date": 1497384466, "answer_id": 44530594, "question_id": 44530252, "link": "https://stackoverflow.com/questions/44530252/finding-a-method-in-rails/44530594#44530594", "title": "Finding a method in Rails", "body": "<p>If you're wondering where it comes from:</p>\n\n<pre><code>item.method(:price).source_location\n</code></pre>\n\n<p>Not every method originates from a <code>def</code>, in many cases they're generated using things like <code>define_method</code>, a module mixin, or other more exotic approaches.</p>\n"}, {"tags": [], "owner": {"reputation": 1589, "user_id": 1123717, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fb3d5703694d21ac6573b31d3f3014f0?s=128&d=identicon&r=PG", "display_name": "aarkerio", "link": "https://stackoverflow.com/users/1123717/aarkerio"}, "is_accepted": false, "score": 0, "last_activity_date": 1497387229, "creation_date": 1497387229, "answer_id": 44531362, "question_id": 44530252, "link": "https://stackoverflow.com/questions/44530252/finding-a-method-in-rails/44531362#44531362", "title": "Finding a method in Rails", "body": "<p>Thanks guys, yeah it was:</p>\n\n<pre><code>def method_missing(symbol, *args)\n   if respond_to?(sym_to_cents_attribute(symbol))\n</code></pre>\n\n<p>since the column price_in_cents exists, it returns the price in dollars.</p>\n"}], "owner": {"reputation": 1589, "user_id": 1123717, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fb3d5703694d21ac6573b31d3f3014f0?s=128&d=identicon&r=PG", "display_name": "aarkerio", "link": "https://stackoverflow.com/users/1123717/aarkerio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1497387248, "creation_date": 1497383172, "last_edit_date": 1497387248, "question_id": 44530252, "link": "https://stackoverflow.com/questions/44530252/finding-a-method-in-rails", "title": "Finding a method in Rails", "body": "<p>In Rails, I have a pretty normal <code>ActiveRecord::Base</code> class, I see the previous developer is using the <code>price</code> method in the <code>Item</code> model but I can't find where that method is, there is no column called <code>price</code> in the database but: </p>\n\n<pre><code> [40] pry(main)&gt; item.method(:price).source_location\n   NameError: undefined method `price' for class `Item'\n   from (pry):40:in `method'\n  [41] pry(main)&gt; item.price\n   =&gt; 80.45\n</code></pre>\n\n<p>How so?</p>\n\n<pre><code>find ./ -type f -name \"*.rb\" | xargs grep \"def price\"\n</code></pre>\n\n<p>returns nothing. There is no alias or something like that. Where the heck is that method coming from?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "ruby-on-rails-4", "architecture"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1497383944, "post_id": 44529982, "comment_id": 76052636, "body": "it&#39;s not necessary to have a user system to use a database. In fact &quot;users&quot; are just another table in the database you have the freedom to add, similar to any other data. Read up on the model layer in Rails, it&#39;s built in and there are plenty of tutorials on it."}], "answers": [{"tags": [], "owner": {"reputation": 505, "user_id": 63516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0885ba9442ca4515dd4b235319278b8b?s=128&d=identicon&r=PG", "display_name": "tmarkiewicz", "link": "https://stackoverflow.com/users/63516/tmarkiewicz"}, "is_accepted": true, "score": 1, "last_activity_date": 1497384095, "creation_date": 1497384095, "answer_id": 44530491, "question_id": 44529982, "link": "https://stackoverflow.com/questions/44529982/how-to-display-and-save-data-without-having-users/44530491#44530491", "title": "How to display and save data without having users", "body": "<p>You should just save the session data regardless of any user model. You mention the session would be lost, but you can easily save it to the database after they're done with the form. There's no reason the session needs to be associated with a user. The following are some resources:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/22065117/rails-how-to-store-data-in-session\">Rails: How to store data in session?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/36750121/can-i-use-sessions-cookies-in-ruby-on-rails-without-having-a-users-model-or-any\">Can I use sessions/cookies in Ruby on Rails without having a user&#39;s model or any authentication?</a></p>\n\n<p><a href=\"http://www.justinweiss.com/articles/how-rails-sessions-work/\" rel=\"nofollow noreferrer\">How Rails Sessions Work</a></p>\n"}], "owner": {"reputation": 866, "user_id": 5768081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/NGa7y.jpg?s=128&g=1", "display_name": "luissimo", "link": "https://stackoverflow.com/users/5768081/luissimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 44530491, "answer_count": 1, "score": 0, "last_activity_date": 1497440220, "creation_date": 1497382027, "question_id": 44529982, "link": "https://stackoverflow.com/questions/44529982/how-to-display-and-save-data-without-having-users", "title": "How to display and save data without having users", "body": "<p>I'm working on a survey application where i need to <strong>display and save</strong> the <strong>data</strong> filled in during the survey at the end but there are <strong>no users</strong>(e.g. devise) since you can't login.</p>\n\n<p>Example of survey:</p>\n\n<pre><code>Whats your name? \n-- [input]\n</code></pre>\n\n<p>Example of show page:</p>\n\n<pre><code>Hi there [input], here are your results:\n</code></pre>\n\n<p>I tried saving <code>[input]</code> in the session but that way the data will be lost after the session ends and i want to keep the data in a database.</p>\n\n<p>Tried googling for a few hours but no real answers to this question. How can i go about this problem, any help in the right direction would be much appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1497380657, "post_id": 44529561, "comment_id": 76050881, "body": "I think you should not use <code>platforms: [:mingw, :mswin, :x64_mingw, :jruby]</code> if you don&#39;t use Windows"}, {"owner": {"reputation": 1, "user_id": 8156498, "user_type": "registered", "profile_image": "https://graph.facebook.com/1833875063607085/picture?type=large", "display_name": "Igor Michalski", "link": "https://stackoverflow.com/users/8156498/igor-michalski"}, "reply_to_user": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1497381827, "post_id": 44529561, "comment_id": 76051450, "body": "I&#39;m not sure, because in the other project I used platforms and it worked."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 7256005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TUx1R.png?s=128&g=1", "display_name": "\u0414\u043c\u0438\u0442\u0440\u0438\u0439 \u0421\u043f\u0438\u0432\u0430\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/7256005/%d0%94%d0%bc%d0%b8%d1%82%d1%80%d0%b8%d0%b9-%d0%a1%d0%bf%d0%b8%d0%b2%d0%b0%d0%ba%d0%be%d0%b2"}, "is_accepted": false, "score": 0, "last_activity_date": 1497451257, "creation_date": 1497451257, "answer_id": 44547915, "question_id": 44529561, "link": "https://stackoverflow.com/questions/44529561/rails-test-files-while-using-postgresql/44547915#44547915", "title": "rails test files while using postgresql", "body": "<p>First, you should get rid of </p>\n\n<pre><code>     gem 'sqlite3'\n</code></pre>\n\n<p>Since you are using PostgreSQL, and gem 'pg' as adapter. After this you should rebuild your Gemfile.lock by running</p>\n\n<pre><code>    bundle install\n</code></pre>\n\n<p>If your problem persists, please check your</p>\n\n<pre><code>/config/database.yml\n</code></pre>\n\n<p>file's content.</p>\n"}], "owner": {"reputation": 1, "user_id": 8156498, "user_type": "registered", "profile_image": "https://graph.facebook.com/1833875063607085/picture?type=large", "display_name": "Igor Michalski", "link": "https://stackoverflow.com/users/8156498/igor-michalski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497451257, "creation_date": 1497380465, "question_id": 44529561, "link": "https://stackoverflow.com/questions/44529561/rails-test-files-while-using-postgresql", "title": "rails test files while using postgresql", "body": "<p>I've got a little problem with RoR and PostgreSQL. When I'm using this database, can't make any test. Always is the same problem. Tried to copy Bundle from other project, but didn't help. It's quite important to do tests in this app. Thanks from advance!</p>\n\n<p>My Gemfile:</p>\n\n<pre><code>    source 'https://rubygems.org'\n    # Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\n    gem 'rails', '~&gt; 5.1.1'\n    # Use postgresql as the database for Active Record\n    gem 'pg', '~&gt; 0.18'\n    # Use Puma as the app server\n    gem 'puma', '~&gt; 3.7'\n    # Use SCSS for stylesheets\n    gem 'sass-rails', '~&gt; 5.0'\n    # Use Uglifier as compressor for JavaScript assets\n    gem 'uglifier', '&gt;= 1.3.0'\n    # See https://github.com/rails/execjs#readme for more supported runtimes\n    # gem 'therubyracer', platforms: :ruby\n\n    # Use CoffeeScript for .coffee assets and views\n    gem 'coffee-rails', '~&gt; 4.2'\n    # Turbolinks makes navigating your web application faster. Read more:         https://github.com/turbolinks/turbolinks\n    gem 'turbolinks', '~&gt; 5'\n    # Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\n    gem 'jbuilder', '~&gt; 2.5'\n    # Use Redis adapter to run Action Cable in production\n    # gem 'redis', '~&gt; 3.0'\n    # Use ActiveModel has_secure_password\n    # gem 'bcrypt', '~&gt; 3.1.7'\n\n    # Use Capistrano for deployment\n    # gem 'capistrano-rails', group: :development\n\n    group :development, :test do\n      # Call 'byebug' anywhere in the code to stop execution and get a         debugger console\n      gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\n      # Adds support for Capybara system testing and selenium driver\n      gem 'capybara', '~&gt; 2.13'\n      gem 'selenium-webdriver'\n      gem 'rails-controller-testing'\n      gem 'sqlite3'\n    end\n\n    group :development do\n     # Access an IRB console on exception pages or by using &lt;%= console %&gt; anywhere in the code. gem 'web-console', '&gt;= 3.3.0' gem 'listen', '&gt;= 3.0.5', '&lt; 3.2' \n   # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring \n   gem 'spring'\n   gem 'spring-watcher-listen', '~&gt; 2.0.0' \n   gem 'bootstrap-sass' \n   end \n   gem 'bcrypt' \n   # Windows does not include zoneinfo files, so bundle the tzinfo-data gem gem 'tzinfo-data', \n    platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>And answer from console:</p>\n\n<pre><code>    igor@igor:~/PWr/RubyProjects/Delegation$ rails test\n    /var/lib/gems/2.3.0/gems/actionpack-5.1.1/lib/action_dispatch /middleware/session/abstract_store.rb:78:in `&lt;module:Session&gt;': uninitialized constant Rack::Session::Abstract::Persisted (NameError)\nfrom /var/lib/gems/2.3.0/gems/actionpack-5.1.1/lib/action_dispatch/middleware/session/abstract_store.rb:8:in `&lt;module:ActionDispatch&gt;'\nfrom /var/lib/gems/2.3.0/gems/actionpack-5.1.1/lib/action_dispatch/middleware/session/abstract_store.rb:7:in `&lt;top (required)&gt;'\nfrom /var/lib/gems/2.3.0/gems/actionpack-5.1.1/lib/action_dispatch/middleware/session/cookie_store.rb:2:in `&lt;top (required)&gt;'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/application/configuration.rb:180:in `const_get'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/application/configuration.rb:180:in `session_store'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/application/default_middleware_stack.rb:56:in `block in build_stack'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/application/default_middleware_stack.rb:13:in `tap'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/application/default_middleware_stack.rb:13:in `build_stack'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/application.rb:501:in `default_middleware_stack'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/engine.rb:506:in `block in app'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/engine.rb:504:in `synchronize'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/engine.rb:504:in `app'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/application/finisher.rb:45:in `block in &lt;module:Finisher&gt;'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/initializable.rb:30:in `instance_exec'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/initializable.rb:30:in `run'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/initializable.rb:59:in `block in run_initializers'\nfrom /usr/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each'\nfrom /usr/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\nfrom /usr/lib/ruby/2.3.0/tsort.rb:431:in `each_strongly_connected_component_from'\nfrom /usr/lib/ruby/2.3.0/tsort.rb:349:in `block in each_strongly_connected_component'\nfrom /usr/lib/ruby/2.3.0/tsort.rb:347:in `each'\nfrom /usr/lib/ruby/2.3.0/tsort.rb:347:in `call'\nfrom /usr/lib/ruby/2.3.0/tsort.rb:347:in `each_strongly_connected_component'\nfrom /usr/lib/ruby/2.3.0/tsort.rb:226:in `tsort_each'\nfrom /usr/lib/ruby/2.3.0/tsort.rb:205:in `tsort_each'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/initializable.rb:58:in `run_initializers'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/application.rb:353:in `initialize!'\nfrom /home/igor/PWr/RubyProjects/Delegation/config/environment.rb:5:in `&lt;top (required)&gt;'\nfrom /home/igor/PWr/RubyProjects/Delegation/test/test_helper.rb:1:in `require'\nfrom /home/igor/PWr/RubyProjects/Delegation/test/test_helper.rb:1:in `&lt;top (required)&gt;'\nfrom /home/igor/PWr/RubyProjects/Delegation/test/controllers/static_pages_controller_test.rb:1:in `require'\nfrom /home/igor/PWr/RubyProjects/Delegation/test/controllers/static_pages_controller_test.rb:1:in `&lt;top (required)&gt;'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/test_unit/test_requirer.rb:14:in `require'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/test_unit/test_requirer.rb:14:in `block in require_files'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/test_unit/test_requirer.rb:13:in `each'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/test_unit/test_requirer.rb:13:in `require_files'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/test_unit/minitest_plugin.rb:94:in `plugin_rails_init'\nfrom /var/lib/gems/2.3.0/gems/minitest-5.10.2/lib/minitest.rb:81:in `block in init_plugins'\nfrom /var/lib/gems/2.3.0/gems/minitest-5.10.2/lib/minitest.rb:79:in `each'\nfrom /var/lib/gems/2.3.0/gems/minitest-5.10.2/lib/minitest.rb:79:in `init_plugins'\nfrom /var/lib/gems/2.3.0/gems/minitest-5.10.2/lib/minitest.rb:130:in `run'\nfrom /var/lib/gems/2.3.0/gems/railties-5.1.1/lib/rails/test_unit/minitest_plugin.rb:77:in `run'\nfrom /var/lib/gems/2.3.0/gems/minitest-5.10.2/lib/minitest.rb:63:in `block in autorun'\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "merge"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1497378022, "post_id": 44528700, "comment_id": 76049417, "body": "Please try something before asking look at Enumerable#group_by and give it a shot"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1497378470, "post_id": 44528700, "comment_id": 76049644, "body": "That is a very peculiar target format."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1497378600, "post_id": 44528700, "comment_id": 76049723, "body": "@tadman I wonder if the OP meant <code>[[&quot;a&quot;], [&quot;b&quot;, &quot;c&quot;], [&quot;d&quot;], [&quot;e&quot;, &quot;f&quot;, &quot;g&quot;]]</code>."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1497378716, "post_id": 44528700, "comment_id": 76049783, "body": "Will the &quot;keys&quot; always be in order, as in your example?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1497379346, "post_id": 44528700, "comment_id": 76050167, "body": "@JordanRunning are you thinking <code>chunk_while</code> as an option?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497379392, "post_id": 44528700, "comment_id": 76050190, "body": "@sagarpandya82 Yep."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497379735, "post_id": 44528700, "comment_id": 76050385, "body": "@sagarpandya82 Or <code>a.chunk(&amp;:last)</code>. For some reason I always remember <code>chunk_while</code> but forget <code>chunk</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497399431, "post_id": 44528700, "comment_id": 76058408, "body": "&quot;I wonder if the OP meant...&quot; then the question isn&#39;t well asked and should be voted to be closed. The OP can then fix the problem and re-open it. <a href=\"https://meta.stackoverflow.com/questions/256328/vote-to-close-unclear-questions-immediately-after-commenting\" title=\"vote to close unclear questions immediately after commenting\">meta.stackoverflow.com/questions/256328/&hellip;</a> and <a href=\"https://meta.stackoverflow.com/questions/260263/how-long-should-we-wait-for-a-poster-to-clarify-a-question-before-closing\" title=\"how long should we wait for a poster to clarify a question before closing\">meta.stackoverflow.com/questions/260263/&hellip;</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1497420702, "post_id": 44528700, "comment_id": 76064448, "body": "What is your desired result if the array were <code>[[&quot;b&quot;,&quot;2&quot;],[&quot;a&quot;,&quot;1&quot;],[&quot;c&quot;,&quot;2&quot;]]</code>, <code>[[&quot;b&quot;],[&quot;a&quot;],[&quot;c&quot;]]</code> or <code>[[&quot;b&quot;,&quot;c&quot;],[&quot;a&quot;]]</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": true, "score": 3, "last_activity_date": 1497399571, "last_edit_date": 1497399571, "creation_date": 1497378168, "answer_id": 44528862, "question_id": 44528700, "link": "https://stackoverflow.com/questions/44528700/ruby-merge-array-conditionally/44528862#44528862", "title": "Ruby merge array conditionally", "body": "<p>One way to do this is to use <code>group_by</code> to group elements by the second value in each array then use <code>map</code> to collect and format the relevant values:</p>\n\n<pre><code>a.group_by(&amp;:last).map { |k,v| [v.map(&amp;:first).join(' ')] }\n#=&gt; =&gt; [[\"a\"], [\"b c\"], [\"d\"], [\"e f g\"]]\n</code></pre>\n\n<p>See <code>group_by</code> and <code>map</code> in the <a href=\"http://www.ruby-doc.org\" rel=\"nofollow noreferrer\">Ruby documentation</a> for more information.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1497379919, "post_id": 44529166, "comment_id": 76050487, "body": "Things like <code>_array</code> and <code>_hash</code> clutter up this solution with pointless verbosity but this is a solution. Don&#39;t forget you can break out elements in an array: <code>each do |a, b|</code> avoids <code>item[0]</code> and <code>item[1]</code>."}], "tags": [], "owner": {"reputation": 19, "user_id": 8156317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b310335a5474d89092fff9c15ac2655a?s=128&d=identicon&r=PG&f=1", "display_name": "mayanksinha", "link": "https://stackoverflow.com/users/8156317/mayanksinha"}, "is_accepted": false, "score": 1, "last_activity_date": 1497379235, "creation_date": 1497379235, "answer_id": 44529166, "question_id": 44528700, "link": "https://stackoverflow.com/questions/44528700/ruby-merge-array-conditionally/44529166#44529166", "title": "Ruby merge array conditionally", "body": "<p>Using Hash can be one way to solve it.</p>\n\n<pre><code>initial_array = [[\"a\",\"1\"],[\"b\",\"2\"],[\"c\",\"2\"],[\"d\",\"3\"],[\"e\",\"4\"],[\"f\",\"4\"],[\"g\",\"4\"]]\nconstructed_hash = {}\ninitial_array.each do |item|\n  constructed_hash[item[1]] = constructed_hash[item[1]].to_a &lt;&lt; item[0]\nend\nfinal_array = constructed_hash.values\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1497381934, "last_edit_date": 1497381934, "creation_date": 1497380952, "answer_id": 44529700, "question_id": 44528700, "link": "https://stackoverflow.com/questions/44528700/ruby-merge-array-conditionally/44529700#44529700", "title": "Ruby merge array conditionally", "body": "<p>This should work well for you too although it does build an intermediary <code>Hash</code> it only needs a single iteration. </p>\n\n<pre><code>a.each_with_object(Hash.new {|h,k| h[k] =''}) do |(v, k),obj| \n  (obj[k] &lt;&lt; \" #{v}\").strip! \nend.values\n#=&gt; [\"a\", \"b c\", \"d\", \"e f g\"]\n</code></pre>\n\n<p>Or using an <code>Array</code> (assuming the \"keys\" are numeric and positional like they are in the question otherwise revert to option 1) </p>\n\n<pre><code>a.each_with_object([]) do |(v,k), obj|\n  ((obj[k.to_i - 1] ||= \"\") &lt;&lt; \" #{v}\").strip!\nend\n#=&gt; [\"a\", \"b c\", \"d\", \"e f g\"]\n</code></pre>\n"}], "owner": {"reputation": 504, "user_id": 4357700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0e0c2f562f1ed55fab85f543069b8a40?s=128&d=identicon&r=PG&f=1", "display_name": "Bastien", "link": "https://stackoverflow.com/users/4357700/bastien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "closed_date": 1497446674, "accepted_answer_id": 44528862, "answer_count": 3, "score": -1, "last_activity_date": 1497399571, "creation_date": 1497377570, "last_edit_date": 1497378397, "question_id": 44528700, "link": "https://stackoverflow.com/questions/44528700/ruby-merge-array-conditionally", "closed_reason": "Needs more focus", "title": "Ruby merge array conditionally", "body": "<p>I have a two-dimensional array in ruby and try to merge data as follows:</p>\n\n<pre><code>a = [[\"a\",\"1\"],[\"b\",\"2\"],[\"c\",\"2\"],[\"d\",\"3\"],[\"e\",\"4\"],[\"f\",\"4\"],[\"g\",\"4\"]]\n</code></pre>\n\n<p>I want to turn it into </p>\n\n<pre><code> [[\"a\"],[\"b c\"],[\"d\"],[\"e f g\"]] //merge each letter together if they have the same \"key\"\n</code></pre>\n\n<p>Could anyone help me figure out what is the most efficient way to do it? Thanks.</p>\n"}, {"tags": ["ruby", "validation", "hanami"], "answers": [{"comments": [{"owner": {"reputation": 7727, "user_id": 585101, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/161cfa234780988a5269603abda9070c?s=128&d=identicon&r=PG", "display_name": "Kleber S.", "link": "https://stackoverflow.com/users/585101/kleber-s"}, "edited": false, "score": 1, "creation_date": 1497374077, "post_id": 44527588, "comment_id": 76047222, "body": "Hey, Diego!   Also, as you said you want to validate against an external dependency (repository) it would be a good idea take a look on this <a href=\"http://dry-rb.org/gems/dry-validation/basics/working-with-schemas/\" rel=\"nofollow noreferrer\">dry-rb.org/gems/dry-validation/basics/working-with-schemas</a>  See the <code>option</code> inside the <code>configure</code> block. The <code>option</code> combined with the <code>validate</code> mentioned by @m45t3r should do the trick!"}], "tags": [], "owner": {"reputation": 449, "user_id": 2751730, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ed5a7c3e629f6b0a0e10a4a204cc8c74?s=128&d=identicon&r=PG&f=1", "display_name": "m45t3r", "link": "https://stackoverflow.com/users/2751730/m45t3r"}, "is_accepted": false, "score": 3, "last_activity_date": 1497373533, "creation_date": 1497373533, "answer_id": 44527588, "question_id": 44526777, "link": "https://stackoverflow.com/questions/44526777/2-field-validation-in-hanami-dry-validation/44527588#44527588", "title": "2 field validation in Hanami + dry-validation", "body": "<p>You can use either <a href=\"http://dry-rb.org/gems/dry-validation/high-level-rules/\" rel=\"nofollow noreferrer\">High-Level Rules</a> or <a href=\"http://dry-rb.org/gems/dry-validation/custom-validation-blocks/\" rel=\"nofollow noreferrer\">Custom Validation Blocks</a>. Something like this:</p>\n\n<pre><code>validations do\n  required(:email) { format?(EMAIL_REGEX)}\n  required(:password).filled(:str?)\n\n  rule(:email_and_password: [:email, :password]) do |email, password|\n    # Example, do what you need here\n    # Only dry-rb rules are valid here\n    email.filled? &amp; password.filled?\n  end\n\n  # Or\n\n  validate(:email_and_password: [:email, :password]) do |email, password|\n    # Example, do what you need here\n    # Any Ruby code is valid here\n    email.filled? &amp;&amp; password.filled?\n  end\nend\n</code></pre>\n\n<p>Maybe you will need to set <code>:email</code> and <code>:password</code> to optional here, and ensure they're filled inside <code>rule</code> or <code>validate</code> block.</p>\n"}, {"tags": [], "owner": {"reputation": 830, "user_id": 4468613, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/cvOh0.jpg?s=128&g=1", "display_name": "Danny Santos", "link": "https://stackoverflow.com/users/4468613/danny-santos"}, "is_accepted": false, "score": 0, "last_activity_date": 1559732102, "creation_date": 1559732102, "answer_id": 56459080, "question_id": 44526777, "link": "https://stackoverflow.com/questions/44526777/2-field-validation-in-hanami-dry-validation/56459080#56459080", "title": "2 field validation in Hanami + dry-validation", "body": "<p>I don't fully understand what you're trying to achieve, it seems as though you're attempting to validate whether the email and/or password match the ones in your database? If so then you're doing it in the wrong place, validators are intended to validate the <strong>params only</strong>. So if the email is in the wrong format, or the password and password confirmation don't match, a validation can catch that and provide the right error message. If you're looking to verify details against the database then this is something that should be done in the interactor.</p>\n\n<p>m45t3r is correct in saying that if you do want to validate two dependent attributes then a rule is probably the way to go.</p>\n\n<p>As for your broken link, the Hanami guides got moved a while back and the old links don't seem to have been forwarded too well! The current docs for validations, and specifically rules, can be found <a href=\"https://guides.hanamirb.org/validations/advanced-usage/#rules\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 41, "user_id": 3310215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc2358443d621d95d3e1a348231859f?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Souza", "link": "https://stackoverflow.com/users/3310215/diego-souza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 776, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1559732102, "creation_date": 1497370684, "question_id": 44526777, "link": "https://stackoverflow.com/questions/44526777/2-field-validation-in-hanami-dry-validation", "title": "2 field validation in Hanami + dry-validation", "body": "<p>I've been trying to validate a sign in process using Hanami (which is on top of <a href=\"https://github.com/dry-rb/dry-validation\" rel=\"nofollow noreferrer\">dry-validation</a>).</p>\n\n<p>The point is: how to validate someting related to 2 fields: email + password?</p>\n\n<p>I've read about custom predicates, but they seem to be only per field. Another concept is rule, but according to the examples it doesn't relate 2 things the way I need.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>module Web::Controllers::Sessions\n  class Create\n    include Web::Action\n\n    expose :validation # my standard way to show errors in the template\n\n    def call(params)\n      @validation = SigninValidator.new(params[:user]).validate\n      if @validation.success? \n      # more stuff here\n    end\n  end\nend\n\nclass SigninValidator\n  include Hanami::Validations::Form\n\n  validations do\n    required(:email) { format?(EMAIL_REGEX)}\n    required(:password).filled(:str?)\n\n    # I GOT CONFUSED HERE\n    # how could I use someting like a repository and relate something like \n    # predicate + message for \"email or password doesn't match\"\n\n  end\nend\n</code></pre>\n\n<p>Unfortunately the <a href=\"http://hanamirb.org/guides/validations/overview/\" rel=\"nofollow noreferrer\">validations section in Hanami Guide</a> is empty and I couldn't find a solution looking at the sources (hanami-validation and dry-validation).</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1497370195, "post_id": 44526485, "comment_id": 76044948, "body": "I would argue that <code>@test</code> is assigned, but <code>@test.score</code> return <code>nil</code>? Please ensure that <code>score</code> always returns a number."}], "answers": [{"comments": [{"owner": {"reputation": 1740, "user_id": 6749371, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/1fb6335a13491c2ead854c6c24a81771?s=128&d=identicon&r=PG&f=1", "display_name": "J Seabolt", "link": "https://stackoverflow.com/users/6749371/j-seabolt"}, "edited": false, "score": 0, "creation_date": 1497370660, "post_id": 44526661, "comment_id": 76045248, "body": "Thank you! I appreciate the help"}], "tags": [], "owner": {"reputation": 46, "user_id": 6525362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6da53e17150fe5d83f10ee3bed0e2af?s=128&d=identicon&r=PG&f=1", "display_name": "Amin Arria", "link": "https://stackoverflow.com/users/6525362/amin-arria"}, "is_accepted": true, "score": 2, "last_activity_date": 1497370282, "creation_date": 1497370282, "answer_id": 44526661, "question_id": 44526485, "link": "https://stackoverflow.com/questions/44526485/rspec-test-for-update-within-another-action/44526661#44526661", "title": "RSpec test for update within another action", "body": "<p>Actually it is telling you that <code>test.score</code> is <strong>nil</strong>. </p>\n\n<p>You could solve it in two ways:</p>\n\n<ul>\n<li>When creating a test instace set its score to 0 with a before_create callback</li>\n<li>In the controller after <code>@test = Test.find(params[:id])</code>: <code>@test.score = 0 if @test.score.nil?</code></li>\n</ul>\n\n<p>PS: I would add a validation to ensure score is an integer</p>\n"}, {"tags": [], "owner": {"reputation": 921, "user_id": 3172183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dscm0.png?s=128&g=1", "display_name": "amrdruid", "link": "https://stackoverflow.com/users/3172183/amrdruid"}, "is_accepted": false, "score": 0, "last_activity_date": 1497373958, "creation_date": 1497373958, "answer_id": 44527705, "question_id": 44526485, "link": "https://stackoverflow.com/questions/44526485/rspec-test-for-update-within-another-action/44527705#44527705", "title": "RSpec test for update within another action", "body": "<p>This is because the score is equal to <code>nil</code> in the <code>Test</code> object</p>\n\n<p>You can create a new migration to ensure that on the database level, you'll always have a score which initially should be <code>0</code></p>\n\n<pre><code>class ChangeTestsScoreNull &lt; ActiveRecord::Migration\n  def change\n    change_column_null :tests, :score, 0\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1740, "user_id": 6749371, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/1fb6335a13491c2ead854c6c24a81771?s=128&d=identicon&r=PG&f=1", "display_name": "J Seabolt", "link": "https://stackoverflow.com/users/6749371/j-seabolt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 44526661, "answer_count": 2, "score": 0, "last_activity_date": 1497373958, "creation_date": 1497369733, "question_id": 44526485, "link": "https://stackoverflow.com/questions/44526485/rspec-test-for-update-within-another-action", "title": "RSpec test for update within another action", "body": "<p>I am building an application in Rails 5 that sends user inputs back to a controller called \"TestsController.\" If the params[:answer] matches the \"correct_answer\" in the controller action, the \"test\" object, which the TestsController controls, will have it's \"score\" increased by 1. If the answer does not match, the score is not increased. </p>\n\n<p>Here is that action: </p>\n\n<pre><code>def question1 \n    @test = Test.find(params[:id])\n    correct_answer = \"&lt;p&gt;\"\n    user_answer = params[:answer]\n    if user_answer == correct_answer\n        flash.now[:success] = \"That is correct!\"\n        new_score = @test.score += 1\n        @test.update(score: new_score)\n    elsif params[:answer].present? &amp;&amp; params[:answer] != correct_answer\n        flash.now[:danger] = \"Wrong answer.\" \n    end\nend\n</code></pre>\n\n<p>Here is the RSpec test I attempted to write for this controller action: </p>\n\n<pre><code>describe 'GET #question1' do \n\n    it 'updates score if params match answer' do \n        get :question1, params: { id: test1.id, answer: '&lt;p&gt;'}\n        expect(test1.score).to eq(1)\n    end \n\nend\n</code></pre>\n\n<p>This test throws this error: </p>\n\n<pre><code>1) TestsController GET #question1 updates score if params match answer\n Failure/Error: new_score = @test.score += 1\n\n NoMethodError:\n   undefined method `+' for nil:NilClass\n</code></pre>\n\n<p>I am unsure what I am doing wrong. It seems the @test object is not being assigned... although I wrote another test in this same RSpec file that says it IS being assigned. Plus this works in the app, just not in the test. Can someone help? </p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 2, "creation_date": 1497368997, "post_id": 44526179, "comment_id": 76044148, "body": "Did you run <code>rails generate rspec:install</code>?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1497370761, "post_id": 44526179, "comment_id": 76045305, "body": "Does the file <code>spec&#47;spec_helper.rb</code> exist? This file normally gets auto-generated, but if you could easily add it manually."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1497370824, "post_id": 44526179, "comment_id": 76045354, "body": "The very first line of your file <code>spec&#47;00_hello_spec.rb</code> probably says <code>require &quot;spec_helper&quot;</code>, and the file does not exist. That is what the error message is telling you."}, {"owner": {"reputation": 21, "user_id": 7668509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6cf0ce093a90ae7ae6b22f8289d6f51?s=128&d=identicon&r=PG&f=1", "display_name": "Kabanica", "link": "https://stackoverflow.com/users/7668509/kabanica"}, "edited": false, "score": 0, "creation_date": 1497521248, "post_id": 44526179, "comment_id": 76118033, "body": "I added the spec_helper using &#39;rspec --init&#39;. Now it saying this:bundler: failed to load command: rspec (/Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bu&zwnj;&#8203;ndle/ruby/2.4.0/bin/&zwnj;&#8203;rspec) NoMethodError: undefined method `shared_context_metadata_behavior=&#39; for #&lt;RSpec::Core::Configuration:0x007fdc263c6630&gt;"}, {"owner": {"reputation": 21, "user_id": 7668509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6cf0ce093a90ae7ae6b22f8289d6f51?s=128&d=identicon&r=PG&f=1", "display_name": "Kabanica", "link": "https://stackoverflow.com/users/7668509/kabanica"}, "edited": false, "score": 0, "creation_date": 1497550594, "post_id": 44526179, "comment_id": 76137335, "body": "Thank you so much to everyone. With your suggestions and so googled tips, I was able finally get it working."}, {"owner": {"reputation": 2068, "user_id": 147844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94c60454380849acb098f6a72ad7f6fd?s=128&d=identicon&r=PG", "display_name": "Andrew Farrell", "link": "https://stackoverflow.com/users/147844/andrew-farrell"}, "edited": false, "score": 2, "creation_date": 1565176219, "post_id": 44526179, "comment_id": 101267864, "body": "&gt; I was able to get it working  What was the command which accomplished this?"}, {"owner": {"reputation": 8714, "user_id": 306084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/546ee016aba112078e62861bdc38ae69?s=128&d=identicon&r=PG", "display_name": "pjmorse", "link": "https://stackoverflow.com/users/306084/pjmorse"}, "edited": false, "score": 1, "creation_date": 1596538825, "post_id": 44526179, "comment_id": 111836888, "body": "This kind of comment - &quot;Oh, never mind, I figured it out&quot; - is ridiculously unhelpful for anyone else who finds this question later after searching the error message."}], "owner": {"reputation": 21, "user_id": 7668509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6cf0ce093a90ae7ae6b22f8289d6f51?s=128&d=identicon&r=PG&f=1", "display_name": "Kabanica", "link": "https://stackoverflow.com/users/7668509/kabanica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5757, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1614618459, "creation_date": 1497368895, "last_edit_date": 1497368948, "question_id": 44526179, "link": "https://stackoverflow.com/questions/44526179/bundler-failed-to-load-command-rspec", "title": "bundler: failed to load command: rspec", "body": "<p>I am new to Rails and I want to run Rspec using Mac.</p>\n\n<p>When I run: </p>\n\n<pre><code>bundle exec rspec spec/00_hello_spec.rb \n</code></pre>\n\n<p>I get the following response:</p>\n\n<pre><code>bundler: failed to load command: rspec (/Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/bin/rspec)\nLoadError: cannot load such file -- spec_helper\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/configuration.rb:1181:in `require'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/configuration.rb:1181:in `block in requires='\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/configuration.rb:1181:in `each'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/configuration.rb:1181:in `requires='\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/configuration_options.rb:110:in `block in process_options_into'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/configuration_options.rb:109:in `each'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/configuration_options.rb:109:in `process_options_into'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/configuration_options.rb:22:in `configure'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/runner.rb:96:in `setup'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/runner.rb:85:in `run'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/runner.rb:70:in `run'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/lib/rspec/core/runner.rb:38:in `invoke'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/gems/rspec-core-3.2.3/exe/rspec:4:in `&lt;top (required)&gt;'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/bin/rspec:22:in `load'\n  /Users/OumouKaba/Downloads/test-first-ruby-master/vendor/bundle/ruby/2.4.0/bin/rspec:22:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>Please help with any suggestions or clarification on this issue. To add, I have done this at various level of the file system from root upward. I highly appreciate any clarifications to help me out of my dilemma. </p>\n"}, {"tags": ["arrays", "ruby", "ruby-hash"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497369186, "post_id": 44526171, "comment_id": 76044273, "body": "<i>&quot;I have tried using merge&quot;</i> \u2013 could you show your attempt?"}, {"owner": {"reputation": 264, "user_id": 5451470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c53b4d1f3a1cb6ba56676a8ca27d3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5451470/ravi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497369289, "post_id": 44526171, "comment_id": 76044337, "body": "Merge returns this <code>{:amount=&gt;952000, :gross_amount=&gt;952000, :tax=&gt;152000, :hotel_fees=&gt;0, :base_fare=&gt;800000, :currency=&gt;nil}</code>"}, {"owner": {"reputation": 264, "user_id": 5451470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c53b4d1f3a1cb6ba56676a8ca27d3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5451470/ravi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497369331, "post_id": 44526171, "comment_id": 76044374, "body": "I can&#39;t have the currency nil."}, {"owner": {"reputation": 264, "user_id": 5451470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c53b4d1f3a1cb6ba56676a8ca27d3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5451470/ravi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497369360, "post_id": 44526171, "comment_id": 76044391, "body": "My attempt: <code>p[0].merge(p[1]){|k,v1,v2| (v1+v2)&#47;2 unless v1 &amp;&amp; v2 == &quot;INR&quot;}</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497369402, "post_id": 44526171, "comment_id": 76044422, "body": "It&#39;s a bit hard to read code in comments, you you edit your question instead?"}], "answers": [{"comments": [{"owner": {"reputation": 264, "user_id": 5451470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c53b4d1f3a1cb6ba56676a8ca27d3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5451470/ravi"}, "edited": false, "score": 0, "creation_date": 1497371997, "post_id": 44526463, "comment_id": 76046104, "body": "ohh I thought it was some thing else."}], "tags": [], "owner": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "is_accepted": false, "score": 3, "last_activity_date": 1497369685, "creation_date": 1497369685, "answer_id": 44526463, "question_id": 44526171, "link": "https://stackoverflow.com/questions/44526171/adding-hashes-from-an-array/44526463#44526463", "title": "Adding Hashes from an array", "body": "<p>Irb</p>\n\n<pre><code>2.2.3 :011 &gt; b = {test1: 30, test2: 40}\n =&gt; {:test1=&gt;30, :test2=&gt;40} \n2.2.3 :012 &gt; a = {test1: 20, test2: 60}\n =&gt; {:test1=&gt;20, :test2=&gt;60} \n2.2.3 :013 &gt; c = a.merge(b){|key, oldval, newval| (newval + oldval)/2}\n =&gt; {:test1=&gt;25, :test2=&gt;50} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 264, "user_id": 5451470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c53b4d1f3a1cb6ba56676a8ca27d3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5451470/ravi"}, "edited": false, "score": 0, "creation_date": 1497370647, "post_id": 44526494, "comment_id": 76045235, "body": "What is <code>_</code> in <code>|_,a,b|</code> doing? Can you please explain?"}, {"owner": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "reply_to_user": {"reputation": 264, "user_id": 5451470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c53b4d1f3a1cb6ba56676a8ca27d3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5451470/ravi"}, "edited": false, "score": 0, "creation_date": 1497371060, "post_id": 44526494, "comment_id": 76045491, "body": "@Ravi it&#39;s explained in my answer, first attribute is key, he called it _ second attribute is the old value, or value from the first hash, third attribute is the new value or value from the second hash"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1497371392, "post_id": 44526494, "comment_id": 76045683, "body": "<code>_</code> corresponds to the hash&#39;s key, it could be named as you want, but as I&#39;m not using it but it must be references then I assign it as <code>_</code>, that means that&#39;s something that&#39;s needed to make the block works, but won&#39;t be used inside."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1497388760, "post_id": 44526494, "comment_id": 76055110, "body": "The question mentions &quot;multiple hashes&quot;, not just 2 hashes."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1498658798, "last_edit_date": 1498658798, "creation_date": 1497369745, "answer_id": 44526494, "question_id": 44526171, "link": "https://stackoverflow.com/questions/44526171/adding-hashes-from-an-array/44526494#44526494", "title": "Adding Hashes from an array", "body": "<p>For two hashes in array you could use <code>inject</code> and <code>merge</code> checking if the value for the both <code>currency</code> keys are Fixnum class, if not, then take the value of currency <code>\"INR\"</code> in the first hash and use it:</p>\n\n<pre><code>array = [\n  {:amount=&gt;897500,  :gross_amount=&gt;897500,  :tax=&gt;147500, :hotel_fees=&gt;0, :base_fare=&gt;750000, :currency=&gt;\"INR\"}, \n  {:amount=&gt;1006500, :gross_amount=&gt;1006500, :tax=&gt;156500, :hotel_fees=&gt;0, :base_fare=&gt;850000, :currency=&gt;\"INR\"}\n]\n\np array.inject{|k,v| k.merge(v){|_,a,b| [a,b].all?{|e| e.is_a?(Fixnum)} ? (a+b)/2 : b}}\n# =&gt; {:amount=&gt;952000, :gross_amount=&gt;952000, :tax=&gt;152000, :hotel_fees=&gt;0, :base_fare=&gt;800000, :currency=&gt;\"INR\"}\n</code></pre>\n\n<p>For two or more hashes in an array you could try with:</p>\n\n<pre><code>main_array = [\n  {:amount=&gt;897500,  :gross_amount=&gt;897500,  :tax=&gt;147500, :hotel_fees=&gt;0, :base_fare=&gt;750000, :currency=&gt;\"INR\"}, \n  {:amount=&gt;1006500, :gross_amount=&gt;1006500, :tax=&gt;156500, :hotel_fees=&gt;0, :base_fare=&gt;850000, :currency=&gt;\"INR\"},\n  {:amount=&gt;1006500, :gross_amount=&gt;1006500, :tax=&gt;156500, :hotel_fees=&gt;0, :base_fare=&gt;850000, :currency=&gt;\"INR\"},\n]\narray_result = main_array.flat_map(&amp;:to_a).group_by(&amp;:first).map do |key, array| \n  { \n    key =&gt; (\n      result = array.inject(0) do |total, (_, value)| \n        value.is_a?(Fixnum) ? total + value : value\n      end \n      result.is_a?(Fixnum) ? result / main_array.size : result \n    ) \n  } \nend\np array_result\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 264, "user_id": 5451470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c53b4d1f3a1cb6ba56676a8ca27d3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5451470/ravi"}, "edited": false, "score": 0, "creation_date": 1497460766, "post_id": 44527498, "comment_id": 76092452, "body": "I know it won&#39;t work for more than two hash. I just wanted an idea on how I could handle it. I was on the right path but couldn&#39;t get correct answer. My problem never was totally different and various other things were involved. This was just a part of it where I was getting confused. The solution I have used is somewhat similar to yours. Check my edit."}], "tags": [], "owner": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "is_accepted": false, "score": 2, "last_activity_date": 1497377493, "last_edit_date": 1497377493, "creation_date": 1497373229, "answer_id": 44527498, "question_id": 44526171, "link": "https://stackoverflow.com/questions/44526171/adding-hashes-from-an-array/44527498#44527498", "title": "Adding Hashes from an array", "body": "<p>The accepted answer will not work for more than 2 hashes, since <code>merge</code> works only 2 by 2 and you are calculating average here.</p>\n\n<pre><code>(((3 + 2) / 2) + 2.5) / 2 is different from (3 + 2 + 2.5) / 3\n</code></pre>\n\n<p>So I wrote a piece of code that could do what you want for whatever size of array you have</p>\n\n<pre><code>  def self.merge_all_and_average(array)\n    new_hash = {}\n    unless array.empty?\n      array[0].keys.each do |key|\n        if array[0][key].class == Fixnum\n          total = array.map { |i| i[key] }.inject(0) { |sum, x| sum + x }\n          new_hash = new_hash.merge(key =&gt; total / array.size)\n        else\n          new_hash = new_hash.merge(key =&gt; array[0][key])\n        end\n      end\n    end\n    new_hash\n  end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 264, "user_id": 5451470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c53b4d1f3a1cb6ba56676a8ca27d3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5451470/ravi"}, "edited": false, "score": 0, "creation_date": 1497461984, "post_id": 44531642, "comment_id": 76093194, "body": "I am doing something similar as well but this method increases my complexity of the code."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1497388262, "creation_date": 1497388262, "answer_id": 44531642, "question_id": 44526171, "link": "https://stackoverflow.com/questions/44526171/adding-hashes-from-an-array/44531642#44531642", "title": "Adding Hashes from an array", "body": "<p>This should work with any number of hashes:</p>\n\n<pre><code>data = [\n  { amount: 897_500, gross_amount: 897_500, tax: 147_500, hotel_fees: 0, base_fare: 750_000, currency: 'INR' },\n  { amount: 1_006_500, gross_amount: 1_006_500, tax: 156_500, hotel_fees: 0, base_fare: 850_000, currency: 'INR' },\n  { amount: 1_006_500, gross_amount: 1_006_500, tax: 156_500, hotel_fees: 0, base_fare: 850_000, currency: 'INR' }\n]\n\ntransposed_hashes = data.each_with_object(Hash.new{|h, k| h[k] = []}) do |h, mem|\n  h.each do |k, v|\n    mem[k] &lt;&lt; v\n  end\nend\n# {:amount=&gt;[897500, 1006500, 1006500], :gross_amount=&gt;[897500, 1006500, 1006500], :tax=&gt;[147500, 156500, 156500], :hotel_fees=&gt;[0, 0, 0], :base_fare=&gt;[750000, 850000, 850000], :currency=&gt;[\"INR\", \"INR\", \"INR\"]}\n\naverage_hash = transposed_hashes.map do |k, v|\n  new_value = if v[0].is_a? Integer\n                v.sum.to_f / v.size\n              else\n                v[0]\n              end\n  [k, new_value]\nend.to_h\n\nputs average_hash\n# {:amount=&gt;970166.6666666666, :gross_amount=&gt;970166.6666666666, :tax=&gt;153500.0, :hotel_fees=&gt;0.0, :base_fare=&gt;816666.6666666666, :currency=&gt;\"INR\"}\n</code></pre>\n"}], "owner": {"reputation": 264, "user_id": 5451470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c53b4d1f3a1cb6ba56676a8ca27d3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5451470/ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 44526494, "answer_count": 4, "score": 4, "last_activity_date": 1498658798, "creation_date": 1497368888, "last_edit_date": 1497461460, "question_id": 44526171, "link": "https://stackoverflow.com/questions/44526171/adding-hashes-from-an-array", "title": "Adding Hashes from an array", "body": "<p>I am trying to create an array/hash from an array of multiple hashes with same keys and an average of values. My array:</p>\n\n<pre><code>[{:amount=&gt;897500, :gross_amount=&gt;897500, :tax=&gt;147500, :hotel_fees=&gt;0, :base_fare=&gt;750000, :currency=&gt;\"INR\"}, {:amount=&gt;1006500, :gross_amount=&gt;1006500, :tax=&gt;156500, :hotel_fees=&gt;0, :base_fare=&gt;850000, :currency=&gt;\"INR\"}]\n</code></pre>\n\n<p>Now I want to return something like this:</p>\n\n<pre><code>{:amount=&gt;952000, :gross_amount=&gt;952000, :tax=&gt;152000, :hotel_fees=&gt;0, :base_fare=&gt;800000, :currency=&gt;\"INR\"}\n</code></pre>\n\n<p>where values are the average of values from each hash with same key.</p>\n\n<p>Is there a simple way to do this. I have tried using merge but currency becomes 0 with it. </p>\n\n<p>My attempt: </p>\n\n<pre><code>p[0].merge(p[1]){|k,v1,v2| (v1+v2)/2 unless v1 &amp;&amp; v2 == \"INR\"}\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Actually my problem didn't end here, so after getting the average I needed to insert the values inside another hash.\nSo I used something like this:</p>\n\n<pre><code>        price_array = offer_values.map do |v| \n          v.inject do |k, v| \n            k.merge!(price: k[:price].merge(v[:price]){|_, a, b| [a, b].flatten })\n          end\n        end\n        price_array.map do |o|\n          o[:price] = {}.tap{ |h| o[:price].each {|k, list| h[k] = list.all?{|e| [Fixnum, NilClass].include? e.class} ? list.map(&amp;:to_i).sum/list.size : list.compact.first ; h  } }\n        end\n</code></pre>\n\n<p>Where offer_array is the one with my orginal/first array in separate hashes. This I have tried for with 2 and 3 hashes and it is working.</p>\n\n<p>If you guys have any suggestion on improving the code, It am open.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch", "elasticsearch-5", "searchkick"], "owner": {"reputation": 89, "user_id": 6157055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a95cdbd40aceb858b0fbb560c9c5bab9?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Matero", "link": "https://stackoverflow.com/users/6157055/matt-matero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497368359, "creation_date": 1497368359, "question_id": 44525979, "link": "https://stackoverflow.com/questions/44525979/elasticsearch-5-x-searchkickrails-configuration", "title": "elasticsearch 5.X + searchkick(rails) configuration", "body": "<p>I'm in the process of upgrading my elasticsearch instance from V1.7 to 5.3 and I'm running into some errors when starting my reindex. From what I can tell most models can index just fine but there are a couple I had that used more advanced settings that don't seem to be working. Here's an example of one of my models(brand.rb):</p>\n\n<pre><code>searchkick word_start: [:name],\n  merge_mappings: true,\n  mappings: searchkick_mappings,\n  settings: searchkick_settings\n\ndef search_data\n  attributes.merge(\n    geography: self.geography ? self.geography.name : \"\",\n    geography_breadcrumb: self.geography ? self.geography.breadcrumb : \"\",\n    producer_name: self.producer.name\n  )\nend\n</code></pre>\n\n<p>the searchkick_mappings and searchkick_settings are defined in another file that is included in my model. Here's the code:</p>\n\n<pre><code>def searchkick_mappings\n  {\n    brand: {\n      properties: {\n        name: {\n          type: 'text',\n          analyzer: 'standard',\n          fields: {\n            autocomplete: {\n              type: 'text',\n              analyzer: 'autocomplete'\n            },\n            folded: {\n              type: 'text',\n              analyzer: 'folded'\n            },\n            delimited: {\n              type: 'text',\n              analyzer: 'delimited'\n            }\n          }\n        }\n      }\n    }\n  }\nend\n\ndef searchkick_settings\n  {\n    analysis: {\n      filter: {\n        autocomplete_filter: {\n          type: 'edge_ngram',\n          min_gram: 1,\n          max_gram: 20\n        },\n        delimiter_filter: {\n          type: 'word_delimiter',\n          preserve_original: true\n        }\n      },\n      analyzer: {\n        folded: {\n          type: 'custom',\n          tokenizer: 'standard',\n          filter: ['standard','lowercase','asciifolding']\n        },\n        delimited: {\n          type: 'custom',\n          tokenizer: 'whitespace',\n          filter: ['lowercase','delimiter_filter']\n        },\n        autocomplete: {\n          type: 'custom',\n          tokenizer: 'standard',\n          filter: ['standard','lowercase', 'asciifolding', \n                  'autocomplete_filter']\n        }\n      }\n    }\n  }\nend\n</code></pre>\n\n<p>The only change I made from when it was working in V1.7 -> 5.3 is that I had to change the 'type' field from \"String\" to \"text\" as it seems they removed the string type in favor of a text and keyword type, where text is analyzed and keywords are not. The error i'm receiving when I run bundle exec searchkick:reindex:all is saying there is an unknown parameter 'ignore_above'. From reading the documentation it seems that parameter is only for keyword fields and not text but I am not adding that parameter in my custom mappings so I don't see why it would be there. </p>\n\n<p>Let me know if you need to see more code/need to know more. I'll gladly edit OP/comment whatever is helpful.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1497369777, "post_id": 44525818, "comment_id": 76044673, "body": "Well that&#39;s great, but would love to hear why @sagarpandya82"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1497377393, "post_id": 44525818, "comment_id": 76049040, "body": "While <code>map</code> iterates like <code>each</code> does, they&#39;re different tools. In actual use we see people try to use <code>each</code> when they should use <code>map</code> and they end up writing more code. Conversely, they&#39;ll use <code>map</code> instead of <code>each</code> and end up writing too much code also. <code>map</code> is for changing values, <code>each</code> is for looping over them. You can force an overlap but that&#39;s going against the flow so learn when to use each of them."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1497377977, "post_id": 44525818, "comment_id": 76049385, "body": "When you have to use compact after a map the odds are really good you did something wrong, such as use a conditional in the block that doesn&#39;t return a value. EVERY loop of a map block should return a usable value. If you&#39;re throwing the values away with compact your code is wasting CPU time and you should have determined which values to work on using <code>select</code> or <code>reject</code> prior to passing that reduced set to <code>map</code>."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1497379259, "post_id": 44525818, "comment_id": 76050118, "body": "To put it another way, your example <i>would be</i> the right way to use <code>map</code> iif the result you <i>wanted</i> was an array with <code>nil</code>s in place of values not equal to <code>2</code> and <code>4</code>. Since that&#39;s not the result you want (as evidenced by the need for <code>compact</code>), <code>map</code> is the wrong choice here."}], "answers": [{"comments": [{"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1497376387, "post_id": 44527389, "comment_id": 76048485, "body": "This is a great example of Ruby: Great flexibility but needs to be applied carefully. Thanks for the clarification."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1497384572, "post_id": 44527389, "comment_id": 76052934, "body": "@MaximFedotov thanks for the accept, but probably the wrong choice. Although somewhat useful I don&#39;t think this answer deals with your issue and example. I would even go so far as to say the example I have given is pointless. The other comments and answers deal with why <code>map</code> is the wrong choice sometimes and when not to use it."}, {"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1497432214, "post_id": 44527389, "comment_id": 76071875, "body": "I think you should take more credit for your answer. While Tin Man answer is great and was interesting to see CPU and memory utilisation angle, yours was exactly on point with what I was asking about. Moreover, @meager comment on your other answer also gave some extra context. So I&#39;d like to keep your answer as accepted."}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": true, "score": 4, "last_activity_date": 1497377591, "last_edit_date": 1497377591, "creation_date": 1497372890, "answer_id": 44527389, "question_id": 44525818, "link": "https://stackoverflow.com/questions/44525818/correct-semantic-usage-of-map/44527389#44527389", "title": "Correct semantic usage of map", "body": "<p>In Computer Science, <code>map</code> according to <a href=\"https://en.wikipedia.org/wiki/Map_(higher-order_function)\" rel=\"nofollow noreferrer\">Wikipedia</a>:</p>\n\n<blockquote>\n  <p>In many programming languages, <code>map</code> is the name of a higher-order\n  function that applies a given function to each element of a list,\n  returning a list of results in the same order</p>\n</blockquote>\n\n<p>This statement implies the returned value of <code>map</code> should be of the same length (because we're applying the function to each element). And the returned-elements are to be in the same order. So when you use <code>map</code>, this is what the reader expects.</p>\n\n<h3>How not to use <code>map</code></h3>\n\n<pre><code>arr.map {|i| arr.pop } #=&gt; [3, 2]\n</code></pre>\n\n<p>This clearly betrays the intention of <code>map</code> since we have a different number of elements returned and they are not even in the original order of application. So don't use <code>map</code> like this. See \"<a href=\"https://stackoverflow.com/questions/38333867/how-to-use-rubys-value-at-to-get-subhashes-in-a-hash/38334344#38334344\">How to use ruby&#39;s value_at to get subhashes in a hash</a>\" and subsequent comments for further clarification and thanks to @meager for originally pointing this out to me.</p>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 4, "last_activity_date": 1497378870, "creation_date": 1497378870, "answer_id": 44529056, "question_id": 44525818, "link": "https://stackoverflow.com/questions/44525818/correct-semantic-usage-of-map/44529056#44529056", "title": "Correct semantic usage of map", "body": "<p>Meditate on this:</p>\n\n<pre><code>array = [1,2,3,4]\n\narray.map{|num| num unless num == 2 || num == 4} # =&gt; [1, nil, 3, nil]\n    .compact # =&gt; [1, 3]\n</code></pre>\n\n<p>The intermediate value is an array of the same size, however it contains undesirable values, forcing the use of <code>compact</code>. The fallout of this is CPU time is wasted generating the nil values, then deleting them. In addition, memory is being wasted generating another array that is the same size when it shouldn't be. Imagine the CPU and memory cost in a loop that is processing thousands of elements in an array.</p>\n\n<p>Instead, using the right tool cleans up the code and avoids wasting CPU or memory:</p>\n\n<pre><code>array.reject { |num| num == 2 || num == 4 } # =&gt; [1, 3]\n</code></pre>\n\n<blockquote>\n  <p>I've been using map and other Enumerator methods for ages and never thought about this too much.</p>\n</blockquote>\n\n<p>I'd recommend thinking about it. It's the little things like this that can make or break code or a system, and everything we do when programming needs to be done deliberately, avoiding all negative side-effects we can foresee. </p>\n"}], "owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 44527389, "answer_count": 2, "score": 2, "last_activity_date": 1497379037, "creation_date": 1497367883, "last_edit_date": 1497379037, "question_id": 44525818, "link": "https://stackoverflow.com/questions/44525818/correct-semantic-usage-of-map", "title": "Correct semantic usage of map", "body": "<p>I am trying to understand what is a semantically right way to use <code>map</code>. As <code>map</code> can behave the same way as <code>each</code>, you could modify the array any way you like. But I've been told by my colleague that after <code>map</code> is applied, array should have \n<strong>the same order and the same size</strong>. </p>\n\n<p>For example, that would mean using the map to return an updated array won't be the right way to use <code>map</code>:</p>\n\n<pre><code>array = [1,2,3,4]\narray.map{|num| num unless num == 2 || num == 4}.compact\n</code></pre>\n\n<p>I've been using <code>map</code> and other <code>Enumerator</code> methods for ages and never thought about this too much. Would appreciate advice from experienced Ruby Developers. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "facebook-chatbot"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1497367970, "post_id": 44525405, "comment_id": 76043405, "body": "You can use <code>include?</code>, that&#39;s slightly faster than applying regex <code>&#39;A string that contains bla&#39;.include?(&#39;bla&#39;) ? do_this : do_another_thing</code>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1497379206, "post_id": 44525405, "comment_id": 76050081, "body": "Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. What have you tried? Show us the minimum code necessary to demonstrate your attempt to solve this, and describe what it is not doing correctly. Without that you&#39;re asking us to write code for you, or to write a tutorial, both of which are off topic. I&#39;d recommend learning about <code>case</code>/<code>when</code> and how regular expressions work."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 7807561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sYeFP.jpg?s=128&g=1", "display_name": "Miko\u0142aj Wawrzyniak", "link": "https://stackoverflow.com/users/7807561/miko%c5%82aj-wawrzyniak"}, "is_accepted": false, "score": 0, "last_activity_date": 1497367444, "creation_date": 1497367444, "answer_id": 44525658, "question_id": 44525405, "link": "https://stackoverflow.com/questions/44525405/parse-received-message-in-ruby/44525658#44525658", "title": "Parse Received Message in Ruby", "body": "<p>I'm not sure if i get what is your intention, but you either could use <code>gsub</code> method <a href=\"https://apidock.com/ruby/String/gsub/%22gsub%20docs%22\" rel=\"nofollow noreferrer\">docs</a> if you want to replace occurrences of given patterns in responses.</p>\n\n<p>Or simply use conditional statements to match given regexs like:</p>\n\n<pre><code>  if /this/.match(message.reply)\n     reply = 'that'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": false, "score": 1, "last_activity_date": 1497367599, "creation_date": 1497367599, "answer_id": 44525715, "question_id": 44525405, "link": "https://stackoverflow.com/questions/44525405/parse-received-message-in-ruby/44525715#44525715", "title": "Parse Received Message in Ruby", "body": "<p>You can use substring indexing:</p>\n\n<pre><code>definite_article = message.reply['this'] ? 'that' : 'this'\n</code></pre>\n"}], "owner": {"reputation": 493, "user_id": 5481342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c57c2f8524b837c99bded0d1bc1a84?s=128&d=identicon&r=PG&f=1", "display_name": "msalihbindak", "link": "https://stackoverflow.com/users/5481342/msalihbindak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1515849233, "creation_date": 1497366728, "last_edit_date": 1515849233, "question_id": 44525405, "link": "https://stackoverflow.com/questions/44525405/parse-received-message-in-ruby", "title": "Parse Received Message in Ruby", "body": "<p>I am coding a Facebook Messenger ChatBot with Ruby on Rails.</p>\n\n<p>I create a database for responses. If message exist in my database it replies, else reply as \"Sorry not found.\"</p>\n\n<pre><code>  ....\n  def analysis(sender, text)\n\n    message = Message.where(:recieved =&gt; text).first\n    if message\n      reply = message.reply\n    else\n      reply = \"Sorry not found\"\n    end\n    send_message(sender,reply)\n  end\n  ....\n</code></pre>\n\n<p>I want to add regex match like conditions. Like this: If message contains \"this\" word. reply with \"that\".</p>\n\n<p>How can I do this? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-i18n"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1497379378, "post_id": 44524481, "comment_id": 76050182, "body": "Welcome to Stack Overflow. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and the linked pages and &quot;<a href=\"http://meta.stackoverflow.com/questions/261592\">How much research effort is expected of Stack Overflow users?</a>&quot;. Your question isn&#39;t asked well. Did you search? If not why? If so, where and why didn&#39;t it help? Did you write code? If not, why? If so, what is the minimum code necessary to demonstrate the problem you&#39;re asking about?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1497366927, "post_id": 44525441, "comment_id": 76042707, "body": "In your example, you&#39;re using already humanized string. And your regex is off."}, {"owner": {"reputation": 3867, "user_id": 3906189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/432b41df14bd9197f1b8601cabf49386?s=128&d=identicon&r=PG", "display_name": "siegy22", "link": "https://stackoverflow.com/users/3906189/siegy22"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1497367083, "post_id": 44525441, "comment_id": 76042808, "body": "Oops, my bad.. what do you mean by &quot;regex is off&quot;?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1497367121, "post_id": 44525441, "comment_id": 76042826, "body": "It doesn&#39;t do what you think it would. :) Try it."}, {"owner": {"reputation": 3867, "user_id": 3906189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/432b41df14bd9197f1b8601cabf49386?s=128&d=identicon&r=PG", "display_name": "siegy22", "link": "https://stackoverflow.com/users/3906189/siegy22"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1497367407, "post_id": 44525441, "comment_id": 76043025, "body": "Good catch tho! Don&#39;t know how I messed it up that it would print thirty-one in the first place.. @SergioTulentsev the regex now should be okay, right?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1497367544, "post_id": 44525441, "comment_id": 76043109, "body": "Yes, better now!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1497367622, "post_id": 44525441, "comment_id": 76043157, "body": "&quot;Don&#39;t know how I messed it up&quot; - Your string was humanized to begin with, and then the regex did nothing"}], "tags": [], "owner": {"reputation": 3867, "user_id": 3906189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/432b41df14bd9197f1b8601cabf49386?s=128&d=identicon&r=PG", "display_name": "siegy22", "link": "https://stackoverflow.com/users/3906189/siegy22"}, "is_accepted": true, "score": 4, "last_activity_date": 1497367694, "last_edit_date": 1497367694, "creation_date": 1497366809, "answer_id": 44525441, "question_id": 44524481, "link": "https://stackoverflow.com/questions/44524481/how-to-pluralize-in-rails-with-words/44525441#44525441", "title": "How to pluralize in rails with words?", "body": "<p>I think what you're looking for is <a href=\"https://github.com/radar/humanize\" rel=\"nofollow noreferrer\">humanize</a>:</p>\n\n<pre><code>2.humanize  # =&gt; \"two\"\n4.humanize  # =&gt; \"four\"\n8.humanize  # =&gt; \"eight\"\n</code></pre>\n\n<p>Or in your case:</p>\n\n<pre><code>str = \"The Patriots came back to win the Superbowl by scoring 31 points in a row.\"\nhumanized = str.gsub(/\\d+/) do |match|\n  match.to_i.humanize  \nend    \nhumanized # =&gt; \"The Patriots came back to win the Superbowl by scoring thirty-one points in a row.\"\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 823361, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/791eec2d0fa2c2b13f88a969b81ce9c0?s=128&d=identicon&r=PG", "display_name": "gards", "link": "https://stackoverflow.com/users/823361/gards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 1, "accepted_answer_id": 44525441, "answer_count": 1, "score": 0, "last_activity_date": 1497367694, "creation_date": 1497364352, "last_edit_date": 1497364944, "question_id": 44524481, "link": "https://stackoverflow.com/questions/44524481/how-to-pluralize-in-rails-with-words", "title": "How to pluralize in rails with words?", "body": "<p>I'd like to pluralize a translation with words for the numbers instead of numerals. </p>\n\n<p>So, for example, I'd like to be able to have a translation that results in:</p>\n\n<pre><code>\"The Patriots came back to win the Superbowl by scoring thirty-one points in a row.\"\n</code></pre>\n\n<p>...instead of:</p>\n\n<pre><code>\"The Patriots came back to win the Superbowl by scoring 31 points in a row.\"\n</code></pre>\n\n<p>Is there a way to do this?</p>\n"}, {"tags": ["ruby", "rest", "azure", "azure-monitoring"], "answers": [{"comments": [{"owner": {"reputation": 1638, "user_id": 2753864, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/1xGw0.jpg?s=128&g=1", "display_name": "Gagan93", "link": "https://stackoverflow.com/users/2753864/gagan93"}, "edited": false, "score": 0, "creation_date": 1497369811, "post_id": 44524563, "comment_id": 76044698, "body": "Oops, code was modified when I was pasting here. Correct code now updated @Md. Farhan Memon"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "reply_to_user": {"reputation": 1638, "user_id": 2753864, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/1xGw0.jpg?s=128&g=1", "display_name": "Gagan93", "link": "https://stackoverflow.com/users/2753864/gagan93"}, "edited": false, "score": 0, "creation_date": 1497417642, "post_id": 44524563, "comment_id": 76063011, "body": "how about enclosing them in square brackets in both cases like <code>&quot;[&amp;name.value=#{val[&#39;name&#39;][&#39;value&#39;]}]&quot; and </code>&quot;[&amp;name=#{val[&#39;name&#39;][&#39;value&#39;]}&quot;]`"}, {"owner": {"reputation": 1638, "user_id": 2753864, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/1xGw0.jpg?s=128&g=1", "display_name": "Gagan93", "link": "https://stackoverflow.com/users/2753864/gagan93"}, "edited": false, "score": 0, "creation_date": 1497442518, "post_id": 44524563, "comment_id": 76079539, "body": "The documentation wasn&#39;t clearly explained. This (<a href=\"https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-rest-api-walkthrough\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/&hellip;</a>&zwnj;&#8203;) blog explained it well. A $filter key was required and now it seems to return some other error (which probably can be rectified)"}], "tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": false, "score": 0, "last_activity_date": 1497364562, "creation_date": 1497364562, "answer_id": 44524563, "question_id": 44524368, "link": "https://stackoverflow.com/questions/44524368/filter-not-working-in-azure-monitor-api-for-showing-metrics-value/44524563#44524563", "title": "Filter not working in Azure monitor API for showing metrics value", "body": "<p>It seems a simple GET request, try setting <code>filter</code> as the following</p>\n\n<pre><code>filter = \"&amp;name=#{val['name']['value']}\"\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>filter = \"&amp;name.value=#{val['name']['value']}\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2407, "user_id": 1475557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v5IDO.png?s=128&g=1", "display_name": "John Kemnetz", "link": "https://stackoverflow.com/users/1475557/john-kemnetz"}, "is_accepted": false, "score": 0, "last_activity_date": 1499887632, "creation_date": 1499887632, "answer_id": 45066039, "question_id": 44524368, "link": "https://stackoverflow.com/questions/44524368/filter-not-working-in-azure-monitor-api-for-showing-metrics-value/45066039#45066039", "title": "Filter not working in Azure monitor API for showing metrics value", "body": "<p>The metric API version you are using is for accessing metrics that come through the Azure Monitor pipeline -- you can see that full list here: <a href=\"https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-supported-metrics\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-supported-metrics</a></p>\n\n<p>For other VM metrics, you need to install the agent and use the table storage API to access the data: <a href=\"https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/azure-diagnostics\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/azure-diagnostics</a></p>\n"}], "owner": {"reputation": 1638, "user_id": 2753864, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/1xGw0.jpg?s=128&g=1", "display_name": "Gagan93", "link": "https://stackoverflow.com/users/2753864/gagan93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499887632, "creation_date": 1497364053, "last_edit_date": 1497369790, "question_id": 44524368, "link": "https://stackoverflow.com/questions/44524368/filter-not-working-in-azure-monitor-api-for-showing-metrics-value", "title": "Filter not working in Azure monitor API for showing metrics value", "body": "<p>I extended the example given in azure github repo to get samples of my Virtual machine running on MS Azure. If I don't give any parameter for filtering, it returns metric values for CPU percentage. Now If I give any value for filtering, it doesn't consider it and still returns samples only for CPU percentage only. I am following <a href=\"https://docs.microsoft.com/en-us/rest/api/monitor/metrics#Metrics_List\" rel=\"nofollow noreferrer\">this</a> for getting results. This is the ruby code I am using. Please check once </p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire 'open-uri'\nrequire 'pp'\nrequire 'typhoeus'\nrequire 'azure_mgmt_resources'\n\ndef print_item(group)\n  puts \"\\tName: #{group.name}\"\n  puts \"\\tId: #{group.id}\"\n  puts \"\\tLocation: #{group.location}\"\n  puts \"\\tTags: #{group.tags}\"\n  puts \"\\tType: #{group.type}\" if group.respond_to? :type\n  print_properties(group.properties)\nend\n\ndef print_properties(props)\n  puts \"\\tProperties:\"\n  props.instance_variables.sort.each do |ivar|\n    str = ivar.to_s.gsub /^@/, ''\n    if props.respond_to? str.to_sym\n      puts \"\\t\\t#{str}: #{props.send(str.to_sym)}\"\n    end\n  end\n  puts \"\\n\\n\"\nend\n\nsubscription_id = \"SUB_ID\"\nprovider = MsRestAzure::ApplicationTokenProvider.new(\n  'TENANT_ID'\n  'CLIENT_ID',\n  'CLIENT_SECRET')\ncredentials = MsRest::TokenCredentials.new(provider)\nclient = Azure::ARM::Resources::ResourceManagementClient.new(credentials)\nclient.subscription_id = subscription_id\n\nheaders = {'Content-Type'=&gt; 'application/json', 'Authorization'=&gt; provider.get_authentication_header }\nresp = Typhoeus::Request.get('https://management.azure.com/subscriptions?api-version=2015-01-01', headers: headers)\n\nmetric_definitions_api = \"https://management.azure.com__RESOURCE__/providers/microsoft.insights/metricDefinitions?api-version=2016-03-01\"\nmetrics_samples_api = \"https://management.azure.com__RESOURCE__/providers/microsoft.insights/metrics?api-version=2016-09-01\"\nJSON.parse(resp.body)[\"value\"].each do |subscriptions|\n  puts \"Subscription id : #{subscriptions[\"subscriptionId\"]}\"\n  client.subscription_id = subscriptions[\"subscriptionId\"]\n  puts 'List Resource Groups'\n\n  client.resource_groups.list.each do\n    |group| print_item(group)\n    puts 'List all of the resources within the group'\n    client.resource_groups.list_resources(group.name).each do |resource|\n      if resource.type == 'Microsoft.Compute/virtualMachines'\n        print_item(resource)\n\n        metric_definitions_api = metric_definitions_api.sub('__RESOURCE__', resource.id)\n        resp = Typhoeus::Request.get(metric_definitions_api, headers: headers)\n        puts \"Definitions :\"\n        pp JSON.parse(resp.body)\n\n        metrics_samples_api = metrics_samples_api.sub('__RESOURCE__', resource.id)\n\n        JSON.parse(resp.body)['value'].each do |val|\n          filter = \"&amp;(name.value eq '#{val[\"name\"][\"value\"]}')\"\n          resp = Typhoeus::Request.get( URI::encode(metrics_samples_api + filter), headers: headers)\n          puts \"Samples : #{metrics_samples_api + filter}\"\n          pp JSON.parse(resp.body)[\"value\"][0][\"data\"][0..4] # Return first 5 samples\n          puts \"\\n\"\n        end\n\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "devise"], "answers": [{"tags": [], "owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "is_accepted": true, "score": 3, "last_activity_date": 1497362495, "creation_date": 1497362495, "answer_id": 44523791, "question_id": 44523513, "link": "https://stackoverflow.com/questions/44523513/ror-integration-test-fail/44523791#44523791", "title": "RoR : integration test fail", "body": "<pre><code>UnexpectedError: ActiveRecord::RecordNotUnique: PG::UniqueViolation: ERROR: duplicate key value violates unique constraint \"index_users_on_email\"\n</code></pre>\n\n<p>So what does this error mean? You have some validation in the model level or the db level which will not let you have the duplicate email for Admin. </p>\n\n<p>So I presume that the factory you used to create Admin, is not creating unique email addresses. </p>\n\n<p>Try this</p>\n\n<pre><code>FactoryGirl.define do\n  factory :admin do\n    # your code\n    email { Faker::Internet.email }\n  end\nend\n</code></pre>\n\n<p>But this thing requires faker gem. If you don't want to use a gem just for this, try using sequences in factory girl.</p>\n\n<p>Also it's good to have the database in a clean state, when running tests. Consider using <a href=\"https://github.com/DatabaseCleaner/database_cleaner\" rel=\"nofollow noreferrer\">https://github.com/DatabaseCleaner/database_cleaner</a></p>\n"}], "owner": {"reputation": 3247, "user_id": 2304517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Wv4Xe.png?s=128&g=1", "display_name": "Xero", "link": "https://stackoverflow.com/users/2304517/xero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 44523791, "answer_count": 1, "score": 1, "last_activity_date": 1497362495, "creation_date": 1497361826, "question_id": 44523513, "link": "https://stackoverflow.com/questions/44523513/ror-integration-test-fail", "title": "RoR : integration test fail", "body": "<p>I have 2 integrations tests, here how it's look :</p>\n\n<pre><code>class TagFlowTest &lt; ActionDispatch::IntegrationTest\n\n  include Devise::Test::IntegrationHelpers\n\n  setup do\n    sign_in FactoryGirl.create(:admin)\n    @partner = create(:partner)\n  end\n\n  test 'can see the list of partners' do\n    get '/partners'\n    assert_response :success\n    assert_select 'tr', 2\n  end \n\n... more tests below ...\n</code></pre>\n\n<p>The second test looks the same\nThe thing is that when a launch rails test on this test, it's working fine. But when I launch : </p>\n\n<blockquote>\n  <p>rails test /test/</p>\n</blockquote>\n\n<p>I got an error :</p>\n\n<blockquote>\n  <p>UnexpectedError: ActiveRecord::RecordNotUnique: PG::UniqueViolation:\n  ERROR:  duplicate key value violates unique constraint\n  \"index_users_on_email\"</p>\n</blockquote>\n\n<p>I understand that the issue come from </p>\n\n<pre><code>sign_in FactoryGirl.create(:admin)\n</code></pre>\n\n<p>When I delete this line on the other test, it's working.\nBut if I do that, I cannot test one test only. How can I do the resolve this ?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ubuntu"], "comments": [{"owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "edited": false, "score": 0, "creation_date": 1497362991, "post_id": 44523415, "comment_id": 76039802, "body": "did you try this sudo apt-get install mysql-client libmysqlclient-dev"}, {"owner": {"reputation": 1396, "user_id": 521347, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e25f20cac27e4f5ddc38e86081f8524d?s=128&d=identicon&r=PG", "display_name": "Sumit Desai", "link": "https://stackoverflow.com/users/521347/sumit-desai"}, "reply_to_user": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "edited": false, "score": 0, "creation_date": 1497364933, "post_id": 44523415, "comment_id": 76041226, "body": "@gates Yes, I tried this and as I mentioned, it uninstalled mysql 5.6 and went on with installing mysql 5.7."}], "owner": {"reputation": 1396, "user_id": 521347, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e25f20cac27e4f5ddc38e86081f8524d?s=128&d=identicon&r=PG", "display_name": "Sumit Desai", "link": "https://stackoverflow.com/users/521347/sumit-desai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497363175, "creation_date": 1497361589, "question_id": 44523415, "link": "https://stackoverflow.com/questions/44523415/mysql2-gem-getting-during-installation", "title": "mysql2 gem getting during installation", "body": "<p>I am trying to call 'bundle install' on a folder which contains <strong>ROR</strong> code. It always gets hanged to a single line:-</p>\n\n<pre><code>Installing mysql2 0.3.19 with native extensions\n</code></pre>\n\n<p>I searched for the same issue on google and I found some solutions like <a href=\"https://stackoverflow.com/questions/10051448/error-failed-to-build-gem-native-extension-mysql2-on-rails-3-2-3/\">this</a> and <a href=\"https://stackoverflow.com/questions/33639260/mysql2-gem-hangs-during-installation/\">this one</a>. However, the solutions mentioned in both above links automatically uninstall existing version of mysql (which is 5.6 for me) and install latest mysql version (5.7). I do not want to upgrade my mysql version. Can there be any solution which will work with my existing version of mysql? I am using Ubuntu 16.04.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1497358553, "post_id": 44522112, "comment_id": 76036072, "body": "what does <code>params.inspect</code> look like?"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 1, "creation_date": 1497358672, "post_id": 44522112, "comment_id": 76036190, "body": "Please post the <code>params</code> and also the form"}, {"owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "edited": false, "score": 0, "creation_date": 1497358997, "post_id": 44522112, "comment_id": 76036489, "body": "paste the code of <code>form</code>"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497359664, "post_id": 44522112, "comment_id": 76037057, "body": "<code>&lt;%= current_shop.purchases.inspect %&gt;</code>   gives this &lt;Purchase id: 15, subscription_id: nil, shop_id: 14, created_at: &quot;2017-06-13 11:29:43&quot;, updated_at: &quot;2017-06-13 11:29:43&quot;&gt;"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497360509, "post_id": 44522112, "comment_id": 76037764, "body": "please check update 1 for more info"}, {"owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1497382083, "post_id": 44522112, "comment_id": 76051584, "body": "@Theopap I usually get <code>param is missing..</code> error when I have some naming conventions error. For example, I believe in <code>params.require(:purchase)</code> you have to user Model name which should be <code>Purchase</code> in your case. If it is slightly different, then you have to fix that. Next thing you have to use <code>purchase_params</code> as in both answers below suggest. 3rd idea what I can imagine is that there is something wrong with your form which is not basically passing particular values."}], "answers": [{"comments": [{"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497358814, "post_id": 44522177, "comment_id": 76036324, "body": "Thanks for the reply @Deepak Mahakale... I get this error now <code>param is missing or the value is empty: purchase</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497358852, "post_id": 44522177, "comment_id": 76036366, "body": "@Theopap: this error means that you don&#39;t have <code>params[:purchase]</code>"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497358894, "post_id": 44522177, "comment_id": 76036402, "body": "@Theopap ok, so it means you are not getting the params in proper format. can you please post whats in params from rails log"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497359997, "post_id": 44522177, "comment_id": 76037316, "body": "Parameters: {&quot;utf8&quot;=&gt;&quot;\u2713&quot;, &quot;authenticity_token&quot;=&gt;&quot;UNVZw04EzzzQOrL+HfAv6jxPxDfzvkU0hgvIU&zwnj;&#8203;izq8Uaf5mbuBkCi8cqUL&zwnj;&#8203;yhpNi7Lok/V7rONRjPSH&zwnj;&#8203;8jm5iB7Xg==&quot;, &quot;payment_method_nonce&quot;=&gt;&quot;3e75204e-3869-0b1e-6be0-50409278011&zwnj;&#8203;6&quot;}"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1497360326, "post_id": 44522177, "comment_id": 76037606, "body": "Well, you got the reason. You are not getting those params"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497365592, "post_id": 44522177, "comment_id": 76041769, "body": "I&#39;m also getting this: <code>SQL (0.4ms)  INSERT INTO &quot;purchases&quot; (&quot;shop_id&quot;, &quot;created_at&quot;, &quot;updated_at&quot;) VALUES (?, ?, ?)  [[&quot;shop_id&quot;, 14], [&quot;created_at&quot;, 2017-06-13 14:39:30 UTC], [&quot;updated_at&quot;, 2017-06-13 14:39:30 UTC]]</code>    ... again the subscription_id is missing!!"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 0, "last_activity_date": 1497358756, "last_edit_date": 1497358756, "creation_date": 1497358546, "answer_id": 44522177, "question_id": 44522112, "link": "https://stackoverflow.com/questions/44522112/pass-params-of-object/44522177#44522177", "title": "Pass params of object", "body": "<p>First thing you need to change </p>\n\n<pre><code>@purchases = current_shop.purchases.build(params[:purchase])\n</code></pre>\n\n<p>to </p>\n\n<pre><code>@purchases = current_shop.purchases.build(purchase_params)\n</code></pre>\n\n<p>And check if you are getting <code>:subscription_id</code> inside <code>purchase</code> or not. something like this:</p>\n\n<pre><code>Parameters: {\"purchase\"=&gt;{\"shop_id\"=&gt;\"7\"}\n</code></pre>\n\n<p>You can check that in rails log</p>\n"}, {"comments": [{"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1497358913, "post_id": 44522205, "comment_id": 76036419, "body": "Thanks for the reply @Rajarshi Das... I&quot;m getting this error now <code>param is missing or the value is empty: purchase</code>"}], "tags": [], "owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "is_accepted": false, "score": 0, "last_activity_date": 1497358599, "creation_date": 1497358599, "answer_id": 44522205, "question_id": 44522112, "link": "https://stackoverflow.com/questions/44522112/pass-params-of-object/44522205#44522205", "title": "Pass params of object", "body": "<p>Please try this</p>\n\n<pre><code>@purchases = current_shop.purchases.build(purchase_params)\n@purchases.save!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 653, "user_id": 8036445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb5ed1c3c2b3b03d10f179fb8f4078c?s=128&d=identicon&r=PG", "display_name": "Velusamy Venkatraman", "link": "https://stackoverflow.com/users/8036445/velusamy-venkatraman"}, "is_accepted": false, "score": 0, "last_activity_date": 1497439541, "creation_date": 1497439541, "answer_id": 44543440, "question_id": 44522112, "link": "https://stackoverflow.com/questions/44522112/pass-params-of-object/44543440#44543440", "title": "Pass params of object", "body": "<p>I think Ur Trying to store data as relation.\nbut the forign key can not store.\ncheck your <code>html.rb</code> file form. and then pass <code>subscription_id</code> as a hidden field</p>\n"}], "owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1502956765, "creation_date": 1497358412, "last_edit_date": 1502956765, "question_id": 44522112, "link": "https://stackoverflow.com/questions/44522112/pass-params-of-object", "title": "Pass params of object", "body": "<p>I'm trying to pass the params:</p>\n\n<pre><code>private\n\ndef purchase_params\n  params.require(:purchase).permit(:shop_id, :subscription_id, :created_at)\nend\n</code></pre>\n\n<p>With this:</p>\n\n<pre><code>@purchases = current_shop.purchases.build(params[:purchase])\n@purchases.save!\n</code></pre>\n\n<p>I get all of the params except the subscription_id, it returns nil.\nAnybody have any idea what I might be missing here?</p>\n\n<p>Thanks in advance!!</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>if I keep it as I initially had it the <code>&lt;%= current_shop.purchases.inspect %&gt;</code> \ngives this: Purchase id: 15, subscription_id: nil, shop_id: 14, created_at: \"2017-06-13 11:29:43\", updated_at: \"2017-06-13 11:29:43\"</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1497358680, "post_id": 44522104, "comment_id": 76036199, "body": "<code>&quot;jim&quot;  = &quot;jim&quot;</code> isn&#39;t valid Ruby syntax"}, {"owner": {"reputation": 109, "user_id": 6551529, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f037bfe432f1c0f8c3734eea2d004b21?s=128&d=identicon&r=PG", "display_name": "user6551529", "link": "https://stackoverflow.com/users/6551529/user6551529"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1497359043, "post_id": 44522104, "comment_id": 76036531, "body": "sorry that was my mistake .I have updated the question"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 6551529, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f037bfe432f1c0f8c3734eea2d004b21?s=128&d=identicon&r=PG", "display_name": "user6551529", "link": "https://stackoverflow.com/users/6551529/user6551529"}, "edited": false, "score": 0, "creation_date": 1497358922, "post_id": 44522234, "comment_id": 76036426, "body": "I also know this thing. My question was how it is implemented in memory .According to that tell me how is it changing in memory"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 109, "user_id": 6551529, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f037bfe432f1c0f8c3734eea2d004b21?s=128&d=identicon&r=PG", "display_name": "user6551529", "link": "https://stackoverflow.com/users/6551529/user6551529"}, "edited": false, "score": 0, "creation_date": 1497359200, "post_id": 44522234, "comment_id": 76036669, "body": "@user6551529 think of a table which maps variables to object ids."}, {"owner": {"reputation": 109, "user_id": 6551529, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f037bfe432f1c0f8c3734eea2d004b21?s=128&d=identicon&r=PG", "display_name": "user6551529", "link": "https://stackoverflow.com/users/6551529/user6551529"}, "edited": false, "score": 0, "creation_date": 1497359226, "post_id": 44522234, "comment_id": 76036686, "body": "Can you please illustrate with diagram or something"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497361231, "post_id": 44522234, "comment_id": 76038391, "body": "@TomLord the first sentence in your answer seems a bit misleading to me. You can make a shallow copy of an object (e.g. via <code>dup</code>), but I don&#39;t think that you can shallow copy a variable."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 109, "user_id": 6551529, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f037bfe432f1c0f8c3734eea2d004b21?s=128&d=identicon&r=PG", "display_name": "user6551529", "link": "https://stackoverflow.com/users/6551529/user6551529"}, "edited": false, "score": 0, "creation_date": 1497370153, "post_id": 44522234, "comment_id": 76044920, "body": "@user6551529 In your original post, you were showing the <code>object_id</code> each step of the way. That&#39;s all you need to know. When you <b>reassign</b> the variable (<code>person1 = &quot;tim&quot;</code>), it&#39;s creating a new object (a string, <code>&quot;tim&quot;</code>) which has a new location in memory - and therefore a new <code>object_id</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1497370213, "post_id": 44522234, "comment_id": 76044962, "body": "In contrast, when you <b>mutate</b> an object (<code>person1[0] = &quot;j&quot;</code>), this is still the same physical object in memory - so the <code>object_id</code> does not change."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 1, "last_activity_date": 1497370067, "last_edit_date": 1497370067, "creation_date": 1497358703, "answer_id": 44522234, "question_id": 44522104, "link": "https://stackoverflow.com/questions/44522104/how-string-is-stored-in-memory/44522234#44522234", "title": "How string is stored in memory", "body": "<p>In the first case, you assigned a second variable to <strong>the same object</strong> in memory and then <strong>mutated it</strong>:</p>\n\n<pre><code>person1 = \"tim\"\nperson2 = person1\nperson1[0] = \"j\"\n</code></pre>\n\n<p><code>person1</code> and <code>person2</code> are still the exact same object in memory, so:</p>\n\n<pre><code>person2 == \"jim\"\n</code></pre>\n\n<hr>\n\n<p>In the second case, you <strong>reassigned</strong> the variable, which sets it to a <strong>different object</strong> in memory:</p>\n\n<pre><code>person1 = \"tim\"\n</code></pre>\n\n<p><code>person2</code> is still <code>\"jim\"</code>, because you have not mutated the object nor reassigned the variable.</p>\n"}], "owner": {"reputation": 109, "user_id": 6551529, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f037bfe432f1c0f8c3734eea2d004b21?s=128&d=identicon&r=PG", "display_name": "user6551529", "link": "https://stackoverflow.com/users/6551529/user6551529"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497370067, "creation_date": 1497358394, "last_edit_date": 1497358978, "question_id": 44522104, "link": "https://stackoverflow.com/questions/44522104/how-string-is-stored-in-memory", "title": "How string is stored in memory", "body": "<p>I am stuck with a problem .Unable to understand how actually string is stored in ruby</p>\n\n<p>In the first case if a change a character in first object it is reflecting in the second object. I understand due to same object_id</p>\n\n<pre><code> person1 = \"tim\"\n =&gt; \"tim\" \n person1.object_id\n =&gt; 9194620  \n person2 = person1\n =&gt; \"tim\"  \n person2.object_id\n =&gt; 9194620  \n person1[0] = \"j\"\n =&gt; \"j\"  \n person1\n =&gt; \"jim\"  \n person1.object_id\n =&gt; 9194620  \n person2\n =&gt; \"jim\" \n  person2.object_id\n =&gt; 9194620 \n</code></pre>\n\n<p>In the second case if first object changes so it doesn't reflect on second object due to different object id.</p>\n\n<pre><code>  person1 = \"jim\"\n =&gt; \"jim\"   \n  person2 = person1\n =&gt; \"jim\"   \n  person1 = \"tim\"\n =&gt; \"tim\"   \n  person1\n =&gt; \"tim\"   \n   person2\n =&gt; \"jim\" \n</code></pre>\n\n<p>My question is how it is internally working in memory,Why object_id doesn't change in first case where as in second case it changes?</p>\n"}, {"tags": ["ruby", "string", "hex", "byte"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497358452, "post_id": 44521821, "comment_id": 76035990, "body": "Don&#39;t make it overly complicated: <code>&quot;1&quot;.bytesize</code> is <code>1</code> and <code>&quot;11111111&quot;.bytesize</code> is <code>8</code>. Why do you expect the latter to result in <code>\\x0B\\x00\\x00\\x00</code>?"}, {"owner": {"reputation": 1739, "user_id": 1219052, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2LXbb.png?s=128&g=1", "display_name": "Jimson Kannanthara James", "link": "https://stackoverflow.com/users/1219052/jimson-kannanthara-james"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497411081, "post_id": 44521821, "comment_id": 76060989, "body": "that is a part of the problem, the result would be concatenated to an Intel x64 JMP instruction to become &quot;\\xE9\\x0B\\x00\\x00\\x00&quot;, which later gets executed."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497424926, "post_id": 44521821, "comment_id": 76066881, "body": "Can you explain the conversion process in detail? <code>&quot;\\b&quot;</code> is <code>00001000</code> (binary) and  <code>&quot;\\x0B&quot;</code> is <code>00001011</code>. Where do the two extra bits come from?"}, {"owner": {"reputation": 1739, "user_id": 1219052, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2LXbb.png?s=128&g=1", "display_name": "Jimson Kannanthara James", "link": "https://stackoverflow.com/users/1219052/jimson-kannanthara-james"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497569864, "post_id": 44521821, "comment_id": 76145964, "body": "fair enough, is it possible to make &quot;\\x0b&quot;?"}, {"owner": {"reputation": 1739, "user_id": 1219052, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2LXbb.png?s=128&g=1", "display_name": "Jimson Kannanthara James", "link": "https://stackoverflow.com/users/1219052/jimson-kannanthara-james"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497580945, "post_id": 44521821, "comment_id": 76148492, "body": "This one is halfwaythrough. <code>a = sprintf(&quot;%02X&quot;,ARGV[0].bytesize) b = ((a .size % 2 == 0) ? (a) : (&quot;0#{a}&quot;)).upcase</code>"}], "owner": {"reputation": 1739, "user_id": 1219052, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2LXbb.png?s=128&g=1", "display_name": "Jimson Kannanthara James", "link": "https://stackoverflow.com/users/1219052/jimson-kannanthara-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497360656, "creation_date": 1497357585, "last_edit_date": 1497360656, "question_id": 44521821, "link": "https://stackoverflow.com/questions/44521821/string-bytesize-to-hex", "title": "string bytesize to hex", "body": "<p>I was trying to convert the bytesize to hex string in ruby.\nI tried various combinations of pack/unpack/chr/hex to no avail.</p>\n\n<p>Here is what I managed to comeup with,</p>\n\n<pre><code>\"1\".bytesize.chr.to_s.split.pack('a4') =&gt; \"\\x01\\x00\\x00\\x00\"\n</code></pre>\n\n<p>As you know this wont work for larger strings, for example,</p>\n\n<pre><code>\"11111111\".bytesize.chr().to_s.split.pack('a4') =&gt; \"\\b\\x00\\x00\\x00\"\n</code></pre>\n\n<p>where first byte is expected to be <code>\\x0B</code>, and</p>\n\n<pre><code>\"testtttttttttttttttttttttttttttttttttttttttttt\".bytesize.chr.to_s.split.pack('a4') \n# =&gt; \".\\x00\\x00\\x00\"\n</code></pre>\n\n<p>which is wrong.</p>\n\n<p>i.e, just the opposite of this, <a href=\"https://www.ruby-forum.com/topic/94529\" rel=\"nofollow noreferrer\">Unpack 4 bytes to a signed integer</a>, where, if the <code>&lt;string&gt;.bytesize</code> is <code>4294967295</code>, it should be <code>\"\\xFF\\xFF\\xFF\\xFF\"</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos"], "comments": [{"owner": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "edited": false, "score": 0, "creation_date": 1497358049, "post_id": 44521642, "comment_id": 76035709, "body": "It seems you don&#39;t have installed Redis server."}, {"owner": {"reputation": 2343, "user_id": 6270554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PqRWJ.jpg?s=128&g=1", "display_name": "Hardik Upadhyay", "link": "https://stackoverflow.com/users/6270554/hardik-upadhyay"}, "edited": false, "score": 0, "creation_date": 1497358108, "post_id": 44521642, "comment_id": 76035751, "body": "Did you install Redis in your machine?"}, {"owner": {"reputation": 13, "user_id": 8154446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37404804e841ebeabdb4936908e6d4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Frederick Nielsen", "link": "https://stackoverflow.com/users/8154446/frederick-nielsen"}, "edited": false, "score": 0, "creation_date": 1497360020, "post_id": 44521642, "comment_id": 76037340, "body": "I installed Redis and it finally worked. Thanks guys!"}], "answers": [{"tags": [], "owner": {"reputation": 710, "user_id": 7551699, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/01X66.jpg?s=128&g=1", "display_name": "Belder", "link": "https://stackoverflow.com/users/7551699/belder"}, "is_accepted": true, "score": 0, "last_activity_date": 1497359040, "creation_date": 1497359040, "answer_id": 44522363, "question_id": 44521642, "link": "https://stackoverflow.com/questions/44521642/rails-server-startup-error-mac/44522363#44522363", "title": "Rails Server Startup Error mac", "body": "<p>It looks to me like you need to install Redis.</p>\n\n<p>There is a Gem for that and you can see the installation instructions <a href=\"https://github.com/redis/redis-rb\" rel=\"nofollow noreferrer\">HERE</a></p>\n"}], "owner": {"reputation": 13, "user_id": 8154446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37404804e841ebeabdb4936908e6d4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Frederick Nielsen", "link": "https://stackoverflow.com/users/8154446/frederick-nielsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 44522363, "answer_count": 1, "score": 0, "last_activity_date": 1497360032, "creation_date": 1497357126, "last_edit_date": 1497360032, "question_id": 44521642, "link": "https://stackoverflow.com/questions/44521642/rails-server-startup-error-mac", "title": "Rails Server Startup Error mac", "body": "<p>I've been working on a project the last few days, and I've been struggling with an error when starting up my rails server with the 'rails server' command. I have searched the whole internet for an answer but I dont really seem to find a solution to my problem.</p>\n\n<p>The problem is that when I launch rails server with the command I get this output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MovSt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MovSt.png\" alt=\"enter image description here\"></a></p>\n\n<p>Output as seen on image.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "jenkins"], "comments": [{"owner": {"reputation": 11556, "user_id": 6090676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5234122477a1ef7cce1b490ffe69241d?s=128&d=identicon&r=PG&f=1", "display_name": "burnettk", "link": "https://stackoverflow.com/users/6090676/burnettk"}, "edited": false, "score": 1, "creation_date": 1497356425, "post_id": 44521322, "comment_id": 76034391, "body": "can you ssh to the machine where it fails? does <code>&#47;var&#47;www&#47;sponsor1_integration&#47;config&#47;boot.rb</code> exist there?"}, {"owner": {"reputation": 335, "user_id": 3303266, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/edd866ff85f48e8f61fe3b6814141269?s=128&d=identicon&r=PG&f=1", "display_name": "user3303266", "link": "https://stackoverflow.com/users/3303266/user3303266"}, "reply_to_user": {"reputation": 11556, "user_id": 6090676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5234122477a1ef7cce1b490ffe69241d?s=128&d=identicon&r=PG&f=1", "display_name": "burnettk", "link": "https://stackoverflow.com/users/6090676/burnettk"}, "edited": false, "score": 0, "creation_date": 1497356772, "post_id": 44521322, "comment_id": 76034649, "body": "It does.  [rfrancis@jenkins-s4 sponsor1_integration]$ ls /var/www/sponsor1_integration/config/boot.rb /var/www/sponsor1_integration/config/boot.rb"}, {"owner": {"reputation": 46525, "user_id": 7294900, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Pdqi4.gif?s=128&g=1", "display_name": "user7294900", "link": "https://stackoverflow.com/users/7294900/user7294900"}, "edited": false, "score": 0, "creation_date": 1497357144, "post_id": 44521322, "comment_id": 76034950, "body": "can be permission problem, can you chmod the file to 777 and try?"}, {"owner": {"reputation": 335, "user_id": 3303266, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/edd866ff85f48e8f61fe3b6814141269?s=128&d=identicon&r=PG&f=1", "display_name": "user3303266", "link": "https://stackoverflow.com/users/3303266/user3303266"}, "edited": false, "score": 0, "creation_date": 1497432434, "post_id": 44521322, "comment_id": 76072022, "body": "Doesnt seem to make any difference. Im going to edit question with my code to see if anything obvious"}, {"owner": {"reputation": 335, "user_id": 3303266, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/edd866ff85f48e8f61fe3b6814141269?s=128&d=identicon&r=PG&f=1", "display_name": "user3303266", "link": "https://stackoverflow.com/users/3303266/user3303266"}, "edited": false, "score": 0, "creation_date": 1497442988, "post_id": 44521322, "comment_id": 76079900, "body": "By the way, how do i make code bold?"}], "owner": {"reputation": 335, "user_id": 3303266, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/edd866ff85f48e8f61fe3b6814141269?s=128&d=identicon&r=PG&f=1", "display_name": "user3303266", "link": "https://stackoverflow.com/users/3303266/user3303266"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497432638, "creation_date": 1497356284, "last_edit_date": 1497432638, "question_id": 44521322, "link": "https://stackoverflow.com/questions/44521322/ruby-on-rails-rake-aborted-cannot-load-such-file-error", "title": "Ruby on Rails: Rake aborted! cannot load such file error", "body": "<p>Running the below command... </p>\n\n<pre><code>rake RAILS_ENV=production company:process_patient_data_feed_01 search_folder=/var/www/sponsor1_integration/to_process/ processed_folder=/var/www/sponsor1_integration/processed/ failed_folder=/var/www/sponsor1_integration/failed/   \n</code></pre>\n\n<p>outputs the following when done in Jenkins</p>\n\n<pre><code>Return: (1, \"rake aborted!\\ncannot load such file -- bundler/setup\\n/var/www/sponsor1_integration/config/boot.rb:3:in `&lt;top (required)&gt;'\\n/var/www/sponsor1_integration/config/application.rb:1:in `&lt;top (required)&gt;'\\n/var/www/sponsor1_integration/Rakefile:4:in `&lt;top (required)&gt;'\\n(See full trace by running task with --trace)\")\n</code></pre>\n\n<p>What confuses me is that when run locally it is fine. There are admittedly different machines. I wonder where can i go to troubleshoot.</p>\n\n<p>My code fyi</p>\n\n<pre><code>Create File  ${BATCH_FILE}\n    Append to file  ${BATCH_FILE}  sponsor,protocol,site_number,subject_number,subject_status,randomization_date,treatment_arm_id,treatment_arm_description\n    : FOR    ${index}    IN RANGE    1    ${amount_of_patients_to_add}\n    \\         ${patient_name}=  Run Keyword if  \"${subject_number}\" == \",\"\n          ...  Set Variable  ${subject_number}\n    \\         ...  ELSE\n          ...  Set Variable  ${subject_number}${index},\n    \\  Append to file  ${BATCH_FILE}  \\n${sponsor},${protocol},${site_number},${patient_name}${subject_status},${randomization_date},${treatment_id},${treatment_arm_description}\n\n    ${base_dir}=  Set Variable  /var/www/${SPONSOR_NAME}_integration/\n    ${files_to_process_path}=  Set Variable  ${base_dir}to_process\n    ${processed_path}=  Set Variable  ${base_dir}processed/\n    ${failed_path}=  Set Variable  ${base_dir}failed/\n    ${path_where_file_should_be_post_processing}=  Set Variable\n    ...  ${base_dir}${directory_where_file_should_be}/${FILE}\n\n    #Open Connection     ${ENV_NAME}.longboat.com\n    #Login With Public Key    jenkins  ~/.ssh/id_rsa\n    Run And Return Rc and Output   rm -rf ${processed_path}\n    Run And Return Rc and Output   rm -rf ${failed_path}\n    Run And Return Rc and Output   rm -rf ${files_to_process_path}\n    Run And Return Rc and Output   mkdir ${processed_path}\n    Run And Return Rc and Output   mkdir ${failed_path}\n    Run And Return Rc and Output   mkdir ${files_to_process_path}\n    Run And Return Rc and Output   mv ${BATCH_FILE} ${files_to_process_path}\n    Run And Return Rc and Output   cat ${files_to_process_path}${FILE}\n    ${RAILS_COMMAND}=  Set Variable\n     ...  rake RAILS_ENV=production longboat:process_patient_data_feed_01 search_folder=${files_to_process_path} processed_folder=${processed_path} failed_folder=${failed_path}\n    Run And Return Rc and Output  sudo chmod 777 ${files_to_process_path}/${FILE}\n    Run And Return Rc and Output  sudo chmod 777 ${processed_path}\n    Run And Return Rc and Output  sudo chmod 777 ${failed_path}\n    Run And Return Rc and Output  sudo chmod 777 ${files_to_process_path}\n    Select From Database\n    ...  Select * from visit_pathways order by id desc\n    Run And Return Rc and Output  cd ${base_dir}\n    Run And Return Rc and Output  ${RAILS_COMMAND}\n    Run And Return Rc and Output   ls ${processed_path}\n    Run And Return Rc and Output   ls ${failed_path}\n    Run And Return Rc and Output   ls ${files_to_process_path}\n    Select From Database\n    ...  Select * from visit_pathways order by id desc\n    Run And Return Rc and Output  cat ${base_dir}/log/production.log \\| grep ERROR\n    Run And Return Rc and Output  cat /var/www/auth/log/production.log \\| grep ERROR\n    Run And Return Rc and Output  tail -200 ${base_dir}/log/production.log\n    Run And Return Rc and Output  tail -200 /var/www/auth/log/production.log\n    ${output}=  Run   ls ${path_where_file_should_be_post_processing} | wc -l\n    Should contain  ${output}  1\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-hash"], "comments": [{"owner": {"reputation": 926, "user_id": 4273180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/04fdc290a17e25fb823d389fff022ee4?s=128&d=identicon&r=PG", "display_name": "Valentin Trinqu&#233;", "link": "https://stackoverflow.com/users/4273180/valentin-trinqu%c3%a9"}, "edited": false, "score": 0, "creation_date": 1497353542, "post_id": 44520178, "comment_id": 76032296, "body": "First, show us what you attempted so far. Then, what&#39;s the expected result in clear <i>words</i>. Some of your hashes have <code>:course_id</code> been transformed to <code>value</code> some other haven&#39;t... Give us some insight."}, {"owner": {"reputation": 1256, "user_id": 2713696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ebob.jpg?s=128&g=1", "display_name": "Mukesh Kumar Gupta", "link": "https://stackoverflow.com/users/2713696/mukesh-kumar-gupta"}, "reply_to_user": {"reputation": 926, "user_id": 4273180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/04fdc290a17e25fb823d389fff022ee4?s=128&d=identicon&r=PG", "display_name": "Valentin Trinqu&#233;", "link": "https://stackoverflow.com/users/4273180/valentin-trinqu%c3%a9"}, "edited": false, "score": 0, "creation_date": 1497354360, "post_id": 44520178, "comment_id": 76032930, "body": "I had updated the question. look at the following code.        hash = {}       assignments.each do |type,type_data|         type_data.each do |assignment_id,data|           course_id = data[:course_id]           hash[course_id] = {}           hash[course_id][type]= {}           hash[course_id][type][assignment_id] = data         end       end"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1497354680, "post_id": 44520178, "comment_id": 76033162, "body": "@MukeshKumarGupta Don&#39;t write code in the comments section, it&#39;s very difficult to read. Please <a href=\"https://stackoverflow.com/posts/44520178/edit\">edit your post</a> and format it nicely."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1497355173, "post_id": 44520178, "comment_id": 76033533, "body": "Also, could you provide a bit more context in terms of what problem you&#39;re <i>actually</i> trying to solve here? You&#39;ve got a really ugly mess of hashes-of-hashes-of-hashes; there&#39;s probably a much better way to solve the actual problem."}, {"owner": {"reputation": 1256, "user_id": 2713696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ebob.jpg?s=128&g=1", "display_name": "Mukesh Kumar Gupta", "link": "https://stackoverflow.com/users/2713696/mukesh-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1497355210, "post_id": 44520178, "comment_id": 76033558, "body": "This is the first time I am posting a question.  I keep in mind your suggestion."}, {"owner": {"reputation": 1256, "user_id": 2713696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ebob.jpg?s=128&g=1", "display_name": "Mukesh Kumar Gupta", "link": "https://stackoverflow.com/users/2713696/mukesh-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1497355583, "post_id": 44520178, "comment_id": 76033802, "body": "I had to send daily course update notification to the user (valid user this is already taken care correctly). update notification contain four types of [:due,:missed,:over_due,:new]. To make it easy I omitted unnecessary field from data.  A user can be part of many courses that is why 2 different course_id there in the hash. The id represents here assignment id in a particular course. 1,2,3,4,5 are assignment id and 20,30 course_id."}], "answers": [{"comments": [{"owner": {"reputation": 1256, "user_id": 2713696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ebob.jpg?s=128&g=1", "display_name": "Mukesh Kumar Gupta", "link": "https://stackoverflow.com/users/2713696/mukesh-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1497356976, "post_id": 44521334, "comment_id": 76034808, "body": "yeah! It is working. I got what I was missing. I was creating empty hash each time blindly. I think we can optimize. If I find any better way to do it. I will post in the same threads.  Thank you."}, {"owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "reply_to_user": {"reputation": 1256, "user_id": 2713696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ebob.jpg?s=128&g=1", "display_name": "Mukesh Kumar Gupta", "link": "https://stackoverflow.com/users/2713696/mukesh-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1497358050, "post_id": 44521334, "comment_id": 76035710, "body": "@MukeshKumarGupta Great. Accept my answer if it works for you&gt; Thanks"}], "tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": false, "score": 1, "last_activity_date": 1497356313, "creation_date": 1497356313, "answer_id": 44521334, "question_id": 44520178, "link": "https://stackoverflow.com/questions/44520178/how-to-parse-the-given-hash-into-desired-output-in-ruby-on-rails/44521334#44521334", "title": "how to parse the given hash into desired output in ruby on rails?", "body": "<p>check below code for your solution:</p>\n\n<pre><code> hash = {} \n assignments.each do |type,type_data| \n    type_data.each do |assignment_id,data| \n        course_id = data[:course_id]\n        hash[course_id] = {} if hash[course_id].nil?\n        hash[course_id][type]= {} if hash[course_id][type].nil?\n        hash[course_id][type][assignment_id] = data \n    end \nend\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>{20=&gt;{:new=&gt;{1=&gt;{:id=&gt;1, :course_id=&gt;20, :name=&gt;\"A\"}, 2=&gt;{:id=&gt;2, :course_id=&gt;20, :name=&gt;\"B\"}}, :over_due=&gt;{4=&gt;{:id=&gt;4, :course_id=&gt;20, :name=&gt;\"E\"}}}, 30=&gt;{:new=&gt;{3=&gt;{:id=&gt;3, :course_id=&gt;30, :name=&gt;\"C\"}}, :over_due=&gt;{5=&gt;{:id=&gt;5, :course_id=&gt;30, :name=&gt;\"F\"}}}}\n</code></pre>\n"}], "owner": {"reputation": 1256, "user_id": 2713696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ebob.jpg?s=128&g=1", "display_name": "Mukesh Kumar Gupta", "link": "https://stackoverflow.com/users/2713696/mukesh-kumar-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497358874, "creation_date": 1497353119, "last_edit_date": 1497358874, "question_id": 44520178, "link": "https://stackoverflow.com/questions/44520178/how-to-parse-the-given-hash-into-desired-output-in-ruby-on-rails", "title": "how to parse the given hash into desired output in ruby on rails?", "body": "<p>I had to send daily course update notification to the user. Update notification contain four types of <code>[:due,:missed,:over_due,:new]</code>. To make it easy I omitted unnecessary field from data like due and missed coz it the same as overdue and new format. Below-provided data belonged a user.   A user can be part of many courses that is why 2 different course_id there in the hash (course_id 20 and 30). The id represents here assignment_id in a particular course. \nThe actual format of data are. </p>\n\n<pre><code>  { \n   1 =&gt; { #the 1st user\n     :new =&gt; {\n          1 =&gt; {\n           :id =&gt; 1,\n           :course_id =&gt;20,\n           :course_name =&gt; \"B\"\n          },\n          2 =&gt; {\n           :id =&gt; 2,\n           :course_id =&gt;30,\n           :course_name =&gt; \"A\"\n         },\n         3 =&gt; {\n           :id =&gt; 3,\n           :course_id =&gt;20,\n           :course_name =&gt; \"B\"\n         }\n       }\n       :over_due =&gt; {}, #This is also having the same format as new\n       :missed =&gt; {}, #This is also having the same format as new\n       :due =&gt; {} #This is also having the same format as new\n     },\n    2 =&gt; { #this is 2nd user\n       :new =&gt; {},\n       :over_due =&gt; {},\n       :missed =&gt; {},\n       :due =&gt; {}\n     }\n   }\n</code></pre>\n\n<p>Suppose, This is just a dummy data I had created for a user for more clarity and explanation. </p>\n\n<pre><code>assignments = {\n  :new =&gt; {\n    1 =&gt; {\n      :id =&gt; 1,\n      :course_id =&gt; 20,\n      :name =&gt; \"A\"\n    },\n    2 =&gt; {\n      :id =&gt; 2,\n      :course_id =&gt; 20,\n      :name=&gt;\"A\"\n    },\n    3 =&gt; {\n      :id =&gt; 3,\n      :course_id =&gt; 30,\n      :name=&gt;\"B\"\n    }\n  },\n  :over_due =&gt; {\n    4 =&gt; {\n      :id =&gt; 4,\n      :course_id =&gt; 20,\n      :name =&gt; \"A\"\n    },\n    5 =&gt; {\n      :id =&gt; 5,\n      :course_id =&gt; 30,\n      :name =&gt; \"B\"\n    }\n  }\n}\n</code></pre>\n\n<p>My requirement to parse data into this format:</p>\n\n<pre><code>{\n  20 =&gt; {\n    :new =&gt; {\n      1 =&gt; {\n        :id =&gt; 1,\n        :course_id =&gt; 20,\n        :name=&gt;\"A\"\n      },\n      2 =&gt; {\n        :id =&gt; 2,\n        :course_id =&gt; 20,\n        :name =&gt; \"B\"\n      }\n    },\n    :over_due =&gt; {\n      4 =&gt; {\n        :id =&gt; 4,\n        :course_id =&gt; 20,\n        :name =&gt; \"E\"\n      }\n    }\n  },\n  30 =&gt; {\n    :new =&gt; {\n      3 =&gt; {\n        :id =&gt; 3,\n        :course_id =&gt; 30,\n        :name =&gt; \"C\"\n      }\n    },\n    :over_due =&gt; {\n      5 =&gt; {\n        :id =&gt; 5,\n        :course_id =&gt; 30,\n        :name=&gt;\"F\"\n      }\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["ruby", "watir", "ruby-watir"], "comments": [{"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1497352781, "post_id": 44519803, "comment_id": 76031722, "body": "Can you provide the html part? , I might find better way to locate that link. The problem in your code is, it is not locating that element."}, {"owner": {"reputation": 65, "user_id": 8125349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/swnsg.jpg?s=128&g=1", "display_name": "Vincent Cheloudiakoff", "link": "https://stackoverflow.com/users/8125349/vincent-cheloudiakoff"}, "reply_to_user": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1497354575, "post_id": 44519803, "comment_id": 76033089, "body": "Yes, the html part is:  &lt;a class=&quot;next-pagination page-link disabled&quot; title=&quot;Suivant&quot; data-page-number=&quot;2&quot;&gt;&lt;span class=&quot;pagination-text&quot;&gt;Suivant&lt;/span&gt;&lt;/a&gt;  This is the html part for the last &quot;next&quot; link"}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1497355927, "post_id": 44519803, "comment_id": 76034046, "body": "Why don&#39;t you locate that element using text? It would work."}, {"owner": {"reputation": 65, "user_id": 8125349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/swnsg.jpg?s=128&g=1", "display_name": "Vincent Cheloudiakoff", "link": "https://stackoverflow.com/users/8125349/vincent-cheloudiakoff"}, "reply_to_user": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1497356844, "post_id": 44519803, "comment_id": 76034704, "body": "Thank&#39;s a lot, it&#39;s work !  I just locate the span element like that  <code>stop = b.link(class: &#39;next-pagination page-link disabled&#39;).span(class: &#39;pagination-text&#39;)</code>"}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1497357344, "post_id": 44519803, "comment_id": 76035110, "body": "Hi, this is not the way I said, I said to locate using text directly. I have updated the answer below, you could check it out."}], "answers": [{"tags": [], "owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "is_accepted": true, "score": 0, "last_activity_date": 1497357308, "creation_date": 1497357308, "answer_id": 44521721, "question_id": 44519803, "link": "https://stackoverflow.com/questions/44519803/click-to-all-different-next-pages-into-a-loop-until-the-last-page-with-watir-gem/44521721#44521721", "title": "Click to all different next pages into a loop until the last page with Watir gem", "body": "<p>Use the text to locate that element</p>\n\n<pre><code>b.span(text: 'Suivant').click\n</code></pre>\n\n<p>You don't have to use parent link and then span like b.link().span() instead you can directly locate span the way I have explained.</p>\n"}], "owner": {"reputation": 65, "user_id": 8125349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/swnsg.jpg?s=128&g=1", "display_name": "Vincent Cheloudiakoff", "link": "https://stackoverflow.com/users/8125349/vincent-cheloudiakoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 44521721, "answer_count": 1, "score": -1, "last_activity_date": 1497357308, "creation_date": 1497352019, "last_edit_date": 1497354899, "question_id": 44519803, "link": "https://stackoverflow.com/questions/44519803/click-to-all-different-next-pages-into-a-loop-until-the-last-page-with-watir-gem", "title": "Click to all different next pages into a loop until the last page with Watir gem", "body": "<p>i have a problem in my ruby watir script.</p>\n\n<p>I want to click through all next pages until the last page, and then puts some first name and last name. I know that the last \"next\" link is called with one more class \"disabled\" <code>stop = b.link(class: 'next-pagination page-link disabled')</code>.\nI try to loop until this classes is reached <code>break if stop.exists?</code></p>\n\n<pre><code>loop do\n  link = b.link(class: 'next-pagination page-link') \n  name_array = b.divs(class: 'name-and-badge-container').map { |e| e.div(class:'name-container').link(class: 'name-link profile-link').text.split(\"\\n\") }\n  puts name_array\n  stop = b.link(class: 'next-pagination page-link disabled')\n  break if stop.exists?\n  link.click\nend\n</code></pre>\n\n<p>I have this error :</p>\n\n<blockquote>\n  <p>This code has slept for the duration of the default timeout waiting for an Element to exist. If the test is still passing, consider using Element#exists? instead of rescuing UnknownObjectException\n  /Users/vincentcheloudiakoff/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/watir-6.2.1/lib/watir/elements/element.rb:496:in <code>rescue in wait_for_exists': timed out after 30 seconds, waiting for #&lt;Watir::Div: located: false; {:class=&gt;\"name-and-badge-container\", :tag_name=&gt;\"div\", :index=&gt;13}&gt; to be located (Watir::Exception::UnknownObjectException)\n      from /Users/vincentcheloudiakoff/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/watir-6.2.1/lib/watir/elements/element.rb:486:in</code>wait_for_exists'\n      from /Users/vincentcheloudiakoff/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/watir-6.2.1/lib/watir/elements/element.rb:487:in <code>wait_for_exists'\n      from /Users/vincentcheloudiakoff/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/watir-6.2.1/lib/watir/elements/element.rb:487:in</code>wait_for_exists'\n      from /Users/vincentcheloudiakoff/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/watir-6.2.1/lib/watir/elements/element.rb:639:in <code>element_call'\n      from /Users/vincentcheloudiakoff/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/watir-6.2.1/lib/watir/elements/element.rb:91:in</code>text'\n      from /Users/vincentcheloudiakoff/Travail/Automation/lib/linkedin.rb:24:in <code>block (2 levels) in start'\n      from /Users/vincentcheloudiakoff/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/watir-6.2.1/lib/watir/element_collection.rb:28:in</code>each'\n      from /Users/vincentcheloudiakoff/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/watir-6.2.1/lib/watir/element_collection.rb:28:in <code>each'\n      from /Users/vincentcheloudiakoff/Travail/Automation/lib/linkedin.rb:24:in</code>map'\n      from /Users/vincentcheloudiakoff/Travail/Automation/lib/linkedin.rb:24:in <code>block in start'\n      from /Users/vincentcheloudiakoff/Travail/Automation/lib/linkedin.rb:22:in</code>loop'\n      from /Users/vincentcheloudiakoff/Travail/Automation/lib/linkedin.rb:22:in <code>start'\n      from start.rb:3:in</code>'</p>\n</blockquote>\n\n<p>It clicks on the next page, but does not find the next disabled button.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "orientdb", "rest-client"], "comments": [{"owner": {"reputation": 926, "user_id": 4273180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/04fdc290a17e25fb823d389fff022ee4?s=128&d=identicon&r=PG", "display_name": "Valentin Trinqu&#233;", "link": "https://stackoverflow.com/users/4273180/valentin-trinqu%c3%a9"}, "edited": false, "score": 0, "creation_date": 1497353789, "post_id": 44519028, "comment_id": 76032476, "body": "From what I&#39;ve understand from a Fast&amp;Furious reading, rest-client, isn&#39;t intended to be used <i>inside</i> rails."}, {"owner": {"reputation": 706, "user_id": 7321201, "user_type": "registered", "accept_rate": 19, "profile_image": "https://lh3.googleusercontent.com/-jYTO0z0j5O8/AAAAAAAAAAI/AAAAAAAAAA4/RMhqw5lbMyM/photo.jpg?sz=128", "display_name": "nishant", "link": "https://stackoverflow.com/users/7321201/nishant"}, "reply_to_user": {"reputation": 926, "user_id": 4273180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/04fdc290a17e25fb823d389fff022ee4?s=128&d=identicon&r=PG", "display_name": "Valentin Trinqu&#233;", "link": "https://stackoverflow.com/users/4273180/valentin-trinqu%c3%a9"}, "edited": false, "score": 0, "creation_date": 1497437576, "post_id": 44519028, "comment_id": 76075794, "body": "I think this is their by default. Moreover OrientDB responds in a restful way."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 820620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gGUXi.jpg?s=128&g=1", "display_name": "hartmut", "link": "https://stackoverflow.com/users/820620/hartmut"}, "is_accepted": false, "score": 0, "last_activity_date": 1497417185, "creation_date": 1497417185, "answer_id": 44535928, "question_id": 44519028, "link": "https://stackoverflow.com/questions/44519028/restclientconflict-409-conflict/44535928#44535928", "title": "RestClient::Conflict: 409 Conflict", "body": "<p>You submitted a query via \u00bbexecute\u00ab, which is transmitted through a POST-request. The requests are logged at the debug-level. </p>\n\n<pre><code>111       begin\n112         logger.debug{ batch[:operations].map{|y|y[:command]}.join(\"; \") }\n113         response = @res[\"/batch/#{ActiveOrient.database}\"].post batch.to_json\n114       rescue ...\n</code></pre>\n\n<p>Can you please provide a short test case and open an issue at github?\nAnd include the output of the logger?</p>\n"}], "owner": {"reputation": 706, "user_id": 7321201, "user_type": "registered", "accept_rate": 19, "profile_image": "https://lh3.googleusercontent.com/-jYTO0z0j5O8/AAAAAAAAAAI/AAAAAAAAAA4/RMhqw5lbMyM/photo.jpg?sz=128", "display_name": "nishant", "link": "https://stackoverflow.com/users/7321201/nishant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1282, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497417185, "creation_date": 1497350044, "question_id": 44519028, "link": "https://stackoverflow.com/questions/44519028/restclientconflict-409-conflict", "title": "RestClient::Conflict: 409 Conflict", "body": "<p>I am getting this error when executing a function in my rails app through rails console. Primary database is OrientDB. And this fucntion is deleting edges in OrientDB in a loop.</p>\n\n<pre><code>RestClient::Conflict: 409 Conflict\n    from /home/ubuntu/.rvm/gems/ruby-2.4.0/gems/rest-client-1.8.0/lib/restclient/abstract_response.rb:74:in `return!'\n    from /home/ubuntu/.rvm/gems/ruby-2.4.0/gems/rest-client-1.8.0/lib/restclient/request.rb:495:in `process_result'\n    from /home/ubuntu/.rvm/gems/ruby-2.4.0/gems/rest-client-1.8.0/lib/restclient/request.rb:421:in `block in transmit'\n    from /home/ubuntu/.rvm/rubies/ruby-2.4.0/lib/ruby/2.4.0/net/http.rb:877:in `start'\n    from /home/ubuntu/.rvm/gems/ruby-2.4.0/gems/rest-client-1.8.0/lib/restclient/request.rb:413:in `transmit'\n    from /home/ubuntu/.rvm/gems/ruby-2.4.0/gems/rest-client-1.8.0/lib/restclient/request.rb:176:in `execute'\n    from /home/ubuntu/.rvm/gems/ruby-2.4.0/gems/rest-client-1.8.0/lib/restclient/request.rb:41:in `execute'\n    from /home/ubuntu/.rvm/gems/ruby-2.4.0/gems/rest-client-1.8.0/lib/restclient/resource.rb:67:in `post'\n    from /home/ubuntu/.rvm/gems/ruby-2.4.0/bundler/gems/active-orient-fdae334715ca/lib/rest/operations.rb:113:in `execute'\n    from /home/ubuntu/rails-project/config/initializers/string.rb:27:in `run_active_orient'\n</code></pre>\n\n<p>First thing is I am not able to get which application generates this error. Is it <strong>RestClient by rails</strong> or <strong>active-orient gem</strong> (active-orient is the ORM used to access OrientDB in rails) or <strong>orientDB-server</strong>. The function seems to generate error at different steps every-time I run it. Also there is no error log on the orientDB server log screen.</p>\n\n<p>Can anyone please help me with this error or help me understand what leads to the generation of the error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "byebug"], "answers": [{"tags": [], "owner": {"reputation": 80, "user_id": 5256281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe6c429e1c626da5f4ddfa78368491b?s=128&d=identicon&r=PG&f=1", "display_name": "Thource", "link": "https://stackoverflow.com/users/5256281/thource"}, "is_accepted": false, "score": 1, "last_activity_date": 1497607610, "creation_date": 1497607610, "answer_id": 44586561, "question_id": 44518678, "link": "https://stackoverflow.com/questions/44518678/got-runtimeerror-unable-to-find-a-spec-satisfying-byebug-0-after-modifyi/44586561#44586561", "title": "Got &quot;RuntimeError: Unable to find a spec satisfying byebug (&gt;= 0)&quot; after modifying Gemfile", "body": "<p>Not entirely sure if this is any help to you, but the issue I had is that one of my gem's .gemspec had a duplicate dependency in it, like so:</p>\n\n<pre><code>spec.add_dependency 'rails', '~&gt; 4.1'\nspec.add_dependency 'rails'\n</code></pre>\n\n<p>Removing the duplicate fixed my issue.</p>\n"}], "owner": {"reputation": 2317, "user_id": 5961990, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/971b4e854947e71931bf6dee307b59c0?s=128&d=identicon&r=PG&f=1", "display_name": "garci560", "link": "https://stackoverflow.com/users/5961990/garci560"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2328, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497607610, "creation_date": 1497349104, "question_id": 44518678, "link": "https://stackoverflow.com/questions/44518678/got-runtimeerror-unable-to-find-a-spec-satisfying-byebug-0-after-modifyi", "title": "Got &quot;RuntimeError: Unable to find a spec satisfying byebug (&gt;= 0)&quot; after modifying Gemfile", "body": "<p>I've created a new Rails application, then I ran <code>bundle</code>, and the bundle completed successfully. Then I modified the byebug entry from </p>\n\n<p><code>gem 'byebug', platform: :mri</code> </p>\n\n<p>to </p>\n\n<p><code>gem 'byebug', platform: [:mri, :mingw, :x64_mingw]</code></p>\n\n<p>so that it works with Windows.</p>\n\n<p>Then, I ran <code>bundle</code> again and I'm getting <code>RuntimeError: Unable to find a spec satisfying byebug (&gt;= 0) in the set. Perhaps the lockfile is corrupted?</code></p>\n\n<p>Why does this happen and how can I solve it (not undoing the Gemfile modification)?</p>\n"}, {"tags": ["ruby", "multithreading", "thread-safety"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497350341, "post_id": 44518289, "comment_id": 76030045, "body": "The global interpreter lock in MRI 1.9 and later makes your code effectively thread-safe."}, {"owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497353842, "post_id": 44518289, "comment_id": 76032517, "body": "@Stefan - Was the GIL changed between 1.8 and 1.9, or was it new in 1.9? Is its behaviour documented anywhere?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497355480, "post_id": 44518289, "comment_id": 76033740, "body": "IIRC, 1.8 had green threads. However, you should not rely on this behavior. If you have a critical section, put it in a <a href=\"http://ruby-doc.org/core-2.4.1/Thread/Mutex.html#method-i-synchronize\" rel=\"nofollow noreferrer\"><code>Mutex#synchronize</code></a> block. You can install JRuby for testing purposes."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1497357153, "post_id": 44518289, "comment_id": 76034963, "body": "This question shows that you should not rely on your intuition: MRI has green threads which the runtime schedules itself, and it can <i>never</i> schedule two threads to run at the same time. Yet, it returns the wrong result. YARV has system threads which are scheduled by the operating system, and so YARV has no control over which thread runs when and on which CPU core. YARV only has a Global VM Lock that protects two Ruby threads from entering the interpreter at the same time, and over the last years there has been work on breaking up the lock, so that more code can run concurrently. Yet, it \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1497357159, "post_id": 44518289, "comment_id": 76034967, "body": "\u2026 returns the correct result. It would be easy to assume that MRI would be safe, since two Ruby threads can never run at the same time. But that is wrong, for two reasons: one, the operation itself is not atomic, so a thread switch may happen in between, and two, both assignment and <code>+</code> is not actually Ruby code, it is C code, and C code <i>can</i> run concurrently in MRI."}], "answers": [{"comments": [{"owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "edited": false, "score": 0, "creation_date": 1497365745, "post_id": 44521011, "comment_id": 76041879, "body": "So, <code>$i += 1</code> is essentially two operations and therefore, in general, non-atomic. Are there any operations that Ruby <i>does</i> guarantee to be atomic, across all implementations?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "edited": false, "score": 0, "creation_date": 1497384383, "post_id": 44521011, "comment_id": 76052848, "body": "Like I said, there is no defined memory model. You simply don&#39;t know. The way it works in Ruby is basically like this: you write some code that works on YARV but doesn&#39;t on JRuby. Now, you get into an argument whose code is correct: yours, YARV&#39;s, or JRuby&#39;s. Either JRuby needs to change to match YARV, YARV needs to change to match JRuby, or <i>your</i> code needs to add some synchronization. And the result of this discussion could be called as some kind of tiny part of a memory model specification."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "edited": false, "score": 0, "creation_date": 1497384575, "post_id": 44521011, "comment_id": 76052937, "body": "There are some expectations in the Ruby community about what is atomic and what isn&#39;t, and an implementation that violates this is not going to be accepted. But really, pretty much the only thing that is universally accepted to be atomic, is variable assignment. And <i>only</i> variable assignment, i.e. no indexing assignment (<code>[]=</code>), no method assignment (<code>foo.bar=</code>), and no compound assignment (<code>a += b</code>)."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 5, "last_activity_date": 1497355471, "creation_date": 1497355471, "answer_id": 44521011, "question_id": 44518289, "link": "https://stackoverflow.com/questions/44518289/is-incrementing-an-integer-using-thread-safe-in-recent-versions-of-ruby/44521011#44521011", "title": "Is incrementing an integer (using +=) thread-safe in (recent versions of) Ruby?", "body": "<p>Unfortunately, Ruby does not have a well-defined memory model like e.g. Java or C++ do. So, the <em>general</em> answer to questions about thread-safety and atomicity is: no-one knows, but you should assume the worst.</p>\n\n<p>There is no way of knowing how any particular Ruby implementation will behave. As you have noticed, MRI and YARV behave differently. (You were assuming the difference is due to Ruby 1.8 vs. Ruby 1.9, but that is wrong, the difference is due to MRI vs. YARV.) Rubinius may behave one way or the other, or a completely different way. Same for Opal, Topaz, Ruby+OMR, TruffleRuby, MagLev, MRuby, IronRuby, JRuby, and whatever else may come along in the future.</p>\n\n<p>However, in this specific case, we can actually get a more satisfying answer than the general \"no-one knows\":</p>\n\n<pre><code>$i += 1\n</code></pre>\n\n<p>is just syntactic sugar for </p>\n\n<pre><code>$i = $i + 1\n</code></pre>\n\n<p>which clearly is two operations and thus clearly non-atomic. The fact that it appears to work on YARV, is due to a private internal implementation detail that is not guaranteed, may change at any moment without notice, and may or may not exist on other implementations.</p>\n"}], "owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1497355471, "creation_date": 1497348185, "question_id": 44518289, "link": "https://stackoverflow.com/questions/44518289/is-incrementing-an-integer-using-thread-safe-in-recent-versions-of-ruby", "title": "Is incrementing an integer (using +=) thread-safe in (recent versions of) Ruby?", "body": "<p>I have used the following Python code to show that it is not thread-safe to increment an integer <code>i</code> on multiple threads:</p>\n\n<pre><code>&gt;&gt;&gt; i = 0\n&gt;&gt;&gt; def increment_i():\n...     global i\n...     for j in range(1000): i += 1\n...\n&gt;&gt;&gt; threads = [threading.Thread(target=increment_i) for j in range(10)]\n&gt;&gt;&gt; for thread in threads: thread.start()\n...\n&gt;&gt;&gt; for thread in threads: thread.join()\n...\n&gt;&gt;&gt; i\n4858  # Not 10000\n</code></pre>\n\n<p>I have tried to translate this code to Ruby, expecting similar results:</p>\n\n<pre><code>&gt; $i = 0\n&gt; def increment_i()\n&gt;     for j in 0...1000 do $i += 1 end\n&gt; end\n\n&gt; threads = (0...10).map { Thread.start { increment_i } }\n\n&gt; for thread in threads do thread.join end\n</code></pre>\n\n<p>If I run this Ruby code on version 1.8, it does indeed behave the same as the Python code, leaving <code>$i</code> with a value less than 10000.</p>\n\n<p>However, on 1.9 and 2.3, <code>$i</code> always seems to be set to exactly 10000.</p>\n\n<p>Is incrementing an integer using <code>+=</code> in fact thread-safe in Ruby 1.9 and later?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497347667, "post_id": 44517991, "comment_id": 76028193, "body": "How do you provide the input?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497348342, "post_id": 44517991, "comment_id": 76028674, "body": "@Stefan: good point, thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1497348180, "last_edit_date": 1497348180, "creation_date": 1497347562, "answer_id": 44518047, "question_id": 44517991, "link": "https://stackoverflow.com/questions/44517991/difference-between-these-split-use/44518047#44518047", "title": "Difference between these &#39;split&#39; use", "body": "<p>The second one contains two calls to <code>gets</code>, which requires STDIN to contain two lines of input (however you do it, via user input in console or piping data to the script). If it doesn't, you get errors.</p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 3177310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0e457fb3ebf0ea43ed2bb443fc28b2?s=128&d=identicon&r=PG&f=1", "display_name": "Poilon", "link": "https://stackoverflow.com/users/3177310/poilon"}, "is_accepted": false, "score": 0, "last_activity_date": 1497348666, "last_edit_date": 1592644375, "creation_date": 1497348666, "answer_id": 44518487, "question_id": 44517991, "link": "https://stackoverflow.com/questions/44517991/difference-between-these-split-use/44518487#44518487", "title": "Difference between these &#39;split&#39; use", "body": "<h1>First</h1>\n<pre><code>def sum_difference_product\n  a , b = gets.split.map { |num| num.to_i }\n  puts a + b\n  puts a - b\n  puts a * b\nend\n</code></pre>\n<p>here <code>a, b = gets.split.map { |num| num.to_i }</code> will grab the standard entry, split it by any space character into an array, cast each element into integers, and put it in a and b.</p>\n<p>result =&gt; if in your standard entry you type <code>22 12</code>, your array will be <code>['22', '12']</code>, and then after the map <code>[22, 12]</code>, then <code>a = 22</code> and <code>b = 12</code>.</p>\n<p>At this point you can do your operations. <code>a + b == 34</code> here</p>\n<hr />\n<h1>Second</h1>\n<pre><code>def sum_difference_product\n  a = gets.split.map { |e| e.to_i  }\n  b = gets.split.map { |e| e.to_i  }\n  puts a + b\n  puts a - b\n  puts a * b\nend\n</code></pre>\n<p>same here, <code>gets.split.map { |e| e.to_i  }</code> will return an array, and and put it in a if your standard entry is well formatted of numbers separated by spaces</p>\n<p>b will wait for a second standard entry, and will be an array too.\na + b will concatenate the 2 arrays.</p>\n<hr />\n<p>If in your standard entry in the first method you send <code>22 12</code> then <code>a == 22</code> and <code>b == 12</code>.</p>\n<p>If you send the same standard entry in the first gets of the second method, then <code>a == [22, 12]</code>. If you don't send any data in the second gets of the second method, then gets will return nil, and you can't call split on nil. This is your error.</p>\n"}], "owner": {"reputation": 3, "user_id": 8142437, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J2rT0AoBsXk/AAAAAAAAAAI/AAAAAAAACFw/uFKPKKbnZHE/photo.jpg?sz=128", "display_name": "Antoine Doolaeghe", "link": "https://stackoverflow.com/users/8142437/antoine-doolaeghe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 44518047, "answer_count": 2, "score": 0, "last_activity_date": 1497349157, "creation_date": 1497347439, "last_edit_date": 1497349157, "question_id": 44517991, "link": "https://stackoverflow.com/questions/44517991/difference-between-these-split-use", "title": "Difference between these &#39;split&#39; use", "body": "<p>I would like to understand the difference between these two expressions:</p>\n\n<p>The first one, which works:</p>\n\n<pre><code>def sum_difference_product\n  a, b = gets.split.map { |num| num.to_i }\n  puts a + b\n  puts a - b\n  puts a * b\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>def sum_difference_product\n  a = gets.split.map { |e| e.to_i  }\n  b = gets.split.map { |e| e.to_i  }\n  puts a + b\n  puts a - b\n  puts a * b\nend\n</code></pre>\n\n<p>which returns:</p>\n\n<pre><code>NameError:\n\nNoMethodError:\n   undefined method `split' for nil:NilClass\n</code></pre>\n"}]