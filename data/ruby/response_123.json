[{"tags": ["c", "ruby", "arduino", "microcontroller"], "comments": [{"owner": {"reputation": 5508, "user_id": 794749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pfE2l.jpg?s=128&g=1", "display_name": "gre_gor", "link": "https://stackoverflow.com/users/794749/gre-gor"}, "edited": false, "score": 1, "creation_date": 1495065493, "post_id": 44036405, "comment_id": 75099665, "body": "<a href=\"https://playground.arduino.cc/Interfacing/Ruby\" rel=\"nofollow noreferrer\">playground.arduino.cc/Interfacing/Ruby</a>"}, {"owner": {"reputation": 587, "user_id": 1473641, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2e1f431cce8a104400fc6ef5f3da497a?s=128&d=identicon&r=PG", "display_name": "Prox", "link": "https://stackoverflow.com/users/1473641/prox"}, "reply_to_user": {"reputation": 5508, "user_id": 794749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pfE2l.jpg?s=128&g=1", "display_name": "gre_gor", "link": "https://stackoverflow.com/users/794749/gre-gor"}, "edited": false, "score": 0, "creation_date": 1495074280, "post_id": 44036405, "comment_id": 75101652, "body": "Thank you.  I got this working quickly for my Arduino Uno."}], "answers": [{"tags": [], "owner": {"reputation": 830, "user_id": 7059512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a00007e9f887b4547f8f29b921e612b2?s=128&d=identicon&r=PG&f=1", "display_name": "per1234", "link": "https://stackoverflow.com/users/7059512/per1234"}, "is_accepted": false, "score": 1, "last_activity_date": 1495073080, "creation_date": 1495073080, "answer_id": 44037415, "question_id": 44036405, "link": "https://stackoverflow.com/questions/44036405/how-to-control-arduino-board-or-stand-alone-avr-using-serial/44037415#44037415", "title": "How to control Arduino board or stand alone AVR using serial?", "body": "<p>You will need to flash the AVR with a program that interprets commands coming over serial from your Ruby program and takes the desired action.</p>\n\n<p>One option is the Firmata protocol. There is a Firmata Arduino library:</p>\n\n<p><a href=\"https://github.com/firmata/arduino\" rel=\"nofollow noreferrer\">https://github.com/firmata/arduino</a></p>\n\n<p>Some Firmata client libraries for Ruby are listed at that <a href=\"https://github.com/firmata/arduino#firmata-client-libraries\" rel=\"nofollow noreferrer\">link</a>. I haven't used it but that seems like a fast way to achieve your goal, though you may have more fun designing your own command protocol and writing the microcontroller firmware from scratch.</p>\n"}], "owner": {"reputation": 587, "user_id": 1473641, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2e1f431cce8a104400fc6ef5f3da497a?s=128&d=identicon&r=PG", "display_name": "Prox", "link": "https://stackoverflow.com/users/1473641/prox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1495073080, "creation_date": 1495064659, "question_id": 44036405, "link": "https://stackoverflow.com/questions/44036405/how-to-control-arduino-board-or-stand-alone-avr-using-serial", "title": "How to control Arduino board or stand alone AVR using serial?", "body": "<p>I know how to program an AVR using a programmer.  I am now wanting to learn Ruby and I thought it might be fun interacting with an Arduino or just an Attiny85 directly from the serial port.  </p>\n\n<p>I am kind of new to this stuff.  Is there a way to control LEDs, servos and other components without burning a program directly to the AVR chip? </p>\n\n<p>Would it make sense to write a Ruby program that connects to the AVR or Arduino through a serial connection and controls components?  I didn't know if this was possible.  Any ideas on how this can be done?  I see that there is a serial port gem for Ruby.  Would this be a good starting point?</p>\n\n<p>I didn't know if this would be a good idea with Ruby.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 11149, "user_id": 706628, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/NICFY.jpg?s=128&g=1", "display_name": "Barry Fruitman", "link": "https://stackoverflow.com/users/706628/barry-fruitman"}, "edited": false, "score": 0, "creation_date": 1495065844, "post_id": 44035954, "comment_id": 75099751, "body": "This is <i>exactly</i> what I&#39;m looking for."}], "tags": [], "owner": {"reputation": 732, "user_id": 5613451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25e0c61e748f8241bc2955589f5d6661?s=128&d=identicon&r=PG&f=1", "display_name": "Mickey Sheu", "link": "https://stackoverflow.com/users/5613451/mickey-sheu"}, "is_accepted": true, "score": 2, "last_activity_date": 1495061430, "creation_date": 1495061430, "answer_id": 44035954, "question_id": 44035876, "link": "https://stackoverflow.com/questions/44035876/concise-way-to-set-a-default-value/44035954#44035954", "title": "Concise way to set a default value?", "body": "<p>If you want to set a default value for one key, <code>Hash#fetch</code> is your answer.  </p>\n\n<p>If passed a block, it will return the value of the block if the key isn't in the params.  </p>\n\n<pre><code>params = {}\nparams.fetch(:foo) { 'default' } \n=&gt; \"default\"\n</code></pre>\n\n<p>If the default is easy to compute, you can just as well do this as a second argument in the method: </p>\n\n<pre><code>params = {}\nparams.fetch(:foo, 'default')\n=&gt; \"default\"\n</code></pre>\n\n<p>If you want to set a default for the whole hash, you should look into <code>#default=</code> and <code>#default_proc</code>.  Since your question concerns <code>params</code>, I'm guessing you can't initialize the hash with an appropriate default.  </p>\n\n<p>BTW, your way will not return <code>nil</code> if the value is set to <code>nil</code>, but fetch will properly return <code>nil</code>.  </p>\n\n<pre><code>params[:foo] = nil\nparams.fetch(:foo) { 'default' }\n=&gt; nil \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1495062091, "last_edit_date": 1495062091, "creation_date": 1495061581, "answer_id": 44035975, "question_id": 44035876, "link": "https://stackoverflow.com/questions/44035876/concise-way-to-set-a-default-value/44035975#44035975", "title": "Concise way to set a default value?", "body": "<p>The shorter equivalent of:</p>\n\n<pre><code>foo = params[:foo].nil? ? 'default' : params[:foo]\n</code></pre>\n\n<p>is</p>\n\n<pre><code>foo = params[:foo] || 'default'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6433, "user_id": 5326603, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/3rFep.png?s=128&g=1", "display_name": "nbkhope", "link": "https://stackoverflow.com/users/5326603/nbkhope"}, "edited": false, "score": 2, "creation_date": 1495069182, "post_id": 44036007, "comment_id": 75100520, "body": "This should be the answer. Everybody should know the OR operator can be used to set default values."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 3, "last_activity_date": 1495061731, "creation_date": 1495061731, "answer_id": 44036007, "question_id": 44035876, "link": "https://stackoverflow.com/questions/44035876/concise-way-to-set-a-default-value/44036007#44036007", "title": "Concise way to set a default value?", "body": "<p>I like:</p>\n\n<pre><code> foo = params[:foo] || 'default'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": false, "score": 0, "last_activity_date": 1495062718, "last_edit_date": 1495062718, "creation_date": 1495061914, "answer_id": 44036036, "question_id": 44035876, "link": "https://stackoverflow.com/questions/44035876/concise-way-to-set-a-default-value/44036036#44036036", "title": "Concise way to set a default value?", "body": "<p>Another option is to use <code>presence</code> method, check this code:</p>\n\n<pre><code>foo = params[:foo].presence || 'default'\n</code></pre>\n\n<ul>\n<li><code>presence</code> checks if the value is present (i.e. is not <code>nil</code>/empty), if it is, it returns that value, if not, it returns <code>nil</code>.</li>\n<li><code>||</code> will return the value to its <em>right</em> if the one its <em>letf</em> is <code>nil</code>. </li>\n</ul>\n\n<p>Please note that this option will also set <code>foo</code> to <code>'default'</code> if <code>params[:foo]</code> is empty.</p>\n"}], "owner": {"reputation": 11149, "user_id": 706628, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/NICFY.jpg?s=128&g=1", "display_name": "Barry Fruitman", "link": "https://stackoverflow.com/users/706628/barry-fruitman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 44035954, "answer_count": 4, "score": 0, "last_activity_date": 1495062718, "creation_date": 1495061025, "question_id": 44035876, "link": "https://stackoverflow.com/questions/44035876/concise-way-to-set-a-default-value", "title": "Concise way to set a default value?", "body": "<p>I'm new to Ruby on Rails. Is there a more elegant or concise way to do this?</p>\n\n<pre><code>foo = params[:foo].nil? ? 'default' : params[:foo]\n</code></pre>\n\n<p>I simply want to assign a default value if a param is not present. My way seems a bit clunky.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "minimagick"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1495066767, "post_id": 44035449, "comment_id": 75100006, "body": "It&#39;s possible that writing the file on top of itself is causing trouble. Have you tried writing to a different output file?"}], "answers": [{"comments": [{"owner": {"reputation": 4249, "user_id": 531479, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/52be1662035d921d395ca5b1d6b9c64c?s=128&d=identicon&r=PG", "display_name": "CWitty", "link": "https://stackoverflow.com/users/531479/cwitty"}, "edited": false, "score": 0, "creation_date": 1495120870, "post_id": 44040434, "comment_id": 75128962, "body": "Logging out the commands showed me that I needed to move the call to <code>format</code> earlier in the method. During format it was wiping the interlace settings."}, {"owner": {"reputation": 1489, "user_id": 7948068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71dc87adc38b9813f2fc7db09aea190?s=128&d=identicon&r=PG&f=1", "display_name": "Kathryn", "link": "https://stackoverflow.com/users/7948068/kathryn"}, "reply_to_user": {"reputation": 4249, "user_id": 531479, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/52be1662035d921d395ca5b1d6b9c64c?s=128&d=identicon&r=PG", "display_name": "CWitty", "link": "https://stackoverflow.com/users/531479/cwitty"}, "edited": false, "score": 0, "creation_date": 1495122043, "post_id": 44040434, "comment_id": 75129744, "body": "@CWitty: Ah! That makes  sense. Glad the logging helped."}], "tags": [], "owner": {"reputation": 1489, "user_id": 7948068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71dc87adc38b9813f2fc7db09aea190?s=128&d=identicon&r=PG&f=1", "display_name": "Kathryn", "link": "https://stackoverflow.com/users/7948068/kathryn"}, "is_accepted": true, "score": 2, "last_activity_date": 1495121943, "last_edit_date": 1495121943, "creation_date": 1495089863, "answer_id": 44040434, "question_id": 44035449, "link": "https://stackoverflow.com/questions/44035449/minimagick-interlace-isnt-working/44040434#44040434", "title": "MiniMagick Interlace isn&#39;t working", "body": "<p>I tried to convert an image using the <a href=\"http://www.rubydoc.info/github/minimagick/minimagick#Appending\" rel=\"nofollow noreferrer\">Metal interface</a>:</p>\n\n<pre><code>require 'mini_magick'\n\nMiniMagick::Tool::Convert.new do |convert|\n  convert &lt;&lt; \"input.jpg\"\n  convert &lt;&lt; \"-interlace plane\"\n  convert &lt;&lt; \"output.jpg\"\nend\n</code></pre>\n\n<p>That should amount to the same thing as:</p>\n\n<pre><code>$ convert input.jpg -interlace plane output.jpg\n</code></pre>\n\n<p>In fact that command works as expected:</p>\n\n<pre><code>$ magick identify -verbose input.jpg output.jpg | grep Interlace\n  Interlace: None\n  Interlace: JPEG\n</code></pre>\n\n<p>You can see what commands your code is issuing by turning on debugging:</p>\n\n<pre><code>MiniMagick.configure do |config|\n  config.debug = true\nend\n</code></pre>\n\n<p>When I run your code with debugging on, I get a bunch of commands that are working on temp files:</p>\n\n<pre><code>MiniMagick.debug is deprecated and will be removed in MiniMagick 5. Use `MiniMagick.logger.level = Logger::DEBUG` instead.\nD, [2017-05-17T23:30:28.456080 #12301] DEBUG -- : [0.01s] identify /var/folders/dh/_zgl_f_s0t7b4wk9j27cpny80000gp/T/mini_magick20170517-12301-17vo4b8.jpg\nD, [2017-05-17T23:30:28.468335 #12301] DEBUG -- : [0.01s] mogrify -resize 500x500&gt; /var/folders/dh/_zgl_f_s0t7b4wk9j27cpny80000gp/T/mini_magick20170517-12301-17vo4b8.jpg\nD, [2017-05-17T23:30:28.481606 #12301] DEBUG -- : [0.01s] mogrify -alpha remove -auto-orient -interlace plane /var/folders/dh/_zgl_f_s0t7b4wk9j27cpny80000gp/T/mini_magick20170517-12301-17vo4b8.jpg\nD, [2017-05-17T23:30:28.493634 #12301] DEBUG -- : [0.01s] convert /var/folders/dh/_zgl_f_s0t7b4wk9j27cpny80000gp/T/mini_magick20170517-12301-17vo4b8.jpg[0] /var/folders/dh/_zgl_f_s0t7b4wk9j27cpny80000gp/T/mini_magick20170517-12301-hks8tq.jpg\n</code></pre>\n\n<p>One thing I can't help notice <a href=\"http://www.rubydoc.info/github/minimagick/minimagick#Usage\" rel=\"nofollow noreferrer\">in the documentation</a> is the line:</p>\n\n<blockquote>\n  <p>On the other hand, if we want the original image to actually <em>get</em> modified, we can use <code>MiniMagick::Image.new</code>.</p>\n</blockquote>\n\n<p>So maybe try <code>new</code> instead of <code>open</code>. And then watch the debugging output to see if the commands make sense. </p>\n\n<p>It seems maybe your code is overcomplicated? Also from <a href=\"http://www.rubydoc.info/github/minimagick/minimagick#Combine_options\" rel=\"nofollow noreferrer\">the documentation</a>:</p>\n\n<blockquote>\n  <p>As a handy shortcut, <code>MiniMagick::Image.new</code> also accepts an optional block which is used to <code>combine_options</code>. </p>\n</blockquote>\n\n<p>So maybe you don't need the explicit call to <code>combine_options</code> if using <code>new</code>.</p>\n"}], "owner": {"reputation": 4249, "user_id": 531479, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/52be1662035d921d395ca5b1d6b9c64c?s=128&d=identicon&r=PG", "display_name": "CWitty", "link": "https://stackoverflow.com/users/531479/cwitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 44040434, "answer_count": 1, "score": 1, "last_activity_date": 1495121943, "creation_date": 1495058393, "question_id": 44035449, "link": "https://stackoverflow.com/questions/44035449/minimagick-interlace-isnt-working", "title": "MiniMagick Interlace isn&#39;t working", "body": "<p>I have some custom methods to resize my images using MiniMagick</p>\n\n<pre><code>def resize_to_limit(dimensions, degrade = false)\n  width, height = dimensions\n  MiniMagick::Image.open(current_path).tap do |image|\n    image.resize \"#{width}x#{height}&gt;\"\n    image.combine_options do |cmd|\n      if degrade\n        cmd.quality 50\n      end\n      cmd.alpha 'remove'\n      cmd.auto_orient\n      cmd.interlace 'plane'\n    end\n    image.format('jpg')\n    image.write current_path\n  end\nend\n</code></pre>\n\n<p>When I check the resulting image using <code>identify</code> the <code>Interlace</code> is still <code>None</code>. Not sure if the library changed the input value, but I have tried both <em>Plane</em> and <em>plane</em>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1495056164, "post_id": 44034858, "comment_id": 75096644, "body": "What sort of input are you getting? A few more examples of valid and invalid input would help."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1495056563, "post_id": 44034858, "comment_id": 75096812, "body": "Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and the linked page. Your question isn&#39;t asked well. Show  the minimum code that demonstrates the problem you&#39;re having. Without that it looks like you didn&#39;t try and want us to write it for you."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1495056382, "post_id": 44034973, "comment_id": 75096734, "body": "Ugh. I used to be in that world and dealing with the list, and ICANN and other registrars made me nuts."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1495056489, "post_id": 44034973, "comment_id": 75096782, "body": "@theTinMan Tell me about it. I&#39;m dealing with email and I&#39;ve given up on thinking we&#39;ll ever make sense of this. Is <code>x@y</code> a valid email? Could be! Only way to know for sure is to try and resolve it, or try and deliver it."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 10, "last_activity_date": 1495055986, "creation_date": 1495055986, "answer_id": 44034973, "question_id": 44034858, "link": "https://stackoverflow.com/questions/44034858/how-to-check-for-top-level-domain-in-ruby-string/44034973#44034973", "title": "How to check for top level domain in Ruby string", "body": "<p>The answer is, unfortunately, yes, no and maybe all at once.</p>\n\n<p>I've <a href=\"https://github.com/twg/domain_prefix\" rel=\"noreferrer\">written a gem</a> which attempts to do this by transforming the <a href=\"https://publicsuffix.org/list/public_suffix_list.dat\" rel=\"noreferrer\">public suffix list</a> into something that can be executed programmatically. For the most part it's pretty accurate but there are still some dark corners in that list not properly qualified. Top-level domains these days are pure anarchy and those that register them are free to organize them however they see fit, or not organize them at all.</p>\n\n<p>Although today <code>bobby</code> is not a gTLD, it's possible that tomorrow it might become one. The <a href=\"https://newgtlds.icann.org/en/\" rel=\"noreferrer\">list of proposed domains at ICANN</a> is surreal to say the least and things such things as <a href=\"https://icannwiki.org/.google\" rel=\"noreferrer\"><code>.google</code></a> have already been approved just to make life as confusing as possible.</p>\n\n<p>So it depends on what you mean by \"top level domain\". Some things that are totally valid even if they seem completely wrong, like <a href=\"https://www.registry.google/\" rel=\"noreferrer\">https://www.registry.google/</a></p>\n\n<p>The <a href=\"https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains\" rel=\"noreferrer\">list of top-level domains</a> might seem thorough enough, but some of these organize their subdomains in a particular way which complicates the issue. For example, Australia does not allow direct <code>.au</code> domains, so <code>example.au</code> is not valid, however <code>example.com.au</code> is. The \"Public Suffix\" list is the compilation of these rules use for cookie-assignment purposes.</p>\n\n<p>Before that list existed it was possible to assign a cookie that stuck to all of <code>.com.au</code>, a behaviour that was highly undesirable to say the least. It's worth noting that <code>com.au</code> is not a valid domain despite matching the usual <code>\\w+\\.\\w\\w+</code> pattern.</p>\n"}], "owner": {"reputation": 621, "user_id": 1308544, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d103bd2ad5343c855955a9415842babd?s=128&d=identicon&r=PG", "display_name": "Ron M", "link": "https://stackoverflow.com/users/1308544/ron-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 44034973, "answer_count": 1, "score": 0, "last_activity_date": 1495056501, "creation_date": 1495055479, "last_edit_date": 1495056501, "question_id": 44034858, "link": "https://stackoverflow.com/questions/44034858/how-to-check-for-top-level-domain-in-ruby-string", "title": "How to check for top level domain in Ruby string", "body": "<p>I'd like to be able to check if a user enters their name with any top level domain in the string. Preferably, validating this with a regex.</p>\n\n<p>I'd like to still allow a user to put a <code>.</code> in their username so <code>Mr. Bobby</code> would be legitimate.</p>\n\n<p>For example, <code>bobby</code> is fine, but <code>bobby.com</code> would be caught by the regex. Is there any way to do this for all TLD's?</p>\n"}, {"tags": ["ruby", "node.js", "angular"], "comments": [{"owner": {"reputation": 2002, "user_id": 5660649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/o3W3w.jpg?s=128&g=1", "display_name": "birwin", "link": "https://stackoverflow.com/users/5660649/birwin"}, "edited": false, "score": 1, "creation_date": 1495057589, "post_id": 44034680, "comment_id": 75097265, "body": "My opinion: As angular&#39;s integration with the middle tier will be through REST calls in most instances, your choices are wide open. It&#39;s hard to say which is best as it depends on your individual situation. Probably the Node option has gained so much traction recently is because the back-end and front-end share a language and its simplicity."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1495058355, "post_id": 44034680, "comment_id": 75097578, "body": "Your question isn&#39;t a good fit for SO. Too much is unknown so we can only assume and guess for the unknown information, then try to give broad answers. SO is about detailed answers, in particular about detailed answers to programming problems. You&#39;re asking about architecture, which SO does touch upon, but code is the focus. Do more research then try things and then ask about problems with the code you write."}], "answers": [{"tags": [], "owner": {"reputation": 10410, "user_id": 87056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LYg63.jpg?s=128&g=1", "display_name": "Yakov Fain", "link": "https://stackoverflow.com/users/87056/yakov-fain"}, "is_accepted": false, "score": 0, "last_activity_date": 1495056431, "creation_date": 1495056431, "answer_id": 44035048, "question_id": 44034680, "link": "https://stackoverflow.com/questions/44034680/backend-application-technology-for-an-angular-front-end/44035048#44035048", "title": "Backend application technology for an Angular front-end", "body": "<p>Angular is agnostic to the backend you use. Just expose a REST endpoint either from your RUby or Node+Expres backend. The client will use something like this anyway:</p>\n\n<pre><code>http.get(\"/products\").subscribe(...)\n</code></pre>\n\n<p>Take a look at these code samples where Angular talks to Node:\n<a href=\"https://github.com/Farata/angular2typescript/tree/master/Angular4/http-node-samples\" rel=\"nofollow noreferrer\">https://github.com/Farata/angular2typescript/tree/master/Angular4/http-node-samples</a></p>\n"}, {"tags": [], "owner": {"reputation": 5977, "user_id": 5683579, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8c263738dccc90304c0ac71ed8ed505b?s=128&d=identicon&r=PG", "display_name": "joh04667", "link": "https://stackoverflow.com/users/5683579/joh04667"}, "is_accepted": true, "score": 1, "last_activity_date": 1495057486, "creation_date": 1495057486, "answer_id": 44035259, "question_id": 44034680, "link": "https://stackoverflow.com/questions/44034680/backend-application-technology-for-an-angular-front-end/44035259#44035259", "title": "Backend application technology for an Angular front-end", "body": "<p>You do have some options here. Angular 2+ apps compile to what is essentially just an <code>index.html</code> that will handle the loading of other necessary views. So, you just need something that is able to serve an <code>index.html</code> file, and your application API could live completely separate from your serving application. Depending on how you're hosting, you have a lot of options here (for example, GitHub pages hosting your frontend and your backend on Heroku. </p>\n\n<p>Rails makes setting up an API-only application a breeze and works quite well with Redis. I would say it's definitely the easiest option here; if you do need to pass in environment-specific configs to the Angular app, there are ways to do this while bootstrapping the startup.</p>\n\n<p>Node is always a good option, but I've never worked with Node-Redis so I couldn't tell you the hangups. I can also say that Rails would likely be easier.\nHowever, <a href=\"https://universal.angular.io/\" rel=\"nofollow noreferrer\">Angular Universal</a> primarily supports Node, with the only other supported platform being .NET. If you want to use or mess with Universal (super cool stuff) Node would be needed, at least when serving the app. </p>\n\n<p>Node would also offer a chance to brush up on your Typescript chops outside of Angular, if you are looking for a learning opportunity.</p>\n"}], "owner": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "closed_date": 1495101479, "accepted_answer_id": 44035259, "answer_count": 2, "score": 0, "last_activity_date": 1495057486, "creation_date": 1495054761, "question_id": 44034680, "link": "https://stackoverflow.com/questions/44034680/backend-application-technology-for-an-angular-front-end", "closed_reason": "Opinion-based", "title": "Backend application technology for an Angular front-end", "body": "<p>I apologize if this question is too open ended. But I am struggling to get some of the principles to get started diving into this. </p>\n\n<p>I am planning to build a fairly small demo app out of this seed (based on Angular 2): <a href=\"https://vmware.github.io/clarity/get-started\" rel=\"nofollow noreferrer\">https://vmware.github.io/clarity/get-started</a> </p>\n\n<p>I'd like to render in an Angular UI some basic data that I keep in a back-end Redis database. </p>\n\n<p>I am trying to find out what application layer I should be using to sit in between Redis and the Angular UI. </p>\n\n<p>I am currently thinking of either using Ruby (just because I am slightly familiar with it) or Node.js. </p>\n\n<p>Part of my struggling is because I am confused about the relation between Node.js and Angular 2 and I am wondering whether using Node code can help me integrating better and more easily with Angular (than with Ruby). </p>\n\n<p>Other than using the same language/syntax (js), I have the gut feeling that I could more easily run a Node \"app.js\" file with some trivial business logic that reads from Redis and pass the result onto the Angular application. At least I could run the app.js logic on the same http instance where I am running the Angular application (my assumption). </p>\n\n<p>If I wanted to use Ruby I have to use some web framework (e.g. Rails or Sinatra) to serve requests coming from the Angular application (e.g. in Angular I will have to make calls to <code>http://myrubysrv/applogic</code>). </p>\n\n<p>Other than the language and this deployment detail, I am just wondering if passing variable from the application logic component into the Angular application is going to be easier if I use Node or the level of effort is going to be exactly the same whether I use Node or Ruby. </p>\n\n<p>Thanks.   </p>\n"}, {"tags": ["ruby", "algorithm"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1495053201, "post_id": 44034273, "comment_id": 75095244, "body": "please, provide example input and expected output."}, {"owner": {"reputation": 217, "user_id": 4024427, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eeeba2d2482f856960056afbf14f8fca?s=128&d=identicon&r=PG&f=1", "display_name": "Clyde Brown", "link": "https://stackoverflow.com/users/4024427/clyde-brown"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1495053630, "post_id": 44034273, "comment_id": 75095457, "body": "Added an example for ya"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1495054541, "post_id": 44034273, "comment_id": 75095904, "body": "Keep in mind there are 3,628,800 permutations for a string of length 10."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1495054614, "post_id": 44034273, "comment_id": 75095934, "body": "Are you asking if there is a faster way to find the middle permutation? Yes, there is. (Do the strings include repeated characters? If not, it is even easier.)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1495054866, "post_id": 44034273, "comment_id": 75096040, "body": "@rici An algorithmic approach would be vastly faster, but the built-in <code>permutation</code> method does brute-force it."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1495055084, "post_id": 44034273, "comment_id": 75096146, "body": "The patterns won&#39;t change for any given X-length sequence, so you can brute-force these into a look-up table for ordering if you want. A more nuanced approach is to construct that sequence algorithmically."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1495055130, "post_id": 44034273, "comment_id": 75096172, "body": "@tadman: i certainly didn&#39;t claim the answer was incorrect, just that there are faster solutions. How does my comment imply anything else?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1495055179, "post_id": 44034273, "comment_id": 75096198, "body": "@rici I&#39;m agreeing with you, not disputing your advice. Just an attempt to clarify what you meant."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 217, "user_id": 4024427, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eeeba2d2482f856960056afbf14f8fca?s=128&d=identicon&r=PG&f=1", "display_name": "Clyde Brown", "link": "https://stackoverflow.com/users/4024427/clyde-brown"}, "edited": false, "score": 0, "creation_date": 1495055424, "post_id": 44034690, "comment_id": 75096293, "body": "That&#39;s the perils of brute-forcing. I&#39;m not sure what the pattern is here: <code>&quot;a&quot;, &quot;ab&quot;, &quot;bac&quot;, &quot;bdca&quot;, &quot;cbeda&quot;, &quot;cfedba&quot;, &quot;dcgfeba&quot;, &quot;dhgfecba&quot;, &quot;edihgfcba&quot;, &quot;ejihgfdcba&quot;</code> but that&#39;s the &quot;middle&quot; of each set for <code>abc...</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 217, "user_id": 4024427, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eeeba2d2482f856960056afbf14f8fca?s=128&d=identicon&r=PG&f=1", "display_name": "Clyde Brown", "link": "https://stackoverflow.com/users/4024427/clyde-brown"}, "edited": false, "score": 0, "creation_date": 1495055470, "post_id": 44034690, "comment_id": 75096326, "body": "If you can make a function that returns arbitrary permutation M for given string of length N then you could do this in pretty much <i>O(N)</i> time for any given string. This reminds me of the <a href=\"https://en.wikipedia.org/wiki/Tower_of_Hanoi\" rel=\"nofollow noreferrer\">Towers of Hanoi</a> problem."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1495056533, "post_id": 44034690, "comment_id": 75096799, "body": "The pattern is: (1) If there are an odd number of characters, take the middle one. (2) Take the character just before the middle of the characters (or remaining characters, if one was removed in step 1). (3) sort the remaining characters in reverse order."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1495056576, "post_id": 44034690, "comment_id": 75096817, "body": "@rici I think you&#39;re on to something there. If you can make that into a workable bit of code, that&#39;s a much better answer than mine."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1495056637, "post_id": 44034690, "comment_id": 75096845, "body": "@tadman: it only works if all the characters are distinct, which is why I asked about that. It should be obvious why it works. List permutations in ascending and descending order (as a mind experiment :-) ) Take permutations in matching positions. Note the correspondence between elements."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1495056699, "post_id": 44034690, "comment_id": 75096870, "body": "I think it&#39;d work regardless since the list is explicitly sorted, unless I&#39;m mistaken. <code>aaaaaa</code> is just trivially easy to do, but <code>aabbcc</code> should follow the same rules you described, so long as you pre-sort the characters of the string."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1495057094, "post_id": 44034690, "comment_id": 75097062, "body": "True, it will work if there are the same number of each element. All elements being unique is a special case of that, as are all elements being the same and all elements appearing exactly twice."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1495057403, "post_id": 44034690, "comment_id": 75097195, "body": "@rici Interesting. I didn&#39;t expect that behaviour, but testing it with <code>aabcddd</code> produces some really odd results. Presumably this is because multiple permutations that emit the same string are &quot;collapsed&quot; which throws off the effective middle."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1495214031, "post_id": 44034690, "comment_id": 75175162, "body": "@rici, I implemented your suggestion (slightly modified), though I didn&#39;t see your comment until after I posted."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1495054837, "creation_date": 1495054837, "answer_id": 44034690, "question_id": 44034273, "link": "https://stackoverflow.com/questions/44034273/permutations-of-strings-takes-too-long-to-solve/44034690#44034690", "title": "Permutations of strings takes too long to solve", "body": "<p>I was able to compact it like this:</p>\n\n<pre><code>def middle_permutation(string)\n  list = string.chars.permutation.map(&amp;:join).sort\n\n  list[list.length / 2 - (list.length.even? ? 1 : 0)]\nend\n</code></pre>\n\n<p>Which yields:</p>\n\n<pre><code>middle_permutation('zxcvbnmasd')\n# =&gt; \"mzxvsndcba\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 217, "user_id": 4024427, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eeeba2d2482f856960056afbf14f8fca?s=128&d=identicon&r=PG&f=1", "display_name": "Clyde Brown", "link": "https://stackoverflow.com/users/4024427/clyde-brown"}, "is_accepted": false, "score": 0, "last_activity_date": 1495120726, "last_edit_date": 1495120726, "creation_date": 1495057325, "answer_id": 44035215, "question_id": 44034273, "link": "https://stackoverflow.com/questions/44034273/permutations-of-strings-takes-too-long-to-solve/44035215#44035215", "title": "Permutations of strings takes too long to solve", "body": "<p>So it turns out there are two tracks to this, odd strings and even strings.</p>\n\n<p>For odd strings, you take out the middle character Element of the sorted array and the one before it, in that order. When you do that you have two remaining arrays, the one the right and left, both alphabetically sorted. You tack on elements of the right array, starting with the last element, then do the same for the one on the left. </p>\n\n<p>For even strings, Do the same but only take one character in the first step: the (N/2) element. </p>\n\n<p>Here's my solution:</p>\n\n<pre><code>def middle_permutation(string)\n  string_array = string.chars.sort\n\n  mid_string = []\n  length = string.length\n    if length.even? \n      mid_string &lt;&lt; string_array[length/2-1]\n      string_array.delete_at(length/2-1)\n      (mid_string &lt;&lt; string_array.reverse).flatten.join\n    else \n      mid_string &lt;&lt; string_array[(length/2)-1..length/2].reverse\n      string_array.slice!((length/2)-1, 2)\n     (mid_string &lt;&lt; string_array.reverse).flatten.join\n    end\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1495072407, "creation_date": 1495072407, "answer_id": 44037326, "question_id": 44034273, "link": "https://stackoverflow.com/questions/44034273/permutations-of-strings-takes-too-long-to-solve/44037326#44037326", "title": "Permutations of strings takes too long to solve", "body": "<p>You don't need to generate <strong>all</strong> permutations. Just find overall number of permutations as <code>PN = N!</code> where N is string (of different chars) length and calculate only needed <code>PN/2-th</code> permutation by its number - for example, using <a href=\"http://antoinecomeau.blogspot.ru/2014/07/mapping-between-permutations-and.html\" rel=\"nofollow noreferrer\">this approach</a></p>\n\n<pre><code>     public static int[] perm(int n, int k)  \n {  \n      int i, ind, m=k;  \n      int[] permuted = new int[n];  \n      int[] elems = new int[n];  \n      for(i=0;i&lt;n;i++) elems[i]=i;  \n      for(i=0;i&lt;n;i++)  \n      {  \n           ind=m%(n-i);  \n           m=m/(n-i);  \n           permuted[i]=elems[ind];  \n           elems[ind]=elems[n-i-1];  \n      }  \n      return permuted;  \n }  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 217, "user_id": 4024427, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eeeba2d2482f856960056afbf14f8fca?s=128&d=identicon&r=PG&f=1", "display_name": "Clyde Brown", "link": "https://stackoverflow.com/users/4024427/clyde-brown"}, "edited": false, "score": 0, "creation_date": 1495131535, "post_id": 44037643, "comment_id": 75135241, "body": "Yea! Wrote my code above if you wanna check it out. Came to the same kind of reasoning soon after I started looking at the sorted original array with the middle permutation."}], "tags": [], "owner": {"reputation": 4989, "user_id": 2041077, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/MPBxe.jpg?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2041077/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1495074690, "creation_date": 1495074690, "answer_id": 44037643, "question_id": 44034273, "link": "https://stackoverflow.com/questions/44034273/permutations-of-strings-takes-too-long-to-solve/44037643#44037643", "title": "Permutations of strings takes too long to solve", "body": "<p>I'm assuming the letters are unique, as in the OP's question.</p>\n\n<ol>\n<li>Sort</li>\n<li>Pluck the middle letter of the sorted string (rounded down). This is the first letter of the middle permutation.</li>\n<li>If the original list had an even number of letters, the rest of the permutation is the reverse sort of the remaining letters.</li>\n<li>If not, take the middle letter again. Now the rest of the result is the reverse sort of the remaining letters.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1495254079, "last_edit_date": 1495254079, "creation_date": 1495142883, "answer_id": 44058062, "question_id": 44034273, "link": "https://stackoverflow.com/questions/44034273/permutations-of-strings-takes-too-long-to-solve/44058062#44058062", "title": "Permutations of strings takes too long to solve", "body": "<p>The method below returns the desired permutation directly, without iterating through permutations. </p>\n\n<p>The asker has stated that the string contains no duplicated letters, which is a requirement for this method. I assume the characters of the string are sorted. If they are not, the creation of a sorted string would be the first step:</p>\n\n<pre><code>str = \"ebadc\".chars.sort.join\n  #=&gt; \"abcde\"\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def mid_perm(str)\n  return mid_perm_even_length_strings(str) if str.size.even?\n  first_char_index = str.size/2\n  str[first_char_index] &lt;&lt; mid_perm_even_length_strings(str[0,first_char_index] +\n    str[first_char_index+1..-1])\nend\n\ndef mid_perm_even_length_strings(str)\n  first_char_index = str.size/2-1\n  str[first_char_index] + (str[0,first_char_index] + str[first_char_index+1..-1]).reverse\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>mid_perm 'abcd'\n  #=&gt; \"bdca\" \nmid_perm 'abcde'\n  #=&gt; \"cbeda\" \nmid_perm 'abcdefghijklmnopqrstuvwxyz'\n  #=&gt; \"mzyxwvutsrqponlkjihgfedcba\" \n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>Let's start by defining a method to produce permutations of the letters of a string.</p>\n\n<pre><code>def perms(str)\n  str.chars.permutation(str.size).map(&amp;:join)\nend\n</code></pre>\n\n<p><em>Strings containing an even number of characters</em></p>\n\n<p>Consider</p>\n\n<pre><code>a = perms \"abcd\"\n  #=&gt; [\"abcd\", \"abdc\", \"acbd\", \"acdb\", \"adbc\", \"adcb\",\n  #    \"bacd\", \"badc\", \"bcad\", \"bcda\", \"bdac\", \"bdca\",\n  #    \"cabd\", \"cadb\", \"cbad\", \"cbda\", \"cdab\", \"cdba\",\n  #    \"dabc\", \"dacb\", \"dbac\", \"dbca\", \"dcab\", \"dcba\"] \n</code></pre>\n\n<p><code>a</code> contains <code>4! #=&gt; 4*3*2 =&gt; 24</code> elements, <code>4</code> being the length of the string.</p>\n\n<p>Notice that since the characters in <code>perms</code>' argument are sorted, the array returned is also sorted<sup>1</sup>.</p>\n\n<pre><code>a == a.sort  #=&gt;true\n</code></pre>\n\n<p>As <code>a.size #=&gt; 24</code>, the \"middle\" element is either <code>a[11] #=&gt; \"bdca\"</code> or <code>a[12] #=&gt; \"cabd\"</code> (where <code>11 = (24-1)/2</code> and <code>12 = 24/2</code>), depending on how we want to round. The question stipulates that, for even-length strings, we are to round down, so that would be <code>\"bdca\"</code>.</p>\n\n<p>Now let's slice <code>a</code> into <code>str.size</code> equal arrays, each containing <code>a.size/str.size #=&gt; 24/4 =&gt; 6</code> elements:</p>\n\n<pre><code>b = a.each_slice(a.size/str.size).to_a\n  #=&gt; [[\"abcd\", \"abdc\", \"acbd\", \"acdb\", \"adbc\", \"adcb\"],\n  #    [\"bacd\", \"badc\", \"bcad\", \"bcda\", \"bdac\", \"bdca\"],\n  #    [\"cabd\", \"cadb\", \"cbad\", \"cbda\", \"cdab\", \"cdba\"],\n  #    [\"dabc\", \"dacb\", \"dbac\", \"dbca\", \"dcab\", \"dcba\"]]\n</code></pre>\n\n<p>The desired element is therefore</p>\n\n<pre><code>b[(a.size/str.size-1)/2-1][-1]\n  #=&gt; \"bdca\"\n</code></pre>\n\n<p>This value can be computed more directly as follows.</p>\n\n<pre><code>first_char_index = str.size/2-1\n  #=&gt; 1 \nfirst_char = str[first_char_index]\n  #=&gt; \"b\" \nremaining_chars = (str[0,first_char_index] + str[first_char_index+1..-1]).reverse\n  #=&gt; \"dca\" \nfirst_char + remaining_chars\n  #=&gt; \"bdca\" \n</code></pre>\n\n<p>The same logic applies to all strings having an even number of characters. We therefore can write the method <code>mid_perm_even_length_strings</code> shown in the <em>Code</em> section above.</p>\n\n<p>For example (for a 12-character string)</p>\n\n<pre><code>mid_perm_even_length_strings 'abcdefghijkl'\n  #=&gt; \"flkjihgedcba\"\n</code></pre>\n\n<p><em>Strings containing an odd number of characters</em></p>\n\n<p>Now consider</p>\n\n<pre><code>str = \"abcde\"\na = perms str\n  #=&gt; [\"abcde\", \"abced\", \"abdce\", \"abdec\", \"abecd\", \"abedc\",\n  #    \"acbde\", \"acbed\", \"acdbe\", \"acdeb\", \"acebd\", \"acedb\",\n  #    \"adbce\", \"adbec\", \"adcbe\", \"adceb\", \"adebc\", \"adecb\",\n  #    \"aebcd\", \"aebdc\", \"aecbd\", \"aecdb\", \"aedbc\", \"aedcb\",\n\n  #    \"bacde\", \"baced\", \"badce\", \"badec\", \"baecd\",..., \"bedca\",\n\n  #    \"cabde\", \"cabed\", \"cadbe\", \"cadeb\", \"caebd\", \"caedb\",\n  #    \"cbade\", \"cbaed\", \"cbdae\", \"cbdea\", \"cbead\", \"cbeda\",\n  #    \"cdabe\", \"cdaeb\", \"cdbae\", \"cdbea\", \"cdeab\", \"cdeba\",\n  #    \"ceabd\", \"ceadb\", \"cebad\", \"cebda\", \"cedab\", \"cedba\",\n\n  #   \"dabce\", \"dabec\", \"dacbe\", \"daceb\", \"daebc\",..., \"decba\",\n\n  #   \"eabcd\", \"eabdc\", \"eacbd\", \"eacdb\", \"eadbc\",..., \"edcba\"] \n</code></pre>\n\n<p>Here the permutation contains <code>5! #=&gt; 100</code> elements, in <code>5</code> blocks of <code>20</code>. (Again, <code>a.each_cons(2).all? { |s1,s2| s1 &lt; s2 } #=&gt; true</code>.)</p>\n\n<p>The middle element of <code>a</code> is clearly the middle element of the block of elements that begin with</p>\n\n<pre><code>str[str.size/2] #=&gt; \"c\"\n</code></pre>\n\n<p>That block would be the array</p>\n\n<pre><code>b = a.each_slice(a.size/str.size).to_a[str.size/2]\n  #=&gt; [\"cabde\", \"cabed\", \"cadbe\", \"cadeb\", \"caebd\", \"caedb\",\n  #    \"cbade\", \"cbaed\", \"cbdae\", \"cbdea\", \"cbead\", \"cbeda\",\n  #    \"cdabe\", \"cdaeb\", \"cdbae\", \"cdbea\", \"cdeab\", \"cdeba\",\n  #    \"ceabd\", \"ceadb\", \"cebad\", \"cebda\", \"cedab\", \"cedba\"]\n</code></pre>\n\n<p>which would be <code>'c'</code> plus the middle element of the array</p>\n\n<pre><code>[\"abde\", \"abed\", \"adbe\", \"adeb\", \"aebd\", \"aedb\",\n \"bade\", \"baed\", \"bdae\", \"bdea\", \"bead\", \"beda\",\n \"dabe\", \"daeb\", \"dbae\", \"dbea\", \"deab\", \"deba\",\n \"eabd\", \"eadb\", \"ebad\", \"ebda\", \"edab\", \"edba\"]\n</code></pre>\n\n<p>That array is merely the permutations of the string <code>\"abde\"</code>. Since that string contains an even number characters, its middle element is</p>\n\n<pre><code>mid_perm_even_length_strings 'abde'\n  #=&gt; \"beda\"\n</code></pre>\n\n<p>It follows that the middle element of the permutations of the letters of <code>\"abcde\"</code> is therefore</p>\n\n<pre><code>'c' + 'abde'\n  #=&gt; \"cabde\"\n</code></pre>\n\n<p>This clearly applies to all strings containing an odd number of characters.</p>\n\n<p><sup>1. The doc for <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-permutation\" rel=\"nofollow noreferrer\">Array#permutation</a> states, \"The implementation makes no guarantees about the order in which the permutations are yielded.\". We therefore might need to tack <code>.sort</code> to the end of the operative line of <code>perms</code>, but with Ruby v2.4 (and I suspect, earlier versions) that is, in fact not necessary here</sup>.</p>\n"}], "owner": {"reputation": 217, "user_id": 4024427, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eeeba2d2482f856960056afbf14f8fca?s=128&d=identicon&r=PG&f=1", "display_name": "Clyde Brown", "link": "https://stackoverflow.com/users/4024427/clyde-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1495254079, "creation_date": 1495053135, "last_edit_date": 1495069291, "question_id": 44034273, "link": "https://stackoverflow.com/questions/44034273/permutations-of-strings-takes-too-long-to-solve", "title": "Permutations of strings takes too long to solve", "body": "<p>I'm creating an array of permutated and unique letters in a string, only to sort them alphabetically and find the middle element in the set. </p>\n\n<pre><code>def middle_permutation(string)\n  length = string.length\n  permutation_set = string.split(\"\").permutation(length).to_a.map{|item| item.join}.sort\n  permutation_set.length.even? ? permutation_set[(permutation_set.length)/2-1] : permutation_set[(permutation_set.length/2)+1]\nend\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>middle_permutation(\"zxcvbnmasd\") should equal \"mzxvsndcba\" \n</code></pre>\n\n<p>Even for small strings (N >=10), the calculations take pretty long to finish, and I can forget about anything double that; is there a quicker way?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 3, "creation_date": 1495051662, "post_id": 44033865, "comment_id": 75094440, "body": "That&#39;s a hard question to answer without some specific information. Can you provide an example? What fields are in your model, what information comes from the outside service, what do you need to query?"}, {"owner": {"reputation": 307, "user_id": 6499808, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9246686a538bc4ad55e6a155f034bc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Mega Man", "link": "https://stackoverflow.com/users/6499808/mega-man"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1495051773, "post_id": 44033865, "comment_id": 75094522, "body": "@moveson Sure, I&#39;ll try to add some pseudocode to get a better idea, but the gist should be the same regardless"}, {"owner": {"reputation": 13459, "user_id": 550349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSyCs.jpg?s=128&g=1", "display_name": "stef", "link": "https://stackoverflow.com/users/550349/stef"}, "edited": false, "score": 2, "creation_date": 1495055023, "post_id": 44033865, "comment_id": 75096119, "body": "Hi. I think this is going to fall into &quot;overly broad / primarily opinion based&quot; unless you can give us some code to work with, sorry."}], "answers": [{"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 2, "last_activity_date": 1495052776, "creation_date": 1495052776, "answer_id": 44034181, "question_id": 44033865, "link": "https://stackoverflow.com/questions/44033865/augment-a-database-query-with-data-from-a-service/44034181#44034181", "title": "Augment a database query with data from a service", "body": "<p>You shouldn't need to use raw SQL. You should be able to do something like this:</p>\n\n<pre><code>part_numbers = [123, 456, 789] # Part numbers returned by the outside service\n\nsimilar_parts = Part.where(part_number: part_numbers)\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 6499808, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9246686a538bc4ad55e6a155f034bc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Mega Man", "link": "https://stackoverflow.com/users/6499808/mega-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495052776, "creation_date": 1495051477, "last_edit_date": 1495052017, "question_id": 44033865, "link": "https://stackoverflow.com/questions/44033865/augment-a-database-query-with-data-from-a-service", "title": "Augment a database query with data from a service", "body": "<p>I have a query from models in my database, and some further optional information that comes from an external service, that will filter my existing query.  My current plan of attack is to use a temporary table from data that is returned by the service.  Is this type of thing advisable?  There aren't many places in the application where raw SQL is used, and I'd like to hear other's thoughts on this sort of thing.</p>\n\n<p>I have a Job model that has many Assets and Parts.  </p>\n\n<p>My current query returns me a collection of all Jobs, and Assets and Parts.\nThe service I'm hitting returns an array of similar Parts to a specific part passed into the service.  The service returns a list of Part ids to filter on.  </p>\n\n<p><code>rails 4.2</code></p>\n"}, {"tags": ["java", "ruby", "testing", "junit"], "comments": [{"owner": {"reputation": 7363, "user_id": 905488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb324daddc3ad22736171ba863234d8?s=128&d=identicon&r=PG", "display_name": "Mick Mnemonic", "link": "https://stackoverflow.com/users/905488/mick-mnemonic"}, "edited": false, "score": 0, "creation_date": 1495050280, "post_id": 44033465, "comment_id": 75093581, "body": "Maybe you previously built on Windows and now copied the files to Linux, where file names are case-sensitive (and should match class names). Also, the JUnit jar does not appear to be in the classpath."}, {"owner": {"reputation": 13, "user_id": 7097476, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7a684b8097b262d502a0170f17291942?s=128&d=identicon&r=PG&f=1", "display_name": "bwielk", "link": "https://stackoverflow.com/users/7097476/bwielk"}, "reply_to_user": {"reputation": 7363, "user_id": 905488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb324daddc3ad22736171ba863234d8?s=128&d=identicon&r=PG", "display_name": "Mick Mnemonic", "link": "https://stackoverflow.com/users/905488/mick-mnemonic"}, "edited": false, "score": 0, "creation_date": 1495051034, "post_id": 44033465, "comment_id": 75094039, "body": "but it seems to be in the classpath. When I type the set CLASSPATH command on prompt, I get the entire path leading to junit.jar file. I use bash to run the file...maybe that&#39;s the problem"}, {"owner": {"reputation": 2074, "user_id": 5917104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q61Sn.png?s=128&g=1", "display_name": "Riaan Nel", "link": "https://stackoverflow.com/users/5917104/riaan-nel"}, "reply_to_user": {"reputation": 7363, "user_id": 905488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb324daddc3ad22736171ba863234d8?s=128&d=identicon&r=PG", "display_name": "Mick Mnemonic", "link": "https://stackoverflow.com/users/905488/mick-mnemonic"}, "edited": false, "score": 0, "creation_date": 1495086227, "post_id": 44033465, "comment_id": 75104887, "body": "@MickMnemonic - even though file names are not case-sensitive on Windows, Java still requires that class names and file names match exactly, regardless of which platform you&#39;re on."}, {"owner": {"reputation": 2074, "user_id": 5917104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q61Sn.png?s=128&g=1", "display_name": "Riaan Nel", "link": "https://stackoverflow.com/users/5917104/riaan-nel"}, "edited": false, "score": 0, "creation_date": 1495086328, "post_id": 44033465, "comment_id": 75104930, "body": "@bwielk That&#39;s a good theory - what happens if you explicitly set it in your Bash script or terminal?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7097476, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7a684b8097b262d502a0170f17291942?s=128&d=identicon&r=PG&f=1", "display_name": "bwielk", "link": "https://stackoverflow.com/users/7097476/bwielk"}, "edited": false, "score": 0, "creation_date": 1495050612, "post_id": 44033518, "comment_id": 75093773, "body": "I have already done it earlier and it&#39;s still not working. when I type set CLASSPATH on command prompt, I get the entire path of the junit.jar file"}, {"owner": {"reputation": 2074, "user_id": 5917104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q61Sn.png?s=128&g=1", "display_name": "Riaan Nel", "link": "https://stackoverflow.com/users/5917104/riaan-nel"}, "reply_to_user": {"reputation": 13, "user_id": 7097476, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7a684b8097b262d502a0170f17291942?s=128&d=identicon&r=PG&f=1", "display_name": "bwielk", "link": "https://stackoverflow.com/users/7097476/bwielk"}, "edited": false, "score": 0, "creation_date": 1495050826, "post_id": 44033518, "comment_id": 75093908, "body": "How are you trying to compile this code?  Via an IDE or on the command line?  I would try to see what happens when you specify the classpath explicitly when you compile it (the -cp argument on the command line)."}, {"owner": {"reputation": 13, "user_id": 7097476, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7a684b8097b262d502a0170f17291942?s=128&d=identicon&r=PG&f=1", "display_name": "bwielk", "link": "https://stackoverflow.com/users/7097476/bwielk"}, "edited": false, "score": 0, "creation_date": 1495051323, "post_id": 44033518, "comment_id": 75094222, "body": "I am compiling it using bash that is set for ruby and java."}, {"owner": {"reputation": 13, "user_id": 7097476, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7a684b8097b262d502a0170f17291942?s=128&d=identicon&r=PG&f=1", "display_name": "bwielk", "link": "https://stackoverflow.com/users/7097476/bwielk"}, "edited": false, "score": 0, "creation_date": 1495051808, "post_id": 44033518, "comment_id": 75094546, "body": "I have just attached an image showing that the CLASSPATH is set right."}], "tags": [], "owner": {"reputation": 2074, "user_id": 5917104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q61Sn.png?s=128&g=1", "display_name": "Riaan Nel", "link": "https://stackoverflow.com/users/5917104/riaan-nel"}, "is_accepted": false, "score": 0, "last_activity_date": 1495050183, "creation_date": 1495050183, "answer_id": 44033518, "question_id": 44033465, "link": "https://stackoverflow.com/questions/44033465/junit-test-wont-run-and-receiving-lots-of-errors/44033518#44033518", "title": "junit - test won&#39;t run and receiving lots of errors", "body": "<p>For the first two errors relating to CashDesk and CashDeskTest - your file names have a lowercase 'd' (Cashdesk.java and CashdeskTest.java).  The casing in the file name should match the actual class names as declared in the code.  Fix that.  </p>\n\n<p>If you still see JUnit errors afterwards, check that you have a JUnit JAR on your classpath.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7097476, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7a684b8097b262d502a0170f17291942?s=128&d=identicon&r=PG&f=1", "display_name": "bwielk", "link": "https://stackoverflow.com/users/7097476/bwielk"}, "edited": false, "score": 0, "creation_date": 1495050542, "post_id": 44033537, "comment_id": 75093725, "body": "what do you mean by &quot;the classpath OF MY PROJECT&quot;? :) my classpath says it&#39;s set to junit.jar"}, {"owner": {"reputation": 1587, "user_id": 1967021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec87a032dd3d3f1c76cd13582e60a54?s=128&d=identicon&r=PG", "display_name": "Ivan Pronin", "link": "https://stackoverflow.com/users/1967021/ivan-pronin"}, "reply_to_user": {"reputation": 13, "user_id": 7097476, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7a684b8097b262d502a0170f17291942?s=128&d=identicon&r=PG&f=1", "display_name": "bwielk", "link": "https://stackoverflow.com/users/7097476/bwielk"}, "edited": false, "score": 0, "creation_date": 1495050912, "post_id": 44033537, "comment_id": 75093958, "body": "I mean the CP for your program. If you are getting junit not found error - this definately means this library is not found in the classpath. It may be wise to post  contents of you *.rb files"}, {"owner": {"reputation": 13, "user_id": 7097476, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7a684b8097b262d502a0170f17291942?s=128&d=identicon&r=PG&f=1", "display_name": "bwielk", "link": "https://stackoverflow.com/users/7097476/bwielk"}, "edited": false, "score": 0, "creation_date": 1495051739, "post_id": 44033537, "comment_id": 75094498, "body": "I have just attached an image showing my set CLASSPATH"}, {"owner": {"reputation": 13, "user_id": 7097476, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7a684b8097b262d502a0170f17291942?s=128&d=identicon&r=PG&f=1", "display_name": "bwielk", "link": "https://stackoverflow.com/users/7097476/bwielk"}, "edited": false, "score": 0, "creation_date": 1495052384, "post_id": 44033537, "comment_id": 75094851, "body": "and I have attached the contents of the rb files"}], "tags": [], "owner": {"reputation": 1587, "user_id": 1967021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec87a032dd3d3f1c76cd13582e60a54?s=128&d=identicon&r=PG", "display_name": "Ivan Pronin", "link": "https://stackoverflow.com/users/1967021/ivan-pronin"}, "is_accepted": false, "score": 0, "last_activity_date": 1495050244, "creation_date": 1495050244, "answer_id": 44033537, "question_id": 44033465, "link": "https://stackoverflow.com/questions/44033465/junit-test-wont-run-and-receiving-lots-of-errors/44033537#44033537", "title": "junit - test won&#39;t run and receiving lots of errors", "body": "<p>Errors <code>Cashdesk.java:4: error: class CashDesk is public, should be \ndeclared in a file named CashDesk.java</code> are caused by inconsistency between .java file names and public class which it contains. In this exaple class CashDesk is saved in <code>Cashdesk.java</code> file - note d vs D in Desk.</p>\n\n<p>The second bunch of errors <code>error: package org.junit does not exist</code> mean you should include JUnit library to the classpath of your project</p>\n"}], "owner": {"reputation": 13, "user_id": 7097476, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7a684b8097b262d502a0170f17291942?s=128&d=identicon&r=PG&f=1", "display_name": "bwielk", "link": "https://stackoverflow.com/users/7097476/bwielk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495052126, "creation_date": 1495049981, "last_edit_date": 1495052126, "question_id": 44033465, "link": "https://stackoverflow.com/questions/44033465/junit-test-wont-run-and-receiving-lots-of-errors", "title": "junit - test won&#39;t run and receiving lots of errors", "body": "<p>I have downloaded my old project that was built on a different computer. I have Java environment installed on the current one. I have also downloaded junit to get things work. When I run my tests using build.rb and run_test.rb - files that worked previously, I receive lots of errors negating the entire code. Here's the example</p>\n\n<pre><code>$ ruby build.rb\nshop_basket\\Cashdesk.java:4: error: class CashDesk is public, should be \ndeclared in a file named CashDesk.java\npublic class CashDesk{\n   ^\n1 error\nshop_basketSpec\\CashdeskTest.java:5: error: class CashDeskTest is public, \nshould be declared in a file named CashDeskTest.java\npublic class CashDeskTest{\n   ^\nshop_basketSpec\\BasketTest.java:2: error: package org.junit does not exist\nimport org.junit.*;\n^\nshop_basketSpec\\BasketTest.java:3: error: package org.junit does not exist\nimport static org.junit.Assert.*;\n                   ^\nshop_basketSpec\\CashdeskTest.java:2: error: package org.junit does not exist\nimport org.junit.*;\n^\nshop_basketSpec\\CashdeskTest.java:3: error: package org.junit does not exist\nimport static org.junit.Assert.*;\n                   ^\nshop_basketSpec\\CashdeskTest.java:7: error: cannot find symbol\nCashDesk cashdesk;\n ^\nsymbol:   class CashDesk\nlocation: class CashDeskTest\nshop_basketSpec\\CustomerTest.java:2: error: package org.junit does not exist\nimport org.junit.*;\n^\n shop_basketSpec\\CustomerTest.java:3: error: package org.junit does not \n exist\n import static org.junit.Assert.*;   ^\n shop_basketSpec\\ProductTest.java:2: error: package org.junit does not exist\n import org.junit.*;\n  ^\n</code></pre>\n\n<p>and there are more errors like this as if they concerned the entire code structure. I don't get why.\nAll the CLASSPATH etc seems to be set on my windows OS. The entire thing irritates as I cannot move with my coding. Thanks for help</p>\n\n<p>Here's my set CLASSPATH\n<a href=\"https://i.stack.imgur.com/Tm7dT.jpg\" rel=\"nofollow noreferrer\">CLASSPATH image</a></p>\n\n<p>The content of my ruby files</p>\n\n<p>run_tests.rb </p>\n\n<pre><code>require 'find'\n\ndef find_valid_files\n  files = []\n  Find.find('bin') do |path|\n  files &lt;&lt; path if path.include?(\".class\") &amp;&amp; path.include?(\"Test\")\nend\nreturn files\nend\n\ndef run_tests(files)\n  for file in files\n   fileName = File.basename(file, \".*\")\n   puts \"Running #{fileName}\"\n\n  system(\"java org.junit.runner.JUnitCore #{fileName}\")\n end\n end\n\nvalid_files = find_valid_files()\n\nDir.chdir \"bin\"\n\nrun_tests(valid_files)\n</code></pre>\n\n<p>build.rb</p>\n\n<pre><code>require 'fileutils'\n\ndef filter_directories\n\n  excluded_directories = [\"bin\"]\n\n  all_files = Dir.glob('*')\n\n return all_files.select do |file|\n   next if excluded_directories.include?(file)\n   File.directory?(file)\n end\nend\n\ndef create_bin\n  FileUtils.rm_rf('bin')\n  FileUtils.mkdir_p('bin')\nend\n\ndef run_tests directories\n  for directory in directories \n    puts \"building #{directory}\"\n   system(\"javac -d bin #{directory}/*.java\")\n  end\nend\n\ncreate_bin()\n\nvalid_directories = filter_directories()\n\nrun_tests(valid_directories)\n</code></pre>\n"}, {"tags": ["ruby", "sorting"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1495049832, "post_id": 44033176, "comment_id": 75093325, "body": "There is a ton of code missing here, like what <code>get</code> and <code>swap</code> do."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1495049865, "post_id": 44033176, "comment_id": 75093350, "body": "Keep in mind Ruby hardly ever uses <code>for</code> directly. It&#39;s preferable to do <code>list.each</code> or <code>list.each_with_index</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1495049971, "post_id": 44033176, "comment_id": 75093407, "body": "Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;, &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and &quot;<a href=\"http://meta.stackoverflow.com/questions/261592\">How much research effort is expected of Stack Overflow users?</a>&quot;."}, {"owner": {"reputation": 11, "user_id": 8027438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5eef32773fbb03c986ddd388b6c286?s=128&d=identicon&r=PG&f=1", "display_name": "asddsa", "link": "https://stackoverflow.com/users/8027438/asddsa"}, "edited": false, "score": 0, "creation_date": 1495050035, "post_id": 44033176, "comment_id": 75093440, "body": "Added code of methods and my try of insertion sort"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1495059691, "post_id": 44033176, "comment_id": 75098021, "body": "Don&#39;t use <code>and</code>, use <code>&amp;&amp;</code> instead. You have objects in your code that aren&#39;t defined. Don&#39;t do that. Again, see &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. We need verifiable code, which means code that runs, but doesn&#39;t do what you want. Syntax errors are a reason we close questions."}], "owner": {"reputation": 11, "user_id": 8027438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5eef32773fbb03c986ddd388b6c286?s=128&d=identicon&r=PG&f=1", "display_name": "asddsa", "link": "https://stackoverflow.com/users/8027438/asddsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495059616, "creation_date": 1495048965, "last_edit_date": 1495059616, "question_id": 44033176, "link": "https://stackoverflow.com/questions/44033176/how-to-create-a-bubble-sort-of-a-double-linked-list-for-ruby", "title": "How to create a bubble sort of a double-linked list for Ruby", "body": "<p>I have been implementing a bubble sort for a doubly linked list:</p>\n\n<pre><code>def sort2(list)  #bubble sort\n  for i in 0...list.length\n    for j in 0...list.length-1-i\n      if list.get(j+1)&lt;list.get(j)\n        list.swap(j+1, j)\n      end\n    end\n  end\nend \n</code></pre>\n\n<p>I don't have any idea how implement a bucket-sort. We can only use methods like:</p>\n\n<ul>\n<li><code>get(i)</code> - which return value of <code>i</code> element</li>\n<li><code>swap(i, j)</code> - which swaps two elements</li>\n<li><code>length(list)</code> - return length of list</li>\n</ul>\n\n<p>This is the code for <code>get</code>, <code>swap</code> and <code>length</code>:</p>\n\n<pre><code>def swap(i,j)  \n  if i &gt; j\n    i, j = j, i\n  elsif j == i\n    return\n  end\n  tmp = nil        \n  list = @ListE.next  #first element\n  for it in 0...j\n    if i == it\n      tmp = list\n    end\n    list = list.next\n  end\n  tmp.v, list.v = list.v, tmp.v\nend\n\ndef get(i)\n  a = @ListE\n  while i&gt;0\n    a = a.next\n    i-=1\n  end\n  return a.next.v\nend\n\ndef length()\n  list = @ListE.next\n  length_of_list = 0\n  while list.v != nil\n    length_of_list += 1\n    list = list.next\n  end\n  return length_of_list\nend\n</code></pre>\n\n<p>This is my attempt at an insertion sort:</p>\n\n<pre><code>def sort3(list)  #insertion sort\n  for i in 1...list.length\n    j = i\n    while j &gt; 0 and list.get(j-1) &gt; list.get(j)\n      list.swap(j-1, i)\n      j -= 1\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "heroku", "sinatra", "twilio"], "comments": [{"owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "edited": false, "score": 0, "creation_date": 1495048626, "post_id": 44032982, "comment_id": 75092644, "body": "I first suggest, you should write code that handle Exception. Please check their document for exception handling. <a href=\"https://www.twilio.com/docs/libraries/ruby#exceptions\" rel=\"nofollow noreferrer\">twilio.com/docs/libraries/ruby#exceptions</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5744666"}, "reply_to_user": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "edited": false, "score": 0, "creation_date": 1495048978, "post_id": 44032982, "comment_id": 75092842, "body": "I did that, copying and pasting in and changing the phone numbers. It got rid of the 500 internal error, but nothing sends. And checking Heroku logs, there&#39;s no additional messages."}, {"owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "edited": false, "score": 0, "creation_date": 1495049135, "post_id": 44032982, "comment_id": 75092938, "body": "ok. Locally application runs in development environment and when we deploy on Heroku, it runs on production environment. Did you checked both environment configuration for twilio ? Also please update your question and add code for exception handling."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5744666"}, "reply_to_user": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "edited": false, "score": 0, "creation_date": 1495057124, "post_id": 44032982, "comment_id": 75097078, "body": "That was it. I was using  ENV[] for the Twilio SID and auth token. How would I reference those environment variables in a production environment?"}, {"owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "edited": false, "score": 0, "creation_date": 1495088778, "post_id": 44032982, "comment_id": 75106110, "body": "I am going to write answer for it."}], "answers": [{"tags": [], "owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "is_accepted": false, "score": 0, "last_activity_date": 1495089142, "creation_date": 1495089142, "answer_id": 44040232, "question_id": 44032982, "link": "https://stackoverflow.com/questions/44032982/500-internal-server-error-trying-to-send-an-sms-using-twilio/44040232#44040232", "title": "500 Internal Server Error Trying to Send an SMS using Twilio", "body": "<p>As per discussion in comment, you have configuration problem. You can run program in locally(development environment) and not heroku(production environment).</p>\n\n<p>As you mention in comment, you are using EVN to set credentials. You can do set this in 2 ways to set ENV in Heroku.</p>\n\n<p>1) write configuration in <code>config/production.rb</code></p>\n\n<p>2) <strong>Recommended</strong> : Set ENV from Heroku Console. Here is Ref. link to do it <a href=\"https://devcenter.heroku.com/articles/config-vars\" rel=\"nofollow noreferrer\">Heroku config vars</a></p>\n\n<p>You can also use <a href=\"https://github.com/laserlemon/figaro\" rel=\"nofollow noreferrer\">Figaro gem</a> for your application.</p>\n\n<p>Hope that helps !</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5744666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 478, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495089142, "creation_date": 1495048133, "last_edit_date": 1495048467, "question_id": 44032982, "link": "https://stackoverflow.com/questions/44032982/500-internal-server-error-trying-to-send-an-sms-using-twilio", "title": "500 Internal Server Error Trying to Send an SMS using Twilio", "body": "<p>Using Heroku to host a Sinatra app. I have a route that's supposed to send an SMS. It returns a 500 internal server error instead.</p>\n\n<p>Everything works perfectly fine in localhost. The logs show a Twilio::REST::RequestError.</p>\n\n<p><strong>main.rb</strong></p>\n\n<pre><code>post '/sms/send' do\n\n    @client = Twilio::REST::Client.new account_sid, auth_token \n\n    @client.account.messages.create(\n        from: '+xxxxxxxxxxx',\n        to: '+xxxxxxxxxxx',\n        body: 'Robot invasion! Reply back with any sightings.'\n    )       \nend\n</code></pre>\n\n<p>Logs:</p>\n\n<pre><code>2017-05-17T19:04:24.640120+00:00 heroku[router]: at=info method=POST path=\"/sms/send\" host=dysfunctionalapp.herokuapp.com request_id=a3736f1a-2264-4b91-b0a9-a3bde94342bd fwd=\"216.73.77.194\" dyno=web.1 connect=0ms service=22ms status=500 bytes=255 protocol=https\n2017-05-17T19:04:24.639060+00:00 app[web.1]: 2017-05-17 19:04:24 - Twilio::REST::RequestError - Twilio::REST::RequestError:\n2017-05-17T19:04:24.639072+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/twilio-ruby-4.13.0/lib/twilio-ruby/rest/base_client.rb:125:in `connect_and_send'\n2017-05-17T19:04:24.639074+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/twilio-ruby-4.13.0/lib/twilio-ruby/rest/base_client.rb:55:in `block (2 levels) in &lt;class:BaseClient&gt;'\n2017-05-17T19:04:24.639075+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/twilio-ruby-4.13.0/lib/twilio-ruby/rest/list_resource.rb:94:in `create'\n2017-05-17T19:04:24.639076+00:00 app[web.1]:    /app/main.rb:84:in `block in &lt;top (required)&gt;'\n2017-05-17T19:04:24.639078+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1632:in `call'\n2017-05-17T19:04:24.639078+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1632:in `block in compile!'\n2017-05-17T19:04:24.639079+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:991:in `block (3 levels) in route!'\n2017-05-17T19:04:24.639095+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1010:in `route_eval'\n2017-05-17T19:04:24.639096+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:991:in `block (2 levels) in route!'\n2017-05-17T19:04:24.639097+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1037:in `block in process_route'\n2017-05-17T19:04:24.639097+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1035:in `catch'\n2017-05-17T19:04:24.639098+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1035:in `process_route'\n2017-05-17T19:04:24.639099+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:989:in `block in route!'\n2017-05-17T19:04:24.639099+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:988:in `each'\n2017-05-17T19:04:24.639100+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:988:in `route!'\n2017-05-17T19:04:24.639101+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1094:in `block in dispatch!'\n2017-05-17T19:04:24.639101+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1073:in `block in invoke'\n2017-05-17T19:04:24.639102+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1073:in `catch'\n2017-05-17T19:04:24.639102+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1073:in `invoke'\n2017-05-17T19:04:24.639103+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1091:in `dispatch!'\n2017-05-17T19:04:24.639104+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:923:in `block in call!'\n2017-05-17T19:04:24.639105+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1073:in `block in invoke'\n2017-05-17T19:04:24.639105+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1073:in `catch'\n2017-05-17T19:04:24.639106+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1073:in `invoke'\n2017-05-17T19:04:24.639106+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:923:in `call!'\n2017-05-17T19:04:24.639107+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:913:in `call'\n2017-05-17T19:04:24.639108+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/rack-protection-2.0.0/lib/rack/protection/xss_header.rb:18:in `call'\n2017-05-17T19:04:24.639108+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/rack-protection-2.0.0/lib/rack/protection/path_traversal.rb:16:in `call'\n2017-05-17T19:04:24.639109+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/rack-protection-2.0.0/lib/rack/protection/json_csrf.rb:26:in `call'\n2017-05-17T19:04:24.639110+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/rack-protection-2.0.0/lib/rack/protection/base.rb:50:in `call'\n2017-05-17T19:04:24.639110+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/rack-protection-2.0.0/lib/rack/protection/base.rb:50:in `call'\n2017-05-17T19:04:24.639111+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/rack-protection-2.0.0/lib/rack/protection/frame_options.rb:31:in `call'\n2017-05-17T19:04:24.639112+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/rack-2.0.3/lib/rack/logger.rb:15:in `call'\n2017-05-17T19:04:24.639113+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/rack-2.0.3/lib/rack/common_logger.rb:33:in `call'\n2017-05-17T19:04:24.639113+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:231:in `call'\n2017-05-17T19:04:24.639114+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:224:in `call'\n2017-05-17T19:04:24.639114+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/rack-2.0.3/lib/rack/head.rb:12:in `call'\n2017-05-17T19:04:24.639115+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/rack-2.0.3/lib/rack/method_override.rb:22:in `call'\n2017-05-17T19:04:24.639116+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:194:in `call'\n2017-05-17T19:04:24.639116+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1955:in `call'\n2017-05-17T19:04:24.639117+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1499:in `block in call'\n2017-05-17T19:04:24.639118+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1726:in `synchronize'\n2017-05-17T19:04:24.639118+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.0/lib/sinatra/base.rb:1499:in `call'\n2017-05-17T19:04:24.639125+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/lib/thin/connection.rb:86:in `block in pre_process'\n2017-05-17T19:04:24.639125+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/lib/thin/connection.rb:84:in `catch'\n2017-05-17T19:04:24.639126+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/lib/thin/connection.rb:84:in `pre_process'\n2017-05-17T19:04:24.639127+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/lib/thin/connection.rb:53:in `process'\n2017-05-17T19:04:24.639127+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/lib/thin/connection.rb:39:in `receive_data'\n2017-05-17T19:04:24.639129+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/eventmachine-1.2.3/lib/eventmachine.rb:194:in `run_machine'\n2017-05-17T19:04:24.639130+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/eventmachine-1.2.3/lib/eventmachine.rb:194:in `run'\n2017-05-17T19:04:24.639130+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/lib/thin/backends/base.rb:73:in `start'\n2017-05-17T19:04:24.639131+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/lib/thin/server.rb:162:in `start'\n2017-05-17T19:04:24.639132+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/lib/thin/controllers/controller.rb:87:in `start'\n2017-05-17T19:04:24.639133+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/lib/thin/runner.rb:200:in `run_command'\n2017-05-17T19:04:24.639133+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/lib/thin/runner.rb:156:in `run!'\n2017-05-17T19:04:24.639134+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/thin-1.7.0/bin/thin:6:in `&lt;top (required)&gt;'\n2017-05-17T19:04:24.639135+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/bin/thin:22:in `load'\n2017-05-17T19:04:24.639137+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/cli/exec.rb:74:in `load'\n2017-05-17T19:04:24.639136+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/bin/thin:22:in `&lt;top (required)&gt;'\n2017-05-17T19:04:24.639138+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/cli/exec.rb:74:in `kernel_load'\n2017-05-17T19:04:24.639139+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/cli.rb:332:in `exec'\n2017-05-17T19:04:24.639140+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'\n2017-05-17T19:04:24.639138+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/cli/exec.rb:27:in `run'\n2017-05-17T19:04:24.639140+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'\n2017-05-17T19:04:24.639141+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/vendor/thor/lib/thor.rb:359:in `dispatch'\n2017-05-17T19:04:24.639142+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/cli.rb:20:in `dispatch'\n2017-05-17T19:04:24.639143+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/vendor/thor/lib/thor/base.rb:440:in `start'\n2017-05-17T19:04:24.639144+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/cli.rb:11:in `start'\n2017-05-17T19:04:24.639144+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/exe/bundle:34:in `block in &lt;top (required)&gt;'\n2017-05-17T19:04:24.639145+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/lib/bundler/friendly_errors.rb:100:in `with_friendly_errors'\n2017-05-17T19:04:24.639146+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.13.7/exe/bundle:26:in `&lt;top (required)&gt;'\n2017-05-17T19:04:24.639146+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/bin/bundle:22:in `load'\n2017-05-17T19:04:24.639147+00:00 app[web.1]:    /app/vendor/bundle/ruby/2.4.0/bin/bundle:22:in `&lt;main&gt;'\n2017-05-17T19:04:24.639551+00:00 app[web.1]: 216.73.77.194 - - [17/May/2017:19:04:24 +0000] \"POST /sms/send HTTP/1.1\" 500 30 0.0217\n</code></pre>\n\n<p>I'm kind of lost. I apologize for the vagueness. Where should I start? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord", "postgresql-9.1"], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 2644111, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9ndPn.jpg?s=128&g=1", "display_name": "Aitizazk", "link": "https://stackoverflow.com/users/2644111/aitizazk"}, "edited": false, "score": 0, "creation_date": 1495050811, "post_id": 44033106, "comment_id": 75093897, "body": "actually i have simplified the model and excluded other columns and relations for this question. both the models belong to a user and i tried some like <code>user.joins(:trips, :spendings)</code> but it returns incorrect values"}], "tags": [], "owner": {"reputation": 688, "user_id": 1477502, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sdapX.jpg?s=128&g=1", "display_name": "dps", "link": "https://stackoverflow.com/users/1477502/dps"}, "is_accepted": false, "score": 0, "last_activity_date": 1495050297, "last_edit_date": 1495050297, "creation_date": 1495048675, "answer_id": 44033106, "question_id": 44032913, "link": "https://stackoverflow.com/questions/44032913/active-record-getting-results-from-two-tables-with-no-associaion/44033106#44033106", "title": "Active record getting results from two tables with no associaion", "body": "<p>Your data is denormalized, can you do something like this?  It might be easier to work with this way.</p>\n\n<pre><code>class Area &lt; ApplicationRecord\n  has_many :spending\n  has_many :trip \nend\n\nclass Spending &lt; ApplicationRecord\n  belongs_to :area\nend\n\nclass Trip &lt; ApplicationRecord\n  belongs_to :area\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 302, "user_id": 2644111, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9ndPn.jpg?s=128&g=1", "display_name": "Aitizazk", "link": "https://stackoverflow.com/users/2644111/aitizazk"}, "edited": false, "score": 0, "creation_date": 1495053084, "post_id": 44034195, "comment_id": 75095187, "body": "As i said in the previous comment i have simplified the model and excluded other columns and relations for this question. both the models belong to a user and i tried some like user.joins(:trips, :spendings) but it returns incorrect values"}, {"owner": {"reputation": 688, "user_id": 1477502, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sdapX.jpg?s=128&g=1", "display_name": "dps", "link": "https://stackoverflow.com/users/1477502/dps"}, "reply_to_user": {"reputation": 302, "user_id": 2644111, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9ndPn.jpg?s=128&g=1", "display_name": "Aitizazk", "link": "https://stackoverflow.com/users/2644111/aitizazk"}, "edited": false, "score": 0, "creation_date": 1495054233, "post_id": 44034195, "comment_id": 75095761, "body": "@Aitizazk did you see the chained .includes on the <code>Group By Query?</code> in this answer?  I didn&#39;t test it but it looks to me like this is type of logic you are looking for. p.s. this is a good answer @Anand Soni"}, {"owner": {"reputation": 302, "user_id": 2644111, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9ndPn.jpg?s=128&g=1", "display_name": "Aitizazk", "link": "https://stackoverflow.com/users/2644111/aitizazk"}, "edited": false, "score": 0, "creation_date": 1495055298, "post_id": 44034195, "comment_id": 75096249, "body": "As i said it is based on the idea that i create a seperate model for <code>Area</code> which is not possible in my situation"}, {"owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "reply_to_user": {"reputation": 302, "user_id": 2644111, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9ndPn.jpg?s=128&g=1", "display_name": "Aitizazk", "link": "https://stackoverflow.com/users/2644111/aitizazk"}, "edited": false, "score": 0, "creation_date": 1495114076, "post_id": 44034195, "comment_id": 75123455, "body": "@Aitizazk, you need to just replace Area with user. I have updated my answer."}], "tags": [], "owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "is_accepted": false, "score": 0, "last_activity_date": 1495114143, "last_edit_date": 1495114143, "creation_date": 1495052897, "answer_id": 44034195, "question_id": 44032913, "link": "https://stackoverflow.com/questions/44032913/active-record-getting-results-from-two-tables-with-no-associaion/44034195#44034195", "title": "Active record getting results from two tables with no associaion", "body": "<p>I agree with @dps's answer but I like to add more in that. Here is the code I tried :</p>\n\n<p><strong>Model definition :</strong></p>\n\n<pre><code>class Area &lt; ApplicationRecord\n  has_many :spendings  \n  has_many :trips\nend\n\nclass Trip &lt; ApplicationRecord\nend\n\nclass Spending &lt; ApplicationRecord\nend\n</code></pre>\n\n<p><strong>Sample data</strong></p>\n\n<pre><code>a1 = Area.create(name: \"CA\")\na2 = Area.create(name: \"AK\")\n\nu1 = User.first\n\nSpending.create(area_id: a1.id, amount: 100, user_id: u1.id)\nSpending.create(area_id: a1.id, amount: 300, user_id: 2)\n\nSpending.create(area_id: a2.id, amount: 200, user_id: u1.id)\nSpending.create(area_id: a2.id, amount: 500, user_id: 2)\n\n\nTrip.create(area_id: a1.id, distance: 10, user_id: u1.id)\nTrip.create(area_id: a1.id, distance: 90, user_id: 2)\n\nTrip.create(area_id: a2.id, distance: 20, user_id: u1.id)\nTrip.create(area_id: a2.id, distance: 70, user_id: 2)\n</code></pre>\n\n<p><strong>Group By Query :</strong> </p>\n\n<pre><code>Area.includes(:trips).includes(:spendings).group_by{|a| [a.name,a.trips.sum(:distance),a.spendings.sum(:amount) ] }\n</code></pre>\n\n<p>If you want separate group by answer then you can try this : </p>\n\n<pre><code>Area.includes(:trips).group(:name).sum(:distance)\nArea.includes(:spendings).group(:name).sum(:amount)\n</code></pre>\n\n<p><strong>UPDATE :</strong>\nAs per requirement, you can replace <code>Area</code> model with <code>User</code>. Here it will look like :</p>\n\n<pre><code>User.includes(:trips).includes(:spendings).group_by{|a| [a.id,a.trips.group(:area_id).sum(:distance),a.spendings.group(:area_id).sum(:amount) ] }\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 302, "user_id": 2644111, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9ndPn.jpg?s=128&g=1", "display_name": "Aitizazk", "link": "https://stackoverflow.com/users/2644111/aitizazk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495114143, "creation_date": 1495047840, "last_edit_date": 1495053141, "question_id": 44032913, "link": "https://stackoverflow.com/questions/44032913/active-record-getting-results-from-two-tables-with-no-associaion", "title": "Active record getting results from two tables with no associaion", "body": "<p>I have two models <code>Trip</code> and <code>Spending</code>, they have no association but they both have <code>user_id</code>.</p>\n\n<ul>\n<li><p>columns on <code>Trip</code> => <code>id</code>, <code>area</code>, <code>user_id</code>, <code>distance</code></p></li>\n<li><p>columns on <code>Spending</code> => <code>id</code>, <code>area</code>, <code>user_id</code>, <code>amount</code></p></li>\n</ul>\n\n<p>Example data in <code>Trip</code>:</p>\n\n<pre><code>id   area   user_id   distance\n1    'CA'     2         10\n1    'AK'     3         20\n1    'CA'     4         30\n1    'AK'     2         10\n</code></pre>\n\n<p>Example data in <code>Spending</code>:</p>\n\n<pre><code>id   area   user_id   Amount\n1    'AK'     2         100\n1    'AK'     3         30\n1    'CA'     4         60\n1    'AK'     2         70\n</code></pre>\n\n<p>I am unable to figure out a way to get the following types of output:</p>\n\n<p>1) <code>sum</code> of <code>amount</code> and <code>distance</code> in an <code>area</code>, e.g.:</p>\n\n<pre><code>area amount distance\nAK    200     30\nCA     60     40\n</code></pre>\n\n<p>2) <code>sum</code> of <code>amount</code> and <code>distance</code> of a <code>user</code> by <code>area</code>, e.g. for <code>user_id = 2</code>:</p>\n\n<pre><code>area amount distance\nAK    170     10\nCA     0      10\n</code></pre>\n\n<p>I can get records from <code>Trip</code> and <code>Spending</code> separately and manipulate in ruby, but that doesn't look very clean to me. I have tried using <code>joins</code> but records are duplicating.</p>\n\n<p>Any help in constructing an <code>ActiveRecord</code> query will be highly appreciated. Thanks. </p>\n\n<p>NOTE:\nI have simplified the model and excluded other columns and relations for this question. so I don't have the option of creating another model for area in my project.</p>\n"}, {"tags": ["ruby", "email", "jruby", "monkeypatching"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1495047501, "post_id": 44032718, "comment_id": 75092051, "body": "The error is telling you that  <code>Mail::SMTP</code> does not have a method called <code>ssl_context</code>. This method is an instance method not a class method."}, {"owner": {"reputation": 4717, "user_id": 1913389, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QKwb2.png?s=128&g=1", "display_name": "theGreenCabbage", "link": "https://stackoverflow.com/users/1913389/thegreencabbage"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1495047545, "post_id": 44032718, "comment_id": 75092080, "body": "It looks like instead of using <code>remove_method</code>, I simply redefine the method (and adding a <code>private</code> on top of the class method), like this: <a href=\"http://stackoverflow.com/questions/33592221/override-a-private-method-in-the-lib-folder-of-a-gem\" title=\"override a private method in the lib folder of a gem\">stackoverflow.com/questions/33592221/&hellip;</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1495047767, "post_id": 44032718, "comment_id": 75092231, "body": "This is not a class method that being said your patch should be fine without the first block <code>class &lt;&lt; Mail::SMTP;...</code> and yes if you want it to be private make it private. Also might be easier to alias the method and make a call to the alias when you want the original functionality."}, {"owner": {"reputation": 4717, "user_id": 1913389, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QKwb2.png?s=128&g=1", "display_name": "theGreenCabbage", "link": "https://stackoverflow.com/users/1913389/thegreencabbage"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1495047800, "post_id": 44032718, "comment_id": 75092242, "body": "@engineersmnky Would you mind writing this as an answer? &quot;Also might be easier to alias the method and make a call to the alias when you want the original functionality.&quot;"}], "owner": {"reputation": 4717, "user_id": 1913389, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QKwb2.png?s=128&g=1", "display_name": "theGreenCabbage", "link": "https://stackoverflow.com/users/1913389/thegreencabbage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495047082, "creation_date": 1495047082, "question_id": 44032718, "link": "https://stackoverflow.com/questions/44032718/monkey-patching-a-class-method-in-ruby-mail-module", "title": "Monkey Patching a Class Method in Ruby Mail Module", "body": "<p>I am currently working on a monkey patch in the JRuby Mail-2.6.0 module. Specifically, I want to patch the <code>ssl_context</code> class method. If it helps, this is the full path to the <a href=\"https://github.com/mikel/mail/blob/master/lib/mail/network/delivery_methods/smtp.rb#L135\" rel=\"nofollow noreferrer\">module</a>.</p>\n\n<p>An issue I am having with the monkey patch is that since I am looking to replace a class method, I am not quite sure what method to use to replace <code>ssl_context</code>.</p>\n\n<p>This is what I have for the monkey patch:</p>\n\n<pre><code>require 'mail/check_delivery_params'\n\nclass &lt;&lt; Mail::SMTP\n  remove_method :ssl_context\nend\n\nmodule Mail\n  class SMTP\n        # Allow SSL context to be configured via settings, for Ruby &gt;= 1.9\n    # Just returns openssl verify mode for Ruby 1.8.x\n    def ssl_context\n      openssl_verify_mode = settings[:openssl_verify_mode]\n\n      if openssl_verify_mode.kind_of?(String)\n        openssl_verify_mode = \"OpenSSL::SSL::VERIFY_#{openssl_verify_mode.upcase}\".constantize\n      end\n\n      # context = Net::SMTP.default_ssl_context\n      context = OpenSSL::SSL::SSLContext.new(settings[:ssl_version])\n      context.verify_mode = openssl_verify_mode\n      context.ca_path = settings[:ca_path] if settings[:ca_path]\n      context.ca_file = settings[:ca_file] if settings[:ca_file]\n      context\n    end\n  end\nend\n</code></pre>\n\n<p>I am basically just trying to change:</p>\n\n<pre><code>context = Net::SMTP.default_ssl_context\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>context = OpenSSL::SSL::SSLContext.new(settings[:ssl_version])\n</code></pre>\n\n<p>I've tried <code>undef_method</code>, <code>remove_class_variable</code>, and <code>remove_method</code>, but kept getting the following type of error:</p>\n\n<pre><code>2017-05-17 11:44:03.423 -0700 [ERROR|007d0|main] :: Error starting Application: Undefined method ssl_context for 'Mail::SMTP'\n  org/jruby/RubyModule.java:2826:in `undef_method'\n  /Users/App/Code/yourtool/lib/helltool/mailer.rb:328:in `singleton class'\n  /Users/App/Code/yourtool//lib/helltool/mailer.rb:327:in `&lt;main&gt;'\n  org/jruby/RubyKernel.java:961:in `require'\n</code></pre>\n\n<p>Curious what I can do to make this work?</p>\n"}, {"tags": ["html", "ruby", "css-selectors", "nokogiri", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1495139783, "post_id": 44032605, "comment_id": 75139680, "body": "Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. When asking a question like this we need you to supply the minimum input (HTML) that demonstrates the problem. Without that you force us to invent the input just to help you, which wastes our time and possibly introduces wobble in our answers. Don&#39;t do that, instead, help us help you."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1495140043, "post_id": 44035293, "comment_id": 75139803, "body": "<code>map(&amp;:text)</code> is more concise."}], "tags": [], "owner": {"reputation": 3590, "user_id": 1494245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50a2dcc33b58918f27664b7646d92b7?s=128&d=identicon&r=PG", "display_name": "Sean Huber", "link": "https://stackoverflow.com/users/1494245/sean-huber"}, "is_accepted": true, "score": 0, "last_activity_date": 1495057682, "creation_date": 1495057682, "answer_id": 44035293, "question_id": 44032605, "link": "https://stackoverflow.com/questions/44032605/how-do-i-select-either-a-th-or-a-td-from-a-table-row/44035293#44035293", "title": "How do I select either a th or a td from a table row?", "body": "<p>Use a <code>,</code> (comma) to select multiple nodes:</p>\n\n<pre><code>row_values = row.css('td, th').map{|str| str.text }\n</code></pre>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 44035293, "answer_count": 1, "score": -1, "last_activity_date": 1495139687, "creation_date": 1495046627, "last_edit_date": 1495139687, "question_id": 44032605, "link": "https://stackoverflow.com/questions/44032605/how-do-i-select-either-a-th-or-a-td-from-a-table-row", "title": "How do I select either a th or a td from a table row?", "body": "<p>I'm using Nokogiri with Rails 5.  How do I select either a \"th\" element or a \"td\" element from a table row?  My goal is to get all the text of cells in a row (if there is a more generic, elegant solution, I'm all in).  Here's what I have</p>\n\n<pre><code>      text_all_rows = all_rows.map do |row|\n        row_values = row.css('td | th').map{|str| str.text }\n                                  .map{|str| str.gsub(/[[:space:]]+/, ' ').gsub(/\\A\\p{Space}+|\\p{Space}+\\z/, '') }.join(\"\\t\")\n        [*row_values]\n      end\n</code></pre>\n\n<p>As you may have noticed \"td | th\" is not valid syntax for selecting the \"th\" or \"td\" elements from the row.</p>\n"}, {"tags": ["ruby", "ssh", "vagrant", "vagrantfile"], "answers": [{"comments": [{"owner": {"reputation": 1567, "user_id": 810706, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7e50c2321b7235c53a46fee37497a98f?s=128&d=identicon&r=PG", "display_name": "Tyson", "link": "https://stackoverflow.com/users/810706/tyson"}, "edited": false, "score": 0, "creation_date": 1495051829, "post_id": 44032653, "comment_id": 75094559, "body": "Thanks! Worked after upgrading. Can you help me understand the issue and why the combination of provider config + ssh forwarding was causing it to show up (since removing either got rid of the problem) prior to upgrading?"}], "tags": [], "owner": {"reputation": 1425, "user_id": 2588830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0b82b9b2a8aee14cc91f05c460992b?s=128&d=identicon&r=PG", "display_name": "tux", "link": "https://stackoverflow.com/users/2588830/tux"}, "is_accepted": true, "score": 1, "last_activity_date": 1495046835, "creation_date": 1495046835, "answer_id": 44032653, "question_id": 44032280, "link": "https://stackoverflow.com/questions/44032280/vagrant-ssh-agent-forwarding-provider-config-error/44032653#44032653", "title": "Vagrant SSH Agent Forwarding + Provider Config = Error?", "body": "<p>I can see that you are using vagrant 1.9.4 and this is a known issue with vagrant 1.9.4. I am linking here the <a href=\"https://github.com/mitchellh/vagrant/issues/8520\" rel=\"nofollow noreferrer\">github issue</a> associated with this problem. This has been fixed in version 1.9.5 though. So, you could either downgrade to 1.9.3 or upgrade to 1.9.5</p>\n"}], "owner": {"reputation": 1567, "user_id": 810706, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7e50c2321b7235c53a46fee37497a98f?s=128&d=identicon&r=PG", "display_name": "Tyson", "link": "https://stackoverflow.com/users/810706/tyson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 44032653, "answer_count": 1, "score": 0, "last_activity_date": 1495046835, "creation_date": 1495045544, "question_id": 44032280, "link": "https://stackoverflow.com/questions/44032280/vagrant-ssh-agent-forwarding-provider-config-error", "title": "Vagrant SSH Agent Forwarding + Provider Config = Error?", "body": "<p>Relative Vagrant and Ruby newb here. I'm trying to enable SSH forwarding from my Windows machine to my Vagrant created Ubuntu VM. My Vagrantfile has some Virtualbox provider specific config:</p>\n\n<pre><code>  config.vm.provider \"virtualbox\" do |v|\n    v.name = guestHostname\n    v.memory = 8192\n    v.cpus = 2\n    v.customize [\"modifyvm\", :id, \"--vram\", \"128\"]\n    v.gui = true\n  end\n</code></pre>\n\n<p>Works fine by itself. But when I add the config for SSH forwarding:</p>\n\n<pre><code>  config.ssh.forward_agent = true\n</code></pre>\n\n<p>Running 'vagrant up' starts failing with this error message:</p>\n\n<pre><code>Bringing machine 'development' up with 'virtualbox' provider...\n==&gt; development: Importing base box 'bento/ubuntu-16.10'...\n==&gt; development: Matching MAC address for NAT networking...\n==&gt; development: Checking if box 'bento/ubuntu-16.10' is up to date...\n==&gt; development: Setting the name of the VM: development\n==&gt; development: Clearing any previously set network interfaces...\n==&gt; development: Preparing network interfaces based on configuration...\n    development: Adapter 1: nat\n==&gt; development: Forwarding ports...\n    development: 22 (guest) =&gt; 2222 (host) (adapter 1)\n==&gt; development: Running 'pre-boot' VM customizations...\n==&gt; development: Booting VM...\n==&gt; development: Waiting for machine to boot. This may take a few minutes...\n    development: SSH address: 127.0.0.1:2222\n    development: SSH username: vagrant\n    development: SSH auth method: private key\n==&gt; development: Forcing shutdown of VM...\n==&gt; development: Destroying VM and associated drives...\nC:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh/transport/server_version.rb:54:in `readpartial': An established connection was aborted by the software in your host machine. (Errno::ECONNABORTED)\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh/transport/server_version.rb:54:in `block (2 levels) in negotiate!'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh/transport/server_version.rb:52:in `loop'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh/transport/server_version.rb:52:in `block in negotiate!'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh/transport/server_version.rb:50:in `loop'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh/transport/server_version.rb:50:in `negotiate!'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh/transport/server_version.rb:32:in `initialize'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh/transport/session.rb:84:in `new'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh/transport/session.rb:84:in `initialize'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh.rb:233:in `new'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/net-ssh-4.1.0/lib/net/ssh.rb:233:in `start'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/vagrant-1.9.4/plugins/communicators/ssh/communicator.rb:397:in `block (2 levels) in connect'\n        from C:/HashiCorp/Vagrant/embedded/lib/ruby/2.2.0/timeout.rb:88:in `block in timeout'\n        from C:/HashiCorp/Vagrant/embedded/lib/ruby/2.2.0/timeout.rb:32:in `block in catch'\n        from C:/HashiCorp/Vagrant/embedded/lib/ruby/2.2.0/timeout.rb:32:in `catch'\n        from C:/HashiCorp/Vagrant/embedded/lib/ruby/2.2.0/timeout.rb:32:in `catch'\n        from C:/HashiCorp/Vagrant/embedded/lib/ruby/2.2.0/timeout.rb:103:in `timeout'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/vagrant-1.9.4/plugins/communicators/ssh/communicator.rb:371:in `block in connect'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/vagrant-1.9.4/lib/vagrant/util/retryable.rb:17:in `retryable'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/vagrant-1.9.4/plugins/communicators/ssh/communicator.rb:370:in `connect'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/vagrant-1.9.4/plugins/communicators/ssh/communicator.rb:68:in `block in wait_for_ready'\n        from C:/HashiCorp/Vagrant/embedded/lib/ruby/2.2.0/timeout.rb:88:in `block in timeout'\n        from C:/HashiCorp/Vagrant/embedded/lib/ruby/2.2.0/timeout.rb:32:in `block in catch'\n        from C:/HashiCorp/Vagrant/embedded/lib/ruby/2.2.0/timeout.rb:32:in `catch'\n        from C:/HashiCorp/Vagrant/embedded/lib/ruby/2.2.0/timeout.rb:32:in `catch'\n        from C:/HashiCorp/Vagrant/embedded/lib/ruby/2.2.0/timeout.rb:103:in `timeout'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/vagrant-1.9.4/plugins/communicators/ssh/communicator.rb:46:in `wait_for_ready'\n        from C:/HashiCorp/Vagrant/embedded/gems/gems/vagrant-1.9.4/lib/vagrant/action/builtin/wait_for_communicator.rb:16:in `block in call'\n</code></pre>\n\n<p>Commenting out the provider specific config makes the error go away, and forwarding appears to work. Any ideas on what could be causing the issue?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "json", "ruby", "file-upload"], "comments": [{"owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "edited": false, "score": 0, "creation_date": 1495936284, "post_id": 44032277, "comment_id": 75456677, "body": "What fails when you upload the file using tus and submit a callback to your endpoint with the JSON uploaded file representation?"}, {"owner": {"reputation": 49, "user_id": 3180195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1afbb7d48d0789d7e652ed8a60b39fb?s=128&d=identicon&r=PG", "display_name": "Jacob Prud&#39;homme", "link": "https://stackoverflow.com/users/3180195/jacob-prudhomme"}, "reply_to_user": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "edited": false, "score": 0, "creation_date": 1496063864, "post_id": 44032277, "comment_id": 75495879, "body": "@janko-m it has something to do with the form in which the data is POSTed. When I upload directly via my API&#39;s endpoint, the file data is wrapped in some sort of hash format (ActiveRecord&#39;s hashed file upload, I do believe) but when I upload using <code>tus</code>, it sends it as pure JSON instead, which  then gives me problems when I try to take the JSON and send it to my API endpoint to have a database record of the files uploaded via <code>tus</code>. Is there anyway to wrap this JSON in ActiveRecord&#39;s file hash?"}, {"owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "edited": false, "score": 0, "creation_date": 1496077856, "post_id": 44032277, "comment_id": 75503483, "body": "I assume you mean multipart upload versus direct upload. With the former you upload the file to the same endpoint where you handle the upload, where with the latter you upload the file separately, and then submit just the uploaded file data to your endpoint (Shrine uses the JSON format for that). That&#39;s the fundamental difference which is the whole advantage of direct asynchronous uploads, you want to treat those two cases differently. Shrine&#39;s attachment attribute accepts these JSON strings (in addition to regular files), which you can utilize with <code>Shrine::Attachment</code> or <code>Shrine::Attacher</code>."}, {"owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "edited": false, "score": 0, "creation_date": 1496077956, "post_id": 44032277, "comment_id": 75503523, "body": "I would suggest using the Shrine mailing list for these kind of questions, as StackOverflow comments are a bit limiting. <a href=\"https://groups.google.com/forum/#!forum/ruby-shrine\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!forum/ruby-shrine</a>"}], "owner": {"reputation": 49, "user_id": 3180195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1afbb7d48d0789d7e652ed8a60b39fb?s=128&d=identicon&r=PG", "display_name": "Jacob Prud&#39;homme", "link": "https://stackoverflow.com/users/3180195/jacob-prudhomme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495045523, "creation_date": 1495045523, "question_id": 44032277, "link": "https://stackoverflow.com/questions/44032277/allow-tus-ruby-server-to-save-file-records-to-database", "title": "Allow tus-ruby-server to save file records to database", "body": "<p>As of now, I have a file upload API using Shrine to handle file attachments and I have added <code>tus-ruby-server</code> to the mix to add the ability to resume uploads.</p>\n\n<p>I have followed the steps <a href=\"https://github.com/janko-m/shrine-tus-demo\" rel=\"nofollow noreferrer\">here</a> to make it so that when a file is uploaded from <code>tus-ruby-server</code>'s endpoint, a database record is also created using Shrine's file handling.</p>\n\n<p>When I POST a file directly to my API's uploads endpoint, it sends the JSON data like so:</p>\n\n<pre><code>{\"video\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x007f811d1d5920 @tempfile=#&lt;Tempfile:/tmp/RackMultipart20170517-19364-6pfr0g.webm&gt;, @original_filename=\"video.webm\", @content_type=\"video/webm\", @headers=\"Content-Disposition: form-data; name=\\\"video\\\"; filename=\\\"video.webm\\\"\\r\\nContent-Type: video/webm\\r\\n\"&gt;, \"id\"=&gt;\"35\"}\n</code></pre>\n\n<p>When I upload a file using <code>tus</code> and then POST that generated file data to my API, it sends the following JSON (which fails):</p>\n\n<pre><code>{\"video\"=&gt;\"{\\\"id\\\":\\\"http://localhost:3000/files/8794bf67f32d01cabb9416ca9febf3c3\\\",\\\"storage\\\":\\\"cache\\\",\\\"metadata\\\":{\\\"filename\\\":\\\"video.webm\\\",\\\"size\\\":142288,\\\"mime_type\\\":\\\"\\\"}}\", \"id\"=&gt;\"35\"}\n</code></pre>\n\n<p>Is there any indication of what is going wrong here?</p>\n\n<hr>\n\n<p>Here's the JavaScript that handles the uploading (using <code>tus-js-client</code>):</p>\n\n<pre><code>var upload = new tus.Upload(file, {\n        chunkSize: 1024 * 1024,\n        endpoint: 'http://localhost:3000/files',\n        metadata: {filename: file.name, content_type: file.type},\n        onError: function(error) {\n            alert(error);\n        },\n        onProgress: function(bytesSent, bytesTotal) {\n            var progress = parseInt(bytesSent / bytesTotal * 100, 10);\n            var percentage = progress.toString() + '%';\n            console.log(percentage + ' finished');\n        },\n        onSuccess: function(result) {\n            var fileData = {\n                id: upload.url,\n                storage: 'cache',\n                metadata: {\n                    filename: upload.file.name.match(/[^\\/\\\\]+$/)[0],\n                    size: upload.file.size,\n                    mime_type: upload.file.type\n                }\n            };\n\n            var fileDataJSON = JSON.stringify(fileData);\n\n            var formData = new FormData();\n            formData.append('video', fileDataJSON);\n            makeXMLHttpRequest('http://localhost:3000/api/uploads/' + gon.currentId, 'PUT', formData);\n        }\n    });\n\n    console.log('Uploading video recording to server...');\n    upload.start();\n</code></pre>\n\n<p>The JavaScript I used before to handle uploading <em>without</em> <code>tus</code>:</p>\n\n<pre><code>var formData = new FormData();\nformData.append('video', blob, 'video.webm');\n\nmakeXMLHttpRequest('http://localhost:3000/api/uploads/' + gon.currentId, 'PUT', formData);\n</code></pre>\n"}, {"tags": ["ruby", "postgresql", "sequel"], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1495049173, "post_id": 44031676, "comment_id": 75092963, "body": "By default Sequel will select <code>*</code> so <code>.select(Sequel.lit(&#39;*&#39;))</code> is redundant. Try <code>Account.dataset.sql</code> and look at the output.  In general the query looks very awkward. I&#39;d recommend asking on the Sequel IRC channel."}], "tags": [], "owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "is_accepted": false, "score": 1, "last_activity_date": 1495834311, "last_edit_date": 1495834311, "creation_date": 1495043223, "answer_id": 44031676, "question_id": 44031579, "link": "https://stackoverflow.com/questions/44031579/how-to-convert-value-hashes-from-a-stored-procedure-into-an-array-of-sequel-mode/44031676#44031676", "title": "How to convert value hashes from a stored procedure into an array of Sequel model instances or dataset", "body": "<p>Sometimes writing a question gives you an answer:</p>\n\n<pre><code>Account.from{ |o| Sequel.function(:get_ancestry, DB.row_type(:accounts, @accounts['A/1/1'].values)) }.all\n</code></pre>\n\n<p>works.</p>\n\n<hr>\n\n<p>Actually, this works really, really, really nice, because it behaves like any dataset would, you can join it, \"where\" it, sort it etc and everything behaves really really nicely.</p>\n\n<pre><code>  DB.register_row_type(:accounts)\n\n  def ancestry_dataset\n    Account.from do |o|\n      Sequel.function(:get_ancestry, DB.row_type(:accounts, values))\n    end\n  end\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>def test_me\n  acc = @accounts['A/1/1']\n  pd = acc.ancestry_dataset\n\n  assert pd.is_a?(Sequel::Postgres::Dataset), 'expected a postgres dataset'\n\n  assert_equal 2, pd.count, 'count returned funny'\n  assert_equal 2, pd.all.count, 'all.count returned funny'\n\n  assert_equal 1, pd.where(parent_id: nil).count, 'where(...).count returned funny'\n  assert_equal 1, pd.where(parent_id: nil).all.count, 'where(...).all.count returned funny'\n\n  assert_equal [:id], pd.select(:id).first.keys, 'when I restrict the select statement columns, the keys are funny'\nend\n</code></pre>\n\n<p>It works nicely without hickups and is a great powertool for handling hierarchical data.</p>\n\n<p>For future reference, the <code>get_ancestry</code> function is:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION get_ancestry(_acct Accounts)\n  RETURNS SETOF Accounts AS $$\n\nDECLARE\n  cur_acct Accounts%ROWTYPE;\n\nBEGIN\n  -- we start from the parent of _acct\n  SELECT INTO cur_acct *\n  FROM Accounts\n  WHERE id = _acct.parent_id;\n\n  WHILE (cur_acct.id IS NOT NULL) LOOP\n    RAISE NOTICE 'get_ancestry: returning %', cur_acct.id;\n    RETURN NEXT cur_acct;\n\n    SELECT INTO cur_acct *\n    FROM Accounts\n    WHERE id = cur_acct.parent_id;\n  END LOOP;\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "edited": false, "score": 0, "creation_date": 1495095332, "post_id": 44033169, "comment_id": 75110245, "body": "Indeed, but if I just delete the ID when I instantiate, then Sequel will think I have a new record when I use the resulting Sequel::Model object. I had to find a way so that Sequel understands that we&#39;re dealing with something that already exists, so it can be joined, updated, etc and generally managed without any special handling."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1495048939, "creation_date": 1495048939, "answer_id": 44033169, "question_id": 44031579, "link": "https://stackoverflow.com/questions/44031579/how-to-convert-value-hashes-from-a-stored-procedure-into-an-array-of-sequel-mode/44033169#44033169", "title": "How to convert value hashes from a stored procedure into an array of Sequel model instances or dataset", "body": "<p>\"id is a restricted primary key\" is because you're passing in the <code>:id</code> of the record. </p>\n\n<p>Delete <code>:id</code> from the value before trying to instantiate a new Account. </p>\n\n<pre><code>.select(Sequel.lit('*'))\n</code></pre>\n\n<p>shouldn't be necessary. Sequel automatically selects <code>*</code>:</p>\n\n<pre><code>require 'json'\nrequire 'sequel'\n\nDB = Sequel.sqlite\nDB.create_table :items do\n  primary_key :id\n  String :name\n  Float :price\nend\nitems = DB[:items]\nitems.insert(:name =&gt; 'abc', :price =&gt; rand * 100)\n\nclass Item &lt; Sequel::Model(:items)\nend\n\nItem.dataset.sql\n# =&gt; \"SELECT * FROM `items`\"\n</code></pre>\n"}], "owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495834487, "creation_date": 1495042858, "last_edit_date": 1495834487, "question_id": 44031579, "link": "https://stackoverflow.com/questions/44031579/how-to-convert-value-hashes-from-a-stored-procedure-into-an-array-of-sequel-mode", "title": "How to convert value hashes from a stored procedure into an array of Sequel model instances or dataset", "body": "<p>A stored procedure returns an array of rows (<code>SETOF</code>) from a table called <code>ACCOUNTS</code> with its associated Sequel model <code>Account</code>:</p>\n\n<pre><code>[1] pry(#&lt;Psql::CalculateMasterBalancesTest&gt;)&gt; DB.select(Sequel.lit('*')).from{ |o| Sequel.function(:get_master_accounts, DB.row_type(:accounts, @accounts['A/1/1'].values)) }.all\n=&gt; [{:id=&gt;1651, :parent_id=&gt;1649, :ban=&gt;nil, :risk=&gt;nil, :custom_attributes=&gt;nil, :created_at=&gt;2017-05-17 19:33:09 +0200, :updated_at=&gt;2017-05-17 19:33:09 +0200},\n {:id=&gt;1649, :parent_id=&gt;1647, :ban=&gt;nil, :risk=&gt;nil, :custom_attributes=&gt;nil, :created_at=&gt;2017-05-17 19:33:09 +0200, :updated_at=&gt;2017-05-17 19:33:09 +0200},\n {:id=&gt;1647, :parent_id=&gt;nil, :ban=&gt;\"A Master\", :risk=&gt;nil, :custom_attributes=&gt;nil, :created_at=&gt;2017-05-17 19:33:09 +0200, :updated_at=&gt;2017-05-17 19:33:09 +0200}]\n</code></pre>\n\n<p>To make this play nice with the rest of the application I would like to instantiate this array of value hashes into an array of <code>Account</code> model instances.</p>\n\n<p>If I just add <code>.map{|hash| Account.new(hash)}</code> to the end of the previous expression I get a </p>\n\n<pre><code>Sequel::MassAssignmentRestriction: id is a restricted primary key\n</code></pre>\n\n<p>error.</p>\n\n<p>If I bully through this and manually set the ID column I'm guessing there's good chances that something will bite me somewhere (in some weird edge case if possible) due to <code>persisted?</code> logic somewhere in Sequel (I'm just guessing, this is what happens with ActiveRecord and it seems a common design issue),</p>\n\n<p>Is there an idiomatic way of handling this in Sequel?</p>\n"}, {"tags": ["ruby", "neo4j", "cypher", "neography"], "comments": [{"owner": {"reputation": 57206, "user_id": 974731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=128&d=identicon&r=PG", "display_name": "cybersam", "link": "https://stackoverflow.com/users/974731/cybersam"}, "edited": false, "score": 0, "creation_date": 1495045121, "post_id": 44031364, "comment_id": 75090875, "body": "Does <code>{relationship}</code> contain a single property or multiple properties?"}, {"owner": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "reply_to_user": {"reputation": 57206, "user_id": 974731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=128&d=identicon&r=PG", "display_name": "cybersam", "link": "https://stackoverflow.com/users/974731/cybersam"}, "edited": false, "score": 0, "creation_date": 1495048435, "post_id": 44031364, "comment_id": 75092556, "body": "single property"}], "answers": [{"tags": [], "owner": {"reputation": 57206, "user_id": 974731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=128&d=identicon&r=PG", "display_name": "cybersam", "link": "https://stackoverflow.com/users/974731/cybersam"}, "is_accepted": false, "score": 0, "last_activity_date": 1495050023, "creation_date": 1495050023, "answer_id": 44033480, "question_id": 44031364, "link": "https://stackoverflow.com/questions/44031364/how-to-pass-a-parameter-as-a-relationship-for-part-of-a-cypher-query-for-neo4j-u/44033480#44033480", "title": "How to pass a parameter as a relationship for part of a cypher query for neo4j using neography", "body": "<p>Since <code>{relationship}</code> is a map with only a single property, you can do one of the following. Let's say the map is <code>{x: 123}</code>.</p>\n\n<ol>\n<li><p>You can just use the property from the map in your <code>MATCH</code> pattern:</p>\n\n<pre><code>MATCH (fromNode)-[ {x: {relationship}.x} ]-&gt;(toNode)\n</code></pre></li>\n<li><p>Instead of using a map, you can just pass the value of <code>x</code> as a parameter. In this example, I assume that you have replaced <code>{relationship}</code> with <code>{x}</code>:</p>\n\n<pre><code>MATCH (fromNode)-[ {x: {x}} ]-&gt;(toNode)\n</code></pre></li>\n</ol>\n\n<p>Note: the recent versions of neo4j have deprecated the <code>{x}</code> syntax, and now prefer <code>$x</code>.</p>\n"}], "owner": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495050023, "creation_date": 1495042113, "last_edit_date": 1495049756, "question_id": 44031364, "link": "https://stackoverflow.com/questions/44031364/how-to-pass-a-parameter-as-a-relationship-for-part-of-a-cypher-query-for-neo4j-u", "title": "How to pass a parameter as a relationship for part of a cypher query for neo4j using neography", "body": "<p>I want to pass to my neography query using cypher a relationship, and have the query execute on that relationship.</p>\n\n<p>I currently get an error:</p>\n\n<pre><code>query_response = @neo.execute_query(\"MATCH   (fromNode)-[{relationship}]-&gt;(toNode) \n                                    WHERE   fromNode.bot_client_id = {bot_client_id} AND toNode.epoch_utc_i &gt; {fromTime} AND toNode.epoch_utc_i &lt; {toTime} \n\n                                    RETURN  toNode.value\n                                    LIMIT   {limit}\", \n                                    {\n                                        :fromTime =&gt; fromTime, :toTime =&gt; toTime, :bot_client_id =&gt; @bot_client_id, \n                                        :limit =&gt; limit, :relationship =&gt; relationship.to_sym\n                                    }\n                                )  \n\n\n\nNeography::SyntaxException: Parameter maps cannot be used in MATCH patterns (use a literal map instead, eg. \"{id: {param}.id}\") (line 1, column 21 (offset: 20))\n    \"MATCH   (fromNode)-[{relationship}]-&gt;(toNode) \"\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "rspec-rails", "secure-random"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1495049397, "post_id": 44031239, "comment_id": 75093083, "body": "Hint: <code>9**6</code> is 531441."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1495049009, "post_id": 44031442, "comment_id": 75092866, "body": "Why are you recommending the non-secure <code>rand</code> instead? That&#39;s really a step backwards."}, {"owner": {"reputation": 443, "user_id": 5158845, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eff4c21679d34a45c335d91940215c9?s=128&d=identicon&r=PG&f=1", "display_name": "gogofan", "link": "https://stackoverflow.com/users/5158845/gogofan"}, "edited": false, "score": 2, "creation_date": 1495056196, "post_id": 44031442, "comment_id": 75096658, "body": "Yea agreed, I wouldn&#39;t use <code>rand</code>, I would stick to <code>SecureRandom</code>"}], "tags": [], "owner": {"reputation": 1247, "user_id": 4087989, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72c9108f519b175d408da0142014d421?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Praveen", "link": "https://stackoverflow.com/users/4087989/siva-praveen"}, "is_accepted": false, "score": -1, "last_activity_date": 1495042338, "creation_date": 1495042338, "answer_id": 44031442, "question_id": 44031239, "link": "https://stackoverflow.com/questions/44031239/generating-random-number-of-length-6-with-securerandom-in-ruby/44031442#44031442", "title": "Generating random number of length 6 with SecureRandom in Ruby", "body": "<p>SecureRandom.random_number(n) gives a random value between 0 to n. You can achieve it using rand function. </p>\n\n<pre><code>2.3.1 :025 &gt; rand(10**5..10**6-1)\n=&gt; 742840\n</code></pre>\n\n<p>rand(a..b) gives a random number between a and b. Here, you always get a 6 digit random number between 10^5 and 10^6-1.</p>\n"}, {"comments": [{"owner": {"reputation": 443, "user_id": 5158845, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eff4c21679d34a45c335d91940215c9?s=128&d=identicon&r=PG&f=1", "display_name": "gogofan", "link": "https://stackoverflow.com/users/5158845/gogofan"}, "edited": false, "score": 0, "creation_date": 1495094545, "post_id": 44033290, "comment_id": 75109785, "body": "Thanks, seems like <code>(SecureRandom.random_number(9e5) + 1e5).to_i</code> is what I am looking for."}, {"owner": {"reputation": 2245, "user_id": 1552570, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/65d6baf647dcd4fc0f4c203bf497a217?s=128&d=identicon&r=PG", "display_name": "mrudult", "link": "https://stackoverflow.com/users/1552570/mrudult"}, "edited": false, "score": 0, "creation_date": 1497124017, "post_id": 44033290, "comment_id": 75950031, "body": "How to use this for generating random number of length <code>n</code>?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497137663, "post_id": 44033290, "comment_id": 75953044, "body": "Use <code>9 * 10**(n-1) </code> and <code>10**(n-1)</code> instead."}, {"owner": {"reputation": 819, "user_id": 2499227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpTc3.jpg?s=128&g=1", "display_name": "MTarantini", "link": "https://stackoverflow.com/users/2499227/mtarantini"}, "edited": false, "score": 0, "creation_date": 1560805096, "post_id": 44033290, "comment_id": 99848534, "body": "Getting an error when trying to pass <code>9e5</code> as a parameter to random_number, although <code>10**6</code> works."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 819, "user_id": 2499227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpTc3.jpg?s=128&g=1", "display_name": "MTarantini", "link": "https://stackoverflow.com/users/2499227/mtarantini"}, "edited": false, "score": 1, "creation_date": 1560874029, "post_id": 44033290, "comment_id": 99876178, "body": "@MTarantini You can always do it long_form: <code>1_000_000</code>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 9, "last_activity_date": 1495049375, "creation_date": 1495049375, "answer_id": 44033290, "question_id": 44031239, "link": "https://stackoverflow.com/questions/44031239/generating-random-number-of-length-6-with-securerandom-in-ruby/44033290#44033290", "title": "Generating random number of length 6 with SecureRandom in Ruby", "body": "<p>You can do it with math:</p>\n\n<pre><code>(SecureRandom.random_number(9e5) + 1e5).to_i\n</code></pre>\n\n<p>Then verify:</p>\n\n<pre><code>100000.times.map do\n  (SecureRandom.random_number(9e5) + 1e5).to_i\nend.map { |v| v.to_s.length }.uniq\n# =&gt; [6]\n</code></pre>\n\n<p>This produces values in the range 100000..999999:</p>\n\n<pre><code>10000000.times.map do\n  (SecureRandom.random_number(9e5) + 1e5).to_i\nend.minmax\n# =&gt; [100000, 999999]\n</code></pre>\n\n<p>If you need this in a more concise format, just roll it into a method:</p>\n\n<pre><code>def six_digit_rand\n  (SecureRandom.random_number(9e5) + 1e5).to_i\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8281, "user_id": 67834, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/qyict.png?s=128&g=1", "display_name": "Eliot Sykes", "link": "https://stackoverflow.com/users/67834/eliot-sykes"}, "is_accepted": false, "score": 2, "last_activity_date": 1560348411, "creation_date": 1560348411, "answer_id": 56564155, "question_id": 44031239, "link": "https://stackoverflow.com/questions/44031239/generating-random-number-of-length-6-with-securerandom-in-ruby/56564155#56564155", "title": "Generating random number of length 6 with SecureRandom in Ruby", "body": "<p>To generate a random, 6-digit string:</p>\n\n<pre><code># This generates a 6-digit string, where the\n# minimum possible value is \"000000\", and the\n# maximum possible value is \"999999\"\nSecureRandom.random_number(10**6).to_s.rjust(6, '0')\n</code></pre>\n\n<hr>\n\n<p>Here's more detail of what's happening, shown by breaking the single line into multiple lines with explaining variables:</p>\n\n<pre><code>  # Calculate the upper bound for the random number generator\n  # upper_bound = 1,000,000\n  upper_bound = 10**6\n\n  # n will be an integer with a minimum possible value of 0,\n  # and a maximum possible value of 999,999\n  n = SecureRandom.random_number(upper_bound)\n\n  # Convert the integer n to a string\n  # unpadded_str will be \"0\" if n == 0\n  # unpadded_str will be \"999999\" if n == 999999\n  unpadded_str = n.to_s\n\n  # Pad the string with leading zeroes if it is less than\n  # 6 digits long.\n  # \"0\" would be padded to \"000000\"\n  # \"123\" would be padded to \"000123\"\n  # \"999999\" would not be padded, and remains unchanged as \"999999\"\n  padded_str = unpadded_str.rjust(6, '0')\n</code></pre>\n"}], "owner": {"reputation": 443, "user_id": 5158845, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eff4c21679d34a45c335d91940215c9?s=128&d=identicon&r=PG&f=1", "display_name": "gogofan", "link": "https://stackoverflow.com/users/5158845/gogofan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3841, "favorite_count": 3, "accepted_answer_id": 44033290, "answer_count": 3, "score": 3, "last_activity_date": 1560348411, "creation_date": 1495041652, "question_id": 44031239, "link": "https://stackoverflow.com/questions/44031239/generating-random-number-of-length-6-with-securerandom-in-ruby", "title": "Generating random number of length 6 with SecureRandom in Ruby", "body": "<p>I tried <code>SecureRandom.random_number(9**6)</code> but it sometimes returns 5 and sometimes 6 numbers. I'd want it to be a length of 6 consistently. I would also prefer it in the format like <code>SecureRandom.random_number(9**6)</code> without using syntax like <code>6.times.map</code> so that it's easier to be stubbed in my controller test.  </p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1495039427, "post_id": 44030515, "comment_id": 75087520, "body": "You did <code>a.find_index(&quot;a&quot;)</code> to find the index of <code>&quot;a&quot;</code> in <code>[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</code>, so why are you doing <code>a.find_index([&quot;b&quot;, &quot;c&quot;])</code> and not <code>a.find_index(&quot;b&quot;)</code> to find the index of <code>&quot;b&quot;</code>? The <code>a.find_index([&quot;b&quot;, &quot;c&quot;])</code> is looking for an element in array <code>a</code> that looks like <code>[&quot;b&quot;, &quot;c&quot;]</code> which isn&#39;t there. That&#39;s a sub-array, not an element."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1495048073, "post_id": 44030515, "comment_id": 75092390, "body": "Are you trying to find the first occurrence of <code>b,c</code> sequentially, or simply the first entry in the given array?"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1495047938, "post_id": 44030541, "comment_id": 75092324, "body": "Someone&#39;s cranky. I&#39;ve voted up to restore balance in the universe. I think it&#39;s because it&#39;s not addressing calling it with an array."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1495089525, "post_id": 44030541, "comment_id": 75106523, "body": "The questions asks for a single number (an index) to be returned, possibly to be used in subsequent calculations. You have not done that. I expect that&#39;s the reason for the downvote. Also, <code>a.map{|e| a.find_index(e)}</code> is of no value."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 13, "last_activity_date": 1495041207, "last_edit_date": 1495041207, "creation_date": 1495039332, "answer_id": 44030541, "question_id": 44030515, "link": "https://stackoverflow.com/questions/44030515/in-ruby-how-do-i-find-the-index-of-one-of-an-array-of-elements/44030541#44030541", "title": "In Ruby how do I find the index of one of an array of elements?", "body": "<p>You can use <code>find_index</code> and pass the needed value from the array:</p>\n\n<pre><code>a = [\"a\", \"b\", \"c\"]\np a.find_index('a')\np a.find_index('b')\np a.find_index('c')\n# =&gt; 0\n# =&gt; 1\n# =&gt; 2\n</code></pre>\n\n<p>You can use <code>map</code> to get every element inside your <code>a</code> array and then to get the index corresponding to each element:</p>\n\n<pre><code>p a.map{|e| a.find_index(e)}\n#\u00a0=&gt; [0, 1, 2]\n</code></pre>\n\n<p>Another possible way to handle it could be to use the <a href=\"https://ruby-doc.org/core-2.4.1/Enumerable.html#method-i-each_with_index\" rel=\"noreferrer\"><code>Enumerable#each_with_index</code></a>:</p>\n\n<pre><code>a.each_with_index{|e,i| puts \"Element: #{e}, Index: #{i}\"}\n#\u00a0=&gt; Element: a, Index: 0\n#\u00a0=&gt; Element: b, Index: 1\n#\u00a0=&gt; Element: c, Index: 2\n</code></pre>\n\n<p>If you want to check the indexes for each element in <code>[\"b\", \"c\"]</code> using the <code>[\"a\", \"b\", \"c\"]</code> array, you can map the first one, get the array values, and then use the <code>a,b,c</code> to check those indexes: </p>\n\n<pre><code>p [\"b\", \"c\"].map{|e| [\"a\", \"b\", \"c\"].find_index(e) }\n#\u00a0=&gt; [1, 2]\n</code></pre>\n\n<p>You can also see <a href=\"https://ruby-doc.org/core-2.4.1/Array.html#method-i-index\" rel=\"noreferrer\"><code>Array#index</code></a> and <a href=\"https://ruby-doc.org/core-2.4.1/Enumerable.html#method-i-find_index\" rel=\"noreferrer\"><code>Enumerable#find_index</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 3363, "user_id": 2876504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f861d39e1561dc8147fc6442d1235e8?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro C.", "link": "https://stackoverflow.com/users/2876504/alejandro-c"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1495114632, "post_id": 44030553, "comment_id": 75123916, "body": "@CarySwoveland no real opinion on <code>compact</code>; I see it used quite often and it seems clear enough to me. Also, fyi <code>[nil,nil,nil].compact.min</code> returns <code>nil</code>. So no exception afaict."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1495133993, "post_id": 44030553, "comment_id": 75136669, "body": "I stand corrected. Thank you. As it was in error, I&#39;ve deleted my earlier comment."}], "tags": [], "owner": {"reputation": 3363, "user_id": 2876504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f861d39e1561dc8147fc6442d1235e8?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro C.", "link": "https://stackoverflow.com/users/2876504/alejandro-c"}, "is_accepted": true, "score": 16, "last_activity_date": 1495039385, "creation_date": 1495039385, "answer_id": 44030553, "question_id": 44030515, "link": "https://stackoverflow.com/questions/44030515/in-ruby-how-do-i-find-the-index-of-one-of-an-array-of-elements/44030553#44030553", "title": "In Ruby how do I find the index of one of an array of elements?", "body": "<p><code>find_index</code> takes a single element. You could find the minimum by doing something like </p>\n\n<pre><code>a = [\"a\", \"b\", \"c\"]\nto_find = [\"b\", \"c\"]\nto_find.map {|i| a.find_index(i) } .compact.min # =&gt; 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1495074020, "post_id": 44030856, "comment_id": 75101594, "body": "If <code>b = [&#39;b&#39;, &#39;c&#39;]</code>, this is preferable to enumerating <code>b</code> looking for matches in <code>a</code>. If <code>a</code> and <code>b</code> contain <code>n</code> and <code>m</code> elements respectively, and the element at index <code>i</code> of <code>a</code> is the first to match an element of <code>b</code> (<code>i &lt;= n</code>), <code>i*m</code> operations are required. If <code>b</code> is enumerated, <code>n*m</code> operations are required. This is therefore faster that enumerating <code>b</code> regardless of <code>n</code> and <code>m</code>. If <code>n*m</code> is large I would suggest first computing <code>require set; sb = b.to_set</code>, and using <code>sb.include?(x)</code> to speed that operation."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 14, "last_activity_date": 1581700972, "last_edit_date": 1581700972, "creation_date": 1495040307, "answer_id": 44030856, "question_id": 44030515, "link": "https://stackoverflow.com/questions/44030515/in-ruby-how-do-i-find-the-index-of-one-of-an-array-of-elements/44030856#44030856", "title": "In Ruby how do I find the index of one of an array of elements?", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.4.1/Array.html#method-i-index\" rel=\"nofollow noreferrer\"><code>Array#index</code></a> with a block. </p>\n\n<pre><code>a = ['a', 'b', 'c']\na.index { |x| ['b', 'c'].include?(x) }\n#=&gt; 1\n</code></pre>\n\n<p>Quote from the docs:</p>\n\n<blockquote>\n  <p>If a block is given instead of an argument, returns the index of the first object for which the block returns true. Returns nil if no match is found.</p>\n</blockquote>\n\n<hr>\n\n<p>As Cary pointed out in his comment it is not the most performant algorithm to compare all elements in <code>a</code> against all elements in <code>['b', 'c']</code> (this would lead to <code>O(n*m)</code>). Depending on the size of both arrays if might sense to build a more efficient data structure first. Using a <code>Set</code> instead of an Array has some cost in creating the <code>set</code> upfront, but makes the comparison in the block much faster (overall <code>O(n+m)</code>):</p>\n\n<pre><code>require 'set'\n\na = ['a', 'b', 'c']\nset = Set.new(['b', 'c'])\na.index { |x| set.include?(x) }\n#=&gt; 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "is_accepted": false, "score": 0, "last_activity_date": 1495048278, "creation_date": 1495048278, "answer_id": 44033010, "question_id": 44030515, "link": "https://stackoverflow.com/questions/44030515/in-ruby-how-do-i-find-the-index-of-one-of-an-array-of-elements/44033010#44033010", "title": "In Ruby how do I find the index of one of an array of elements?", "body": "<p>You could find index of all elements of array <code>b</code> in the array <code>a</code>, and find the min index to find the index at which an element from array <code>b</code>  occurred first in array <code>a</code>.</p>\n\n<p>Something like below:</p>\n\n<pre><code>a = [\"a\", \"b\", \"c\"]\nb = [\"b\", \"c\"]\n\nb.map { |x| a.find_index(x) }.min\n#=&gt; 1\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41664, "favorite_count": 5, "accepted_answer_id": 44030553, "answer_count": 4, "score": 20, "last_activity_date": 1603968906, "creation_date": 1495039255, "last_edit_date": 1603968906, "question_id": 44030515, "link": "https://stackoverflow.com/questions/44030515/in-ruby-how-do-i-find-the-index-of-one-of-an-array-of-elements", "title": "In Ruby how do I find the index of one of an array of elements?", "body": "<p>In Ruby 2.4, how do I find the earliest index of an element of an array in another array?  That is, if any element of an array occurs in the other array, I want to get the first index.  I thought find_index might do it, but</p>\n<pre><code>a = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]\n# =&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]\na.find_index(&quot;a&quot;)\n# =&gt; 0\na.find_index([&quot;b&quot;, &quot;c&quot;])\n# =&gt; nil\n</code></pre>\n<p>In the above example, I would expect to see the output &quot;1&quot; because the element &quot;b&quot; occurs at index 1 in the array &quot;a&quot;.</p>\n"}, {"tags": ["ruby", "xml", "encryption", "soap", "xml-encryption"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1495050569, "post_id": 44030473, "comment_id": 75093741, "body": "Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;. Your question is basically asking us to recommend an off-site resource and asking for opinions without us knowing your expertise, your system or whose API you&#39;re using, which results in broad answers. The SO way is for you to identify the gems, decide which works for you, then try writing code, then ask about a specific problem when you encounter one. &quot;Before i spend a few days walking down dead ends...&quot; is basically your prep work before asking. &quot;<a href=\"http://meta.stackoverflow.com/questions/261592\">How much research effort is expected of Stack Overflow users?</a>&quot;"}, {"owner": {"reputation": 957, "user_id": 851145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/DsSyn.jpg?s=128&g=1", "display_name": "krsyoung", "link": "https://stackoverflow.com/users/851145/krsyoung"}, "edited": false, "score": 1, "creation_date": 1507153436, "post_id": 44030473, "comment_id": 80102851, "body": "Same problem here, any chance you have come up with a solution in the past couple of months that you could share here?"}, {"owner": {"reputation": 193, "user_id": 1284852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af48c69c31baaac8a9c70c0daead4c1a?s=128&d=identicon&r=PG", "display_name": "carlos", "link": "https://stackoverflow.com/users/1284852/carlos"}, "reply_to_user": {"reputation": 957, "user_id": 851145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/DsSyn.jpg?s=128&g=1", "display_name": "krsyoung", "link": "https://stackoverflow.com/users/851145/krsyoung"}, "edited": false, "score": 1, "creation_date": 1527867646, "post_id": 44030473, "comment_id": 88304394, "body": "@krsyoung I never found a complete solution.  Another dev ended up creating a microservice running on the JVM that handled it pretty easily - Java tends to have library support for any protocol you can think of. We considered accessing those libs via jruby, but decided not to muddle the issue even more. Let me know if you were able to find a pure ruby solution."}, {"owner": {"reputation": 957, "user_id": 851145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/DsSyn.jpg?s=128&g=1", "display_name": "krsyoung", "link": "https://stackoverflow.com/users/851145/krsyoung"}, "edited": false, "score": 0, "creation_date": 1528396465, "post_id": 44030473, "comment_id": 88503582, "body": "@carlos Wow, I need to dust off my memory here.  I did get it working, pure ruby but I know it wasn&#39;t pretty!  Unfortunately I don&#39;t have access to the code base any more ... so possible but I think the path you took makes more sense."}], "owner": {"reputation": 193, "user_id": 1284852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af48c69c31baaac8a9c70c0daead4c1a?s=128&d=identicon&r=PG", "display_name": "carlos", "link": "https://stackoverflow.com/users/1284852/carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1495039102, "creation_date": 1495039102, "question_id": 44030473, "link": "https://stackoverflow.com/questions/44030473/xml-encryption-of-soap-request-in-ruby", "title": "xml encryption of SOAP request in ruby", "body": "<p>I need to consume a 3rd party SOAP webservice from a Rails 5 app running Ruby 2.3.x.  The SOAP webservice requires the use of XML signatures and XML encryption on all requests/responses.</p>\n\n<p>There appear to be adequate ruby gems that add XML signatures to SOAP requests (e.g. Savon with the Akami gem).  However, i can't find anything that will transparently handle XML encryption of SOAP requests and decryption of SOAP responses.  There are a few gems that work with XML encryption to various degrees.</p>\n\n<p>The xmlsec gem, a nokogiri extension, claims to support XML-Enc and XML-Sig but hasn't been updated in 4 years.  The xmlenc gem only supports decryption at this time.  The few gems I have found that implement specs with encrypted XML, like the ruby-saml gem, only have to deal with decryption and have hand rolled their solution.  Moreover, the XML-enc metadata that needs to be injected into the XML document is substantively different between SOAP and SAML.</p>\n\n<p>Like XML-Sig, the XML-Enc spec is more far reaching than just encrypting the contents of an XML element with a private key.  There is a lot of additional metadata that must be injected into the XML doc that complicates the implementation and facilitates document exchange.</p>\n\n<p>Before i spend a few days walking down dead ends ... I was wondering if someone could point me in the right direction.</p>\n"}, {"tags": ["ruby", "hash", "chef-infra"], "answers": [{"comments": [{"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 1, "creation_date": 1495039520, "post_id": 44030180, "comment_id": 75087575, "body": "You can slightly simplify that, <code>&lt;%= value %&gt;</code> for example."}], "tags": [], "owner": {"reputation": 3363, "user_id": 2876504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f861d39e1561dc8147fc6442d1235e8?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro C.", "link": "https://stackoverflow.com/users/2876504/alejandro-c"}, "is_accepted": true, "score": 1, "last_activity_date": 1495039654, "last_edit_date": 1495039654, "creation_date": 1495038110, "answer_id": 44030180, "question_id": 44029760, "link": "https://stackoverflow.com/questions/44029760/chef-fill-in-xml-values-in-template-with-hash-in-attribute/44030180#44030180", "title": "chef fill in xml values in template with hash in attribute", "body": "<p>You need to use erb <code>&lt;%= %&gt;</code></p>\n\n<pre><code>&lt;% node['server']['database'].each do |hash| %&gt;\n    &lt;% hash.each do |key, value| %&gt;\n        &lt;%if key == \"name\" %&gt;\n            &lt;Resource name=\"&lt;%= value %&gt;\"\n                &lt;% else %&gt;\n                    &lt;%= \"#{key}=\\\"#{value}\\\"\" %&gt;\n                &lt;% end %&gt;\n            &lt;% end %&gt;\n            /&gt;\n        &lt;% end %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1495039449, "post_id": 44030209, "comment_id": 75087532, "body": "Ruby hash key ordering has been part of the language since the 1.9 days."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1495040104, "post_id": 44030209, "comment_id": 75087922, "body": "Ruby 1.9 grantees that the keys are returned in their <i>insertion order</i>, that is true. I wanted to point out that the OPs code is error prone, because it breaks as soon as the order is not like expected and that might happen by accident when someone changes the config, by updating the hash based on conditions, using an old Ruby version or because the hash might be read from an external file. On the other hand, my examples are easier to read, to understand and fault-tolerant."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1495042960, "last_edit_date": 1495042960, "creation_date": 1495038189, "answer_id": 44030209, "question_id": 44029760, "link": "https://stackoverflow.com/questions/44029760/chef-fill-in-xml-values-in-template-with-hash-in-attribute/44030209#44030209", "title": "chef fill in xml values in template with hash in attribute", "body": "<p>I would do something like this:</p>\n\n<pre><code>&lt;% node['server']['database'].each do |hash| %&gt;\n  &lt;Resource name=\"&lt;%= hash['name'] %&gt;\"\n            user=\"&lt;%= hash['user'] %&gt;\"\n            pass=\"&lt;%= hash['pass'] %&gt;\" /&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>&lt;% node['server']['database'].each do |hash| %&gt;\n  &lt;Resource &lt;%= hash.map { |k, v| \"#{k}=#{v.inspect}\" }.join(' ') %&gt; /&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Please note that the order of keys in a hash can be difficult to debug in corner cases. In contrast to your nested example do my examples do not rely on a specific key ordering. </p>\n"}], "owner": {"reputation": 158, "user_id": 2334324, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/73d4019af69d424c0586a4e9c1cd8cec?s=128&d=identicon&r=PG", "display_name": "Mike D", "link": "https://stackoverflow.com/users/2334324/mike-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "accepted_answer_id": 44030180, "answer_count": 2, "score": 0, "last_activity_date": 1495042960, "creation_date": 1495036778, "question_id": 44029760, "link": "https://stackoverflow.com/questions/44029760/chef-fill-in-xml-values-in-template-with-hash-in-attribute", "title": "chef fill in xml values in template with hash in attribute", "body": "<p>I have an array of hashes with values in my attributes/default.rb file in chef like what I have below:</p>\n\n<pre><code>default['server']['database'] = [\n    {\n        'name' =&gt; 'srv1'\n        'user' =&gt; 'usr1'\n        'pass' =&gt; 'pwd1'\n    },\n    {\n        'name' =&gt; 'srv2'\n        'user' =&gt; 'user2'\n        'pass' =&gt; 'pwd3'\n    }\n]\n</code></pre>\n\n<p>Then, I've got a templates/default/server.xml.erb file with the following nested loop:</p>\n\n<pre><code>&lt;% node['server']['database'].each do |hash| %&gt;\n    &lt;% hash.each do |key, value| %&gt;\n        &lt;%if key == \"name\" %&gt;\n            &lt;Resource name=\"#{value}\"\n                &lt;% else %&gt;\n                    #{key}=\"#{value}\"\n                &lt;% end %&gt;\n            &lt;% end %&gt;\n            /&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>The expected result is:</p>\n\n<pre><code>&lt;Resource name=\"srv1\"\n    user=\"usr1\"\n    pass=\"pwd1\"\n/&gt;\n&lt;Resource name=\"srv2\"\n    user=\"usr2\"\n    pass=\"pwd2\"\n/&gt;\n</code></pre>\n\n<p>What I end up getting with this is:</p>\n\n<pre><code>&lt;Resource name=\"#{value}\"\n    #{key}=\"#{value}\"\n    #{key}=\"#{value}\"\n/&gt;\n&lt;Resource name=\"#{value}\"\n    #{key}=\"#{value}\"\n    #{key}=\"#{value}\"\n/&gt;\n</code></pre>\n\n<p>I've tried this in plain ruby and got it to print expected results.  Not sure what I'm doing wrong here, but please, if you could shed some light I would appreciate it.</p>\n"}, {"tags": ["ruby", "unit-testing", "aws-sdk", "stub"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 1101936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011b1956f9a1b3294af3bbf8cdd89741?s=128&d=identicon&r=PG", "display_name": "burn5", "link": "https://stackoverflow.com/users/1101936/burn5"}, "edited": false, "score": 0, "creation_date": 1495091799, "post_id": 44030099, "comment_id": 75108005, "body": "Thanks @max-pleaner I have updated the question to clarify the test framework I am using, which is <code>MiniTest</code>. So I guess the equivalent would be to create a <code>MiniTest::Mock</code> object and add an expect, like so?  <code>mock = MiniTest.Mock.new()</code> <code>mock.expect(:update, nil, [{}])</code>  And then stub the <code>Aws.config</code> call like this?  <code>Aws.config.stub(:update, mock)</code>"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 2, "last_activity_date": 1495037871, "creation_date": 1495037871, "answer_id": 44030099, "question_id": 44029711, "link": "https://stackoverflow.com/questions/44029711/stub-calls-to-aws-config-update/44030099#44030099", "title": "Stub Calls to `Aws.config.update()`", "body": "<p>Stubbing without specifying a return value has the effect you intend, for example:</p>\n\n<pre><code>expect(Aws.config).to receive(:update)\n</code></pre>\n\n<p>afer this, running <code>Aws.config.update</code> will just return nil and not actually run anything. You could also use <code>allow</code>. </p>\n\n<p>You didn't specify what testing library you're using, but to be clear the example I gave is in RSpec. </p>\n"}], "owner": {"reputation": 37, "user_id": 1101936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011b1956f9a1b3294af3bbf8cdd89741?s=128&d=identicon&r=PG", "display_name": "burn5", "link": "https://stackoverflow.com/users/1101936/burn5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 44030099, "answer_count": 1, "score": 0, "last_activity_date": 1495091712, "creation_date": 1495036648, "last_edit_date": 1495091712, "question_id": 44029711, "link": "https://stackoverflow.com/questions/44029711/stub-calls-to-aws-config-update", "title": "Stub Calls to `Aws.config.update()`", "body": "<p>I am writing unit tests (using the Ruby MiniTest framework) for a class which, as part of the constructor, configures the AWS SDK global configuration with a set of credentials.</p>\n\n<p>It does so by calling <code>Aws.config.update()</code> and passing a hash of credentials.</p>\n\n<p>As part of the test I do not want this configuration change to take place. Is there any way I can achieve this without modifying the class being tested? ie Without adding in a condition to the method call driven by a method parameter. </p>\n\n<p>Whilst this doesn't seem like a 'stub' scenario (I don't want a canned response in return from the call, I just don't want that call to result in a configuration change) I wondered if I could use the AWS SDK stubbing capabilities (described quite nicely <a href=\"https://aws.amazon.com/blogs/developer/stubbing-aws-responses/\" rel=\"nofollow noreferrer\">here</a>)</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1030, "user_id": 2100645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9894864f33c42fffe19330d2e00d1b?s=128&d=identicon&r=PG", "display_name": "Lucas Costa", "link": "https://stackoverflow.com/users/2100645/lucas-costa"}, "edited": false, "score": 0, "creation_date": 1495040336, "post_id": 44029126, "comment_id": 75088060, "body": "Are you sure that the command <code>bitcoin-cli</code> outputs its result to <code>STDOUT</code>?"}, {"owner": {"reputation": 13, "user_id": 6900766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a799e40111e093f0e6a422ca2465df42?s=128&d=identicon&r=PG&f=1", "display_name": "Zeshan Butt", "link": "https://stackoverflow.com/users/6900766/zeshan-butt"}, "reply_to_user": {"reputation": 1030, "user_id": 2100645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9894864f33c42fffe19330d2e00d1b?s=128&d=identicon&r=PG", "display_name": "Lucas Costa", "link": "https://stackoverflow.com/users/2100645/lucas-costa"}, "edited": false, "score": 0, "creation_date": 1495103382, "post_id": 44029126, "comment_id": 75115811, "body": "it does not create any output."}], "owner": {"reputation": 13, "user_id": 6900766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a799e40111e093f0e6a422ca2465df42?s=128&d=identicon&r=PG&f=1", "display_name": "Zeshan Butt", "link": "https://stackoverflow.com/users/6900766/zeshan-butt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495035006, "creation_date": 1495035006, "question_id": 44029126, "link": "https://stackoverflow.com/questions/44029126/bitcoin-core-rpc-method-sendfrom-is-not-working", "title": "Bitcoin core RPC method &quot;sendfrom&quot; is not working", "body": "<p>Bitcoin core RPC method \"sendfrom\" is not working from my controller.I am running the following command from my controller</p>\n\n<pre><code>bitcoin_cli = BitcoinCli.new  \nresponse = bitcoin_cli.execute_function(\"sendfrom\", \"#{account.strip}\", \"#{address.strip}\", \"#{amount}\")\n</code></pre>\n\n<p>and here is execute function</p>\n\n<pre><code>class BitcoinCli   \n\n  def initialize()\n\n  end\n\n\n  def execute_function(function_name, *params)  \n    result = %x{/usr/local/bin/bitcoin-cli #{function_name} #{params.join(' ')}}  \n  end  \n</code></pre>\n\n<p>end</p>\n\n<p>but after executing the function the response is nil.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter-bootstrap"], "answers": [{"comments": [{"owner": {"reputation": 1480, "user_id": 3927509, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/078194551f43a33f5110051a3faf3643?s=128&d=identicon&r=PG", "display_name": "exsnake", "link": "https://stackoverflow.com/users/3927509/exsnake"}, "edited": false, "score": 1, "creation_date": 1495035602, "post_id": 44029023, "comment_id": 75085090, "body": "Ok, i fix it removing the line <code>&#47;&#47;= require bootstrap-sprockets</code>, don&#39;t if that is a right thing to do..."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 1480, "user_id": 3927509, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/078194551f43a33f5110051a3faf3643?s=128&d=identicon&r=PG", "display_name": "exsnake", "link": "https://stackoverflow.com/users/3927509/exsnake"}, "edited": false, "score": 1, "creation_date": 1495035651, "post_id": 44029023, "comment_id": 75085139, "body": "Maybe some additional code, I tried in a clean Rails app and no problem. I have just <code>&#47;&#47;= require bootstrap-sprockets</code> as the doc says, no <code>&#47;&#47;= require bootstrap</code>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 3, "last_activity_date": 1495035067, "last_edit_date": 1495035067, "creation_date": 1495034735, "answer_id": 44029023, "question_id": 44028730, "link": "https://stackoverflow.com/questions/44028730/bootstrap-modal-in-ruby-on-rails-not-working/44029023#44029023", "title": "Bootstrap modal in ruby on rails not working", "body": "<p>You need to remove the <code>hide</code> class from the <code>#myModal</code> modal, because that's given it a <code>display: none !important</code> CSS rule, that's why you can't see it:</p>\n\n<p>Check with this:</p>\n\n<pre><code>&lt;div id=\"myModal\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\"&gt;\n  &lt;div class=\"modal-dialog\" role=\"document\"&gt;\n    &lt;div class=\"modal-content\"&gt;\n      &lt;div class=\"modal-header\"&gt;\n        &lt;button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\"&gt;\u00d7&lt;/button&gt;\n        &lt;h3 id=\"myModalLabel\"&gt;Modal header&lt;/h3&gt;\n      &lt;/div&gt;\n      &lt;div class=\"modal-body\"&gt;\n        &lt;p&gt;One fine body\u2026&lt;/p&gt;\n      &lt;/div&gt;\n      &lt;div class=\"modal-footer\"&gt;\n        &lt;button class=\"btn\" data-dismiss=\"modal\" aria-hidden=\"true\"&gt;Close&lt;/button&gt;\n        &lt;button class=\"btn btn-primary\"&gt;Save changes&lt;/button&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And most probably you'll need to wrap your <code>.modal-header</code> within a <code>&lt;div class=\"modal-dialog\" role=\"document\"&gt;</code> and a <code>&lt;div class=\"modal-content\"&gt;</code> to see your it \"well\". </p>\n"}, {"tags": [], "owner": {"reputation": 68, "user_id": 7508848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512dca7f2add55b851369e5d304c82fa?s=128&d=identicon&r=PG", "display_name": "Marshall", "link": "https://stackoverflow.com/users/7508848/marshall"}, "is_accepted": false, "score": 1, "last_activity_date": 1611635673, "last_edit_date": 1611635673, "creation_date": 1498777425, "answer_id": 44836258, "question_id": 44028730, "link": "https://stackoverflow.com/questions/44028730/bootstrap-modal-in-ruby-on-rails-not-working/44836258#44836258", "title": "Bootstrap modal in ruby on rails not working", "body": "<p>The modal will disappear immediately after showing. So I delete   //= require bootstrap-sprockets in the application.js file and solve this problem. FYI</p>\n"}], "owner": {"reputation": 1480, "user_id": 3927509, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/078194551f43a33f5110051a3faf3643?s=128&d=identicon&r=PG", "display_name": "exsnake", "link": "https://stackoverflow.com/users/3927509/exsnake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2052, "favorite_count": 1, "accepted_answer_id": 44029023, "answer_count": 2, "score": 3, "last_activity_date": 1611635673, "creation_date": 1495033909, "last_edit_date": 1495542880, "question_id": 44028730, "link": "https://stackoverflow.com/questions/44028730/bootstrap-modal-in-ruby-on-rails-not-working", "title": "Bootstrap modal in ruby on rails not working", "body": "<p>I'm trying to implement a modal to create a new user for my app. For some reason a can't make it work.</p>\n\n<p>This code just fade in and out, and no modal is showing up, i can't figure out why. In fact, I'm using the exact same code from this answer <a href=\"https://stackoverflow.com/questions/15152486/how-to-add-bootstrap-modal-with-link-to-so-the-link-content-open-in-modal\">How to add bootstrap modal with link_to so the link content open in modal ?</a></p>\n\n<pre><code>&lt;%= link_to \"Open modal\", \"#myModal\", :class =&gt; \"btn\", \"data-toggle\" =&gt; \"modal\" %&gt;\n      &lt;!-- Modal --&gt;\n      &lt;div id=\"myModal\" class=\"modal hide fade\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\"&gt;\n        &lt;div class=\"modal-header\"&gt;\n          &lt;button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\"&gt;\u00d7&lt;/button&gt;\n          &lt;h3 id=\"myModalLabel\"&gt;Modal header&lt;/h3&gt;\n        &lt;/div&gt;\n        &lt;div class=\"modal-body\"&gt;\n          &lt;p&gt;One fine body\u2026&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div class=\"modal-footer\"&gt;\n          &lt;button class=\"btn\" data-dismiss=\"modal\" aria-hidden=\"true\"&gt;Close&lt;/button&gt;\n          &lt;button class=\"btn btn-primary\"&gt;Save changes&lt;/button&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n</code></pre>\n\n<p>My gems:</p>\n\n<pre><code>gem 'rails',        '5.0.2'\n# Use mysql as the database for Active Record\ngem 'mysql2', '&gt;= 0.3.18', '&lt; 0.5'\ngem 'faker',          '1.6.6'\ngem 'will_paginate',           '3.1.0'\ngem 'bootstrap-will_paginate', '0.0.10'\ngem 'bcrypt',         '3.1.11'\ngem 'bootstrap-sass', '3.3.6'\ngem 'puma',         '3.4.0'\ngem 'sass-rails',   '5.0.6'\ngem 'uglifier',     '3.0.0'\ngem 'coffee-rails', '4.2.1'\ngem 'jquery-rails', '4.1.1'\ngem 'turbolinks',   '5.0.1'\ngem 'jbuilder',     '2.4.1'\n</code></pre>\n\n<p>below line in <code>app/assets/javascripts/application.js</code></p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require bootstrap\n//= require bootstrap-sprockets\n</code></pre>\n\n<p>And my <code>scss</code></p>\n\n<pre><code>@import \"bootstrap-sprockets\";\n@import \"bootstrap\";\n</code></pre>\n"}, {"tags": ["php", "ruby", "encryption"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1495038128, "post_id": 44028396, "comment_id": 75086798, "body": "it might be easier to make a command line script which runs the Laravel decryption, then run that through ruby system commands to get the output. Especially since it&#39;s a one-off job."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 2651822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c54b49d177fa52fa64df3416ef3da96?s=128&d=identicon&r=PG", "display_name": "Mike Mollick", "link": "https://stackoverflow.com/users/2651822/mike-mollick"}, "is_accepted": true, "score": 2, "last_activity_date": 1495082206, "creation_date": 1495082206, "answer_id": 44038667, "question_id": 44028396, "link": "https://stackoverflow.com/questions/44028396/laravel-cryptdecrypt-migration-to-ruby/44038667#44038667", "title": "Laravel Crypt::decrypt migration to ruby", "body": "<p>You can reverse engineer Laravel's Encrypter::decrypt method using mostly standard libs. Laravel will serialize data before encrypting it unless told explicitly not to. This means attempting to unserialize the decrypted string prior to using it.</p>\n\n<pre><code>require 'base64'\nrequire 'openssl'\nrequire 'json'\nrequire 'php_serialize'\n\ndef lara_decrypt(encryptedString, appKey)\n   data = JSON.parse(Base64::decode64(encryptedString))\n\n   decipher = OpenSSL::Cipher.new('aes-256-cbc')\n   decipher.decrypt\n   decipher.key = Base64::decode64(appKey)\n   decipher.iv = Base64::decode64(data['iv'])\n   decrypted = decipher.update(Base64::decode64(data['value'])) + decipher.final\n   begin\n      PHP.unserialize(decrypted)\n   rescue\n      decrypted\n   end\nend\n</code></pre>\n\n<p>Also when you set the app key be sure to drop <code>base64:</code> from the beginning of it (if it's there).</p>\n"}], "owner": {"reputation": 4451, "user_id": 788652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1daf5af7198f084898f5c0d5c4b909d5?s=128&d=identicon&r=PG", "display_name": "Hendrik", "link": "https://stackoverflow.com/users/788652/hendrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 1, "accepted_answer_id": 44038667, "answer_count": 1, "score": 0, "last_activity_date": 1495082206, "creation_date": 1495033047, "question_id": 44028396, "link": "https://stackoverflow.com/questions/44028396/laravel-cryptdecrypt-migration-to-ruby", "title": "Laravel Crypt::decrypt migration to ruby", "body": "<p>for a customer we are migrating a Laravel application to a Ruby application. We have some data stored in the database that we would like to decrypt in the ruby world.</p>\n\n<p>This is the laravel part that was used to encrypt the data: <a href=\"https://laravel.com/docs/5.0/encryption\" rel=\"nofollow noreferrer\">https://laravel.com/docs/5.0/encryption</a></p>\n\n<p>Now when importing the data to ruby we need a counter part that can decrypt the data.</p>\n\n<p>In the laravel console I was able to decrypt the data like this:</p>\n\n<pre><code>&gt;&gt;&gt; Crypt::decrypt('eyJpdiI6ImZyek9ZTjJNSW5ZYlhSa2ZYUldVbEE9PSIsInZhbHVlIjoia20zMTRLWEpCdXM2K05DZDBHSlE5SDlcL2pYVXk5aE5RWWR3dHFQT1dGQzA9IiwibWFjIjoiZWZlNGE3NTRhMDDlNzk2MjhlYjI1Mzc1NGNiYmRjNDMwZjM1NzdiMzkyZTU4ZjA4ZDNkMGE0YjUyOTBjMDAzOCJA')\n=&gt; \"123123123123\"\n</code></pre>\n\n<p>I am no laravel expert, but in the app.php file a secret key was set. So I need to be able to pass it somehow to the decrypt function.</p>\n\n<p>The goal is to have a ruby function that takes the laravel password, encryption key and returns the decrypted value.</p>\n\n<pre><code>def decrypt_laravel_crypt(value, encryption_key)\nend\n</code></pre>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["ruby", "postgresql", "sequel"], "answers": [{"comments": [{"owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "edited": false, "score": 0, "creation_date": 1495032897, "post_id": 44028237, "comment_id": 75083037, "body": "Hmmm, thanks, I&#39;ll play with it. I updated the answer with some stuff I&#39;ve tried by now"}, {"owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "edited": false, "score": 0, "creation_date": 1495033631, "post_id": 44028237, "comment_id": 75083629, "body": "<code>DB.inspect</code> returns <code>&quot;#&lt;Sequel::Postgres::Database: \\&quot;postgres:&#47;&#47;test:test@127.0.0.1:5432&#47;db_test\\&quot; {:notice_receiver=&gt;#&lt;Proc:0x00000003f2e0d8@...&#47;Backend&#47;confi&zwnj;&#8203;g&#47;initializers&#47;00_da&zwnj;&#8203;tabase.rb:4&gt;}&gt;&quot;</code>, and <code>require &#39;pg&#39;</code>  returns false so I guess it&#39;s the right adapter?"}, {"owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "edited": false, "score": 1, "creation_date": 1495034110, "post_id": 44028237, "comment_id": 75083997, "body": "Hmf, I nailed it, it seems notices don&#39;t get distributed with the notice_receiver hook, but warnings do. I&#39;ll workaround this for now by using <code>raise warning</code> where I should be doing <code>raise notice</code> and see through the source code what&#39;s up."}, {"owner": {"reputation": 3363, "user_id": 2876504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f861d39e1561dc8147fc6442d1235e8?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro C.", "link": "https://stackoverflow.com/users/2876504/alejandro-c"}, "reply_to_user": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "edited": false, "score": 0, "creation_date": 1495036084, "post_id": 44028237, "comment_id": 75085454, "body": "Try setting client_min_messages to <code>:notice</code> in the spec?"}, {"owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "edited": false, "score": 0, "creation_date": 1495036451, "post_id": 44028237, "comment_id": 75085744, "body": "Want to edit your answer to include the <code>client_min_messages</code> angle and I&#39;ll accept it?"}], "tags": [], "owner": {"reputation": 3363, "user_id": 2876504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f861d39e1561dc8147fc6442d1235e8?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro C.", "link": "https://stackoverflow.com/users/2876504/alejandro-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1548411575, "last_edit_date": 1548411575, "creation_date": 1495032608, "answer_id": 44028237, "question_id": 44027973, "link": "https://stackoverflow.com/questions/44027973/how-to-print-postgres-raise-notice-output-from-sequel/44028237#44028237", "title": "How to print postgres &quot;raise notice&quot; output from Sequel?", "body": "<p>You pass in your own proc which gets the notice as a string. To have it trigger on notices and not <a href=\"https://github.com/jeremyevans/sequel/blob/88180f7b46140687070f81bbf0c9cd7a0436f18d/lib/sequel/adapters/shared/postgres.rb#L52\" rel=\"nofollow noreferrer\">just warnings and above</a>, use client_min_messages. For example:</p>\n\n<pre><code>a = nil\nSequel.connect(\n  DB.opts.merge(\n      notice_receiver: proc{|r| a = r.result_error_message}, \n      client_min_messages: :notice)) { |db|\n  db.do(\"BEGIN\\nRAISE WARNING 'foo';\\nEND;\")\n}\na == \"WARNING:  foo\\n\" # true\n</code></pre>\n"}], "owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "accepted_answer_id": 44028237, "answer_count": 1, "score": 1, "last_activity_date": 1548411575, "creation_date": 1495031986, "last_edit_date": 1495036071, "question_id": 44027973, "link": "https://stackoverflow.com/questions/44027973/how-to-print-postgres-raise-notice-output-from-sequel", "title": "How to print postgres &quot;raise notice&quot; output from Sequel?", "body": "<p>Raise notice is typically used to debug PSQL scripts in postgres (<a href=\"https://stackoverflow.com/questions/23465429/printing-a-value-of-a-variable-in-postgresql\">link</a>).</p>\n\n<p><a href=\"http://sequel.jeremyevans.net/rdoc/files/doc/opening_databases_rdoc.html#label-postgres\" rel=\"nofollow noreferrer\">The docs say that there's some kind of support for printing notices when using the pg gem</a>, but there's no info on how to use this proc, what it yields, possible (probable?) caveats etc.</p>\n\n<p>Does anyone have a working code example for production and/or development? Ideally, I'm looking for a solution that allows PG notices to be printed out in development when Sequel logging is enabled.</p>\n\n<p>When I do:</p>\n\n<pre><code>DB = Sequel.connect(\n  ENV['DATABASE_URL'],\n  notice_receiver: lambda{ |x| binding.pry }\n)\n</code></pre>\n\n<p>the <code>notice_receiver</code> lambda never gets called once I execute a function that raises a notice. I.e</p>\n\n<pre><code>[1] pry(#&lt;Psql::CalculateMasterBalancesTest&gt;)&gt; DB.select{ |o| Sequel.function(:emit_notice) }.first\nI, [2017-05-17T16:51:56.746003 #23139]  INFO -- : (0.000335s) SELECT emit_notice() LIMIT 1\n=&gt; {:emit_notice=&gt;\"\"}\n</code></pre>\n\n<p>where emit notice is:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION emit_notice()\n  RETURNS VOID AS $$\n\nBEGIN\n  RAISE NOTICE 'NOTICE ME!!!';\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre>\n\n<p>and it works from PgAdmin:</p>\n\n<pre><code>NOTICE:  NOTICE ME!!!\nTotal query runtime: 21 ms.\n1 row retrieved.\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Alejandro C gave a good working example, and it seems that notices don't get distributed with the <code>notice_receiver</code> hook. For example:</p>\n\n<pre><code>Sequel.connect(DB.opts.merge(:notice_receiver=&gt;proc{|r| puts r.result_error_message})){ |db|\n  db.do(\"BEGIN\\nRAISE NOTICE 'foo';\\nEND;\")\n}\n</code></pre>\n\n<p>prints nothing, and:</p>\n\n<pre><code>Sequel.connect(DB.opts.merge(:notice_receiver=&gt;proc{|r| puts r.result_error_message})){ |db|\n  db.do(\"BEGIN\\nRAISE WARNING 'foo';\\nEND;\")\n}\n</code></pre>\n\n<p>Prints</p>\n\n<blockquote>\n  <p>WARNING:  foo</p>\n</blockquote>\n\n<p>Since <a href=\"https://github.com/jeremyevans/sequel/blob/master/lib/sequel/adapters/postgres.rb#L257\" rel=\"nofollow noreferrer\">Sequel just calls <code>set_notice_receiver</code> from PG</a>, I guess I should file a bug report with PG.</p>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>Yet when I try things just with the PG gem I get</p>\n\n<pre><code>conn = PG.connect( :dbname =&gt; 'db_test', user: 'test', password: 'test', host: '127.0.0.1' )\nconn.set_notice_receiver{|r| puts r.result_error_message }\nconn.exec(\"SELECT emit_notice()\")\nNOTICE:  NOTICE ME!!!\n=&gt; #&lt;PG::Result:0x0000000405ac18 status=PGRES_TUPLES_OK ntuples=1 nfields=1 cmd_tuples=1&gt;\n</code></pre>\n\n<p>So at this point I'm a bit confused...</p>\n\n<p><strong>EDIT 3</strong></p>\n\n<p><a href=\"https://github.com/jeremyevans/sequel/issues/1362\" rel=\"nofollow noreferrer\">Posted an issue GitHub...</a></p>\n\n<p><strong>EDIT 4</strong></p>\n\n<p>Ah, apparently there's another options you need to use, <code>client_min_messages</code> needs to be set to <code>:notice</code> as so:</p>\n\n<pre><code>DB = Sequel.connect(\n  ENV['DATABASE_URL'],\n  notice_receiver: proc{|r| puts r.result_error_message},\n  client_min_messages: :notice\n)\n</code></pre>\n\n<p>and this works</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "cancancan"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1495032130, "post_id": 44027632, "comment_id": 75082443, "body": "you don&#39;t have a current user so this fails you could add a guard clause or implement in the same fashion as the <a href=\"https://github.com/CanCanCommunity/cancancan/wiki/defining-abilities\" rel=\"nofollow noreferrer\">Abilities Docs</a>"}], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 6772134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P4l5R.jpg?s=128&g=1", "display_name": "Pedro Holguin", "link": "https://stackoverflow.com/users/6772134/pedro-holguin"}, "edited": false, "score": 0, "creation_date": 1495034183, "post_id": 44028761, "comment_id": 75084049, "body": "This method is used with rolify <a href=\"https://github.com/RolifyCommunity/rolify/wiki/Devise---CanCanCan---rolify-Tutorial\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 2256, "user_id": 2241124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc5006fe57f3543b66290035bb9ef0c7?s=128&d=identicon&r=PG", "display_name": "seancdavis", "link": "https://stackoverflow.com/users/2241124/seancdavis"}, "edited": false, "score": 0, "creation_date": 1495036281, "post_id": 44028761, "comment_id": 75085624, "body": "The OP mentioned nothing about rolify, and the user model he&#39;s showing does not have a <code>has_role?</code> method."}], "tags": [], "owner": {"reputation": 56, "user_id": 6772134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P4l5R.jpg?s=128&g=1", "display_name": "Pedro Holguin", "link": "https://stackoverflow.com/users/6772134/pedro-holguin"}, "is_accepted": false, "score": 0, "last_activity_date": 1495034016, "creation_date": 1495034016, "answer_id": 44028761, "question_id": 44027632, "link": "https://stackoverflow.com/questions/44027632/ruby-on-rail-undefined-method-admin-for-nilnilclass/44028761#44028761", "title": "Ruby on Rail - undefined method `admin?&#39; for nil:NilClass", "body": "<p><strong>ability</strong></p>\n\n<pre><code>class Ability\n include CanCan::Ability\n\n  def initialize(user)\n    if user.has_role? :admin\n     can :manage, :all\n    else\n     can :read, :all\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2256, "user_id": 2241124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc5006fe57f3543b66290035bb9ef0c7?s=128&d=identicon&r=PG", "display_name": "seancdavis", "link": "https://stackoverflow.com/users/2241124/seancdavis"}, "is_accepted": true, "score": 2, "last_activity_date": 1495036239, "creation_date": 1495036239, "answer_id": 44029554, "question_id": 44027632, "link": "https://stackoverflow.com/questions/44027632/ruby-on-rail-undefined-method-admin-for-nilnilclass/44029554#44029554", "title": "Ruby on Rail - undefined method `admin?&#39; for nil:NilClass", "body": "<p>I'm guessing the line from where the error is originating is something like:</p>\n\n<pre><code>if can? :manage, @object\n  # ...\n</code></pre>\n\n<p>This is likely causing an error because your user is not logged in.</p>\n\n<p>The method defining the abilities looks like this:</p>\n\n<pre><code>def initialize(user)\n  if user.admin?\n    can :manage, :all\n  else\n    can :read, :all\n  end\nend\n</code></pre>\n\n<p>So, if you have no user, the line <code>user.admin?</code> will cause an error because <code>user</code> is <code>nil</code> and <code>nil</code> has no <code>admin?</code> method.</p>\n\n<p>I would do something like this:</p>\n\n<pre><code>def initialize(user)\n  if user.try(:admin?)\n    can :manage, :all\n  else\n    can :read, :all\n  end\nend\n</code></pre>\n\n<p><code>try</code> in Ruby won't throw an error but will return <code>nil</code> if the method doesn't exist.</p>\n\n<p>(I have not tested this and since you're not sharing the error, I'm taking some liberties in the response.)</p>\n\n<hr>\n\n<p>I'd also like to point out that if the <code>admin</code> attribute on your <code>User</code> model is a boolean, you don't need to define this method\u2014Rails does that automatically for you.</p>\n\n<pre><code>def admin?\n  self.admin\nend\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6141727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e96508c754beb589bfa88e3c4f4e7e50?s=128&d=identicon&r=PG&f=1", "display_name": "Vinz_B", "link": "https://stackoverflow.com/users/6141727/vinz-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 44029554, "answer_count": 2, "score": 2, "last_activity_date": 1495036239, "creation_date": 1495031139, "last_edit_date": 1495031489, "question_id": 44027632, "link": "https://stackoverflow.com/questions/44027632/ruby-on-rail-undefined-method-admin-for-nilnilclass", "title": "Ruby on Rail - undefined method `admin?&#39; for nil:NilClass", "body": "<p>I am using <code>gem 'devise'</code> and <code>'cancancan'</code> for defining roles for user. problem is when I run rails server its says: <code>undefined method 'admin?' for nil:NilClass</code></p>\n\n<p><strong>ability.rb:</strong></p>\n\n<pre><code>class Ability\n  include CanCan::Ability\n\n  def initialize(user)\n    if user.admin?\n      can :manage, :all\n    else\n      can :read, :all\n    end\n  end\nend\n</code></pre>\n\n<p><strong>User model:</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  has_many :projects\n\n  def admin?\n    self.admin\n  end\nend\n</code></pre>\n\n<p>What could be the problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "model-view-controller"], "answers": [{"comments": [{"owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1495368077, "post_id": 44094109, "comment_id": 75213937, "body": "Thanks Josh, these are fair comments. I wasn&#39;t meaning for the post to come across as derogatory towards a particular gem. In this instance the code doesn&#39;t seem too daunting to implement so I wanted to understand how to do it using the Ajax method. I&#39;ll amend the question accordingly."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "reply_to_user": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1495397751, "post_id": 44094109, "comment_id": 75222922, "body": "@Mike.Whitehead I&#39;ll update my answer accordingly :)"}, {"owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1495398301, "post_id": 44094109, "comment_id": 75223083, "body": "thanks. Have you any thoughts on Ajax/in-line editing?"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "reply_to_user": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1495399122, "post_id": 44094109, "comment_id": 75223360, "body": "see my update :) I included an example repo that I whipped up in 10 minutes that uses ajax for editing."}, {"owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1495404915, "post_id": 44094109, "comment_id": 75224748, "body": "@JoshBrady Thanks for such a detailed answer - much appreciated. Do you need to add a route for the editing button if you&#39;re editing on the same page? It&#39;s a nested route so I&#39;d need to do (@event, comment)"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "reply_to_user": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1495408442, "post_id": 44094109, "comment_id": 75225494, "body": "Assuming you&#39;re following conventions, the route will be the same as the route you would normally use. I can&#39;t really specify without seeing your routes and controllers. Guess-and-check never hurt anyone though!"}], "tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": 4, "last_activity_date": 1495399092, "last_edit_date": 1495399092, "creation_date": 1495350561, "answer_id": 44094109, "question_id": 44027374, "link": "https://stackoverflow.com/questions/44027374/rails-5-0-how-to-implement-in-place-editing-without-using-best-in-place-gem/44094109#44094109", "title": "Rails 5.0 - How to implement in-place editing without using best_in_place gem", "body": "<p>I realize this doesn't answer your question, but hopefully it'll solve headaches down the road for you as far as reinventing the wheel goes. It's also why (I believe) you're seeing downvotes.</p>\n\n<blockquote>\n  <p>I don't want to use best_in_place gem as it appears to not have been updated for a while and I'm not sure if its the best fit for Rails 5.0.</p>\n</blockquote>\n\n<p>Gems don't need to have activity to still be useful. By \"for a while\", you must mean mean \"less than 24 hours ago\" because I'm seeing plenty of activity over the last month. Once a Gem solves its usually good to go. </p>\n\n<p><a href=\"https://github.com/bernat/best_in_place/commits/master\" rel=\"nofollow noreferrer\">https://github.com/bernat/best_in_place/commits/master</a></p>\n\n<p>Rails 5 still handles POST requests right? Then it should work. best_in_place is more javascript-heavy than anything. <a href=\"https://github.com/bernat/best_in_place/tree/master/lib/best_in_place\" rel=\"nofollow noreferrer\">https://github.com/bernat/best_in_place/tree/master/lib/best_in_place</a></p>\n\n<p>The most \"daunting\" code in there is the helper.rb file, which renders the HTML that hooks into the JS library.</p>\n\n<p>Update:</p>\n\n<p>The comments/edit.js.erb file would be responsible for inserting the form to edit the comment, such as <code>$('div#new_comment').append('&lt;%= j render 'form' %&gt;');</code></p>\n\n<p>This assumes you're using Rails' conventions in regards to element/ID naming.</p>\n\n<p>If you have a <code>link_to(\"Edit\", edit_comment_path(comment), :remote =&gt; true)</code> everything should fire automatically.</p>\n\n<p><a href=\"https://github.com/joshmn/so-mikew\" rel=\"nofollow noreferrer\">Here's an example repo using Rails 4</a>; should be the same for Rails 5, with the exception of (maybe) <code>respond_to</code> blocks? I'm not sure, haven't used Rails 5 yet. Just do a <code>bundle</code>, <code>rake db:setup</code>, and then a <code>rails s</code>; navigate to <code>http://localhost:3000/events</code> and enjoy.</p>\n"}, {"tags": [], "owner": {"reputation": 2888, "user_id": 2518285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sETWZ.jpg?s=128&g=1", "display_name": "Brett Donald", "link": "https://stackoverflow.com/users/2518285/brett-donald"}, "is_accepted": false, "score": 0, "last_activity_date": 1495756445, "creation_date": 1495756445, "answer_id": 44191479, "question_id": 44027374, "link": "https://stackoverflow.com/questions/44027374/rails-5-0-how-to-implement-in-place-editing-without-using-best-in-place-gem/44191479#44191479", "title": "Rails 5.0 - How to implement in-place editing without using best_in_place gem", "body": "<p>You're on the right track with edit.js.erb. The file should contain JS code to set up the screen for editing, which might be hiding a DIV and displaying an INPUT or TEXTAREA instead, for example.</p>\n\n<p>Of course, the file can also contain Ruby code as well, inside &lt;% %> tags.</p>\n"}], "owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4040, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1495756445, "creation_date": 1495030468, "last_edit_date": 1495368160, "question_id": 44027374, "link": "https://stackoverflow.com/questions/44027374/rails-5-0-how-to-implement-in-place-editing-without-using-best-in-place-gem", "title": "Rails 5.0 - How to implement in-place editing without using best_in_place gem", "body": "<p>I'm building an Events site using RoR which I've just upgraded to v5.0.1 (not moving to 5.1 just yet). My events show page has a comments section at the foot of the page which, so far, only has a create and delete functionality. \nI want to add an Edit/Update function to comments so only the user who created the comment can edit the comment if they see fit. I want them to be able to edit their comment whilst on the same page. </p>\n\n<p>I'm trying to implement these changes using remote: true &amp; Ajax, rather than rely on a gem as it doesn't appear too complex, but I've never done this before and there doesn't appear to be a clear guide via the internet/SO. Here's my views &amp; controller code - </p>\n\n<p><strong>comments_controller.rb</strong></p>\n\n<pre><code>    def create\n        @event = Event.find(params[:event_id])\n        @comment = @event.comments.create!(params[:comment].permit(:name, :body))\n        @comment.user_id = current_user.id\n\n\n        redirect_to @event\n    end\n\n    def update\n        @comment.user = current_user\n\n    respond_to do |format|\n      if @comment.update\n        format.html { redirect_to @comment, notice: 'Comment was successfully updated.' }\n        format.js   { }\n        format.json { render :show, status: :created, location: @comment }\n      else\n        format.html { render :new }\n        format.json { render json: @comment.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n\n\n    def destroy\n        @event = Event.find(params[:event_id])\n        @comment = @event.comments.find(params[:id])\n        @comment.destroy\n\n        redirect_to event_path(@event)\n    end\n</code></pre>\n\n<p><strong>_comments.html.erb</strong></p>\n\n<pre><code>&lt;% if user_signed_in?  %&gt;\n  &lt;p&gt;&lt;%= link_to \"Edit\", remote: true %&gt;&lt;/p&gt;\n  &lt;p&gt;&lt;%= link_to 'Delete', [comment.event, comment],\n                  method: :delete,\n                  class: \"button\",\n                  data: { confirm: 'Are you sure?' } %&gt;&lt;/p&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>My understanding is that I need to include a .js.erb file in my views/comments folder to deal with this ( edit.js.erb ?) but what I'm not clear on is exactly what javascript code I need to include in order for this to work. Also, I don't think my controller code above seems right - should this go in the Edit action? Do I also need an Event#show action in my events controller as this is where it sits in the views?</p>\n\n<p>Any assistance would be greatly appreciated.</p>\n"}, {"tags": ["c", "ruby", "api"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1495030396, "post_id": 44027037, "comment_id": 75081031, "body": "<code>RBASIC(my_argument)-&gt;klass</code> should do."}, {"owner": {"reputation": 116, "user_id": 7926043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2a05eeb94cfe09ed7a81a9dbd971998?s=128&d=identicon&r=PG&f=1", "display_name": "Sisyphe", "link": "https://stackoverflow.com/users/7926043/sisyphe"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1495031740, "post_id": 44027037, "comment_id": 75082118, "body": "Yes, it does. Thank you very much."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1495085019, "creation_date": 1495085019, "answer_id": 44039204, "question_id": 44027037, "link": "https://stackoverflow.com/questions/44027037/how-to-get-the-class-of-a-value-in-ruby-c-api/44039204#44039204", "title": "How to get the class of a VALUE in Ruby C API", "body": "<p>Every ruby object is internally represented by <a href=\"https://github.com/ruby/ruby/blob/0472578b26793e45434769200a806cb6190e5700/include/ruby/ruby.h#L889\" rel=\"nofollow noreferrer\"><code>RObject</code></a> struct (I will copy the source here for the sake of future readers):</p>\n\n<pre><code>struct RObject {\n  struct RBasic basic;\n  union {\n    struct {\n      uint32_t numiv;\n      VALUE *ivptr;\n      void *iv_index_tbl; /* shortcut for RCLASS_IV_INDEX_TBL(rb_obj_class(obj)) */\n    } heap;\n    VALUE ary[ROBJECT_EMBED_LEN_MAX];\n  } as;\n};\n</code></pre>\n\n<p>The very first member, <a href=\"https://github.com/ruby/ruby/blob/0472578b26793e45434769200a806cb6190e5700/include/ruby/ruby.h#L854\" rel=\"nofollow noreferrer\"><code>RBasic</code></a>, defines the class:</p>\n\n<pre><code>struct RBasic {\n    VALUE flags;\n    const VALUE klass;\n}\n</code></pre>\n\n<p>To get an access to <code>RBasic</code> metadata of anything, one might use <code>RBASIC</code> macro:</p>\n\n<pre><code>RBASIC(my_argument)\n</code></pre>\n\n<p>To get the class directly, one might use <a href=\"https://github.com/ruby/ruby/blob/0472578b26793e45434769200a806cb6190e5700/include/ruby/ruby.h#L878\" rel=\"nofollow noreferrer\"><code>RBASIC_CLASS</code></a> macro:</p>\n\n<pre><code>RBASIC_CLASS(my_argument)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "is_accepted": false, "score": 2, "last_activity_date": 1531738110, "creation_date": 1531738110, "answer_id": 51360066, "question_id": 44027037, "link": "https://stackoverflow.com/questions/44027037/how-to-get-the-class-of-a-value-in-ruby-c-api/51360066#51360066", "title": "How to get the class of a VALUE in Ruby C API", "body": "<p>I came across this recently, and used the <code>RBASIC_CLASS</code> macro, but was getting segfaults in certain scenarios for some unexplained reason.</p>\n\n<p>After scanning through <code>ruby.h</code>, I found the <code>CLASS_OF</code> macro, which returns the class as <code>VALUE</code> of a given object.</p>\n\n<pre><code>VALUE obj = INT2NUM(10);\nVALUE klass = CLASS_OF(obj); // rb_cInteger \n</code></pre>\n\n<p>Using Ruby 2.5</p>\n"}], "owner": {"reputation": 116, "user_id": 7926043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2a05eeb94cfe09ed7a81a9dbd971998?s=128&d=identicon&r=PG&f=1", "display_name": "Sisyphe", "link": "https://stackoverflow.com/users/7926043/sisyphe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 44039204, "answer_count": 2, "score": 1, "last_activity_date": 1531738110, "creation_date": 1495029554, "last_edit_date": 1495051425, "question_id": 44027037, "link": "https://stackoverflow.com/questions/44027037/how-to-get-the-class-of-a-value-in-ruby-c-api", "title": "How to get the class of a VALUE in Ruby C API", "body": "<p>I created some classes with Ruby's C API. I want to create a function whose behavior will change depending on the class of the Ruby object.</p>\n\n<p>I tried to use <code>is_a?</code> from Ruby, however, I don't think it's the good way to do this. I checked \"<a href=\"https://github.com/ruby/ruby/blob/trunk/doc/extension.rdoc\" rel=\"nofollow noreferrer\">Creating Extension Libraries for Ruby</a>\" without success. The only direct way to check classes is with the default types.</p>\n\n<p>I have my class \"Klass\" already created:</p>\n\n<pre><code>VALUE rb_cKlass = rb_define_class(\"Klass\", rb_cObject);\n</code></pre>\n\n<p>And how I wanted to check if the class is the good one:</p>\n\n<pre><code>VALUE my_function(VALUE self, VALUE my_argument) {\n    if(rb_check_class(my_argument), rb_cKlass)) {\n        // do something if my_argument is an instance of Klass\n    } else {\n        return Qnil;\n    }\n}\n</code></pre>\n\n<p>Is there a way to do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx", "systemd"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 2453003, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9cccc19200fa7b304f6c947c8a4d0b1a?s=128&d=identicon&r=PG", "display_name": "LongRon", "link": "https://stackoverflow.com/users/2453003/longron"}, "edited": false, "score": 0, "creation_date": 1495090200, "post_id": 44032041, "comment_id": 75106926, "body": "Hey thanks for the advice. I changed the systemd unit the way you told me, but still the same error occurs. journalctl -u resque-worker.service just giving me the code=exited status=203 thats all. Any more ideas? thanks in advance"}, {"owner": {"reputation": 3158, "user_id": 7925197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M21lU.png?s=128&g=1", "display_name": "papey", "link": "https://stackoverflow.com/users/7925197/papey"}, "reply_to_user": {"reputation": 53, "user_id": 2453003, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9cccc19200fa7b304f6c947c8a4d0b1a?s=128&d=identicon&r=PG", "display_name": "LongRon", "link": "https://stackoverflow.com/users/2453003/longron"}, "edited": false, "score": 0, "creation_date": 1495090949, "post_id": 44032041, "comment_id": 75107399, "body": "I&#39;m not a rake expert but I think you need <code>Type=simple</code> not <code>Type=forking</code>, here is a a pointer to the documentation <a href=\"https://www.freedesktop.org/software/systemd/man/systemd.service.html\" rel=\"nofollow noreferrer\">freedesktop.org/software/systemd/man/systemd.service.html</a>"}], "tags": [], "owner": {"reputation": 3158, "user_id": 7925197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M21lU.png?s=128&g=1", "display_name": "papey", "link": "https://stackoverflow.com/users/7925197/papey"}, "is_accepted": false, "score": 1, "last_activity_date": 1495044562, "creation_date": 1495044562, "answer_id": 44032041, "question_id": 44027019, "link": "https://stackoverflow.com/questions/44027019/systemd-init-script-for-resque-worker/44032041#44032041", "title": "systemd init script for resque worker", "body": "<p>I think there 2 types of errors inside the systemd unit. Here are some advices : </p>\n\n<p>1) Let systemd capture your application logs, then use journalctl to look at it</p>\n\n<pre><code>journalctl -u resque-worker.service\n</code></pre>\n\n<p>2) Use env the systemd way : </p>\n\n<pre><code>[Unit]\nDescription=resque-worker for pageflow\n\n[Service]\nType=forking\nExecStart=/home/pageflow/pageflow_daad/rake resque:scheduler\nEnvironement=QUEUE=*\nEnrironement=RAILS_ENV=production\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n\n<p>Then,</p>\n\n<pre><code>systemctl daemon-reload\nsystemctl restart resque-worker.service\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 2453003, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9cccc19200fa7b304f6c947c8a4d0b1a?s=128&d=identicon&r=PG", "display_name": "LongRon", "link": "https://stackoverflow.com/users/2453003/longron"}, "is_accepted": true, "score": 1, "last_activity_date": 1495104983, "creation_date": 1495104983, "answer_id": 44045862, "question_id": 44027019, "link": "https://stackoverflow.com/questions/44027019/systemd-init-script-for-resque-worker/44045862#44045862", "title": "systemd init script for resque worker", "body": "<p>After studying the several docu sites and the documentation itself i found a way to get this running. Just wanted to post this if someone finds this to be helpfull:</p>\n\n<pre><code>[Unit]\nDescription=resque-scheduler for pageflow\n\n[Service]\nUser=yourUser\nWorkingDirectory=/path/to/rails/app\nExecStart=/path/to/executeable/rake resque:scheduler &amp;\nEnvironment=QUEUE=*\nEnvironment=RAILS_ENV=production\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n\n<p>With this script, a </p>\n\n<pre><code>systemctl daemon-reload\n</code></pre>\n\n<p>&amp;</p>\n\n<pre><code>systemctl start example.service\n</code></pre>\n\n<p>The Service startet running and runs like a charm.</p>\n"}], "owner": {"reputation": 53, "user_id": 2453003, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9cccc19200fa7b304f6c947c8a4d0b1a?s=128&d=identicon&r=PG", "display_name": "LongRon", "link": "https://stackoverflow.com/users/2453003/longron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "accepted_answer_id": 44045862, "answer_count": 2, "score": 0, "last_activity_date": 1495104983, "creation_date": 1495029491, "question_id": 44027019, "link": "https://stackoverflow.com/questions/44027019/systemd-init-script-for-resque-worker", "title": "systemd init script for resque worker", "body": "<p>i habe an nginx webserver running on an Ubuntu 16.04 Server.\nNow i am trying to build an init script for resque worker and scheduler for a Rails app.</p>\n\n<p>I created a file resque-worker.service in \"/etc/systemd/system/\" and it looks like this:</p>\n\n<pre><code>[Unit]\n Description=resque-worker for pageflow\n\n[Service]\n Type=forking\n ExecStart=/home/pageflow/pageflow_daad/rake resque:scheduler QUEUE=* RAILS_ENV=production &gt; /home/pageflow/pageflow_daad/log/resqueschedule.log &amp;\n\n[Install]\n WantedBy=multi-user.target\n</code></pre>\n\n<p>For some reason after executing \"systemctl daemon-reload\" and \"systemctl start name.service\" i get this error:</p>\n\n<pre><code>$ systemctl status resque-worker.service\n\u25cf resque-worker.service - resque-worker for pageflow\n   Loaded: loaded (/etc/systemd/system/resque-worker.service; enabled; vendor preset: enabled)\n   Active: failed (Result: exit-code) since Wed 2017-05-17 15:52:38 CEST; 15s ago\n  Process: 28096 ExecStart=/home/pageflow/pageflow_daad/rake resque:scheduler QUEUE=* RAILS_ENV=production &gt; /home/pageflow/pageflow_daad/log/resqueschedule.log &amp; (code=exited, status=203/EXEC)\n\nMay 17 15:52:38 ostheim systemd[1]: Starting resque-worker for pageflow...\nMay 17 15:52:38 ostheim systemd[1]: resque-worker.service: Control process exited, code=exited status=203\nMay 17 15:52:38 ostheim systemd[1]: Failed to start resque-worker for pageflow.\nMay 17 15:52:38 ostheim systemd[1]: resque-worker.service: Unit entered failed state.\nMay 17 15:52:38 ostheim systemd[1]: resque-worker.service: Failed with result 'exit-code'.\n</code></pre>\n\n<p>In this case i used the root path of my Rails app for \"/home/pageflow/pageflow_daad/rake\".</p>\n\n<p>The times before where i tried the path of the rake binary i got the error:<code>May 17 15:30:26 ostheim rake[26846]: rake aborted!\nMay 17 15:30:26 ostheim rake[26846]: ArgumentError: couldn't find HOME environment -- expanding</code>~'`</p>\n\n<p>I hope someone with more experience in this can help me out.</p>\n\n<p>Thanks in advance and best regards,\nRonald</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "rails-i18n"], "owner": {"reputation": 454, "user_id": 4420382, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100007097701606/picture?type=large", "display_name": "Martijn Kerckhaert", "link": "https://stackoverflow.com/users/4420382/martijn-kerckhaert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 380, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1495025839, "creation_date": 1495025839, "question_id": 44025554, "link": "https://stackoverflow.com/questions/44025554/translating-model-attributes-for-devise-error-messages-breaks-form", "title": "Translating model attributes for devise error messages breaks form", "body": "<p>I have ajax devise forms that on error append field and message of error to the bottom of the form.</p>\n\n<p>On ajax:error I do following:</p>\n\n<pre><code>$.each(errors, function(field, messages){\n  error_div.append(field + \" \" + \"messages)\n});\n</code></pre>\n\n<p>I want to translate the errors that are sent and for messages that devise generate I've found an answer on SO that works for me (adding it in my translation file):</p>\n\n<pre><code>en:\n  errors:\n    messages:\n      accepted: \"have to be checked\"\n</code></pre>\n\n<p>Now when I get an error it is like following:</p>\n\n<blockquote>\n  <p>terms_and_conditions have to be checked</p>\n</blockquote>\n\n<p>So next on my list was somehow translating these modal attributes</p>\n\n<p>So I found another SO post that explained a way to translate model attributes like following:</p>\n\n<pre><code>activerecord:\n  models:\n    recruiter:\n      terms_and_conditions: \"Terms and conditions\"\n</code></pre>\n\n<p>But I got a 501 server error,\nAfter tracing the bug and printing the error it is as following:</p>\n\n<pre><code>I18n::InvalidPluralizationData at /recruiters\n=============================================\n\n&gt; translation data {:terms_and_conditions=&gt;\"TERMS TRANSLATION\"} can not be used with :count =&gt; 1\n\napp/controllers/recruiters/registrations_controller.rb, line 8\n``` ruby\n    3   \n    4     def create\n    5       respond_to do |format|\n    6         format.json {\n    7           build_resource(sign_up_params)\n&gt;   8           if resource.save\n    9             RegistrationMailer.recruiter(resource.id).deliver_later! if Rails.env.production?\n   10             sign_in(resource_name, resource)\n   11             if ['true', true].include?(params[:get_token])\n   12               token = resource.generate_authentication_token!\n   13               render json: { id: resource.id, email: resource.email, authentication_token: token }\n</code></pre>\n\n<p>So I looked for the error InvalidPluralizationData and found an answer that explained you need both singular and plural translations.\nSo I changed I tried </p>\n\n<pre><code>activerecord:\n  models:\n    recruiter:\n      terms_and_conditions:\n        one: \"Term and condition singular test\"\n        other: \"Term and conditions plural test\"\n</code></pre>\n\n<p>But the same error still applies with different params:</p>\n\n<h1>I18n::InvalidPluralizationData at /recruiters</h1>\n\n<pre><code>translation data {:company_name=&gt;{:one=&gt;\"Term and condition singular test\", :other=&gt;\"Term and conditions plural test\"}} can not be used with :count =&gt; 1\n</code></pre>\n\n<p>I havent been able to find a suitable solution to also translate these model attributes without breaking the whole form (i'm not able to submit the form even if I try to translate the attributes).</p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["ruby", "activerecord", "sinatra", "sinatra-activerecord"], "comments": [{"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1495025908, "post_id": 44025165, "comment_id": 75077388, "body": "Do you have a join table in your app?"}, {"owner": {"reputation": 679, "user_id": 2988753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/aKneR.jpg?s=128&g=1", "display_name": "AlexLarra", "link": "https://stackoverflow.com/users/2988753/alexlarra"}, "reply_to_user": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1495026120, "post_id": 44025165, "comment_id": 75077570, "body": "No @hashrocket, it has three tables. Neither of them are a join table."}, {"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1495026185, "post_id": 44025165, "comment_id": 75077613, "body": "Do any of your tables contain :null =&gt; false?"}, {"owner": {"reputation": 679, "user_id": 2988753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/aKneR.jpg?s=128&g=1", "display_name": "AlexLarra", "link": "https://stackoverflow.com/users/2988753/alexlarra"}, "reply_to_user": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1495026414, "post_id": 44025165, "comment_id": 75077799, "body": "One, just the column I want to remove in the migration. But the error is of an internal table. We cannot change it."}], "answers": [{"comments": [{"owner": {"reputation": 679, "user_id": 2988753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/aKneR.jpg?s=128&g=1", "display_name": "AlexLarra", "link": "https://stackoverflow.com/users/2988753/alexlarra"}, "edited": false, "score": 0, "creation_date": 1495028284, "post_id": 44025988, "comment_id": 75079342, "body": "It has a default value (false), but it is not that problem. It is in other table."}, {"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "reply_to_user": {"reputation": 679, "user_id": 2988753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/aKneR.jpg?s=128&g=1", "display_name": "AlexLarra", "link": "https://stackoverflow.com/users/2988753/alexlarra"}, "edited": false, "score": 0, "creation_date": 1495028341, "post_id": 44025988, "comment_id": 75079384, "body": "Did you try it?"}, {"owner": {"reputation": 679, "user_id": 2988753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/aKneR.jpg?s=128&g=1", "display_name": "AlexLarra", "link": "https://stackoverflow.com/users/2988753/alexlarra"}, "edited": false, "score": 0, "creation_date": 1495028622, "post_id": 44025988, "comment_id": 75079606, "body": "I remove that column in the migration and it does it well. But it raises an error later for <code>ar_internal_metadata</code> table. It does it with any new migration."}, {"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "reply_to_user": {"reputation": 679, "user_id": 2988753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/aKneR.jpg?s=128&g=1", "display_name": "AlexLarra", "link": "https://stackoverflow.com/users/2988753/alexlarra"}, "edited": false, "score": 0, "creation_date": 1495028738, "post_id": 44025988, "comment_id": 75079700, "body": "Are you trying this in a production environment?"}, {"owner": {"reputation": 679, "user_id": 2988753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/aKneR.jpg?s=128&g=1", "display_name": "AlexLarra", "link": "https://stackoverflow.com/users/2988753/alexlarra"}, "edited": false, "score": 0, "creation_date": 1495028854, "post_id": 44025988, "comment_id": 75079799, "body": "No, in development"}], "tags": [], "owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "is_accepted": false, "score": 0, "last_activity_date": 1495026861, "creation_date": 1495026861, "answer_id": 44025988, "question_id": 44025165, "link": "https://stackoverflow.com/questions/44025165/activerecordnotnullviolation-with-ar-5-1-and-sinatra-2/44025988#44025988", "title": "ActiveRecord::NotNullViolation with AR 5.1 and Sinatra 2", "body": "<p>Change the db column that has <code>:null =&gt; false</code> to <code>:null=&gt; true</code>. </p>\n\n<p>The reason this is happening is because newer versions of MySql turn on \"strict mode\" by default. Any column with :null=> false requires that column to be populated with some kind of data. It seems your is empty, so your getting an error. </p>\n"}], "owner": {"reputation": 679, "user_id": 2988753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/aKneR.jpg?s=128&g=1", "display_name": "AlexLarra", "link": "https://stackoverflow.com/users/2988753/alexlarra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 812, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495026861, "creation_date": 1495024856, "question_id": 44025165, "link": "https://stackoverflow.com/questions/44025165/activerecordnotnullviolation-with-ar-5-1-and-sinatra-2", "title": "ActiveRecord::NotNullViolation with AR 5.1 and Sinatra 2", "body": "<p>we are using:</p>\n\n<pre><code>gem 'sinatra', '~&gt; 2.0.0'\ngem 'activerecord', '~&gt; 5.1.1'\ngem 'sinatra-activerecord', '~&gt; 2.0.13'\n</code></pre>\n\n<p>The thing is that with ActiveRecord 5 we cannot pass a migration:</p>\n\n<pre><code>rake aborted!\nActiveRecord::NotNullViolation: Mysql2::Error: Field 'created_at' doesn't have a default value: INSERT INTO `ar_internal_metadata` (`key`, `value`) VALUES ('environment', 'default_env')\n/home/alex/.rbenv/versions/2.3.0/bin/ruby_executable_hooks:15:in `eval'\n/home/alex/.rbenv/versions/2.3.0/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\nMysql2::Error: Field 'created_at' doesn't have a default value\n/home/alex/.rbenv/versions/2.3.0/bin/ruby_executable_hooks:15:in `eval'\n/home/alex/.rbenv/versions/2.3.0/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\n</code></pre>\n\n<p>AR5 adds a new table called ar_internal_metadata to prevent destructive rakes in production:\n<a href=\"http://blog.bigbinary.com/2016/06/07/rails-5-prevents-destructive-action-on-production-db.html\" rel=\"nofollow noreferrer\">http://blog.bigbinary.com/2016/06/07/rails-5-prevents-destructive-action-on-production-db.html</a></p>\n\n<p>As you can see in logs value is receiving Null and it raises doing the migration pending.</p>\n\n<p>We have tried adding this ENV_VARS but nothing:\n<code>DISABLE_DATABASE_ENVIRONMENT_CHECK=1</code></p>\n\n<p>Can anyone help us with this, please?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "postgresql"], "comments": [{"owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "edited": false, "score": 3, "creation_date": 1495021216, "post_id": 44023307, "comment_id": 75073922, "body": "I am not sure, but have you tried JSON.parse?"}, {"owner": {"reputation": 11075, "user_id": 744346, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4d4016d193e6a2ccf2fef223f7eac9db?s=128&d=identicon&r=PG", "display_name": "MrDanA", "link": "https://stackoverflow.com/users/744346/mrdana"}, "reply_to_user": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "edited": false, "score": 1, "creation_date": 1495025810, "post_id": 44023307, "comment_id": 75077311, "body": "@gates <code>=&gt;</code> is not valid JSON, so it would fail to be parsed as is."}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 1, "creation_date": 1495025948, "post_id": 44023307, "comment_id": 75077419, "body": "Why do you have Ruby code in a jsonb column?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1495029299, "post_id": 44023307, "comment_id": 75080154, "body": "Why do you want to do that? What do you try to achieve?"}, {"owner": {"reputation": 303, "user_id": 6234188, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ee7757cab97d62eef070eb269f3bc96a?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ed7 Ti\u1ebfn", "link": "https://stackoverflow.com/users/6234188/%c4%90%e1%bb%97-ti%e1%ba%bfn"}, "edited": false, "score": 0, "creation_date": 1495029694, "post_id": 44023307, "comment_id": 75080460, "body": "The reason is I want to extract the keys and values of each separate hash in the string."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1495051768, "post_id": 44023307, "comment_id": 75094518, "body": "It looks like you&#39;ve stored the string version of the elements of an array of hashes, instead of doing the right thing and storing the individual values in a separate table, or serializing the data using JSON, and are now painted into a corner. See &quot;<a href=\"https://meta.stackexchange.com/q/66377/153968\">XY Problem</a>&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 6234188, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ee7757cab97d62eef070eb269f3bc96a?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ed7 Ti\u1ebfn", "link": "https://stackoverflow.com/users/6234188/%c4%90%e1%bb%97-ti%e1%ba%bfn"}, "edited": false, "score": 0, "creation_date": 1495095068, "post_id": 44034333, "comment_id": 75110102, "body": "Thank you for your help. I&#39;ve just updated my question. Please take quick look when you have time."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1495056132, "last_edit_date": 1495056132, "creation_date": 1495053298, "answer_id": 44034333, "question_id": 44023307, "link": "https://stackoverflow.com/questions/44023307/regular-expression-to-split-ruby-strings-into-multiple-hashes/44034333#44034333", "title": "Regular expression to split ruby strings into multiple hashes", "body": "<p>It looks like you tried to create your own JSON serializer, instead of using the one that comes with Ruby. Or, perhaps you didn't realize that JSON was a thing and wanted to store arrays of hashes and tried to invent your own. Either way, it wasn't a good path to follow.</p>\n\n<p>This is your definition, which, after being retrieved would remain a String. It appears to be the elements of an Array of Hashes, without the surrounding Array <code>[</code> and <code>]</code>:</p>\n\n<pre><code>foo = \"{\\\"monday\\\"=&gt;\\\"{:start_time=&gt;9.0, :end_time=&gt;10.5}\\\"},{\\\"tuesday\\\"=&gt;\\\"{:start_time=&gt;8.5, :end_time=&gt;10.0}\\\"},{\\\"wednesday\\\"=&gt;\\\"{:start_time=&gt;8.5, :end_time=&gt;10.0}\\\"}\"\n</code></pre>\n\n<p>and it remains a String:</p>\n\n<pre><code>foo.class # =&gt; String\n</code></pre>\n\n<p>It'd be possible to munge it back into a form that could be evaluated and turned back into an Array of Hashes, but it's not straightforward, nor is it clean or convenient or elegant.</p>\n\n<p>I suspect your original object looked like this:</p>\n\n<pre><code>foo = {\"monday\"=&gt;{:start_time=&gt;9.0, :end_time=&gt;10.5}},{\"tuesday\"=&gt;{:start_time=&gt;8.5, :end_time=&gt;10.0}},{\"wednesday\"=&gt;{:start_time=&gt;8.5, :end_time=&gt;10.0}}\n# =&gt; [{\"monday\"=&gt;{:start_time=&gt;9.0, :end_time=&gt;10.5}},\n#     {\"tuesday\"=&gt;{:start_time=&gt;8.5, :end_time=&gt;10.0}},\n#     {\"wednesday\"=&gt;{:start_time=&gt;8.5, :end_time=&gt;10.0}}]\n</code></pre>\n\n<p>which is an Array:</p>\n\n<pre><code>foo.class # =&gt; Array\n</code></pre>\n\n<p>It's an Array now because you have multiple Hash elements separated by commas (<code>,</code>) which Ruby interprets as an Array when assigned to a single variable. This would be a less visually confusing example:</p>\n\n<pre><code>foo = {a: 1}, {a: 2} # =&gt; [{:a=&gt;1}, {:a=&gt;2}]\nfoo.class  # =&gt; Array\nfoo.first.class # =&gt; Hash\n</code></pre>\n\n<p>Back to the Array of Hashes in <code>foo</code>: Starting from that it's easy to let the JSON class serialize it into a string that can be stored in a database, then retrieved and reparsed back into a Ruby object:</p>\n\n<pre><code>require 'json'\nfoo.to_json\n</code></pre>\n\n<p><code>foo.to_json</code> would result in a serialized string that looks like:</p>\n\n<pre><code>[{\"monday\":{\"start_time\":9.0,\"end_time\":10.5}},{\"tuesday\":{\"start_time\":8.5,\"end_time\":10.0}},{\"wednesday\":{\"start_time\":8.5,\"end_time\":10.0}}]\n</code></pre>\n\n<p>And, given that string, JSON can rebuild the object:</p>\n\n<pre><code>bar = JSON.parse(foo.to_json)\n# =&gt; [{\"monday\"=&gt;{\"start_time\"=&gt;9.0, \"end_time\"=&gt;10.5}},\n#     {\"tuesday\"=&gt;{\"start_time\"=&gt;8.5, \"end_time\"=&gt;10.0}},\n#     {\"wednesday\"=&gt;{\"start_time\"=&gt;8.5, \"end_time\"=&gt;10.0}}]\n</code></pre>\n\n<p>Note that it's not necessary to use <code>parse</code> or <code>to_json</code>. The class is smart enough to recognize whether the parameter is a String, or an Array or Hash, and parse or serialize respectively:</p>\n\n<pre><code>JSON[JSON[foo]]\n# =&gt; [{\"monday\"=&gt;{\"start_time\"=&gt;9.0, \"end_time\"=&gt;10.5}},\n#     {\"tuesday\"=&gt;{\"start_time\"=&gt;8.5, \"end_time\"=&gt;10.0}},\n#     {\"wednesday\"=&gt;{\"start_time\"=&gt;8.5, \"end_time\"=&gt;10.0}}]\n</code></pre>\n\n<p>At this point you're prepared to store the values into a String-type field in your database, then retrieve them later and reuse them.</p>\n\n<p>If you are hoping to search or manipulate those stored JSON strings, I'd recommend re-thinking that. While a modern DBM can search inside JSON and generate it, you'd be better off having a separate table of the keys and values. It's faster and more flexible.</p>\n\n<p>Finally to your question, how to convert the string so you can get the keys and values:</p>\n\n<pre><code>foo = \"{\\\"monday\\\"=&gt;\\\"{:start_time=&gt;9.0, :end_time=&gt;10.5}\\\"},{\\\"tuesday\\\"=&gt;\\\"{:start_time=&gt;8.5, :end_time=&gt;10.0}\\\"},{\\\"wednesday\\\"=&gt;\\\"{:start_time=&gt;8.5, :end_time=&gt;10.0}\\\"}\"\nbar = eval('[' + foo.gsub(/\"([{}])/, '\\1') + ']')\nbar\n# =&gt; [{\"monday\"=&gt;{:start_time=&gt;9.0, :end_time=&gt;10.5}},\n#     {\"tuesday\"=&gt;{:start_time=&gt;8.5, :end_time=&gt;10.0}},\n#     {\"wednesday\"=&gt;{:start_time=&gt;8.5, :end_time=&gt;10.0}}]\n\nbar.map { |h| [h.keys, h.values.first.keys] }\n# =&gt; [[[\"monday\"], [:start_time, :end_time]],\n#     [[\"tuesday\"], [:start_time, :end_time]],\n#     [[\"wednesday\"], [:start_time, :end_time]]]\n</code></pre>\n\n<p>This hints that the Array of Hashes wasn't the right structure either. A simple hash would have sufficed:</p>\n\n<pre><code>foo = {\n  \"monday\"=&gt;{:start_time=&gt;9.0, :end_time=&gt;10.5},\n  \"tuesday\"=&gt;{:start_time=&gt;8.5, :end_time=&gt;10.0},\n  \"wednesday\"=&gt;{:start_time=&gt;8.5, :end_time=&gt;10.0}\n}\n\nrequire 'json'\nbar = JSON[JSON[foo]] # imitate a round-trip to/from the DB\nbar.keys # =&gt; [\"monday\", \"tuesday\", \"wednesday\"]\nbar.values # =&gt; [{\"start_time\"=&gt;9.0, \"end_time\"=&gt;10.5}, {\"start_time\"=&gt;8.5, \"end_time\"=&gt;10.0}, {\"start_time\"=&gt;8.5, \"end_time\"=&gt;10.0}]\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 6234188, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ee7757cab97d62eef070eb269f3bc96a?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ed7 Ti\u1ebfn", "link": "https://stackoverflow.com/users/6234188/%c4%90%e1%bb%97-ti%e1%ba%bfn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 44034333, "answer_count": 1, "score": -6, "last_activity_date": 1495092996, "creation_date": 1495019779, "last_edit_date": 1495092996, "question_id": 44023307, "link": "https://stackoverflow.com/questions/44023307/regular-expression-to-split-ruby-strings-into-multiple-hashes", "title": "Regular expression to split ruby strings into multiple hashes", "body": "<p>I have a string like this one in a jsonb column in my Postgresql database:</p>\n\n<pre><code>\"{\\\"monday\\\"=&gt;\\\"{:start_time=&gt;9.0, :end_time=&gt;10.5}\\\"},{\\\"tuesday\\\"=&gt;\\\"{:start_time=&gt;8.5, :end_time=&gt;10.0}\\\"},{\\\"wednesday\\\"=&gt;\\\"{:start_time=&gt;8.5, :end_time=&gt;10.0}\\\"}\"\n</code></pre>\n\n<p>Now I want to use regular expression to make it look like this one:</p>\n\n<pre><code>[{\\\"monday\\\"=&gt;\\\"{:start_time=&gt;9.0, :end_time=&gt;10.5}\\\"}, \n{\\\"tuesday\\\"=&gt;\\\"{:start_time=&gt;8.5, :end_time=&gt;10.0}\\\"},\n{\\\"wednesday\\\"=&gt;\\\"{:start_time=&gt;8.5, :end_time=&gt;10.0}\\\"}\n]\n</code></pre>\n\n<p>I am trying to use the method split with regular expression to accomplish the task. However, I still couldn't figure it out how to split only the commas that are right after the closing curly braces in the string. \nAll I can think of is testing it with the scan method in ruby like this:</p>\n\n<pre><code>test =  \"{\\\"monday\\\"=&gt;\\\"{:start_time=&gt;9.0, :end_time=&gt;10.5}\\\"},{\\\"tuesday\\\"=&gt;\\\"{:start_time=&gt;8.5, :end_time=&gt;10.0}\\\"},{\\\"wednesday\\\"=&gt;\\\"{:start_time=&gt;8.5, :end_time=&gt;10.0}\\\"}\"\nresult = test.scan(/\\\"},/)\n=&gt; result = [\"\\\"},\", \"\\\"},\"]\n</code></pre>\n\n<p>It seems like I am going on the right track, but I am stuck here. Any suggestions would be appreciated.</p>\n\n<p><strong>Update</strong>\nThank you Mr. Tinman for your thoughtful explaination. I changed the database back to hstore, and use JSON.stringify before passing my data to the backend side.  With some twisting here and there, I can finally get the hash I want as you suggested:</p>\n\n<pre><code>{\"monday\"=&gt;{\"start_time\"=&gt;9, \"end_time\"=&gt;10.5}, \"tuesday\"=&gt;{\"start_time\"=&gt;8.5, \"end_time\"=&gt;10}, \"wednesday\"=&gt;{\"start_time\"=&gt;8.5, \"end_time\"=&gt;10}}\n</code></pre>\n\n<p>. However, after saving it to the database, all the values of the hash are serialized as string:</p>\n\n<pre><code>{\n       \"monday\" =&gt; \"{\\\"start_time\\\"=&gt;9, \\\"end_time\\\"=&gt;10.5}\",\n      \"tuesday\" =&gt; \"{\\\"start_time\\\"=&gt;7, \\\"end_time\\\"=&gt;8.5}\",\n    \"wednesday\" =&gt; \"{\\\"start_time\\\"=&gt;7, \\\"end_time\\\"=&gt;8.5}\"\n}\n</code></pre>\n\n<p>I know I can convert them back to hashes by using eval. However, are there any ways for me save those values as hashes also in the database or I can't because of Hstore mechanism? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sunspot", "sunspot-rails", "sunspot-solr"], "answers": [{"tags": [], "owner": {"reputation": 1489, "user_id": 7948068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71dc87adc38b9813f2fc7db09aea190?s=128&d=identicon&r=PG&f=1", "display_name": "Kathryn", "link": "https://stackoverflow.com/users/7948068/kathryn"}, "is_accepted": false, "score": 1, "last_activity_date": 1497521849, "creation_date": 1497521849, "answer_id": 44564909, "question_id": 44021926, "link": "https://stackoverflow.com/questions/44021926/sunspot-gem-using-in-sti-table/44564909#44564909", "title": "Sunspot Gem Using in STI TABLE", "body": "<p>According to <a href=\"https://github.com/sunspot/sunspot#reindexing-objects\" rel=\"nofollow noreferrer\">the documentation</a>, objects will be indexed automatically if you are on Rails. But it also mentions you can reindex a class manually:</p>\n\n<pre><code>Account.reindex\nSunspot.commit\n</code></pre>\n\n<p>It also suggests using <code>Sunspot.index</code> on individual objects.</p>\n"}, {"tags": [], "owner": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "is_accepted": false, "score": 4, "last_activity_date": 1497787292, "last_edit_date": 1497787292, "creation_date": 1497761868, "answer_id": 44611856, "question_id": 44021926, "link": "https://stackoverflow.com/questions/44021926/sunspot-gem-using-in-sti-table/44611856#44611856", "title": "Sunspot Gem Using in STI TABLE", "body": "<blockquote>\n  <p>sql will run Two Insert one for Account model and one for Asset Table  </p>\n</blockquote>\n\n<p>FYI you use STI when you want to share same database table between multiple models because they are similar in attributes and behavior. Like <code>AdminUser</code> model is likely to have almost same attributes/columns as <code>PublisherUser</code> or <code>ReaderUser</code>. Therefore you might wish to have a common table called <code>users</code> or model <code>User</code> and share this table among the above mentioned models.</p>\n\n<p><strong>Point</strong> is: ActiveRecord will run a single SQL query not two, like:</p>\n\n<pre><code>INSERT INTO \"accounts\" (\"name\", \"code\", \"type\") VALUES ('test123', 'test123', 'Asset')\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>my question is how can i reindex my model when i update. with a particular data. i can do Sunspot.reindex but this is will load all data in my sql. that will cause me to slow</p>\n</blockquote>\n\n<p>Actually <code>sunspot_rails</code> is designed to auto-reindex whenever you make changes to your model/record. It listens to the <code>save</code> <a href=\"http://guides.rubyonrails.org/active_record_callbacks.html#available-callbacks\" rel=\"nofollow noreferrer\">callbacks</a>.</p>\n\n<p>But you need to make sure that you are not using methods like <code>update_column(s)</code>. <a href=\"http://www.davidverhasselt.com/set-attributes-in-activerecord#cheat-sheet\" rel=\"nofollow noreferrer\">See the list of silent create/update methods which do not trigger callbacks and validations at all</a>.</p>\n\n<hr>\n\n<p>In addition, you need to understand the concept of <code>batch size</code> in terms of Solr. For performance reasons, all of your new indexes are not immediately committed. <strong>Committed</strong> means, writing indexes to database like in RDBMS commits. </p>\n\n<p>By default the <code>batch_size</code> for commits is <strong>50</strong>. Meaning after 50 <code>index</code> method executions only the indexes will be committed and you will be able to search the records. To change it, use following </p>\n\n<pre><code># in config/initializers/sunspot_config.rb\nSunspot.config.indexing.default_batch_size = 1 # or any number\n</code></pre>\n\n<p>or</p>\n\n<pre><code># in models; its not considered good though\nafter_commit do\n  Sunspot.commit\nend\n</code></pre>\n\n<hr>\n\n<p>For manual re-indexing, you can use like <a href=\"https://stackoverflow.com/a/44564909/3437900\">@Kathryn</a> suggested. </p>\n\n<p>But, I don't think you need to intervene in the auto-operation. I think you were not seeing immediate results so you were worrying.</p>\n"}, {"comments": [{"owner": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "edited": false, "score": 0, "creation_date": 1497851338, "post_id": 44620732, "comment_id": 76231735, "body": "regarding indexing, its handled properly automatically by <code>sunspot</code>. only thing you are advised to do manually is &quot;Commit&quot;."}, {"owner": {"reputation": 83, "user_id": 4282244, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9d8545d620a27003a570b704c36a86df?s=128&d=identicon&r=PG&f=1", "display_name": "Deez Nuuts", "link": "https://stackoverflow.com/users/4282244/deez-nuuts"}, "reply_to_user": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "edited": false, "score": 0, "creation_date": 1497858007, "post_id": 44620732, "comment_id": 76235150, "body": "commit are for add , delete and edit my only problem is to edit"}, {"owner": {"reputation": 83, "user_id": 4282244, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9d8545d620a27003a570b704c36a86df?s=128&d=identicon&r=PG&f=1", "display_name": "Deez Nuuts", "link": "https://stackoverflow.com/users/4282244/deez-nuuts"}, "reply_to_user": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "edited": false, "score": 0, "creation_date": 1497858249, "post_id": 44620732, "comment_id": 76235282, "body": "its weird why i got a problem in editing when i use STI but its ok now"}], "tags": [], "owner": {"reputation": 83, "user_id": 4282244, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9d8545d620a27003a570b704c36a86df?s=128&d=identicon&r=PG&f=1", "display_name": "Deez Nuuts", "link": "https://stackoverflow.com/users/4282244/deez-nuuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1497831620, "creation_date": 1497831620, "answer_id": 44620732, "question_id": 44021926, "link": "https://stackoverflow.com/questions/44021926/sunspot-gem-using-in-sti-table/44620732#44620732", "title": "Sunspot Gem Using in STI TABLE", "body": "<p>i put this to my model </p>\n\n<pre><code> after_update do\n  Sunspot.index Account.where(id: self.id)\nend\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 4282244, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9d8545d620a27003a570b704c36a86df?s=128&d=identicon&r=PG&f=1", "display_name": "Deez Nuuts", "link": "https://stackoverflow.com/users/4282244/deez-nuuts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 44620732, "answer_count": 3, "score": 2, "last_activity_date": 1497831620, "creation_date": 1495015933, "last_edit_date": 1497759013, "question_id": 44021926, "link": "https://stackoverflow.com/questions/44021926/sunspot-gem-using-in-sti-table", "title": "Sunspot Gem Using in STI TABLE", "body": "<p>i have <code>Account</code> Model,<code>Asset</code>, <code>Capital</code> and <code>Revenue</code> this table are all inherited in my <code>Account</code> model. i have 3 kind of attributes in my Account model. name, code and type. when i create an account where will be to insert will happen one in my account and the other one is in my type for example </p>\n\n<pre><code>Account.create(name: \"test123\", code:\"test123\", type:\"Asset\")\n</code></pre>\n\n<p>sql will run Two Insert one for Account model and one for Asset Table</p>\n\n<p>and my sunspot work well it will <strong>reindex</strong> my database and i can search my params</p>\n\n<p>but when i update my model Account my sql run one insert and one update</p>\n\n<p>my question is how can i reindex my model when i update. with a particular data. i can do <code>Sunspot.reindex</code> but this is will load all data in my sql. that will cause me to slow</p>\n"}, {"tags": ["ruby", "google-drive-api"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495016066, "post_id": 44021544, "comment_id": 75070493, "body": "How is the code being called? Can you provide a <i>reproducible</i> example?"}, {"owner": {"reputation": 403, "user_id": 6227057, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e899d21cb72710b518e844a244e410a?s=128&d=identicon&r=PG", "display_name": "Ernesto G", "link": "https://stackoverflow.com/users/6227057/ernesto-g"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495024895, "post_id": 44021544, "comment_id": 75076547, "body": "Sure, this is the full script in gist: <a href=\"https://gist.github.com/EGimenoS/0f3ab2fdb82a74807f2c941a4c640a05\" rel=\"nofollow noreferrer\">gist.github.com/EGimenoS/0f3ab2fdb82a74807f2c941a4c640a05</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495025027, "post_id": 44021544, "comment_id": 75076657, "body": "Can you please <a href=\"http://stackoverflow.com/posts/44021544/edit\">edit your post</a> and provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. Linking to gists is not encouraged, as that link may not be accessible for future readers - it&#39;s better to copy+paste all relevant code into the body of your post."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495025319, "post_id": 44021544, "comment_id": 75076903, "body": "It would also be much easier to understand that code if the methods/variables were written in English. StackOverflow <a href=\"https://stackoverflow.blog/2009/07/23/non-english-question-policy/\">is an English site</a>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495025478, "post_id": 44021544, "comment_id": 75077033, "body": "(Because it&#39;s not English, I only semi-understand that code ... but surely the problem has obviously got something to do with the fact that you&#39;re calling the method twice, as I suspected! <code>subir_lote(1); subir_lote(5)</code>)"}, {"owner": {"reputation": 403, "user_id": 6227057, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e899d21cb72710b518e844a244e410a?s=128&d=identicon&r=PG", "display_name": "Ernesto G", "link": "https://stackoverflow.com/users/6227057/ernesto-g"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495028289, "post_id": 44021544, "comment_id": 75079344, "body": "Sure, I will fix it right away. Tom, the problem is not related to calling the method twice. This is because I have two subfolders, so I have to run twice but writing in different folders. The porblem is that every file gets uploaded to the folder I want (&quot;1&quot; or &quot;5&quot;) but they also gets uploaded to the root"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495029633, "post_id": 44021544, "comment_id": 75080412, "body": "Are you saying that simply writing:  <code>folder.add(@session.upload_from_file(ruta, file, convert: false))</code> uploads the file twice, to two locations? I haven&#39;t bothered to try, because I highly doubt that .... Can you please confirm exactly what behaviour you are seeing from a <b>minimal</b> code example?"}, {"owner": {"reputation": 403, "user_id": 6227057, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e899d21cb72710b518e844a244e410a?s=128&d=identicon&r=PG", "display_name": "Ernesto G", "link": "https://stackoverflow.com/users/6227057/ernesto-g"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495030973, "post_id": 44021544, "comment_id": 75081461, "body": "Exactly Tom, is this particular line of code. I have just run the script again now and I&#39;m just seeing how this happens as the files get uploaded."}, {"owner": {"reputation": 18863, "user_id": 1000753, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/23634e7a38e353cca12bb72a4205615b?s=128&d=identicon&r=PG", "display_name": "pinoyyid", "link": "https://stackoverflow.com/users/1000753/pinoyyid"}, "edited": false, "score": 2, "creation_date": 1495034414, "post_id": 44021544, "comment_id": 75084228, "body": "are you sure the file is uploaded twice vs being uploaded to both parents (1 and root). Check the file ids"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 12070054, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u7SRMcwnkJI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reWPugfiTR3garhloctH93uRgdThQ/photo.jpg?sz=128", "display_name": "Rostislav Ruban", "link": "https://stackoverflow.com/users/12070054/rostislav-ruban"}, "edited": false, "score": 0, "creation_date": 1583148908, "post_id": 44042078, "comment_id": 107006673, "body": "2020 and the answer still actual."}], "tags": [], "owner": {"reputation": 403, "user_id": 6227057, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e899d21cb72710b518e844a244e410a?s=128&d=identicon&r=PG", "display_name": "Ernesto G", "link": "https://stackoverflow.com/users/6227057/ernesto-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1495095018, "creation_date": 1495095018, "answer_id": 44042078, "question_id": 44021544, "link": "https://stackoverflow.com/questions/44021544/google-drive-ruby-upload-file-to-a-folder-duplicates-the-file-in-the-folder-and/44042078#44042078", "title": "google-drive-ruby: upload file to a folder duplicates the file in the folder and root path", "body": "<p>I received an answer from the gem creator explaining what is happening and my script is finally working as I expected.</p>\n\n<p><a href=\"https://github.com/gimite/google-drive-ruby/issues/260\" rel=\"nofollow noreferrer\">https://github.com/gimite/google-drive-ruby/issues/260</a></p>\n\n<p>The thing is that the file is firstly uploaded to the root by default and then .add just moves the file to the selected collection, so the file needs to be removed from root after the move operation is completed.</p>\n\n<pre><code>@session.root_collection.remove(file)\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 6227057, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e899d21cb72710b518e844a244e410a?s=128&d=identicon&r=PG", "display_name": "Ernesto G", "link": "https://stackoverflow.com/users/6227057/ernesto-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 44042078, "answer_count": 1, "score": 2, "last_activity_date": 1495095018, "creation_date": 1495015038, "last_edit_date": 1495028510, "question_id": 44021544, "link": "https://stackoverflow.com/questions/44021544/google-drive-ruby-upload-file-to-a-folder-duplicates-the-file-in-the-folder-and", "title": "google-drive-ruby: upload file to a folder duplicates the file in the folder and root path", "body": "<p>I have writen a Ruby script to lookup for documents with a given date and upload them to Google Drive by using the google-drive-ruby gem. I have a folder inside of the gdrive root path where I want to place the files, and I access it using collection_by_title and then uploading the file by using the .add method. </p>\n\n<p>The problem is that the files are being uploaded each one two times, one to the folder I want and another one to the root path of my GDrive. Any thoughts?</p>\n\n<p>This is the method where the file gets uploaded:</p>\n\n<pre><code>def upload_document(file, folder_code)\n  folder = @session.collection_by_title(\"#{folder_code}\")\n  path = \"#{@basedir}/#{folder_code}/#{file}\"\n  folder.add(@session.upload_from_file(path, file, convert: false)) \nend\n</code></pre>\n\n<p>EDIT: Methods and variables translated to english.</p>\n\n<p>Each time the method upload_document is triggered, one copy of the file gets uploaded to the folder and another copy gets uploaded to the root path of gdrive.</p>\n\n<p>Example: Method upload_document gets called providing the file (454327.pdf) and the code of the folder where it has to be uploaded in gdrive (\"1\"). I build the folder object by using collection_by_title, I build the path where the file is located in my local network, and finally the file gets uploaded using upload_from_file. At this point, two copies of the file had been uploaded, one to the root path of gdrive (which I don't want) and another one to the right folder in gdrive.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1495016306, "post_id": 44021296, "comment_id": 75070641, "body": "It looks like you&#39;re trying to use a <i>class</i> instance variable here, for <code>@permissions</code> -- so should that not be: <code>self.class.instance_variable_get(:@permissions)</code>?"}, {"owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495016355, "post_id": 44021296, "comment_id": 75070671, "body": "as I thought! see my edit, wdyt?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1495016437, "post_id": 44021296, "comment_id": 75070731, "body": "My only other key thought is: Why are you using <code>instance_variable_set</code> here? You could have just written: <code>@permissions = permissions</code>, no? Other than that, LGTM."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1495016647, "post_id": 44021296, "comment_id": 75070854, "body": "@TomLord: and then maybe define a reader, so that there&#39;s no need for <code>instance_variable_get</code> too."}, {"owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1495016856, "post_id": 44021296, "comment_id": 75071011, "body": "@SergioTulentsev where exactly?"}, {"owner": {"reputation": 46, "user_id": 8018795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd735baf0e0ea446f3ffaa97a4427215?s=128&d=identicon&r=PG&f=1", "display_name": "user8018795", "link": "https://stackoverflow.com/users/8018795/user8018795"}, "edited": false, "score": 0, "creation_date": 1495018737, "post_id": 44021296, "comment_id": 75072220, "body": "Why don&#39;t use <code>@@a_class_variable</code> for class variables?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 46, "user_id": 8018795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd735baf0e0ea446f3ffaa97a4427215?s=128&d=identicon&r=PG&f=1", "display_name": "user8018795", "link": "https://stackoverflow.com/users/8018795/user8018795"}, "edited": false, "score": 1, "creation_date": 1495019442, "post_id": 44021296, "comment_id": 75072631, "body": "@user8018795 e.g. because class variables are shared between the classes hierarchy tree (and have many other drawbacks.)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 46, "user_id": 8018795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd735baf0e0ea446f3ffaa97a4427215?s=128&d=identicon&r=PG&f=1", "display_name": "user8018795", "link": "https://stackoverflow.com/users/8018795/user8018795"}, "edited": false, "score": 0, "creation_date": 1495019528, "post_id": 44021296, "comment_id": 75072684, "body": "@user8018795 You could do... But class variables in ruby have several &quot;strange&quot; behaviours. It&#39;s generally advisable to use class <i>instance</i> variables instead, which is what has been done above."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1495019688, "post_id": 44023175, "comment_id": 75072804, "body": "Its usage will look ugly, in a target class. Better to use the getter-slash-setter idiom (IMHO)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1495019781, "post_id": 44023175, "comment_id": 75072871, "body": "@SergioTulentsev the above is the getter/setter idiom, isn\u2019t it?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1495019812, "post_id": 44023175, "comment_id": 75072890, "body": "Nah. I meant one method that does both. Depending on whether you pass it an argument or not"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1495019935, "post_id": 44023175, "comment_id": 75072975, "body": "@SergioTulentsev it\u2019s impossible to empty the permissions with that approach if splatted parameters are allowed."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1495019999, "post_id": 44023175, "comment_id": 75073033, "body": "I&#39;d argue that this is not a concern at all. Permissions are always set, never changed/emptied. This kind of DSL is quite common."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1495019380, "creation_date": 1495019380, "answer_id": 44023175, "question_id": 44021296, "link": "https://stackoverflow.com/questions/44021296/access-instance-variable-defined-in-classmethod/44023175#44023175", "title": "access instance variable defined in ClassMethod", "body": "<pre><code>module BackofficeAuthenticator\n  module ClassMethods\n    def permissions=(*permissions)\n      @permissions = permissions\n    end\n    def permissions\n      @permissions || [] \n    end\n  end\n\n  def self.included base\n    base.extend ClassMethods\n  end\n\n  def authenticate_agent\n    raise NotAllowed if self.class.permissions.include?(agent_permissions)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495019380, "creation_date": 1495014521, "last_edit_date": 1495016324, "question_id": 44021296, "link": "https://stackoverflow.com/questions/44021296/access-instance-variable-defined-in-classmethod", "title": "access instance variable defined in ClassMethod", "body": "<p>I have a controller where I'd like to define a specific list of permissions, like this:</p>\n\n<pre><code>class Backoffice::OrdersController &lt; ApiController\n  include BackofficeAuthenticator\n  before_action :authenticate_agent\n  permissions :admin, :tech_god\n</code></pre>\n\n<p>I created this method <code>permission</code> on <code>BackofficeAuthenticator</code>:</p>\n\n<pre><code>module BackofficeAuthenticator\n  extend ActiveSupport::Concern\n\n  module ClassMethods\n    def permissions(*permissions)\n      instance_variable_set(:@permissions, permissions)\n    end\n  end\n\ndef authenticate_agent\n    raise MissingAccessToken if token.blank?\n    @decoded_payload = JWT.decode(token, JWT_SECRET, true, algorithm: 'HS256').first\n    if instance_variable_get(:@permissions).present?\n      raise NotAllowed if @permissions.include? agent_permissions\n    end\n  end\n</code></pre>\n\n<p>but when I try to read this variable as above (<code>instance_variable_get(:@permissions).present?</code>)  I get <code>nil</code>. \nMy question is: how can I define the permissions on the controller as I want and access these values on the authenticator module?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I <em>kinda</em> get it, as following: </p>\n\n<pre><code>module ClassMethods\n  def permissions(*permissions)\n    instance_variable_set(:@defined_permissions, permissions)\n  end\nend\n</code></pre>\n\n<p>and </p>\n\n<pre><code>def authenticate_agent\n    raise MissingAccessToken if token.blank?\n    @decoded_payload = JWT.decode(token, JWT_SECRET, true, algorithm: 'HS256').first\n    defined_permissions = self.class.instance_variable_get(:@defined_permissions)\n</code></pre>\n\n<p>at this point, <code>defined_permissions</code> has the values set before, but I'm not really sure if it is right to do this way.</p>\n\n<p>I also added <code>base.extend ClassMethods</code> on the end of <code>included do |base|</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "security", "rack", "rackattack"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1495010004, "post_id": 44018724, "comment_id": 75066151, "body": "<code>Rack::Attack</code> is normally used for <i>throttling high-volume requests</i>; I would consider rules like &quot;3 failed attempts = 4 sec delay&quot; to be way too strict. Have a read through the <a href=\"https://github.com/kickstarter/rack-attack/wiki/Example-Configuration\" rel=\"nofollow noreferrer\">example configurations</a>. I believe what you&#39;re really trying to achieve here would be better done with an <a href=\"https://github.com/kickstarter/rack-attack/wiki/Advanced-Configuration#exponential-backoff\" rel=\"nofollow noreferrer\">exponential backoff</a>."}, {"owner": {"reputation": 1826, "user_id": 185027, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8865c2bdaf725c5ac24fbe34ea97c945?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob", "link": "https://stackoverflow.com/users/185027/jacob"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495031773, "post_id": 44018724, "comment_id": 75082144, "body": "Hey @TomLord, thanks very much for your feedback. I have the same feeling about that being too strict. Anyway, I did read the example configurations, but that exponential backoff leaves me with the same question. In this case, we still have a throttling over a resource (the login) but the system wouldn&#39;t penalize especially those failing, which I understand is the intent of the technique described in the guide."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1495033059, "post_id": 44018724, "comment_id": 75083193, "body": "You could use <code>blacklist</code> instead of <code>throttle</code>, with pretty much the same code as in that example... I&#39;ve used precisely this technique in a production application before (including tests to ensure it does work). If it helps, I could dig out this code and paste it below?"}, {"owner": {"reputation": 1826, "user_id": 185027, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8865c2bdaf725c5ac24fbe34ea97c945?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob", "link": "https://stackoverflow.com/users/185027/jacob"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495037551, "post_id": 44018724, "comment_id": 75086470, "body": "If you can, I think it&#39;d be a great example :)"}], "answers": [{"comments": [{"owner": {"reputation": 266, "user_id": 4496274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OyQ-1B1uLVg/AAAAAAAAAAI/AAAAAAAAAAA/bkOJk27Y1Tw/photo.jpg?sz=128", "display_name": "curtp", "link": "https://stackoverflow.com/users/4496274/curtp"}, "edited": false, "score": 0, "creation_date": 1533741348, "post_id": 44086388, "comment_id": 90460132, "body": "Thanks for posting this!!  We&#39;re exploring this as an option for protecting our login post action.  One concern we have is with NAT addresses, where lots of people share the same address.  Our use case will have possibly 100&#39;s of people with the same address logging into the app in quick succession, then logins will tail off as the day progresses.  Have you tested this configuration with such a use case?    I&#39;ve considered reversing the ban time logic so the smaller findtime windows will be banned for longer and the band time will decrease as the findtime window grows."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 266, "user_id": 4496274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OyQ-1B1uLVg/AAAAAAAAAAI/AAAAAAAAAAA/bkOJk27Y1Tw/photo.jpg?sz=128", "display_name": "curtp", "link": "https://stackoverflow.com/users/4496274/curtp"}, "edited": false, "score": 0, "creation_date": 1533748671, "post_id": 44086388, "comment_id": 90464346, "body": "@curtp In my specific use case above, I didn&#39;t need to account for that - but I&#39;m well aware of the issue, which is why I wrote <i>&quot;You may wish to tweak those numbers as desired for your particular application&quot;</i> :)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 266, "user_id": 4496274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OyQ-1B1uLVg/AAAAAAAAAAI/AAAAAAAAAAA/bkOJk27Y1Tw/photo.jpg?sz=128", "display_name": "curtp", "link": "https://stackoverflow.com/users/4496274/curtp"}, "edited": false, "score": 0, "creation_date": 1533748812, "post_id": 44086388, "comment_id": 90464417, "body": "@curtp Something you could consider, if possible, is to establish different rules for different IP address (ranges?) - i.e. relax the throttling for known IPs, or even during during different times of day. I know of other companies that do this in schools, for example - where the rate limiting is less relaxed from a school&#39;s IP during school hours."}, {"owner": {"reputation": 266, "user_id": 4496274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OyQ-1B1uLVg/AAAAAAAAAAI/AAAAAAAAAAA/bkOJk27Y1Tw/photo.jpg?sz=128", "display_name": "curtp", "link": "https://stackoverflow.com/users/4496274/curtp"}, "edited": false, "score": 0, "creation_date": 1533750240, "post_id": 44086388, "comment_id": 90465187, "body": "Yeah, we&#39;ve been playing around with different numbers to see if we can find something that will work for most of our scenarios.  Again, thanks for posting this solution!"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 4, "last_activity_date": 1495287791, "last_edit_date": 1495287791, "creation_date": 1495286537, "answer_id": 44086388, "question_id": 44018724, "link": "https://stackoverflow.com/questions/44018724/preventing-rapid-fire-login-attempts-with-rackattack/44086388#44086388", "title": "Preventing rapid-fire login attempts with Rack::Attack", "body": "<p>Sorry for the delay in getting back to you; it took me a while to dig out my old code relating to this.</p>\n\n<p>As discussed in the comments above, here is a solution using a <code>blacklist</code>, with a <code>findtime</code></p>\n\n<pre><code># config/initilizers/rack-attack.rb\nclass Rack::Attack\n  (1..6).each do |level| \n    blocklist(\"allow2ban login scrapers - level #{level}\") do |req| \n      Allow2Ban.filter( \n        req.ip, \n        maxretry: (20 * level), \n        findtime: (8**level).seconds, \n        bantime: (8**level).seconds \n      ) do \n        req.path == '/users/sign_in' &amp;&amp; req.post? \n      end \n    end \n  end\nend\n</code></pre>\n\n<p>You may wish to tweak those numbers as desired for your particular application; the figures above are only what I decided as 'sensible' for my particular application - they do not come from any official standard.</p>\n\n<p>One issue with using the above that when developing/testing (e.g. your <code>rspec</code> test suite) the application, you can easily hit the above limits and inadvertently throttle <em>yourself</em>. This can be avoided by adding the following config  to the initializer:</p>\n\n<pre><code>safelist('allow from localhost') do |req|\n  '127.0.0.1' == req.ip || '::1' == req.ip\nend\n</code></pre>\n\n<p>The most common brute-force login attack is a brute-force password attack where an attacker simply tries a large number of emails and passwords to see if any credentials match.</p>\n\n<p>You should mitigate this in the application by use of an account LOCK after a few failed login attempts. (For example, if using <code>devise</code> then there is a built-in <a href=\"http://www.rubydoc.info/github/plataformatec/devise/Devise/Models/Lockable\" rel=\"nofollow noreferrer\"><code>Lockable</code> module</a> that you can make use of.)</p>\n\n<p>However, this account-locking approach opens a new attack vector: An attacker can spam the system with login attempts, using valid emails and incorrect passwords, to continuously re-lock all accounts!</p>\n\n<p>This configuration helps mitigate that attack vector, by <em>exponentially</em> limiting the number of sign-in attempts from a given IP.</p>\n\n<p>I also added the following \"catch-all\" request throttle:</p>\n\n<pre><code>throttle('req/ip', limit: 300, period: 5.minutes, &amp;:ip)\n</code></pre>\n\n<p>This is primarily to throttle malicious/poorly configured scrapers; to prevent them from hogging all of the app server's CPU.</p>\n\n<p>Note: If you're serving assets through rack, those requests may be counted by rack-attack and this throttle may be activated too quickly. If so, enable the condition to exclude them from tracking.</p>\n\n<hr>\n\n<p>I also wrote an integration test to ensure that my <code>Rack::Attack</code> configuration was doing its job. There were a few challenges in making this test work, so I'll let the code+comments speak for itself:</p>\n\n<pre><code>class Rack::AttackTest &lt; ActionDispatch::IntegrationTest \n  setup do \n    # Prevent subtle timing issues (==&gt; intermittant test failures) \n    # when the HTTP requests span across multiple seconds \n    # by FREEZING TIME(!!) for the duration of the test \n    travel_to(Time.now) \n\n    @removed_safelist = Rack::Attack.safelists.delete('allow from localhost') \n    # Clear the Rack::Attack cache, to prevent test failure when \n    # running multiple times in quick succession. \n    # \n    # First, un-ban localhost, in case it is already banned after a previous test: \n    (1..6).each do |level| \n      Rack::Attack::Allow2Ban.reset('127.0.0.1', findtime: (8**level).seconds) \n    end \n    # Then, clear the 300-request rate limiter cache: \n    Rack::Attack.cache.delete(\"#{Time.now.to_i / 5.minutes}:req/ip:127.0.0.1\") \n  end \n\n  teardown do \n    travel_back # Un-freeze time \n    Rack::Attack.safelists['allow from localhost'] = @removed_safelist \n  end \n\n  test 'should block access on 20th successive /users/sign_in attempt' do \n    19.times do |i| \n      post user_session_url \n      assert_response :success, \"was not even allowed to TRY to login on attempt number #{i + 1}\" \n    end \n\n    # For DOS protection: Don't even let the user TRY to login; they're going way too fast. \n    # Rack::Attack returns 403 for blocklists by default, but this can be reconfigured: \n    # https://github.com/kickstarter/rack-attack/blob/master/README.md#responses \n    post user_session_url \n    assert_response :forbidden, 'login access should be blocked upon 20 successive attempts' \n  end \nend\n</code></pre>\n"}], "owner": {"reputation": 1826, "user_id": 185027, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8865c2bdaf725c5ac24fbe34ea97c945?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob", "link": "https://stackoverflow.com/users/185027/jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1355, "favorite_count": 1, "accepted_answer_id": 44086388, "answer_count": 1, "score": 1, "last_activity_date": 1495287791, "creation_date": 1495007509, "last_edit_date": 1495541906, "question_id": 44018724, "link": "https://stackoverflow.com/questions/44018724/preventing-rapid-fire-login-attempts-with-rackattack", "title": "Preventing rapid-fire login attempts with Rack::Attack", "body": "<p>We have been reading the <a href=\"https://stackoverflow.com/questions/549/the-definitive-guide-to-form-based-website-authentication#477579\">Definitive guide to form based website authentication</a> with the intention of preventing rapid-fire login attempts.</p>\n\n<p>One example of this could be:</p>\n\n<ul>\n<li>1 failed attempt = no delay</li>\n<li>2 failed attempts = 2 sec delay</li>\n<li>3 failed attempts = 4 sec delay</li>\n<li>etc</li>\n</ul>\n\n<p>Other methods appear in the guide, but they all require a storage capable of recording previous failed attempts.</p>\n\n<p>Blocklisting is discussed in one of the posts in <a href=\"https://github.com/kickstarter/rack-attack/pull/90\" rel=\"nofollow noreferrer\">this issue</a> (appears under the old name blacklisting that was changed in the documentation to blocklisting) as a possible solution. </p>\n\n<p>As per Rack::Attack specifically, one naive example of implementation could be:</p>\n\n<p>Where the login fails:</p>\n\n<pre><code>StorageMechanism.increment(\"bad-login/#{req.ip\")\n</code></pre>\n\n<p>In the rack-attack.rb:</p>\n\n<pre><code>Rack::Attack.blacklist('bad-logins') { |req|\n    StorageMechanism.get(\"bad-login/#{req.ip}\")\n}\n</code></pre>\n\n<p>There are two parts here, returning the response if it is blocklisted and check if a previous failed attempt happened (StorageMechanism).</p>\n\n<p>The first part, returning the response, can be handled automatically by the gem. However, I don't see so clear the second part, at least with the de-facto choice for cache backend for the gem and Rails world, Redis.</p>\n\n<p>As far as I know, the expired keys in Redis are automatically removed. That would make impossible to access the information (even if expired), set a new value for the counter and increment accordingly the timeout for the refractory period.</p>\n\n<p>Is there any way to achieve this with Redis and Rack::Attack?</p>\n\n<p>I was thinking that maybe the 'StorageMechanism' has to remain absolutely agnostic in this case and know nothing about Rack::Attack and its storage choices.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "fullcalendar"], "comments": [{"owner": {"reputation": 2375, "user_id": 2519373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64c8f28fe60aacbed60e4adaf301599?s=128&d=identicon&r=PG", "display_name": "tsayen", "link": "https://stackoverflow.com/users/2519373/tsayen"}, "edited": false, "score": 0, "creation_date": 1495008347, "post_id": 44018587, "comment_id": 75065066, "body": "you might want to look <a href=\"https://github.com/bokmann/fullcalendar-rails/issues/64\" rel=\"nofollow noreferrer\">at this bug report</a>"}, {"owner": {"reputation": 2062, "user_id": 4896126, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/aUY9T.png?s=128&g=1", "display_name": "Marcos R. Guevara", "link": "https://stackoverflow.com/users/4896126/marcos-r-guevara"}, "edited": false, "score": 0, "creation_date": 1495010559, "post_id": 44018587, "comment_id": 75066601, "body": "show us your files"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 2375, "user_id": 2519373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64c8f28fe60aacbed60e4adaf301599?s=128&d=identicon&r=PG", "display_name": "tsayen", "link": "https://stackoverflow.com/users/2519373/tsayen"}, "edited": false, "score": 0, "creation_date": 1495010593, "post_id": 44018587, "comment_id": 75066628, "body": "@tsayen good catch! You may want to write this as an answer, specifically vital-edu&#39;s comment about what&#39;s needed in app/assets/javascripts/application.js"}, {"owner": {"reputation": 105, "user_id": 5654472, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cDVkM.jpg?s=128&g=1", "display_name": "msayen", "link": "https://stackoverflow.com/users/5654472/msayen"}, "reply_to_user": {"reputation": 2062, "user_id": 4896126, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/aUY9T.png?s=128&g=1", "display_name": "Marcos R. Guevara", "link": "https://stackoverflow.com/users/4896126/marcos-r-guevara"}, "edited": false, "score": 0, "creation_date": 1495011305, "post_id": 44018587, "comment_id": 75067155, "body": "I&#39;ve implemented what vital-edu said and it does not work still. @MarcosR.Guevara - files added above."}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 5654472, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cDVkM.jpg?s=128&g=1", "display_name": "msayen", "link": "https://stackoverflow.com/users/5654472/msayen"}, "is_accepted": false, "score": 1, "last_activity_date": 1495023346, "last_edit_date": 1495023346, "creation_date": 1495015718, "answer_id": 44021841, "question_id": 44018587, "link": "https://stackoverflow.com/questions/44018587/how-to-start-with-fullcalendar-rails-gem-in-ruby-on-rails-app/44021841#44021841", "title": "How to start with fullcalendar-rails gem in Ruby on Rails app?", "body": "<p>And here goes the answer:</p>\n\n<pre><code>$(document).ready(function() {\n    $('#calendar').fullCalendar({})\n});\n</code></pre>\n\n<p>full<strong>C</strong>alendar, not full<strong>c</strong>alendar.</p>\n\n<p>Maybe there was a change in the lib in the meantime.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 1648019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V903t.jpg?s=128&g=1", "display_name": "dkang", "link": "https://stackoverflow.com/users/1648019/dkang"}, "is_accepted": false, "score": 2, "last_activity_date": 1495019477, "last_edit_date": 1495542383, "creation_date": 1495019477, "answer_id": 44023206, "question_id": 44018587, "link": "https://stackoverflow.com/questions/44018587/how-to-start-with-fullcalendar-rails-gem-in-ruby-on-rails-app/44023206#44023206", "title": "How to start with fullcalendar-rails gem in Ruby on Rails app?", "body": "<p>Apart from <a href=\"https://stackoverflow.com/a/44021841/1648019\">https://stackoverflow.com/a/44021841/1648019</a>, that is correct.\nIf you are using application.scss, you should use <code>@import 'fullcalendar'</code> instead of <code>*= require fullcalendar</code></p>\n"}], "owner": {"reputation": 105, "user_id": 5654472, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cDVkM.jpg?s=128&g=1", "display_name": "msayen", "link": "https://stackoverflow.com/users/5654472/msayen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1495023346, "creation_date": 1495007083, "last_edit_date": 1495011467, "question_id": 44018587, "link": "https://stackoverflow.com/questions/44018587/how-to-start-with-fullcalendar-rails-gem-in-ruby-on-rails-app", "title": "How to start with fullcalendar-rails gem in Ruby on Rails app?", "body": "<p>I've followed instruction from <a href=\"https://github.com/bokmann/fullcalendar-rails#installation\" rel=\"nofollow noreferrer\">https://github.com/bokmann/fullcalendar-rails#installation</a> for installation.\nAt the end I've added <code>&lt;div id=\"calendar\"&gt;&lt;/div&gt;</code> to the view. But nothing happened - view is empty. Any ideas how to start with empty calendar (how to display it) in rails app?</p>\n\n<p>Here are my files:\nindex.html.erb:</p>\n\n<pre><code>    &lt;div class='row'&gt;\n  &lt;div class='col-md-12'&gt;\n    &lt;p&gt;&lt;h4&gt;Hello, &lt;%= current_user.name %&gt;&lt;/h4&gt;&lt;/p&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;div id=\"calendar\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>application.js:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require turbolinks\n//= require bootstrap-sprockets\n//= require_tree .\n\n//=require moment\n//=require fullcalendar\n\n\n$(document).ready(function() {\n    $('#calendar').fullcalendar({\n    })\n});\n</code></pre>\n\n<p>and in application.scss I've added only:</p>\n\n<pre><code>*= require fullcalendar\n</code></pre>\n"}, {"tags": ["ruby", "linux", "resources", "bundle", "gitlab"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 6019988, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3g8iM.jpg?s=128&g=1", "display_name": "Kirill", "link": "https://stackoverflow.com/users/6019988/kirill"}, "edited": false, "score": 0, "creation_date": 1495272817, "post_id": 44078038, "comment_id": 75191178, "body": "I checked logs and find  that gitlab produces a lot of activity with no client requests. Here is log <a href=\"https://gist.github.com/Zmeu213/33dda00f42b134908cccf3d5b410fe39\" rel=\"nofollow noreferrer\">Gist</a> So <code>gitlab</code> working on virtual server where only me could access it from web. It produce such log messages pretty frequently. Gitlab was recently installed and it has no users (except me), no projects, no anything"}], "tags": [], "owner": {"reputation": 2099, "user_id": 5385187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa4512591dc0b8628c775a5cf1b16bef?s=128&d=identicon&r=PG", "display_name": "Drew Blessing", "link": "https://stackoverflow.com/users/5385187/drew-blessing"}, "is_accepted": false, "score": 1, "last_activity_date": 1495223510, "creation_date": 1495223510, "answer_id": 44078038, "question_id": 44017641, "link": "https://stackoverflow.com/questions/44017641/bundle-eats-all-resources-while-gitlab-ce-running/44078038#44078038", "title": "Bundle eats all resources while gitlab-ce running", "body": "<p>When you see <code>bundle</code>, it corresponds to the GitLab Rails/Unicorn server. If it's eating up all the CPU there may be something strange happening on your server. Do you see any particular type of request in the Nginx logs that show up very often? </p>\n\n<p>There are a couple of known issues that can cause pegged CPU with GitLab. For example, if a user is building a large build trace (<a href=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/27724\" rel=\"nofollow noreferrer\">https://gitlab.com/gitlab-org/gitlab-ce/issues/27724</a>) or sometimes when viewing a large issue or merge request (<a href=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/32347\" rel=\"nofollow noreferrer\">https://gitlab.com/gitlab-org/gitlab-ce/issues/32347</a>). In the logs, look for suspect requests that include <code>trace</code> or <code>issue</code> or <code>merge_request</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 1481498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac276137f2cc6235208e5cc7e08f21?s=128&d=identicon&r=PG", "display_name": "sjwoodr", "link": "https://stackoverflow.com/users/1481498/sjwoodr"}, "is_accepted": false, "score": 2, "last_activity_date": 1505741596, "creation_date": 1505741596, "answer_id": 46280648, "question_id": 44017641, "link": "https://stackoverflow.com/questions/44017641/bundle-eats-all-resources-while-gitlab-ce-running/46280648#46280648", "title": "Bundle eats all resources while gitlab-ce running", "body": "<p>I also have observed this on GitLab CE -- no builds were running but after the weekend, I came back into the office and GitLab was unresponsive in the browser.  I saw 4 bundle processes eating up all of the available CPU.  I restarted (gitlab-ctl restart) and things returned to normal.  I then went to the jobs page (/admin/jobs) and no builds were running when I restarted the server.  This isn't an answer... but confirmation that there seems to be a real issue here.</p>\n"}], "owner": {"reputation": 155, "user_id": 6019988, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3g8iM.jpg?s=128&g=1", "display_name": "Kirill", "link": "https://stackoverflow.com/users/6019988/kirill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4668, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1505741596, "creation_date": 1495004091, "question_id": 44017641, "link": "https://stackoverflow.com/questions/44017641/bundle-eats-all-resources-while-gitlab-ce-running", "title": "Bundle eats all resources while gitlab-ce running", "body": "<p>I installed <code>gitlab-ce</code> on my digitalocean droplet, it works fine but very slow, im also turned off <code>nginx</code> as it thinks that time is out on simple requests, and the problem is in bundler. <code>bundle</code> process runs forever and eats all memory. What is the reason of this? I thought bundle is needed only for setup and it is not required for running as I see other gitlab processes. Even if I kill <code>bundle</code> process manually it is started again by git user. How to fix that or is it all goes as intended?  </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1495000876, "post_id": 44016638, "comment_id": 75060688, "body": "&quot;no implicit conversion of Symbol into Integer&quot; generally means that you&#39;re trying to index an array with a symbol (i.e. you think you have a hash when you really have an array). That example response shouldn&#39;t produce that error and the <code>cred[:name]</code> in the <code>find_by</code> should trigger it before line 16 does. So what specifically is <code>cred</code> when the error happens?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1495001103, "post_id": 44016638, "comment_id": 75060804, "body": "What is <code>Integer1</code>?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1495001523, "post_id": 44016638, "comment_id": 75060995, "body": "What <code>AntHQ.logger.debug &quot;==&gt; #{cred}&quot;</code> spits out?"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1495004275, "post_id": 44016638, "comment_id": 75062555, "body": "@mudasobwa: What is AntHQ? Never heard of it, and could not even find it with Google."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1495006985, "post_id": 44016638, "comment_id": 75064231, "body": "@user1934428 no idea, it\u2019s the line from the snipped provided in OP."}, {"owner": {"reputation": 164, "user_id": 4586802, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10202329763124223/picture?type=large", "display_name": "Avin A Good-time Chadee", "link": "https://stackoverflow.com/users/4586802/avin-a-good-time-chadee"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1495081428, "post_id": 44016638, "comment_id": 75103374, "body": "@sawa Integer1 is just a typo sorry."}, {"owner": {"reputation": 164, "user_id": 4586802, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10202329763124223/picture?type=large", "display_name": "Avin A Good-time Chadee", "link": "https://stackoverflow.com/users/4586802/avin-a-good-time-chadee"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1495081472, "post_id": 44016638, "comment_id": 75103385, "body": "@mudasobwa AntHQ is just the application namespace for a custom logger we use"}, {"owner": {"reputation": 164, "user_id": 4586802, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10202329763124223/picture?type=large", "display_name": "Avin A Good-time Chadee", "link": "https://stackoverflow.com/users/4586802/avin-a-good-time-chadee"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1495081604, "post_id": 44016638, "comment_id": 75103420, "body": "@muistooshort cred is each element in that array specified in the response. Its worth noting when I run this manually in the console it works every time. Its just when its deployed to the server"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1495086852, "post_id": 44016638, "comment_id": 75105169, "body": "I know what the code is saying about <code>cred</code> but what is it really when the error happens? You seem to have some logging so what&#39;s in the logs? And how would <code>cred[:name]</code> (in the <code>find_by</code>) and <code>cred[:value]</code> in the <code>if</code> work but <code>cred[:value]</code> in the assignment fail?"}], "answers": [{"tags": [], "owner": {"reputation": 164, "user_id": 4586802, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10202329763124223/picture?type=large", "display_name": "Avin A Good-time Chadee", "link": "https://stackoverflow.com/users/4586802/avin-a-good-time-chadee"}, "is_accepted": true, "score": 0, "last_activity_date": 1496806547, "creation_date": 1496806547, "answer_id": 44403046, "question_id": 44016638, "link": "https://stackoverflow.com/questions/44016638/no-implicit-conversion-of-symbol-into-integer-only-happening-sometimes/44403046#44403046", "title": "No implicit conversion of Symbol into Integer only happening sometimes", "body": "<p>Hi guys I appreciate your answers. </p>\n\n<p>The real cause was because our jenkins agent wasn't deploying the code to all our instances.</p>\n"}], "owner": {"reputation": 164, "user_id": 4586802, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10202329763124223/picture?type=large", "display_name": "Avin A Good-time Chadee", "link": "https://stackoverflow.com/users/4586802/avin-a-good-time-chadee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 44403046, "answer_count": 1, "score": -2, "last_activity_date": 1496806547, "creation_date": 1495000412, "last_edit_date": 1495081649, "question_id": 44016638, "link": "https://stackoverflow.com/questions/44016638/no-implicit-conversion-of-symbol-into-integer-only-happening-sometimes", "title": "No implicit conversion of Symbol into Integer only happening sometimes", "body": "<p>Can someone explain what I'm doing wrong!?      </p>\n\n<pre><code>   if response[:result]\n      response[:credentials].each do |cred|\n\n        AntHQ.logger.debug \"==&gt; #{cred}\"\n        c = app_instance.credentials.find_by(name: cred[:name])\n\n        if c &amp;&amp; cred[:value]\n          c.value = cred[:value]\n          c.expiry = cred[:expiry]\n          c.save!\n        end\n      end\n    end\n</code></pre>\n\n<p>Error</p>\n\n<pre><code>TypeError: no implicit conversion of Symbol into Integer\n\nFile \"/usr/local/lib/ruby/gems/2.1.0/bundler/gems/ant_light_tasks-01095a3ea065/lib/ant_light_tasks/app/update_credentials.rb\" line 16 in []\n</code></pre>\n\n<p>Line 16:</p>\n\n<pre><code> c.value = cred[:value]\n</code></pre>\n\n<p>Example \"response\":</p>\n\n<pre><code>{:result=&gt;true, :credentials=&gt;[{:name=&gt;\"access_token\", :value=&gt;\"...\", :expiry=&gt;\"...\"}]}\n</code></pre>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1494997662, "post_id": 44015651, "comment_id": 75059397, "body": "Your question is unclear. You have only said what happens, but you haven&#39;t said what you <i>expect</i> to happen instead, <i>why</i> you expect that to happen, and in what way the expected behavior and the actual behavior differ. What <i>specifically</i> is the problem with your code? Why does it matter to you whether <code>require</code> returns <code>false</code> or <code>true</code>?"}, {"owner": {"reputation": 759, "user_id": 2077644, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/49dde1608911b1724d850a8eb6f408d4?s=128&d=identicon&r=PG", "display_name": "Karthi1234", "link": "https://stackoverflow.com/users/2077644/karthi1234"}, "edited": false, "score": 0, "creation_date": 1494998068, "post_id": 44015651, "comment_id": 75059519, "body": "My question when I load rubygems why its showing false though gem is working fine."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1495035281, "post_id": 44015651, "comment_id": 75084886, "body": "Is there anything in the documentation of <code>Kernel#require</code> that is particularly unclear? It would be very nice of you if you could tell <i>what part</i> precisely of the documentation is unclear to you, so that the Ruby developers can improve the documentation for future readers."}], "answers": [{"comments": [{"owner": {"reputation": 759, "user_id": 2077644, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/49dde1608911b1724d850a8eb6f408d4?s=128&d=identicon&r=PG", "display_name": "Karthi1234", "link": "https://stackoverflow.com/users/2077644/karthi1234"}, "edited": false, "score": 0, "creation_date": 1495094185, "post_id": 44015985, "comment_id": 75109568, "body": "Thanks for the clarification! Now I understand very well about this."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1494997272, "creation_date": 1494997272, "answer_id": 44015985, "question_id": 44015651, "link": "https://stackoverflow.com/questions/44015651/ruby-unable-to-load-rubygems-after-compilation/44015985#44015985", "title": "ruby unable to load rubygems after compilation", "body": "<p><code>require</code> returns <code>true</code> when it loads a module, <code>false</code> if the module is already loaded, and raises a <code>LoadError</code> when a module cannot be found.</p>\n\n<p>You are not unable to load <code>rubygems</code>; it is loaded by default. Try to <code>require 'smegybur'</code> or some other nonsense to see how it looks like when a package in fact cannot be loaded.</p>\n"}], "owner": {"reputation": 759, "user_id": 2077644, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/49dde1608911b1724d850a8eb6f408d4?s=128&d=identicon&r=PG", "display_name": "Karthi1234", "link": "https://stackoverflow.com/users/2077644/karthi1234"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "closed_date": 1495013033, "accepted_answer_id": 44015985, "answer_count": 1, "score": -3, "last_activity_date": 1494997272, "creation_date": 1494995567, "question_id": 44015651, "link": "https://stackoverflow.com/questions/44015651/ruby-unable-to-load-rubygems-after-compilation", "closed_reason": "Needs details or clarity", "title": "ruby unable to load rubygems after compilation", "body": "<p>I have compiled Ruby 193 and was able to load many of the modules without any issues. But when I tried to load 'rubygems' its saying false.</p>\n\n<pre><code>irb(main):001:0&gt; require 'json'\n=&gt; true\nirb(main):002:0&gt; require 'yaml'\n=&gt; true\nirb(main):003:0&gt; require 'time'\n=&gt; true\nirb(main):004:0&gt; require 'rubygems'\n=&gt; false\nirb(main):005:0&gt;\n</code></pre>\n\n<p>But on ruby 1.8.7, to load the json we needed to load rubygems first and only then json will load. Am having little confusion with the rubygems between ruby 193 and 187. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1494997150, "post_id": 44015437, "comment_id": 75059245, "body": "I dont quite understand why a session belongs to both a teacher and a student. As far as i understand your application only teachers can login so the session should belongs only to a teacher and a note should belong to a student instead of a session . This way a teacher could add notes to any student or multiple students"}, {"owner": {"reputation": 89, "user_id": 4544501, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/54f01eb3371e5aeefc23e4d210078278?s=128&d=identicon&r=PG", "display_name": "Kapaz", "link": "https://stackoverflow.com/users/4544501/kapaz"}, "reply_to_user": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1494997810, "post_id": 44015437, "comment_id": 75059442, "body": "@RadaBogdan I thought the same thing. I went to my superior/instructor and apparently session_notes belongs to session not students. Which is why i&#39;m trying to figure out how to associate session notes to a student."}, {"owner": {"reputation": 3206, "user_id": 4721554, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4zQo.png?s=128&g=1", "display_name": "fbelanger", "link": "https://stackoverflow.com/users/4721554/fbelanger"}, "edited": false, "score": 0, "creation_date": 1494998180, "post_id": 44015437, "comment_id": 75059552, "body": "Session is not authentication in this exercise, it&#39;s the relationship between teacher and student. SessionNote belongs to Teacher and Student by belonging to Session, because it belongs to Teacher and Student. Look at my answer for more ;)"}, {"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1495016528, "post_id": 44015437, "comment_id": 75070780, "body": "Aha . Now i understand"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4544501, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/54f01eb3371e5aeefc23e4d210078278?s=128&d=identicon&r=PG", "display_name": "Kapaz", "link": "https://stackoverflow.com/users/4544501/kapaz"}, "edited": false, "score": 0, "creation_date": 1494999447, "post_id": 44015893, "comment_id": 75060057, "body": "Pretend I&#39;m a  teacher. While I have this web app open if i want to write a quick note about a student I can write it and I can choose who the note is about in case later I want to view notes about a certain student.                                                     **We have a feature where the teacher can conduct study sessions with students. While the timer/session for that student is running I want to be able to write a note and have that note be associated with that student automatically without the teachers input."}], "tags": [], "owner": {"reputation": 184, "user_id": 2597237, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Cx30l.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/2597237/adam"}, "is_accepted": false, "score": 0, "last_activity_date": 1494996760, "creation_date": 1494996760, "answer_id": 44015893, "question_id": 44015437, "link": "https://stackoverflow.com/questions/44015437/associating-multiple-notesdata-model-to-a-studentdata-model/44015893#44015893", "title": "Associating multiple notes(data model) to a student(data model)", "body": "<p>I'm having trouble picking out a question in your post.  Can you try to get a little more specific on what your goal is or what you don't understand?<br>\nThat being said...</p>\n\n<p>If I'm understanding correctly, you're wanting to set up a <code>has_many</code> type relationship but you aren't sure how to do it, yet.  If that's the case, take a look at this piece of the <a href=\"http://guides.rubyonrails.org/getting_started.html#associating-models\" rel=\"nofollow noreferrer\">rails docs</a> for associating one model with another.</p>\n\n<p>Basically, with the code I see above, you would set up a new model and put it in the <code>&lt;your app's root directory&gt;/app/models/</code> directory.  That class would have a few lines that might resemble this</p>\n\n<pre><code>class SessionNote &lt; ApplicationRecord\n  belongs_to :Teacher\n\n  # code that does things you need your model to do\nend\n</code></pre>\n\n<p>and so on.\nI'm not even sure if I'm on the right track with the answer so I'll post this and let you update with a bit more detail.\nLet me know if you have any questions about what I meant or if I'm not giving you the info you want.</p>\n"}, {"tags": [], "owner": {"reputation": 3206, "user_id": 4721554, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4zQo.png?s=128&g=1", "display_name": "fbelanger", "link": "https://stackoverflow.com/users/4721554/fbelanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1494998764, "last_edit_date": 1494998764, "creation_date": 1494997752, "answer_id": 44016065, "question_id": 44015437, "link": "https://stackoverflow.com/questions/44015437/associating-multiple-notesdata-model-to-a-studentdata-model/44016065#44016065", "title": "Associating multiple notes(data model) to a student(data model)", "body": "<p>From the nature of your question, I will assume that you're pretty new to software.</p>\n\n<p>You are in charge of Notes, however the note <strong>feature</strong> can effect and depend on other <strong>features</strong>.</p>\n\n<p>Not sure why you're showing sessions_controller, but I'm glad you did. I realize now that a <code>Session</code> is a many to many between students and teachers. Got completely caught up with the meaning of sessions in software.</p>\n\n<p>So looking at your schema file, your associating the session to the note.</p>\n\n<p>The session represents an instance of a teacher and student. So far so good.</p>\n\n<p>Because a session belongs to a teacher and student, we can leverage that to express the same for notes, while saying that a note belongs to a specific session.</p>\n\n<p>I guess what you really want to know is how to code it. Because you've only added boilerplate controller code and haven't provided any model code at all, classic :)</p>\n\n<pre><code>class SessionNote &lt; ActiveRecord::Base # ApplicationRecord for Rails 5+\n  belongs_to :session\n  delegate :teacher, :student, to: :session\nend\n\nclass Session &lt; ActiveRecord::Base\n  belongs_to :teacher, foreign_key: 'teacher_session'\n  belongs_to :student, foreign_key: 'student_session'\n  has_many :session_notes\nend\n\nclass Student &lt; ActiveRecord::Base\n  has_many :sessions\n  has_many :session_notes, through: :sessions\nend\n\nclass Teacher &lt; ActiveRecord::Base\n  has_many :sessions\n  has_many :session_notes, through: :sessions\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3206, "user_id": 4721554, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4zQo.png?s=128&g=1", "display_name": "fbelanger", "link": "https://stackoverflow.com/users/4721554/fbelanger"}, "edited": false, "score": 0, "creation_date": 1494997849, "post_id": 44016071, "comment_id": 75059454, "body": "No need for a many to many between teacher and student when one is available. Essentially a session_note already belongs to a student and teacher by belonging to sessions. And he seems to want to track which session a note originated from."}, {"owner": {"reputation": 89, "user_id": 4544501, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/54f01eb3371e5aeefc23e4d210078278?s=128&d=identicon&r=PG", "display_name": "Kapaz", "link": "https://stackoverflow.com/users/4544501/kapaz"}, "reply_to_user": {"reputation": 3206, "user_id": 4721554, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4zQo.png?s=128&g=1", "display_name": "fbelanger", "link": "https://stackoverflow.com/users/4721554/fbelanger"}, "edited": false, "score": 0, "creation_date": 1494999643, "post_id": 44016071, "comment_id": 75060130, "body": "@fbelanger Yes we have a teacher can conduct study sessions with one student. During that session a teacher can write a note about that student during that session and i want that note to be associated to that student automatically."}, {"owner": {"reputation": 3206, "user_id": 4721554, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4zQo.png?s=128&g=1", "display_name": "fbelanger", "link": "https://stackoverflow.com/users/4721554/fbelanger"}, "reply_to_user": {"reputation": 89, "user_id": 4544501, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/54f01eb3371e5aeefc23e4d210078278?s=128&d=identicon&r=PG", "display_name": "Kapaz", "link": "https://stackoverflow.com/users/4544501/kapaz"}, "edited": false, "score": 0, "creation_date": 1494999857, "post_id": 44016071, "comment_id": 75060240, "body": "@Kapaz you&#39;re adding a lot of content that belongs in your question, not this comment section."}], "tags": [], "owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "is_accepted": true, "score": 1, "last_activity_date": 1494997861, "last_edit_date": 1494997861, "creation_date": 1494997801, "answer_id": 44016071, "question_id": 44015437, "link": "https://stackoverflow.com/questions/44015437/associating-multiple-notesdata-model-to-a-studentdata-model/44016071#44016071", "title": "Associating multiple notes(data model) to a student(data model)", "body": "<p>what you need is\none-many relation between your <code>students</code> and <code>session_notes</code> table</p>\n\n<ul>\n<li>one <code>Student</code> instance has_many session_notes</li>\n<li>one <code>SessionNote</code> instance belongs_to student</li>\n</ul>\n\n<p>one-many relation between your <code>teachers</code> and <code>session_notes</code> table</p>\n\n<ul>\n<li>one <code>Teacher</code> instance has_many session_notes</li>\n<li>one <code>SessionNote</code> instance belongs_to teacher</li>\n</ul>\n\n<p>generate migration to add <code>student_id</code> on <code>session_notes</code> table</p>\n\n<pre><code>rails g migration add_student_id_to_session_notes student_id:integer\n</code></pre>\n\n<p>generate migration to add <code>teacher_id</code> on <code>session_notes</code> table</p>\n\n<pre><code>rails g migration add_teacher_id_to_session_notes teacher_id:integer\n</code></pre>\n\n<p>then run the migrations <code>bundle exec rake db:migrate</code></p>\n\n<pre><code># app/models/session_note.rb\nclass SessionNote &lt; ActiveRecord::Base\n  belongs_to :student\n  belongs_to :teacher\nend\n\n# app/models/student.rb\nclass Student &lt; ActiveRecord::Base\n  has_many :session_notes\nend\n\n# app/models/teacher.rb\nclass Teacher &lt; ActiveRecord::Base\n  has_many :session_notes\nend\n</code></pre>\n\n<p>Use them: </p>\n\n<pre><code>Student.last.session_notes\nTeacher.last.session_notes\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 4544501, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/54f01eb3371e5aeefc23e4d210078278?s=128&d=identicon&r=PG", "display_name": "Kapaz", "link": "https://stackoverflow.com/users/4544501/kapaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 44016071, "answer_count": 3, "score": 0, "last_activity_date": 1494998764, "creation_date": 1494994534, "question_id": 44015437, "link": "https://stackoverflow.com/questions/44015437/associating-multiple-notesdata-model-to-a-studentdata-model", "title": "Associating multiple notes(data model) to a student(data model)", "body": "<p>In my web application, I'm building a note taking feature. I want to have notes appear for certain students, I want teachers to be able to write notes about students. So I want to be able to associate notes with students. How can I go about doing something like this?</p>\n\n<p>The obvious solution would be to make a Notes(belongs_to student) and student (has_many notes). I think this is the way but i'm not sure. The only problem is I'm in charge of Note. Other people are in charge of students, sessions, etc. </p>\n\n<p>Problem: I'm in charge of Notes while others are in charge of students, sessions, etc.</p>\n\n<p>What can i do, what should I be researching. Any help would be appreciated.\nSchema.rb</p>\n\n<pre><code>  create_table \"session_notes\", force: :cascade do |t|\n    t.text     \"note\"\n    t.integer  \"session_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"sessions\", force: :cascade do |t|\n    t.datetime \"start_time\"\n    t.datetime \"end_time\"\n    t.integer  \"session_teacher\"\n    t.integer  \"session_student\"\n    t.datetime \"created_at\",      null: false\n    t.datetime \"updated_at\",      null: false\n  end\n\n  create_table \"students\", force: :cascade do |t|\n    t.string   \"full_name\"\n    t.string   \"screen_name\"\n    t.string   \"icon\"\n    t.string   \"color\"\n    t.string   \"contact_info\"\n    t.text     \"description\"\n    t.integer  \"session_interval\"\n    t.integer  \"school_id\"\n    t.datetime \"created_at\",       null: false\n    t.datetime \"updated_at\",       null: false\n  end\n\n  create_table \"teachers\", force: :cascade do |t|\n    t.string   \"user_name\"\n    t.string   \"password_digest\"\n    t.datetime \"last_login\"\n    t.string   \"full_name\"\n    t.string   \"screen_name\"\n    t.string   \"icon\"\n    t.string   \"color\"\n    t.string   \"email\"\n    t.text     \"description\"\n    t.string   \"powers\"\n    t.integer  \"school_id\"\n    t.datetime \"created_at\",      null: false\n    t.datetime \"updated_at\",      null: false\n  end\n</code></pre>\n\n<p>Sessions_note_controller </p>\n\n<pre><code>class SessionNotesController &lt; ApplicationController\n  #before_action :set_session_note,  only: [:show, :edit, :update, :destroy]\n\n  # GET /session_notes\n  # GET /session_notes.json\n  def index\n    @session_note = SessionNote.new\n    @session_notes = SessionNote.paginate(page: params[:page])\n  end\n\n  # GET /session_notes/1\n  # GET /session_notes/1.json\n  def show\n  end\n\n  # GET /session_notes/new\n  def new\n    @session_note = SessionNote.new\n  end\n\n  # GET /session_notes/1/edit\n  def edit\n  end\n\n  # POST /session_notes\n  # POST /session_notes.json\n  def create\n    @session_note = SessionNote.new(session_note_params)\n\n    respond_to do |format|\n      if @session_note.save\n        format.html { redirect_to session_notes_url, notice: 'Session note was successfully created.' }\n        format.json { render :index, status: :created, location: @session_note }\n      else\n        format.html { render :new }\n        format.json { render json: @session_note.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /session_notes/1\n  # PATCH/PUT /session_notes/1.json\n  def update\n    respond_to do |format|\n      if @session_note.update(session_note_params)\n        format.html { redirect_to @session_note, notice: 'Session note was successfully updated.' }\n        format.json { render :show, status: :ok, location: @session_note }\n      else\n        format.html { render :edit }\n        format.json { render json: @session_note.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /session_notes/1\n  # DELETE /session_notes/1.json\n  def destroy\n    @session_note.destroy\n    respond_to do |format|\n      format.html { redirect_to session_notes_url, notice: 'Session note was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # # Use callbacks to share common setup or constraints between actions.\n    # def set_session_note\n    #   @session_note = SessionNote.find(params[:id])\n    # end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def session_note_params\n      params.require(:session_note).permit(:note, :session_id, :created_at)\n    end\nend\n</code></pre>\n\n<p>Sessions_controller</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n  before_action :set_session, only: [:show, :edit, :update, :destroy]\n\n  # GET /sessions\n  # GET /sessions.json\n  def index\n    @sessions = Session.all\n  end\n\n  # GET /sessions/1\n  # GET /sessions/1.json\n  def show\n    @student = Student.find(@session.session_student)\n    @teacher = Teacher.find(@session.session_teacher)\n  end\n\n  # GET /sessions/new\n  def new\n    @session = Session.new\n  end\n\n  # GET /sessions/1/edit\n  def edit\n  end\n\n  # POST /sessions\n  # POST /sessions.json\n  def create\n    @session = Session.new(session_params)\n\n    respond_to do |format|\n      if @session.save\n        format.html { redirect_to @session, notice: 'Session was successfully created.' }\n        format.json { render :show, status: :created, location: @session }\n      else\n        format.html { render :new }\n        format.json { render json: @session.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /sessions/1\n  # PATCH/PUT /sessions/1.json\n  def update\n    respond_to do |format|\n      if @session.update(session_params)\n        format.html { redirect_to @session, notice: 'Session was successfully updated.' }\n        format.json { render :show, status: :ok, location: @session }\n      else\n        format.html { render :edit }\n        format.json { render json: @session.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /sessions/1\n  # DELETE /sessions/1.json\n  def destroy\n    @session.destroy\n    respond_to do |format|\n      format.html { redirect_to sessions_url, notice: 'Session was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_session\n      @session = Session.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def session_params\n      params.require(:session).permit(:start_time, :end_time, :session_teacher, :session_student)\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1494997342, "post_id": 44015266, "comment_id": 75059296, "body": "I think the error &#238;s pretty verbose. You have somewhere in your code the string &quot;Rack::Cors&quot;. You just have to get rid of the quotes. And it will be a class that can respond to the &#39;new&#39; method"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "edited": false, "score": 0, "creation_date": 1495034591, "post_id": 44016229, "comment_id": 75084349, "body": "@xSlok you need the Rails 5 style since you are using rails 5 as is evident by <code>railties-5.1.1</code> littered through out your stack trace"}, {"owner": {"reputation": 6670, "user_id": 3625317, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/sTfWL.png?s=128&g=1", "display_name": "Eugen Mayer", "link": "https://stackoverflow.com/users/3625317/eugen-mayer"}, "edited": false, "score": 0, "creation_date": 1545302592, "post_id": 44016229, "comment_id": 94581270, "body": "thanks. Little note, that is needed from 5.1.0, 5.0.0 still works with the 3/4.x variant - if of any interest"}], "tags": [], "owner": {"reputation": 3077, "user_id": 1257369, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UVwvN.gif?s=128&g=1", "display_name": "everyman", "link": "https://stackoverflow.com/users/1257369/everyman"}, "is_accepted": true, "score": 59, "last_activity_date": 1582499612, "last_edit_date": 1582499612, "creation_date": 1494998514, "answer_id": 44016229, "question_id": 44015266, "link": "https://stackoverflow.com/questions/44015266/how-to-fix-undefined-method-new-for-rackcorsstring/44016229#44016229", "title": "How to fix undefined method `new&#39; for &quot;Rack::Cors&quot;:String", "body": "<p>When using Rails 5 or Rails 6, remove the quotes.</p>\n\n<pre><code>module YourApp\n  class Application &lt; Rails::Application\n\n    # ...\n\n    # Rails 3/4\n\n    config.middleware.insert_before 0, \"Rack::Cors\" do\n      allow do\n        origins '*'\n        resource '*', :headers =&gt; :any, :methods =&gt; [:get, :post, :options]\n      end\n    end\n\n    # Rails 5/6\n\n    config.middleware.insert_before 0, Rack::Cors do\n      allow do\n        origins '*'\n        resource '*', :headers =&gt; :any, :methods =&gt; [:get, :post, :options]\n      end\n    end\n\n  end\nend\n</code></pre>\n\n<p>See <a href=\"https://github.com/cyu/rack-cors#rails-configuration\" rel=\"noreferrer\">https://github.com/cyu/rack-cors#rails-configuration</a></p>\n"}], "owner": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5848, "favorite_count": 1, "accepted_answer_id": 44016229, "answer_count": 1, "score": 11, "last_activity_date": 1587592868, "creation_date": 1494993316, "last_edit_date": 1587592868, "question_id": 44015266, "link": "https://stackoverflow.com/questions/44015266/how-to-fix-undefined-method-new-for-rackcorsstring", "title": "How to fix undefined method `new&#39; for &quot;Rack::Cors&quot;:String", "body": "<p>I'm new to Ruby on Rails and am learning to use Angular with it, but after I ran \"<code>gem install rack-cors</code>\", when I try to start a Rails application, I keep getting this error:</p>\n\n<pre><code>C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/actionpack-5.1.1/lib/action_dispatch/middleware/stack.rb:35:in `build': undefined method `new' for \"Rack::Cors\":String (NoMethodError)\nDid you mean?  next\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/actionpack-5.1.1/lib/action_dispatch/middleware/stack.rb:99:in `block in build'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/actionpack-5.1.1/lib/action_dispatch/middleware/stack.rb:99:in `each'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/actionpack-5.1.1/lib/action_dispatch/middleware/stack.rb:99:in `inject'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/actionpack-5.1.1/lib/action_dispatch/middleware/stack.rb:99:in `build'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/engine.rb:508:in `block in app'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/engine.rb:504:in `synchronize'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/engine.rb:504:in `app'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/application/finisher.rb:45:in `block in &lt;module:Finisher&gt;'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/initializable.rb:30:in `instance_exec'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/initializable.rb:30:in `run'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/initializable.rb:59:in `block in run_initializers'\n        from C:/Ruby23-x64/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each'\n        from C:/Ruby23-x64/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n        from C:/Ruby23-x64/lib/ruby/2.3.0/tsort.rb:431:in `each_strongly_connected_component_from'\n        from C:/Ruby23-x64/lib/ruby/2.3.0/tsort.rb:349:in `block in each_strongly_connected_component'\n        from C:/Ruby23-x64/lib/ruby/2.3.0/tsort.rb:347:in `each'\n        from C:/Ruby23-x64/lib/ruby/2.3.0/tsort.rb:347:in `call'\n        from C:/Ruby23-x64/lib/ruby/2.3.0/tsort.rb:347:in `each_strongly_connected_component'\n        from C:/Ruby23-x64/lib/ruby/2.3.0/tsort.rb:226:in `tsort_each'\n        from C:/Ruby23-x64/lib/ruby/2.3.0/tsort.rb:205:in `tsort_each'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/initializable.rb:58:in `run_initializers'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/application.rb:353:in `initialize!'\n        from D:/TFE Unipar/Vigia Back-End/config/environment.rb:5:in `&lt;top (required)&gt;'\n        from config.ru:3:in `require_relative'\n        from config.ru:3:in `block in &lt;main&gt;'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/rack-2.0.2/lib/rack/builder.rb:55:in `instance_eval'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/rack-2.0.2/lib/rack/builder.rb:55:in `initialize'\n        from config.ru:in `new'\n        from config.ru:in `&lt;main&gt;'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/rack-2.0.2/lib/rack/builder.rb:49:in `eval'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/rack-2.0.2/lib/rack/builder.rb:49:in `new_from_string'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/rack-2.0.2/lib/rack/builder.rb:40:in `parse_file'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/rack-2.0.2/lib/rack/server.rb:319:in `build_app_and_options_from_config'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/rack-2.0.2/lib/rack/server.rb:219:in `app'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/commands/server/server_command.rb:24:in `app'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/rack-2.0.2/lib/rack/server.rb:354:in `wrapped_app'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/commands/server/server_command.rb:80:in `log_to_stdout'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/commands/server/server_command.rb:42:in `start'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/commands/server/server_command.rb:131:in `block in perform'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/commands/server/server_command.rb:126:in `tap'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/commands/server/server_command.rb:126:in `perform'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/thor-0.19.4/lib/thor/command.rb:27:in `run'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/thor-0.19.4/lib/thor/invocation.rb:126:in `invoke_command'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/thor-0.19.4/lib/thor.rb:369:in `dispatch'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/command/base.rb:63:in `perform'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/command.rb:44:in `invoke'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/railties-5.1.1/lib/rails/commands.rb:16:in `&lt;top (required)&gt;'\n        from bin/rails:4:in `require'\n        from bin/rails:4:in `&lt;main&gt;\n</code></pre>\n\n<p>This is the file that's mentioned on the error:</p>\n\n<pre><code>require \"active_support/inflector/methods\"\nrequire \"active_support/dependencies\"\n\nmodule ActionDispatch\n  class MiddlewareStack\n    class Middleware\n      attr_reader :args, :block, :klass\n\n      def initialize(klass, args, block)\n        @klass = klass\n        @args  = args\n        @block = block\n      end\n\n      def name; klass.name; end\n\n      def ==(middleware)\n        case middleware\n        when Middleware\n          klass == middleware.klass\n        when Class\n          klass == middleware\n        end\n      end\n\n      def inspect\n        if klass.is_a?(Class)\n          klass.to_s\n        else\n          klass.class.to_s\n        end\n      end\n\n      def build(app)\n        klass.new(app, *args, &amp;block)\n      end\n    end\n\n    include Enumerable\n\n    attr_accessor :middlewares\n\n    def initialize(*args)\n      @middlewares = []\n      yield(self) if block_given?\n    end\n\n    def each\n      @middlewares.each { |x| yield x }\n    end\n\n    def size\n      middlewares.size\n    end\n\n    def last\n      middlewares.last\n    end\n\n    def [](i)\n      middlewares[i]\n    end\n\n    def unshift(klass, *args, &amp;block)\n      middlewares.unshift(build_middleware(klass, args, block))\n    end\n\n    def initialize_copy(other)\n      self.middlewares = other.middlewares.dup\n    end\n\n    def insert(index, klass, *args, &amp;block)\n      index = assert_index(index, :before)\n      middlewares.insert(index, build_middleware(klass, args, block))\n    end\n\n    alias_method :insert_before, :insert\n\n    def insert_after(index, *args, &amp;block)\n      index = assert_index(index, :after)\n      insert(index + 1, *args, &amp;block)\n    end\n\n    def swap(target, *args, &amp;block)\n      index = assert_index(target, :before)\n      insert(index, *args, &amp;block)\n      middlewares.delete_at(index + 1)\n    end\n\n    def delete(target)\n      middlewares.delete_if { |m| m.klass == target }\n    end\n\n    def use(klass, *args, &amp;block)\n      middlewares.push(build_middleware(klass, args, block))\n    end\n\n    def build(app = Proc.new)\n      middlewares.freeze.reverse.inject(app) { |a, e| e.build(a) }\n    end\n\n    private\n\n      def assert_index(index, where)\n        i = index.is_a?(Integer) ? index : middlewares.index { |m| m.klass == index }\n        raise \"No such middleware to insert #{where}: #{index.inspect}\" unless i\n        i\n      end\n\n      def build_middleware(klass, args, block)\n        Middleware.new(klass, args, block)\n      end\n  end\nend\n</code></pre>\n\n<p>How do I solve it?</p>\n"}, {"tags": ["ruby", "neo4j", "cypher", "neography"], "answers": [{"comments": [{"owner": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "edited": false, "score": 0, "creation_date": 1494994902, "post_id": 44015384, "comment_id": 75058498, "body": "It didn&#39;t work: @neo.execute_query(&quot;match (node)-[:gratefulFor]-&gt;(node2) where node.bot_client_id = &#39;aiaas-1409611358153-user-0149&#39; AND node2.epoch_utc_i &gt; $yesterday return node.bot_client_id, node2.epoch_utc_i, node2.value&quot;, {:yesterday =&gt; yesterday}) Neography::SyntaxException: NeographyError:  --message: Variable <code>$yesterday</code> not defined (line 1, column 121 (offset: 120))"}, {"owner": {"reputation": 1392, "user_id": 4607153, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4tlcK.jpg?s=128&g=1", "display_name": "Diego Gallegos", "link": "https://stackoverflow.com/users/4607153/diego-gallegos"}, "reply_to_user": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "edited": false, "score": 0, "creation_date": 1494995346, "post_id": 44015384, "comment_id": 75058634, "body": "Try with the <code>{yesterday}</code> syntax as <code>$yesterday</code> is quite recent notation."}, {"owner": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "edited": false, "score": 0, "creation_date": 1495041502, "post_id": 44015384, "comment_id": 75088795, "body": "this seems to work, great!  related question though is how do I pass the value for the relationship, instead of hard-coding <code>:gratefulFor</code>....I will update the question."}], "tags": [], "owner": {"reputation": 1392, "user_id": 4607153, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4tlcK.jpg?s=128&g=1", "display_name": "Diego Gallegos", "link": "https://stackoverflow.com/users/4607153/diego-gallegos"}, "is_accepted": true, "score": 0, "last_activity_date": 1494995690, "last_edit_date": 1494995690, "creation_date": 1494994223, "answer_id": 44015384, "question_id": 44015212, "link": "https://stackoverflow.com/questions/44015212/how-do-i-use-cipher-to-query-time-range-for-neo4j-nodes/44015384#44015384", "title": "how do I use cipher to query time range for neo4j nodes?", "body": "<p>You would have to pass the variable to the query. Parameters are passed to Cypher queries using <code>$yesterday</code> or <code>{yesterday}</code> (old notation). The query will be as follows:</p>\n\n<pre><code>MATCH (node) WHERE node.value \nCONTAINS 'Rachel' AND node.epoch_utc_i &gt; {yesterday} \nRETURN node.uuid, node.epoch_utc_i, node.value\"\n</code></pre>\n\n<p>The query execution will be passed the yesterday variable and interpolated into the query above.</p>\n\n<pre><code>@neo.execute_query(query, {:yesterday =&gt; yesterday})\n</code></pre>\n"}], "owner": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 44015384, "answer_count": 1, "score": 0, "last_activity_date": 1494995690, "creation_date": 1494992968, "last_edit_date": 1494995003, "question_id": 44015212, "link": "https://stackoverflow.com/questions/44015212/how-do-i-use-cipher-to-query-time-range-for-neo4j-nodes", "title": "how do I use cipher to query time range for neo4j nodes?", "body": "<p>I have the following:</p>\n\n<pre><code>@neo.execute_query(\"match (node) where node.value = 'Rachel' return node.uuid, node.epoch_utc_i, node.value\")\n\n =&gt; {\"columns\"=&gt;[\"node.uuid\", \"node.epoch_utc_i\", \"node.value\"], \"data\"=&gt;[[\"87f7d4c7-c161-4ba2-bce6-8c3c5104f60c\", 1493774726, \"Rachel\"], [\"23574509-3d67-4783-a00a-66a2b49b5cbd\", 1493968856, \"Rachel\"], [\"e7f01367-baa6-431b-8760-1979c215d777\", 1494035989, \"Rachel\"], [\"4cc0f450-a1c4-4992-85c1-9bcb4d759d6a\", 1494047641, \"Rachel\"], [\"e3a83a43-3b0f-4a7f-944b-4f582fb47b72\", 1494183024, \"Rachel\"], [\"1d8be261-e788-449c-9fa1-9db82816fa37\", 1494531971, \"Rachel\"]]}\n</code></pre>\n\n<p>However, I am unable to use <code>WHERE</code> to return only those with the <code>epoch_utc_i</code> time between Today and Yesterday, for example:</p>\n\n<pre><code>2.2.1 :045 &gt; yesterday = Chronic.parse('1 day ago').to_i\n =&gt; 1494906466 \n\n2.2.1 :046 &gt; @neo.execute_query(\"match (node) where node.value Contains 'Rachel' AND node.epoch_utc_i &gt; yesterday return node.uuid, node.epoch_utc_i, node.value\")\nNeography::SyntaxException: NeographyError: \n--message: Variable `yesterday` not defined (line 1, column 72 (offset: 71))\n</code></pre>\n\n<p><strong>Edit: tried passing the value into the query</strong></p>\n\n<pre><code>@neo.execute_query(\"match (node)-[:gratefulFor]-&gt;(node2) where node.bot_client_id = 'aiaas-1409611358153-user-0149' AND node2.epoch_utc_i &gt; $yesterday return node.bot_client_id, node2.epoch_utc_i, node2.value\", {:yesterday =&gt; yesterday})\n\nNeography::SyntaxException: NeographyError: \n--message: Variable `$yesterday` not defined (line 1, column 121 (offset: 120))\n\n--request: {:path=&gt;\"/db/data/cypher\", :body=&gt;\"{\\\"query\\\":\\\"match (node)-[:gratefulFor]-&gt;(node2) where node.bot_client_id = 'aiaas-1409611358153-user-0149' AND node2.epoch_utc_i &gt; $yesterday return node.bot_client_id, node2.epoch_utc_i, node2.value\\\",\\\"params\\\":{\\\"yesterday\\\":1494908349}}\"},\n</code></pre>\n\n<p><strong>Question:</strong></p>\n\n<p>How could I achieve as I intended in my code above, only those nodes where the epoch time is greater than the epoch time for yesterday?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "collection-select"], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 6140921, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d7f0e9fe14ff9fe126642d451ccc245e?s=128&d=identicon&r=PG&f=1", "display_name": "lili pupu", "link": "https://stackoverflow.com/users/6140921/lili-pupu"}, "is_accepted": true, "score": 3, "last_activity_date": 1494992765, "creation_date": 1494992765, "answer_id": 44015171, "question_id": 44015135, "link": "https://stackoverflow.com/questions/44015135/collection-select-not-saving/44015171#44015171", "title": "Collection_select not saving", "body": "<p>This should work :</p>\n\n<pre><code>def group_params\n  params.require(:group).permit(:name, :user_ids =&gt; [])\nend\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 7847797, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-k7pSuJNJeV4/AAAAAAAAAAI/AAAAAAAAApY/6cIE0jxiCM8/photo.jpg?sz=128", "display_name": "jacques Mesnet", "link": "https://stackoverflow.com/users/7847797/jacques-mesnet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 44015171, "answer_count": 1, "score": 0, "last_activity_date": 1494992765, "creation_date": 1494992432, "question_id": 44015135, "link": "https://stackoverflow.com/questions/44015135/collection-select-not-saving", "title": "Collection_select not saving", "body": "<p>I'm trying to implement a collection select to create associations between my model group and user (join table: groups_user). But this association is not saving when i'm using a collection_select. And I have absolutely no idea what can be the problem</p>\n\n<p>My code : </p>\n\n<p>view :</p>\n\n<pre><code>&lt;%= simple_form_for(group, remote: true) do |f| %&gt;\n\n  &lt;%= f.collection_select :user_ids, @users.order(:pseudo), :id, :pseudo, {}, {multiple: true} %&gt;\n\n  &lt;%= f.submit %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>&amp; my controller(group) :</p>\n\n<pre><code>def group_params\n  params.require(:group).permit(:name, :user_ids)\nend\n</code></pre>\n\n<p>Just for info, i have a action to submit individually the association, and it's working perfectly !  But when i try to implement a collection to select collectively, is not working </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "strong-parameters"], "comments": [{"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1494992474, "post_id": 44015075, "comment_id": 75057873, "body": "Can you show your complete controller code?"}, {"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1494992969, "post_id": 44015075, "comment_id": 75057971, "body": "Also show your model code."}], "answers": [{"tags": [], "owner": {"reputation": 2072, "user_id": 3389795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiAJt.jpg?s=128&g=1", "display_name": "Shiko", "link": "https://stackoverflow.com/users/3389795/shiko"}, "is_accepted": false, "score": 1, "last_activity_date": 1495008292, "last_edit_date": 1495008292, "creation_date": 1494994212, "answer_id": 44015381, "question_id": 44015075, "link": "https://stackoverflow.com/questions/44015075/rails-send-strong-parameter-and-update-2-tables-at-once/44015381#44015381", "title": "Rails send strong parameter and update 2 tables at once", "body": "<p>You can do it in one go, but assure you have the <strong>has_many</strong> relation between master and child table and assure your child table has <strong>belongs_to</strong> to master:  </p>\n\n<pre><code>def post_detail_params\n    params.permit(:shop_name, shop_details: [:item_image, :price] )\nend\n\n\npost = Shop.build(post_detail_params)\npost.save\n</code></pre>\n\n<p><strong>Model relationship:</strong>  </p>\n\n<pre><code>class Shop &lt; ActiveRecord::Base\n    has_many: shop_details\nend\n\nclass ShopDetail &lt; ActiveRecord::Base\n    belongs_to: shop\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7207905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1eab725150664c0c639aef7c459f268?s=128&d=identicon&r=PG&f=1", "display_name": "jessy wan", "link": "https://stackoverflow.com/users/7207905/jessy-wan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495008292, "creation_date": 1494991984, "last_edit_date": 1494992593, "question_id": 44015075, "link": "https://stackoverflow.com/questions/44015075/rails-send-strong-parameter-and-update-2-tables-at-once", "title": "Rails send strong parameter and update 2 tables at once", "body": "<p>I am new in Rails, any advises, tips would be appreciated.</p>\n\n<p>rails : '4.2.5'</p>\n\n<p>I have 2 tables as below.\nShop(Master table)\nShop_detail(Detail table)\nThere is a relation between 2 tables.</p>\n\n<p><strong>What I want to do</strong></p>\n\n<p>Send user input values to controllers via AJAX.\nValues are like, shop_name, item_image, price, etc.</p>\n\n<p>In the controller, I want to create 2 tables as below.\nShop(Master table) -> create a new record with shop_name.</p>\n\n<p>Shop_detail(detail table) -> create a new record with item_image, price and shop_id which is obtained from Shop(Master table).</p>\n\n<p>I want to put strong parameter as below.</p>\n\n<pre><code>def post_master_params &lt;- this is for master table.\n    params.permit(:shop_name)\nend\ndef post_detail_params\n    params.permit(:item_image, :price)\nend\n\n@shop = Shop.new(post_master_params)\n@shop.save\n\n@shop_detail = Shop_detail.new(post_detail_params)\n@shop_detail.shop_id = @shop.id\n@shop_detail.save\n</code></pre>\n\n<p>as a result, I got an error below.</p>\n\n<blockquote>\n  <p>Completed 406 Not Acceptable in 83ms (ActiveRecord: 0.4ms)\n  ActionController::UnknownFormat (ActionController::UnknownFormat):</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-3", "datetime"], "comments": [{"owner": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "edited": false, "score": 0, "creation_date": 1494991834, "post_id": 44015019, "comment_id": 75057755, "body": "did you forget to commit?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1494998723, "post_id": 44015019, "comment_id": 75059769, "body": "Does your <code>Agreement</code> model have an overloaded <code>due_date</code> method by any chance? Please, share the model."}, {"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "edited": false, "score": 0, "creation_date": 1495006562, "post_id": 44015019, "comment_id": 75063982, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/44011228/datetime-retrieval-says-nil-when-i-see-that-it-was-inserted-into-db\">datetime retrieval says nil when I see that it was inserted into db</a>"}, {"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "edited": false, "score": 0, "creation_date": 1495006604, "post_id": 44015019, "comment_id": 75063998, "body": "How is this question different from <a href=\"http://stackoverflow.com/q/44011228/6464308\">that one</a>?"}, {"owner": {"reputation": 572, "user_id": 2568409, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PPaUS.png?s=128&g=1", "display_name": "Yaro", "link": "https://stackoverflow.com/users/2568409/yaro"}, "edited": false, "score": 1, "creation_date": 1495014179, "post_id": 44015019, "comment_id": 75069220, "body": "share the model +1"}, {"owner": {"reputation": 437, "user_id": 4643020, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/10152761017948295/picture?type=large", "display_name": "Michael Lombardo", "link": "https://stackoverflow.com/users/4643020/michael-lombardo"}, "edited": false, "score": 0, "creation_date": 1495049343, "post_id": 44015019, "comment_id": 75093052, "body": "It had an overload like mudasobwa said"}], "owner": {"reputation": 437, "user_id": 4643020, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/10152761017948295/picture?type=large", "display_name": "Michael Lombardo", "link": "https://stackoverflow.com/users/4643020/michael-lombardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494991669, "creation_date": 1494991669, "question_id": 44015019, "link": "https://stackoverflow.com/questions/44015019/datetime-saved-in-database-but-when-i-want-to-call-the-datetime-it-is-a-nil-valu", "title": "datetime saved in database but when i want to call the datetime it is a nil value", "body": "<p>I have a <code>datetime</code>, called <code>due_date</code>, that gets saved in <code>agreement</code> table. When i want to display the datetime, it just gives me nil, however Im looking at my db row and its clearly not nil. must be some sort of formating problem.. im using mountain time zone for my whole application as the <code>datetime</code> value called <code>due_date</code> needs to be my timezone anyways. the reason is my <code>due_date</code> is set to the end of the day and i want it to be specifically mountain time.  Im using rails and postgres. </p>\n\n<p>As you can see I have an agreement with the due_date entered.. now when i want to display the due_date value it gives me nil.\n<a href=\"https://i.stack.imgur.com/XKqco.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XKqco.png\" alt=\"enter image description here\"></a></p>\n\n<p>application.rb</p>\n\n<pre class=\"lang-rails prettyprint-override\"><code> config.time_zone = 'Mountain Time (US &amp; Canada)'\n config.active_record.default_timezone = :local\n</code></pre>\n\n<p>All in all how can I display <code>@agreement.due_date</code> and give me the same date from the db? </p>\n\n<ul>\n<li>also a note is from the picture is that when i try <code>@agreement.created_at</code> it shows up just fine unlike the <code>due_date</code></li>\n</ul>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 386, "user_id": 8022943, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh6.googleusercontent.com/-HFr4KLq5n_A/AAAAAAAAAAI/AAAAAAAAAaY/dZPxUcJU80Q/photo.jpg?sz=128", "display_name": "E Pierre", "link": "https://stackoverflow.com/users/8022943/e-pierre"}, "edited": false, "score": 0, "creation_date": 1495024282, "post_id": 44016908, "comment_id": 75076112, "body": "Thank you! This worked for tat. I knew it was something more simple."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 7, "last_activity_date": 1495001671, "last_edit_date": 1495540971, "creation_date": 1495001671, "answer_id": 44016908, "question_id": 44014858, "link": "https://stackoverflow.com/questions/44014858/rspec-error-using-ruby-script-cannot-load-such-file-components-tasks-rb/44016908#44016908", "title": "Rspec error using ruby script: &quot;cannot load such file -- ./components/tasks.rb&quot; (ruby app not rails)", "body": "<p>the <code>require</code> paths are resolved according to the <em>dir you're in when you're executing the code</em>. It's actually a bit more complicated than that, and there is this whole concept of \"load path\" which is configurable. See <a href=\"https://stackoverflow.com/questions/9474299/what-are-the-paths-that-require-looks-up-by-default\">What are the paths that &quot;require&quot; looks up by default?</a></p>\n\n<p>From this line <code>An error occurred while loading ./game_spec.rb.</code> I'm figuring you've run <code>cd spec</code> then <code>rspec ./game_spec.rb</code> or something like that. I think your code would work if you were in the root of the project directory and ran <code>rspec spec/game_spec.rb</code>.</p>\n\n<p>The benefit of <code>require_relative</code> over <code>require</code> is that the paths can be resolved no matter where you call the script from. I think if you used <code>require_relative</code> in tictactoe.rb it would work. </p>\n"}], "owner": {"reputation": 386, "user_id": 8022943, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh6.googleusercontent.com/-HFr4KLq5n_A/AAAAAAAAAAI/AAAAAAAAAaY/dZPxUcJU80Q/photo.jpg?sz=128", "display_name": "E Pierre", "link": "https://stackoverflow.com/users/8022943/e-pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8594, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495001671, "creation_date": 1494990512, "question_id": 44014858, "link": "https://stackoverflow.com/questions/44014858/rspec-error-using-ruby-script-cannot-load-such-file-components-tasks-rb", "title": "Rspec error using ruby script: &quot;cannot load such file -- ./components/tasks.rb&quot; (ruby app not rails)", "body": "<p>I am trying to build my Rspec testing test to test out a ruby app I am building. I know I should build first but test later. The code does work 100%  I am just having issues getting Rspec to even look at my code.</p>\n\n<p>The full code on github:\n<a href=\"https://github.com/EsdrasEtrenne/tictactoe\" rel=\"nofollow noreferrer\">https://github.com/EsdrasEtrenne/tictactoe</a></p>\n\n<p>The only file that im running with rspec so far is ruby/spec/game_spec.rb</p>\n\n<p>the game_spec.rb file looks like this:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>require_relative \"../tictactoe\"\r\nRspec.describe Tasks do\r\n  before(:each)do\r\n    @game = Tictactoe::Game.new\r\n  end\r\n\r\n  it \"has a working method called play\" do\r\n    expect{@game.play}.to output(\"WELCOME! To the unbeatable Tic-tac-toe\").to_stdout\r\n  end\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>It requires tictactoe as a relative:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>require \"./components/tasks.rb\"\r\nrequire \"./components/board.rb\"\r\nrequire \"./components/player.rb\"\r\nrequire \"./components/player_types/computer.rb\"\r\nrequire \"./components/player_types/human.rb\"\r\n\r\nmodule Tictactoe\r\n  class Game\r\n    attr_reader :board, :player, :opponent, :tasks\r\n\r\n    def initialize\r\n      @board = Board.new\r\n      @tasks = Tasks.new\r\n    end\r\n\r\n    def play\r\n      @tasks.greet_players\r\n      @player, @opponent = @tasks.get_order\r\n      current_player, current_opponent = @player, @opponent\r\n      @tasks.print_board(@board)\r\n\r\n      until @board.game_is_over || @board.tie\r\n        @tasks.tell_turn(current_player)\r\n        current_player.move(@board)\r\n        @tasks.print_board(@board)\r\n        if @board.game_is_over || @board.tie\r\n          @tasks.game_over(@board)\r\n          if @tasks.end_options\r\n            game = Tictactoe::Game.new\r\n            game.play\r\n          end\r\n        else\r\n          current_player, current_opponent = current_opponent, current_player\r\n        end\r\n      end\r\n\r\n    end\r\n\r\n  end\r\nend\r\n\r\ngame = Tictactoe::Game.new\r\ngame.play</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Then I get this error when I run rspec game_spec.rb:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>An error occurred while loading ./game_spec.rb.\r\nFailure/Error: return gem_original_require(path)\r\n\r\nLoadError:\r\n  cannot load such file -- ./components/tasks.rb\r\n# /Users/Esdras/Desktop/first_vagrant_box/coding_challenges/ruby/tictactoe.rb:1:in `&lt;top (required)&gt;'\r\n# ./game_spec.rb:1:in `require_relative'\r\n# ./game_spec.rb:1:in `&lt;top (required)&gt;'\r\nNo examples found.\r\n\r\n\r\nFinished in 0.00028 seconds (files took 0.08732 seconds to load)\r\n0 examples, 0 failures, 1 error occurred outside of examples</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The game works 100% regularly. I just am looking to make the first test pass and from there the rest should be really straight forward.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 628, "user_id": 4643970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwK4h.jpg?s=128&g=1", "display_name": "Mahmoud Sayed", "link": "https://stackoverflow.com/users/4643970/mahmoud-sayed"}, "edited": false, "score": 0, "creation_date": 1494988600, "post_id": 44014541, "comment_id": 75056994, "body": "Try <code>if &quot;#{key}&quot; == &quot;name&quot;</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1494997825, "post_id": 44014541, "comment_id": 75059446, "body": "Why have you commented out the condition?"}], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 2334324, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/73d4019af69d424c0586a4e9c1cd8cec?s=128&d=identicon&r=PG", "display_name": "Mike D", "link": "https://stackoverflow.com/users/2334324/mike-d"}, "edited": false, "score": 0, "creation_date": 1494989950, "post_id": 44014583, "comment_id": 75057318, "body": "Thank you, this works perfectly and I understand it now."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1495005670, "post_id": 44014583, "comment_id": 75063418, "body": "<code>if #{key} == &quot;name&quot;</code> is not equivalent to <code>if key == &quot;name&quot;</code>: the <code>#</code> starts a comment!"}], "tags": [], "owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "is_accepted": true, "score": 4, "last_activity_date": 1494988679, "creation_date": 1494988679, "answer_id": 44014583, "question_id": 44014541, "link": "https://stackoverflow.com/questions/44014541/ruby-key-value-pairs-not-printing-correctly/44014583#44014583", "title": "Ruby key value pairs not printing correctly", "body": "<p>You have an array of hashes, you need to make a nested loop which loops over the array and, for each hash in the array, loops on the key/value pairs:</p>\n\n<pre><code>array.each do |hash|\n  hash.each do |key, value|\n    if key == \"name\"\n      puts \"Name_is=#{key}\"\n    else\n      puts \"#{key}=#{value}\"\n    end\n  end\nend\n</code></pre>\n\n<p>Also I'm not sure why you have <code>if #{key} == \"name\"</code> while you can simply have <code>if key == \"name\"</code>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1143452"}, "is_accepted": false, "score": 0, "last_activity_date": 1495003244, "creation_date": 1495003244, "answer_id": 44017367, "question_id": 44014541, "link": "https://stackoverflow.com/questions/44014541/ruby-key-value-pairs-not-printing-correctly/44017367#44017367", "title": "Ruby key value pairs not printing correctly", "body": "<p>I think this is a Ruby-like solution:</p>\n\n<pre><code>array = [\n  {\n    'name' =&gt; 'Tom',\n    'age' =&gt; '31',\n    'weight' =&gt; '180'\n  },\n  {\n    'name' =&gt; 'Jane',\n    'age' =&gt; '24',\n    'weight' =&gt; '110'\n  }\n]\n\narray.each do |hash|\n  hash['Name_is'] = hash.delete 'name'\n\n  hash.each do |key, value|\n    puts \"#{key}=#{value}\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 2334324, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/73d4019af69d424c0586a4e9c1cd8cec?s=128&d=identicon&r=PG", "display_name": "Mike D", "link": "https://stackoverflow.com/users/2334324/mike-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 44014583, "answer_count": 2, "score": 0, "last_activity_date": 1495003244, "creation_date": 1494988386, "question_id": 44014541, "link": "https://stackoverflow.com/questions/44014541/ruby-key-value-pairs-not-printing-correctly", "title": "Ruby key value pairs not printing correctly", "body": "<p>I am trying to match key value pairs in an array and print them in a clear format: </p>\n\n<pre><code>array = [\n  {\n    'name' =&gt; 'Tom',\n    'age' =&gt; '31',\n    'weight' =&gt; '180'\n  },\n  {\n    'name' =&gt; 'Jane',\n    'age' =&gt; '24',\n    'weight' =&gt; '110'\n  }\n]\n\narray.each do |key, value|\n  if #{key} == \"name\"\n    puts \"Name_is=#{key}\"\n  else\n    puts \"#{key}=#{value}\"\n  end\nend\n</code></pre>\n\n<p>This results in: </p>\n\n<pre><code>Name_is={\"name\"=&gt;\"Tom\", \"age\"=&gt;\"31\", \"weight\"=&gt;\"180\"}\n{\"name\"=&gt;\"Tom\", \"age\"=&gt;\"31\", \"weight\"=&gt;\"180\"}=\nName_is={\"name\"=&gt;\"Jane\", \"age\"=&gt;\"24\", \"weight\"=&gt;\"110\"}\n{\"name\"=&gt;\"Jane\", \"age\"=&gt;\"24\", \"weight\"=&gt;\"110\"}=\n</code></pre>\n\n<p>Expected result is:</p>\n\n<pre><code>Name_is=Tom\nage=31\nweight=180\nName_is=Jane\nage=24\nweight=110\n</code></pre>\n\n<p>What am I not doing right?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "file-upload", "shrine"], "comments": [{"owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "edited": false, "score": 0, "creation_date": 1495029313, "post_id": 44014272, "comment_id": 75080165, "body": "Tus-ruby-server is an encapsulated Rack application, in which way would you like to unify tus-ruby-server&#39;s endpoints with your app&#39;s endpoint?"}, {"owner": {"reputation": 49, "user_id": 3180195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1afbb7d48d0789d7e652ed8a60b39fb?s=128&d=identicon&r=PG", "display_name": "Jacob Prud&#39;homme", "link": "https://stackoverflow.com/users/3180195/jacob-prudhomme"}, "reply_to_user": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "edited": false, "score": 1, "creation_date": 1495033037, "post_id": 44014272, "comment_id": 75083171, "body": "@janko-m in the sense that I can POST to my API endpoint to have the file uploaded to a certain folder and its information saved in the database, and I can use <code>tus-js-client</code> to have the file uploaded to a different folder without saving any records to the database. Is there any way to have it so I can use <code>tus-js-client</code> to upload the file to the same folder that my API would save it in, and also save its record in the database? I got a working example running using tutorials, but the biggest problem is that no database record is created."}, {"owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "edited": false, "score": 0, "creation_date": 1495935623, "post_id": 44014272, "comment_id": 75456580, "body": "That is a good point, unfortunately at the moment <code>tus-ruby-server</code> pretty-much just acts as a black-box Rack endpoint, without the possibility to forward &quot;tus requests&quot; to the main app. I should probably add some kind of hooks, though notice that since <code>Tus::Server</code> is a Roda app you can use Roda&#39;s <code>hooks</code> plugin which allows you to specify <code>before</code> and <code>after</code> blocks. <a href=\"http://roda.jeremyevans.net/rdoc/classes/Roda/RodaPlugins/Hooks.html\" rel=\"nofollow noreferrer\">roda.jeremyevans.net/rdoc/classes/Roda/RodaPlugins/Hooks.htm&zwnj;&#8203;l</a>"}, {"owner": {"reputation": 49, "user_id": 3180195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1afbb7d48d0789d7e652ed8a60b39fb?s=128&d=identicon&r=PG", "display_name": "Jacob Prud&#39;homme", "link": "https://stackoverflow.com/users/3180195/jacob-prudhomme"}, "reply_to_user": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "edited": false, "score": 0, "creation_date": 1496063456, "post_id": 44014272, "comment_id": 75495604, "body": "@janko-m thanks, I&#39;ll check it out!"}], "owner": {"reputation": 49, "user_id": 3180195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1afbb7d48d0789d7e652ed8a60b39fb?s=128&d=identicon&r=PG", "display_name": "Jacob Prud&#39;homme", "link": "https://stackoverflow.com/users/3180195/jacob-prudhomme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 322, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494986277, "creation_date": 1494986277, "question_id": 44014272, "link": "https://stackoverflow.com/questions/44014272/unifying-tus-uploads-with-rails-api-using-shrine", "title": "Unifying tus uploads with Rails API using Shrine", "body": "<p>I recently made a Rails 5 API that uses Shrine for file attachments (videos attached to a model named Upload). The user would send a POST request with the file to <code>hostname.com/api/uploads</code> and a new Upload object would be added to the database.</p>\n\n<p>I have been following tutorials online for adding tus compatibility to Shrine using <code>tus-ruby-server</code> and <code>tus-js-client</code> and they all indicate that there is a separate endpoint (say <code>hostname.com/files</code>) that is used to upload files using tus. Is there any way to unify this endpoint with the endpoint my API app already had for uploading files?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1494984565, "post_id": 44014041, "comment_id": 75055999, "body": "<code>categoy_id </code> is it a typo when you wrote the question?"}, {"owner": {"reputation": 1, "user_id": 8022684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d34439031e5c986572c2f9acbc754d8?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8022684/john"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1494985011, "post_id": 44014041, "comment_id": 75056089, "body": "Yes it it a typo"}, {"owner": {"reputation": 1, "user_id": 8022684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d34439031e5c986572c2f9acbc754d8?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8022684/john"}, "edited": false, "score": 0, "creation_date": 1494985519, "post_id": 44014041, "comment_id": 75056221, "body": "I was told not to use params for security and use portfolio_params instead"}, {"owner": {"reputation": 1, "user_id": 8022684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d34439031e5c986572c2f9acbc754d8?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8022684/john"}, "edited": false, "score": 0, "creation_date": 1494985698, "post_id": 44014041, "comment_id": 75056264, "body": "I still get the same thing"}, {"owner": {"reputation": 1, "user_id": 8022684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d34439031e5c986572c2f9acbc754d8?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8022684/john"}, "edited": false, "score": 0, "creation_date": 1494986212, "post_id": 44014041, "comment_id": 75056415, "body": "That does not work too"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1494989256, "post_id": 44014041, "comment_id": 75057139, "body": "Could you provide a repo?"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1494995469, "post_id": 44014041, "comment_id": 75058672, "body": "You mean the <code>@test</code> variable is null in create method?"}, {"owner": {"reputation": 6105, "user_id": 1700874, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad36477949cfd7db659cd4420537911c?s=128&d=identicon&r=PG&f=1", "display_name": "The Whiz of Oz", "link": "https://stackoverflow.com/users/1700874/the-whiz-of-oz"}, "edited": false, "score": 0, "creation_date": 1495007714, "post_id": 44014041, "comment_id": 75064675, "body": "params: categories: [:id]"}], "owner": {"reputation": 1, "user_id": 8022684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d34439031e5c986572c2f9acbc754d8?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8022684/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495002234, "creation_date": 1494984493, "last_edit_date": 1495002234, "question_id": 44014041, "link": "https://stackoverflow.com/questions/44014041/rails-association-when-you-have-a-drop-down", "title": "Rails association when you have a drop down", "body": "<p>I am using a collection select to display all the categories on the website. </p>\n\n<pre><code>&lt;%= form.collection_select :category_id, Category.all, :id, :name, :prompt =&gt; \"Select category\" %&gt;\n</code></pre>\n\n<p>I also included category_id in the permit params</p>\n\n<pre><code>def portfolio_params\n  params.require(:portfolio).permit(:name, :client, :completed, :about,:square, :cover, :category_id)\nend\n</code></pre>\n\n<p>Shouldn't it form the association using the create method like this </p>\n\n<pre><code> def create\n  @portfolio = Portfolio.new(portfolio_params)\n  @test = portfolio_params[:category_id]\n  respond_to do |format|\n   if @portfolio.save\n    format.html { redirect_to @portfolio, notice: 'Portfolio was successfully created.' }\n    format.json { render :show, status: :created, location: @portfolio }\n  else\n    format.html { render :new }\n    format.json { render json: @portfolio.errors, status: :unprocessable_entity }\n  end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>But when I look at the test variable it shows null. I am really puzzled about this. I am using rails 5 and ruby 2.3.0</p>\n\n<p>Here are the params</p>\n\n<pre><code>&lt;ActionController::Parameters \n  {\"utf8\"=&gt;\"\u2713\", \n   \"authenticity_token\"=&gt;\"XzyeAtZF5mOXG2GdRIrlmRcPwhruAOfrvzIWTD9QUsIJ4GMytB6s38oM3NT9RIwr+B8osJWasmg2Qd0VoROTiw==\", \n   \"portfolio\"=&gt;&lt;ActionController::Parameters\n     {\"name\"=&gt;\"test\", \n      \"client\"=&gt;\"\", \n      \"completed(1i)\"=&gt;\"2017\", \n      \"completed(2i)\"=&gt;\"5\", \n      \"completed(3i)\"=&gt;\"17\", \n      \"about\"=&gt;\"\", \n      \"categoy_id\"=&gt;\"3\"} permitted: false&gt;, \n   \"commit\"=&gt;\"Create Portfolio\", \n   \"controller\"=&gt;\"portfolios\", \n   \"action\"=&gt;\"create\"} permitted: false&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494984491, "post_id": 44013781, "comment_id": 75055983, "body": "If you set Capybara.app_host, that&#39;s where Capybara is going to tell the browser to connect to. Therefore, if your dev env is running on port 3010 you shouldn&#39;t be setting app_host to port 3010"}, {"owner": {"reputation": 163, "user_id": 2347724, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e2a963595df816da93c9aad07fb32502?s=128&d=identicon&r=PG", "display_name": "jonatasdaniel", "link": "https://stackoverflow.com/users/2347724/jonatasdaniel"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494985047, "post_id": 44013781, "comment_id": 75056105, "body": "But if I don&#39;t set app_host I got a reached error, capybara can&#39;t connect to my app. How should it be?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494985264, "post_id": 44013781, "comment_id": 75056150, "body": "app_host needs to be set the address that Capybara will run your app at.  Assuming I&#39;m understanding what you&#39;re doing correctly (running the browser/selenium grid in docker, but capybara on your local machine) then <code>app_host</code> would be set to <code>http:&#47;&#47;#{the ip of your local machine accessible from docker}</code> and you would set <code>Capybara.always_include_port = true</code>"}, {"owner": {"reputation": 163, "user_id": 2347724, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e2a963595df816da93c9aad07fb32502?s=128&d=identicon&r=PG", "display_name": "jonatasdaniel", "link": "https://stackoverflow.com/users/2347724/jonatasdaniel"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494985382, "post_id": 44013781, "comment_id": 75056191, "body": "My capybara is also running inside Docker"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494985816, "post_id": 44013781, "comment_id": 75056293, "body": "If everything is being run in Docker, then you may not need to specify <code>app_host</code> at all, or potentially <code>http:&#47;&#47;#{docker_ip}</code> and set <code>Capybara.always_include_port = true</code> .  It needs to end up being an ip that resolves to one of the interfaces for whatever you&#39;ve set Capybara.server_host to (in your case 0.0.0.0, which means all interfaces on the docker instance)"}, {"owner": {"reputation": 163, "user_id": 2347724, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e2a963595df816da93c9aad07fb32502?s=128&d=identicon&r=PG", "display_name": "jonatasdaniel", "link": "https://stackoverflow.com/users/2347724/jonatasdaniel"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494985955, "post_id": 44013781, "comment_id": 75056344, "body": "But my app will run at dev env, and capybara in test env. That&#39;s the problem I&#39;m having. I don&#39;t know if I&#39;m doing erything right."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494986103, "post_id": 44013781, "comment_id": 75056384, "body": "By default Capybara runs it&#39;s own instance of your app at Capybara.server_host:Capybara.server_port, what your dev instance is being run at is irrelevant (unless you set app_host to point at your dev instance, which is just wrong)"}, {"owner": {"reputation": 163, "user_id": 2347724, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e2a963595df816da93c9aad07fb32502?s=128&d=identicon&r=PG", "display_name": "jonatasdaniel", "link": "https://stackoverflow.com/users/2347724/jonatasdaniel"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494989744, "post_id": 44013781, "comment_id": 75057269, "body": "If I comment the line <code>app_host</code> I got this error:  <code>Selenium::WebDriver::Error::UnknownError:             Reached error page: about:neterror?e=connectionFailure</code>"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494989871, "post_id": 44013781, "comment_id": 75057296, "body": "And did you try setting apphost to <code>http:&#47;&#47;#{docker_ip}</code> and also setting <code>Capybara.always_include_port = true</code> as I suggested?"}, {"owner": {"reputation": 163, "user_id": 2347724, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e2a963595df816da93c9aad07fb32502?s=128&d=identicon&r=PG", "display_name": "jonatasdaniel", "link": "https://stackoverflow.com/users/2347724/jonatasdaniel"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494990102, "post_id": 44013781, "comment_id": 75057360, "body": "Now I have:  <code>Capybara.app_host = &quot;http:&#47;&#47;#{docker_ip}&quot; Capybara.server_host = &#39;0.0.0.0&#39; Capybara.server_port = &#39;3011&#39;  Capybara.always_include_port = true</code>  but I got the same error"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1494993452, "post_id": 44013781, "comment_id": 75058086, "body": "Then there&#39;s something about your setup that you haven&#39;t explained fully, or you&#39;ve changed other Capybara default settings -- As a last resort try setting Capybara.server_host to your docker ip, beyond that I have no idea what you&#39;re doing."}, {"owner": {"reputation": 163, "user_id": 2347724, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e2a963595df816da93c9aad07fb32502?s=128&d=identicon&r=PG", "display_name": "jonatasdaniel", "link": "https://stackoverflow.com/users/2347724/jonatasdaniel"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1495027680, "post_id": 44013781, "comment_id": 75078823, "body": "I have in my docker-compose <code>selenium:     image: selenium&#47;standalone-firefox-debug:3.4.0     ports:       - 4444:4444       - 5900:5900</code>  and in my Dockerfile  That&#39;s what I have"}, {"owner": {"reputation": 535, "user_id": 5121955, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db5d1153ea4146102d5c2b9b54443176?s=128&d=identicon&r=PG&f=1", "display_name": "SanjiBukai", "link": "https://stackoverflow.com/users/5121955/sanjibukai"}, "edited": false, "score": 0, "creation_date": 1498291092, "post_id": 44013781, "comment_id": 76450279, "body": "@jonatasdaniel Hi, did you solve your problem? I have a similar problem <a href=\"https://stackoverflow.com/questions/44732620/rails-system-test-with-capybara-and-headless-selenium-browser-in-docker\">on this SO question here</a>"}, {"owner": {"reputation": 163, "user_id": 2347724, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e2a963595df816da93c9aad07fb32502?s=128&d=identicon&r=PG", "display_name": "jonatasdaniel", "link": "https://stackoverflow.com/users/2347724/jonatasdaniel"}, "reply_to_user": {"reputation": 535, "user_id": 5121955, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db5d1153ea4146102d5c2b9b54443176?s=128&d=identicon&r=PG&f=1", "display_name": "SanjiBukai", "link": "https://stackoverflow.com/users/5121955/sanjibukai"}, "edited": false, "score": 0, "creation_date": 1498476601, "post_id": 44013781, "comment_id": 76497888, "body": "@SanjiBukai I didn&#39;t find any solution, then I moved to poltergeist rather then selenium."}, {"owner": {"reputation": 535, "user_id": 5121955, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db5d1153ea4146102d5c2b9b54443176?s=128&d=identicon&r=PG&f=1", "display_name": "SanjiBukai", "link": "https://stackoverflow.com/users/5121955/sanjibukai"}, "edited": false, "score": 0, "creation_date": 1498554619, "post_id": 44013781, "comment_id": 76533148, "body": "@jonatasdaniel I finally found a <a href=\"https://stackoverflow.com/a/44746792/5121955\">very good solution</a>!"}, {"owner": {"reputation": 163, "user_id": 2347724, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e2a963595df816da93c9aad07fb32502?s=128&d=identicon&r=PG", "display_name": "jonatasdaniel", "link": "https://stackoverflow.com/users/2347724/jonatasdaniel"}, "reply_to_user": {"reputation": 535, "user_id": 5121955, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db5d1153ea4146102d5c2b9b54443176?s=128&d=identicon&r=PG&f=1", "display_name": "SanjiBukai", "link": "https://stackoverflow.com/users/5121955/sanjibukai"}, "edited": false, "score": 0, "creation_date": 1498612119, "post_id": 44013781, "comment_id": 76565042, "body": "@SanjiBukai very interesting, I&#39;ll try this. Do you thin Selenium is better than poltergeist?"}], "answers": [{"tags": [], "owner": {"reputation": 809, "user_id": 4164061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4eca75dce0784171bfdd981c4b104f?s=128&d=identicon&r=PG&f=1", "display_name": "miguel savignano", "link": "https://stackoverflow.com/users/4164061/miguel-savignano"}, "is_accepted": false, "score": 1, "last_activity_date": 1517881903, "creation_date": 1517881903, "answer_id": 48634299, "question_id": 44013781, "link": "https://stackoverflow.com/questions/44013781/capybara-selenium-inside-docker-container/48634299#48634299", "title": "Capybara + Selenium inside Docker container", "body": "<p>In using docker-compose version 3,\nthis works for me</p>\n\n<pre><code>Capybara.register_driver :selenium do |app|\nCapybara::Selenium::Driver.new(app,\n  :browser =&gt; :remote,\n  :url =&gt; \"http://selenium:4444/wd/hub\")\nend\n\nCapybara.app_host = \"http://web:3010\"\nCapybara.server_host = '0.0.0.0'\nCapybara.server_port = '3010'\nCapybara.always_include_port = true\n</code></pre>\n\n<p>docker-compose.yml</p>\n\n<pre><code>version: '3'\nservices:\n  web:\n    build: .\n    depends_on:\n      - db\n      - selenium\n  ...\n  selenium:\n    image: selenium/standalone-firefox-debug:2.47.1\n    ports:\n      - \"4444:4444\"\n  ...\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 2347724, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e2a963595df816da93c9aad07fb32502?s=128&d=identicon&r=PG", "display_name": "jonatasdaniel", "link": "https://stackoverflow.com/users/2347724/jonatasdaniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1180, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1517881903, "creation_date": 1494982247, "question_id": 44013781, "link": "https://stackoverflow.com/questions/44013781/capybara-selenium-inside-docker-container", "title": "Capybara + Selenium inside Docker container", "body": "<p>I'm starting with integration tests and I'm using Docker on my dev env.</p>\n\n<p>I have <code>selenium-webdriver</code> gem installed and this config file:</p>\n\n<pre><code>docker_ip = %x(/sbin/ip route|awk '/default/ { print $3 }').strip\nCapybara.register_driver :selenium do |app|\n  Capybara::Selenium::Driver.new(app,\n  :browser =&gt; :remote,\n  :url =&gt; \"http://#{docker_ip}:4444/wd/hub\")\nend\n\nCapybara.app_host = \"http://#{docker_ip}:3010\"\nCapybara.server_host = '0.0.0.0'\nCapybara.server_port = '3011'\n</code></pre>\n\n<p>and when I run my integration test, it fails because I created a record with FactoryGirl (which creates on test DB) and my app (on port 3010) is running in dev env.\nCapybara should starts by itself my app in test env?\nWhat am I doing wrong?</p>\n\n<p>PS: My app starts on dev end when I run <code>docker-compose up</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter-bootstrap"], "comments": [{"owner": {"reputation": 3624, "user_id": 5615038, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wW8mP.jpg?s=128&g=1", "display_name": "fangxing", "link": "https://stackoverflow.com/users/5615038/fangxing"}, "edited": false, "score": 0, "creation_date": 1494982355, "post_id": 44013737, "comment_id": 75055576, "body": "Related to <a href=\"https://stackoverflow.com/questions/29379979/disable-a-link-in-bootstrap\" title=\"disable a link in bootstrap\">stackoverflow.com/questions/29379979/&hellip;</a>"}, {"owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 1, "creation_date": 1494982476, "post_id": 44013737, "comment_id": 75055600, "body": "Add the <code>disabled</code> class if your link is disabled"}, {"owner": {"reputation": 2785, "user_id": 7503064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T2C-ikRb0Ew/AAAAAAAAAAI/AAAAAAAAADM/Y7xlspIiYvg/photo.jpg?sz=128", "display_name": "I.B", "link": "https://stackoverflow.com/users/7503064/i-b"}, "reply_to_user": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 0, "creation_date": 1494983524, "post_id": 44013737, "comment_id": 75055794, "body": "@LukeS I&#39;m not too sure I understand what you mean.I&#39;m pretty new to Ruby on Rails isn&#39;t this the regular syntax of how to disable something?"}, {"owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 0, "creation_date": 1494987532, "post_id": 44013737, "comment_id": 75056742, "body": "it is, but you also need to add <code>disabled</code> to your list of classes so that Bootstrap recognizes that it&#39;s disabled. The <code>:disabled =&gt; !organisme.active?</code> will set the disabled html attribute to true but bootstrap doesn&#39;t support that. You need to specify it through the <code>class</code> attribute. Hope that&#39;s clearer :)"}], "answers": [{"tags": [], "owner": {"reputation": 3852, "user_id": 1802527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THq66.png?s=128&g=1", "display_name": "Alexis", "link": "https://stackoverflow.com/users/1802527/alexis"}, "is_accepted": true, "score": 2, "last_activity_date": 1494989308, "creation_date": 1494989308, "answer_id": 44014672, "question_id": 44013737, "link": "https://stackoverflow.com/questions/44013737/disabling-link-and-keep-bootstrap-style/44014672#44014672", "title": "Disabling link and keep bootstrap style", "body": "<pre><code>&lt;% if organisme.active? %&gt;\n    &lt;%= link_to 'Show', organismereferent_path(organisme), class: 'btn btn-info'%&gt;\n&lt;% else %&gt;\n    &lt;%= link_to '#', organismereferent_path(organisme), class: 'btn btn-info disabled', :disabled =&gt; true %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>or if the class is enough</p>\n\n<pre><code>&lt;%= link_to 'Show', organismereferent_path(organisme), class: \"btn btn-info#{organisme.active? ? ' disabled' : nil }\"%&gt;\n</code></pre>\n"}], "owner": {"reputation": 2785, "user_id": 7503064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T2C-ikRb0Ew/AAAAAAAAAAI/AAAAAAAAADM/Y7xlspIiYvg/photo.jpg?sz=128", "display_name": "I.B", "link": "https://stackoverflow.com/users/7503064/i-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1205, "favorite_count": 1, "accepted_answer_id": 44014672, "answer_count": 1, "score": 0, "last_activity_date": 1494989308, "creation_date": 1494981840, "question_id": 44013737, "link": "https://stackoverflow.com/questions/44013737/disabling-link-and-keep-bootstrap-style", "title": "Disabling link and keep bootstrap style", "body": "<p>I have a link that has a <code>class: 'btn btn-info'</code> style on it. The problem is when I disable the link the bootstrap style doesn't appear I only get a plain text.</p>\n\n<pre><code>&lt;%= link_to_if organisme.active?, 'Show', organismereferent_path(organisme), class: 'btn btn-info', :disabled =&gt; !organisme.active? %&gt;\n</code></pre>\n\n<p>What I tried to do is change the <code>link_to_if</code> for a <code>button_to</code></p>\n\n<pre><code>&lt;%= button_to 'Show', organismereferent_path(organisme), class: 'btn btn-info', :disabled =&gt; !organisme.active? %&gt;\n</code></pre>\n\n<p>This works but now the button does not send the user to the right place it stays on the same page. What is the correct way of handling this situation?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1494982857, "post_id": 44013833, "comment_id": 75055673, "body": "If you want a Subdoc to belong to many Masters then use a join table and declare the association as <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"nofollow noreferrer\"><code>has_many :through</code></a>."}, {"owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "edited": false, "score": 0, "creation_date": 1494983017, "post_id": 44013833, "comment_id": 75055704, "body": "Although what you&#39;re saying makes logical sense but I&#39;m working on a legacy application and I&#39;m not allowed to make changes to the database. I need to use the existing table and models to do this :/"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "edited": false, "score": 1, "creation_date": 1494983652, "post_id": 44013833, "comment_id": 75055824, "body": "I guess my only advice then is to run away from the project as fast you can."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 2, "last_activity_date": 1494982728, "creation_date": 1494982728, "answer_id": 44013833, "question_id": 44013684, "link": "https://stackoverflow.com/questions/44013684/delete-value-from-serialized-array-in-activerecord-model/44013833#44013833", "title": "Delete value from serialized Array in ActiveRecord model", "body": "<p>You don't want to use an array here. Especially not a serialized array:</p>\n\n<ul>\n<li>You have to scan a string to be able use the column in a query.</li>\n<li>ActiveRecord associations are built to work with actual foreign key columns. So are relational databases.</li>\n<li>You get no referential integrity.</li>\n</ul>\n\n<p>So start by creating a migration <code>rails g migration add_master_to_subdocs</code></p>\n\n<pre><code>class AddMasterToSubdocs &lt; ActiveRecord::Migration[5.0]\n  def change\n    add_reference :subdocs, :master, foreign_key: true\n    remove_column :subdocs, :user_id\n  end\nend\n</code></pre>\n\n<p>We are also removing the <code>user_id</code> column since it won't be needed:</p>\n\n<pre><code>class Master &lt; ActiveRecord::Base\n  belongs_to :user\n  has_many :submasters\n  has_many :subdocs\nend\n\nclass Subdocs &lt; ActiveRecord::Base\n  belongs_to :master\n  has_one :user, through: :master\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "is_accepted": true, "score": 0, "last_activity_date": 1494982984, "creation_date": 1494982984, "answer_id": 44013864, "question_id": 44013684, "link": "https://stackoverflow.com/questions/44013684/delete-value-from-serialized-array-in-activerecord-model/44013864#44013864", "title": "Delete value from serialized Array in ActiveRecord model", "body": "<p>While I agree with max and you should not use this architecture, assuming you keep it as is, you will need to delete the item from the array in master and save master.</p>\n\n<pre><code>def destroy\n  @masters = {}\n  @subdoc = Subdoc.find(params[:id])\n  @masters = current_user.user.masters\n  @masters.each do |master| \n    if master.subdocs.index(params[:id])\n      master.subdocs.delete(params[:id])\n      master.save!\n    end\n  end  \n\n  @subdoc.destroy\n  return render :status =&gt; 200, :json =&gt; { :success =&gt; true }    \nend\n</code></pre>\n"}], "owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 44013864, "answer_count": 2, "score": 0, "last_activity_date": 1494982984, "creation_date": 1494981393, "question_id": 44013684, "link": "https://stackoverflow.com/questions/44013684/delete-value-from-serialized-array-in-activerecord-model", "title": "Delete value from serialized Array in ActiveRecord model", "body": "<p>I have a rails model set up as:</p>\n\n<pre><code>class Master &lt; ActiveRecord::Base\n  belongs_to :user\n  has_many :submasters\n  serialize :subdocs, Array\nend\n</code></pre>\n\n<p>It has a serialized <code>array</code> of <code>submaster_docs</code> which stores the <code>id</code> of the connected <code>subdocs</code> and my model for <code>Subdocs</code> is:</p>\n\n<pre><code>class Subdocs &lt; ActiveRecord::Base\n  belongs_to :user\nend\n</code></pre>\n\n<p>Now I have a rails method which deletes a <code>subdoc</code> when user clicks on the delete button. </p>\n\n<p>While deleting the Subdocs entries I want to remove the id of the <code>Subdocs</code> from <code>Master</code> also so that it doesn't try to create an association between them even after deleting <code>Subdocs</code></p>\n\n<p>My database entry of <code>Master</code> looks as follows:</p>\n\n<pre><code>&lt;ActiveRecord::Relation [#&lt;Master id: 3, user_id: 1, name: \"Being Batman\", description: \"Every man who has lotted here over the centuries, ...\", subdocs: [\"5\"]&gt;]&gt; \n</code></pre>\n\n<p>Database entry of <code>subdoc</code>:</p>\n\n<pre><code>&lt;ActiveRecord::Relation [#&lt;Subdoc id: 5, user_id: 1, name: \"subdoc1.pdf\"&gt;]&gt; \n</code></pre>\n\n<p>Over here for example if a user deletes the subdoc 5 then I want to remove that value from <code>subdocs</code> array of all <code>Master</code>'s</p>\n\n<p>My method for deleting the subdocs is as follows:</p>\n\n<pre><code>def destroy\n  @masters = {}\n  @subdoc = Subdoc.find(params[:id])\n  @masters = current_user.user.masters\n\n  # Tried these methods to delete the value.\n  # @subdocs = @masters.select { |t| t.subdocs.to_a - [params[:id]] }\n  # @subdocs = @masters.each { |t| t[:subdocs] - params[:id] }   \n\n  @subdoc.destroy\n  return render :status =&gt; 200, :json =&gt; { :success =&gt; true }    \nend\n</code></pre>\n\n<p>But this throws me the error: <code>No Implicit conversion of String into Array</code></p>\n\n<p>How can I correct this? Thanks!</p>\n"}, {"tags": ["ruby", "google-chrome", "firefox", "methods", "cucumber"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494982006, "post_id": 44012909, "comment_id": 75055518, "body": "&quot;<a href=\"http://catb.org/esr/faqs/smart-questions.html\" rel=\"nofollow noreferrer\">How To Ask Questions The Smart Way</a>&quot; will be useful to you. &quot; I need to write a class to call a method. I tried it but didn&#39;t succeed.&quot; And, where is it? Why didn&#39;t it succeed? Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and &quot;<a href=\"http://meta.stackoverflow.com/questions/261592\">How much research effort is expected of Stack Overflow users?</a>&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 223, "user_id": 7953991, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZoKMJd3UU5E/AAAAAAAAAAI/AAAAAAAAC_Q/PReVbmHDe9w/photo.jpg?sz=128", "display_name": "toouur", "link": "https://stackoverflow.com/users/7953991/toouur"}, "edited": false, "score": 0, "creation_date": 1494976142, "post_id": 44012985, "comment_id": 75054227, "body": "&gt;some flag change will likely fix that thanks fot this. gonna google &gt;The code error is a typo shame on me &gt;&lt;"}, {"owner": {"reputation": 223, "user_id": 7953991, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZoKMJd3UU5E/AAAAAAAAAAI/AAAAAAAAC_Q/PReVbmHDe9w/photo.jpg?sz=128", "display_name": "toouur", "link": "https://stackoverflow.com/users/7953991/toouur"}, "edited": false, "score": 0, "creation_date": 1494978439, "post_id": 44012985, "comment_id": 75054791, "body": "em. should I paste my scenario code into the parentheses? then what do they mean by &quot;closing routine&quot;. I&#39;m afraid I don&#39;t quite understand it=\\"}], "tags": [], "owner": {"reputation": 995, "user_id": 1148163, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9e9b7487dfc0324dca8b49395d1a267b?s=128&d=identicon&r=PG", "display_name": "mr12086", "link": "https://stackoverflow.com/users/1148163/mr12086"}, "is_accepted": false, "score": 0, "last_activity_date": 1494982303, "last_edit_date": 1495540490, "creation_date": 1494975856, "answer_id": 44012985, "question_id": 44012909, "link": "https://stackoverflow.com/questions/44012909/how-to-write-a-simple-cucumber-script/44012985#44012985", "title": "How to write a simple Cucumber script", "body": "<p>Connection refused, I'm unsure but \"<a href=\"https://stackoverflow.com/questions/9023273/watircucumber-connection-refused\">Watir+Cucumber Connection refused</a>\" looks a fix.</p>\n\n<p>Copy pasta:</p>\n\n<pre><code>AfterConfiguration do |config|\n   yourCodeStartUp()                    # Put your SETUP code here including the launch of webdriver\n   at_exit \n       yourCodeTearDown()               # Put your CLOSING routine here\n       puts 'stopped'\n   end\nend\n</code></pre>\n\n<p>The code error is a typo, it should be <code>browser.text_field(...</code></p>\n"}, {"comments": [{"owner": {"reputation": 223, "user_id": 7953991, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZoKMJd3UU5E/AAAAAAAAAAI/AAAAAAAAC_Q/PReVbmHDe9w/photo.jpg?sz=128", "display_name": "toouur", "link": "https://stackoverflow.com/users/7953991/toouur"}, "edited": false, "score": 0, "creation_date": 1495054897, "post_id": 44032562, "comment_id": 75096052, "body": "hi. yep, I&#39;ve already corrected my typo, script is running in firefox. regarding chrome i believe I&#39;ve used 2.29 but I&#39;ll 2check. The PATH is ok."}], "tags": [], "owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "is_accepted": false, "score": 0, "last_activity_date": 1495047472, "last_edit_date": 1495047472, "creation_date": 1495046452, "answer_id": 44032562, "question_id": 44012909, "link": "https://stackoverflow.com/questions/44012909/how-to-write-a-simple-cucumber-script/44032562#44032562", "title": "How to write a simple Cucumber script", "body": "<p>Regarding the issue you are observing on chrome, it sounds like you need to update <a href=\"https://sites.google.com/a/chromium.org/chromedriver/downloads\" rel=\"nofollow noreferrer\"><code>chromedriver</code></a> (and make sure the exe is in PATH).  If you are running chrome v56-58, you need ChromeDriver 2.29.</p>\n\n<p>Regarding the <code>NoMethodError: undefined method</code> error, you have a typo when you call the <code>text_field</code> method (i.e. <code>browser.text_filed</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1495065658, "post_id": 44034906, "comment_id": 75099705, "body": "If the root issues were typo and config-related, it&#39;s probably best to just delete this question.  The chromedriver question has been answered numerous times."}], "tags": [], "owner": {"reputation": 223, "user_id": 7953991, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZoKMJd3UU5E/AAAAAAAAAAI/AAAAAAAAC_Q/PReVbmHDe9w/photo.jpg?sz=128", "display_name": "toouur", "link": "https://stackoverflow.com/users/7953991/toouur"}, "is_accepted": false, "score": 0, "last_activity_date": 1495055700, "creation_date": 1495055700, "answer_id": 44034906, "question_id": 44012909, "link": "https://stackoverflow.com/questions/44012909/how-to-write-a-simple-cucumber-script/44034906#44034906", "title": "How to write a simple Cucumber script", "body": "<p>Nope, I was mistaken, I had an older version of chromedriver. Now it's running in chrome as well. Thank you very much. Appreciate your time!</p>\n\n<p>So, the answers are:\n1. Update chromedriver.\n2. Check your code for typos one more time.</p>\n\n<p>Was really easy but took me a lot of time%</p>\n"}], "owner": {"reputation": 223, "user_id": 7953991, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZoKMJd3UU5E/AAAAAAAAAAI/AAAAAAAAC_Q/PReVbmHDe9w/photo.jpg?sz=128", "display_name": "toouur", "link": "https://stackoverflow.com/users/7953991/toouur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1495055700, "creation_date": 1494975413, "last_edit_date": 1494982156, "question_id": 44012909, "link": "https://stackoverflow.com/questions/44012909/how-to-write-a-simple-cucumber-script", "title": "How to write a simple Cucumber script", "body": "<p>I'm following the tutorial to run my first Cucumber script:</p>\n\n<pre><code>Feature: guru99 Demopage Login   \nIn order to Login in Demopage we have to enter login details\n\nScenario: \nRegister On Guru99 Demopage without email\nGiven I am on the Guru99 homepage\nWhen enter blank details for register\nThen error email shown\n</code></pre>\n\n<p>I have the project in Idea but when I run it I get errors.</p>\n\n<p>When using chrome:</p>\n\n<pre><code>Failed to open TCP connection to 127.0.0.1:9515 (No connection could be made because the target machine actively refused it.\n</code></pre>\n\n<p>I have no idea how to resolve it.</p>\n\n<p>When using Firefox, the script successfully opens the browser but fails after that:</p>\n\n<pre><code>require 'watir'\nrequire 'colorize'\nSelenium::WebDriver::Firefox::Binary.path='C:\\soft\\Mozilla Firefox\\firefox.exe'\ncase ENV['BROWSER']\n  when 'chrome'\n    browser = Watir::Browser.new :chrome\n  when 'firefox'\n    browser = Watir::Browser.new :firefox\nend\n\nGiven(/^I am on the Guru99 homepage$/)do\n  @browser = Watir::Browser.new :firefox\n  @browser.goto \"http://demo.guru99.com\"\nend\n\nWhen(/^enter blank details for register$/) do\n  browser.text_filed(:name,\"emaiid\").set(\"\")\n  browser.button(:name,\"btnLogin\").click\nend\n\nThen(/^error email shown$/) do\n  puts \"Email is Required!\".red\n  browser.close\nend\n</code></pre>\n\n<p>And returns:</p>\n\n<pre><code>NoMethodError: undefined method `text_filed' for nil:NilClass\n</code></pre>\n\n<p>on this line:</p>\n\n<pre><code>browser.text_filed(:name,\"emaiid\").set(\"\")\n</code></pre>\n\n<p>I found some references that I need to write a class to call a method. I tried it but didn't succeed. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494982424, "post_id": 44012839, "comment_id": 75055589, "body": "Welcome to Stack Overflow. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. We need you to put in effort to format your document correctly, and use correct grammar and spelling. SO isn&#39;t a discussion list, it&#39;s an online reference book, and as such, grammar, spelling and readability are important."}, {"owner": {"reputation": 487, "user_id": 7847797, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-k7pSuJNJeV4/AAAAAAAAAAI/AAAAAAAAApY/6cIE0jxiCM8/photo.jpg?sz=128", "display_name": "jacques Mesnet", "link": "https://stackoverflow.com/users/7847797/jacques-mesnet"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494984073, "post_id": 44012839, "comment_id": 75055917, "body": "Ok, @theTinMan, I&#39;m gonna make an effort for that. But I&#39;m not a native english, so I do my best about the grammar ;)"}], "answers": [{"comments": [{"owner": {"reputation": 487, "user_id": 7847797, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-k7pSuJNJeV4/AAAAAAAAAAI/AAAAAAAAApY/6cIE0jxiCM8/photo.jpg?sz=128", "display_name": "jacques Mesnet", "link": "https://stackoverflow.com/users/7847797/jacques-mesnet"}, "edited": false, "score": 0, "creation_date": 1494977697, "post_id": 44013090, "comment_id": 75054624, "body": "Thanks @rohan, and how should i call the &lt;%=@requests%&gt; after that ?"}, {"owner": {"reputation": 487, "user_id": 7847797, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-k7pSuJNJeV4/AAAAAAAAAAI/AAAAAAAAApY/6cIE0jxiCM8/photo.jpg?sz=128", "display_name": "jacques Mesnet", "link": "https://stackoverflow.com/users/7847797/jacques-mesnet"}, "edited": false, "score": 0, "creation_date": 1494977857, "post_id": 44013090, "comment_id": 75054659, "body": "I&#39;ve tried something like that : group(:requests).each but is not working :("}, {"owner": {"reputation": 1476, "user_id": 3282479, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45e313bf91a74f84cb6dfc02625797de?s=128&d=identicon&r=PG&f=1", "display_name": "rohan", "link": "https://stackoverflow.com/users/3282479/rohan"}, "reply_to_user": {"reputation": 487, "user_id": 7847797, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-k7pSuJNJeV4/AAAAAAAAAAI/AAAAAAAAApY/6cIE0jxiCM8/photo.jpg?sz=128", "display_name": "jacques Mesnet", "link": "https://stackoverflow.com/users/7847797/jacques-mesnet"}, "edited": false, "score": 0, "creation_date": 1494978111, "post_id": 44013090, "comment_id": 75054717, "body": "your code in the view is fine. you have to loop through groups. But since you have already eager-loaded associated requests in memory, it will not make sql query to get them. Maybe, you can save a line of code by writing g.requests.each do |r| in the view. But it is same thing"}, {"owner": {"reputation": 487, "user_id": 7847797, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-k7pSuJNJeV4/AAAAAAAAAAI/AAAAAAAAApY/6cIE0jxiCM8/photo.jpg?sz=128", "display_name": "jacques Mesnet", "link": "https://stackoverflow.com/users/7847797/jacques-mesnet"}, "edited": false, "score": 0, "creation_date": 1494978268, "post_id": 44013090, "comment_id": 75054753, "body": "Cool, that&#39;s exactly what i&#39;m looking for, your making my day much better like this @rohan."}], "tags": [], "owner": {"reputation": 1476, "user_id": 3282479, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45e313bf91a74f84cb6dfc02625797de?s=128&d=identicon&r=PG&f=1", "display_name": "rohan", "link": "https://stackoverflow.com/users/3282479/rohan"}, "is_accepted": true, "score": 2, "last_activity_date": 1494978153, "last_edit_date": 1494978153, "creation_date": 1494976579, "answer_id": 44013090, "question_id": 44012839, "link": "https://stackoverflow.com/questions/44012839/how-to-use-include-or-join-into-with-a-each-method/44013090#44013090", "title": "How to use include or join into with a each method", "body": "<p>In your controller, add includes like this to preload requests and avoid n+1 queries.</p>\n\n<pre><code>def index\n  @groups = current_user.groups.includes(:requests)\nend\n</code></pre>\n\n<p>View is fine, but you can also write as:-</p>\n\n<pre><code>&lt;% @groups.each do |g| %&gt;\n  &lt;MODAL&gt;\n    &lt;% g.requests.each do |r| %&gt;\n      &lt;%= r.date %&gt;\n    &lt;% end %&gt;\n  &lt;/MODAL&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 7847797, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-k7pSuJNJeV4/AAAAAAAAAAI/AAAAAAAAApY/6cIE0jxiCM8/photo.jpg?sz=128", "display_name": "jacques Mesnet", "link": "https://stackoverflow.com/users/7847797/jacques-mesnet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 44013090, "answer_count": 1, "score": 0, "last_activity_date": 1494983554, "creation_date": 1494974982, "last_edit_date": 1494983554, "question_id": 44012839, "link": "https://stackoverflow.com/questions/44012839/how-to-use-include-or-join-into-with-a-each-method", "title": "How to use include or join into with a each method", "body": "<p>I need a little advice about the <code>join</code> and <code>includes</code> methods.</p>\n\n<p>I display a list of groups in the index view. Each has a modal associated, and, in this modal, I would like to display the requests associated to this group. Normally, I'd use <code>@requests = group.requests</code>, but would like to use <code>join</code> for sending just one request to my database. </p>\n\n<p>Since I'm in the index view, I don't have a <code>@</code>group in my action. </p>\n\n<p>controller: </p>\n\n<pre><code>def index\n  @groups = current_user.groups\nend \n</code></pre>\n\n<p>view (index):</p>\n\n<pre><code>&lt;% @groups.each do |g| %&gt;\n  &lt;MODAL&gt;\n    &lt;% @requests = g.requests %&gt;\n    &lt;% @requests.each do |r| %&gt;\n      &lt;%= r.date %&gt;\n    &lt;% end %&gt;\n  &lt;/MODAL&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I guess I can also use <code>join</code> and <code>include</code> for <code>@groups</code>, but there is already one SQL request, so I'm good with it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1494974411, "post_id": 44012645, "comment_id": 75053625, "body": "Could you post your routes.rb file? Also, from the command line, type <code>rake routes</code> and post the result."}, {"owner": {"reputation": 2785, "user_id": 7503064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T2C-ikRb0Ew/AAAAAAAAAAI/AAAAAAAAADM/Y7xlspIiYvg/photo.jpg?sz=128", "display_name": "I.B", "link": "https://stackoverflow.com/users/7503064/i-b"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1494974695, "post_id": 44012645, "comment_id": 75053729, "body": "@moveson Added it."}], "answers": [{"comments": [{"owner": {"reputation": 2785, "user_id": 7503064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T2C-ikRb0Ew/AAAAAAAAAAI/AAAAAAAAADM/Y7xlspIiYvg/photo.jpg?sz=128", "display_name": "I.B", "link": "https://stackoverflow.com/users/7503064/i-b"}, "edited": false, "score": 0, "creation_date": 1494976268, "post_id": 44012905, "comment_id": 75054260, "body": "Thank you so much it works perfectly and now I understand a little bit more how things work in rails :) Is there any way of making the page refresh itself after the changes? Forget it I added <code>redirect_to organismereferents_path</code> and it does the trick. Thanks so much for your help :)"}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": true, "score": 1, "last_activity_date": 1494975758, "last_edit_date": 1494975758, "creation_date": 1494975387, "answer_id": 44012905, "question_id": 44012645, "link": "https://stackoverflow.com/questions/44012645/changing-boolean-value-from-view/44012905#44012905", "title": "Changing boolean value from view", "body": "<p>We have a few problems here. </p>\n\n<p>First, in your views, the <code>link_to</code> helper <code>method</code> parameter doesn't want to know the name of your controller action. It wants to know the http method to use. For the actions you are doing, I think the most appropriate would be <code>PATCH</code>. So change those lines to <code>method: :patch</code>.</p>\n\n<p>Second, you need to update your <code>routes.rb</code> file to include the routes you need. You can do that by replacing <code>resources :organismereferents</code> with the following:</p>\n\n<pre><code>resources :organismereferents do\n  member { patch :activate }\n  member { patch :deactivate }\nend\n</code></pre>\n\n<p>Using the <code>member</code> designation indicates to Rails that you want to include an <code>:id</code> param in the URL. Now when you run <code>rake routes</code> you should see, in addition to what you already have, the following:</p>\n\n<pre><code>activate_organismereferents   PATCH  /organismereferents/:id/activate(.:format)   organismereferents#activate\ndeactivate_organismereferents PATCH  /organismereferents/:id/deactivate(.:format) organismereferents#deactivate\n</code></pre>\n\n<p>Third, you need to fix your path helpers. The first column returned by <code>rake routes</code> tells you the name of the Rails helper path that you can use in your <code>link_to</code> helpers. So in your Activate link, you'll need to change <code>organismereferent_path(organisme)</code> to <code>activate_organismereferent_path(organisme)</code>, and in your Deactivate link, use <code>deactivate_organismereferent_path(organisme)</code>.</p>\n\n<p>Finally, in your controller actions, you are not saving the records after you change the boolean value. You will need to call <code>@organisme.save</code> to persist the change. Or if you would prefer to make the change and save it in a single line, you can use <code>@organisme.update(active: true)</code> and <code>@organisme.update(active: false)</code>.</p>\n"}], "owner": {"reputation": 2785, "user_id": 7503064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T2C-ikRb0Ew/AAAAAAAAAAI/AAAAAAAAADM/Y7xlspIiYvg/photo.jpg?sz=128", "display_name": "I.B", "link": "https://stackoverflow.com/users/7503064/i-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1032, "favorite_count": 0, "accepted_answer_id": 44012905, "answer_count": 1, "score": 0, "last_activity_date": 1494975758, "creation_date": 1494973893, "last_edit_date": 1494974659, "question_id": 44012645, "link": "https://stackoverflow.com/questions/44012645/changing-boolean-value-from-view", "title": "Changing boolean value from view", "body": "<p>I have a model <code>organismereferent</code> which has a boolean value named <code>active</code>. What I'm trying to do is depending on what value it has do a different action.</p>\n\n<p>So if it's active the button shows deactivate and allows the user to set active to false. So after that the button should show activate which will allow the user to set active back to true.</p>\n\n<p>I tried making a method in my controller then calling that method from my index view but it gives me a <code>No route matches [POST] \"/organismereferents/8\"</code>. I'm pretty new to Ruby on Rails so there must be an easier way to accomplish that</p>\n\n<p>View:</p>\n\n<pre><code>&lt;table class=\"table table-hover\"&gt;\n\n&lt;tr&gt;\n    &lt;th&gt;Nom Organisation&lt;/th&gt;\n    &lt;th&gt;Site Web&lt;/th&gt;\n&lt;/tr&gt;\n\n&lt;% @organismes.each do |organisme| %&gt;\n    &lt;tr&gt;\n        &lt;td&gt;&lt;%= organisme.nom_organisation %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= organisme.site_web %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Show', organismereferent_path(organisme), class: 'btn btn-info' %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Edit', edit_organismereferent_path(organisme), class: 'btn btn-warning' %&gt;&lt;/td&gt;\n\n        &lt;% if organisme.active == false %&gt;\n\n        &lt;td&gt;&lt;%= link_to 'Activate', organismereferent_path(organisme), class: 'btn btn-danger',\n                method: :activate,\n                data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n        &lt;% else %&gt;\n\n        &lt;td&gt;&lt;%= link_to 'Deactivate', organismereferent_path(organisme), class: 'btn btn-danger',\n                method: :deactivate,\n                data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n\n        &lt;% end %&gt;\n\n    &lt;/tr&gt;\n&lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>def index\n  @organismes = Organismereferent.all\nend\n\ndef deactivate\n  @organisme = Organismereferent.find(params[:id])\n  @organisme.active = false\nend\n\ndef activate\n  @organisme = Organismereferent.find(params[:id])\n  @organisme.active = true\nend\n</code></pre>\n\n<p>If you need any more information I will be glad too add it.</p>\n\n<p>Routes:</p>\n\n<pre><code>Rails.application.routes.draw do\n# For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nget 'master/index'\n\nresources :organismereferents\n\n# Notre page principal\nroot 'master#index'\nend\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cRdkG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cRdkG.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "multithreading"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1494973059, "post_id": 44012432, "comment_id": 75053117, "body": "Threads are not the same as separate sub-shells or separate invocations of Ruby and a script nor are they in parallel; They share the same interpreter, environment and <code>ENV</code>. &quot;Without solving this problem, I can&#39;t use Threads at all.&quot; Well, that&#39;s dramatic. Threads aren&#39;t the solution to every problem, but they&#39;re very useful, however without an understanding of your goal we can&#39;t help much. Perhaps your decision to use threads resulted in an &quot;<a href=\"https://meta.stackexchange.com/q/66377/153968\">XY Problem</a>&quot; and there might have been a better way to go."}, {"owner": {"reputation": 155, "user_id": 5306768, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/90a110eea5d8e9fe3a9733fb33c41d56?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/5306768/jon"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494973890, "post_id": 44012432, "comment_id": 75053442, "body": "The reason I chose Threads is I have like 100 DBs in a server. It will take too long to execute a SQL serially. How do u run a code in parallel with a different ENV like ORACLE_SID different for each DB? I chose above simple code to really pinpoint the problem I&#39;m facing now. Any comment is welcome"}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 1, "creation_date": 1494974384, "post_id": 44012432, "comment_id": 75053612, "body": "@Jon: Probably by using database software/APIs that are intended to be used that way. I know it sounds dismissive, but there is a point beyond which trying to contort software into circumstances it wasn&#39;t designed for isn&#39;t worth it unless you&#39;re doing legacy maintenance."}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 1, "creation_date": 1494978057, "post_id": 44012432, "comment_id": 75054706, "body": "Oh boy. I can&#39;t wait for you to find out that MRI ruby threads aren&#39;t executed in parallel and that they&#39;re subject to the global interpreter lock. If you&#39;re trying to parallelize a SQL query across an array of instances and you landed on Ruby as the tool to do it, you must be very at odds with engineering."}, {"owner": {"reputation": 155, "user_id": 5306768, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/90a110eea5d8e9fe3a9733fb33c41d56?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/5306768/jon"}, "reply_to_user": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 0, "creation_date": 1494978108, "post_id": 44012432, "comment_id": 75054716, "body": "@Linuxios, just from above code, ENV can be set per thread? If not, what other options available? Please don&#39;t tell me database API. I&#39;ve been an oracle dba for 20 years. that is not really my question here."}, {"owner": {"reputation": 155, "user_id": 5306768, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/90a110eea5d8e9fe3a9733fb33c41d56?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/5306768/jon"}, "reply_to_user": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1494978232, "post_id": 44012432, "comment_id": 75054745, "body": "@coreyward, is it possible to print x2.rb like x1.rb or do you have any other way to do it ?"}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 1, "creation_date": 1494978269, "post_id": 44012432, "comment_id": 75054754, "body": "@Jon: Even on a Ruby implementation that <i>isn&#39;t</i> MRI (the one post people use, which doesn&#39;t even have real threads), the threads are going to be child processes/threads of the main process, and as such, will share its environment variables on any system I can think of. However, it <i>is</i> possible (though I don&#39;t remember the details) to spawn another process with different environment variables than your own without changing yours, which I have a feeling is what you actually need to do."}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 1, "creation_date": 1494978419, "post_id": 44012432, "comment_id": 75054786, "body": "Here&#39;s another idea: instead of insisting on using ENV or arguments, write your configuration data to a file. Load it in the main thread and spawn off workers based on the configuration. Still, you&#39;re using a wrench to do open heart surgery."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494981749, "post_id": 44012432, "comment_id": 75055460, "body": "Running 100 threads at a time is doable but it doesn&#39;t seem like a good solution. Again, without more information we&#39;re having to make broad suggestions, but I&#39;d probably write a small app that is used to talk to any DB, depending on the DSN passed to it, and that can accept a query, and returns a result set as JSON, then write code that calls that script. Then you can use sub-shells and their individual ENVs. The calling program would have to wait for the sub shells to finish and would then process the results. The Open3 and JSON classes will be your friends. I&#39;d also look at the Sequel gem."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1143452"}, "is_accepted": false, "score": 1, "last_activity_date": 1495018613, "creation_date": 1495018613, "answer_id": 44022898, "question_id": 44012432, "link": "https://stackoverflow.com/questions/44012432/ruby-how-to-set-env-variable-in-each-thread/44022898#44022898", "title": "ruby, how to set ENV variable in each thread?", "body": "<p>If you join your threads like this, it will work:</p>\n\n<pre><code>test_hash.each do |k, v|\n  Thread.new(k, v)  do |k, v|\n    test_env(k, v)\n  end.join\nend\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5306768, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/90a110eea5d8e9fe3a9733fb33c41d56?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/5306768/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1495018613, "creation_date": 1494972630, "question_id": 44012432, "link": "https://stackoverflow.com/questions/44012432/ruby-how-to-set-env-variable-in-each-thread", "title": "ruby, how to set ENV variable in each thread?", "body": "<p>I'm trying to run a ruby code in parallel using Threads like x2.rb.\nI've pasted here a sample code as simple as possible for my problem.\nIn here, I can't figure out why ENV is not set differently per thread. I've been stuck with this. Can anyone help me out?\nWithout solving this problem, I can't use Threads at all.</p>\n\n<pre><code># ./x1.rb\ntest1 a .. a .. {\"TEST\"=&gt;\"a\"}\ntest1 b .. b .. {\"TEST\"=&gt;\"b\"}\ntest1 c .. c .. {\"TEST\"=&gt;\"c\"}\n\n# ./x2.rb\n\ntest1 a .. a .. {\"TEST\"=&gt;\"c\"}       # this needs to be {\"TEST\"=&gt;\"a\"}\ntest1 b .. b .. {\"TEST\"=&gt;\"c\"}       # this needs to be {\"TEST\"=&gt;\"b\"}\ntest1 c .. c .. {\"TEST\"=&gt;\"c\"}       # this needs to be {\"TEST\"=&gt;\"c\"}\n\nx1.rb:\n\n#!/usr/bin/ruby\n\ntest_hash = {'a': 1, 'b': 2, 'c': 3}\n\ndef test_env(k, v)\n  ENV.clear\n  ENV['TEST'] = k.to_s\n  print \"test1 #{k} .. #{ENV['TEST']} .. \"\n  p ENV\n  # run_cmd(ENV, \"cmd to run\")\nend\n\ntest_hash.each do |k, v|\n  test_env(k, v)\nend\n\nx2.rb:\n\n#!/usr/bin/ruby\n\ntest_hash = {'a': 1, 'b': 2, 'c': 3}\nthreads = []\n\ndef test_env(k, v)\n  ENV.clear\n  ENV['TEST'] = k.to_s\n  print \"\\ntest1 #{k} .. #{ENV['TEST']} .. \"\n  p ENV\n  # run_cmd(ENV, \"cmd to run\")\nend\n\ntest_hash.each do |k, v|\n  threads &lt;&lt; Thread.new(k, v)  do |k, v|\n    test_env(k, v)\n  end\nend\n\nthreads.each(&amp;:join)\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1494971337, "post_id": 44011556, "comment_id": 75052426, "body": "What exactly is your question?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 3, "creation_date": 1494974594, "post_id": 44011556, "comment_id": 75053686, "body": "Did you post the answer as part of the question?? (Move it into an answer below.)"}, {"owner": {"reputation": 419, "user_id": 7724157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iGIzu.jpg?s=128&g=1", "display_name": "Nico Brenner", "link": "https://stackoverflow.com/users/7724157/nico-brenner"}, "edited": false, "score": 0, "creation_date": 1495227517, "post_id": 44011556, "comment_id": 75181764, "body": "Thank you Holger and Tom for your comments. Edited the question to clarify and posted the solution as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 419, "user_id": 7724157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iGIzu.jpg?s=128&g=1", "display_name": "Nico Brenner", "link": "https://stackoverflow.com/users/7724157/nico-brenner"}, "is_accepted": false, "score": 1, "last_activity_date": 1495227481, "creation_date": 1495227481, "answer_id": 44078886, "question_id": 44011556, "link": "https://stackoverflow.com/questions/44011556/rbenv-fails-to-install-ruby-1-8-7-on-macos-x-sierra/44078886#44078886", "title": "rbenv fails to install ruby 1.8.7 on MacOS X Sierra", "body": "<p>Found the solution here: <a href=\"http://xibbar.hatenablog.com\" rel=\"nofollow noreferrer\">http://xibbar.hatenablog.com</a></p>\n\n<p>After running it through Google Translate, got to this:</p>\n\n<ul>\n<li>Find <code>ruby-build</code>: <code>which ruby-build</code></li>\n<li>Edit it (in my case): <code>vim /usr/local/bin/ruby-build</code></li>\n<li><p>Add the following code after line 762:</p>\n\n<pre><code>local osx_version=\"$(osx_version)\"\nif [ $osx_version = \"1012\" ]; then\n return 0\nfi\n</code></pre></li>\n<li><p>Run:</p>\n\n<pre><code>CONFIGURE_OPTS=\"--with-readline-dir=/usr/local --with-openssl-dir=`brew --prefix openssl`\" RUBY_CONFIGURE_OPTS=\"--with-openssl-dir=`brew --prefix openssl`\" rbenv install 1.8.7-p374\n</code></pre></li>\n</ul>\n\n<p>Hope it's useful to others.</p>\n"}, {"tags": [], "owner": {"reputation": 641, "user_id": 5199542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc4bf213725a3737f165cd15af26331c?s=128&d=identicon&r=PG", "display_name": "Xiting", "link": "https://stackoverflow.com/users/5199542/xiting"}, "is_accepted": true, "score": 3, "last_activity_date": 1503937577, "last_edit_date": 1503937577, "creation_date": 1503937116, "answer_id": 45923366, "question_id": 44011556, "link": "https://stackoverflow.com/questions/44011556/rbenv-fails-to-install-ruby-1-8-7-on-macos-x-sierra/45923366#45923366", "title": "rbenv fails to install ruby 1.8.7 on MacOS X Sierra", "body": "<p>Previous answer looks good, but some updates for it: </p>\n\n<p>You must add the following code not after line 762 (because from version to version lines must be different).\nYou must insert it after: </p>\n\n<pre><code>require_gcc() {\n  local gcc=\"$(locate_gcc || true)\"\n</code></pre>\n\n<p>these lines(for me it was 784 line)</p>\n\n<p><strong>So full tutorial:</strong> </p>\n\n<p>Found the solution here: <a href=\"http://xibbar.hatenablog.com\" rel=\"nofollow noreferrer\">http://xibbar.hatenablog.com</a></p>\n\n<p><a href=\"http://xibbar.hatenablog.com/entry/2017/04/28/112813\" rel=\"nofollow noreferrer\">http://xibbar.hatenablog.com/entry/2017/04/28/112813</a> </p>\n\n<p>After running it through Google Translate, got to this:</p>\n\n<ul>\n<li>Find <code>ruby-build</code>: <code>which ruby-build</code></li>\n<li>Edit it (in my case): <code>vim /usr/local/bin/ruby-build</code></li>\n<li><p>Find the lines like these: </p>\n\n<p>require_gcc() {\n  local gcc=\"$(locate_gcc || true)\"</p></li>\n<li><p>Add the following code after it:</p>\n\n<pre><code>local osx_version=\"$(osx_version)\"\nif [ $osx_version = \"1012\" ]; then\n return 0\nfi\n</code></pre></li>\n<li><p>Run:</p>\n\n<pre><code>CONFIGURE_OPTS=\"--with-readline-dir=/usr/local --with-openssl-dir=`brew --prefix openssl`\" RUBY_CONFIGURE_OPTS=\"--with-openssl-dir=`brew --prefix openssl`\" rbenv install 1.8.7-p374\n</code></pre></li>\n</ul>\n\n<p>Hope it's useful to others.</p>\n"}], "owner": {"reputation": 419, "user_id": 7724157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iGIzu.jpg?s=128&g=1", "display_name": "Nico Brenner", "link": "https://stackoverflow.com/users/7724157/nico-brenner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1094, "favorite_count": 1, "accepted_answer_id": 45923366, "answer_count": 2, "score": 2, "last_activity_date": 1503937577, "creation_date": 1494968666, "last_edit_date": 1495227424, "question_id": 44011556, "link": "https://stackoverflow.com/questions/44011556/rbenv-fails-to-install-ruby-1-8-7-on-macos-x-sierra", "title": "rbenv fails to install ruby 1.8.7 on MacOS X Sierra", "body": "<p>After creating a <code>.ruby-version</code> file with <code>1.8.7</code>, running <code>rbenv install</code> on the same directory where the file is gives the following error:</p>\n\n<blockquote>\n  <p>ERROR: This package must be compiled with GCC, but ruby-build couldn't\n  find a suitable <code>gcc</code> executable on your system. Please install GCC\n  and try again.</p>\n  \n  <p>DETAILS: Apple no longer includes the official GCC compiler with Xcode\n  as of version 4.2. Instead, the <code>gcc</code> executable is a symlink to\n  <code>llvm-gcc</code>, a modified version of GCC which outputs LLVM bytecode.</p>\n  \n  <p>For most programs the <code>llvm-gcc</code> compiler works fine. However,\n  versions of Ruby older than 1.9.3-p125 are incompatible with\n  <code>llvm-gcc</code>. To build older versions of Ruby you must have the official\n  GCC compiler installed on your system.</p>\n  \n  <p>TO FIX THE PROBLEM: Install Homebrew's apple-gcc42 package with this\n  command: brew tap homebrew/dupes ; brew install apple-gcc42</p>\n  \n  <p>You will need to install the official GCC compiler to build older\n  versions of Ruby even if you have installed Apple's Command Line Tools\n  for Xcode package. The Command Line Tools for Xcode package only\n  includes <code>llvm-gcc</code>.</p>\n  \n  <p>BUILD FAILED (OS X 10.12.4 using ruby-build 20170405-2-g3b15693)</p>\n</blockquote>\n\n<p>Then running <code>brew install apple-gcc42</code> gives:</p>\n\n<blockquote>\n  <p>apple-gcc42: This formula either does not compile or function as expected on macOS\n  versions newer than Mavericks due to an upstream incompatibility.\n  Error: An unsatisfied requirement failed this build.</p>\n</blockquote>\n\n<p>Stuck trying to install ruby 1.8.7 through rbenv on MacOS X Sierra. Any ideas on how to fix this?</p>\n"}, {"tags": ["ruby", "selenium", "xpath", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1494968551, "post_id": 44011317, "comment_id": 75051256, "body": "Could you see if <code>element = row.find_element(:xpath =&gt; &#39;&#47;&#47;*[text()=&quot;#{unique_field_value.to_s.strip}&quot;]&#39;)</code> matches some element?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494983430, "post_id": 44011317, "comment_id": 75055781, "body": "Stylistically, we don&#39;t use camelCase for variables or methods in Ruby. ItIsAReadabilityThing, so <code>selectedLine</code> should be <code>selected_line</code>."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 8021176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd229a6fc426485dbad3bba46065c9f?s=128&d=identicon&r=PG&f=1", "display_name": "znon", "link": "https://stackoverflow.com/users/8021176/znon"}, "is_accepted": false, "score": 0, "last_activity_date": 1494979670, "last_edit_date": 1494979670, "creation_date": 1494971051, "answer_id": 44012100, "question_id": 44011317, "link": "https://stackoverflow.com/questions/44011317/ruby-selenium-web-driver-find-xpath-elements-without-throwing-nosuchelementexce/44012100#44012100", "title": "Ruby Selenium Web Driver: find xpath elements without throwing NoSuchElementException", "body": "<p>Try: </p>\n\n<pre><code>rows.each do |row|\n  element = row.find_element(:xpath =&gt; \"./li/span[contains(., '#{unique_field_value.to_s.strip.downcase}')]\")\n  if(!element.nil?)\n    selectedLine = row\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3468, "user_id": 1258669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1988d60d9df1a4aaecc77ffc49532a5a?s=128&d=identicon&r=PG", "display_name": "RanPaul", "link": "https://stackoverflow.com/users/1258669/ranpaul"}, "is_accepted": false, "score": 0, "last_activity_date": 1494972543, "creation_date": 1494972543, "answer_id": 44012425, "question_id": 44011317, "link": "https://stackoverflow.com/questions/44011317/ruby-selenium-web-driver-find-xpath-elements-without-throwing-nosuchelementexce/44012425#44012425", "title": "Ruby Selenium Web Driver: find xpath elements without throwing NoSuchElementException", "body": "<p>got it working with below code</p>\n\n<pre><code>rows.each do |row|\n    elements = row.find_elements(:xpath =&gt; \"./li/span[contains(., '#{unique_field_value.to_s.strip}')]\")\n    if (elements.length &gt; 0)\n      selectedLine = row\n    end\n  end\n</code></pre>\n"}], "owner": {"reputation": 3468, "user_id": 1258669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1988d60d9df1a4aaecc77ffc49532a5a?s=128&d=identicon&r=PG", "display_name": "RanPaul", "link": "https://stackoverflow.com/users/1258669/ranpaul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 718, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1494979670, "creation_date": 1494967776, "question_id": 44011317, "link": "https://stackoverflow.com/questions/44011317/ruby-selenium-web-driver-find-xpath-elements-without-throwing-nosuchelementexce", "title": "Ruby Selenium Web Driver: find xpath elements without throwing NoSuchElementException", "body": "<p>I have a below html which am trying to test using ruby selenium web driver</p>\n\n<pre><code>&lt;div class=\"container-fluid container-results\"&gt;\n    &lt;div class=\"result-row\" id=\"0\"&gt;\n        &lt;ul&gt;\n            &lt;li class=\"process-status-column upload-success-icon\"&gt;\n                &lt;svg class=\"glyphicon-upload-green\" viewBox=\"0 0 100 100\"&gt;\n                    &lt;use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#doc_upload\"&gt;&lt;/use&gt;\n                &lt;/svg&gt;\n            &lt;/li&gt;\n            &lt;li class=\"file-label-column\"&gt;&lt;span&gt;validated.txt&lt;/span&gt;&lt;/li&gt;\n            &lt;li class=\"client-company-column\"&gt;&lt;span&gt;test-client&lt;/span&gt;&lt;/li&gt;\n            &lt;li class=\"reference-column\"&gt;&lt;span&gt;Ref001&lt;/span&gt;&lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/div&gt;\n    &lt;div class=\"result-row\" id=\"1\"&gt;\n        &lt;ul&gt;\n            &lt;li class=\"process-status-column upload-error-icon\"&gt;\n                &lt;svg class=\"glyphicon-exclamation\" viewBox=\"0 0 100 100\"&gt;\n                    &lt;use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#exclamation\"&gt;&lt;/use&gt;\n                &lt;/svg&gt;\n            &lt;/li&gt;\n            &lt;li class=\"file-label-column\"&gt;&lt;span&gt;Error.txt&lt;/span&gt;\n                &lt;div class=\"attachment-row\"&gt;This invoice contains an error&lt;/div&gt;\n            &lt;/li&gt;\n            &lt;li class=\"client-company-column\"&gt;&lt;span&gt;test-client&lt;/span&gt;&lt;/li&gt;\n            &lt;li class=\"reference-column\"&gt;&lt;span&gt;Ref002&lt;/span&gt;&lt;/li&gt;            \n        &lt;/ul&gt;\n    &lt;/div&gt;   \n    &lt;div class=\"result-row\" id=\"2\"&gt;\n        &lt;ul&gt;\n            &lt;li class=\"process-status-column upload-pending-icon\"&gt;\n                &lt;svg class=\"glyphicon-spin\" viewBox=\"0 0 100 100\"&gt;\n                    &lt;use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#refresh\"&gt;&lt;/use&gt;\n                &lt;/svg&gt;\n            &lt;/li&gt;\n            &lt;li class=\"file-label-column\"&gt;&lt;span&gt;Pending.txt&lt;/span&gt;&lt;/li&gt;\n            &lt;li class=\"client-company-column\"&gt;&lt;/li&gt;\n            &lt;li class=\"reference-column\"&gt;&lt;/li&gt;            \n        &lt;/ul&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I am trying to find the <code>ul</code> element as <code>selectedLine</code> variable, which matches the <code>span</code> value as per the input parameter <code>unique_field_value</code> </p>\n\n<pre><code>selectedLine = nil\nrows = driver.find_elements(:css =&gt; \"div.container-fluid.container-results &gt;div.result-row &gt;ul\")\nrows.each do |row|\n   element = row.find_element(:xpath =&gt; \"./li/span[contains(., '#{unique_field_value.to_s.strip}')]\")\n  if(!element.nil?)\n    selectedLine = row\n  end\nend\n</code></pre>\n\n<p>Above code works fine if I pass  <code>validated.txt</code> as parameter value <code>unique_field_value</code>  but if I pass <code>Error.txt</code> or <code>Pending.txt</code> am getttig below exception</p>\n\n<pre><code>no such element: Unable to locate element: {\"method\":\"xpath\",\"selector\":\"./li/span[contains(., 'Error.txt')]\"} (org.openqa.selenium.NoSuchElementException)\n</code></pre>\n\n<p>My code is trying to find the <code>span</code> element matching <code>unique_field_value</code> parameter in first iteration of the <code>rows</code> and throwning exception if it doesnt find one, how do I continue the iteration over all the elements of <code>rows</code> without throwing <code>NoSuchElementException</code> exception</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actioncable"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 7733552, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0585b2af4349bcf8312cad05f837ab9?s=128&d=identicon&r=PG&f=1", "display_name": "megahra", "link": "https://stackoverflow.com/users/7733552/megahra"}, "edited": false, "score": 0, "creation_date": 1495047524, "post_id": 44014977, "comment_id": 75092065, "body": "Thank you for telling me what the problem is - being new to Rails I&#39;ve now spent some time googeling what writing an event handler  or callback function in my coffeescript code would look like but haven&#39;t gotten it to work yet. If you add a concrete suggestion I will accept this answer @Laith, otherwise I&#39;ll add my code as soon as I have something that works."}, {"owner": {"reputation": 529, "user_id": 6030056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c775b7467b51ad2401710b9b265a4aa1?s=128&d=identicon&r=PG&f=1", "display_name": "Laith Azer", "link": "https://stackoverflow.com/users/6030056/laith-azer"}, "reply_to_user": {"reputation": 185, "user_id": 7733552, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0585b2af4349bcf8312cad05f837ab9?s=128&d=identicon&r=PG&f=1", "display_name": "megahra", "link": "https://stackoverflow.com/users/7733552/megahra"}, "edited": false, "score": 0, "creation_date": 1495053362, "post_id": 44014977, "comment_id": 75095334, "body": "Well it depends what you want your app to do. Do you want the user to click on a button and then you fire the <code>send_data</code>? What will the user interaction be?"}, {"owner": {"reputation": 185, "user_id": 7733552, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0585b2af4349bcf8312cad05f837ab9?s=128&d=identicon&r=PG&f=1", "display_name": "megahra", "link": "https://stackoverflow.com/users/7733552/megahra"}, "edited": false, "score": 0, "creation_date": 1495100444, "post_id": 44014977, "comment_id": 75113842, "body": "Yes exactly. The quiz hoster user clicks on a button and broadcasts a change in the view of the quiz participant @Laith"}, {"owner": {"reputation": 529, "user_id": 6030056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c775b7467b51ad2401710b9b265a4aa1?s=128&d=identicon&r=PG&f=1", "display_name": "Laith Azer", "link": "https://stackoverflow.com/users/6030056/laith-azer"}, "reply_to_user": {"reputation": 185, "user_id": 7733552, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0585b2af4349bcf8312cad05f837ab9?s=128&d=identicon&r=PG&f=1", "display_name": "megahra", "link": "https://stackoverflow.com/users/7733552/megahra"}, "edited": false, "score": 0, "creation_date": 1495114317, "post_id": 44014977, "comment_id": 75123669, "body": "@megahra I have updated the original answer to match your requirements"}], "tags": [], "owner": {"reputation": 529, "user_id": 6030056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c775b7467b51ad2401710b9b265a4aa1?s=128&d=identicon&r=PG&f=1", "display_name": "Laith Azer", "link": "https://stackoverflow.com/users/6030056/laith-azer"}, "is_accepted": false, "score": 0, "last_activity_date": 1495114289, "last_edit_date": 1495114289, "creation_date": 1494991438, "answer_id": 44014977, "question_id": 44011075, "link": "https://stackoverflow.com/questions/44011075/how-to-call-actioncable-method-from-controller-or-model-uninitialized-constan/44014977#44014977", "title": "How to call ActionCable method from controller or model - &quot;uninitialized constant QuizSession::App&quot; Error", "body": "<p>WebSockets are designed such that it doesn't matter whether you are building a one-to-one, many-to-one, one-to-many or many-to-many feature. The reason is as a Publisher to a channel, you do not know who is Subscribed to it, so whether it is just 1 or 1000 users, they will all receive the message that is published.</p>\n\n<p>As for why you are getting the error, well the <code>App</code> object is a JavaScript object (see how you are accessing it in your coffeescript files), so you cannot use it in Ruby code.</p>\n\n<p>The <code>App</code> object is not made available in your Ruby code (backend) because it is supposed to be a method for the client (user) to communicate with the server (backend), which is why it is initialized in your coffeescript code.</p>\n\n<p>So you will need to call the send_data method by attaching a click handler to your button. Let's say in your html your button looks like:</p>\n\n<pre><code>&lt;button id=\"broadcast-button\"&gt;Broadcast&lt;/button&gt;\n</code></pre>\n\n<p>In your client side code (coffeescript), you would do the following:</p>\n\n<pre><code>$('#broadcast-button').on 'click', (e) -&gt;\n  App.quiz_data.send_data()\n</code></pre>\n\n<p>So when the user clicks on that button, the send_data method will be called.</p>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 7733552, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0585b2af4349bcf8312cad05f837ab9?s=128&d=identicon&r=PG&f=1", "display_name": "megahra", "link": "https://stackoverflow.com/users/7733552/megahra"}, "is_accepted": true, "score": 0, "last_activity_date": 1509052634, "creation_date": 1509052634, "answer_id": 46963960, "question_id": 44011075, "link": "https://stackoverflow.com/questions/44011075/how-to-call-actioncable-method-from-controller-or-model-uninitialized-constan/46963960#46963960", "title": "How to call ActionCable method from controller or model - &quot;uninitialized constant QuizSession::App&quot; Error", "body": "<blockquote>\n  <p>As for why you are getting the error, well the App object is a JavaScript object (see how you are accessing it in your coffeescript files), so you cannot use it in Ruby code.</p>\n  \n  <p>The App object is not made available in your Ruby code (backend)\n  because it is supposed to be a method for the client (user) to\n  communicate with the server (backend), which is why it is initialized\n  in your coffeescript code.</p>\n</blockquote>\n\n<p>As @Laith Azer pointed out, it <strong>is not possible</strong> to call a CoffeeScript method (since that represents the frontend) from a controller or model, but all my CoffeeScript method <code>send_data</code> really does, is call its counterpart on the backend:</p>\n\n<pre><code>#/app/assets/javascripts/channels/quiz_data.coffee:\nApp.quiz_data = App.cable.subscriptions.create \"QuizDataChannel\",\n  ...\n  send_data: -&gt;\n    @perform 'send_data'\n</code></pre>\n\n<p>So what <strong>is possible</strong>, is to call this backend method directly:</p>\n\n<pre><code>#In some controller or model:\nQuizDataChannel.send_data(current_user)\n</code></pre>\n\n<p>For that to work we need to change the method in our ActionCable channel to a class method:</p>\n\n<pre><code>#/app/channels/quiz_data_channel.rb:\nclass QuizDataChannel &lt; ApplicationCable::Channel\n  def self.send_data(current_user) #self. makes it a class method\n    new_quiz_html = Services::QuizDataCreation.new(user: current_user).create\n    #change \"some_room\" to the room name you want to send the page on\n    ActionCable.server.broadcast(\"some_room\", html: new_quiz_html) \n  end\nend\n</code></pre>\n\n<p>And all that is left is to receive this html page and display it:</p>\n\n<pre><code>#/app/assets/javascripts/channels/quiz_data.coffee:\nApp.quiz_data = App.cable.subscriptions.create \"QuizDataChannel\",\n  ...\n  send_data: -&gt;\n    @perform 'send_data'\n\n  received: (data) -&gt;\n    # This will replace your body with the page html string:\n    $('body').html(data.html)\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 7733552, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0585b2af4349bcf8312cad05f837ab9?s=128&d=identicon&r=PG&f=1", "display_name": "megahra", "link": "https://stackoverflow.com/users/7733552/megahra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1375, "favorite_count": 0, "accepted_answer_id": 46963960, "answer_count": 2, "score": 0, "last_activity_date": 1509052814, "creation_date": 1494966821, "last_edit_date": 1509052814, "question_id": 44011075, "link": "https://stackoverflow.com/questions/44011075/how-to-call-actioncable-method-from-controller-or-model-uninitialized-constan", "title": "How to call ActionCable method from controller or model - &quot;uninitialized constant QuizSession::App&quot; Error", "body": "<p>I'm trying to write a simple quiz app with Ruby on Rails with 2 users, who get to see different views:</p>\n\n<ul>\n<li>the quiz hoster view shows the current question and a \"next question\"-button (which he is supposed to project onto a wall for the audience) and </li>\n<li>the participant view shows the 4 buttons with answer options corresponding to the current question (so the audience can participate in the quiz from their smartphones).</li>\n</ul>\n\n<p>I'm at the point, where I'm trying to use ActionCable to broadcast these 4 answer buttons to my channel, but when I try calling the method I defined in my channel I get the error <code>\"uninitialized constant QuizSession::App\"</code>.</p>\n\n<p>These are the steps I've taken to enable ActionCable:</p>\n\n<p>1) I generated a new channel in /app/channels/quiz_data_channel.rb:</p>\n\n<pre><code>class QuizDataChannel &lt; ApplicationCable::Channel\n  def subscribed\n    stream_from \"quiz_data\"\n  end\n\n  def unsubscribed\n    # Any cleanup needed when channel is unsubscribed\n  end\n\n  def send_data\n    Services::QuizDataCreation.new(user: current_user).create\n  end\nend\n\n# /app/assets/javascripts/channels/quiz_data.coffee:\nApp.quiz_data = App.cable.subscriptions.create \"QuizDataChannel\",\n  connected: -&gt;\n    # Called when the subscription is ready for use on the server\n\n  disconnected: -&gt;\n    # Called when the subscription has been terminated by the server\n\n  received: (data) -&gt;\n    # Called when there's incoming data on the websocket for this channel\n  $('answer-buttons').append(data.partial)\n\n  send_data: -&gt;\n    @perform 'send_data'\n</code></pre>\n\n<p>2) Then I made a new service in app/models/services/quiz_data_creation.rb:</p>\n\n<pre><code>module Services\n  class QuizDataCreation\n\n    def initialize(user)\n      self.user = user\n    end\n\n    def create\n      create_quiz_data\n      broadcast_creation\n    end\n\n    private\n    attr_accessor :user, :answers\n\n    def create_quiz_data  #not sure if this will work\n      @quiz_session = user.quiz_session\n      self.answers = @quiz_session.quiz.questions[@quiz_session.current_question_index].answers\n    end\n\n    def broadcast_creation\n      QuizDataBroadcastJob.perform_now(answers)\n    end\n  end\nend\n</code></pre>\n\n<p>3) Then I generated a new job at /app/jobs/quiz_data_broadcast_job.rb:</p>\n\n<pre><code>class QuizDataBroadcastJob &lt; ApplicationJob\n  queue_as :default\n\n  def perform(answers)\n    ActionCable.server.broadcast('quiz_data', data: render_answer_options(answers))\n  end\n\n  private\n  def render_answer_options(answers)\n    answers.each do |answer|\n      ApplicationController.render(\n          #render student/quiz_question page and render as many answer_option partials as needed\n          partial: 'pages/student/answer_option',\n          locals: {answer: answer}\n      )\n    end\n  end\nend\n</code></pre>\n\n<p>4) I mounted ActionCable in my routes.rb:</p>\n\n<pre><code>mount ActionCable.server =&gt; '/cable'\n</code></pre>\n\n<p>5) And finally I'm trying to broadcast data by calling the send_data function elsewhere in my application:</p>\n\n<pre><code>def send_current_question\n    App.quiz_data.send_data &lt;--- this is apparently where the error gets thrown\nend\n</code></pre>\n\n<p>What I would like to know is:</p>\n\n<ul>\n<li>How do I solve this error?</li>\n<li>Is the problem that I haven't established the socket connection correctly?</li>\n</ul>\n\n<p>I have read 3 ActionCable guides and watched 2 guide videos - since most of them seem to be about chat applications (which in my mind is a 1 to 1 connection) I am now thoroughly confused as to how to get my app to work in the one-to-many broadcasting fashion I need.</p>\n\n<p>I'm new to Rails, so any pointers would be appreciated! :)</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "json", "ruby", "ajax"], "comments": [{"owner": {"reputation": 2545, "user_id": 1783642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc69b60352cb9a411cb033b26bd8136e?s=128&d=identicon&r=PG", "display_name": "Puhlze", "link": "https://stackoverflow.com/users/1783642/puhlze"}, "edited": false, "score": 1, "creation_date": 1494966398, "post_id": 44010736, "comment_id": 75050121, "body": "The 500 and 404 are server generated status. What&#39;s in your server logs?"}, {"owner": {"reputation": 715, "user_id": 6341982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10206246890437893/picture?type=large", "display_name": "Luiz Henrique", "link": "https://stackoverflow.com/users/6341982/luiz-henrique"}, "reply_to_user": {"reputation": 2545, "user_id": 1783642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc69b60352cb9a411cb033b26bd8136e?s=128&d=identicon&r=PG", "display_name": "Puhlze", "link": "https://stackoverflow.com/users/1783642/puhlze"}, "edited": false, "score": 0, "creation_date": 1494968444, "post_id": 44010736, "comment_id": 75051208, "body": "@Puhlze, I edited the question with server log information. It is strange.. because it does not happen when the actions are not called together."}, {"owner": {"reputation": 2545, "user_id": 1783642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc69b60352cb9a411cb033b26bd8136e?s=128&d=identicon&r=PG", "display_name": "Puhlze", "link": "https://stackoverflow.com/users/1783642/puhlze"}, "edited": false, "score": 1, "creation_date": 1494969241, "post_id": 44010736, "comment_id": 75051587, "body": "Can you post the server code for these controllers?"}, {"owner": {"reputation": 715, "user_id": 6341982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10206246890437893/picture?type=large", "display_name": "Luiz Henrique", "link": "https://stackoverflow.com/users/6341982/luiz-henrique"}, "reply_to_user": {"reputation": 2545, "user_id": 1783642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc69b60352cb9a411cb033b26bd8136e?s=128&d=identicon&r=PG", "display_name": "Puhlze", "link": "https://stackoverflow.com/users/1783642/puhlze"}, "edited": false, "score": 0, "creation_date": 1494970138, "post_id": 44010736, "comment_id": 75051941, "body": "@Puhlze I edited with the controllers code."}, {"owner": {"reputation": 715, "user_id": 6341982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10206246890437893/picture?type=large", "display_name": "Luiz Henrique", "link": "https://stackoverflow.com/users/6341982/luiz-henrique"}, "reply_to_user": {"reputation": 2545, "user_id": 1783642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc69b60352cb9a411cb033b26bd8136e?s=128&d=identicon&r=PG", "display_name": "Puhlze", "link": "https://stackoverflow.com/users/1783642/puhlze"}, "edited": false, "score": 0, "creation_date": 1494972674, "post_id": 44010736, "comment_id": 75052989, "body": "@Puhlze, I think I fixed, but I do not know exactly why.. When I was querying my model, I was using &quot;return @levels&quot;, so I was returning de Objects and numbers. When I changed to &quot;return levels&quot;, it stopped returning the numbers and just returned the objects, which was what I wanted. Do you know why it happens?"}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 6341982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10206246890437893/picture?type=large", "display_name": "Luiz Henrique", "link": "https://stackoverflow.com/users/6341982/luiz-henrique"}, "is_accepted": true, "score": 0, "last_activity_date": 1495086384, "creation_date": 1495086384, "answer_id": 44039517, "question_id": 44010736, "link": "https://stackoverflow.com/questions/44010736/rails-ajax-calls-generate-404-and-500-errors-when-together/44039517#44039517", "title": "Rails ajax calls generate 404 and 500 errors when together", "body": "<p>Well, the answer was that, for some reason, calling the actions by ajax was including the ids on the JSON. In the model, I was using \"@levels\" as a return instead of \"levels\". When I used just \"levels\", it worked.</p>\n"}], "owner": {"reputation": 715, "user_id": 6341982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10206246890437893/picture?type=large", "display_name": "Luiz Henrique", "link": "https://stackoverflow.com/users/6341982/luiz-henrique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 44039517, "answer_count": 1, "score": 0, "last_activity_date": 1495086384, "creation_date": 1494965439, "last_edit_date": 1494970478, "question_id": 44010736, "link": "https://stackoverflow.com/questions/44010736/rails-ajax-calls-generate-404-and-500-errors-when-together", "title": "Rails ajax calls generate 404 and 500 errors when together", "body": "<p>I have two actions, each in a different controller, that return json data. One of these actions is used to generate data to plot a chartkick.js graph. Every 5 seconds these actions need to be called to update data that is showed on the graph and on some divs.\nMy routes for these actions are:</p>\n\n<p>routes.rb</p>\n\n<pre><code>get \"/get_all_tanks_graph\", to: \"charts#get_all_tanks_graph\", as: \"get_all_tanks_graph\"\nget \"/render_all_current_levels\", to: \"static#render_all_current_levels\", as: \"render_all_current_levels\"\n</code></pre>\n\n<p>On my javascript file that is used on the view (static/index.html), I am doing like bellow to render the graph and the contents of some divs that are coming from the database:</p>\n\n<p>assets/static.js</p>\n\n<pre><code>$(document).ready(function() {\n  getLevels();\n  getGraph();\n  setInterval(\n    function() {\n      getLevels();\n      updateGraph();\n    },\n    5000\n  );\n});\n\nfunction getLevels() {\n  $.ajax({\n    type: \"GET\",\n    url: \"/render_all_current_levels\",\n    dataType: \"json\",\n    success: function(response){\n     ...\n    }\n  });\n}\n\nfunction getGraph() {\n  $.ajax({\n    type: \"GET\",\n    url: \"/get_all_tanks_graph\",\n    dataType: \"json\",\n    success: function(response){\n      $chart = new Chartkick.LineChart(\"graph-display\", response);\n    }\n  });\n}\n\nfunction updateGraph() {\n  $.ajax({\n    type: \"GET\",\n    url: \"/get_all_tanks_graph\",\n    dataType: \"json\",\n    success: function(response){\n      $chart = Chartkick.charts[\"graph-display\"];\n      $chart.updateData(response);\n    }\n  });\n}\n</code></pre>\n\n<p>I need that these actions to happen together. But this way I am getting this on my console and it keeps happening every 5 seconds on the ajax calls:\n<a href=\"https://i.stack.imgur.com/5Fctc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Fctc.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I call just getLevels() to get div content and then keep it updating like this,</p>\n\n<pre><code>$(document).ready(function() {\n  getLevels();\n  setInterval(\n    function() {\n      getLevels();\n    },\n    5000\n  );\n});\n</code></pre>\n\n<p>or if I just render the graph and keep it updating, like this,</p>\n\n<pre><code>$(document).ready(function() {\n  getGraph();\n  setInterval(\n    function() {\n      updateGraph();\n    },\n    5000\n  );\n});\n</code></pre>\n\n<p>they work perfectly. So I am able to call them separately but not able to use them together inside $(document).ready. Why is that happening?</p>\n\n<p>The controllers code are:</p>\n\n<pre><code>def get_all_tanks_graph\n    @hash = {}\n    @array = Array.new\n    @levels = Level.get_all_tanks_levels\n\n    @levels.each do |l| \n      l.each do |i| \n        @hash[i.created_at] = i.level \n      end \n      @array &lt;&lt; @hash \n      @hash = Hash.new \n    end\n\n    render json: @array.each_with_index.map { \n      |a, index| { \n        name: \"Caixa #{index + 1}\", data: a \n      } \n    }\n\n  end\n\ndef render_all_current_levels\n    @levels = Array.new\n    array = Level.get_all_current_levels\n    array.each do |level|\n      @levels &lt;&lt; Level.find(level) if level\n    end\n    render json: @levels\n  end\n</code></pre>\n\n<p>The server log shows what is following when the actions are called consecutively:</p>\n\n<pre><code>NoMethodError (undefined method `each' for 15:Fixnum):\n\n\nCompleted 500 Internal Server Error in 11ms (ActiveRecord: 4.7ms)\n\n\n\nNoMethodError (undefined method `each' for 15:Fixnum):\n\napp/controllers/charts_controller.rb:9:in `block in get_all_tanks_graph'\napp/controllers/charts_controller.rb:8:in `each'\napp/controllers/charts_controller.rb:8:in `get_all_tanks_graph'\n\n\nCompleted 404 Not Found in 51ms (ActiveRecord: 44.1ms)\n\n\n\nActiveRecord::RecordNotFound (Couldn't find Level with 'id'=#&lt;Level::ActiveRecord_Relation:0x007f9f36429ca8&gt;):\n\napp/controllers/static_controller.rb:21:in `block in render_all_current_levels'\napp/controllers/static_controller.rb:20:in `each'\napp/controllers/static_controller.rb:20:in `render_all_current_levels'\n</code></pre>\n"}, {"tags": ["ruby", "tcpserver"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 1, "creation_date": 1494963770, "post_id": 44010111, "comment_id": 75048656, "body": "Shot in the dark but try <code>0.0.0.0</code>."}, {"owner": {"reputation": 427, "user_id": 7756955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2556cac9a475709d3c560fd3632e3622?s=128&d=identicon&r=PG", "display_name": "StuntHacks", "link": "https://stackoverflow.com/users/7756955/stunthacks"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1494966141, "post_id": 44010111, "comment_id": 75050010, "body": "Okay so with 0.0.0.0 it works that I can access it with both localhost/127.0.0.1 as well as with the local network ip address. However, I can&#39;t access it from an external source. I tried using the ip address that shows up if I visit sites like whatismyipaddress.com but it doesn&#39;t work. The ports are opened.  Sorry if this is a dumb question but this is the first time I program a server."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1494983738, "post_id": 44010111, "comment_id": 75055845, "body": "Your question could possibly do better on <a href=\"https://superuser.com\">Super User</a>. But, TCPServer is for creating new TCP-based services. You&#39;re creating a service that uses HTTPd, since you&#39;re talking to a browser. I&#39;d recommend researching how to do this using Sinatra or Rack. You might also want to look into Passenger and even nginx if you need more options."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1494983835, "post_id": 44010111, "comment_id": 75055875, "body": "Define &quot;external&quot;. It&#39;s often the case that you&#39;ll be behind a layer of NAT and using a private IP that is not directly accessible from the general internet. If you want to open something up you need to use <a href=\"https://en.wikipedia.org/wiki/Universal_Plug_and_Play\" rel=\"nofollow noreferrer\">UPnP</a>, for which there are several Rubygems solutions that might work for you. Experiment and see what&#39;s best."}], "owner": {"reputation": 427, "user_id": 7756955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2556cac9a475709d3c560fd3632e3622?s=128&d=identicon&r=PG", "display_name": "StuntHacks", "link": "https://stackoverflow.com/users/7756955/stunthacks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494983704, "creation_date": 1494963299, "last_edit_date": 1494983704, "question_id": 44010111, "link": "https://stackoverflow.com/questions/44010111/how-to-listen-to-requests-on-all-adresses-with-tcpserver", "title": "How to listen to requests on all adresses with TCPServer", "body": "<p>I want to create a simple webserver to communicate with my running Ruby script via a web browser.</p>\n\n<p>I can only set the TCPServer's address to one address per time. For example, if I don't set any address at all, I can only access it on the computer it is running on with 'localhost:port'. If I set it to the computer's network address I can access it from the whole network via its address but I can't access it via 'localhost' or '127.0.0.1'. However, in the end the server should be accessable from all over the world by just having it's IP.</p>\n\n<p>Here is the basic source code of the server:</p>\n\n<pre><code>server = TCPServer.open(\"some.ip.v4.address\", 8080)\n\nloop do\n\n  Thread.start(server.accept) do |socket|\n\n    #Do something...\n\n  end\nend\n</code></pre>\n\n<p>Is something like that possible? How would I do it?</p>\n"}, {"tags": ["json", "ruby", "sequel"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1494963499, "post_id": 44010044, "comment_id": 75048492, "body": "Have you got this somewhere: <code>Sequel::Model.plugin :json_serializer</code>. If so, what is <code>Client.first.class</code>?"}, {"owner": {"reputation": 33, "user_id": 1311755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc0a6c0057e5bbf6217d926b7267df5?s=128&d=identicon&r=PG", "display_name": "Mackaber", "link": "https://stackoverflow.com/users/1311755/mackaber"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1494969696, "post_id": 44010044, "comment_id": 75051779, "body": "Ok, I just added it and it worked straight away, thanks a lot!"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494984060, "post_id": 44010044, "comment_id": 75055913, "body": "I&#39;d try <code>Client.first.to_h.to_json</code>. A model returns an instance of that class so you need to convert the result to a hash."}], "answers": [{"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 3, "last_activity_date": 1494984384, "creation_date": 1494984384, "answer_id": 44014027, "question_id": 44010044, "link": "https://stackoverflow.com/questions/44010044/how-to-serialize-a-sequel-result-into-json/44014027#44014027", "title": "How to serialize a Sequel result into JSON", "body": "<p>You need to use <code>to_hash</code>:</p>\n\n<pre><code>require 'json'\nrequire 'sequel'\n\nDB = Sequel.sqlite\nDB.create_table :items do\n  primary_key :id\n  String :name\n  Float :price\nend\nitems = DB[:items]\nitems.insert(:name =&gt; 'abc', :price =&gt; rand * 100)\n\nclass Item &lt; Sequel::Model(:items)\nend\n\nItem.first\n  .to_hash # =&gt; {:id=&gt;1, :name=&gt;\"abc\", :price=&gt;51.47074347440235}\n  .to_json # =&gt; \"{\\\"id\\\":1,\\\"name\\\":\\\"abc\\\",\\\"price\\\":51.47074347440235}\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": true, "score": 5, "last_activity_date": 1495009167, "last_edit_date": 1495009167, "creation_date": 1495008865, "answer_id": 44019163, "question_id": 44010044, "link": "https://stackoverflow.com/questions/44010044/how-to-serialize-a-sequel-result-into-json/44019163#44019163", "title": "How to serialize a Sequel result into JSON", "body": "<p>The <code>json</code> library (part of the Ruby standard library), and other gems such as ActiveSupport, monkey patch objects with a <code>to_json</code> method which could be what is getting called, not a the specific <code>to_json</code> method supplied by Sequel which knows how to convert a <code>Sequel::Model</code> instance to JSON. This is speculation as I'd be surprised that the JSON library monkey patches anything other than <code>String</code>, <code>Array</code>, <code>Hash</code> etc.</p>\n\n<p>When using <code>DB[:clients].first</code> you probably get back a <code>Hash</code> which has a <code>to_json</code> method, where as <code>Client.first</code> returns a model instance which isn't handled by the generic <code>to_json</code> method supplied by the json library.</p>\n\n<p>Try registering the Sequel JSON plugin, this should take precedence over the monkey patched <code>to_json</code> method:</p>\n\n<pre><code>Sequel::Model.plugin :json_serializer\n</code></pre>\n\n<p>By the way this is a good indicator of why monkey patching is often a bad idea, particularly monkey patching of classes which are outside a libraries/gems namespace.</p>\n"}], "owner": {"reputation": 33, "user_id": 1311755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc0a6c0057e5bbf6217d926b7267df5?s=128&d=identicon&r=PG", "display_name": "Mackaber", "link": "https://stackoverflow.com/users/1311755/mackaber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1355, "favorite_count": 0, "accepted_answer_id": 44019163, "answer_count": 2, "score": 2, "last_activity_date": 1495009167, "creation_date": 1494963038, "last_edit_date": 1494984120, "question_id": 44010044, "link": "https://stackoverflow.com/questions/44010044/how-to-serialize-a-sequel-result-into-json", "title": "How to serialize a Sequel result into JSON", "body": "<p>This is my Model</p>\n\n<pre><code>class Client &lt; Sequel::Model(:clients)\nend\n</code></pre>\n\n<p>When I execute </p>\n\n<pre><code>Client.first.to_json\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>\"\\\"#&lt;Client:0x2594b824&gt;\\\"\"\n</code></pre>\n\n<p>But when I execute </p>\n\n<pre><code>DB[:clients].first.to_json\n</code></pre>\n\n<p>I correctly get:</p>\n\n<pre><code>{id: 1, name: \"Someone\" ... }\n</code></pre>\n\n<p>What am I doing wrong?... I also tried using <code>Client.dataset.first.json</code> having the same result. </p>\n\n<p>Also I'm using a MS Access DB but I don't think that's important.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1494963699, "post_id": 44009911, "comment_id": 75048607, "body": "trying to call controller methods manually is something that beginners often get caught up on. It&#39;s better to move the logic to some shared place and then call it from the controller action and elsewhere if needed. See <a href=\"http://stackoverflow.com/questions/15260984/guidelines-for-where-to-put-classes-in-rails-apps-that-dont-fit-anywhere\" title=\"guidelines for where to put classes in rails apps that dont fit anywhere\">stackoverflow.com/questions/15260984/&hellip;</a>"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1494963705, "post_id": 44009911, "comment_id": 75048611, "body": "Are you trying to access <code>params</code> from an earlier request, if so, you can&#39;t, <code>params</code> is reset for every request. If so, why would you want to do this?"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 7927990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1425331290823651/picture?type=large", "display_name": "Riley Thompson", "link": "https://stackoverflow.com/users/7927990/riley-thompson"}, "is_accepted": true, "score": 0, "last_activity_date": 1494964560, "last_edit_date": 1494964560, "creation_date": 1494964037, "answer_id": 44010343, "question_id": 44009911, "link": "https://stackoverflow.com/questions/44009911/function-defined-values-in-create/44010343#44010343", "title": "Function defined values in &#39;create&#39;", "body": "<p>I find it best to abstract out all API call logic to its own object which I call a service object. This object has methods with your baseline API calls which are returning the JSON. You can then pass these hashes (JSON) to your RUN model or whatever model you're using to populate the report data with and extract what you need from them with methods, or just pass the entire hash in if it has all the required attributes. </p>\n\n<p>The way I would do this is make your \"Get Report\" button a post that hits the create action in this provided controller. </p>\n\n<p>I would not use a \"new\" action in this case, because that is generally reserved for some kind of user input view.</p>\n"}], "owner": {"reputation": 275, "user_id": 8016360, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a30be4c216a1d7c1546ea2bd5db83c77?s=128&d=identicon&r=PG&f=1", "display_name": "RedOster", "link": "https://stackoverflow.com/users/8016360/redoster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 44010343, "answer_count": 1, "score": 0, "last_activity_date": 1494983690, "creation_date": 1494962551, "last_edit_date": 1494983690, "question_id": 44009911, "link": "https://stackoverflow.com/questions/44009911/function-defined-values-in-create", "title": "Function defined values in &#39;create&#39;", "body": "<p>I have a report object that get's data from other APIs when the user presses the \"Get Report\" Button.</p>\n\n<p>How do I design <code>new</code> and <code>create</code> to get parameters from another function? This is what my controller looks like:</p>\n\n<pre><code>def new\n  @run = Run.new\nend\n\ndef create\n  param_holder = get_payload\n  @run = Run.new(param_holder)\nend\n\ndef get_payload\n  statushash = Hash.new\n\n  # placeholder data for testing below \n  statushash[:daterun] = Time.now.strftime(\"%m/%d/%Y\")\n  statushash[:status] = \"OK\"\n  statushash[:count] = 13\n\n  return statushash\nend\n</code></pre>\n\n<p>Does anyone have suggestions for learning resources and to ask basic questions like this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "xml-parsing", "nokogiri"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494961694, "post_id": 44009363, "comment_id": 75047458, "body": "When you ask a question it&#39;s really important that what is displayed accurately represents what problem you&#39;re asking about. That means formatting must be usable. Take the time to make it readable and accurate; The time you put in encourages us to help you. Help is available in the formatting pages for easy access."}, {"owner": {"reputation": 1, "user_id": 7405893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b6c6f2306c5b951a7f0411b3542ce5?s=128&d=identicon&r=PG&f=1", "display_name": "Random Comp Genius", "link": "https://stackoverflow.com/users/7405893/random-comp-genius"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494961919, "post_id": 44009363, "comment_id": 75047598, "body": "@theTinMan Thank you for your help. I&#39;ll work on it."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494963130, "post_id": 44009363, "comment_id": 75048291, "body": "Note: When asking, we expect you to strip your input to the bare minimum necessary to demonstrate the problem. Anything beyond that wastes our time as we try to find a solution for you. &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; Yours isn&#39;t as bad as many we see, but it is a reason for closing questions, and again, the effort to help write clear and concise question is important."}], "answers": [{"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1494983334, "last_edit_date": 1494983334, "creation_date": 1494962087, "answer_id": 44009769, "question_id": 44009363, "link": "https://stackoverflow.com/questions/44009363/how-to-parse-and-print-an-xml-file-using-ruby/44009769#44009769", "title": "How to parse and print an XML file using Ruby", "body": "<p>The problem is that your CSS selectors are not CSS, nor are they the correct XPath:</p>\n\n<pre><code>'//ssn//p'\n'//ssn//p//v'\n</code></pre>\n\n<p>Nokogiri tests them prior to using them and thinks they're XPath so it treats them as XPath.</p>\n\n<p>To get the output you want I'd use CSS:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::XML(&lt;&lt;EOT)\n&lt;ssn&gt;\n  &lt;p qn=\"Question 1\"&gt;\n    &lt;v ans=\"C\"/&gt;\n    &lt;v ans=\"D\"/&gt;\n    &lt;v ans=\"A\"/&gt;\n    &lt;v ans=\"B\"/&gt; \n  &lt;/p&gt;\n  &lt;p qn=\"Question 2\"&gt;\n    &lt;v ans=\"D\"/&gt;\n    &lt;v ans=\"C\"/&gt;\n    &lt;v ans=\"B\"/&gt;\n    &lt;v ans=\"A\"/&gt; \n  &lt;/p&gt;\n  &lt;p qn=\"Question 3\"&gt;\n    &lt;v ans=\"A\"/&gt;\n    &lt;v ans=\"B\"/&gt;\n    &lt;v ans=\"C\"/&gt;\n    &lt;v ans=\"D\"/&gt; \n  &lt;/p&gt;\n&lt;/ssn&gt;\nEOT\n\ndoc.search('p').each { |p|\n  puts \"#{ p['qn'] }:\"\n  puts p.search('v').map { |v| v['ans'] }\n  puts\n}\n</code></pre>\n\n<p>Which generates:</p>\n\n<pre><code>Question 1:\nC\nD\nA\nB\n\nQuestion 2:\nD\nC\nB\nA\n\nQuestion 3:\nA\nB\nC\nD\n</code></pre>\n\n<p>The problem with the XPath selectors you're using is the secondary <code>//</code>. In XPath-ese <code>//</code> means start at the top of the document and search everywhere. So <code>//ssn//p</code> means \"start at the top and find <code>&lt;ssn&gt;</code> then start at the top and find <code>&lt;p&gt;</code>. Instead you want <code>//ssn/p</code> which means \"start at the top and find <code>&lt;ssn&gt;</code> then find <code>&lt;p&gt;</code> inside them\".</p>\n\n<p>The selectors above could have been written:</p>\n\n<pre><code>doc.search('//p').each { |p|\n  puts \"#{ p['qn'] }:\"\n  puts p.search('./v').map { |v| v['ans'] }\n  puts\n}\n</code></pre>\n\n<p>which would output the same thing.</p>\n\n<p>I recommend using CSS because it generally results in more readable selectors, however sometimes I use XPath because it's more powerful.</p>\n\n<p>Nokogiri has <code>search</code> and <code>at</code>; <code>at</code> is equivalent to <code>search('some selector').first</code>. Nokogiri will try to figure out if the selector is CSS or XPath for you if you use those. There are also CSS and XPath specific methods <code>css</code> and <code>xpath</code> are similar to <code>search</code> and <code>at_css</code> and <code>at_xpath</code> are the <code>at</code> versions. Based on the output you got it appears that Nokogiri only uses the <code>*css</code> or <code>*xpath</code> variants as hints, not as absolute descriptions of the type of the selector. I'll have to nose around in the code to see for sure.</p>\n"}], "owner": {"reputation": 1, "user_id": 7405893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b6c6f2306c5b951a7f0411b3542ce5?s=128&d=identicon&r=PG&f=1", "display_name": "Random Comp Genius", "link": "https://stackoverflow.com/users/7405893/random-comp-genius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494983334, "creation_date": 1494960685, "last_edit_date": 1494983302, "question_id": 44009363, "link": "https://stackoverflow.com/questions/44009363/how-to-parse-and-print-an-xml-file-using-ruby", "title": "How to parse and print an XML file using Ruby", "body": "<p>I am trying to parse an XML file using Ruby. It parses successfully but it does not print what I want it to print:</p>\n\n<pre><code>require 'rubygems'\nrequire 'nokogiri'\n\ndef parseXML(filename)\n  page = Nokogiri::XML(open(filename))\n  puts page.class\n\npage.css('//ssn//p').each do |a|\n\n  puts  a['qn']\n\n  page.css('//ssn//p//v').each do |e|\n\n      puts e['fans']\n\n      end\n    end\n  end\n\nif __FILE__ == $0\n  parseXML('CS 141 FALL 2016/SessionData/L1611021411.xml')\nend\n</code></pre>\n\n<p>The format of the XML file is:</p>\n\n<pre><code>&lt;ssn &gt;\n &lt;p strt=\"14:13:09\" qn=\"Question 1\" stp=\"14:14:20\"&gt;\n  &lt;v fans=\"C\" id=\"#00A4DB7F\" ans=\"C\" fanst=\"33.59\"/&gt;\n  &lt;v fans=\"A\" id=\"#3910072E\" ans=\"D\" fanst=\"50.71\"/&gt;\n  &lt;v fans=\"A\" id=\"#3C44F58D\" ans=\"A\" fanst=\"20.71\"/&gt;\n  &lt;v fans=\"B\" id=\"#3C62633D\" ans=\"B\" fanst=\"10.78\"/&gt; \n   &lt;/p&gt;\n  &lt;p strt=\"14:20:17\" qn=\"Question 2\" stp=\"14:21:24\"&gt;\n  &lt;v fans=\"A\" id=\"#00A4DB7F\" ans=\"D\" fanst=\"33.59\"/&gt;\n  &lt;v fans=\"E\" id=\"#3910072E\" ans=\"C\" fanst=\"50.71\"/&gt;\n  &lt;v fans=\"E\" id=\"#3C44F58D\" ans=\"B\" fanst=\"20.71\"/&gt;\n  &lt;v fans=\"C\" id=\"#3C62633D\" ans=\"A\" fanst=\"10.78\"/&gt; \n    &lt;/p&gt;\n   &lt;p strt=\"14:22:17\" qn=\"Question 3\" stp=\"14:23:24\"&gt;\n  &lt;v fans=\"A\" id=\"#00A4DB7F\" ans=\"A\" fanst=\"33.59\"/&gt;\n  &lt;v fans=\"B\" id=\"#3910072E\" ans=\"B\" fanst=\"50.71\"/&gt;\n  &lt;v fans=\"C\" id=\"#3C44F58D\" ans=\"C\" fanst=\"20.71\"/&gt;\n  &lt;v fans=\"D\" id=\"#3C62633D\" ans=\"D\" fanst=\"10.78\"/&gt; \n    &lt;/p&gt;\n   &lt;/ssn&gt;\n</code></pre>\n\n<p>I want to print:</p>\n\n<pre><code>Question 1: \nC \nA \nA \nB \n\nQuestion 2: \nA \nE \nE\nC \n\nQuestion 3: \nA \nB \nC \nD\n</code></pre>\n\n<p>But instead it's printing this:</p>\n\n<pre><code>Question 1: \nC \nA \nA \nB \nA \nE \nE\nC \nA \nB \nC \nD\n\nQuestion 2: \nC \nA \nA \nB \nA \nE \nE\nC \nA \nB \nC \nD\n\nQuestion 3: \nC \nA \nA \nB \nA \nE \nE\nC \nA \nB \nC \nD\n</code></pre>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1494958654, "post_id": 44008770, "comment_id": 75045732, "body": "Please edit the question and provide the code in the body of the question. Off-site links are strongly discouraged: They can drift out of sync, be at untrusted sites, contain inappropriate content, or expire."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1494958916, "post_id": 44008770, "comment_id": 75045897, "body": "Only provide the relevant code of course:)"}, {"owner": {"reputation": 1, "user_id": 8021363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea88d472c316bb30f706ee235a0a44ab?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Student", "link": "https://stackoverflow.com/users/8021363/confused-student"}, "edited": false, "score": 0, "creation_date": 1494959161, "post_id": 44008770, "comment_id": 75046044, "body": "Alright. I&#39;ve edited with the code in question"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1494959796, "post_id": 44008770, "comment_id": 75046398, "body": "<code>C</code> is a class, <code>&quot;C&quot;</code> is a string which is what <code>gets</code> will return."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1494963568, "post_id": 44008770, "comment_id": 75048534, "body": "Practice safe indentation. It&#39;ll help you understand the logic of your own code. Decent text editors will indent for you. Your future self will thank you. And write Ruby according to Ruby&#39;s style, not as if it&#39;s Python. Your first code review writing it as you are would be painful."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494964497, "post_id": 44008770, "comment_id": 75049082, "body": "@theTinMan I edited and fixed the indentation at the same time you posted the comment :) Good advice none the less!"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494964516, "post_id": 44008770, "comment_id": 75049097, "body": "Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; along with the linked pages. Your code isn&#39;t valid and is rejected by the Ruby interpreter. As such the question needs to be closed. We need code that doesn&#39;t have syntax errors."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1494964607, "post_id": 44008770, "comment_id": 75049142, "body": "I was just wondering why it had been flagged to be closed."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1495047441, "post_id": 44008770, "comment_id": 75092012, "body": "@Confused_Student, are <code>A</code>, <code>B</code>, <code>C</code> or <code>D</code> supposed to be keys that were pressed, or defined classes? Your question isn&#39;t asked well and needed editing and explanation of what you&#39;re trying to do otherwise it&#39;s doomed to be closed."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494964610, "post_id": 44009246, "comment_id": 75049143, "body": "<code>C</code> isn&#39;t a class, the OP is trying to check the value of a string literal. <a href=\"https://meta.stackoverflow.com/questions/256328/vote-to-close-unclear-questions-immediately-after-commenting\" title=\"vote to close unclear questions immediately after commenting\">meta.stackoverflow.com/questions/256328/&hellip;</a> and <a href=\"https://meta.stackoverflow.com/questions/260263/how-long-should-we-wait-for-a-poster-to-clarify-a-question-before-closing\" title=\"how long should we wait for a poster to clarify a question before closing\">meta.stackoverflow.com/questions/260263/&hellip;</a>. While you&#39;re trying to help it&#39;s better to help the site and the user by closing than struggling to fix it."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494964764, "post_id": 44009246, "comment_id": 75049236, "body": "I think the reverse. <code>C</code> is an undefined class / constant and I see no string literal. Hence the answer that the OP is using <code>C</code> not <code>&quot;C&quot;</code>... But I see the point of the links above. It seems pretty clear in this case the problem and solution since we know <code>gets</code> returns a string."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1494972567, "post_id": 44009246, "comment_id": 75052942, "body": "If you look at the linked code in the question, there is repeated use of bare upper-case characters <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code> being compared to a value that results from the use of <code>gets</code> and no attempt to create any classes."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1495008312, "post_id": 44009246, "comment_id": 75065043, "body": "Exactly my point. I think they are using <code>C</code> instead of a string literal, <code>&quot;C&quot;</code>, as per my answer."}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 2, "last_activity_date": 1494960206, "creation_date": 1494960206, "answer_id": 44009246, "question_id": 44008770, "link": "https://stackoverflow.com/questions/44008770/a-little-stumped-with-some-code-for-class/44009246#44009246", "title": "A little stumped with some code for class", "body": "<p>You are referencing an undefined class, <code>C</code>, which is why you get a <code>NameError</code>. If you defined <code>C</code> as a class you will not get the error. However <code>gets</code> will returns an instance of String, such as <code>\"C\"</code>, not a class. Your syntax is wrong.</p>\n\n<pre><code># assignment\nchoice1 = \"C\"\n\n# equality\nchoice1 == C # =&gt; NameError \n\n# define class\nclass C\nend\n\n# equality\nchoice1 == C # =&gt; false (no error this time)\nchoice1 == \"C\" # =&gt; true\n</code></pre>\n\n<p>By the way, technically <code>C</code> is not the syntax for a class but a constant. For example you could do any of the following to define the <code>C</code> constant.</p>\n\n<pre><code>C = \"hello\"\nC = Class.new\nclass C; end\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8021363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea88d472c316bb30f706ee235a0a44ab?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Student", "link": "https://stackoverflow.com/users/8021363/confused-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1494963881, "creation_date": 1494958425, "last_edit_date": 1494963881, "question_id": 44008770, "link": "https://stackoverflow.com/questions/44008770/a-little-stumped-with-some-code-for-class", "title": "A little stumped with some code for class", "body": "<p>I'm a little stumped with an assignment for class. So I'm supposed to take four user inputs for different hotels and have different prices. I'm having trouble with some of my If statements. When I test my program say I put \"A\" I get an error saying uninitialized constant C (NameError). I'm just looking to see if the user puts A,B,C, or D and then go on to do the rest of the if statement. I'm wondering if I did something wrong with my if statements. Here is my code.</p>\n\n<pre><code>choice1 = gets.chomp.capitalize.to_s\n\nif choice1 == C then \n  puts \"For how many nights?\"\n  nightsC == gets.chomp.to_i\n\n  if nightsC == 3\n    priceC == 700\n    nightsT + nightsC\n  else\n    priceC == nightsC * 300\n  end\nend\n</code></pre>\n\n<p>Here's the Pastebin <a href=\"https://pastebin.com/9c5ezuab\" rel=\"nofollow noreferrer\">https://pastebin.com/9c5ezuab</a></p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rbenv", "capistrano3"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1494957932, "post_id": 44008509, "comment_id": 75045299, "body": "You have a SEGFAULT (which means, your ruby process died, often because of incompatible C-extensions). In addition to that, you are using Rails 4.2.4 with Ruby 2.4. This won&#39;t work. The first version of Rails 4.2 to be compatible with Ruby 2.4 is Rails 4.2.8."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494958063, "post_id": 44008509, "comment_id": 75045369, "body": "If you need to use Rails <code>4.2.4</code>, then use Ruby <code>2.3.x</code> (ideally <code>2.3.4</code>). If you need to use Rails <code>4.2.x</code>, and want to use Ruby <code>2.4.x</code>, then use Rails <code>4.2.8</code> (and ideally Ruby <code>2.4.1</code>). Or if you have no good reason to restrict the versions (e.g. if this is a new project), then just go for the latest versions of both: Rails <code>5.1.1</code> and Ruby <code>2.4.1</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494958233, "post_id": 44008509, "comment_id": 75045472, "body": "For a little bit of context here, see: <a href=\"http://weblog.rubyonrails.org/2017/2/21/Rails-4-2-8-has-been-released/\" rel=\"nofollow noreferrer\">weblog.rubyonrails.org/2017/2/21/Rails-4-2-8-has-been-releas&zwnj;&#8203;ed</a>"}, {"owner": {"reputation": 620, "user_id": 2243320, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e0accc0a9f0b38c1aed5c668875b4868?s=128&d=identicon&r=PG", "display_name": "Nicoara Talpes", "link": "https://stackoverflow.com/users/2243320/nicoara-talpes"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1494960707, "post_id": 44008509, "comment_id": 75046927, "body": "@HolgerJust I specified in my Gemfile &quot;gem &#39;rails&#39;, &#39;5.1.1&#39;&quot;, and my ruby is 2.4.0p0 . now error is:  01 $HOME/.rbenv/bin/rbenv exec bundle exec rake assets:precompile       01 /home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/acti&zwnj;&#8203;vesupport-4.2.4/lib/&zwnj;&#8203;active_support/core_&zwnj;&#8203;ext/numeric/conversi&zwnj;&#8203;ons.rb:121: warning: constant ::Fixnum \u2026       01 rake aborted!       01 SystemStackError: stack level too deep       01 /home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/acti&zwnj;&#8203;vesupport-4.2.4/lib/&zwnj;&#8203;active_support/core_&zwnj;&#8203;ext/numeric/conversi&zwnj;&#8203;ons.rb:124:in `block (2 levels) in &lt;cla\u2026"}, {"owner": {"reputation": 620, "user_id": 2243320, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e0accc0a9f0b38c1aed5c668875b4868?s=128&d=identicon&r=PG", "display_name": "Nicoara Talpes", "link": "https://stackoverflow.com/users/2243320/nicoara-talpes"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494960719, "post_id": 44008509, "comment_id": 75046935, "body": "@TomLord replied above . thanks"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494967233, "post_id": 44008509, "comment_id": 75050573, "body": "@NicoaraTalpes &quot;.../ruby/&lt;&lt;2.4.0&gt;&gt;/gems/acti\u200c\u200bvesupport-&lt;&lt;4.2.4&gt;&gt;/lib/...&quot; -- You&#39;re <i>still</i> using Rails <code>4.2.4</code>, and why are you not using ruby <code>2.4.1</code>?"}, {"owner": {"reputation": 620, "user_id": 2243320, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e0accc0a9f0b38c1aed5c668875b4868?s=128&d=identicon&r=PG", "display_name": "Nicoara Talpes", "link": "https://stackoverflow.com/users/2243320/nicoara-talpes"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495036271, "post_id": 44008509, "comment_id": 75085615, "body": "@TomLord know i have ruby 2.4.1 on both local and server. but somehow it keeps installing on the server at /home/deploy/deploy_test1/shared/bundle/ruby the version 2.4.0 and keeps repeating the same error. how do i tell it not to install this version? my Capfile has &quot;set :rbenv_ruby, &#39;2.4.1&#39;&quot;. Thanks"}, {"owner": {"reputation": 620, "user_id": 2243320, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e0accc0a9f0b38c1aed5c668875b4868?s=128&d=identicon&r=PG", "display_name": "Nicoara Talpes", "link": "https://stackoverflow.com/users/2243320/nicoara-talpes"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1495108564, "post_id": 44008509, "comment_id": 75119408, "body": "@HolgerJust I have updated the problem with a comment. Thanks"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1495145476, "post_id": 44008509, "comment_id": 75142078, "body": "I don&#39;t know, @NicoaraTalpes. Without knowing <i>exactly</i> what you are doing to cause this behaviour, and without a reproducible example, I can only guess. My best guess at this point is that you are typing <code>git commit</code>, but not <code>git push</code> - and so therefore are deploying the wrong version."}], "owner": {"reputation": 620, "user_id": 2243320, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e0accc0a9f0b38c1aed5c668875b4868?s=128&d=identicon&r=PG", "display_name": "Nicoara Talpes", "link": "https://stackoverflow.com/users/2243320/nicoara-talpes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 524, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494957614, "creation_date": 1494957614, "question_id": 44008509, "link": "https://stackoverflow.com/questions/44008509/rake-exit-status-139", "title": "rake exit status: 139", "body": "<p>I am following <a href=\"https://gorails.com/deploy/ubuntu/16.04\" rel=\"nofollow noreferrer\">https://gorails.com/deploy/ubuntu/16.04</a></p>\n\n<p>I am running : \"bundle exec cap production deploy\" and getting the following error:</p>\n\n<pre><code>         01 $HOME/.rbenv/bin/rbenv exec bundle install --path /home/deploy/deploy_test1/shared/bundle --without development test --deployment --q\u2026\n        \u2714 01 deploy@107.170.84.18 3.251s\n    00:21 deploy:assets:precompile\n          01 $HOME/.rbenv/bin/rbenv exec bundle exec rake assets:precompile\n          01 /home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:121: w\u2026\n          01 /home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:121: w\u2026\n          01 bash: line 1: 23934 Segmentation fault      (core dumped) $HOME/.rbenv/bin/rbenv exec bundle exec rake assets:precompile\n    (Backtrace restricted to imported tasks)\n    cap aborted!\n    SSHKit::Runner::ExecuteError: Exception while executing as deploy@107.170.84.18: rake exit status: 139\n    rake stdout: Nothing written\n    rake stderr: /home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:121: warning: constant ::Fixnum is deprecated\n    /home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:121: warning: constant ::Bignum is deprecated\n    bash: line 1: 23934 Segmentation fault      (core dumped) $HOME/.rbenv/bin/rbenv exec bundle exec rake assets:precompile\n\n    SSHKit::Command::Failed: rake exit status: 139\n    rake stdout: Nothing written\n    rake stderr: /home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:121: warning: constant ::Fixnum is deprecated\n    /home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:121: warning: constant ::Bignum is deprecated\n    bash: line 1: 23934 Segmentation fault      (core dumped) $HOME/.rbenv/bin/rbenv exec bundle exec rake assets:precompile\n\n    Tasks: TOP =&gt; deploy:assets:precompile\n    (See full trace by running task with --trace)\n    The deploy has failed with an error: Exception while executing as deploy@107.170.84.18: rake exit status: 139\n    rake stdout: Nothing written\n    rake stderr: /home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:121: warning: constant ::Fixnum is deprecated\n    /home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:121: warning: constant ::Bignum is deprecated\n    bash: line 1: 23934 Segmentation fault      (core dumped) $HOME/.rbenv/bin/rbenv exec bundle exec rake assets:precompile\n......\n......\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/cache/strategy/local_cache.rb:138:in `local_cache_key'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/cache/strategy/local_cache.rb:74:in `middleware'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/application/bootstrap.rb:79:in `block in &lt;module:Bootstrap&gt;'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/initializable.rb:30:in `instance_exec'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/initializable.rb:30:in `run'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/initializable.rb:55:in `block in run_initializers'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/initializable.rb:54:in `run_initializers'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/application.rb:352:in `initialize!'\n/home/deploy/deploy_test1/releases/20170516175610/config/environment.rb:5:in `&lt;top (required)&gt;'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/application.rb:328:in `require'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/application.rb:328:in `require_environment!'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/application.rb:457:in `block in run_tasks_blocks'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/sprockets-rails-3.2.0/lib/sprockets/rails/task.rb:62:in `block (2 levels) in define'\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/rake-12.0.0/exe/rake:27:in `&lt;top (required)&gt;'\n/home/deploy/.rbenv/versions/2.4.0/bin/bundle:22:in `load'\n/home/deploy/.rbenv/versions/2.4.0/bin/bundle:22:in `&lt;main&gt;'\nTasks: TOP =&gt; environment\n(See full trace by running task with --trace)\n\n\n** DEPLOY FAILED\n** Refer to log/capistrano.log for details. Here are the last 20 lines:\n\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/cache/strategy/local_cache.rb:138:in `local_cache_key'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/activesupport-4.2.4/lib/active_support/cache/strategy/local_cache.rb:74:in `middleware'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/application/bootstrap.rb:79:in `block in &lt;module:Bootstrap&gt;'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/initializable.rb:30:in `instance_exec'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/initializable.rb:30:in `run'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/initializable.rb:55:in `block in run_initializers'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/initializable.rb:54:in `run_initializers'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/application.rb:352:in `initialize!'\n\n/home/deploy/deploy_test1/releases/20170516175610/config/environment.rb:5:in `&lt;top (required)&gt;'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/application.rb:328:in `require'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/application.rb:328:in `require_environment!'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/railties-4.2.4/lib/rails/application.rb:457:in `block in run_tasks_blocks'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/sprockets-rails-3.2.0/lib/sprockets/rails/task.rb:62:in `block (2 levels) in define'\n\n/home/deploy/deploy_test1/shared/bundle/ruby/2.4.0/gems/rake-12.0.0/exe/rake:27:in `&lt;top (required)&gt;'\n\n/home/deploy/.rbenv/versions/2.4.0/bin/bundle:22:in `load'\n\n/home/deploy/.rbenv/versions/2.4.0/bin/bundle:22:in `&lt;main&gt;'\n\nTasks: TOP =&gt; environment\n\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>my Capfile is the one from here with rbenv 2.4.0:\n<a href=\"https://stackoverflow.com/questions/43878840/cap-deploy-rbenv-bundle-command-not-found?noredirect=1#comment74889497_43878840\">cap deploy + rbenv: bundle: command not found</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "will-paginate"], "answers": [{"tags": [], "owner": {"reputation": 691, "user_id": 4761914, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/xyiAo.jpg?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/4761914/antonio"}, "is_accepted": true, "score": 2, "last_activity_date": 1494962270, "creation_date": 1494962270, "answer_id": 44009832, "question_id": 44008290, "link": "https://stackoverflow.com/questions/44008290/rails-5-will-paginate-gem-paginating-repeated-objects-100-objects-of-ids-1-10/44009832#44009832", "title": "Rails 5: will_paginate gem paginating repeated objects (100 objects of ids 1-10 etc).", "body": "<p>I figured out my issue. I was handling the code the <code>&lt;%= render @books %&gt;</code> wrong (I don't use it that much).</p>\n\n<p>I had to change my code in my partial to be more implicit. using <code>@books.each do |b|</code> was making things repeat multiple times. Changing my code to this:</p>\n\n<pre><code>&lt;!-- _book.html.erb --&gt;\n&lt;tr&gt;\n  &lt;div&gt;\n    &lt;td&gt;&lt;%= book.id %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= book.title %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= book.author %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= book.genre %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= book.pub_date %&gt;&lt;/td&gt;\n  &lt;/div&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>fixed all my issues. </p>\n"}], "owner": {"reputation": 691, "user_id": 4761914, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/xyiAo.jpg?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/4761914/antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 44009832, "answer_count": 1, "score": 1, "last_activity_date": 1494962270, "creation_date": 1494956837, "question_id": 44008290, "link": "https://stackoverflow.com/questions/44008290/rails-5-will-paginate-gem-paginating-repeated-objects-100-objects-of-ids-1-10", "title": "Rails 5: will_paginate gem paginating repeated objects (100 objects of ids 1-10 etc).", "body": "<p>I have <code>will_paginate</code> version <code>3.1.5</code> installed on my app and it's doing something funky.</p>\n\n<p>I'm trying to paginate <code>Books</code>. I have pagination set up like this in my <code>books_controller</code>:</p>\n\n<pre><code>def index\n  @books = Book.paginate(page: params[:page], per_page: 10)\n  respond_to do |format|\n    format.html\n    format.js\n  end\nend\n</code></pre>\n\n<p>But when I visit that page, I notice that the terminal doesn't query 10 books like it should:</p>\n\n<pre><code>Started GET \"/\" for ::1 at 2017-05-16 10:28:47 -0700\nProcessing by BooksController#index as HTML\n  Rendering books/index.html.erb within layouts/application\n  Book Load (1.1ms)  SELECT  \"books\".* FROM \"books\" LIMIT $1 OFFSET $2  [[\"LIMIT\", 10], [\"OFFSET\", 0]]\n  Rendered collection of books/_book.html.erb [10 times] (291.7ms)\n   (0.6ms)  SELECT COUNT(*) FROM \"books\"\n  Rendered books/index.html.erb within layouts/application (389.9ms)\nCompleted 200 OK in 880ms (Views: 849.9ms | ActiveRecord: 1.7ms)\n</code></pre>\n\n<p>If I inspect <code>@books</code> I see that there are 100 <code>books</code> in the collection.</p>\n\n<pre><code>(byebug) @books.count\n  CACHE (0.0ms)  SELECT COUNT(*) FROM \"books\"\n100\n</code></pre>\n\n<p>But, upon further inspection, It just 10 copies of the first 10 books in the collection. There are only <code>id</code>s in the collection are 1-10.</p>\n\n<pre><code>(byebug) @books.each { |b| puts b.id }\n  Book Load (0.9ms)  SELECT  \"books\".* FROM \"books\" LIMIT $1 OFFSET $2  [[\"LIMIT\", 10], [\"OFFSET\", 0]]\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n</code></pre>\n\n<p>If I go to the next page I'll just get another 100 results but the <code>id</code>s only being 11-20:</p>\n\n<pre><code>(byebug) @books.count\n   (0.4ms)  SELECT COUNT(*) FROM \"books\"\n100\n(byebug) @books.each { |b| puts b.id }\n  Book Load (4.9ms)  SELECT  \"books\".* FROM \"books\" LIMIT $1 OFFSET $2  [[\"LIMIT\", 10], [\"OFFSET\", 10]]\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n</code></pre>\n\n<p>Here are my views:</p>\n\n<pre><code>&lt;!-- index.html.erb --&gt;\n&lt;h1&gt;Books list:&lt;/h1&gt;\n\n&lt;div&gt;\n  &lt;table&gt;\n    &lt;thead&gt;\n      &lt;tr&gt;\n        &lt;th&gt;ID&lt;/th&gt;\n        &lt;th&gt;Title&lt;/th&gt;\n        &lt;th&gt;Author&lt;/th&gt;\n        &lt;th&gt;Genre&lt;/th&gt;\n        &lt;th&gt;Publication Date&lt;/th&gt;\n      &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody id=\"book-list\"&gt;\n      &lt;%= render @books %&gt;\n    &lt;/tbody&gt;\n  &lt;/table&gt;\n  &lt;/ul&gt;\n&lt;/div&gt;\n\n&lt;div id=\"infinite-scrolling\"&gt;\n  &lt;%= will_paginate %&gt;\n&lt;/div&gt;\n\n&lt;!-- _book.html.erb --&gt;\n&lt;% @books.each do |b| %&gt;\n&lt;tr&gt;\n  &lt;div&gt;\n    &lt;td&gt;&lt;%= b.id %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= b.title %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= b.author %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= b.genre %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= b.pub_date %&gt;&lt;/td&gt;\n  &lt;/div&gt;\n&lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "recursion", "minmax"], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1494957420, "creation_date": 1494957420, "answer_id": 44008453, "question_id": 44008051, "link": "https://stackoverflow.com/questions/44008051/minmax-tic-tac-toe/44008453#44008453", "title": "Minmax tic-tac-toe", "body": "<p>The error message says pretty clearly what the problem is: you are attempting to call <code>[]</code> on <code>nil</code>, but <code>nil</code> doesn't respond to <code>[]</code>. The only place where you call <code>[]</code> is on the result of <code>max_by</code>. <code>max_by</code> returns <code>nil</code> when called on an empty <code>Enumerable</code>. Ergo, <code>best_score</code> must be empty. And indeed: you always pass an empty <code>Hash</code> as the argument to <code>best_score</code>, and you never modify <code>best_score</code>, so it is and always will be empty.</p>\n"}], "owner": {"reputation": 27, "user_id": 5266498, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/35140aa543689b761c1a167440cb5af0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahler7", "link": "https://stackoverflow.com/users/5266498/mahler7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1494983954, "creation_date": 1494956001, "last_edit_date": 1494983954, "question_id": 44008051, "link": "https://stackoverflow.com/questions/44008051/minmax-tic-tac-toe", "title": "Minmax tic-tac-toe", "body": "<p>I'm trying to use the <a href=\"http://www.shei.io/recursion-minimax-algorithm\" rel=\"nofollow noreferrer\">minmax algorithm</a> for a game of tic-tac-toe.</p>\n\n<p>This is the code I'm working with for getting the best AI move in the game.</p>\n\n<pre><code> def get_best_move(board, next_player, depth = 0, best_score = {})\n    return 0 if tie(board)\n    return -1 if game_is_over(board)\n\n    available_spaces = []\n    best_move = nil\n    board.each do |s|\n      if s != \"X\" &amp;&amp; s != \"O\"\n        available_spaces &lt;&lt; s\n      end\n    end\n\n    available_spaces.each do |as|\n      board[as.to_i] = @com\n      if game_is_over(board)\n        best_score[as.to_i] = -1 * get_best_move(board, @com, depth + 1, {})\n        board[as.to_i] = as\n        return best_score\n      else\n        board[as.to_i] = @hum\n        if game_is_over(board)\n          best_score[as.to_i] = -1 * get_best_move(board, @com, depth + 1, {})\n          board[as.to_i] = as\n          return best_score\n        else\n          board[as.to_i] = as\n        end\n      end\n    end\n    best_move = best_score.max_by { |key, value| value }[0] \n    highest_minimax_score = best_score.max_by { |key, value| value }[1] \n\n    if depth == 0\n      return best_move\n    elsif depth &gt; 0\n      return highest_minimax_score\n    end\n  end\n</code></pre>\n\n<p>I get this error when I run the game in the terminal, and I would like to know how to fix it.</p>\n\n<pre><code>rb:332:in get_best_move': undefined method `[]' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>rb:332 is referring to these 2 lines in the example below</p>\n\n<pre><code>best_move = best_score.max_by { |key, value| value }[0] \nhighest_minimax_score = best_score.max_by { |key, value| value }[1]\n</code></pre>\n"}, {"tags": ["ruby", "pdf", "encoding"], "comments": [{"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 1, "creation_date": 1499227763, "post_id": 44008009, "comment_id": 76809731, "body": "I am CombinePDF&#39;s author. I can&#39;t fully support Object Streams without supporting PDF encryption, which is a huge headache and I don&#39;t need it for my use-case... <i>however</i>, if you found an issue where CombinePDF doesn&#39;t manage to open a file, <a href=\"https://github.com/boazsegev/combine_pdf/issues\" rel=\"nofollow noreferrer\">please open an issue at GitHub</a>. I&#39;ll try to make it work as much as I can, even if it&#39;s caused by Object Streams."}, {"owner": {"reputation": 5455, "user_id": 393021, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5761f8f81bb258e64b585889481ef25c?s=128&d=identicon&r=PG", "display_name": "iGbanam", "link": "https://stackoverflow.com/users/393021/igbanam"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1499253825, "post_id": 44008009, "comment_id": 76825046, "body": "Amazing! I shall do just that. To move forward on this problem, I used <a href=\"http://qpdf.sourceforge.net/\" rel=\"nofollow noreferrer\">QPDF</a>. Maybe this could help you look into how it could come into CombinePDF if you see a merger with this and your use-case"}], "owner": {"reputation": 5455, "user_id": 393021, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5761f8f81bb258e64b585889481ef25c?s=128&d=identicon&r=PG", "display_name": "iGbanam", "link": "https://stackoverflow.com/users/393021/igbanam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 399, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495018791, "creation_date": 1494955862, "last_edit_date": 1495018791, "question_id": 44008009, "link": "https://stackoverflow.com/questions/44008009/remove-object-stream-encodings-from-pdf", "title": "Remove Object Stream Encodings from PDF", "body": "<p>I have a PDF which was encoded using Object Streams. I would like to parse this PDF for further processing with other generated PDFs. Most PDF gems I have used claim Object Streams are not supported. </p>\n\n<p>How have you dealt with parsing object streams?</p>\n\n<p>I am currently using <a href=\"https://github.com/boazsegev/combine_pdf\" rel=\"nofollow noreferrer\">CombinePDF</a>. When I try to load the PDF, CombinePDF chokes on parsing this PDF.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aC8M5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aC8M5.png\" alt=\"Cannot parse object streams\"></a></p>\n\n<p>Ideally, I would like to take a PDF which has object streams, remove the object streams, save the PDF as a new PDF file without object streams.</p>\n\n<p>Other gems I've tried, <a href=\"https://github.com/gdelugre/origami\" rel=\"nofollow noreferrer\">Origami</a>, <a href=\"https://github.com/Erol/yomu\" rel=\"nofollow noreferrer\">Yomu</a>, and PDF Reader, all do a lazy parsing. </p>\n\n<p>I know this is possible because I achieved this using Preview on OS X. I opened the said file with Preview on OS X and \"Export to PDF\u2026\", the new file did not have object streams. How can I reproduce this action in code? </p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "search"], "comments": [{"owner": {"reputation": 2877, "user_id": 1234433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DQSgD.png?s=128&g=1", "display_name": "James Kraus", "link": "https://stackoverflow.com/users/1234433/james-kraus"}, "edited": false, "score": 0, "creation_date": 1494955012, "post_id": 44007755, "comment_id": 75043628, "body": "If you create a fiddle/example of a table and the code here filtering it, that would make helping you easier."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1494964136, "post_id": 44007755, "comment_id": 75048874, "body": "When I run the snippet I get an error <code>Uncaught SyntaxError: Unexpected token &lt;&quot;,</code>"}], "owner": {"reputation": 21, "user_id": 3531964, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cf4cb0bf103679aa3f205fd274958fb?s=128&d=identicon&r=PG&f=1", "display_name": "Walsh259", "link": "https://stackoverflow.com/users/3531964/walsh259"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494958498, "creation_date": 1494954945, "last_edit_date": 1494958498, "question_id": 44007755, "link": "https://stackoverflow.com/questions/44007755/searching-a-table-in-ruby-on-rails-with-javascript", "title": "Searching a table in Ruby on rails with Javascript", "body": "<p>I'm new to both ruby and javascript and currently trying to add a search to a table. </p>\n\n<p>Is there a way to make this code work? \nWhen I load the page with the table I see the results in the table, however, once I start to search then they all disappear.</p>\n\n<pre><code>    &lt;div class=\"container\"&gt;\n\n  &lt;div class=\"page-header\"&gt;\n    &lt;h3&gt;Order List&lt;/h3&gt;\n  &lt;/div&gt;\n\n&lt;input type=\"text\" id=\"myInput\" onkeyup=\"myFunction()\" placeholder=\"Search for names..\"&gt;\n\n  &lt;table id=\"myTable\"&gt;\n    &lt;thead&gt;\n      &lt;tr&gt;\n        &lt;th&gt;ID&lt;/th&gt;\n        &lt;th&gt;Name&lt;/th&gt;\n        &lt;th&gt;Phone&lt;/th&gt;\n        &lt;th&gt;Date&lt;/th&gt;\n        &lt;th&gt;Total&lt;/th&gt;\n        &lt;th&gt;Weight(kg)&lt;/th&gt;\n        &lt;th&gt;Status&lt;/th&gt;\n        &lt;th&gt;View&lt;/th&gt;\n        &lt;th&gt;&lt;/th&gt;\n      &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n      &lt;% @orders.each_with_index do |order, index| %&gt;\n        &lt;tr&gt;\n          &lt;td&gt;&lt;%= order.id %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= order.name %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%=  %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= order.ddate1 %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%=  order.total_price%&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= order.weight%&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= order.status %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= link_to 'View', dashboard_user_sale_path(user_id: current_user, id: order), class: 'btn btn-primary'%&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= link_to 'Update Status/ Notes', '#', :id =&gt; 'login', \"data-toggle\" =&gt; \"modal\", 'data-target' =&gt; '#index', class: \"btn btn-default\"%&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;%= render 'status_note', order: order, index: index%&gt;\n      &lt;% end %&gt;\n    &lt;/tbody&gt;\n  &lt;/table&gt;\n\n\n&lt;/div&gt;\n\n&lt;script&gt;\nfunction myFunction() {\n  // Declare variables \n  var input, filter, table, tr, td, i;\n  input = document.getElementById(\"myInput\");\n  filter = input.value.toUpperCase();\n  table = document.getElementById(\"myTable\");\n  tr = table.getElementsByTagName(\"tr\");\n\n  // Loop through all table rows, and hide those who don't match the search query\n  for (i = 0; i &lt; tr.length; i++) {\n    td = tr[i].getElementsByTagName(\"td\")[0];\n    if (td) {\n      if (td.innerHTML.toUpperCase().indexOf(filter) &gt; -1) {\n        tr[i].style.display = \"\";\n      } else {\n        tr[i].style.display = \"none\";\n      }\n    } \n  }\n}\n&lt;/script&gt;\n</code></pre>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>&lt;script&gt;\r\nfunction myFunction() {\r\n  // Declare variables \r\n  var input, filter, table, tr, td, i;\r\n  input = document.getElementById(\"myInput\");\r\n  filter = input.value.toUpperCase();\r\n  table = document.getElementById(\"myTable\");\r\n  tr = table.getElementsByTagName(\"tr\");\r\n\r\n  // Loop through all table rows, and hide those who don't match the search query\r\n  for (i = 0; i &lt; tr.length; i++) {\r\n    td = tr[i].getElementsByTagName(\"td\")[0];\r\n    if (td) {\r\n      if (td.innerHTML.toUpperCase().indexOf(filter) &gt; -1) {\r\n        tr[i].style.display = \"\";\r\n      } else {\r\n        tr[i].style.display = \"none\";\r\n      }\r\n    } \r\n  }\r\n}\r\n&lt;/script&gt;</code></pre>\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>#myInput {\r\n    background-image: url('/css/searchicon.png'); /* Add a search icon to input */\r\n    background-position: 10px 12px; /* Position the search icon */\r\n    background-repeat: no-repeat; /* Do not repeat the icon image */\r\n    width: 100%; /* Full-width */\r\n    font-size: 16px; /* Increase font-size */\r\n    padding: 12px 20px 12px 40px; /* Add some padding */\r\n    border: 1px solid #ddd; /* Add a grey border */\r\n    margin-bottom: 12px; /* Add some space below the input */\r\n}\r\n\r\n#myTable {\r\n    border-collapse: collapse; /* Collapse borders */\r\n    width: 100%; /* Full-width */\r\n    border: 1px solid #ddd; /* Add a grey border */\r\n    font-size: 18px; /* Increase font-size */\r\n}\r\n\r\n#myTable th, #myTable td {\r\n    text-align: left; /* Left-align text */\r\n    padding: 12px; /* Add padding */\r\n}\r\n\r\n#myTable tr {\r\n    /* Add a bottom border to all table rows */\r\n    border-bottom: 1px solid #ddd; \r\n}\r\n\r\n#myTable tr.header, #myTable tr:hover {\r\n    /* Add a grey background color to the table header and on hover */\r\n    background-color: #f1f1f1;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"container\"&gt;\r\n\r\n  &lt;div class=\"page-header\"&gt;\r\n    &lt;h3&gt;Order List&lt;/h3&gt;\r\n  &lt;/div&gt;\r\n\r\n&lt;input type=\"text\" id=\"myInput\" onkeyup=\"myFunction()\" placeholder=\"Search for Names or order ID..\"&gt;\r\n\r\n  &lt;table id=\"myTable\"&gt;\r\n    &lt;thead&gt;\r\n      &lt;tr&gt;\r\n        &lt;th&gt;ID&lt;/th&gt;\r\n        &lt;th&gt;Name&lt;/th&gt;\r\n        &lt;th&gt;Phone&lt;/th&gt;\r\n        &lt;th&gt;Date&lt;/th&gt;\r\n        &lt;th&gt;Total&lt;/th&gt;\r\n        &lt;th&gt;Weight(kg)&lt;/th&gt;\r\n        &lt;th&gt;Status&lt;/th&gt;\r\n        &lt;th&gt;View&lt;/th&gt;\r\n        &lt;th&gt;&lt;/th&gt;\r\n      &lt;/tr&gt;\r\n    &lt;/thead&gt;\r\n    &lt;tbody&gt;\r\n      &lt;% @orders.each_with_index do |order, index| %&gt;\r\n        &lt;tr&gt;\r\n          &lt;td&gt;&lt;%= order.id %&gt;&lt;/td&gt;\r\n          &lt;td&gt;&lt;%= order.name %&gt;&lt;/td&gt;\r\n          &lt;td&gt;&lt;%=  %&gt;&lt;/td&gt;\r\n          &lt;td&gt;&lt;%= order.ddate1 %&gt;&lt;/td&gt;\r\n          &lt;td&gt;&lt;%=  order.total_price%&gt;&lt;/td&gt;\r\n          &lt;td&gt;&lt;%= order.weight%&gt;&lt;/td&gt;\r\n          &lt;td&gt;&lt;%= order.status %&gt;&lt;/td&gt;\r\n          &lt;td&gt;&lt;%= link_to 'View', dashboard_user_sale_path(user_id: current_user, id: order), class: 'btn btn-primary'%&gt;&lt;/td&gt;\r\n          &lt;td&gt;&lt;%= link_to 'Update Status/ Notes', '#', :id =&gt; 'login', \"data-toggle\" =&gt; \"modal\", 'data-target' =&gt; '#index', class: \"btn btn-default\"%&gt;&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n        &lt;%= render 'status_note', order: order, index: index%&gt;\r\n      &lt;% end %&gt;\r\n    &lt;/tbody&gt;\r\n  &lt;/table&gt;\r\n\r\n\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby", "puppet", "erb", "eruby"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1494955622, "post_id": 44007694, "comment_id": 75043948, "body": "Can&#39;t you just dump <code>@filename</code> into a JavaScript variable (probably using JSON) and then iterate over the data in JavaScript? That approach tends to be a lot cleaner and easier to understand than writing a code generator."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1494956136, "post_id": 44007694, "comment_id": 75044221, "body": "@muistooshort, that might be easier, but it&#39;s irrelevant.  The point here is to build a file that will be deployed on the Puppet client.  The required nature of the file is a characteristic of the package that is going to use it.  One is rarely at liberty to demand that the package work differently or accept a different form of input than it already does."}, {"owner": {"reputation": 343, "user_id": 6839853, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c07dcef318ffb2616264d986be5ea550?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6839853/max"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1494956559, "post_id": 44007694, "comment_id": 75044488, "body": "@muistooshort, thanks for the reply! Well I never thought about that, since I don&#39;t code in JavaScript, only Bash and Python, a and bit Ruby and Perl. Our hiera backend in the company is yaml. So I have to stick to this. But I am interesting how this would be in JavaScript!"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1494957413, "post_id": 44007694, "comment_id": 75044998, "body": "I misread your question and thought you were producing JavaScript rather than some Puppet-specific configuration."}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 6839853, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c07dcef318ffb2616264d986be5ea550?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6839853/max"}, "edited": false, "score": 0, "creation_date": 1494957032, "post_id": 44008239, "comment_id": 75044755, "body": "I have this point in my mind, since the hash could have more or less than five entries depending on the location of the company and how the network infrastructure looks like. I wanted to resolve the indentation issue and then use the same approach to generate the block closures. Will try it and post the final result. You seem to be my savior John. Thanks man!"}, {"owner": {"reputation": 343, "user_id": 6839853, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c07dcef318ffb2616264d986be5ea550?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6839853/max"}, "edited": false, "score": 0, "creation_date": 1494957490, "post_id": 44008239, "comment_id": 75045037, "body": "Works perfect! I&#39;ll post the final code when I am done with block closures! Thanks again John."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1494970953, "last_edit_date": 1494970953, "creation_date": 1494956650, "answer_id": 44008239, "question_id": 44007694, "link": "https://stackoverflow.com/questions/44007694/indentation-erb-file/44008239#44008239", "title": "indentation ERB file", "body": "<p>You ought to be able to generate appropriate indentation via Ruby scriptlet code by building up an indentation string as you iterate.  For example,</p>\n\n<pre><code>if (!EAP-Message) {\n    # Now check against the authorized_macs file\n    &lt;%- indent = '' -%&gt;\n    &lt;%- @filename.each do |key,value| -%&gt;\n    &lt;%= indent %&gt;&lt;%= key %&gt;\n    &lt;%= indent %&gt;if (!ok) {\n    &lt;%- indent += '    ' -%&gt;\n    &lt;%- end -%&gt;\n                        eap\n    ...\n</code></pre>\n\n<p>It seems to me, though, that you might have another problem.  Can you be confident that the <code>@filenames</code> hash will always contain exactly five entries?  If it contains some other number of entries then your template will produce malformed output, because there will be either too many or too few block closures.</p>\n\n<p>You could address that by using an approach similar to the one I already described to build up the block closures in a string as you iterate, and then outputting the string at the appropriate point (instead of using template text to close the blocks).</p>\n"}, {"tags": [], "owner": {"reputation": 343, "user_id": 6839853, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c07dcef318ffb2616264d986be5ea550?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6839853/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1495028716, "last_edit_date": 1495028716, "creation_date": 1495017836, "answer_id": 44022629, "question_id": 44007694, "link": "https://stackoverflow.com/questions/44007694/indentation-erb-file/44022629#44022629", "title": "indentation ERB file", "body": "<p>this is the final result of the freeradius module. These are the relevant code fragments I've been asking for help.</p>\n\n<p><strong>default.erb</strong></p>\n\n<pre><code>if (!EAP-Message) {\n    # Now check against the authorized_macs file\n    &lt;%- indent = '' -%&gt;\n    &lt;%- @filename.each do |key,value| -%&gt;\n    &lt;%= indent %&gt;&lt;%= key %&gt;\n    &lt;%= indent %&gt;if (!ok) {\n    &lt;%- indent += '    ' -%&gt;\n    &lt;%- end -%&gt;\n    &lt;%= indent %&gt;eap\n&lt;%- @filename.each do |key,value| -%&gt;\n    &lt;%= indent %&gt;}\n    &lt;%= indent %&gt;else {\n        &lt;%= indent %&gt;# accept\n        &lt;%= indent %&gt;update control {\n            &lt;%= indent %&gt;Auth-Type := Accept\n        &lt;%= indent %&gt;}\n    &lt;%= indent %&gt;}\n&lt;% indent = indent.slice(0..-5) -%&gt;\n&lt;%- end -%&gt; \n}\nelse {\n    eap\n}\n</code></pre>\n\n<p>The <code>post-auth</code> section of the virtual server configuration was a bit tricky, as I had to read the hash, write down the keys and assign the vlans in reverse order, so I converted the hash to an array, revered it and converted the array back to hash.</p>\n\n<p><strong>inner-tunnel</strong></p>\n\n<pre><code>post-auth {\n    &lt;%- indent = '' -%&gt;\n    &lt;%- @filename.each do |key,value| -%&gt;\n    &lt;%= indent %&gt;&lt;%= key %&gt;\n    &lt;%= indent %&gt;if (!ok) {\n    &lt;%- indent += '    ' -%&gt;\n    &lt;%- end -%&gt;\n    &lt;%= indent %&gt;ldap\n&lt;%- @new_files = Hash[@filename.to_a.reverse].to_hash -%&gt;\n&lt;%- @new_files.each do |key,value| -%&gt;\n&lt;%= indent %&gt;}\n&lt;%= indent %&gt;else {\n    &lt;%= indent %&gt;update reply {\n        &lt;%= indent %&gt;Tunnel-Type = VLAN\n        &lt;%= indent %&gt;Tunnel-Medium-Type = IEEE-802\n        &lt;%= indent %&gt;Tunnel-Private-Group-ID =  &lt;%= value['vlan'] %&gt;\n    &lt;%= indent %&gt;}\n&lt;%= indent %&gt;}\n&lt;%- indent = indent.slice(0..-5) -%&gt;\n&lt;%- end -%&gt;\n\n    ldap\n&lt;%- @groups.each do |key,value| -%&gt;\n&lt;%- if key == 'vlan_10' -%&gt;\n    if (LDAP-Group == vlan_10) {\n        update reply {\n            Tunnel-Type = VLAN\n            Tunnel-Medium-Type = IEEE-802\n            Tunnel-Private-Group-ID = 10\n        }\n    }\n&lt;%- else -%&gt;\n    elsif (LDAP-Group == &lt;%= key %&gt;) {\n        update reply {\n            Tunnel-Type = VLAN\n            Tunnel-Medium-Type = IEEE-802\n            Tunnel-Private-Group-ID = &lt;%= value['vlan'] %&gt;\n        }\n    }\n&lt;%- end -%&gt;\n&lt;%- end -%&gt;\n\n    Post-Auth-Type REJECT {\n        attr_filter.access_reject\n    }\n}\n</code></pre>\n\n<p>Thank you all, especially John!</p>\n"}], "owner": {"reputation": 343, "user_id": 6839853, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c07dcef318ffb2616264d986be5ea550?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6839853/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1342, "favorite_count": 0, "accepted_answer_id": 44008239, "answer_count": 2, "score": 1, "last_activity_date": 1495028716, "creation_date": 1494954766, "question_id": 44007694, "link": "https://stackoverflow.com/questions/44007694/indentation-erb-file", "title": "indentation ERB file", "body": "<p>I have the following code:</p>\n\n<pre><code>if (!EAP-Message) {\n    # Now check against the authorized_macs file\n    &lt;%- @filename.each do |key,value| -%&gt;\n    &lt;%= key %&gt;\n    if (!ok) {\n    &lt;%- end -%&gt;\n                        eap\n                    }\n                    else {\n                        # accept\n                        update control {\n                            Auth-Type := Accept\n                        }\n                    }\n                }\n                else {\n                    # accept\n                    update control {\n                        Auth-Type := Accept\n                    }   \n                }\n            }\n            else {\n                # accept\n                update control {\n                    Auth-Type := Accept\n                }\n            }\n        }\n        else {\n            # accept\n            update control {\n                Auth-Type := Accept\n            }\n        }\n    }\n    else {\n        # accept\n        update control {\n            Auth-Type := Accept\n        }\n    }\n}\nelse {\n    eap\n}\n</code></pre>\n\n<p>I would like to indent the file properly by adding indentation or spaces or tabs after each loop, so that it looks like this:</p>\n\n<pre><code>if (!EAP-Message) {\n    # Now check against the authorized_macs file\n    authorized_macs_10\n    if (!ok) {\n        authorized_macs_11\n        if (!ok) {\n            authorized_macs_12\n            if (!ok) {\n                authorized_macs_13\n                if (!ok) {\n                    authorized_macs_14\n                    if (!ok) {\n                        eap\n                    }\n                    else {\n                        # accept\n                        update control {\n                            Auth-Type := Accept\n                        }\n                    }\n                }\n                else {\n                    # accept\n                    update control {\n                        Auth-Type := Accept\n                    }\n                }\n            }\n            else {\n                # accept\n                update control {\n                    Auth-Type := Accept\n                }\n            }\n        }\n        else {\n            # accept\n            update control {\n                Auth-Type := Accept\n            }\n        }\n    }\n    else {\n        # accept\n        update control {\n            Auth-Type := Accept\n        }\n    }\n}\nelse {\n    eap\n}\n</code></pre>\n\n<p>This is a part of the /etc/freeradius/sites-available/default of my freeradius puppet module, which is finally done. The <code>@filename</code> variable is a hiera_hash, which I get from a yaml file. Here is the relevant part:</p>\n\n<pre><code>test_freeradius::files:\n'authorized_macs_10':\n    macs: \n        - 'aaaaa'\n        - 'bbbbb'\n    vlan: '10' \n'authorized_macs_11':\n    macs: \n        - 'ccccc' \n        - 'ddddd'  \n    vlan: '11'\n'authorized_macs_12':\n    macs: \n        - 'eeeee'\n        - 'fffff'\n    vlan: '12'\n'authorized_macs_13':\n    macs:\n        - 'ggggg'\n        - 'hhhhh'\n    vlan: '13'\n'authorized_macs_14':\n    macs:\n        - 'iiiii'\n        - 'jjjjj'\n    vlan: '14'\n</code></pre>\n\n<p>And below is the define I use to create among other things the content of the <code>default</code> file:</p>\n\n<pre><code>define test_freeradius::files (\n\n  $macs,\n  $vlan,\n  $macfile  = $title,\n\n) {\n\n  include test_freeradius::service\n\n  ensure_resource('file', '/etc/freeradius/modules/files', {\n      ensure  =&gt; 'file',\n      owner   =&gt; 'root',\n      group   =&gt; 'root',\n      mode    =&gt; '0644',\n      content =&gt; template(\"${module_name}/files.erb\"),\n      require =&gt; Class['test_freeradius::install'],\n      notify  =&gt; Service['freeradius'],\n    }\n  )\n\n  file { \"/etc/freeradius/${macfile}\" :\n    ensure  =&gt; 'file',\n    owner   =&gt; 'root',\n    group   =&gt; 'root',\n    mode    =&gt; '0644',\n    content =&gt; template(\"${module_name}/macfiles.erb\"),\n    require =&gt; Class['test_freeradius::install'],\n    notify  =&gt; Service['freeradius'],\n  }\n\n  ensure_resource('file', '/etc/freeradius/sites-available/default', {\n      ensure  =&gt; 'file',\n      owner   =&gt; 'root',\n      group   =&gt; 'freerad',\n      mode    =&gt; '0644',\n      content =&gt; template(\"${module_name}/default.erb\"),\n      require =&gt; Class['test_freeradius::install'],\n      notify  =&gt; Service['freeradius'],\n    }\n  )\n\n  ensure_resource('file', '/etc/freeradius/sites-enabled/default', {\n      ensure =&gt; 'link',\n      target =&gt; '/etc/freeradius/sites-available/default',\n    }\n  )\n}\n</code></pre>\n\n<p>The loop does what it should, but without indentation, I tried different things like adding <code>&lt;%= \" \"%&gt;</code> at several positions and creating a variable for the <code>if (!ok) {</code> part, unfortunately without success, maybe I should restructure the code?  any ideas? </p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "infinite-loop", "rake-task", "monit"], "comments": [{"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1494965698, "post_id": 44007641, "comment_id": 75049772, "body": "You could try instead using the daemons gem to create a daemonized process and use God to monitor it :)"}], "answers": [{"tags": [], "owner": {"reputation": 6227, "user_id": 808533, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/qSPq0.jpg?s=128&g=1", "display_name": "prasad.surase", "link": "https://stackoverflow.com/users/808533/prasad-surase"}, "is_accepted": true, "score": 0, "last_activity_date": 1496845880, "creation_date": 1496845880, "answer_id": 44415539, "question_id": 44007641, "link": "https://stackoverflow.com/questions/44007641/monitor-a-rake-task-in-rails-5/44415539#44415539", "title": "Monitor a rake task in rails 5", "body": "<p>This monit configuration worked for me</p>\n\n<pre><code>check process aws_sqs_consumer with pidfile /var/www/myproject/shared/tmp/pids/sqs_consumer.pid\n  start program = \"/bin/sh -c 'cd /var/www/myproject/current &amp;&amp; BACKGROUND=y PIDFILE=/var/www/myproject/shared/tmp/pids/sqs_consumer.pid LOG_LEVEL=info bundle exec rake sqs_consumer:start RAILS_ENV=staging'\"\n  stop program = \"/bin/sh -c 'kill $(cat /var/www/myproject/shared/tmp/pids/sqs_consumer.pid)'\" as uid ubuntu and gid ubuntu with timeout 90 seconds\n</code></pre>\n"}], "owner": {"reputation": 6227, "user_id": 808533, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/qSPq0.jpg?s=128&g=1", "display_name": "prasad.surase", "link": "https://stackoverflow.com/users/808533/prasad-surase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 44415539, "answer_count": 1, "score": 0, "last_activity_date": 1496845880, "creation_date": 1494954576, "question_id": 44007641, "link": "https://stackoverflow.com/questions/44007641/monitor-a-rake-task-in-rails-5", "title": "Monitor a rake task in rails 5", "body": "<p>I have a requirement wherein I have to constantly fetch messages from AWS-SQS(simple queue service) and update the related records of a model. The message contains data that needs to be displayed to the related users as notifications as soon as they are fetched. This has been successfully managed by using Action Cable. I have created a rake task that fetches the messages from the queue and does the required processing. This task is supposed to run in an infinite loop. I have 2 questions regarding it?</p>\n\n<pre><code>namespace :sqs_consumer do\n  desc 'Get data from the AWS-SQS and process it.'\n  task start: :environment do\n    # initialize the sqs client\n    loop do\n      #read the queue for messages and process them in batches(if any)\n    end\n  end\nend\n</code></pre>\n\n<p>1) Is it right to create a rake task for the above requirement? A rake task that runs infinitely is the right way? If not, what is the right approach. I cant run the task periodically since i need data in real time.</p>\n\n<p>2) I want to monitor the task. I am using monit for the same. Unfortunately, Monit conf for the same doesn't seem to work. What am I doing wrong or missing?</p>\n\n<pre><code>check process aws_sqs_consumer with pidfile /var/www/myproject/shared/pids/sqs_consumer.pid\n  start program = \"/bin/sh -c 'cd /var/www/myproject/current; nohup bundle exec rake sqs_consumer:start RAILS_ENV=staging -i 0 -P /var/www/myproject/shared/pids/sqs_consumer.pid &gt;&gt; log/sqs_consumer.log 2&gt;&amp;1 &amp;'\" as uid ubuntu and gid ubuntu\n  stop program = \"/bin/sh -c 'kill $(cat /var/www/myproject/shared/pids/sqs_consumer.pid)'\" as uid ubuntu and gid ubuntu\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 1064, "user_id": 2317487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/S9GeT.jpg?s=128&g=1", "display_name": "Aus", "link": "https://stackoverflow.com/users/2317487/aus"}, "edited": false, "score": 0, "creation_date": 1494953026, "post_id": 44007122, "comment_id": 75042527, "body": "Aha, I was using different class &quot;gets&quot;.. Thansk mate!"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1494953104, "post_id": 44007122, "comment_id": 75042563, "body": "Yes, <a href=\"https://ruby-doc.org/core-2.4.1/Kernel.html#method-i-gets\" rel=\"nofollow noreferrer\"><code>Kernel#gets</code></a> is quite different from <a href=\"https://ruby-doc.org/core-2.4.1/IO.html#method-i-gets\" rel=\"nofollow noreferrer\"><code>IO#gets</code></a> even though they have similar functions and identical names."}], "tags": [], "owner": {"reputation": 1064, "user_id": 2317487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/S9GeT.jpg?s=128&g=1", "display_name": "Aus", "link": "https://stackoverflow.com/users/2317487/aus"}, "is_accepted": false, "score": 2, "last_activity_date": 1494952897, "creation_date": 1494952897, "answer_id": 44007122, "question_id": 44007074, "link": "https://stackoverflow.com/questions/44007074/when-specifying-command-line-arguments-ruby-no-longer-waits-for-input-using-gets/44007122#44007122", "title": "When specifying command-line arguments Ruby no longer waits for input using gets", "body": "<p>Nevermind,</p>\n\n<p>The \"gets\" actually takes the first line from the file I added in the cli arguments.</p>\n\n<p>Very weird.</p>\n"}, {"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 2, "last_activity_date": 1494963876, "creation_date": 1494963876, "answer_id": 44010297, "question_id": 44007074, "link": "https://stackoverflow.com/questions/44007074/when-specifying-command-line-arguments-ruby-no-longer-waits-for-input-using-gets/44010297#44010297", "title": "When specifying command-line arguments Ruby no longer waits for input using gets", "body": "<p>In addition to STDIN.gets like others have recommended, you can use plain <code>gets</code> if you call <code>ARGV.clear</code> beforehand. The regular <code>gets</code> works as expected if there aren't command like arguments to the script, but if there are, then it will read them. It's not really clear why you're using <code>./test.rb test.rb</code>, but the second filename is a command line argument.</p>\n\n<p>More specifically, if regular <code>gets</code> is called when ARGV is populated, then the result will be the <em>contents</em> of the file.</p>\n\n<pre><code>max@max ~&gt; echo \"content\" &gt; test.txt\nmax@max ~&gt; ruby -e \"puts ARGV.inspect; puts gets\" test.txt\n[\"test.txt\"]\ncontent\n</code></pre>\n"}], "owner": {"reputation": 1064, "user_id": 2317487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/S9GeT.jpg?s=128&g=1", "display_name": "Aus", "link": "https://stackoverflow.com/users/2317487/aus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 44010297, "answer_count": 2, "score": 1, "last_activity_date": 1494963876, "creation_date": 1494952741, "last_edit_date": 1494954630, "question_id": 44007074, "link": "https://stackoverflow.com/questions/44007074/when-specifying-command-line-arguments-ruby-no-longer-waits-for-input-using-gets", "title": "When specifying command-line arguments Ruby no longer waits for input using gets", "body": "<p>When running a ruby script with command line arguments, the \"gets\" is no longer blocking, it doesn't work.</p>\n\n<p>test.rb</p>\n\n<pre><code>#!/usr/bin/ruby\nputs \"should wait for input\"\ngets\nputs \"test\"\n</code></pre>\n\n<p>and here is how I run it</p>\n\n<pre><code>$ ./test.rb test.rb\n  should wait for input\n  test\n</code></pre>\n\n<p>It didn't wait.</p>\n\n<p>I'm running Ubuntu 16.04 desktop, and Ruby from repository ruby 2.3.1p112 (2016-04-26) [x86_64-linux-gnu]</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1494954496, "post_id": 44007032, "comment_id": 75043339, "body": "Yeah, <code>inspect</code> is a highly Ruby-specific form and isn&#39;t something you can easily and safely deserialize. JSON is much better."}, {"owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "edited": false, "score": 0, "creation_date": 1494957866, "post_id": 44007032, "comment_id": 75045256, "body": "thanks.. its still not working though.. I get this error.. &quot;TypeError (no implicit conversion of nil into String):&quot;"}, {"owner": {"reputation": 735, "user_id": 5775246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rWMQ7_UYyiI/AAAAAAAAAAI/AAAAAAAAADc/xFHc8sFhSWk/photo.jpg?sz=128", "display_name": "DjezzzL", "link": "https://stackoverflow.com/users/5775246/djezzzl"}, "reply_to_user": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "edited": false, "score": 0, "creation_date": 1494959385, "post_id": 44007032, "comment_id": 75046171, "body": "@ToddT I updated my answer. Now get_custom_from_redis method won&#39;t throw an error because customer_info could be nil. Could you please try it now."}], "tags": [], "owner": {"reputation": 735, "user_id": 5775246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rWMQ7_UYyiI/AAAAAAAAAAI/AAAAAAAAADc/xFHc8sFhSWk/photo.jpg?sz=128", "display_name": "DjezzzL", "link": "https://stackoverflow.com/users/5775246/djezzzl"}, "is_accepted": false, "score": 1, "last_activity_date": 1494959325, "last_edit_date": 1494959325, "creation_date": 1494952602, "answer_id": 44007032, "question_id": 44006286, "link": "https://stackoverflow.com/questions/44006286/hget-in-private-method-not-returning-hash/44007032#44007032", "title": "HGET in private method not returning hash", "body": "<p>I'd recommend you rather than using <code>.inspect</code> use <code>.to_json</code> like this:</p>\n\n<pre><code>def return_customer\n  email = params[\"email\"]\n  customer = Customer.find_by(email: email)\n  credit_amount = customer.credit_amount.to_f\n  customer_data = {email: email, customer_id: customer.id, credit_amount: credit_amount}\n  redis.set(\"shop:#{customer.shop.id}:customer\", customer_data.to_json)\n  render json: customer\nend\n</code></pre>\n\n<p>And then in your private method</p>\n\n<pre><code>def get_customer_from_redis\n  shop = Shop.find_by(shopify_domain: params[\"shop\"])\n  customer_info = redis.get(\"shop:#{shop.id}:customer\", customer_data)\n  JSON.parse(customer_info) if customer_info\nend\n</code></pre>\n"}], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494959325, "creation_date": 1494950367, "last_edit_date": 1494957905, "question_id": 44006286, "link": "https://stackoverflow.com/questions/44006286/hget-in-private-method-not-returning-hash", "title": "HGET in private method not returning hash", "body": "<p>Some reason my <code>hget</code> is not finding or returning a hash I set in a public method. I can't figure out why.</p>\n\n<p>This is all in one controller that inherits from <code>ApplicationController</code>, which is where I define my redis initializer:</p>\n\n<pre><code>def redis\n   Thread.current[:redis] ||= Redis.new\nend\n</code></pre>\n\n<p>Then in my controller I do this to set the hash:</p>\n\n<pre><code>def return_customer\n  email = params[\"email\"]\n  customer = Customer.find_by(email: email)\n  credit_amount = customer.credit_amount.to_f\n  customer_data = {email: email, customer_id: customer.id, credit_amount: credit_amount}\n  redis.hset(\"shop:#{customer.shop.id}:customer\", customer_data, customer_data.inspect)\n  render json: customer\nend\n</code></pre>\n\n<p>Then finally I have this private method I use in other methods in the same controller, this is the part that's not working:</p>\n\n<pre><code>private\n\ndef get_customer_from_redis\n  shop = Shop.find_by(shopify_domain: params[\"shop\"])\n  customer_info = redis.hget(\"shop:#{shop.id}:customer\", customer_data)\n  eval(customer_info)\nend\n</code></pre>\n\n<p>This is the error that's returned</p>\n\n<pre><code>TypeError (no implicit conversion of nil into String):\n</code></pre>\n"}, {"tags": ["ruby", "chef-recipe", "rubocop"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1494947890, "creation_date": 1494947890, "answer_id": 44005424, "question_id": 44005410, "link": "https://stackoverflow.com/questions/44005410/need-to-refactor-to-the-new-ruby-1-9-hash-syntax/44005424#44005424", "title": "Need to refactor to the new Ruby 1.9 hash syntax", "body": "<pre><code>service 'apache' do\n  supports status: true, restart: true, reload: true\nend\n</code></pre>\n\n<p>You can use this new syntax when you have symbols as keys.</p>\n"}, {"comments": [{"owner": {"reputation": 745, "user_id": 1382244, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/8wVu8.jpg?s=128&g=1", "display_name": "Giovanni Di Toro", "link": "https://stackoverflow.com/users/1382244/giovanni-di-toro"}, "edited": false, "score": 0, "creation_date": 1548435623, "post_id": 44005425, "comment_id": 95553592, "body": "How would I type a hash with 2 symbols, like: {:key =&gt; :value, :key2 =&gt; :value2} ?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 745, "user_id": 1382244, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/8wVu8.jpg?s=128&g=1", "display_name": "Giovanni Di Toro", "link": "https://stackoverflow.com/users/1382244/giovanni-di-toro"}, "edited": false, "score": 1, "creation_date": 1548435908, "post_id": 44005425, "comment_id": 95553738, "body": "Just <code>{ key: :value, key2: :value2 }</code>, both values, hash key and hash value are symbols."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 19, "last_activity_date": 1494949003, "last_edit_date": 1494949003, "creation_date": 1494947890, "answer_id": 44005425, "question_id": 44005410, "link": "https://stackoverflow.com/questions/44005410/need-to-refactor-to-the-new-ruby-1-9-hash-syntax/44005425#44005425", "title": "Need to refactor to the new Ruby 1.9 hash syntax", "body": "<p>In the Ruby version 1.9 has been introduced a new syntax for hash literals whose keys are symbols. Hashes use the \"hash rocket\" operator to separate the key and the value:</p>\n\n<pre><code>a_hash = { :a_key =&gt; 'a_value' }\n</code></pre>\n\n<p>In Ruby 1.9 this syntax is valid, but whenever the key is a symbol it's also possible to write it as:</p>\n\n<pre><code>a_hash = { a_key: 'a_value' }\n</code></pre>\n\n<p>And as the Ruby style guide says, you should prefer to use the Ruby 1.9 hash literal syntax when your hash keys are symbols <a href=\"https://github.com/bbatsov/ruby-style-guide#hash-literals\" rel=\"noreferrer\">(see)</a>:</p>\n\n<pre><code># bad\nhash = { :one =&gt; 1, :two =&gt; 2, :three =&gt; 3 }\n\n# good\nhash = { one: 1, two: 2, three: 3 }\n</code></pre>\n\n<p>And as an additional hint: Don't mix the Ruby 1.9 hash syntax with hash rockets in the same hash literal. When you've got keys that are not symbols stick to the hash rockets syntax <a href=\"https://github.com/bbatsov/ruby-style-guide#no-mixed-hash-syntaces\" rel=\"noreferrer\">(see)</a>:</p>\n\n<pre><code># bad\n{ a: 1, 'b' =&gt; 2 }\n\n# good\n{ :a =&gt; 1, 'b' =&gt; 2 }\n</code></pre>\n\n<p>So you can try with:</p>\n\n<pre><code>service 'apache' do\n  supports status: true, restart: true, reload: true\nend\n</code></pre>\n\n<p>If you want to see what's the Rubocop \"way\" you can run this in the command line, this will autocorrect your code only for the <code>HashSyntax</code> warnings or flags:</p>\n\n<pre><code>rubocop --only HashSyntax --auto-correct\n</code></pre>\n"}], "owner": {"reputation": 637, "user_id": 4347446, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/515608942796a1ad61a00222b6014344?s=128&d=identicon&r=PG&f=1", "display_name": "TyMac", "link": "https://stackoverflow.com/users/4347446/tymac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8838, "favorite_count": 2, "closed_date": 1494947910, "accepted_answer_id": 44005425, "answer_count": 2, "score": 10, "last_activity_date": 1494949003, "creation_date": 1494947850, "question_id": 44005410, "link": "https://stackoverflow.com/questions/44005410/need-to-refactor-to-the-new-ruby-1-9-hash-syntax", "closed_reason": "Duplicate", "title": "Need to refactor to the new Ruby 1.9 hash syntax", "body": "<p>I have a recipe that has the following code that is failing a lint test:</p>\n\n<pre><code>service 'apache' do\n  supports :status =&gt; true, :restart =&gt; true, :reload =&gt; true\nend\n</code></pre>\n\n<p>It fails with the error:</p>\n\n<pre><code>Use the new Ruby 1.9 hash syntax.\n  supports :status =&gt; true, :restart =&gt; true, :reload =&gt; true\n</code></pre>\n\n<p>Not sure what the new syntax looks like... can anyone please assist? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1494947409, "post_id": 44005225, "comment_id": 75038745, "body": "<code>&quot;no route matches [POST] ...&quot;</code> could we see your <code>routes.rb</code>?, is there just <code>resources :messages, only: [:create, :edit, :destroy]</code>?"}, {"owner": {"reputation": 357, "user_id": 5280140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Ngnfa.jpg?s=128&g=1", "display_name": "Makcheese", "link": "https://stackoverflow.com/users/5280140/makcheese"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1494947572, "post_id": 44005225, "comment_id": 75038850, "body": "aight sorry, I put only the messages bit there because I thought that was the only relevant part.  I&#39;ll edit the post now."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494949439, "post_id": 44005225, "comment_id": 75040228, "body": "What is the test that&#39;s failing? What is the full backtrace of the error? Your <code>ChatRoomsController#show</code> action contains a dodgy <code>if</code> statement, by the way -- you&#39;re always overriding the value of <code>@message</code>, regardless."}, {"owner": {"reputation": 357, "user_id": 5280140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Ngnfa.jpg?s=128&g=1", "display_name": "Makcheese", "link": "https://stackoverflow.com/users/5280140/makcheese"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494950249, "post_id": 44005225, "comment_id": 75040876, "body": "@TomLord thanks, I&#39;ve added the bit of the test that fails.  Also, what&#39;s wrong with the <code>if</code> statement?  I might be being dim here but I can&#39;t see any problems with it."}, {"owner": {"reputation": 357, "user_id": 5280140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Ngnfa.jpg?s=128&g=1", "display_name": "Makcheese", "link": "https://stackoverflow.com/users/5280140/makcheese"}, "edited": false, "score": 0, "creation_date": 1494950503, "post_id": 44005225, "comment_id": 75041040, "body": "Also, FYI, the ID it has in the url is the ID of the current chat room."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494951534, "post_id": 44005225, "comment_id": 75041648, "body": "@Makcheese My point is that you&#39;re setting <code>@messages = @chosen.messages</code> or <code>@messages = nil</code>, but this is totally pointless sine you are then setting <code>@message = Message.new</code> and aren&#39;t actually using the <code>@messages</code> variable anywhere."}, {"owner": {"reputation": 357, "user_id": 5280140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Ngnfa.jpg?s=128&g=1", "display_name": "Makcheese", "link": "https://stackoverflow.com/users/5280140/makcheese"}, "edited": false, "score": 0, "creation_date": 1494951736, "post_id": 44005225, "comment_id": 75041764, "body": "Oh sorry, I am using the <code>@messages</code> variable, in an unrelated part of the view."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494951875, "post_id": 44005225, "comment_id": 75041854, "body": "Hmm, ok... Anyway, I digress..... Should that not just be <code>post :create, messages_path</code> instead of <code>post :create, message_path</code>?"}, {"owner": {"reputation": 357, "user_id": 5280140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Ngnfa.jpg?s=128&g=1", "display_name": "Makcheese", "link": "https://stackoverflow.com/users/5280140/makcheese"}, "edited": false, "score": 0, "creation_date": 1494952012, "post_id": 44005225, "comment_id": 75041937, "body": "yeah, you bringing up this confusion has led me to rename the <code>@message</code> variable so it&#39;s less confusing.  Also I&#39;m going to see if I can ingeneral clean up the view.  If the solution IS to as simple as <code>messages_path</code> rather than <code>message_path</code>, I will be really angry at myself -_-"}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 2, "last_activity_date": 1494964694, "creation_date": 1494964694, "answer_id": 44010522, "question_id": 44005225, "link": "https://stackoverflow.com/questions/44005225/how-to-create-an-instance-of-model-a-from-a-form-inside-a-view-for-model-b/44010522#44010522", "title": "How to Create an Instance of Model A, from a Form inside a view for Model B", "body": "<p>With this line you're running POST /messages/:id</p>\n\n<pre><code>post message_path, params: {message: {body: \"yo ho ho and a bottle of rum!\"}}\n</code></pre>\n\n<p>In your routes file you have this:</p>\n\n<pre><code>resources :messages, only: [:create, :edit, :destroy]\n</code></pre>\n\n<p>This will create the routes POST /messages, PUT/PATCH /messages/:id, and DELETE /messages/:id. You can verify this with <code>rake routes</code>.</p>\n\n<p>None of these generated routes handle POST /messages/:id.</p>\n\n<p>If you're trying to have the test create a new message, then you can use <code>messages_path</code> instead. <code>message_path</code> (with singular <code>message</code>) takes a message argument as a message, e.g. <code>message_path(Message.first)</code> and uses that to build the url. </p>\n"}], "owner": {"reputation": 357, "user_id": 5280140, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Ngnfa.jpg?s=128&g=1", "display_name": "Makcheese", "link": "https://stackoverflow.com/users/5280140/makcheese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 44010522, "answer_count": 1, "score": 2, "last_activity_date": 1494964694, "creation_date": 1494947345, "last_edit_date": 1494950170, "question_id": 44005225, "link": "https://stackoverflow.com/questions/44005225/how-to-create-an-instance-of-model-a-from-a-form-inside-a-view-for-model-b", "title": "How to Create an Instance of Model A, from a Form inside a view for Model B", "body": "<p>So I have a <code>Message</code> model, and a <code>ChatRoom</code> model.</p>\n\n<p>When I display a chat room, I use the <code>show</code> action on the ChatRoom controller.  In the view for this action, there is a little form for the user to create a post, and submit that post to the chat room being shown.</p>\n\n<p>When I run my tests, however, I get an error \"no route matches [POST] /messages/an_id_of_some_sort\".  Specifically, in this little test:</p>\n\n<pre><code>post message_path, params: {message: {body: \"yo ho ho and a bottle of rum!\"}}\nassert_redirected_to chat_room_path(@channel)\n</code></pre>\n\n<p>the error pops up in the <code>post message_path</code>.</p>\n\n<p>The <code>show</code> method on the chat room controller looks like</p>\n\n<pre><code>def show\n\nif(@user = current_user)\n  @chats = @user.chat_rooms\n  @chosen = ChatRoom.find_by(id: params[:id])\n\n  if(@chosen.messages.any?)\n    @messages = @chosen.messages\n\n  else\n    @messages = nil\n  end\n\n  @message = Message.new\n\nend\n\nend\n</code></pre>\n\n<p>Then the little form bit of the view is:</p>\n\n<pre><code>&lt;div class=\"message-input\"&gt;\n    &lt;%= form_for(@message) do |f| %&gt;\n      &lt;%= render 'shared/error_messages', object: f.object %&gt;\n      &lt;%= f.text_area :body, placeholder: \"Write Message...\" %&gt;\n      &lt;%= f.hidden_field :room, :value =&gt; params[:room] %&gt;\n\n      &lt;%= button_tag(type: \"submit\", class: \"message-submit-btn\", name: \"commit\", value: \"\") do %&gt;\n        &lt;span class=\"glyphicon glyphicon-menu-right\"&gt;&lt;/span&gt;\n      &lt;% end %&gt;\n\n    &lt;% end %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>I have a <code>create</code> action on the Messages Controller which does the saving to the database: </p>\n\n<pre><code>@message = current_user.messages.build(message_params);\n@message.chat_room = params[:room]\n\nif @message.save\n  redirect_to chat_room_path(@message.chat_room)\nend\n</code></pre>\n\n<p>and routing-wise I have</p>\n\n<pre><code>Rails.application.routes.draw do\n\nroot 'welcome#welcome'\n\nget '/login', to: 'sessions#new'\npost '/login', to: 'sessions#create'\ndelete '/logout', to: 'sessions#destroy'\n\nget '/signup', to: 'users#new'\npost '/signup', to: 'users#create'\nget 'users/signup_success'\n\ndelete '/chat_rooms/leave/:id', to: 'chat_rooms#leave', as: 'current'\n\nget 'welcome/welcome'\n\nresources :users\nresources :account_activations, only: [:edit]    #Only providing an Edit route for this resource.\nresources :password_resets, only: [:new, :edit, :create, :update]\nresources :chat_rooms, only: [:new, :create, :show, :index]\nresources :messages, only: [:create, :edit, :destroy]\n\nend\n</code></pre>\n\n<p>I have tried playing around with explicitly setting the <code>:url</code> on the form_for, but no dice.  There is another question on this problem, but the solution there hasn't really helped.</p>\n\n<p>I would greatly appreciate any help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7740219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c47369c3588f3ac96366f3986ed75e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexi", "link": "https://stackoverflow.com/users/7740219/alexi"}, "edited": false, "score": 0, "creation_date": 1494985913, "post_id": 44007304, "comment_id": 75056331, "body": "The #modal-window element is in my layout file.  This method works - you also select the modal-body as you suggested.  I simply had set layout to false in my controller respond_to block for js."}], "tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": false, "score": 0, "last_activity_date": 1494953463, "creation_date": 1494953463, "answer_id": 44007304, "question_id": 44004783, "link": "https://stackoverflow.com/questions/44004783/rendering-partial-through-modal-in-rails/44007304#44007304", "title": "Rendering partial through modal in Rails", "body": "<p>Where is the <code>\"#modal-window\"</code> element? You should be selecting the <code>.modal-body</code>. Such as: </p>\n\n<pre><code>$(\".modal-dialog .modal-body\").html(\"&lt;%= escape_javascript(render 'quick_add') %&gt;\");\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7740219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c47369c3588f3ac96366f3986ed75e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexi", "link": "https://stackoverflow.com/users/7740219/alexi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 800, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1494953463, "creation_date": 1494946179, "last_edit_date": 1494946331, "question_id": 44004783, "link": "https://stackoverflow.com/questions/44004783/rendering-partial-through-modal-in-rails", "title": "Rendering partial through modal in Rails", "body": "<p>Modal div in layout:</p>\n\n<pre><code>main\n  = render 'layouts/desktop_sidebar'\n  #modal-window.modal aria-labelledby=\"myModalLabel\" role=\"dialog\" tabindex=\"-1\"\n\n  .main-content\n    = render 'flash'\n    = yield\n</code></pre>\n\n<p>Modal content:</p>\n\n<pre><code>.modal-dialog role=\"document\"\n  .modal-content\n    .modal-header\n      button.close aria-label=\"Close\" data-dismiss=\"modal\" type=\"button\"\n        span aria-hidden=\"true\"  &amp;times;\n      h4#myModalLabel.modal-title Modal title\n    .modal-body\n      | Test body content\n    .modal-footer\n      button.btn.btn-default data-dismiss=\"modal\" type=\"button\"  Close\n      button.btn.btn-primary type=\"button\"  Save changes`\n</code></pre>\n\n<p>Link to toggle modal:</p>\n\n<pre><code>= link_to 'Quick Add', companies_quick_add_path, remote: true, data: { toggle: \"modal\", target: '#modal-window' }\n</code></pre>\n\n<p>quick_add.js.erb</p>\n\n<pre><code>$(\"#modal-window\").html(\"&lt;%= escape_javascript(render 'quick_add') %&gt;\");\n</code></pre>\n\n<p>Clients controller action:</p>\n\n<pre><code>def quick_add\n    @client = Client.new\n    initialize_client_children\n\n    respond_to do |format|\n      format.html\n      format.js\n    end\nend\n</code></pre>\n\n<p>DOM before clicking link:\n<a href=\"https://i.stack.imgur.com/Mu4ni.png\" rel=\"nofollow noreferrer\">Image</a></p>\n\n<p>DOM after clicking link:\n<a href=\"https://i.stack.imgur.com/LeWVQ.png\" rel=\"nofollow noreferrer\">Image</a></p>\n\n<p>When clicking the link to render the modal, it hits the controller action and successfully reaches the view partial. The screen darkens, but the modal does not show at all.</p>\n\n<p>When moving the modal out of the partial and placing the modal content right below the div and id declaration, the model will render, but I obviously have no access to the controller variables.</p>\n"}, {"tags": ["arrays", "ruby", "string", "substring", "ruby-2.4"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1494961150, "post_id": 44004601, "comment_id": 75047187, "body": "I expect this would be more efficient than using a regex, but not because of the short-circuiting, as the regex would short-circuit as well. Indeed, I can&#39;t think of a reasonable way of solving the problem that does not short-circuit."}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 10, "last_activity_date": 1494946751, "last_edit_date": 1494946751, "creation_date": 1494945733, "answer_id": 44004601, "question_id": 44004552, "link": "https://stackoverflow.com/questions/44004552/how-can-i-tell-if-my-string-contains-a-substring-from-an-array/44004601#44004601", "title": "How can I tell if my string contains a substring from an array?", "body": "<p>You want to use <a href=\"https://ruby-doc.org/core-2.4.1/Enumerable.html#method-i-any-3F\" rel=\"noreferrer\">Enumerable#<code>any?</code></a>:</p>\n\n<pre><code>arr.any? { |substring| str.include?(substring) }\n</code></pre>\n\n<p>The solution is very efficient, because this method ensures <em>short-circuit evaluation</em>, meaning, that if you have array of 100000000 substrings and you want to check whether your string contains any of these substrings, this method will stop right when its block returns <code>true</code>, meaning, that if the matching substring is first in the array, it will never check other 99999999 elements.</p>\n"}, {"comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 2, "creation_date": 1494964302, "post_id": 44004697, "comment_id": 75048971, "body": "You could use <code>inject</code> instead of <code>map</code> and <code>.any?</code> instead of the second <code>inject</code>, but using <code>.any?</code> to replace it all would be simpler and faster (it will stop on the first positive match)."}], "tags": [], "owner": {"reputation": 1362, "user_id": 2320744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ade05a3f9049c069fc845f7529a7423?s=128&d=identicon&r=PG", "display_name": "Mathias Vonende", "link": "https://stackoverflow.com/users/2320744/mathias-vonende"}, "is_accepted": true, "score": -1, "last_activity_date": 1495101257, "last_edit_date": 1495101257, "creation_date": 1494945960, "answer_id": 44004697, "question_id": 44004552, "link": "https://stackoverflow.com/questions/44004552/how-can-i-tell-if-my-string-contains-a-substring-from-an-array/44004697#44004697", "title": "How can I tell if my string contains a substring from an array?", "body": "<p>Given:</p>\n\n<pre><code>arr = [\"a\", \"b\", \"x\"]\nstr = \"DoDox\"\n</code></pre>\n\n<p><strong>EDIT</strong>: As the other comments have pointed out, this is actually the fastest way, as it breaks the evaluation when a single true statement is found:</p>\n\n<pre><code>arr.any?{|substr| str.include?(substr)}\n</code></pre>\n\n<p>The <a href=\"https://en.wikipedia.org/wiki/Fold_(higher-order_function)\" rel=\"nofollow noreferrer\">foldl</a> way: I have used this example to illustrate the power of folding expresions. This solution might be somewhat elegant as an illustrative example for foldings, but it is not sufficiently performant.</p>\n\n<pre><code>arr.map{|substr| str.include?(substr)}.inject{|x,y| x || y}\n</code></pre>\n\n<p>The <code>map</code>-function maps all possible substrings the original string <code>str</code> can have. <code>inject</code> iterates over the returning array and compares its constituents, using a logical or. If any substring in the array 'arr' is encountered, the result will yield true in the result of map. With the or-relation we return a true value, if any value of the result of map was true. This is slower than <code>any?</code>, because every single value in the array gets evaluated even if a <code>true</code> is encountered (wich would always yield a <code>true</code> at the end of <code>inject</code>).</p>\n\n<pre><code>[\"a\", \"b\", \"x\"] -------&gt; [false, false, true] ----------&gt; true\n                 map()                          inject()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 4, "last_activity_date": 1494971351, "last_edit_date": 1494971351, "creation_date": 1494950288, "answer_id": 44006258, "question_id": 44004552, "link": "https://stackoverflow.com/questions/44004552/how-can-i-tell-if-my-string-contains-a-substring-from-an-array/44006258#44006258", "title": "How can I tell if my string contains a substring from an array?", "body": "<p>Construct a Regular Expression (without pipes and slashes and dots and other magic stuff):</p>\n\n<pre><code>arr = [\"aa\", \"bb\", \"cc\"]\nstr = \"mystringcc\"\nreg = Regexp.union(arr)  # That's all!\np str.match?(reg)        #=&gt; true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24660, "user_id": 225647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/G7HMF.png?s=128&g=1", "display_name": "kiamlaluno", "link": "https://stackoverflow.com/users/225647/kiamlaluno"}, "is_accepted": false, "score": 0, "last_activity_date": 1499633740, "creation_date": 1499633740, "answer_id": 45000934, "question_id": 44004552, "link": "https://stackoverflow.com/questions/44004552/how-can-i-tell-if-my-string-contains-a-substring-from-an-array/45000934#45000934", "title": "How can I tell if my string contains a substring from an array?", "body": "<p>The reason you are getting that error message is because the <code>*</code> operator is telling Ruby to pass all the items of <code>arr</code> to <code>str.include?</code>. For those <code>arr</code> items, that is equivalent to writing <code>str.include?(\"aa\", \"bb\", \"cc\")</code>.</p>\n\n<p>As said in other answers, checking a condition is verified for any of the elements contained in an array, like in your case (where you don't want to check if all the elements of an array are substrings of a given string), is done using <code>arr.any? { |item| str.include?(item) }</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1921, "favorite_count": 0, "accepted_answer_id": 44004697, "answer_count": 4, "score": 0, "last_activity_date": 1499633740, "creation_date": 1494945621, "last_edit_date": 1494946316, "question_id": 44004552, "link": "https://stackoverflow.com/questions/44004552/how-can-i-tell-if-my-string-contains-a-substring-from-an-array", "title": "How can I tell if my string contains a substring from an array?", "body": "<p>How can I tell if my string contains a substring from an array?</p>\n\n<p>I thought <code>include?</code> was the key, but apparently not ...</p>\n\n<pre><code>arr = [\"aa\", \"bb\", \"cc\"]\nstr = \"mystringcc\"\nstr.include?(*arr)\nArgumentError: wrong number of arguments (given 3, expected 1)\n</code></pre>\n\n<p>In the above example, I would expect the result to be <code>true</code> since the string has <code>\"cc\"</code>, which is an element of the array.</p>\n"}, {"tags": ["ruby", "global-variables", "code-analysis", "rubocop"], "answers": [{"comments": [{"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 7, "creation_date": 1494946233, "post_id": 44004709, "comment_id": 75037848, "body": "It works!!  GlobalVars:   AllowedVariables:      - $redis"}], "tags": [], "owner": {"reputation": 435, "user_id": 729973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3237b00df62e8859236e9ad564738652?s=128&d=identicon&r=PG", "display_name": "michaeltomer", "link": "https://stackoverflow.com/users/729973/michaeltomer"}, "is_accepted": true, "score": 15, "last_activity_date": 1569093997, "last_edit_date": 1569093997, "creation_date": 1494945994, "answer_id": 44004709, "question_id": 44004319, "link": "https://stackoverflow.com/questions/44004319/how-can-i-exclude-a-global-variable-from-rubocop/44004709#44004709", "title": "How can I exclude a global variable from rubocop?", "body": "<p>Switch <code>Exclude</code> with <a href=\"https://github.com/rubocop-hq/rubocop/blob/0c8fcd343cec4bddeb60b8406775e1893318f907/lib/rubocop/cop/style/global_vars.rb#L57\" rel=\"nofollow noreferrer\"><code>AllowedVariables</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 22299, "user_id": 252014, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/60ARJ.jpg?s=128&g=1", "display_name": "Jaime Bellmyer", "link": "https://stackoverflow.com/users/252014/jaime-bellmyer"}, "is_accepted": false, "score": 6, "last_activity_date": 1574200109, "creation_date": 1574200109, "answer_id": 58943333, "question_id": 44004319, "link": "https://stackoverflow.com/questions/44004319/how-can-i-exclude-a-global-variable-from-rubocop/58943333#58943333", "title": "How can I exclude a global variable from rubocop?", "body": "<p>in <code>.rubocop.yml</code>:</p>\n\n<pre><code>GlobalVars:\n  AllowedVariables:\n    - $redis\n</code></pre>\n\n<p>Note that the variable name requires the leading dollar sign.</p>\n"}], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3033, "favorite_count": 0, "accepted_answer_id": 44004709, "answer_count": 2, "score": 7, "last_activity_date": 1574200109, "creation_date": 1494944952, "question_id": 44004319, "link": "https://stackoverflow.com/questions/44004319/how-can-i-exclude-a-global-variable-from-rubocop", "title": "How can I exclude a global variable from rubocop?", "body": "<p>I want to exclude a global variable from rubocop but I'm not being able to find the rule name. \nI tried adding</p>\n\n<pre><code>GlobalVars:\n  Exclude:\n    - redis\n</code></pre>\n\n<p>to <code>.rubocop.yml</code> but no luck. </p>\n\n<p>The error says <code>Do not introduce global variables.</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"tags": [], "owner": {"reputation": 3852, "user_id": 1802527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THq66.png?s=128&g=1", "display_name": "Alexis", "link": "https://stackoverflow.com/users/1802527/alexis"}, "is_accepted": false, "score": 0, "last_activity_date": 1494992928, "creation_date": 1494992928, "answer_id": 44015205, "question_id": 44004275, "link": "https://stackoverflow.com/questions/44004275/custom-message-on-devise-lockable-n-th-attempt/44015205#44015205", "title": "Custom message on devise lockable n-th attempt", "body": "<p>maybe a custom SessionsController, I'm guessing that devise uses dynamic methods, I couldn't find where :last_attempt was called to just override the unauthenticated_message method</p>\n\n<pre><code>def create\n    if self.resource.failed_attempts != self.resource.class.maximum_attempts - 1 and self.resource.failed_attempts != 0\n        attempts_left = self.resource.failed_attempts\n        flash[:alert] = I18n.t 'some_path.errors.attempts', attempts_left: attempts_left\n    super\nend\n</code></pre>\n\n<p>The idea is to add a flash alert when you have 1 or less than the max attempts, in the max attempt case and the last attempt case you would get the default messages</p>\n"}, {"tags": [], "owner": {"reputation": 94, "user_id": 5187790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LshIU.jpg?s=128&g=1", "display_name": "yusefu", "link": "https://stackoverflow.com/users/5187790/yusefu"}, "is_accepted": false, "score": 2, "last_activity_date": 1519985956, "last_edit_date": 1519985956, "creation_date": 1519984654, "answer_id": 49066747, "question_id": 44004275, "link": "https://stackoverflow.com/questions/44004275/custom-message-on-devise-lockable-n-th-attempt/49066747#49066747", "title": "Custom message on devise lockable n-th attempt", "body": "<p>The idea is interesting but won't work because <code>lockable</code> is called before <code>create</code>, so I created a custom action which I call before <code>create</code>.</p>\n\n<p>This worked for me:</p>\n\n<pre><code>class User::SessionsController &lt; Devise::SessionsController\n  before_action :check_failed_attempts, only: :create\n\n  def after_sign_in_path_for(user)\n    # some code\n  end\n\n  def create\n    super\n    # create some stuff and check others\n  end\n\n  def destroy\n    # may be destroy and deal with cookies\n    super\n  end\n\n  def check_failed_attempts\n    flash.clear\n\n    email = self.params[\"user\"][\"email\"]\n    return unless email\n\n    user = User.find_by_email(email)\n    return unless user\n\n    failed_attempts = user.failed_attempts\n    maximum_attempts = User.maximum_attempts\n    attempts_left = maximum_attempts - failed_attempts - 1\n    if attempts_left != maximum_attempts and attempts_left &gt; 1\n      flash[:notice] = I18n.t 'devise.failure.n_attempt', attempts_left: attempts_left\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 635, "user_id": 3097602, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ee8efa0b265ba18249d36b4ca235077a?s=128&d=identicon&r=PG&f=1", "display_name": "ryan2johnson9", "link": "https://stackoverflow.com/users/3097602/ryan2johnson9"}, "is_accepted": false, "score": 1, "last_activity_date": 1589262744, "last_edit_date": 1589262744, "creation_date": 1589262335, "answer_id": 61744634, "question_id": 44004275, "link": "https://stackoverflow.com/questions/44004275/custom-message-on-devise-lockable-n-th-attempt/61744634#61744634", "title": "Custom message on devise lockable n-th attempt", "body": "<p>You can overwrite the Devise code with</p>\n\n<pre><code>module Devise::Models::Lockable\n  def unauthenticated_message\n    # If set to paranoid mode, do not show the locked message because it\n    # leaks the existence of an account.\n    if Devise.paranoid\n      super\n    elsif access_locked? || (lock_strategy_enabled?(:failed_attempts) &amp;&amp; attempts_exceeded?)\n      :locked\n    elsif lock_strategy_enabled?(:failed_attempts) &amp;&amp; last_attempt? &amp;&amp; self.class.last_attempt_warning\n      :last_attempt\n    else\n      return \"invalid_fail_attempt_#{failed_attempts}\" if temporary\n      #super normally this would return :invalid see super class\n    end\n  end\nend\n</code></pre>\n\n<p>then you would need to add your translations for</p>\n\n<pre><code>devise.failure.user.invalid_1: \"one shot down! 4 to go\"\ndevise.failure.user.invalid_2: \"ooh 2 strikes!!\"\ndevise.failure.user.invalid_3: \"3 strikes!! but your not out yet! 2 left\"\n</code></pre>\n\n<p>and you don't need number 4 as that would be handled by the block that runs on <code>last_attempt?</code> (assuming you have a 5 attempt limit, adjust as needed.)</p>\n\n<p>That code might also go in the super class wherever that is..</p>\n"}], "owner": {"reputation": 318, "user_id": 1750821, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee9372bcae718bfbb737a30718e091ec?s=128&d=identicon&r=PG", "display_name": "d3m0n", "link": "https://stackoverflow.com/users/1750821/d3m0n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1589262744, "creation_date": 1494944829, "last_edit_date": 1494945475, "question_id": 44004275, "link": "https://stackoverflow.com/questions/44004275/custom-message-on-devise-lockable-n-th-attempt", "title": "Custom message on devise lockable n-th attempt", "body": "<p>I'm looking for a method to display custom messages for a various numbers of failed attempts in devise lockable module.</p>\n\n<p>I found out that only the last attempt could be notified by default:\n<a href=\"https://github.com/plataformatec/devise/blob/master/lib/devise/models/lockable.rb#L121\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise/blob/master/lib/devise/models/lockable.rb#L121</a></p>\n\n<p>Is there any elegant way to display different warning message for say 7th, and 8th failed attempt? Could you propose one?</p>\n"}, {"tags": ["mysql", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7910371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2f1a2acf998adb213994299638ae1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7910371/mike"}, "edited": false, "score": 0, "creation_date": 1495027667, "post_id": 44005534, "comment_id": 75078809, "body": "Thanks Gerry. Your code modification helped but still widget is not updated. ....................                  results.each do |row|    puts row[&#39;total&#39;]   send_event(&#39;totals&#39;, { value: row[&#39;total&#39;] }) end                                                              Job shows the count(variable total) value as &quot;3&quot; . Somehow this value is not getting sent to widget  &quot; totals&quot; &lt;li data-row=&quot;1&quot; data-col=&quot;1&quot; data-sizex=&quot;1&quot; data-sizey=&quot;1&quot;&gt;  &lt;div data-id=&quot;totals&quot; data-view=&quot;Number&quot; data-title=&quot;Number of Shares&quot; data-moreinfo=&quot;Shares&quot; data-prefix=&quot;&quot;&gt;&lt;/div&gt;  . Please advise."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 13, "user_id": 7910371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2f1a2acf998adb213994299638ae1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7910371/mike"}, "edited": false, "score": 0, "creation_date": 1495031194, "post_id": 44005534, "comment_id": 75081659, "body": "@Mike Got it, you must use <code>current</code> binding instead of <code>value</code>, so change <code>send_event(&#39;totals&#39;, { value: row[&#39;total&#39;] })</code> to <code>send_event(&#39;totals&#39;, { current: row[&#39;total&#39;] })</code>; check the updated answer."}, {"owner": {"reputation": 13, "user_id": 7910371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2f1a2acf998adb213994299638ae1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7910371/mike"}, "edited": false, "score": 0, "creation_date": 1495035443, "post_id": 44005534, "comment_id": 75084996, "body": "Thanks alot Gerry. It worked perfectly. Can you please let me know if there is any documentation to understand this workflow?"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 13, "user_id": 7910371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2f1a2acf998adb213994299638ae1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7910371/mike"}, "edited": false, "score": 0, "creation_date": 1495035752, "post_id": 44005534, "comment_id": 75085211, "body": "@Mike go to <code>sweet_dashboard_project&#47;widgets</code> and you will find a directory with source files for each <code>data-view</code>. Open the <code>.html</code> file, which contains the source html of the widget and look for any <code>data-bind</code> value, those are the ones you could use in <code>send_event()</code>. You can change that file to customize your widget as well."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 13, "user_id": 7910371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2f1a2acf998adb213994299638ae1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7910371/mike"}, "edited": false, "score": 0, "creation_date": 1495036160, "post_id": 44005534, "comment_id": 75085533, "body": "@Mike You can check their <a href=\"http://dashing.io/\" rel=\"nofollow noreferrer\">homepage</a>, i know, is kind of basic; but use that information while browsing the <code>widget</code> directory and you will get a better understanding of how this gem works."}, {"owner": {"reputation": 13, "user_id": 7910371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2f1a2acf998adb213994299638ae1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7910371/mike"}, "edited": false, "score": 0, "creation_date": 1495067002, "post_id": 44005534, "comment_id": 75100061, "body": "Thank you so much,Gerry.You helped me alot"}], "tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": true, "score": 0, "last_activity_date": 1495031847, "last_edit_date": 1495031847, "creation_date": 1494948176, "answer_id": 44005534, "question_id": 44004235, "link": "https://stackoverflow.com/questions/44004235/updating-number-widgets-with-mysql-query-data-dashing/44005534#44005534", "title": "Updating &quot;Number&quot; widgets with mysql query data - Dashing", "body": "<p>The problem is here:</p>\n\n<pre><code>results.each do |row|\n  puts row['total']\n  send_event('totals', { value: total })\nend\n</code></pre>\n\n<p>Check the line <code>send_event('totals', { value: total })</code>. You are setting <code>value</code> to <code>total</code>, but you haven't set that variable or method (i.e. <code>total</code>) anywhere, thus the <code>undefined local variable or method</code> error.</p>\n\n<p>It think that you want to assign <code>row['total']</code> instead:</p>\n\n<pre><code>results.each do |row|\n  puts row['total']\n  send_event('totals', { value: row['total'] })\nend\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>To show the values in the widget, you must use <code>current</code> instead of <code>value</code> to get the correct binding (in <code>send_event()</code>) , so the above code becomes:</p>\n\n<pre><code>results.each do |row|\n  puts row['total']\n  send_event('totals', { current: row['total'] })\nend\n</code></pre>\n\n<p>An alternative is to change <code>current</code> to <code>value</code> in the source file <code>widgets/number/number.html</code>.</p>\n\n<p>So this line:</p>\n\n<pre><code>&lt;h2 class=\"value\" data-bind=\"current | shortenedNumber | prepend prefix | append suffix\"&gt;&lt;/h2&gt;\n</code></pre>\n\n<p>would become:</p>\n\n<pre><code>&lt;h2 class=\"value\" data-bind=\"value | shortenedNumber | prepend prefix | append suffix\"&gt;&lt;/h2&gt;\n</code></pre>\n\n<p>Although i won't recommend this, its better to keep the defaults (that is, <code>current</code>).</p>\n"}], "owner": {"reputation": 13, "user_id": 7910371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2f1a2acf998adb213994299638ae1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7910371/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 44005534, "answer_count": 1, "score": 0, "last_activity_date": 1495031847, "creation_date": 1494944728, "last_edit_date": 1494972871, "question_id": 44004235, "link": "https://stackoverflow.com/questions/44004235/updating-number-widgets-with-mysql-query-data-dashing", "title": "Updating &quot;Number&quot; widgets with mysql query data - Dashing", "body": "<p>I am very much new to ruby and I am trying to set up a test dashboard. I see that mysql gives the total count of the sql query. However its not getting populated on the widget.Can someone please help?</p>\n\n<pre><code># mysql.rb (jobs file)    \nrequire \"mysql2\"\n\nSCHEDULER.every '5s' do\n  client = Mysql2::Client.new(:host =&gt; \"192.168.1.3\",:username =&gt; \"testuser\",:database =&gt; 'testdb')\n\n  results=client.query(\"SELECT count(*) as total from testdb.share\")\n  puts results\n\n  results.each do |row|\n    puts row['total']\n    send_event('totals', { value: total })\n  end\nend\n</code></pre>\n\n<p>The dashboard file:</p>\n\n<pre><code># sample.erb\n&lt;li data-row=\"1\" data-col=\"1\" data-sizex=\"1\" data-sizey=\"1\"&gt;\n  &lt;div data-id=\"totals\" data-view=\"Number\" data-title=\"Number of Shares\" data-moreinfo=\"Shares\" data-prefix=\"$\"&gt;&lt;/div&gt;\n&lt;/li&gt;\n....\n</code></pre>\n\n<p>Dashing console shows as below</p>\n\n<pre><code>#&lt;Mysql2::Result:0x007f98b4b85d18&gt; \n3   ---&gt;&gt;&gt;&gt; This is the count of my mysql query\n</code></pre>\n\n<p>Scheduler caught exception:</p>\n\n<pre><code>&gt; undefined local variable or method `total' for main:Object\n&gt; /home/user/.rvm/sweet_dashboard_project/jobs/mysql.rb:20:in `block (2\n&gt; levels) in &lt;top (required)&gt;'\n&gt; /home/user/.rvm/sweet_dashboard_project/jobs/mysql.rb:11:in `each'\n&gt; /home/user/.rvm/sweet_dashboard_project/jobs/mysql.rb:11:in `block in\n&gt; &lt;top (required)&gt;'\n&gt; /home/user/.rvm/gems/ruby-2.2.1/gems/rufus-scheduler-2.0.24/lib/rufus/sc/jobs.rb:230:in\n&gt; `call'\n&gt; /home/user/.rvm/gems/ruby-2.2.1/gems/rufus-scheduler-2.0.24/lib/rufus/sc/jobs.rb:230:in\n&gt; `trigger_block'\n&gt; /home/user/.rvm/gems/ruby-2.2.1/gems/rufus-scheduler-2.0.24/lib/rufus/sc/jobs.rb:204:in\n&gt; `block in trigger'\n&gt; /home/user/.rvm/gems/ruby-2.2.1/gems/rufus-scheduler-2.0.24/lib/rufus/sc/scheduler.rb:430:in\n&gt; `call'\n&gt; /home/user/.rvm/gems/ruby-2.2.1/gems/rufus-scheduler-2.0.24/lib/rufus/sc/scheduler.rb:430:in\n&gt; `block in trigger_job'\n</code></pre>\n"}, {"tags": ["ruby", "rubocop"], "comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 1, "creation_date": 1500309161, "post_id": 44003201, "comment_id": 77267770, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1961030/ruby-ampersand-colon-shortcut\">Ruby ampersand colon shortcut</a>"}, {"owner": {"reputation": 881, "user_id": 3010879, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000951369051/picture?type=large", "display_name": "medik", "link": "https://stackoverflow.com/users/3010879/medik"}, "edited": false, "score": 1, "creation_date": 1500309544, "post_id": 44003201, "comment_id": 77267986, "body": "In such cases it&#39;s always best to refer to the source: <a href=\"http://www.rubydoc.info/gems/rubocop/0.26.1/RuboCop/Cop/Style/SymbolProc\" rel=\"nofollow noreferrer\">rubydoc.info/gems/rubocop/0.26.1/RuboCop/Cop/Style/SymbolPro&zwnj;&#8203;c</a>."}], "answers": [{"tags": [], "owner": {"reputation": 435, "user_id": 729973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3237b00df62e8859236e9ad564738652?s=128&d=identicon&r=PG", "display_name": "michaeltomer", "link": "https://stackoverflow.com/users/729973/michaeltomer"}, "is_accepted": false, "score": 0, "last_activity_date": 1494946382, "creation_date": 1494946382, "answer_id": 44004863, "question_id": 44003201, "link": "https://stackoverflow.com/questions/44003201/ruby-passing-key-as-an-argument-to-map-instead-of-a-block/44004863#44004863", "title": "ruby passing &amp;:key as an argument to map instead of a block", "body": "<p>Ruby has a shorthand for simple blocks.</p>\n\n<pre><code>[\"apple\", \"pear\", \"grape\"].map { |fruit| fruit.upcase }\n\n# This does the same thing with less code:\n\n[\"apple\", \"pear\", \"grape\"].map(&amp;:upcase)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7276662, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SBXF48kDoR8/AAAAAAAAAAI/AAAAAAAACHo/TgwiXpRs4wU/photo.jpg?sz=128", "display_name": "Hasan", "link": "https://stackoverflow.com/users/7276662/hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 901, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500309169, "creation_date": 1494942115, "last_edit_date": 1500309169, "question_id": 44003201, "link": "https://stackoverflow.com/questions/44003201/ruby-passing-key-as-an-argument-to-map-instead-of-a-block", "title": "ruby passing &amp;:key as an argument to map instead of a block", "body": "<p>I wrote the following code:</p>\n\n<pre><code>def report_view_classes\n  [\n    Hourdiff,\n    AverageTimeForFirstReferrals,\n    CountZipCodeByUserids,\n    FirstRentForUsers,\n  ]\nend\n\ndef load_views\n  report_view_classes.each do |report_view_class|\n    report_view_class.create\n  end\n</code></pre>\n\n<p>but rubocop gives me following warning:</p>\n\n<pre><code>C: Pass &amp;:create as an argument to each instead of a block.\n  report_view_classes.each do |report_view_class\n</code></pre>\n\n<p>I am confused what to do </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "email", "selenium"], "answers": [{"tags": [], "owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "is_accepted": false, "score": 0, "last_activity_date": 1494941116, "creation_date": 1494941116, "answer_id": 44002805, "question_id": 44002608, "link": "https://stackoverflow.com/questions/44002608/how-to-automate-scenario-to-verify-if-email-is-received-by-user-after-every-8-ho/44002805#44002805", "title": "How to automate scenario to verify if email is received by user after every 8 hour/daily/ once in a week in selenium ruby?", "body": "<p>This is not something that selenium is capable of. Selenium is used for functional testing from within the browser whereas email is generated out of <a href=\"http://guides.rubyonrails.org/action_mailer_basics.html\" rel=\"nofollow noreferrer\">Rails mailers</a> and doesn't interact with the views.</p>\n\n<p>You can test the mailers using built in <a href=\"http://guides.rubyonrails.org/testing.html#testing-your-mailers\" rel=\"nofollow noreferrer\">mail testers</a>. And to test the delay likely you'll need to use <a href=\"http://edgeguides.rubyonrails.org/active_job_basics.html\" rel=\"nofollow noreferrer\">Active Job</a> which you'll need to <a href=\"http://edgeguides.rubyonrails.org/testing.html#testing-jobs\" rel=\"nofollow noreferrer\">test on their own</a> as well.</p>\n"}], "owner": {"reputation": 1, "user_id": 8019864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e90d8278fed9f4801748d4fa480c2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Spaul", "link": "https://stackoverflow.com/users/8019864/spaul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494941451, "creation_date": 1494940599, "last_edit_date": 1494941451, "question_id": 44002608, "link": "https://stackoverflow.com/questions/44002608/how-to-automate-scenario-to-verify-if-email-is-received-by-user-after-every-8-ho", "title": "How to automate scenario to verify if email is received by user after every 8 hour/daily/ once in a week in selenium ruby?", "body": "<p>How to verify if user is receiving email after every 8 hours in a day or one email a day or once in a week in selenium ruby as per the option user selects for getting email notification.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "model-view-controller"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1494940721, "post_id": 44002495, "comment_id": 75033515, "body": "try moving <code>:remote =&gt; true</code> outside the array: <code>simple_form_for([@event, @event.comments.build], remote: true)</code>"}, {"owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1494941703, "post_id": 44002495, "comment_id": 75034357, "body": "Thanks, this has removed the error but the page won&#39;t allow me to update the comment. Do I need to include a js.erb file?"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1494942115, "post_id": 44002495, "comment_id": 75034704, "body": "<code>@event.comments.build</code> builds the structure of a new <code>comment</code>, that new(not yet saved) object is used in the form <code>f</code> to build the whole form html structure. Short answer, that form must be pointing to the <code>create</code> and not the <code>update</code>, why ?, as I told you <code>@event.comments.build</code> builds a new <code>comment</code> which is not yet saved."}, {"owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1494942393, "post_id": 44002495, "comment_id": 75034913, "body": "So, what do i change the hash to? Or do i adjust the create method in the controller?"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1494942827, "post_id": 44002495, "comment_id": 75035259, "body": "what does the rails console show you when you click on <code>Add Comment</code>, is the request going to  the <code>create</code> action ?, it should go there; so, if you don&#39;t have a <code>create</code> action add it, and you&#39;ll have to adapt your code so that it creates a new <code>comment</code> with the given parameters."}], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 1, "last_activity_date": 1494940754, "creation_date": 1494940754, "answer_id": 44002653, "question_id": 44002495, "link": "https://stackoverflow.com/questions/44002495/rails-how-to-implement-remote-true-to-edit-comments-on-the-same-page/44002653#44002653", "title": "Rails - How to implement :remote =&gt; true, to edit comments on the same page", "body": "<p>You are not using proper format of <code>simple_form_for</code>. It should be</p>\n\n<pre><code>&lt;%= simple_form_for([@event, @event.comments.build], remote: true ) do |f| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494940754, "creation_date": 1494940330, "question_id": 44002495, "link": "https://stackoverflow.com/questions/44002495/rails-how-to-implement-remote-true-to-edit-comments-on-the-same-page", "title": "Rails - How to implement :remote =&gt; true, to edit comments on the same page", "body": "<p>I'm building an events site using Rails 5. On the Event#show page I have a comments section which I want to give edit/update functionality to without the user leaving the page. \nI'm trying to use <code>:remote =&gt; true</code> in the form but I'm hitting errors, here's the views and controller code -</p>\n\n<p><strong>comments/_form.html.erb</strong></p>\n\n<pre><code>&lt;%= simple_form_for([@event, @event.comments.build, :remote =&gt; true ]) do |f| %&gt;\n\n\n    &lt;%= f.label :comment %&gt;&lt;br&gt;\n    &lt;%= f.text_area :body %&gt;&lt;br&gt;\n    &lt;br&gt;\n    &lt;%= f.button :submit, label: 'Add Comment', class: \"btn btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Comments_controller.rb</strong></p>\n\n<pre><code>def update\n\n    respond_to do |format|\n      if @comment.update\n        format.html { redirect_to @comment, notice: 'Comment was successfully updated.' }\n        format.js   { }\n        format.json { render :show, status: :created, location: @comment }\n      else\n        format.html { render :new }\n        format.json { render json: @comment.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>The current error I'm getting is 'undefined method `model_name' for {:remote=>true}:Hash'. This is pointing to the events#show method in the Events controller. I'm not sure I'm using :remote => true in the correct place hence the error. This is the first time I've done this so I'm hitting errors each step of the way. Any help/assistance would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "docker", "dockerfile"], "comments": [{"owner": {"reputation": 1268, "user_id": 6309699, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vzRre.png?s=128&g=1", "display_name": "Gabbax0r", "link": "https://stackoverflow.com/users/6309699/gabbax0r"}, "edited": false, "score": 1, "creation_date": 1494939742, "post_id": 44002175, "comment_id": 75032754, "body": "what is the exact error msg you get while the docker builds the container?"}, {"owner": {"reputation": 11049, "user_id": 3324556, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4uEBE.jpg?s=128&g=1", "display_name": "Alex Karshin", "link": "https://stackoverflow.com/users/3324556/alex-karshin"}, "edited": false, "score": 0, "creation_date": 1494940410, "post_id": 44002175, "comment_id": 75033286, "body": "what is the result of <code>&#47;usr&#47;src&#47;app&#47;bin&#47;setup</code> execution?"}, {"owner": {"reputation": 54431, "user_id": 103264, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/82e758ccce74a8723ebba3d12c1a59da?s=128&d=identicon&r=PG&f=1", "display_name": "001", "link": "https://stackoverflow.com/users/103264/001"}, "edited": false, "score": 0, "creation_date": 1494940999, "post_id": 44002175, "comment_id": 75033767, "body": "I found the issue, it was my fault, the script executed but there was some errors, I used &quot;dos2unix&quot; on the setup file and it worked!"}], "answers": [{"tags": [], "owner": {"reputation": 3853, "user_id": 7274380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e841ecd1c88a7d4ea1347064b59ff5b?s=128&d=identicon&r=PG&f=1", "display_name": "Qasim Sarfraz", "link": "https://stackoverflow.com/users/7274380/qasim-sarfraz"}, "is_accepted": false, "score": 1, "last_activity_date": 1494948181, "creation_date": 1494948181, "answer_id": 44005535, "question_id": 44002175, "link": "https://stackoverflow.com/questions/44002175/dockerfile-how-to-run-script/44005535#44005535", "title": "Dockerfile - how to run script?", "body": "<p>I was facing a similar dos/unix issue. I did a git check out of a file in windows and added it to docker image(linux). If that is the case <code>sed</code> is your friend. Just add following to your <code>Dockerfile</code>:</p>\n\n<pre><code>RUN /bin/sed s/\\\\r//g -i /usr/src/app/bin/setup\n</code></pre>\n\n<p>Might save you from installing an additional package. Hope it help! </p>\n"}], "owner": {"reputation": 54431, "user_id": 103264, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/82e758ccce74a8723ebba3d12c1a59da?s=128&d=identicon&r=PG&f=1", "display_name": "001", "link": "https://stackoverflow.com/users/103264/001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494948181, "creation_date": 1494939532, "question_id": 44002175, "link": "https://stackoverflow.com/questions/44002175/dockerfile-how-to-run-script", "title": "Dockerfile - how to run script?", "body": "<p>Created a docker file, but unable to get run the rail setup script i.e ./bin/setup to execute</p>\n\n<p>What am I doing wrong? <code>RUN /bin/bash -C \"/usr/src/app/bin/setup\"</code> this does not work.</p>\n\n<p>I also tried this <code>RUN ./bin/setup</code> (this also does not work!)</p>\n\n<p>Dockerfile</p>\n\n<pre><code>FROM ruby:2.3\n\nRUN apt-get update &amp;&amp; apt-get install -y nodejs --no-install-recommends &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nENV RAILS_VERSION 5\n\nRUN gem install rails --version \"$RAILS_VERSION\"\n\nWORKDIR /usr/src/app\nCOPY . .\n# setup does not run, why?\nRUN /bin/bash -C \"/usr/src/app/bin/setup\"\n\n...\n</code></pre>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "openxml", "docx"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494939550, "post_id": 44000633, "comment_id": 75032573, "body": "Can you please provide a <b>complete, verifiable</b> example of your current code? I just went through the effort of reproducing your example above and found: <code>NoMethodError: undefined method &#39;underline=&#39; for #&lt;OpenXml::Docx::Elements::Run:0x007fec344aa1a0 @children=[]&gt;</code>"}, {"owner": {"reputation": 13, "user_id": 7651803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084db1d659f85b0a691cdf8260c1f88b?s=128&d=identicon&r=PG&f=1", "display_name": "vegeta", "link": "https://stackoverflow.com/users/7651803/vegeta"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494999820, "post_id": 44000633, "comment_id": 75060216, "body": "I got it working..thanks"}], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 8018505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b91738cee0a49bbbf95faf11cf9bc5a?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Coleman", "link": "https://stackoverflow.com/users/8018505/paul-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1494943983, "creation_date": 1494943983, "answer_id": 44003912, "question_id": 44000633, "link": "https://stackoverflow.com/questions/44000633/underline-in-openxmldocx-using-ruby/44003912#44003912", "title": "underline in OpenXml::Docx using Ruby", "body": "<p>Check the code for the <a href=\"https://github.com/openxml/openxml-docx/blob/master/lib/openxml/docx/properties/underline.rb\" rel=\"nofollow noreferrer\">Underline class</a> for the attributes that can be set.</p>\n\n<p>e.g. You can set the type of underline with this:</p>\n\n<pre><code>run = OpenXml::Docx::Elements::Run.new\nrun.underline.type = :dash\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7651803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084db1d659f85b0a691cdf8260c1f88b?s=128&d=identicon&r=PG&f=1", "display_name": "vegeta", "link": "https://stackoverflow.com/users/7651803/vegeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 44003912, "answer_count": 1, "score": -1, "last_activity_date": 1494943983, "creation_date": 1494935300, "question_id": 44000633, "link": "https://stackoverflow.com/questions/44000633/underline-in-openxmldocx-using-ruby", "title": "underline in OpenXml::Docx using Ruby", "body": "<p>I am using the OpenXml::Docx for creating docx and adding some text with some style like double underline, strike. The documentations explains through an example </p>\n\n<pre><code> require \"openxml/docx\"\n\n text = OpenXml::Docx::Elements::Text.new(\"Some text that I want to \n include in my new OOXML document\")\n run = OpenXml::Docx::Elements::Run.new\n run.bold = true\n run &lt;&lt; text\n paragraph = OpenXml::Docx::Elements::Paragraph.new\n paragraph &lt;&lt; run\n\n\ndocument = OpenXml::Docx::Package.new\ndocument.document &lt;&lt; paragraph\ndocument.save(\"/path/where/i/save/things/test.docx\")\n</code></pre>\n\n<p>So, I tried to make the text underlined but I was not able to do::</p>\n\n<pre><code>run = OpenXml::Docx::Elements::Run.new\nrun.underline = True\n</code></pre>\n\n<p>The underline tag is present as as property <a href=\"http://www.rubydoc.info/gems/openxml-docx/0.10.0/OpenXml/Docx/Properties\" rel=\"nofollow noreferrer\">link</a> but it is not showing in the output docx.\nPlease let me know the correct method. Also, let me know way to do double underline.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "capistrano3"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5506322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb7e914c558829a233e91deed224e921?s=128&d=identicon&r=PG&f=1", "display_name": "Nick La", "link": "https://stackoverflow.com/users/5506322/nick-la"}, "is_accepted": false, "score": 0, "last_activity_date": 1494937564, "creation_date": 1494937564, "answer_id": 44001456, "question_id": 44000413, "link": "https://stackoverflow.com/questions/44000413/gems-are-not-being-installed-from-capistrano-deployment/44001456#44001456", "title": "Gems are not being installed from capistrano deployment", "body": "<p>Deployment is in production mode.</p>\n\n<pre><code> RAILS_ENV=production bundle install\n</code></pre>\n"}], "owner": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1494940127, "creation_date": 1494934620, "last_edit_date": 1494940127, "question_id": 44000413, "link": "https://stackoverflow.com/questions/44000413/gems-are-not-being-installed-from-capistrano-deployment", "title": "Gems are not being installed from capistrano deployment", "body": "<p>I am using:</p>\n\n<ul>\n<li>rails 4.2</li>\n<li>unicorn server </li>\n<li>nginx web server</li>\n<li>capistrano for deployment.</li>\n</ul>\n\n<p>If I am adding a new gem to gemfile it's not reflecting in the application. I tried to check a gem by using <code>Gem.loaded_specs[\"koala\"].full_gem_path</code> but its not showing anywhere. I can see gem being bundled in the log and deployment gets completed successfully. But somewhere in between, I can see one error in Capistrano logs.</p>\n\n<p>NOTE: Bundler is already installed.</p>\n\n<pre><code>cd /home/deploy/bloom/releases/20170516105043 &amp;&amp; RAILS_ENV=dev bundle exec honeybadger deploy --environment dev --revision 08e4726 --repository git@bitbucket.org:appster/bloom-ruby.git --user arvindmehra\nDEBUG[1450b9f0]     **bash: bundle: command not found**\n</code></pre>\n\n<p>Here is my capfile: </p>\n\n<pre><code>require 'capistrano/setup'\nrequire 'capistrano/deploy'\nrequire 'capistrano/bundler'\nrequire 'capistrano/honeybadger'\nrequire 'capistrano/rails/assets'\nrequire 'capistrano/rails/migrations'\nrequire 'capistrano/rvm'\nrequire 'whenever/capistrano'\n\nDir.glob('lib/capistrano/tasks/*.rake').each { |r| import r }\n</code></pre>\n\n<p>Here is my deployment environment script from dev.rb</p>\n\n<pre><code>set :branch, 'dev'\nset :keep_releases, 3\n\nserver '66.128.61.239',\n  user: 'deploy',\n  roles: %w{web app db},\n  ssh_options: {\n    user: 'deploy', # overrides user setting above\n    keys: %w(~/.ssh/id_rsa),\n    forward_agent: false,\n    #auth_methods: %w(publickey)\n    password: 'password'\n  }\n\n\n namespace :deploy do\n\n  %w[start stop restart].each do |command|\n    desc \"#{command} unicorn server\"\n    task command do\n      on roles(:app), in: :sequence, wait: 1 do\n         execute \"/etc/init.d/bloom-ruby #{command}\"\n      end\n    end\n  end\n\n  after :publishing, :restart\n\n  after :restart, :clear_cache do\n    on roles(:web), in: :groups, limit: 3, wait: 10 do\n      # Here we can do anything such as:\n      # within release_path do\n      #   execute :rake, 'cache:clear'\n      # end\n    end\n  end\n\nend\n</code></pre>\n\n<p>Here is my deploy.rb </p>\n\n<pre><code># config valid only for current version of Capistrano\nlock '3.3.3'\n\n\nset :application, 'bloom'\nset :repo_url, 'git@bitbucket.org:appster/bloom-ruby.git'\nset :deploy_to, '/home/deploy/bloom'\n#set :linked_files, fetch(:linked_files, []).push('config/database.yml', 'config/secrets.yml')\n\n# Define which type of RVM the server is using\nset :rvm_type, :user\nset :rvm_ruby_version, '2.2.2@bloom'\n\n# Default value for :linked_files is []\nset :linked_files, %w{config/database.yml config/secrets.yml config/settings.yml config/providers.yml config/stripe.yml}\n\n# Default value for linked_dirs is []\nset :linked_dirs, %w{log tmp/pids tmp/cache tmp/sockets vendor/bundle public/system public/identicons public/uploads public/images}\n</code></pre>\n"}, {"tags": ["python", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3999, "user_id": 1920003, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gkgdd.jpg?s=128&g=1", "display_name": "Lynob", "link": "https://stackoverflow.com/users/1920003/lynob"}, "edited": false, "score": 3, "creation_date": 1494933983, "post_id": 44000085, "comment_id": 75028488, "body": "it&#39;s a really bad idea to use a real terminal and let the user execute code on your server, you need to use a python interpreter written in javascript like <a href=\"http://pypyjs.org/\" rel=\"nofollow noreferrer\">pypyjs.org</a> so it&#39;s just javascript"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1494952169, "post_id": 44000085, "comment_id": 75042028, "body": "At the moment, there are no Python implementations written in Ruby, although there <i>was</i> a project for a Python implementation on top of the Rubinius Language Framework (typhon, it never had more than a README and an empty directory, though). There <i>is</i> funnily enough a Ruby implementation on top of the PyPy Language Framework, but that is not feature-complete (and seems abandoned). Note that having users execute arbitrary code is a <i>really bad idea</i> unless you know <i>exactly</i> what you&#39;re doing."}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 4580814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027bad725fb46b84a2499611073a2ff9?s=128&d=identicon&r=PG&f=1", "display_name": "Abass Sesay", "link": "https://stackoverflow.com/users/4580814/abass-sesay"}, "edited": false, "score": 0, "creation_date": 1495749882, "post_id": 44006799, "comment_id": 75394923, "body": "or <code>`python #{file_path}`</code>. back ticks work the same"}], "tags": [], "owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "is_accepted": true, "score": 0, "last_activity_date": 1494951916, "creation_date": 1494951916, "answer_id": 44006799, "question_id": 44000085, "link": "https://stackoverflow.com/questions/44000085/python-embedded-in-rubyonrails/44006799#44006799", "title": "Python embedded in RubyOnRails", "body": "<p>As other have stated, there are serious security implications for letting users blindly run things on your server, but if you really wanted to, you could write the python to a file and then execute the python using <code>system \"python #{file_path}\"</code>.</p>\n\n<p>I'm not too familiar with python, but you could probably switch stdout and stderr to write to files and then read those files to get any print statements.</p>\n"}], "owner": {"reputation": 13, "user_id": 8019285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d0a69864b7409a51489488c531c53d?s=128&d=identicon&r=PG&f=1", "display_name": "Just For", "link": "https://stackoverflow.com/users/8019285/just-for"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 44006799, "answer_count": 1, "score": 0, "last_activity_date": 1494951916, "creation_date": 1494933653, "last_edit_date": 1494940483, "question_id": 44000085, "link": "https://stackoverflow.com/questions/44000085/python-embedded-in-rubyonrails", "title": "Python embedded in RubyOnRails", "body": "<p>I am trying to make a site like Codeacademy. Where users can learn Python online,\nsolve problems and master theory.</p>\n\n<p>Framework for the server is Ruby On Rails</p>\n\n<p>I am trying to understand how can I translate python's code to the server, then execute this code on the server? Any python's interpreters created in Ruby? I totally can not understand how this should work.</p>\n\n<p>Python's version: 2.7 or 3.5 (Not fundamentally)</p>\n\n<p>Thank you for attention</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1494932817, "post_id": 43999707, "comment_id": 75027684, "body": "No, that&#39;s about the best you can get, without compromising security."}, {"owner": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1494933234, "post_id": 43999707, "comment_id": 75027964, "body": "excuse me, what about the security in this case ?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1494933437, "post_id": 43999707, "comment_id": 75028111, "body": "To shorten this code any further, one would have to forego explicit listing of the attributes and the code would become &quot;take whatever is in that hash and make some variables from it&quot;. This is especially dangerous with dynamic local variables, which I&#39;m pretty sure you have to use <code>eval</code> for (which should not be used unless precautions are made and there&#39;s a legitimate reason, which is not the case here)."}, {"owner": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1494933618, "post_id": 43999707, "comment_id": 75028246, "body": "I got your idea. Thank you for your support."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1494933956, "post_id": 43999707, "comment_id": 75028459, "body": "Having many local variables is usually a code smell. Why do you need them in the first place?"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "edited": false, "score": 0, "creation_date": 1494933191, "post_id": 43999810, "comment_id": 75027934, "body": "Thank you very much, your method is so impressive"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "edited": false, "score": 0, "creation_date": 1494933700, "post_id": 43999810, "comment_id": 75028301, "body": "My pleasure Sir :) Anyway, I have to say I don&#39;t know if there is a better way. It could be."}, {"owner": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "edited": false, "score": 0, "creation_date": 1494933768, "post_id": 43999810, "comment_id": 75028341, "body": "It&#39;s the best method in this case :)"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "reply_to_user": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "edited": false, "score": 1, "creation_date": 1494934108, "post_id": 43999810, "comment_id": 75028600, "body": "@BraveVN you can move keys to <code>array</code> to make this line a bit shorter: <code>keys = %i[user_id first_name last_name phone_number addres]</code> and then just: <code>user_info.values_at(*keys)</code>"}, {"owner": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "reply_to_user": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1494934276, "post_id": 43999810, "comment_id": 75028727, "body": "awesome @AlexGolubenko, you&#39;re my hero :D"}, {"owner": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "reply_to_user": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1494934516, "post_id": 43999810, "comment_id": 75028891, "body": "@AlexGolubenko 2 shorter lines are always better than 1 long line :D"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1494932950, "creation_date": 1494932950, "answer_id": 43999810, "question_id": 43999707, "link": "https://stackoverflow.com/questions/43999707/how-to-do-mass-variable-assignment/43999810#43999810", "title": "How to do mass variable assignment", "body": "<p>This line</p>\n\n<pre><code>user_id, first_name, last_name, phone_number, address = user_info[:user_id], user_info[:first_name], user_info[:last_name], user_info[:phone_number], user_info[:address]\n</code></pre>\n\n<p>could be</p>\n\n<pre><code>user_id, first_name, last_name, phone_number, address = user_info.values_at(:user_id, :first_name, :last_name, :phone_number, :address)\n</code></pre>\n\n<p>Although it's long as well, I know</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 8018795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd735baf0e0ea446f3ffaa97a4427215?s=128&d=identicon&r=PG&f=1", "display_name": "user8018795", "link": "https://stackoverflow.com/users/8018795/user8018795"}, "is_accepted": false, "score": 1, "last_activity_date": 1494934124, "creation_date": 1494934124, "answer_id": 44000235, "question_id": 43999707, "link": "https://stackoverflow.com/questions/43999707/how-to-do-mass-variable-assignment/44000235#44000235", "title": "How to do mass variable assignment", "body": "<p>You could also use an OpenStruct, like so:</p>\n\n<pre><code>o=OpenStruct.new(user_info)\n</code></pre>\n\n<p>Then, you can access variables like so:</p>\n\n<pre><code>o.user_id\n</code></pre>\n\n<p>etc</p>\n"}], "owner": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 43999810, "answer_count": 2, "score": 0, "last_activity_date": 1494939501, "creation_date": 1494932672, "last_edit_date": 1494933886, "question_id": 43999707, "link": "https://stackoverflow.com/questions/43999707/how-to-do-mass-variable-assignment", "title": "How to do mass variable assignment", "body": "<p>I have a hash like this:  </p>\n\n<pre><code>user_info = {\n    user_id: 1,\n    first_name: \"Henry\",\n    last_name: \"Avery\",\n    phone_number: 1234567890,\n    address: \"United Kingdom\",\n}\n</code></pre>\n\n<p>When I receive this hash, I need to assign many variables like this:</p>\n\n<pre><code>user_id = user_info[:user_id]\nfirst_name = user_info[:first_name]\nlast_name = user_info[:last_name]\nphone_number = user_info[:phone_number]\naddress = user_info[:address]\n</code></pre>\n\n<p>It's annoying, and makes the code have more unnecessary lines. Even if I put all of them into one sentence, it'll be messy, the line being too long:</p>\n\n<pre><code>user_id, first_name, last_name, phone_number, address = user_info[:user_id], user_info[:first_name], user_info[:last_name], user_info[:phone_number], user_info[:address]\n</code></pre>\n\n<p>Do you know a quicker way to assign the hash to variables?<br>\nThank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "include", "autoload"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1494930551, "post_id": 43998870, "comment_id": 75026108, "body": "Nah, FQN won&#39;t help."}, {"owner": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "edited": false, "score": 0, "creation_date": 1494930672, "post_id": 43998870, "comment_id": 75026188, "body": "Sergio Tulentsev - why not?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1494930893, "post_id": 43998870, "comment_id": 75026318, "body": "@SergioTulentsev Huh? Of course when the class is defined as above FQN does work."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1494930955, "post_id": 43998870, "comment_id": 75026351, "body": "@mudasobwa: I don&#39;t think so. Your second example <i>might</i> work. But first one won&#39;t. I&#39;m willing to bet a beer on this."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1494931110, "post_id": 43998870, "comment_id": 75026450, "body": "@mudasobwa: it&#39;s not the class definition format. It&#39;s where its file is."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1494931112, "post_id": 43998870, "comment_id": 75026451, "body": "@SergioTulentsev you must be kidding. Rails [thanks God] still can\u2019t affect the syntax Ruby classes are declared with. It might [or might not] have problems with loading, but once it\u2019s loaded it\u2019s definitely addressable as such."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1494931152, "post_id": 43998870, "comment_id": 75026480, "body": "@mudasobwa: ah, if we&#39;re talking eager loading, then yes. I was referring to auto-loading (which is used by default in dev mode)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1494931271, "post_id": 43998870, "comment_id": 75026562, "body": "@SergioTulentsev I never could wrap my head around how it\u2019s doing auto-loading, so I always just do plain old good <code>Dir.each(&amp;:require)</code> :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1494930349, "creation_date": 1494930349, "answer_id": 43998870, "question_id": 43998837, "link": "https://stackoverflow.com/questions/43998837/rails-app-autoloading-classes-defined-in-modules/43998870#43998870", "title": "Rails app: autoloading classes defined in modules", "body": "<p>Either use a full-qualified name:</p>\n\n<pre><code>::Actions::Frontend::Cart::GetCartItemsSummarized.new.call\n</code></pre>\n\n<p>or just stick to Rails constant lookup (the below should work):</p>\n\n<pre><code>GetCartItemsSummarized.new.call\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "edited": false, "score": 0, "creation_date": 1494936002, "post_id": 43998990, "comment_id": 75029928, "body": "This looks like domain logic, so I would still keep it in <code>&#47;app</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "edited": false, "score": 0, "creation_date": 1494936634, "post_id": 43998990, "comment_id": 75030395, "body": "@fylooi: keep it in <code>&#47;app&#47;domain</code> then ). To keep it separate from, say, views."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1494930674, "creation_date": 1494930674, "answer_id": 43998990, "question_id": 43998837, "link": "https://stackoverflow.com/questions/43998837/rails-app-autoloading-classes-defined-in-modules/43998990#43998990", "title": "Rails app: autoloading classes defined in modules", "body": "<p>In rails/autoloading, the first level of directories, the one directly under <code>app</code>, is not considered a part of the name. It is so that your model can be just <code>User</code> and not <code>Models::User</code>, etc.</p>\n\n<p>My solution to this is to put all custom stuff in <code>app/lib</code>. This way, <code>lib</code> eats that non-naming layer and the rest of your folder structure become a name. In your example, put your file to</p>\n\n<pre><code>app/lib/actions/frontend/cart/get_cart_items_summarized.rb\n</code></pre>\n\n<p>Of course, feel free to replace \"lib\" with whatever you want (\"app/custom\", for example). This name doesn't matter. </p>\n"}, {"tags": [], "owner": {"reputation": 1700, "user_id": 627806, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c6022ce776b5415ea90bddd94355fffa?s=128&d=identicon&r=PG", "display_name": "Jon Burgess", "link": "https://stackoverflow.com/users/627806/jon-burgess"}, "is_accepted": false, "score": 0, "last_activity_date": 1531960303, "creation_date": 1531960303, "answer_id": 51412709, "question_id": 43998837, "link": "https://stackoverflow.com/questions/43998837/rails-app-autoloading-classes-defined-in-modules/51412709#51412709", "title": "Rails app: autoloading classes defined in modules", "body": "<p>In \"config/application.rb\", add \"app\" to autoload paths, e.g.:</p>\n\n<pre><code>class Application &lt; Rails::Application\n\n  config.autoload_paths += Dir[Rails.root.join('app')]\n\nend\n</code></pre>\n"}], "owner": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 0, "accepted_answer_id": 43998990, "answer_count": 3, "score": 2, "last_activity_date": 1531960303, "creation_date": 1494930236, "question_id": 43998837, "link": "https://stackoverflow.com/questions/43998837/rails-app-autoloading-classes-defined-in-modules", "title": "Rails app: autoloading classes defined in modules", "body": "<p>in Rails 5.0.1 application I have file <em>app/actions/frontend/cart/get_cart_items_summarized.rb</em> with:</p>\n\n<pre><code>module Actions\n  module Frontend\n    module Cart\n      class GetCartItemsSummarized\n        #content here\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>And in <em>app/helpers/application_helper.rb</em> I call it:</p>\n\n<pre><code>def get_cart_items\n  #...\n  items = Actions::Frontend::Cart::GetCartItemsSummarized.new.call\n  #...\nend\n</code></pre>\n\n<p>But I'm getting:</p>\n\n<p><em>uninitialized constant ApplicationHelper::Actions</em></p>\n\n<p>Why? How should I use this class?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "react-rails"], "comments": [{"owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1494930687, "post_id": 43998821, "comment_id": 75026195, "body": "can post the code where you are rendering time in view? @TopperH"}, {"owner": {"reputation": 1997, "user_id": 1637183, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/34c35d942fd31cb88655c18232404314?s=128&d=identicon&r=PG", "display_name": "TopperH", "link": "https://stackoverflow.com/users/1637183/topperh"}, "reply_to_user": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1494930958, "post_id": 43998821, "comment_id": 75026355, "body": "@NarasimhaReddy, yes, sure, just updated my question with the view code"}, {"owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1494931359, "post_id": 43998821, "comment_id": 75026647, "body": "Here <code>React.DOM.td null, @props.booking.start_time</code> you are passing a hash of values to DOM but you shouldn&#39;t. create a sentense that you want to display in <code>td</code> from <code>@props.booking.start_time</code> and pass that sentense there. it will work. like <code>React.DOM.td null, timeToDisplay</code>."}, {"owner": {"reputation": 1997, "user_id": 1637183, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/34c35d942fd31cb88655c18232404314?s=128&d=identicon&r=PG", "display_name": "TopperH", "link": "https://stackoverflow.com/users/1637183/topperh"}, "reply_to_user": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1494931712, "post_id": 43998821, "comment_id": 75026894, "body": "@NarasimhaReddy should the parsing be done in the controller?"}], "answers": [{"comments": [{"owner": {"reputation": 1997, "user_id": 1637183, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/34c35d942fd31cb88655c18232404314?s=128&d=identicon&r=PG", "display_name": "TopperH", "link": "https://stackoverflow.com/users/1637183/topperh"}, "edited": false, "score": 0, "creation_date": 1494939238, "post_id": 43999434, "comment_id": 75032315, "body": "Great, thank you. How would you make it handle a nil &quot;start_time&quot; field?"}, {"owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "reply_to_user": {"reputation": 1997, "user_id": 1637183, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/34c35d942fd31cb88655c18232404314?s=128&d=identicon&r=PG", "display_name": "TopperH", "link": "https://stackoverflow.com/users/1637183/topperh"}, "edited": false, "score": 1, "creation_date": 1494939553, "post_id": 43999434, "comment_id": 75032575, "body": "@TopperH it&#39;s better to handle it in back end side rather than in views."}], "tags": [], "owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "is_accepted": true, "score": 1, "last_activity_date": 1494931910, "creation_date": 1494931910, "answer_id": 43999434, "question_id": 43998821, "link": "https://stackoverflow.com/questions/43998821/react-rails-objects-are-not-valid-as-a-react-child/43999434#43999434", "title": "React Rails: Objects are not valid as a react child", "body": "<pre><code>let time = @props.booking.start_time\nlet timeToDisplay = time[\"hour\"] + \":\" + time[\"minute\"] + \":\" + time[\"second\"]\n</code></pre>\n\n<p><br> Do it like this and pass that value to <code>td</code>. i think it works. </p>\n\n<pre><code>React.DOM.td null, timeToDisplay\n</code></pre>\n"}], "owner": {"reputation": 1997, "user_id": 1637183, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/34c35d942fd31cb88655c18232404314?s=128&d=identicon&r=PG", "display_name": "TopperH", "link": "https://stackoverflow.com/users/1637183/topperh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 43999434, "answer_count": 1, "score": 0, "last_activity_date": 1494931910, "creation_date": 1494930204, "last_edit_date": 1494930907, "question_id": 43998821, "link": "https://stackoverflow.com/questions/43998821/react-rails-objects-are-not-valid-as-a-react-child", "title": "React Rails: Objects are not valid as a react child", "body": "<p>I'm using rails 5.1 with the react-rails gem.</p>\n\n<p>My model has a \"start_time\" column that uses the \"tod\" (time of day gem), so it is serialized in my model like this:</p>\n\n<pre><code>serialize :start_time, Tod::TimeOfDay\n</code></pre>\n\n<p>I need to parse this time in my react view, but I don't understand how to render the resulting object.</p>\n\n<pre><code>console.log(@props.booking.start_time) #=&gt; Object {hour: 10, minute: 15, second: 0, second_of_day: 36900}\n</code></pre>\n\n<p>When I try to render it in a view I get this error:</p>\n\n<pre><code>Uncaught Error: Objects are not valid as a React child (found: object with keys {hour, minute, second, second_of_day}). If you meant to render a collection of children, use an array instead or wrap the object using createFragment(object) from the React add-ons.\n</code></pre>\n\n<p>Should I parse the attribute in the model before sending it to react, or there is a react way to parse (and format) the array?</p>\n\n<p>EDIT: added the view code</p>\n\n<pre><code>@Booking = React.createClass\n  render: -&gt;\n    React.DOM.tr null,\n      React.DOM.td null, @props.booking.start_time\n</code></pre>\n"}, {"tags": ["ruby", "selection-sort"], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1494941797, "post_id": 43999020, "comment_id": 75034446, "body": "Do you need <code>@min</code> at all?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1494941898, "post_id": 43999020, "comment_id": 75034529, "body": "@Stefan I don\u2019t but since the original implementation returned a value, stored in instance variable, I decided to decrease an impact of my changes."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1494931337, "last_edit_date": 1494931337, "creation_date": 1494930749, "answer_id": 43999020, "question_id": 43998713, "link": "https://stackoverflow.com/questions/43998713/selection-sort-setting-value-in-each-loop/43999020#43999020", "title": "Selection sort setting value in each loop", "body": "<p><code>@min</code> plays [here] a role of global variable (<code>main</code>\u2019s instance variable.) Once set, it is never updated, since the minimum would never be touched anymore.</p>\n\n<p>You might want to update it\u2019s value on each subsequent call:</p>\n\n<pre><code>def finding_smallest arr_arg\n  @min = arr_arg.first\n\n  arr_arg.each do |el|\n    if el &lt; @min\n      @min = el\n    end\n  end\n  @min\nend\n</code></pre>\n\n<p>In ruby we use <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\"><code>Enumerable#reduce</code></a> for that:</p>\n\n<pre><code>def finding_smallest arr_arg\n  @min = arr_arg.reduce do |min, el|\n    el &lt; min ? el : min\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 4821316, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh6.googleusercontent.com/-bKDtq9ba2tk/AAAAAAAAAAI/AAAAAAAAACM/YsMOjzxHSik/photo.jpg?sz=128", "display_name": "11223342124", "link": "https://stackoverflow.com/users/4821316/11223342124"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 43999020, "answer_count": 1, "score": 0, "last_activity_date": 1494931337, "creation_date": 1494929946, "last_edit_date": 1494931034, "question_id": 43998713, "link": "https://stackoverflow.com/questions/43998713/selection-sort-setting-value-in-each-loop", "title": "Selection sort setting value in each loop", "body": "<p>I am trying to find the smallest element in an array.</p>\n\n<p>I tried to do this with <code>finding_smallest</code> method as follows:</p>\n\n<pre><code>def finding_smallest arr_arg\n  # first time returns 3;\n  # second time returns 3 again, even though arr_arg doesn't have it.\n  p arr_arg    \n  arr_arg.each do |el|\n    if el &lt; @min\n      @min = el\n    end\n  end\n  @min\nend\n\ndef selection_sort array\n  counter = 0\n  sorting = -&gt;(arr){\n    arr_range = arr[counter..-1]\n    smallest = finding_smallest(arr_range)\n    p arr_range # first iteration - whole array; second iteration - [1..end of the array]\n    p smallest # first iteration: 3, second iteration: 3;\n    first_element_in_range = arr_range[0] # for switching indexes of smallest and first in array\n    arr_range[arr_range.index(smallest)], arr_range[0] = arr_range[0], arr_range[arr_range.index(smallest)] #switching places\n    counter += 1\n    sorting.call(arr_range) unless counter == array.length || arr.nil?\n  }\n  sorting.call(array)\nend\n\n@array = [78, 42, 51, 49, 74, 53, 66, 39, 40, 3, 66, 100]\n@min = @array[0]\nselection_sort(@array)\n</code></pre>\n\n<p>It returns the smallest element from a previous array. I think the problem is that the <code>each</code> loop doesn't set the value for the second time (or first). What I am doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "distributed-system"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1494929954, "post_id": 43998572, "comment_id": 75025703, "body": "I don&#39;t think there&#39;s an &quot;idiomatic&quot; way of doing this, simply because people don&#39;t do this often enough. Every such situation is a unique snowflake."}, {"owner": {"reputation": 2460, "user_id": 3940126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0222b0a3b16a79649265eabba7e05add?s=128&d=identicon&r=PG&f=1", "display_name": "slowjack2k", "link": "https://stackoverflow.com/users/3940126/slowjack2k"}, "edited": false, "score": 1, "creation_date": 1494951918, "post_id": 43998572, "comment_id": 75041871, "body": "Your solution is one valid possibility. If you choose this one then you should consider using uuid&#39;s as primary keys or another uniq id mechanism between all servers. I would consider creating an API instead of sharing the DB. An API can be stable between all apps and does not rely on the persistence layer."}], "owner": {"reputation": 63, "user_id": 4833940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9f12c2610b09f1306a31ddd60d3e012?s=128&d=identicon&r=PG&f=1", "display_name": "Arsen Afaunov", "link": "https://stackoverflow.com/users/4833940/arsen-afaunov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494929577, "creation_date": 1494929577, "question_id": 43998572, "link": "https://stackoverflow.com/questions/43998572/the-best-way-to-sync-activerecord-structure-between-rails-apps", "title": "The best way to sync ActiveRecord structure between rails apps", "body": "<p>I am developing a distributed system consisting of rails apps. There are multiple servers in different geographical locations producing some data that should be synced with a single cloud server and then distributed among the \"local\" servers. In other words, there is a shared state stored on the \"global\" server and partially on the \"local\" ones and its changes are lazily actualized by the \"local\" servers.</p>\n\n<p>ActiveRecord models to be synced have the same definition both on the \"local\" servers and the \"global\" one. But they are maintained separately just by a developers convention. Thus there might some synchronization issues including differences in model definitions.</p>\n\n<p>What is the best way to share the model definitions between the servers and implement their validation?</p>\n\n<p>The solution I've come up with is to move model definitions into a separate versioned library (gem), share it between servers and use serialization and deserialization (<code>as_json</code> and <code>from_json</code> methods) to ensure that the structure of the model received by the cloud server is correct while syncing.</p>\n\n<p>Is there a more idiomatic way of doing it?</p>\n"}, {"tags": ["ruby", "split"], "comments": [{"owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "edited": false, "score": 2, "creation_date": 1494928053, "post_id": 43997964, "comment_id": 75024383, "body": "Show some example input and desired output"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1494930971, "post_id": 43998052, "comment_id": 75026367, "body": "Consider using <a href=\"https://ruby-doc.org/core/Regexp.html#method-c-union\" rel=\"nofollow noreferrer\"><code>Regexp#union</code></a> instead of <code>(#{words.join(&#39;|&#39;)})</code>."}, {"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1494932044, "post_id": 43998052, "comment_id": 75027140, "body": "@mudasobwa Makes it harder to add case-insensitive modifier. This <code>&#47;#{ Regexp.union(words).source }&#47;i</code> looks more complex than <code>&#47;(#{words.join(&#39;|&#39;)})&#47;i</code> in my opinion."}], "tags": [], "owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "is_accepted": false, "score": 1, "last_activity_date": 1494929432, "last_edit_date": 1494929432, "creation_date": 1494928203, "answer_id": 43998052, "question_id": 43997964, "link": "https://stackoverflow.com/questions/43997964/how-to-split-string-based-on-certain-words/43998052#43998052", "title": "How to split string based on certain words", "body": "<p>Regex is your friend here. Just pass the words you want to split on (Stop for example) and you can also use <code>i</code> so you don't need to downcase:</p>\n\n<pre><code>command, service = params['body'].split(/(stop)/i)\n</code></pre>\n\n<p>A better example: </p>\n\n<pre><code>words = %w(stop start)\nyour_string = 'stop88 start 88'\n\nyour_string.gsub!(/\\s+/, \"\") # remove whitespaces\nyour_string.split(/(#{words.join('|')})/i).reject(&amp;:empty?)\n=&gt; [\"stop\", \"88\", \"start\", \"88\"]\n</code></pre>\n\n<p><code>/(#{words.join('|')})/i</code> translates to <code>/(stop|start)/i</code> in this example</p>\n\n<ul>\n<li>takes an array of words that you want to split on and joins them with <code>|</code> meaning it'll match either of them </li>\n<li>applies <code>()</code> to include the matches themselves. </li>\n<li><code>/i</code> means it's case-insensitive</li>\n<li><code>reject(&amp;:empty?)</code> just deletes empty fields if any</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1494931360, "creation_date": 1494931360, "answer_id": 43999234, "question_id": 43997964, "link": "https://stackoverflow.com/questions/43997964/how-to-split-string-based-on-certain-words/43999234#43999234", "title": "How to split string based on certain words", "body": "<p>You can use <code>match</code> with named captures, for example: </p>\n\n<pre><code>example_arr = ['START88', 'START 88', 'start 88', 'STOP 99']\nmatcher = /(?&lt;command&gt;start|stop)\\s*(?&lt;service&gt;\\d*)/i\nexample_arr.map { |line| line.match matcher }\n\n#=&gt; [#&lt;MatchData \"START88\" command:\"START\" service:\"88\"&gt;, \n     #&lt;MatchData \"START 88\" command:\"START\" service:\"88\"&gt;, \n     #&lt;MatchData \"start 88\" command:\"start\" service:\"88\"&gt;, \n     #&lt;MatchData \"STOP 99\" command:\"STOP\" service:\"99\"&gt;]\n</code></pre>\n\n<p>It's just example, in your case it would be something like:</p>\n\n<pre><code>params['body'] = 'START88'\ncommand, service = params['body'].match(matcher).captures\n\n&gt; command\n#=&gt; \"START\"\n&gt; service\n#=&gt; \"88\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1494931712, "post_id": 43999314, "comment_id": 75026893, "body": "Nice solution, +1 :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1494931601, "creation_date": 1494931601, "answer_id": 43999314, "question_id": 43997964, "link": "https://stackoverflow.com/questions/43997964/how-to-split-string-based-on-certain-words/43999314#43999314", "title": "How to split string based on certain words", "body": "<pre><code>['START88', 'START 88'].map { |w| w.scan(/(\\w+)\\s*(\\d+)/) }\n#\u21d2\u00a0[['START', '88'], ['START', '88']]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "is_accepted": false, "score": 0, "last_activity_date": 1494932364, "creation_date": 1494932364, "answer_id": 43999602, "question_id": 43997964, "link": "https://stackoverflow.com/questions/43997964/how-to-split-string-based-on-certain-words/43999602#43999602", "title": "How to split string based on certain words", "body": "<p>For a given string you can also extract digits and letters <em>without regexes</em>. </p>\n\n<pre><code>a = \"START88\"\na.chars.select{|e| e.chr.to_i != 0 }.join(\"\")\n#=&gt; \"88\"\n# you can also use reject if != is not for you -))\n#a.chars.select{ |e| e.chr.to_i != 0 }.join(\"\").to_i\n#=&gt; 88\na.chars.select{ |e| e.chr.to_i == 0 }.join(\"\")\n#=&gt; \"START\"\n</code></pre>\n\n<p>p.s. converting a string into an array, then joining elements to form a string is not a good solution, but in case if you hate regexes -))</p>\n"}], "owner": {"reputation": 517, "user_id": 6469753, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/72cdf784409922bdc8656020f9214259?s=128&d=identicon&r=PG&f=1", "display_name": "EamonnMcElroy", "link": "https://stackoverflow.com/users/6469753/eamonnmcelroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "accepted_answer_id": 43999234, "answer_count": 4, "score": -2, "last_activity_date": 1494933493, "creation_date": 1494927980, "last_edit_date": 1494933493, "question_id": 43997964, "link": "https://stackoverflow.com/questions/43997964/how-to-split-string-based-on-certain-words", "title": "How to split string based on certain words", "body": "<p>I want to split a string by <code>'START'</code> optionally surrounded by spaces. Examples:</p>\n\n<pre><code>params['body'] = 'START88'\n# =&gt; command = 'START', service = '88'\n\nparams['body'] = 'START 88'\n# =&gt; command = 'START', service = '88'\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>command, service = params['body'].downcase.strip.split(' ')\n</code></pre>\n\n<p>but am not sure how to encompass words instead of spaces. </p>\n\n<p>EDIT: Might I also add the service is not always numbers so it could quite easily be 'STARTSERVICE'. There are however a finite number of commands: START, STOP, SUB, UNSUB.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1384, "user_id": 7175708, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/QJYJM.png?s=128&g=1", "display_name": "Lechucico", "link": "https://stackoverflow.com/users/7175708/lechucico"}, "edited": false, "score": 0, "creation_date": 1495723898, "post_id": 43998360, "comment_id": 75380984, "body": "Can you edit the answer and show me how will be Invoice, Serie, Season and Chapter tables?"}], "tags": [], "owner": {"reputation": 735, "user_id": 5775246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rWMQ7_UYyiI/AAAAAAAAAAI/AAAAAAAAADc/xFHc8sFhSWk/photo.jpg?sz=128", "display_name": "DjezzzL", "link": "https://stackoverflow.com/users/5775246/djezzzl"}, "is_accepted": true, "score": 1, "last_activity_date": 1494929028, "creation_date": 1494929028, "answer_id": 43998360, "question_id": 43997834, "link": "https://stackoverflow.com/questions/43997834/ruby-on-rail-multiple-product-possibility-on-invoice-table/43998360#43998360", "title": "Ruby on rail multiple product possibility on invoice table", "body": "<p>You could use <a href=\"http://guides.rubyonrails.org/association_basics.html#polymorphic-associations\" rel=\"nofollow noreferrer\">polymorphic association</a> from Active Record.</p>\n\n<p>It can be represented like this:</p>\n\n<pre><code>class InvoiceLine &lt; ActiveRecord::Base\n  belongs_to :invoice\n  belongs_to :containable, polymorphic: true\nend\n</code></pre>\n\n<p>With this definition you should have table like this:</p>\n\n<pre><code>create_table :invoice_lines do |t|\n  t.references :invoice,\n  t.references :containable, polymorphic: true\nend\n</code></pre>\n\n<p><code>t.references :containable, polymorphic: true</code> will create both integer containable_id and string containable_type columns.</p>\n"}], "owner": {"reputation": 1384, "user_id": 7175708, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/QJYJM.png?s=128&g=1", "display_name": "Lechucico", "link": "https://stackoverflow.com/users/7175708/lechucico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 43998360, "answer_count": 1, "score": 0, "last_activity_date": 1494929028, "creation_date": 1494927697, "question_id": 43997834, "link": "https://stackoverflow.com/questions/43997834/ruby-on-rail-multiple-product-possibility-on-invoice-table", "title": "Ruby on rail multiple product possibility on invoice table", "body": "<p>I have by the moment 4 tables on my web-market.</p>\n\n<pre><code>Table User: Username + password + email.\nTable Serie: Serie name + price + description\nTable Season: Season name + price + description + fk(Serie)   //Each season belongs to a serie \nTable Chapter: Chapter name + price + description + fk(Season)   //Each chapter belongs to a season\n</code></pre>\n\n<p>The user would be able to buy either series seasons and chapters. The main idea is the following:</p>\n\n<pre><code>Table invoice: fk(user)   //User have multiple invoices\nTable invoice_line: fk(invoice), fk(serie|season|chapter)   //Each invoice contains multiple products\n</code></pre>\n\n<p>How can I represent that serie|season|chapter relation easily?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "haml"], "comments": [{"owner": {"reputation": 403, "user_id": 4206866, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J50VD3U3eLI/AAAAAAAAAAI/AAAAAAAAB94/avkl6wqQvS8/photo.jpg?sz=128", "display_name": "Raman Kumar Sharma", "link": "https://stackoverflow.com/users/4206866/raman-kumar-sharma"}, "edited": false, "score": 0, "creation_date": 1494927362, "post_id": 43997185, "comment_id": 75023827, "body": "Do you want to show just images present in that raw post body or whole body content?"}], "answers": [{"comments": [{"owner": {"reputation": 201, "user_id": 7666165, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/SakmP.jpg?s=128&g=1", "display_name": "Cliff_Cleet", "link": "https://stackoverflow.com/users/7666165/cliff-cleet"}, "edited": false, "score": 0, "creation_date": 1494999140, "post_id": 43997775, "comment_id": 75059949, "body": "Thank you @Rokibul"}], "tags": [], "owner": {"reputation": 3724, "user_id": 2409515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a33T6.jpg?s=128&g=1", "display_name": "Rokibul Hasan", "link": "https://stackoverflow.com/users/2409515/rokibul-hasan"}, "is_accepted": true, "score": 1, "last_activity_date": 1494927568, "creation_date": 1494927568, "answer_id": 43997775, "question_id": 43997185, "link": "https://stackoverflow.com/questions/43997185/how-to-get-the-img-src-value-from-raw-content-in-haml-rails/43997775#43997775", "title": "How to get the img src value from raw content in haml (Rails )", "body": "<p>You can use <a href=\"https://github.com/sparklemotion/nokogiri\" rel=\"nofollow noreferrer\">gem nokogiri</a> to extract any html tag, try following code snippet, you might need to <code>require 'nokogiri'</code> while try on <code>console</code></p>\n\n<pre><code> content = Nokogiri::HTML(pass_your_html_content)\n srcs    = content.css('img').map{ |i| i['src'] }\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 7666165, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/SakmP.jpg?s=128&g=1", "display_name": "Cliff_Cleet", "link": "https://stackoverflow.com/users/7666165/cliff-cleet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 43997775, "answer_count": 1, "score": 0, "last_activity_date": 1494927568, "creation_date": 1494926086, "question_id": 43997185, "link": "https://stackoverflow.com/questions/43997185/how-to-get-the-img-src-value-from-raw-content-in-haml-rails", "title": "How to get the img src value from raw content in haml (Rails )", "body": "<p>How can i get the img src value from the (= raw post.body) in ruby on rails haml page ? Now i am getting the total contents i.e,</p>\n\n<pre><code>&lt;p&gt;Lorem ipsumLorem ipsumLorem ipsumLorem ipsumLorem ipsumLorem ipsum&lt;/p&gt;\\r\\n&lt;p&gt;&lt;img style=\\\"float: right;\\\" src=\\\"../../../spree/blog_entry_images/704/large/IMG_4378.jpg?1466600823\\\" alt=\\\"\\\" width=\\\"404\\\" height=\\\"606\\\" /&gt;&lt;img src=\\\"../../../spree/blog_entry_images/718/large/IMG_4356.jpg?1466608157\\\" alt=\\\"\\\" width=\\\"405\\\" height=\\\"608\\\" /&gt;&lt;/p&gt;\n</code></pre>\n\n<p>I want to show each image in loop. So how can i get this ???</p>\n\n<p>Thanks in Advance.</p>\n"}, {"tags": ["ruby", "xml", "nokogiri"], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 3328921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9386ab49bea2f95ab84eb048aee4863a?s=128&d=identicon&r=PG&f=1", "display_name": "archon92", "link": "https://stackoverflow.com/users/3328921/archon92"}, "is_accepted": false, "score": 0, "last_activity_date": 1495105012, "creation_date": 1495105012, "answer_id": 44045867, "question_id": 43996705, "link": "https://stackoverflow.com/questions/43996705/nokogiri-check-if-xml-element-has-a-child-node/44045867#44045867", "title": "Nokogiri check if XML element has a child node", "body": "<p>why cant you try a simpler approach,\nbased off of your sample xml doc, this pseudo code must work.EVERY 'Nokogiri::XML::ELEMENT' has a method called 'next_element' which you could leverage in the following way</p>\n\n<p><code>xml_doc.elements.each do |ele|\n     #iterate over children in the doc\"\n     ele.children.each do |child_ele|\n          #check if the next element belongs to nokogiri text class\n          unless child_ele.next_element.class == 'Nokogiri::XML::Text'\n               #do something with child_elements which are not text\n          else\n               #do something with text element\n          end\n     end\nend</code></p>\n"}], "owner": {"reputation": 1455, "user_id": 2274900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aa6c355c642a86a8a18c956dbe67a972?s=128&d=identicon&r=PG", "display_name": "chinds", "link": "https://stackoverflow.com/users/2274900/chinds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 994, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1495105012, "creation_date": 1494924763, "question_id": 43996705, "link": "https://stackoverflow.com/questions/43996705/nokogiri-check-if-xml-element-has-a-child-node", "title": "Nokogiri check if XML element has a child node", "body": "<p>Given an XML structure similar to: </p>\n\n<pre><code>&lt;homes&gt;\n    &lt;home&gt;\n        &lt;name&gt;home 1&lt;/name&gt;\n    &lt;/home&gt;\n    &lt;home&gt;\n        &lt;name&gt;home 2&lt;/name&gt;\n    &lt;/home&gt;\n&lt;/homes&gt;\n&lt;flats&gt;\n    &lt;flat&gt;Flat 1&lt;/flat&gt;\n&lt;/flats&gt;\n</code></pre>\n\n<p>Using Ruby and nokogiri how would I iterate over the nodes and check if the child element is another element or a text node?</p>\n\n<p>Basically if the child node is another element I need to modify what I do with the output than if it was just a text node.</p>\n\n<p>I need to do this without knowing the key names.</p>\n\n<p>As an example I can do exactly what i want if I check the key name (as I know this have a child element) however this need to be generic and not data specific.</p>\n\n<p>This is what I have by checking the key name:</p>\n\n<pre><code>repeatingElements = []\n        nodes.each do |element|\n          case element\n          when Nokogiri::XML::Element\n            child_content = map_content(element.children, {})\n            if element.name === 'home'\n              repeatingElements &lt;&lt; {\n                element.name =&gt; child_content\n              }\n              content_hash = repeatingElements\n            else\n              content_hash[element.name] = child_content unless child_content.empty?\n            end\n          when Nokogiri::XML::Text\n            return element.content\n          end\n        end\n        content_hash\n      end\n</code></pre>\n\n<p>Im trying to avoid using this: <code>if element.name === 'home'</code> as with real data I may not know the key name.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 1039, "user_id": 558232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aLHwj.jpg?s=128&g=1", "display_name": "shivashankar", "link": "https://stackoverflow.com/users/558232/shivashankar"}, "edited": false, "score": 0, "creation_date": 1494923200, "post_id": 43995689, "comment_id": 75020804, "body": "Can you post the Gemfile content?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1494923202, "post_id": 43995689, "comment_id": 75020805, "body": "Can you please show us the output (by editing your original post, not in the comments) of running <code>bundle env</code>? It is also highly preferable for users to copy+paste text into question, rather than taking a screenshot of it."}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 1, "creation_date": 1494925929, "post_id": 43995689, "comment_id": 75022617, "body": "1) This is just a wild guess, but perhaps bundler is copying something from <code>~&#47;.bundle&#47;cache&#47;*</code> into <code>&#47;tmp</code>, and the permission error is therefore somewhere in  the <code>~&#47;.bundle</code> hierarchy, and not in <code>&#47;tmp</code>. I would check everything in <code>~&#47;.bundle</code> to make sure. 2) Is there enough space on <code>&#47;tmp</code>?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1494927061, "post_id": 43995689, "comment_id": 75023539, "body": "Hmm... what <i>are</i> the permissions on <code>&#47;tmp</code>? (And <code>~&#47;.bundle</code>?) Have you done anything &#39;unusual&#39; to them? Are you running in a strange environment, e.g. inside a docker container?"}, {"owner": {"reputation": 183, "user_id": 6176394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/945261141733c25671268e2aa465249d?s=128&d=identicon&r=PG&f=1", "display_name": "Artur Martsinkovskyi", "link": "https://stackoverflow.com/users/6176394/artur-martsinkovskyi"}, "edited": false, "score": 0, "creation_date": 1494931951, "post_id": 43995689, "comment_id": 75027067, "body": "No, just an rvm environment. No Docker or something."}, {"owner": {"reputation": 330, "user_id": 4681454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-b-mqwMUa9aE/AAAAAAAAAAI/AAAAAAAAAOY/buV0IYuNIvY/photo.jpg?sz=128", "display_name": "Eric Terry", "link": "https://stackoverflow.com/users/4681454/eric-terry"}, "edited": false, "score": 0, "creation_date": 1614134523, "post_id": 43995689, "comment_id": 117290444, "body": "Check your bundler version. If it&#39;s different than the one specified in <code>Gemfile.lock</code>, it could be trying to update that <code>BUNDLED WITH</code> line."}], "owner": {"reputation": 183, "user_id": 6176394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/945261141733c25671268e2aa465249d?s=128&d=identicon&r=PG&f=1", "display_name": "Artur Martsinkovskyi", "link": "https://stackoverflow.com/users/6176394/artur-martsinkovskyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1437, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494923785, "creation_date": 1494921742, "last_edit_date": 1494923785, "question_id": 43995689, "link": "https://stackoverflow.com/questions/43995689/permission-error-trying-to-bundle-install", "title": "Permission error trying to bundle install", "body": "<p>When I try to bundle install on any of my rails projects it provides me with that error. The strange thing is that this file is inexistent and even if I create it and chmod it to writeable it still fails with the same error. How can I solve this?\nThe error is following: \n<em>There was an error while trying to write to\n/tmp/bundler-compact-index-20170516-7063-bzwspt/versions. It is likely that\nyou need to grant write permissions for that path.</em></p>\n\n<h2>Environment</h2>\n\n<pre><code>Bundler   1.14.5\nRubygems  2.6.10\nRuby      2.3.1p112 (2016-04-26 revision 0) [x86_64-linux-gnu]\nGit       2.9.3\nPlatform  x86_64-linux\n</code></pre>\n\n<h2>Gemfile</h2>\n\n<h3>Gemfile</h3>\n\n<pre><code>ruby\nsource 'https://rubygems.org'\n\nruby '2.3.0'\n\ngem 'rails', '&gt;= 5.0.0.beta3', '&lt; 5.1'\ngem 'whenever', require: false\ngem 'rake', '&lt; 11.0'\ngem 'puma'\ngem 'sass-rails', '~&gt; 5.0'\ngem 'uglifier', '&gt;= 1.3.0'\ngem 'coffee-rails', '~&gt; 4.1.0'\n\ngem 'jquery-rails'\ngem 'turbolinks', '&lt; 5.x'\n\ngem 'dotenv'\ngem 'dotenv-rails'\ngem 'dotenv-deployment', require: 'dotenv/deployment'\n\ngem 'bootstrap-sass', '~&gt; 3.3.6'\ngem 'jquery-turbolinks'\n\ngem 'simple_form'\n\ngem 'font-awesome-rails'\ngem 'momentjs-rails', '~&gt; 2.9'\ngem 'datetimepicker-rails', github: 'zpaulovics/datetimepicker-rails', submodules: true\ngem 'country_select'\ngem 'paranoia', github: 'radar/paranoia', branch: 'core'\n\ngem 'chartjs-ror', '~&gt; 2.2.0'\n\ngem 'wfarr-ciunas', '~&gt; 0.0.3'\n\ngroup :development, :test do\n  gem 'byebug'\n  gem 'rspec-rails'\n  gem 'database_cleaner'\n  gem 'factory_girl_rails'\n  gem 'faker'\nend\n\ngroup :development do\n  gem 'web-console', '~&gt; 3.0'\n  gem 'listen', '~&gt; 3.0.5'\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\n  # deploy\n  gem 'capistrano', '3.4.1'\n  gem 'capistrano-rails'\n  gem 'capistrano-rvm'\n  gem 'capistrano3-puma'\n  gem 'active-record-query-trace'\nend\n\ngem 'gritter'\n\ngem 'rubocop'\ngem 'pg'\ngem 'devise', github: 'plataformatec/devise', ref: '88724e10adaf9ffd1d8dbfbaadda2b9d40de756a'\ngem 'omniauth-facebook'\ngem 'omniauth-twitter'\ngem 'cloudinary', '1.1.2'\ngem 'aasm'\ngem 'recaptcha', require: 'recaptcha/rails'\ngem 'cancancan', '~&gt; 1.10'\ngem 'sproutvideo-rb'\n\ngem 'bootbox-rails', '~&gt;0.4'\ngem 'kaminari', git: 'git://github.com/amatsuda/kaminari.git', branch: 'master'\ngem 'stripe'\ngem 'paypal-sdk-rest'\n\ngem 'newrelic_rpm'\ngem 'ckeditor', '4.2.0'\n\ngem 'breadcrumbs_on_rails'\n\ngem 'autoprefixer-rails'\n\ngroup :production do\n  gem 'mailgun_rails'\nend\n\ngem 'sitemap'\ngem 'carrierwave'\n\ngem 'friendly_id', '~&gt; 5.1.0'\ngem 'mini_magick'\n\nRUBY VERSION\n   ruby 2.3.0p0\n\nBUNDLED WITH\n   1.14.4\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zgMGe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zgMGe.png\" alt=\"this is what I get when I try to bundle install\"></a></p>\n"}]