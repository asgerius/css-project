[{"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 2, "creation_date": 1527117545, "post_id": 50498733, "comment_id": 88010317, "body": "This is non-trivial.  You need to handle the &#39;submit&#39; event on the form, save the state that your committing, use Javascript to detect and save the addition of data through the button presses, then finally do the post request with all the data you&#39;ve collected, probably best in a <code>data</code> Javascript object which includes the forms original data + the additional data added through your UI."}], "owner": {"reputation": 47, "user_id": 9458696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160157475535302/picture?type=large", "display_name": "Nick Saltarelli", "link": "https://stackoverflow.com/users/9458696/nick-saltarelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527117254, "creation_date": 1527117254, "question_id": 50498733, "link": "https://stackoverflow.com/questions/50498733/how-to-add-more-information-to-my-post-request-sinatra", "title": "How to add more information to my &quot;Post&quot; request (Sinatra)", "body": "<p>I want ask a user for more information once they click one of the mood buttons. Example: If a user clicks on \"Very Happy\", I would like to pop another input form asking: \"Would you like to add more info as to why you feel this way?\"</p>\n\n<p>If a user says no then proceed to posting. </p>\n\n<p>If a user fills in additional info. Modify the information being posted to the database which one now include info to be posted to the property :mood_reason.</p>\n\n<p>Any help in achieving this would be awesome.</p>\n\n<p><strong>My Current situation</strong></p>\n\n<p>Currently when a user clicks one of my buttons in image below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5DVtK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5DVtK.png\" alt=\"enter image description here\"></a></p>\n\n<p>I send the post request directly to my database using the following code:</p>\n\n<pre><code>post '/mood' do\n params.merge!(user_id: session[:id])\n Mood.create(params)\n redirect '/dashboard'\nend\n</code></pre>\n\n<p>My Html.erb input forms looks like this:</p>\n\n<pre><code>&lt;div style=\"height:50px;\"&gt;&lt;/div&gt;\n\n&lt;div class=\"w3-display-container\" style=\"height:50px;\"&gt;\n&lt;form action = \"/mood\" method = \"post\"&gt;\n&lt;input class=\"w3-button w3-display-middle w3-black\" \nstyle=\"width:200px;\" type=\"submit\" name=\"mood\" value=\"Very Happy\" /&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n\n&lt;div class=\"w3-display-container\" style=\"height:50px;\"&gt;\n&lt;form action = \"/mood\" method = \"post\"&gt;\n&lt;input class=\"w3-button w3-display-middle w3-black\" \nstyle=\"width:200px;\" type=\"submit\" name=\"mood\" value=\"Happy\" /&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n\n&lt;div class=\"w3-display-container\" style=\"height:50px;\"&gt;\n&lt;form action = \"/mood\" method = \"post\"&gt;\n&lt;input class=\"w3-button w3-display-middle w3-black\" \nstyle=\"width:200px;\" type=\"submit\" name=\"mood\" value=\"Neutral\" /&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n\n&lt;div class=\"w3-display-container\" style=\"height:50px;\"&gt;\n&lt;form action = \"/mood\" method = \"post\"&gt;\n&lt;input class=\"w3-button w3-display-middle w3-black\" \nstyle=\"width:200px;\" type=\"submit\" name=\"mood\" value=\"Sad\" /&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n\n&lt;div class=\"w3-display-container\" style=\"height:50px;\"&gt;\n&lt;form action = \"/mood\" method = \"post\"&gt;\n&lt;input class=\"w3-button w3-display-middle w3-black\" \nstyle=\"width:200px;\" type=\"submit\" name=\"mood\" value=\"Very Sad\" /&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ios", "ruby-on-rails", "ruby", "mobile-safari", "mobile-chrome"], "comments": [{"owner": {"reputation": 2090, "user_id": 642978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/WpQgb.jpg?s=128&g=1", "display_name": "mroach", "link": "https://stackoverflow.com/users/642978/mroach"}, "edited": false, "score": 0, "creation_date": 1527145595, "post_id": 50498694, "comment_id": 88018330, "body": "What&#39;s the <code>Content-Type</code> on the URL? I can imagine if an unknown <code>Content-Type</code> is returned that a mobile browser would attempt to just download it as a binary file. I&#39;d run the Chrome and/or Safari remote debugger/inspector to see what&#39;s going on."}, {"owner": {"reputation": 1, "user_id": 9837168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10273d3d4dde979c0202f1cd7a6adbe6?s=128&d=identicon&r=PG&f=1", "display_name": "nobetterjim", "link": "https://stackoverflow.com/users/9837168/nobetterjim"}, "reply_to_user": {"reputation": 2090, "user_id": 642978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/WpQgb.jpg?s=128&g=1", "display_name": "mroach", "link": "https://stackoverflow.com/users/642978/mroach"}, "edited": false, "score": 0, "creation_date": 1527173538, "post_id": 50498694, "comment_id": 88037115, "body": "Thanks, I&#39;ll give this a shot later today."}], "owner": {"reputation": 1, "user_id": 9837168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10273d3d4dde979c0202f1cd7a6adbe6?s=128&d=identicon&r=PG&f=1", "display_name": "nobetterjim", "link": "https://stackoverflow.com/users/9837168/nobetterjim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527118489, "creation_date": 1527116924, "last_edit_date": 1527118489, "question_id": 50498694, "link": "https://stackoverflow.com/questions/50498694/rails-app-follows-controller-action-except-on-mobile-browsers-where-it-tries-to", "title": "Rails app follows controller action except on mobile browsers, where it tries to turn the POST into a download", "body": "<p>My Rails 5 app makes four API calls and displays the results on the show page. I have button_to in place that calls an Ajax POST request on the show page so users can vote on their favorite. This triggers some JS, which works fine in dev and production on my laptop. Browsers on my iphone, though, use the full controller URI and try to download it. The button_to returns a 204: no content status. </p>\n\n<p>I've tried redirecting to another /show page after the Ajax call as well as redirecting with the gem browser if the user is on mobile, but those pages crash if the user refreshes them. I've tried explicitly returning a 200 status in the controller, but that wants a redirect. I want the user to stay on the /show page, so nothing else with redirecting works for me. </p>\n\n<p>In the model:</p>\n\n<pre><code>def self.first_api(term)\n  call_url = FIRST_CALL_URL\n  response = HTTParty.get(call_url,\n    { headers: {\n      \"Accept\": \"application/json\",\n      \"app_id\": \"#{ENV['FIRST_API_APP_ID']}\",\n      \"app_key\": \"#{ENV['FIRST_API_APP_KEY']}\" }\n    })\n\n  if response.include?(\"!DOCTYPE\")\n    \"NO DEFINITION\"\n  else\n    response\n  end\nend\n</code></pre>\n\n<p>Controller (truncated): </p>\n\n<pre><code>def show\n  @full_call = FullCall.find(params[:id])\nend\n\ndef create\n  @full_call = FullCall.where(word:full_call_params[:word]).first_or_create do |call|\n    call.first_api_response = FirstCall.first_api(call.word)\n  end\nend\n\nif @full_call.save\n  redirect_to @full_call\nelse\n  render 'new'\nend\n\ndef vote_for_first\n  @full_call.first_vote += 1\n  @full_call.save\nend\n\nprivate\n\n    def full_call_params\n      params.require(:full_call).permit(:word, :definition)\n    end\n</code></pre>\n\n<p>Relevant routes: </p>\n\n<pre><code>resources :full_calls\npost 'vote_for_first', to: 'full_calls#vote_for_first'\n</code></pre>\n\n<p>/show page:</p>\n\n<pre><code>&lt;p&gt;\n  &lt;div&gt;\n    &lt;h2 id='full-call-heading'&gt;&lt;%= @full_call.word.upcase %&gt;&lt;/h2&gt;\n    &lt;div id='full-call-alert'&gt;&lt;/div&gt;\n  &lt;/div&gt;\n&lt;/p&gt;\n\n&lt;div class=\"container\"&gt;\n  &lt;div class=\"card-title\"&gt;\n    &lt;div class=\"card card-default\"&gt;\n      &lt;div class=\"card-header\"&gt;&lt;strong&gt;First Call Definition:&lt;/strong&gt;\n        &lt;div&gt;\n          &lt;%= button_to('VOTE FOR FIRST', { controller: 'full_calls',\n                                         action: 'vote_for_first',\n                                         id: @full_call,\n                                         remote: true },\n                                       { class: \"btn btn-outline-secondary btn-sm vote-btn\" }) %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;div class=\"card-block\"&gt;&lt;%= @full_call.first_api_response %&gt;&lt;/div&gt;\n</code></pre>\n\n<p>application.js</p>\n\n<pre><code>$(document).on('turbolinks:load', function() {\n  $('.vote-btn').on('click', function() {\n    setTimeout(function() {\n      $('.vote-btn').attr('disabled', true);\n      $('#full-call-alert').append(\"&lt;h5&gt;Thanks for voting!&lt;/h5&gt;\").hide().slideDown('slow');\n    }, 100);\n  });\n});\n</code></pre>\n\n<p>And, finally, the URL that returns the \"Download failed\" message only on mobile browsers:</p>\n\n<pre><code>myapp.herokuapp.com/vote_for_first?id=12&amp;remote=true\n</code></pre>\n\n<p>Any ideas? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "excel", "csv"], "comments": [{"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "edited": false, "score": 0, "creation_date": 1527120859, "post_id": 50498656, "comment_id": 88011082, "body": "Looks like your csv file is utf-8 encoded. Try opening it in utf-8 mode in Excel (if that&#39;s possible), or write the file as ascii if it doesn&#39;t contain special characters."}, {"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "reply_to_user": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "edited": false, "score": 0, "creation_date": 1527121245, "post_id": 50498656, "comment_id": 88011154, "body": "I tried doing: <code>CSV.open(fileNameInbound, &#39;wb&#39;, :encoding =&gt; Encoding::US_ASCII) do |csv|</code>  I get this error: <code>Encoding::UndefinedConversionError: U+2019 from UTF-8 to US-ASCII</code>"}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "edited": false, "score": 0, "creation_date": 1527121439, "post_id": 50498656, "comment_id": 88011195, "body": "Yes, because your file is in utf-8 encoding. You could try to write it in ascii encoding or open it as utf-8 in Excel."}, {"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "reply_to_user": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "edited": false, "score": 0, "creation_date": 1527122613, "post_id": 50498656, "comment_id": 88011432, "body": "I showed the beginning of the code. I am writing it from the table to CSV and adding the encoding ASCII  <code>CSV.open(fileNameInbound, &#39;wb&#39;, :encoding =&gt; Encoding::US_ASCII) do |csv|  myModel.all.each do |m|     csv &lt;&lt; m   end end</code>"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1527146227, "post_id": 50498656, "comment_id": 88018694, "body": "If the data is pure US-ASCII then you should be able to write the file in UTF-8 or US-ASCII as the first 128 characters in UTF-8 correspond to US-ASCII.  So since this does not show up properly: the single quote is probably not in US-ASCII but something else?"}, {"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "edited": false, "score": 0, "creation_date": 1527177772, "post_id": 50498656, "comment_id": 88039854, "body": "I think is the fancy back quote that throws Excel off. The simple &#39; works."}, {"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "edited": false, "score": 0, "creation_date": 1527279557, "post_id": 50498656, "comment_id": 88084713, "body": "I fixed my issue. Thanks Danny_ds. I answered is below."}, {"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "edited": false, "score": 0, "creation_date": 1528234090, "post_id": 50498656, "comment_id": 88427516, "body": "I don&#39;t get why the downvote? It&#39;s so dumb how some people have genuine issues and try their best to ask them and some random person could down vote it and making the question obscure. This is super helpful and I am sure many people are struggling sharing data and not displaying correctly in Excel."}], "answers": [{"tags": [], "owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "is_accepted": true, "score": 0, "last_activity_date": 1527279489, "creation_date": 1527279489, "answer_id": 50536311, "question_id": 50498656, "link": "https://stackoverflow.com/questions/50498656/exporting-ruby-csv-from-activerecord-single-quote-in-excel-looks-weird/50536311#50536311", "title": "Exporting Ruby CSV from ActiveRecord single quote in Excel looks weird", "body": "<p>I fixed my problem by adding BOM characters in the beginning of my file to force the UTF-8 in Excel. </p>\n\n<pre><code>CSV.open(fileNameInbound, 'wb', :encoding: 'UTF-8') do |csv| \n  myModel.all.each do |m| \n    csv &lt;&lt; ['\\xef\\xbb\\xbf']\n    csv &lt;&lt; m \n  end \nend\n</code></pre>\n"}], "owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 50536311, "answer_count": 1, "score": -1, "last_activity_date": 1527279489, "creation_date": 1527116638, "last_edit_date": 1527127088, "question_id": 50498656, "link": "https://stackoverflow.com/questions/50498656/exporting-ruby-csv-from-activerecord-single-quote-in-excel-looks-weird", "title": "Exporting Ruby CSV from ActiveRecord single quote in Excel looks weird", "body": "<p>When I open the exported CSV file from Excel after extracting data from my table using the <a href=\"https://ruby-doc.org/stdlib-2.0.0/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\" title=\"Ruby&#39;s CSV library\">Ruby's CSV library</a>. I open the file using Excel (all of my users use Excel to open my CSV files). It comes out funky looking. Here's some screen shots. </p>\n\n<p>I tried converting converting it to ASCII, but I get an error:\n<code>Encoding::UndefinedConversionError: U+2019 from UTF-8 to US-ASCII</code></p>\n\n<pre><code>CSV.open(fileNameInbound, 'wb', :encoding =&gt; Encoding::US_ASCII) do |csv| \n  myModel.all.each do |m| \n    csv &lt;&lt; m \n  end \nend\n</code></pre>\n\n<p>My users are not tech savvy so I cannot have them trying to change it to UTF-8 or something. </p>\n\n<p>In Sublime Text looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2ILmX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2ILmX.png\" alt=\"enter image description here\"></a></p>\n\n<p>In Excel looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/c3vuK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c3vuK.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "tdd", "fixtures"], "comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1527132581, "post_id": 50498543, "comment_id": 88013554, "body": "This should help <a href=\"https://stackoverflow.com/a/26637179/4758119\">stackoverflow.com/a/26637179/4758119</a>"}, {"owner": {"reputation": 600, "user_id": 2796616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sPrN.png?s=128&g=1", "display_name": "andrew21", "link": "https://stackoverflow.com/users/2796616/andrew21"}, "edited": false, "score": 0, "creation_date": 1527135351, "post_id": 50498543, "comment_id": 88014258, "body": "Are the ID\u2019s \u201crandom\u201d or sequentially higher across runs of rspec?  Can you include one complete rspec file where you are running this test?  In the same block where you test location.retailer, can you also run \u2018pp retailers(:ret_europe)\u2019  also, run .valid? Against both objects to see if you are having some sort of validation error.  All-in-all, this should generally work, so not sure why it wouldn\u2019t.  Oh, can you confirm you are enforcing referential integrity on the tables as well?"}, {"owner": {"reputation": 4632, "user_id": 83846, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/63d0301fd5cf100d3c291b76df0acc70?s=128&d=identicon&r=PG", "display_name": "Tom Corelis", "link": "https://stackoverflow.com/users/83846/tom-corelis"}, "edited": false, "score": 0, "creation_date": 1527188583, "post_id": 50498543, "comment_id": 88045371, "body": "While the answer solves the problem I do want to note that some of the other classes in the project (not these ones) have some code that runs in the before_validation handler, which expects certain associations to be present. In the normal application workflow this is not a problem but I have noticed that building those same objects using fixtures can be problematic as those expected associations aren&#39;t present. I will look into that further but it is a bit puzzling as the included samples don&#39;t have any such logic and still have the issue."}, {"owner": {"reputation": 4632, "user_id": 83846, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/63d0301fd5cf100d3c291b76df0acc70?s=128&d=identicon&r=PG", "display_name": "Tom Corelis", "link": "https://stackoverflow.com/users/83846/tom-corelis"}, "edited": false, "score": 0, "creation_date": 1527188664, "post_id": 50498543, "comment_id": 88045422, "body": "Also, I am not aware of postgres-enforced CREATE PRIMARY KEY or somesuch, AR is supposed to be handling that on the Ruby side. Or did that change with newer versions of Rails? This project was originally upgraded from 4.1."}], "answers": [{"comments": [{"owner": {"reputation": 4632, "user_id": 83846, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/63d0301fd5cf100d3c291b76df0acc70?s=128&d=identicon&r=PG", "display_name": "Tom Corelis", "link": "https://stackoverflow.com/users/83846/tom-corelis"}, "edited": false, "score": 1, "creation_date": 1527188295, "post_id": 50500971, "comment_id": 88045225, "body": "So I have considered this but the docs seem to imply that specifying your own ID wasn&#39;t necessary. I would certainly prefer if I could trust the ORM or fixtures to handle it. I know that fixtures knows about the object because if I call out a fixture that doesn&#39;t exist it throws an error. Nonetheless, this does solve the problem and I&#39;ve marked this as an answer. Thank you!"}, {"owner": {"reputation": 108, "user_id": 9166666, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kzDV5A0MgjE/AAAAAAAAAAI/AAAAAAAAAWE/jEBZlgSx7C4/photo.jpg?sz=128", "display_name": "Ayer", "link": "https://stackoverflow.com/users/9166666/ayer"}, "reply_to_user": {"reputation": 4632, "user_id": 83846, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/63d0301fd5cf100d3c291b76df0acc70?s=128&d=identicon&r=PG", "display_name": "Tom Corelis", "link": "https://stackoverflow.com/users/83846/tom-corelis"}, "edited": false, "score": 0, "creation_date": 1527230591, "post_id": 50500971, "comment_id": 88057925, "body": "I don&#39;t know what your  <i>location_spec.rb</i> looks like. But, for your code to work without implementing my previously mentioned solution you should include both fixtures in <i>location_spec.rb</i>. <i>location_spec.rb</i> should contain these lines <code>fixtures :locations</code> <code>fixtures :retailers</code> inside RSpec context where you&#39;re using <code>pp locations(:loc_paris).retailer</code>"}, {"owner": {"reputation": 108, "user_id": 9166666, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kzDV5A0MgjE/AAAAAAAAAAI/AAAAAAAAAWE/jEBZlgSx7C4/photo.jpg?sz=128", "display_name": "Ayer", "link": "https://stackoverflow.com/users/9166666/ayer"}, "reply_to_user": {"reputation": 4632, "user_id": 83846, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/63d0301fd5cf100d3c291b76df0acc70?s=128&d=identicon&r=PG", "display_name": "Tom Corelis", "link": "https://stackoverflow.com/users/83846/tom-corelis"}, "edited": false, "score": 0, "creation_date": 1527231084, "post_id": 50500971, "comment_id": 88058130, "body": "And @TomCorelis please remove <code>(Retailer)</code> from these lines <code>retailer: ret_europe (Retailer)</code> and <code>retailer: ret_usa (Retailer)</code>"}], "tags": [], "owner": {"reputation": 108, "user_id": 9166666, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kzDV5A0MgjE/AAAAAAAAAAI/AAAAAAAAAWE/jEBZlgSx7C4/photo.jpg?sz=128", "display_name": "Ayer", "link": "https://stackoverflow.com/users/9166666/ayer"}, "is_accepted": true, "score": 3, "last_activity_date": 1527136479, "last_edit_date": 1527136479, "creation_date": 1527136013, "answer_id": 50500971, "question_id": 50498543, "link": "https://stackoverflow.com/questions/50498543/nil-associations-with-rails-fixtures-how-to-fix/50500971#50500971", "title": "Nil Associations with Rails Fixtures... how to fix?", "body": "<p><strong>Problem with fixtures</strong></p>\n\n<p>Looking at what you've done, <code>locations(:loc_paris)</code> will find the record described in <em>locations.yml</em>, but <code>locations(:loc_paris).retailer</code> won't.</p>\n\n<p><strong>Rails Associations work like this:</strong> </p>\n\n<p><code>locations(:loc_paris).retailer</code> will look for the <code>retailer</code> with <code>retailer_id</code> mentioned in <code>locations(:loc_paris)</code> record. In your case <code>retailer_id: 399879241</code> and there is no <code>reseller</code> with this <code>id</code> that's why it returns <code>Nil</code>.</p>\n\n<p><strong>Solution:</strong>\nDescribe fixtures like this: </p>\n\n<pre><code>#spec/fixtures/locations.yml\nloc_paris:\n  retailer_id: 1\n  name: \"Paris\"\n  nickname: \"paris\"\n\nloc_washington:\n  retailer_id: 2\n  name: \"Washington\"\n  nickname: \"washington\"\n\n#spec/fixtures/retailers.yml\nret_europe:\n  id: 1\n  name: \"AcmeCo France\"\n  nickname: \"acmecofr\"\n  currency_type: \"EUR\"\n\nret_usa:\n  id: 2\n  name: \"AcmeCo USA\"\n  nickname: \"acmecousa\"\n  currency_type: \"USD\"\n</code></pre>\n\n<p>Now, <code>locations(:loc_paris).retailer</code> will look for the retailer with <code>retailer_id</code> mentioned in <code>locations(:loc_paris)</code> record i.e. <code>retailer_id: 1</code> and there is a reseller <code>ret_europe</code> with this <code>id</code>. <strong>Problem Solved</strong></p>\n\n<p><strong>When you run rspec, at first <code>rspec</code> saves these fixtures into your database with some auto-generated <code>id</code> values (if <code>id</code> not provided explicitly), that's why <code>id</code> and <code>reseller_id</code> are some random values</strong>. If you don't want the <code>id</code> of <code>locations.yml</code> record to be some random value, you can provide it yourself like this:</p>\n\n<pre><code>loc_paris:\n  id: 1\n  retailer_id: 1\n  name: \"Paris\"\n  nickname: \"paris\"\n</code></pre>\n\n<p><strong>Tips:</strong>\nAs <code>rspec</code> runs in <code>test</code> environment (mentioned in <em>app/spec/rails_helper.rb</em>) and as I mentioned earlier whenever you run <code>rspec</code>, at first it saves the fixtures into your database. If your <code>local</code> and <code>test</code> database are same, fixtures will replace the actual database records of your database. In your case, records in <code>locations</code> and <code>resellers</code> table record will be completely erased and replaced with these fixtures. So, make different database for <code>test</code> environment.</p>\n\n<p><strong>Hope this answer is helpful</strong></p>\n"}], "owner": {"reputation": 4632, "user_id": 83846, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/63d0301fd5cf100d3c291b76df0acc70?s=128&d=identicon&r=PG", "display_name": "Tom Corelis", "link": "https://stackoverflow.com/users/83846/tom-corelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 916, "favorite_count": 1, "accepted_answer_id": 50500971, "answer_count": 1, "score": 3, "last_activity_date": 1527136479, "creation_date": 1527115692, "question_id": 50498543, "link": "https://stackoverflow.com/questions/50498543/nil-associations-with-rails-fixtures-how-to-fix", "title": "Nil Associations with Rails Fixtures... how to fix?", "body": "<p>I have a Rails 5.1 project using rspec/fixtures and I am having trouble getting fixtures to load objects associated with belongs_to/has_one/has_many: the object I requested the fixture for comes back with its _id columns filled with a seemingly-random number and ActiveRecord sees the association as <code>nil</code>. This occurs on large classes with many associations as well as small data classes with only a few fields. </p>\n\n<p>If, in my test code, I assign those associations with normal Ruby code, objects behave as normal and my tests pass. However when loading the same data through fixtures, associated records are not available and tests that require data spanning across associations fail.</p>\n\n<p>As an example, here are two affected classes:</p>\n\n<pre><code>#app/models/location.rb\nclass Location &lt; ActiveRecord::Base\n  has_many :orders\n  has_many :end_user\n  belongs_to :retailer\n  belongs_to :depot\nend\n\n#app/models/retailer.rb\nclass Retailer &lt; ActiveRecord::Base\n    has_many :locations\nend\n</code></pre>\n\n<p>And here are two corresponding fixtures files:</p>\n\n<pre><code>#spec/fixtures/locations.yml\nloc_paris:\n  retailer: ret_europe (Retailer)\n  name: \"Paris\"\n  nickname: \"paris\"\n\nloc_washington:\n  retailer: ret_usa (Retailer)\n  name: \"Washington\"\n  nickname: \"washington\"\n\n#spec/fixtures/retailers.yml\nret_europe:\n  name: \"AcmeCo France\"\n  nickname: \"acmecofr\"\n  currency_type: \"EUR\"\n\nret_usa:\n  name: \"AcmeCo USA\"\n  nickname: \"acmecousa\"\n  currency_type: \"USD\"\n</code></pre>\n\n<p>With the above data, running <code>pp locations(:loc_paris)</code> results in:</p>\n\n<pre><code>#&lt;Location:0x0000000006eee1d8\n id: 35456173,\n name: \"Paris\",\n nickname: \"paris\",\n retailer_id: 399879241,\n created_at: Wed, 23 May 2018 22:39:56 UTC +00:00,\n updated_at: Wed, 23 May 2018 22:39:56 UTC +00:00&gt;\n</code></pre>\n\n<p>Those id numbers are consistent through multiple calls, at least in the same RSpec context. (I put <code>pp locations(:loc_paris)</code> in a <code>let</code> block.) Yet <code>pp locations(:loc_paris).retailer</code> returns <code>nil</code>.</p>\n\n<p>I tried using FactoryBot however we had to switch away from it. I am trying to give fixtures an honest shake but it seems like we are best off simply building data objects in the actual test code... because that solutions works without complaining :/</p>\n\n<p>Am I doing something wrong here? Are we asking too much of fixtures?</p>\n\n<p>Thank you!</p>\n\n<p>Tom</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1527111004, "post_id": 50497725, "comment_id": 88008372, "body": "There are a number of style guides you can use, <a href=\"https://github.com/airbnb/ruby\" rel=\"nofollow noreferrer\">such as this one from Airbnb</a>, to improve the readability of your code through formatting."}, {"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "reply_to_user": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1527111298, "post_id": 50497725, "comment_id": 88008470, "body": "Thanks that&#39;s helpful. However, I would like to perhaps create a method for some of my variables. For example, I have the same attributes in questions and in transformed. How can I make it where is more reusable."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527112001, "post_id": 50497725, "comment_id": 88008751, "body": "&quot;how repetitive and how copy paste I did&quot; - looks fine to me &#175;\\_(\u30c4)_/&#175; But maybe you can save a few lines with a <a href=\"https://blog.bigbinary.com/2018/02/06/ruby-2-5-added-hash-slice-method.html\" rel=\"nofollow noreferrer\"><code>Hash#slice</code></a> (ruby 2.5+, <a href=\"https://ruby-doc.org/core-2.5.1/Hash.html#method-i-slice\" rel=\"nofollow noreferrer\">docs</a>)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527112340, "post_id": 50497725, "comment_id": 88008875, "body": "&quot;I am literally using the same keys for questions and transformed&quot; - yeah, so? Why exactly do you think this is a problem?"}, {"owner": {"reputation": 12135, "user_id": 538471, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d2051553a8bdd27c26fec84b47806714?s=128&d=identicon&r=PG", "display_name": "dan-klasson", "link": "https://stackoverflow.com/users/538471/dan-klasson"}, "edited": false, "score": 0, "creation_date": 1527113121, "post_id": 50497725, "comment_id": 88009138, "body": "<a href=\"https://github.com/mak-it/xport\" rel=\"nofollow noreferrer\">github.com/mak-it/xport</a>"}, {"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527179982, "post_id": 50497725, "comment_id": 88041001, "body": "@Sergio Tulentsev because I have thousands of line of code. I made a small sample of my code. If I could get rid off many lines by reusing my variables it will be more readable and easier to maintain."}], "answers": [{"comments": [{"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "edited": false, "score": 0, "creation_date": 1527117186, "post_id": 50498359, "comment_id": 88010234, "body": "I need to rearrange the columns and that&#39;s why I have them twice. Also, they do not equal each-other. The keys do. I have <code>questions</code> for show a different header name instead the column names. You cannot rearrange them any other way apparently than creating a new hash with the order you want. My schema shows the way they are arranged."}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "edited": false, "score": 0, "creation_date": 1527118424, "post_id": 50498359, "comment_id": 88010536, "body": "@myhouse so you need only to use <code>slice</code> as suggested by @sergio-tulentsev. Please check my updated answer"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1527167668, "post_id": 50498359, "comment_id": 88032887, "body": "<code>slice</code> in not needed since you do not care about the <code>keys</code> themselves instead <code>values_at(*questions.keys)</code> would suffice also the <code>compact</code> will shift the values if one happens to be <code>nil</code> also probably not useful"}, {"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "edited": false, "score": 0, "creation_date": 1527180134, "post_id": 50498359, "comment_id": 88041084, "body": "I see what you&#39;re saying. That&#39;s a good point."}, {"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "edited": false, "score": 0, "creation_date": 1527181727, "post_id": 50498359, "comment_id": 88041910, "body": "I have a lot of true and false and I would like to replace the true and false with yes and no. How do you do that?"}], "tags": [], "owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "is_accepted": true, "score": 1, "last_activity_date": 1527119900, "last_edit_date": 1527119900, "creation_date": 1527114453, "answer_id": 50498359, "question_id": 50497725, "link": "https://stackoverflow.com/questions/50497725/fix-rails-bad-practice-make-more-pretty/50498359#50498359", "title": "Fix rails bad practice make more pretty", "body": "<p>Try this:</p>\n\n<pre><code>questions = {\n                created_at: 'DATE SUBMITTED',   \n                flight_date: 'FLIGHT DATE',\n                flight_num: 'FLIGHT NUMBER',\n                orn: 'ORIGIN'\n    }\n    CSV.open('/user/pepe/myfile.csv', 'wb') do |csv|\n        csv &lt;&lt; questions.values\n        MyModel.all.select(questionsInbound.keys).each do |inbounds|\n            csv &lt;&lt; inbounds.attributes.symbolize_keys.slice(*questions.keys).values.compact\n        end\n    end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "edited": false, "score": 0, "creation_date": 1527117329, "post_id": 50498641, "comment_id": 88010266, "body": "I haven&#39;t yet tried this, but if it works I am thinking accepting your answer. So far is been the neatest answer. Thanks."}], "tags": [], "owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "is_accepted": false, "score": 0, "last_activity_date": 1527116504, "creation_date": 1527116504, "answer_id": 50498641, "question_id": 50497725, "link": "https://stackoverflow.com/questions/50497725/fix-rails-bad-practice-make-more-pretty/50498641#50498641", "title": "Fix rails bad practice make more pretty", "body": "<p>My approach has been to come up with a Hash of Strings and Lambdas that describes the columns:</p>\n\n<pre><code>columns = {\n  'DATE SUBMITTED' =&gt; -&gt;(flight) { flight.created_at },\n  'FLIGHT DATE'    =&gt; -&gt;(flight) { flight.flight_date },\n  'FLIGHT NUMBER'  =&gt; -&gt;(flight) { flight.flight_num },\n  'ORN'            =&gt; -&gt;(flight) { flight.origin }\n}\n</code></pre>\n\n<p>Then loop though the Hash's <code>#keys</code> and <code>#values</code>.</p>\n\n<pre><code>CSV.generate do |csv|\n  csv &lt;&lt; columns.keys\n  flights.each do |flight|\n    csv &lt;&lt; columns.values.map { |column| column.call(flight) }\n  end\nend\n</code></pre>\n\n<p>I've also seen it done with Symbols refering to method names rather than lambdas.</p>\n\n<hr>\n\n<p>However, you've also looking to call <code>Model.select(column_names)</code> which implies that you may need to come up with more data beyond just a lambda. Like, say, a <code>Struct</code>:</p>\n\n<pre><code>Column = Struct.new(name: name, value: callable, sql_select: nil)\n\ncolumns = [\n  Column.new(name: 'DATE SUBMITTED', value: -&gt;(flight) { flight.created_at }, sql_select: 'created_at'),\n  ...\n]\n</code></pre>\n\n<p>CSV generation is similar:</p>\n\n<pre><code>CSV.generate do |csv|\n  csv &lt;&lt; columns.map(&amp;:name)\n  flights.select(columns.map(&amp;:sql_select)).each do |flight|\n    csv &lt;&lt; columns.map { |column| column.value.call(flight) }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1527116837, "accepted_answer_id": 50498359, "answer_count": 2, "score": 1, "last_activity_date": 1527119900, "creation_date": 1527110827, "last_edit_date": 1527112203, "question_id": 50497725, "link": "https://stackoverflow.com/questions/50497725/fix-rails-bad-practice-make-more-pretty", "closed_reason": "Opinion-based", "title": "Fix rails bad practice make more pretty", "body": "<p>I am trying to create a CSV file from my ActiveRecord. I want to display my own custom headers for the CSV file instead the attribute name. I also want to reorder the columns and not use the column order in the database table.</p>\n\n<p>I am not satisfy on how repetitive and how copy paste I did and I was wondering if anyone had suggestions on a much cleaner solution. </p>\n\n<p>schema:</p>\n\n<pre><code>create_table \"myTable\", options: \"ENGINE=InnoDB DEFAULT CHARSET=utf8\", force: :cascade do |t|\n    t.text \"flight_date\"\n    t.text \"orn\"\n    t.text \"flight_num\"\n    t.datetime \"created_at\"\nend\n</code></pre>\n\n<p>code:</p>\n\n<pre><code># field names and their values\nquestions = {\n            created_at: 'DATE SUBMITTED',   \n            flight_date: 'FLIGHT DATE',\n            flight_num: 'FLIGHT NUMBER',\n            orn: 'ORIGIN'\n}\nCSV.open('/user/pepe/myfile.csv', 'wb') do |csv|\n    csv &lt;&lt; questions.values\n    MyModel.all.select(questionsInbound.keys).each do |inbounds|\n        attributes = inbounds.attributes //put the custom header\n        transformed = {\n            created_at: attributes['created_at'],   \n            flight_dt: attributes['flight_dt'],\n            flight_num: attributes['flight_num'],\n            orn: attributes['orn']\n        }\n        csv &lt;&lt; transformed.values.compact # get values and filter out nil\n    end\nend\n</code></pre>\n\n<p>If you have notice I am literally using the same keys for questions and transformed. How can I condense the two and make them more reusable?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 5448461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef66bc6d987a9f3d65c0b99e7fbc5252?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Goel", "link": "https://stackoverflow.com/users/5448461/nikhil-goel"}, "is_accepted": false, "score": 0, "last_activity_date": 1527158597, "creation_date": 1527158597, "answer_id": 50507313, "question_id": 50497428, "link": "https://stackoverflow.com/questions/50497428/how-to-eager-load-has-one-associations-on-sti-subclass/50507313#50507313", "title": "How to eager-load has_one associations on STI subclass", "body": "<p>Looks like a typical typo error, as the error states.</p>\n\n<p><code>has_one</code> must have the class association name as <strong>singular</strong>.</p>\n\n<p>Try:</p>\n\n<pre><code>class HelloActivity &lt; Activity\n  has_one :hello_activity_detail\nend\n\nclass WorldActivity &lt; Activity\n  has_one :world_activity_detail\nend\n</code></pre>\n"}], "owner": {"reputation": 6279, "user_id": 412556, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/669395788/picture?type=large", "display_name": "MEURSAULT", "link": "https://stackoverflow.com/users/412556/meursault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527158597, "creation_date": 1527109440, "question_id": 50497428, "link": "https://stackoverflow.com/questions/50497428/how-to-eager-load-has-one-associations-on-sti-subclass", "title": "How to eager-load has_one associations on STI subclass", "body": "<p>I have a model hierarchy like this:</p>\n\n<pre><code>class Activity\nend\n\nclass HelloActivity &lt; Activity\n  has_one :hello_activity_details\nend\n\nclass WorldActivity &lt; Activity\n  has_one :world_activity_details\nend\n</code></pre>\n\n<p>I want to query all activities and eager load the details to avoid the N+1 issue. However, doing:</p>\n\n<pre><code>Activity.all.include([:hello_activity_details, :world_activity_details])\n</code></pre>\n\n<p>Yields</p>\n\n<pre><code>Association named 'hello_activity_details' not found on WorldActivity; perhaps you misspelled it?\n</code></pre>\n\n<p>How can I load the details?</p>\n\n<p>I know I can invoke the preloader manually, but is there a more idiomatic way.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["mysql", "ruby", "escaping", "gsub", "single-quotes"], "comments": [{"owner": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 0, "creation_date": 1527109370, "post_id": 50497165, "comment_id": 88007715, "body": "What do you want your output string to be?"}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1527114249, "post_id": 50498212, "comment_id": 88009489, "body": "But if you must use string operations, at least use <code>@client.escape</code> rather than attempting to do it by hand with <code>String#gsub</code> so you&#39;ll get it right."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1527119641, "post_id": 50498212, "comment_id": 88010842, "body": "@muistooshort Emphasis on <i>if</i> and <i>must</i>, but yes, that!"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 6, "last_activity_date": 1527113482, "creation_date": 1527113482, "answer_id": 50498212, "question_id": 50497165, "link": "https://stackoverflow.com/questions/50497165/escaping-in-ruby-string-without-escaping-for-inserting-to-mysql/50498212#50498212", "title": "Escaping &#39; in Ruby string, without escaping \\ for inserting to MySQL", "body": "<p>When inserting into a database, like MySQL, it's important to use <strong>prepared statements with placeholder values</strong>. I've put that in bold because it's extra super important to understand. All it takes is one little slip and you've created a <a href=\"http://bobby-tables.com/\" rel=\"noreferrer\">SQL injection hole</a> anyone can exploit and these can be extremely damaging.</p>\n\n<p>Escaping a string might seem superficially simple, but it's not. There's a lot of quirky edge cases you'll need to cover off, the details of which are too complicated to mention here in a short answer.</p>\n\n<p>The simple solution is to not bother escaping at all, instead write queries of this form:</p>\n\n<pre><code>INSERT INTO table_name (column_name) VALUES (?)\n</code></pre>\n\n<p>Where the <code>?</code> represents the data you're inserting. You can use these with, for example, the <a href=\"https://github.com/brianmario/mysql2\" rel=\"noreferrer\"><code>mysql2</code> driver</a> like this:</p>\n\n<pre><code>stmt = @client.prepare(\"INSERT INTO table_name (column_name) VALUES (?)\")\nstmt.execute(\"Henry's string\")\n</code></pre>\n\n<p>Where that driver will take care of properly encoding the values so you don't have to worry about it.</p>\n\n<p>You can also use something like <a href=\"http://sequel.rubyforge.org\" rel=\"noreferrer\">Sequel</a> or <a href=\"http://guides.rubyonrails.org/active_record_querying.html\" rel=\"noreferrer\">ActiveRecord</a> that simplify things even further.</p>\n"}], "owner": {"reputation": 31, "user_id": 4123049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d517cbef3b1de1ec11fb88bf9baca2f5?s=128&d=identicon&r=PG&f=1", "display_name": "Katherine", "link": "https://stackoverflow.com/users/4123049/katherine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527113482, "creation_date": 1527108167, "last_edit_date": 1527109343, "question_id": 50497165, "link": "https://stackoverflow.com/questions/50497165/escaping-in-ruby-string-without-escaping-for-inserting-to-mysql", "title": "Escaping &#39; in Ruby string, without escaping \\ for inserting to MySQL", "body": "<p>I have a string in Ruby of the form: <code>\"Henry's string\"</code></p>\n\n<p>Every <code>gsub</code> and <code>tr</code> I've tried gives me forms like <code>\"Henry\\\\'s string\"</code>, <code>\"Henry\\\\\\\\'s string\"</code>, etc.</p>\n\n<p>These are all escaping the backslashes, but leaving me with an unescaped single quote.</p>\n\n<p>I've tried:</p>\n\n<ul>\n<li><p><code>\"Henry's string\".gsub(\"'\",\"\\\\\\\\'\")</code> with varying numbers of \\</p></li>\n<li><p><code>\"Henry's string\".gsub(/'/) {|x| \"\\\\\\\\#{x}\"}</code> again with varying numbers of \\</p></li>\n<li><p><code>\"Henry's string\".gsub(/'/) {|x| \"\\\\#{x}\"}.gsub(/\\\\/) {|x| \"#{x}\"}</code></p></li>\n</ul>\n\n<p>I think I need an odd number of <code>\\</code> to fully escape the ' (in order to load to MySQL) but I cannot figure out how to get this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "timezone", "tzinfo"], "comments": [{"owner": {"reputation": 23287, "user_id": 5981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab183bb240ffd3a3966d5a615b4bdeb?s=128&d=identicon&r=PG", "display_name": "Phil Ross", "link": "https://stackoverflow.com/users/5981/phil-ross"}, "edited": false, "score": 2, "creation_date": 1527357158, "post_id": 50496540, "comment_id": 88102071, "body": "The IANA Time Zone Database (and therefore TZInfo) time zone for the entire of India is Asia/Kolkata. Using Etc fixed offset zones is generally not a good idea because they don&#39;t reflect daylight savings (although not currently a problem for India) and won&#39;t adjust following political changes. Do you actually need to add a new time zone, or would mapping to the Asia/Kolkata zone be preferable?"}], "owner": {"reputation": 6433, "user_id": 1064917, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/219d10e3fc486c3173291954195d537c?s=128&d=identicon&r=PG", "display_name": "Rick", "link": "https://stackoverflow.com/users/1064917/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527105565, "creation_date": 1527105565, "question_id": 50496540, "link": "https://stackoverflow.com/questions/50496540/add-custom-timezone-to-tzinfotimezone", "title": "Add custom Timezone to `TZInfo::Timezone`", "body": "<p>My Rails application validates timezones (and finds offsets) by using the list of timezone names in <code>TZInfo::Timezone.all_identifiers</code>.</p>\n\n<p>I am able to pull up timezones that have an <code>:00</code> GMT offset without problems:</p>\n\n<pre><code>irb(main):008:0&gt; TZInfo::Timezone.get(\"Etc/GMT+1\")\n=&gt; #&lt;TZInfo::DataTimezone: Etc/GMT+1&gt;\n</code></pre>\n\n<p>But when attempting to pull up <code>Etc/</code> timezones with a <code>:30</code> offset, I receive the following runtime exception:</p>\n\n<pre><code>irb(main):012:0&gt; TZInfo::Timezone.get(\"Etc/GMT+5:30\")\nTraceback (most recent call last):\n        1: from (irb):12\nTZInfo::InvalidTimezoneIdentifier (Invalid identifier)\n</code></pre>\n\n<p>I am specifically looking for <code>Indian/Delhi</code> or <code>Etc/GMT+5:30</code>.</p>\n\n<p><strong>How do I add a custom timezone name / offset to the list of sources in the <code>tzinfo</code> gem?</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1527114806, "post_id": 50494898, "comment_id": 88009635, "body": "Have a look at: <a href=\"https://stackoverflow.com/a/4471202/3982562\">stackoverflow.com/a/4471202/3982562</a>. In particular the &quot;Method Wrapping&quot; section."}], "answers": [{"comments": [{"owner": {"reputation": 9224, "user_id": 801058, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f6b75e25a5cc42698204a58eca97c5ae?s=128&d=identicon&r=PG", "display_name": "leemour", "link": "https://stackoverflow.com/users/801058/leemour"}, "edited": false, "score": 0, "creation_date": 1527106696, "post_id": 50495120, "comment_id": 88006362, "body": "Thanks, that works. However, I&#39;d also like to know how to define methods after the module is included so instead of a hack with <code>url_helpers</code> I&#39;d have a common solution. Could you help?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1527110987, "post_id": 50495120, "comment_id": 88008365, "body": "Use <code>public_send</code> with url_helpers too, for consistency."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 9224, "user_id": 801058, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f6b75e25a5cc42698204a58eca97c5ae?s=128&d=identicon&r=PG", "display_name": "leemour", "link": "https://stackoverflow.com/users/801058/leemour"}, "edited": false, "score": 0, "creation_date": 1527111179, "post_id": 50495120, "comment_id": 88008430, "body": "@leemour: FWIW, I consider <i>your</i> way to be the hacky one here. &#175;\\_(\u30c4)_/&#175; Usage of url_helpers is common outside of controller context  (say models or something like that)."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 9224, "user_id": 801058, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f6b75e25a5cc42698204a58eca97c5ae?s=128&d=identicon&r=PG", "display_name": "leemour", "link": "https://stackoverflow.com/users/801058/leemour"}, "edited": false, "score": 0, "creation_date": 1527111500, "post_id": 50495120, "comment_id": 88008548, "body": "@leemour: I myself haven&#39;t tried this, but I have a good feeling that if you monkeypatch the url helpers object (in an initializer or something), you&#39;ll achieve what you want."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1527119019, "post_id": 50495120, "comment_id": 88010710, "body": "Also send the args too as right now they are being dropped so things like  <code>business_path(@business)</code> will fail."}], "tags": [], "owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "is_accepted": true, "score": 3, "last_activity_date": 1527172392, "last_edit_date": 1527172392, "creation_date": 1527100048, "answer_id": 50495120, "question_id": 50494898, "link": "https://stackoverflow.com/questions/50494898/overriding-path-helpers-in-rails-using-define-method/50495120#50495120", "title": "Overriding path helpers in Rails using define_method", "body": "<p>Instead of trying to use <code>Kernel.method</code>, have you tried using the <code>Rails.application.routes.url_helpers</code> method?</p>\n\n<pre><code>%i[...].each do |path_method|\n  define_method(\"#{path_method}_path\") do |*args|\n    if params[:city_id] == 2\n      public_send(\"moscow_#{path_method}_path\", *args)\n    else\n      Rails.application.routes.url_helpers.public_send(\"#{path_method}_path\", *arsg)\n    end\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9224, "user_id": 801058, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f6b75e25a5cc42698204a58eca97c5ae?s=128&d=identicon&r=PG", "display_name": "leemour", "link": "https://stackoverflow.com/users/801058/leemour"}, "edited": false, "score": 0, "creation_date": 1527105740, "post_id": 50496415, "comment_id": 88005908, "body": "I have path helpers all over the project, so replacing them isn&#39;t a desirable solution"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 9224, "user_id": 801058, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f6b75e25a5cc42698204a58eca97c5ae?s=128&d=identicon&r=PG", "display_name": "leemour", "link": "https://stackoverflow.com/users/801058/leemour"}, "edited": false, "score": 0, "creation_date": 1527108862, "post_id": 50496415, "comment_id": 88007457, "body": "@leemour very well I added a new implementation in addition"}, {"owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "edited": false, "score": 1, "creation_date": 1527115576, "post_id": 50496415, "comment_id": 88009845, "body": "All things equal, this is the approach I would take too. Much cleaner."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 2, "last_activity_date": 1527109279, "last_edit_date": 1527109279, "creation_date": 1527105045, "answer_id": 50496415, "question_id": 50494898, "link": "https://stackoverflow.com/questions/50494898/overriding-path-helpers-in-rails-using-define-method/50496415#50496415", "title": "Overriding path helpers in Rails using define_method", "body": "<p>You could just wrap all your calls too</p>\n\n<pre><code>def path_name_for(path_name,*args) \n  path = \"#{path_name}_path\"\n  path.prepend(\"moscow_\") if params[:city] == 2\n  public_send(path,*args)\nend \n</code></pre>\n\n<p>Then in your views simply call </p>\n\n<pre><code>&lt;%= link_to 'Business Path', path_name_for(:business, @business) %&gt;\n</code></pre>\n\n<p>This makes the routing a bit clearer to me as it makes it a bit more obvious that there is a custom implementation rather than overriding a known implementation.</p>\n\n<p>Also this too might be a possibility (Although untested this should function like your existing code in \"path_helper.rb\")</p>\n\n<pre><code>module PathHelper\n  module MoscowRedirect\n    def self.prepended(base) \n      %i[...].each do |path_name|\n        define_method(\"#{path_name}_path\") do |*args|\n          params[:city] == 2 ? public_send(\"moscow_#{__method__}\",*args) : super(*args)\n        end\n      end\n    end\n  end\n  self.prepend(MoscowRedirect)\nend \n</code></pre>\n"}], "owner": {"reputation": 9224, "user_id": 801058, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f6b75e25a5cc42698204a58eca97c5ae?s=128&d=identicon&r=PG", "display_name": "leemour", "link": "https://stackoverflow.com/users/801058/leemour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 50495120, "answer_count": 2, "score": 2, "last_activity_date": 1527172392, "creation_date": 1527099256, "question_id": 50494898, "link": "https://stackoverflow.com/questions/50494898/overriding-path-helpers-in-rails-using-define-method", "title": "Overriding path helpers in Rails using define_method", "body": "<p>I need to override quite a few path helper methods in Ruby on Rails and call super from them. My standard approach would be:<br>\n<strong>path_helper.rb</strong></p>\n\n<pre><code>def business_path(business)\n  if params[:city_id] == 2\n    moscow_business_path(business)\n  else\n    super\n  end\nend\n</code></pre>\n\n<p>But I have a lot of these methods, so I want to define them dynamically like this:</p>\n\n<pre><code>  %i[root businesses business ...].each do |path_method|\n    method_name = \"#{path_method}_path\"\n    old_method = method(method_name)\n    define_method(method_name) do |*args|\n      if params[:city_id] == 2\n        public_send(\"moscow_#{method_name}\")\n      else\n        old_method.call(*args)\n      end\n    end\n  end\n</code></pre>\n\n<p>But I get this error:</p>\n\n<pre><code> /home/leemour/Ruby/burobiz/app/helpers/path_helper.rb:31:in `method': undefined method `root_path' for class `Module' (NameError) \n from /home/leemour/Ruby/burobiz/app/helpers/path_helper.rb:31:in `block in &lt;module:PathHelper&gt;'\n from /home/leemour/Ruby/burobiz/app/helpers/path_helper.rb:29:in `each' \n from /home/leemour/Ruby/burobiz/app/helpers/path_helper.rb:29:in `&lt;module:PathHelper&gt;' \n from /home/leemour/Ruby/burobiz/app/helpers/path_helper.rb:1:in `&lt;top (required)&gt;' \n from /home/leemour/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.3/lib/active_support/dependencies.rb:476:in `load'\n</code></pre>\n\n<p>I guess helper modules haven't been included yet, so there is no original path helper method to capture with <code>method(method_name)</code>. Then I guess I'd have to use <code>self.included</code> hook but I couldn't figure it. How can I adjust this code to make it work? (I don't want to use eval).</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 1, "creation_date": 1527099427, "post_id": 50494857, "comment_id": 88002666, "body": "Just run in rails console <code>User.last.activate</code>."}, {"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1527100125, "post_id": 50494857, "comment_id": 88003027, "body": "Small technicality.  You don&#39;t need to receive an email - you need to have the link, which is <i>in</i> the email.  The email is likely being written to a log (or there are other options to view outbound emails).  You could get the URL from that if you want the glorious experience of activating your users.  Or you could follow Vasilisa&#39;s suggestion above. :)"}, {"owner": {"reputation": 467, "user_id": 5323216, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206553142180222/picture?type=large", "display_name": "Aly Dabbous", "link": "https://stackoverflow.com/users/5323216/aly-dabbous"}, "edited": false, "score": 0, "creation_date": 1527162619, "post_id": 50494857, "comment_id": 88029157, "body": "Thanks alot for your prompt response."}], "answers": [{"tags": [], "owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "is_accepted": true, "score": 1, "last_activity_date": 1527102253, "creation_date": 1527102253, "answer_id": 50495720, "question_id": 50494857, "link": "https://stackoverflow.com/questions/50494857/sending-and-receiving-activation-emails-ruby-on-rails-tutorial-by-michael-hart/50495720#50495720", "title": "sending and receiving activation emails - ruby on rails tutorial by michael hartl", "body": "<p>Yeah...sending emails from dev environment is often not straightforward. As Vasilisa comments above, the quickest fix for your need is to activate the user from the rails console...perhaps like this:</p>\n\n<pre><code>% bundle exec rails console\nmy-app(development)&gt; User.last.activate\n</code></pre>\n\n<p>However, there will be other times when you actually want to see the email in the context of a mail client. For this, <a href=\"https://mailcatcher.me/\" rel=\"nofollow noreferrer\">https://mailcatcher.me/</a> makes it super easy. Just install the mailcatcher gem -- not in your app's Gemfile, but on your local machine's ruby installation.</p>\n\n<p>Then, change the host and port in <code>app/config/development.rb</code> (NOT in other environemnts, like prod!)</p>\n\n<pre><code>config.action_mailer.smtp_settings = {\n  # For use with Mailcatcher: https://mailcatcher.me/\n  address: '127.0.0.1',\n  port: 1025\n}\n</code></pre>\n\n<p>Run <code>mailcatcher</code> once from a command prompt. </p>\n\n<p>Then, do your thing in your app to trigger an email send, and open <code>http://127.0.0.1:1080/</code> in your browser. Voila, you see your email like it was really sent.  </p>\n\n<p>This a super-easy, super-useful way to see real emails without setting up your local env to actually send emails. </p>\n"}], "owner": {"reputation": 467, "user_id": 5323216, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206553142180222/picture?type=large", "display_name": "Aly Dabbous", "link": "https://stackoverflow.com/users/5323216/aly-dabbous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 50495720, "answer_count": 1, "score": 0, "last_activity_date": 1527106239, "creation_date": 1527099107, "last_edit_date": 1592644375, "question_id": 50494857, "link": "https://stackoverflow.com/questions/50494857/sending-and-receiving-activation-emails-ruby-on-rails-tutorial-by-michael-hart", "title": "sending and receiving activation emails - ruby on rails tutorial by michael hartl", "body": "<p>I recently started following Hartl's Ruby on Rails <a href=\"https://www.railstutorial.org/\" rel=\"nofollow noreferrer\">tutorial</a>.</p>\n<p>I downloaded the existing <code>sample_app_reference</code> app from <a href=\"https://bitbucket.org/railstutorial/sample_app_4th_ed/src/0b9194fe8dc8/app/mailers/application_mailer.rb?at=master\" rel=\"nofollow noreferrer\">bitbucket</a>.</p>\n<p>My goal is not to start and learn everything from scratch but rather to add new features to the already existing app.</p>\n<p>The issue is that I can't test the features I'm adding since I can't activate my account locally. In order to activate my account, I need to receive an activation email (which I'm not). I've searched the web for hours, but couldn't find anything regarding the issue. Did anyone try this tutorial before and encountered the same problem? Any help would be much appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1527099421, "post_id": 50494849, "comment_id": 88002661, "body": "Have you included <code>:status</code> in the permitted parameters in your controller?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9700954"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1527099747, "post_id": 50494849, "comment_id": 88002829, "body": "for the status field I want to make it a dropdown and want it pending for user and only admin can change it to approved or declined."}], "answers": [{"tags": [], "owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "is_accepted": true, "score": 1, "last_activity_date": 1527101426, "creation_date": 1527101426, "answer_id": 50495495, "question_id": 50494849, "link": "https://stackoverflow.com/questions/50494849/data-not-getting-stored-in-table-rails/50495495#50495495", "title": "Data not getting stored in table rails", "body": "<p>it seems that the problem you have is not with the table itself. you just forget to add :status to your permitted parameters.</p>\n\n<p>maybe you have something like this in your controller</p>\n\n<pre><code>private\n  def funding_params\n    params.require(:funding).permit(:describe_activity, :type_of_activity..., :status)\n  end\n</code></pre>\n\n<p>just add :status there to be permitted</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9700954"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 50495495, "answer_count": 1, "score": 0, "last_activity_date": 1527101426, "creation_date": 1527099070, "question_id": 50494849, "link": "https://stackoverflow.com/questions/50494849/data-not-getting-stored-in-table-rails", "title": "Data not getting stored in table rails", "body": "<p>I have generated a migration to add a status field in fundings table by using rails generate migration add_status_to_fundings. migration file gets created and in it, I have added\n<strong>add_column :fundings, :status, :string</strong>\nThen <strong>rails db:migrate</strong>\nin schema <strong>status</strong> gets added to the funding table. but whatever data I enter in status it doesn't get stored in the funding table. neither the data display in show.html.erb file. kindly help.</p>\n\n<p>_form.html.erb</p>\n\n<pre><code>&lt;div class = \"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= form.label :status %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.text_field :status %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt; \n      &lt;div class=\"form-group\"&gt;\n        &lt;div class=\"col-sm-10\"&gt;\n          &lt;%= form.submit \"Apply\", class: 'btn btn-primary btn-lg' %&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>show.html.erb</p>\n\n<pre><code>&lt;p&gt;&lt;strong&gt;Status: &lt;/strong&gt;&lt;%= @funding.status %&gt;&lt;/p&gt;&lt;br&gt;\n</code></pre>\n\n<p>migrationfile</p>\n\n<pre><code>class AddStatusToFundings &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_column :fundings, :status, :string\n  end\nend\n</code></pre>\n\n<p>rails console</p>\n\n<pre><code>&lt;Funding id: 1, describe_activity: \"10 players in each team\", type_of_activity: \"Cricket\", season: \"Fall\", activity_details: \"best outdoor games \", name_of_organisation: \"BCCI\", activity_start_date: \"2018-12-12\", number_of_weeks: \"6\", days_per_week: \"6\", hours_per_day: \"6\", program_registration_cost: 100, family_contribution: \"10\", other_funds: 20, other_fund_provider: \"Arni\", amount_requested: 70, created_at: \"2018-05-23 17:56:03\", updated_at: \"2018-05-23 17:56:03\", child_id: 1, status: nil&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1527098285, "post_id": 50494607, "comment_id": 88002150, "body": "What a silly error... :/ I was searching for puts, but was adamant it was <code>WEBrick</code> xD. Thanks for the spot :)"}], "tags": [], "owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "is_accepted": true, "score": 0, "last_activity_date": 1527098041, "creation_date": 1527098041, "answer_id": 50494607, "question_id": 50494341, "link": "https://stackoverflow.com/questions/50494341/io-select-prints-data/50494607#50494607", "title": "IO.select prints data?", "body": "<p>I find, at times like this, it's useful to search for <code>puts</code>.</p>\n\n<p>Your <code>puts</code>ing the request path <a href=\"https://github.com/sancarn/RubyConsole/blob/master/Console.rb#L127\" rel=\"nofollow noreferrer\">https://github.com/sancarn/RubyConsole/blob/master/Console.rb#L127</a></p>\n\n<p>The request path is <code>/</code>.</p>\n"}], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 50494607, "answer_count": 1, "score": 0, "last_activity_date": 1527098041, "creation_date": 1527096911, "question_id": 50494341, "link": "https://stackoverflow.com/questions/50494341/io-select-prints-data", "title": "IO.select prints data?", "body": "<p>I've been trying to silence WEBrick's server as I want to stop data going directly to the log file.</p>\n\n<p>Looking through the server.rb I added <code>puts \"before\"</code> and <code>puts \"after</code> to the following code at line 98:</p>\n\n<pre><code>        puts \"before\"\n        if svrs = IO.select(@listeners, nil, nil, 2.0)\n          puts \"after\"\n</code></pre>\n\n<p>When running the ruby script I get the following in my log:</p>\n\n<pre><code>before\n/\nafter\n</code></pre>\n\n<p>Why is <code>/</code> being logged to the server? Is this just being logged in a different thread or is <code>svrs = IO.select(@listeners, nil, nil, 2.0)</code> really printing a <code>/</code> to the stdout?</p>\n\n<p>The full code (if needed) can be found in <a href=\"https://github.com/sancarn/RubyConsole\" rel=\"nofollow noreferrer\">Console.rb</a></p>\n"}, {"tags": ["ruby", "rubygems", "cocoapods"], "answers": [{"comments": [{"owner": {"reputation": 6902, "user_id": 1523603, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Tbb5R.png?s=128&g=1", "display_name": "StuartM", "link": "https://stackoverflow.com/users/1523603/stuartm"}, "edited": false, "score": 0, "creation_date": 1527111027, "post_id": 50496140, "comment_id": 88008382, "body": "thank you! I would have never worked that out. I did have to gem install match after as well."}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 1, "last_activity_date": 1527105460, "last_edit_date": 1527105460, "creation_date": 1527103824, "answer_id": 50496140, "question_id": 50494261, "link": "https://stackoverflow.com/questions/50494261/unable-to-run-gem-command-match-init/50496140#50496140", "title": "Unable to run gem command: match init", "body": "<p>It looks like <code>match</code> is installed system-wide on your computer (perhaps done previously, before you installed RVM). The shell is picking it up from <code>/usr/local/bin</code> instead of from your RVM installation. </p>\n\n<p>Not sure why the path of RVM is not before <code>/usr/local/bin</code>, but a quick fix is to rename the file <code>match</code> in <code>/usr/local/bin</code> to something else, and then try again:</p>\n\n<pre><code>sudo mv /usr/local/bin/match /usr/local/bin/match_old\nhash -r\n</code></pre>\n\n<p>Now your shell should pick up <code>match</code> from your RVM installation instead (provided you've installed that gem under RVM).</p>\n"}], "owner": {"reputation": 6902, "user_id": 1523603, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Tbb5R.png?s=128&g=1", "display_name": "StuartM", "link": "https://stackoverflow.com/users/1523603/stuartm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 50496140, "answer_count": 1, "score": 0, "last_activity_date": 1527105460, "creation_date": 1527096693, "question_id": 50494261, "link": "https://stackoverflow.com/questions/50494261/unable-to-run-gem-command-match-init", "title": "Unable to run gem command: match init", "body": "<p>I am trying to run a gem called match. <a href=\"https://codesigning.guide/\" rel=\"nofollow noreferrer\">https://codesigning.guide/</a></p>\n\n<pre><code>match init\n</code></pre>\n\n<p>When this runs the following is returned:</p>\n\n<pre><code>-bash: /usr/local/bin/match: /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby: bad interpreter: No such file or directory\n</code></pre>\n\n<p>I have seen other related posts but those do not resolve my issue: <a href=\"https://stackoverflow.com/questions/44396215/cocoapods-not-working-in-macos-high-sierra/46484926\">CocoaPods not working in macOS High Sierra</a></p>\n\n<p>It seems something somewhere is pointing toward Ruby 2.0, but that is not the current version in use.</p>\n\n<p>ruby -v</p>\n\n<pre><code>ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-darwin17]\n</code></pre>\n\n<p>rvm -v</p>\n\n<pre><code>rvm 1.27.0 (latest) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\n</code></pre>\n\n<p>If I got to the path: /System/Library/Frameworks/Ruby.framework/Versions/ -- this has a folder 2.3 and Current.</p>\n\n<p>I am not familiar with gems/ruby/rvm so unsure where to check.</p>\n"}, {"tags": ["ruby", "url"], "answers": [{"tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": true, "score": 3, "last_activity_date": 1527096698, "creation_date": 1527096698, "answer_id": 50494267, "question_id": 50493389, "link": "https://stackoverflow.com/questions/50493389/after-loading-a-url-by-open-uri-how-to-handle-the-generated-tempfile-object/50494267#50494267", "title": "After loading a url by open-uri, how to handle the generated Tempfile object?", "body": "<ol>\n<li>The original filename is only really available in the URL. Just take <code>uri.path.split(\"/\").last</code>.</li>\n<li>Tempfiles are effective Files, with the distinction that when it is garbage collected, the underlying file is deleted.</li>\n<li>You can copy the underlying file with <code>FileUtils.copy</code>, or you can open the Tempfile, read it, and write it into a new File handle of your choosing.</li>\n<li><p>Something like this should work:</p>\n\n<pre><code>def download_url_to(url, base_path)\n  uri = URI(url)\n  filename = uri.path.split(\"/\").last\n  new_file = File.join(base_path, filename)\n  response = uri.open\n  open(new_file, \"wb\") {|fp| fp.puts response.read }\n  return new_file\nend\n</code></pre></li>\n</ol>\n\n<p>It's worth noting that if the file is less than 10kb, you'll get a StringIO object rather than a Tempfile object. The above solution handles both cases. This also just accepts whatever the last part of the path parameter is - it's going to be up to you to sanitize it, as well as the contents of the file itself; you don't want to permit clients to download arbitrary files to your system, in most cases. For example, you may want to be extra sure that the filename doesn't include paths like <code>..\\\\..\\\\..\"</code>which may be used to write files to non-intended locations.</p>\n"}], "owner": {"reputation": 363, "user_id": 7534274, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/n9TCm.jpg?s=128&g=1", "display_name": "Xullnn", "link": "https://stackoverflow.com/users/7534274/xullnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 50494267, "answer_count": 1, "score": 1, "last_activity_date": 1527132479, "creation_date": 1527093287, "last_edit_date": 1527132479, "question_id": 50493389, "link": "https://stackoverflow.com/questions/50493389/after-loading-a-url-by-open-uri-how-to-handle-the-generated-tempfile-object", "title": "After loading a url by open-uri, how to handle the generated Tempfile object?", "body": "<p>I wanna figure out how to download images from internet then store them locally.\nHere's what I did:</p>\n\n<pre><code>require 'open-uri' # =&gt; true\n\nfile = open \"https://s3-ap-southeast-1.amazonaws.com/xxx/Snip20180323_40.png\"\n# =&gt; #&lt;Tempfile:/var/folders/k0/.../T/open-uri20180524-60756-1r44uix&gt;\n</code></pre>\n\n<p>Then I was confused about this <code>Tempfile</code> object. I found I can get the original url by:</p>\n\n<pre><code>file.base_uri\n# =&gt; #&lt;URI::HTTPS https://s3-ap-southeast-1.amazonaws.com/xxx/Snip20180323_40.png&gt;\n</code></pre>\n\n<p>But I failed in finding a method that can directly get the original file name <code>Snip20180323_40.png</code>.</p>\n\n<ol>\n<li>Is there a method that can directly get the original file name from a <code>Tempfile</code> object?</li>\n<li>What purpose are <code>Tempfile</code> objects mainly used for? Are they different from normal file objects such as: <code>file_object = File.open('how_old.rb') # =&gt; #&lt;File:how_old.rb&gt;</code>?</li>\n<li>Can I convert a <code>Tempfile</code> object to a <code>File</code> object?</li>\n<li>How can I write this <code>Tempfile</code> as the same name file in a local directory, for example <code>/users/user_name/images/Snip20180323_40.png</code>?</li>\n</ol>\n"}, {"tags": ["ruby", "regex", "gsub"], "answers": [{"comments": [{"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1527092837, "post_id": 50493228, "comment_id": 87999425, "body": "Making <code>names_seen</code> a Hash or Set would be slightly more efficient, but with a short list, it doesn&#39;t really matter, so Array is simpler."}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1527092710, "creation_date": 1527092710, "answer_id": 50493228, "question_id": 50492954, "link": "https://stackoverflow.com/questions/50492954/ruby-replacing-only-the-first-occurrence-of-multiple-regexes-passed-as-a-hash/50493228#50493228", "title": "Ruby replacing only the first occurrence of multiple regexes passed as a hash", "body": "<p>One option would be to call <code>sub</code> separately for each name in sequence.</p>\n\n<p>Alternatively, you can use the block form of <code>gsub</code> to keep track of which names you've already highlighted:</p>\n\n<pre><code>names_seen = []\nregex = Regexp.union([\"Lebron James\", \"Chris Paul\"])\n\nstr = ..\nstr.gsub(regex) do |name|\n  if names_seen.include?(name)\n    name # not the first; replace with itself\n  else\n    names_seen &lt;&lt; name # remember\n    \"**#{name}**\" # or use `names_hash[name]` if needed\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1527094150, "post_id": 50493275, "comment_id": 88000122, "body": "Exquisitely! Like."}, {"owner": {"reputation": 552, "user_id": 3123551, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KNo5S.jpg?s=128&g=1", "display_name": "fhbi", "link": "https://stackoverflow.com/users/3123551/fhbi"}, "edited": false, "score": 0, "creation_date": 1527095953, "post_id": 50493275, "comment_id": 88001022, "body": "Thanks this answers it perfectly, simple and easy to understand. However a quick extension on the original question, how could <code>str.gsub(regex) { |name| names_hash.delete(name) || name }</code> be written to support multiple <code>str</code>s? If I pass another string to the gsub, it won&#39;t replace anything in the second string."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 552, "user_id": 3123551, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KNo5S.jpg?s=128&g=1", "display_name": "fhbi", "link": "https://stackoverflow.com/users/3123551/fhbi"}, "edited": false, "score": 0, "creation_date": 1527097927, "post_id": 50493275, "comment_id": 88001967, "body": "@FrankBi That&#39;s because the <code>names_hash</code> variable loses it&#39;s key/value pair after a match. Like the answer stated: &quot;Note that this approach mutates the original names_hash - so you may need to dup it beforehand if the variable is needed later on.&quot; This means you&#39;ll have to duplicate the hash beforehand. Something like this will do: <code>names_hash.dup.yield_self { |names_hash| str.gsub(regex) { |name| names_hash.delete(name) || name } }</code> (<i>Object#yield_self</i> is introduced in Ruby 2.5.0). Alternatively you can just create a new variable beforehand and use that instead."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1527098283, "post_id": 50493275, "comment_id": 88002148, "body": "@JohanWentholt <code>Object#tap</code> was introduced in Ruby 1.0 and it works pretty fine here."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1527098445, "post_id": 50493275, "comment_id": 88002214, "body": "@mudasobwa That doesn&#39;t return the string as result."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1527098534, "post_id": 50493275, "comment_id": 88002259, "body": "@JohanWentholt sure it does (with <code>break</code>): <code>names_hash.dup.tap { |names_hash| break str.gsub(regex) { |name| names_hash.delete(name) || name } }</code>."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1527099284, "post_id": 50493275, "comment_id": 88002600, "body": "@mudasobwa You got me there. I&#39;ll often forget you can jump out of blocks with <code>break</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1527100996, "post_id": 50493275, "comment_id": 88003491, "body": "Good one, Tom!. I would like to see word breaks (<code>\\b</code>) in the regex, however, to avoid matching, for example, &quot;Chris Pauly&quot;. This applies to all answers, of course."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1527103275, "post_id": 50493275, "comment_id": 88004663, "body": "Sure @CarySwoveland, I agree there are some edge cases that the regex does not account for - but I considered that beyond the scope of the question :) For example, the simple <code>.join(&quot;|&quot;)</code> approach above would not escape any special characters (use <code>Regexp.escape</code> if needed), or maybe you&#39;ll also need to highlight abbreviations like &quot;L James&quot;... Who knows! But given the input/output provided, this is sufficient."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1527127099, "post_id": 50493275, "comment_id": 88012355, "body": "You could alternative write <code>regex.default_proc = -&gt;(_,k) { k }</code> and then remove <code>|| name</code> from the block."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 4, "last_activity_date": 1527092879, "creation_date": 1527092879, "answer_id": 50493275, "question_id": 50492954, "link": "https://stackoverflow.com/questions/50492954/ruby-replacing-only-the-first-occurrence-of-multiple-regexes-passed-as-a-hash/50493275#50493275", "title": "Ruby replacing only the first occurrence of multiple regexes passed as a hash", "body": "<p>How about:</p>\n\n<pre><code>regex = Regexp.new([\"Lebron James\", \"Chris Paul\"].join(\"|\"))\nnames_hash = {\"Lebron James\" =&gt; \"**Lebron James**\", \"Chris Paul\" =&gt; \"**Chris Paul**\"}\nstr = \"of the best players left in the playoffs, Lebron James is the most experienced player left in the field and probably in all of the league. Chris Paul has played in many playoff games but has never been to a conference final. Lebron James on the other hand, has been to seven straight NBA finals.\"\n\n\nstr.gsub(regex) { |name| names_hash.delete(name) || name }\n</code></pre>\n\n<p>This will read from the <code>names_hash</code> only for the first replacement; after that, the <code>gsub</code> will \"default\" to making no alteration.</p>\n\n<p>Note that this approach mutates the original <code>names_hash</code> - so you may need to <code>dup</code> it beforehand if the variable is needed later on.</p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1527098141, "post_id": 50494429, "comment_id": 88002073, "body": "Neat. The <code>map</code>/<code>zip</code> seems to be an overkill here, since one might just <code>names.inject(str) { |str, name| str.sub(name, &quot;**#{name}**&quot;) }</code>."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1527099515, "last_edit_date": 1527099515, "creation_date": 1527097279, "answer_id": 50494429, "question_id": 50492954, "link": "https://stackoverflow.com/questions/50492954/ruby-replacing-only-the-first-occurrence-of-multiple-regexes-passed-as-a-hash/50494429#50494429", "title": "Ruby replacing only the first occurrence of multiple regexes passed as a hash", "body": "<p>Although <a href=\"https://stackoverflow.com/a/50493275/3982562\">Tom Lords answer</a> is good, I want to show you a different way of solving your issue. My solution involves calling <a href=\"https://ruby-doc.org/core-2.5.1/String.html#method-i-sub\" rel=\"nofollow noreferrer\"><em>String#sub</em></a> as many times as you have names.</p>\n\n<pre><code>str = 'of the best players left in the playoffs, Lebron James is the most experienced player left in the field and probably in all of the league. Chris Paul has played in many playoff games but has never been to a conference final. Lebron James on the other hand, has been to seven straight NBA finals.'\nnames = ['Lebron James', 'Chris Paul']\n</code></pre>\n\n<p><strong>original answer</strong></p>\n\n<pre><code>replacements = names.map { |name| \"**#{name}**\" }\nreplacements = names.zip(replacements)\n\nreplacements.inject(str) { |str, args| str.sub(*args) }\n</code></pre>\n\n<p>As <a href=\"https://stackoverflow.com/questions/50492954/ruby-replacing-only-the-first-occurrence-of-multiple-regexes-passed-as-a-hash/50494429#comment88002073_50494429\">mudasobwa pointed out in the comments</a>, the <em>#map</em> / <em>#zip</em> might be overkill. You could just run the following instead:</p>\n\n<pre><code>names.inject(str) { |str, name| str.sub(name, \"**#{name}**\") }\n</code></pre>\n\n<p><strong>returns</strong></p>\n\n<blockquote>\n  <p>\"of the best players left in the playoffs, <strong>Lebron James</strong> is the most experienced player left in the field and probably in all of the league. <strong>Chris Paul</strong> has played in many playoff games but has never been to a conference final. Lebron James on the other hand, has been to seven straight NBA finals.\"</p>\n</blockquote>\n\n<p><strong>references</strong></p>\n\n<ul>\n<li><a href=\"https://ruby-doc.org/core-2.5.1/Array.html#method-i-map\" rel=\"nofollow noreferrer\"><em>Array#map</em></a></li>\n<li><a href=\"https://ruby-doc.org/core-2.5.1/Array.html#method-i-zip\" rel=\"nofollow noreferrer\"><em>Array#zip</em></a></li>\n<li><a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-inject\" rel=\"nofollow noreferrer\"><em>Enumerable#inject</em></a></li>\n</ul>\n"}], "owner": {"reputation": 552, "user_id": 3123551, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KNo5S.jpg?s=128&g=1", "display_name": "fhbi", "link": "https://stackoverflow.com/users/3123551/fhbi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 50493275, "answer_count": 3, "score": 4, "last_activity_date": 1527099515, "creation_date": 1527091645, "question_id": 50492954, "link": "https://stackoverflow.com/questions/50492954/ruby-replacing-only-the-first-occurrence-of-multiple-regexes-passed-as-a-hash", "title": "Ruby replacing only the first occurrence of multiple regexes passed as a hash", "body": "<p>I have a paragraph of text and want to only Ruby <code>sub</code> the first regex match of the word. This would be fine if I only had to match one string, but I'm passing multiple regexes into my sub:</p>\n\n<pre><code>regex = Regexp.new([\"Lebron James\", \"Chris Paul\"].join(\"|\"))\nnames_hash = {\"Lebron James\" =&gt; \"**Lebron James**\", \"Chris Paul\" =&gt; \"**Chris Paul**\"}\n\nstr = \"of the best players left in the playoffs, Lebron James is the most experienced player left in the field and probably in all of the league. Chris Paul has played in many playoff games but has never been to a conference final. Lebron James on the other hand, has been to seven straight NBA finals.\"\n</code></pre>\n\n<p>If I run <code>str.gsub(regex, names_hash)</code>, all instances of Lebron James and Chris Paul get replaced to:</p>\n\n<blockquote>\n  <p>\"of the best players left in the playoffs, <strong>Lebron James</strong> is the most\n  experienced player left in the field and probably in all of the\n  league. <strong>Chris Paul</strong> has played in many playoff games but has never\n  been to a conference final. <strong>Lebron James</strong> on the other hand, has been\n  to seven straight NBA finals.\"</p>\n</blockquote>\n\n<p>And if I run <code>str.sub(regex, names_hash)</code> (sub instead of gsub), I get only the first occurrence of Lebron James, but not Chris Paul:</p>\n\n<blockquote>\n  <p>\"of the best players left in the playoffs, <strong>Lebron James</strong> is the most\n  experienced player left in the field and probably in all of the\n  league. Chris Paul has played in many playoff games but has never been\n  to a conference final. Lebron James on the other hand, has been to\n  seven straight NBA finals.\"</p>\n</blockquote>\n\n<p>My question:</p>\n\n<p>How do I set up what I have so that I can replace both the first instance of Lebron James and Chris Paul, but not the second reference of Lebron James? My expected result:</p>\n\n<blockquote>\n  <p>\"of the best players left in the playoffs, <strong>Lebron James</strong> is the most\n  experienced player left in the field and probably in all of the\n  league. <strong>Chris Paul</strong> has played in many playoff games but has never been\n  to a conference final. Lebron James on the other hand, has been to\n  seven straight NBA finals.\"</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "foreign-keys"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1527089344, "post_id": 50492152, "comment_id": 87997324, "body": "please post the errors you&#39;re getting in your logs"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1527090634, "post_id": 50492152, "comment_id": 87998208, "body": "There&#39;s a clash here: <code>has_many :activities;   has_many :activities, through: :user_activities</code>. You&#39;re defining the <code>activities</code> relation twice. Try renaming the first of these (you&#39;ll need to specify the <code>class_name</code>) and stick to using the <code>through</code> line. If you&#39;re only meant to be using a <code>has_many through</code> relationship, you can remove this entirely."}, {"owner": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1527145992, "post_id": 50492152, "comment_id": 88018582, "body": "I have make the change, but i can&#39;t add or edit one activity :/"}], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1527155708, "post_id": 50505401, "comment_id": 88024600, "body": "Hi, thanks i just posted new answer bellow , because i can&#39;t edit my post to makes the changes :/ (sorry if i make somes inglish mistakes)"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1527163552, "post_id": 50505401, "comment_id": 88029797, "body": "Thanks @BenjaminBarb&#233; - looks like you&#39;re heading in the right direction. Your new trace suggests you&#39;re having a problem saving the <code>activity</code>, which is likely down to the validations or data passed to the controller. I&#39;d suggest opening a new question specifically relating to this (feel free to @ me below it and I&#39;ll help as I can) and -- if you think this has helped -- give it a tick as answering this one :)"}, {"owner": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 1, "creation_date": 1527176000, "post_id": 50505401, "comment_id": 88038722, "body": "Alright Thanks : there the new post :)  <a href=\"https://stackoverflow.com/questions/50513153/rails-having-a-error-when-i-add-one-activity-in-my-db\" title=\"rails having a error when i add one activity in my db\">stackoverflow.com/questions/50513153/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 0, "last_activity_date": 1527153957, "last_edit_date": 1527153957, "creation_date": 1527153159, "answer_id": 50505401, "question_id": 50492152, "link": "https://stackoverflow.com/questions/50492152/rails-cant-anymore-add-article-in-my-db-after-making-somes-changes-fk/50505401#50505401", "title": "RAILS Can&#39;t anymore add article in my db after making somes changes (fk)", "body": "<p>To expand on my comment, you're defining the relationship between users and activities twice, which will cause a problem, here:</p>\n\n<pre><code># user.rb\nhas_many :activities\n\n# activity.rb\nbelongs_to :user\n</code></pre>\n\n<p>And:</p>\n\n<pre><code># user.rb\nhas_many :user_activities\nhas_many :activities, through: :user_activities\n\n# activity.rb\nhas_many :user_activities, dependent: :destroy\nhas_many :users, through: :user_activities\n</code></pre>\n\n<p>This means there's a clash when calling <code>user.activities</code> as there are two differing associations it's looking at: a <code>has_many - belongs to</code> to and a <code>has_many through</code>. The former is one to many, the latter many to many.</p>\n\n<p>That's not to say this is bad practice, just that you need to ensure the naming doesn't clash. I'm not sure of the nature of the relationship and what you're looking to achieve, but something like the following would resolve this:</p>\n\n<pre><code># user.rb\nhas_many :created_activities, class_name: 'Activity'\n\nhas_many :user_activities\nhas_many :activities, through: :user_activities\n\n# activity.rb\nhas_many :user_activities, dependent: :destroy\nhas_many :users, through: :user_activities\n\nbelongs_to :master_user, class_name: 'User'\n</code></pre>\n\n<p>This updates your code to do allow you to call the following:</p>\n\n<pre><code>user.created_activities # has_many\nuser.activities # has_many through\n\nactivity.master_user # belongs_to\nactivity.users #\u00a0has_many through\n</code></pre>\n\n<p>Obviously you can name the associations differently, and also rename the <code>has_many through</code> relationship if it adds clarity.</p>\n\n<p><a href=\"http://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">The docs</a> here are a little weighty, but well worth spending the time to understand - there are also other options such as <code>foreign_key</code> if your column names differ from the conventions.</p>\n\n<p>Hope that helps - give me a shout if you've any questions :)</p>\n"}], "owner": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 50505401, "answer_count": 1, "score": 1, "last_activity_date": 1527155736, "creation_date": 1527089137, "last_edit_date": 1527153250, "question_id": 50492152, "link": "https://stackoverflow.com/questions/50492152/rails-cant-anymore-add-article-in-my-db-after-making-somes-changes-fk", "title": "RAILS Can&#39;t anymore add article in my db after making somes changes (fk)", "body": "<p>When creating a user_activities table, I added some  foreign keys, since I can not create any more activities and rails do not give me errors,\nhere is my code</p>\n\n<p>form:</p>\n\n<pre><code>  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.input :title, label: \"Titre (optionnel)\", class: \"form-control\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :content, 'Contenu (requis)' %&gt;\n    &lt;%= f.text_area :content, id: \"wysiwyg\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.input :group_id, prompt: \"- Choisir un groupe (requis) -\", label: false, collection: current_user.groups.order('name') %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.button :submit, @activity.new_record? ? \"Cr\u00e9er l'activit\u00e9\" : \"Mettre \u00e0 jour l'activit\u00e9\", class: \"btn btn-outline-primary btn-sm\" %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>Activities controller</p>\n\n<pre><code>  def create\n    @activity = Activity.new(activity_params)\n    @activity.user = current_user\n    if @activity.save\n      flash[:notice] = \"Votre activit\u00e9 a \u00e9t\u00e9 cr\u00e9\u00e9e !\"\n      redirect_to root_path\n    else\n      flash[:alert] = \"Erreur lors la cr\u00e9ation\"\n      redirect_to root_path\n    end\n  end\n\n  def activity_params\n    params.require(:activity).permit(:content, :title, :group_id)\n  end\n</code></pre>\n\n<p>models :</p>\n\n<pre><code># useractivity\n  belongs_to :activity\n  belongs_to :user\n  validates :user, uniqueness: { scope: :activity }\n# user\n  has_many :user_activities\n  has_many :activities\n  has_many :activities, through: :user_activities\n# Activity\n  has_many :user_activities, dependent: :destroy\n  belongs_to :category\n  has_many :users, through: :user_activities\n  belongs_to :user\n  validates :content, presence: true\n</code></pre>\n\n<p>Trace:</p>\n\n<pre><code>Started POST \"/activities\" for 127.0.0.1 at 2018-05-24 09:38:18 +0200\nProcessing by ActivitiesController#create as JS\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"j1AMcsR16eBMf+6nTO9NN17NE7Qhz0DS07hu+w1YtYopYcwaRbQw6ThkCK3RQ0wY5MqNxM7Fe9VXezSHAZgUnw==\", \"activity\"=&gt;{\"title\"=&gt;\"TESTTITLE\", \"content\"=&gt;\"&lt;p&gt;TESTCONTENT&lt;/p&gt;\", \"group_id\"=&gt;\"1\"}, \"commit\"=&gt;\"Cr\u00e9er l'activit\u00e9\"}\n  User Load (2.9ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 2], [\"LIMIT\", 1]]\n  \u21b3 /home/benjamin/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/activerecord-5.2.0.rc1/lib/active_record/log_subscriber.rb:98\n   (4.1ms)  BEGIN\n  \u21b3 app/controllers/activities_controller.rb:9\n  Group Load (0.5ms)  SELECT  \"groups\".* FROM \"groups\" WHERE \"groups\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/activities_controller.rb:9\n   (0.2ms)  ROLLBACK\n  \u21b3 app/controllers/activities_controller.rb:9\nRedirected to http://localhost:3000/\nCompleted 200 OK in 22ms (ActiveRecord: 8.0ms)\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>  def create\n    @activity = Activity.new(activity_params)\n    @activity.user = current_user\n       #line 9 ----&gt;\n    if @activity.save\n      flash[:notice] = \"Votre activit\u00e9 a \u00e9t\u00e9 cr\u00e9\u00e9e !\"\n      redirect_to root_path\n    else\n      flash[:alert] = \"Erreur lors la cr\u00e9ation\"\n      redirect_to root_path\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby", "gtk", "markup", "pango", "ruby-gnome2"], "comments": [{"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1528906404, "post_id": 50492102, "comment_id": 88687209, "body": "Gtk is not HTML. You need to check what all system fonts are available, if what you want is their use it or else choose another. You can use Electron if prettiness is top priority."}], "answers": [{"tags": [], "owner": {"reputation": 1896, "user_id": 4226702, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-siukF5ObSUs/AAAAAAAAAAI/AAAAAAAAAEc/Qww5nEqBNDw/photo.jpg?sz=128", "display_name": "Alexander Dmitriev", "link": "https://stackoverflow.com/users/4226702/alexander-dmitriev"}, "is_accepted": false, "score": 0, "last_activity_date": 1527429394, "creation_date": 1527429394, "answer_id": 50552850, "question_id": 50492102, "link": "https://stackoverflow.com/questions/50492102/specifying-fallback-fonts-with-pango-markup-for-gtk-application/50552850#50552850", "title": "Specifying fallback fonts with Pango markup for Gtk application", "body": "<p>AFAIK there is no way to specify multiple fonts. You can obtain a list of all available fonts (<a href=\"https://www.lemoda.net/pango/list-fonts/index.html\" rel=\"nofollow noreferrer\">that's how it's done in C</a>) and then iterate over that list, finding the one that fits best. </p>\n"}], "owner": {"reputation": 953, "user_id": 2733453, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1108602033/picture?type=large", "display_name": "Rahul Vijay Dawda", "link": "https://stackoverflow.com/users/2733453/rahul-vijay-dawda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527429394, "creation_date": 1527088987, "question_id": 50492102, "link": "https://stackoverflow.com/questions/50492102/specifying-fallback-fonts-with-pango-markup-for-gtk-application", "title": "Specifying fallback fonts with Pango markup for Gtk application", "body": "<p>I am developing a dialog for my application using Ruby Gtk and have a requirement of displaying the text on the dialog in the <em>Open Sans</em> font. I have used Pango markup below to achieve this and seems to work as expected on my system.</p>\n\n<pre><code>&lt;span font_family=\\\"Open Sans\\\" foreground=\\\"black\\\" size=\\\"x-small\\\" weight=\\\"bold\\\"&gt;#{value}&lt;/span&gt;\n</code></pre>\n\n<p>To make it work though, I also had to manually install the <em>Open Sans</em> font onto my system. Without doing so, I was seeing the following warning in the application log file.</p>\n\n<pre><code>Pango-WARNING **:couldn't load font \"Open Sans Bold Not-Rotated 10\", falling back to \"Sans Bold Not-Rotated 10\", expect ugly output.\n</code></pre>\n\n<p>I know it is possible to specify multiple fonts in case of HTML in descending order of preference as a fallback in case a certain font doesn't exist and such a logic would be acceptable in my case. But I can't seem to find an example on the internet. Is it even possible to specify multiple fonts with Pango markup? If so, how? If not, is there any other way around this warning other than installing the font?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9435, "user_id": 2626000, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/j8GY0.jpg?s=128&g=1", "display_name": "Aaron Christiansen", "link": "https://stackoverflow.com/users/2626000/aaron-christiansen"}, "edited": false, "score": 0, "creation_date": 1527087459, "post_id": 50491591, "comment_id": 87996075, "body": "Please show us the code you&#39;d tried for updating the hash keys."}, {"owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "reply_to_user": {"reputation": 9435, "user_id": 2626000, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/j8GY0.jpg?s=128&g=1", "display_name": "Aaron Christiansen", "link": "https://stackoverflow.com/users/2626000/aaron-christiansen"}, "edited": false, "score": 0, "creation_date": 1527087774, "post_id": 50491591, "comment_id": 87996292, "body": "@AaronChristiansen updated the question, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "edited": false, "score": 0, "creation_date": 1527087917, "post_id": 50491754, "comment_id": 87996404, "body": "Thank you! I&#39;m gonna accept the answer as soon as I can =)"}, {"owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "edited": false, "score": 0, "creation_date": 1527088657, "post_id": 50491754, "comment_id": 87996880, "body": "Thanks for the warning! But in my case that&#39;s not gonna happen"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 7, "last_activity_date": 1527087940, "last_edit_date": 1527087940, "creation_date": 1527087872, "answer_id": 50491754, "question_id": 50491591, "link": "https://stackoverflow.com/questions/50491591/ruby-update-hash-keys-to-strip-whitespaces/50491754#50491754", "title": "Ruby - update hash keys to strip whitespaces", "body": "<p>Keys in the hashes are frozen (as the error message says,) and hence they cannot be modified <em>inplace</em>. The new hash must be constructed with new keys:</p>\n\n<pre><code>{\"my hash key\" =&gt; 12}.map { |k, v| [k.delete(' '), v] }.to_h\n#\u21d2 {\"myhashkey\"=&gt;12}\n</code></pre>\n\n<p><strong>NB!</strong> there is a pitfall: you might lose some values!</p>\n\n<pre><code>{\"a b c\" =&gt; 42, \"abc\" =&gt; :foo}.\n  map { |k, v| [k.delete(' '), v] }.to_h\n#\u21d2\u00a0{\"abc\"=&gt;:foo}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1527106965, "post_id": 50491823, "comment_id": 88006492, "body": "I&#39;ve wondered if you&#39;d ever change your avatar. I don&#39;t recall the grey hair."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1527108368, "post_id": 50491823, "comment_id": 88007203, "body": "Holy Moly!! +1 to @CarySwoveland"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1527141054, "post_id": 50491823, "comment_id": 88016028, "body": "@CarySwoveland only once in a blue moon ;-)"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 5, "last_activity_date": 1527088083, "creation_date": 1527088083, "answer_id": 50491823, "question_id": 50491591, "link": "https://stackoverflow.com/questions/50491591/ruby-update-hash-keys-to-strip-whitespaces/50491823#50491823", "title": "Ruby - update hash keys to strip whitespaces", "body": "<p>You could use <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-transform_keys\" rel=\"noreferrer\"><code>transform_keys</code></a>:</p>\n\n<pre><code>my_hash = { 'my hash key': 12 }\n#=&gt; {:\"my hash key\"=&gt;12}\n\nmy_hash.transform_keys { |k| k.to_s.delete(' ').to_sym }\n#=&gt; {:myhashkey=&gt;12}\n</code></pre>\n\n<p>The <code>to_s</code> / <code>to_sym</code> conversion is needed because <code>Symbol</code> doesn't implement <code>delete</code>. You can omit it if your keys are actually strings:</p>\n\n<pre><code>my_hash = { 'my hash key' =&gt; 12 }\n#=&gt; {:\"my hash key\"=&gt;12}\n\nmy_hash.transform_keys { |k| k.delete(' ') }\n#=&gt; {:myhashkey=&gt;12}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "is_accepted": false, "score": 2, "last_activity_date": 1527088701, "last_edit_date": 1527088701, "creation_date": 1527088319, "answer_id": 50491898, "question_id": 50491591, "link": "https://stackoverflow.com/questions/50491591/ruby-update-hash-keys-to-strip-whitespaces/50491898#50491898", "title": "Ruby - update hash keys to strip whitespaces", "body": "<p>Try the following:</p>\n\n<pre><code>h = { \"my hash key\": 12 }\nh.map {|key, value| [key.to_s.delete(' '), value] }.to_h\n</code></pre>\n\n<p>Basically, you map your hash to a new array where you strip all white spaces (that's what the <code>key.to_s.delete(' ')</code> does), and you convert it back to a hash with <code>.to_h</code> :)</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Just saw @stephen's answer, which uses <code>transform_keys</code>, a much simpler method which was introduced in Ruby 2.5.</p>\n\n<p>However I'm still gonna leave my answer up, in case anyone using a previous version of Ruby stumbles upon this</p>\n"}], "owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 0, "accepted_answer_id": 50491754, "answer_count": 3, "score": 2, "last_activity_date": 1527088701, "creation_date": 1527087409, "last_edit_date": 1527087538, "question_id": 50491591, "link": "https://stackoverflow.com/questions/50491591/ruby-update-hash-keys-to-strip-whitespaces", "title": "Ruby - update hash keys to strip whitespaces", "body": "<p>I would like to strip whitespaces from my hash, so if I have</p>\n\n<pre><code>{\"my hash key\": 12}\n</code></pre>\n\n<p>I would like to get</p>\n\n<pre><code>{\"myhashkey\": 12}\n</code></pre>\n\n<p>I have found some ways to strip from the values, but got a problem to do that on keys. When I tried</p>\n\n<pre><code> my_hash.each_key{|k| k.gsub!(' ', '')}\n</code></pre>\n\n<p>I got the error:</p>\n\n<pre><code>RuntimeError: can't modify frozen String\n</code></pre>\n\n<p>and if use only gsub (without '!') it runs fine, but doesn't work.</p>\n\n<p>So what's the best way to achieve that? Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 974, "user_id": 3057947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e732340579ce5625b1f2c96f8a20fcd8?s=128&d=identicon&r=PG", "display_name": "Biwek", "link": "https://stackoverflow.com/users/3057947/biwek"}, "edited": false, "score": 1, "creation_date": 1527090802, "post_id": 50492170, "comment_id": 87998305, "body": "@Navroop glad it helped. could you tick the answer to approve it. thanks :)"}], "tags": [], "owner": {"reputation": 974, "user_id": 3057947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e732340579ce5625b1f2c96f8a20fcd8?s=128&d=identicon&r=PG", "display_name": "Biwek", "link": "https://stackoverflow.com/users/3057947/biwek"}, "is_accepted": true, "score": 1, "last_activity_date": 1527089183, "creation_date": 1527089183, "answer_id": 50492170, "question_id": 50491590, "link": "https://stackoverflow.com/questions/50491590/display-full-application-when-i-click-on-view-this-application/50492170#50492170", "title": "Display full application when I click on View this application", "body": "<p>If I understand correctly, did you mean to do:</p>\n\n<pre><code>&lt;%= link_to \"View this application\", funding, class: \"btn btn-primary btn-2x\" %&gt;\n</code></pre>\n\n<p>You're currently doing <code>Funding.find(params[:id])</code>, which is basically the same funding id thats been passed in <code>fundings#show</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9700954"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 50492170, "answer_count": 1, "score": 0, "last_activity_date": 1527089183, "creation_date": 1527087408, "last_edit_date": 1527087717, "question_id": 50491590, "link": "https://stackoverflow.com/questions/50491590/display-full-application-when-i-click-on-view-this-application", "title": "Display full application when I click on View this application", "body": "<p>the problem I am facing is when I click on view this application it just opens the same application every time that is the first ID in the funding table. But there are other applications existing as well. If I click on any view this application the same application opens up every time that is first application in the funding table. please help.</p>\n\n<p>show.html.erb (children)</p>\n\n<pre><code>&lt;div class=\"col-sm-9 col-xs-12\"&gt;\n            &lt;div class=\"content\" role=\"main\" id=\"main-content\"&gt;\n              &lt;article&gt;\n                &lt;div &gt;&lt;h1 align=\"center\"&gt;&lt;%= @child.firstname %&gt;&lt;/h1&gt;\n                    &lt;hr&gt;\n&lt;p&gt;First Name: &lt;%= @child.firstname %&gt;&lt;/p&gt;\n&lt;p&gt;Last Name: &lt;%= @child.lastname %&gt;&lt;/p&gt;\n&lt;p&gt;Date of Birth:&lt;%= @child.dateofbirth %&gt;&lt;/p&gt;\n&lt;p&gt;Gender: &lt;%= @child.gender %&gt;&lt;/p&gt;\n\n\n&lt;p&gt;\n&lt;%= link_to \"Apply for funding\", new_funding_path, class: \"btn btn-primary btn-2x\" %&gt;\n\n&lt;%= link_to \"Edit the child\", edit_child_path(@child), class: \"btn btn-primary btn-2x\" %&gt;\n&lt;%= link_to \"Delete this child\", child_path(@child), method: :delete, data: {confirm: \"Are you sure you want to delete?\"}, class: \"btn btn-primary btn-2x\" %&gt;|\n&lt;%= link_to \"Add another child\", new_child_path, class: \"btn btn-primary btn-2x\" %&gt;&lt;/p&gt;\n&lt;hr&gt;\n**&lt;h1 align=\"center\"&gt;Applied&lt;/h1&gt;**\n&lt;% @child.fundings.each do |funding| %&gt;\n  &lt;p&gt;&lt;strong&gt;Status: &lt;/strong&gt; |\n    &lt;strong&gt;Type of Activity: &lt;/strong&gt;&lt;%= funding.type_of_activity %&gt; |\n    &lt;strong&gt;Start Date: &lt;/strong&gt;&lt;%= funding.activity_start_date %&gt;|\n    **&lt;%= link_to \"View this application\", Funding.find_by(params[:id]), class: \"btn btn-primary btn-2x\" %&gt;**\n\n&lt;/p&gt;\n\n&lt;% end %&gt;\n\n\n\n&lt;div class=\"clearfix\"&gt;&lt;/div&gt;&lt;/div&gt;           \n              &lt;/article&gt;\n            &lt;/div&gt;\n            &lt;!-- .content --&gt;\n          &lt;/div&gt;\n</code></pre>\n\n<p>fundings_controller.rb</p>\n\n<pre><code>class FundingsController &lt; ApplicationController\n\n    def index\n        @fundings=Funding.all\n    end\n\n    def show\n    @funding = Funding.find(params[:id])    \n    end\ndef new\n    @funding = Funding.new      \n    end\n\n    def create\n        @funding = Funding.new(funding_params)\n\n        puts child_user\n        @funding.child = Child.find(child_user.ids[0])\n            if @funding.save\n                flash[:success] = \"Thankyou for submitting\"\n                redirect_to funding_path(@funding)\n            else \n                render 'new'\n            end\n    end\n\n    def edit\n        @funding = Funding.find(params[:id])\n    end\n\n    def update  \n        @funding = Funding.find(params[:id])\n        if @funding.update(funding_params)\n            flash[:success] = \"Your application is updated successfully\"\n            redirect_to funding_path(@funding)\n        else\n            render 'edit'   \n        end \n    end\n\n    def destroy\n        @funding = Funding.find(params[:id])\n        @funding.destroy\n        flash[:danger] = \"Application was successfully cancelled\"\n        redirect_to child_path(@child) \n    end\n    private\n\n    def funding_params\n        params.require(:funding).permit(:describe_activity, :type_of_activity, :season, :activity_details, :name_of_organisation, :activity_start_date, :number_of_weeks, :days_per_week, :hours_per_day, :program_registration_cost, :family_contribution, :other_funds, :other_fund_provider, :amount_requested, organisations_attributes: Organisation.attribute_names.map(&amp;:to_sym).push(:_destroy))        \n    end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "user-accounts", "pundit", "clearance"], "comments": [{"owner": {"reputation": 1127, "user_id": 399940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52fbb830df79b0280d8d45826c202d5f?s=128&d=identicon&r=PG", "display_name": "emptywalls", "link": "https://stackoverflow.com/users/399940/emptywalls"}, "edited": false, "score": 0, "creation_date": 1527286160, "post_id": 50491575, "comment_id": 88086919, "body": "You mentioned devise_invitable, so you&#39;re probably familiar with Devise.  I&#39;ve done things similar to what you need using Devise + Pundit and Rolify. I believe the missing part you&#39;re looking for is going to be something for AUTHORIZATION. You&#39;ve got AUTHENTICATION using Clearance, so you know who they are, but you need a way to tell Pundit what they can DO. You&#39;re looking for something like Rolify or CanCan to provide the accounts with roles. If you&#39;re looking for a more well tread path, I would recommend Devise, devise_invitable, Pundit, and Rolify, but I&#39;m sure you can do the same thing."}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "reply_to_user": {"reputation": 1127, "user_id": 399940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52fbb830df79b0280d8d45826c202d5f?s=128&d=identicon&r=PG", "display_name": "emptywalls", "link": "https://stackoverflow.com/users/399940/emptywalls"}, "edited": false, "score": 0, "creation_date": 1527443934, "post_id": 50491575, "comment_id": 88120741, "body": "I&#39;d prefer to stick with Clearance and Pundit as they are much more lightweight than using Devise. Is what I&#39;m suggesting not a good idea? That seems like a simple way to implement it."}], "answers": [{"comments": [{"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1527450251, "post_id": 50555224, "comment_id": 88122521, "body": "Thanks this is exactly what I needed help with. Didn&#39;t think about using the before_filter. Also didn&#39;t think about abstracting the User.new into another controller that creates the &quot;Team Member&quot;. That was a helpful tip. Appreciate it!"}], "tags": [], "owner": {"reputation": 1321, "user_id": 2422068, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/608060c57e57d2a4989c6b82a8a1f289?s=128&d=identicon&r=PG", "display_name": "Kartikey Tanna", "link": "https://stackoverflow.com/users/2422068/kartikey-tanna"}, "is_accepted": true, "score": 6, "last_activity_date": 1527446027, "last_edit_date": 1527446027, "creation_date": 1527445501, "answer_id": 50555224, "question_id": 50491575, "link": "https://stackoverflow.com/questions/50491575/how-do-you-invite-another-user-to-a-team-or-account-or-project-with-cleara/50555224#50555224", "title": "How do you invite another user to a &quot;team&quot; or &quot;account&quot; or &quot;project&quot; with Clearance and Pundit?", "body": "<p>Your plan is good. There is no <a href=\"https://github.com/thoughtbot/clearance\" rel=\"noreferrer\">Clearance</a> or <a href=\"https://github.com/varvet/pundit\" rel=\"noreferrer\">Pundit</a> specific way to do it. Of course, your strategy seems fine and you will have to implement it using <a href=\"https://github.com/thoughtbot/clearance\" rel=\"noreferrer\">Clearance</a>.</p>\n\n<ol>\n<li><p>As far as I understand, you first want to create the user and then create the team for the user. So it would be better to user <code>after_*</code> callback from the available <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html\" rel=\"noreferrer\">callbacks</a>. <code>before_filter</code> hook is executed before the record is stored in the database. So for example, unless you have the user stored in the database you can not assign it them as Team Leader \"before\" the user is saved.</p></li>\n<li><p>If you want to use UUID instead of ID you can do something like <a href=\"https://blog.arkency.com/2014/10/how-to-start-using-uuid-in-activerecord-with-postgresql/\" rel=\"noreferrer\">this</a> or else you can simply use the <a href=\"http://guides.rubyonrails.org/active_record_validations.html#uniqueness\" rel=\"noreferrer\">unique constraint</a> on <code>name</code> column of <code>teams</code> table. The association you have mentioned seem fine.</p></li>\n<li><p>You can create a custom controller here which creates a User. Something like <code>app/controllers/team_members#create</code>. I don't think it is needed to be ducted-tape to <a href=\"https://github.com/thoughtbot/clearance\" rel=\"noreferrer\">Clearance</a>. The example code can be:</p></li>\n</ol>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def create\n  member = User.new(team_member_params)\n  if member.save\n    #some code\n  else\n    #some code\n  end\nend\n</code></pre>\n\n<ol start=\"4\">\n<li>I don't think it would be a good idea to use password-reset emails. You can send out new mailer using <code>after_create</code> hook.</li>\n</ol>\n\n<p><code>after_create :send_invitation_to_team_member, if: :not_team_leader</code></p>\n"}], "owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 50555224, "answer_count": 1, "score": 5, "last_activity_date": 1527446027, "creation_date": 1527087367, "last_edit_date": 1527443840, "question_id": 50491575, "link": "https://stackoverflow.com/questions/50491575/how-do-you-invite-another-user-to-a-team-or-account-or-project-with-cleara", "title": "How do you invite another user to a &quot;team&quot; or &quot;account&quot; or &quot;project&quot; with Clearance and Pundit?", "body": "<p>I have a Rails app with Clearance and Pundit and I'm trying to create \"teams\" where the \"Team Leader\" can invite other users to join their team. I would like to do <a href=\"https://stackoverflow.com/questions/34083334/how-to-invite-a-user-to-project-with-devise-invitable\">something similar</a> to <a href=\"https://github.com/scambra/devise_invitable\" rel=\"noreferrer\">devise_invitable</a>, but with Clearance. </p>\n\n<p>Here is my plan for how this might work:</p>\n\n<ol>\n<li><p>Users that sign up to the site through the signup form are automatically assigned a unique Team ID and become the \"Team Lead.\" They don't see this ID on the form. (Another way this could be done is they create a unique team name that is saved on sign up.) <em>Is the best way to do this to create a before_filter for assigning the team ID and Team Leader on sign up?</em> </p></li>\n<li><p>Team IDs or names would be unique and each User can only belong to one team. Association would look like this:</p>\n\n<p>Team </p>\n\n<pre><code>has_many :users\n</code></pre>\n\n<p>User </p>\n\n<pre><code>belongs_to :team\n</code></pre></li>\n<li><p>Once this \"Team Leader\" account is created, this user can invite other users to join the team by filling out a User#new form similar to the Clearance sign up form (name, email, etc.) This form would create the User and assign them to the Team Leader's team. They could be assigned a random password to give to <a href=\"https://github.com/thoughtbot/clearance\" rel=\"noreferrer\">Clearance</a> so that the new user passes the validation.</p></li>\n<li><p>Once a user has been created by the Team Leader they are saved in the database with the randomly generated password and a Mailer is sent to the invited user that is similar to the standard Clearance password reset Mailer. It just gives them a notification that they have been invited to the team and provides a link to reset their password and then log in. It's basically the Clearance password reset Mailer with different copy.</p></li>\n</ol>\n\n<p>Is this a decent strategy or is there a more widely used pattern I'm missing for solving this problem with <a href=\"https://github.com/thoughtbot/clearance\" rel=\"noreferrer\">Clearance</a> and <a href=\"https://github.com/varvet/pundit\" rel=\"noreferrer\">Pundit</a>? I've never done anything like this with Rails, so I have no idea if this is a ducted-tape way to use <a href=\"https://github.com/thoughtbot/clearance\" rel=\"noreferrer\">Clearance</a>.</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527084260, "post_id": 50490392, "comment_id": 87993741, "body": "What kind of objects do you have in your initial array? Strings or Time instances or something else?"}, {"owner": {"reputation": 109, "user_id": 9486016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-2e0nuSWKDGE/AAAAAAAAAAI/AAAAAAAAAIE/JYcps_nk_FY/photo.jpg?sz=128", "display_name": "No&#233;mie Harvey", "link": "https://stackoverflow.com/users/9486016/no%c3%a9mie-harvey"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527085316, "post_id": 50490392, "comment_id": 87994464, "body": "@Stefan Time instances !"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527085500, "post_id": 50490392, "comment_id": 87994596, "body": "And you want <code>string =&gt; [string, string]</code> pairs in your hash instead of maybe <code>date =&gt; [time, time]</code>?"}, {"owner": {"reputation": 109, "user_id": 9486016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-2e0nuSWKDGE/AAAAAAAAAAI/AAAAAAAAAIE/JYcps_nk_FY/photo.jpg?sz=128", "display_name": "No&#233;mie Harvey", "link": "https://stackoverflow.com/users/9486016/no%c3%a9mie-harvey"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527085560, "post_id": 50490392, "comment_id": 87994644, "body": "Actually, it doesn&#39;t matter. Both are okay"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1527113294, "post_id": 50490392, "comment_id": 88009199, "body": "No&#233;mie, your question states that you wish to return a hash whose keys and values are strings. Your comment above, which states that the hash could instead contain <code>Time</code> objects, causes two potential problems. The first is that it changes the question. Any change or clarification to a question should be done by editing the question, not by elaborating in comments, for the simple reason that not everyone reads all comments. Suppose, for example, an answer were posted which produced a hash whose values were <code>Time</code> objects. (cont.)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1527113358, "post_id": 50490392, "comment_id": 88009219, "body": "...A reader who had missed your comment might downvote that answer because it was inconsistent with what you asked for in the question. Also, it&#39;s obviously problematic to change a question after an answer has been posted. (cont.)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1527113417, "post_id": 50490392, "comment_id": 88009237, "body": "...The second problem is that by saying that the desired return value could be any of two or more Ruby objects (e.g., containing strings or <code>Time</code> objects), you may be making it difficult to compare answers. In general, if you ask for &quot;A or B&quot;, it could be that producing &quot;A&quot; is simple but deriving &quot;B&quot; is much more complex, even if &quot;A&quot; and &quot;B&quot; seem very similar. It&#39;s best to just ask for &quot;A&quot;. I know you&#39;re newish to SO, so please don&#39;t take my comments as a criticism."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 9486016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-2e0nuSWKDGE/AAAAAAAAAAI/AAAAAAAAAIE/JYcps_nk_FY/photo.jpg?sz=128", "display_name": "No&#233;mie Harvey", "link": "https://stackoverflow.com/users/9486016/no%c3%a9mie-harvey"}, "edited": false, "score": 0, "creation_date": 1527085411, "post_id": 50490468, "comment_id": 87994534, "body": "I have Time instances in my array, not Strings"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 109, "user_id": 9486016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-2e0nuSWKDGE/AAAAAAAAAAI/AAAAAAAAAIE/JYcps_nk_FY/photo.jpg?sz=128", "display_name": "No&#233;mie Harvey", "link": "https://stackoverflow.com/users/9486016/no%c3%a9mie-harvey"}, "edited": false, "score": 1, "creation_date": 1527086058, "post_id": 50490468, "comment_id": 87995042, "body": "@No&#233;mieHarvey the block simply returns the key for that item. Items with the same key end up in the same array. If you have time instances, you could use <code>group_by(&amp;:to_date)</code> and they will be grouped by their respective dates."}, {"owner": {"reputation": 109, "user_id": 9486016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-2e0nuSWKDGE/AAAAAAAAAAI/AAAAAAAAAIE/JYcps_nk_FY/photo.jpg?sz=128", "display_name": "No&#233;mie Harvey", "link": "https://stackoverflow.com/users/9486016/no%c3%a9mie-harvey"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527086196, "post_id": 50490468, "comment_id": 87995144, "body": "@Stefan thank you, that&#39;s exactly what I was looking for :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1527084272, "creation_date": 1527084272, "answer_id": 50490468, "question_id": 50490392, "link": "https://stackoverflow.com/questions/50490392/ruby-convert-array-to-hash/50490468#50490468", "title": "Ruby - Convert array to hash", "body": "<p>Use <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\"><code>Enumerable#group_by</code></a>:</p>\n\n<pre><code>input = ['2018-05-23 8:00:00', '2018-05-23 8:30:00',\n         '2018-05-23 9:30:00', '2018-05-24 15:00:00', '2018-05-24 15:30:00']\ninput.group_by { |e| DateTime.parse(e).to_date.to_s }\n#\u21d2 {\"2018-05-23\"=&gt;[\"2018-05-23 8:00:00\", \"2018-05-23 8:30:00\", \"2018-05-23 9:30:00\"],\n#   \"2018-05-24\"=&gt;[\"2018-05-24 15:00:00\", \"2018-05-24 15:30:00\"]}\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 9486016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-2e0nuSWKDGE/AAAAAAAAAAI/AAAAAAAAAIE/JYcps_nk_FY/photo.jpg?sz=128", "display_name": "No&#233;mie Harvey", "link": "https://stackoverflow.com/users/9486016/no%c3%a9mie-harvey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1527085453, "creation_date": 1527084104, "last_edit_date": 1527085453, "question_id": 50490392, "link": "https://stackoverflow.com/questions/50490392/ruby-convert-array-to-hash", "title": "Ruby - Convert array to hash", "body": "<p>I loop on this array (Time instances):</p>\n\n<p><code>[2018-05-23 8:00:00, 2018-05-23 8:30:00, 2018-05-23 9:30:00, 2018-05-24 15:00:00, 2018-05-24 15:30:00]</code> </p>\n\n<p>And I would like to convert it to a hash like this :</p>\n\n<p><code>{\"2018-05-23\"=&gt;[\"2018-05-23 8:00:00\", \"2018-05-23 8:30:00\"], \"2018-05-24\"=&gt;[]}</code></p>\n\n<p>Thanks !</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1527084068, "post_id": 50490264, "comment_id": 87993625, "body": "Some possibilities: 1) You&#39;ve updated Ruby without recompiling the gems? 2) OS updates running in the background updating system libraries?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1527089657, "post_id": 50490264, "comment_id": 87997541, "body": "Are you using a ruby version manager i.e. RVM or RBENV?  If not you may want to."}, {"owner": {"reputation": 628, "user_id": 4679332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-6A3_vIZehYw/AAAAAAAAAAI/AAAAAAAACI0/ExTSSO1w_l4/photo.jpg?sz=128", "display_name": "Christopher Warrington", "link": "https://stackoverflow.com/users/4679332/christopher-warrington"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1527097207, "post_id": 50490264, "comment_id": 88001630, "body": "@Casper, could be #2. But, would either of those cause this error so frequently?"}, {"owner": {"reputation": 628, "user_id": 4679332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-6A3_vIZehYw/AAAAAAAAAAI/AAAAAAAACI0/ExTSSO1w_l4/photo.jpg?sz=128", "display_name": "Christopher Warrington", "link": "https://stackoverflow.com/users/4679332/christopher-warrington"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1527097232, "post_id": 50490264, "comment_id": 88001644, "body": "@lacostenycoder, I do run RVM"}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1527098455, "post_id": 50490264, "comment_id": 88002219, "body": "You would need to save the exact error message. It should report which library linkages have become disconnected. Save the error message each time, and then look for a common pattern. This should start to give you a clue where the problem is coming from."}, {"owner": {"reputation": 628, "user_id": 4679332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-6A3_vIZehYw/AAAAAAAAAAI/AAAAAAAACI0/ExTSSO1w_l4/photo.jpg?sz=128", "display_name": "Christopher Warrington", "link": "https://stackoverflow.com/users/4679332/christopher-warrington"}, "edited": false, "score": 0, "creation_date": 1528172348, "post_id": 50490264, "comment_id": 88393450, "body": "Thank you, Casper. I am keeping track. It happened again. So, I am going to see if I can keep track as you suggested and find a pattern."}], "owner": {"reputation": 628, "user_id": 4679332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-6A3_vIZehYw/AAAAAAAAAAI/AAAAAAAACI0/ExTSSO1w_l4/photo.jpg?sz=128", "display_name": "Christopher Warrington", "link": "https://stackoverflow.com/users/4679332/christopher-warrington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527095284, "creation_date": 1527083750, "question_id": 50490264, "link": "https://stackoverflow.com/questions/50490264/ruby-gems-loosing-native-extensions", "title": "Ruby gems loosing native extensions", "body": "<p>I have been noticing a trend, but not a cause, over the past few months. Every few weeks when I go into a RoR project (not always the same project) and start up the server I receive an error that usually contains the phrase <code>'require': incompatible library version</code></p>\n\n<p>To fix it, I usually have to do <code>gem pristine</code> along with the gem name that was within the error line; for instance: </p>\n\n<pre><code>gem pristine nokogiri\n</code></pre>\n\n<p>This fixes the extensions; but, when trying to run the server again, the same error pops up with a different gem. The only way to fix it would be to run the code above on all gems like so: </p>\n\n<pre><code>gem pristine --all\n</code></pre>\n\n<p>This takes a long time, but faster than doing one at a time and it fixes the issue every time.</p>\n\n<p>This last time 25 different gems had to be restored. </p>\n\n<p><strong>Question</strong></p>\n\n<p>Here is my question. Is there a reason that any of you know for why this would be happening so often? Is there something that I am doing to cause these to become corrupted? Or maybe is there something that is happening on my machine the way it is setup to cause these extensions to continually get corrupted and have to be fixed? Any insight or thoughts would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 11, "creation_date": 1527081420, "post_id": 50489405, "comment_id": 87991701, "body": "<code>post.group_by(&amp;:topic_id)</code> is more idiomatic."}], "tags": [], "owner": {"reputation": 39, "user_id": 8138553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H157qx2xlSI/AAAAAAAAAAI/AAAAAAAAACU/vF_Dw33EIZc/photo.jpg?sz=128", "display_name": "Nijeesh K J", "link": "https://stackoverflow.com/users/8138553/nijeesh-k-j"}, "is_accepted": false, "score": 2, "last_activity_date": 1527084628, "last_edit_date": 1527084628, "creation_date": 1527081239, "answer_id": 50489405, "question_id": 50489319, "link": "https://stackoverflow.com/questions/50489319/how-to-group-ruby-array-based-on-id-in-the-hash/50489405#50489405", "title": "How to group ruby array based on id in the hash", "body": "<p>Found the answer.\nYou can do it using ruby's <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\"><code>Enumerable#group_by</code></a>:</p>\n\n<pre><code>post.group_by{|post| post.topic_id}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 346, "user_id": 3047808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7A17E.jpg?s=128&g=1", "display_name": "Pedro Fernandes", "link": "https://stackoverflow.com/users/3047808/pedro-fernandes"}, "is_accepted": true, "score": 2, "last_activity_date": 1527087688, "creation_date": 1527087688, "answer_id": 50491679, "question_id": 50489319, "link": "https://stackoverflow.com/questions/50489319/how-to-group-ruby-array-based-on-id-in-the-hash/50491679#50491679", "title": "How to group ruby array based on id in the hash", "body": "<p>Use this:</p>\n\n<pre><code>Post.all.group_by(&amp;:topic_id).each do |topic_id, posts|\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 8138553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H157qx2xlSI/AAAAAAAAAAI/AAAAAAAAACU/vF_Dw33EIZc/photo.jpg?sz=128", "display_name": "Nijeesh K J", "link": "https://stackoverflow.com/users/8138553/nijeesh-k-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 50491679, "answer_count": 2, "score": 1, "last_activity_date": 1527087688, "creation_date": 1527081035, "question_id": 50489319, "link": "https://stackoverflow.com/questions/50489319/how-to-group-ruby-array-based-on-id-in-the-hash", "title": "How to group ruby array based on id in the hash", "body": "<p>I have two models post and topic which has a one to many relation</p>\n\n<pre><code>#Post.rb\nclass Post &lt; ApplicationRecord\n  belongs_to :topic\n  validates :topic_id, presence: true\n  validates :title, presence: true\n  validates :body, presence: true\nend\n</code></pre>\n\n<p>if i have an array of posts by calling <code>Post.all</code> for example</p>\n\n<pre><code>    #&lt;ActiveRecord::Relation [#&lt;Post id: 1, title: \"Rails Code\", body: \"class TopicsController &lt; ApplicationController\\r\\n  ...\", created_at: \"2018-05-22 09:34:15\", updated_at: \"2018-05-22 09:34:15\", topic_id: \"2\"&gt;, \n#&lt;Post id: 2, title: \"Post with tags\", body: \"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq...\", created_at: \"2018-05-22 11:48:54\", updated_at: \"2018-05-22 11:48:54\", topic_id: \"2\"&gt;, \n#&lt;Post id: 3, title: \"12hello world12\", body: \"12312sdfsdfsdsdsdsd31231231231231\", created_at: \"2018-05-23 12:54:02\", updated_at: \"2018-05-23 12:54:02\", topic_id: \"2\"&gt;,\n #&lt;Post id: 4, title: \"12hello world12\", body: \"12312sdfsdfsdsdsdsd31231231231231\", created_at: \"2018-05-23 12:54:09\", updated_at: \"2018-05-23 12:54:09\", topic_id: \"1\"&gt;,\n #&lt;Post id: 5, title: \"12hellsdssdo world12\", body: \"12312sdfsdfsdsdsdsd31231231231231\", created_at: \"2018-05-23 12:54:15\", updated_at: \"2018-05-23 12:54:15\", topic_id: \"1\"&gt;]&gt;\n</code></pre>\n\n<p>is there a way i could group them by their <code>topic_id</code>  so i could display them topic by topic</p>\n\n<p>example </p>\n\n<pre><code>Topic - 1\npost 1    post2   post 3\nTopic -2\npost4   post5\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 691, "user_id": 4385342, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-ywHOrlzk5g4/AAAAAAAAAAI/AAAAAAAAB9Y/mO2q6r1jr60/photo.jpg?sz=128", "display_name": "a3y3", "link": "https://stackoverflow.com/users/4385342/a3y3"}, "edited": false, "score": 0, "creation_date": 1527078978, "post_id": 50488230, "comment_id": 87989971, "body": "You are submitting the token correctly, so maybe it&#39;s a browser fault? Try doing it in incognito perhaps."}], "answers": [{"comments": [{"owner": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "edited": false, "score": 1, "creation_date": 1527100012, "post_id": 50490638, "comment_id": 88002964, "body": "Thanks Amir, but I would like to know the real reason for it."}, {"owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "reply_to_user": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "edited": false, "score": 0, "creation_date": 1527163536, "post_id": 50490638, "comment_id": 88029780, "body": "You&#39;re welcome :), Check this out, it should help you <a href=\"https://www.bhalash.com/archives/13544808782\" rel=\"nofollow noreferrer\">bhalash.com/archives/13544808782</a>"}, {"owner": {"reputation": 399, "user_id": 2351224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xvi2F.jpg?s=128&g=1", "display_name": "ianrandmckenzie", "link": "https://stackoverflow.com/users/2351224/ianrandmckenzie"}, "edited": false, "score": 1, "creation_date": 1552539513, "post_id": 50490638, "comment_id": 97050219, "body": "This will create a big problem with security."}, {"owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "edited": false, "score": 0, "creation_date": 1552563442, "post_id": 50490638, "comment_id": 97062014, "body": "Exactly, that&#39;s why i said its not recommended, just a temp solution"}], "tags": [], "owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "is_accepted": false, "score": -1, "last_activity_date": 1527084770, "creation_date": 1527084770, "answer_id": 50490638, "question_id": 50488230, "link": "https://stackoverflow.com/questions/50488230/actioncontrollerinvalidauthenticitytoken-actioncontrollerinvalidauthenticit/50490638#50490638", "title": "ActionController::InvalidAuthenticityToken (ActionController::InvalidAuthenticityToken): Rails 5", "body": "<p>You can add this to the controller</p>\n\n<pre><code>skip_before_action :verify_authenticity_token\n</code></pre>\n\n<p>Of course it's not recommended to do this, but for some reason it solved my problems, since it happen on one form only on my whole application and it was safe to skip this auth.</p>\n"}], "owner": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 920, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527084770, "creation_date": 1527077914, "last_edit_date": 1527078400, "question_id": 50488230, "link": "https://stackoverflow.com/questions/50488230/actioncontrollerinvalidauthenticitytoken-actioncontrollerinvalidauthenticit", "title": "ActionController::InvalidAuthenticityToken (ActionController::InvalidAuthenticityToken): Rails 5", "body": "<p>Hi I have rails 5 application which is throwing following errors \n<code>Can't verify CSRF token authenticity.</code> <code>ActionController::InvalidAuthenticityToken</code> error when submitting a POST request for signin in staging environment. It's weird because form is working fine for Production and development environment. Here is the request param</p>\n\n<pre><code>{  \n   \"method\":\"POST\",\n   \"path\":\"/users/sign_in\",\n   \"format\":\"html\",\n   \"controller\":\"Users::SessionsController\",\n   \"action\":\"create\",\n   \"status\":422,\n   \"error\":\"ActionController::InvalidAuthenticityToken: ActionController::InvalidAuthenticityToken\",\n   \"duration\":11.53,\n   \"view\":0.0,\n   \"params\":{  \n      \"utf8\":\"\u2713\",\n      \"authenticity_token\":\"LDPxQ17rH9W/AoW1Hfeyd4in1Ms7snMuys6IyFIlB6K9JoCLanfjHg6OOcqlf/HkE9pPzEuOwVz3d29iwYaJbA==\",\n      \"user\":{  \n         \"email\":\"\",\n         \"password\":\"[FILTERED]\"\n      },\n      \"commit\":\"Login\"\n   },\n   \"@timestamp\":\"2018-05-23T12:08:26.463Z\",\n   \"@version\":\"1\",\n   \"message\":\"[422] POST /users/sign_in (Users::SessionsController#create)\"\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "filterrific"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1527079683, "post_id": 50488221, "comment_id": 87990491, "body": "Where is <i>your</i> <code>search_query</code> scope? Your question talks about a <code>locality</code> field, yet there&#39;s no mention of this in the code samples."}, {"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1527082671, "post_id": 50488221, "comment_id": 87992641, "body": "@TomLord Yes sorry I forgot to edit this part. You can now have a look at the <code>search_query</code> scope, which look in the <code>title</code> and <code>locality</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1527084208, "post_id": 50488221, "comment_id": 87993710, "body": "Have you looked at the generated SQL? (What is it?) Does this SQL match the record? (If not, why not?)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1527084318, "post_id": 50488221, "comment_id": 87993784, "body": "The easiest way to see the SQL is probably by just looking in <code>logs&#47;development.log</code>."}, {"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1527164260, "post_id": 50488221, "comment_id": 88030353, "body": "@TomLord I edit my post, with the SQL logs"}], "answers": [{"comments": [{"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 1, "creation_date": 1527177095, "post_id": 50509678, "comment_id": 88039438, "body": "Thank you Tom ! :D"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1527165479, "creation_date": 1527165479, "answer_id": 50509678, "question_id": 50488221, "link": "https://stackoverflow.com/questions/50488221/filterrific-how-to-search-query-with-multiple-words/50509678#50509678", "title": "filterrific : How to search query with multiple words?", "body": "<p>The problem can be seen from your SQL log:</p>\n\n<pre><code>...\nAND ((LOWER(title) LIKE 'new%' OR LOWER(locality) LIKE 'new%')\nAND (LOWER(title) LIKE 'york%' OR LOWER(locality) LIKE 'york%'))\n</code></pre>\n\n<p>The desired SQL <strong>should</strong> be:</p>\n\n<pre><code>...\nAND ((LOWER(title) LIKE '%new%' OR LOWER(locality) LIKE '%new%')\nAND (LOWER(title) LIKE '%york%' OR LOWER(locality) LIKE '%york%'))\n</code></pre>\n\n<p>Because \"new\" is at the <em>start</em> of the <code>locality</code>, it matched; but because \"york\" is not at the start, it did not match.</p>\n\n<p>To fix this, you could replace the line:</p>\n\n<pre><code>(e.gsub('*', '%') + '%').gsub(/%+/, '%')\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>('%' + e.gsub('*', '%') + '%').gsub(/%+/, '%')\n</code></pre>\n"}], "owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 50509678, "answer_count": 1, "score": 0, "last_activity_date": 1527165479, "creation_date": 1527077886, "last_edit_date": 1527164231, "question_id": 50488221, "link": "https://stackoverflow.com/questions/50488221/filterrific-how-to-search-query-with-multiple-words", "title": "filterrific : How to search query with multiple words?", "body": "<p>I'm using <code>filterrific</code> to make filter.</p>\n\n<p>Let suppose I get an object with the <code>locality</code> set to \"New York\".</p>\n\n<p>With the present code, it works if I search only with one word for example : \"New\". If I write \"New York\", nothing appears.</p>\n\n<p>In the <a href=\"http://filterrific-demo.herokuapp.com/students\" rel=\"nofollow noreferrer\">filterrific</a> example the filter allow user to write several words in \"query\".</p>\n\n<p><strong>model</strong></p>\n\n<pre><code>  scope :search_query, lambda { |query|\n  return nil  if query.blank?\n    terms = query.downcase.split(/\\s+/)\n    terms = terms.map { |e|\n      (e.gsub('*', '%') + '%').gsub(/%+/, '%')\n    }\n    num_or_conds = 2\n    where(\n      terms.map { |term|\n        \"(LOWER(title) LIKE ? OR LOWER(locality) LIKE ?)\"\n      }.join(' AND '),\n      *terms.map { |e| [e] * num_or_conds }.flatten\n    )\n  }\n\n\n\nfilterrific(\n   default_filter_params: {},\n   available_filters: [\n     :search_query\n   ]\n )\n</code></pre>\n\n<p><strong>controller</strong></p>\n\n<pre><code>def index\n   @filterrific = initialize_filterrific(\n     @ads,\n     params[:filterrific]\n   ) or return\n    @ads = @filterrific.find.page(params[:page])\nend\n</code></pre>\n\n<p><strong>view</strong></p>\n\n<pre><code>  = form_for_filterrific @filterrific do |f|\n    div\n      | Search\n      = f.text_field :search_query, class: 'skills field w-input filterrific-periodically-observed', placeholder: \"Job title, keywords, skills...\"\n\n      = f.submit 'GO !', {class: \"submit-b w-button\"}\n</code></pre>\n\n<p><strong><em>EDIT</em></strong></p>\n\n<p><strong>logs</strong></p>\n\n<pre><code> Ad Load (1.2ms)  SELECT  \"ads\".* FROM \"ads\" WHERE (publishing_at &lt;= '2018-05-24') AND (expiring_at &gt;= '2018-05-24') AND ((LOWER(title) LIKE 'new%' OR LOWER(locality) LIKE 'new%') AND (LOWER(title) LIKE 'york%' OR LOWER(locality) LIKE 'york%')) LIMIT $1 OFFSET $2  [[\"LIMIT\", 20], [\"OFFSET\", 0]]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 1, "creation_date": 1527077220, "post_id": 50487944, "comment_id": 87988731, "body": "<code>post.image.url(:thumb)</code>"}, {"owner": {"reputation": 13, "user_id": 9819794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WYMIX.jpg?s=128&g=1", "display_name": "derek2", "link": "https://stackoverflow.com/users/9819794/derek2"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1527077384, "post_id": 50487944, "comment_id": 87988828, "body": "@Gabbar I changed to this line               &lt;%= link_to image_tag(post.image.url(:thumb), width: 500, height: 250), post %&gt; but still have this: <a href=\"https://i.imgur.com/BQ7Eiaa.png\" rel=\"nofollow noreferrer\">i.imgur.com/BQ7Eiaa.png</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9819794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WYMIX.jpg?s=128&g=1", "display_name": "derek2", "link": "https://stackoverflow.com/users/9819794/derek2"}, "edited": false, "score": 0, "creation_date": 1527087909, "post_id": 50490715, "comment_id": 87996393, "body": "If you mean               &lt;%= link_to image_tag(post.image.thumb.url), post %&gt; its still not working :("}, {"owner": {"reputation": 13, "user_id": 9819794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WYMIX.jpg?s=128&g=1", "display_name": "derek2", "link": "https://stackoverflow.com/users/9819794/derek2"}, "edited": false, "score": 0, "creation_date": 1527088256, "post_id": 50490715, "comment_id": 87996607, "body": "/edit wow &lt;%= image_tag post.image.url, style: &#39;height:100px; width:100px;&#39;%&gt; working, finally ;) thank you so much!"}, {"owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "reply_to_user": {"reputation": 13, "user_id": 9819794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WYMIX.jpg?s=128&g=1", "display_name": "derek2", "link": "https://stackoverflow.com/users/9819794/derek2"}, "edited": false, "score": 0, "creation_date": 1527162504, "post_id": 50490715, "comment_id": 88029071, "body": "You&#39;re welcome :) You must take care of the aspect ratio as well, either by managing this on ImageUploader resize_to_fit or just add width and height should be auto"}], "tags": [], "owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "is_accepted": true, "score": 1, "last_activity_date": 1527084964, "creation_date": 1527084964, "answer_id": 50490715, "question_id": 50487944, "link": "https://stackoverflow.com/questions/50487944/thumb-in-rails-it-does-not-load-photos/50490715#50490715", "title": "(:thumb) in Rails It does not load photos", "body": "<p>try this</p>\n\n<pre><code>post.image.thumb.url\n</code></pre>\n\n<p>It should work</p>\n\n<p>if you want it with inline styling try this:</p>\n\n<pre><code>&lt;%= image_tag post.image.url, style: 'height:100px; width:100px;'%&gt;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9819794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WYMIX.jpg?s=128&g=1", "display_name": "derek2", "link": "https://stackoverflow.com/users/9819794/derek2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 50490715, "answer_count": 1, "score": 0, "last_activity_date": 1527084964, "creation_date": 1527076977, "question_id": 50487944, "link": "https://stackoverflow.com/questions/50487944/thumb-in-rails-it-does-not-load-photos", "title": "(:thumb) in Rails It does not load photos", "body": "<p>I use carieerwave and mini magick. I'm trying to scale pictures from carieerwave in the thumb version up to 500x250 but I can not read them:\n<a href=\"https://i.stack.imgur.com/V3DAg.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Section with images (articles).  I can not set the same size of all photos (500x250) and when I add a version (: thumb) they will not load at all. </p>\n\n<pre><code>&lt;div class=\"section\"&gt;\n    &lt;div class=\"container\" style=\"display: flex;\"&gt;\n        &lt;% @posts.take(4).each do |post| %&gt;\n          &lt;div class=\"carda\" &gt;\n            &lt;div class=\"card-content\"&gt;\n              &lt;%= link_to image_tag(post.image_url(:thumb), width: 500, height: 250), post %&gt;\n              &lt;p class=\"title\" style=\"margin-top: 5px; color:black\"&gt;\n      &lt;%= raw link_to post.title, post  %&gt;\n              &lt;/p&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n      &lt;% end %&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And image uploader </p>\n\n<pre><code>class ImageUploader &lt; CarrierWave::Uploader::Base\n  # Include RMagick or MiniMagick support:\n  # include CarrierWave::RMagick\n   include CarrierWave::MiniMagick\n\n  # Choose what kind of storage to use for this uploader:\n  storage :file\n  # storage :fog\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  # Provide a default URL as a default if there hasn't been a file uploaded:\n  # def default_url(*args)\n  #   # For Rails 3.1+ asset pipeline compatibility:\n  #   # ActionController::Base.helpers.asset_path(\"fallback/\" + [version_name, \"default.png\"].compact.join('_'))\n  #\n  #   \"/images/fallback/\" + [version_name, \"default.png\"].compact.join('_')\n  # end\n\n  # Process files as they are uploaded:\n  # process scale: [200, 300]\n  #\n  # def scale(width, height)\n  #   # do something\n  # end\n\n  # Create different versions of your uploaded files:\n  version :thumb do\n    process resize_to_fit: [500, 250]\n  end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n   def extension_whitelist\n     %w(jpg jpeg gif png)\n  end\n\n  # Override the filename of the uploaded files:\n  # Avoid using model.id or version_name here, see uploader/store.rb for details.\n  # def filename\n  #   \"something.jpg\" if original_filename\n  # end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form", "simple-form-for"], "comments": [{"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1527075173, "post_id": 50487246, "comment_id": 87987309, "body": "Can you check the logfile, and show us: what is posted to the controller (<code>params</code>), and possibly the error? Do you have any validations in your <code>Post</code> model?"}, {"owner": {"reputation": 1, "user_id": 9834069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f38a095cc548769e8097cc330ac49b0?s=128&d=identicon&r=PG&f=1", "display_name": "Lamperoyge", "link": "https://stackoverflow.com/users/9834069/lamperoyge"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1527075643, "post_id": 50487246, "comment_id": 87987614, "body": "Edited the post and added what&#39;s logged in the console and my validations :)"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1527077303, "post_id": 50487246, "comment_id": 87988787, "body": "Can you provide the error(s) in <code>@post.errors.details</code>? You can do this by placing a <code>byebug</code> in your <code>else</code> statement and use the interactive debugger (use the command <code>c</code> to continue). Or output <code>@post.errors.details.to_s</code> in your <code>app&#47;views&#47;posts&#47;new</code> view."}, {"owner": {"reputation": 1, "user_id": 9834069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f38a095cc548769e8097cc330ac49b0?s=128&d=identicon&r=PG&f=1", "display_name": "Lamperoyge", "link": "https://stackoverflow.com/users/9834069/lamperoyge"}, "edited": false, "score": 0, "creation_date": 1527078160, "post_id": 50487246, "comment_id": 87989359, "body": "<code>pry(#&lt;PostsController&gt;)&gt; @post.errors.details =&gt; {:category_id=&gt;[{:error=&gt;:blank}], :category=&gt;[{:error=&gt;:blank}], :user=&gt;[{:error=&gt;:blank}]}</code> apprently it&#39;s rolling back because it finds no category and no user?"}, {"owner": {"reputation": 1, "user_id": 9834069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f38a095cc548769e8097cc330ac49b0?s=128&d=identicon&r=PG&f=1", "display_name": "Lamperoyge", "link": "https://stackoverflow.com/users/9834069/lamperoyge"}, "edited": false, "score": 0, "creation_date": 1527079123, "post_id": 50487246, "comment_id": 87990075, "body": "using <code>@post.errors.details.to_s</code> in the view I&#39;m getting <code>{:user=&gt;[{:error=&gt;:blank}]} </code> so basically it finds no user? I&#39;m using Devise for auth, in console current_user returns nil"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9834069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f38a095cc548769e8097cc330ac49b0?s=128&d=identicon&r=PG&f=1", "display_name": "Lamperoyge", "link": "https://stackoverflow.com/users/9834069/lamperoyge"}, "edited": false, "score": 0, "creation_date": 1527090805, "post_id": 50489867, "comment_id": 87998310, "body": "Already tried adding this, still doesn&#39;t work, the problem is that the user is not being passed as a parameter so it cannot create it, probably a Devise problem"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 1, "user_id": 9834069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f38a095cc548769e8097cc330ac49b0?s=128&d=identicon&r=PG&f=1", "display_name": "Lamperoyge", "link": "https://stackoverflow.com/users/9834069/lamperoyge"}, "edited": false, "score": 0, "creation_date": 1527092515, "post_id": 50489867, "comment_id": 87999258, "body": "What do you mean &quot;the user is not being passed as a parameter&quot; @Lamperoyge? Pavel&#39;s answer will be an issue you&#39;ll need to address somewhere - it sounds like you might have an additional problem on top of this? Perhaps updating the user association to be optional, using: <code>belongs_to :user, optional: true</code>?"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1527150224, "post_id": 50489867, "comment_id": 88020970, "body": "Yes, my initial post addressed your first issue, while you have many of them. Updated post with <code>user</code> passing. And it is not &quot;Devise problem&quot; definitely. If you have your <code>Post</code> connected to <code>User</code>, you <b>must</b> fill out <code>user_id</code>"}], "tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": false, "score": 2, "last_activity_date": 1527149731, "last_edit_date": 1527149731, "creation_date": 1527082556, "answer_id": 50489867, "question_id": 50487246, "link": "https://stackoverflow.com/questions/50487246/rails-simple-form-not-saving-the-input-to-the-database/50489867#50489867", "title": "Rails - Simple form, not saving the input to the database", "body": "<p>Console output points the reason - you pass <code>photo_cache</code> parameter while have not permitted it:</p>\n\n<pre><code>Unpermitted parameter: :photo_cache\n</code></pre>\n\n<p>So, just add <code>:photo_cache</code> to <code>permit</code> list:</p>\n\n<pre><code>params.require(:post).permit(..., :photo_cache)\n</code></pre>\n\n<p><strong>UPDATE</strong>: If <code>Post</code> model belongs to <code>User</code>, it should have <em>foreign key</em> constraint and you <em>must</em> pass <code>user_id</code> parameter to <code>Post.create</code>.\nIn real apps something like <code>Devise</code> is used for authentication and controller looks like:</p>\n\n<pre><code>class PostsController &lt; ApplicationController    \n  before_action :authenticate_user!\n\n  def create\n    post = current_user.posts.create!(create_params)\n    # post = Post.new(create_params.merge(user: current_user))\n    # ...\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9834069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f38a095cc548769e8097cc330ac49b0?s=128&d=identicon&r=PG&f=1", "display_name": "Lamperoyge", "link": "https://stackoverflow.com/users/9834069/lamperoyge"}, "is_accepted": false, "score": 0, "last_activity_date": 1527092553, "creation_date": 1527092553, "answer_id": 50493177, "question_id": 50487246, "link": "https://stackoverflow.com/questions/50487246/rails-simple-form-not-saving-the-input-to-the-database/50493177#50493177", "title": "Rails - Simple form, not saving the input to the database", "body": "<p>Basically what helped is changing the create method</p>\n\n<pre><code>def create\n @post = current_user.posts.new(post_params)\n authorize @post\n if @post.save\n  redirect_to @post, notice: \"The post was created!\"\n else\n  render 'new'\n end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9834069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f38a095cc548769e8097cc330ac49b0?s=128&d=identicon&r=PG&f=1", "display_name": "Lamperoyge", "link": "https://stackoverflow.com/users/9834069/lamperoyge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527149731, "creation_date": 1527074907, "last_edit_date": 1527078335, "question_id": 50487246, "link": "https://stackoverflow.com/questions/50487246/rails-simple-form-not-saving-the-input-to-the-database", "title": "Rails - Simple form, not saving the input to the database", "body": "<p>I'm not sure why but I cannot save my form input to the database, and I couldn't find any answer so far :), but it works for creating the posts using the console.</p>\n\n<pre><code>  Started POST \"/posts\" for 127.0.0.1 at 2018-05-23 14:04:32 +0300\nProcessing by PostsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"B19yVi1jHtg7068SKFbI3tj28THNdfgGYwUSN+e79Vt/o0ivDUl0D4i71PuLKlZf1wxnEJMVnp+GmH/HcxE6cQ==\", \"post\"=&gt;{\"category_id\"=&gt;\"2\", \"title\"=&gt;\"asfaf\", \"content\"=&gt;\"asfkja\", \"photo_cache\"=&gt;\"\"}, \"commit\"=&gt;\"Create Post\"}\nUnpermitted parameter: :photo_cache\n  User Load (0.8ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n   (0.5ms)  BEGIN\n  Category Load (0.5ms)  SELECT  \"categories\".* FROM \"categories\" WHERE \"categories\".\"id\" = $1 LIMIT $2  [[\"id\", 2], [\"LIMIT\", 1]]\n   (0.4ms)  ROLLBACK\n</code></pre>\n\n<p> </p>\n\n<pre><code>&lt;%= simple_form_for(@post) do |f| %&gt;\n  &lt;%= f.collection_select(:category_id, Category.all, :id, :name, {prompt: \"Choose a category\" }) %&gt;&lt;br&gt;\n  &lt;%= f.label :title %&gt;&lt;br&gt;\n  &lt;%= f.text_field :title, placeholder: \"Type the post title here\" %&gt;&lt;br&gt;\n  &lt;%= f.label :content %&gt;&lt;br&gt;\n  &lt;%= f.text_area :content, placeholder: \"Type the post text here\" %&gt;&lt;br&gt;\n  &lt;%= f.input :photo %&gt;\n  &lt;%= f.input :photo_cache, as: :hidden %&gt;&lt;br&gt;\n  &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>def new\n  @post = Post.new\n  authorize @post\nend\n\ndef create\n  @post = Post.new(post_params)\n  authorize @post\n  if @post.save\n    redirect_to @post, notice: \"The post was created!\"\n  else\n    render 'new'\n  end\nend\n\ndef post_params \n  params.require(:post).permit(:title, :content, :category_id, :photo, :user_id)\nend\n</code></pre>\n\n<p></p>\n\n<pre><code>class Post &lt; ApplicationRecord\n  validates :title, :content, :category_id, presence: true\n  belongs_to :category\n  belongs_to :user\n  mount_uploader :photo, PhotoUploader\nend\n</code></pre>\n"}, {"tags": ["ruby", "csv", "export-to-excel", "export-to-csv"], "comments": [{"owner": {"reputation": 2298, "user_id": 5883753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32d66e6c723279fdfc2a90b269a070c?s=128&d=identicon&r=PG&f=1", "display_name": "fongfan999", "link": "https://stackoverflow.com/users/5883753/fongfan999"}, "edited": false, "score": 0, "creation_date": 1527080945, "post_id": 50487071, "comment_id": 87991363, "body": "Hi @Pierrre, there are 2 types of rating: Presse and Spectateurs. What is your expected output? <code>Coco,4.1,4.6</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "is_accepted": true, "score": 2, "last_activity_date": 1527081548, "last_edit_date": 1527081548, "creation_date": 1527081221, "answer_id": 50489396, "question_id": 50487071, "link": "https://stackoverflow.com/questions/50487071/storing-in-csv-file-ruby-separator/50489396#50489396", "title": "Storing in CSV file - ruby separator", "body": "<p>I think the problem here is that you are not pushing the elements correctly into your <code>array</code> variable. Basically, your array ends up looking like this: </p>\n\n<pre><code>['Movie 1 Title', 'Movie 1 rating', 'Movie 2 Title', 'Movie 2 rating', ...]\n</code></pre>\n\n<p>What you actually want is an array of arrays, like so:</p>\n\n<pre><code>[\n  ['Movie 1 Title', 'Movie 1 rating'],\n  ['Movie 2 Title', 'Movie 2 rating'],\n  ...\n]\n</code></pre>\n\n<p>And once your array is correctly set, you don't even need to specify a row separator in your CSV options. </p>\n\n<p>The following should do the trick: </p>\n\n<pre><code>require 'open-uri'\nrequire 'nokogiri'\nrequire 'csv'\n\narray = []\n\n\n10.times do |i|\n  url = \"http://www.allocine.fr/film/meilleurs//?page=#{i}\"\n  html_file = open(url).read\n  html_doc = Nokogiri::HTML(html_file)\n\n\n  html_doc.search('.img_side_content').each do |element|\n    title = element.search('.no_underline').inner_text.strip\n    notes = element.search('.note').map { |note| note.inner_text }\n    array &lt;&lt; [title, notes].flatten\n  end\nend\n\nputs array\n\nfilepath    = 'allocine.csv'\ncsv_options = { force_quotes: true, quote_char: '\"' }\n\nCSV.open(filepath, 'w', csv_options) do |csv|\n  array.each do |item|\n    csv &lt;&lt; item\n  end\nend\n</code></pre>\n\n<p>( I also took the liberty of changing your <code>for</code> loop to a <code>times</code>, which is more ruby-like ;) )</p>\n"}], "owner": {"reputation": 318, "user_id": 8398293, "user_type": "registered", "profile_image": "https://graph.facebook.com/732236736985262/picture?type=large", "display_name": "Pierre Laburthe", "link": "https://stackoverflow.com/users/8398293/pierre-laburthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "accepted_answer_id": 50489396, "answer_count": 1, "score": 4, "last_activity_date": 1527081548, "creation_date": 1527074372, "question_id": 50487071, "link": "https://stackoverflow.com/questions/50487071/storing-in-csv-file-ruby-separator", "title": "Storing in CSV file - ruby separator", "body": "<p>I am trying to store the results from my scrapping exercice into a CSV file. </p>\n\n<p>The current CSV file gives me the following output : </p>\n\n<pre><code>Name of Movie 1\n\nRating 1\n\nName of Movie 2 \n\nRating 2     \n</code></pre>\n\n<p>I would like to get the following output : </p>\n\n<pre><code>Name of Movie 1 Rating 1 \n\nName of Movie 2 Rating 2 \n</code></pre>\n\n<p>Here is my code, I guess it has to deal with the row / column separator :</p>\n\n<pre><code>require 'open-uri'\nrequire 'nokogiri'\nrequire 'csv'\n\narray = []\n\n\nfor i in 1..10\n  url = \"http://www.allocine.fr/film/meilleurs//?page=#{i}\"\n  html_file = open(url).read\n  html_doc = Nokogiri::HTML(html_file)\n\n\n  html_doc.search('.img_side_content').each do |element|\n    array &lt;&lt; element.search('.no_underline').inner_text\n    element.search('.note').each do |data|\n      array &lt;&lt; data.inner_text\n    end\n  end\nend\n\nputs array\n\n\ncsv_options = { row_sep: ',', force_quotes: true, quote_char: '\"' }\nfilepath    = 'allocine.csv'\n\nCSV.open(filepath, 'wb', csv_options) do |csv|\n  array.each { |item| csv &lt;&lt; [item] }\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1527076214, "post_id": 50487163, "comment_id": 87987988, "body": "I am getting the same thing with this. Isn&#39;t there a <code>quoted_str</code> helper or something?"}, {"owner": {"reputation": 301, "user_id": 8759209, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AhiT4Z0WHsg/AAAAAAAAAAI/AAAAAAAAANk/8ZIAOkPCMA8/photo.jpg?sz=128", "display_name": "Artem Ignatiev", "link": "https://stackoverflow.com/users/8759209/artem-ignatiev"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1527241669, "post_id": 50487163, "comment_id": 88064220, "body": "I believe there is none because it is very easy to write: <a href=\"https://gist.github.com/timon/039d8b57b41dfcc523610f1b9987204e#file-quoted_header-rb\" rel=\"nofollow noreferrer\">Gist</a>"}], "tags": [], "owner": {"reputation": 301, "user_id": 8759209, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AhiT4Z0WHsg/AAAAAAAAAAI/AAAAAAAAANk/8ZIAOkPCMA8/photo.jpg?sz=128", "display_name": "Artem Ignatiev", "link": "https://stackoverflow.com/users/8759209/artem-ignatiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1527074671, "creation_date": 1527074671, "answer_id": 50487163, "question_id": 50486858, "link": "https://stackoverflow.com/questions/50486858/ruby-on-rails-how-may-create-a-quoted-string-to-a-request-header/50487163#50487163", "title": "Ruby on Rails: How may create a quoted string to a request header?", "body": "<p><code>%Q(x)</code> is basically the same as \"x\".</p>\n\n<p>To achieve the desired result you have to manually introduce quotes into <code>%Q</code> expression, like this: <code>%Q(\"#{Figaro.env.TWITTER_ACCESS_TOKEN}\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 3758, "user_id": 4530440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y6kMf.png?s=128&g=1", "display_name": "Kruup&#246;s", "link": "https://stackoverflow.com/users/4530440/kruup%c3%b6s"}, "is_accepted": true, "score": 1, "last_activity_date": 1527078042, "creation_date": 1527078042, "answer_id": 50488267, "question_id": 50486858, "link": "https://stackoverflow.com/questions/50486858/ruby-on-rails-how-may-create-a-quoted-string-to-a-request-header/50488267#50488267", "title": "Ruby on Rails: How may create a quoted string to a request header?", "body": "<p><strong>1. My solution:</strong></p>\n\n<pre><code>'oauth_consumer_key=\"#{Figaro.env.TWITTER_ACCESS_TOKEN}\"'\n</code></pre>\n\n<p><strong>2. Why:</strong></p>\n\n<p><code>%Q()</code> basically replaces the variable with double quotes <code>\"\"</code>, it is literally the same as if you wrote <code>\"Figaro.env.TWITTER_ACCESS_TOKEN\"</code></p>\n\n<p>In fact, to display the <strong>content</strong> of a variable, you have to use <a href=\"https://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Literals#Interpolation\" rel=\"nofollow noreferrer\">interpolation</a>\n   instead of the name itself, using <code>\"#{var}\"</code>.</p>\n\n<p>You can also use <code>%Q</code> directly with interpolation using <code>%Q{var}</code> (note <code>{}</code> instead of <code>()</code>).</p>\n\n<p>Your problem is elsewhere: with the <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-join\" rel=\"nofollow noreferrer\">join()</a> method. It's getting rid of double quotes. In that case doing <code>[\"var\", var].join('=')</code> and <code>[\"var\", %Q{var}].join('=')</code> ends doing exactly the same thing but more complicated.</p>\n\n<p><strong>@Artem Ignatiev's solution should works</strong>. But if you need to be more readable, you don't even need to join, imho, it makes sense only when you are using more than two variables.</p>\n\n<p>For instance, I will use something like <code>'oauth_consumer_key=\"#{var}\"'</code> mixing single and double quote to make sure it causes no confusions.</p>\n\n<p>If you <strong>do</strong> need to use <code>%Q()</code> and <code>join</code>, you can still use <code>[\"oauth_consumer_key\", %Q(\"#{Figaro.env.TWITTER_ACCESS_TOKEN})].join('=')</code>.</p>\n\n<ul>\n<li>Note that because of the <code>join</code> you can use single quote interpolation <code>%q</code> or double quote interpolation <code>%Q</code> without affecting the ends results: </li>\n</ul>\n\n<p><em>e.g</em></p>\n\n<pre><code>['oauth_consumer_key', %q(\"#{var}\")].join('=') == [\"oauth_consumer_key\", %Q(\"#{var}\")].join('=')\n</code></pre>\n"}], "owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 50488267, "answer_count": 2, "score": 0, "last_activity_date": 1527078042, "creation_date": 1527073704, "question_id": 50486858, "link": "https://stackoverflow.com/questions/50486858/ruby-on-rails-how-may-create-a-quoted-string-to-a-request-header", "title": "Ruby on Rails: How may create a quoted string to a request header?", "body": "<p>I am writing from scratch a Twitter client and one of the requisites is <strong>not</strong> using Twitter gems, so I must create my own requests.</p>\n\n<p>Twitter API  documentation says <a href=\"https://developer.twitter.com/en/docs/basics/authentication/guides/authorizing-a-request\" rel=\"nofollow noreferrer\">here</a> that I must have a Authorization header like this:</p>\n\n<pre><code>Authorization:\nOAuth oauth_consumer_key=\"xvz1evFS4wEEPTGEFPHBog\",\noauth_nonce=\"kYjzVBB8Y0ZFabxSWbWovY3uYSQ2pTgmZeNu2VS4cg\",\noauth_signature=\"tnnArxj06cWHq44gCs1OSKk%2FjLY%3D\",\noauth_signature_method=\"HMAC-SHA1\",\noauth_timestamp=\"1318622958\",\noauth_token=\"370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb\",\noauth_version=\"1.0\"\n</code></pre>\n\n<p>As you may see I must have something like <code>oauth_consumer_key=\"xvz1evFS4wEEPTGEFPHBog\"</code> with the second part in quotes. I tried using %Q like in </p>\n\n<pre><code>[\"oauth_consumer_key\",%Q( Figaro.env.TWITTER_ACCESS_TOKEN )].join('=')\n</code></pre>\n\n<p>assuming %Q would return a quoted string. but when I inspect the value, all I get is</p>\n\n<pre><code>oauth_consumer_key=xvz1evFS4wEEPTGEFPHBog\n</code></pre>\n\n<p>which, obviously, is different from the required result.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1527071889, "post_id": 50486048, "comment_id": 87985163, "body": "The reason you get <code>[[:a, 1], [:b, 2]]</code> is because your code is actually trying to <i>convert</i> the hash into an Array. Not wrap it."}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1527072391, "post_id": 50486048, "comment_id": 87985505, "body": "Also, Array() return parameter without changing when that is the array: Array([h]) will be same as [h]"}], "answers": [{"comments": [{"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 1, "creation_date": 1527072951, "post_id": 50486137, "comment_id": 87985887, "body": "<code>Array.wrap(h)</code> won&#39;t support in plain ruby, it is support in <code>ActiveSupport</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1527072986, "post_id": 50486137, "comment_id": 87985909, "body": "@GaganGami: oh right, thanks. BTW I do have a vanilla way too."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1527074236, "post_id": 50486137, "comment_id": 87986702, "body": "It might be worth noting that <code>Array.wrap(obj)</code> does much more than <code>[obj]</code> \u2013 see the <a href=\"http://api.rubyonrails.org/classes/Array.html#method-c-wrap\" rel=\"nofollow noreferrer\">docs</a>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527168507, "post_id": 50486137, "comment_id": 88033448, "body": "@Stefan much more might be an overstatement it is essentially <code>obj.respond_to?(:to_ary) ? obj.to_ary : [obj].compact</code>"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 6, "last_activity_date": 1527073004, "last_edit_date": 1527073004, "creation_date": 1527071665, "answer_id": 50486137, "question_id": 50486048, "link": "https://stackoverflow.com/questions/50486048/use-array-with-a-hash-item/50486137#50486137", "title": "Use Array with a hash item", "body": "<p>I would do </p>\n\n<pre><code>a = [h]\n</code></pre>\n\n<p>But if you insist on using <code>Array</code>, then you can do this (with Rails/ActiveSupport):</p>\n\n<pre><code>a = Array.wrap(h)\n</code></pre>\n\n<hr>\n\n<p>As mentioned by Tom Lord in comments, you are getting the result you're getting because <code>Array()</code> (and its brethren, like <code>Integer()</code>) are <strong>conversion functions</strong>. They take the input and attempt to transform it into the desired type. And you want something else.</p>\n"}, {"tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1527078702, "last_edit_date": 1527078702, "creation_date": 1527072995, "answer_id": 50486619, "question_id": 50486048, "link": "https://stackoverflow.com/questions/50486048/use-array-with-a-hash-item/50486619#50486619", "title": "Use Array with a hash item", "body": "<pre><code>h = {a: 1, b: 2}\na = []\n\na.push h\n</code></pre>\n\n<p>or </p>\n\n<pre><code>a&lt;&lt;h\n</code></pre>\n\n<p>output</p>\n\n<pre><code>p a\n[{:a=&gt;1, :b=&gt;2}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1527079035, "creation_date": 1527079035, "answer_id": 50488633, "question_id": 50486048, "link": "https://stackoverflow.com/questions/50486048/use-array-with-a-hash-item/50488633#50488633", "title": "Use Array with a hash item", "body": "<p>You can use a <em>moustache</em> syntax:</p>\n\n<pre><code>Array.new(1) {{ a: 1, b: 2 }}\n#\u21d2 [{:a=&gt;1, :b=&gt;2}]\n</code></pre>\n"}], "owner": {"reputation": 7073, "user_id": 978360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/J7u43.jpg?s=128&g=1", "display_name": "TieDad", "link": "https://stackoverflow.com/users/978360/tiedad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1527079035, "creation_date": 1527071437, "question_id": 50486048, "link": "https://stackoverflow.com/questions/50486048/use-array-with-a-hash-item", "title": "Use Array with a hash item", "body": "<p>I have a Hash:</p>\n\n<pre><code>h = {a: 1, b: 2}\n</code></pre>\n\n<p>To use</p>\n\n<pre><code>a = Array(h)\n</code></pre>\n\n<p>What I expected is that <code>a</code> is an array and <code>h</code> is an item of <code>a</code>: <code>[{a:1,b:2}]</code></p>\n\n<p>But <code>a</code> is actually <code>[[:a, 1], [:b, 2]]</code>. </p>\n\n<p>Question is, how to get my expected <code>a</code> with <code>Array()</code>?</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "hover"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1527070870, "post_id": 50485210, "comment_id": 87984525, "body": "You should add an hidden form to the page and trigger the form submission, look <a href=\"http://guides.rubyonrails.org/working_with_javascript_in_rails.html\" rel=\"nofollow noreferrer\">here</a>. In particular the <a href=\"http://guides.rubyonrails.org/working_with_javascript_in_rails.html#server-side-concerns\" rel=\"nofollow noreferrer\">chapter 4</a>"}], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1527078333, "post_id": 50487048, "comment_id": 87989478, "body": "Actualy Working Thanks, did u know how to add one line in my database, i have one table user_articles with user_id and article_id"}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "reply_to_user": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1527079186, "post_id": 50487048, "comment_id": 87990108, "body": "Migration uses to change database tables(create, rename, add or delete fields). Example: &quot;rails g migration AddFieldToUserArticles field_name:string &amp;&amp; rake db:migrate&quot;. You can handle create a migration, but generator adds the timestamp to the filename that helps manage migration. After generation and before &#39;rake db:migrate&#39; you can edit migration at db/migrate"}, {"owner": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1527079374, "post_id": 50487048, "comment_id": 87990252, "body": "I have already realized my migration, I am only looking for a solution to add a line from the jquery or to do it during the hover"}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "reply_to_user": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1527079899, "post_id": 50487048, "comment_id": 87990646, "body": "Use ajax to send a request(in client side you can&#39;t update databases and that is good for security reason): $.ajax({url: &#39;/user_articles&#39;, method: &#39;POST&#39;, data: {id: myArticleId}}). Handle this request in the server by creating relevant action and route"}, {"owner": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1527080576, "post_id": 50487048, "comment_id": 87991115, "body": "I have make the following route:       post&quot;/user_articles&quot; =&gt; &#39;user_articles#create&#39;, :as =&gt; &#39;create&#39; but i have somes erros(Bad Request) param is missing or the value is empty : user_activity"}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "reply_to_user": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1527081535, "post_id": 50487048, "comment_id": 87991780, "body": "Look like userarticles_params have code as params.require(:user_activity).premit(...). If you want to use this construction you must change ajax data: $.ajax({url: &#39;/user_articles&#39;, method: &#39;POST&#39;, data: {user_activity: {article_id: myArticleId}}}).   Also, you can write something like this without changing ajax request: UserArticle.create(user_id: current_user.id, article_id: params[:id])"}, {"owner": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1527082241, "post_id": 50487048, "comment_id": 87992316, "body": "I will test that thanks,  is it possible to don&#39;t refresh the page, because it goes up every time"}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 0, "last_activity_date": 1527074297, "creation_date": 1527074297, "answer_id": 50487048, "question_id": 50485210, "link": "https://stackoverflow.com/questions/50485210/add-a-line-in-database-during-a-hover-ruby-on-rails/50487048#50487048", "title": "Add a line in database during a hover - ruby on rails", "body": "<p>You need a single js script that must control many articles blocks. So, you can put &lt;%= article.id %> to script each time, but script run once after the page loaded. That means you put to js only last article id. </p>\n\n<p>But you can mark HTML block(use data attribute) and then just read the note. For example:</p>\n\n<pre><code>&lt;div class=\"newness\" data-id='&lt;%= article.id %&gt;'&gt;new&lt;/div&gt;\n</code></pre>\n\n<p>And then write you js once:</p>\n\n<pre><code>&lt;script&gt;\n  $('.newness').hover(\n    function() {\n      $(this).addClass('hover);\n      //read your note there\n      myArticleId = $(this).data('id');\n      // console.log(myArticleId);\n      // do something with id or send ajax request\n    }\n  )\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "is_accepted": false, "score": 0, "last_activity_date": 1527076443, "last_edit_date": 1527076443, "creation_date": 1527075650, "answer_id": 50487501, "question_id": 50485210, "link": "https://stackoverflow.com/questions/50485210/add-a-line-in-database-during-a-hover-ruby-on-rails/50487501#50487501", "title": "Add a line in database during a hover - ruby on rails", "body": "<p>You can create a form, but you can also create a dedicated action in your controller that is passed the article id, then you can change the <code>visibility</code> tracker to \"seen\" or to \"1\" if boolean</p>\n\n<p>In your view, you should call this action on hover by following the section 2 of this thread : <a href=\"https://stackoverflow.com/questions/15381810/using-remote-true-with-hover-event\">Using :remote =&gt; true with hover event</a></p>\n\n<p>You only have to mention the path to your dedicated action and also pass the article id. It avoid creating a form with hidden fields.</p>\n\n<p>Finally, in order to remove the tab for the article, just put the javascript into a view file named like your action : <code>dedicated_action.erb.js</code> where you put some JS or Jquery code to make the div of the article disappear. The only thing you have to do in your original view with all articles is to assign an ID to the Div that is a container of the article, and use the same ID in the JS view in order to select the right DIV.</p>\n"}, {"tags": [], "owner": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1527079056, "creation_date": 1527079056, "answer_id": 50488639, "question_id": 50485210, "link": "https://stackoverflow.com/questions/50485210/add-a-line-in-database-during-a-hover-ruby-on-rails/50488639#50488639", "title": "Add a line in database during a hover - ruby on rails", "body": "<p>I'm sorry for not understanding everything but I am new on rails,\nAt the moment I have a form to add a User_activity:\nTable that contains the id of the user and the article\nand my functional hover\nremains to put thats part together  to add in database when the mouse is hover the div </p>\n\n<pre><code>&lt;script&gt;\n  $('.newness').hover(\n    function() {\n      $(this).addClass('hover);\n      myArticleId = $(this).data('id');\n      //I want there to put user_id &amp; activity_id in my database\n    }\n  )\n&lt;/script&gt;\n</code></pre>\n\n<p>There is my model :</p>\n\n<pre><code>//appcontroller\ndef set_variables\n@userarticle = UserArticle.new\nend\n//user_articles_controller\ndef create\n@user = current_user\n@userarticle = @user.user_articles.build(userarticles_params)\n@userarticle.save\nredirect_to root_path\nend\n</code></pre>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 233, "user_id": 9833510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765049716863833/picture?type=large", "display_name": "Benjamin Barb&#233;", "link": "https://stackoverflow.com/users/9833510/benjamin-barb%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 50487048, "answer_count": 3, "score": 0, "last_activity_date": 1527079056, "creation_date": 1527069268, "question_id": 50485210, "link": "https://stackoverflow.com/questions/50485210/add-a-line-in-database-during-a-hover-ruby-on-rails", "title": "Add a line in database during a hover - ruby on rails", "body": "<p>I want to achieve something in rails: I have a new colony in bdd, by default an element is a 1 for all users.\nI have a table \"userarticles\" which will contain the id of the article and the id of the user for each article that flew over\nSo I want that when an over a div with a \"new\" tab disappears and that it puts in database that the user saw the article</p>\n\n<p>so, my problem is that when my JQuery request to remove the div it works but I can not make rail requests</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>&lt;script&gt;\r\n$('.newness').hover(\r\nfunction() {\r\n$(this).addClass('hover);\r\n//i want to put my rails function there\r\n//I try this\r\n//$(this).innerHTML('&lt;%= article.id %&gt;')\r\n//but he return my all time the same ID.. \r\n}\r\n&lt;/script&gt;</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!--rest of my code --&gt;\r\n&lt;h5&gt; &lt;%= article.title %&gt; &lt;/h5&gt;\r\n&lt;div class=\"newness\"&gt;new&lt;/div&gt;\r\n&lt;!--rest of my code--&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>here the result : </p>\n\n<p><a href=\"https://image.noelshack.com/fichiers/2018/21/3/1527069190-capture-d-ecran-2018-05-23-11-52-00.png\" rel=\"nofollow noreferrer\">Result</a></p>\n\n<p>Sorry for my english,\nBen</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1527069010, "post_id": 50485016, "comment_id": 87983238, "body": "I am guessing you have a default image set (to <code>no-image.jpg</code>) ? So actually you want to block attachments without image?"}, {"owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1527069136, "post_id": 50485016, "comment_id": 87983314, "body": "Thanks for the reply @nathanvda , I want show all the images except for the <code>no-image.jpg</code>, if it exists inside the loop."}], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "edited": false, "score": 0, "creation_date": 1527070393, "post_id": 50485561, "comment_id": 87984207, "body": "Thanks @nathanvda, this worked just fine for me <code>attachment.image_identifier</code>"}], "tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": true, "score": 1, "last_activity_date": 1527070186, "creation_date": 1527070186, "answer_id": 50485561, "question_id": 50485016, "link": "https://stackoverflow.com/questions/50485016/rails-loop-through-a-database-table-and-reject-one-object-by-name/50485561#50485561", "title": "Rails loop through a database table and reject one object by name", "body": "<p>Seeing you also write <code>attachment.image.url</code> I assume <code>image</code> is the field where the image is stored inside the <code>Attachment</code> class, so in that case you should just write</p>\n\n<pre><code>attachment.image.identifier \n</code></pre>\n\n<p>I think <code>attachment.image_identifier</code> is also possible.</p>\n"}], "owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 50485561, "answer_count": 1, "score": 0, "last_activity_date": 1527070186, "creation_date": 1527068687, "question_id": 50485016, "link": "https://stackoverflow.com/questions/50485016/rails-loop-through-a-database-table-and-reject-one-object-by-name", "title": "Rails loop through a database table and reject one object by name", "body": "<p>I'm searching for objects inside a database table according to an <code>id</code>:</p>\n\n<pre><code>def edit\n  @attachments = Attachment.where(item_id: @item.id)\nend\n</code></pre>\n\n<p>and inside the view I'm trying to reject the <code>no-image.jpg</code> image like this:</p>\n\n<pre><code>&lt;% @attachments.reject { |attachment| attachment.image.file.identifier == \"no-image.jpg\" }.each do |attachment| %&gt;\n    &lt;%= image_tag(attachment.image.url(:mini))%&gt;\n    &lt;%= link_to \"Remove\", remove_item_attachment_path(attachment), :data =&gt; {:confirm =&gt; 'Are you sure?'}, :method =&gt; :delete %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Now even though the file <code>no-image.jpg</code> exists inside the loop when I debug it, it's giving the following error:</p>\n\n<pre><code>NoMethodError in Items#edit\nundefined method `identifier' for #&lt;CarrierWave::Storage::Fog::File:0x007fb193633520&gt;\n</code></pre>\n\n<p>The error is in this line: </p>\n\n<pre><code>&lt;% @attachments.reject { |attachment| attachment.image.file.identifier == \"no-image.jpg\" }.each do |attachment| %&gt;\n</code></pre>\n\n<p>Any ideas how I can fix this?</p>\n"}, {"tags": ["ruby", "rspec", "monkeypatching"], "answers": [{"tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": true, "score": 1, "last_activity_date": 1527069159, "last_edit_date": 1527069159, "creation_date": 1527068837, "answer_id": 50485060, "question_id": 50484959, "link": "https://stackoverflow.com/questions/50484959/mocking-a-patch-module/50485060#50485060", "title": "Mocking a patch module", "body": "<p>I would go with cloning, something along this lines: </p>\n\n<pre><code>before do\n  @original_connection = ActiveRecord::Base.connection\n  ActiveRecord::Base.connection = @original_commention.dup\n  ActiveRecord::Base.connection.extend(App::SomePatch)\nend\n\nafter do\n  ActiveRecord::Base.connection = @original_connection\nend\n</code></pre>\n\n<p>I did not test that, but as long there are not \"quirks\" with cloning the object, this should be fine.</p>\n\n<p>Edit: Ok, this does not work, because there's no <code>connection=</code> method, so you can probably try with mocking: </p>\n\n<pre><code>before do\n  @original_connection = ActiveRecord::Base.connection\n  new_connection = @original_connection.dup\n  new_connection.extend(App::SomePatch)\n  allow(ActiveRecord::Base).to receive(:connection).and_return(new_connection)\nend\n</code></pre>\n\n<p>And you probably don't need <code>after</code> because the mock will be \"undone\"</p>\n"}], "owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 50485060, "answer_count": 1, "score": 0, "last_activity_date": 1527069159, "creation_date": 1527068498, "question_id": 50484959, "link": "https://stackoverflow.com/questions/50484959/mocking-a-patch-module", "title": "Mocking a patch module", "body": "<p>I've got a codebase which is tested in two scenarios: run via entry point A, and B. When it's run via A, the db connection is used as is. When it's run via B, <code>ActiveRecord::Base.connection</code> is monkey patched.</p>\n\n<p>Since B is just a helper script, it's currently tested in rspec by running it as an external command and checking the output. I'd like to bring some sanity back and test the behaviour without spawning new processes though.</p>\n\n<p>Is there a way in rspec mocks to \"temporarily extend\" a class? I'd like to get the behaviour of doing:</p>\n\n<pre><code>before do\n  ActiveRecord::Base.connection.extend(App::SomePatch)\nend\nafter do\n  ActiveRecord::Base.connection.unextend(App::SomePatch)\nend\n</code></pre>\n\n<p>Of course unextend doesn't exist. I have only 3 methods to patch, so I could potentially use the mocks for each method instead, but a method alias makes this complicated.</p>\n\n<p>The patch module looks like this:</p>\n\n<pre><code>module SomePatch\n  def SomePatch.included(mod)\n    alias :old_execute :execute\n  end\n\n  def execute(*args) ... end\n\n  def some_storage\n    @some_storage ||= []\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527068412, "post_id": 50484851, "comment_id": 87982836, "body": "I don&#39;t know if such method exists already, but you can always <i>create</i> one, and hide the dup/tap there."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527068538, "post_id": 50484851, "comment_id": 87982928, "body": "@SergioTulentsev I though that I might be overlooking an obvious solution."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527068743, "post_id": 50484851, "comment_id": 87983076, "body": "It certainly <i>feels</i> that way, yes."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 1, "creation_date": 1527069028, "post_id": 50484851, "comment_id": 87983250, "body": "<a href=\"https://bugs.ruby-lang.org/issues/14778\" rel=\"nofollow noreferrer\">Coincidentally there is a recent feature request for <code>dup</code> accepting a <code>tap</code>-like block.</a> Not sure if that&#39;s a good idea though."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527071093, "post_id": 50484851, "comment_id": 87984644, "body": "FYI I&#39;ve opened a feature request for what I think would be a viable solution to my problem: <a href=\"https://bugs.ruby-lang.org/issues/14783\" rel=\"nofollow noreferrer\">bugs.ruby-lang.org/issues/14783</a>"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1527086431, "post_id": 50484851, "comment_id": 87995300, "body": "What about using <code>sub</code>? Something along the lines of: <code>string.sub(&#47;(?&lt;=.{3}).&#47;, &#39;&#39;)</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1527086568, "post_id": 50484851, "comment_id": 87995389, "body": "@SagarPandya yes, that would probably work. But using a regular expression to remove a single character seems a bit much ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527069412, "post_id": 50485218, "comment_id": 87983501, "body": "Alternatively <code>string[0...at] + string[at + 1..-1]</code>"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527071791, "post_id": 50485218, "comment_id": 87985091, "body": "@Stefan yes, that would work as well. I think that <code>[]</code> is way to overloaded though. So I never use it. <a href=\"https://ruby-doc.org/core-2.5.1/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.1/String.html#method-i-5B-5D</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1527072098, "post_id": 50485218, "comment_id": 87985326, "body": "<code>String#[]</code> and <code>String#slice</code> are aliases."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527161031, "post_id": 50485218, "comment_id": 88028161, "body": "@Stefan overloaded in the sense that it is used for lots of things e.g. accessing elements if an Array/Hash and my brain does not parse String[] well :-)"}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 2, "last_activity_date": 1527069296, "creation_date": 1527069296, "answer_id": 50485218, "question_id": 50484851, "link": "https://stackoverflow.com/questions/50484851/how-to-return-string-with-character-at-given-index-removed/50485218#50485218", "title": "How to return string with character at given index removed?", "body": "<p>I'm not aware of such a method. You can write it yourself using <code>slice</code> though.</p>\n\n<pre><code>at = 3\nstring = \"abc-def\"\ndef delete_at(string, at)\n  string.slice(0, at) + string.slice(at + 1, string.length)\nend\n\nx = delete_at(string, at) #&gt; \"abcdef\"\n</code></pre>\n\n<p>You could also monkey patch it to <code>String</code> class (which I don't like though)</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1527102635, "last_edit_date": 1527102635, "creation_date": 1527092074, "answer_id": 50493046, "question_id": 50484851, "link": "https://stackoverflow.com/questions/50484851/how-to-return-string-with-character-at-given-index-removed/50493046#50493046", "title": "How to return string with character at given index removed?", "body": "<p>Seems <code>Kernel#sprintf</code>can solve this fairly simply: </p>\n\n<pre><code>str = \"foo-bar\"\nsprintf(\"%3.3s%s\",str,str[4..-1])\n#=&gt; \"foobar\"\n</code></pre>\n\n<p>Or simply </p>\n\n<pre><code>sprintf(\"%s%s\",str[0..2],str[4..-1])\n#=&gt; \"foobar\"\n</code></pre>\n\n<p>Additionally <code>Enumerable</code> methods could help but seem a bit overkill e.g.</p>\n\n<pre><code>str.each_char.with_index.reduce(\"\")  do |memo,(s,i)| \n  i == 3 ? memo : memo &lt;&lt; s\nend\n#=&gt; \"foobar\"\n</code></pre>\n"}], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1527102635, "creation_date": 1527068193, "last_edit_date": 1527071202, "question_id": 50484851, "link": "https://stackoverflow.com/questions/50484851/how-to-return-string-with-character-at-given-index-removed", "title": "How to return string with character at given index removed?", "body": "<p>I have a string, e.g.</p>\n\n<pre><code>string = 'foo-bar'\n</code></pre>\n\n<p>and I want a <em>new</em> string which doesn't contain the character at <em>index</em>  <code>3</code> (the <code>-</code> in the example string), so the results would be <code>\"foobar\"</code>. The former string must not be changed.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>new_string = string.dup\nnew_string.slice!(3)\nnew_string\n#=&gt; \"foobar\"\n\nstring\n#=&gt; \"foo-bar\"\n</code></pre>\n\n<p>or as a \"one-liner\":</p>\n\n<pre><code>new_string = string.dup.tap { |s| s.slice!(3) }\n#=&gt; \"foobar\"\n</code></pre>\n\n<p>But having to <code>dup</code> and maybe <code>tap</code> looks quite cumbersome. Is there a more concise way?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cron", "whenever"], "comments": [{"owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "edited": false, "score": 0, "creation_date": 1527067354, "post_id": 50484467, "comment_id": 87982089, "body": "Please consider sharing code, what have you tried or trying."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1527067791, "post_id": 50484467, "comment_id": 87982392, "body": "Try check <a href=\"https://stackoverflow.com/a/24077174/5239030\">this topic</a>, maybe can give some insights."}], "answers": [{"comments": [{"owner": {"reputation": 500, "user_id": 5973933, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-Oibv_qAg5fQ/AAAAAAAAAAI/AAAAAAAAAGs/PWra2-sj8Pk/photo.jpg?sz=128", "display_name": "Raunak Joneja", "link": "https://stackoverflow.com/users/5973933/raunak-joneja"}, "edited": false, "score": 0, "creation_date": 1527583300, "post_id": 50485935, "comment_id": 88169009, "body": "This works perfectly, only thing, the strftime format you provided didnt work for some reason. The format that worked for me was   .strftime(&#39;%I:%M%P&#39;)"}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 2, "last_activity_date": 1527071137, "creation_date": 1527071137, "answer_id": 50485935, "question_id": 50484467, "link": "https://stackoverflow.com/questions/50484467/whenever-gem-cronjob-on-a-particular-time-based-on-model/50485935#50485935", "title": "Whenever gem cronjob on a particular time based on model", "body": "<p>There is a way to run <code>whenever</code> dynamically. Just add this line to the top of your <code>schedule.rb</code>: </p>\n\n<pre><code>require \"/home/username/appname/config/environment.rb\"\n</code></pre>\n\n<p>That allows you to use all your models class on the schedule.rb. For example: </p>\n\n<pre><code>every 1.day, :at =&gt; (Booking.last.event_time - 1.hour).strftime('%I:%M %p') do\n  ...\nend\n</code></pre>\n\n<p>Also, you can use the environment variable to set the time too.</p>\n\n<p>Don't forget update crontab when time change:</p>\n\n<pre><code>system 'bundle exec whenever --update-crontab'\n</code></pre>\n\n<p>But cron uses to run schedule jobs (commands or shell scripts) <strong>periodically</strong> at fixed times. So, whenever isn't better solution for you. As iGian wrote at his comment - check this <a href=\"https://stackoverflow.com/questions/24076954/best-way-to-trigger-an-hour-before-event-starts/24077174#24077174\">topic</a>: delay job(sidekiq or similar) is more relevant to that job. </p>\n"}, {"tags": [], "owner": {"reputation": 691, "user_id": 4385342, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-ywHOrlzk5g4/AAAAAAAAAAI/AAAAAAAAB9Y/mO2q6r1jr60/photo.jpg?sz=128", "display_name": "a3y3", "link": "https://stackoverflow.com/users/4385342/a3y3"}, "is_accepted": false, "score": 0, "last_activity_date": 1527079224, "creation_date": 1527079224, "answer_id": 50488680, "question_id": 50484467, "link": "https://stackoverflow.com/questions/50484467/whenever-gem-cronjob-on-a-particular-time-based-on-model/50488680#50488680", "title": "Whenever gem cronjob on a particular time based on model", "body": "<p>@Leo answered it correctly, but adding <code>require File.expand_path(File.dirname(__FILE__) + \"/environment\")</code> at the beginning of your <code>schedule.rb</code> will make it more versatile and easier to read.</p>\n"}], "owner": {"reputation": 500, "user_id": 5973933, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-Oibv_qAg5fQ/AAAAAAAAAAI/AAAAAAAAAGs/PWra2-sj8Pk/photo.jpg?sz=128", "display_name": "Raunak Joneja", "link": "https://stackoverflow.com/users/5973933/raunak-joneja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 50485935, "answer_count": 2, "score": 0, "last_activity_date": 1527079224, "creation_date": 1527067084, "question_id": 50484467, "link": "https://stackoverflow.com/questions/50484467/whenever-gem-cronjob-on-a-particular-time-based-on-model", "title": "Whenever gem cronjob on a particular time based on model", "body": "<p>I am using the whenever gem, to handle my cron jobs. \nI have an events and bookings rails application where I have an events and a bookings table.</p>\n\n<p>I want to send out a mailer, with all the bookings for an event to the event organizer an hour or so before the event's start time. \nBut I am not able to find a way to that with the whenever gem. </p>\n\n<p>Currently, I am just sending out all mailers at 9pm, and that works perfectly, but I that doesn't serve my use case, since different event organizers require it at different times</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "rabl", "jbuilder"], "owner": {"reputation": 11, "user_id": 9833422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d007f66cad05724e2e457571793391?s=128&d=identicon&r=PG&f=1", "display_name": "xedeheji", "link": "https://stackoverflow.com/users/9833422/xedeheji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527066705, "creation_date": 1527066705, "question_id": 50484306, "link": "https://stackoverflow.com/questions/50484306/jbuilder-to-rabl", "title": "Jbuilder to Rabl", "body": "<p>I have a strange issue using <code>gem gon</code></p>\n\n<p>it cause <code>.rvm/gems/ruby-2.3.1/gems/gon-5.2.3/lib/gon/jbuilder.rb:84: [BUG] Segmentation fault at 0x00000000000004\n</code></p>\n\n<p>so i decided to move to <code>rabl</code></p>\n\n<p>but i need help to convert code from <code>json.jbuilder</code> to <code>json.rabl</code></p>\n\n<pre><code>json.asks @asks\n\nif @member\n json.my_trades @trades_done.map(&amp;:for_notify)\n json.my_orders *([@orders_wait] + Order::ATTRIBUTES)\nend\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 9735728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Scott Picquerey", "link": "https://stackoverflow.com/users/9735728/scott-picquerey"}, "is_accepted": true, "score": 3, "last_activity_date": 1527065708, "creation_date": 1527065708, "answer_id": 50483980, "question_id": 50483950, "link": "https://stackoverflow.com/questions/50483950/scraping-the-web-data-separator-needed/50483980#50483980", "title": "Scraping the web : data separator needed", "body": "<p>You forgot to parse the notes, this is why they appear without a space in the console.\nWhat you can do is to add an <code>each</code> and fill your array like this :</p>\n\n<pre><code>element.search('.note').each do |data|\n  array &lt;&lt; data.inner_text\nend\n</code></pre>\n"}], "owner": {"reputation": 318, "user_id": 8398293, "user_type": "registered", "profile_image": "https://graph.facebook.com/732236736985262/picture?type=large", "display_name": "Pierre Laburthe", "link": "https://stackoverflow.com/users/8398293/pierre-laburthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 50483980, "answer_count": 1, "score": 2, "last_activity_date": 1612350449, "creation_date": 1527065631, "last_edit_date": 1612350449, "question_id": 50483950, "link": "https://stackoverflow.com/questions/50483950/scraping-the-web-data-separator-needed", "title": "Scraping the web : data separator needed", "body": "<p>I am trying to scrape the allocine website as an exercice and my output is the following : </p>\n\n<pre><code>Movie Name \nRating 1 Rating 2 \n</code></pre>\n\n<p>Example : </p>\n\n<pre><code>Coco\n4,14,6\n\nForrest Gump\n2,64,6\n</code></pre>\n\n<p>it should be instead : </p>\n\n<pre><code>Movie Name\n\nRating 1\n\nRating 2 \n</code></pre>\n\n<p>Hope you can help me ! </p>\n\n<pre><code>require 'open-uri'\nrequire 'nokogiri'\nrequire 'csv'\n\narray = []\n\n\nfor i in 1..10\n  url = \"http://www.allocine.fr/film/meilleurs//?page=#{i}\"\n  html_file = open(url).read\n  html_doc = Nokogiri::HTML(html_file)\n\n\n  html_doc.search('.img_side_content').each do |element|\n    array &lt;&lt; element.search('.no_underline').inner_text\n    array &lt;&lt; element.search('.note').inner_text\n  end\n\n\n\n\n\nend\nputs array\n\n\ncsv_options = { col_sep: ',', force_quotes: true, quote_char: '\"' }\nfilepath    = 'allocine.csv'\n\nCSV.open(filepath, 'wb', csv_options) do |csv|\n  array.each { |item| csv &lt;&lt; [item] }\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activestorage"], "comments": [{"owner": {"reputation": 3333, "user_id": 259368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d4ddc41d7cf45d2601c3afc736fc58?s=128&d=identicon&r=PG", "display_name": "Jon M.", "link": "https://stackoverflow.com/users/259368/jon-m"}, "edited": false, "score": 0, "creation_date": 1530285476, "post_id": 50483901, "comment_id": 89196802, "body": "I&#39;ve used the Direct Upload feature of ActiveStorage recently. What I like about this approach is that I don&#39;t have to write any code to handle the actual upload itself, Rails does it for me. Did you take this approach too? See the related guide here and let me know: <a href=\"http://edgeguides.rubyonrails.org/active_storage_overview.html#direct-uploads\" rel=\"nofollow noreferrer\">edgeguides.rubyonrails.org/&hellip;</a> \u2013 even though the docs make a reference to uploading to the cloud, it will work with locally stored files too."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 3642589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e80ee6e262f26a94a0f20ddc12c51d2?s=128&d=identicon&r=PG&f=1", "display_name": "stmpjmpr", "link": "https://stackoverflow.com/users/3642589/stmpjmpr"}, "is_accepted": false, "score": 2, "last_activity_date": 1530320153, "creation_date": 1530320153, "answer_id": 51110900, "question_id": 50483901, "link": "https://stackoverflow.com/questions/50483901/rails-activestorage-error-messageverifier-invalidsignature/51110900#51110900", "title": "Rails ActiveStorage Error - MessageVerifier-InvalidSignature", "body": "<p>You need to assign the signature (in <code>params[:signed_blob_id]</code>) to the instance as the example from <a href=\"http://edgeapi.rubyonrails.org/classes/ActiveStorage/Attached/One.html#method-i-attach\" rel=\"nofollow noreferrer\">the docs</a> illustrates.</p>\n\n<p>So, like this:</p>\n\n<pre><code>@location.photos.attach(params[:signed_blob_id]) # Signed reference to blob from direct upload\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "is_accepted": false, "score": 20, "last_activity_date": 1537202395, "last_edit_date": 1537202395, "creation_date": 1530346526, "answer_id": 51113082, "question_id": 50483901, "link": "https://stackoverflow.com/questions/50483901/rails-activestorage-error-messageverifier-invalidsignature/51113082#51113082", "title": "Rails ActiveStorage Error - MessageVerifier-InvalidSignature", "body": "<p>Make sure to add <code>multipart: true</code> in <code>form_tag</code>. It generates <code>enctype=\"multipart/form-data\"</code>.</p>\n\n<p><code>form_tag</code> by default not responsible for it, must have it (if attaching a file).</p>\n\n<blockquote>\n  <p>multipart/form-data   No characters are encoded. This value is required\n  when you are using forms that have a file upload control</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/MPvaY.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/MPvaY.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Form:</strong></p>\n\n<pre><code>&lt;%= form_tag attach_photo_location_path(@location), method: :put, multipart: true do %&gt;\n  &lt;%= label_tag :photo %&gt;\n  &lt;%= file_field_tag :photo %&gt;\n\n  &lt;%= submit_tag \"Upload\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Also:</strong></p>\n\n<p>Change <code>post</code> to <code>put</code> method, We are updating not creating <a href=\"http://www.restapitutorial.com/lessons/idempotency.html\" rel=\"noreferrer\">Idempotency</a></p>\n\n<pre><code>resources :locations do\n  member do\n    put :attach_photo\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 742, "user_id": 5328443, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MIICt.png?s=128&g=1", "display_name": "slehmann36", "link": "https://stackoverflow.com/users/5328443/slehmann36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8238, "favorite_count": 1, "answer_count": 2, "score": 11, "last_activity_date": 1537202395, "creation_date": 1527065482, "last_edit_date": 1537202338, "question_id": 50483901, "link": "https://stackoverflow.com/questions/50483901/rails-activestorage-error-messageverifier-invalidsignature", "title": "Rails ActiveStorage Error - MessageVerifier-InvalidSignature", "body": "<p>I'm working on a project that requires an <code>ActiveStorage</code> <code>has_many_attached :photos</code> situation on a <code>Location</code> model.</p>\n\n<p>I have the code set up below, but when attempting to upload a form, I receive the following error:</p>\n\n<pre><code>ActiveSupport::MessageVerifier::InvalidSignature in \n                                 LocationsController#attach_photo\n</code></pre>\n\n<p>Is this the way to \"add\" a file to the set of attachments for a particular parent record (i.e: a <code>Location</code> record)?</p>\n\n<h3><code>Location</code> Model</h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Location &lt; ApplicationRecord\n  ...\n  has_many_attached :photos\n  ...\nend\n</code></pre>\n\n<h3>Locations Controller</h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class LocationsController &lt; ApplicationController\n  ...\n  def attach_photo\n    @location = Location.find(params[:id])\n    @location.photos.attach(params[:photo])\n    redirect_to location_path(@location)\n  end\n  ...\nend\n</code></pre>\n\n<h3>View</h3>\n\n<pre><code>&lt;%= form_tag attach_photo_location_path(@location) do %&gt;\n  &lt;%= label_tag :photo %&gt;\n  &lt;%= file_field_tag :photo %&gt;\n\n  &lt;%= submit_tag \"Upload\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<h3>View</h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code>resources :locations do\n  member do\n    post :attach_photo\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1527066513, "post_id": 50483866, "comment_id": 87981468, "body": "Your title and question don&#39;t match at all. Are you asking about how to send a POST, or how to get a cookie?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1527066638, "post_id": 50483866, "comment_id": 87981547, "body": "<code>data[Account][username]=myusername&amp;data[Account][passwd]=myp&zwnj;&#8203;assword</code> is not <code>text&#47;html</code> in the least."}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1527066915, "post_id": 50483866, "comment_id": 87981754, "body": "@Flimzy, actually, I am not sure how to send the post, so I can get the cookie. I don&#39;t know why to cause this problem. It might have some error of post, it might have errors when getting the cookie."}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1527066988, "post_id": 50483866, "comment_id": 87981818, "body": "@mkopriva, I post in google chrome, and it states the content type is <code>text&#47;html</code>.  So what is the correct format of <code>data[Account][username]=myusername&amp;data[Account][passwd]=myp&zwnj;&#8203;assword</code> ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1527067082, "post_id": 50483866, "comment_id": 87981880, "body": "@CodaChang, if the Content-Type header is not set manually, ruby&#39;s http.post(path, data) sets it automatically to <code>application&#47;x-www-form-urlencoded</code>. <a href=\"https://ruby-doc.org/stdlib-2.1.1/libdoc/net/http/rdoc/Net/HTTP.html#method-i-post\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.1.1/libdoc/net/http/rdoc/Net/&hellip;</a>"}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1527067508, "post_id": 50483866, "comment_id": 87982209, "body": "Thanks, it seems the website take both <code>application&#47;x-www-form-urlencoded</code> and <code>text&#47;html</code> as well."}], "answers": [{"tags": [], "owner": {"reputation": 1014, "user_id": 61360, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/70602c12ed1c06db5165ff6a88cd38e0?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Insaurralde", "link": "https://stackoverflow.com/users/61360/mat%c3%adas-insaurralde"}, "is_accepted": true, "score": 13, "last_activity_date": 1527066173, "creation_date": 1527066173, "answer_id": 50484129, "question_id": 50483866, "link": "https://stackoverflow.com/questions/50483866/get-cookie-from-golang-post/50484129#50484129", "title": "Get cookie from Golang post", "body": "<p>To get the cookies you should call the <code>Cookies()</code> method that's part of <code>http.Response</code>, try this:</p>\n\n<pre><code>for _, cookie := range resp.Cookies() {\n  fmt.Println(\"Found a cookie named:\", cookie.Name)\n}\n</code></pre>\n\n<p>See the <code>Cookie</code> fields <a href=\"https://golang.org/pkg/net/http/#Cookie\" rel=\"noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 11048506, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aPzcWUxDzLQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNYAqJ-FvOa4I3E5729rOhDbY5R7g/mo/photo.jpg?sz=128", "display_name": "Muhammed Sertkaya", "link": "https://stackoverflow.com/users/11048506/muhammed-sertkaya"}, "is_accepted": false, "score": 6, "last_activity_date": 1576031122, "creation_date": 1576031122, "answer_id": 59278048, "question_id": 50483866, "link": "https://stackoverflow.com/questions/50483866/get-cookie-from-golang-post/59278048#59278048", "title": "Get cookie from Golang post", "body": "<p>//Create Client</p>\n\n<pre><code>client=http.client{}\n</code></pre>\n\n<p>//Create Varible </p>\n\n<pre><code>var cookie []*http.Cookie\n</code></pre>\n\n<p>//  Create Request</p>\n\n<pre><code>req, _ := http.NewRequest(\"GET\", url, nil)\nresp, err := client.Do(req) //send request\nif err != nil {\nreturn \n}\ncookie = resp.Cookies() //save cookies\n</code></pre>\n\n<p>//  Create New Request</p>\n\n<pre><code>req, _ := http.NewRequest(\"POST\", url, nil)   \nfor i := range cookie {\n    req.AddCookie(cookie[i])\n}\nresp, err := client.Do(req) //send request\nif err != nil {\n      return \n              }\n</code></pre>\n"}], "owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12646, "favorite_count": 2, "accepted_answer_id": 50484129, "answer_count": 2, "score": 8, "last_activity_date": 1576031122, "creation_date": 1527065396, "question_id": 50483866, "link": "https://stackoverflow.com/questions/50483866/get-cookie-from-golang-post", "title": "Get cookie from Golang post", "body": "<p>How do I send the post in GoLang?</p>\n\n<p>I have the following code in <code>ruby</code>, now I need to transfer into Golang.</p>\n\n<pre><code>http = Net::HTTP.new('example.com', 443)\nhttp.use_ssl = true\nhttp\n\npath = '/abc/login'\ndata = 'data[Account][username]=myusername&amp;data[Account][passwd]=mypassword'\nresp, _ = http.post(path, data)\n</code></pre>\n\n<p>This way, I can get the cookie after login request.</p>\n\n<p>But I don't know how to send a post request in Go.</p>\n\n<p>I've written the following code.</p>\n\n<pre><code>path := \"https://example.com/abc/login\"\ndata := strings.NewReader(\"data[Account][username]=myusername&amp;data[Account][passwd]=mypassword\")\nresp, err := http.Post(path, \"text/html; charset=UTF-8\", data)\n</code></pre>\n\n<p>It seems not correct, because I didn't find a way to get cookie.</p>\n"}, {"tags": ["c++", "ruby"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1527064035, "post_id": 50483344, "comment_id": 87979787, "body": "Packages, libraries."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1527067182, "post_id": 50483344, "comment_id": 87981955, "body": "I suggest to check this <a href=\"https://stackoverflow.com/questions/924485/whats-the-difference-between-a-header-file-and-a-library\">topic</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7539264, "user_type": "registered", "profile_image": "https://graph.facebook.com/550165537/picture?type=large", "display_name": "Torsten Martinsen", "link": "https://stackoverflow.com/users/7539264/torsten-martinsen"}, "is_accepted": false, "score": 2, "last_activity_date": 1527065958, "creation_date": 1527065958, "answer_id": 50484044, "question_id": 50483344, "link": "https://stackoverflow.com/questions/50483344/what-is-the-equivalent-of-gems-of-ruby-in-c/50484044#50484044", "title": "What is the equivalent of GEMS of RUBY in C++?", "body": "<p>In languages such as Ruby and Java you merely 'require' or similar a package (which is called a gem in Ruby). In C++, you generally need both to #include one or more header files, and also to link with a (dynamic or static) library.</p>\n"}], "owner": {"reputation": 45, "user_id": 9833158, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sainath", "link": "https://stackoverflow.com/users/9833158/sainath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "closed_date": 1527081815, "answer_count": 1, "score": 0, "last_activity_date": 1527065958, "creation_date": 1527063817, "last_edit_date": 1527064116, "question_id": 50483344, "link": "https://stackoverflow.com/questions/50483344/what-is-the-equivalent-of-gems-of-ruby-in-c", "closed_reason": "Needs more focus", "title": "What is the equivalent of GEMS of RUBY in C++?", "body": "<p>I feel that header files which  i include in c++ acts as equivalents of GEMS in ruby but i am not sure.A brief description of gems along the lines of c++ will be helpful</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 16960, "user_id": 274354, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2b145518aa5a6dbf09cc9ef7c7ae428b?s=128&d=identicon&r=PG", "display_name": "mydoghasworms", "link": "https://stackoverflow.com/users/274354/mydoghasworms"}, "edited": false, "score": 0, "creation_date": 1527058806, "post_id": 50481599, "comment_id": 87976558, "body": "Thanks, the .fetch solution is great, but I don&#39;t understand what you did differently in your second solution. It&#39;s the same as what I had in my question, except for the double pipe. It&#39;s still invalid syntax (at least in IRB; I haven&#39;t tried it in a script)."}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 16960, "user_id": 274354, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2b145518aa5a6dbf09cc9ef7c7ae428b?s=128&d=identicon&r=PG", "display_name": "mydoghasworms", "link": "https://stackoverflow.com/users/274354/mydoghasworms"}, "edited": false, "score": 0, "creation_date": 1527059079, "post_id": 50481599, "comment_id": 87976695, "body": "The double pipe makes it a short-circuiting &#39;or&#39;; the parentheses on the <code>raise</code> fix the syntax error."}, {"owner": {"reputation": 16960, "user_id": 274354, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2b145518aa5a6dbf09cc9ef7c7ae428b?s=128&d=identicon&r=PG", "display_name": "mydoghasworms", "link": "https://stackoverflow.com/users/274354/mydoghasworms"}, "edited": false, "score": 0, "creation_date": 1527060092, "post_id": 50481599, "comment_id": 87977248, "body": "Oh, brilliant. I didn&#39;t notice that little detail! :-) Thanks, answer accepted!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1527062708, "post_id": 50481599, "comment_id": 87978943, "body": "This would be the only situation where it&#39;s acceptable to use <code>or</code> over <code>||</code>. Can omit the parentheses then too."}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 3, "last_activity_date": 1527058192, "creation_date": 1527058192, "answer_id": 50481599, "question_id": 50481505, "link": "https://stackoverflow.com/questions/50481505/how-do-i-raise-an-exception-if-an-evaluation-returns-nil-in-ruby/50481599#50481599", "title": "How do I raise an exception if an evaluation returns nil in Ruby?", "body": "<p><code>dict.fetch(lookup_value)</code> is like <code>dict[lookup_value]</code>, but will raise if the key was missing.</p>\n\n<p>You can also do approximately what you have in the question, with a couple of tweaks: <code>dict[lookup_value] || raise('not found')</code> -- that gives you control of the exception.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1527060674, "last_edit_date": 1527060674, "creation_date": 1527059727, "answer_id": 50482080, "question_id": 50481505, "link": "https://stackoverflow.com/questions/50481505/how-do-i-raise-an-exception-if-an-evaluation-returns-nil-in-ruby/50482080#50482080", "title": "How do I raise an exception if an evaluation returns nil in Ruby?", "body": "<p>This should fix the nil return when a value is found.</p>\n\n<p>Changing this:</p>\n\n<pre><code>res = (raise 'not found' unless dict[lookup_value])\n</code></pre>\n\n<p>into this:</p>\n\n<pre><code>raise 'not found' unless res = dict[lookup_value]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1527063295, "post_id": 50482868, "comment_id": 87979307, "body": "No need to add a block here. The documentation says the following: &quot;With no other arguments, it will raise a KeyError exception&quot;. <a href=\"https://ruby-doc.org/core-2.5.1/Hash.html#method-i-fetch\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.1/Hash.html#method-i-fetch</a>"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1527063462, "post_id": 50482868, "comment_id": 87979416, "body": "@JohanWentholt yeah, I know it, but as I understand, OP is asking how to raise his own error."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1527063527, "post_id": 50482868, "comment_id": 87979453, "body": "Ah, I missed that part."}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1527063647, "post_id": 50482868, "comment_id": 87979535, "body": "@JohanWentholt ;)"}], "tags": [], "owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1527062205, "creation_date": 1527062205, "answer_id": 50482868, "question_id": 50481505, "link": "https://stackoverflow.com/questions/50481505/how-do-i-raise-an-exception-if-an-evaluation-returns-nil-in-ruby/50482868#50482868", "title": "How do I raise an exception if an evaluation returns nil in Ruby?", "body": "<p>In addition to @matthewd, you can control <code>raise</code> with <code>fetch</code> in this way:</p>\n\n<pre><code>dict.fetch(lookup_value) { raise 'not found' }\n</code></pre>\n"}], "owner": {"reputation": 16960, "user_id": 274354, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2b145518aa5a6dbf09cc9ef7c7ae428b?s=128&d=identicon&r=PG", "display_name": "mydoghasworms", "link": "https://stackoverflow.com/users/274354/mydoghasworms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1065, "favorite_count": 0, "accepted_answer_id": 50481599, "answer_count": 3, "score": 0, "last_activity_date": 1527062205, "creation_date": 1527057916, "question_id": 50481505, "link": "https://stackoverflow.com/questions/50481505/how-do-i-raise-an-exception-if-an-evaluation-returns-nil-in-ruby", "title": "How do I raise an exception if an evaluation returns nil in Ruby?", "body": "<p>I want to do something along the lines of this:</p>\n\n<pre><code>lookup_value = :f\ndict = {a: 20, b: 30, c: 40}\nres = dict[lookup_value] | raise 'not found'\n</code></pre>\n\n<p>As in the above example, if the key is not found in the dictionary, I want to raise an error. I <em>could</em> just have an additional line which says <code>raise 'not found' unless res</code>, but I <em>really</em> want to use the lookup in an expression:</p>\n\n<pre><code>output = 'prefix' + (dict[lookup_value] | raise 'not found')\n</code></pre>\n\n<p>The problem is that using <code>raise</code> in this way is not valid syntax. I am looking for a way that I can raise an error in an expression if the lookup of the value in the hash fails without having to declare additional variables or do a check beforehand.</p>\n\n<p>The following is valid syntax and will throw an exception if the value is not found, but returns nil when a value is found:</p>\n\n<pre><code>res = (raise 'not found' unless dict[lookup_value])\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 777, "user_id": 1971586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f6027e3a9bb7094bd38fc08be15af55?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/1971586/brian"}, "edited": false, "score": 0, "creation_date": 1527082089, "post_id": 50482450, "comment_id": 87992177, "body": "Thanks for the response!  I&#39;m not quite sure what you mean by &quot;later called methods&quot; and &quot;require time&quot;.  Is there a bottom-up resolution of symbols during runtime?  I guess I always assumed all was loaded into the main <code>$.</code> scope and things were executed based on that?"}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 777, "user_id": 1971586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f6027e3a9bb7094bd38fc08be15af55?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/1971586/brian"}, "edited": false, "score": 1, "creation_date": 1527083249, "post_id": 50482450, "comment_id": 87993054, "body": "I expanded the explanation in the answer, does that help? (One shouldn&#39;t actually use class variables, incidentally -- that was just an easy super-short example of how one might encounter a deferrable reference.)"}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1527083223, "last_edit_date": 1527083223, "creation_date": 1527060937, "answer_id": 50482450, "question_id": 50481267, "link": "https://stackoverflow.com/questions/50481267/requiring-multiple-modules-in-one-project-gem/50482450#50482450", "title": "Requiring multiple modules in one project/gem", "body": "<p><code>cli_starter.rb</code> is referencing <code>Command1</code> at require time, before the other files have been loaded: there's no separate resolution step.</p>\n\n<p>The additional <code>require_relative</code> calls ensure those files are loaded first, so their constants are available while <code>cli_starter.rb</code> is getting loaded.</p>\n\n<p>The various forms of <code>require</code> are essentially equivalent to inserting the content of the file at that point in the code (if it hasn't already been required).</p>\n\n<p>So (depending on the order <code>Dir[]</code> finds the files from your glob), the overall failing execution looks something like:</p>\n\n<pre><code>module MyThorCLI\n  class Base &lt; Thor\n    Command1 ...\n  end\nend\n\nclass Command1\nend\n</code></pre>\n\n<p>With no separate resolution step, this fails when it hits the <code>Command1</code> reference, because the class definition hasn't been encountered yet -- it's several lines below.</p>\n\n<hr>\n\n<p>Adding those requires is a perfectly reasonable solution to the problem. The potentially tricker approach is to change the contents of <code>cli_starter.rb</code> so it doesn't reference the other constants until later (by putting those references inside later-called methods, instead of directly inside the class body). Whether that's feasible depends on what your class body is doing with them.</p>\n\n<pre><code>class Base ..\n  @@first_command = Command1 # this reference is evaluated when it's encountered\n  def first_command\n    @@first_command\n  end\n\n# --&gt;\n\nclass Base ..\n  def first_command\n    Command1 # this one is evaluated when the method is called\n  end\n</code></pre>\n"}], "owner": {"reputation": 777, "user_id": 1971586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f6027e3a9bb7094bd38fc08be15af55?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/1971586/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 50482450, "answer_count": 1, "score": 0, "last_activity_date": 1527083223, "creation_date": 1527057056, "last_edit_date": 1527059647, "question_id": 50481267, "link": "https://stackoverflow.com/questions/50481267/requiring-multiple-modules-in-one-project-gem", "title": "Requiring multiple modules in one project/gem", "body": "<p>I have a project with the following structure:</p>\n\n<pre><code>Project\n\u251c\u2500\u2500 lib\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 project.rb\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 thor_commands\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 cli_starter.rb\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 command1.rb\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 command2.rb\n\u2514\u2500\u2500 runme\n</code></pre>\n\n<p><strong>runme</strong></p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire_relative 'lib/project.rb'\n</code></pre>\n\n<p><strong>project.rb:</strong></p>\n\n<pre><code>Dir[File.dirname(__FILE__) + '/thor_commands/*.rb'].each { |file| require file }\n</code></pre>\n\n<p><strong>cli_starter.rb</strong></p>\n\n<pre><code>require_relative command1.rb  # Why do I need these\nrequire_relative command2.rb  #\n\nmodule MyThorCLI\n  class Base &lt; Thor\n    Command1 ...\n  end\nend\n</code></pre>\n\n<p>If I run something like <code>runme cmd1</code> without <code>require_relative command1</code> and <code>require_relative command2</code> in <code>cli_starter.rb</code>, I get an error: <code>uninitialized constant MyThorCLI::Base::Command1</code>.</p>\n\n<p>I'm trying to understand why I need to <code>require_relative command1</code> and <code>require_relative command2</code> although everything were already required in <code>project.rb</code>.</p>\n\n<p>It looks to me that modules and classes in those modules should be loaded during run time, but it failed.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "controller", "rspec-rails"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1527056211, "post_id": 50480945, "comment_id": 87975183, "body": "What is your question?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1527056667, "post_id": 50480945, "comment_id": 87975402, "body": "if one of the tests is failing, please say which it is and include the output in the question. Currently it&#39;s too broad."}, {"owner": {"reputation": 89, "user_id": 9489349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311f6f5bab6da02e18d5819a55a77bbd?s=128&d=identicon&r=PG&f=1", "display_name": "Harini", "link": "https://stackoverflow.com/users/9489349/harini"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1527057854, "post_id": 50480945, "comment_id": 87976041, "body": "sorry for the improper details, now i have updated the question.  @maxpleaner"}], "owner": {"reputation": 89, "user_id": 9489349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311f6f5bab6da02e18d5819a55a77bbd?s=128&d=identicon&r=PG&f=1", "display_name": "Harini", "link": "https://stackoverflow.com/users/9489349/harini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527057776, "creation_date": 1527055649, "last_edit_date": 1527057776, "question_id": 50480945, "link": "https://stackoverflow.com/questions/50480945/rspec-for-the-controller-without-factory-girl", "title": "rspec for the controller without factory girl", "body": "<p>I am trying to write spec code for my controller it gets failed. And i am not sure where it gets failed.</p>\n\n<p>Controller Code</p>\n\n<pre><code>def index\n    @users = User.all\n  end\n\n  def update\n    authorize! :update, @user\n    respond_to do |format|\n      if @user.update(user_params)\n        format.html { redirect_to user_index_path }\n      else\n        format.html { render :index }\n      end\n    end\n  end\n\n  private\n\n  def set_user\n    @user = User.find(params[:id])\n  end\n\n  def user_params\n    params.permit(:active)\n  end\n</code></pre>\n\n<p>Spec Code for the above controller</p>\n\n<pre><code>RSpec.describe UserController, type: :controller do\n    describe 'GET #index' do\n      let(:user) {User.create!(name: \"hari\")}\n      context 'with user details'do\n        it 'loads correct user details' do\n          get :index\n\n      expect(response).to permit(:user)\n    end\n      end\n\n      context 'without user details' do\n        it 'doesnot loads correct user details' do\n          get :index\n\n        expect(response).not_to permit(:user)\n      end\n    end\n    end\n\n    describe 'Patch #update' do\n\n      context 'when valid params' do\n        let(:attr) do\n          {active: 'true'}\n        end\n\n        before(:each) do\n       @user = subject.current_user\n       put :update, params: { user: attr }\n       @user.reload\n     end\n\n     it 'redirects to user_index_path ' do\n       expect(response).redirect_to(user_index_path)\n     end\n\n     it 'sets active state' do\n       expect(@user.active?('true')).to be true\n     end\n   end\n\n   context 'when invalid param' do\n     let(:attr) do\n       {active: 'nil'}\n     end\n\n     before(:each) do\n       @user = subject.current_user\n       put :update, params: { user: attr }\n       @user.reload\n     end\n\n     it 'render index' do\n       expect(respone.status).to eq(200)\n     end\n\n     it 'doesnot change active state' do\n       expect(@user.active?(nil)).to be true\n     end\n   end\n  end\n end\n</code></pre>\n\n<p>I  am just a beginner and tried the spec code for my controller by checking <a href=\"https://relishapp.com/rspec/rspec-rails/docs/gettingstarted\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-rails/docs/gettingstarted</a>. Can you help me where my spec goes wrong or could anyone give me a few test examples for these methods or could redirect me to an rspec guide? the index method is getting failed \nand my </p>\n\n<p>terminal log is </p>\n\n<pre><code>1) UserController GET #index with user details loads correct user details\n     Failure/Error: expect(response).to permit(:user)\n\n     NoMethodError:\n       undefined method `permit' for #&lt;RSpec::ExampleGroups::UserController::GETIndex::WithUserDetails:0x00005614152406b0&gt;\n       Did you mean?  print\n     # ./spec/controllers/user_controller_spec.rb:10:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "permissions", "rubygems", "rbenv"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1527050568, "post_id": 50479426, "comment_id": 87973214, "body": "What is your question?"}, {"owner": {"reputation": 4690, "user_id": 170527, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d58a042e02e02b72aa35e3e1181a7a6f?s=128&d=identicon&r=PG", "display_name": "map7", "link": "https://stackoverflow.com/users/170527/map7"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1527053302, "post_id": 50479426, "comment_id": 87974062, "body": "Added clarification of my question to the end."}, {"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1527836555, "post_id": 50479426, "comment_id": 88285540, "body": "Do you want them to share gems or have a possibility to have individual gems?"}, {"owner": {"reputation": 4690, "user_id": 170527, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d58a042e02e02b72aa35e3e1181a7a6f?s=128&d=identicon&r=PG", "display_name": "map7", "link": "https://stackoverflow.com/users/170527/map7"}, "edited": false, "score": 0, "creation_date": 1528091319, "post_id": 50479426, "comment_id": 88357697, "body": "Share gems. I don&#39;t want to keep two copies on the same machine, so this is why I&#39;ve created a system install of rubies"}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 4789458, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-639ZDwotd9k/AAAAAAAAAAI/AAAAAAAAAN0/bVPioucvwK8/photo.jpg?sz=128", "display_name": "Sebastian Sangervasi", "link": "https://stackoverflow.com/users/4789458/sebastian-sangervasi"}, "is_accepted": false, "score": 2, "last_activity_date": 1528389918, "creation_date": 1528389918, "answer_id": 50746403, "question_id": 50479426, "link": "https://stackoverflow.com/questions/50479426/rbenv-system-wide-install-results-in-insecure-operation/50746403#50746403", "title": "rbenv system wide install results in insecure operation", "body": "<p>I took a look at the source code for RubyGems <code>config_file</code>. The error you're encountering is caused by <a href=\"https://github.com/rubygems/rubygems/blob/master/lib/rubygems/config_file.rb#L231\" rel=\"nofollow noreferrer\">this file operation</a> trying to read <code>$HOME/.gem/credentials</code> (which is hard-coded <a href=\"https://github.com/rubygems/rubygems/blob/master/lib/rubygems/config_file.rb#L261\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>Based on this, you could try giving rbenv permission to read <code>$HOME/.gem/credentials</code> for one user and see if that allows the user to install a gem.</p>\n\n<p>However, exposing anything called \"credentials\" to all users seems like a dangerous proposition.</p>\n\n<p>My understanding is that the credentials file only needs to contain real credentials if you're trying to <a href=\"https://guides.rubygems.org/publishing/\" rel=\"nofollow noreferrer\">publish gems</a>, but can be empty for most installs. As this is a shared machine, you're already expecting people to trample on each other's gems occasionally, so giving rbenv access to all gem credentials may be acceptable for you...</p>\n\n<p>Until it's not. You mentioned that you \"don't want to keep two copies on the same machine\" but this is more difficult than it seems. Every programming language has a slightly different tool for avoiding <a href=\"https://en.wikipedia.org/wiki/Dependency_hell\" rel=\"nofollow noreferrer\">Dependency Hell</a>, but many stick to one pattern: every code project gets its copy of all its dependencies. On my machine I have at least five copies of Rails installed by <a href=\"https://bundler.io/docs.html\" rel=\"nofollow noreferrer\">Bundler</a>, across two or three versions. I don't worry about the disk space, I'm just happy I don't have to sort through a thousand dependencies by hand.</p>\n"}], "owner": {"reputation": 4690, "user_id": 170527, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d58a042e02e02b72aa35e3e1181a7a6f?s=128&d=identicon&r=PG", "display_name": "map7", "link": "https://stackoverflow.com/users/170527/map7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1528424132, "creation_date": 1527046606, "last_edit_date": 1528424132, "question_id": 50479426, "link": "https://stackoverflow.com/questions/50479426/rbenv-system-wide-install-results-in-insecure-operation", "title": "rbenv system wide install results in insecure operation", "body": "<p>We use thin clients at our company and we have many users using the same box. I've installed rbenv as a system install by following the instructions on the following website;</p>\n\n<p><a href=\"https://blakewilliams.me/posts/system-wide-rbenv-install\" rel=\"nofollow noreferrer\">https://blakewilliams.me/posts/system-wide-rbenv-install</a></p>\n\n<p>This boils down to these commands</p>\n\n<pre><code>cd /usr/local\ngit clone git://github.com/sstephenson/rbenv.git rbenv\nchgrp -R staff rbenv\nchmod -R g+rwxXs rbenv\n</code></pre>\n\n<p>By running the last line there we should be able to install gems as any user of the system which is part of the 'staff' group. We have two developers which are part of that group and neither can install gems.</p>\n\n<p>We get the error;</p>\n\n<pre><code>~ % gem install cheat         \n/usr/local/rbenv/versions/2.3.5/lib/ruby/2.3.0/rubygems/config_file.rb:332:in `exist?': Insecure operation - exist? (SecurityError)\n    from /usr/local/rbenv/versions/2.3.5/lib/ruby/2.3.0/rubygems/config_file.rb:332:in `load_file'\n    from /usr/local/rbenv/versions/2.3.5/lib/ruby/2.3.0/rubygems/config_file.rb:198:in `initialize'\n    from /usr/local/rbenv/versions/2.3.5/lib/ruby/2.3.0/rubygems/gem_runner.rb:75:in `new'\n    from /usr/local/rbenv/versions/2.3.5/lib/ruby/2.3.0/rubygems/gem_runner.rb:75:in `do_configuration'\n    from /usr/local/rbenv/versions/2.3.5/lib/ruby/2.3.0/rubygems/gem_runner.rb:40:in `run'\n    from /usr/local/rbenv/versions/2.3.5/bin/gem:21:in `&lt;main&gt;'\n~ % gem install cheat\n</code></pre>\n\n<p>If I remove the sticky bit from the group then they can add gems but if someone tries to remove a gem installed by someone else this will fail;</p>\n\n<pre><code>~ % chmod -R g-s rbenv\n</code></pre>\n\n<p>How do I allow multiple users install/uninstall gems from a system wide installation of rbenv?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here is an example of installations in the <code>/usr/local/rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems</code> directory, as you can see </p>\n\n<pre><code>drwxrwxr-x   5 map7  map7  4.0K Jun  4 15:50 unicode-display_width-1.3.3\ndrwxrwxr-x   5 andre andre 4.0K May 23 13:22 vcr-3.0.3\ndrwxrwxr-x   3 map7  staff 4.0K Apr 30 11:01 web-console-3.6.2\n</code></pre>\n\n<p>The solution to this I found as</p>\n\n<pre><code>  : cd /usr/local/rbenv/versions/2.5.1/lib/ruby/gems/2.5.0\n  : sudo chown -R map7:staff gems\n  : sudo chmod -R 775 gems\n  : sudo chmod g+s gems\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1527047047, "post_id": 50478530, "comment_id": 87972433, "body": "You might also be interested in <a href=\"https://ruby-doc.org/core/Array.html#method-i-dig\" rel=\"nofollow noreferrer\"><code>Array#dig</code></a>, which does something similar to how you want to use <code>get_value</code>: <code>@array.dig(0, 1) # =&gt; 0</code>, <code>@array.dig(0) # =&gt; [0, 0, 0]</code>; though if you have an array you need to decompose it: <code>@array.dig(*position_array)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527060068, "post_id": 50478897, "comment_id": 87977234, "body": "Even with <code>prepend</code>, you&#39;re modifying <code>Array</code> globally. Not sure if that qualifies as &quot;non-invasively&quot;."}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527085640, "post_id": 50478897, "comment_id": 87994714, "body": "Sure.  Subclass Array... and then deal with having to work with instances of your Thing instead of just using Arrays.  You could do that too."}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527086210, "post_id": 50478897, "comment_id": 87995153, "body": "@Stefan as opposed to reopening the class Array and redefining [] in its entirety, prepend is relatively non-invasive, which is what I was thinking when I wrote that."}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527086310, "post_id": 50478897, "comment_id": 87995216, "body": "Ah, I think the spirit of the question and his followup questions led me to believe that he <i>wanted</i> to change the behavior of the Array class.  He was puzzled as it why it wasn&#39;t changed...."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527086815, "post_id": 50478897, "comment_id": 87995562, "body": "I think the OP wanted to change the behavior of <code>Array#[]</code> within the <code>Thing</code> class only. Maybe refinements could help to achieve that (I haven&#39;t used them much)."}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1527127211, "post_id": 50478897, "comment_id": 88012380, "body": "I cannot think of a way to do that short of having the <code>Thing</code> <i>and</i> a subclass of <code>Array</code>, which would not be simple."}], "tags": [], "owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1527043339, "last_edit_date": 1527043339, "creation_date": 1527041926, "answer_id": 50478897, "question_id": 50478530, "link": "https://stackoverflow.com/questions/50478530/why-index-self-instead-of-instance-variable-in-bracket-method/50478897#50478897", "title": "Why index self instead of instance variable in bracket method", "body": "<p>You <em>could</em> use a prepended method to non-invasively override the [] method in Array by duck-typing the parameter passed to the [] method, and then calling the original if its not what you expect.  Then you don't need a <code>Thing</code> object at all.</p>\n\n<pre><code>module MyArrayExtension\n  def [] (*param)\n    if param.size == 2\n      row, col = param\n      raise ArgumentError, 'Row must be an integer' if row.class != Integer\n      raise ArgumentError, 'Column must be an integer' if col.class != Integer\n      raise ArgumentError, \"Element at row #{row} is not an array\" if self[row].class != Array\n      self[row][col]\n    else\n      super\n    end\n  end\nend\n\nclass Array\n  prepend MyArrayExtension\nend\n\nthing = [[1,2,3],[4,5,6]]\nputs \"The 2D array is: #{thing}\"\nputs \"Extension used on the thing to get at element 1 of first array:\"\nputs thing[0,1]\n\nputs '-' * 20\n\nnormal = [1,2,:blah,4,5]\nputs \"Normal array is #{normal}\"\nputs \"Original [] method used to get the 3rd element:\"\nputs normal[2]\n\nputs '-' * 20\nputs \"Using the extension on the non-2D array:\"\nputs normal[0,1]\n</code></pre>\n\n<p>The output of this program is:</p>\n\n<pre><code>The 2D array is: [[1, 2, 3], [4, 5, 6]]\nExtension used on the thing to get at element 1 of first array:\n2\n--------------------\nNormal array is [1, 2, :blah, 4, 5]\nOriginal [] method used to get the 3rd element:\nblah\n--------------------\nUsing the extension on the non-2D array:\n./test.rb:9:in `[]': Element at row 0 is not an array (ArgumentError)\n    from ./test.rb:35:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1527060361, "last_edit_date": 1527060361, "creation_date": 1527059752, "answer_id": 50482089, "question_id": 50478530, "link": "https://stackoverflow.com/questions/50478530/why-index-self-instead-of-instance-variable-in-bracket-method/50482089#50482089", "title": "Why index self instead of instance variable in bracket method", "body": "<p>Just think of <em>message</em> and <em>receiver</em>.</p>\n\n<p><code>@array[position_array]</code> sends the message <code>[]</code> to the receiver <code>@array</code>. <code>@array</code> is an instance of <code>Array</code>, so the method <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-5B-5D\" rel=\"nofollow noreferrer\"><code>Array#[]</code></a> gets invoked.</p>\n\n<p><code>self[position_array]</code> sends the message <code>[]</code> to the receiver <code>self</code>. Within instance methods, <code>self</code> refers to that instance. And because <code>self</code> is an instance of <code>Thing</code>, the method <code>Thing#[]</code> gets invoked.</p>\n\n<p>Since <code>Thing</code> is a subclass of <code>Object</code> and not a subclass of <code>Array</code> (nothing wrong here, you shouldn't subclass <code>Array</code> anyway), your implementation of <code>[]</code> does <em>not</em> override <code>Array#[]</code>. Both methods are totally independent of each other, just like <code>String#[]</code> or <code>Hash#[]</code>.</p>\n\n<p>This is how I would approach it:</p>\n\n<pre><code>class Thing\n  def initialize\n    @array = [[1, 2, 3], [4, 5, 6]]\n  end\n\n  def [](i, j)\n    @array[i][j]\n  end\nend\n\nthing = Thing.new\nthing[0, 1] #=&gt; 2\nthing[1, 1] #=&gt; 5\n</code></pre>\n"}], "owner": {"reputation": 870, "user_id": 6084667, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/1b758f31cf4fabf9fdc34f7a5e4f1222?s=128&d=identicon&r=PG&f=1", "display_name": "Senyokbalgul", "link": "https://stackoverflow.com/users/6084667/senyokbalgul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 50482089, "answer_count": 2, "score": -1, "last_activity_date": 1527060361, "creation_date": 1527038520, "last_edit_date": 1527052545, "question_id": 50478530, "link": "https://stackoverflow.com/questions/50478530/why-index-self-instead-of-instance-variable-in-bracket-method", "title": "Why index self instead of instance variable in bracket method", "body": "<p>I have:</p>\n\n<pre><code>class Thing\n  def initialize\n    @array = [[0, 0, 0], [1, 1, 1]]\n  end\nend\n\nthing = Thing.new\n</code></pre>\n\n<p>The normal way to access an element in <code>@array</code> is to use <code>[]</code> as in:</p>\n\n<pre><code>@array[0][1] # =&gt; 0\n</code></pre>\n\n<p>I am trying to overwrite <code>[]</code> so as to get results like this:</p>\n\n<pre><code>position_array = [0, 1]\n@array[position_array] # =&gt; 0\n</code></pre>\n\n<p>This is my attempt:</p>\n\n<pre><code>class Thing\n  def [](position_array)\n    index_row, index_col = position_array\n    @array[index_row][index_col]\n  end\n\n  def get_value(position_array)\n    @array[position_array]           # doesn't work\n    # self[position_array]           # does work\n  end\nend\n\nthing.get_value([0, 1])\n# &gt;&gt; 'get_value': no implicit conversion of Array into Integer (TypeError)\n</code></pre>\n\n<p>Why do I need to index the <code>Thing</code> object in order to index <code>@array</code>?</p>\n"}, {"tags": ["ruby", "tensorflow"], "comments": [{"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1528271189, "post_id": 50478312, "comment_id": 88438406, "body": "Probably you need run a global variable initialiser? <a href=\"https://stackoverflow.com/questions/44299666/when-global-variables-initializer-is-actually-required\" title=\"when global variables initializer is actually required\">stackoverflow.com/questions/44299666/&hellip;</a>. Not sure what is Ruby equivalent"}], "answers": [{"tags": [], "owner": {"reputation": 978, "user_id": 2510391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lKKhB.jpg?s=128&g=1", "display_name": "Wiwiweb", "link": "https://stackoverflow.com/users/2510391/wiwiweb"}, "is_accepted": true, "score": 0, "last_activity_date": 1529964476, "creation_date": 1529964476, "answer_id": 51032425, "question_id": 50478312, "link": "https://stackoverflow.com/questions/50478312/running-a-saved-model-on-tensorflow-rb/51032425#51032425", "title": "Running a saved model on tensorflow.rb", "body": "<p>It turned out to be a type mismatch. I saved the model to accept float32 variables. <a href=\"https://github.com/somaticio/tensorflow.rb/blob/master/lib/tensorflow/tensor.rb#L148\" rel=\"nofollow noreferrer\">tensorflow.rb created input tensors from Ruby's float type</a>, which is float64.</p>\n\n<p>Changing this:</p>\n\n<pre><code># Save the model under pb format\nfeatures = {'Float_input_1': tf.placeholder(tf.float32, shape=[1]),\n            'Float_input_2': tf.placeholder(tf.float32, shape=[1])}\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code># Save the model under pb format\nfeatures = {'Float_input_1': tf.placeholder(tf.float64, shape=[1]),\n            'Float_input_2': tf.placeholder(tf.float64, shape=[1])}\n</code></pre>\n\n<p>Fixed the problem.</p>\n"}], "owner": {"reputation": 978, "user_id": 2510391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lKKhB.jpg?s=128&g=1", "display_name": "Wiwiweb", "link": "https://stackoverflow.com/users/2510391/wiwiweb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 51032425, "answer_count": 1, "score": 6, "last_activity_date": 1529964476, "creation_date": 1527036395, "question_id": 50478312, "link": "https://stackoverflow.com/questions/50478312/running-a-saved-model-on-tensorflow-rb", "title": "Running a saved model on tensorflow.rb", "body": "<p>I built and saved a very simple model in Python using the high-level Estimator API (DNNClassifier). It takes 2 floats and outputs one of two classes. I'm trying to load it in Ruby using the <a href=\"https://github.com/somaticio/tensorflow.rb/issues/107\" rel=\"noreferrer\">tensorflow.rb gem</a>, and make a prediction with it. This should be very similar <a href=\"https://github.com/somaticio/tensorflow.rb/blob/master/examples/captcha/captcha.rb\" rel=\"noreferrer\">to the CAPTCHA example provided by tensorflow.rb</a>. </p>\n\n<p>I saved it using <code>export_saved_model</code>. Here is the Python code that trained the model. It can correctly predict the classes.</p>\n\n<p>import numpy as np\n    import pandas as pd\n    import tensorflow as tf</p>\n\n<pre><code>dataframe = pd.read_csv(\"remediations_import.csv\", sep=\",\")\ndataframe = dataframe.reindex(\n    np.random.permutation(dataframe.index))\n\nSTEPS = 5000\nBATCH_SIZE = 10\nSAVED_MODEL_FOLDER = 'saved_model'\nFEATURE_1 = 'Float_input_1'\nFEATURE_2 = 'Float_input_2'\nLABEL = \"Human_label\"\n\nmy_feature_data = dataframe[[FEATURE_1, FEATURE_2]]\ntargets = dataframe[LABEL]\n\nfeature_columns = [tf.feature_column.numeric_column(FEATURE_1),\n                   tf.feature_column.numeric_column(FEATURE_2)]\n\nfeatures = {key: np.array(value) for key, value in dict(my_feature_data).items()}\ntraining_input_fn = tf.estimator.inputs.numpy_input_fn(x=features,\n                                                       y=targets.as_matrix(),\n                                                       batch_size=BATCH_SIZE,\n                                                       shuffle=True)\n\nclassifier = tf.estimator.DNNClassifier(\n    feature_columns=feature_columns,\n    hidden_units=[10, 10],\n    n_classes=2,\n    model_dir=SAVED_MODEL_FOLDER)\n\nclassifier.train(\n    input_fn=training_input_fn,\n    steps=STEPS\n)\n\nprint(\"Model training finished.\")\n\n# Save the model under pb format\nfeatures = {'Float_input_1': tf.placeholder(tf.float32, shape=[1]),\n            'Float_input_2': tf.placeholder(tf.float32, shape=[1])}\nserving_input_receiver_fn = tf.estimator.export.build_raw_serving_input_receiver_fn(features,\n                                                                                    default_batch_size=None)\nclassifier.export_savedmodel(SAVED_MODEL_FOLDER + '_pb', serving_input_receiver_fn, strip_default_attrs=True)\n\n# Predict\nnew_features = pd.DataFrame({FEATURE_1: [0.97, 0.03], FEATURE_2: [1.00, -1.00]})\n# Convert pandas data into a dict of numpy arrays.\nfeatures = {key: np.array(value) for key, value in dict(new_features).items()}\nprediction_input_fn = tf.estimator.inputs.numpy_input_fn(x=features,\n                                                         num_epochs=1,\n                                                         shuffle=False)\n\npredictions_results = classifier.predict(input_fn=prediction_input_fn)\npredictions = np.array([item['class_ids'][0] for item in predictions_results])\nprint(predictions)\n</code></pre>\n\n<p>Looking at my saved model using <code>saved_model_cli</code> shows this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>MetaGraphDef with tag-set: 'serve' contains the following SignatureDefs:\n\nsignature_def['predict']:\n  The given SavedModel SignatureDef contains the following input(s):\n    inputs['Float_input_1'] tensor_info:\n        dtype: DT_FLOAT\n        shape: (-1)\n        name: Placeholder:0\n    inputs['Float_input_2'] tensor_info:\n        dtype: DT_FLOAT\n        shape: (-1)\n        name: Placeholder_1:0\n  The given SavedModel SignatureDef contains the following output(s):\n    outputs['class_ids'] tensor_info:\n        dtype: DT_INT64\n        shape: (-1, 1)\n        name: dnn/head/predictions/ExpandDims:0\n    outputs['classes'] tensor_info:\n        dtype: DT_STRING\n        shape: (-1, 1)\n        name: dnn/head/predictions/str_classes:0\n    outputs['logistic'] tensor_info:\n        dtype: DT_FLOAT\n        shape: (-1, 1)\n        name: dnn/head/predictions/logistic:0\n    outputs['logits'] tensor_info:\n        dtype: DT_FLOAT\n        shape: (-1, 1)\n        name: dnn/logits/BiasAdd:0\n    outputs['probabilities'] tensor_info:\n        dtype: DT_FLOAT\n        shape: (-1, 2)\n        name: dnn/head/predictions/probabilities:0\n  Method name is: tensorflow/serving/predict\n</code></pre>\n\n<p>My tensorflow.rb Ruby code to get a prediction:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>saved_model = Tensorflow::Savedmodel.new\nsaved_model.LoadSavedModel('saved_model_pb', ['serve'], nil)\n\ninput = [0.97, 1.00]\nfeature1_output = saved_model.graph.operation('Placeholder').output(0)\nfeature2_output = \nsaved_model.graph.operation('Placeholder_1').output(0)\nclasses = saved_model.graph.operation('dnn/head/predictions/str_classes').output(0)\n# probabilities = saved_model.graph.operation('dnn/head/predictions/probabilities').output(0)\n\nfeature1_tensor = Tensorflow::Tensor.new(input[0])\nfeature2_tensor = Tensorflow::Tensor.new(input[1])\nfeeds_tensor_to_output_hash = {feature1_output =&gt; feature1_tensor,\n                               feature2_output =&gt; feature2_tensor}\nout_tensor = saved_model.session.run(feeds_tensor_to_output_hash, [classes], [])\n\nputs out_tensor\n</code></pre>\n\n<p>This fails with an ArgumentError without an error message:</p>\n\n<pre><code>2018-05-22 17:07:08.443115: I tensorflow/cc/saved_model/loader.cc:242] Loading SavedModel with tags: { serve }; from: saved_model_pb/saved_model\n2018-05-22 17:07:08.447053: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.2 AVX AVX2 FMA\n2018-05-22 17:07:08.452575: I tensorflow/cc/saved_model/loader.cc:161] Restoring SavedModel bundle.\n2018-05-22 17:07:08.453012: I tensorflow/cc/saved_model/loader.cc:171] The specified SavedModel has no variables; no checkpoints were restored.\n2018-05-22 17:07:08.453024: I tensorflow/cc/saved_model/loader.cc:196] Running LegacyInitOp on SavedModel bundle.\n2018-05-22 17:07:08.475575: I tensorflow/cc/saved_model/loader.cc:291] SavedModel load for tags { serve }; Status: success. Took 33095 microseconds.\nrake aborted!\nArgumentError: \n.rbenv/versions/2.2.5/lib/ruby/gems/2.2.0/bundler/gems/tensorflow.rb-eb3f5bf4f0fd/lib/tensorflow/session.rb:57:in `Session_run'\n.rbenv/versions/2.2.5/lib/ruby/gems/2.2.0/bundler/gems/tensorflow.rb-eb3f5bf4f0fd/lib/tensorflow/session.rb:57:in `run'\nlib/tasks/ml.rake:380:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Any idea what I'm doing wrong? The CAPTCHA example and model work fine. Is my model saved correctly? <a href=\"https://github.com/somaticio/tensorflow.rb/files/2029009/saved_model.pb.zip\" rel=\"noreferrer\">Here is the saved model that I used.</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller"], "comments": [{"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1527032565, "post_id": 50477807, "comment_id": 87969343, "body": "Try adding <code>as: :draw_day</code> after your <code>get &#39;weeks&#47;draw_day&#39;</code> route (might also need to specify <code>to:</code>). You can see what the route is currently named by doing something like <code>rake routes | grep draw_day</code> from the command line,"}, {"owner": {"reputation": 570, "user_id": 5347656, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/50c696cb8d82b2701f5e9267a6a1a775?s=128&d=identicon&r=PG&f=1", "display_name": "frillybob", "link": "https://stackoverflow.com/users/5347656/frillybob"}, "reply_to_user": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1527033137, "post_id": 50477807, "comment_id": 87969474, "body": "@dinjas Without your suggestion I get this with <code>weeks_draw_day GET &#47;weeks&#47;draw_day(.:format) weeks#draw_day)</code>. With your suggestion I get the same exact thing except <code>weeks</code> is no longer appended in the first &quot;draw_day&quot;. I changed the view to match the new route and was given the same error in the helper method that is called."}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 1, "creation_date": 1527041741, "post_id": 50477807, "comment_id": 87971375, "body": "ah sorry, I misread your original explanation. try just moving the <code>weeks&#47;dray_day</code> route above your <code>&#47;weeks&#47;:id</code> route. Also if you watch your server logs when you click the link, you should be able to see something happen."}, {"owner": {"reputation": 570, "user_id": 5347656, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/50c696cb8d82b2701f5e9267a6a1a775?s=128&d=identicon&r=PG&f=1", "display_name": "frillybob", "link": "https://stackoverflow.com/users/5347656/frillybob"}, "reply_to_user": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1527043459, "post_id": 50477807, "comment_id": 87971728, "body": "@dinjas it works when I place the route above the id, thank you! I would like to figure out why if possible. Without the fix, the console shows a GET request for <code>weeks&#47;draw_day</code>. Then it says <code>Processing by WeeksController#setup as HTML</code> that setup is the page that I want to be navigating away from. With the fix the proper controller action is shown on the console <code>WeeksController#draw_day as HTML</code>"}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1527046463, "post_id": 50477807, "comment_id": 87972321, "body": "When Rails tries to find a route to maps your request to a <code>controller#action</code>, it uses the first route that matches. When you have the <code>&#47;weeks&#47;:id</code> route first, and you try to visit <code>&#47;weeks&#47;draw_day</code>, it matches <code>&#39;draw_day&#39;</code> as the <code>:id</code> param in your <code>&#47;weeks&#47;:id</code> route and sends you off to <code>weeks#setup</code> with <code>params[:id]</code> set to <code>&#39;draw_day&#39;</code>."}], "owner": {"reputation": 570, "user_id": 5347656, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/50c696cb8d82b2701f5e9267a6a1a775?s=128&d=identicon&r=PG&f=1", "display_name": "frillybob", "link": "https://stackoverflow.com/users/5347656/frillybob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527031684, "creation_date": 1527031684, "question_id": 50477807, "link": "https://stackoverflow.com/questions/50477807/rails-link-to-calling-incorrect-controller-action", "title": "Rails link_to calling incorrect controller action", "body": "<p>My rails link_to is calling a different controller action than it should. I have a dropdown menu that I would like to link_to another portion of the site. However, it calls the controller method that helped build the page instead of the actual controller method. This causes a problem because I don't pass in the correct information into the method call to properly execute that. I have gotten this exact thing to work on other portions of my site but cannot here.</p>\n\n<p>The exact problem happens when the <code>setup</code> method gets called and which then in turns calls another method that relies on an ID that is passed in. However, I don't pass in the ID when I have the link_to in the dropdown menu because I don't want to call setup. </p>\n\n<p>Here is the relevant code: </p>\n\n<p>setup.html.erb :</p>\n\n<pre><code>  &lt;div class=\"dropdown-menu aria-labelledby=\"dropdownMenuButton\"\" &gt;\n    &lt;% @days.each do |d|%&gt;\n      &lt;%= link_to \"Go to #{d}\", weeks_draw_day_path(:test =&gt; d), :class=&gt;'dropdown-item' %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>weeks_controller.rb: I removed most of the <code>setup</code> code because it wasn't useful. I did keep the param lookup with the id and the subsequent call to a helper method that crashes because I never pass in that id on the link_to in the above view. </p>\n\n<pre><code>class WeeksController &lt; ApplicationController\n  before_action :set_week, only: [:show, :edit, :update, :destroy]\n\n\n  def schedule\n    week, start, finish = get_set_of_weeks()\n    for i in 0...week.length\n      Week.check_insert_week(week[i], start[i], finish[i])\n    end\n  end\n\n\n  def setup\n    # Gets the id of the current week\n    @w = Week.find_by_id(params[:id])\n    # Gets a DB friendly start of week \n\n  end\n\n  def draw_day\n    byebug\n    logger.info \"Sup\"\n  end\n\n\n\n  def week_lookup_controller(id)\n    Week.week_lookup_model_lit(id)\n  end\n\n\n  helper_method :week_lookup_controller\n\n  private\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def week_params\n      params.fetch(:week, {})\n    end\nend\n</code></pre>\n\n<p>routes.rb :I only have the \"weeks\" controller routes listed here as I don't believe the others are relevant. </p>\n\n<pre><code>  ########### Week actions #############\n  get 'weeks/schedule'\n  get '/weeks/:id', to: 'weeks#setup', as: 'weeks_setup'\n  get 'weeks/draw_day'\n\n  resources :weeks, only: [:schedule, ] do\n    get :schedule, on: :collection\n  end\n</code></pre>\n\n<p>As you can see I have <code>byebug</code> in the draw_day controller method. This never gets executed. Let me know if I can provide any more useful information, thanks for the help!</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1527048542, "post_id": 50476935, "comment_id": 87972728, "body": "Fixing a bug is not refactoring."}], "answers": [{"tags": [], "owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "is_accepted": false, "score": 1, "last_activity_date": 1527027647, "last_edit_date": 1527027647, "creation_date": 1527026336, "answer_id": 50477027, "question_id": 50476935, "link": "https://stackoverflow.com/questions/50476935/understanding-string-appending-in-ruby/50477027#50477027", "title": "Understanding string appending in Ruby", "body": "<p>Appending to a string via <code>&lt;&lt;</code> will mutate the receiver object, whereas using <code>+</code> will not. An example:</p>\n\n<pre><code># Mutating\nstring1 = 'foo'\nstring1 &lt;&lt; ' bar'\nputs string1\n# =&gt; \"foo bar\"\n\n# Non-mutating\nstring2 = string1 + ' baz'\nputs string2\n# =&gt; \"foo bar baz\"\nputs string1\n# =&gt; \"foo bar\"\n</code></pre>\n\n<p>In your case, each time the URI append logic is run, it's appending the string directly to the original object, which is why you're experiencing the unwanted chaining of that <code>email_check</code> substring on subsequent runs.</p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1527028631, "creation_date": 1527028631, "answer_id": 50477372, "question_id": 50476935, "link": "https://stackoverflow.com/questions/50476935/understanding-string-appending-in-ruby/50477372#50477372", "title": "Understanding string appending in Ruby", "body": "<p>This is setting <code>uri</code> to be the <em>same object</em> as in <code>organization_host_url</code></p>\n\n<pre><code>uri = organization_host_url\n</code></pre>\n\n<p>This is mutating that same object.</p>\n\n<pre><code>uri &lt;&lt; 'email_check'\n</code></pre>\n\n<p>If you check now, you'll see that both <code>uri</code> and <code>organization_host_url</code> contain the modified string object.</p>\n\n<p>When you do </p>\n\n<pre><code>uri = organization_host_url + 'email_check'\n</code></pre>\n\n<p><code>uri</code> now contains a <em>different</em> string object than <code>organization_host_uri</code></p>\n\n<p>You can test this by checking <code>uri.object_id</code> and <code>organization_host_uri.object_id</code> in the first example, you'll see they have the same object id.</p>\n"}], "owner": {"reputation": 1589, "user_id": 1123717, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fb3d5703694d21ac6573b31d3f3014f0?s=128&d=identicon&r=PG", "display_name": "aarkerio", "link": "https://stackoverflow.com/users/1123717/aarkerio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 50477372, "answer_count": 2, "score": 0, "last_activity_date": 1527048787, "creation_date": 1527025869, "last_edit_date": 1527048787, "question_id": 50476935, "link": "https://stackoverflow.com/questions/50476935/understanding-string-appending-in-ruby", "title": "Understanding string appending in Ruby", "body": "<p>I had the following code:</p>\n\n<pre><code>uri = organization_host_url\nuri &lt;&lt; 'email_check'\ntarget_uri = URI(uri)\n</code></pre>\n\n<p>When this part of code was called repeatedly, <code>uri</code> kept the old value and added the new appending part. On the other hand, when I called it alone, it did not keep the old value.</p>\n\n<p>I refactored the code to:</p>\n\n<pre><code>uri = organization_host_url + 'email_check'\ntarget_uri = URI(uri) \n</code></pre>\n\n<p>and now <code>uri</code> does not keep the old value when repeatedly called.</p>\n\n<p>Why did using the appending option result in <code>uri</code> holding the old value?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 0, "creation_date": 1527018895, "post_id": 50475112, "comment_id": 87964508, "body": "I don&#39;t know what you mean by &quot;Why same value has been assigned in hash&quot;. They are not the same values? 2 of them are converted to strings, which may be useful for certain purposes if you want to work with a hash of only string values."}], "answers": [{"tags": [], "owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "is_accepted": false, "score": 1, "last_activity_date": 1527018631, "creation_date": 1527018631, "answer_id": 50475478, "question_id": 50475112, "link": "https://stackoverflow.com/questions/50475112/ruby-code-format-what-is-the-meaning-of-ruby-code-format/50475478#50475478", "title": "Ruby code format - What is the meaning of ruby code format?", "body": "<p>This assumes the code above has 2 syntax errors: the first <code>,,</code> should be <code>,</code> and the second <code>,,</code> shouldn't be there.</p>\n\n<p>This code creates a <code>proc</code> that takes as an argument an object that responds to <code>.field1</code>, <code>.field2</code>, <code>.field3</code>, <code>.field4</code>.  It returns a <code>Hash</code> that has 4 fields in it, converting <code>field2</code> and <code>field4</code> to strings.</p>\n\n<p>So, the input could be something like an <code>OpenStruct</code> (but doesn't have to be; it just has to respond to the 4 method calls above):</p>\n\n<pre><code>foo = OpenStruct.new\nfoo.field1 = 'hi'\nfoo.field2 = 123\nfoo.field3 = 'bar'\nfoo.field4 = 456\n</code></pre>\n\n<p>Now passing that parameter to the <code>Proc</code> returns:</p>\n\n<pre><code>{\"field1\"=&gt;\"hi\", \"field2\"=&gt;\"123\", \"field3\"=&gt;\"bar\", \"field4\"=&gt;\"456\"}\n</code></pre>\n\n<p>I can't say WHY the code does this.</p>\n"}], "owner": {"reputation": 119, "user_id": 8448115, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/85a3a21b20ad7b2f42d49fe345cefeca?s=128&d=identicon&r=PG&f=1", "display_name": "Nomadic_coder", "link": "https://stackoverflow.com/users/8448115/nomadic-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1527019723, "answer_count": 1, "score": -4, "last_activity_date": 1527018631, "creation_date": 1527017092, "question_id": 50475112, "link": "https://stackoverflow.com/questions/50475112/ruby-code-format-what-is-the-meaning-of-ruby-code-format", "closed_reason": "Needs details or clarity", "title": "Ruby code format - What is the meaning of ruby code format?", "body": "<p>What does this mean in Ruby ? Why are they assigning same value to existing hash value ?</p>\n\n<pre><code>Proc.new { |message|\n   {\n      'field1' =&gt; message.field1,\n      'field2' =&gt; message.field2.to_s,\n      'field3' =&gt; message.field3,,\n      'field4' =&gt; message.field4.to_s,,\n   }\n}\n</code></pre>\n\n<p>What is the meaning of above structure ? Why same value has been assigned in hash ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1527023131, "post_id": 50475069, "comment_id": 87966404, "body": "When you say you&#39;re setting the time zone in the controller, does this vary depend on who&#39;s logged in? Or is that supposed to be a global configuration for the whole rails application? In the case of the former, you&#39;d need to pass the time zone into the model method as a parameter; models have no knowledge of the &quot;current user&quot;. In the case of the latter, then this code never belonged in the controller in the first place! You should set the global time zone in <code>config&#47;application.rb</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "is_accepted": true, "score": 0, "last_activity_date": 1527099422, "creation_date": 1527099422, "answer_id": 50494945, "question_id": 50475069, "link": "https://stackoverflow.com/questions/50475069/time-zone-setting-in-controller-only/50494945#50494945", "title": "Time.zone setting in controller only", "body": "<p><code>Time.zone</code> is set as a thread variable. If you're in a different thread (i.e. a background worker, process, irb), <code>Time.zone</code> will be your application's default (usually set in <code>config/application.rb</code>).</p>\n\n<p>If you're not in a different thread/process, make sure you're not accidentally calling <code>Time.zone = nil</code>. You should also check out the Rails definitive <code>Time.use_zone</code> example at <a href=\"http://api.rubyonrails.org/classes/Time.html#method-c-use_zone\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/classes/Time.html#method-c-use_zone</a>.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 0, "accepted_answer_id": 50494945, "answer_count": 1, "score": 0, "last_activity_date": 1527099422, "creation_date": 1527016928, "question_id": 50475069, "link": "https://stackoverflow.com/questions/50475069/time-zone-setting-in-controller-only", "title": "Time.zone setting in controller only", "body": "<p>I have a Rails app where I set the timezone for each request in a before action in my controller like so:</p>\n\n<pre><code>Time.zone=\"Central Time (US &amp; Canada\")\n</code></pre>\n\n<p>I can print the time zone with </p>\n\n<pre><code>puts Time.zone\n</code></pre>\n\n<p>and this is what is printed out. </p>\n\n<pre><code>(GMT-06:00) Central Time (US &amp; Canada)\n</code></pre>\n\n<p>All of this works fine until I call a method in my model. When I do, the timezone is lost and I have to set <code>Time.zone</code> again in my model. </p>\n\n<p>From my controller if I call the method below that's in my model it prints UTC time. </p>\n\n<p>Model</p>\n\n<pre><code>def self.import_file(file)\n    puts Time.zone\n    # this prints out UTC time. \nend\n</code></pre>\n\n<p>Is this expected behavior or am I missing something?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527016814, "post_id": 50474961, "comment_id": 87963565, "body": "puts returns <code>nil</code> but <code>User.all</code> will never be <code>nil</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1527017107, "post_id": 50474961, "comment_id": 87963678, "body": "<code>User.all</code> will be an empty <code>User::::ActiveRecord_Relation</code> (like an empty array, but you can call query methods on it). <code>puts</code> always <i>returns</i> <code>nil</code>, but prints the value to STDOUT."}], "answers": [{"comments": [{"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1527017486, "post_id": 50475081, "comment_id": 87963865, "body": "It&#39;s not only lazily evaluated, but also memoized i.e evaluated only once."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 1, "creation_date": 1527020000, "post_id": 50475081, "comment_id": 87965024, "body": "@meta the memoized value is only cached per example meaning it is evaluated under each example independently (something akin to <code>user ||= user()</code> inside the example body)"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1527021148, "post_id": 50475081, "comment_id": 87965569, "body": "Yes, this is what I meant. Just something worth noting."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527096254, "post_id": 50475081, "comment_id": 88001163, "body": "Thanks for the clarification @engineersmnky."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 4, "last_activity_date": 1527016975, "creation_date": 1527016975, "answer_id": 50475081, "question_id": 50474961, "link": "https://stackoverflow.com/questions/50474961/model-all-doesnt-work-after-i-use-createmodel-in-specs/50475081#50475081", "title": "Model.all doesn&#39;t work after I use create(:model) in specs", "body": "<p>RSpecs <code>let</code> is evaluated lazily. So the record is not actually created until you call <code>user</code>:</p>\n\n<pre><code>describe 'GET #show' do\n  let(:user) { create(:user) }\n\n  it 'returns HTTP OK response with expected body' do\n    user\n    puts User.all\n  end\nend\n</code></pre>\n\n<p><code>let</code> does not actually declare a variable. Rather it creates a method via metaprogramming that memoizes its value.</p>\n\n<p>RSpec provides a <code>let!</code> method as well that is evaluated at once:</p>\n\n<pre><code>describe 'GET #show' do\n  let!(:user) { create(:user) }\n\n  it 'returns HTTP OK response with expected body' do\n    puts User.all\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 18601, "user_id": 599184, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/tjsXC.jpg?s=128&g=1", "display_name": "Leo Jiang", "link": "https://stackoverflow.com/users/599184/leo-jiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 50475081, "answer_count": 1, "score": 0, "last_activity_date": 1527016975, "creation_date": 1527016474, "question_id": 50474961, "link": "https://stackoverflow.com/questions/50474961/model-all-doesnt-work-after-i-use-createmodel-in-specs", "title": "Model.all doesn&#39;t work after I use create(:model) in specs", "body": "<p>In my spec, I have:</p>\n\n<pre><code>  describe 'GET #show' do\n    let(:user) { create(:user) }\n\n    it 'returns HTTP OK response with expected body' do\n      puts User.all\n    end\n  end\n</code></pre>\n\n<p><code>User.all</code> is nil. How do I make it return the user object that was created?</p>\n"}, {"tags": ["ruby", "regex", "ruby-2.4"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1527016147, "post_id": 50474477, "comment_id": 87963270, "body": "FYI: in the real life nobody matches anything 100_000 times. That said, your advice is good for marketing department: tests will show the drastic performance increase, while in reality this change brings zero profit. In other words, <b>this answer is plain wrong.</b>"}, {"owner": {"reputation": 65, "user_id": 681143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b194d0ca17061b849ca8d066e23bad5?s=128&d=identicon&r=PG", "display_name": "ayeezy", "link": "https://stackoverflow.com/users/681143/ayeezy"}, "edited": false, "score": 0, "creation_date": 1527046831, "post_id": 50474477, "comment_id": 87972397, "body": "This looks promising to me. My use case is to scan for the same 10,000 regex like millions of times.  What&#39;s the trade off on using the /o/ modifier? Is it just taking up a lot of memory?"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1527065475, "post_id": 50474477, "comment_id": 87980741, "body": "@mudasobwa i have matched a huge number of times in real life (not tinder). For example when processing logs, request headers, etc."}], "tags": [], "owner": {"reputation": 1955, "user_id": 2193416, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4173555c6bc153846714c964c0cd8a19?s=128&d=identicon&r=PG", "display_name": "dug", "link": "https://stackoverflow.com/users/2193416/dug"}, "is_accepted": false, "score": 4, "last_activity_date": 1527014537, "creation_date": 1527014537, "answer_id": 50474477, "question_id": 50473969, "link": "https://stackoverflow.com/questions/50473969/ruby-2-4-how-to-speed-up-regexp-initializing-dynamically-for-use-with-match/50474477#50474477", "title": "Ruby 2.4: How To Speed Up Regexp Initializing Dynamically For Use with .match?", "body": "<p>Use the <a href=\"https://ruby-doc.org/core-2.4.1/Regexp.html#class-Regexp-label-Options\" rel=\"nofollow noreferrer\">/o</a> modifier, so the interpolation is only performed once:</p>\n\n<pre><code>str = 's'\nBenchmark.bm do |b|\n  b.report(\".match         \") { 100000.times { 'string'.match /s/ } }\n  b.report(\".match?        \") { 100000.times { 'string'.match? /s/ } }\n  b.report(\".match dynamic \") { 100000.times { 'string'.match /#{str}/o } }\n  b.report(\".match? dynamic\") { 100000.times { 'string'.match? /#{str}/o } }\nend\n       user     system      total        real\n.match           0.120000   0.010000   0.130000 (  0.117889)\n.match?          0.020000   0.000000   0.020000 (  0.027255)\n.match dynamic   0.110000   0.000000   0.110000 (  0.113300)\n.match? dynamic  0.030000   0.000000   0.030000 (  0.034755)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 681143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b194d0ca17061b849ca8d066e23bad5?s=128&d=identicon&r=PG", "display_name": "ayeezy", "link": "https://stackoverflow.com/users/681143/ayeezy"}, "edited": false, "score": 0, "creation_date": 1527046708, "post_id": 50474841, "comment_id": 87972370, "body": "In my 2nd benchmark, hardcoding in a regex vs interpolating is causing like a 500x difference in performance.  I am still hoping there would is a way to generate regex from string that would be quicker."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1527016032, "creation_date": 1527016032, "answer_id": 50474841, "question_id": 50473969, "link": "https://stackoverflow.com/questions/50473969/ruby-2-4-how-to-speed-up-regexp-initializing-dynamically-for-use-with-match/50474841#50474841", "title": "Ruby 2.4: How To Speed Up Regexp Initializing Dynamically For Use with .match?", "body": "<p>You basically measure the string/regexp interpolation vs literal instantiation. The time of <code>match?</code> itself is not affecting the result of the measure at all.</p>\n\n<p>To compare <code>match?</code> against <code>match</code>, one should instantiate the regexp upfront:</p>\n\n<pre><code>str = 'my text with words'\nreg_str = '...'\nreg = /#{reg_str}/i\nputs Benchmark.measure {\n  100000.times { str.match? reg }\n}\n</code></pre>\n\n<p>The result of above will be roughly the same as in your second test.</p>\n\n<p>That said, the string/regexp interpolation is the beast who takes most of the time. If you need a complicated interpolation in regular expression, the difference between <code>match?</code> and <code>match</code> won\u2019t be noticeable, since the interpolation is a bottleneck, not the matching.</p>\n"}, {"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 1, "last_activity_date": 1527066084, "creation_date": 1527066084, "answer_id": 50484088, "question_id": 50473969, "link": "https://stackoverflow.com/questions/50473969/ruby-2-4-how-to-speed-up-regexp-initializing-dynamically-for-use-with-match/50484088#50484088", "title": "Ruby 2.4: How To Speed Up Regexp Initializing Dynamically For Use with .match?", "body": "<p>The speed improvement of <code>match?</code> comes from not allocating the MatchData objects and globals like <code>$1</code>. It just returns <code>true</code> or <code>false</code>. You can't use <code>match?</code> if you need to return something from the regex.</p>\n\n<p><code>match?</code> won't be any faster at compiling regex-strings into <code>Regexp</code> objects. </p>\n\n<p>Perhaps in your code you can first create the regexes and then use those in the loop instead of constantly recreating them:</p>\n\n<pre><code># bad:\nlines.each { |line| puts \"Found a match!\" if line.match?(/abcd/) }\n\n# good:\nregex = /abcd/\nlines.each { |line| puts \"Found a match!\" if line.match?(regex) }\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 681143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b194d0ca17061b849ca8d066e23bad5?s=128&d=identicon&r=PG", "display_name": "ayeezy", "link": "https://stackoverflow.com/users/681143/ayeezy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1527066084, "creation_date": 1527012436, "last_edit_date": 1527013414, "question_id": 50473969, "link": "https://stackoverflow.com/questions/50473969/ruby-2-4-how-to-speed-up-regexp-initializing-dynamically-for-use-with-match", "title": "Ruby 2.4: How To Speed Up Regexp Initializing Dynamically For Use with .match?", "body": "<p>I just read about <code>Regexp.match?('string')</code> for Ruby 2.4 and was very excited to see the results!  But when I tried it out in my application, I hardly saw any gains.</p>\n\n<pre><code>str = 's'\nBenchmark.bm do |b|\n  b.report(\".match         \") { 100000.times { 'string'.match /s/ } }\n  b.report(\".match?        \") { 100000.times { 'string'.match? /s/ } }\n  b.report(\".match dynamic \") { 100000.times { 'string'.match /#{str}/ } }\n  b.report(\".match? dynamic\") { 100000.times { 'string'.match? /#{str}/ } }\nend\n                 user     system      total        real\n.match           0.140000   0.000000   0.140000 (  0.143658)\n.match?          0.020000   0.000000   0.020000 (  0.029628)\n.match dynamic   0.370000   0.010000   0.380000 (  0.371935)\n.match? dynamic  0.260000   0.010000   0.270000 (  0.278614)\n</code></pre>\n\n<p>From the Benchmark, we see a tremendous gain from <code>.match</code> to <code>.match?</code>, but once i start dynamically creating complicated regex as my app requires, I'm loosing a lot of the gains.</p>\n\n<p>My question is, why is there such a drastic difference and can I somehow create dynamic regexp to utilize the performance of <code>.matches?</code> in the example below? I tested my benchmarks using <code>ruby 2.4.2p198</code></p>\n\n<pre><code>str = 'my text with words'\nreg_str = '((^|[\\s\\\"\u201c])(cherry pie|cherry pies)($|[\\s\\\"\u201d\\.\\,\\:\\?\\!])|(\\#(cherrypie|cherrypies)($|\\s|\\#|\\.|\\,|\\:|\\?|\\!)))'\nputs Benchmark.measure {\n  100000.times { str.match? /#{reg_str}/i }\n}\n9.380000   0.010000   9.390000 (  9.403821)\n\nputs Benchmark.measure {\n  100000.times { str.match? /((^|[\\s\\\"\u201c])(cherry pie|cherry pies)($|[\\s\\\"\u201d\\.\\,\\:\\?\\!])|(\\#(cherrypie|cherrypies)($|\\s|\\#|\\.|\\,|\\:|\\?|\\!)))/i }\n}  \n0.020000   0.000000   0.020000 (  0.017900)\n</code></pre>\n"}, {"tags": ["ruby", "paper-trail-gem", "redaction"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527009037, "post_id": 50472838, "comment_id": 87959859, "body": "I&#39;m voting to close this question as off-topic because Stack Overflow is not a legal authority on how to handle GDPR compliance."}, {"owner": {"reputation": 2734, "user_id": 1657639, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/94504d99f1d8559e8cb58591ee42a34b?s=128&d=identicon&r=PG", "display_name": "mr rogers", "link": "https://stackoverflow.com/users/1657639/mr-rogers"}, "edited": false, "score": 1, "creation_date": 1527009084, "post_id": 50472838, "comment_id": 87959877, "body": "Do you need to track that there was a change?  Papertrail has the <code>:ignore</code> and <code>:only</code> options to only watch for changes on certain attributes."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527011810, "post_id": 50472838, "comment_id": 87961192, "body": "Why are you only redacting <code>Josh</code>? If I change my name to <code>Joshua</code> I would expect that too to be redacted as it still personally identifies me in the <code>update</code>. Plus it would be easier to target known keys to redact rather than specific key value pairs"}, {"owner": {"reputation": 26534, "user_id": 184212, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b31e7abd14f1ceb4c4957da08933c630?s=128&d=identicon&r=PG", "display_name": "Joshua Cheek", "link": "https://stackoverflow.com/users/184212/joshua-cheek"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1527013423, "post_id": 50472838, "comment_id": 87961913, "body": "@tadman not asking for legal advice, just how to redact information in PaperTrail."}, {"owner": {"reputation": 26534, "user_id": 184212, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b31e7abd14f1ceb4c4957da08933c630?s=128&d=identicon&r=PG", "display_name": "Joshua Cheek", "link": "https://stackoverflow.com/users/184212/joshua-cheek"}, "reply_to_user": {"reputation": 2734, "user_id": 1657639, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/94504d99f1d8559e8cb58591ee42a34b?s=128&d=identicon&r=PG", "display_name": "mr rogers", "link": "https://stackoverflow.com/users/1657639/mr-rogers"}, "edited": false, "score": 1, "creation_date": 1527013652, "post_id": 50472838, "comment_id": 87962026, "body": "@mrrogers I&#39;m not sure I understand the question. We track all changes to a subset of fields, and I need to redact specific PII from those historical records. We use those features only for reducing irrelevant info which gets spammy. Until a piece of data is redacted, we expect full normal functionality."}, {"owner": {"reputation": 26534, "user_id": 184212, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b31e7abd14f1ceb4c4957da08933c630?s=128&d=identicon&r=PG", "display_name": "Joshua Cheek", "link": "https://stackoverflow.com/users/184212/joshua-cheek"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527013807, "post_id": 50472838, "comment_id": 87962106, "body": "@engineersmnky In that situation, we would redact two pieces of information. Note that this example is merely intended to explore how to redact info, not to be representative of the actual data I need to redact. It&#39;s a reasonable consideration, but if we do decide to do something along those lines, it will be a business decision, based on requirements that emerge in practice and conversations between the business team and the legal team."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527014635, "post_id": 50472838, "comment_id": 87962504, "body": "my point was your existing &quot;use case&quot; shows we are redacting the name &quot;Josh&quot; but when the name changes we do not redact the change. This does not make logical sense to me. Do you know the key fields (hash keys in this case) you want to redact or are the redactions arbitrary as shown? What are the actual rules for this because they are unclear right now? Also what ruby version are you using as it does impact how on answers updating values in a <code>Hash</code>?"}, {"owner": {"reputation": 26534, "user_id": 184212, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b31e7abd14f1ceb4c4957da08933c630?s=128&d=identicon&r=PG", "display_name": "Joshua Cheek", "link": "https://stackoverflow.com/users/184212/joshua-cheek"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527015158, "post_id": 50472838, "comment_id": 87962768, "body": "@engineersmnky within the context of my example, there should be no way to go from the name <code>&quot;Josh&quot;</code> to any data associated with Josh. While my example changes <code>&quot;Josh&quot;</code> to <code>&quot;Josh2&quot;</code>, these are to be considered different names. In my real example, its based on email addresses, and the requirements are more nuanced. Do you know if this is the way to redact information from PaperTrail&#39;s versions table? Or, more generally, perhaps: is this the way to modify versioned history?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527029559, "post_id": 50472838, "comment_id": 87968568, "body": "You can probably get an answer for that narrow problem, but for GDPR in general, you&#39;ll need a professional assessment. For anything involving potential fines I&#39;m just trying to be careful here."}], "answers": [{"tags": [], "owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "is_accepted": true, "score": 0, "last_activity_date": 1527699964, "creation_date": 1527699964, "answer_id": 50610093, "question_id": 50472838, "link": "https://stackoverflow.com/questions/50472838/how-to-redact-information-from-paper-trails-versions/50610093#50610093", "title": "How to redact information from Paper Trail&#39;s versions?", "body": "<blockquote>\n  <p>For the EU's GDPR compliance (user privacy), we need to redact personally identifiable information form the versions of our records. I've come up with something that seems to work, but figure I should ask if there's an established way to do this.</p>\n</blockquote>\n\n<p>No, as of today, 2018-05-30, there is no built-in feature or documented solution for GDPR redaction.</p>\n\n<p>PaperTrail provides many ways to iterate over, and to query records in the <code>versions</code> table. <code>where_object_changes</code> is one such feature, but it generates some pretty complicated SQL.</p>\n\n<pre><code>where_object_changes(name: 'Joan')\n\nSELECT \"versions\".*\nFROM \"versions\"\nWHERE .. (\"versions\".\"object_changes\" LIKE '%\nname:\n- Joan\n%' OR \"versions\".\"object_changes\" LIKE '%\nname:\n-%\n- Joan\n%')\n</code></pre>\n\n<p>You may, justifiably, have concerns about the correctness of this query. In fact, as of <a href=\"https://github.com/paper-trail-gem/paper_trail/blob/master/CHANGELOG.md#900-2018-03-26\" rel=\"nofollow noreferrer\">PT 9.0.0</a>, using <code>where_object_changes</code> to read YAML from a text column raises an error to that effect. Reading JSON from text or from a <code>json/b</code> column is still allowed.</p>\n\n<p>Anyway, if I've succeeded in making you wary of such complicated SQL then you should choose a simpler approach, perhaps iterating over all of the version records for that user (<code>user.versions.find_each</code>)</p>\n"}], "owner": {"reputation": 26534, "user_id": 184212, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b31e7abd14f1ceb4c4957da08933c630?s=128&d=identicon&r=PG", "display_name": "Joshua Cheek", "link": "https://stackoverflow.com/users/184212/joshua-cheek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 50610093, "answer_count": 1, "score": 1, "last_activity_date": 1527699964, "creation_date": 1527007899, "last_edit_date": 1527018040, "question_id": 50472838, "link": "https://stackoverflow.com/questions/50472838/how-to-redact-information-from-paper-trails-versions", "title": "How to redact information from Paper Trail&#39;s versions?", "body": "<p>For the EU's GDPR compliance (user privacy), we need to redact personally identifiable information form the versions of our records. I've come up with something that seems to work, but figure I should ask if there's an established way to do this.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_paper_trail\nend\n\nuser = User.create! name: 'Josh'\nuser.update_attributes name: 'Josh2'\nuser.update_attributes name: 'Josh3'\nuser.destroy!\n\ndef self.get_data\n  PaperTrail::Version.order(:id).where(item_id: 1).map { |ver| [ver.event, ver.object, ver.object_changes] }\nend\n\n# =====  BEFORE  =====\nget_data\n# =&gt; [[\"create\", nil, {\"id\"=&gt;[nil, 1], \"name\"=&gt;[nil, \"Josh\"]}],\n#     [\"update\", {\"id\"=&gt;1, \"name\"=&gt;\"Josh\"}, {\"name\"=&gt;[\"Josh\", \"Josh2\"]}],\n#     [\"update\", {\"id\"=&gt;1, \"name\"=&gt;\"Josh2\"}, {\"name\"=&gt;[\"Josh2\", \"Josh3\"]}],\n#     [\"destroy\", {\"id\"=&gt;1, \"name\"=&gt;\"Josh3\"}, nil]]\n\nPaperTrail::Version.where_object_changes(name: 'Josh').each do |ver|\n  ver.object['name'] = 'REDACTED' if ver.object &amp;&amp; ver.object['name'] == 'Josh'\n  if oc = ver.object_changes\n    oc['name'] = oc['name'].map { |name| name == 'Josh' ? 'REDACTED' : name }\n    ver.object_changes = oc\n  end\n  ver.save!\nend\n\n# =====  AFTER  =====\nget_data\n# =&gt; [[\"create\", nil, {\"id\"=&gt;[nil, 1], \"name\"=&gt;[nil, \"REDACTED\"]}],\n#     [\"update\",\n#      {\"id\"=&gt;1, \"name\"=&gt;\"REDACTED\"},\n#      {\"name\"=&gt;[\"REDACTED\", \"Josh2\"]}],\n#     [\"update\", {\"id\"=&gt;1, \"name\"=&gt;\"Josh2\"}, {\"name\"=&gt;[\"Josh2\", \"Josh3\"]}],\n#     [\"destroy\", {\"id\"=&gt;1, \"name\"=&gt;\"Josh3\"}, nil]]\n</code></pre>\n\n<p><strong>UPDATE:</strong> Actually, I'm going to need to scope the record by an association, as well, so my example isn't sufficient.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form"], "answers": [{"comments": [{"owner": {"reputation": 3629, "user_id": 384693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f847aeef61e9466a132b6fdbd980e11?s=128&d=identicon&r=PG", "display_name": "spikeheap", "link": "https://stackoverflow.com/users/384693/spikeheap"}, "edited": false, "score": 1, "creation_date": 1527008052, "post_id": 50472824, "comment_id": 87959364, "body": "<code>simple_form_for</code> does accept a symbol as the first argument. It&#39;ll yield the same results as 1 and 2"}, {"owner": {"reputation": 3022, "user_id": 336392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c144b7e260029f00b1efb08fb29bb023?s=128&d=identicon&r=PG", "display_name": "Thomas R. Koll", "link": "https://stackoverflow.com/users/336392/thomas-r-koll"}, "reply_to_user": {"reputation": 3629, "user_id": 384693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f847aeef61e9466a132b6fdbd980e11?s=128&d=identicon&r=PG", "display_name": "spikeheap", "link": "https://stackoverflow.com/users/384693/spikeheap"}, "edited": false, "score": 0, "creation_date": 1527008448, "post_id": 50472824, "comment_id": 87959561, "body": "oh, you&#39;re right though then the second argument is expected to be a <code>record_object</code> and the whole thing is passed to a <code>fields_for</code> and not to a <code>form_for</code> as the name <code>simple_form_for</code> would suggest.  <a href=\"https://www.rubydoc.info/github/plataformatec/simple_form/master/SimpleForm/ActionViewExtensions/FormHelper#simple_form_for-instance_method\" rel=\"nofollow noreferrer\">rubydoc.info/github/plataformatec/simple_form/master/SimpleF&zwnj;&#8203;orm/&hellip;</a>  Personally I wouldn&#39;t use it as it is not describe in the README and you have to read the APIs code to figure the difference."}], "tags": [], "owner": {"reputation": 3022, "user_id": 336392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c144b7e260029f00b1efb08fb29bb023?s=128&d=identicon&r=PG", "display_name": "Thomas R. Koll", "link": "https://stackoverflow.com/users/336392/thomas-r-koll"}, "is_accepted": false, "score": 0, "last_activity_date": 1527007859, "creation_date": 1527007859, "answer_id": 50472824, "question_id": 50472627, "link": "https://stackoverflow.com/questions/50472627/different-ways-to-use-simple-form-in-ruby-on-rails-what-is-the-difference/50472824#50472824", "title": "Different Ways to use simple_form in Ruby on Rails | What is the difference?", "body": "<p>1 and 2 are indentical if you do <code>@pack = Pack.find(params[:id])</code> in your controller (and it is generally recommended).</p>\n\n<p>3 is something you don't do as <code>simple_form_for</code> expects an object as first argument not a symbol (you might confuse it with something like <code>form.input :name</code>). I recommend you read the gem's README.</p>\n"}, {"comments": [{"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1527009230, "post_id": 50472951, "comment_id": 87959939, "body": "I&#39;ve also run into the problem where calling the symbol <code>:pack</code> will not be able to load in ruby error messages via <code>&lt;%= render &#39;shared&#47;error_messages&#39;, object: f.object %&gt;</code> Is this just because of <code>.object</code>? or would calling <code>symbol: f.symbol</code> fix this issue?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1527013603, "post_id": 50472951, "comment_id": 87962000, "body": "The biggest problem with using a symbol is actually that it will mask nil errors. So instead of getting a nil error you get a bunch of translation errors or something else since the form is not bound to model which is less obvious."}], "tags": [], "owner": {"reputation": 3629, "user_id": 384693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f847aeef61e9466a132b6fdbd980e11?s=128&d=identicon&r=PG", "display_name": "spikeheap", "link": "https://stackoverflow.com/users/384693/spikeheap"}, "is_accepted": false, "score": 2, "last_activity_date": 1527008301, "creation_date": 1527008301, "answer_id": 50472951, "question_id": 50472627, "link": "https://stackoverflow.com/questions/50472627/different-ways-to-use-simple-form-in-ruby-on-rails-what-is-the-difference/50472951#50472951", "title": "Different Ways to use simple_form in Ruby on Rails | What is the difference?", "body": "<p>All three approaches yield the same form (assuming you're setting <code>@pack</code> to be <code>Pack.find(params[:id])</code>, however there are trade-offs:</p>\n\n<ol>\n<li><p>It's not advisable to have an ActiveRecord call in your view code. Views should just be responsible for laying out the form, not for querying the database. Maintaining this separation will make long-term maintenance much more straightforward. Using a variable also means you can have the same form for both the <code>new</code> and <code>edit</code> screens, by setting <code>@pack = Pack.new</code> in your controller for the <code>new</code> view. For these reasons, I'd advise against option [1].</p></li>\n<li><p>Using the object (<code>@pack</code>) or the symbol (<code>:pack</code>) yields the same results because internally the Rails <code>form_for</code> helper uses the symbol to look up the variable. IMHO option [2] and referencing the object directly is \"better\" because there's less magic going on, so it's easier for people new to the project (or you in a year's time) to understand. Option [2] is also consistent with the <a href=\"http://api.rubyonrails.org/v5.2.0/classes/ActionView/Helpers/FormHelper.html#method-i-form_for\" rel=\"nofollow noreferrer\">Rails docs</a> and SimpleForm docs, so it's less of a surprise for people to see.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1527013083, "post_id": 50473152, "comment_id": 87961763, "body": "Also not that specifying <code>url: pack_path(@pack), method: :patch</code> are not necessary when you follow convention over configuration. Rails figures if the HTTP method is POST or PATCH by calling <code>.new_record?</code>. And makes a guess based on the model name that there is a <code>pack_path</code> or <code>packs_path</code> path helper.&#168;"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1527018774, "post_id": 50473152, "comment_id": 87964441, "body": "&quot;Note that Rails will try to resolve the local variable @thing but will not raise an error if it is nil. Using this form is therefore generally not advised as it can mask errors.&quot; I encountered this recently, is there a way to disable the instance variable resolving? I ended up dumping the <i>form_for</i> helper in favor of the <i>form_tag</i> for a search usage, because on some pages it was pre-filling itself or raising an error because I provided a symbol to a field that isn&#39;t a real attribute."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1527035540, "post_id": 50473152, "comment_id": 87970007, "body": "@max So, essentially removing the <code>(@pack)</code> would still leave the form functioning, but since it is guesswork would it be vulnerable to any kind of freak errors that including the object would avoid?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1527095738, "post_id": 50473152, "comment_id": 88000915, "body": "@JohanWentholt  I&#39;m not aware of any configuration option to turn off the variable resolving that happen with <code>form_for</code> but the Rails 5.1 <code>form_with</code> helper that is meant to replace both <code>form_tag</code> and <code>form_for</code> solves this pretty much by requiring that you use the <code>model:</code> option which removes any potential ambiguity."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 4, "last_activity_date": 1527013117, "last_edit_date": 1527013117, "creation_date": 1527009076, "answer_id": 50473152, "question_id": 50472627, "link": "https://stackoverflow.com/questions/50472627/different-ways-to-use-simple-form-in-ruby-on-rails-what-is-the-difference/50473152#50473152", "title": "Different Ways to use simple_form in Ruby on Rails | What is the difference?", "body": "<h2>1. and 2. - Binding a form helper to a model instance</h2>\n\n<p>Are basically identical besides the fact that in 2. you're referencing a model instance from an instance variable instead of just passing the return value of a method call.</p>\n\n<p>The end result is that you get a form that is bound to a model instance. This means that the value attributes of the inputs will contain the values from the model.</p>\n\n<p>In fact all of these will give the same result:</p>\n\n<pre><code>&lt;% \n  @pack = Pack.find(params[:id]) \n  pack = Pack.find(params[:id]) \n\n%&gt;\n\n&lt;%= simple_form_for Pack.find(params[:id]), method: :patch do |f| %&gt;\n&lt;%= simple_form_for @pack |f| %&gt;\n&lt;%= simple_form_for pack |f| %&gt;\n</code></pre>\n\n<p>But the first is less desirable since you should avoid doing queries directly from the view. The view should recieve data from the controler and use it to create HTML and be as simple and declarative as possible. Another major problem is that <code>.find</code> will raise <code>ActiveRecord::RecordNotFoundError</code> which should have been caught much earlier in the controller if the id is invalid.</p>\n\n<h2>3. Calling the form helpers with a symbol:</h2>\n\n<pre><code>&lt;%= simple_form_for :pack, url: pack_path(@pack), method: :patch do |f| %&gt;\n</code></pre>\n\n<p>This creates a form that is \"scoped\" without necissarily being bound to an specific model instance. Take this example:</p>\n\n<pre><code>&lt;%= simple_form_for :thing do  |f| %&gt;\n  &lt;%= f.input :name %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This generates the following HTML:</p>\n\n<pre><code>&lt;form novalidate=\"novalidate\" class=\"simple_form thing\" action=\"/things/new\" accept-charset=\"UTF-8\" method=\"post\"&gt;\n  &lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input type=\"hidden\" name=\"authenticity_token\" value=\"F4r1gLuboZc1CKIdn9qac0sefxSVIvkjxk9KsD+sRl1wnVtEIKzHvWY0mPuLPvHI1Kcv3TIWD883YXHKXA+yJQ==\" /&gt;\n  &lt;div class=\"input string required thing_name\"&gt;\n    &lt;label class=\"string required\" for=\"thing_name\"&gt;&lt;abbr title=\"required\"&gt;*&lt;/abbr&gt; Name&lt;/label&gt;\n    &lt;input class=\"string required\" type=\"text\" name=\"thing[name]\" id=\"thing_name\" /&gt;\n  &lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Note <code>name=\"thing[name]\"</code> which means it will give a params hash which is just like if we had a model instance:</p>\n\n<pre><code>{\n   thing: {\n     name: \"foo\"\n   }\n}\n</code></pre>\n\n<p>This is not as commonly used (at least not correctly) since most of the time you're manipulating model instances but it does have a use in special cases like search forms.</p>\n\n<p>Note that Rails will try to resolve the local variable <code>@thing</code> but will not raise an error if it is nil. Using this form is therefore generally not advised as it can mask errors.</p>\n\n<p>The best way to understand this behavior is to read the docs for <a href=\"http://api.rubyonrails.org/v5.1/classes/ActionView/Helpers/FormHelper.html\" rel=\"nofollow noreferrer\">ActionView::FormHelpers</a> which SimpleForm is just sugar on top of.</p>\n"}], "owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3313, "favorite_count": 0, "accepted_answer_id": 50473152, "answer_count": 3, "score": 4, "last_activity_date": 1527684400, "creation_date": 1527006993, "last_edit_date": 1527684400, "question_id": 50472627, "link": "https://stackoverflow.com/questions/50472627/different-ways-to-use-simple-form-in-ruby-on-rails-what-is-the-difference", "title": "Different Ways to use simple_form in Ruby on Rails | What is the difference?", "body": "<p>What is the difference between these methods of addressing an edit form for \"packs\"?</p>\n\n<p>How do these different approaches affect the stability of the application? It's versatility?</p>\n\n<p>Where would these run into major problems? Why is one better than the other?</p>\n\n<ol>\n<li>Via \"method?\" <code>&lt;%= simple_form_for Pack.find(params[:id]), method: :patch do |f| %&gt;</code></li>\n<li>Via Object <code>&lt;%= simple_form_for @pack, url: pack_path(@pack), method: :patch do |f| %&gt;</code></li>\n<li>Via Symbol <code>&lt;%= simple_form_for :pack, url: pack_path(@pack), method: :patch do |f| %&gt;</code></li>\n</ol>\n\n<p>Any information would be nice, I would love to know!</p>\n"}, {"tags": ["ruby", "xml", "nokogiri"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1527008447, "post_id": 50472314, "comment_id": 87959560, "body": "I can&#39;t reproduce this problem. Can you provide a self-contained example. <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 1549, "user_id": 1594097, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0487c4cdd633c17168020dbae62de9e5?s=128&d=identicon&r=PG", "display_name": "Argus9", "link": "https://stackoverflow.com/users/1594097/argus9"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1527008503, "post_id": 50472314, "comment_id": 87959598, "body": "I could try providing the full XML, sure. Or a code snippet to reproduce the results I&#39;m getting. See above for edits shortly."}, {"owner": {"reputation": 1549, "user_id": 1594097, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0487c4cdd633c17168020dbae62de9e5?s=128&d=identicon&r=PG", "display_name": "Argus9", "link": "https://stackoverflow.com/users/1594097/argus9"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1527008904, "post_id": 50472314, "comment_id": 87959793, "body": "@Casper please see the update above."}], "answers": [{"comments": [{"owner": {"reputation": 1549, "user_id": 1594097, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0487c4cdd633c17168020dbae62de9e5?s=128&d=identicon&r=PG", "display_name": "Argus9", "link": "https://stackoverflow.com/users/1594097/argus9"}, "edited": false, "score": 1, "creation_date": 1527010134, "post_id": 50473300, "comment_id": 87960363, "body": "Thank you. I thought I was doing something wrong. I&#39;ve used Nokogiri in the past, though admittedly not in a couple of years, so I&#39;m a bit Rusty. This RSS library sounds promising though. I&#39;ll check it out."}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 3, "last_activity_date": 1527009609, "creation_date": 1527009609, "answer_id": 50473300, "question_id": 50472314, "link": "https://stackoverflow.com/questions/50472314/nokogiri-parsing-multi-line-link-tag-as-link-and-text/50473300#50473300", "title": "Nokogiri - parsing multi-line `&lt;link&gt;` tag as link and text", "body": "<p>The fix is a lot simpler than you would think. An RSS feed is not valid HTML, but it works with XML:</p>\n\n<pre><code>doc = Nokogiri::XML(open('...'))\n</code></pre>\n\n<p>Ruby also has a <a href=\"https://docs.ruby-lang.org/en/2.2.0/RSS.html\" rel=\"nofollow noreferrer\">module named RSS</a>, which might be better suited for something like this:</p>\n\n<pre><code>require 'rss'\ndoc = RSS::Parser.parse(open('...'))\ndoc.items.first.link\n=&gt; \"https://....\"\n</code></pre>\n"}], "owner": {"reputation": 1549, "user_id": 1594097, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0487c4cdd633c17168020dbae62de9e5?s=128&d=identicon&r=PG", "display_name": "Argus9", "link": "https://stackoverflow.com/users/1594097/argus9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 50473300, "answer_count": 1, "score": 3, "last_activity_date": 1527009609, "creation_date": 1527005910, "last_edit_date": 1527008856, "question_id": 50472314, "link": "https://stackoverflow.com/questions/50472314/nokogiri-parsing-multi-line-link-tag-as-link-and-text", "title": "Nokogiri - parsing multi-line `&lt;link&gt;` tag as link and text", "body": "<p>I am using Nokogiri to parse an RSS feed for a podcast. I am trying to grab a particular piece of data containing a link to the episode, so I'm using Nokogiri to parse the XML response for the RSS feed.</p>\n\n<p>The relevant bit is below:</p>\n\n<pre><code>&lt;item&gt;\n  &lt;title&gt;An awesome title!&lt;/title&gt;\n  ...\n  &lt;link&gt;\n    http://www.foobar.com/episodes/1\n  &lt;/link&gt;\n&lt;/item&gt;\n</code></pre>\n\n<p>Nokogiri appears to be having a hard time grabbing the <code>&lt;link&gt;</code> tag though; I am able to get the <code>&lt;item&gt;</code> tag as a <code>Nokogiri::Node</code> object, and I can grab the title just fine with <code>node.css('title').text</code>, but when I try the same with <code>node.css('link').text</code>, I get a blank string.</p>\n\n<p>I tried calling <code>node.children.to_a</code> to examine all of the children in this node, and I noticed something odd: the text inside the <code>&lt;link&gt;</code> tag is being parsed as a separate child:</p>\n\n<pre><code>[0] = {Nokogiri::XML::Element} &lt;title&gt;An awesome title!&lt;/title&gt;\\n\n[1] = {Nokogiri::XML::Element} &lt;link&gt;\n[2] = {Nokogiri::XML::Text} http://www.foobar.com/episodes/1\\n\n</code></pre>\n\n<p>Is there a way I can help Nokogiri properly parse this multi-line tag so that I can grab the text inside?</p>\n\n<p><strong>UPDATE:</strong> Here is the exact code I'm executing when I run into the issue.</p>\n\n<pre><code>require 'open-uri'\ndoc = Nokogiri::HTML(open('https://rss.acast.com/abroadinjapan')) # Returns Nokogiri::HTML::Document\nnode = doc.css('//item').first # Returns Nokogiri::XML::Element\nnode.css('title').text # Returns \"Abroad in Japan: Two weeks more in Japan!\"\nnode.css('link').text # Returns \"\"\nnode.css('link').inner_text # Also returns \"\" - saw this elsewhere and thought I'd try it\nnode.children.to_a # Result, parsed by RubyMine for readability:\n\nresult = Array (14 elements)\n [0] = {Nokogiri::XML::Element} &lt;title&gt;Abroad in Japan: Two weeks more in Japan!&lt;/title&gt;\\n\n [1] = {Nokogiri::XML::Element} &lt;subtitle&gt;Chris and Pete return and they've planned out a very different route through Northern Japan.&amp;amp;nbsp;\\n\\n\\nOur Google Map can be found here:&amp;amp;nbsp;\\ngoo.gl/3t4t3q&amp;amp;nbsp;\\n\\n\\nGet in touch:&amp;amp;nbsp;abroadinjapanpodcast@gmail.com&amp;amp;nbsp;\\nMore Abr...&lt;/subtitle&gt;\n [2] = {Nokogiri::XML::Element} &lt;summary&gt;&lt;/summary&gt;\n [3] = {Nokogiri::XML::Element} &lt;guid ispermalink=\"false\"&gt;&lt;/guid&gt;\n [4] = {Nokogiri::XML::Element} &lt;pubdate&gt;Wed, 16 May 2018 21:00:00 GMT&lt;/pubdate&gt;\n [5] = {Nokogiri::XML::Element} &lt;duration&gt;01:00:00&lt;/duration&gt;\n [6] = {Nokogiri::XML::Element} &lt;keywords&gt;&lt;/keywords&gt;\n [7] = {Nokogiri::XML::Element} &lt;explicit&gt;no&lt;/explicit&gt;\n [8] = {Nokogiri::XML::Element} &lt;episodetype&gt;full&lt;/episodetype&gt;\n [9] = {Nokogiri::XML::Element} &lt;image href=\"https://imagecdn.acast.com/image?h=1500&amp;amp;w=1500&amp;amp;source=https%3A%2F%2Fmediacdn.acast.com%2Fassets%2Fcb30d29f-7342-46f0-a649-12f1b4e601f7%2Fcover-image-jgyt2ecc-japan.jpg\"&gt;&lt;/image&gt;\n [10] = {Nokogiri::XML::Element} &lt;description&gt;Chris and Pete return and they've planned out a very different route through Northern Japan.\u00a0&lt;p&gt;&lt;br&gt;&lt;/p&gt;\\n&lt;p&gt;Our Google Map can be found here:\u00a0&lt;/p&gt;\\n&lt;p&gt;&lt;a href=\"https://foobar.com/zqWZss9GSF\" target=\"_blank\"&gt;goo.gl/3t4t3q\u00a0&lt;/a&gt;&lt;/p&gt;\\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\\n&lt;p&gt;Get in touch:\u00a0&lt;a href=\"mailto:abroadinjapanpodcast@gmail.com\" target=\"_blank\"&gt;abroadinjapanpodcast@gmail.com&lt;/a&gt;\u00a0&lt;/p&gt;\\n&lt;p&gt;More Abroad In Japan shows available below, do subscribe, rate and review us on iTunes, and please tell your friends!\u00a0&lt;/p&gt;\\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\\n&lt;p&gt;&lt;a href=\"http://www.radiostakhanov.com/abroadinjapan/\" target=\"_blank\"&gt;http://www.radiostakhanov.com/abroadinjapan/&lt;/a&gt;&lt;/p&gt;]]&amp;gt;&lt;/description&gt;\n [11] = {Nokogiri::XML::Element} &lt;link&gt;\n [12] = {Nokogiri::XML::Text} https://www.acast.com/abroadinjapan/abroadinjapan-twoweeksmoreinjapan-\\n                \n [13] = {Nokogiri::XML::Element} &lt;enclosure url=\"https://media.acast.com/abroadinjapan/abroadinjapan-twoweeksmoreinjapan-/media.mp3\" length=\"28806528\" type=\"audio/mpeg\"&gt;&lt;/enclosure&gt;\n</code></pre>\n\n<p>NOTE: One of the URLs above uses a URL shortener, which SO doesn't like, so I replaced it with <code>foobar.com</code>.</p>\n"}, {"tags": ["ruby", "introspection"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1527004679, "post_id": 50471581, "comment_id": 87957440, "body": "I believe you actually want to <code>AjaxDatatablesRails.constants false</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1527004908, "post_id": 50471581, "comment_id": 87957601, "body": "^^ Very true - this is quite likely an XY question. Are you <i>really</i> trying to find all constants containing &quot;AjaxDatatablesRails&quot;, or is it actually the case that you know <code>AjaxDatatablesRails</code> exists, and you&#39;d like to see all constants defined within this class/module?"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527006637, "post_id": 50471938, "comment_id": 87958579, "body": "While this answer is correct, given the fact that this is <code>rails</code> (or at least one can reasonably assume this is <code>rails</code>). You might want to expand on this <i>&quot;all constants accessible from the point of call&quot;</i>. My suggestion being that <code>rails</code> has a tendency to lazy load classes as needed and thus this call may not return a complete list in all cases."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527007391, "post_id": 50471938, "comment_id": 87959026, "body": "The question made no mention of, or reference to, <code>rails</code> - so I disagree that it would be reasonable to assume this. However, it&#39;s a fair point that <i>due to the nature of ruby</i> (not specifically rails), code can be dynamically loaded and therefore the list of &quot;all&quot; constants is context-dependant."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1527007452, "post_id": 50471938, "comment_id": 87959063, "body": "Hmm okay to each their own. However <a href=\"https://github.com/jbox-web/ajax-datatables-rails\" rel=\"nofollow noreferrer\"><code>ajax-datatables-rails</code></a> is a gem specifically for <code>rails</code>"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 4, "last_activity_date": 1527004579, "creation_date": 1527004579, "answer_id": 50471938, "question_id": 50471581, "link": "https://stackoverflow.com/questions/50471581/how-to-search-defined-constants-in-ruby/50471938#50471938", "title": "How to search defined constants in ruby", "body": "<pre><code>Module.constants.grep /AjaxDatatablesRails/\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core/Module.html#method-c-constants\" rel=\"nofollow noreferrer\"><code>Module.constants</code></a> returns an array of the names of all constants accessible from the point of call.</p>\n\n<p><a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-grep\" rel=\"nofollow noreferrer\"><code>Enumerable#grep</code></a> then loops through this array, and filters out the names matching the given pattern.</p>\n"}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527050769, "creation_date": 1527003399, "last_edit_date": 1527050769, "question_id": 50471581, "link": "https://stackoverflow.com/questions/50471581/how-to-search-defined-constants-in-ruby", "title": "How to search defined constants in ruby", "body": "<p>How can I show all defined constants with the word <code>\"AjaxDatatablesRails\"</code> in it?</p>\n\n<p>I tried this:</p>\n\n<pre><code>::AjaxDatatablesRails::Extensions\n# &gt;&gt; NameError: uninitialized constant AjaxDatatablesRails::Extensions\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527005537, "post_id": 50472152, "comment_id": 87957989, "body": "beware: <code>nil&amp;.nil? # =&gt; nil</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527005608, "post_id": 50472152, "comment_id": 87958029, "body": "@SergioTulentsev yep that is the way the operator works (I didn&#39;t design it) and the question was how to monkey patch the safe operator into a method call"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527005680, "post_id": 50472152, "comment_id": 87958072, "body": "Ah, I see now. Need to rest :) Thought the navigation operator was doing nothing useful there (and <code>public_send</code> would have sufficed)"}, {"owner": {"reputation": 4896, "user_id": 3068360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1As83.jpg?s=128&g=1", "display_name": "Weston Ganger", "link": "https://stackoverflow.com/users/3068360/weston-ganger"}, "edited": false, "score": 0, "creation_date": 1527026348, "post_id": 50472152, "comment_id": 87967621, "body": "Apparently safe navigation doesnt work on Classes or Modules"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 4896, "user_id": 3068360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1As83.jpg?s=128&g=1", "display_name": "Weston Ganger", "link": "https://stackoverflow.com/users/3068360/weston-ganger"}, "edited": false, "score": 1, "creation_date": 1527027949, "post_id": 50472152, "comment_id": 87968109, "body": "@WestonGanger what do you mean? It works just fine <code>Class&amp;.to_s #=&gt;&quot;Class&quot;</code>"}, {"owner": {"reputation": 4896, "user_id": 3068360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1As83.jpg?s=128&g=1", "display_name": "Weston Ganger", "link": "https://stackoverflow.com/users/3068360/weston-ganger"}, "edited": false, "score": 0, "creation_date": 1527094571, "post_id": 50472152, "comment_id": 88000331, "body": "Ex. <code>Array&amp;.bad_method #=&gt; NoMethodError: undefined method </code>bad_method&#39; for Array:Class`"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 4896, "user_id": 3068360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1As83.jpg?s=128&g=1", "display_name": "Weston Ganger", "link": "https://stackoverflow.com/users/3068360/weston-ganger"}, "edited": false, "score": 0, "creation_date": 1527094697, "post_id": 50472152, "comment_id": 88000397, "body": "@WestonGanger that has nothing to do with the safe navigation operator. You explicitly stated <i>&quot;I dont care about the minor behaviour differences between try and safe navigation operator&quot;</i> (well that is one of the differences) I have updated my answer drastically to illustrate"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 9, "last_activity_date": 1527100739, "last_edit_date": 1592644375, "creation_date": 1527005360, "answer_id": 50472152, "question_id": 50471518, "link": "https://stackoverflow.com/questions/50471518/ruby-is-it-possible-to-alias-a-method-to-the-safe-navigation-operator/50472152#50472152", "title": "Ruby - Is it possible to alias a method to the safe navigation operator", "body": "<p>I guess you could go with something as simple as</p>\n<pre><code>class Object\n  def fast_try(meth,*args,&amp;block)\n    self&amp;.public_send(meth,*args,&amp;block)\n  end\nend\n</code></pre>\n<p>For Example:</p>\n<pre><code>[&quot;string&quot;,&quot;STRING&quot;,&quot;pOw&quot;].map do |s| \n  s.fast_try(:upcase!)\n     .fast_try(:chars)\n     .fast_try(:find, -&gt;{&quot;No S&quot;}) { |a| a == &quot;S&quot; }\n     .fast_try(:prepend, &quot;!&quot;)\nend\n#=&gt; [&quot;!S&quot;,nil,&quot;!No S&quot;]\n</code></pre>\n<p>While your question states, <em>&quot; No, I don't care about the minor behavior differences between try and safe navigation operator.&quot;</em>, given the fact that you have written a gem and noted the following</p>\n<blockquote>\n<p>Differences between FastTry and ActiveSupport#try</p>\n<p>It is not our goal to maintain any consistency with the ActiveSupport version of the try method. I do however want to maintain a simple list of the differences. Please create a PR or Issue if you find a difference that should be documented here.</p>\n<p>Nothing reported yet</p>\n</blockquote>\n<p>I feel it prudent to mention that there are discernible, and potentially poignant, differences between the 2 here is a <a href=\"https://repl.it/@engineersmnky/AStry-vs-and-Safe-Navigation\" rel=\"nofollow noreferrer\">Repl Spec</a> to show the differences and for the sake of this answer and the fact that the link might die the output of this spec is as follows:</p>\n<pre><code>ActiveSupport#try vs. Safe Navigation (&amp;.)\n  #try\n    handles would be NoMethodError with nil (using #respond_to?)\n    does not work on a BasicObject\n    behaves like a method call\n      with no method name given\n        when block_given?\n          yields self to a block with arity &gt; 0\n          evaluates block with arity == 0 in the context of self\n        when no block_given?\n          raises an ArgumentError\n      with a method_name given\n        a non nil object\n          uses public_send for message transmission\n        nil\n          calls NilClass#try and returns nil\n  #try!\n    does not handle NoMethodError\n    does not work on a BasicObject\n    behaves like a method call\n      with no method name given\n        when block_given?\n          yields self to a block with arity &gt; 0\n          evaluates block with arity == 0 in the context of self\n        when no block_given?\n          raises an ArgumentError\n      with a method_name given\n        a non nil object\n          uses public_send for message transmission\n        nil\n          calls NilClass#try and returns nil\n  &amp;. (safe navigation)\n    does not handle NoMethodError\n    raises a SyntaxError with no method name given when block_given?\n    raises a SyntaxError with no method name given when no block_given?\n    works on a BasicObject\n    does not act like a method call\n      with a method_name given\n        a non nil object\n          &amp;. is not called\n        nil\n          returns nil without a method call\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527063216, "post_id": 50477215, "comment_id": 87979260, "body": "It&#39;s not alias, though. It may be an implementation that behaves identically, but it&#39;s not an alias."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527063369, "post_id": 50477215, "comment_id": 87979349, "body": "&quot;should always behave just like the safe navigation operator&quot; - there is only one test in this gem. &#175;\\_(\u30c4)_/&#175;"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527082432, "post_id": 50477215, "comment_id": 87992450, "body": "@SergioTulentsev is right this is not an alias just a method wrapper. Also since you noted in your gem that there are no known differences I figure it is worht mentioning that there are notable and poignant differences between the safe navigator and <code>try</code>. Please see some of these notable differences in <a href=\"https://repl.it/@engineersmnky/AStry-vs-and-Safe-Navigation\" rel=\"nofollow noreferrer\">This Repl Spec</a>"}, {"owner": {"reputation": 4896, "user_id": 3068360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1As83.jpg?s=128&g=1", "display_name": "Weston Ganger", "link": "https://stackoverflow.com/users/3068360/weston-ganger"}, "edited": false, "score": 0, "creation_date": 1527095260, "post_id": 50477215, "comment_id": 88000647, "body": "The repo is open source. Its all about collaboration. Simply add a PR or issue in the repo as you deem appropriate."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527099535, "post_id": 50477215, "comment_id": 88002727, "body": "@WestonGanger I am well aware of how open source works but given that your gem is a single file. I would essentially be rewriting your entire library which is not my intention nor does it allow you to showcase your own work."}], "tags": [], "owner": {"reputation": 4896, "user_id": 3068360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1As83.jpg?s=128&g=1", "display_name": "Weston Ganger", "link": "https://stackoverflow.com/users/3068360/weston-ganger"}, "is_accepted": false, "score": 0, "last_activity_date": 1527095440, "last_edit_date": 1527095440, "creation_date": 1527027553, "answer_id": 50477215, "question_id": 50471518, "link": "https://stackoverflow.com/questions/50471518/ruby-is-it-possible-to-alias-a-method-to-the-safe-navigation-operator/50477215#50477215", "title": "Ruby - Is it possible to alias a method to the safe navigation operator", "body": "<p>I have created a gem to solve this problem based on info from this StackOverflow answer. </p>\n\n<p><a href=\"https://github.com/westonganger/fast_try\" rel=\"nofollow noreferrer\">fast_try</a> is a simple method wrapper to the safe navigation operator.</p>\n\n<p>Features / Goals:</p>\n\n<ul>\n<li>Utilize the safe navigation operator (&amp;.) while improving readability</li>\n<li>Improve performance over other implementations such as the ActiveSupport#try method</li>\n<li>Do not worry about most obscure arguments / syntax limitations if they cannot be avoided. Simplicity and speed is key.</li>\n<li>The methods provided should behave very similarly to the safe navigation operator. If you need to retain the exact behaviour of ActiveSupport try, simply set your own custom method name(s) for FastTry.</li>\n<li>The only dependency is Ruby 2.3+. It does NOT require Rails /ActiveSupport anything else however it works great with it too!</li>\n</ul>\n\n<p>In an Initializer:</p>\n\n<pre><code>FastTry.method_names = [:try, :custom_try, :try!]\nrequire 'fast_try/apply'\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>str.try(:upcase).try(:downcase)\n\n# the above statement is now equivalent to using the safe navigation operator Ex.\nstr&amp;.upcase&amp;.downcase\n</code></pre>\n"}], "owner": {"reputation": 4896, "user_id": 3068360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1As83.jpg?s=128&g=1", "display_name": "Weston Ganger", "link": "https://stackoverflow.com/users/3068360/weston-ganger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 50472152, "answer_count": 2, "score": 3, "last_activity_date": 1527100739, "creation_date": 1527003201, "last_edit_date": 1527012089, "question_id": 50471518, "link": "https://stackoverflow.com/questions/50471518/ruby-is-it-possible-to-alias-a-method-to-the-safe-navigation-operator", "title": "Ruby - Is it possible to alias a method to the safe navigation operator", "body": "<p>Ruby 2.3 introduced the safe navigation operator, however I find that its syntax is too discrete an can be easy to miss when briefly scanning code. Instead I much prefer the syntax of <code>try</code> as it looks much more obvious and intentional.</p>\n\n<p>So my question is in Ruby 2.3+, Is there a way to alias or monkey patch a method to the safe navigation operator <code>&amp;.</code> to a custom method name ie. <code>s.fast_try(:upcase!).fast_try(:downcase)</code> instead of writing <code>s&amp;.upcase!&amp;.downcase</code></p>\n\n<p>The main idea is to attempt to improve performance over another implementation such as <code>try</code> method. No, I dont care about the minor behaviour differences between try and safe navigation operator. Also, I do not mind some obscure argument limitations if they cannot be avoided, just point them out.</p>\n"}, {"tags": ["ruby", "csv", "selenium-webdriver", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7880133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f3516a8f3850dc15d8ad8e14c5bdf60?s=128&d=identicon&r=PG&f=1", "display_name": "QAguy", "link": "https://stackoverflow.com/users/7880133/qaguy"}, "edited": false, "score": 0, "creation_date": 1527104971, "post_id": 50478871, "comment_id": 88005524, "body": "Thanks Jonny that does help me get started. How would I be able to loop this though once the assertion is complete, so that I could return to the first page and submit the value in the next row to complete that method? For example I would need to return to &quot;Step 2&quot; to enter the value in row 2 and so on and so on. If that makes any sense."}, {"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "reply_to_user": {"reputation": 13, "user_id": 7880133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f3516a8f3850dc15d8ad8e14c5bdf60?s=128&d=identicon&r=PG&f=1", "display_name": "QAguy", "link": "https://stackoverflow.com/users/7880133/qaguy"}, "edited": false, "score": 0, "creation_date": 1527110171, "post_id": 50478871, "comment_id": 88008066, "body": "Put all that navigation logic inside of method_that_does_stuff(). So inside of that method you could log in, put id in text field, and completes action agains id. Then you assert that this is correct and then the loop starts again. There are pitfalls to this approach as your test could die early and then any assertions following the failure will not run. I suppose you could log a result after each loop and then assert outside of the foreach."}], "tags": [], "owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1527041680, "creation_date": 1527041680, "answer_id": 50478871, "question_id": 50471338, "link": "https://stackoverflow.com/questions/50471338/using-ruby-selenium-to-input-data-from-csv-file-to-complete-actions-until-list-i/50478871#50478871", "title": "Using Ruby Selenium to input data from csv file to complete actions until list is complete", "body": "<p>I'm not sure I fully understand your question but I can try to point you in the right direction.</p>\n\n<p>Ruby has a csv parser built in which you can read about here: <a href=\"https://ruby-doc.org/stdlib-2.0.0/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">CVS class</a></p>\n\n<p>One of the first examples would seem to provide you with the functinoality you are looking for. I think in your example you would want to do something like:</p>\n\n<pre><code>CSV.foreach(\"path/to/file.csv\") do |row|\n  #I'm assuming ID is the first element in each row\n  id = row.first\n  method_that_does_stuff(id)\n\n  # assert that stuff has happened ...\nend\n</code></pre>\n\n<p>does that help get you started?</p>\n"}], "owner": {"reputation": 13, "user_id": 7880133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f3516a8f3850dc15d8ad8e14c5bdf60?s=128&d=identicon&r=PG&f=1", "display_name": "QAguy", "link": "https://stackoverflow.com/users/7880133/qaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527041680, "creation_date": 1527002650, "question_id": 50471338, "link": "https://stackoverflow.com/questions/50471338/using-ruby-selenium-to-input-data-from-csv-file-to-complete-actions-until-list-i", "title": "Using Ruby Selenium to input data from csv file to complete actions until list is complete", "body": "<p>I am fairly new to selenium ruby/rspec scripting and I have come across a use case that requires data to be pulled from a csv or xlsx file in the test. Any help or suggestions on how to approach this would be greatly appreciated. </p>\n\n<p>The test would pull from the csv file and input data from each row to complete the same actions against. This particular file contains a single column of \"id's\" and the same action would need to be repeated until all values from the column have been used. Here is the basic steps...</p>\n\n<ol>\n<li>User logs in</li>\n<li>User pulls first value (id) from file to search in text field</li>\n<li>User completes action against this id</li>\n<li>User returns to text field and pulls value from second row of same file</li>\n<li>User completes action against this id</li>\n</ol>\n\n<p>This would repeat until all rows are completed</p>\n\n<p>Is this possible to complete the same method repeatedly but filtering through data from the file? </p>\n\n<p>How would you pull the csv file into the script and specifically grab the first value (and subsequent values) throughout? </p>\n\n<p>I know this is pretty vague but I have not seen any examples such as this in SO and researching online. Any suggestions or examples would very much appreciated.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527002923, "post_id": 50471314, "comment_id": 87956273, "body": "<code>csv &lt;&lt; </code> accepts/expects an array. You pass it a single string."}], "answers": [{"tags": [], "owner": {"reputation": 3022, "user_id": 336392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c144b7e260029f00b1efb08fb29bb023?s=128&d=identicon&r=PG", "display_name": "Thomas R. Koll", "link": "https://stackoverflow.com/users/336392/thomas-r-koll"}, "is_accepted": true, "score": 0, "last_activity_date": 1527003006, "creation_date": 1527003006, "answer_id": 50471450, "question_id": 50471314, "link": "https://stackoverflow.com/questions/50471314/storing-array-into-csv-undefined-methodmap-for-cocostring/50471450#50471450", "title": "Storing array into Csv : &lt;&lt;&#39;: undefined methodmap&#39; for &quot;Coco&quot;:String", "body": "<p>your <code>csv</code> object doesn't accept a string because it does expect an array that represents a whole row/line.</p>\n\n<p>So, maybe this is what you want</p>\n\n<pre><code>CSV.open(filepath, 'wb', csv_options) do |csv|\n  array.each  { |item| csv &lt;&lt; [item] }\nend\n</code></pre>\n"}], "owner": {"reputation": 318, "user_id": 8398293, "user_type": "registered", "profile_image": "https://graph.facebook.com/732236736985262/picture?type=large", "display_name": "Pierre Laburthe", "link": "https://stackoverflow.com/users/8398293/pierre-laburthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 50471450, "answer_count": 1, "score": 0, "last_activity_date": 1527003006, "creation_date": 1527002582, "question_id": 50471314, "link": "https://stackoverflow.com/questions/50471314/storing-array-into-csv-undefined-methodmap-for-cocostring", "title": "Storing array into Csv : &lt;&lt;&#39;: undefined methodmap&#39; for &quot;Coco&quot;:String", "body": "<p>I am trying to scrape the allocine webpage as an exercice and I can get the movie titles but i can't store them into a csv file. </p>\n\n<pre><code>require 'open-uri'\nrequire 'nokogiri'\nrequire 'csv'\n\nurl = \"http://www.allocine.fr/film/meilleurs/\"\n\nhtml_file = open(url).read\nhtml_doc = Nokogiri::HTML(html_file)\narray = []\n\nhtml_doc.search('.no_underline').each do |element|\n    array &lt;&lt; element.text.strip\nend\n\nputs array\n\ncsv_options = { col_sep: ',', force_quotes: true, quote_char: '\"' }\nfilepath    = 'allocine.csv'\n\nCSV.open(filepath, 'wb', csv_options) do |csv|\n  array.each  { |item| csv &lt;&lt; item }\nend\n</code></pre>\n\n<p>Here is my error message : Coco\nForrest Gump\nLa Ligne verte\nYour Name\nLa Liste de Schindler\n12 hommes en col\u00e8re\nLion\nLe Parrain\nDjango Unchained\nTu ne tueras point\nThe Dark Knight, Le Chevalier Noir\nGran Torino\nLe Seigneur des anneaux : le retour du roi\nPulp Fiction\nLes Evad\u00e9s\nLe Seigneur des anneaux : la communaut\u00e9 de l'anneau\nFight Club\nLe Roi Lion\nThe Greatest Showman\nLe Seigneur des anneaux : les deux tours\nVol au-dessus d'un nid de coucou\nLes Enfants Loups, Ame &amp; Yuki\nAu Revoir L\u00e0-haut\nInterstellar\nGladiator</p>\n\n<p>/Users/laburthe/.rbenv/versions/2.4.3/lib/ruby/2.4.0/csv.rb:1705:in <code>&lt;&lt;': undefined method</code>map' for \"Coco\":String (NoMethodError)\nDid you mean?  tap\n    from scrap.rb:22:in <code>block (2 levels) in &lt;main&gt;'\n    from scrap.rb:22:in</code>each'\n    from scrap.rb:22:in <code>block in &lt;main&gt;'\n    from /Users/laburthe/.rbenv/versions/2.4.3/lib/ruby/2.4.0/csv.rb:1299:in</code>open'\n    from scrap.rb:21:in `'</p>\n"}, {"tags": ["ruby", "macos", "homebrew"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1527002804, "post_id": 50471174, "comment_id": 87956201, "body": "Why don&#39;t you want to use established mechanisms (although I currently prefer asdf) for switching? It&#39;s much easier and more reliable. In any case, have you <code>brew doctor</code>ed first? And are you running the <code>brew</code> you think you are (e.g., <a href=\"https://github.com/Homebrew/legacy-homebrew/issues/25647\" rel=\"nofollow noreferrer\">github.com/Homebrew/legacy-homebrew/issues/25647</a>)"}, {"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1527010599, "post_id": 50471174, "comment_id": 87960589, "body": "Yeah, I&#39;d use <code>rbenv</code> or <code>rvm</code> and curious why you are ruling those out."}, {"owner": {"reputation": 2387, "user_id": 4717992, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SRrvm.jpg?s=128&g=1", "display_name": "Jonathan Soifer", "link": "https://stackoverflow.com/users/4717992/jonathan-soifer"}, "edited": false, "score": 0, "creation_date": 1527058566, "post_id": 50471174, "comment_id": 87976425, "body": "I like to run terminal sessions inside of Emacs using <code>multiterm</code>. It&#39;s not so easy and straightforward to mirror environment variables needed by something like <code>rvm</code> inside of it, so I just avoid it: <a href=\"https://stackoverflow.com/questions/5521112/using-rvm-in-eshell-of-emacs\" title=\"using rvm in eshell of emacs\">stackoverflow.com/questions/5521112/&hellip;</a> . This is one of the reasons. The other one is that I was curious as to how to make this work / why it wasn&#39;t working."}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 5689584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34cbe205b9a39a5bec9d89063665776a?s=128&d=identicon&r=PG&f=1", "display_name": "suyogb", "link": "https://stackoverflow.com/users/5689584/suyogb"}, "is_accepted": true, "score": 1, "last_activity_date": 1527003931, "creation_date": 1527003931, "answer_id": 50471738, "question_id": 50471174, "link": "https://stackoverflow.com/questions/50471174/switching-ruby-versions-using-homebrew/50471738#50471738", "title": "Switching Ruby versions using homebrew", "body": "<p>Check if both the ruby versions are installed.\nIf both are installed, then try this:    </p>\n\n<pre><code>brew unlink ruby@2.5 &amp;&amp; brew link --force --overwrite ruby@2.3\n</code></pre>\n"}], "owner": {"reputation": 2387, "user_id": 4717992, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SRrvm.jpg?s=128&g=1", "display_name": "Jonathan Soifer", "link": "https://stackoverflow.com/users/4717992/jonathan-soifer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3060, "favorite_count": 2, "accepted_answer_id": 50471738, "answer_count": 1, "score": 1, "last_activity_date": 1527003931, "creation_date": 1527002172, "question_id": 50471174, "link": "https://stackoverflow.com/questions/50471174/switching-ruby-versions-using-homebrew", "title": "Switching Ruby versions using homebrew", "body": "<p>One of the projects that I've been working has a dependency on <code>ruby@2.3</code>.</p>\n\n<p>I'm using a Mac and the version of Ruby that I used for other projects is the <code>2.5</code>.</p>\n\n<p>I want to temporarily switch from <code>2.5</code> to <code>2.3</code> using <code>brew</code>. I don't want to use neither <code>rbenv</code> nor <code>rvm</code>.</p>\n\n<p><strong>1. I've installed the <code>2.3.7</code> version, using <code>brew</code>:</strong></p>\n\n<p><code>bf-old&gt; brew install ruby@2.3\n    Warning: ruby@2.3 2.3.7 is already installed and up-to-date\n    To reinstall 2.3.7, run `brew reinstall ruby@2.3</code></p>\n\n<p><strong>2. I'm trying to switch to it, but it's not working:</strong></p>\n\n<p><code>bf-old&gt; brew switch 2.3.7\nError: 2.3.7 not found in the Cellar.\n</code></p>\n\n<p>What can I do about this?</p>\n"}, {"tags": ["ruby", "jenkins", "jenkins-plugins"], "comments": [{"owner": {"reputation": 1250, "user_id": 3626406, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/292edf62f7e356454a28b5d8f6c6cb3d?s=128&d=identicon&r=PG&f=1", "display_name": "cyberjoac", "link": "https://stackoverflow.com/users/3626406/cyberjoac"}, "edited": false, "score": 0, "creation_date": 1531929797, "post_id": 50471097, "comment_id": 89784019, "body": "Did you find any solution ?"}], "owner": {"reputation": 23, "user_id": 7188627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00a694c8c3fcea9c6b78e57c8eef198?s=128&d=identicon&r=PG&f=1", "display_name": "B.Batiege", "link": "https://stackoverflow.com/users/7188627/b-batiege"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1527001930, "creation_date": 1527001930, "question_id": 50471097, "link": "https://stackoverflow.com/questions/50471097/failing-to-install-ruby-runtime-due-to-null-pointer-exception", "title": "Failing to install ruby-runtime due to null pointer exception", "body": "<p>I'm trying to install the ruby-runtime (0.12) plugin for Jenkins, but getting the following error:</p>\n\n<pre><code>ruby-runtime    \n Failure -\njava.lang.NullPointerException\n    at java.lang.Class.isAssignableFrom(Native Method)\n    at org.jenkinsci.jruby.JavaProxyConverter.canConvert(JavaProxyConverter.java:43)\n    at com.thoughtworks.xstream.core.DefaultConverterLookup.registerConverter(DefaultConverterLookup.java:74)\n    at com.thoughtworks.xstream.XStream$2.registerConverter(XStream.java:502)\n    at com.thoughtworks.xstream.XStream.registerConverter(XStream.java:1422)\n    at com.thoughtworks.xstream.XStream.registerConverter(XStream.java:1417)\n    at org.jenkinsci.jruby.JRubyXStream.register(JRubyXStream.java:26)\n    at ruby.RubyRuntimePlugin.initRubyXStreams(RubyRuntimePlugin.java:44)\n    at ruby.RubyRuntimePlugin.start(RubyRuntimePlugin.java:28)\n    at hudson.ClassicPluginStrategy.startPlugin(ClassicPluginStrategy.java:539)\n    at hudson.ClassicPluginStrategy.load(ClassicPluginStrategy.java:528)\nCaused: java.io.IOException: Failed to initialize\n    at hudson.ClassicPluginStrategy.load(ClassicPluginStrategy.java:531)\n    at hudson.PluginManager.dynamicLoad(PluginManager.java:872)\nCaused: java.io.IOException: Failed to install ruby-runtime plugin\n    at hudson.PluginManager.dynamicLoad(PluginManager.java:881)\n    at hudson.PluginManager.dynamicLoad(PluginManager.java:820)\n    at hudson.model.UpdateCenter$InstallationJob._run(UpdateCenter.java:1889)\nCaused: java.io.IOException: Failed to dynamically deploy this plugin\n    at hudson.model.UpdateCenter$InstallationJob._run(UpdateCenter.java:1893)\n    at hudson.model.UpdateCenter$DownloadJob.run(UpdateCenter.java:1651)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n    at hudson.remoting.AtmostOneThreadExecutor$Worker.run(AtmostOneThreadExecutor.java:110)\n    at java.lang.Thread.run(Thread.java:748)\n</code></pre>\n\n<p>I've found some questions on similar issues, however none of them seem to address this specific issue. Would greatly appreciate any assistance or where to go towards in terms of troubleshooting.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord"], "comments": [{"owner": {"reputation": 13804, "user_id": 15754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DrITH.jpg?s=128&g=1", "display_name": "dbugger", "link": "https://stackoverflow.com/users/15754/dbugger"}, "edited": false, "score": 2, "creation_date": 1527001391, "post_id": 50470561, "comment_id": 87955217, "body": "Would be helpful to show the code you have tried."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527002488, "post_id": 50470561, "comment_id": 87955973, "body": "What you are describing sounds like &quot;polymorphism&quot; but without a bit more context it will be difficult to assist."}], "answers": [{"tags": [], "owner": {"reputation": 1105, "user_id": 391122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/63c655bc5282d3f343574aef29de460a?s=128&d=identicon&r=PG", "display_name": "Jared", "link": "https://stackoverflow.com/users/391122/jared"}, "is_accepted": false, "score": 2, "last_activity_date": 1527016996, "last_edit_date": 1527016996, "creation_date": 1527002201, "answer_id": 50471181, "question_id": 50470561, "link": "https://stackoverflow.com/questions/50470561/join-two-rails-activerecord-models-in-a-third-model/50471181#50471181", "title": "Join two Rails ActiveRecord Models in a third Model", "body": "<p>You can still use the <code>union</code> pipe operator to join the two lists of ActiveRecord Objects.</p>\n\n<pre><code>projects = Project.where.not(hero_image: nil)\ncompetitions = Competition.where.not(hero_image: nil)\ncollection_of_proj_and_comps = projects | competitions\n</code></pre>\n\n<p>This will get you an Array of all of those objects in the same list.</p>\n\n<p>I would just add tests to make sure they both \"quack\" like each other.  So add tests to ensure they both respond to <code>hero_image</code> and other things you'll be doing with this unioned collection later on.</p>\n\n<hr>\n\n<p><em>Old answer for pre-edited question</em></p>\n\n<p>For ease of typing out the syntax I'll remake the scenario with Users having many Posts and Comments.</p>\n\n<p>In your User class you could do something like</p>\n\n<pre><code>@user.comments.pluck(:hero_image) | @user.posts.pluck(:hero_image)\n</code></pre>\n\n<p>This would create two arrays then union then, removing any duplicate entries from overlap between the two queries.</p>\n"}, {"tags": [], "owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "is_accepted": false, "score": 0, "last_activity_date": 1527063498, "last_edit_date": 1527063498, "creation_date": 1527004565, "answer_id": 50471933, "question_id": 50470561, "link": "https://stackoverflow.com/questions/50470561/join-two-rails-activerecord-models-in-a-third-model/50471933#50471933", "title": "Join two Rails ActiveRecord Models in a third Model", "body": "<p>It really depends what you're trying to achieve but you might try adding this view to your database (not to be confused with views in MVC). </p>\n\n<pre><code>create or replace view hero_images as\nselect \n  hero_image, \n  id source_id,\n  'Project' source_type\nfrom projects\nunion all\nselect\n  hero_image,\n  id source_id,\n  'Competition' source_type\nfrom competitions\n</code></pre>\n\n<p>(Note that syntax may be different for your database, this is Oracle syntax).</p>\n\n<p>If you then query these in the database, you'll see the hero image, and where it's come from.</p>\n\n<p>If you then write a model called HeroImage, it should return the data you want.</p>\n\n<p>You might want a link back to the source, too</p>\n\n<pre><code>class HeroImage &lt; ActiveRecord::Base\n\n  primary_key :source_id\n\n  belongs_to :source, polymorphic: true\n\nend\n</code></pre>\n\n<p>I'm not sure if this is what you want, but it should get all that data together.</p>\n\n<hr>\n\n<p>What this is doing:</p>\n\n<p>A <em>database view</em> is a canned SQL statement which can be queried like a table (but is read-only).</p>\n\n<p>A <em>union</em> statement will return the results of two or more SQL statements with the same column names as a single table of results.</p>\n\n<p>A <em>polymorphic reference</em> uses *_type to decide which model the related object belongs to and *_id to find a specific instance.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 8066072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e17dcdcdef6de9304af60c054a4d74b?s=128&d=identicon&r=PG&f=1", "display_name": "C.Diezinger", "link": "https://stackoverflow.com/users/8066072/c-diezinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1527010177, "creation_date": 1527010177, "answer_id": 50473445, "question_id": 50470561, "link": "https://stackoverflow.com/questions/50470561/join-two-rails-activerecord-models-in-a-third-model/50473445#50473445", "title": "Join two Rails ActiveRecord Models in a third Model", "body": "<pre><code>projects = Project.where.not(hero_image: nil)\ncompetitions = Competition.where.not(hero_image: nil)\n</code></pre>\n\n<p>I was chasing the wrong rabbit. All I need is</p>\n\n<pre><code>collection_of_proj_and_comps = projects + competitions\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8066072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e17dcdcdef6de9304af60c054a4d74b?s=128&d=identicon&r=PG&f=1", "display_name": "C.Diezinger", "link": "https://stackoverflow.com/users/8066072/c-diezinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 50473445, "answer_count": 3, "score": 2, "last_activity_date": 1527063498, "creation_date": 1527000322, "last_edit_date": 1527010088, "question_id": 50470561, "link": "https://stackoverflow.com/questions/50470561/join-two-rails-activerecord-models-in-a-third-model", "title": "Join two Rails ActiveRecord Models in a third Model", "body": "<p>My problem is as follows:\nI have two models, A and B. Now I want to create a third model C which references the other two models A and B, so that an object of Model C can \"hold\" several objects of A and B.</p>\n\n<p>What I want to do with it: \nModel A and B both have an attribute called :hero_image. Now I want to show all :hero_images of A and B, which are joined in the object of C.</p>\n\n<p>Actually I\u00b4m not sure if I need model C at all.\nI have projects and competitions and I want to join them in a collection.</p>\n\n<pre><code>projects = Project.where.not(hero_image: nil)\ncompetitions = Competition.where.not(hero_image: nil)\n</code></pre>\n\n<p>Now I want to join those 2 collections.</p>\n\n<p>I was chasing the wrong rabbit. All I need is</p>\n\n<pre><code>collection_of_proj_and_comps = projects + competitions\n</code></pre>\n\n<p>Thank you for your advice. Did let me rethink the problem.</p>\n"}, {"tags": ["ruby", "database", "ruby-on-rails-3", "activerecord"], "comments": [{"owner": {"reputation": 482, "user_id": 3609100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6fte8.png?s=128&g=1", "display_name": "Krzysztof Witczak", "link": "https://stackoverflow.com/users/3609100/krzysztof-witczak"}, "edited": false, "score": 0, "creation_date": 1526996956, "post_id": 50469191, "comment_id": 87952067, "body": "If you will add <code>active</code> property to <code>Progression</code> model, you can then add custom validation to <code>Progression</code> to ensure that there is only one <code>active</code> progression for it&#39;s group at any time (so if you will try to add another active progression, it will break). Then you can add method to <code>Group</code> (instead of <code>has_one</code>) that returns that active progression (with that <code>active</code> property set to true)."}, {"owner": {"reputation": 35, "user_id": 3235417, "user_type": "registered", "profile_image": "https://graph.facebook.com/18801567/picture?type=large", "display_name": "p4ndepravity", "link": "https://stackoverflow.com/users/3235417/p4ndepravity"}, "reply_to_user": {"reputation": 482, "user_id": 3609100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6fte8.png?s=128&g=1", "display_name": "Krzysztof Witczak", "link": "https://stackoverflow.com/users/3609100/krzysztof-witczak"}, "edited": false, "score": 0, "creation_date": 1526997296, "post_id": 50469191, "comment_id": 87952313, "body": "@KrzysztofWitczak then a progression would only be able to be &#39;active&#39; for a single Group which means if all my groups happen to want the same progression as their active, there would be <code>Group.all * Progression</code> of identical progressions in the database. This cannot be the best way..."}, {"owner": {"reputation": 482, "user_id": 3609100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6fte8.png?s=128&g=1", "display_name": "Krzysztof Witczak", "link": "https://stackoverflow.com/users/3609100/krzysztof-witczak"}, "edited": false, "score": 1, "creation_date": 1526998001, "post_id": 50469191, "comment_id": 87952826, "body": "I see. Maybe, in that case, has_one :through <a href=\"https://dev.mikamai.com/2015/03/18/fun-with-rails-hasone-through-association/\" rel=\"nofollow noreferrer\">dev.mikamai.com/2015/03/18/&hellip;</a> could be helpful?"}, {"owner": {"reputation": 35, "user_id": 3235417, "user_type": "registered", "profile_image": "https://graph.facebook.com/18801567/picture?type=large", "display_name": "p4ndepravity", "link": "https://stackoverflow.com/users/3235417/p4ndepravity"}, "reply_to_user": {"reputation": 482, "user_id": 3609100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6fte8.png?s=128&g=1", "display_name": "Krzysztof Witczak", "link": "https://stackoverflow.com/users/3609100/krzysztof-witczak"}, "edited": false, "score": 1, "creation_date": 1526998428, "post_id": 50469191, "comment_id": 87953100, "body": "@KrzysztofWitczak thanks for the link! this is a great solution. i was hoping to avoid the use of another join table, but this will work fine."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527010920, "post_id": 50470213, "comment_id": 87960759, "body": "why not put it all on SQL and actually use <code>ActiveRecord::find</code> e.g. <code>def active_progression; progressions.find(active_progess_id);end</code>? This avoids loading all <code>Progression</code>s into memory and iterating them to find just 1"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1527151185, "post_id": 50470213, "comment_id": 88021500, "body": "That is a good option too, I suggested this because if you need all progressions and the active progress then it <i>should</i> be one SQL call, not two. It really depends on the use case, e.g. if you just want to highlight the active row in a list of all progression just knowing the active_progress_id is enough."}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 0, "last_activity_date": 1526999238, "creation_date": 1526999238, "answer_id": 50470213, "question_id": 50469191, "link": "https://stackoverflow.com/questions/50469191/modeling-has-one-active-child-among-has-many-children/50470213#50470213", "title": "Modeling has_one &quot;active&quot; child among has_many children", "body": "<p>One option might be a method, on <code>Group</code>, such as:</p>\n\n<pre><code>def active_progression\n  progressions.all.find { |p| p.id == active_progress_id }\nend\n</code></pre>\n\n<p>The advantage of using a method is if you usually loop over all progressions anyway you only make one SQL call. The method looks up the active progression from the existing set of records.</p>\n\n<p>Note that this is using the Ruby <code>#find</code> method (<a href=\"https://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-find\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-find</a>) not the ActiveRecord <code>#find</code> method.</p>\n"}], "owner": {"reputation": 35, "user_id": 3235417, "user_type": "registered", "profile_image": "https://graph.facebook.com/18801567/picture?type=large", "display_name": "p4ndepravity", "link": "https://stackoverflow.com/users/3235417/p4ndepravity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526999238, "creation_date": 1526996372, "last_edit_date": 1526997169, "question_id": 50469191, "link": "https://stackoverflow.com/questions/50469191/modeling-has-one-active-child-among-has-many-children", "title": "Modeling has_one &quot;active&quot; child among has_many children", "body": "<p>I have a model:</p>\n\n<pre><code>class Group &lt; ActiveRecord::Base\n  has_many :progressions\n  has_one :active_progression, class_name: \"Progression\"\nend\n</code></pre>\n\n<p>And the child:</p>\n\n<pre><code>class Progression &lt; ActiveRecord::Base\n  belongs_to :group\nend\n</code></pre>\n\n<p>I know that convention says I should create a separate foreign key inside <code>Progression</code> to associate the active progression with the Group's id (as that is how <code>has_one</code> works).</p>\n\n<p>However, IMHO, it makes more logical sense to store the 'active' child's id in the Group model.</p>\n\n<p>Edit: The reasoning is that storing the Group id in the Progression model as <code>active_group_id</code> or something similar is semantically confusing and opens the possibility of having multiple active progressions associated with a Group, which is obviously incorrect. </p>\n\n<p>Edit 2: Additionally, a Progression should be able to be the active progression for multiple Groups. Creating an additional join-table seems redundant if only I was able to have the 'active' child's id stored in the Group model.</p>\n\n<p>I have read several posts where people confuse the underlying <code>has_one</code> meaning, assuming it does the same thing as <code>belongs_to</code> but for the parent. I know this is not the case. <code>has_one</code> does the opposite of <code>belongs_to</code>, i.e. looking for the key in the counterpart instead of the calling model.</p>\n\n<p>If Rails does not provide a method for creating an association of this nature, what is the most Railsy solution?</p>\n"}, {"tags": ["ruby", "ruby-hash"], "answers": [{"comments": [{"owner": {"reputation": 4106, "user_id": 104219, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/24d3df508ced34482056f6a939588152?s=128&d=identicon&r=PG", "display_name": "Bryan Ash", "link": "https://stackoverflow.com/users/104219/bryan-ash"}, "edited": false, "score": 0, "creation_date": 1526993976, "post_id": 50468286, "comment_id": 87949783, "body": "data[:foo][:bar][:baz] ||= [] =&gt; {:foo=&gt;{:bar=&gt;{:baz=&gt;{}}}}"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 4106, "user_id": 104219, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/24d3df508ced34482056f6a939588152?s=128&d=identicon&r=PG", "display_name": "Bryan Ash", "link": "https://stackoverflow.com/users/104219/bryan-ash"}, "edited": false, "score": 0, "creation_date": 1526994075, "post_id": 50468286, "comment_id": 87949866, "body": "@BryanAsh so what? One obviously should not call <code>||=</code> on the hash with a <code>default_proc</code>, use <code>=</code> instead."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 5, "creation_date": 1526994987, "post_id": 50468286, "comment_id": 87950504, "body": "<code>Hash.new { |h, k| h[k] = Hash.new(&amp;h.default_proc) }</code> is a bit more efficient."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 3, "creation_date": 1526995229, "post_id": 50468286, "comment_id": 87950675, "body": "Eh, credits, as if I invented it :D anyway, it&#39;s a known incantation, with a somewhat less known name: &quot;hash autovivification&quot;."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1527021655, "post_id": 50468286, "comment_id": 87965783, "body": "I suppose that if <code>data</code> is a given non-empty hash one simply attaches a default proc. If one does so could there be side-effects? For example, what if the hash already had a default proc? Note that it would be necessary to use <code>h.key?(k)</code> to check if a key exists, rather than relying on <code>h[k].nil?</code>."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1527052937, "post_id": 50468286, "comment_id": 87973944, "body": "@mudasobwa perfect answer to the question. Kudos to Amadan too for more efficient approach. Just a note: It will set the keys in hash even if we just access <code>data[:foo][:bar][:baz]</code> before setting its value. Not a problem for me, but good to remember."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 8, "last_activity_date": 1526995386, "last_edit_date": 1526995386, "creation_date": 1526993735, "answer_id": 50468286, "question_id": 50468234, "link": "https://stackoverflow.com/questions/50468234/better-way-to-initialize-and-update-deeply-nested-hash/50468286#50468286", "title": "Better way to initialize and update deeply nested Hash", "body": "<p>Use <em>hash autovivification</em>:</p>\n\n<pre><code>data = Hash.new { |h, k| h[k] = h.dup.clear }\n#\u21d2 {}\n\n# or, credits to @Amadan:\ndata = Hash.new { |h, k| h[k] = Hash.new(&amp;h.default_proc) }\n#\u21d2 {}\n\ndata[:foo][:bar][:baz] = 42\ndata\n#\u21d2 {:foo=&gt;{:bar=&gt;{:baz=&gt;42}}}\n</code></pre>\n\n<p>The trick used here is we use <a href=\"https://ruby-doc.org/core/Hash.html#method-i-default_proc\" rel=\"noreferrer\"><code>Hash#default_proc</code></a> to create nested keys.</p>\n\n<p>For your case:</p>\n\n<pre><code>(data[:foo][:bar][:baz] = []) &lt;&lt; 99\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527001370, "post_id": 50470769, "comment_id": 87955205, "body": "Bad, bad idea. Never subclass built-in collection classes for something as insignificant as this. Can you guess why?"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527001516, "post_id": 50470769, "comment_id": 87955307, "body": "I heard this before, but can&#39;t recall why."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527001582, "post_id": 50470769, "comment_id": 87955353, "body": "What would be the result of <code>h.slice(:foo)[:f1][:f2] = &#39;f3&#39;</code>?"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527001681, "post_id": 50470769, "comment_id": 87955424, "body": "<code>#slice</code> is a Rails method?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527002026, "post_id": 50470769, "comment_id": 87955667, "body": "You didn&#39;t try it? <code>#slice</code> is in core."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527002101, "post_id": 50470769, "comment_id": 87955710, "body": "I did, <code>undefined method slice for {}:Hash</code>. Ruby 2.4."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527002119, "post_id": 50470769, "comment_id": 87955720, "body": "I&#39;m on 2.5. :shrug:"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527002191, "post_id": 50470769, "comment_id": 87955772, "body": "anyway I guess slice returns a Hash, not SpecialHash."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1527002214, "post_id": 50470769, "comment_id": 87955787, "body": "Yep, exactly this."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527002267, "post_id": 50470769, "comment_id": 87955821, "body": "In which case you could use a delegator to get the same class back for every method call."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527002292, "post_id": 50470769, "comment_id": 87955840, "body": "You could, but <i>should</i> you? Is it worth the effort and potential problems?"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1527002378, "post_id": 50470769, "comment_id": 87955886, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/171556/discussion-between-kris-and-sergio-tulentsev\">continue this discussion in chat</a>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1527012427, "post_id": 50470769, "comment_id": 87961469, "body": "or even <code>def [](key); super || store(key,self.class.new); end</code>"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1527151586, "post_id": 50470769, "comment_id": 88021763, "body": "Only reason I didn&#39;t use <code>super</code> was in case a key had the value <code>nil</code>, I think it would return a new instance instead of <code>nil</code>."}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 0, "last_activity_date": 1527001345, "last_edit_date": 1527001345, "creation_date": 1527000961, "answer_id": 50470769, "question_id": 50468234, "link": "https://stackoverflow.com/questions/50468234/better-way-to-initialize-and-update-deeply-nested-hash/50470769#50470769", "title": "Better way to initialize and update deeply nested Hash", "body": "<p>You could also do something like:</p>\n\n<pre><code>class SpecialHash &lt; Hash\n  def [](key)\n    if has_key?(key)\n      super(key)\n    else\n      self[key] = self.class.new\n    end\n  end\nend\n\nh = SpecialHash.new\nh[:foo][:bar][:baz] = \"Baz\"\nh # =&gt; {:foo=&gt;{:bar=&gt;{:baz=&gt;\"Baz\"}}}\n</code></pre>\n\n<p>It duck types exactly the same as a <code>Hash</code>.</p>\n\n<p>You can reformat the same code as:</p>\n\n<pre><code>class SpecialHash &lt; Hash\n  def [](key)\n    return super if has_key?(key)\n    self[key] = self.class.new\n  end\nend\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>class SpecialHash &lt; Hash\n  def [](key)\n    has_key?(key) ? super : self[key] = self.class.new\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1527053273, "post_id": 50475905, "comment_id": 87974051, "body": "Thanks for the answer. But as per my need, i think i&#39;ll go with mudasobwa&#39;s answer for now. May be later. :)"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1527061451, "last_edit_date": 1527061451, "creation_date": 1527020581, "answer_id": 50475905, "question_id": 50468234, "link": "https://stackoverflow.com/questions/50468234/better-way-to-initialize-and-update-deeply-nested-hash/50475905#50475905", "title": "Better way to initialize and update deeply nested Hash", "body": "<p>One could use recursion.</p>\n\n<pre><code>def stuff_it(h, first_key, *rest_keys, val)\n  if rest_keys.empty?\n    (h[first_key] ||= []) &lt;&lt; val\n  else\n    h[first_key] = stuff_it(h[first_key] ||= {}, *rest_keys, val)\n  end\n  h\nend   \n\nstuff_it({ a: 1 }, :foo, :bar, :baz, 99)\n  #=&gt; {:a=&gt;1, :foo=&gt;{:bar=&gt;{:baz=&gt;[99]}}}\nstuff_it({ a: 1, foo: { b: 2 } }, :foo, :bar, :baz, 99)\n  #=&gt; {:a=&gt;1, :foo=&gt;{:b=&gt;2, :bar=&gt;{:baz=&gt;[99]}}}\nstuff_it({ a: 1, foo: { b: 2, bar: { c: 3 } } }, :foo, :bar, :baz, 99)\n  #=&gt; {:a=&gt;1, :foo=&gt;{:b=&gt;2, :bar=&gt;{:c=&gt;3, :baz=&gt;[99]}}}\nh = { a: 1, foo: { b: 2, bar: { c: 3, baz: [88] } } }\nstuff_it(h, :foo, :bar, :baz, 99)\n  #=&gt; {:a=&gt;1, :foo=&gt;{:b=&gt;2, :bar=&gt;{:c=&gt;3, :baz=&gt;[88, 99]}}}\nh # =&gt; {:a=&gt;1, :foo=&gt;{:b=&gt;2, :bar=&gt;{:c=&gt;3, :baz=&gt;[88, 99]}}}\n</code></pre>\n\n<p>As one can see from the last example, the method is destructive. It can be made non-destructive by making a small change.</p>\n\n<pre><code>def stuff_it(g, first_key, *rest_keys, val)\n  h = g.merge(g)\n  if rest_keys.empty?\n     h[first_key] = h[first_key] ? h[first_key].dup &lt;&lt; val : [val]\n  else\n    h[first_key] = stuff_it(h[first_key] ||= {}, *rest_keys, val)\n  end\n  h\nend   \n\nh = { a: 1, foo: { b: 2, bar: { c: 3 } } }\nstuff_it(h, :foo, :bar, :baz, 99)\n  #=&gt; {:a=&gt;1, :foo=&gt;{:b=&gt;2, :bar=&gt;{:c=&gt;3, :baz=&gt;[99]}}}\nh #=&gt; { a: 1, foo: { b: 2, bar: { c: 3 } } }\n\nh = { a: 1, foo: { b: 2, bar: { c: 3, baz: [88] } } }\nstuff_it(h, :foo, :bar, :baz, 99)\n  #=&gt; {:a=&gt;1, :foo=&gt;{:b=&gt;2, :bar=&gt;{:c=&gt;3, :baz=&gt;[88, 99]}}}\nh #=&gt; {:a=&gt;1, :foo=&gt;{:b=&gt;2, :bar=&gt;{:c=&gt;3, :baz=&gt;[88]}}}\n</code></pre>\n"}], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1064, "favorite_count": 0, "accepted_answer_id": 50468286, "answer_count": 3, "score": 5, "last_activity_date": 1527061451, "creation_date": 1526993543, "last_edit_date": 1527050982, "question_id": 50468234, "link": "https://stackoverflow.com/questions/50468234/better-way-to-initialize-and-update-deeply-nested-hash", "title": "Better way to initialize and update deeply nested Hash", "body": "<p>I have a <code>Hash</code> and I want to insert some data into it at a deep level, but a key might be missing at any level. So, I am conditionally initializing it before updating its value at every level.</p>\n\n<p>What would be a better way to write this or an approach that can make code less ugly?</p>\n\n<pre><code>data[:foo] ||= {}\ndata[:foo][:bar] ||= {}\ndata[:foo][:bar][:baz] ||= []\ndata[:foo][:bar][:baz] &lt;&lt; 99\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "grouping"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1526999833, "post_id": 50467702, "comment_id": 87954102, "body": "Could you consider adding a new column which is a Date not DateTime and group by that?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9424176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CCIF.jpg?s=128&g=1", "display_name": "Athimni Iheb", "link": "https://stackoverflow.com/users/9424176/athimni-iheb"}, "edited": false, "score": 0, "creation_date": 1526994295, "post_id": 50467846, "comment_id": 87950014, "body": "I get this  Error :::"}, {"owner": {"reputation": 9, "user_id": 9424176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CCIF.jpg?s=128&g=1", "display_name": "Athimni Iheb", "link": "https://stackoverflow.com/users/9424176/athimni-iheb"}, "edited": false, "score": 0, "creation_date": 1526994339, "post_id": 50467846, "comment_id": 87950043, "body": "Groupdate::Error: ActiveRecord::Base.default_timezone must be :utc to use Groupdate"}], "tags": [], "owner": {"reputation": 856, "user_id": 2131983, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3sKfa.jpg?s=128&g=1", "display_name": "khiav reoy", "link": "https://stackoverflow.com/users/2131983/khiav-reoy"}, "is_accepted": false, "score": 0, "last_activity_date": 1526992443, "creation_date": 1526992443, "answer_id": 50467846, "question_id": 50467702, "link": "https://stackoverflow.com/questions/50467702/ruby-on-rails-group-by-week/50467846#50467846", "title": "Ruby on Rails group_by_week", "body": "<p>Have you tried setting the timezone of <code>Groupdate</code>?</p>\n\n<pre><code>Groupdate.time_zone = \"Pacific Time (US &amp; Canada)\"\n</code></pre>\n\n<p><a href=\"https://github.com/ankane/groupdate#time-zones\" rel=\"nofollow noreferrer\">see the docs</a></p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1526996277, "creation_date": 1526996277, "answer_id": 50469160, "question_id": 50467702, "link": "https://stackoverflow.com/questions/50467702/ruby-on-rails-group-by-week/50469160#50469160", "title": "Ruby on Rails group_by_week", "body": "<p>Try play with this:</p>\n\n<pre><code>by_week = goal.feats.group_by {|feat| feat.created_at.strftime('%W')}\n</code></pre>\n\n<p>This returns an hash grouped by week, where each key is the week number (details <a href=\"https://stackoverflow.com/a/13075656/5239030\">here</a>).</p>\n\n<p>Then you can count how many values per keys:</p>\n\n<pre><code>by_week.map {|_k , v| v.length }\n</code></pre>\n\n<p>Which returns an array of counts</p>\n"}], "owner": {"reputation": 9, "user_id": 9424176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CCIF.jpg?s=128&g=1", "display_name": "Athimni Iheb", "link": "https://stackoverflow.com/users/9424176/athimni-iheb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 733, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1526996277, "creation_date": 1526992085, "question_id": 50467702, "link": "https://stackoverflow.com/questions/50467702/ruby-on-rails-group-by-week", "title": "Ruby on Rails group_by_week", "body": "<p>I am trying to create a request where I group my elements by week. Something like :</p>\n\n<pre><code>&lt;%= line_chart @goals.map { |goal|\n{name: goal.name, data: goal.feats.group_by_week(:created_at).count}\n} %&gt;\n</code></pre>\n\n<p>I am using mysql db so i guess 'trunc('week', element)' does not work for me. </p>\n\n<p>I have also tried to work with the 'groupdate gem', but since I dont work with 'utc' it also gave me an error. </p>\n\n<p>Can you please help me ?</p>\n"}, {"tags": ["ruby", "variables"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 2, "creation_date": 1526992071, "post_id": 50467524, "comment_id": 87948394, "body": "It&#39;s an instance variable of the class object."}, {"owner": {"reputation": 107, "user_id": 9445965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73b3c5e8539b74049577c68b6275e21?s=128&d=identicon&r=PG&f=1", "display_name": "blackwater7", "link": "https://stackoverflow.com/users/9445965/blackwater7"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1526992375, "post_id": 50467524, "comment_id": 87948659, "body": "But I thought class variables must be shown like @@x = 5. Whats the difference between them?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1526992476, "post_id": 50467524, "comment_id": 87948730, "body": "Class variables are accessible easily also in subclasses (i.e. if you define <code>@@a = 5</code> in parent class, this value will be the same in sublass) and instances of the class."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1526992499, "post_id": 50467524, "comment_id": 87948753, "body": "&quot;class variables&quot; is not the same thing as &quot;instance variable on the class object&quot;. Very different, in fact."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1527000118, "post_id": 50467524, "comment_id": 87954282, "body": "I never use <code>@@x</code> but sometimes <code>@x</code>. However in general I try and avoid any state in classes as it is global and can&#39;t easily be changed for different contexts."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 9445965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73b3c5e8539b74049577c68b6275e21?s=128&d=identicon&r=PG&f=1", "display_name": "blackwater7", "link": "https://stackoverflow.com/users/9445965/blackwater7"}, "edited": false, "score": 0, "creation_date": 1526992361, "post_id": 50467779, "comment_id": 87948647, "body": "But I thought class variables must be shown like @@x = 5. Whats the difference between them?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1527028638, "post_id": 50467779, "comment_id": 87968322, "body": "Who said anything about class variables?"}], "tags": [], "owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "is_accepted": false, "score": 0, "last_activity_date": 1526992261, "creation_date": 1526992261, "answer_id": 50467779, "question_id": 50467524, "link": "https://stackoverflow.com/questions/50467524/what-if-you-put-x-5-right-after-class-definition/50467779#50467779", "title": "What if you put @x = 5 right after class definition?", "body": "<p>It's not an instance variable for objects of class A, but it <em>is</em> an instance variable for the class itself.  A class is just an object in ruby, so that class can have its own instance variables.</p>\n\n<pre><code>class A\n  @x = 5\n  def self.show_my_var\n    @x\n  end\nend\n\nA.show_my_var\n=&gt; 5\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1526992917, "post_id": 50467829, "comment_id": 87949035, "body": "I&#39;d say that is the main difference, yes. But not the only one. For example, class variables provide what I call &quot;unambiguous access&quot;: If you use <code>@@x</code>, you&#39;ll always refer to the class variables, from everywhere (instance context or class context)."}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1526993145, "post_id": 50467829, "comment_id": 87949197, "body": "I&#39;d say instance variables are pretty unambiguous, people just tend to get confused as to what the <code>self</code> they are currently operating on is (though except for rare meta programming cases I think it&#39;s generally rather obvious)."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1526994896, "post_id": 50467829, "comment_id": 87950436, "body": "Not obvious, no. I mean, for well factored/structured code it is. But imagine a method <code>foo</code> defined in the middle of 200-LOC <code>class &lt;&lt; self</code> block. And you arrive to its definition from project search results. (<i>this may have happened to me more times that I&#39;d like</i>)"}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1526995638, "post_id": 50467829, "comment_id": 87951014, "body": "Now this is getting a bit off-topic, but if you have 200 LOC <code>class &lt;&lt; self</code> blocks, ambiguous instance variables don&#39;t strike me as the biggest problem ;-)"}], "tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": false, "score": 5, "last_activity_date": 1526993043, "last_edit_date": 1526993043, "creation_date": 1526992395, "answer_id": 50467829, "question_id": 50467524, "link": "https://stackoverflow.com/questions/50467524/what-if-you-put-x-5-right-after-class-definition/50467829#50467829", "title": "What if you put @x = 5 right after class definition?", "body": "<p>A class object itself is an instance of <code>Class</code>.</p>\n\n<pre><code>A.class\n#=&gt; Class\n</code></pre>\n\n<p>So this is indeed an instance variable, just on the class <code>A</code> itself, not on instances of <code>A</code>. Without an accessor you get the value like this:</p>\n\n<pre><code>A.instance_variable_get('@x')\n#=&gt; 5\n</code></pre>\n\n<p>The difference between class variables (<code>@@x</code>) and class instance variables (<code>@x</code>) is that the former are shared with subclasses, whereas the latter are not:</p>\n\n<pre><code>class Test1 ; @@x = 5 ; end\nclass Test2 &lt; Test1 ; end\n\nTest2.class_variable_get('@@x')\n#=&gt; 5\nTest1.class_variable_set('@@x', 1)\n#=&gt; 1\n&gt;&gt; Test2.class_variable_get('@@x')\n#=&gt; 1\n</code></pre>\n\n<p>This does not happen with class instance variables:</p>\n\n<pre><code>class Test3 ; @x = 5 ; end\nclass Test4 &lt; Test 3 ; end\n\nTest3.instance_variables\n#=&gt; [:@x]\n&gt;&gt; Test4.instance_variables\n#=&gt; []\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 9445965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73b3c5e8539b74049577c68b6275e21?s=128&d=identicon&r=PG&f=1", "display_name": "blackwater7", "link": "https://stackoverflow.com/users/9445965/blackwater7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1526993043, "creation_date": 1526991619, "question_id": 50467524, "link": "https://stackoverflow.com/questions/50467524/what-if-you-put-x-5-right-after-class-definition", "title": "What if you put @x = 5 right after class definition?", "body": "<p>1) What is the role of @x in this code? Its not an instance variable right? Because there was no attr_accessor , or initialize method in my code. (if i remember correctly)</p>\n\n<p>2) How can I view the data in x? How can I reach that?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>class A\n@x = 5\n// some other things here\nend\n</code></pre>\n"}, {"tags": ["ruby", "string", "utf-8"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1526991805, "post_id": 50467338, "comment_id": 87948185, "body": "You&#39;re having issues with German characters only ? You need a method to translate &quot;b&#252;rger&quot; into &quot;b\\x81rger&quot; and other words that have special characters ?"}, {"owner": {"reputation": 918, "user_id": 788754, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/13d7a3ab12ec57e0d372d7115362cb91?s=128&d=identicon&r=PG", "display_name": "Pod", "link": "https://stackoverflow.com/users/788754/pod"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1526991945, "post_id": 50467338, "comment_id": 87948299, "body": "I will have problems with special characters in general, &#229;,&#228;,&#252;,&#225;, etc."}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1526992209, "post_id": 50467338, "comment_id": 87948520, "body": "&#196; = \\\\x8e, &#228; = \\\\x84, &#214; = \\\\x99, &#246; = \\\\x94, &#220; = \\\\x9a, &#252; = \\\\x81, &#223; = \\\\xe1 Here&#39;s the table for german characters, unfortunately I can not find out the rest of the table that your printer is using. I hope someone else with more knowledge in encoding/decoding can help. Good luck!"}, {"owner": {"reputation": 918, "user_id": 788754, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/13d7a3ab12ec57e0d372d7115362cb91?s=128&d=identicon&r=PG", "display_name": "Pod", "link": "https://stackoverflow.com/users/788754/pod"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1526992400, "post_id": 50467338, "comment_id": 87948672, "body": "Thanks Viktor. Yep in case I can&#39;t find some usable method I guess I could do the substitution myself. Though I hope there&#39;s a general method for it."}], "answers": [{"comments": [{"owner": {"reputation": 918, "user_id": 788754, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/13d7a3ab12ec57e0d372d7115362cb91?s=128&d=identicon&r=PG", "display_name": "Pod", "link": "https://stackoverflow.com/users/788754/pod"}, "edited": false, "score": 0, "creation_date": 1526992759, "post_id": 50467853, "comment_id": 87948938, "body": "Awesome! This solves the issue with the printer. Thanks!"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 6, "last_activity_date": 1526992464, "creation_date": 1526992464, "answer_id": 50467853, "question_id": 50467338, "link": "https://stackoverflow.com/questions/50467338/ruby-decode-string/50467853#50467853", "title": "Ruby decode string", "body": "<p>Turns out it\u2019s <strong><code>CP850</code></strong>.</p>\n\n<p><strong>Proper solution (Ruby 2.5+)</strong></p>\n\n<p>Normalize the unicode string and then encode it into <code>CP850</code>:</p>\n\n<pre><code>\"b\u00fcrger\".unicode_normalize(:nfc).encode(Encoding::CP850)\n#\u21d2 \"b\\x81rger\"\n</code></pre>\n\n<p>Works for both special characters and combined diacritics.</p>\n\n<p><strong>Fallback solution (Ruby 2.5-)</strong></p>\n\n<p>Encode and pray it\u2019s a composed umlaut:</p>\n\n<pre><code>\"b\u00fcrger\".encode(Encoding::CP850)\n#\u21d2 \"b\\x81rger\"\n</code></pre>\n"}], "owner": {"reputation": 918, "user_id": 788754, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/13d7a3ab12ec57e0d372d7115362cb91?s=128&d=identicon&r=PG", "display_name": "Pod", "link": "https://stackoverflow.com/users/788754/pod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "accepted_answer_id": 50467853, "answer_count": 1, "score": 2, "last_activity_date": 1526992464, "creation_date": 1526991081, "last_edit_date": 1526991389, "question_id": 50467338, "link": "https://stackoverflow.com/questions/50467338/ruby-decode-string", "title": "Ruby decode string", "body": "<p>In Ruby how can I get:</p>\n\n<p><code>\"b\\x81rger\"</code> by providing the string <code>\"b\u00fcrger\"</code>.</p>\n\n<p>I need to print special characters to a Zebra printer, I can see that <code>\"b\\x81rger\"</code> prints <code>\"b\u00fcrger\"</code>, but sending <code>\"b\u00fcrger\"</code> does not print the correct character.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "multiple-databases"], "comments": [{"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 1, "creation_date": 1526991256, "post_id": 50467291, "comment_id": 87947840, "body": "If you have &quot;referred the question&quot; then I suggest you show us exactly why this does not suit you. And if you have be &quot;referred before&quot; then it&#39;s exactly for the same reason you are likely to here, being that you have not taken the time to &quot;show&quot; us what is so different about your problem. If you cannot do that, then I think you know what the likely outcome here is. I suggest you get busy editing your question with lots of detail about what you actually have done."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1527000262, "post_id": 50467291, "comment_id": 87954390, "body": "You can&#39;t really have two identically named models without conflicts. Can you not namespace them in different models. Or do you mean you have one model but need instances to point to different databases?"}, {"owner": {"reputation": 171, "user_id": 7264802, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9619647177653103cccb62e579a2cadc?s=128&d=identicon&r=PG&f=1", "display_name": "Praneetha", "link": "https://stackoverflow.com/users/7264802/praneetha"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1527016296, "post_id": 50467291, "comment_id": 87963350, "body": "Hi @Kris, I have one model say, &#39;SampleModel&#39; in one rails application say  &#39;sample1&#39; and I have another model with same name &#39;SampleModel&#39; in another rails application say &#39;sample2&#39;. Now I want to write a method  in &#39;sample1&#39; application which will actually use &#39;SampleModel&#39; of &#39;sample2&#39; application. Please let me know if any details are required. Thank you."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1527151316, "post_id": 50467291, "comment_id": 88021575, "body": "I would suggest to put the shared code in a gem/engine to share them between both applications. You could either share the entire model or add a module (called concern in Rails) which is included in both models."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1527151401, "post_id": 50467291, "comment_id": 88021636, "body": "The other option is an HTTP API between both applications, so you don&#39;t access the code in the other application directly but via HTTP like a regular request."}], "owner": {"reputation": 171, "user_id": 7264802, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9619647177653103cccb62e579a2cadc?s=128&d=identicon&r=PG&f=1", "display_name": "Praneetha", "link": "https://stackoverflow.com/users/7264802/praneetha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526990921, "creation_date": 1526990921, "question_id": 50467291, "link": "https://stackoverflow.com/questions/50467291/rails-multiple-mongo-db-connections-but-with-same-model-name", "title": "Rails multiple mongo db connections but with same model name.", "body": "<p>I have 2 models with same name but in different mongo db's. I want to access these 2 models in one rails application. \nHow can I do that?</p>\n\n<p>I have referred to this question but I am not sure how it fetches data if it has same model name : <a href=\"https://stackoverflow.com/questions/5796921/mongoid-using-more-than-one-database\">Mongoid: using more than one database?</a> </p>\n\n<p>PS: I have also referred similar questions on stack overflow but some of them are for mysql db and I am not sure how I can use same thing for mongo db. </p>\n"}, {"tags": ["ruby", "sketchup"], "answers": [{"tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": true, "score": 2, "last_activity_date": 1526992106, "last_edit_date": 1526992106, "creation_date": 1526991605, "answer_id": 50467518, "question_id": 50466846, "link": "https://stackoverflow.com/questions/50466846/how-to-set-camera-for-page-in-sketchup-programmatically/50467518#50467518", "title": "How to set camera for page in Sketchup programmatically?", "body": "<p>Have you tried to use <a href=\"https://ruby.sketchup.com/Sketchup/Camera.html#set-instance_method\" rel=\"nofollow noreferrer\"><code>Camera#set</code></a>?</p>\n\n<pre><code>pg_front.camera.set(front_cam)\n</code></pre>\n\n<p>I know very little about Sketchup, but you may have to update the page afterwards:</p>\n\n<pre><code>pg_front.update(1)\n</code></pre>\n\n<p>According to the docs of <a href=\"https://ruby.sketchup.com/Sketchup/Page.html#update-instance_method\" rel=\"nofollow noreferrer\"><code>Page#update</code></a> the following update flags are available:</p>\n\n<pre><code>- 1 - Camera Location,\n- 2 - Drawing Style,\n- 4 - Shadow Settings,\n- 8 - Axes Location,\n- 16 - Hidden Geometry,\n- 32 - Visible Layers,\n- 64 - Active Section Planes.\n</code></pre>\n\n<p>If this isn't working, try disabling the camera before reassigning it, then enable it again (<code>pg_front.use_camera = true/false</code>).</p>\n"}], "owner": {"reputation": 45, "user_id": 7454160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d423bbd3c122c0a67de45209872989?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin Bara\u0144ski", "link": "https://stackoverflow.com/users/7454160/marcin-bara%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 50467518, "answer_count": 1, "score": 1, "last_activity_date": 1526992106, "creation_date": 1526989456, "question_id": 50466846, "link": "https://stackoverflow.com/questions/50466846/how-to-set-camera-for-page-in-sketchup-programmatically", "title": "How to set camera for page in Sketchup programmatically?", "body": "<p>I am new in writing Sketchup plugins and I got problem. I know how to create page (scene) and camera, but I have no idea how to set the camera for the page. Any tips? </p>\n\n<pre><code>eye = [100, 100, 500]\ntarget = [300, 300, 300]\nup = [0, 0, 1]\n\npg_front = pages.add \"front\"\nfront_cam = Sketchup::Camera.new eye, target, up\n\n# First idea, but it's not working\npg_front.camera = front_cam\n\n# Second idea, but it's not working too\npg_front.use_camera = front_cam\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "heroku", "sqlite"], "comments": [{"owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "edited": false, "score": 0, "creation_date": 1527053279, "post_id": 50466386, "comment_id": 87974053, "body": "Could you please provide the <code>database.yml</code> for checking the database adapter, I think it&#39;s causing for database adapter, the <code>like</code> does not work in <code>PostgreSQL</code> OTOH, <code>ilike</code> does not work in <code>SQLite</code>,  if you use <code>SQLite</code> for development &amp; <code>PostgreSQL</code> for production,"}, {"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "reply_to_user": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "edited": false, "score": 0, "creation_date": 1527053887, "post_id": 50466386, "comment_id": 87974250, "body": "@fool-dev I have updated the question."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1527002797, "post_id": 50466615, "comment_id": 87956195, "body": "&quot;OTOH&quot; = &quot;<b>O</b>bfuscated <b>T</b>ext <b>O</b>nly <b>H</b>inders&quot; (I believe) :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1527004113, "post_id": 50466615, "comment_id": 87957060, "body": "@engineersmnky <b>O</b>n <b>T</b>he <b>O</b>ther <b>H</b>and, but I like your interpretation more."}, {"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "edited": false, "score": 0, "creation_date": 1527004665, "post_id": 50466615, "comment_id": 87957433, "body": "@mudasobwa thanks for the answer, my question is the search query is not working, it&#39;s going to else block"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "edited": false, "score": 0, "creation_date": 1527004758, "post_id": 50466615, "comment_id": 87957510, "body": "@jesica do you have the data in production? It looks like you haven\u2019t that\u2019s why it\u2019s going to <code>else</code> block."}, {"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "edited": false, "score": 0, "creation_date": 1527005164, "post_id": 50466615, "comment_id": 87957772, "body": "Yes I have lots of data if I use like <code>Job.all</code> then it will return the data"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1527005307, "post_id": 50466615, "comment_id": 87957854, "body": "Then check <code>params[:q]</code>\u2014it looks like the scope returns an empty set."}, {"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "edited": false, "score": 0, "creation_date": 1527055067, "post_id": 50466615, "comment_id": 87974666, "body": "@mudasobwa +1 for you but the solution from the <code>fool-dev</code> answer, you answer&#39;s helped me a lot, Thanks"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 6, "last_activity_date": 1526988673, "creation_date": 1526988673, "answer_id": 50466615, "question_id": 50466386, "link": "https://stackoverflow.com/questions/50466386/json-data-showing-in-development-properly-but-in-production-does-not-showing-pro/50466615#50466615", "title": "JSON data showing in development properly but in production does not showing properly", "body": "<p>The <code>if</code> branch of your code is fine, and since <code>dev</code> contains records, it\u2019s being rendered without any glitch.</p>\n\n<p>In <code>prod</code>, OTOH, there are no records and the <code>else</code> branch, which is not quite correct, is tried to be rendered. And it fails, giving you the error.</p>\n\n<p>Do supply a hash there instead:</p>\n\n<pre><code>else\n  render json: {error: \"Not Found\"}, status: :ok\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "is_accepted": true, "score": 1, "last_activity_date": 1527053349, "creation_date": 1527053349, "answer_id": 50480444, "question_id": 50466386, "link": "https://stackoverflow.com/questions/50466386/json-data-showing-in-development-properly-but-in-production-does-not-showing-pro/50480444#50480444", "title": "JSON data showing in development properly but in production does not showing properly", "body": "<p>Look the <code>LIKE</code> keyword in SQL, if you use <code>SQLite</code> database for <code>development</code> and <code>PostgreSQL</code> database for <code>production</code> then maybe it's happened, the <code>like</code> is working on the development environment and production environment will be <code>ilike</code> the <code>like</code> does not work, OTOH, <code>ilike</code> does not work in <code>SQLite</code>.</p>\n\n<p>If so then the solution is:</p>\n\n<p><strong>Solution 1</strong> You can change the development database to <code>PostgreSQL</code>, if you have worry about changing the database then follow the below</p>\n\n<p><strong>Solution 2</strong> You can use <code>lower(attr)</code> like </p>\n\n<pre><code>def self.job_title_search(q)\n    where('lower(title) LIKE lower(?)', \"%#{q}%\").select(:title, :label).distinct\nend\n</code></pre>\n\n<p>You can see the <a href=\"https://stackoverflow.com/a/11278943/4172515\">SO Answer</a> for this.</p>\n\n<p>Hope will help.</p>\n"}], "owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 50480444, "answer_count": 2, "score": 1, "last_activity_date": 1527053852, "creation_date": 1526987981, "last_edit_date": 1527053852, "question_id": 50466386, "link": "https://stackoverflow.com/questions/50466386/json-data-showing-in-development-properly-but-in-production-does-not-showing-pro", "title": "JSON data showing in development properly but in production does not showing properly", "body": "<p>This is my routes.rb</p>\n\n<pre><code>namespace :api do\n    get 'suggestions/jobs', to: \"suggestions#jobs\"\nend\n</code></pre>\n\n<p>My controller</p>\n\n<pre><code>class Api::SuggestionsController &lt; ApplicationController\n    def jobs\n        @jobs = Job.job_title_search(params[:q])   #.select(:title, :label).distinct\n        if @jobs.present?\n            render json: @jobs, status: :ok\n        else\n            render json: \"Not Found\", status: :ok\n        end\n    end\nend\n</code></pre>\n\n<p>and model</p>\n\n<pre><code>def self.job_title_search(q)\n    where('title LIKE ?', \"%#{q}%\").select(:title, :label).distinct\nend\n</code></pre>\n\n<p>in the development environment like <code>localhost:3000/api/suggestions/jobs?q=dev</code> the data sample is </p>\n\n<pre><code>[\n    {\"id\":null,\"title\":\"React Native Developer\",\"label\":\"Top label job\"},\n    {\"id\":null,\"title\":\"Android Developer\",\"label\":\"Top label job\"},\n    {\"id\":null,\"title\":\"Business Development Representative\",\"label\":\"Mid label job\"},\n    {\"id\":null,\"title\":\"Node.js Developer\",\"label\":\"Top label job\"}\n]\n</code></pre>\n\n<p>that means it's working, but while I pushed into the Heroku then like <code>example.herokuapp.com/api/suggestions/jobs?q=dev</code> it's showing </p>\n\n<blockquote>\n  <p>SyntaxError: JSON.parse: unexpected character at line 1 column 1 of the JSON data</p>\n</blockquote>\n\n<p>I know there is \"Not Found\" like the code is </p>\n\n<pre><code>render json: \"Not Found\", status: :ok\n</code></pre>\n\n<p>My question is why same code is not working on Heroku? and What can I do for this?</p>\n\n<p>the database.yml</p>\n\n<pre><code># SQLite version 3.x\n#   gem install sqlite3\n#\n#   Ensure the SQLite 3 gem is defined in your Gemfile\n#   gem 'sqlite3'\n#\ndefault: &amp;default\n  adapter: sqlite3\n  pool: &lt;%= ENV.fetch(\"RAILS_MAX_THREADS\") { 5 } %&gt;\n  timeout: 5000\n\ndevelopment:\n  &lt;&lt;: *default\n  database: db/development.sqlite3\n\n# Warning: The database defined as \"test\" will be erased and\n# re-generated from your development database when you run \"rake\".\n# Do not set this db to the same as development or production.\ntest:\n  &lt;&lt;: *default\n  database: db/test.sqlite3\n\nproduction:\n  &lt;&lt;: *default\n  database: my_project_production\n  username: my_project\n  password: &lt;%= ENV['MY_PROJECT_DATABASE_PASSWORD'] %&gt;\n</code></pre>\n\n<p>Any help appriciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "rspec", "dry"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1526987690, "post_id": 50466205, "comment_id": 87945637, "body": "Surround the whole <code>describe</code> with <code>%i[restaraunt supplier].each</code>?"}, {"owner": {"reputation": 13234, "user_id": 409792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9f1a530bb9d8cf91a889b4af5f80e9?s=128&d=identicon&r=PG", "display_name": "zwippie", "link": "https://stackoverflow.com/users/409792/zwippie"}, "edited": false, "score": 2, "creation_date": 1526987787, "post_id": 50466205, "comment_id": 87945705, "body": "Perhaps a use case for <a href=\"https://relishapp.com/rspec/rspec-core/v/3-7/docs/example-groups/shared-examples\" rel=\"nofollow noreferrer\">shared examples</a>?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 13234, "user_id": 409792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9f1a530bb9d8cf91a889b4af5f80e9?s=128&d=identicon&r=PG", "display_name": "zwippie", "link": "https://stackoverflow.com/users/409792/zwippie"}, "edited": false, "score": 0, "creation_date": 1526988061, "post_id": 50466205, "comment_id": 87945890, "body": "Your testing strategy looks backwards to be. As @zwippie suggests, it would make more sense to have something like <code>it_behaves_like &#39;tax number validations&#39;</code> in each model spec, rather than looping through each model in the validator spec. Your model specs should all be in one place, not spread across multiple files like that."}, {"owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526988952, "post_id": 50466205, "comment_id": 87946425, "body": "@TomLord Would it be possible though to test the validator in isolation, rather than repeating the same tests in all models that make use of it?"}, {"owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "reply_to_user": {"reputation": 13234, "user_id": 409792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9f1a530bb9d8cf91a889b4af5f80e9?s=128&d=identicon&r=PG", "display_name": "zwippie", "link": "https://stackoverflow.com/users/409792/zwippie"}, "edited": false, "score": 0, "creation_date": 1526989260, "post_id": 50466205, "comment_id": 87946623, "body": "@zwippie I was reading about the shared examples before but had no idea how to implement it in this case..."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1526993072, "post_id": 50466205, "comment_id": 87949147, "body": "If your tests don&#39;t need to touch the database -- and nothing in your post indicates that they do -- then they should run very fast; you&#39;re best off to just repeat a set of shared tests for each model."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1526993192, "post_id": 50466205, "comment_id": 87949234, "body": "<i>Could</i> you test the validator in isolation? Yes, but - for the reasons I keep repeating above - that wouldn&#39;t be the best idea. You could either just give it one &#39;arbitrary&#39; model to run tests on, or use a mock object. (But if you use a mock, you should really also be ensuring that all of your models satisfy your mock&#39;s interface!)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1527003255, "post_id": 50466205, "comment_id": 87956483, "body": "Additionally, and slightly off topic, if you will have more of these classes it might make more sense to store the tax numbers in a table of their own and use a polymorphic relationship. This will isolate the validation process while offering the ability to apply this functionality unilaterally to all objects that need a tax number. Also given the assumption that all tax numbers would most likely be unique a single source of truth makes this easier too."}], "owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1526987369, "creation_date": 1526987369, "question_id": 50466205, "link": "https://stackoverflow.com/questions/50466205/rails-testing-a-custom-validator-for-several-models", "title": "Rails: testing a custom validator for several models", "body": "<p>I have a custom validator to test my tax number of different organisation types. I was wondering if it's possible to test it with Rspec, passing different models to the tests, to keep things DRY.</p>\n\n<p>app/models/restaurant.rb</p>\n\n<pre><code>class Restaurant &lt; ApplicationRecord\n  validates :tax_number, uniqueness: true, presence: true\n  validates_with TaxNumberValidator\nend\n</code></pre>\n\n<p>app/models/supplier.rb</p>\n\n<pre><code>class Supplier &lt; ApplicationRecord\n  validates :tax_number, uniqueness: true, presence: true\n  validates_with TaxNumberValidator\nend\n</code></pre>\n\n<p>This is how my spec file looks now, but ideally instead of testing separately for each model, I would like to pass any instance with an attribute <code>:tax_number</code> to test if valid.</p>\n\n<pre><code>describe TaxNumberValidator do\n  with_model :restaurant do\n    table do |t|\n      t.string :tax_number\n    end\n\n    model do\n      validates :tax_number, tax_number: true\n    end\n  end\n\n  it 'should be valid with a valid tax number' do\n    expect(Fabricate(:restaurant)).to be_valid\n  end\n\n  it 'should be invalid without an tax number' do\n    expect(Fabricate.build :restaurant, tax_number: '').not_to be_valid\n  end\n\n  it 'should be invalid with an invalid tax number' do\n    expect(Fabricate.build :restaurant, tax_number: '111').not_to be_valid\n    expect(Fabricate.build :restaurant, tax_number: 'abc').not_to be_valid\n  end\nend\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "webpacker"], "comments": [{"owner": {"reputation": 2583, "user_id": 6269247, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/kapSj.jpg?s=128&g=1", "display_name": "rainer", "link": "https://stackoverflow.com/users/6269247/rainer"}, "edited": false, "score": 0, "creation_date": 1526987756, "post_id": 50465929, "comment_id": 87945687, "body": "Hi, I am reviewing your post. You should add code or images directly to your post, since web-addresses can change and it makes it easier for the SO community to reproduce your query. Please check here on how to ask good questions: <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9703984"}, "reply_to_user": {"reputation": 2583, "user_id": 6269247, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/kapSj.jpg?s=128&g=1", "display_name": "rainer", "link": "https://stackoverflow.com/users/6269247/rainer"}, "edited": false, "score": 0, "creation_date": 1526989472, "post_id": 50465929, "comment_id": 87946744, "body": "thx very much for corrected my post :)"}], "owner": {"user_type": "does_not_exist", "display_name": "user9703984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526989425, "creation_date": 1526986488, "last_edit_date": 1526989425, "question_id": 50465929, "link": "https://stackoverflow.com/questions/50465929/rails-webpackerbootstrap-popover-show-not-correct", "title": "rails webpacker+bootstrap popover show not correct", "body": "<pre><code>#html.slim\n= link_to 'Tasks', '#', data: {content: (\"And here's some amazing content. It's very engaging. Right?\"), placement: \"bottom\", toggle: \"popover\", trigger: \"click\", template: '&lt;div class=\"popover\" role=\"tooltip\"&gt;&lt;div class=\"arrow\"&gt;&lt;/div&gt;&lt;h3 class=\"popover-header\"&gt;Driver Compliance Management &lt;span class=\"badge badge-success\"&gt;Advanced&lt;/span&gt;&lt;/h3&gt;&lt;div class=popover-body&gt;&lt;p&gt;&lt;small&gt;Easily keep your drivers current and compliant&lt;/small&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Build a driver\u2019s DQ file without any extra work&lt;/li&gt;&lt;li&gt;Avoid expirations with automated notifications&lt;/li&gt;&lt;li&gt;Access records from any device&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div class=\"popover-footer\"&gt;&lt;button type=\"button\" class=\"btn btn-success btn-block \"&gt;Start Free Trial&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;' }\n</code></pre>\n\n<p>javascript:</p>\n\n<pre><code>$('[data-toggle=\"popover\"]').popover();\n</code></pre>\n\n<p>This code works correctly without the webpacker, but when I tried use it with webpack, it does not show correctly. </p>\n\n<p>With webpack I can only show \" And here's some amazing content. It's very engaging. Right?\" It's content, but i tried to delete this content, moved to js, nothing worked.</p>\n\n<p>Screenshot:\n<a href=\"https://drive.google.com/open?id=1Ul75ERpFJ6gQnQV43uEkyAR64yN_4WV9\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=1Ul75ERpFJ6gQnQV43uEkyAR64yN_4WV9</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "rake-task"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 9019159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080da344ace01293e4dc944184112f34?s=128&d=identicon&r=PG&f=1", "display_name": "Dr.Gonzo", "link": "https://stackoverflow.com/users/9019159/dr-gonzo"}, "edited": false, "score": 0, "creation_date": 1526987233, "post_id": 50466068, "comment_id": 87945360, "body": "I&#39;m going to accept this as the top answer thanks the rake task executed properly and the data updated accordingly in MySQL."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 87, "user_id": 9019159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080da344ace01293e4dc944184112f34?s=128&d=identicon&r=PG&f=1", "display_name": "Dr.Gonzo", "link": "https://stackoverflow.com/users/9019159/dr-gonzo"}, "edited": false, "score": 1, "creation_date": 1526987500, "post_id": 50466068, "comment_id": 87945531, "body": "@Llanod11 Glad to know hear, i updated answer if you want more information please check it :)"}], "tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": true, "score": 4, "last_activity_date": 1526987469, "last_edit_date": 1526987469, "creation_date": 1526986932, "answer_id": 50466068, "question_id": 50465754, "link": "https://stackoverflow.com/questions/50465754/updating-specific-attributes-on-models-in-rails-5/50466068#50466068", "title": "Updating specific attributes on models in Rails 5", "body": "<p>You can use update_column for updating single column it will not check for any validations and <strong>you need to only update investment if any record is found</strong></p>\n\n<pre><code>Saving.where(is_autobid: 1).each do |s|\n  investment = s.investments.find_by(is_autobid: 0)\n  investment.update_column(:is_autobid, 1) if investment\nend\n</code></pre>\n\n<blockquote>\n  <p>Update</p>\n</blockquote>\n\n<p>If you want to load all records at once, than you can do it with below query</p>\n\n<pre><code>investments = Investment.includes(:saving).where(\"savings.id = (select id from savings where savings.is_autobid = 0 limit 1)\").references(:saving)\n\ninvestments.each do |investment|\n  investment.update_column(:is_autobid, 1)\nend\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 9019159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080da344ace01293e4dc944184112f34?s=128&d=identicon&r=PG&f=1", "display_name": "Dr.Gonzo", "link": "https://stackoverflow.com/users/9019159/dr-gonzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 50466068, "answer_count": 1, "score": 1, "last_activity_date": 1526987469, "creation_date": 1526985929, "last_edit_date": 1526985977, "question_id": 50465754, "link": "https://stackoverflow.com/questions/50465754/updating-specific-attributes-on-models-in-rails-5", "title": "Updating specific attributes on models in Rails 5", "body": "<p>I very new to rails 5 and need a hand with some syntax..</p>\n\n<p>I have two models <code>Saving</code> and <code>Investment</code> .. Each Saving can have many Investments so the relation is 1:m. Both models have an boolean attribute <code>is_autobid</code>. </p>\n\n<p>I want to create a rake task that retrieves all Savings where <code>is_autobid = true</code> and then updates the first investments of a particular Saving record to true .. so far I have: </p>\n\n<pre><code>task :update_autobids =&gt; :environment do\n\n  Saving.where(is_autobid: 1).all.each do |s|\n\n    investment = s.investments.first(:is_autobid, 0)\n    investment.update(is_autobid = 1)\n  end\nend\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 1, "creation_date": 1526984980, "post_id": 50465432, "comment_id": 87944005, "body": "Hello, you need to post a more detailed question if you expect asnwers, for example, the code that is giving you the error."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526986266, "post_id": 50465432, "comment_id": 87944730, "body": "Doesn&#39;t even worth asking &quot;what is your question?&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5694703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2d6235d561e15b3ab8a66bdb95c230?s=128&d=identicon&r=PG&f=1", "display_name": "Gediyaj", "link": "https://stackoverflow.com/users/5694703/gediyaj"}, "edited": false, "score": 0, "creation_date": 1526990927, "post_id": 50466365, "comment_id": 87947604, "body": "Yes its works but now when i try to :"}, {"owner": {"reputation": 13, "user_id": 5694703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2d6235d561e15b3ab8a66bdb95c230?s=128&d=identicon&r=PG&f=1", "display_name": "Gediyaj", "link": "https://stackoverflow.com/users/5694703/gediyaj"}, "edited": false, "score": 0, "creation_date": 1526991122, "post_id": 50466365, "comment_id": 87947723, "body": "Ok Thanks its works but now when I try to type the following command: rails db:schema;dump that time getting this error:   rails aborted! Mysql2:Error: Authentication plugins &#39; caching_sha2_password&#39; cannot be loaded: the specified module could not be found bin/rails:4:in &#39;&lt;main&gt;&#39;"}], "tags": [], "owner": {"reputation": 528, "user_id": 6571468, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/ldBvQ.png?s=128&g=1", "display_name": "bilge", "link": "https://stackoverflow.com/users/6571468/bilge"}, "is_accepted": true, "score": 0, "last_activity_date": 1526987898, "creation_date": 1526987898, "answer_id": 50466365, "question_id": 50465432, "link": "https://stackoverflow.com/questions/50465432/issue-with-connecting-mysql-with-ruby-on-rails/50466365#50466365", "title": "issue with connecting mysql with ruby on rails", "body": "<p>Look at this: <a href=\"https://stackoverflow.com/questions/31111847/identified-by-password-in-mysql\">&quot;IDENTIFIED BY &#39;password&#39;&quot; in MySQL</a></p>\n\n<p>\"</p>\n\n<p>In summary, use <code>CREATE</code> to create a user, and use <code>GRANT</code> to add privileges:</p>\n\n<pre><code>CREATE USER 'username'@'localhost' IDENTIFIED BY 'password';\nGRANT ALL PRIVILEGES ON database.* TO 'username'@'localhost'; \n</code></pre>\n\n<p>\"</p>\n"}], "owner": {"reputation": 13, "user_id": 5694703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2d6235d561e15b3ab8a66bdb95c230?s=128&d=identicon&r=PG&f=1", "display_name": "Gediyaj", "link": "https://stackoverflow.com/users/5694703/gediyaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "closed_date": 1528195441, "accepted_answer_id": 50466365, "answer_count": 1, "score": -3, "last_activity_date": 1526987898, "creation_date": 1526984878, "last_edit_date": 1526986408, "question_id": 50465432, "link": "https://stackoverflow.com/questions/50465432/issue-with-connecting-mysql-with-ruby-on-rails", "closed_reason": "Needs details or clarity", "title": "issue with connecting mysql with ruby on rails", "body": "<p>When I try to connect database at the moment I got this an error:</p>\n\n<pre><code>GRANT ALL PRIVILEGES ON `simple_development`.* TO 'rails_user'@'localhost'  IDENTIFIED BY 'PASSWORD';\n</code></pre>\n\n<blockquote>\n  <p>ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right\n   syntax to use near IDENTIFIED BY \"Password\" at line 1</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "scope", "activesupport-concern"], "answers": [{"comments": [{"owner": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "edited": false, "score": 0, "creation_date": 1526976841, "post_id": 50462841, "comment_id": 87938669, "body": "Ok, so what is the difference between <code>scope :default_scope, -&gt; { where(deleted_at: nil) }</code> and <code>default_scope { where(deleted_at: nil) }</code>? The first is defining a new scope the second is overriding existing one?"}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "reply_to_user": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "edited": false, "score": 0, "creation_date": 1526977107, "post_id": 50462841, "comment_id": 87938819, "body": "added some more details"}], "tags": [], "owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "is_accepted": true, "score": 3, "last_activity_date": 1526976846, "last_edit_date": 1526976846, "creation_date": 1526976746, "answer_id": 50462841, "question_id": 50462683, "link": "https://stackoverflow.com/questions/50462683/redefining-default-scope-in-concern-in-rails/50462841#50462841", "title": "Redefining default_scope in concern (in Rails)", "body": "<p>The issue isn't really related to defining the scope as part of a concern. You'd see the same error if trying to define a scope called <code>default_scope</code> from within the model itself.</p>\n\n<p>To set the default scope use <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Scoping/Default/ClassMethods.html#method-i-default_scope\" rel=\"nofollow noreferrer\"><code>default_scope</code></a>:</p>\n\n<pre><code>default_scope { where(deleted_at: nil) }\n</code></pre>\n\n<p><code>scope</code> is for creating a named scope of your own, for example:</p>\n\n<pre><code>scope :non_deleted, -&gt; { where(deleted_at: nil) }\n</code></pre>\n\n<p>would allow you to write</p>\n\n<pre><code>`Model.non_deleted.where....`\n</code></pre>\n\n<p>so the code in your question is trying to create a scope called <code>default_scope</code>, but as the error message suggests that scope <code>Model.default_scope...</code> would then conflict with the existing <code>default_scope</code> method that is used to <em>set</em> the default scope.</p>\n"}], "owner": {"reputation": 1461, "user_id": 58049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a96600452ce423bd250a7c0df8e2b6ae?s=128&d=identicon&r=PG", "display_name": "o..o", "link": "https://stackoverflow.com/users/58049/o-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 50462841, "answer_count": 1, "score": 3, "last_activity_date": 1526976846, "creation_date": 1526976209, "question_id": 50462683, "link": "https://stackoverflow.com/questions/50462683/redefining-default-scope-in-concern-in-rails", "title": "Redefining default_scope in concern (in Rails)", "body": "<p>I'd like to redefine <code>default_scope</code> in model concern, but I'm getting this:</p>\n\n<p><code>You tried to define a scope named \"default_scope\" on the model \"Product\", but Active Record already defined a class method with the same name.</code></p>\n\n<pre><code>module SoftDeletable\n  extend ActiveSupport::Concern\n\n  included do\n    scope :default_scope, -&gt; { where(deleted_at: nil) }\n  end\nend\n</code></pre>\n\n<p>Yes, I know there are gems for this, but the question is not about that.<br>\nDo you have an idea how can I set the <code>default_scope</code> in concern?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "mongoid", "rspec-rails"], "answers": [{"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1526984285, "creation_date": 1526984285, "answer_id": 50465221, "question_id": 50462474, "link": "https://stackoverflow.com/questions/50462474/model-embeds-many-and-embedded-in-relationship-using-factorygirls/50465221#50465221", "title": "Model embeds_many and embedded_in relationship using factorygirls", "body": "<p>You have the association class name wrong:</p>\n\n<pre><code>module Company\n  class Contact\n    include Mongoid::Document\n    include ActiveModel::Validations\n\n    embedded_in :company, class_name: 'Company::Company'\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1459, "user_id": 5075036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34c56488ab9cdbb6a3c159ef36a8c76?s=128&d=identicon&r=PG", "display_name": "Harshit Garg", "link": "https://stackoverflow.com/users/5075036/harshit-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526984426, "creation_date": 1526975489, "last_edit_date": 1526984426, "question_id": 50462474, "link": "https://stackoverflow.com/questions/50462474/model-embeds-many-and-embedded-in-relationship-using-factorygirls", "title": "Model embeds_many and embedded_in relationship using factorygirls", "body": "<p>I want to write FactoryGirl class for creating company. The models are as follows:</p>\n\n<pre><code>module Company\n  class Contact\n    include Mongoid::Document\n    include ActiveModel::Validations\n\n    embedded_in :company, class_name: \"::Company::Contact\"\n\n  end\nend\n\nmodule Company\n  class Company\n\n    require 'autoinc'\n\n    embeds_many :contacts, class_name: \"::Company::Contact\"\n\n  end\nend\n\n\nFactoryGirl.define do\n  factory :company, :class =&gt; 'Company::Company' do\n    name { Faker::Company.name }\n\n    after(:create) do |company|\n      # company.contacts &lt;&lt; create(:company_contact)\n      create_list(:company_contact, 1, company: company)\n    end\n    # contacts { [ build(:company_contact) ] }\n  end\nend\n</code></pre>\n\n<p>The error received is</p>\n\n<p>Failure/Error: create_list(:company_contact, 1, company: company)</p>\n\n<pre><code> Mongoid::Errors::InvalidPath:\n\n   message:\n     Having a root path assigned for Company::Contact is invalid.\n   summary:\n     Mongoid has two different path objects for determining the location of a document in the database, Root and Embedded. This error is raised when an embedded document somehow gets a root path assigned.\n   resolution:\n     Most likely your embedded model, Company::Contact is also referenced via a has_many from a root document in another collection. Double check the relation definitions and fix any instances where embedded documents are improperly referenced from other collections\n</code></pre>\n\n<p>How should I handle this? I cannot change the models. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 23594, "user_id": 336626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/608b32640d0fca097b40bc6a28cadc5f?s=128&d=identicon&r=PG", "display_name": "Vasiliy Ermolovich", "link": "https://stackoverflow.com/users/336626/vasiliy-ermolovich"}, "edited": false, "score": 0, "creation_date": 1526974969, "post_id": 50462256, "comment_id": 87937623, "body": "looks like you need to specify database adapter in <code>production</code> section in your database.yml as you have it in <code>development</code> section. So try to add <code>adapter: sqlite3</code> if you&#39;re using sqlite3"}, {"owner": {"reputation": 535, "user_id": 3134957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qutnS.jpg?s=128&g=1", "display_name": "Anurag Aryan", "link": "https://stackoverflow.com/users/3134957/anurag-aryan"}, "edited": false, "score": 0, "creation_date": 1526975060, "post_id": 50462256, "comment_id": 87937665, "body": "You&#39;re missing <code>adapter: postgresql</code> in default."}, {"owner": {"reputation": 175, "user_id": 7336686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c01414e7eec3b6630015dcaf052d1b78?s=128&d=identicon&r=PG&f=1", "display_name": "naughie", "link": "https://stackoverflow.com/users/7336686/naughie"}, "edited": false, "score": 0, "creation_date": 1526976173, "post_id": 50462256, "comment_id": 87938301, "body": "I added <code>adapter: postgresql</code> but get the error <code>Gem::LoadError: Specified &#39;postgresql&#39; for database adapter, but the gem is not loaded. Add </code>gem &#39;pg&#39;` to your Gemfile (and ensure its version is at the minimum required by ActiveRecord).` I got the same error when adding <code>adapter: sqlite3</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "edited": false, "score": 0, "creation_date": 1526982555, "post_id": 50464529, "comment_id": 87942426, "body": "For gem not loading error try adding gem &#39;pg&#39;, &#39;~&gt; 0.20&#39; to the gemfile"}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 1, "creation_date": 1526990023, "post_id": 50464529, "comment_id": 87947074, "body": "I <i><b>strongly</b></i> recommend switching to Postgres locally. Running different database systems in development and production is asking for trouble..."}], "tags": [], "owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1526982197, "creation_date": 1526982197, "answer_id": 50464529, "question_id": 50462256, "link": "https://stackoverflow.com/questions/50462256/could-not-precompile-assets-locally/50464529#50464529", "title": "Could not precompile assets locally", "body": "<p>As per the specifications shared it seems like you have missed the adapter settings from production settings in database.yml</p>\n\n<pre><code> default: &amp;default\n  pool: &lt;%= ENV.fetch(\"RAILS_MAX_THREADS\") { 5 } %&gt;\n  # adapter: sqlite3 #preferred to use the adapter settings here\n  timeout: 5000\n\n development:\n   &lt;&lt;: *default\n   adapter: sqlite3\n   database: db/development.sqlite3\n\n test:\n  &lt;&lt;: *default\n  adapter: sqlite3\n  database: db/test.sqlite3\n\n production:\n  &lt;&lt;: *default\n  adapter: postgresql\n  url: &lt;%= ENV['DATABASE_URL'] %&gt;\n</code></pre>\n\n<p>Otherwise it is preferable to specify adapter settings in default configuration when using same database across multiple environments.</p>\n"}], "owner": {"reputation": 175, "user_id": 7336686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c01414e7eec3b6630015dcaf052d1b78?s=128&d=identicon&r=PG&f=1", "display_name": "naughie", "link": "https://stackoverflow.com/users/7336686/naughie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526982197, "creation_date": 1526974715, "question_id": 50462256, "link": "https://stackoverflow.com/questions/50462256/could-not-precompile-assets-locally", "title": "Could not precompile assets locally", "body": "<p>I use Heroku to run my Ruby on Rails app, and I want to precompile assets.</p>\n\n<p>In my <code>Gemfile</code>:</p>\n\n<pre><code>group :development, :test do\n  gem 'sqlite3'\nend\n\ngroup :production do\n  gem 'pg'\nend\n</code></pre>\n\n<p>and <code>config/database.yml</code>:</p>\n\n<pre><code>default: &amp;default\n  pool: &lt;%= ENV.fetch(\"RAILS_MAX_THREADS\") { 5 } %&gt;\n  timeout: 5000\n\ndevelopment:\n  &lt;&lt;: *default\n  adapter: sqlite3\n  database: db/development.sqlite3\n\ntest:\n  &lt;&lt;: *default\n  adapter: sqlite3\n  database: db/test.sqlite3\n\nproduction:\n  &lt;&lt;: *default\n  url: &lt;%= ENV['DATABASE_URL'] %&gt;\n</code></pre>\n\n<p><code>config/application.rb</code> and <code>config/environments/production.rb</code>:</p>\n\n<pre><code># config/application.rb\nconfig.serve_static_files = true\nconfig.assets.initialize_on_precompile = false\n\n# config/environments/production.rb\nconfig.assets.js_compressor = :uglifier\nconfig.assets.css_compressor = :scss\nconfig.assets.compile = true\nconfig.assets.digest = true\n</code></pre>\n\n<p>Then, I did the following commands and got errors:</p>\n\n<pre><code>$ export DATABASE_URL=$(heroku config:get DATABASE_URL)\n$ RAILS_ENV=production bundle exec rake assets:precompile\nrake aborted!\nActiveRecord::AdapterNotSpecified: database configuration does not specify adapter\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/connection_specification.rb:182:in `spec'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:880:in `establish_connection'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/connection_handling.rb:58:in `establish_connection'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/railtie.rb:124:in `block (2 levels) in &lt;class:Railtie&gt;'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:69:in `instance_eval'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:69:in `block in execute_hook'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:60:in `with_execution_control'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:65:in `execute_hook'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:50:in `block in run_load_hooks'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:49:in `each'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/lazy_load_hooks.rb:49:in `run_load_hooks'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/base.rb:326:in `&lt;module:ActiveRecord&gt;'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activerecord-5.1.6/lib/active_record/base.rb:25:in `&lt;top (required)&gt;'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `block in require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:258:in `load_dependency'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n/Users/nakatam/develop/naughie/app/models/application_record.rb:1:in `&lt;top (required)&gt;'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `block in require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:258:in `load_dependency'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:379:in `block in require_or_load'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:36:in `block in load_interlock'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies/interlock.rb:12:in `block in loading'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/concurrency/share_lock.rb:149:in `exclusive'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies/interlock.rb:11:in `loading'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:36:in `load_interlock'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:357:in `require_or_load'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:511:in `load_missing_constant'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:202:in `const_missing'\n/Users/nakatam/develop/naughie/app/models/user.rb:1:in `&lt;top (required)&gt;'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `block in require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:258:in `load_dependency'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:379:in `block in require_or_load'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:36:in `block in load_interlock'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies/interlock.rb:12:in `block in loading'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/concurrency/share_lock.rb:149:in `exclusive'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies/interlock.rb:11:in `loading'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:36:in `load_interlock'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:357:in `require_or_load'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:511:in `load_missing_constant'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:202:in `const_missing'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/inflector/methods.rb:269:in `const_get'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/inflector/methods.rb:269:in `block in constantize'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/inflector/methods.rb:267:in `each'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/inflector/methods.rb:267:in `inject'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/inflector/methods.rb:267:in `constantize'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:583:in `get'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:614:in `constantize'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise.rb:316:in `get'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/mapping.rb:83:in `to'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/mapping.rb:78:in `modules'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/mapping.rb:95:in `routes'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/mapping.rb:162:in `default_used_route'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/mapping.rb:72:in `initialize'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise.rb:346:in `new'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise.rb:346:in `add_mapping'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/rails/routes.rb:243:in `block in devise_for'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/rails/routes.rb:242:in `each'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/devise-4.4.3/lib/devise/rails/routes.rb:242:in `devise_for'\n/Users/nakatam/develop/naughie/config/routes.rb:2:in `block in &lt;top (required)&gt;'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.6/lib/action_dispatch/routing/route_set.rb:436:in `instance_exec'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.6/lib/action_dispatch/routing/route_set.rb:436:in `eval_block'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.6/lib/action_dispatch/routing/route_set.rb:418:in `draw'\n/Users/nakatam/develop/naughie/config/routes.rb:1:in `&lt;top (required)&gt;'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:286:in `load'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:286:in `block in load'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:258:in `load_dependency'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:286:in `load'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:55:in `block in load_paths'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:55:in `each'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:55:in `load_paths'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:18:in `reload!'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:41:in `block in updater'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/file_update_checker.rb:81:in `execute'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:42:in `updater'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/routes_reloader.rb:31:in `execute_if_updated'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application/finisher.rb:128:in `block in &lt;module:Finisher&gt;'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/initializable.rb:30:in `instance_exec'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/initializable.rb:30:in `run'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/initializable.rb:59:in `block in run_initializers'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/initializable.rb:58:in `run_initializers'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application.rb:353:in `initialize!'\n/Users/nakatam/develop/naughie/config/environment.rb:5:in `&lt;top (required)&gt;'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `block in require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:258:in `load_dependency'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:292:in `require'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application.rb:329:in `require_environment!'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/railties-5.1.6/lib/rails/application.rb:445:in `block in run_tasks_blocks'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/sprockets-rails-3.2.1/lib/sprockets/rails/task.rb:62:in `block (2 levels) in define'\n/Users/nakatam/develop/naughie/vendor/bundle/ruby/2.5.0/gems/rake-12.3.1/exe/rake:27:in `&lt;top (required)&gt;'\n/Users/nakatam/.rbenv/versions/2.5.0/bin/bundle:23:in `load'\n/Users/nakatam/.rbenv/versions/2.5.0/bin/bundle:23:in `&lt;main&gt;'\nTasks: TOP =&gt; environment\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>Next, I tried to install <code>pg</code> gem locally (macOS), but it failed.</p>\n\n<p>Why such errors occured? And what should I do to precompile assets?</p>\n"}, {"tags": ["ruby", "xcode", "rubygems", "build-error", "run-script"], "answers": [{"tags": [], "owner": {"reputation": 2185, "user_id": 2811053, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/854bc24214e445d3c3cd2b96bab3569b?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/2811053/ankush"}, "is_accepted": false, "score": 0, "last_activity_date": 1526984102, "creation_date": 1526984102, "answer_id": 50465165, "question_id": 50462206, "link": "https://stackoverflow.com/questions/50462206/xcode-ruby-runscript-can-not-find-gem/50465165#50465165", "title": "Xcode ruby runscript can not find gem", "body": "<p>Okay I found the bug in my code.</p>\n\n<p>There were two ruby versions one for the system i.e <code>/System/Library/Frameworks/Ruby.framework/Versions/2.3</code> (this is for the root system, which comes with macOS) and other was <code>/usr/local/Cellar/ruby/2.5.1/lib/ruby</code> (Not sure what is this for, My guess is that it is separate ruby environment for new version 2.5.1, I might have installed it in past)</p>\n\n<p>In my runscript's shell, I had <code>/usr/bin/ruby</code> which has ruby executable file for system's ruby <code>/System/Library/Frameworks/Ruby.framework</code></p>\n\n<p>I checked the ruby environment by command <code>gem environment</code>, And it gave the output </p>\n\n<pre><code>RubyGems Environment:\n  - RUBYGEMS VERSION: 2.7.6\n  - RUBY VERSION: 2.5.1 (2018-03-29 patchlevel 57) [x86_64-darwin17]\n  - INSTALLATION DIRECTORY: /usr/local/lib/ruby/gems/2.5.0\n  - USER INSTALLATION DIRECTORY: /Users/xxx/.gem/ruby/2.5.0\n  - RUBY EXECUTABLE: /usr/local/opt/ruby/bin/ruby\n  - EXECUTABLE DIRECTORY: /usr/local/bin\n  - SPEC CACHE DIRECTORY: /Users/xxx/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /usr/local/Cellar/ruby/2.5.1/etc\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-17\n</code></pre>\n\n<p>Here <code>EXECUTABLE DIRECTORY: /usr/local/bin</code> and I had a different path for my ruby executable which I specified in my runscript's shell <code>(/usr/bin/ruby)</code> so I changed <code>/usr/bin/ruby</code> to <code>/usr/local/bin/ruby</code> and it is working. </p>\n\n<p>As my gem was being installed in updated version of ruby(2.5) <code>/usr/local/Cellar/ruby/2.5.1/lib/ruby</code> instead of old system's ruby (2.3)<code>/System/Library/Frameworks/Ruby.framework</code> so now as I provided the executable ruby path of the latest ruby version, in which gem was installed, it is working fine.  </p>\n"}], "owner": {"reputation": 2185, "user_id": 2811053, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/854bc24214e445d3c3cd2b96bab3569b?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/2811053/ankush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1266, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526984102, "creation_date": 1526974553, "question_id": 50462206, "link": "https://stackoverflow.com/questions/50462206/xcode-ruby-runscript-can-not-find-gem", "title": "Xcode ruby runscript can not find gem", "body": "<p>Xcode: 9.3.1</p>\n\n<p>OS: macOS High Sierra 10.13.4</p>\n\n<p>I am and iOS developer and I am not familiar with ruby at all. </p>\n\n<p>I am using a run-script in my Xcode project which uses a ruby gem called '<code>xcodeproj</code>'. Before everything was working, But I updated my macOS and now this runscript is not able to find gem 'xcodeproj'</p>\n\n<p>When I try to build my project it shows following error </p>\n\n<pre><code>/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- xcodeproj (LoadError)\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require' \n</code></pre>\n\n<p>I went to the path which is shown in the above error, and there was no <code>xcodeproj</code> gem files, even after that I installed <code>gem install xcodeproj</code> it is being installed somewhere else. This is the output on my terminal</p>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code>xxx-MacBook-Pro:~ user$ gem list\n\n*** LOCAL GEMS ***\n\natomos (0.1.2)\nbigdecimal (default: 1.3.4)\nbundler (default: 1.16.1)\nCFPropertyList (3.0.0)\nclaide (1.0.2)\ncmath (default: 1.0.0)\ncolored2 (3.1.2)\ncsv (default: 1.0.0)\ndate (default: 1.0.0)\ndbm (default: 1.0.0)\netc (default: 1.0.0)\nfcntl (default: 1.0.0)\nfiddle (default: 1.0.0)\nfileutils (default: 1.0.2)\nio-console (default: 0.4.6)\nipaddr (default: 1.2.0)\njson (default: 2.1.0)\nnanaimo (0.2.5)\nopenssl (default: 2.1.0)\npsych (default: 3.0.2)\nrdoc (default: 6.0.1)\nscanf (default: 1.0.0)\nsdbm (default: 1.0.0)\nstringio (default: 0.0.1)\nstrscan (default: 1.0.0)\nwebrick (default: 1.4.2)\nxcodeproj (1.5.9)\nzlib (default: 1.0.0)\n</code></pre>\n\n<p>Moreover, when I try to execute my ruby runscript via terminal it shows no error (And via xcode it fails).</p>\n\n<p>Apparently, gem <code>xcodeproj</code> has been installed in my macOS but it is not under Ruby.framwork and I think that's why my xcode's runscript is failing at build time. Hese is my runscript  <a href=\"https://i.stack.imgur.com/LiQmq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LiQmq.png\" alt=\"enter image description here\"></a></p>\n\n<p>The screenshot of error in Xcode <a href=\"https://i.stack.imgur.com/yCrom.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yCrom.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any help is highly appreciated, guys :) </p>\n"}, {"tags": ["ruby", "hash"], "answers": [{"comments": [{"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 2, "creation_date": 1526975530, "post_id": 50461781, "comment_id": 87937930, "body": "If there is at most 1 result for a given <code>user_id</code> then you should replace <code>select</code> with <code>find</code>. This will return the first hash that matches instead of an array, and avoids searching the rest of the array once a match is found."}], "tags": [], "owner": {"reputation": 151, "user_id": 8544663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d5bd127ee648e485f57eebb637198e1?s=128&d=identicon&r=PG", "display_name": "Kumar Abhinav", "link": "https://stackoverflow.com/users/8544663/kumar-abhinav"}, "is_accepted": true, "score": 4, "last_activity_date": 1526973068, "creation_date": 1526973068, "answer_id": 50461781, "question_id": 50461652, "link": "https://stackoverflow.com/questions/50461652/display-contents-of-a-hash-if-value-exists/50461781#50461781", "title": "Display contents of a hash if value exists", "body": "<pre><code>req[\"results\"].select{|x| x[\"user_id\"] == 152528025}\n</code></pre>\n"}], "owner": {"reputation": 182, "user_id": 6848493, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b004235b4697691e9bc3aab04c58baa7?s=128&d=identicon&r=PG", "display_name": "Maayan Naveh", "link": "https://stackoverflow.com/users/6848493/maayan-naveh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 50461781, "answer_count": 1, "score": 1, "last_activity_date": 1526974879, "creation_date": 1526972581, "last_edit_date": 1526974879, "question_id": 50461652, "link": "https://stackoverflow.com/questions/50461652/display-contents-of-a-hash-if-value-exists", "title": "Display contents of a hash if value exists", "body": "<p>I have a hash:</p>\n\n<pre><code>req = {\n  \"count\" =&gt; 50100,\n  \"results\" =&gt; [\n    {\"listing_id\" =&gt; 615929315, \"state\" =&gt; \"active\", \"user_id\" =&gt; 140604756, \"category_id\" =&gt; 69150367}, \n    {\"listing_id\" =&gt; 615929311, \"state\" =&gt; \"active\", \"user_id\" =&gt; 152528025, \"category_id\" =&gt; 69150367}\n  ]\n}\n</code></pre>\n\n<p>I want to find and display the entire internal hash if a particular <code>user_id</code> exists. I can find it:</p>\n\n<pre><code>req[\"results\"][0].select{|key, value| value == 152528025}\n# =&gt; {\"user_id\" =&gt; 152528025}\n</code></pre>\n\n<p>How do I then display this entire (nested) hash?</p>\n\n<pre><code>{\"listing_id\" =&gt; 615929311, \"state\" =&gt; \"active\", \"user_id\" =&gt; 152528025, \"category_id\" =&gt; 69150367}\n</code></pre>\n"}, {"tags": ["ruby", "if-statement"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1526970763, "post_id": 50461198, "comment_id": 87935433, "body": "What error message are you getting?"}, {"owner": {"reputation": 179, "user_id": 8201398, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357899441/picture?type=large", "display_name": "Vitaliy Tretyakov", "link": "https://stackoverflow.com/users/8201398/vitaliy-tretyakov"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1526971045, "post_id": 50461198, "comment_id": 87935581, "body": "There is not error message. Program just counts left and right sums and shows them, but the strings  &lt;br/&gt;   if right_sum - arr[i] == left_sum + arr[i-1]     puts &quot;Left sum&quot; + &quot;=&quot; + &quot;Right sum&quot;     counter.push(i)   end  &lt;br/&gt; do not work."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1526971633, "creation_date": 1526971633, "answer_id": 50461419, "question_id": 50461198, "link": "https://stackoverflow.com/questions/50461198/if-statement-doesnt-work-in-for-loop/50461419#50461419", "title": "&#39;if&#39; statement doesn&#39;t work in &#39;for&#39; loop", "body": "<p><em>Sidenote:</em> <code>for</code> loops are counter-idiomatic in ruby (read: nobody uses <code>for</code> loops in ruby.)</p>\n\n<p>The problem with your code is in the last comparison. You already have sums calculated, hence you shouldn\u2019t alter them:</p>\n\n<pre><code># if right_sum - arr[i] == left_sum + arr[i-1]\nif right_sum == left_sum\n  puts \"Left sum\" + \"=\" + \"Right sum\"\n  counter.push(i)\nend\n</code></pre>\n\n<p>Also, I strongly suggest to rewrite this solution using <a href=\"https://ruby-doc.org/core/Array.html#method-c-5B-5D\" rel=\"nofollow noreferrer\"><code>Array#[]</code></a> and <a href=\"https://ruby-doc.org/core/Array.html#method-i-sum\" rel=\"nofollow noreferrer\"><code>Array#sum</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9827776, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CfJkrJbKzD4/AAAAAAAAAAI/AAAAAAAAAAA/3pMLCTsR7yk/photo.jpg?sz=128", "display_name": "juanmont", "link": "https://stackoverflow.com/users/9827776/juanmont"}, "is_accepted": false, "score": 1, "last_activity_date": 1526985003, "creation_date": 1526985003, "answer_id": 50465465, "question_id": 50461198, "link": "https://stackoverflow.com/questions/50461198/if-statement-doesnt-work-in-for-loop/50465465#50465465", "title": "&#39;if&#39; statement doesn&#39;t work in &#39;for&#39; loop", "body": "<p>In ruby is not a good idea to use <code>for</code>, you can use <code>each</code> for loops in Ruby.</p>\n\n<pre><code>arr.each { |i|\n   ...\n}\n</code></pre>\n\n<p>Also you need to have already calculated the sum before ask if are equals.</p>\n\n<pre><code>right_aux = right_sum - arr[i]\nleft_aux = left_sum + arr[i-1]\nif right_aux == left_aux\n  puts \"Left sum\" + \"=\" + \"Right sum\"\n  counter.push(i)\nend \n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 8201398, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357899441/picture?type=large", "display_name": "Vitaliy Tretyakov", "link": "https://stackoverflow.com/users/8201398/vitaliy-tretyakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1526985003, "creation_date": 1526970695, "last_edit_date": 1526972076, "question_id": 50461198, "link": "https://stackoverflow.com/questions/50461198/if-statement-doesnt-work-in-for-loop", "title": "&#39;if&#39; statement doesn&#39;t work in &#39;for&#39; loop", "body": "<p>I need to find whether an array of integers contains one or more elements that divides the array into two parts such that the sum of the elements in the left and the right parts are equal.</p>\n\n<p>I tried this:</p>\n\n<pre><code>arr = [1,2,3,4,3,2,1]\n\nleft_sum = 0\nright_sum = arr.inject(0) { |sum, x| sum = sum + x } \n\nfor i in 0..arr.length-1\n  counter = []\n  right_sum = right_sum - arr[i]\n\n  case i\n    when 0\n    left_sum = 0          \n  else\n    left_sum = left_sum + arr[i-1]\n  end\n\n  puts \"Left sum of element #\" + i.to_s + \"=\" + left_sum.to_s\n  puts \"Right sum of element #\" + i.to_s + \"=\" + right_sum.to_s\n  puts \" \"\n\n  if right_sum - arr[i] == left_sum + arr[i-1]\n    puts \"Left sum\" + \"=\" + \"Right sum\"\n    counter.push(i)\n  end\n\n  puts counter.to_s\n\nend\n</code></pre>\n\n<p>I encountered an error. I do not understand why the <code>if</code>-statement doesn't work in the <code>for</code>-loop. What did I do wrong?</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1526970907, "post_id": 50461131, "comment_id": 87935514, "body": "key <code>:and</code> is duplicated and will be overwritten."}, {"owner": {"reputation": 55, "user_id": 8637293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b1358e569a8aa1226e0d8173dde645?s=128&d=identicon&r=PG", "display_name": "Jackson Gong", "link": "https://stackoverflow.com/users/8637293/jackson-gong"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1526971192, "post_id": 50461131, "comment_id": 87935642, "body": "You are right.. so I&#39;ll have to make and: point to an array instead I guess. Zooming out, is this even the correct idea to process search string?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1526973758, "post_id": 50461131, "comment_id": 87936972, "body": "Do you need an ad-hoc solution or a correct one? The latter would involve building a grammar parser. The former might be done with plain old good regexps."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526975440, "post_id": 50461131, "comment_id": 87937879, "body": "Your issue has nothing to do with Boolean. You just have conjunction, disjunction, and negation, but you are not doing any Boolean algebra."}, {"owner": {"reputation": 55, "user_id": 8637293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b1358e569a8aa1226e0d8173dde645?s=128&d=identicon&r=PG", "display_name": "Jackson Gong", "link": "https://stackoverflow.com/users/8637293/jackson-gong"}, "edited": false, "score": 0, "creation_date": 1526976405, "post_id": 50461131, "comment_id": 87938429, "body": "Hi sawa, in theory the logic could get more complex, such as <code>(a or d) not (b or c)</code> - is this what you mean by Boolean algebra? If there is any existing methods/module to process this that&#39;ll be great. I write the string in a simple way coz I myself can only realistically handle the easy use cases."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 8637293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b1358e569a8aa1226e0d8173dde645?s=128&d=identicon&r=PG", "display_name": "Jackson Gong", "link": "https://stackoverflow.com/users/8637293/jackson-gong"}, "edited": false, "score": 1, "creation_date": 1526975260, "post_id": 50462109, "comment_id": 87937777, "body": "This is a great idea! a couple of minor points: a. prepend! is not a valid method - I need to use unshift instead (maybe I&#39;m using an older version of ruby?); b. each_slice(2).to_a seems to be easier to break up the array; c. as Sagar pointed out, if there are multiple or/not/and, some keyword will be overwritten. Still, your way is better than what I&#39;m working with. I just need to work on the downstream processing a bit. Thank you!"}], "tags": [], "owner": {"reputation": 4450, "user_id": 837638, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/32d80da41830a6e6c1bb3eb977537e3e?s=128&d=identicon&r=PG", "display_name": "coorasse", "link": "https://stackoverflow.com/users/837638/coorasse"}, "is_accepted": false, "score": 1, "last_activity_date": 1527066741, "last_edit_date": 1527066741, "creation_date": 1526974162, "answer_id": 50462109, "question_id": 50461131, "link": "https://stackoverflow.com/questions/50461131/process-search-keywords-with-logical-options/50462109#50462109", "title": "Process search keywords with logical options", "body": "<pre><code>splitted = \"hello and world or jump not read\".split(/( and | or | not )/)\n# =&gt; [\"hello\", \" and \", \"world\", \" or \", \"jump\", \" not \", \"read\"]\n\nsplitted = splitted.unshift('and') unless splitted[0] == 'and'\n# =&gt; [\"and\". \"hello\", \" and \", \"world\", \" or \", \"jump\", \" not \", \"read\"]\n\nsplitted.each_slice(2).to_h\n# =&gt; {\"and\"=&gt;\"hello\", \" and \"=&gt;\"world\", \" or \"=&gt;\"jump\", \" not \"=&gt;\"read\"}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8637293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b1358e569a8aa1226e0d8173dde645?s=128&d=identicon&r=PG", "display_name": "Jackson Gong", "link": "https://stackoverflow.com/users/8637293/jackson-gong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1527066741, "creation_date": 1526970437, "last_edit_date": 1526975270, "question_id": 50461131, "link": "https://stackoverflow.com/questions/50461131/process-search-keywords-with-logical-options", "title": "Process search keywords with logical options", "body": "<p>I want to processes a string of search keywords with options <code>\"and\"</code>, <code>\"or\"</code>, and <code>\"not\"</code>, such as <code>\"gis and gjs not gkp\"</code> in order to perform search with each keyword, and record the search logic.</p>\n\n<p>To do so, I need to break up the search string by <code>\"and\"</code>, <code>\"or\"</code>, and <code>\"not\"</code>, and remember which divider was used at each point. I want to transform it to maybe a hash: <code>{and: 'gis', and: 'gjs', not: 'gkp'}</code>.</p>\n\n<p>What's the best way to do this? Or is there a better way to process such a search string?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "encryption", "rubygems"], "comments": [{"owner": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 0, "creation_date": 1526969551, "post_id": 50460891, "comment_id": 87934906, "body": "Don&#39;t ever commit secrets into your source control, encrypted or not."}, {"owner": {"reputation": 11, "user_id": 4486254, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kyl7LDIr6FY/AAAAAAAAAAI/AAAAAAAAAak/jtB0LhiEwgc/photo.jpg?sz=128", "display_name": "Sukanth K", "link": "https://stackoverflow.com/users/4486254/sukanth-k"}, "reply_to_user": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 0, "creation_date": 1526969897, "post_id": 50460891, "comment_id": 87935066, "body": "Please tell how to decrypt the db name to use in the application"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1526970046, "post_id": 50460891, "comment_id": 87935130, "body": "What\u2019s wrong with using <code>SecureYaml::load(File.open(&#39;database.yml&#39;))</code> as specified in the documentation you\u2019ve linked?"}, {"owner": {"reputation": 11, "user_id": 4486254, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kyl7LDIr6FY/AAAAAAAAAAI/AAAAAAAAAak/jtB0LhiEwgc/photo.jpg?sz=128", "display_name": "Sukanth K", "link": "https://stackoverflow.com/users/4486254/sukanth-k"}, "edited": false, "score": 0, "creation_date": 1526970202, "post_id": 50460891, "comment_id": 87935188, "body": "Where should I use that? In which file?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1526970301, "post_id": 50460891, "comment_id": 87935236, "body": "I believe where you establish a connection to the database."}, {"owner": {"reputation": 11, "user_id": 4486254, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kyl7LDIr6FY/AAAAAAAAAAI/AAAAAAAAAak/jtB0LhiEwgc/photo.jpg?sz=128", "display_name": "Sukanth K", "link": "https://stackoverflow.com/users/4486254/sukanth-k"}, "edited": false, "score": 0, "creation_date": 1526971879, "post_id": 50460891, "comment_id": 87935984, "body": "I put these 2 lines in application.rb.   require &#39;secure_yaml&#39; decrypted_yaml = SecureYaml::load(File.open(&#39;config/database.yml&#39;))  But got an error like this: `retrieve_secret_key&#39;: PROPERTIES_ENCRYPTION_PASSWORD env property not found (RuntimeError)"}, {"owner": {"reputation": 11, "user_id": 4486254, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kyl7LDIr6FY/AAAAAAAAAAI/AAAAAAAAAak/jtB0LhiEwgc/photo.jpg?sz=128", "display_name": "Sukanth K", "link": "https://stackoverflow.com/users/4486254/sukanth-k"}, "edited": false, "score": 0, "creation_date": 1526973276, "post_id": 50460891, "comment_id": 87936717, "body": "PROPERTIES_ENCRYPTION_PASSWORD env property not found.  Why this error occurs?"}, {"owner": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 0, "creation_date": 1526999052, "post_id": 50460891, "comment_id": 87953528, "body": "Look at point 3) in the secure_yaml docs. You need to set PROPERTIES_ENCRYPTION_PASSWORD as an environment variable in the shell you start your application in."}], "owner": {"reputation": 11, "user_id": 4486254, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kyl7LDIr6FY/AAAAAAAAAAI/AAAAAAAAAak/jtB0LhiEwgc/photo.jpg?sz=128", "display_name": "Sukanth K", "link": "https://stackoverflow.com/users/4486254/sukanth-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526969823, "creation_date": 1526969376, "last_edit_date": 1526969823, "question_id": 50460891, "link": "https://stackoverflow.com/questions/50460891/how-to-decrypt-and-use-the-encrypted-database-yml-using-secure-yaml-in-rails-pro", "title": "How to decrypt and use the encrypted database.yml using secure_yaml in Rails project?", "body": "<p>I was trying to encrypt the username, password and database name in the database.yml file using secure_yaml in Rails project. </p>\n\n<p>I was able to encrypt using the secret key and save the encrypted database name in database.yml file.</p>\n\n<p>But I am not aware, how should I decrypt the database name and use in my application. </p>\n\n<p>The secure_yaml documentation says \"Within your app\", but I don't know where to do it.</p>\n\n<p><a href=\"https://www.rubydoc.info/gems/secure_yaml/2.0.2\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/secure_yaml/2.0.2</a></p>\n\n<p>My decrypted db name is something like this : ENC(2Q1tkliN6Ei45tCRg9s=)</p>\n\n<p>But I don't how to decrypt this db name to use in the application.</p>\n\n<p>While running my application I got an error db not found (encrypted db name).</p>\n\n<p>How to decrypt the db name to use in the application.? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model", "paperclip"], "answers": [{"tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": true, "score": 6, "last_activity_date": 1526970569, "last_edit_date": 1526970569, "creation_date": 1526969198, "answer_id": 50460855, "question_id": 50460802, "link": "https://stackoverflow.com/questions/50460802/how-to-make-a-model-has-unlimited-images-with-paperclip-in-ruby-on-rails/50460855#50460855", "title": "How to make a model has unlimited images with paperclip in Ruby on Rails?", "body": "<p>You can store the <code>photos</code> (if you call it that) for a user in a separate model and add an association to it in <code>User</code> model:</p>\n\n<p><strong>Command line</strong></p>\n\n<pre><code>rails g paperclip photo pic\n</code></pre>\n\n<p><strong>app/models/user.rb</strong></p>\n\n<pre><code>has_many :photos, dependent: :destroy\n</code></pre>\n\n<p><strong>app/models/photo.rb</strong></p>\n\n<pre><code>belongs_to :user\nhas_attached_file :pic, styles: { medium: \"420\u00d7633!\", thumb: \"100x100#\" }, default_url: \"/images/:style/missing.png\"\nvalidates_attachment_content_type :pic, content_type: /\\Aimage\\/.*\\z/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1526969346, "creation_date": 1526969346, "answer_id": 50460885, "question_id": 50460802, "link": "https://stackoverflow.com/questions/50460802/how-to-make-a-model-has-unlimited-images-with-paperclip-in-ruby-on-rails/50460885#50460885", "title": "How to make a model has unlimited images with paperclip in Ruby on Rails?", "body": "<p>As per the given specifications you could generate another model for saving user_images, in this way user can have unlimited images.</p>\n\n<pre><code>user.rb\nclass User &lt; ApplicationRecord\n  has_many :user_images, dependent: :destroy\n\n  accepts_nested_attributes :user_images\n\n  validates_attachment_content_type :pic, content_type: /\\Aimage\\/.*\\z/\n  has_many :reviews, dependent: :destroy \nend\n\nuser_image.rb\nClass UserImage &lt; ApplicationRecord\n   belongs_to :user\n   has_attached_file :user_image, styles: { medium: \"420\u00d7633!\", thumb: \"100x100#\" }, default_url: \"/images/:style/missing.png\"\nend\n</code></pre>\n\n<p>Added accepts_nested_attributes in user_model and paperclip setting in user_image for uploading images.</p>\n"}], "owner": {"reputation": 708, "user_id": 8005612, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fe32b531eb7d09e29b64d71d392ba9fc?s=128&d=identicon&r=PG&f=1", "display_name": "jungleMan", "link": "https://stackoverflow.com/users/8005612/jungleman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 50460855, "answer_count": 2, "score": 1, "last_activity_date": 1526970569, "creation_date": 1526968956, "question_id": 50460802, "link": "https://stackoverflow.com/questions/50460802/how-to-make-a-model-has-unlimited-images-with-paperclip-in-ruby-on-rails", "title": "How to make a model has unlimited images with paperclip in Ruby on Rails?", "body": "<p>I have a User model that has an avatar. Paperclip was used to allow image upload. However, I want a User to be able to upload as many images as possible (unlimited) . How do I modify my model to allow such behavior ?\nThe user model looks like this: </p>\n\n<pre><code>class Model &lt; ApplicationRecord\n  has_attached_file :pic, styles: { medium: \"420\u00d7633!\", thumb: \"100x100#\" }, default_url: \"/images/:style/missing.png\"\n  validates_attachment_content_type :pic, content_type: /\\Aimage\\/.*\\z/\n  has_many :reviews, dependent: :destroy \n</code></pre>\n\n<p>Thanks in advance !</p>\n"}, {"tags": ["ruby", "fonts", "truetype", "typography", "opentype"], "comments": [{"owner": {"reputation": 39499, "user_id": 740553, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/s5cOX.jpg?s=128&g=1", "display_name": "Mike &#39;Pomax&#39; Kamermans", "link": "https://stackoverflow.com/users/740553/mike-pomax-kamermans"}, "edited": false, "score": 0, "creation_date": 1527536636, "post_id": 50460609, "comment_id": 88154844, "body": "You probably want to ask this question over on <a href=\"http://typedrawers.com\" rel=\"nofollow noreferrer\">typedrawers.com</a>, in the font technology subforum. I suspect you&#39;re looking at CFF-when-embedded-in-PDF for that test case, but I can&#39;t say I ever checked. (Asking on the opentype mailing list might also yield an answer sooner than here on SO)"}, {"owner": {"reputation": 621, "user_id": 498080, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/47915548cbcc438c8407595935951a6b?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/498080/cameron"}, "reply_to_user": {"reputation": 39499, "user_id": 740553, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/s5cOX.jpg?s=128&g=1", "display_name": "Mike &#39;Pomax&#39; Kamermans", "link": "https://stackoverflow.com/users/740553/mike-pomax-kamermans"}, "edited": false, "score": 0, "creation_date": 1527569649, "post_id": 50460609, "comment_id": 88162196, "body": "Great, thanks @Mike&#39;Pomax&#39;Kamermans, I&#39;ll give those avenues a shot :)"}, {"owner": {"reputation": 621, "user_id": 498080, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/47915548cbcc438c8407595935951a6b?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/498080/cameron"}, "reply_to_user": {"reputation": 39499, "user_id": 740553, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/s5cOX.jpg?s=128&g=1", "display_name": "Mike &#39;Pomax&#39; Kamermans", "link": "https://stackoverflow.com/users/740553/mike-pomax-kamermans"}, "edited": false, "score": 1, "creation_date": 1527605959, "post_id": 50460609, "comment_id": 88184211, "body": "Posted over on Typedrawers: <a href=\"http://typedrawers.com/discussion/2718/real-world-fonts-that-include-an-encoding-in-their-cff-table/p1?new=1\" rel=\"nofollow noreferrer\">typedrawers.com/discussion/2718/&hellip;</a>"}, {"owner": {"reputation": 39499, "user_id": 740553, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/s5cOX.jpg?s=128&g=1", "display_name": "Mike &#39;Pomax&#39; Kamermans", "link": "https://stackoverflow.com/users/740553/mike-pomax-kamermans"}, "edited": false, "score": 0, "creation_date": 1527611367, "post_id": 50460609, "comment_id": 88187297, "body": "Also, because I know Adobe is already working on this, CFF recently got updated to the <a href=\"https://docs.microsoft.com/en-us/typography/opentype/spec/cff2\" rel=\"nofollow noreferrer\">CFF2 spec</a> for use specifically in opentype fonts (rather than as datablock to be embedded in &quot;something&quot;), which&#39;ll be well worth implementing in parallel. It ditched the local encoding/charset and just relies on <code>cmap</code> and <code>post</code> =)"}], "owner": {"reputation": 621, "user_id": 498080, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/47915548cbcc438c8407595935951a6b?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/498080/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526968020, "creation_date": 1526968020, "question_id": 50460609, "link": "https://stackoverflow.com/questions/50460609/are-there-any-real-world-fonts-out-there-that-specify-an-encoding-in-the-top-dic", "title": "Are there any real-world fonts out there that specify an encoding in the top dict of the CFF table?", "body": "<p>I am currently working on implementing support for the CFF table and charstrings in the <a href=\"https://github.com/prawnpdf/ttfunk\" rel=\"nofollow noreferrer\">TTFunk</a> library. At the moment I'm trying to write tests for the CFF table's encoding structure, but I'm having a devil of a time finding a real-world font that actually specifies an encoding. CID fonts don't specify one, and all the non-CID fonts I've looked at use one of the predefined encodings (\"standard\" or \"expert\"). I've downloaded thousands of fonts and for the life of me can't find anything. Can anyone point me to a font that has one of these encoding structures, or is it more of an academic thing that nobody actually uses?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1526964354, "post_id": 50459678, "comment_id": 87933032, "body": "Yes it is possible."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 2, "creation_date": 1526964884, "post_id": 50459678, "comment_id": 87933200, "body": "You could use <code>http:&#47;&#47;api.rubyonrails.org&#47;classes&#47;ActionDispatch&#47;Request.ht&zwnj;&#8203;ml#method-i-original&zwnj;&#8203;_url</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "is_accepted": true, "score": 0, "last_activity_date": 1527026001, "creation_date": 1527026001, "answer_id": 50476960, "question_id": 50459678, "link": "https://stackoverflow.com/questions/50459678/need-javascript-location-object-data-in-ruby-helper/50476960#50476960", "title": "Need javascript location object data in ruby helper", "body": "<p>You don't need to pass the javascript value to the helper, you can use </p>\n\n<p><code>request.original_url</code> on your code, and will give you the same value as <code>window.location.href</code> in javascript</p>\n"}], "owner": {"reputation": 5, "user_id": 9826220, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Amit Bisht", "link": "https://stackoverflow.com/users/9826220/amit-bisht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 50476960, "answer_count": 1, "score": -2, "last_activity_date": 1527026001, "creation_date": 1526962398, "last_edit_date": 1526962815, "question_id": 50459678, "link": "https://stackoverflow.com/questions/50459678/need-javascript-location-object-data-in-ruby-helper", "title": "Need javascript location object data in ruby helper", "body": "<p>I need a way to pass javascript object, that is <code>window.location.href</code>  into a rails helper and use the url value there.</p>\n\n<p>is it possible?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1526963221, "post_id": 50459639, "comment_id": 87932717, "body": "What is data type of column <code>cuisines</code> ?"}, {"owner": {"reputation": 101, "user_id": 3192151, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001309058942/picture?type=large", "display_name": "Dr. Joao Paulo", "link": "https://stackoverflow.com/users/3192151/dr-joao-paulo"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1526963620, "post_id": 50459639, "comment_id": 87932828, "body": "Its an array, but rails seems to be not recognizing it"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1526963728, "post_id": 50459639, "comment_id": 87932854, "body": "try to send it with <code>&quot;cuisines[]&quot;: [17,5,2],</code> . let me know if it is working or not"}, {"owner": {"reputation": 101, "user_id": 3192151, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001309058942/picture?type=large", "display_name": "Dr. Joao Paulo", "link": "https://stackoverflow.com/users/3192151/dr-joao-paulo"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1526964060, "post_id": 50459639, "comment_id": 87932945, "body": "Still the same error: {     &quot;status&quot;: &quot;Error&quot;,     &quot;message&quot;: [         &quot;Cuisines can&#39;t be blank&quot;     ] }"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1526966203, "post_id": 50459639, "comment_id": 87933577, "body": "I added my answer , please check it and let me know if it working or not"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 3192151, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001309058942/picture?type=large", "display_name": "Dr. Joao Paulo", "link": "https://stackoverflow.com/users/3192151/dr-joao-paulo"}, "edited": false, "score": 0, "creation_date": 1526964194, "post_id": 50459902, "comment_id": 87932986, "body": "Ok, this works fine IF I remove the :cuisines from my validates part on User model"}, {"owner": {"reputation": 101, "user_id": 3192151, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001309058942/picture?type=large", "display_name": "Dr. Joao Paulo", "link": "https://stackoverflow.com/users/3192151/dr-joao-paulo"}, "edited": false, "score": 0, "creation_date": 1526964205, "post_id": 50459902, "comment_id": 87932988, "body": "validates :first_name, :last_name,:city_id, :province_id,  :password,:password_confirmation,             :presence =&gt; true"}], "tags": [], "owner": {"reputation": 547, "user_id": 6792180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mpzfa.jpg?s=128&g=1", "display_name": "Andres23Ramirez", "link": "https://stackoverflow.com/users/6792180/andres23ramirez"}, "is_accepted": false, "score": 2, "last_activity_date": 1526963975, "creation_date": 1526963975, "answer_id": 50459902, "question_id": 50459639, "link": "https://stackoverflow.com/questions/50459639/receiving-array-in-post-in-rails-api/50459902#50459902", "title": "Receiving array in POST in Rails API", "body": "<p>To declare that the value in params must be an array of permitted scalar values map the key to an empty array:</p>\n\n<pre><code>def user_params\n  params.require(:user).permit(:email, :first_name, :last_name, \n  :city_id, :province_id, :password, :password_confirmation, :cuisines =&gt; [])\nend\n</code></pre>\n\n<p>You can see the answer with more details here <a href=\"https://stackoverflow.com/questions/16549382/how-to-permit-an-array-with-strong-parameters?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">how to permit an array with strong parameters</a></p>\n"}, {"tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": false, "score": 1, "last_activity_date": 1526966181, "creation_date": 1526966181, "answer_id": 50460260, "question_id": 50459639, "link": "https://stackoverflow.com/questions/50459639/receiving-array-in-post-in-rails-api/50460260#50460260", "title": "Receiving array in POST in Rails API", "body": "<p>If you are using POSTMAN then try to send it with form-data\nPlease check below image </p>\n\n<p><a href=\"https://i.stack.imgur.com/09IhI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/09IhI.png\" alt=\"enter image description here\"></a></p>\n\n<p>and in your permit method please add cuisines as array</p>\n\n<pre><code> params.require(:user).permit(:email, :first_name, :last_name, \n  :city_id, :province_id, :password, :password_confirmation, :cuisines =&gt; [])\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 3192151, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001309058942/picture?type=large", "display_name": "Dr. Joao Paulo", "link": "https://stackoverflow.com/users/3192151/dr-joao-paulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 969, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1526966332, "creation_date": 1526962130, "last_edit_date": 1526966332, "question_id": 50459639, "link": "https://stackoverflow.com/questions/50459639/receiving-array-in-post-in-rails-api", "title": "Receiving array in POST in Rails API", "body": "<p>I'm creating a Rails API, and I'm trying to receive an array through a post request. On POSTMAN, my request is:</p>\n\n<pre><code>{\n    \"user\": {\n        \"email\": \"testuser2@gmail.com\",\n        \"first_name\": \"Joao Paulo\",\n        \"last_name\": \"Furtado Silva\",\n        \"city_id\": 384,\n        \"province_id\": 2,\n        \"cuisines\": [17,5,2],\n        \"password\":\"123456\",\n        \"password_confirmation\":\"123456\"\n    }\n}\n</code></pre>\n\n<p>On the user model:</p>\n\n<pre><code>validates :first_name, :last_name, :city_id, :province_id, :cuisines, :password, :password_confirmation, :presence =&gt; true\n</code></pre>\n\n<p>And on User_controller:</p>\n\n<pre><code>def user_params\n  params.require(:user).permit(:email, :first_name, :last_name, :city_id, :province_id, :password, :password_confirmation, :cuisines)\nend\n</code></pre>\n\n<p>Even if I pass my cuisines array to the backend, Rails doesn't recognize it. It says as API response:</p>\n\n<pre><code>{\n  \"status\": \"Error\",\n  \"message\": [\n    \"Cuisines can't be blank\"\n  ]\n}\n</code></pre>\n\n<p>What I'm doing wrong here?</p>\n\n<p>If I remove <code>:cuisines</code> from validation, it works fine. But I'm not supposed to do this. What's the best way to solve this issue?</p>\n\n<p><strong>SOLUTION SO FAR:</strong></p>\n\n<p>I removed <code>:cuisines</code>  automatic validation from Rails, and validated it manually in a simple code like:</p>\n\n<pre><code>#validate cuisines\n@cuisines = params.require(:user)[:cuisines] #it comes in array format\n\nif @cuisines.empty?\n  render json: {\n    status: 'Error',\n    message: 'User cuisines are empty',\n  }, status: :precondition_failed\n\n  return false\nend\n</code></pre>\n\n<p>If someone has a better solution, please post.</p>\n"}, {"tags": ["ruby", "heap"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 3, "creation_date": 1526958387, "post_id": 50459098, "comment_id": 87931659, "body": "What does k stand for? What tells how to prioritize? Maybe you can expand the example? I have the idea to use rotate, but need more details to test."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1526959336, "post_id": 50459098, "comment_id": 87931872, "body": "I mean, <code>words.rotate(k).first(k)</code> gives the required output, but what if the array is longer? And how to manage the show up count?"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 1, "creation_date": 1526962884, "post_id": 50459098, "comment_id": 87932632, "body": "array looks simple enough, did you try <code>words[3..-1]</code>? Not sure how heap or Priority Queue will solve this problem. If you have got such array with huge amount of data then probably it&#39;s more of NLP problem to solve. Without knowing what exactly is required/logic to form/capture a particular sentence will not work."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4690694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TXIqMuXbd-8/AAAAAAAAAAI/AAAAAAAAABM/10g1h8lXj0Y/photo.jpg?sz=128", "display_name": "tk0221", "link": "https://stackoverflow.com/users/4690694/tk0221"}, "edited": false, "score": 0, "creation_date": 1526966203, "post_id": 50460178, "comment_id": 87933576, "body": "Thanks for the help. I am not familiar with writing code inside of <code>{}</code> block. Do you have any reference for that?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 121, "user_id": 4690694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TXIqMuXbd-8/AAAAAAAAAAI/AAAAAAAAABM/10g1h8lXj0Y/photo.jpg?sz=128", "display_name": "tk0221", "link": "https://stackoverflow.com/users/4690694/tk0221"}, "edited": false, "score": 1, "creation_date": 1526967963, "post_id": 50460178, "comment_id": 87934243, "body": "I am not sure what\u2019s specific with writing code inside <code>{}</code> block. It\u2019s exactly the same code as outside."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1526965745, "creation_date": 1526965745, "answer_id": 50460178, "question_id": 50459098, "link": "https://stackoverflow.com/questions/50459098/how-can-i-implement-priority-queue-or-heap-in-ruby/50460178#50460178", "title": "How can I implement priority queue or heap in Ruby?", "body": "<p>If you want to sort alphabetically when the frequency is the same, <em>do sort alphabetically</em>:</p>\n\n<pre><code>words.group_by { |w| w }.\n      sort_by { |w, a| [-a.size, w] }. # \u21d0 HERE\n      map(&amp;:first).\n      first(3)\n#\u21d2 [\"i\", \"love\", \"code\"]\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4690694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TXIqMuXbd-8/AAAAAAAAAAI/AAAAAAAAABM/10g1h8lXj0Y/photo.jpg?sz=128", "display_name": "tk0221", "link": "https://stackoverflow.com/users/4690694/tk0221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 50460178, "answer_count": 1, "score": 0, "last_activity_date": 1526965745, "creation_date": 1526957576, "last_edit_date": 1526965329, "question_id": 50459098, "link": "https://stackoverflow.com/questions/50459098/how-can-i-implement-priority-queue-or-heap-in-ruby", "title": "How can I implement priority queue or heap in Ruby?", "body": "<p>I have:</p>\n\n<pre><code>words = [\"i\", \"love\", \"leet\", \"i\", \"love\", \"code\"]\nk = 3\n</code></pre>\n\n<p><code>\"i\"</code> and <code>\"love\"</code> show up twice, but <code>\"leet\"</code> and <code>\"code\"</code> show up once. I want:</p>\n\n<pre><code>[\"i\", \"love\", \"code\"]\n</code></pre>\n\n<p>instead of <code>\"leet\"</code>. This code:</p>\n\n<pre><code>words.group_by(&amp;:itself).sort_by {|_, s| -s.length}.first(k).map(&amp;:first)\n</code></pre>\n\n<p>will display:</p>\n\n<pre><code>[\"i\", \"love\", \"leet\"]\n</code></pre>\n\n<p>What is a good way to solve this issue?</p>\n\n<p>It can be solved using a heap, but Ruby does not support Heap. Is there any recommendation? I would like to do it without using a gem so that I can demo at an online code test site.</p>\n\n<p>==========================================================================\n<code>k</code> is for frequency\nSo this question is for find k frequency words in the words array.\nwhen k is 3 issue I counter is choosing <code>code</code> not <code>leet</code>. I want to sort by alphabet order when there is same frequency words, so I can pick first one. </p>\n"}, {"tags": ["ruby", "mongodb", "error-handling", "mongoid"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526959201, "post_id": 50458970, "comment_id": 87931848, "body": "What is your question?"}, {"owner": {"reputation": 2084, "user_id": 3141240, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bc520eb2dcd6c23a18369425666faae8?s=128&d=identicon&r=PG&f=1", "display_name": "Ravenstine", "link": "https://stackoverflow.com/users/3141240/ravenstine"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1526960015, "post_id": 50458970, "comment_id": 87932027, "body": "@sawa Sorry, I thought it was implicit but I&#39;ll clarify.  Why is it that the error seems to get raised even when I rescue it, and how can I prevent the error from getting raised?  I don&#39;t remember ever having an error &quot;bubble&quot; up like that when rescued."}], "answers": [{"tags": [], "owner": {"reputation": 775, "user_id": 1544440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75da798fa2e162ff6eab82bc51a2d3a3?s=128&d=identicon&r=PG", "display_name": "Omar Bahareth", "link": "https://stackoverflow.com/users/1544440/omar-bahareth"}, "is_accepted": false, "score": 0, "last_activity_date": 1527064457, "creation_date": 1527064457, "answer_id": 50483559, "question_id": 50458970, "link": "https://stackoverflow.com/questions/50458970/mongoiderrorsdocumentnotfound-is-raised-even-after-rescuing/50483559#50483559", "title": "Mongoid::Errors::DocumentNotFound is raised even after rescuing", "body": "<p>I'm not sure why it gets raised even when you rescue it, but I'll answer the \"how to prevent it\" part.</p>\n\n<p>In your <code>mongoid.yml</code>, you need to set </p>\n\n<pre><code>raise_not_found_error: false\n</code></pre>\n\n<p>See <a href=\"https://docs.mongodb.com/mongoid/master/tutorials/mongoid-installation/#anatomy-of-a-mongoid-config\" rel=\"nofollow noreferrer\">this section</a> in the Mongoid docs for an example.</p>\n"}], "owner": {"reputation": 2084, "user_id": 3141240, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bc520eb2dcd6c23a18369425666faae8?s=128&d=identicon&r=PG&f=1", "display_name": "Ravenstine", "link": "https://stackoverflow.com/users/3141240/ravenstine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 514, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527064457, "creation_date": 1526956467, "last_edit_date": 1526960083, "question_id": 50458970, "link": "https://stackoverflow.com/questions/50458970/mongoiderrorsdocumentnotfound-is-raised-even-after-rescuing", "title": "Mongoid::Errors::DocumentNotFound is raised even after rescuing", "body": "<p>I have a Rails controller with this method being triggered as a before_action:</p>\n\n<pre><code>  def authenticate_user\n    Knock::AuthToken.new(token: token).entity_for(User)\n  rescue Mongoid::Errors::DocumentNotFound\n    render nothing: true, status: 401\n  end\n</code></pre>\n\n<p>Even though I can verify that it's rescuing the error(a byebug breakpoint gets triggered under the rescue statement), it still manages to be raised immediately after:</p>\n\n<pre><code>Mongoid::Errors::DocumentNotFound (\nmessage:\n  Document(s) not found for class User with id(s) 1.\nsummary:\n  When calling User.find with an id or array of ids, each parameter must match a document in the database or this error will be raised. The search was for the id(s): 1 ... (1 total) and the following ids were not found: 1.\nresolution:\n  Search for an id that is in the database or set the Mongoid.raise_not_found_error configuration option to false, which will cause a nil to be returned instead of raising this error when searching for a single id, or only the matched documents when searching for multiples.):\n\napp/controllers/api/base_controller.rb:12:in `authenticate_user'\n</code></pre>\n\n<p>I've been using the rescue keyword for years in Ruby and have never encountered this.  </p>\n\n<p>What I'm running:</p>\n\n<ul>\n<li>Ruby 2.5</li>\n<li>Rails 5.2</li>\n<li>Mongoid 7.0.1</li>\n</ul>\n\n<p>Why is it that the error gets raised even when I rescue it, and how can I prevent the error from getting raised?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite"], "comments": [{"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "edited": false, "score": 0, "creation_date": 1527017421, "post_id": 50458931, "comment_id": 87963830, "body": "<code>gem uninstall sqlite3 (select all)</code> <code>gem install sqlite3 --platform=ruby</code> - that will fix it"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 5156455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008e0ac86b465299852befcb2e44c453?s=128&d=identicon&r=PG", "display_name": "Anil Cherukuri", "link": "https://stackoverflow.com/users/5156455/anil-cherukuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1527017147, "creation_date": 1527017147, "answer_id": 50475122, "question_id": 50458931, "link": "https://stackoverflow.com/questions/50458931/error-message-when-starting-ruby-on-rails-server/50475122#50475122", "title": "Error message when starting Ruby on Rails server", "body": "<p>I recommend setting up a Linux VM on your Windows PC and start coding on it instead of on Windows. You'll keep encountering many issues in the future if you stick with Windows. Windows &amp; ruby on rails don't go well together. So, it's better to go with some Linux flavor or preferably Mac.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3966058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FQTN6.jpg?s=128&g=1", "display_name": "Pseudo", "link": "https://stackoverflow.com/users/3966058/pseudo"}, "is_accepted": false, "score": 0, "last_activity_date": 1527034068, "creation_date": 1527034068, "answer_id": 50478087, "question_id": 50458931, "link": "https://stackoverflow.com/questions/50458931/error-message-when-starting-ruby-on-rails-server/50478087#50478087", "title": "Error message when starting Ruby on Rails server", "body": "<p>If you are going to be learning RoR with the goal of ever doing anything serious in the future, here's the best advice I can give to someone starting out:  Buy a Mac.  NEVER try to use Microsoft for anything but Microsoft office...  you'll just end up so frustrated that you will give up.  RoR is NOT the toy to try \"round peg, square hole\" with.</p>\n\n<p>Next, being that your on a Mac, NEVER use sqlite3.  You can easily use the correct database which is PostgreSQL.  Why is this important?</p>\n\n<p>You're starting out.  Keep things very simple.  Get a free Heroku account, and install the CLI (for mac).  You can then do: \"heroku local\" to run your code locally (for building), and because it's Mac/PostgreSQL, when you go to push that code live, everything is the same (Heroku is going to be PostgreSQL) so you won't get lost for days trouble shooting the differences between where you're building the code, and where you're running the code.</p>\n"}], "owner": {"reputation": 25, "user_id": 4531234, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8ab490565f4f521c67707605f58bd229?s=128&d=identicon&r=PG&f=1", "display_name": "user4531234", "link": "https://stackoverflow.com/users/4531234/user4531234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1527034068, "creation_date": 1526956084, "last_edit_date": 1526956751, "question_id": 50458931, "link": "https://stackoverflow.com/questions/50458931/error-message-when-starting-ruby-on-rails-server", "title": "Error message when starting Ruby on Rails server", "body": "<p>hope I can get some help with a problem I have been having. I am getting into Ruby on Rails and used a tutorial (<a href=\"http://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/getting_started.html</a>) to try to get started with it. It says I need Sqlite3. I followed the steps up to the point where it says to use the ruby bin\\rails server command in command prompt. However, when I try to do this, I get the following error message.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XHDSg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XHDSg.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I try to install Sqlite3, I use the x86 version for Windows, as I am using Windows 8.1.</p>\n\n<p>I don't know what I am doing wrong...I am not even sure if the SQlite3 files are in the right place. I use command prompt to check if I have Ruby, Rails, and Sqlite3 all installed, which I do. I also know I have the SQlite3 Ruby gem installed. I have also added SQlite3 to my PATH system variable, but that doesn't seem to work either. I always get the same above error message no matter what I do.</p>\n\n<p>Anyone have any ideas as to what the problem might be? Any help would be greatly appreciated! Thanks!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1526953605, "post_id": 50458643, "comment_id": 87930735, "body": "The filename in what you&#39;ve posted is <code>File_DR017_20180503.csv</code>."}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1526953626, "post_id": 50458643, "comment_id": 87930739, "body": "Yes, I tried that first and it was returning nil but I figured it out."}], "answers": [{"tags": [], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "is_accepted": false, "score": 0, "last_activity_date": 1526953694, "creation_date": 1526953694, "answer_id": 50458684, "question_id": 50458643, "link": "https://stackoverflow.com/questions/50458643/read-a-csv-file-from-ftp/50458684#50458684", "title": "Read a csv file from FTP", "body": "<p>If you pass in a file as a second argument, it will copy the contents to the new file:</p>\n\n<pre><code>ftp.gettextfile(\"File_DR017_20180503.csv\", \"/Users/myuser/Downloads/somerandomfile\")\n</code></pre>\n\n<p>And then you can read the content from that file.</p>\n\n<p>Also using the ftp.<code>nlst</code> command is the way to get the actual file names without listing all the contents of the file, which is what <code>ls</code> does. </p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 441, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526953694, "creation_date": 1526953357, "question_id": 50458643, "link": "https://stackoverflow.com/questions/50458643/read-a-csv-file-from-ftp", "title": "Read a csv file from FTP", "body": "<p>I am simply trying to read a csv file from a remote ftp server:</p>\n\n<pre><code>ftp = Net::FTP.new(\"ftp.website.org\")\nftp.login user, pass\nftp.passive = true\nftp.list\n =&gt; [\"05-03-18  09:36AM                54590 File_DR017_20180503.csv\",\nf1 = ftp.get(\"05-03-18  09:36AM                54590 File_DR017_20180503.csv\")\n=&gt; Net::FTPPermError: 550 The parameter is incorrect.\n</code></pre>\n\n<p>Note that if I try to read <code>File_DR017_20180503.csv</code>:</p>\n\n<pre><code>ftp.gettextfile(\"Osceola_Civil_DR017_20180503.csv\")\n =&gt; nil \n</code></pre>\n\n<p>it returns nil</p>\n\n<p>How can I read a csv file from ftp server?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "activerecord", "nested-attributes"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1526965110, "post_id": 50457598, "comment_id": 87933260, "body": "Tried this: <a href=\"https://github.com/ryanb/nested_form\" rel=\"nofollow noreferrer\">github.com/ryanb/nested_form</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 1221, "user_id": 3043906, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/DqKY8.jpg?s=128&g=1", "display_name": "Horacio", "link": "https://stackoverflow.com/users/3043906/horacio"}, "is_accepted": false, "score": 0, "last_activity_date": 1526944973, "creation_date": 1526944973, "answer_id": 50457765, "question_id": 50457598, "link": "https://stackoverflow.com/questions/50457598/how-to-create-multiple-children-objects-after-the-parent-has-been-created/50457765#50457765", "title": "How to create multiple children objects after the parent has been created?", "body": "<p>An option could be to create first your Order, and then the items.</p>\n\n<pre><code># config/routes\n...\nresources :orders do\n  resources :items\nend\n\n# app/controllers/itesm_controller.rb\nclass ItemsController &lt; ApplicationController\n  def new\n    order = Order.find(params[:order_id]\n    @item = order.items.new\n  end\n\n  def create\n    item.create(item_params)\n    redirect_to orders_path # just guessing your paths\n  end\n\n  protected\n\n  def item_params\n    params.require(:item).permit(:your, :attributes, :here)\n  end\nend\n\n# Assuming Rails +5.1\n# app/views/items/_form.html.erb\n# you can use this partial in 'new.html.erb' and 'edit.html.erb'\n\n&lt;%= form_view model: @item do |form| %&gt;\n  &lt;%= form.label :your_attribute %&gt;\n  &lt;%= form.text_field :your_attribute %&gt;\n  &lt;%= form.submit %&gt;\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 2908539, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qggO4.png?s=128&g=1", "display_name": "Andr&#233; Luiz", "link": "https://stackoverflow.com/users/2908539/andr%c3%a9-luiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526946980, "creation_date": 1526943499, "last_edit_date": 1526946980, "question_id": 50457598, "link": "https://stackoverflow.com/questions/50457598/how-to-create-multiple-children-objects-after-the-parent-has-been-created", "title": "How to create multiple children objects after the parent has been created?", "body": "<p>This is my scenario:</p>\n\n<p>I have a an <strong>Order</strong> model and a <strong>Item</strong> model. They have the following relationship:</p>\n\n<pre><code>class Order &lt; ApplicationRecord\n    has_many :items\nend\n\nclass Item &lt; ApplicationRecord\n    belongs_to :order\nend\n</code></pre>\n\n<p>In my project, initially, I need to create the Order without Items. After that I need to create the items related to that order.</p>\n\n<p>I have already tried user <strong>nested_attributes</strong>, however, I'm gonna need to created items more than once and in the second time try the Items I have already created shows up in the form for editing.</p>\n\n<p>Any suggestions on the best approach?</p>\n\n<p>EDIT:</p>\n\n<p>Add one more info. I need the option to create multiple items at once.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1526939765, "post_id": 50457067, "comment_id": 87927753, "body": "Is there a &quot;blank&quot; user created? Or is it nil like the error implies? Unrelated, but I don&#39;t see how the title is related to the question."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1526940603, "post_id": 50457067, "comment_id": 87928001, "body": "Sorry, I forgot to change the title. It doesn&#39;t seem like it no. (I checked the db via &quot;DB Browser&quot; and I only have users 2 and 3, I deleted the first user using the DB browser. I was testing and made the same user twice, but it didn&#39;t raise the error but said the error in my command prompt. I implemented this and it didn&#39;t seem to work."}, {"owner": {"reputation": 1603, "user_id": 565487, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vDTFH.jpg?s=128&g=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/565487/julien"}, "edited": false, "score": 0, "creation_date": 1526941031, "post_id": 50457067, "comment_id": 87928111, "body": "show us the rest of the code (controller action and form)"}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "reply_to_user": {"reputation": 1603, "user_id": 565487, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vDTFH.jpg?s=128&g=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/565487/julien"}, "edited": false, "score": 0, "creation_date": 1526941395, "post_id": 50457067, "comment_id": 87928237, "body": "@Julien I added more info"}], "answers": [{"comments": [{"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1526942128, "post_id": 50457336, "comment_id": 87928425, "body": "Thank you it now displays the errors! Would calling the object me required for all forms like this? or only the ones that need to use the <code>object.errors</code> exception handler?"}, {"owner": {"reputation": 1603, "user_id": 565487, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vDTFH.jpg?s=128&g=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/565487/julien"}, "reply_to_user": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 1, "creation_date": 1526942306, "post_id": 50457336, "comment_id": 87928464, "body": "when working on an object you should do it like that, it will allow you also to have the form populated with the object&#39;s data when using the form in the edit action"}], "tags": [], "owner": {"reputation": 1603, "user_id": 565487, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vDTFH.jpg?s=128&g=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/565487/julien"}, "is_accepted": true, "score": 1, "last_activity_date": 1526941538, "creation_date": 1526941538, "answer_id": 50457336, "question_id": 50457067, "link": "https://stackoverflow.com/questions/50457067/object-errors-in-ruby-on-rails-not-working/50457336#50457336", "title": "Object.errors in Ruby on Rails not working", "body": "<p>Change the way you are opening the form to this (instead of a symbol pass the object you created in the new action):</p>\n\n<pre><code>&lt;%= simple_form_for @user, url: register_path do |f| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 50457336, "answer_count": 1, "score": 2, "last_activity_date": 1526941538, "creation_date": 1526939573, "last_edit_date": 1526941354, "question_id": 50457067, "link": "https://stackoverflow.com/questions/50457067/object-errors-in-ruby-on-rails-not-working", "title": "Object.errors in Ruby on Rails not working", "body": "<p>I have a form error partial that raises a NoMethodError in Users#new. It says \"undefined method <code>errors</code> for nil:NilClass</p>\n\n<p>This is the partial I am calling via: <code>&lt;%= render 'shared/error_messages', object: f.object %&gt;</code></p>\n\n<pre><code>&lt;% if object.errors.any? %&gt;\n  &lt;div id=\"error_explanation\"&gt;\n    &lt;div class=\"alert\"&gt;\n      The form contains &lt;%= pluralize(object.errors.count, \"error\") %&gt;.\n    &lt;/div&gt;\n    &lt;ul&gt;\n    &lt;% object.errors.full_messages.each do |msg| %&gt;\n      &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n    &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The <code>new.html.erb</code> for <code>users</code>:</p>\n\n<pre><code>&lt;%= simple_form_for :user, url: register_path do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;%= f.input :username, label: false, placeholder: \"Username (maximum: 12 characters)\", class: \"form-control\" %&gt;\n  &lt;%= f.input :first_last_name, label: false, placeholder: \"First &amp; Last Name\", class: \"form-control\" %&gt;\n  &lt;%= f.input :email, label: false, placeholder: \"Email Address\", class: \"form-control\" %&gt;\n  &lt;%= f.input :password, label: false, placeholder: \"Create a Password (minimum: 6 characters)\", class: \"form-control\" %&gt;\n  &lt;%= f.button :submit, \"Create an Account!\", class: \"submit btn btn-block btn-success\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><code>users_controller</code>:</p>\n\n<pre><code>before_action :logged_in_user, only: [:edit, :update, :show]\nbefore_action :correct_user,   only: [:edit, :update, :show]\nbefore_action :admin_user,     only: :destroy\n\ndef new\n  @title = 'Register';\n  @user = User.new;\nend\n\ndef create\n  @user = User.new(user_params)\n  if @user.save\n    @user.send_activation_email\n    flash[:info] = \"Please check your email to activate your account.\"\n    redirect_to root_url\n  else\n    render 'new'\n  end\nend\n\n  private\n\ndef user_params\n  params.require(:user).permit(:username, :first_last_name, :email, :password)\nend\n\n# Before filters\n\n# Confirms the correct user.\ndef correct_user\n  @user = User.find(params[:id])\n  redirect_to(root_url) unless current_user?(@user)\nend\n\n# Confirms an admin user.\ndef admin_user\n  redirect_to(root_url) unless current_user.admin?\nend\n</code></pre>\n\n<p>I don't really understand why this wouldn't be working, Thanks for the help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 301, "user_id": 8759209, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AhiT4Z0WHsg/AAAAAAAAAAI/AAAAAAAAANk/8ZIAOkPCMA8/photo.jpg?sz=128", "display_name": "Artem Ignatiev", "link": "https://stackoverflow.com/users/8759209/artem-ignatiev"}, "edited": false, "score": 0, "creation_date": 1526946493, "post_id": 50457026, "comment_id": 87929386, "body": "Hi ferne97, check <a href=\"https://stackoverflow.com/a/40511534/8759209\">this answer</a>, that should help"}, {"owner": {"reputation": 4821, "user_id": 248501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jECl1.jpg?s=128&g=1", "display_name": "Woahdae", "link": "https://stackoverflow.com/users/248501/woahdae"}, "edited": false, "score": 0, "creation_date": 1544653982, "post_id": 50457026, "comment_id": 94357595, "body": "Your example doesn&#39;t reflect a true polymorphic use case, which hides the complexity here. You also need a <code>Baz</code> that is <code>barable</code>, which exposes the issue - you can&#39;t just query the join table id is null as you would for a normal has-many/belongs-to relationship because you don&#39;t know the join table name without asking the Rails class."}], "answers": [{"comments": [{"owner": {"reputation": 973, "user_id": 1566806, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2cb29963af804c2c0c5dc7328abfc431?s=128&d=identicon&r=PG", "display_name": "ferne97", "link": "https://stackoverflow.com/users/1566806/ferne97"}, "edited": false, "score": 0, "creation_date": 1526951694, "post_id": 50458376, "comment_id": 87930378, "body": "<code>left_outer_joins</code> doesn&#39;t seem to work with polymorphic associations"}, {"owner": {"reputation": 346, "user_id": 3047808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7A17E.jpg?s=128&g=1", "display_name": "Pedro Fernandes", "link": "https://stackoverflow.com/users/3047808/pedro-fernandes"}, "reply_to_user": {"reputation": 973, "user_id": 1566806, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2cb29963af804c2c0c5dc7328abfc431?s=128&d=identicon&r=PG", "display_name": "ferne97", "link": "https://stackoverflow.com/users/1566806/ferne97"}, "edited": false, "score": 0, "creation_date": 1526952945, "post_id": 50458376, "comment_id": 87930625, "body": "True, I&#39;ve changed to another way. This should work with polymorphic associations. @ferne97"}, {"owner": {"reputation": 4821, "user_id": 248501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jECl1.jpg?s=128&g=1", "display_name": "Woahdae", "link": "https://stackoverflow.com/users/248501/woahdae"}, "edited": false, "score": 0, "creation_date": 1544654106, "post_id": 50458376, "comment_id": 94357650, "body": "There is no <code>foo_id</code> on <code>bars</code> in his example. If there were, it&#39;d be a has-many/belongs-to relationship, rather than a polymorphic one with <code>barable_id</code> and <code>barable_type</code> on <code>Bar</code> and nothing on any other model."}], "tags": [], "owner": {"reputation": 346, "user_id": 3047808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7A17E.jpg?s=128&g=1", "display_name": "Pedro Fernandes", "link": "https://stackoverflow.com/users/3047808/pedro-fernandes"}, "is_accepted": false, "score": 0, "last_activity_date": 1526952876, "last_edit_date": 1526952876, "creation_date": 1526950774, "answer_id": 50458376, "question_id": 50457026, "link": "https://stackoverflow.com/questions/50457026/query-empty-polymorphic-associations/50458376#50458376", "title": "Query empty polymorphic associations", "body": "<pre><code>Foo.joins('LEFT JOIN bars ON bars.foo_id = foos.id').where('bars.id is null') \n</code></pre>\n"}], "owner": {"reputation": 973, "user_id": 1566806, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2cb29963af804c2c0c5dc7328abfc431?s=128&d=identicon&r=PG", "display_name": "ferne97", "link": "https://stackoverflow.com/users/1566806/ferne97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1526958064, "creation_date": 1526939303, "last_edit_date": 1526958064, "question_id": 50457026, "link": "https://stackoverflow.com/questions/50457026/query-empty-polymorphic-associations", "title": "Query empty polymorphic associations", "body": "<p>I'm trying to find all <code>Foo</code>'s that don't have a <code>Bar</code> associated with them. I know this doesn't work but something along the lines of <code>Foo.where(barable: nil)</code>.</p>\n\n<p><strong>Foo model</strong></p>\n\n<pre><code>class Foo &lt; ApplicationRecord\n    has_many :bars, as: :barable\nend\n</code></pre>\n\n<p><strong>Bar model</strong></p>\n\n<pre><code>class Bar &lt; ApplicationRecord\n    belongs_to :barable, polymorphic: true\nend\n</code></pre>\n\n<p><strong>Tables</strong></p>\n\n<pre><code>Foo(id: integer, name: string, created_at: datetime, updated_at: datetime)\n\nBar(id: integer, barable_type: string, barable_id: string, created_at: datetime, updated_at: datetime)\n</code></pre>\n"}, {"tags": ["ruby", "faraday"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526938756, "post_id": 50456917, "comment_id": 87927422, "body": "Does Faraday have a tuneable max-accept limit?"}, {"owner": {"reputation": 16919, "user_id": 152825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e990c2bcb4dfb7fd0c398098da9bca59?s=128&d=identicon&r=PG", "display_name": "timpone", "link": "https://stackoverflow.com/users/152825/timpone"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1526939105, "post_id": 50456917, "comment_id": 87927545, "body": "I don&#39;t think so"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 9825164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7444fd9ca9b1c9718b0dc3b92e2f53d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9825164/chris"}, "is_accepted": true, "score": 3, "last_activity_date": 1526939109, "creation_date": 1526939109, "answer_id": 50456994, "question_id": 50456917, "link": "https://stackoverflow.com/questions/50456917/baffled-as-to-why-faraday-is-giving-me-a-403-error/50456994#50456994", "title": "baffled as to why faraday is giving me a 403 error", "body": "<p>That error sounds like a response from the API you're querying, rather than an issue with Faraday specifically. I would not expect Faraday to overwrite the actual HTTP response body.</p>\n\n<p>What happens when you make the API request using <code>curl -i</code>? </p>\n\n<p>If it is caused by Faraday struggling with the large response payload, can you just stream the response directly to disk?</p>\n"}], "owner": {"reputation": 16919, "user_id": 152825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e990c2bcb4dfb7fd0c398098da9bca59?s=128&d=identicon&r=PG", "display_name": "timpone", "link": "https://stackoverflow.com/users/152825/timpone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 50456994, "answer_count": 1, "score": 0, "last_activity_date": 1526939109, "creation_date": 1526938581, "question_id": 50456917, "link": "https://stackoverflow.com/questions/50456917/baffled-as-to-why-faraday-is-giving-me-a-403-error", "title": "baffled as to why faraday is giving me a 403 error", "body": "<p>I'm using Faraday to interact with an API. It is returning large JSON objects (> 10MB) but not that large. When I dump the res.body, it is: </p>\n\n<pre><code>{\"code\": 403, \"error\": \"Exceeded max response data size\"}\n</code></pre>\n\n<p>What is going on? Code isn't presumably an http status and I've never had a response be too large. Can I adjust the data size? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1526936750, "creation_date": 1526936750, "answer_id": 50456617, "question_id": 50456159, "link": "https://stackoverflow.com/questions/50456159/rsvp-button-users-can-only-rsvp-once/50456617#50456617", "title": "rsvp button (users can only rsvp once)", "body": "<p>The most important thing to me is a database constraint. You want to instruct the database to throw an error in those cases.</p>\n\n<p>In a migration</p>\n\n<pre><code>add_index :rsvps, [:user_id, :post_id], unique: true\n</code></pre>\n\n<p>And a validation that reflect that, just to make rails aware of this</p>\n\n<pre><code>validates :user_id, uniqueness: { scope: :post_id }\n</code></pre>\n\n<p>Now we're sure that no more than one pair some_user_id, some_post_id is present in the database.</p>\n\n<p>Now, let's instruct the view to not display the button in those cases</p>\n\n<pre><code>&lt;% unless Rsvp.exists?(post: @post, user: @post.user) %&gt;\n  &lt;div class=\"rsvp\"&gt;\n    &lt;%= button_to \"Rsvp now\", rsvps_post_path(@post), class: \"btn btn-primary\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I'd move that exists query in the action and use just a boolean here, this is just demonstrative.</p>\n"}], "owner": {"reputation": 19, "user_id": 9825021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "digital king", "link": "https://stackoverflow.com/users/9825021/digital-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526936750, "creation_date": 1526934430, "question_id": 50456159, "link": "https://stackoverflow.com/questions/50456159/rsvp-button-users-can-only-rsvp-once", "title": "rsvp button (users can only rsvp once)", "body": "<p>So currently users can rsvp multiple times for the same event. That is obviously problematic for my website so I want it that a single user can only rsvp once for a specific post/event. After they have made their Rsvp I want the rsvp button to disappear. Heres is how my code is looking.</p>\n\n<h1>show.html.erb</h1>\n\n<pre><code>id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n\n&lt;p&gt;\n  &lt;strong&gt;Date:&lt;/strong&gt;\n  &lt;%= @post.date %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n    &lt;strong&gt;Name:&lt;/strong&gt;\n    &lt;%= @post.name %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;User_id:&lt;/strong&gt;\n  &lt;%= @post.user_id %&gt;\n&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Address:&lt;/strong&gt; &lt;%= @post.address %&gt;&lt;/p&gt;\n&lt;p&gt;\n  &lt;strong&gt;Description:&lt;/strong&gt;\n  &lt;%= @post.description %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n    &lt;strong&gt;registered:&lt;/strong&gt;\n    &lt;%=@post.users.length%&gt;\n&lt;/p&gt;\n\n\n\n\n\n\n&lt;% if current_user == @post.user %&gt;\n &lt;%= link_to 'Edit', edit_post_path(@post) %&gt; |\n&lt;%end%&gt;\n &lt;%= link_to 'Back', posts_path %&gt;\n\n&lt;div class=\"rsvp\"&gt;&lt;%= button_to \"Rsvp now\", rsvps_post_path(@post), class: \"btn btn-primary\" %&gt;&lt;/div&gt;\n\n\n\n\n\n&lt;div class=\"map\"&gt;&lt;%= image_tag \"http://maps.googleapis.com/maps/api/staticmap?center=#{@post.latitude},#{@post.longitude}&amp;markers=#{@post.latitude},#{@post.longitude}&amp;zoom=12&amp;size=450x400&amp;sensor=false&amp;key=AIzaSyCKzKMEhSNgwSXf7WV71pHWgzdpMkPn8W4\",\nclass: 'img-fluid img-rounded', alt: \"#{@post} on the map\"%&gt;\n&lt;/div&gt;\n</code></pre>\n\n<h1>post.rb</h1>\n\n<pre><code>class Post &lt; ApplicationRecord\nbelongs_to :user\n geocoded_by :address\nafter_validation :geocode, if: -&gt;(obj){ obj.address.present? and obj.address_changed? }\nreverse_geocoded_by :latitude, :longitude\nafter_validation :reverse_geocode\n\n\n  has_many :rsvps\n  has_many :users, through: :rsvps\n\n  validates :name, presence: true\n</code></pre>\n\n<h1>user.rb</h1>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n         has_many :posts\n\n          has_many :rsvps\n          has_many :posts, through: :rsvps\n\n          validates :email, presence: true\n</code></pre>\n\n<h1>rsvp.rb</h1>\n\n<pre><code>class Rsvp &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :post\nend\n</code></pre>\n\n<p>#rsvp migration</p>\n\n<pre><code>class Rsvp &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :post\nend\n</code></pre>\n\n<p>So I've looked around in Stackoverflow and googled for a bit but I'm at a loss. I would really appreciate an answer that would solve this issue. I just want the rsvp button to show users who havent rsvped for the specific post/event.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "edited": false, "score": 0, "creation_date": 1526933628, "post_id": 50455932, "comment_id": 87925413, "body": "Is there a reason why you want to keep the <code>break</code>? If you get rid of the <code>if</code> condition (doing away with the need for the counter), your loop will run forever."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1526933929, "post_id": 50455932, "comment_id": 87925542, "body": "<code>10.times { puts &quot;hello&quot;; sleep 2 }</code>"}, {"owner": {"reputation": 1, "user_id": 9621245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8850f81413978a167d34e3ea43051a91?s=128&d=identicon&r=PG&f=1", "display_name": "DestroyedPixels", "link": "https://stackoverflow.com/users/9621245/destroyedpixels"}, "edited": false, "score": 0, "creation_date": 1526934203, "post_id": 50455932, "comment_id": 87925656, "body": "I should amend the code, I want it to sleep(7200) then restart."}, {"owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "edited": false, "score": 0, "creation_date": 1526934908, "post_id": 50455932, "comment_id": 87925954, "body": "You can edit your original question if you need to."}, {"owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "edited": false, "score": 0, "creation_date": 1526936797, "post_id": 50455932, "comment_id": 87926684, "body": "You don&#39;t need the counter. As in Sagar Pandya&#39;s example, you can use the <code>#times</code> method. See the integer class <a href=\"https://ruby-doc.org/core-2.2.0/Integer.html\" rel=\"nofollow noreferrer\">documentation</a>."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1526936888, "post_id": 50455932, "comment_id": 87926730, "body": "The &quot;top&quot; meaning... what? What specifically do you want the code to do? If you want to run the inner loop (<code>text_counter &gt;= MAXTEXT_COUNTER</code>) n times then put the existing loop in an outer loop. And you can use <code>times</code> for that as well."}], "answers": [{"comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 2, "creation_date": 1526936809, "post_id": 50456615, "comment_id": 87926692, "body": "<code>next</code> would be meaningless here; the loop already does what it&#39;s supposed to. There needs to be an <i>outer</i> loop."}], "tags": [], "owner": {"reputation": 46, "user_id": 9825164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7444fd9ca9b1c9718b0dc3b92e2f53d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9825164/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1526936746, "creation_date": 1526936746, "answer_id": 50456615, "question_id": 50455932, "link": "https://stackoverflow.com/questions/50455932/restarting-a-loop-from-the-top/50456615#50456615", "title": "Restarting a loop from the top", "body": "<p>You're looking for <strong>next</strong></p>\n\n<p>It functions similarly to <code>break</code>, but returns control back to the top of the loop. It's great for creating flat control flow.</p>\n\n<p>For example</p>\n\n<pre><code>0.upto(100) do |i|\n  if i % 7 == 0\n    puts \"#{i} is a multiple of 7\"\n    next\n  end\n\n  puts i\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1526938635, "creation_date": 1526938635, "answer_id": 50456923, "question_id": 50455932, "link": "https://stackoverflow.com/questions/50455932/restarting-a-loop-from-the-top/50456923#50456923", "title": "Restarting a loop from the top", "body": "<p>It looks like you need a loop within a loop where you repeat one N times, the other M times:</p>\n\n<pre><code>MAXTEXT_COUNTER = 10\n\nputs \"hello, this will start\"\n\nloop do\n  MAXTEXT_COUNTER.times do\n    puts \"hello\"\n    sleep(2)\n  end\n\n  print \"ended test\"\n  sleep(7200)\nend\n</code></pre>\n\n<p>The outer loop is perpetual. The inner one runs a certain number of times and stops using the <code>times</code> method.</p>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 8759209, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AhiT4Z0WHsg/AAAAAAAAAAI/AAAAAAAAANk/8ZIAOkPCMA8/photo.jpg?sz=128", "display_name": "Artem Ignatiev", "link": "https://stackoverflow.com/users/8759209/artem-ignatiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1526945576, "creation_date": 1526945576, "answer_id": 50457824, "question_id": 50455932, "link": "https://stackoverflow.com/questions/50455932/restarting-a-loop-from-the-top/50457824#50457824", "title": "Restarting a loop from the top", "body": "<p>There is a <a href=\"http://rubyquicktips.com/post/1122838559/redo-vs-retry\" rel=\"nofollow noreferrer\"><code>retry</code> keyword</a> which repeats the loop from top, just what you've asked.</p>\n\n<p>Or you can wrap your loop into a method and continuously call that method.</p>\n"}], "owner": {"reputation": 1, "user_id": 9621245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8850f81413978a167d34e3ea43051a91?s=128&d=identicon&r=PG&f=1", "display_name": "DestroyedPixels", "link": "https://stackoverflow.com/users/9621245/destroyedpixels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1526959454, "creation_date": 1526933301, "last_edit_date": 1526959454, "question_id": 50455932, "link": "https://stackoverflow.com/questions/50455932/restarting-a-loop-from-the-top", "title": "Restarting a loop from the top", "body": "<p>I have the following:</p>\n\n<pre><code>text_counter = 0\nMAXTEXT_COUNTER = 10\nputs \"hello, this will start\"\nloop do\n  puts \"hello\"\n  text_counter += 1\n  sleep(2)\n  if text_counter &gt;= MAXTEXT_COUNTER\n    break\n  end\nend\nsleep(7200)\nprint \"ended test\"\n</code></pre>\n\n<p>Once the <code>break</code> has happened, how can I get it to start again from the top?</p>\n\n<p>I'm now thinking I could nest this loop in an <code>until</code> loop with the condition of <code>text_counter == 1000</code>. This would break, then sleep for 2 hours, then start again until it hits 1000.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form"], "comments": [{"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1526934310, "post_id": 50455700, "comment_id": 87925711, "body": "Everything worked fine when It wasn&#39;t used in a <code>simple_form</code>, So I&#39;m pretty sure it was (unless using this gem is altering something I don&#39;t know)."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1526935168, "post_id": 50455700, "comment_id": 87926074, "body": "I&#39;ve tried this out. The checkbox is centered in the text field and is the same height as it. It also highlights the border of the text field when I select the checkbox."}], "answers": [{"tags": [], "owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "is_accepted": true, "score": 2, "last_activity_date": 1526935231, "creation_date": 1526935231, "answer_id": 50456347, "question_id": 50455700, "link": "https://stackoverflow.com/questions/50455700/simple-form-remember-me-checkbox-in-ruby-on-rails/50456347#50456347", "title": "Simple_form :remember_me checkbox in ruby on rails", "body": "<p>simple_form provides a <code>boolean</code> helper (<a href=\"https://github.com/plataformatec/simple_form#available-input-types-and-defaults-for-each-column-type\" rel=\"nofollow noreferrer\">source</a>)<br>\nSo you just have to do :</p>\n\n<pre><code>&lt;%= f.input :remember_me, as: :boolean, inline_label: \"Remember me\", class: \"checkbox inline\" %&gt;\n</code></pre>\n\n<p>(assuming <code>remember_me</code> returns a boolean attribute)</p>\n"}], "owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 50456347, "answer_count": 1, "score": 1, "last_activity_date": 1526935231, "creation_date": 1526932191, "last_edit_date": 1526934473, "question_id": 50455700, "link": "https://stackoverflow.com/questions/50455700/simple-form-remember-me-checkbox-in-ruby-on-rails", "title": "Simple_form :remember_me checkbox in ruby on rails", "body": "<p>I have a <code>:remember_me</code> checkbox in the login form on my website. After writing the following code for the checkbox, it appears as a text input, not a checkbox. How would I turn this into a checkbox?</p>\n\n<pre><code>&lt;%= simple_form_for :session, url: login_path do |f| %&gt;\n  &lt;%= f.input :email, placeholder: \"Email Address\", class: \"form-control\" %&gt;\n  &lt;%= f.input :password, placeholder: \"Password\", class: \"form-control\" %&gt;\n  &lt;%= f.input :remember_me, inline_label: \"Remember me\", class: \"checkbox inline\" %&gt;\n  &lt;%= f.button :submit, \"log in\", class: \"btn btn-success btn-block login-bar\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In my <code>User.rb</code> file I have the following methods:</p>\n\n<pre><code>def remember\n  self.remember_token = User.new_token\n  update_attribute(:remember_digest, User.digest(remember_token))\nend\n\ndef forget\n  update_attribute(:remember_digest, nil)\nend\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "methods"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 2, "last_activity_date": 1526929982, "creation_date": 1526929982, "answer_id": 50455254, "question_id": 50455178, "link": "https://stackoverflow.com/questions/50455178/how-to-define-variable-outside-method-that-is-present-inside-method/50455254#50455254", "title": "How to define variable outside method that is present inside method?", "body": "<p>Make the method <em>return</em> the value, not <em>assign</em> it:</p>\n\n<pre><code>def sql(code)\n   client = Mysql2::Client.new(:username =&gt; 'buck19j')\n   client.query(code)\nend\n</code></pre>\n\n<p>Then assign a variable when you call the method:</p>\n\n<pre><code>results = sql('SHOW DATABASES')\nputs(results.to_a)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 2, "last_activity_date": 1526930024, "creation_date": 1526930024, "answer_id": 50455269, "question_id": 50455178, "link": "https://stackoverflow.com/questions/50455178/how-to-define-variable-outside-method-that-is-present-inside-method/50455269#50455269", "title": "How to define variable outside method that is present inside method?", "body": "<p><code>results</code> doesn't \"go out\" the sql method, because is a local variable. An approach would be to define it as an instance variable, and you could use then as you do with <code>puts</code> (still unclear what's the whole context of this).</p>\n\n<pre><code>def sql(code) \n  client = Mysql2::Client.new(:username =&gt; 'buck19j')\n  @results = client.query(code)\nend\n\nsql('SHOW DATABASES')\nputs(@results.to_a)\n</code></pre>\n\n<p>Other way would be just leave the function returns the <code>client.query(code)</code> value:</p>\n\n<pre><code>def sql(code) \n  client = Mysql2::Client.new(:username =&gt; 'buck19j')\n  client.query(code)\nend\n\nputs(sql('SHOW DATABASES').to_a)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9824692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeec7ddf6116d57e5fd0e4f4580c049a?s=128&d=identicon&r=PG&f=1", "display_name": "jbounc", "link": "https://stackoverflow.com/users/9824692/jbounc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 50455254, "answer_count": 2, "score": 0, "last_activity_date": 1526930024, "creation_date": 1526929649, "last_edit_date": 1526929855, "question_id": 50455178, "link": "https://stackoverflow.com/questions/50455178/how-to-define-variable-outside-method-that-is-present-inside-method", "title": "How to define variable outside method that is present inside method?", "body": "<p>I'm trying to create a method that allows me to query SQL in ruby without typing <code>results = client.query('code')</code> for every query. Heres my current method but it says that results are undefined in my puts statement. When I don't use my method it works normally.</p>\n\n<pre><code>require \"mysql2\" \nclient = Mysql2::Client.new(:username =&gt; 'buck19j')\n\n\ndef sql(code)\n   client = Mysql2::Client.new(:username =&gt; 'buck19j')\n   results = client.query(code)\nend\n\nsql('SHOW DATABASES')\nputs(results.to_a)\n</code></pre>\n\n<p>How to define variable outside method that is present inside method?</p>\n"}, {"tags": ["arrays", "ruby", "algorithm", "time-complexity"], "comments": [{"owner": {"reputation": 301, "user_id": 8759209, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AhiT4Z0WHsg/AAAAAAAAAAI/AAAAAAAAANk/8ZIAOkPCMA8/photo.jpg?sz=128", "display_name": "Artem Ignatiev", "link": "https://stackoverflow.com/users/8759209/artem-ignatiev"}, "edited": false, "score": 3, "creation_date": 1526928114, "post_id": 50454751, "comment_id": 87923010, "body": "Looks like you are trying to split the graph into connected components. I belive I have seen something you need in <a href=\"https://github.com/monora/rgl\" rel=\"nofollow noreferrer\">ruby graph library</a>"}, {"owner": {"reputation": 1969, "user_id": 5651536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e841ed95d19835d55d481e2678655df1?s=128&d=identicon&r=PG&f=1", "display_name": "John Ellmore", "link": "https://stackoverflow.com/users/5651536/john-ellmore"}, "edited": false, "score": 4, "creation_date": 1526928421, "post_id": 50454751, "comment_id": 87923142, "body": "A disjoint-set data structure would solve your problem in near-linear time: <a href=\"https://en.wikipedia.org/wiki/Disjoint-set_data_structure\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Disjoint-set_data_structure</a>. I&#39;m seeing numerous Ruby gems out there which implement it."}], "answers": [{"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 4, "last_activity_date": 1526931385, "last_edit_date": 1526931385, "creation_date": 1526930915, "answer_id": 50455472, "question_id": 50454751, "link": "https://stackoverflow.com/questions/50454751/take-an-array-of-pairs-of-strings-and-return-an-array-of-arrays-of-all-connected/50455472#50455472", "title": "Take an array of pairs of strings and return an array of arrays of all connected items", "body": "<p>You're lucky that disjoint-set is my favorite data structure. Here's a quick'n'dirty implementation:</p>\n\n<pre><code>pairs = [['alison', 'jason'], ['alison', 'chris'], ['john', 'bill'], ['bill', 'alex'], ['alex', 'jack'], ['steve', 'alex']]\n\nparents = {}\n\npairs.each do |x, y|\n  # each person starts as their own set, and their own representative\n  parents[x] ||= x\n  parents[y] ||= y\n\n  # find representative of x set\n  x_parent = parents[x]\n  loop do\n    break if parents[x_parent] == x_parent\n    x_parent = parents[x_parent]\n  end\n\n  # find representative of y set\n  y_parent = parents[y]\n  loop do\n    break if parents[y_parent] == y_parent\n    y_parent = parents[y_parent]\n  end\n\n  # union by changing y's representative\n  parents[y_parent] = x_parent\n  # path compression to speed up later unions\n  parents[x] = x_parent\n  parents[y] = x_parent\nend\n\n# group by set representative (some paths might not be compressed)\ngroups = parents.each_key.group_by do |person|\n  parent = parents[person]\n  loop do\n    break if parents[parent] == parent\n    parent = parents[parent]\n  end\n  parent\nend\n\np groups.values\n[[\"alison\", \"jason\", \"chris\"], [\"john\", \"bill\", \"alex\", \"jack\", \"steve\"]]\n</code></pre>\n\n<p>This is approximately O(N+M) where N is the number of people and M is the number of pairs. Notice the repetition e.g. in looking up a set's representative. The algorithm looks a lot cleaner if you define a proper class for doing the lookup.</p>\n\n<p>Also my path compression is not ideal, you can speed it up even more if you put the compression inside the representative lookup rather than the union.</p>\n"}], "owner": {"reputation": 59, "user_id": 9824506, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qVytqo64a4U/AAAAAAAAAAI/AAAAAAAAAWU/q8K_lR7dq5k/photo.jpg?sz=128", "display_name": "Raynor", "link": "https://stackoverflow.com/users/9824506/raynor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 50455472, "answer_count": 1, "score": 3, "last_activity_date": 1526959791, "creation_date": 1526927738, "last_edit_date": 1526959791, "question_id": 50454751, "link": "https://stackoverflow.com/questions/50454751/take-an-array-of-pairs-of-strings-and-return-an-array-of-arrays-of-all-connected", "title": "Take an array of pairs of strings and return an array of arrays of all connected items", "body": "<p>I have an array of pairs of names like:</p>\n\n<pre><code>[\n  ['alison', 'jason'],\n  ['alison', 'chris'],\n  ['john', 'bill'],\n  ['bill', 'alex'],\n  ['alex', 'jack']\n]\n</code></pre>\n\n<p>and I'm trying to write a method that can take this, and return </p>\n\n<pre><code>[\n  ['alison', 'jason', 'chris'],\n  ['john', 'bill', 'alex', 'jack']\n]\n</code></pre>\n\n<p>in better than O(N^2) time. My attempt at this was as so:</p>\n\n<pre><code>def teams(arr)\n  pair_hash = {}\n  arr.each do |pair|\n    if pair_hash[pair[0]].nil?\n      pair_hash[pair[0]] = [pair[1]]\n    else\n      pair_hash[pair[0]].push(pair[1])\n    end\n  end\n  teams = []\n  pair_hash.map do |leader, team|\n    teams.push(find_teammates(pair_hash, leader, team))\n  end\n  teams\nend\n\ndef find_teammates(hash, leader, team)\n  result = [leader]\n  team.each do |member|\n    if hash[member].nil?\n      result += [member]\n    else\n      result += find_teammates(hash, member, hash[member])\n    end\n  end\n  result\nend\n</code></pre>\n\n<p>but this solution has extra teams in the result, and every solution I can think of involves having really poor time complexity. If you have any idea how to solve this without just brute forcing through all the pairs, I'd love to know.</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 1948, "user_id": 8098236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7003b88799ae3c4d2faf4dbf20250521?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Rehwinkel", "link": "https://stackoverflow.com/users/8098236/ian-rehwinkel"}, "edited": false, "score": 0, "creation_date": 1526926885, "post_id": 50454558, "comment_id": 87922367, "body": "what output are you expecting?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1526927130, "post_id": 50454558, "comment_id": 87922473, "body": "Do you want <code>&quot;N8383&quot;.split(&#47;[(A-Z])&#47;) # =&gt; [&quot;&quot;, &quot;N&quot;, &quot;8383&quot;]</code>? I suspect not. See the doc for <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-split\" rel=\"nofollow noreferrer\">String#split</a> with respect to capture groups, but I&#39;m not sure you actually want to <code>split</code> here."}, {"owner": {"reputation": 964, "user_id": 922592, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677f7fdb87ded28ed533d8fd14b28a82?s=128&d=identicon&r=PG", "display_name": "Gregg Horton", "link": "https://stackoverflow.com/users/922592/gregg-horton"}, "edited": false, "score": 0, "creation_date": 1526927210, "post_id": 50454558, "comment_id": 87922519, "body": "I want <code>[&quot;N&quot;, &quot;8383&quot;]</code>"}, {"owner": {"reputation": 964, "user_id": 922592, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677f7fdb87ded28ed533d8fd14b28a82?s=128&d=identicon&r=PG", "display_name": "Gregg Horton", "link": "https://stackoverflow.com/users/922592/gregg-horton"}, "edited": false, "score": 0, "creation_date": 1526927237, "post_id": 50454558, "comment_id": 87922532, "body": "what would you suggest instead?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1526927341, "post_id": 50454558, "comment_id": 87922585, "body": "Is this the only case? You could use <code>&quot;N8383&quot;.split(&#47;(?&lt;=[A-Z])&#47;)</code> this is a non capturing group that will split between &quot;N&quot; and &quot;8383&quot; but if there are more cases, edge cases, etc. we would need to know as this only applies to a single character <code>[A-Z]</code> followed by any characters that are not <code>[A-Z]</code>"}, {"owner": {"reputation": 964, "user_id": 922592, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677f7fdb87ded28ed533d8fd14b28a82?s=128&d=identicon&r=PG", "display_name": "Gregg Horton", "link": "https://stackoverflow.com/users/922592/gregg-horton"}, "edited": false, "score": 0, "creation_date": 1526927516, "post_id": 50454558, "comment_id": 87922669, "body": "In this case I want to support strings that could be <code>N8383</code> or <code>8383N</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1526927690, "post_id": 50454558, "comment_id": 87922771, "body": "@GreggHorton that is very important. Add this to your question. Preferably with a small set of Input -&gt; output expectations. e.g. <code>&quot;N8383&quot; =&gt; [&quot;N&quot;, &quot;8383&quot;]</code> and <code>&quot;8383N&quot; =&gt; [&quot;8383&quot;,&quot;N&quot;]</code> (more examples would be better especially if anything does not / might not match this pattern"}], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 3, "last_activity_date": 1526929120, "last_edit_date": 1526929120, "creation_date": 1526928405, "answer_id": 50454897, "question_id": 50454558, "link": "https://stackoverflow.com/questions/50454558/how-to-split-on-a-character-and-keep-value/50454897#50454897", "title": "How to split on a character and keep value", "body": "<p>Okay given the examples you could use the following regex </p>\n\n<pre><code>   /(?=[A-Z])|(?&lt;=[A-Z])/\n</code></pre>\n\n<p>This will look look ahead (<code>?=</code>) for a single character <code>[A-Z]</code> or look behind (<code>?&lt;=</code>) for a single character <code>[A-Z]</code>. Since these are zero length assertions the split is placed between the characters rather than being the character. e.g.</p>\n\n<pre><code>  %w{N8383 N344 344N S555 555S}.map {|s| s.split(/(?=[A-Z])|(?&lt;=[A-Z])/) } \n  #=&gt; [[\"N\", \"8383\"], [\"N\", \"344\"], [\"344\", \"N\"], [\"S\", \"555\"], [\"555\", \"S\"]]\n</code></pre>\n\n<p>However this regex is specific to the given cases and does not offer any real deviation from the given cases e.g I have no idea of desired output for \"N344S\" but right now it will be <code>[\"N\", \"344\" ,\"S\"]</code> and worse yet <code>\"NSS344S\"</code> will be <code>[\"N\", \"S\", \"S\", \"344\", \"S\"]</code></p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1526929727, "post_id": 50455108, "comment_id": 87923689, "body": "I wonder if order is important? since &quot;S555&quot; AND &quot;555S&quot; produce the same results in this case. I would assume your answer is better after having re read the question"}, {"owner": {"reputation": 964, "user_id": 922592, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677f7fdb87ded28ed533d8fd14b28a82?s=128&d=identicon&r=PG", "display_name": "Gregg Horton", "link": "https://stackoverflow.com/users/922592/gregg-horton"}, "edited": false, "score": 0, "creation_date": 1526930567, "post_id": 50455108, "comment_id": 87924048, "body": "thank you so much! this is exactly what I was looking for and allows me to use the characters and numbers later in a way that makes sense."}], "tags": [], "owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "is_accepted": true, "score": 4, "last_activity_date": 1526930922, "last_edit_date": 1526930922, "creation_date": 1526929419, "answer_id": 50455108, "question_id": 50454558, "link": "https://stackoverflow.com/questions/50454558/how-to-split-on-a-character-and-keep-value/50455108#50455108", "title": "How to split on a character and keep value", "body": "<p><code>String#split</code> is a bad fit for this problem for the reasons others have stated. I would approach it like this, using <a href=\"https://ruby-doc.org/core-2.5.1/String.html#method-i-scan\" rel=\"nofollow noreferrer\"><code>String#scan</code></a> instead:</p>\n\n<pre><code>str_parts = \"N8383\".scan(/[[:alpha:]]+/)\nnum_parts = \"N8383\".scan(/[[:digit:]]+/)\n</code></pre>\n\n<p>This will give you something to work with if the strings contain multiple string parts and/or multiple numeric parts. </p>\n\n<p>This expression:</p>\n\n<pre><code>%w[N344 344N S555 555S].map do |str|\n  next str.scan(/[[:alpha:]]+/), str.scan(/[[:digit:]]+/)\nend \n</code></pre>\n\n<p>Will return:</p>\n\n<pre><code>[\n  [[\"N\"], [\"344\"]],\n  [[\"N\"], [\"344\"]],\n  [[\"S\"], [\"555\"]],\n  [[\"S\"], [\"555\"]]\n]\n</code></pre>\n\n<p>Although you are scanning each string twice, I think it's a better solution than 1. trying to come up with a complex regex that backtracks to return the parts in the right order, or 2. reprocessing the results to put the parts in the right order. Especially if the strings are as short as they are in the examples you've provided. That being said, if scanning each string twice really rankles you, here's another way to do it:</p>\n\n<pre><code>str_parts, num_parts = str.scan(/([[:alpha:]]+)|([[:digit:]]+)/).transpose.each(&amp;:compact!)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1526935974, "last_edit_date": 1526935974, "creation_date": 1526931986, "answer_id": 50455662, "question_id": 50454558, "link": "https://stackoverflow.com/questions/50454558/how-to-split-on-a-character-and-keep-value/50455662#50455662", "title": "How to split on a character and keep value", "body": "<pre><code>def doit(str)\n str.scan(/\\d+|\\p{L}+/)\nend\n\ndoit \"N123\"   #=&gt; [\"N\", \"123\"]\ndoit \"123N\"   #=&gt; [\"123\", \"N\"]\ndoit \"N123M\"  #=&gt; [\"N\", \"123\", \"M\"]\ndoit \"N12M3P\" #=&gt; [\"N\", \"12\", \"M\", \"3\", \"P\"]\ndoit \"123\"    #=&gt; [\"123\"]\ndoit \"NMN\"    #=&gt; [\"NMN\"]\ndoit \"\"       #=&gt; []\n</code></pre>\n"}], "owner": {"reputation": 964, "user_id": 922592, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677f7fdb87ded28ed533d8fd14b28a82?s=128&d=identicon&r=PG", "display_name": "Gregg Horton", "link": "https://stackoverflow.com/users/922592/gregg-horton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 50455108, "answer_count": 3, "score": 1, "last_activity_date": 1526960341, "creation_date": 1526926823, "last_edit_date": 1526960341, "question_id": 50454558, "link": "https://stackoverflow.com/questions/50454558/how-to-split-on-a-character-and-keep-value", "title": "How to split on a character and keep value", "body": "<p>I have a string:</p>\n\n<p>\"N8383\"</p>\n\n<p>I want to split on the character and maintain it to get:</p>\n\n<pre><code>[\"N\", \"8383\"]\n</code></pre>\n\n<p>I tried the following: </p>\n\n<pre><code>\"N8383\".split(/[A-Z]/)\n</code></pre>\n\n<p>which gives me:</p>\n\n<pre><code>[\"\", \"8383\"]\n</code></pre>\n\n<p>I want to match some more example strings like:</p>\n\n<pre><code>N344 344N S555 555S\n</code></pre>\n"}]