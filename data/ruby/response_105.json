[{"tags": ["ruby-on-rails", "ruby", "string-interpolation"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1484180065, "post_id": 41602934, "comment_id": 70408652, "body": "Are you getting errors? The backslash doesn&#39;t seem like it should cause you problems as it&#39;s just an escape character, not a proper character in the string."}, {"owner": {"reputation": 69, "user_id": 7016424, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/roLXv.jpg?s=128&g=1", "display_name": "Lego Astronaut ", "link": "https://stackoverflow.com/users/7016424/lego-astronaut"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1484224525, "post_id": 41602934, "comment_id": 70427967, "body": "@jvillian Thanks, I was not getting any errors."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7016424, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/roLXv.jpg?s=128&g=1", "display_name": "Lego Astronaut ", "link": "https://stackoverflow.com/users/7016424/lego-astronaut"}, "edited": false, "score": 0, "creation_date": 1484224437, "post_id": 41603768, "comment_id": 70427886, "body": "Thanks Max! I really appreciate it! :)"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 0, "last_activity_date": 1484185232, "creation_date": 1484185232, "answer_id": 41603768, "question_id": 41602934, "link": "https://stackoverflow.com/questions/41602934/interacting-programmatically-with-the-equivalent-of-puts-ruby/41603768#41603768", "title": "Interacting programmatically with the equivalent of puts -ruby", "body": "<p>These two are equivalent:</p>\n\n<pre><code># double quotes\n\"first=\\#{first_name}&amp;last=\\#{last_name}\"\n\n# single quotes\n'first=#{first_name}&amp;last=#{last_name}'\n</code></pre>\n\n<p>In neither case is the backslash actually part of the string. If say <code>string.include? '\\'</code> it will return false.</p>\n\n<p>However, if you were to say <code>'\\#{}'</code> the backslash would be part of the string. That's because in single quotes, <code>#{}</code> does not interpolate but is interpreted as literal characters.</p>\n\n<p>Some example:</p>\n\n<pre><code>foo = 1\n'#{foo}' # =&gt; \"\\#{foo}\"\n\"#{foo}\" # =&gt; \"1\"\n'#{foo}' == \"\\#{foo}\" # =&gt; true\n\"\\#{foo}\".include? '\\' # =&gt; false\n'\\#{foo}'.include? '\\' # =&gt; true\n</code></pre>\n\n<p>Note that <code>\"\\\"</code> is an invalid string in ruby, but <code>'\\'</code> is valid.</p>\n"}], "owner": {"reputation": 69, "user_id": 7016424, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/roLXv.jpg?s=128&g=1", "display_name": "Lego Astronaut ", "link": "https://stackoverflow.com/users/7016424/lego-astronaut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 41603768, "answer_count": 1, "score": 0, "last_activity_date": 1484185232, "creation_date": 1484179129, "question_id": 41602934, "link": "https://stackoverflow.com/questions/41602934/interacting-programmatically-with-the-equivalent-of-puts-ruby", "title": "Interacting programmatically with the equivalent of puts -ruby", "body": "<p>I have a string, that I need to save escaped and then need to interact with programmatically without any backspaces:</p>\n\n<pre><code>    string = 'first=#{first_name}&amp;last=#{last_name}'\n\n    p string.to_s\n\n=&gt; \"first=\\#{first_name}&amp;last=\\#{last_name}\"\n\n    puts string.to_s\n\n=&gt; first=#{first_name}&amp;last=#{last_name}\n</code></pre>\n\n<p>How do I get first=#{first_name}&amp;last=#{last_name} to assign to a variable that I can scan, that does not have the \"\\\" character?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash", "each"], "answers": [{"tags": [], "owner": {"reputation": 1624, "user_id": 2912211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059632598/picture?type=large", "display_name": "Zzz", "link": "https://stackoverflow.com/users/2912211/zzz"}, "is_accepted": false, "score": 3, "last_activity_date": 1484178723, "creation_date": 1484178723, "answer_id": 41602877, "question_id": 41602708, "link": "https://stackoverflow.com/questions/41602708/how-to-add-string-into-hash-with-each/41602877#41602877", "title": "How to add string into Hash with each", "body": "<p><code>y</code> is an array, therefore in the block <code>key</code> is the item itself ('one', 'two'), and value is always nil.</p>\n\n<p>You can convert an array to hash using splat operator <code>*</code></p>\n\n<p><code>Hash[*y]</code></p>\n"}, {"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1484181392, "post_id": 41602921, "comment_id": 70408992, "body": "Actually @Zhong Zheng&#39;s answer is more elegant. My solution&#39;s good if for some reason you&#39;re set on using each (or each_slice) methods and is perhaps useful for educational purposes, but in the real world <code>Hash[*y]</code> is cleaner."}], "tags": [], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "is_accepted": true, "score": 0, "last_activity_date": 1484179072, "creation_date": 1484179072, "answer_id": 41602921, "question_id": 41602708, "link": "https://stackoverflow.com/questions/41602708/how-to-add-string-into-hash-with-each/41602921#41602921", "title": "How to add string into Hash with each", "body": "<p>A bit faster way of doing it:</p>\n\n<pre><code>x=\"one two\"\nHash[[x.split]]\n</code></pre>\n\n<p>If you're looking for a more general solution where x could have more elements, consider something like this:</p>\n\n<pre><code>hash = {}\nx=\"one two three four\"\nx.split.each_slice(2) do |key, value| # each_slice(n) pulls the next n elements from an array\n  hash[key] = value\nend\n\nhash\n</code></pre>\n\n<p>Or, if you're really feeling fancy, try using inject:</p>\n\n<pre><code>x=\"one two three four\"\nx.split.each_slice(2).inject({}) do |memo, (key, value)|\n  memo[key] = value\n  memo\nend\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7087412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69dcaacf474db71bbf61b5909d3cff1d?s=128&d=identicon&r=PG&f=1", "display_name": "Ciechan", "link": "https://stackoverflow.com/users/7087412/ciechan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 41602921, "answer_count": 2, "score": 1, "last_activity_date": 1484179072, "creation_date": 1484177515, "question_id": 41602708, "link": "https://stackoverflow.com/questions/41602708/how-to-add-string-into-hash-with-each", "title": "How to add string into Hash with each", "body": "<pre><code>x = \"one two\"\ny = x.split\n\nhash = {}\n\ny.each do |key, value|\n  hash[key] = value\nend\nprint hash\n</code></pre>\n\n<p>The result of this is: one=> nil, two => nil</p>\n\n<p>I want to make \"one\" - key, and \"two\" - value, but how to do this? </p>\n\n<p>It may look like this:  \"one\" => \"two\" </p>\n"}, {"tags": ["ruby", "lookup", "method-missing"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484177441, "post_id": 41602673, "comment_id": 70407814, "body": "You&#39;re bubbling up through to Object, and at that point calling <code>super</code> will give you a NoMethodError."}, {"owner": {"reputation": 1, "user_id": 7404395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/541e384772b4bbce27a423089393fc6d?s=128&d=identicon&r=PG&f=1", "display_name": "rublen", "link": "https://stackoverflow.com/users/7404395/rublen"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484220919, "post_id": 41602673, "comment_id": 70425589, "body": "I suppose it&#39;s a problem of environment, I tried it in the codepad.io. Can it be? With Command Prompt with Ruby (Windows) it works nice."}], "owner": {"reputation": 1, "user_id": 7404395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/541e384772b4bbce27a423089393fc6d?s=128&d=identicon&r=PG&f=1", "display_name": "rublen", "link": "https://stackoverflow.com/users/7404395/rublen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484177274, "creation_date": 1484177274, "question_id": 41602673, "link": "https://stackoverflow.com/questions/41602673/ruby-2-3-3-exploring-method-lookup", "title": "Ruby 2.3.3: exploring method lookup", "body": "<p>I have a challenge: to explore how method lookup works in Ruby. Here\u2019s experimental code:</p>\n\n<pre><code>class Object\n  def method_missing(*args)\n    @count = @count.to_i + 1\n    puts \"Object: #{ @count }\"\n    super\n  end\nend\n\nmodule Module1\n  def method_missing(*args)\n    puts 'Module1'\n    super\n  end\nend\n\nmodule Module2\n  def method_missing(*args)\n    puts 'Module2'\n    super\n  end\nend\n\nmodule Module3\n  def method_missing(*args)\n    puts 'Module3'\n    super\n  end\nend\n\nclass Class1\n  include Module1\n\n  def method_missing(*args)\n    puts 'Class1'\n    super\n  end\nend\n\nclass Class2 &lt; Class1\n  include Module3\n  include Module2\n\n  def method_missing(*args)\n    puts 'Class2'\n    super\n  end\nend\n\ntest_obj = Class2.new\ntest_obj.testrun # non existing method\n</code></pre>\n\n<p>In Ruby 2.3.0 it seems works normally. But in Ruby 2.3.3 it has odd output with loops. Even if I comment two last lines (#test_obj = Class2.new and #test_obj.testrun) it will have looping in output, though must have nothing. Help to find the cause of problem, please.</p>\n"}, {"tags": ["ruby", "associations"], "answers": [{"tags": [], "owner": {"reputation": 2188, "user_id": 1489914, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/7PReX.jpg?s=128&g=1", "display_name": "Tall Paul", "link": "https://stackoverflow.com/users/1489914/tall-paul"}, "is_accepted": true, "score": 1, "last_activity_date": 1484179571, "creation_date": 1484179571, "answer_id": 41603000, "question_id": 41602601, "link": "https://stackoverflow.com/questions/41602601/how-to-pull-a-specific-field-from-a-ruby-associations-collectionproxy/41603000#41603000", "title": "How to pull a specific field from a Ruby Associations CollectionProxy?", "body": "<p>So this is basically an array of hobbies that gets attached to the user. so you need to iterate over each one and then ask for the attribute you want from it. Try something like this:</p>\n\n<pre><code>&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;User&lt;/th&gt;\n    &lt;th&gt;Hobby&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;% @users.each do |user| %&gt;\n  &lt;tr&gt;\n     &lt;td&gt;&lt;%= user.name %&gt;&lt;/td&gt;\n     &lt;td&gt;\n       &lt;% user.hobbies.each do |hobby| %&gt;\n         &lt;%= hobby.attribute_name %&gt;,\n       &lt;% end %&gt;\n     &lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>If you want to get real fancy you could try doing something like this:</p>\n\n<pre><code>&lt;% user.hobbies.each_with_index do |hobby, index| %&gt;\n   &lt;%= hobby.attribute_name %&gt;\n   &lt;%= (index == user.hobbies.length-1) ? '' : ','\n&lt;% end %&gt; \n</code></pre>\n\n<p>That is using a ternary operator to basically say only put a comma if the hobby is not the last hobby</p>\n"}], "owner": {"reputation": 173, "user_id": 4933098, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ec3ab3be25ee9c09b825139c9578804?s=128&d=identicon&r=PG&f=1", "display_name": "MLZ", "link": "https://stackoverflow.com/users/4933098/mlz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 41603000, "answer_count": 1, "score": 0, "last_activity_date": 1484179571, "creation_date": 1484176924, "question_id": 41602601, "link": "https://stackoverflow.com/questions/41602601/how-to-pull-a-specific-field-from-a-ruby-associations-collectionproxy", "title": "How to pull a specific field from a Ruby Associations CollectionProxy?", "body": "<p>I have the following models:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_many :hobbies, dependent: :destroy\nend\n\nclass Hobby &lt; ApplicationRecord\n  belongs_to :user\nend\n</code></pre>\n\n<p>I was trying to output to my view the user and its hobbies:</p>\n\n<pre><code>&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;User&lt;/th&gt;\n    &lt;th&gt;Hobby&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;% @users.each do |u| %&gt;\n  &lt;tr&gt;\n     &lt;td&gt;&lt;%= u.name %&gt;&lt;/td&gt;\n     &lt;td&gt;&lt;%= u.hobbies %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>But I see the following: </p>\n\n<pre><code>User    Hobby\nMad Max &lt;Hobby::ActiveRecord_Associations_CollectionProxy:0x007fa2721ab910&gt;\n</code></pre>\n\n<p>It looks like I am outputting the collection, but I want the actual hobby name.  I have tried u.hobbies.first, u.hobbies[:hobby], etc. I've looked inside <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Associations/CollectionProxy.html\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/classes/ActiveRecord/Associations/CollectionProxy.html</a> but it's abit confusing for me as a new developer. Can someone tell me how to pull from a specific field from the collection? And which resource out there is a good guide for me to reference in the future?</p>\n"}, {"tags": ["ruby", "struct"], "answers": [{"comments": [{"owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "edited": false, "score": 0, "creation_date": 1484179584, "post_id": 41602880, "comment_id": 70408491, "body": "Ok, that makes sense. However, I&#39;m still not sure how to get the keyword arguments to work. I can pass in two hashes ie <code>MyStruct.new({fname: &#39;first&#39;}, {lname: &#39;last&#39;})</code> but that will give me a hash to work with rather than a string."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "edited": false, "score": 0, "creation_date": 1492741090, "post_id": 41602880, "comment_id": 74118037, "body": "I seemed to have missed your 3-month-old comment. <code>my_struct = MyStruct.new({fname: &#39;first&#39;}, {lname: &#39;last&#39;}); my_struct.fname #=&gt;  {:fname=&gt;&quot;first&quot;}; my_struct.lname #=&gt; {:lname=&gt;&quot;last&quot;}</code>. Does that answer your question?"}, {"owner": {"reputation": 387, "user_id": 3189203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0c575af9cc91c1cbd528ca3bd72ec8?s=128&d=identicon&r=PG", "display_name": "rohitpaulk", "link": "https://stackoverflow.com/users/3189203/rohitpaulk"}, "edited": false, "score": 1, "creation_date": 1506507143, "post_id": 41602880, "comment_id": 79846056, "body": "I wrote a gem (<a href=\"https://github.com/rohitpaulk/named_struct\" rel=\"nofollow noreferrer\">github.com/rohitpaulk/named_struct</a>) that defines a <code>NamedStruct</code> class that inherits from Struct, and changes the initialization behavior to accept keyword arguments instead."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1484179691, "last_edit_date": 1495542351, "creation_date": 1484178750, "answer_id": 41602880, "question_id": 41602448, "link": "https://stackoverflow.com/questions/41602448/initializing-ruby-structs-with-keyword-arguments/41602880#41602880", "title": "Initializing Ruby Structs with Keyword arguments", "body": "<pre><code>my_struct = MyStruct.new(fname: 'first', lname: 'last')\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>my_struct = MyStruct.new({ fname: 'first', lname: 'last' })\n  #=&gt; #&lt;struct MyStruct fname={:fname=&gt;\"first\", :lname=&gt;\"last\"}, lname=nil&gt;\n</code></pre>\n\n<p>(one argument) so <code>fname</code> is set equal to the argument and <code>lname</code> is set to <code>nil</code>, in the same way that <code>x, y = [2]; x #=&gt; 2; y #=&gt; nil</code>.</p>\n\n<p>This is because Ruby allows one to omit the braces when a hash is the argument of a method.</p>\n\n<p>You may wish to search SO for related questions such as <a href=\"https://stackoverflow.com/questions/5407940/named-parameters-in-ruby-structs\">this one</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1916, "user_id": 89082, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ed77c0d1c8da409c4f69f67f934ff0bb?s=128&d=identicon&r=PG", "display_name": "Martinos", "link": "https://stackoverflow.com/users/89082/martinos"}, "is_accepted": false, "score": 13, "last_activity_date": 1520995461, "creation_date": 1520995461, "answer_id": 49268979, "question_id": 41602448, "link": "https://stackoverflow.com/questions/41602448/initializing-ruby-structs-with-keyword-arguments/49268979#49268979", "title": "Initializing Ruby Structs with Keyword arguments", "body": "<p>With Ruby 2.5, you can set the <code>keyword_init</code> option to <code>true</code>.</p>\n\n<pre><code>MyStruct = Struct.new(:fname, :lname, keyword_init: true)\n# =&gt; MyStruct(keyword_init: true)\nirb(main):002:0&gt; my_struct = MyStruct.new(fname: 'first', lname: 'last')\n# =&gt; #&lt;struct MyStruct fname=\"first\", lname=\"last\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2011, "favorite_count": 1, "answer_count": 2, "score": 8, "last_activity_date": 1520995461, "creation_date": 1484176274, "question_id": 41602448, "link": "https://stackoverflow.com/questions/41602448/initializing-ruby-structs-with-keyword-arguments", "title": "Initializing Ruby Structs with Keyword arguments", "body": "<p>Ruby version: 2.3.1</p>\n\n<p>It does not appear that Ruby Structs can be declared using keyword params. Is there a way to do this within <code>Struct</code>?</p>\n\n<p>Example:</p>\n\n<pre><code>MyStruct = Struct.new(:fname, :lname)\n=&gt; MyStruct\n\nmy_struct = MyStruct.new(fname: 'first', lname: 'last')\n=&gt; &lt;struct MyStruct fname={:fname=&gt;\"first\", :lname=&gt;\"last\"}, lname=nil&gt;\n\nmy_struct.fname\n=&gt; {:fname=&gt;\"first\", :lname=&gt;\"last\"}\n\nmy_struct.lname\n=&gt; nil\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "installation", "rbenv"], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 6400294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KtX2z.jpg?s=128&g=1", "display_name": "Shannon", "link": "https://stackoverflow.com/users/6400294/shannon"}, "is_accepted": true, "score": 0, "last_activity_date": 1484176455, "creation_date": 1484176455, "answer_id": 41602494, "question_id": 41602313, "link": "https://stackoverflow.com/questions/41602313/error-with-ruby-update/41602494#41602494", "title": "Error with ruby update", "body": "<p>Is this on OS X? You can try removing <code>\"$(rbenv init -)\"</code> from your <code>~/.bash_profile</code></p>\n"}, {"tags": [], "owner": {"reputation": 1310, "user_id": 2618036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb602439c78c24083769286e12fbb2a?s=128&d=identicon&r=PG", "display_name": "georger", "link": "https://stackoverflow.com/users/2618036/georger"}, "is_accepted": false, "score": 0, "last_activity_date": 1507152442, "creation_date": 1507152442, "answer_id": 46574475, "question_id": 41602313, "link": "https://stackoverflow.com/questions/41602313/error-with-ruby-update/46574475#46574475", "title": "Error with ruby update", "body": "<p>If you are using <code>brew</code> you can do <code>brew link --overwrite ruby</code> and it should fix it. There might be some broken symlinks.</p>\n"}], "owner": {"reputation": 151, "user_id": 5895163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313a66c26f44cd04a91c34690613192a?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/5895163/benjamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 0, "accepted_answer_id": 41602494, "answer_count": 2, "score": 0, "last_activity_date": 1507152442, "creation_date": 1484175677, "last_edit_date": 1484182219, "question_id": 41602313, "link": "https://stackoverflow.com/questions/41602313/error-with-ruby-update", "title": "Error with ruby update", "body": "<p>I tried to update my ruby and rails version. But I ended up with this error:</p>\n\n<pre><code>~ ruby -v\n/Users/Benjamin/.rbenv/shims/ruby: line 21: /usr/local/Cellar/rbenv/1.1.0/libexec/rbenv:\nNo such file or directory\n</code></pre>\n\n<p>Is there anything I can do to fix this?</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe", "fog"], "comments": [{"owner": {"reputation": 72198, "user_id": 256618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbfec69b120650860f555af29ee8a974?s=128&d=identicon&r=PG", "display_name": "Mark O&#39;Connor", "link": "https://stackoverflow.com/users/256618/mark-oconnor"}, "edited": false, "score": 1, "creation_date": 1484265286, "post_id": 41602213, "comment_id": 70451523, "body": "see: <a href=\"https://github.com/berkshelf/ridley\" rel=\"nofollow noreferrer\">github.com/berkshelf/ridley</a>"}, {"owner": {"reputation": 324, "user_id": 2881055, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8169d2d8a50adcf5e923478713260887?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/2881055/ram"}, "reply_to_user": {"reputation": 72198, "user_id": 256618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbfec69b120650860f555af29ee8a974?s=128&d=identicon&r=PG", "display_name": "Mark O&#39;Connor", "link": "https://stackoverflow.com/users/256618/mark-oconnor"}, "edited": false, "score": 0, "creation_date": 1484285104, "post_id": 41602213, "comment_id": 70456255, "body": "Thank you mark. That&#39;s what I need."}], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 1, "last_activity_date": 1484183928, "creation_date": 1484183928, "answer_id": 41603593, "question_id": 41602213, "link": "https://stackoverflow.com/questions/41602213/how-to-create-chef-data-bags-from-ruby-application/41603593#41603593", "title": "How to create chef data bags from ruby application", "body": "<p>Use the chef-api gem. It has examples on how to do this if you poke around a bit but it's pretty much what you would expect.</p>\n"}], "owner": {"reputation": 324, "user_id": 2881055, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8169d2d8a50adcf5e923478713260887?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/2881055/ram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 41603593, "answer_count": 1, "score": 1, "last_activity_date": 1484183928, "creation_date": 1484175209, "question_id": 41602213, "link": "https://stackoverflow.com/questions/41602213/how-to-create-chef-data-bags-from-ruby-application", "title": "How to create chef data bags from ruby application", "body": "<p>We have a ruby fog application which creates instances in AWS and we have a cookbook which installs and configures a service and creates the users using chef data bags.</p>\n\n<p>For now we are creating the data bags and role files manually and we want to automate this with our ruby application which creates instances, installs and configures chef client and runs the cookbook and I don't to use knife commands. </p>\n\n<p>what is the best way to create the data bags and role files after the instance is created? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1484174028, "post_id": 41601769, "comment_id": 70406598, "body": "Instead of <code>where(...).first</code> you can do <code>find_by(...)</code> with the same conditions."}], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1484178157, "creation_date": 1484178157, "answer_id": 41602798, "question_id": 41601769, "link": "https://stackoverflow.com/questions/41601769/how-do-i-merge-parent-array-and-one-child-with-different-attribute/41602798#41602798", "title": "How do I merge parent array and one child with different attribute?", "body": "<p>The following is not necessarily performant as it builds an array instead of an ActiveRecord relation.</p>\n\n<pre><code>@ativity_list = (@user.comments + @user.votes.up).sort{|x,y| x.created_at &lt;=&gt; y.created_at}.map{|x| x.is_a?(Vote) ? x.votable : x}\n</code></pre>\n\n<p><code>(@user.comments + @user.votes.up)</code> returns an array of comments and votes.</p>\n\n<p><code>#sort{|x,y| x.created_at &lt;=&gt; y.created_at}</code> uses an array sort on <code>created_at</code> field</p>\n\n<p><code>#map{|x| x.is_a?(Vote) ? x.votable : x}</code> changes the array from a comments / vote set to a comments / voted on set</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6107987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 41602798, "answer_count": 1, "score": 0, "last_activity_date": 1484178157, "creation_date": 1484173214, "last_edit_date": 1484175327, "question_id": 41601769, "link": "https://stackoverflow.com/questions/41601769/how-do-i-merge-parent-array-and-one-child-with-different-attribute", "title": "How do I merge parent array and one child with different attribute?", "body": "<p>I have comments and likes (acts_as_votable gem). I want to create one activity list and sort by <code>created_at</code> for comments and <code>updated_at</code> for votes.</p>\n\n<pre><code>@activity_list = (@user.comments + @user.find_up_voted_items)\n</code></pre>\n\n<p><code>@user.find_up_voted_items</code> - it's not likes, but liked elements.</p>\n\n<p>I can find <code>updated_at</code> time for vote using this code:</p>\n\n<pre><code>@post.votes_for.up.where(voter_id: @user.id).first.updated_at\n</code></pre>\n\n<p>How I can merge and sort it correctly?</p>\n"}, {"tags": ["ruby", "testing", "rspec", "sinatra"], "answers": [{"tags": [], "owner": {"reputation": 45754, "user_id": 17410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1022b779bdc1ddef7cd9d29abd70ed15?s=128&d=identicon&r=PG", "display_name": "zetetic", "link": "https://stackoverflow.com/users/17410/zetetic"}, "is_accepted": false, "score": 0, "last_activity_date": 1484174576, "creation_date": 1484174576, "answer_id": 41602078, "question_id": 41601741, "link": "https://stackoverflow.com/questions/41601741/test-production-specific-code-with-rspec-sinatra/41602078#41602078", "title": "Test production specific code with rspec - Sinatra", "body": "<p>You could break out the code in the body of the <code>configure</code> block into one or methods that take the environment value as an argument, then write a separate test for those methods. However, I would advise against complicating the code if the only goal is to get to 100% coverage.</p>\n"}], "owner": {"reputation": 11, "user_id": 7406882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c49014846d915d40e34202f9b92693b?s=128&d=identicon&r=PG&f=1", "display_name": "Joel Chapman", "link": "https://stackoverflow.com/users/7406882/joel-chapman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484174576, "creation_date": 1484173135, "question_id": 41601741, "link": "https://stackoverflow.com/questions/41601741/test-production-specific-code-with-rspec-sinatra", "title": "Test production specific code with rspec - Sinatra", "body": "<p>I have this code to configure logging for production and test/development environments:</p>\n\n<pre><code>class ApplicationController &lt; Sinatra::Base\n  configure :development, :test do\n    enable :logging\n    file = File.new(\"#{settings.root}/../../log/#{settings.environment}.log\", 'a+')\n    file.sync = true\n    use Rack::CommonLogger, file\n  end\n\n\n  configure :production do\n    enable :logging\n    log_file = File.new(\"#{settings.root}/../../log/#{settings.environment}.log\", 'a+')\n\n    STDOUT.reopen(log_file)\n    STDERR.reopen(log_file)\n\n    STDOUT.sync = true\n    STDERR.sync = true\n  end\nend\n</code></pre>\n\n<p>The issue being simplecov is stating I'm not testing the production block as I'm setting my environment to be 'test' within my spec_helper file.</p>\n\n<p>Is there a way to test both 'test' and 'production' code with rspec?</p>\n"}, {"tags": ["ruby", "web-scraping", "capybara", "poltergeist"], "answers": [{"comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1484172688, "post_id": 41601505, "comment_id": 70406020, "body": "Are you waiting a little bit after clicking the link to check the new url so the browser has time for it to occur?  Are you expecting the url of the current window to change, or is the new url opening in the new window?"}, {"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1484173911, "post_id": 41601505, "comment_id": 70406551, "body": "@ThomasWalpole I wait 10 seconds before and after clicking the link (see updated question), but <code>current_url</code> reports the same value. I&#39;d like to know url of the page in the first window (the second window becomes current). That is, url of the initial window changes (and I can&#39;t get to it), but also new window appears at another url, and becomes current."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1484174050, "post_id": 41601505, "comment_id": 70406609, "body": "Huh?  Capybara doesn&#39;t shift the window it&#39;s communicating with without you telling it to.  Are you saying the new URL opens in a new window and that&#39;s where you want to get the url from?"}, {"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1484174110, "post_id": 41601505, "comment_id": 70406632, "body": "Yep, second window becomes current (<code>firefox</code>). And I want new url of the initial window. Maybe the javascript code running on the site makes new window current, not sure about that."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1484174346, "post_id": 41601505, "comment_id": 70406713, "body": "If you want the url of the initial window (the one where you clicked) then what you&#39;re doing should be correct - If you want the url of the new window that opens then it would be something like  <code>within_window(window_opened_by { first(&#39;#some-id&#39;).click })  { p current_url } )</code>  otherwise I&#39;m confused"}, {"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1484174921, "post_id": 41601505, "comment_id": 70406924, "body": "Feel free to try it yourself: <code>visit(&#39;https:&#47;&#47;www.tripadvisor.com&#47;Attraction_Review-g106645&zwnj;&#8203;7-d479258-Reviews-Sh&zwnj;&#8203;injuku_Gyoen_Nationa&zwnj;&#8203;l_Garden-Shinjuku_To&zwnj;&#8203;kyo_Tokyo_Prefecture&zwnj;&#8203;_Kanto.html&#39;); ...; find(&#39;#ABOVE_THE_FOLD .map_and_listing .detail_section.info .contact_info .taLnk&#39;).click</code>"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1484176374, "post_id": 41601505, "comment_id": 70407440, "body": "Got it working -- the original windows URL appears to stay the same and it opens two new windows - you&#39;ll need to use within_window to swap over to whichever of the other windows you want the url from"}, {"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1484177483, "post_id": 41601505, "comment_id": 70407828, "body": "Well, thanks, that somewhat explains it. Not sure what are windows in terms of <code>capybara</code>, though. Anyways, <code>within_window</code> triggers <code>block passed to #window_opened_by opened 2 windows instead of 1 (Capybara::WindowError)</code>. How do I choose which window I need?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1484177964, "post_id": 41601505, "comment_id": 70407978, "body": "Since it&#39;s opening 2 you can either use <code>http:&#47;&#47;www.rubydoc.info&#47;gems&#47;capybara&#47;Capybara&#47;Session#windo&zwnj;&#8203;ws-instance_method</code> and step through each of them with within_window to find the one you want, or if you know something about the window you want (title, regex that would match URL, etc) you could use the lambda version of within_window - <code>within_window(-&gt;{ title == &#39;Title of the window&#39; }) do puts current_url end</code>"}, {"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1484179014, "post_id": 41601505, "comment_id": 70408297, "body": "Thanks, you&#39;ve been a great help. For now I&#39;ll stick with <code>within_window(Capybara.current_session.windows[-2])</code>. We&#39;ll see if it&#39;ll work out."}], "tags": [], "owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "is_accepted": true, "score": 0, "last_activity_date": 1484179344, "last_edit_date": 1495541790, "creation_date": 1484172150, "answer_id": 41601505, "question_id": 41601349, "link": "https://stackoverflow.com/questions/41601349/how-to-debug-capybara-not-clicking-links/41601505#41601505", "title": "How to debug capybara not clicking links?", "body": "<p>What I did. Installed <code>selenium-webdriver</code>. Switched to driver <code>:selenium</code>:</p>\n\n<pre><code>Capybara.default_driver = :selenium\n</code></pre>\n\n<p>And added <code>byebug</code> after clicking the link. And now I see that clicking the link redirects to the other site, but also opens new window. However, <code>capybara</code> reports url didn't change.</p>\n\n<p><strong>UPD</strong> The issue was that clicking the link opened two new windows (in terms of <code>capybara</code>, from user point of view only one more window appeared). That's why <code>capybara</code> reported the same url. And with Thomas Walpole's help, I was able to get to the new url of initial window:</p>\n\n<pre><code>within_window(Capybara.current_session.windows[-2]) { p current_url }\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/41601349/how-to-debug-capybara-not-clicking-links/41601505?noredirect=1#comment70407978_41601505\">this comment</a> for alternative ways of choosing the window.</p>\n"}], "owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 41601505, "answer_count": 1, "score": 0, "last_activity_date": 1484179534, "creation_date": 1484171493, "last_edit_date": 1484179534, "question_id": 41601349, "link": "https://stackoverflow.com/questions/41601349/how-to-debug-capybara-not-clicking-links", "title": "How to debug capybara not clicking links?", "body": "<p>I'm trying to use <code>capybara</code> for web scraping. Namely, making it click the link, which is a <code>span</code> actually, but has <code>onclick</code> handler attached:</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire 'rubygems'\nrequire 'bundler/setup'\nrequire 'capybara/dsl'\n\ninclude Capybara::DSL\nCapybara.default_driver = :poltergeist\n\nvisit 'http://example.com'\np current_url\nsleep 10\nfirst('#some-id').click\nsleep 10\np current_url\n</code></pre>\n\n<p>But judging from <code>current_url</code> it fails. For now I'm using <code>poltergeist</code> driver. When I run this code against the other (test) page with span having <code>onclick</code> handler attached, it works. How can I figure out what's the issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1484170402, "post_id": 41600927, "comment_id": 70404970, "body": "If your code works and you just want recommendations of how to write it better you should consider putting it on <a href=\"https://codereview.stackexchange.com\">Code Review</a> rather than <a href=\"https://stackoverflow.com\">Stack Overflow</a>. I&#39;d also recommend using a spelling checker."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6528504"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1484170458, "post_id": 41600927, "comment_id": 70404997, "body": "i dont tested. i just would like to know if is possible without problems"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1484173095, "post_id": 41600927, "comment_id": 70406202, "body": "Every time I see a <code>has_many :through</code> I wonder if this is just a way to hide a violation of the <a href=\"https://en.wikipedia.org/wiki/Law_of_Demeter\" rel=\"nofollow noreferrer\">Law of Demeter</a>."}, {"owner": {"reputation": 680, "user_id": 5243191, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ErQEn.jpg?s=128&g=1", "display_name": "CottonEyeJoe", "link": "https://stackoverflow.com/users/5243191/cottoneyejoe"}, "edited": false, "score": 0, "creation_date": 1485935069, "post_id": 41600927, "comment_id": 71126630, "body": "Maybe this helps, when deciding to go with <code>has_many :through</code> associations: <a href=\"http://stackoverflow.com/a/11601236/5243191\">stackoverflow.com/a/11601236/5243191</a>"}], "owner": {"user_type": "does_not_exist", "display_name": "user6528504"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484196426, "creation_date": 1484169713, "last_edit_date": 1484196426, "question_id": 41600927, "link": "https://stackoverflow.com/questions/41600927/rails-has-many-through-with-5-tables", "title": "rails has_many through with 5 tables", "body": "<p>I would like to know if is a good practice create a has_many through with more than 2 tables. for exemple:</p>\n\n<p>I have</p>\n\n<pre><code>class Color &lt; ActiveRecord::Base\n  attr_accessible :name, :hex\n  has_many :colorships\n  has_many :products, :through =&gt; :orderships\n  has_many :orders, :through =&gt; :orderships\n  accepts_nested_attributes_for :products, :orders\n\nend\n\nclass Size &lt; ActiveRecord::Base\n  # attr_accessible :title, :body\n  attr_accessible :size\n # has_many :orders \n  has_many :orderships\n  has_many :products, :through =&gt; :orderships\n  has_many :orders, :through =&gt; :orderships\n accepts_nested_attributes_for :products, :orders\n\nend\n\n\n\nclass Condition &lt; ActiveRecord::Base\n  attr_accessible :name, :condition\n  has_many :products\n\n\n\n has_many :orderships\n  has_many :products, :through =&gt; :orderships\n  has_many :orders, :through =&gt; :orderships\n\n  accepts_nested_attributes_for :products, :orders\n\n\nend\n\n\nclass Brand &lt; ActiveRecord::Base\n  attr_accessible :name\n  has_many :orderships\n  has_many :products, :through =&gt; :orderships\n  has_many :orders, :through =&gt; :orderships\n\n  accepts_nested_attributes_for :products, :orders\n\n\n\nend\n</code></pre>\n\n<p>The most part the exemples just show 2 models relation</p>\n\n<pre><code>class Material &lt; ActiveRecord::Base\n  attr_accessible :name\n\n\n\n has_many :orderships\n  has_many :products, :through =&gt; :orderships\n  has_many :orders, :through =&gt; :orderships\n\n  accepts_nested_attributes_for :products, :orders\n\n\nend\n\n\nclass Order &lt; ActiveRecord::Base\n\n  has_many :orderships\n  has_many :colors, :through =&gt; :orderships\n  has_many :sizes, :through =&gt; :orderships\n  has_many :materials, :through =&gt; :orderships\n  has_many :brands, :through =&gt; :orderships\n  has_many :conditions, :through =&gt; :orderships\nend\n</code></pre>\n\n<p>So, seems that overblunder the models.</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n\n  has_many :orderships\n  has_many :colors, :through =&gt; :orderships\n  has_many :sizes, :through =&gt; :orderships\n  has_many :materials, :through =&gt; :orderships\n  has_many :brands, :through =&gt; :orderships\n  has_many :conditions, :through =&gt; :orderships\n\nend\n</code></pre>\n\n<p>with relations but at leat dry out models</p>\n\n<pre><code>class Ordership &lt; ActiveRecord::Base\n  # attr_accessible :title, :body\n\n  attr_accessible :product_id, :size_id, :order_id,:condition_id,:brand_id,:material_id\n  #\n  belongs_to :product\n  belongs_to :color\n   belongs_to :order\n belongs_to:condition\n belongs_to:material\n belongs_to:Brand\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 4, "creation_date": 1484169836, "post_id": 41600881, "comment_id": 70404692, "body": "I am not sure about what you want. Something like this? <code>[10 - 12, 0].max</code>"}, {"owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "reply_to_user": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 0, "creation_date": 1484170096, "post_id": 41600881, "comment_id": 70404842, "body": "Yeah actually that worked! Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "is_accepted": true, "score": 4, "last_activity_date": 1484170138, "creation_date": 1484170138, "answer_id": 41601003, "question_id": 41600881, "link": "https://stackoverflow.com/questions/41600881/ensure-that-a-equation-can-never-be-less-than-0-ruby/41601003#41601003", "title": "ensure that a equation can never be less than 0 - Ruby", "body": "<p>There are many ways you could do this.  For example: </p>\n\n<pre><code>[10 - 12, 0].max \n</code></pre>\n\n<p>Or: </p>\n\n<pre><code>result = 10 - 12 \nresult &lt; 0 ? 0 : result\n</code></pre>\n"}], "owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 41601003, "answer_count": 1, "score": 1, "last_activity_date": 1484170138, "creation_date": 1484169505, "question_id": 41600881, "link": "https://stackoverflow.com/questions/41600881/ensure-that-a-equation-can-never-be-less-than-0-ruby", "title": "ensure that a equation can never be less than 0 - Ruby", "body": "<p>If I have this calculation:</p>\n\n<pre><code> 10 - 12\n</code></pre>\n\n<p>I will obviously be returned -2. But I want to use a either a ruby or rails method that will basically return 0 if that calculation is passed to it. I've can't seem to figure this one out?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 1, "creation_date": 1484169344, "post_id": 41600787, "comment_id": 70404418, "body": "Is this in a class?"}, {"owner": {"reputation": 147, "user_id": 7108144, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zB40x.jpg?s=128&g=1", "display_name": "Wali Chaudhary", "link": "https://stackoverflow.com/users/7108144/wali-chaudhary"}, "reply_to_user": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1484170629, "post_id": 41600787, "comment_id": 70405092, "body": "no, it is not in a class"}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1484170715, "post_id": 41600787, "comment_id": 70405136, "body": "Then the <code>initialize</code> method is never getting called, which is why <code>@max</code> is <code>nil</code>"}, {"owner": {"reputation": 1136, "user_id": 5215927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w06Fv.jpg?s=128&g=1", "display_name": "mr_sudaca", "link": "https://stackoverflow.com/users/5215927/mr-sudaca"}, "reply_to_user": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1484170864, "post_id": 41600787, "comment_id": 70405193, "body": "everything are classes in ruby. <code>initialize</code> is the constructor method name by default,  you need to change that name cos you&#39;re overriding <code>Object</code> class constructor method. Also, as @tibsar said, you are not calling the method, hence <code>@max</code> is <code>nil</code>"}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 5069606, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5rzb5dJvxl4/AAAAAAAAAAI/AAAAAAAAAEA/xUrOX8Uw2ts/photo.jpg?sz=128", "display_name": "Ricardo CF", "link": "https://stackoverflow.com/users/5069606/ricardo-cf"}, "is_accepted": true, "score": 2, "last_activity_date": 1484175257, "creation_date": 1484175257, "answer_id": 41602223, "question_id": 41600787, "link": "https://stackoverflow.com/questions/41600787/how-to-call-an-externally-defined-method-within-a-while-loop-in-another-function/41602223#41602223", "title": "How to call an externally defined method within a while loop in another function", "body": "<p>mr_sudaca is right, your @max is always nil..</p>\n\n<p>maybe you'd like to try this:</p>\n\n<pre><code>class Discover\n  def initialize\n    @max = 0\n    @maxln = ''\n  end\n\n  def maxNumberOf file\n    infile = File.open(file, 'r')\n    while (line = infile.gets)\n        defining_max line\n    end\n    infile.close\n    @maxln\n  end\n\n  private\n  def defining_max line\n    size = line.chomp.size\n    if @max &lt; size\n        @max = size\n        @maxln = line\n    end\n  end\nend\n\nt =  Discover.new\nputs t.maxNumberOf 'example.txt'\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 7108144, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zB40x.jpg?s=128&g=1", "display_name": "Wali Chaudhary", "link": "https://stackoverflow.com/users/7108144/wali-chaudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 41602223, "answer_count": 1, "score": 0, "last_activity_date": 1484175257, "creation_date": 1484169185, "last_edit_date": 1484170745, "question_id": 41600787, "link": "https://stackoverflow.com/questions/41600787/how-to-call-an-externally-defined-method-within-a-while-loop-in-another-function", "title": "How to call an externally defined method within a while loop in another function", "body": "<p>This is the problem given:</p>\n\n<p>Exercise 2.1</p>\n\n<blockquote>\n  <p>Given a text file with multiple lines, write a program\n  to print the line with the maximum number of characters and the number of \n  characters that it has. Assume that the input file has a distinct maximum (\n  i.e., only one line has the maximum number of characters).</p>\n</blockquote>\n\n<p>This is my correct solution:</p>\n\n<pre><code>def file\n  infile = File.open('example.txt', 'r')\n  max = -1\n  maxln = ''\n  while (line = infile.gets)\n    size = line.chomp.size\n    if max &lt; size\n      max = size\n      maxln = line\n    end\n  end\n  infile.close\n  puts maxln\n  puts max\nend\n\nfile\n</code></pre>\n\n<p>However, I want to play around with it a little so I broke up the code into different functions:</p>\n\n<pre><code>def initialize(max = -1, maxln = '')\n  @max = max\n  @maxln = ''\nend\n\ndef defining_max\n  if @max &lt; @size\n    @max, @maxln = @size, @line\n  end\nend\n\ndef building_max\n  infile = File.open('example.txt', 'r')\n  while (line = infile.gets)\n     @size = line.chomp.size\n     defining_max\n  end\n   infile.close\n  puts @maxln\n  puts @max\nend\n\nbuilding_max\n</code></pre>\n\n<p>In <code>building_max</code> I try to call <code>defining_max</code>. How do I do that? And also, do I properly break up the code into different functions?</p>\n\n<p>This is the error I got: </p>\n\n<pre><code>c2e1.rb:95: warning: redefining Object#initialize may cause infinite loop\nc2e1.rb:101:in `defining_max': undefined method `&lt;' for nil:NilClass (NoMethodError)\nfrom c2e1.rb:110:in `building_max'\nfrom c2e1.rb:117:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "ruby-on-rails-5", "devise-confirmable"], "comments": [{"owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 0, "creation_date": 1484171292, "post_id": 41600269, "comment_id": 70405393, "body": "Check the <code>db&#47;schema.rb</code> file to make sure that the table <code>users</code> has the <code>confirmed_at</code> column."}], "answers": [{"comments": [{"owner": {"reputation": 649, "user_id": 6262799, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fdcfbe1750c5845f84869ae9f741b27b?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/6262799/prometheus"}, "edited": false, "score": 0, "creation_date": 1484171885, "post_id": 41600387, "comment_id": 70405677, "body": "Thanks! That was the problem! Is there anything i need to do in order to make it finally send an email? Because right now i can finally sign up again but no confirmation email has been send."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "reply_to_user": {"reputation": 649, "user_id": 6262799, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fdcfbe1750c5845f84869ae9f741b27b?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/6262799/prometheus"}, "edited": false, "score": 0, "creation_date": 1484173211, "post_id": 41600387, "comment_id": 70406245, "body": "There&#39;s not much, but the devil is in the details. I would check out mailcatcher.me to &quot;send&quot; mail in development (personal preference; you&#39;ll understand why I&#39;m quoting &quot;send&quot; later), and then read something like this: <a href=\"https://richonrails.com/articles/debugging-emails-with-mailcatcher\" rel=\"nofollow noreferrer\">richonrails.com/articles/debugging-emails-with-mailcatcher</a>"}, {"owner": {"reputation": 649, "user_id": 6262799, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fdcfbe1750c5845f84869ae9f741b27b?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/6262799/prometheus"}, "edited": false, "score": 0, "creation_date": 1484218886, "post_id": 41600387, "comment_id": 70424197, "body": "I&#39;ll check that out. Thanks for helping so much!"}], "tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": true, "score": 1, "last_activity_date": 1484173247, "last_edit_date": 1484173247, "creation_date": 1484167538, "answer_id": 41600387, "question_id": 41600269, "link": "https://stackoverflow.com/questions/41600269/rails-devise-confirmable-error/41600387#41600387", "title": "Rails Devise confirmable error", "body": "<p>For each column in your database, ActiveRecord creates a method to both \"set\" and \"get\" the attribute (to the class, as a column represented in your database), named after the column on the class. In this case, the class is User, the column is confirmed_at.</p>\n\n<p>What the error message is telling you is that there is no method on the User class. You can see methods by calling User.methods.</p>\n\n<p>Without seeing your latest schema.rb file, I'm going to assume that you're missing the Devise confirmable migrations. </p>\n\n<p>Create a new migration file, <code>rails g migration AddConfirmableToUsers</code>; head to db/migrations and open the corresponding migration file, and then copy-paste this in:</p>\n\n<p><code>class AddConfirmableToUsers &lt; ActiveRecord::Migration\n  def change\n    change_table(:users) do |t|\n       # Confirmable\n       t.string   :confirmation_token\n       t.datetime :confirmed_at\n       t.datetime :confirmation_sent_at\n       t.string   :unconfirmed_email # Only if using reconfirmable\n     end\n     add_index  :users, :confirmation_token, :unique =&gt; true \n   end\nend\n</code></p>\n\n<p>then invoke <code>rake db:migrate</code>.</p>\n"}], "owner": {"reputation": 649, "user_id": 6262799, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fdcfbe1750c5845f84869ae9f741b27b?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/6262799/prometheus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1149, "favorite_count": 0, "accepted_answer_id": 41600387, "answer_count": 1, "score": 0, "last_activity_date": 1484173247, "creation_date": 1484167114, "question_id": 41600269, "link": "https://stackoverflow.com/questions/41600269/rails-devise-confirmable-error", "title": "Rails Devise confirmable error", "body": "<p>Currently trying to integrate a confirmation mail with devise authentication. I followed the instruction's from the devise documentation: </p>\n\n<p><a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Add-:confirmable-to-Users\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise/wiki/How-To:-Add-:confirmable-to-Users</a></p>\n\n<p>When i try to sign up a new user i get the following error: </p>\n\n<pre><code>NameError in Devise::RegistrationsController#create\nundefined local variable or method `confirmed_at' for #&lt;User:0x9b87b38&gt;\n</code></pre>\n\n<p><strong>User.rb</strong></p>\n\n<pre><code>  class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n\n\n\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable, :confirmable\nend\n</code></pre>\n\n<p><strong>rails g migration add_confirmable_to_devise</strong></p>\n\n<pre><code>    class AddConfirmableToDevise &lt; ActiveRecord::Migration\n  # Note: You can't use change, as User.update_all will fail in the down migration\n  def up\n    add_column :users, :confirmation_token, :string\n    add_column :users, :confirmed_at, :datetime\n    add_column :users, :confirmation_sent_at, :datetime\n    # add_column :users, :unconfirmed_email, :string # Only if using reconfirmable\n    add_index :users, :confirmation_token, unique: true\n    # User.reset_column_information # Need for some types of updates, but not for update_all.\n    # To avoid a short time window between running the migration and updating all existing\n    # users as confirmed, do the following\n    execute(\"UPDATE users SET confirmed_at = NOW()\")\n    # All existing user accounts should be able to log in after this.\n    # Remind: Rails using SQLite as default. And SQLite has no such function :NOW.\n    # Use :date('now') instead of :NOW when using SQLite.\n    # =&gt; execute(\"UPDATE users SET confirmed_at = date('now')\")\n    # Or =&gt; User.all.update_all confirmed_at: Time.now\n  end\n\n  def down\n    remove_columns :users, :confirmation_token, :confirmed_at, :confirmation_sent_at\n    # remove_columns :users, :unconfirmed_email # Only if using reconfirmable\n  end\nend\n</code></pre>\n\n<p><strong>confirmations_controller.rb</strong></p>\n\n<pre><code>class ConfirmationsController &lt; Devise::ConfirmationsController\n  private\n  def after_confirmation_path_for(resource_name, resource)\n    your_new_after_confirmation_path\n  end\nend\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users, controllers:{ confirmations: 'confirmations'}\n  resources :videos\n  get 'welcome/index'\n\n  get 'welcome/new'\n\n  root 'welcome#index'\n\n\n\nend\n</code></pre>\n\n<p>I also saw someone saying i should add gem 'simple_token_authentication to my Gemfile and run </p>\n\n<pre><code>    rails g migration add_authentication_token_to_users authentication_token:string:index\nrake db:migrate\n</code></pre>\n\n<p>However, that didn't fix that problem. </p>\n\n<p>Any ideas? Thanks!</p>\n"}, {"tags": ["ruby", "string", "csv", "parsing"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1484164863, "post_id": 41599663, "comment_id": 70402058, "body": "Not sure why you&#39;re using FasterCSV when the built-in CSV module is equivalent."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484171813, "post_id": 41599663, "comment_id": 70405640, "body": "As @tadman said, FasterCSV <i>is</i> Ruby&#39;s built-in CSV so just use CSV for clarity and simplicity. Then I&#39;d recommend reading the examples in <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">the documentation</a> as they cover this very well."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "edited": false, "score": 0, "creation_date": 1484165698, "post_id": 41599779, "comment_id": 70402552, "body": "In your example, &#39;CSV.parse_line(&quot;a,b,c,d,e&quot;)&#39;, how does it know what the token separator is, or does it just assume it is always a comma?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1484165928, "post_id": 41599779, "comment_id": 70402671, "body": "It defaults to a comma (&quot;CSV&quot; stands for &quot;comma-separated values&quot;). Like I said, it takes <a href=\"https://ruby-doc.org/stdlib-2.3.3/libdoc/csv/rdoc/CSV.html#method-c-new\" rel=\"nofollow noreferrer\">the same options</a> as <code>CSV.new</code>, so you can pass the <code>col_sep: &quot;\\t&quot;</code> option to use tabs instead. I&#39;ve updated my answer with a second example."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 4, "last_activity_date": 1484166083, "last_edit_date": 1484166083, "creation_date": 1484165073, "answer_id": 41599779, "question_id": 41599663, "link": "https://stackoverflow.com/questions/41599663/how-do-i-split-treat-a-string-not-a-file-as-a-line-in-a-csv-file-and-parse-the/41599779#41599779", "title": "How do I split treat a string (not a file) as a line in a CSV file and parse the string?", "body": "<p>FasterCSV has long since been <a href=\"https://ruby-doc.org/stdlib-2.3.3/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">adopted as the CSV module</a> in the Ruby standard library. Just <code>require \"csv\"</code>.</p>\n\n<p>A very brief glance at the CSV docs reveals the <a href=\"https://ruby-doc.org/stdlib-2.3.3/libdoc/csv/rdoc/CSV.html#method-c-parse_line\" rel=\"nofollow noreferrer\"><code>CSV.parse_line</code></a> method.</p>\n\n<pre><code>require \"csv\"\nCSV.parse_line(\"a,b,c,d,e\")\n# =&gt; [\"a\", \"b\", \"c\", \"d\", \"e\"]\n</code></pre>\n\n<p><code>CSV.parse</code> takes all of <a href=\"https://ruby-doc.org/stdlib-2.3.3/libdoc/csv/rdoc/CSV.html#method-c-new\" rel=\"nofollow noreferrer\">the same options as <code>CSV.new</code></a> et al, so you can pass the <code>col_sep: \"\\t\"</code> option to use tabs as the separator instead:</p>\n\n<pre><code>CSV.parse_line(\"a,b,c,d,e\", col_sep: \"\\t\")\n# =&gt; [\"a,b,c,d,e\"]\n</code></pre>\n\n<p>See it on repl.it: <a href=\"https://repl.it/FGft/1\" rel=\"nofollow noreferrer\">https://repl.it/FGft/1</a></p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1484165121, "creation_date": 1484165121, "answer_id": 41599795, "question_id": 41599663, "link": "https://stackoverflow.com/questions/41599663/how-do-i-split-treat-a-string-not-a-file-as-a-line-in-a-csv-file-and-parse-the/41599795#41599795", "title": "How do I split treat a string (not a file) as a line in a CSV file and parse the string?", "body": "<p>If you have arbitrary string data you want to parse as CSV you can just use <code>parse</code>. No need for a temporary file:</p>\n\n<pre><code>require 'csv'\n\ncommas = %Q[a,b,\"c,d\"]\n\nCSV.parse(commas)\n# =&gt; [[\"a\", \"b\", \"c,d\"]]\n\ntabs = %Q[a\\tb\\t\"c\\td\"]\n\nCSV.parse(tabs, col_sep: \"\\t\")\n# =&gt; [[\"a\", \"b\", \"c\\td\"]]\n</code></pre>\n\n<p>The <code>col_sep</code> option allows you to specify what separator is used.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 41599795, "answer_count": 2, "score": 0, "last_activity_date": 1484166083, "creation_date": 1484164707, "question_id": 41599663, "link": "https://stackoverflow.com/questions/41599663/how-do-i-split-treat-a-string-not-a-file-as-a-line-in-a-csv-file-and-parse-the", "title": "How do I split treat a string (not a file) as a line in a CSV file and parse the string?", "body": "<p>I'm using Ruby 2.4.  Given a particular delimiter character, how can I treat a string as a line in a CSV file and use the delimiter to split that line into an array of tokens?  All the examples online that I have found, for instance</p>\n\n<pre><code>table = FasterCSV.read(result_file.to_file.path, { :headers =&gt; true, :col_sep =&gt; \"\\t\", :skip_blanks =&gt; true })\n</code></pre>\n\n<p>require reading in an entire file.  It seems wasteful to write my line to a file, read the file back, and then delete the temporary file I've created.  Also using the \"split\" function doesn't seem safe if the delimiter is a comma because CSV files will sometimes have commas in the data (in which case quotes surround the data).</p>\n\n<p>An example of such a string might be</p>\n\n<pre><code>a,b,c,d,e\n</code></pre>\n\n<p>If the delimiter passed in is \"\\t\", the result would be [\"a,b,c,d,e\"] but if the delimiter used were a \",\", the result woudl be [\"a\", \"b\", \"c\", \"d\", \"e\"]</p>\n"}, {"tags": ["ruby", "oauth"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 2, "last_activity_date": 1484167598, "creation_date": 1484167598, "answer_id": 41600398, "question_id": 41599621, "link": "https://stackoverflow.com/questions/41599621/only-rescue-specific-oauth2-errors/41600398#41600398", "title": "Only rescue specific OAuth2 errors", "body": "<p>I don't know specifically whether or OAuth::Error has subclasses.</p>\n\n<p>But here is a generally applicable way to rescue specific errors.</p>\n\n<pre><code>begin\n  # raise error here\nrescue OAuth::Error =&gt; e\n  puts e.class # =&gt; OAuth::Error or some subclass\n  if e.class == OAuth::Error::SomeSubclass\n    # continue with rescue\n  else\n    raise e # the equivalent of \"super\" from a rescue block\n            # i.e. act like the rescue didn't happen\n  end\nend\n</code></pre>\n\n<p>In addition to using <code>if</code> on <code>e.class</code>, you can get more information about the error with <code>e.message</code> and <code>e.backtrace</code>. Maybe something like <code>if e.message.include?(\"some string\")</code>.</p>\n\n<p>If you've determined that there is a subclass of the error, you can replace <code>rescue Oauth::Error</code> with only the subclass. </p>\n"}], "owner": {"reputation": 1921, "user_id": 2529285, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/I32t7.png?s=128&g=1", "display_name": "NateW", "link": "https://stackoverflow.com/users/2529285/natew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484167598, "creation_date": 1484164546, "question_id": 41599621, "link": "https://stackoverflow.com/questions/41599621/only-rescue-specific-oauth2-errors", "title": "Only rescue specific OAuth2 errors", "body": "<p>I'm using OAuth2 to make requests in the following format:</p>\n\n<pre><code>@access_token = get_access_token\nbegin\n  @access_token.get(...).body\nrescue OAuth::Error =&gt; e\n   # handle errors\nend\n</code></pre>\n\n<p>This works but it rescues <strong><em>all</em></strong> OAuth2 errors and I would like to only rescue specific errors. </p>\n\n<p>For example if I only want to rescue Unauthorized errors. Is there something like <code>OAuth::Error::Unauthorized</code> or maybe response codes just using response codes <code>OAuth::Error::401</code>.</p>\n\n<p>Is there any way to limit which <code>OAuth</code> errors that I rescue from?</p>\n"}, {"tags": ["ruby", "math", "prime-factoring"], "comments": [{"owner": {"reputation": 1592, "user_id": 7138517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40228125f914cf5ef1ae7df6b98c550d?s=128&d=identicon&r=PG&f=1", "display_name": "Coolness", "link": "https://stackoverflow.com/users/7138517/coolness"}, "edited": false, "score": 0, "creation_date": 1484165317, "post_id": 41599429, "comment_id": 70402338, "body": "Does it require you to find the max number of <i>unique</i> prime factors in a range? Because your code seems to do just that."}, {"owner": {"reputation": 5455, "user_id": 393021, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5761f8f81bb258e64b585889481ef25c?s=128&d=identicon&r=PG", "display_name": "iGbanam", "link": "https://stackoverflow.com/users/393021/igbanam"}, "reply_to_user": {"reputation": 1592, "user_id": 7138517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40228125f914cf5ef1ae7df6b98c550d?s=128&d=identicon&r=PG&f=1", "display_name": "Coolness", "link": "https://stackoverflow.com/users/7138517/coolness"}, "edited": false, "score": 0, "creation_date": 1484165978, "post_id": 41599429, "comment_id": 70402697, "body": "Yes. And that&#39;s what my code does. But it does not scale, @Coolness"}, {"owner": {"reputation": 1592, "user_id": 7138517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40228125f914cf5ef1ae7df6b98c550d?s=128&d=identicon&r=PG&f=1", "display_name": "Coolness", "link": "https://stackoverflow.com/users/7138517/coolness"}, "edited": false, "score": 0, "creation_date": 1484166315, "post_id": 41599429, "comment_id": 70402875, "body": "Right, it&#39;s just that you might want to edit that in (in case someone looks at this in the future), because the non-unique problem is a different one :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1484166643, "post_id": 41599429, "comment_id": 70403041, "body": "Why the rush to select an answer?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1484170423, "post_id": 41599429, "comment_id": 70404982, "body": "@CarySwoveland: With all due respect : You answered this one after I completed my reply. The structure of your code is very similar to my last method (I surely don&#39;t mean to imply you copied it : Just that&#39;s it doesn&#39;t add much value after the question has been answered), and your method actually doesn&#39;t return the desired output. So please don&#39;t feel bad : you&#39;ll get your &quot;revenge&quot; on another question."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 2, "creation_date": 1484172194, "post_id": 41599429, "comment_id": 70405794, "body": "@Eric, I&#39;m not suggesting that my answer be selected. I often chide askers for quick-draw selections, regardless of whether I&#39;ve submitted an answer, am working on one, have no intention of answering or have submitted the answer that has been selected (in which case I usually suggest the greenie be removed)! I usually point out the downsides of a quick selection (it may discourage other answers and ,imo, is disrespectful to those still woking on answers) and ask if there is any argument for a rapid selection."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484172600, "post_id": 41599429, "comment_id": 70405971, "body": "Got it. Thanks for the explanation."}], "answers": [{"comments": [{"owner": {"reputation": 5455, "user_id": 393021, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5761f8f81bb258e64b585889481ef25c?s=128&d=identicon&r=PG", "display_name": "iGbanam", "link": "https://stackoverflow.com/users/393021/igbanam"}, "edited": false, "score": 0, "creation_date": 1484165875, "post_id": 41599770, "comment_id": 70402643, "body": "This is genius. I thought I knew Enumerable. Teach me, master"}, {"owner": {"reputation": 1592, "user_id": 7138517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40228125f914cf5ef1ae7df6b98c550d?s=128&d=identicon&r=PG&f=1", "display_name": "Coolness", "link": "https://stackoverflow.com/users/7138517/coolness"}, "edited": false, "score": 0, "creation_date": 1484166208, "post_id": 41599770, "comment_id": 70402819, "body": "Great solution. I&#39;m curious, how does <code>(1..n).find()</code> work so fast? Is it optimized to binary search seeing as the interval is sorted? I&#39;m presuming <code>(1..n)</code> doesn&#39;t allocate an array since that would take too much time here. Does it call <code>Range#bsearch</code>?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 1592, "user_id": 7138517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40228125f914cf5ef1ae7df6b98c550d?s=128&d=identicon&r=PG&f=1", "display_name": "Coolness", "link": "https://stackoverflow.com/users/7138517/coolness"}, "edited": false, "score": 1, "creation_date": 1484168758, "post_id": 41599770, "comment_id": 70404109, "body": "@Coolness: I updated the answer. <code>(1..n).find</code> begins with 1, and iterates until the block is truthy. This happens really fast because product of <code>m</code> first primes grows faster than exponentially. The range max actually doesn&#39;t matter at all, and no array is created. See <code>(1..Float::INFINITY).find{|x| x &gt; 100}</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1484168771, "post_id": 41599770, "comment_id": 70404116, "body": "<code>n = Float::INFINITY</code> would be a wee problem. Note you don&#39;t have to take the first <code>i+1</code> primes each time. Just multiply the product of the first <code>i</code> by the next one. Granted, you wouldn&#39;t be saving much time."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484168869, "post_id": 41599770, "comment_id": 70404174, "body": "I never talked about <code>n = Float::INFINITY</code>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1484169348, "post_id": 41599770, "comment_id": 70404420, "body": "@CarySwoveland : I updated the answer. The time complexity is so low that I&#39;d much rather have a nice and readable one-liner than trying to optimize for peanuts. No. <code>n != range.max</code>, but <code>range.max</code> can be defined to be <code>n</code>. EDIT: You got it."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1484169639, "post_id": 41599770, "comment_id": 70404588, "body": "To  make it clearer I would suggest <code>1.step.find {...}</code>."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1484169910, "post_id": 41599770, "comment_id": 70404733, "body": "@CarySwoveland: I&#39;ve never seen <code>1.step</code>, interesting! I don&#39;t find it clearer though."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1484171076, "post_id": 41599770, "comment_id": 70405289, "body": "I prefer <code>1.step</code> or the less attractive <code>1..Float::INFINITY</code> to <code>1..n</code> because latter requires the reader to ask &quot;why <code>n</code>?&quot;. This is evidenced by the asker&#39;s first comment above. If the range were infinite it would be obvious that the block  would just iterate away until it found <code>true</code>. I think it was Ruby v2.1 when the <code>limit</code> argument for <a href=\"http://ruby-doc.org/core-2.3.0/Numeric.html#method-i-step\" rel=\"nofollow noreferrer\">Numeric#step</a> became optional."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484171297, "post_id": 41599770, "comment_id": 70405398, "body": "In that case, the user probably would have asked : &quot;what is <code>1.step.find</code>?&quot; :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1484171340, "post_id": 41599770, "comment_id": 70405418, "body": "I hope so! Then they would have learned something new about Ruby."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1484174352, "post_id": 41599770, "comment_id": 70406715, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/132949/discussion-between-eric-duminil-and-cary-swoveland\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 5, "last_activity_date": 1484170605, "last_edit_date": 1484170605, "creation_date": 1484165037, "answer_id": 41599770, "question_id": 41599429, "link": "https://stackoverflow.com/questions/41599429/highest-unique-prime-factors-in-range/41599770#41599770", "title": "Highest unique prime factors in range", "body": "<h1>Solution</h1>\n\n<p>The numbers in your example are just the products of the first Primes, which actually makes sense if you want to minimize the product while maximizing the number of factors.</p>\n\n<p>See this integer <a href=\"http://oeis.org/A002110\" rel=\"nofollow noreferrer\">sequence</a> for more information :</p>\n\n<blockquote>\n  <p>a(n) is the least number N with n distinct prime factors</p>\n</blockquote>\n\n<h3>Code</h3>\n\n<pre><code>require 'prime'\n\nn = 50000\n\np (1..n).find{|i| Prime.take(i+1).inject(:*) &gt; n}\n#=&gt; 6\n</code></pre>\n\n<p>With <code>n = 10000000000</code> :</p>\n\n<pre><code>p (1..n).find{|i| Prime.take(i+1).inject(:*) &gt; n}\n#=&gt; 10\n</code></pre>\n\n<h3>Explanation</h3>\n\n<p>It calculates the product of the first <code>i+1</code> primes until it is greater than n. In this case, <code>i</code> is the desired output.</p>\n\n<p>Note that <code>i</code> is always smaller than n, so searching the Range <code>(1..n)</code> will be more than enough. <code>find</code> stops the search as soon as block returns a truthy value, so it doesn't matter if <code>range.max</code> is <code>n</code> or even <code>Float::INFINITY</code>.</p>\n\n<p>It isn't really efficient to calculate the product for each <code>i</code>, but the solution is found so fast it probably doesn't matter : The product of the first k primes grows faster than <code>k!</code>, so less than <code>O(\u0393**-1(n))</code> steps are needed.</p>\n\n<h3>For which number?</h3>\n\n<p>If you want to know for which number it is :</p>\n\n<pre><code>p Prime.inject { |product, prime|\n  new_product = prime * product\n  break product if new_product &gt; n\n  new_product\n}\n#=&gt; 6469693230\n</code></pre>\n\n<p>or just :</p>\n\n<pre><code>p Prime.take(10).inject(:*)\n#=&gt; 6469693230\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1484168396, "post_id": 41600133, "comment_id": 70403915, "body": "I have said this many times already: Project Euler, HackerRank and whatever their names are <i>not</i> programming problems. If you use them to learn programming, you are doing it wrong. They are maths problems. They teach you maths, not programming. An answer to a Project Euler / HackerRank / etc. problem should usually involve a proof or at least some equations or mathematical arguments. This answer is a nice example of that. +1"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1484175550, "last_edit_date": 1484175550, "creation_date": 1484166600, "answer_id": 41600133, "question_id": 41599429, "link": "https://stackoverflow.com/questions/41599429/highest-unique-prime-factors-in-range/41600133#41600133", "title": "Highest unique prime factors in range", "body": "<p>The maximum number of distinct primes between <code>2</code> and <code>n</code> is <code>m</code> such that <code>P(m) &lt;= n &lt; P(m+1)</code>, where <code>P(m) = p</code><sub><code>1</code></sub><code>*p</code><sub><code>2</code></sub><code>*...*p</code><sub><code>m</code></sub>, <code>p</code><sub><code>i</code></sub> being the <code>i</code>th largest prime. The proof (by contradiction) is simple. Suppose <code>q</code><sub><code>1</code></sub><code>*q</code><sub><code>2</code></sub><code>*...*q</code><sub><code>m+1</code></sub> is any other sequence of increasing primes. Since <code>p</code><sub><code>i</code></sub><code>&lt;= q</code><sub><code>i</code></sub> for <code>i = 1...m+1</code>, it follows that the product of the <code>q</code>'s must exceed <code>n</code>. </p>\n\n<pre><code>require 'prime'\n\ndef max_number_primes(n)\n  return 0 if n &lt; 2\n  t = 1\n  Prime.each_with_object([]) do |p, a|\n    tmp = p*t\n    return a if tmp &gt; n\n    a &lt;&lt; p\n    t = tmp\n  end\nend\n\nmax_number_primes(50)              #=&gt; [2, 3, 5]\nmax_number_primes(50_000)          #=&gt; [2, 3, 5, 7, 11, 13] \nmax_number_primes(10_000_000_000)  #=&gt; [2, 3, 5, 7, 11, 13, 17, 19, 23, 29]\n</code></pre>\n"}], "owner": {"reputation": 5455, "user_id": 393021, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5761f8f81bb258e64b585889481ef25c?s=128&d=identicon&r=PG", "display_name": "iGbanam", "link": "https://stackoverflow.com/users/393021/igbanam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 41599770, "answer_count": 2, "score": 4, "last_activity_date": 1484175550, "creation_date": 1484163884, "last_edit_date": 1484166389, "question_id": 41599429, "link": "https://stackoverflow.com/questions/41599429/highest-unique-prime-factors-in-range", "title": "Highest unique prime factors in range", "body": "<p>I am trying to scale a solution I have to a Hackerrank <em>practice</em> question.</p>\n\n<p>The question, in summary is, find the max number of prime factors in a range.</p>\n\n<p>For <code>1..500</code> it's <code>4 for 210 -&gt; 2(1), 3(1), 5(1), 7(1)</code><br>\nFor <code>1..5000</code> it's <code>5 for 2310 -&gt; 2(1), 3(1), 5(1), 7(1), 11(1)</code><br>\nFor <code>1..50000</code> it's <code>6 for 30030 -&gt; 2(1), 3(1), 5(1), 7(1), 11(1), 13(1)</code>  </p>\n\n<p>This is my solution</p>\n\n<pre><code>require 'prime'\nmax = 0\nfor d in 1..n\n    pfs = d.prime_division.count\n    max = pfs if pfs &gt; max\nend\nputs max\n</code></pre>\n\n<p>This takes forever for <code>n = 10000000000</code>.</p>\n\n<p>I may be looking at the solution from the wrong perspective.<br>\nHow do I scale this solution?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "multithreading", "activerecord"], "comments": [{"owner": {"reputation": 5529, "user_id": 1032663, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/nQ6Rw.jpg?s=128&g=1", "display_name": "Joel_Blum", "link": "https://stackoverflow.com/users/1032663/joel-blum"}, "edited": false, "score": 0, "creation_date": 1484164136, "post_id": 41599120, "comment_id": 70401646, "body": "what version rails are you using? i think there were some changes lately in starting threads"}, {"owner": {"reputation": 1986, "user_id": 422131, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d46192872b1cab3ef46da47bdd56e12?s=128&d=identicon&r=PG", "display_name": "CppNoob", "link": "https://stackoverflow.com/users/422131/cppnoob"}, "reply_to_user": {"reputation": 5529, "user_id": 1032663, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/nQ6Rw.jpg?s=128&g=1", "display_name": "Joel_Blum", "link": "https://stackoverflow.com/users/1032663/joel-blum"}, "edited": false, "score": 0, "creation_date": 1484164204, "post_id": 41599120, "comment_id": 70401695, "body": "I am using Rails 4. What kind of changes were these?"}], "answers": [{"tags": [], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "is_accepted": true, "score": 1, "last_activity_date": 1563006041, "last_edit_date": 1563006041, "creation_date": 1484168399, "answer_id": 41600596, "question_id": 41599120, "link": "https://stackoverflow.com/questions/41599120/rails-4-using-activerecord-object-from-one-thread-in-another/41600596#41600596", "title": "Rails 4: Using ActiveRecord object from one thread in another", "body": "<p>You've heard correctly. When using AR, you may find that you'll need to tiptoe around threads in weird ways to keep things stable... If you have a guarantee that you'll only ever have 2 threads, then you're probably safe at least as far as AR is concerned. (Of course, all the other pitfalls of concurrency\u2013e.g. deadlocks, thread starvation, etc\u2013still apply, so make sure to account for these.)</p>\n\n<p>One thing to keep in mind is that each thread will use it's AR connection, so the <code>pool</code> field in database.yml must be high enough to accommodate all threads. If you're using a thread based webserver like Puma, then this can get even more complicated... If you're newer to rails, I would urge caution when dealing with threads and AR. It can be quite a rabbit-hole.</p>\n\n<p>What's the purpose of having one thread fetch the object, and another access it? If you expect real speed benefits then it may be worth it, but since the activity of the second thread (operations on the AR record) is contingent on the result of the first thread, (loading of the AR record) then you may not see speed improvements since you'll need to wait for the first thread to finish to even begin using the second one. If your scenario doesn't do anything with the first thread after it's loaded up the object, I would absolutely recommend against this since you wouldn't see any speed improvements, but I don't know the whole scenario, and using threads may still make sense for your situation.</p>\n\n<p>So in short, there's nothing stopping you from using threads with AR, but it is risky, and you can expect bugs to crop up in weird places unless your thread usage is conservative. It <em>may</em> still make sense for your app, but look into other solutions first and proceed with caution if you do go with threads.</p>\n\n<p>Re \"If the two threads use separate connections to the DB, which connection will be used if needed to access the AR object's associations\": Each thread acquires its own AR connection, so the thread accessing the AR associations will use its own connection, irrespective of the thread that originally loaded the AR record.</p>\n\n<p>What's the motivation for using threads in your app? There may be a better way of handling things.</p>\n"}], "owner": {"reputation": 1986, "user_id": 422131, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d46192872b1cab3ef46da47bdd56e12?s=128&d=identicon&r=PG", "display_name": "CppNoob", "link": "https://stackoverflow.com/users/422131/cppnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 41600596, "answer_count": 1, "score": 0, "last_activity_date": 1563006041, "creation_date": 1484162713, "last_edit_date": 1484164188, "question_id": 41599120, "link": "https://stackoverflow.com/questions/41599120/rails-4-using-activerecord-object-from-one-thread-in-another", "title": "Rails 4: Using ActiveRecord object from one thread in another", "body": "<p>I have two threads. In one thread I fetch a record from the database as an ActiveRecord object. I then access this object from another thread.</p>\n\n<p>Is there a problem with this usage?\nIf the two threads use separate connections to the DB, which connection will be used if needed to access the AR object's associations, etc?</p>\n\n<p>I have seen some questions on StackOverflow that speak about the pitfalls of connecting to the DB via ActiveRecord from different threads and the need for manually checking-in such connections. Does that have an impact on this issue?</p>\n"}, {"tags": ["c++", "ruby", "segmentation-fault", "embed"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484163984, "post_id": 41598494, "comment_id": 70401574, "body": "You&#39;re going to need to trace a little more thoroughly than that."}, {"owner": {"reputation": 173, "user_id": 5202096, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cj-g4-8M82g/AAAAAAAAAAI/AAAAAAAAAEI/uZarQlx71kU/photo.jpg?sz=128", "display_name": "Strelokhalfer", "link": "https://stackoverflow.com/users/5202096/strelokhalfer"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484167950, "post_id": 41598494, "comment_id": 70403715, "body": "Hmm, some bug with JUMP_TAG"}], "answers": [{"tags": [], "owner": {"reputation": 2681, "user_id": 486990, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b0220a4b0ec42f2ddc610d0c187b1ee1?s=128&d=identicon&r=PG", "display_name": "thomthom", "link": "https://stackoverflow.com/users/486990/thomthom"}, "is_accepted": false, "score": 0, "last_activity_date": 1575489488, "creation_date": 1575489488, "answer_id": 59183799, "question_id": 41598494, "link": "https://stackoverflow.com/questions/41598494/rb-raise-in-embeded-c-cause-segmentation-fault/59183799#59183799", "title": "rb_raise in embeded c++ cause Segmentation fault", "body": "<p>Late answer, but for anyone who might come across this, uncaught Ruby exceptions will segfault your application. When embedding Ruby in your application you need to use <code>rb_protect</code> to catch the errors.</p>\n\n<p><a href=\"https://silverhammermba.github.io/emberb/c/#exceptions\" rel=\"nofollow noreferrer\">https://silverhammermba.github.io/emberb/c/#exceptions</a></p>\n\n<blockquote>\n  <p>If you\u2019re compiling a library to be loaded by Ruby, you have it easy. Any exceptions raised in the API can be rescued as usual in your Ruby code. If you want to rescue an exception in the API, you can use rb_rescue2() which is similar to Ruby\u2019s rescue.</p>\n</blockquote>\n\n<p>...</p>\n\n<blockquote>\n  <p>If you\u2019re embedding the Ruby interpreter in C, you need to be extremely careful when calling API functions that could raise exceptions: an uncaught exception will segfault the VM and kill your program. You could call rb_rescue2() with rb_eException, but there\u2019s another approach for rescuing all exceptions:\n  <a href=\"https://silverhammermba.github.io/emberb/c/#rb_protect\" rel=\"nofollow noreferrer\"><code>rb_protect</code></a></p>\n</blockquote>\n"}], "owner": {"reputation": 173, "user_id": 5202096, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cj-g4-8M82g/AAAAAAAAAAI/AAAAAAAAAEI/uZarQlx71kU/photo.jpg?sz=128", "display_name": "Strelokhalfer", "link": "https://stackoverflow.com/users/5202096/strelokhalfer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575489488, "creation_date": 1484160616, "question_id": 41598494, "link": "https://stackoverflow.com/questions/41598494/rb-raise-in-embeded-c-cause-segmentation-fault", "title": "rb_raise in embeded c++ cause Segmentation fault", "body": "<p>I try embed ruby interpretator into my program.\nProgram work well, but if ruby get exeption(in C or ruby itself), program crash with SEGFAULT.\nExpamle:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"Ruby/ruby.h\"\n#define RUBY_METH(method) reinterpret_cast&lt; VALUE ( * ) ( ... ) &gt;(method)\nusing namespace std;\n\nint main(int argc, char** argv)\n{\n    cout &lt;&lt; \"Hello world!\" &lt;&lt; endl;\n    ruby_sysinit(&amp;argc, &amp;argv);\n    RUBY_INIT_STACK;\n    ruby_init();\n    ruby_init_loadpath();\n    rb_require(\"./init\");//segfault by \"raise\"\n    rb_raise(rb_eArgError, \"Lol\");//If comment \"raise\" in init.rb, segfault\n\n    return 0;\n}\n</code></pre>\n\n<p>init.rb</p>\n\n<pre><code>p \"lol\"\nraise \n</code></pre>\n\n<p>Console output</p>\n\n<pre><code>Hello world!\n\"lol\"\n&lt;main&gt;: [BUG] Segmentation fault\nruby 1.9.3p551 (2014-11-13) [i386-mingw32]\n\n-- Control frame information -----------------------------------------------\nc:0001 p:0000 s:0002 b:0002 l:000c74 d:000c74 TOP\n\n\n-- C level backtrace information -------------------------------------------\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(ZwWaitForSingleObject+0xc) [0x76fbe5fc]\nC:\\WINDOWS\\System32\\KERNELBASE.dll(WaitForSingleObject+0x12) [0x75bdad52]\n [0x004b2789]\n [0x00402106]\n [0x00402f6f]\n [0x004f9e90]\n [0x004011ea]\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(LdrSetAppCompatDllRedirectionCallback+0x1ae9d) [0x76fee0bd]\n</code></pre>\n\n<p>Compile with GNU GCC on windows</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3.2", "ruby-2.3"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1484161227, "post_id": 41598467, "comment_id": 70400058, "body": "What is the output of <code>puts caller</code> inside your patched tempfile.rb?"}], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1484163923, "post_id": 41599366, "comment_id": 70401532, "body": "<code>`</code> is a backtick (or <a href=\"http://www.fileformat.info/info/unicode/char/0060/index.htm\" rel=\"nofollow noreferrer\">grave accent</a>). <code>~</code> is a <a href=\"http://www.fileformat.info/info/unicode/char/007e/index.htm\" rel=\"nofollow noreferrer\">tilde</a>."}, {"owner": {"reputation": 1175, "user_id": 4091773, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uYBaq.jpg?s=128&g=1", "display_name": "Javier Perez", "link": "https://stackoverflow.com/users/4091773/javier-perez"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1484165249, "post_id": 41599366, "comment_id": 70402293, "body": "I knew someone would correct me about that but couldn&#39;t remember the name, thanks dude."}, {"owner": {"reputation": 2688, "user_id": 164237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5290492d327de6973c0f52e82d9cbf35?s=128&d=identicon&r=PG", "display_name": "bschaeffer", "link": "https://stackoverflow.com/users/164237/bschaeffer"}, "edited": false, "score": 0, "creation_date": 1484320620, "post_id": 41599366, "comment_id": 70475205, "body": "Thanks for the feedback. The code above is the code in the app no <code>~</code> or <code>`</code> and I&#39;m using 2.3.3 to produce the error. When you say you get the same error using a regex, do you mean you are seeing the <code>[]</code> args being converted to a hash?"}], "tags": [], "owner": {"reputation": 1175, "user_id": 4091773, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uYBaq.jpg?s=128&g=1", "display_name": "Javier Perez", "link": "https://stackoverflow.com/users/4091773/javier-perez"}, "is_accepted": false, "score": 0, "last_activity_date": 1484163677, "creation_date": 1484163677, "answer_id": 41599366, "question_id": 41598467, "link": "https://stackoverflow.com/questions/41598467/ruby-2-3-3-weird-tempfile-newname-prefix-basename-converted-to-hash/41599366#41599366", "title": "Ruby 2.3.3: Weird Tempfile.new([name, prefix]) basename converted to hash", "body": "<p>Just tried this in my console, and got no error. Try a few things, </p>\n\n<ol>\n<li>Make sure you are using ruby 2.3 or higher in your rail app, because I believe that method <code>make_tmpname</code> was handled differently before. </li>\n<li>Make sure the quotes around <code>.csv</code> are quotes and not a tilde `.</li>\n<li>I get your same error with ruby 2.3.1 if I do this <code>Tempfile.new(['test', /re/])</code></li>\n</ol>\n\n<p>I hope this helps, at the end of the day what's causing your error is this method <a href=\"http://apidock.com/ruby/String/try_convert/class\" rel=\"nofollow noreferrer\">try_convert</a> which is returning <code>nil</code> for the second argument you pass to <code>Tempfile.new</code></p>\n"}, {"comments": [{"owner": {"reputation": 5064, "user_id": 524740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d217125368b3d2afc1be2129674d39e2?s=128&d=identicon&r=PG", "display_name": "Prem", "link": "https://stackoverflow.com/users/524740/prem"}, "edited": false, "score": 0, "creation_date": 1569253071, "post_id": 41938350, "comment_id": 102527889, "body": "This is not working for me and still getting the same error, while running &#39;ruby 2.3.1p112&#39;"}, {"owner": {"reputation": 5064, "user_id": 524740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d217125368b3d2afc1be2129674d39e2?s=128&d=identicon&r=PG", "display_name": "Prem", "link": "https://stackoverflow.com/users/524740/prem"}, "edited": false, "score": 0, "creation_date": 1571004181, "post_id": 41938350, "comment_id": 103086404, "body": "This didn&#39;t fix my error, but helped me find my error. In my case, basename was being as an array which was not an issue in ruby-2.1.8, but ruby-2.3.1 started giving error for that. Array being tried to convert to string, to get the prefix and it was becoming nil and giving runtime error &#39;unexpected prefix&#39;. Updating the basename parameter sending to Tempfile, to be a filename string fixed my issue."}], "tags": [], "owner": {"reputation": 1, "user_id": 2352227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74650024a0d3adea8252eb9485f0d5fd?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/2352227/emanuel"}, "is_accepted": false, "score": 0, "last_activity_date": 1485786560, "creation_date": 1485786560, "answer_id": 41938350, "question_id": 41598467, "link": "https://stackoverflow.com/questions/41598467/ruby-2-3-3-weird-tempfile-newname-prefix-basename-converted-to-hash/41938350#41938350", "title": "Ruby 2.3.3: Weird Tempfile.new([name, prefix]) basename converted to hash", "body": "<p>This is how I fixed it.</p>\n\n<pre><code>class Tempfile \n  def initialize(basename=\"\", tmpdir=nil, mode: 0, **options)\n    warn \"Tempfile.new doesn't call the given block.\" if block_given?\n\n    basename = basename.keys if basename.kind_of?(Hash)\n\n    @unlinked = false\n    @mode = mode|File::RDWR|File::CREAT|File::EXCL\n    ::Dir::Tmpname.create(basename, tmpdir, options) do |tmpname, n, opts|\n      opts[:perm] = 0600\n      @tmpfile = File.open(tmpname, @mode, opts)\n      @opts = opts.freeze\n    end\n    ObjectSpace.define_finalizer(self, Remover.new(@tmpfile))\n\n    super(@tmpfile)\n  end\nend  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2688, "user_id": 164237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5290492d327de6973c0f52e82d9cbf35?s=128&d=identicon&r=PG", "display_name": "bschaeffer", "link": "https://stackoverflow.com/users/164237/bschaeffer"}, "edited": false, "score": 0, "creation_date": 1504021047, "post_id": 45204851, "comment_id": 78844613, "body": "Thank you so much for answering!!!! That&#39;s a really nice find! Been struggling with this for a while."}, {"owner": {"reputation": 5064, "user_id": 524740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d217125368b3d2afc1be2129674d39e2?s=128&d=identicon&r=PG", "display_name": "Prem", "link": "https://stackoverflow.com/users/524740/prem"}, "edited": false, "score": 0, "creation_date": 1569253209, "post_id": 45204851, "comment_id": 102527951, "body": "Nice finding, Thank you. But having/not having default name, both the cases i am still getting the error while running &#39;ruby 2.3.1p112&#39;"}, {"owner": {"reputation": 5064, "user_id": 524740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d217125368b3d2afc1be2129674d39e2?s=128&d=identicon&r=PG", "display_name": "Prem", "link": "https://stackoverflow.com/users/524740/prem"}, "edited": false, "score": 0, "creation_date": 1571004420, "post_id": 45204851, "comment_id": 103086443, "body": "My issue was not related to default parameter. I was getting an array in basename and that is having issue in getting converted to string to verify prefix. updating that value from array to a string of filename, fixed my issue."}], "tags": [], "owner": {"reputation": 1916, "user_id": 89082, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ed77c0d1c8da409c4f69f67f934ff0bb?s=128&d=identicon&r=PG", "display_name": "Martinos", "link": "https://stackoverflow.com/users/89082/martinos"}, "is_accepted": true, "score": 3, "last_activity_date": 1500556273, "last_edit_date": 1500556273, "creation_date": 1500522889, "answer_id": 45204851, "question_id": 41598467, "link": "https://stackoverflow.com/questions/41598467/ruby-2-3-3-weird-tempfile-newname-prefix-basename-converted-to-hash/45204851#45204851", "title": "Ruby 2.3.3: Weird Tempfile.new([name, prefix]) basename converted to hash", "body": "<p>In your case I think that somewhere in your code you have the <code>Array#to_hash</code> method defined. </p>\n\n<p>I had the same issue and for some reason when a method has a default param, in this case <code>basename=\"\"</code>, and a double splatted parameter, Ruby calls the <code>to_hash</code> function on the first param.</p>\n\n<p>See the following example:</p>\n\n<pre><code>class Dummy\n  def initialize(val = \"\", **options)\n    puts \"val = #{val}\"\n    # puts \"Options: #{options}\"\n  end\nend\n\nclass Array\n  def to_hash\n    puts \"to_hash called on #{self}\"\n  end\nend\n\nDummy.new([\"Joe\", \"Bloe\"])\n</code></pre>\n\n<p>This will output</p>\n\n<pre><code>to_hash called on [\"Joe\", \"Bloe\"]\nval = [\"Joe\", \"Bloe\"]\n</code></pre>\n\n<p>But when there's no default value for the <code>val</code> param, you'll get:</p>\n\n<pre><code>val = [\"Joe\", \"Bloe\"]\n</code></pre>\n\n<p>Note that the <code>TempFile#initialize</code> function signature was changed from Ruby 2.1 to Ruby 2.2.</p>\n\n<p>Here's the diff:</p>\n\n<pre><code>-  def initialize(basename, *rest)\n+  def initialize(basename=\"\", tmpdir=nil, mode: 0, **options)\n</code></pre>\n\n<p>Notice that <code>basename</code> doesn't have a default value anymore.</p>\n"}], "owner": {"reputation": 2688, "user_id": 164237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5290492d327de6973c0f52e82d9cbf35?s=128&d=identicon&r=PG", "display_name": "bschaeffer", "link": "https://stackoverflow.com/users/164237/bschaeffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 0, "accepted_answer_id": 45204851, "answer_count": 3, "score": 3, "last_activity_date": 1500556273, "creation_date": 1484160530, "question_id": 41598467, "link": "https://stackoverflow.com/questions/41598467/ruby-2-3-3-weird-tempfile-newname-prefix-basename-converted-to-hash", "title": "Ruby 2.3.3: Weird Tempfile.new([name, prefix]) basename converted to hash", "body": "<p>Testing an upgrade to Ruby 2.3.3 for our Rails 3.2.22.2 application, and getting a weird situation where we are passing an array as the first argument to <code>Tempfile.new</code>, but it's ending up as a hash.</p>\n\n<p>I've patched <code>tempfile.rb</code> to output the <code>basename</code> argument being passed in.</p>\n\n<p>In an <code>irb</code> session (non-Rails), everything is fine:</p>\n\n<pre><code>&gt; require 'tempfile'\ntrue\n&gt; Tempfile.new(['test', '.csv'])\n[\"home\", \".csv\"] # output of basename argument for Tempfile.new\n =&gt; #&lt;Tempfile:/var/blah/test###.csv&gt; \n</code></pre>\n\n<p>In a <code>rails console</code> session:</p>\n\n<pre><code>&gt; Tempfile.new(['test', '.csv'])\n{\"test\"=&gt;nil, \".csv\"=&gt;nil}\nArgumentError: unexpected prefix: {\"test\"=&gt;nil, \".csv\"=&gt;nil}\nfrom /path/to/ruby-2.3.3/lib/ruby/2.3.0/tmpdir.rb:113:in `make_tmpname'\n</code></pre>\n\n<p>Gotta be a gem or something, but can't figure out for the life of me why this is happening or where or what is changing the behavior.</p>\n\n<p>Any ideas or suggestions on how to debug?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "apache"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1484162044, "post_id": 41598045, "comment_id": 70400494, "body": "Phusion Passenger&#39;s <a href=\"https://www.phusionpassenger.com/documentation/Design%20and%20Architecture.html\" rel=\"nofollow noreferrer\">Design and Architecture</a> document has a &quot;Common Models&quot; section that provides a great overview of the various ways this is done."}, {"owner": {"reputation": 1248, "user_id": 1542307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BXRAC.jpg?s=128&g=1", "display_name": "Karan Shah", "link": "https://stackoverflow.com/users/1542307/karan-shah"}, "edited": false, "score": 0, "creation_date": 1484222755, "post_id": 41598045, "comment_id": 70426794, "body": "If I&#39;ve answered your query, do mark the answer as correct"}], "answers": [{"tags": [], "owner": {"reputation": 1248, "user_id": 1542307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BXRAC.jpg?s=128&g=1", "display_name": "Karan Shah", "link": "https://stackoverflow.com/users/1542307/karan-shah"}, "is_accepted": false, "score": 2, "last_activity_date": 1484172169, "last_edit_date": 1484172169, "creation_date": 1484160404, "answer_id": 41598433, "question_id": 41598045, "link": "https://stackoverflow.com/questions/41598045/how-does-the-ruby-interpreter-integrate-with-http-servers-like-apache/41598433#41598433", "title": "How does the Ruby interpreter integrate with HTTP servers like Apache?", "body": "<p>Ruby cannot work with Apache alone, Apache is a web server and Ruby needs an application server as it's an interpreted language. Wikipedia's \"<a href=\"https://en.wikipedia.org/wiki/Interpreted_language\" rel=\"nofollow noreferrer\">Interpreted language</a>\" page has more about interpreted languages.</p>\n\n<p>Ruby works with Apache in conjunction with an application server like Passenger. Read Digital Ocean's <a href=\"https://www.digitalocean.com/community/tutorials/how-to-deploy-a-rails-app-with-passenger-and-apache-on-ubuntu-14-04\" rel=\"nofollow noreferrer\">\"How To Deploy a Rails App with Passenger and Apache on Ubuntu 14.04\"</a> tutorial for more information.</p>\n\n<p>I have personally deployed Ruby apps with Passenger Phusion + Nginx as well.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1484173118, "last_edit_date": 1592644375, "creation_date": 1484173118, "answer_id": 41601736, "question_id": 41598045, "link": "https://stackoverflow.com/questions/41598045/how-does-the-ruby-interpreter-integrate-with-http-servers-like-apache/41601736#41601736", "title": "How does the Ruby interpreter integrate with HTTP servers like Apache?", "body": "<p>There are many different ways to do that.</p>\n<h1>CGI</h1>\n<p>The oldest way is the Common Gateway Interface (CGI), introduced in 1993 in the NCSA webserver and supported by every webserver since. It is an extremely simple protocol: the webserver sets a standardized set of environment variables containing information about the request, calls a program, that program can then examine the environment variables and write its response to stdout, which the webserver simply sends back. The next request starts the cycle (and the program) all over again.</p>\n<p>Here's an extremely simple CGI example in Ruby (I don't have Apache installed, so I couldn't test this):</p>\n<pre><code>#!/usr/bin/env ruby\n\n# We need to send the header as well, the webserver won't do it for us\nputs 'Content-type: text/html'\nputs\n\nputs &lt;&lt;~&quot;HTML&quot;\n  &lt;!DOCTYPE html&gt;\n  &lt;html lang=&quot;en&quot;&gt;\n    &lt;head&gt;\n      &lt;meta charset=&quot;utf-8&quot;&gt;\n      &lt;title&gt;CGI Demo Script in Ruby&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n      &lt;p&gt;\n        My name is #{ENV['SCRIPT_NAME']} and you called me with the path #{ENV['PATH_INFO']} and query string #{ENV['QUERY_STRING']}.\n     &lt;/p&gt;\n    &lt;/body&gt;\n  &lt;/html&gt;\nHTML\n</code></pre>\n<h1>FastCGI</h1>\n<p>Since CGI starts a new process for every single request, and communication via environment variables and stdout isn't exactly efficient either, FastCGI was created in 1996. The idea is similar to CGI, but the handler process is not started for every request, instead the handler process stays in memory and handles the requests in a loop, and the communication between the webserver and the handler uses an efficient binary protocol.</p>\n<p>Communication uses either Unix sockets or TCP.</p>\n<h1>SCGI</h1>\n<p>The Simple Common Gateway Interface (SCGI), published 2006, is similar to FastCGI, but simpler and uses a text-based communication protocol (based on netstrings) instead of a binary one. It also avoids the overhead of firing up a process for every request, instead the handler program keeps running and simply processes the requests in a loop.</p>\n<h1>In-process modules</h1>\n<p>Almost every webserver has a module API that allows you to add your own code to the running webserver process. One of the earliest ones was the Netscape NSAPI, which appeared in the mid-90s and was a direct competitor to CGI, with FastCGI OTOH being developed as a reaction to it. IIS, Apache, Nginx, etc. all also have similar APIs. These differ from FastCGI and SCGI mainly in the fact that they don't run as a separate process but rather within the webserver process. This gives them maximum performance and maximum access to the webserver internals, but also maximum potential for damage.</p>\n<p>There are/were a couple of modules for running a Ruby execution engine inside a webserver. <code>mod_ruby</code> was an Apache module for embedding MRI inside Apache, <code>mod_rubinius</code> did the same thing for Rubinius. IronRuby could run inside IIS as a plugin.</p>\n<p>This is the solution that is classically employed by PHP (<code>mod_php</code>) and Perl (<code>mod_perl</code>). There are also <code>mod_python</code>, even <code>mod_mono</code> and <code>mod_java</code>.</p>\n<h1>Webserver interfaces</h1>\n<p>Webserver interfaces provide a standardized interface between web frameworks and webservers. Actually, Servlets could be seen as a distant relative.</p>\n<p>The most well-known interface in the Ruby world is Rack, but before there was Rack in Ruby, there were already WSGI (Web Server Gateway Interface) in Python, PSGI in Perl, and so on. The main idea behind such interfaces is that they provide a narrow, simple interface that decouples webframeworks and webservers. E.g. any Rack-compliant framework (Rails, Sinatra, Padrino, Cuba, Lotus, Ramaze, NYNY, Nancy, Crepe, Hobbit, Grape, Roy, \u2026) will work with any Rack-compliant webserver (Mongrel, Thin, Unicorn, Puma, \u2026) For example, before there was Rack, Rails had different code for running under Lighttpd, SCGI, FastCGI, CGI, and Webrick. Now, there's just Rack.</p>\n<p>For webservers which are not themselves Rack-compliant (e.g. because they were created before Rack or because they are language-agnostic), there are ways to implement Rack on top of them using any of the above-mentioned techniques, e.g. there is a <code>mod_rack</code> for Apache and Nginx.</p>\n<h2>Phusion Passenger</h2>\n<p>Phusion Passenger is a special-case of this. It is a Rack (and Python WSGI) server implemented as an extension module to Apache and Nginx.</p>\n<h1>Native webserver</h1>\n<p>Instead of running the language inside the webserver, you can also run the webserver inside the language, e.g. Webrick is a webserver written in Ruby that can run Rails.</p>\n"}, {"tags": [], "owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "is_accepted": false, "score": 1, "last_activity_date": 1484178348, "last_edit_date": 1484178348, "creation_date": 1484173956, "answer_id": 41601937, "question_id": 41598045, "link": "https://stackoverflow.com/questions/41598045/how-does-the-ruby-interpreter-integrate-with-http-servers-like-apache/41601937#41601937", "title": "How does the Ruby interpreter integrate with HTTP servers like Apache?", "body": "<p>As with all things, there are several ways to do it. <a href=\"https://www.phusionpassenger.com\" rel=\"nofollow noreferrer\">Phusion Passenger</a> provides <a href=\"https://www.phusionpassenger.com/library/install/apache\" rel=\"nofollow noreferrer\">Apache</a> and <a href=\"https://www.phusionpassenger.com/library/install/nginx\" rel=\"nofollow noreferrer\">NGINX</a> modules, which are relatively comparable to e.g. mod_php and mod_perl. It's also available in <a href=\"https://www.phusionpassenger.com/library/install/standalone/\" rel=\"nofollow noreferrer\">standalone</a> mode, which includes its own web server (i.e. no Apache or NGINX required). A good comparison between the three modes is available <a href=\"https://www.phusionpassenger.com/library/indepth/integration_modes.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Tiered web architectures will take Passenger in standalone mode and serve it from behind a <a href=\"https://www.phusionpassenger.com/library/deploy/standalone/reverse_proxy.html\" rel=\"nofollow noreferrer\">reverse proxy</a>, which can be anything from NGINX or Apache to other middlewares like HAProxy or Varnish. You might be familiar with this model because it is similar to how Jetty, Tomcat, etc. serve Java applications to the public Internet (i.e. from behind a reverse proxy). Advanced architectures may consist of multiple reverse proxies and application servers, each solving a different piece of the multi-tiered web architecture puzzle (e.g. SSL termination, load balancing, caching, compression, static asset serving, dynamic content). </p>\n\n<p>I actually prefer <a href=\"http://puma.io\" rel=\"nofollow noreferrer\">Puma</a>, which is analogous to Passenger standalone. It's easier to understand and (last time I checked) faster and more memory-efficient in many benchmarks. It gives you the option of a hybrid forking+threading mode that (again, last time I checked) is only available in Passenger Enterprise. Puma is the default web server in Rails and on Heroku and other hosting platforms. </p>\n"}], "owner": {"reputation": 30367, "user_id": 97901, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tZgrA.jpg?s=128&g=1", "display_name": "benstpierre", "link": "https://stackoverflow.com/users/97901/benstpierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1484178348, "creation_date": 1484159054, "question_id": 41598045, "link": "https://stackoverflow.com/questions/41598045/how-does-the-ruby-interpreter-integrate-with-http-servers-like-apache", "title": "How does the Ruby interpreter integrate with HTTP servers like Apache?", "body": "<p>I have been wondering how Ruby integrates with HTTP servers like Apache.  As a Java developer I understand the full stack of a servlet container and how the whole lifecycle works and how you could have a servlet or filter integrate different web frameworks into a standardized container HTTP lifecycle.</p>\n\n<p>That being said I was never clear on how other frameworks like Ruby managed to hook into the apache server.  Is it via a C api?  Some other standard?  </p>\n"}, {"tags": ["ruby", "github", "oauth", "sinatra"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7361207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b796204d0ae865c6570eb0c5b30bda?s=128&d=identicon&r=PG&f=1", "display_name": "zander", "link": "https://stackoverflow.com/users/7361207/zander"}, "edited": false, "score": 0, "creation_date": 1484184126, "post_id": 41601546, "comment_id": 70409624, "body": "Hi, I tried doing that and I&#39;m getting the same result. Is it because the way I&#39;m calling <code>&#47;login</code> is from an <code>href</code> in <code>index.erb</code>? Is it because the Redirect URL in the Github app is set to <code>&#47;</code>? @wjordan"}, {"owner": {"reputation": 16977, "user_id": 2518355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3ed231a208476815d1b89dcc045aa6?s=128&d=identicon&r=PG", "display_name": "wjordan", "link": "https://stackoverflow.com/users/2518355/wjordan"}, "reply_to_user": {"reputation": 27, "user_id": 7361207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b796204d0ae865c6570eb0c5b30bda?s=128&d=identicon&r=PG&f=1", "display_name": "zander", "link": "https://stackoverflow.com/users/7361207/zander"}, "edited": false, "score": 0, "creation_date": 1484185499, "post_id": 41601546, "comment_id": 70409969, "body": "@zander in order to provide a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that I or others can reproduce your issue, please add more complete contents of the Sinatra source code you&#39;re running, and the exact commands you&#39;re using to run your server in development. I&#39;m curious how the <code>GITHUB_</code> environment variables are provided and if that&#39;s consistent between your test app and this one."}, {"owner": {"reputation": 27, "user_id": 7361207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b796204d0ae865c6570eb0c5b30bda?s=128&d=identicon&r=PG&f=1", "display_name": "zander", "link": "https://stackoverflow.com/users/7361207/zander"}, "edited": false, "score": 0, "creation_date": 1484186742, "post_id": 41601546, "comment_id": 70410291, "body": "As seen in the code above, I am using a client ID and client secret from GitHub and what I listed above is pretty much all I have, I just left out the index.erb because that&#39;s just an href linking to <code>&#47;login</code>. In terms of the server, I&#39;m running <code>bundle exec shotgun -p 3000</code> and the redirect link is just <code>http:&#47;&#47;0.0.0.0:3000</code>, if I try to set it to <code>http:&#47;&#47;0.0.0.0:3000&#47;login</code>, an error shows up that the redirect URI is incorrect. It is going to Github normally, but the response link is not sending the user back to the Sinatra app @wjordan"}, {"owner": {"reputation": 27, "user_id": 7361207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b796204d0ae865c6570eb0c5b30bda?s=128&d=identicon&r=PG&f=1", "display_name": "zander", "link": "https://stackoverflow.com/users/7361207/zander"}, "edited": false, "score": 0, "creation_date": 1484187785, "post_id": 41601546, "comment_id": 70410587, "body": "The code is in a class in an <code>app.rb</code> file and the config.ru links to it but in an example I <a href=\"https://github.com/atmos/sinatra-auth-github-test/blob/master/config.ru\" rel=\"nofollow noreferrer\">saw</a> it was working in a config.ru @wjordan"}, {"owner": {"reputation": 16977, "user_id": 2518355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3ed231a208476815d1b89dcc045aa6?s=128&d=identicon&r=PG", "display_name": "wjordan", "link": "https://stackoverflow.com/users/2518355/wjordan"}, "reply_to_user": {"reputation": 27, "user_id": 7361207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b796204d0ae865c6570eb0c5b30bda?s=128&d=identicon&r=PG&f=1", "display_name": "zander", "link": "https://stackoverflow.com/users/7361207/zander"}, "edited": false, "score": 0, "creation_date": 1484188130, "post_id": 41601546, "comment_id": 70410677, "body": "have you tried calling <code>enable :sessions</code> within your Sinatra app?"}, {"owner": {"reputation": 27, "user_id": 7361207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b796204d0ae865c6570eb0c5b30bda?s=128&d=identicon&r=PG&f=1", "display_name": "zander", "link": "https://stackoverflow.com/users/7361207/zander"}, "edited": false, "score": 0, "creation_date": 1484188420, "post_id": 41601546, "comment_id": 70410747, "body": "yeah its been in there the entire time"}, {"owner": {"reputation": 16977, "user_id": 2518355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3ed231a208476815d1b89dcc045aa6?s=128&d=identicon&r=PG", "display_name": "wjordan", "link": "https://stackoverflow.com/users/2518355/wjordan"}, "reply_to_user": {"reputation": 27, "user_id": 7361207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b796204d0ae865c6570eb0c5b30bda?s=128&d=identicon&r=PG&f=1", "display_name": "zander", "link": "https://stackoverflow.com/users/7361207/zander"}, "edited": false, "score": 0, "creation_date": 1484188552, "post_id": 41601546, "comment_id": 70410781, "body": "Until you provide a complete example I can run locally and reproduce your issue (e.g., a public GitHub repo I can clone), I can&#39;t help any further, sorry."}, {"owner": {"reputation": 16977, "user_id": 2518355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3ed231a208476815d1b89dcc045aa6?s=128&d=identicon&r=PG", "display_name": "wjordan", "link": "https://stackoverflow.com/users/2518355/wjordan"}, "reply_to_user": {"reputation": 27, "user_id": 7361207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b796204d0ae865c6570eb0c5b30bda?s=128&d=identicon&r=PG&f=1", "display_name": "zander", "link": "https://stackoverflow.com/users/7361207/zander"}, "edited": false, "score": 0, "creation_date": 1484190386, "post_id": 41601546, "comment_id": 70411240, "body": "@zander with the actual code I managed to narrow down your issue to the use of <code>shotgun</code>. it works when using <code>rackup</code>. hope that helps!"}, {"owner": {"reputation": 16977, "user_id": 2518355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3ed231a208476815d1b89dcc045aa6?s=128&d=identicon&r=PG", "display_name": "wjordan", "link": "https://stackoverflow.com/users/2518355/wjordan"}, "reply_to_user": {"reputation": 27, "user_id": 7361207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b796204d0ae865c6570eb0c5b30bda?s=128&d=identicon&r=PG&f=1", "display_name": "zander", "link": "https://stackoverflow.com/users/7361207/zander"}, "edited": false, "score": 0, "creation_date": 1484191579, "post_id": 41601546, "comment_id": 70411522, "body": "Great, glad to hear it worked! If this answer helped solve your question, the last step is to <a href=\"http://meta.stackexchange.com/a/5235/327137\">mark it as Accepted</a>. Welcome to Stack Overflow!"}], "tags": [], "owner": {"reputation": 16977, "user_id": 2518355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3ed231a208476815d1b89dcc045aa6?s=128&d=identicon&r=PG", "display_name": "wjordan", "link": "https://stackoverflow.com/users/2518355/wjordan"}, "is_accepted": true, "score": 0, "last_activity_date": 1484190308, "last_edit_date": 1484190308, "creation_date": 1484172315, "answer_id": 41601546, "question_id": 41597989, "link": "https://stackoverflow.com/questions/41597989/sinatra-github-oauth-problems/41601546#41601546", "title": "Sinatra Github OAuth Problems", "body": "<p>It's possible that the issue you're experiencing is related to <a href=\"http://recipes.sinatrarb.com/p/development/shotgun#label-Shotgun\" rel=\"nofollow noreferrer\"><code>shotgun</code></a>. This gem reloads your entire application on every request, so it's possible there's an issue with maintaining the OAuth-login session state across the login-related requests.</p>\n\n<p>Running your application with <code>rackup</code> instead (as in the example app), I don't experience any problems:</p>\n\n<pre><code>bundle exec rackup -p 3000\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7361207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b796204d0ae865c6570eb0c5b30bda?s=128&d=identicon&r=PG&f=1", "display_name": "zander", "link": "https://stackoverflow.com/users/7361207/zander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 41601546, "answer_count": 1, "score": 1, "last_activity_date": 1484190308, "creation_date": 1484158850, "last_edit_date": 1484172524, "question_id": 41597989, "link": "https://stackoverflow.com/questions/41597989/sinatra-github-oauth-problems", "title": "Sinatra Github OAuth Problems", "body": "<p>I am using the <a href=\"https://github.com/atmos/sinatra_auth_github\" rel=\"nofollow noreferrer\"><code>sinatra_auth_github</code></a> gem to try and put GitHub OAuth into my Sinatra app. I was testing using the <a href=\"https://github.com/atmos/sinatra-auth-github-test\" rel=\"nofollow noreferrer\"><code>sinatra-auth-github-test</code></a> example app for a while and it worked. I went back to try and get some of that code to work in my app and though most of it worked, the redirect from GitHub doesn't.</p>\n\n<p>Can anyone recommend anything to help?</p>\n\n<p>Here's the code:</p>\n\n<pre><code>class SimpleApp &lt; Sinatra::Base\n  # [...]\n\n  set :github_options, {\n    :scope     =&gt; 'user',\n    :secret    =&gt; ENV['GITHUB_CLIENT_SECRET'],\n    :client_id =&gt; ENV['GITHUB_CLIENT_ID'],\n  }\n  register Sinatra::Auth::Github\n\n  get '/' do\n    erb :index\n  end\n\n  get '/login' do\n    authenticate!\n    \"Hello there, #{github_user.login}!\"\n  end\nend\n</code></pre>\n"}, {"tags": ["css", "ruby-on-rails", "ruby", "asset-pipeline"], "comments": [{"owner": {"reputation": 818, "user_id": 2509777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EyQvS.jpg?s=128&g=1", "display_name": "mlabarca", "link": "https://stackoverflow.com/users/2509777/mlabarca"}, "edited": false, "score": 2, "creation_date": 1484158521, "post_id": 41597613, "comment_id": 70398583, "body": "Is this on development or in production? Are you using asset precompilation? Does anything pop up in the web inspector console?"}, {"owner": {"reputation": 4391, "user_id": 3106174, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/mKAhl.jpg?s=128&g=1", "display_name": "Advice-Dog", "link": "https://stackoverflow.com/users/3106174/advice-dog"}, "reply_to_user": {"reputation": 818, "user_id": 2509777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EyQvS.jpg?s=128&g=1", "display_name": "mlabarca", "link": "https://stackoverflow.com/users/2509777/mlabarca"}, "edited": false, "score": 0, "creation_date": 1484159343, "post_id": 41597613, "comment_id": 70398991, "body": "Dev, I don&#39;t believe so, and no, just shows the URL but don&#39;t see anything."}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1484160009, "post_id": 41597613, "comment_id": 70399405, "body": "Try running manually <code>rake assets:clobber</code> and then <code>rake assets:precompile</code>. If this works, then you&#39;ll know your app is not precompiling your assets correctly."}, {"owner": {"reputation": 4391, "user_id": 3106174, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/mKAhl.jpg?s=128&g=1", "display_name": "Advice-Dog", "link": "https://stackoverflow.com/users/3106174/advice-dog"}, "edited": false, "score": 0, "creation_date": 1484160229, "post_id": 41597613, "comment_id": 70399529, "body": "I ran both of those and even restarted my server, still no go. Could this be a JS issue?"}, {"owner": {"reputation": 818, "user_id": 2509777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EyQvS.jpg?s=128&g=1", "display_name": "mlabarca", "link": "https://stackoverflow.com/users/2509777/mlabarca"}, "edited": false, "score": 1, "creation_date": 1484160583, "post_id": 41597613, "comment_id": 70399717, "body": "This is a bit of a long shot, but do you have a content security policy tag in your rendered html/layout? something like <code>&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src * ....</code>"}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1484160695, "post_id": 41597613, "comment_id": 70399775, "body": "Really strange... In cases like this I always consider the possibility of something really weird like mentioning <code>logo.png</code> but the real file is <code>logo.jpg</code>, or other kind of typo in the file name. It happened to me many times and sometimes things like this take a long time to notice."}, {"owner": {"reputation": 4391, "user_id": 3106174, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/mKAhl.jpg?s=128&g=1", "display_name": "Advice-Dog", "link": "https://stackoverflow.com/users/3106174/advice-dog"}, "edited": false, "score": 0, "creation_date": 1484160893, "post_id": 41597613, "comment_id": 70399882, "body": "I didn&#39;t see anything like that &lt;meta&gt; tag. And I checked the file name and file type. Even tried renaming it and changing it in both places to ensure."}, {"owner": {"reputation": 4243, "user_id": 4638378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pGqPN.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4638378/brian"}, "edited": false, "score": 3, "creation_date": 1484168897, "post_id": 41597613, "comment_id": 70404187, "body": "If you view source or inspect the element, what path is actually in the HTML?"}, {"owner": {"reputation": 4391, "user_id": 3106174, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/mKAhl.jpg?s=128&g=1", "display_name": "Advice-Dog", "link": "https://stackoverflow.com/users/3106174/advice-dog"}, "edited": false, "score": 0, "creation_date": 1484223389, "post_id": 41597613, "comment_id": 70427201, "body": "It generates this html: <code>&lt;img src=&quot;&#47;images&#47;logo.png&quot; alt=&quot;Logo&quot;&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4391, "user_id": 3106174, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/mKAhl.jpg?s=128&g=1", "display_name": "Advice-Dog", "link": "https://stackoverflow.com/users/3106174/advice-dog"}, "edited": false, "score": 0, "creation_date": 1484224047, "post_id": 41605916, "comment_id": 70427638, "body": "Same result without brackets, and there isn&#39;t anything special in my <code>application.html.erb</code>, it&#39;s mostly the default stuff with a few nav buttons."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7037425"}, "is_accepted": false, "score": 1, "last_activity_date": 1484199828, "creation_date": 1484199828, "answer_id": 41605916, "question_id": 41597613, "link": "https://stackoverflow.com/questions/41597613/ruby-on-rails-image-tag-cannot-find-local-image/41605916#41605916", "title": "Ruby on Rails - image_tag cannot find local image", "body": "<p>try\n        &lt;%= image_tag 'logo.png' %></p>\n\n<p>Also, can I see more of your application.html.erb file?</p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 3963445, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000034413203/picture?type=large", "display_name": "Masha Klimkin", "link": "https://stackoverflow.com/users/3963445/masha-klimkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1490354235, "creation_date": 1490354235, "answer_id": 42998143, "question_id": 41597613, "link": "https://stackoverflow.com/questions/41597613/ruby-on-rails-image-tag-cannot-find-local-image/42998143#42998143", "title": "Ruby on Rails - image_tag cannot find local image", "body": "<p>I had this problem with Rails 5.0.2.</p>\n\n<p>What eventually solved it is changing the version in the following line found, in my case, in config/assets.rb:</p>\n\n<pre><code>Rails.application.config.assets.version = '1.0'\n</code></pre>\n\n<p>According to <a href=\"http://guides.rubyonrails.org/asset_pipeline.html#upgrading-from-old-versions-of-rails\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/asset_pipeline.html#upgrading-from-old-versions-of-rails</a> it can be found in config/application.rb as well</p>\n\n<pre><code>config.assets.version = '1.0'\n</code></pre>\n\n<p>I guess the idea is that every time you update your assets you should update the asset version. I'm not sure it's worth it, so I'll probably will be removing the line completely.</p>\n"}, {"tags": [], "owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "is_accepted": false, "score": 1, "last_activity_date": 1521019114, "creation_date": 1521019114, "answer_id": 49273734, "question_id": 41597613, "link": "https://stackoverflow.com/questions/41597613/ruby-on-rails-image-tag-cannot-find-local-image/49273734#49273734", "title": "Ruby on Rails - image_tag cannot find local image", "body": "<p>You just need to put your image in assets/images/ and you can load it from any view by</p>\n\n<pre><code>&lt;%=image_tag(\"logo.png\")%&gt;\n</code></pre>\n\n<p>if rails fails to find your image then it will throw an exception <strong>AssetNotFound</strong> </p>\n"}], "owner": {"reputation": 4391, "user_id": 3106174, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/mKAhl.jpg?s=128&g=1", "display_name": "Advice-Dog", "link": "https://stackoverflow.com/users/3106174/advice-dog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1923, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1521019114, "creation_date": 1484157495, "last_edit_date": 1484223984, "question_id": 41597613, "link": "https://stackoverflow.com/questions/41597613/ruby-on-rails-image-tag-cannot-find-local-image", "title": "Ruby on Rails - image_tag cannot find local image", "body": "<p>I'm trying to display a logo image with <code>image_tag</code>, but it always comes up as a broken image.</p>\n\n<pre><code>// application.html.erb\n\n&lt;%= image_tag(\"logo.png\") %&gt;\n</code></pre>\n\n<p>I have \"logo.png\" in both <code>/assets/images/logo.png</code> and <code>/assets/logo.png</code> and have tried a lot of variations of the URL such as <code>images/logo.png</code>, <code>/images/logo.png</code>, <code>assets/images/logo.png</code>, etc but nothing seems to work.</p>\n\n<p>Any ideas on what I could be doing wrong?</p>\n\n<p>Thank you.</p>\n\n<p><strong>Edit: Addition information</strong></p>\n\n<p>I'm using <code>rails ~&gt; 5.0.1</code> with <code>bootstrap-sass ~&gt; 3.3.6</code>.</p>\n\n<p>The file is located at <code>/project_base/app/assets/images/logo.png</code>.</p>\n\n<p>Running <code>rake assets:clobber &amp; rake assets:precompie</code> doesn't seem to change anything.</p>\n\n<p>There is no generated asset for <code>logo.png</code> in <code>/project_base/public/...</code>.</p>\n\n<p>I haven't changed anything in the <code>development.rb</code> file, but tried adding:</p>\n\n<pre><code>config.assets.digest = false \nconfig.assets.compile = true \n</code></pre>\n\n<p>which still doesn't seem to effect the images.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "datetime", "ruby-on-rails-5", "delayed-job"], "answers": [{"comments": [{"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1484158788, "post_id": 41597903, "comment_id": 70398723, "body": "Hmm, how is Time.current different than Time.now.utc (if my server is set to UTC. I had just been tacking on &#39;utc&#39; just to be save, even though its not needed)"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1484159198, "post_id": 41597903, "comment_id": 70398925, "body": "Also, does the transaction finishing automatically unlock a record? Ive never used that method, looks great"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 1, "creation_date": 1484160871, "post_id": 41597903, "comment_id": 70399871, "body": "<code>Time.current</code> is <a href=\"http://stackoverflow.com/a/12748804/2483313\">preferred over</a> <code>Time.now</code>. And yes, the end of the transaction also releases the lock on the <code>unit</code>."}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1484161064, "post_id": 41597903, "comment_id": 70399974, "body": "Ahh interesting. And so does Time.current (with Rails set to <code>UTC</code>) still ackwnoledge +/- 1 hour DST?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1484161321, "post_id": 41597903, "comment_id": 70400103, "body": "No, it doesn&#39;t but that not important in the context of your worker, because the worker only cares about not generating duplicate invoices. But it it the external clock&#39;s responsibility to start the worker on time and it does (as far at it looks from your code above)."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 0, "last_activity_date": 1484158562, "creation_date": 1484158562, "answer_id": 41597903, "question_id": 41597568, "link": "https://stackoverflow.com/questions/41597568/how-to-make-a-job-idempotent-for-1-run-every-month-rails-5/41597903#41597903", "title": "How to make a job idempotent for 1 run every month (Rails 5)?", "body": "<p>I would do something like this in the worker:</p>\n\n<pre><code># `beginning_of_month` because we want to load units that haven't \n# been billed this month\nunits_to_bill = Unit.where(enabled: true)\n  .where('last_invoice_generated_at &lt; ?', Time.current.beginning_of_month)\n\n# `find_each` because it needs less memory\nunits_to_bill.find_each do |unit|\n\n  # Beginn a transaction to ensure all or nothing is updated\n  Unit.transaction do\n\n    # reload the unit, because it might have been updated by another \n    # task in the meantime\n    unit.reload\n\n    # lock the current unit for updates\n    unit.lock!\n\n    # check if the condition is still true\n    if unit.last_invoice_generated_at &lt; 1.month.ago\n\n      # generate invoices\n      # invoice = Invoice.create!(\n      # line_item = LineItem.create!(\n\n      # last step update unit\n      unit.update_attributes(\n        last_invoice_generated_at: Time.current\n      )\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 41597903, "answer_count": 1, "score": 0, "last_activity_date": 1484158562, "creation_date": 1484157326, "question_id": 41597568, "link": "https://stackoverflow.com/questions/41597568/how-to-make-a-job-idempotent-for-1-run-every-month-rails-5", "title": "How to make a job idempotent for 1 run every month (Rails 5)?", "body": "<p>I need to generate invoices once per month, according to the EST/EDT timezone (the clients are throughout the country but in this industry billing happens at the same timezone).</p>\n\n<p>I'm creating a <code>GenerateInvoicesJob</code> but I'm having trouble reasoning about a 100% perfect way to generate invoices so that there isn't any possible duplicate/confusion with regards to:</p>\n\n<ul>\n<li>Generate invoices only once per month</li>\n<li>Let the job run every day</li>\n<li>Make the job idempotent</li>\n</ul>\n\n<p>Then the final point which is the hard one for me, how do I ensure that there are no bugs with EST/DST and 1 hour slipping through.</p>\n\n<p>Here is my clock.rb:</p>\n\n<pre><code>every(1.day, 'GenerateInvoicesJob', tz: 'America/New_York', at: '04:00') do\n  Delayed::Job.enqueue GenerateInvoicesJob.new, queue: 'high'\nend\n</code></pre>\n\n<p>And here's the top of my job:</p>\n\n<pre><code>Unit.where(enabled: true)\n  .joins(:user)\n  .where('last_invoice_generated_at &lt;= ?', Time.now.utc.end_of_month)\n  .each do |unit|\n\n  ActiveRecord::Base.transaction do\n    unit.update_attributes(\n      last_invoice_generated_at: Time.now.utc\n    )\n    invoice = Invoice.create!(\n      ...\n    )\n    line_item = LineItem.create!(\n      ...\n    )\n  end\n</code></pre>\n\n<p>I realize the direct conditional logic might be wrong, so that's not entirely my question... my main addition to that question is whats the best way overall to do this so I can make sure that all times in EST are 100% accounted for, including weird off-by-1-hour bugs, etc. This job is super important so I'm hesitant on a way to make it perfect.</p>\n\n<p>On top of that I\"m not sure whether I should store UTC in the database.... normally I know you always are supposed to store UTC, but I know UTC doesnt have DST so I'm afraid if I store it like that, the job could run one time and invoices would be not run properly</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 482, "user_id": 213191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ecb37878cb8bc1d330473023f1eeca?s=128&d=identicon&r=PG", "display_name": "Peter H. Boling", "link": "https://stackoverflow.com/users/213191/peter-h-boling"}, "is_accepted": true, "score": 4, "last_activity_date": 1484523450, "creation_date": 1484523450, "answer_id": 41667574, "question_id": 41597169, "link": "https://stackoverflow.com/questions/41597169/unknown-host-error-while-updating-ruby-gems/41667574#41667574", "title": "Unknown Host Error while updating Ruby-Gems", "body": "<p>Unsure what version of rubygems you have installed, however there are three ways to fix:</p>\n\n<ol>\n<li>network issues - try again later.</li>\n<li><p>the version you have is bricked for updates, and you will need to install another way</p>\n\n<blockquote>\n  <p>NOTE: RubyGems 1.1 and 1.2 have problems upgrading when there is no rubygems-update installed. You will need to use the following instructions if you see Nothing to update. If you have an older version of RubyGems installed, then you can still do it in two steps:</p>\n</blockquote>\n\n<p><code>$ gem install rubygems-update  # might need to be admin/root</code></p>\n\n<p><code>$ update_rubygems</code></p></li>\n<li><p>Failing that you have to get your hands dirty:</p>\n\n<ul>\n<li>Download from <a href=\"https://rubygems.org/pages/download\" rel=\"nofollow noreferrer\">https://rubygems.org/pages/download</a></li>\n<li>Unpack into a directory and cd there</li>\n<li>Install with: ruby setup.rb (you may need admin/root privilege)</li>\n</ul></li>\n</ol>\n\n<p>See <a href=\"https://rubygems.org/pages/download\" rel=\"nofollow noreferrer\">https://rubygems.org/pages/download</a> for more info</p>\n"}], "owner": {"reputation": 83, "user_id": 7405908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34526901d1596f578a7485401a8e1895?s=128&d=identicon&r=PG&f=1", "display_name": "SUBHASH SAURABH", "link": "https://stackoverflow.com/users/7405908/subhash-saurabh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7920, "favorite_count": 1, "accepted_answer_id": 41667574, "answer_count": 1, "score": 8, "last_activity_date": 1590717029, "creation_date": 1484155924, "last_edit_date": 1484199709, "question_id": 41597169, "link": "https://stackoverflow.com/questions/41597169/unknown-host-error-while-updating-ruby-gems", "title": "Unknown Host Error while updating Ruby-Gems", "body": "<p>I am trying to update ruby gems by using:</p>\n\n<pre><code>gem update --system \n</code></pre>\n\n<p>But I am getting error:</p>\n\n<blockquote>\n  <p>ERROR:  While executing gem ...(Gem::RemoteFetcher::UnknownHostError)\n      no such name     (<a href=\"https://rubygems.org/specs.4.8.gz\" rel=\"noreferrer\">https://rubygems.org/specs.4.8.gz</a>). </p>\n</blockquote>\n"}, {"tags": ["javascript", "jquery", "ruby", "twitter-bootstrap"], "answers": [{"comments": [{"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "edited": false, "score": 1, "creation_date": 1484560069, "post_id": 41600182, "comment_id": 70544387, "body": "Thanks a lot for your help."}], "tags": [], "owner": {"reputation": 1215, "user_id": 5872672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DdyYO.png?s=128&g=1", "display_name": "Dan_", "link": "https://stackoverflow.com/users/5872672/dan"}, "is_accepted": true, "score": 1, "last_activity_date": 1484166764, "creation_date": 1484166764, "answer_id": 41600182, "question_id": 41597079, "link": "https://stackoverflow.com/questions/41597079/recalculate-the-same-javascript-variable-on-each-bootstrap-carousel-slide/41600182#41600182", "title": "Recalculate the same javascript variable on each Bootstrap carousel slide", "body": "<p>I am not someone who has used ruby, but surely only the script inside the reached 'if' block is called? Is that not the case? Either way you could try the following;</p>\n\n<p>The code initializing all of the carousel.</p>\n\n<pre><code>...\n&lt;div id=\"myCarousel\" class=\"carousel slide\" data-ride=\"carousel\"&gt;\n...\n</code></pre>\n\n<p>The items inside the carousel;</p>\n\n<pre><code>&lt;div class=\"item\" data-slidetype=\"twitter\"&gt;\n  &lt;img src=\"...\" alt=\"...\"&gt;\n  &lt;div class=\"carousel-caption\"&gt;\n    ...\n  &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;div class=\"item\" data-slidetype=\"instagram\"&gt;\n  &lt;img src=\"...\" alt=\"...\"&gt;\n  &lt;div class=\"carousel-caption\"&gt;\n    ...\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Then the following javascript;</p>\n\n<pre><code>myCarousel.on('slide.bs.carousel', function (e) {\n    console.log(e.relatedTarget.dataset.slidetype);\n});\n</code></pre>\n\n<p>The console will either output 'twitter' or 'instagram' dependent on the active slide. You can then use this event to trigger whichever calculations you want.</p>\n\n<pre><code>myCarousel.on('slide.bs.carousel', function (e) {\n    var activeSlide = e.relatedTarget.dataset.slidetype\n    if ( activeSlide == \"instagram\" ) {\n        // Insta calculations\n    } else if ( activeSlide == \"twitter\" ) { \n        // twitter calculations\n    }\n});\n</code></pre>\n\n<p>This is all from a JS point of view though but maybe you can salvage something. Makes use of data attributes assigned to the various items but you could use another property or look at children if they contain the information you need.</p>\n"}], "owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 41600182, "answer_count": 1, "score": 0, "last_activity_date": 1484166764, "creation_date": 1484155658, "question_id": 41597079, "link": "https://stackoverflow.com/questions/41597079/recalculate-the-same-javascript-variable-on-each-bootstrap-carousel-slide", "title": "Recalculate the same javascript variable on each Bootstrap carousel slide", "body": "<p>I have a popin/modal (using <a href=\"http://github.hubspot.com/messenger/\" rel=\"nofollow noreferrer\">Hubspot Messenger</a>) that contains a  Bootstrap 3 carousel. On each slide of the carousel a different \"social embed\" (like facebook or <a href=\"https://dev.twitter.com/rest/reference/get/statuses/oembed\" rel=\"nofollow noreferrer\">twitter embed</a>) appears and I want to resize the width of the modal/popin according to the size of the image.</p>\n\n<p>What I basically do is change the width of the modal (cases of slides come from a backoffice, so using my backend language Ruby):</p>\n\n<pre><code>$(\"ul.messenger.messenger-fixed\").css(\"width\",insta_classic_size);\n</code></pre>\n\n<p>The whole code is:</p>\n\n<pre><code>&lt;div class=\"item &lt;% if index == 0 %&gt;active&lt;% end%&gt;\"&gt;      \n\n        &lt;% if slide['modal_slide_type'] == \"instagram\" %&gt;\n          &lt;script&gt;  \n              var insta_size = Math.max( Math.floor(embedWidth), 320);                      \n              $(\"ul.messenger.messenger-fixed\").css(\"width\",insta_size); \n          &lt;/script&gt;\n\n        &lt;% elsif slide['modal_slide_type'] == \"twitter\" %&gt;   \n\n          &lt;script&gt; \n            var twitter_size = Math.floor(embedWidth);           \n            $(\"ul.messenger.messenger-fixed\").css(\"width\",twitter_size); \n\n          &lt;/script&gt;\n\n       and so on... many different other types of slides...\n</code></pre>\n\n<p>My problem is that when I load the modal/popin, all the scripts are executed, that is to say in the above example the TWO blocks of  and..as expected the value of $(\"ul.messenger.messenger-fixed\")'s width is set to the latest block being executed, here meaning twitter_size.\nso even the first  block will have a $(\"ul.messenger.messenger-fixed\")'s width' width set to twitter_size instead of what I wanted to, that is to say a width equal to insta_size.</p>\n\n<p>Basically what I need is to know how to prevent the code to execute ALL the scripts or to tell him to <strong>Recalculate the value on each slide when it becomes visible (=active)</strong>.</p>\n\n<p>I tried using some <a href=\"http://getbootstrap.com/javascript/#carousel-events\" rel=\"nofollow noreferrer\">BS carousel events</a> but failed to succeed.</p>\n"}, {"tags": ["ruby", "windows", "tiny-tds"], "comments": [{"owner": {"reputation": 1, "user_id": 7405885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/729359e593e8577bacb5533305b1ce87?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar", "link": "https://stackoverflow.com/users/7405885/kumar"}, "edited": false, "score": 0, "creation_date": 1485207372, "post_id": 41597007, "comment_id": 70820345, "body": "no answers from anyone? Am I the only one with this problem?"}], "answers": [{"tags": [], "owner": {"reputation": 5470, "user_id": 2568849, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/UxtGh.png?s=128&g=1", "display_name": "Mesut GUNES", "link": "https://stackoverflow.com/users/2568849/mesut-gunes"}, "is_accepted": false, "score": 0, "last_activity_date": 1490967802, "creation_date": 1490967802, "answer_id": 43142258, "question_id": 41597007, "link": "https://stackoverflow.com/questions/41597007/tinytdserror-exception-read-from-the-server-failed-servername/43142258#43142258", "title": "TinyTds::Error Exception: Read from the server failed (serverName)", "body": "<p>You should provide all parameters for tiny_tds client depend on <a href=\"https://github.com/rails-sqlserver/tiny_tds#tinytdsclient-usage\" rel=\"nofollow noreferrer\">git doc</a>, see the below:</p>\n\n<pre><code>client = TinyTds::Client.new username: 'sa', password: 'secret', host: 'mydb.host.net'\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7405885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/729359e593e8577bacb5533305b1ce87?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar", "link": "https://stackoverflow.com/users/7405885/kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490967802, "creation_date": 1484155472, "last_edit_date": 1484156388, "question_id": 41597007, "link": "https://stackoverflow.com/questions/41597007/tinytdserror-exception-read-from-the-server-failed-servername", "title": "TinyTds::Error Exception: Read from the server failed (serverName)", "body": "<p>Using Windows 7, Ruby version 2.2.4, tiny_tds version 1.0.0, and the targeted sql server runs in SQL Server 2012.</p>\n\n<p>Code: </p>\n\n<p>require 'tiny_tds'</p>\n\n<pre><code>client = TinyTds::Client.new dataserver:'serverName', database: 'databaseName'\n</code></pre>\n\n<p>Just an fyi, I am providing my actual serverName and databaseName in my actual code.</p>\n\n<p>Running this gives the error \"TinyTds::Error Exception: Read from the server failed (serverName)\"  </p>\n\n<p>Has anyone had this issue and was able to fix it? I am assuming some issue caused by version updates of ruby and/or tiny_tds, since it was working few months back... but I am running out of ideas. \nMy apologies ahead of time if some other pertinent info is left out of this question. I would be more than happy to provide any extra info as needed. </p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "redis"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1484153077, "post_id": 41596013, "comment_id": 70395252, "body": "Is your Redis running on the same machine or on another server?"}, {"owner": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1484154151, "post_id": 41596013, "comment_id": 70395931, "body": "@spickermann: I have a local Redis instance for development and a Heroku Redis instance in production, and we see it on both. (although the local instance appears to be able to handle longer strings before going kaput)."}], "answers": [{"comments": [{"owner": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "edited": false, "score": 0, "creation_date": 1484158777, "post_id": 41596919, "comment_id": 70398716, "body": "Great, I&#39;ll make a bug report to them. Thanks!"}], "tags": [], "owner": {"reputation": 39563, "user_id": 3160475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8989da0a2c491338617b07df53e60c?s=128&d=identicon&r=PG", "display_name": "Itamar Haber", "link": "https://stackoverflow.com/users/3160475/itamar-haber"}, "is_accepted": true, "score": 1, "last_activity_date": 1484155205, "creation_date": 1484155205, "answer_id": 41596919, "question_id": 41596013, "link": "https://stackoverflow.com/questions/41596013/redis-timing-out-on-long-strings-below-the-512-mb-max/41596919#41596919", "title": "Redis timing out on long strings (below the 512 MB max)", "body": "<p>This isn't a Redis limitation, more likely a client setting. Repeating the example with a different client (Python's redis-py) does not reproduce the issue:</p>\n\n<pre><code>In [1]: long_string = \"x\" * 9000000\n\nIn [2]: len(long_string) / (1024.0 ** 2)\nOut[2]: 8.58306884765625\n\nIn [3]: import redis\n\nIn [4]: r = redis.StrictRedis()\n\nIn [5]: r.set('test', long_string)\nOut[5]: True\n\nIn [6]: longer = long_string * 50\n\nIn [7]: r.set('test2', longer)\nOut[7]: True\n\nIn [8]: r.strlen('test2')\nOut[8]: 450000000\n</code></pre>\n"}], "owner": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 1, "accepted_answer_id": 41596919, "answer_count": 1, "score": 1, "last_activity_date": 1484155205, "creation_date": 1484152415, "last_edit_date": 1495542278, "question_id": 41596013, "link": "https://stackoverflow.com/questions/41596013/redis-timing-out-on-long-strings-below-the-512-mb-max", "title": "Redis timing out on long strings (below the 512 MB max)", "body": "<p>This is using the <a href=\"https://github.com/redis/redis-rb\" rel=\"nofollow noreferrer\">Ruby client</a>.</p>\n\n<pre><code>&gt; long_string = 'x' * 9_000_000; \"created\"\n\"created\"\n&gt; long_string.bytesize / (1024.0 * 1024.0) # size in megabytes\n8.58306884765625\n&gt; client.set('test', long_string)\nRedis::TimeoutError: Connection timed out\n</code></pre>\n\n<p>I get the timeout error after five seconds (the default timeout). When I raise the timeout even to ten minutes, it still fails. Whether this happens also seems to be dependent on past calls to <code>client.set</code>, even at different keys. </p>\n\n<p>According to the <a href=\"https://redis.io/topics/data-types\" rel=\"nofollow noreferrer\">documentation</a>, the max size for strings is 512 MB. Is this over-optimistic?</p>\n\n<p><a href=\"https://stackoverflow.com/a/11861586/2339708\">This answer</a> vaguely suggests that Redis is not meant to handle long strings. Is that what's going on, or is the issue in the Ruby library?</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 126, "user_id": 5747405, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f6df507d43a44a61ddad066e32a90c40?s=128&d=identicon&r=PG&f=1", "display_name": "Shital luitel", "link": "https://stackoverflow.com/users/5747405/shital-luitel"}, "edited": false, "score": 0, "creation_date": 1484153276, "post_id": 41596007, "comment_id": 70395358, "body": "Yeah it worked but it gave raise to new problem... now it says ActionController::InvalidAuthenticityToken (ActionController::InvalidAuthenticityToken):"}, {"owner": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "reply_to_user": {"reputation": 126, "user_id": 5747405, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f6df507d43a44a61ddad066e32a90c40?s=128&d=identicon&r=PG&f=1", "display_name": "Shital luitel", "link": "https://stackoverflow.com/users/5747405/shital-luitel"}, "edited": false, "score": 0, "creation_date": 1484153456, "post_id": 41596007, "comment_id": 70395479, "body": "You need to make sure that you&#39;re properly passing around the authenticity token. Check this: <a href=\"http://stackoverflow.com/questions/7203304/warning-cant-verify-csrf-token-authenticity-rails\" title=\"warning cant verify csrf token authenticity rails\">stackoverflow.com/questions/7203304/&hellip;</a>"}, {"owner": {"reputation": 126, "user_id": 5747405, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f6df507d43a44a61ddad066e32a90c40?s=128&d=identicon&r=PG&f=1", "display_name": "Shital luitel", "link": "https://stackoverflow.com/users/5747405/shital-luitel"}, "edited": false, "score": 0, "creation_date": 1484153671, "post_id": 41596007, "comment_id": 70395623, "body": "Can&#39;t verify CSRF token authenticity. Completed 422 Unprocessable Entity in 16ms (ActiveRecord: 0.0ms)      ActionController::InvalidAuthenticityToken (ActionController::InvalidAuthenticityToken):"}, {"owner": {"reputation": 126, "user_id": 5747405, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f6df507d43a44a61ddad066e32a90c40?s=128&d=identicon&r=PG&f=1", "display_name": "Shital luitel", "link": "https://stackoverflow.com/users/5747405/shital-luitel"}, "edited": false, "score": 0, "creation_date": 1484153722, "post_id": 41596007, "comment_id": 70395657, "body": "This is the full error provided when i submit my form using cross-platform request...."}, {"owner": {"reputation": 126, "user_id": 5747405, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f6df507d43a44a61ddad066e32a90c40?s=128&d=identicon&r=PG&f=1", "display_name": "Shital luitel", "link": "https://stackoverflow.com/users/5747405/shital-luitel"}, "edited": false, "score": 0, "creation_date": 1484153826, "post_id": 41596007, "comment_id": 70395726, "body": "Do you want to see my form?"}, {"owner": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "reply_to_user": {"reputation": 126, "user_id": 5747405, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f6df507d43a44a61ddad066e32a90c40?s=128&d=identicon&r=PG&f=1", "display_name": "Shital luitel", "link": "https://stackoverflow.com/users/5747405/shital-luitel"}, "edited": false, "score": 0, "creation_date": 1484153903, "post_id": 41596007, "comment_id": 70395778, "body": "Just go ahead and debug the code that passes Authenticity Token. One thing that I&#39;m seeing is that the <code>$.ajaxSetup</code> should be inside the <code>$(document).ready</code> function."}], "tags": [], "owner": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "is_accepted": true, "score": 5, "last_activity_date": 1484152409, "creation_date": 1484152409, "answer_id": 41596007, "question_id": 41595922, "link": "https://stackoverflow.com/questions/41595922/rails-cors-actioncontrollerroutingerror-no-route-matches-options-batches/41596007#41596007", "title": "Rails CORS: ActionController::RoutingError (No route matches [OPTIONS] &quot;/batches&quot;):", "body": "<p>You need to configure Rails to support <em>CORS</em>.</p>\n\n<p>One solution is to use the <a href=\"https://github.com/cyu/rack-cors\" rel=\"noreferrer\">rack-cors</a> gem.</p>\n\n<p>The following snipped will be needed to be added to <em>config/application.rb</em></p>\n\n<pre><code>module YourApp\n  class Application &lt; Rails::Application\n\n    # ...\n\n    # Rails 3/4\n\n    config.middleware.insert_before 0, \"Rack::Cors\" do\n      allow do\n        origins '*'\n        resource '*', :headers =&gt; :any, :methods =&gt; [:get, :post, :options]\n      end\n    end\n\n    # Rails 5\n\n    config.middleware.insert_before 0, Rack::Cors do\n      allow do\n        origins '*'\n        resource '*', :headers =&gt; :any, :methods =&gt; [:get, :post, :options]\n      end\n    end\n\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 126, "user_id": 5747405, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f6df507d43a44a61ddad066e32a90c40?s=128&d=identicon&r=PG&f=1", "display_name": "Shital luitel", "link": "https://stackoverflow.com/users/5747405/shital-luitel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1092, "favorite_count": 0, "accepted_answer_id": 41596007, "answer_count": 1, "score": 3, "last_activity_date": 1484154848, "creation_date": 1484152088, "last_edit_date": 1484154848, "question_id": 41595922, "link": "https://stackoverflow.com/questions/41595922/rails-cors-actioncontrollerroutingerror-no-route-matches-options-batches", "title": "Rails CORS: ActionController::RoutingError (No route matches [OPTIONS] &quot;/batches&quot;):", "body": "<p>I am trying to perform cross-platform request in rails.</p>\n\n<p>My jquery code is as follow:-</p>\n\n<pre><code>&lt;script&gt;\n    $.ajaxSetup({\n      headers: {\n        'X-CSRF-Token': $('meta[name=\"csrf-token\"]').attr('content')\n      }\n    });\n    $(document).ready(function () {\n        $('#submit-button').click(function() {\n            $.ajax({\n                type: \"POST\",\n                url: \"http://localhost:3000/batches\",\n                beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name=\"csrf-token\"]').attr('content'))},\n                xhrFields: {\n                    withCredentials: true\n                },\n                data: {     \n                    batch: {\n                      name: $(\"#name\").val(),\n                      course_id: $(\"#course_id\").val(),\n                      start_date: $(\"#start_date\").val(),\n                      end_date: $(\"#end_date\").val(),\n                      status: $(\"#batch_status\").val(),\n                      }\n                },\n                dataType: \"JSON\",\n              error: function(error) {\n                    console.log(error);\n                      },\n              success: function(data) {\n                         console.log(data);\n                         return false;\n                      },\n            })\n        });\n    })\n&lt;/script&gt;\n</code></pre>\n\n<p>And my control is as follow: -</p>\n\n<pre><code>def new\n    @batch = Batch.new\n    respond_to do |format|\n      format.json\n      format.html\n    end\n  end\n\n  def create\n    @batch = Batch.new(batch_param)\n    respond_to do |format|\n       if @batch.save\n         format.json { render json: @batch, status: :created, location: @batch }\n         format.html { redirect_to @batch, notice: \"Save process completed!\" }\n       else\n          format.html {\n            flash.now[:notice]=\"Save proccess coudn't be completed!\"\n            render json: @batch.errors, status: :unprocessable_entity\n          }\n          format.json { render json: @batch.errors, status: :unprocessable_entity}\n      end\n    end\n  end\ndef batch_param\n      params.require(:batch).permit(:name, :course_id, :start_date, :end_date, :status)\n    end\n</code></pre>\n\n<p>But each time when i try to add record using form it shows following error in rails log:-</p>\n\n<p>Error when i submit my first data</p>\n\n<pre><code>Started OPTIONS \"/batches\" for 127.0.0.1 at 2017-01-11 22:02:49 +0545\n  ActiveRecord::SchemaMigration Load (0.5ms)  SELECT \"schema_migrations\".* FROM \"schema_migrations\"\n\nActionController::RoutingError (No route matches [OPTIONS] \"/batches\"):\n</code></pre>\n\n<p>Error when i submit data more the one time: -</p>\n\n<pre><code>Started OPTIONS \"/batches\" for 127.0.0.1 at 2017-01-11 22:08:50 +0545\n\nActionController::RoutingError (No route matches [OPTIONS] \"/batches\"):\n</code></pre>\n\n<p>Can anyone help me in this problem.</p>\n"}, {"tags": ["ruby", "facebook", "facebook-graph-api", "facebook-messenger"], "comments": [{"owner": {"reputation": 1210, "user_id": 2590406, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000448320161/picture?type=large", "display_name": "Jonny Vu", "link": "https://stackoverflow.com/users/2590406/jonny-vu"}, "edited": false, "score": 0, "creation_date": 1484429350, "post_id": 41595847, "comment_id": 70509024, "body": "did you check facebook app permissions?"}], "answers": [{"tags": [], "owner": {"reputation": 1210, "user_id": 2590406, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000448320161/picture?type=large", "display_name": "Jonny Vu", "link": "https://stackoverflow.com/users/2590406/jonny-vu"}, "is_accepted": false, "score": 1, "last_activity_date": 1484430553, "creation_date": 1484430553, "answer_id": 41655358, "question_id": 41595847, "link": "https://stackoverflow.com/questions/41595847/facebookmessengerbotrecipientnotfound/41655358#41655358", "title": "Facebook::Messenger::Bot::RecipientNotFound", "body": "<p>I never have used hyperoslo framework like you but I found something that could explain your question.</p>\n\n<p>Your message value:</p>\n\n<pre><code>#&lt;Facebook::Messenger::Incoming::Message:0x007fdd2d4a40e0 @messaging={\"sender\"=&gt;{\"id\"=&gt;\"1349987331712XXX\"}, \"recipient\"=&gt;{\"id\"=&gt;\"1683630555268XXX\"}, \"timestamp\"=&gt;1484149162343, \"message\"=&gt;{\"mid\"=&gt;\"mid.1484149162343:d5a47f1649\", \"seq\"=&gt;121620, \"text\"=&gt;\"Why wont this work?\"}}&gt;\n</code></pre>\n\n<p>That mean, to get sender id, the code should be <code>@message['sender']['id']</code>\nBut I found on hyperoslo source (<a href=\"https://github.com/hyperoslo/facebook-messenger/blob/master/lib/facebook/messenger/incoming/common.rb\" rel=\"nofollow noreferrer\">https://github.com/hyperoslo/facebook-messenger/blob/master/lib/facebook/messenger/incoming/common.rb</a>), it seem inconsistent:</p>\n\n<pre><code>    def sender\n      @messaging['sender']\n    end\n\n    def recipient\n      @messaging['recipient']\n    end\n\n    def reply(message)\n      payload = {\n        recipient: sender,\n        message: message\n      }\n\n      Facebook::Messenger::Bot.deliver(payload, access_token: access_token)\n    end\n</code></pre>\n\n<p>I think, it should be <code>@messaging['sender']['id']</code> rather than <code>@messaging['sender']</code>.</p>\n\n<p>Anyway, take a look at this issue: <a href=\"https://github.com/hyperoslo/facebook-messenger/issues/96\" rel=\"nofollow noreferrer\">https://github.com/hyperoslo/facebook-messenger/issues/96</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 7405616, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154902245440908/picture?type=large", "display_name": "Gino Chiffi", "link": "https://stackoverflow.com/users/7405616/gino-chiffi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1484430553, "creation_date": 1484151856, "question_id": 41595847, "link": "https://stackoverflow.com/questions/41595847/facebookmessengerbotrecipientnotfound", "title": "Facebook::Messenger::Bot::RecipientNotFound", "body": "<p>I'm trying to build a messenger bot using the facebook messenger gem provided by Hypersolo: <a href=\"https://github.com/hyperoslo/facebook-messenger\" rel=\"nofollow noreferrer\">https://github.com/hyperoslo/facebook-messenger</a> </p>\n\n<p>I always get the following error: \nFacebook::Messenger::Bot::RecipientNotFound (Unsupported post request. Object with ID 'me' does not exist, cannot be loaded due to missing permissions, or does not support this operation. Please read the Graph API documentation at <a href=\"https://developers.facebook.com/docs/graph-api\" rel=\"nofollow noreferrer\">https://developers.facebook.com/docs/graph-api</a>)</p>\n\n<p>I assumed the error was due to an invalid or inactive access_token, however I requested a new one over and over again and the error remains. I checked my page subscriptions which seem to be fine as well as disabling message_echoes in webhooks.</p>\n\n<p>The code I'm using is simple:</p>\n\n<pre><code>require 'facebook/messenger'\ninclude Facebook::Messenger\n\nFacebook::Messenger::Subscriptions.subscribe(access_token: ENV[\"ACCESS_TOKEN\"])\n\nBot.on :message do |message|\n  message.reply(text: 'Hello, human!')\nend\n</code></pre>\n\n<p>Additionally; leaving out the reply and inspecting the message variable gives me a valid message object.</p>\n\n<pre><code>#&lt;Facebook::Messenger::Incoming::Message:0x007fdd2d4a40e0 @messaging={\"sender\"=&gt;{\"id\"=&gt;\"1349987331712XXX\"}, \"recipient\"=&gt;{\"id\"=&gt;\"1683630555268XXX\"}, \"timestamp\"=&gt;1484149162343, \"message\"=&gt;{\"mid\"=&gt;\"mid.1484149162343:d5a47f1649\", \"seq\"=&gt;121620, \"text\"=&gt;\"Why wont this work?\"}}&gt;\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "combinations", "arrayofarrays"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1484154621, "post_id": 41595669, "comment_id": 70396257, "body": "I&#39;m not following your formula, how are you deriving <code>[0,2],[0.3]</code> etc"}, {"owner": {"reputation": 102, "user_id": 5261487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87b2d70f9bb5a24c48b94809217fa22b?s=128&d=identicon&r=PG&f=1", "display_name": "jpf", "link": "https://stackoverflow.com/users/5261487/jpf"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1484160435, "post_id": 41595669, "comment_id": 70399634, "body": "0 is a value of arr[0], 2 is a value of arr[1], 3 is a value of arr[1].  So I need to pull no more than one value from arr[0], no more than one value from arr[1], and no more than one value from arr[2] to create combinations of two values. So no combinations of arr[0] and arr[0], nor arr[1] and arr[1], etc.  And I need to do this for a variable n in arr[n]."}], "answers": [{"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 3, "last_activity_date": 1484173197, "last_edit_date": 1484173197, "creation_date": 1484161902, "answer_id": 41598900, "question_id": 41595669, "link": "https://stackoverflow.com/questions/41595669/ruby-unique-combinations-of-2-from-n-arrays-of-different-sizes/41598900#41598900", "title": "Ruby Unique combinations of 2 from n arrays of different sizes", "body": "<h1>Arrays</h1>\n\n<p>You can use <a href=\"https://ruby-doc.org/core-2.3.1/Array.html#method-i-combination\" rel=\"nofollow noreferrer\"><code>combination</code></a> and Cartesian <a href=\"https://ruby-doc.org/core-2.3.1/Array.html#method-i-product\" rel=\"nofollow noreferrer\"><code>product</code></a> :</p>\n\n<pre><code>arrays = [[0, 1], [2, 3, 4], [5, 6, 7, 8]]\n\np arrays.combination(2).flat_map{ |a, b| a.product(b) }.sort\n#=&gt; [[0, 2], [0, 3], [0, 4], [1, 2], [1, 3], [1, 4], [0, 5], [0, 6], [0, 7], [0, 8], [1, 5], [1, 6], [1, 7], [1, 8], [2, 5], [2, 6], [2, 7], [2, 8], [3, 5], [3, 6], [3, 7], [3, 8], [4, 5], [4, 6], [4, 7], [4, 8]]\n\np arrays.combination(2).flat_map{ |a, b| a.product(b) }.sort\n#=&gt; [[0, 2], [0, 3], [0, 4], [0, 5], [0, 6], [0, 7], [0, 8], [1, 2], [1, 3], [1, 4], [1, 5], [1, 6], [1, 7], [1, 8], [2, 5], [2, 6], [2, 7], [2, 8], [3, 5], [3, 6], [3, 7], [3, 8], [4, 5], [4, 6], [4, 7], [4, 8]]\n\np arrays.combination(2).flat_map{|a,b| a.product(b)}.size\n#=&gt; 26\n</code></pre>\n\n<p>Calling <code>combination(2)</code> on the array outputs all the unique pairs of sub-arrays.\nFor each pair of arrays, every element of the first array is matched with every element of the second array (see <a href=\"https://en.wikipedia.org/wiki/Cartesian_product\" rel=\"nofollow noreferrer\">Cartesian product</a>).</p>\n\n<p><a href=\"https://ruby-doc.org/core-2.3.3/Enumerable.html#method-i-flat_map\" rel=\"nofollow noreferrer\"><code>flat_map</code></a> is here to avoid getting an array of arrays of arrays.</p>\n\n<h1>Size</h1>\n\n<h3>Using combinations</h3>\n\n<p>Your formula is correct for 3 sub-arrays. For <code>n</code> arrays, you need to list all the combinations of two sub-arrays, and sum the product of their respective size :</p>\n\n<pre><code>p arrays.map(&amp;:size).combination(2).map{|s1, s2| s1*s2}.inject(:+)\n#=&gt; 26\n</code></pre>\n\n<h3>Alternative</h3>\n\n<p>Using the fact that the expanded version of <code>(x+y+z)**2</code> is</p>\n\n<pre><code>x**2 + 2*xy + y**2 + 2*xz + 2*yz + z**2\n</code></pre>\n\n<p>we see that :</p>\n\n<pre><code>2*xy + 2*xz + 2*yz = (x+y+z)**2 - (x**2 + y**2 + z**2)\n</code></pre>\n\n<p>so </p>\n\n<pre><code>xy + xz + yz = ( (x+y+z)**2 - (x**2 + y**2 + z**2) )/2\n</code></pre>\n\n<p>It doesn't look like much of a shortcut for 3 values, but it generalizes to <code>n</code> arrays, and helps us avoid <code>combination</code> altogether :</p>\n\n<pre><code>sizes = arrays.map(&amp;:size)\np (sizes.inject(:+)**2 - sizes.map{|s| s**2}.inject(:+))/2\n#=&gt; 26\n</code></pre>\n"}], "owner": {"reputation": 102, "user_id": 5261487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87b2d70f9bb5a24c48b94809217fa22b?s=128&d=identicon&r=PG&f=1", "display_name": "jpf", "link": "https://stackoverflow.com/users/5261487/jpf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 0, "accepted_answer_id": 41598900, "answer_count": 1, "score": 2, "last_activity_date": 1484173197, "creation_date": 1484151333, "last_edit_date": 1484160799, "question_id": 41595669, "link": "https://stackoverflow.com/questions/41595669/ruby-unique-combinations-of-2-from-n-arrays-of-different-sizes", "title": "Ruby Unique combinations of 2 from n arrays of different sizes", "body": "<p>I have an array of <em>n</em> arrays all potentially of different sizes.  I need to calculate the possible combinations of 2 by using no more than one value from each array and print the total number.  For example:</p>\n\n<p>I have: </p>\n\n<pre><code>n = 3, in arr[n]\narr = [[0, 1], [2, 3, 4], [5, 6, 7, 8]]\n</code></pre>\n\n<p>I want to get:</p>\n\n<pre><code>[0, 2], [0, 3], [0, 4], [0, 5], [0, 6], [0, 7], [0, 8],\n[1, 8], [1, 3], [1, 4], [1, 5], [1, 6], [1, 7], [1, 8],\n[3, 5], [3, 6], [3, 7], [3, 8], \n[4, 5], [4, 6], [4, 7], [4, 8], etc.\n\nreturn number of arrays\n</code></pre>\n\n<p>Mathematically, I believe this is x<em>y + x</em>z + y*z or:</p>\n\n<pre><code>arr[0].size * arr[1].size + arr[0].size * arr[2].size + arr[1].size * arr[2].size\n</code></pre>\n\n<p>Feel free to correct me if I'm mistaken on that formula.</p>\n\n<p>Anyways, how can I achieve this for an unknown <em>n</em> arrays?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 5998, "user_id": 3889043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDMd.jpg?s=128&g=1", "display_name": "mrlew", "link": "https://stackoverflow.com/users/3889043/mrlew"}, "is_accepted": true, "score": 1, "last_activity_date": 1484151425, "creation_date": 1484151425, "answer_id": 41595701, "question_id": 41595298, "link": "https://stackoverflow.com/questions/41595298/skip-before-filter-for-the-login-action-of-devise/41595701#41595701", "title": "skip_before_filter for the &quot;login&quot; action of devise", "body": "<p>One approach is to override devise sessions controler:</p>\n\n<p><strong>1)</strong> create a <code>users/sessions_controller.rb</code> file:</p>\n\n<pre><code>class Users::SessionsController &lt; Devise::SessionsController\n   skip_before_filter :authenticate_user!\nend\n</code></pre>\n\n<p><strong>2)</strong> and set it on <code>routes.rb</code>:</p>\n\n<pre><code>devise_for :users, controllers: { sessions: \"users/sessions\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 471, "user_id": 2513295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBYmk.png?s=128&g=1", "display_name": "Hany Moh.", "link": "https://stackoverflow.com/users/2513295/hany-moh"}, "is_accepted": false, "score": 0, "last_activity_date": 1570203197, "creation_date": 1570203197, "answer_id": 58239441, "question_id": 41595298, "link": "https://stackoverflow.com/questions/41595298/skip-before-filter-for-the-login-action-of-devise/58239441#58239441", "title": "skip_before_filter for the &quot;login&quot; action of devise", "body": "<p><code>skip_before_filter</code> is deprecated, so try to <code>use skip_before_action</code></p>\n\n<p>it's worked with me</p>\n"}], "owner": {"reputation": 301, "user_id": 7338173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cf5f4cc9a6c6173f95951a727c87cc59?s=128&d=identicon&r=PG&f=1", "display_name": "Jodooomi", "link": "https://stackoverflow.com/users/7338173/jodooomi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 41595701, "answer_count": 2, "score": 0, "last_activity_date": 1570203197, "creation_date": 1484150238, "question_id": 41595298, "link": "https://stackoverflow.com/questions/41595298/skip-before-filter-for-the-login-action-of-devise", "title": "skip_before_filter for the &quot;login&quot; action of devise", "body": "<p>I can do this to skip calling \"authenticate_user\" in a certain controller where I need to:</p>\n\n<pre><code>class ApplicationController\n  before_filter :authenticate_user!\nend\n\nclass MyController &lt; ApplicationController\n  skip_before_filter :authenticate_user!\nend\n</code></pre>\n\n<p>I want to call <code>skip_before_filter</code> for \"login\" action of devise gem and I don't want to have to override anything else. How can I do that? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-admin"], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 5145402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d8b5ce978c5bdf6ca34c6a1d852d9b0?s=128&d=identicon&r=PG&f=1", "display_name": "Panda", "link": "https://stackoverflow.com/users/5145402/panda"}, "is_accepted": true, "score": 0, "last_activity_date": 1484168100, "last_edit_date": 1495540373, "creation_date": 1484168100, "answer_id": 41600518, "question_id": 41595157, "link": "https://stackoverflow.com/questions/41595157/ruby-cant-verify-csrf-token-authenticity-api-rails-admin-import/41600518#41600518", "title": "ruby can&#39;t verify csrf token authenticity api rails admin import", "body": "<p>How did you setup rails_admin?</p>\n\n<p>Did you try using different controllers for both API and RailsAdmin, adding the needed includes in the later? Namely including <code>ActionController::RequestForgeryProtection</code> as described in <a href=\"https://stackoverflow.com/questions/36840247/using-rails-admin-with-rails-api\">Using rails_admin with rails_api</a>?</p>\n"}], "owner": {"reputation": 3, "user_id": 7405448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d91ffc9ad989e2211626607ed9ee966?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Anacleto", "link": "https://stackoverflow.com/users/7405448/ricardo-anacleto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 1, "accepted_answer_id": 41600518, "answer_count": 1, "score": 0, "last_activity_date": 1484168100, "creation_date": 1484149792, "last_edit_date": 1484151286, "question_id": 41595157, "link": "https://stackoverflow.com/questions/41595157/ruby-cant-verify-csrf-token-authenticity-api-rails-admin-import", "title": "ruby can&#39;t verify csrf token authenticity api rails admin import", "body": "<p>I'm building a ruby API using rails admin (which is working) and rails admin import which has this problem:</p>\n\n<blockquote>\n  <p>Can't verify CSRF token authenticity.</p>\n</blockquote>\n\n<p>Tried to deactivate it with</p>\n\n<pre><code>module Api::V1\n  class ApiController &lt; ApplicationController     \n     skip_before_action :verify_authenticity_token\n...\nclass ApplicationController &lt; ActionController::API\n      skip_before_action :verify_authenticity_token\n</code></pre>\n\n<p>But the result was the same error. Any ideas?</p>\n\n<p>Thank you</p>\n\n<p>P.S:\nAlso getting this when I put the code above(as it apears not to be implemented)</p>\n\n<p><pre>\n\"status\":500,\"error\":\"Internal Server Error\"\n\"exception\":\"# ArgumentError: Before process_action callback :verify_authenticity_token has not been defined\"\n</pre></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"tags": [], "owner": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "is_accepted": false, "score": 3, "last_activity_date": 1484152740, "last_edit_date": 1484152740, "creation_date": 1484149815, "answer_id": 41595165, "question_id": 41594958, "link": "https://stackoverflow.com/questions/41594958/ruby-on-rails-how-to-handle-belongs-to-multiple-on-create/41595165#41595165", "title": "Ruby on Rails - how to handle belongs_to multiple on create", "body": "<p>No matter how you go about it, you do need to either set <code>discussion_id</code> or get it to be present in <code>comment_params</code>.</p>\n\n<p>Does this look less hacky to you?</p>\n\n<pre><code>def create\n    comment_params.merge(discussion_id: params[:discussion_id])\n    @comment = current_user.comments.build(comment_params)\n    ...\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4391, "user_id": 3106174, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/mKAhl.jpg?s=128&g=1", "display_name": "Advice-Dog", "link": "https://stackoverflow.com/users/3106174/advice-dog"}, "edited": false, "score": 0, "creation_date": 1484151726, "post_id": 41595433, "comment_id": 70394413, "body": "I tried your answer with merge, but it gives me an error.  &quot;undefined method `to_h&#39; for &quot;1&quot;:String Did you mean? to_r to_f to_i to_d to_c to_s&quot; for &quot;params.require(:comment).permit(:message, :group_id).merge(params.require(:discussion_id))&quot;"}, {"owner": {"reputation": 4391, "user_id": 3106174, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/mKAhl.jpg?s=128&g=1", "display_name": "Advice-Dog", "link": "https://stackoverflow.com/users/3106174/advice-dog"}, "edited": false, "score": 0, "creation_date": 1484153063, "post_id": 41595433, "comment_id": 70395243, "body": "Awesome, I got that working. Now I&#39;ll just need to get it working on the Discussion Model as that&#39;s also a nested under another Model. Thanks!"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 3, "last_activity_date": 1484152209, "last_edit_date": 1484152209, "creation_date": 1484150679, "answer_id": 41595433, "question_id": 41594958, "link": "https://stackoverflow.com/questions/41594958/ruby-on-rails-how-to-handle-belongs-to-multiple-on-create/41595433#41595433", "title": "Ruby on Rails - how to handle belongs_to multiple on create", "body": "<p>I would add the <code>:discussion_id</code> to the <code>comment_params</code> method:</p>\n\n<pre><code>def create\n  @comment = current_user.comments.build(comment_params)\n  ...\nend\n\nprivate\n\ndef comment_params\n  params.require(:comment)\n        .permit(...)\n        .merge(discussion_id: params.require(:discussion_id))\nend\n</code></pre>\n\n<p><strong>Or</strong> you could use <code>build</code> with a block:</p>\n\n<pre><code>def create\n  @comment = current_user.comments.build(comment_params) { |comment| \n    comment.discussion_id = params[:discussion_id] \n  }\n  # ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3134, "user_id": 183887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d83c876c3286901d4041aa73133cef?s=128&d=identicon&r=PG", "display_name": "kr00lix", "link": "https://stackoverflow.com/users/183887/kr00lix"}, "is_accepted": false, "score": 2, "last_activity_date": 1484150838, "creation_date": 1484150838, "answer_id": 41595495, "question_id": 41594958, "link": "https://stackoverflow.com/questions/41594958/ruby-on-rails-how-to-handle-belongs-to-multiple-on-create/41595495#41595495", "title": "Ruby on Rails - how to handle belongs_to multiple on create", "body": "<p>You can pass additional params in the block</p>\n\n<pre><code>params = ActionController::Parameters.new({\n  comment: {\n    name: 'Francesco',\n    body:  'Text'\n  }\n})\n\ncomment_params = params.require(:comment).permit(:name, :body)\n\ndef create\n  @comment = current_user.comments.build(comment_params) do |comment|\n    comment.discussion_id = params[:discussion_id]\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 1915599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2437f1cc6f91be4df87daadf648a858?s=128&d=identicon&r=PG", "display_name": "schnika", "link": "https://stackoverflow.com/users/1915599/schnika"}, "is_accepted": false, "score": 1, "last_activity_date": 1484151513, "creation_date": 1484151513, "answer_id": 41595730, "question_id": 41594958, "link": "https://stackoverflow.com/questions/41594958/ruby-on-rails-how-to-handle-belongs-to-multiple-on-create/41595730#41595730", "title": "Ruby on Rails - how to handle belongs_to multiple on create", "body": "<p>There are several things you need to keep in mind when you create an entity which is associated to more than one entity.</p>\n\n<p>With respect to your question regarding to best practices. I would like to emphasise the usage of an interactor here:</p>\n\n<pre><code># xx_controller.rb\ndef create\n  success = CreateComment.call(params)\n  if success\n     ....\n  else\n     ....\n  end\nend\n\n\n# ../../create_comment.rb\n# pseudocode\nclass CreateComment\n  def call(params)\n    validate your params # check if nothing is missing, the discussion exists and you have a user\n    build_and_save_your_comment\n    return_your_result_object # return a tuple or a result or whatever you need in order to handle errors and success cases...\n  end\nend\n</code></pre>\n\n<p>With this approach you keep the readability within your controller and you can focus on what matters to the comment creation in a dedicated place. </p>\n"}], "owner": {"reputation": 4391, "user_id": 3106174, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/mKAhl.jpg?s=128&g=1", "display_name": "Advice-Dog", "link": "https://stackoverflow.com/users/3106174/advice-dog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 41595433, "answer_count": 4, "score": 1, "last_activity_date": 1484152740, "creation_date": 1484149203, "question_id": 41594958, "link": "https://stackoverflow.com/questions/41594958/ruby-on-rails-how-to-handle-belongs-to-multiple-on-create", "title": "Ruby on Rails - how to handle belongs_to multiple on create", "body": "<p>I'm trying to create a Comment that belongs_to multiple Models but I'm not sure on what the best practice is to assign it to both.</p>\n\n<pre><code>class Comment &lt; ApplicationRecord\n    validates :message, :presence =&gt; true\n    belongs_to :user\n    belongs_to :discussion\nend\n</code></pre>\n\n<p>When creating a Comment within a Discussion, I run into the error \"Discussion must exist\". </p>\n\n<p>I'm using Devise so I am using current_user and building a Comment to align it with them, but I'm not sure on exactly how to point it to both. This seems to work, but seems very hacky. </p>\n\n<pre><code>def create\n    @comment = current_user.comments.build(comment_params)\n    @comment.discussion_id = params[:discussion_id]\n    ...\nend\n</code></pre>\n\n<p>What's the best practice?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "datatables"], "answers": [{"tags": [], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "is_accepted": true, "score": 0, "last_activity_date": 1484166282, "creation_date": 1484166282, "answer_id": 41600072, "question_id": 41594839, "link": "https://stackoverflow.com/questions/41594839/ruby-on-rails-using-functions-to-retrieve-data-from-model/41600072#41600072", "title": "Ruby on Rails: Using functions to retrieve data from model", "body": "<p>All I needed to do was change the below lines in my controller:</p>\n\n<pre><code>def group_member_name(group, i)\n    contact = Contactgroup.where(group_id: group).offset(i).pluck(:contact_id)\n    Contact.find_by_id(contact).firstname\nend\n</code></pre>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 41600072, "answer_count": 1, "score": 0, "last_activity_date": 1484166282, "creation_date": 1484148802, "last_edit_date": 1484153548, "question_id": 41594839, "link": "https://stackoverflow.com/questions/41594839/ruby-on-rails-using-functions-to-retrieve-data-from-model", "title": "Ruby on Rails: Using functions to retrieve data from model", "body": "<p>In my RoR application I am trying to display information from associated tables on a view.</p>\n\n<p>I have tables with data such as this:</p>\n\n<pre><code>Email\nid      subject\n1       This week's work\n2       Presentation\n3       Spreadsheets\n\nRecipients\nemail_id       group_id\n1              2\n2              2\n3              1\n1              3\n\nGroups\nid        name\n1         Managers\n2         Employees\n3         Directors\n\nContactgroups\ngroup_id        contact_id\n1               1\n2               1\n1               3\n3               2\n\nContacts\nid          email\n1           Gary\n2           Dave\n3           Annie\n</code></pre>\n\n<p>What I am trying to do is display a list of groups that were sent an email as well as each group member. For example, email 1 \"This week's work\" was sent to groups 1 \"Managers\" and 3 \"Directors\", the \"Managers\" group consists of the contacts Gary and Annie and the \"Directors\" group consists of the contact \"Dave\". So on the <code>show.html.erb</code> page I want to display the email's details as well as the groups it was sent to and each of their contacts.</p>\n\n<p>In order to do this, on the <code>show.html.erb</code> page I have the code:</p>\n\n<pre><code>&lt;p&gt;\n  &lt;strong&gt;Groups Sent To:&lt;/strong&gt;&lt;/br&gt;\n  &lt;% @recipients.each do |recipient| %&gt;\n        &lt;%= recipient.group.name %&gt;\n        &lt;% for i in 0..count_group_members(recipient.group.id)-1 do %&gt;\n            &lt;%= group_member_name(recipient.group.id, i) %&gt;\n        &lt;% end %&gt;&lt;/br&gt;\n  &lt;% end %&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>And in my <code>emails_controller</code> I have the code:</p>\n\n<pre><code>class EmailsController &lt; ApplicationController\n    helper_method :count_group_members, :group_member_name\n    def index\n        @useraccounts = Useraccount.where(user_id: session[:user_id])\n        accountsarray = [0]\n        @useraccounts.each do |f|\n            accountsarray &lt;&lt; f.account_id\n        end\n        # find all emails where the account_id is in the array - and so belongs to the user\n        @emails = Email.where(account_id: [accountsarray])\n    end\n    def show\n        @email = Email.find(params[:id])\n        @account = Account.find_by_id(@email.account_id)\n        @recipients = Recipient.where(email_id: @email.id)\n    end\n    def new\n        @email = Email.new\n        @email.recipients.build\n        @useraccounts = Useraccount.where(user_id: session[:user_id])\n    end\n    def edit\n        @email = Email.find(params[:id])\n        @useraccounts = Useraccount.where(user_id: session[:user_id])\n    end\n    def create\n        @email = Email.new(email_params)\n        if @email.save\n            redirect_to @email\n        else\n            render 'new'\n        end\n    end\n    def update\n        @email = Email.find(params[:id])\n        if @email.update(email_params)\n            redirect_to @email\n        else\n            render 'edit'\n        end\n    end\n    def destroy\n        @email = Email.find(params[:id])\n        @email.destroy\n        redirect_to emails_path\n    end\n    def count_group_members(group)\n        Contactgroup.where(group_id: group).count\n    end\n    def group_member_name(group, i)\n        contact = Contactgroup.where(group_id: group).offset(i).pluck(:contact_id)\n        Contact.where(id: contact).pluck(:firstname)\n    end\n    private\n    def email_params\n        params.require(:email).permit(:subject, :message, :account_id, { contact_ids: [] }, { group_ids: [] })\n    end\nend\n</code></pre>\n\n<p>The problem with this is that on the <code>show.html.erb</code> view a user sees the information like this:</p>\n\n<p><strong>Groups Sent To:</strong></p>\n\n<p>Managers [\"Gary\", \"Annie\"] [\"Annie\"]</p>\n\n<p>Directors [\"Dave\"] </p>\n\n<p>When I want is to display as:</p>\n\n<p><strong>Groups Sent To:</strong></p>\n\n<p>Managers Gary, Annie</p>\n\n<p>Directors Dave</p>\n\n<p>Can someone please help me with this?</p>\n"}, {"tags": ["ruby", "delegates", "constants"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1484152673, "post_id": 41594617, "comment_id": 70395008, "body": "You can&#39;t delegate constant lookup to something that is not a class or a module. If you want to do that, you could use <code>const_missing</code> and <code>const_get</code>."}], "answers": [{"comments": [{"owner": {"reputation": 921, "user_id": 3601621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/548735107/picture?type=large", "display_name": "Adzz", "link": "https://stackoverflow.com/users/3601621/adzz"}, "edited": false, "score": 0, "creation_date": 1484149909, "post_id": 41594890, "comment_id": 70393178, "body": "Ah I see, so I would have to wrap the constant in a method. I don&#39;t get why it doesn&#39;t pick up the name though? A constant is <i>almost</i> a class method right? (see here <a href=\"https://github.com/bbatsov/ruby-style-guide/issues/328\" rel=\"nofollow noreferrer\">github.com/bbatsov/ruby-style-guide/issues/328</a> )"}, {"owner": {"reputation": 75, "user_id": 1411131, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nIGRo.jpg?s=128&g=1", "display_name": "Linus Falck-Ytter", "link": "https://stackoverflow.com/users/1411131/linus-falck-ytter"}, "reply_to_user": {"reputation": 921, "user_id": 3601621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/548735107/picture?type=large", "display_name": "Adzz", "link": "https://stackoverflow.com/users/3601621/adzz"}, "edited": false, "score": 0, "creation_date": 1484152347, "post_id": 41594890, "comment_id": 70394824, "body": "You could also just address the constant in the other class directly, provided it has access to it - something like <code>Thing::CONSTANT</code>. As for your other question - A constant is just a type of variable - that github issue is referring to stylistic choices when declaring values inside of a class - in the first case the user is declaring a constant, and in the second case he&#39;s providing a accessor method for the constant."}], "tags": [], "owner": {"reputation": 75, "user_id": 1411131, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nIGRo.jpg?s=128&g=1", "display_name": "Linus Falck-Ytter", "link": "https://stackoverflow.com/users/1411131/linus-falck-ytter"}, "is_accepted": false, "score": 1, "last_activity_date": 1484149005, "creation_date": 1484149005, "answer_id": 41594890, "question_id": 41594617, "link": "https://stackoverflow.com/questions/41594617/can-i-use-forwardable-to-delegate-a-constant-in-ruby/41594890#41594890", "title": "Can I use Forwardable to delegate a constant in Ruby?", "body": "<p>Forwardable (and SingleForwardable) let you add class functions to your current class via a module. When you write a delegator you're specifying which methods are being passed on to the receiving object from the original module.</p>\n\n<p>In your example, <code>def_single_delegator :@thing, :CONSTANT</code> is being interpreted as the following: Defines a method <code>:CONSTANT</code> which delegates to accessor <code>:@thing</code> (i.e. it calls the method of the same name in accessor).</p>\n\n<p>As you can see, this is not passing on the value of the constant, instead it's passing on a method with the same name as the constant. If you want to pass on the same value as the constant you can provide an accessor method that returns to you the value of the original constant so that you can assign it in this class.</p>\n"}, {"comments": [{"owner": {"reputation": 921, "user_id": 3601621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/548735107/picture?type=large", "display_name": "Adzz", "link": "https://stackoverflow.com/users/3601621/adzz"}, "edited": false, "score": 0, "creation_date": 1484150060, "post_id": 41595167, "comment_id": 70393274, "body": "I always considered constants to be some kind of syntactic sugar for class methods though. I guess that was wrong"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 921, "user_id": 3601621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/548735107/picture?type=large", "display_name": "Adzz", "link": "https://stackoverflow.com/users/3601621/adzz"}, "edited": false, "score": 0, "creation_date": 1484150268, "post_id": 41595167, "comment_id": 70393413, "body": "No, a constant is a kind of variable, like global variables, local variables, instance variables, and class variables. It has absolutely nothing to do with methods. (Oh, and there are no class methods in Ruby. There are only instance methods. We may use the word &quot;class method&quot; to talk about an instance method that is defined on the singleton class of an instance of the <code>Class</code> class, but that is only a conversational convenience. There are no class methods in the Ruby language.)"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 1, "last_activity_date": 1484221911, "last_edit_date": 1592644375, "creation_date": 1484149819, "answer_id": 41595167, "question_id": 41594617, "link": "https://stackoverflow.com/questions/41594617/can-i-use-forwardable-to-delegate-a-constant-in-ruby/41595167#41595167", "title": "Can I use Forwardable to delegate a constant in Ruby?", "body": "<p>This one is answered by <a href=\"https://ruby-doc.org/stdlib/libdoc/forwardable/rdoc/SingleForwardable.html#method-i-def_single_delegator\" rel=\"nofollow noreferrer\">the documentation (<strong>bold</strong> emphasis mine)</a>:</p>\n<blockquote>\n<h1><code>def_single_delegator(accessor, method, new_name=method)</code></h1>\n<p>Defines a <strong>method</strong> <em>method</em> which delegates to <em>accessor</em> (i.e. it <strong>calls the method of the same name</strong> in <em>accessor</em>). If <em>new_name</em> is provided, it is used as the name for the delegate method.</p>\n</blockquote>\n<p>So, no, you can only delegate message sends, not constant lookup.</p>\n"}], "owner": {"reputation": 921, "user_id": 3601621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/548735107/picture?type=large", "display_name": "Adzz", "link": "https://stackoverflow.com/users/3601621/adzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 1, "accepted_answer_id": 41595167, "answer_count": 2, "score": 0, "last_activity_date": 1484223451, "creation_date": 1484148177, "last_edit_date": 1484223451, "question_id": 41594617, "link": "https://stackoverflow.com/questions/41594617/can-i-use-forwardable-to-delegate-a-constant-in-ruby", "title": "Can I use Forwardable to delegate a constant in Ruby?", "body": "<p>Given a class like:</p>\n\n<pre><code>class Thing\n  CONSTANT = 10\n  # other code\nend\n</code></pre>\n\n<p>And another like:</p>\n\n<pre><code>class Other\n  def initialize\n    @thing = Thing.new\n  end\n\n  def method\n    puts CONSTANT\n  end\nend\n</code></pre>\n\n<p>Is it possible to extend <code>Forwardable</code> to have <code>Other</code>'s <code>CONSTANT</code> delegate to <code>Thing</code>'s constant?</p>\n\n<p>I have tried extending<code>SingleForwardable</code> (see docs <a href=\"https://ruby-doc.org/stdlib-2.0.0/libdoc/forwardable/rdoc/SingleForwardable.html\" rel=\"nofollow noreferrer\">here</a> ) like so:</p>\n\n<pre><code>class Other\n  extend SingleForwardable\n\n  def initialize\n    @thing = Thing.new\n  end\n\n  def method\n    puts CONSTANT\n  end\n\n  def_single_delegator :@thing, :CONSTANT\nend\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>def_single_delegator :@thing, :constant\n</code></pre>\n\n<p>but neither worked, am I getting the syntax wrong? If not, is there another way?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1484147095, "post_id": 41594074, "comment_id": 70391356, "body": "You could just have a boolean field on answers called &quot;correct&quot; and mark which answers are correct, then you will know when the answer is submitted if it is correct or not at that point instead of running a check.  This solution is based on the assumption the user is selecting answers being presented to them."}, {"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1484147153, "post_id": 41594074, "comment_id": 70391392, "body": "Also watch out it looks like you have a typo in your submissions form, it says &quot;cotnent&quot; instead of &quot;content&quot;."}, {"owner": {"reputation": 21, "user_id": 7391609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72560d8654a68f1a5013fbe4d5e3c1db?s=128&d=identicon&r=PG&f=1", "display_name": "user7391609", "link": "https://stackoverflow.com/users/7391609/user7391609"}, "reply_to_user": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1484148397, "post_id": 41594074, "comment_id": 70392204, "body": "Hi @RockwellRice, thank you for the response, the user will be inputting their own answers and it will be presented to them,  I thought by using a find_by or a where, It would return as a boolean, true/false if the answer exists? no? Would it be better to use a where function instead of a find_by?"}], "owner": {"reputation": 21, "user_id": 7391609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72560d8654a68f1a5013fbe4d5e3c1db?s=128&d=identicon&r=PG&f=1", "display_name": "user7391609", "link": "https://stackoverflow.com/users/7391609/user7391609"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484146697, "creation_date": 1484146697, "question_id": 41594074, "link": "https://stackoverflow.com/questions/41594074/questions-and-answers-ruby-on-rails-website", "title": "Questions and Answers Ruby on Rails website", "body": "<p>I\u2019m developing question and answers application, where a user attempts to answer questions, I am looking to define a custom method rather than doing coding in the controller methods, creating a separate method that can be called to check the answer the user submitted against the answers database table, where the question_id and the user_input is the same as the Answers database.</p>\n\n<p>Can anyone guide me with where I am going wrong or is there a better approach to checking the user submitted input against the database and then inputting the submission into the database.</p>\n\n<p><strong>Submissions form</strong> </p>\n\n<pre><code>&lt;%= form_for :submission :controller =&gt; :submissions :action =&gt; 'check_answer' do |f| %&gt;\n&lt;%= f.text_field :contnet, :value =&gt; '' %&gt;\n&lt;%= f.submit 'Submit Answer' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Submissions_controller</strong></p>\n\n<pre><code>def check_answer\n  answer = Answer.find_by(question_id: params[:question_id][:content])\n  if answer.present?\n    #insert into submissions table, display correct and add to scoreboard\n  else\n    redirect_to competitions_path\n  end\nend\n</code></pre>\n\n<p><strong>Answers Table :</strong></p>\n\n<pre><code>  create_table \"answers\", force: :cascade do |t|\n    t.string   \"content\"\n    t.integer  \"question_id\"\n    t.datetime \"created_at\",  null: false\n    t.datetime \"updated_at\",  null: false\n  end\n</code></pre>\n\n<p><strong>Question_table :</strong></p>\n\n<pre><code> create_table \"members_questions\", force: :cascade do |t|\n    t.string   \"title\"\n    t.integer  \"category_id\"\n    t.integer  \"point_id\"\n    t.integer  \"event_id\"\n    t.datetime \"created_at\",         null: false\n    t.datetime \"updated_at\",         null: false\n    t.string   \"image_file_name\"\n    t.string   \"image_content_type\"\n    t.integer  \"image_file_size\"\n    t.datetime \"image_updated_at\"\n    t.string   \"file_file_name\"\n    t.string   \"file_content_type\"\n    t.integer  \"file_file_size\"\n    t.datetime \"file_updated_at\"\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "html5-video"], "comments": [{"owner": {"reputation": 1151, "user_id": 2468200, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AKp0O.jpg?s=128&g=1", "display_name": "Ivan Kolmychek", "link": "https://stackoverflow.com/users/2468200/ivan-kolmychek"}, "edited": false, "score": 0, "creation_date": 1484147006, "post_id": 41593967, "comment_id": 70391304, "body": "Have you tried to put coma before <code>:controls</code> in video tag arguments?"}, {"owner": {"reputation": 1, "user_id": 7402419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b67dfc735f6f29b88082f8249d575ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ruby", "link": "https://stackoverflow.com/users/7402419/ruby"}, "reply_to_user": {"reputation": 1151, "user_id": 2468200, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AKp0O.jpg?s=128&g=1", "display_name": "Ivan Kolmychek", "link": "https://stackoverflow.com/users/2468200/ivan-kolmychek"}, "edited": false, "score": 0, "creation_date": 1484152092, "post_id": 41593967, "comment_id": 70394655, "body": "Thanks. Adding a comma shows a video player with nothing in it. I can press the play button and it says that the video length is 0:00 seconds. There is a download button as well and clicking it downloads the correct video. However, the video player does not show anything other then a play and pause button and a progress bar with 0:00 seconds."}, {"owner": {"reputation": 1151, "user_id": 2468200, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AKp0O.jpg?s=128&g=1", "display_name": "Ivan Kolmychek", "link": "https://stackoverflow.com/users/2468200/ivan-kolmychek"}, "edited": false, "score": 0, "creation_date": 1484231849, "post_id": 41593967, "comment_id": 70432962, "body": "are you sure that the video is in format supported by your browser?"}, {"owner": {"reputation": 1, "user_id": 7402419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b67dfc735f6f29b88082f8249d575ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ruby", "link": "https://stackoverflow.com/users/7402419/ruby"}, "reply_to_user": {"reputation": 1151, "user_id": 2468200, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AKp0O.jpg?s=128&g=1", "display_name": "Ivan Kolmychek", "link": "https://stackoverflow.com/users/2468200/ivan-kolmychek"}, "edited": false, "score": 0, "creation_date": 1484337600, "post_id": 41593967, "comment_id": 70484886, "body": "Thank you! The video format was not supported, uploading another video format fixed the problem."}], "owner": {"reputation": 1, "user_id": 7402419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b67dfc735f6f29b88082f8249d575ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ruby", "link": "https://stackoverflow.com/users/7402419/ruby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484155983, "creation_date": 1484146358, "question_id": 41593967, "link": "https://stackoverflow.com/questions/41593967/ruby-on-rails-video-upload-via-carrier-upload-not-working", "title": "Ruby on Rails Video Upload Via Carrier Upload not working", "body": "<p>I'm trying to upload and display this video on my application built on Ruby on Rails. I am using the carrierwave gem to do this. I believe I have the file upload part working however when I go to my show method, no video is shown. The video is meant to be attached to a model called \"post\". I'm not fully sure how video tags work in Ruby. </p>\n\n<p>The video tag exists in this file.</p>\n\n<p><strong>show.html.erb</strong></p>\n\n<pre><code>&lt;h1&gt;Videos &lt;/h1&gt;\n&lt;% @posts.each do |post|%&gt;\n&lt;%= video_tag post.video_url.to_s%&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p><strong>posts_controller.rb</strong></p>\n\n<pre><code>def index\n  @posts = Post.all\nend\n\n\ndef show\n  @posts=Post.all\nend\n\n\ndef new\n  @post = Post.new\nend\n\n\n def create\n  @post = Post.new(post_params)\n  if @post.save\n    flash[:success] = \"The video was added!\"\n    redirect_to @post\n  else\n    render 'new'\n  end\nend\n\n  private\n  def post_params\n      params.require(:post).permit(:video)\n  end           \nend\n</code></pre>\n\n<p><strong>post.rb</strong></p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n      mount_uploader :video, VideoUploader  \nend\n</code></pre>\n\n<p><strong>add_video_to_post.rb</strong></p>\n\n<pre><code> class AddVideoToPost &lt; ActiveRecord::Migration\n    def change\n    add_column :posts, :video, :string\n    end\n end\n</code></pre>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code>&lt;%= form_for(@post) do |f| %&gt;\n &lt;% if @post.errors.any? %&gt;\n &lt;div id=\"error_explanation\"&gt;\n   &lt;h2&gt;&lt;%= pluralize(@post.errors.count, \"error\") %&gt;&lt;/h2&gt;\n\n  &lt;ul&gt;\n  &lt;% @post.errors.full_messages.each do |message| %&gt;\n    &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n  &lt;% end %&gt;\n  &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;div class=\"actions\"&gt;\n  &lt;%=f.file_field :video%&gt;\n&lt;%= f.submit %&gt;\n&lt;/div&gt;\n</code></pre>\n\n   \n\n<p>I believe it is something wrong with the video tag in my show page. The original tutorial that I followed said the video tag should be this:</p>\n\n<pre><code>&lt;%= video_tag post.video_url.to_s :controls =&gt;true %&gt;\n</code></pre>\n\n<p>However, this gives me the error:</p>\n\n<pre><code>wrong number of arguments (1 for 0)\n</code></pre>\n\n<p>Can anyone help out?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "is_accepted": false, "score": 1, "last_activity_date": 1484152157, "creation_date": 1484152157, "answer_id": 41595941, "question_id": 41593952, "link": "https://stackoverflow.com/questions/41593952/retrieve-all-has-many-related-objects-filtered-by-one-instance-in-ruby/41595941#41595941", "title": "Retrieve all &#39;has_many&#39; related objects filtered by one instance in ruby", "body": "<p>This is one way to do it, first get the user ids of posts with id 1 or 2, and then get all those users. There are other ways of course, but this at least should work for you.</p>\n\n<pre><code>user_ids = Post.where('id = 1 OR id = 2').pluck(:user_id)\nusers = User.where(id: user_ids)\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6484817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a16ae0b4cb7b28d96ff4c455676287?s=128&d=identicon&r=PG&f=1", "display_name": "ntrax111", "link": "https://stackoverflow.com/users/6484817/ntrax111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484152157, "creation_date": 1484146281, "question_id": 41593952, "link": "https://stackoverflow.com/questions/41593952/retrieve-all-has-many-related-objects-filtered-by-one-instance-in-ruby", "title": "Retrieve all &#39;has_many&#39; related objects filtered by one instance in ruby", "body": "<p>I have two ActiveRecords Users and Posts:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :post\nend\n\nclass Post &lt; MyBase\n  belongs_to :user\nend\n</code></pre>\n\n<p>I'm trying to get list of all users and <strong>all</strong> their posts.\nHowever when running the following code, I get the users who has posts with id 1 or 2, but only these posts. I want to get these users with all their posts.\nAny ideas how to do that?</p>\n\n<p><code>users = User.sorted.references([:posts]).includes([:posts]).where('posts.id=1' OR posts.id=2).all</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "web-deployment", "capistrano3"], "comments": [{"owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 0, "creation_date": 1484144280, "post_id": 41593164, "comment_id": 70389426, "body": "What is the output of <code>rake db:migrate:status</code>"}, {"owner": {"reputation": 818, "user_id": 2509777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EyQvS.jpg?s=128&g=1", "display_name": "mlabarca", "link": "https://stackoverflow.com/users/2509777/mlabarca"}, "edited": false, "score": 0, "creation_date": 1484144648, "post_id": 41593164, "comment_id": 70389666, "body": "add your <code>AddRefColorToProfileModels</code> migration to your post"}, {"owner": {"reputation": 171, "user_id": 2336659, "user_type": "registered", "accept_rate": 11, "profile_image": "https://i.stack.imgur.com/Urvau.jpg?s=128&g=1", "display_name": "Luis Mauri", "link": "https://stackoverflow.com/users/2336659/luis-mauri"}, "edited": false, "score": 0, "creation_date": 1484144863, "post_id": 41593164, "comment_id": 70389817, "body": "From the log a think is rake exit status: 1"}, {"owner": {"reputation": 349, "user_id": 7915241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3903b2d1221e55e6fb21f0842390cd50?s=128&d=identicon&r=PG&f=1", "display_name": "Juanse Cora", "link": "https://stackoverflow.com/users/7915241/juanse-cora"}, "edited": false, "score": 0, "creation_date": 1531597292, "post_id": 41593164, "comment_id": 89658995, "body": "Did you solve it?"}], "owner": {"reputation": 171, "user_id": 2336659, "user_type": "registered", "accept_rate": 11, "profile_image": "https://i.stack.imgur.com/Urvau.jpg?s=128&g=1", "display_name": "Luis Mauri", "link": "https://stackoverflow.com/users/2336659/luis-mauri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484146498, "creation_date": 1484143989, "last_edit_date": 1484144759, "question_id": 41593164, "link": "https://stackoverflow.com/questions/41593164/rails-capistrano-first-deploy-error-with-postgres-in-migration-task", "title": "Rails Capistrano first deploy error with postgres in migration task", "body": "<p>I'm running:</p>\n\n<pre><code>cap production deploy\n</code></pre>\n\n<p>Everything works fine until this step:</p>\n\n<pre><code>** Execute deploy:migrating\n01:05 deploy:migrating\n01 ~/.rvm/bin/rvm default do bundle exec rake db:migrate\n01 == 20160811165131 AddRefColorToProfileModels: migrating =======================\n01 -- add_reference(:profile_models, :ayes_color, {:foreign_key=&gt;true, :index=&gt;true})\n01 rake aborted!\n01 StandardError: An error has occurred, this and all later migrations canceled:\n01\n01 PG::UndefinedTable: ERROR:  relation \"ayes_colors\" does not exist\n01 : ALTER TABLE \"profile_models\" ADD CONSTRAINT \"fk_rails_d2695831c0\"\n01 FOREIGN KEY (\"ayes_color_id\")\n01   REFERENCES \"ayes_colors\" (\"id\")\n01 /home/deployer/apps/cubamodela/shared/bundle/ruby/2.3.0/gems/activerecord-5.0.0/lib/active_record/connection_adapters/postgresql/data\u2026\n01 /home/deployer/apps/cubamodela/shared/bundle/ruby/2.3.0/gems/activerecord-5.0.0/lib/active_record/connection_adapters/postgresql/data\u2026\n01 /home/deployer/apps/cubamodela/shared/bundle/ruby/2.3.0/gems/activerecord-5.0.0/lib/active_record/connection_adapters/abstract_adapte\u2026\n...\n</code></pre>\n\n<p>I don't know if this is important but anyway, in this failed migration I made a mistake writing eyes_color (I wrote ayes_color), I wrote later other migration to correct this.</p>\n\n<p>The line in ProfileModel class is:</p>\n\n<pre><code>belongs_to :eyes_color, class_name: \"Color\", foreign_key: \"eyes_color_id\", optional: true\n</code></pre>\n\n<p>And I have a table colors in a previous migration.</p>\n\n<pre><code>class CreateColors &lt; ActiveRecord::Migration[5.0]\n def change\n  create_table :colors do |t|\n   t.string :name\n\n   t.timestamps\n  end\n end\nend\n</code></pre>\n\n<p>If any other info is needed please tell me.\nThanks in advance for the help.</p>\n\n<p>Update</p>\n\n<pre><code>class AddRefColorToProfileModels &lt; ActiveRecord::Migration[5.0]\n def change\n  add_reference :profile_models, :ayes_color, foreign_key: true, index: true\n end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "hashmap", "activesupport"], "answers": [{"comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 3, "creation_date": 1484142925, "post_id": 41592521, "comment_id": 70388570, "body": "Btw symbols are now GCed in Ruby 2.4.0."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1484149365, "post_id": 41592521, "comment_id": 70392837, "body": "@ndn unless their length is greater or equal than 24 bytes, they are stored in <code>RValue</code>s, which are <b>not</b> GC\u2019ed. Google for \u201cruby heaps.\u201d Maybe this was changed in Ruby 2.4 as well, but I doubt that."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1484142070, "creation_date": 1484142070, "answer_id": 41592521, "question_id": 41592312, "link": "https://stackoverflow.com/questions/41592312/why-does-rails-hashwithindifferentaccess-store-keys-as-strings-and-not-symbol/41592521#41592521", "title": "Why does Rails&#39; `HashWithIndifferentAccess` store keys as strings and not symbols?", "body": "<blockquote>\n  <p>Why have they chosen to do this</p>\n</blockquote>\n\n<p><code>ActiveSupport::HashWithIndifferentAccess</code> is mainly used to handle parameters coming from outside. Symbols are stored in the ruby heap and in general, they are never released back to the system.</p>\n\n<p>Using symbols as keys in something that gets keys from the outside, leads to the vulnerability against <code>OutOfMemory</code> attacks (<code>[D]DoS</code>, sending queries with randomly generated parameters names.) That\u2019s why strings were chosen, AFAIU. For 100% assurance ask DHH.</p>\n\n<blockquote>\n  <p>how significant is the difference in performance?</p>\n</blockquote>\n\n<p>Use <a href=\"https://ruby-doc.org/stdlib-2.4.0/libdoc/benchmark/rdoc/Benchmark.html\" rel=\"nofollow noreferrer\"><code>Benchmark</code></a> to check. This site is not supposed to be a \u201cplease do benchmarks for me\u201d\u00a0site.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 3, "last_activity_date": 1484144357, "creation_date": 1484144357, "answer_id": 41593287, "question_id": 41592312, "link": "https://stackoverflow.com/questions/41592312/why-does-rails-hashwithindifferentaccess-store-keys-as-strings-and-not-symbol/41593287#41593287", "title": "Why does Rails&#39; `HashWithIndifferentAccess` store keys as strings and not symbols?", "body": "<p>In the past, there were some implementations that were unable to collect symbols. IOW, a symbol, once created, would stay in memory until the end of <strike>time</strike> the process (which for a server process like a Rails app, can be months). Up until three weeks ago, YARV, the most popular implementation, happened to be one of those.</p>\n\n<p>Ergo, you could DoS a Ruby system running one of those vulnerable implementations by generating lots of symbols, and since Rails uses HWIA for request params (which are fully under the attacker's control), among others, it is quite trivial to do so.</p>\n\n<p>Now, that every single implementation supports collecting symbols (JRuby and Rubinius supported it years ago, YARV supports it since 2.4.0), that implementation strategy may change \u2026 or not: never change a running system.</p>\n"}], "owner": {"reputation": 310, "user_id": 2959891, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c54e8df53a97c82a0409045212f569f?s=128&d=identicon&r=PG", "display_name": "Ontonator", "link": "https://stackoverflow.com/users/2959891/ontonator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 996, "favorite_count": 0, "accepted_answer_id": 41592521, "answer_count": 2, "score": 2, "last_activity_date": 1484144357, "creation_date": 1484141512, "question_id": 41592312, "link": "https://stackoverflow.com/questions/41592312/why-does-rails-hashwithindifferentaccess-store-keys-as-strings-and-not-symbol", "title": "Why does Rails&#39; `HashWithIndifferentAccess` store keys as strings and not symbols?", "body": "<p>I am using <code>enum</code> to map integers in my database to semantic values in my ruby code, however I noticed that the keys that it uses are strings. When I checked the type of the hash, I discovered that it was an <code>ActiveSupport::HashWithIndifferentAccess</code>, not a standard <code>Hash</code>, which makes sense, but lead to the question of why Rails chose to store and compare the values as strings, not symbols, internally.</p>\n\n<p>The <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/HashWithIndifferentAccess.html\" rel=\"nofollow noreferrer\">documentation</a> states:</p>\n\n<blockquote>\n  <p>Internally symbols are mapped to strings when used as keys in the entire writing interface</p>\n</blockquote>\n\n<p>Symbols are usually used in hashes because of their fast comparison, but Rails has chosen to use strings instead. Why have they chosen to do this, and how significant is the difference in performance?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1484141716, "post_id": 41592191, "comment_id": 70387792, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2390178/skip-before-filter-in-rails\">Skip before_filter in Rails</a>"}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 7338173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cf5f4cc9a6c6173f95951a727c87cc59?s=128&d=identicon&r=PG&f=1", "display_name": "Jodooomi", "link": "https://stackoverflow.com/users/7338173/jodooomi"}, "edited": false, "score": 0, "creation_date": 1484142311, "post_id": 41592373, "comment_id": 70388199, "body": "will I have to override the SessionsController of devise?"}, {"owner": {"reputation": 301, "user_id": 7338173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cf5f4cc9a6c6173f95951a727c87cc59?s=128&d=identicon&r=PG&f=1", "display_name": "Jodooomi", "link": "https://stackoverflow.com/users/7338173/jodooomi"}, "edited": false, "score": 0, "creation_date": 1484150283, "post_id": 41592373, "comment_id": 70393423, "body": "<a href=\"http://stackoverflow.com/questions/41595298/skip-before-filter-for-the-login-action-of-devise\" title=\"skip before filter for the login action of devise\">stackoverflow.com/questions/41595298/&hellip;</a>"}], "tags": [], "owner": {"reputation": 166, "user_id": 6549733, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/vyFYL.png?s=128&g=1", "display_name": "Rooby Doo", "link": "https://stackoverflow.com/users/6549733/rooby-doo"}, "is_accepted": true, "score": 4, "last_activity_date": 1484141668, "creation_date": 1484141668, "answer_id": 41592373, "question_id": 41592191, "link": "https://stackoverflow.com/questions/41592191/authenticate-user-for-all-but-a-single-page-how-to-do-that-easily/41592373#41592373", "title": "authenticate_user! for all but a single page -- how to do that easily?", "body": "<p>Yes, you can do.,</p>\n\n<pre><code>class ApplicationController\n  before_filter :authenticate_user!\nend\n\nclass SessionsController &lt; ApplicationController\n  skip_before_filter :authenticate_user!\nend\n</code></pre>\n\n<p>And you can mention the methods you want to exclude using <code>except:</code>.</p>\n"}], "owner": {"reputation": 301, "user_id": 7338173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cf5f4cc9a6c6173f95951a727c87cc59?s=128&d=identicon&r=PG&f=1", "display_name": "Jodooomi", "link": "https://stackoverflow.com/users/7338173/jodooomi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 41592373, "answer_count": 1, "score": 0, "last_activity_date": 1484141668, "creation_date": 1484141185, "question_id": 41592191, "link": "https://stackoverflow.com/questions/41592191/authenticate-user-for-all-but-a-single-page-how-to-do-that-easily", "title": "authenticate_user! for all but a single page -- how to do that easily?", "body": "<p>I want to use <code>authenticate_user!</code> in all, but a single page \"login\" page, in my Rails application. For this I can insert <code>authenticate_user!</code> in all the controllers. But it'd be easier to insert it into <code>ApplicationController</code> and\ndisabe only on \"login\" page or rather in SessionController for \"login\" action. Is it possible?</p>\n"}, {"tags": ["json", "ruby", "rspec", "ruby-on-rails-5", "rails-api"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484141438, "post_id": 41592040, "comment_id": 70387605, "body": "Isn&#39;t something missing in your example? Where is <code>As an unregistered user signing up skip user authentication</code> defined?"}, {"owner": {"reputation": 45, "user_id": 3907366, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/841986068/picture?type=large", "display_name": "Elison de Campos", "link": "https://stackoverflow.com/users/3907366/elison-de-campos"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484141501, "post_id": 41592040, "comment_id": 70387648, "body": "that was some old fragment of unused code, sorry, gonna edit"}], "owner": {"reputation": 45, "user_id": 3907366, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/841986068/picture?type=large", "display_name": "Elison de Campos", "link": "https://stackoverflow.com/users/3907366/elison-de-campos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 788, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484141635, "creation_date": 1484140779, "last_edit_date": 1484141568, "question_id": 41592040, "link": "https://stackoverflow.com/questions/41592040/undefined-method-unpack-for-nilnilclass-when-rendering-json", "title": "undefined method unpack for nil:NilClass when rendering JSON", "body": "<p>I'm working on a Rails 5 API application and Im having trouble when trying to render json. Take that simple controller:</p>\n\n<pre><code>module Api\n  module V1\n    class UsersController &lt; ApplicationController\n      def sign_up\n        @user = User.new user_params\n        if @user.save\n          render json: {status: :ok, user: @user.to_json }\n        else\n          render json: { status: :error, errors: @user.errors }, status: :unprocessable_entity\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>When I test this request with a simple spec:</p>\n\n<pre><code>RSpec.describe Api::V1::UsersController, type: :controller do\n\n  context 'As an unregistered user' do\n    context 'signing up with valid params' do\n      let(:valid_params) do\n        { name: 'Test User', email: 'test@test.com', password: '123456789', password_confirmation: '123456789' }\n      end\n\n      it 'returns a 200 status' do\n        post :sign_up, params: { user: valid_params }\n        expect(response.status).to eq 200\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I get an error thrown at me: </p>\n\n<pre><code>Failures:\n\n  1) Api::V1::UsersController As an unregistered user signing up with valid status returns a 200 status\n     Failure/Error: render json: {status: :ok, user: @user.to_json }\n\n     NoMethodError:\n       undefined method `unpack' for nil:NilClass\n     # ./app/controllers/api/v1/users_controller.rb:10:in `sign_up'\n     # ./spec/controllers/api/v1/users_controller_spec.rb:15:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>I'm not using any gems that alter rendering yet so I'm really lost of what might be the problem. Thanks in advance.</p>\n"}, {"tags": ["ruby", "learn-ruby-the-hard-way"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1484141970, "post_id": 41591986, "comment_id": 70387966, "body": "Your question is unclear. What does &quot;passing method to methods&quot; mean? From what I can see, you never pass a method to a method anywhere, so why is that relevant? Why do you need to do that &quot;whenever i want to return something from the method&quot;? What does the &quot;it&quot; in &quot;Can you guys explain on how do i go about passing it.&quot; refer to? Also, please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, and pay special attention to the &quot;M&quot; (Minimal) part. I highly doubt that you need 120 lines of code to replicate your problem. In fact, I have spotted several bugs that are completely unrelated to your problem, but make it pretty much \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1484141980, "post_id": 41591986, "comment_id": 70387974, "body": "\u2026 impossible to diagnose."}, {"owner": {"reputation": 47, "user_id": 6665939, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6a72c796c6bc28bd71eb452f53b41d35?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/6665939/suresh"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1484142445, "post_id": 41591986, "comment_id": 70388284, "body": "Read the last statement and you will understand."}], "answers": [{"comments": [{"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1484144953, "post_id": 41592916, "comment_id": 70389876, "body": "This isn&#39;t strictly correct.  if you do <code>def Weapon</code> and <code>end</code> and <code>Weapon</code> you&#39;ll see the <code>uninitialized constant</code> error.  But if you explicity call it <i>as</i> a method, with parentheses... <code>Weapon()</code> as the OP does, then it will work. That&#39;s not to say it&#39;s good practice, but it&#39;s not the cause of OP&#39;s issue."}, {"owner": {"reputation": 1464, "user_id": 5712410, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2be8636271ba5bf194537f8119d752b1?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Avlija\u0161", "link": "https://stackoverflow.com/users/5712410/marko-avlija%c5%a1"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1484146179, "post_id": 41592916, "comment_id": 70390734, "body": "Good point. I am still going to leave this as answer because he might learn from it."}, {"owner": {"reputation": 47, "user_id": 6665939, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6a72c796c6bc28bd71eb452f53b41d35?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/6665939/suresh"}, "edited": false, "score": 0, "creation_date": 1484147870, "post_id": 41592916, "comment_id": 70391859, "body": "Thank you guys. :)"}, {"owner": {"reputation": 1464, "user_id": 5712410, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2be8636271ba5bf194537f8119d752b1?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Avlija\u0161", "link": "https://stackoverflow.com/users/5712410/marko-avlija%c5%a1"}, "edited": false, "score": 0, "creation_date": 1484212833, "post_id": 41592916, "comment_id": 70420073, "body": "I think you should have accepted the other answer cause it was better. You can upvote answer (up arrow above number 0) if you like it."}], "tags": [], "owner": {"reputation": 1464, "user_id": 5712410, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2be8636271ba5bf194537f8119d752b1?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Avlija\u0161", "link": "https://stackoverflow.com/users/5712410/marko-avlija%c5%a1"}, "is_accepted": false, "score": 1, "last_activity_date": 1484146249, "last_edit_date": 1484146249, "creation_date": 1484143282, "answer_id": 41592916, "question_id": 41591986, "link": "https://stackoverflow.com/questions/41591986/stand-alone-method-is-calling-another-method-by-itself/41592916#41592916", "title": "Stand alone method is calling another method by itself", "body": "<p>In ruby constants start with Capital letter. \nMethods are always defined in lower case.</p>\n\n<p>Try this in irb</p>\n\n<pre><code>irb(main):001:0&gt; def Weapon\nirb(main):002:1&gt; end\n=&gt; :Weapon\nirb(main):003:0&gt; Weapon\nNameError: uninitialized constant Weapon\n</code></pre>\n\n<p>To solve your problem name methods using ruby's naming conventions:<br>\n<code>zombie_room</code>, <code>collect_prize</code> etc.</p>\n\n<p>Then this code will work:<br>\n<code>zombie_room(weapon())</code></p>\n\n<p>What you are doing there is not really passing method weapon to method zombie room. \nWhat is really going on is that method weapon is executed, then it returns a value and result of that value is passed to method zombie_room.</p>\n\n<p>I think that is what you wanted.</p>\n\n<p>If you need to pass a method, check out documentation for <code>proc</code> and <code>lambda</code> or just use blocks.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 6665939, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6a72c796c6bc28bd71eb452f53b41d35?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/6665939/suresh"}, "edited": false, "score": 0, "creation_date": 1484146890, "post_id": 41593729, "comment_id": 70391231, "body": "Ok thank you. It&#39;s my mistake that i didn&#39;t check the CollectPrize method is at zombie_room method. That&#39;s why it&#39;s keep looping."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 47, "user_id": 6665939, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6a72c796c6bc28bd71eb452f53b41d35?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/6665939/suresh"}, "edited": false, "score": 0, "creation_date": 1484150894, "post_id": 41593729, "comment_id": 70393849, "body": "No problem, if you found my answer helpful feel free to accept it."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1484145611, "creation_date": 1484145611, "answer_id": 41593729, "question_id": 41591986, "link": "https://stackoverflow.com/questions/41591986/stand-alone-method-is-calling-another-method-by-itself/41593729#41593729", "title": "Stand alone method is calling another method by itself", "body": "<p>Your code is in a large <code>while true</code> loop.  Since true is always true, it will never end, so after it calls CollectPrize() it just goes back to the <code>while</code> statement.</p>\n\n<p>You could get out of it by inserting a <code>break</code> line after the <code>CollectPrize()</code> but there's another <code>while true</code> loop around this one.</p>\n\n<p>I think you need to pay closer attention to how you want to exit the while loops.</p>\n\n<pre><code>puts \"Time to take down that zombie now.\"\nwhile true # &lt;---------------- this is ALWAYS going to loop, without end\n  puts \"Type Shoot to knock it down or quit.\"\n  choice = gets.chomp\n  if $choosen_gun[1][1] &gt;= 1\n    health = value[0] -= 1\n    $choosen_gun[1][1] -= 1 \n    puts \"#{key} health now is #{health}\"\n  else\n    puts \"Please reload your gun\"\n    puts \"Reloading......\"\n    $choosen_gun[1][1] += 5  \n  end \n  if health == 0 \n    puts \"You have defeated #{key}\"\n    puts \"Congrats!!!\"\n    puts \"We are happy for you\"\n    puts \"Lets begins to collect your prize\"\n    CollectPrize()\n  else\n    puts \"You did not defeat the #{key} yet\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6665939, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6a72c796c6bc28bd71eb452f53b41d35?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/6665939/suresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 41593729, "answer_count": 2, "score": 0, "last_activity_date": 1484146249, "creation_date": 1484140656, "last_edit_date": 1484140980, "question_id": 41591986, "link": "https://stackoverflow.com/questions/41591986/stand-alone-method-is-calling-another-method-by-itself", "title": "Stand alone method is calling another method by itself", "body": "<p>Ok i seriously suck at passing method to methods whenever i want to return something from the method. Can you guys explain on how do i go about passing it.\nHere's my hash</p>\n\n<pre><code>$choosen_gun = {}\n$Weapon = {\n    :Bazoka =&gt; [\"Bazoka\",5],\n    :Machine_gun =&gt; [\"Machine_gun\",1000],\n    :Hand_gun =&gt; [\"Hand_gun\",24,2],\n    :Double_Hand_gun =&gt; [\"Double_Hand_gun\",24,4],\n    :Sniper =&gt; [\"Sniper\",12,1],\n    :Shot_gun =&gt; [\"Shot_gun\",8,2]\n}\n</code></pre>\n\n<p>Here's my code for method  Weapon</p>\n\n<pre><code>    def Weapon\n        puts \"Now it's time to select your weapon.\"\n        puts \"Please choose a weapon that is good throughout the game.\"\n        puts \"Whenever you are shortage of bullets, please reload it.\"\n        puts \"Please avoid last minute of reloading of weapon.\"\n        puts \"Now choose your weapon based on your own preferences.\"\n        print  \"\\n\"\n\n        puts \"Type 1\"\n        puts \"Gun Name: Bazoka\"\n        puts \"Description: A powerful gun that is strong with only 5 bullets.\"\n        puts \"Rating: \u2605 \u2605 \u2605 \u2605\"\n        num = gets.chomp.to_i\n\n       case num \n          when 1 \n          puts \"Selection of Bazoka is chosen\"\n          puts \"Loaded 5 bullets only\"\n          $choosen_gun[num] = $Weapon[:Bazoka]\n       end      \n     return num\nend\n</code></pre>\n\n<p>Upon calling the method. The user will choose his weapon and it will add it to the $choosen_gun hash with it's num, and it's return it's num what the user types</p>\n\n<p>Here's my code for method  ZombieRoom</p>\n\n<pre><code>    def ZombieRoom(w)\n    zombie = {\n        :Construcied =&gt; [5],\n        :Invader =&gt; [5],\n        :Damned =&gt; [5],\n        :Steampunk =&gt; [5],\n        :Stoner =&gt; [5],\n        :Wasted =&gt; [5],\n        :Romero =&gt; [5]\n    }\n             puts \"Welcome to the worst night mare of Zombie Room\"\n             puts \"You will be fighting with a random zombie\"\n\n\n             while true \n             puts \"..........\"\n             puts \"Selecting a random zombie\"\n             puts \"Selecting your prefered gun....\"\n             case w \n                   when 1 \n                   $choosen_gun[1]\n                   puts \"Your selected gun is #{$choosen_gun[1][0]}\"\n                   #values = zombie.values\n                   #puts values[rand(values.size)]\n                   #random_zombie = zombie.keys.sample(1)\n                   #puts random_zombie[   \n                    random_zombie = zombie.to_a.sample(1).to_h\n                    random_zombie.each do |key,value|\n                    puts \"Your random zombie is #{key}\"\n                    puts \"With a health value of #{value[0]}\"\n\n\n                    puts \"Time to take down that zombie now.\"\n                    while true\n                    puts \"Type Shoot to knock it down or quit.\"\n                    choice = gets.chomp\n                    if $choosen_gun[1][1] &gt;= 1\n                        health = value[0] -= 1\n                        $choosen_gun[1][1] -= 1 \n                    puts \"#{key} health now is #{health}\"\n                    else\n                    puts \"Please reload your gun\"\n                    puts \"Reloading......\"\n                    $choosen_gun[1][1] += 5  \n                    end \n\n                    if health == 0 \n                        puts \"You have defeated #{key}\"\n                        puts \"Congrats!!!\"\n                        puts \"We are happy for you\"\n                        puts \"Lets begins to collect your prize\"\n                         CollectPrize()\n                     else\n                        puts \"You did not defeat the #{key} yet\"\n                    end\n\n                    end\n\n                    end\n       end\n     end\n   end\n</code></pre>\n\n<p>Here's my code for method  CollectPrize</p>\n\n<pre><code>def CollectPrize\n      puts \"Congratulations on defeating\"\n      puts \"We would now like to give you some case prizes\"\n\n      print \"\\n\"\n\n      puts \"Please choose only 1 prize for yourself\"\n      print \"\\n\"\n      puts \"Type 1\"\n      puts \"$50,000\"\n      print \"\\n\"\n      puts \"Type 2\"\n      puts \"$25,000\"\n      print \"\\n\"\n      puts \"Type 3\"\n      puts \"$55,000\"\n      hoho = gets.chomp.to_f\n\n\n      if hoho == 1\n            puts \"hehe\"\n      end\nend\n</code></pre>\n\n<p>Here how i call my method</p>\n\n<pre><code>ZombieRoom(Weapon())\nCollectPrize()\n</code></pre>\n\n<p>Now the problem is that whenever the CollectPrize method is called and i type my input to collect the prize example 1 then it print \"$50,000\". instead of the ending the problem, it went back to the ZombieRoom and continues to loop at the \"Type Shoot to knock it down or quit.\" Can someone atleast tell me a proper way to solve this issue or also what other way to pass a method? </p>\n"}, {"tags": ["ruby", "cucumber"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1484161487, "post_id": 41591910, "comment_id": 70400194, "body": "Can you post the code you&#39;re using to re-run the failed examples?  And what happens when &quot;not all failed tests are getting re-executed&quot; (e.g. error is thrown or tests are silently skipped)?"}], "answers": [{"tags": [], "owner": {"reputation": 217, "user_id": 4366433, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aff751f7cf64bbf5f4009effdfa7f8c8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmay", "link": "https://stackoverflow.com/users/4366433/tanmay"}, "is_accepted": false, "score": 0, "last_activity_date": 1487142436, "creation_date": 1487142436, "answer_id": 42242726, "question_id": 41591910, "link": "https://stackoverflow.com/questions/41591910/cucumber-rerun-failed-tests-not-working-in-chrome/42242726#42242726", "title": "Cucumber rerun failed tests not working in chrome", "body": "<p>My bad , this was design issue rather than browser specific issue. :/\nAfter redesigning the rerun feature flow , the issue is resolved.\nThe reason this was happening was multi-threading issue since multiple docker containers are involved.</p>\n\n<p>Thank you for looking into it.</p>\n"}], "owner": {"reputation": 217, "user_id": 4366433, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aff751f7cf64bbf5f4009effdfa7f8c8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmay", "link": "https://stackoverflow.com/users/4366433/tanmay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487142436, "creation_date": 1484140431, "last_edit_date": 1484161371, "question_id": 41591910, "link": "https://stackoverflow.com/questions/41591910/cucumber-rerun-failed-tests-not-working-in-chrome", "title": "Cucumber rerun failed tests not working in chrome", "body": "<p>I am using cucumber and watir with Ruby for test automation and pretty much new to it.\nI am trying to rerun failed tests for which I am using cucumber rerun formatter.</p>\n\n<p>Tests are rerunning fine on Firefox, but on chrome not all failed tests are getting re-executed.</p>\n\n<p>Is there any dependency of cucumber with chrome for rerun to happen?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1484140967, "post_id": 41591909, "comment_id": 70387286, "body": "Rails&#39; API mode disables some Rails features to improve the performance for non-html applications. I would be surprised when a gem that depends on views and view helper works in such an environment."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7404890"}, "is_accepted": false, "score": 0, "last_activity_date": 1484142616, "creation_date": 1484142616, "answer_id": 41592705, "question_id": 41591909, "link": "https://stackoverflow.com/questions/41591909/is-the-gem-thredded-compatible-with-rails-5-api/41592705#41592705", "title": "Is the gem &#39;thredded&#39; compatible with rails 5 api?", "body": "<p>if you go there home page on github <a href=\"https://github.com/thredded/thredded\" rel=\"nofollow noreferrer\">https://github.com/thredded/thredded</a> you will see a message that reads </p>\n\n<blockquote>\n  <p>@glebm glebm Bump Rails to 5.0.1 in spec/gemfiles/rails_5_0.gemfile\n  <a href=\"https://i.stack.imgur.com/wYhnf.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n</blockquote>\n\n<p>that message will change on the next commit</p>\n\n<p>now if what you are asking if they are using action cable. I did not find anything to say that they were.</p>\n\n<p>but they are rails 5 compatible</p>\n\n<p>I hope that this helps </p>\n"}], "owner": {"reputation": 1, "user_id": 7404765, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mGYbkPFqvKw/AAAAAAAAAAI/AAAAAAAAABM/BMGvD6CF-vs/photo.jpg?sz=128", "display_name": "Anfernee Ng", "link": "https://stackoverflow.com/users/7404765/anfernee-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484142616, "creation_date": 1484140428, "question_id": 41591909, "link": "https://stackoverflow.com/questions/41591909/is-the-gem-thredded-compatible-with-rails-5-api", "title": "Is the gem &#39;thredded&#39; compatible with rails 5 api?", "body": "<p>I am currently developing a social media-ish app, and it needs a forum. I wanted to use a gem for the forum side of the app. We are using Rails as a backend API serving json responses to the frontend using Angular.</p>\n\n<p>With that, I've seen the thredded readme, and it seems that it has a view side to it which Rails 5 api clearly lacks. With that, will it still smoothly work with Rails 5 api? Just checking out if someone has tried this out already. Thanks a bunch.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 1, "creation_date": 1484139452, "post_id": 41591181, "comment_id": 70386324, "body": "You reference it correctly, the actual question is why it&#39;s not loaded. What is the name of the file containing the <code>Membership</code> class and where is it located? If you fire the console and type <code>Membership</code> do you get <i>uninitialized constant</i> error?"}], "answers": [{"comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1484139748, "post_id": 41591623, "comment_id": 70386533, "body": "Apologies for wasting your time - was a typo on my part - as you say the code above works fine."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1484139780, "post_id": 41591623, "comment_id": 70386552, "body": "No problem. Been there, done that. Rails magic can make it hard to debug sometimes."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 2, "last_activity_date": 1484139541, "creation_date": 1484139541, "answer_id": 41591623, "question_id": 41591181, "link": "https://stackoverflow.com/questions/41591181/ruby-referencing-another-class-inside-a-self-method/41591623#41591623", "title": "Ruby - referencing another class inside a self.method", "body": "<p>Your code works fine when both classes are in the same file. <code>Membership</code> class is found by <code>Person</code> class :</p>\n\n<pre><code>class Membership\n  def self.individuals\n    puts \"Membership.individuals\"\n  end\n\n  def self.individuals_ids\n    puts \"Membership.individuals_ids\"\n  end\nend\n\nclass Person\n  def self.individuals\n    puts \"Person.individuals\"\n    Membership.individuals_ids\n  end\nend\n\nPerson.individuals\n\n#=&gt; Person.individuals\n#=&gt; Membership.individuals_ids\n</code></pre>\n\n<p>It means your <code>Membership</code> class isn't <a href=\"http://guides.rubyonrails.org/autoloading_and_reloading_constants.html\" rel=\"nofollow noreferrer\">autoloaded</a> by Rails. You can make sure that <code>Membership</code> is defined in <code>membership.rb</code> and either :</p>\n\n<ul>\n<li>move <code>membership.rb</code> to <code>app</code> folder</li>\n<li>add the required path to <a href=\"http://guides.rubyonrails.org/autoloading_and_reloading_constants.html#autoload-paths\" rel=\"nofollow noreferrer\"><code>config.autoload_paths</code></a></li>\n</ul>\n"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 41591623, "answer_count": 1, "score": 2, "last_activity_date": 1484139556, "creation_date": 1484138227, "question_id": 41591181, "link": "https://stackoverflow.com/questions/41591181/ruby-referencing-another-class-inside-a-self-method", "title": "Ruby - referencing another class inside a self.method", "body": "<p>I've 2 classes, Person and Membership. Membership has a method called individual_ids which returns an array of ID's, and I'd like to retrieve people with an ID in that array:</p>\n\n<pre><code>class Membership\n\n  def self.individuals\n    where(membershipable_type: 'individual')\n  end\n\n  def self.individuals_ids\n    individuals.pluck(:membershipable_id)\n  end\nend\n\n\nclass Person\n\n  def self.individuals\n    Person.where(id: Membership.individuals_ids)\n  end\n\nend\n</code></pre>\n\n<p>When I attempt to run Person.individuals, I'm told:</p>\n\n<pre><code>NameError: uninitialized constant Person::Membership\n</code></pre>\n\n<p>How do I reference the Membership class from inside a self method call as above, rather than it thinking I mean Person.Membership?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "translate", "irb", "rails-i18n"], "comments": [{"owner": {"reputation": 34664, "user_id": 390819, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee2ef44de10f7791cca06df317246935?s=128&d=identicon&r=PG", "display_name": "Cristian Lupascu", "link": "https://stackoverflow.com/users/390819/cristian-lupascu"}, "edited": false, "score": 1, "creation_date": 1484137924, "post_id": 41590976, "comment_id": 70385341, "body": "Your method works fine for me in irb. See if any of your code/libs do any monkey patching/refinements on <code>String</code>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1484141633, "post_id": 41590976, "comment_id": 70387735, "body": "You say that your <code>translate</code> method undefines <code>String#start_with?</code>, but there is no indication of that in the transcript you showed. How did you determine that that is indeed what is happening?"}, {"owner": {"reputation": 500, "user_id": 6148582, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4df4768cb482ebfe0bf0ff10a02381b0?s=128&d=identicon&r=PG&f=1", "display_name": "ToTenMilan", "link": "https://stackoverflow.com/users/6148582/totenmilan"}, "reply_to_user": {"reputation": 34664, "user_id": 390819, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee2ef44de10f7791cca06df317246935?s=128&d=identicon&r=PG", "display_name": "Cristian Lupascu", "link": "https://stackoverflow.com/users/390819/cristian-lupascu"}, "edited": false, "score": 0, "creation_date": 1484147304, "post_id": 41590976, "comment_id": 70391516, "body": "@w0lf I read about this monkey patching. Honestly, I don&#39;t know how to check this, but if it&#39;s because of some gems I have installed only <code>ruby</code>, <code>rails</code>, <code>rspec</code> and <code>pry</code> on a blank cloud9 workspace. @J&#246;rgWMittag <code>undefined method </code>start_with?&#39;` Isn&#39;t that what you mean? I tried <code>puts String.methods</code> but output is always the same, no matter what I type. I can only ctrl+d and restart irb. I Also noticed this on fresh irb: &gt; def translate(s) &gt; puts s &gt; end #&lt;RubyVM::InstructionSequence:0x00000000a9a2e0&gt;  =&gt; :translate I checked RubyVM in Ruby-doc but for now this is some arcane magic"}], "answers": [{"tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 1, "last_activity_date": 1485246682, "last_edit_date": 1485246682, "creation_date": 1484156517, "answer_id": 41597342, "question_id": 41590976, "link": "https://stackoverflow.com/questions/41590976/why-word-translate-is-messing-irb/41597342#41597342", "title": "Why word &#39;translate&#39; is messing irb?", "body": "<p>Here is a theory</p>\n\n<ul>\n<li>There is probably a global function <code>translate</code> in your setup</li>\n<li>This function is called with an instruction sequence as argument when <code>irb</code> prints the output</li>\n<li>Hence when you redefine <code>translate</code> printing the output breaks</li>\n</ul>\n\n<p>The <code>NoMethodError: undefined method</code> does not mean that the method has been undefined globally but that it is being sent to an object that does not understand it</p>\n\n<p>You can test my theory by executing</p>\n\n<pre><code>method(:translate)\n</code></pre>\n\n<p>If you get a result back then <code>translate</code> is already defined and your must not redefine it!</p>\n\n<p>Now if you want to know which gem defined this function, install <code>pry</code> gem (which is a better irb) and use the <code>$</code> command to look at the file and source code of that method</p>\n\n<pre><code># Use this command in pry to see location and source code\n$ translate\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 2, "last_activity_date": 1486320951, "creation_date": 1486320951, "answer_id": 42055933, "question_id": 41590976, "link": "https://stackoverflow.com/questions/41590976/why-word-translate-is-messing-irb/42055933#42055933", "title": "Why word &#39;translate&#39; is messing irb?", "body": "<p>It is a bug in YARV that was <a href=\"https://github.com/ruby/ruby/commit/d8c3672b012ec6eb55e097162c6c638e8d932471\" rel=\"nofollow noreferrer\">fixed</a> in YARV 2.4.0.</p>\n\n<p>The commit message mentions the following workaround if you don't have YARV 2.4.0:</p>\n\n<blockquote>\n<pre><code>class &lt;&lt; RubyVM::InstructionSequence\n  def translate; end\n  undef translate\nend\n</code></pre>\n</blockquote>\n\n<p>Note that other implementations are not affected, only YARV.</p>\n"}], "owner": {"reputation": 500, "user_id": 6148582, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4df4768cb482ebfe0bf0ff10a02381b0?s=128&d=identicon&r=PG&f=1", "display_name": "ToTenMilan", "link": "https://stackoverflow.com/users/6148582/totenmilan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 42055933, "answer_count": 2, "score": 2, "last_activity_date": 1486320951, "creation_date": 1484137660, "last_edit_date": 1495540408, "question_id": 41590976, "link": "https://stackoverflow.com/questions/41590976/why-word-translate-is-messing-irb", "title": "Why word &#39;translate&#39; is messing irb?", "body": "<p>I don't understand why my method <code>translate</code> undefines <code>start_with?</code> method and is messing something in irb, so I can exit irb only by pressing <kbd>Ctrl</kbd>+<kbd>d</kbd>, not <code>exit</code> or <code>quit</code>:</p>\n\n<pre><code>&gt;&gt; \"hello\".respond_to?(:start_with?)\n=&gt; true\n&gt;&gt; def translate(string)                                                                                                                   \n&gt;&gt;   if string.start_with?(\"a\", \"e\", \"i\", \"o\", \"u\")\n&gt;&gt;     string += \"ay\"                                                                                                                      \n&gt;&gt; end\n&gt;&gt; end\nNoMethodError: undefined method `start_with?' for #&lt;RubyVM::InstructionSequence:0x00000001d4c960&gt;\n        from (irb):3:in `translate'\n        from /usr/local/rvm/rubies/ruby-2.3.0/bin/irb:11:in `&lt;main&gt;'\n&gt;&gt; \"hello\".respond_to?(:start_with?)                                                                                                       \nNoMethodError: undefined method `start_with?' for &lt;RubyVM::InstructionSequence:irb_binding@(irb)&gt;:RubyVM::InstructionSequence\n        from (irb):3:in `translate'\n        from /usr/local/rvm/rubies/ruby-2.3.0/bin/irb:11:in `&lt;main&gt;'\n&gt;&gt; exit\nNoMethodError: undefined method `start_with?' for &lt;RubyVM::InstructionSequence:irb_binding@(irb)&gt;:RubyVM::InstructionSequence\n        from (irb):3:in `translate'\n        from /usr/local/rvm/rubies/ruby-2.3.0/bin/irb:11:in `&lt;main&gt;'\n&gt;&gt; quit\nNoMethodError: undefined method `start_with?' for &lt;RubyVM::InstructionSequence:irb_binding@(irb)&gt;:RubyVM::InstructionSequence\n        from (irb):3:in `translate'\n        from /usr/local/rvm/rubies/ruby-2.3.0/bin/irb:11:in `&lt;main&gt;'\n&gt;&gt;  \n</code></pre>\n\n<p>I tried two different workspaces and effect is the same.<br>My Ruby and Rails versions are:</p>\n\n<pre><code>~/workspace $ ruby -v\nruby 2.3.0p0 (2015-12-25 revision 53290) [x86_64-linux]\n~/workspace $ rails -v\nRails 4.2.2\n</code></pre>\n\n<p>from <a href=\"https://stackoverflow.com/questions/41577814/what-is-translate-keyword-do-in-ruby\">my other question</a> I know that word <code>translate</code> is used by many I18N libraries, so it's my only suspect, hence the title of this question. However as a beginner, I don't see any relation.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "utf-8"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 6838276, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x6TbRxwTtrw/AAAAAAAAAAI/AAAAAAAACCs/aMoCXUfg0go/photo.jpg?sz=128", "display_name": "Joshua Waiswa", "link": "https://stackoverflow.com/users/6838276/joshua-waiswa"}, "is_accepted": true, "score": 0, "last_activity_date": 1484211578, "creation_date": 1484211578, "answer_id": 41608851, "question_id": 41590314, "link": "https://stackoverflow.com/questions/41590314/encodinginvalidbytesequenceerror-in-homeindex-xa9-on-utf-8/41608851#41608851", "title": "Encoding::InvalidByteSequenceError in Home#index &quot;\\xA9&quot; on UTF-8", "body": "<p>So, I solved this by reinstalling the Ruby application. </p>\n\n<p>Don't know what had caused it, but I just reinstalled the application and everything works fine. </p>\n\n<p>Thanks all for the help. </p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 3231947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5bb65e5a701060706365b4f771dcc8f?s=128&d=identicon&r=PG", "display_name": "Karthikeyan A K", "link": "https://stackoverflow.com/users/3231947/karthikeyan-a-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1543390598, "creation_date": 1543390598, "answer_id": 53514368, "question_id": 41590314, "link": "https://stackoverflow.com/questions/41590314/encodinginvalidbytesequenceerror-in-homeindex-xa9-on-utf-8/53514368#53514368", "title": "Encoding::InvalidByteSequenceError in Home#index &quot;\\xA9&quot; on UTF-8", "body": "<p>I had this very same issue. I identified it to a  file I had in my application, actually it was taking place in minified javascript file I had in my Rails app. I open the file in text editor, added a new line and, set the encoding as UTF-8 and saved it, and the problem disappeared.</p>\n"}], "owner": {"reputation": 33, "user_id": 6838276, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x6TbRxwTtrw/AAAAAAAAAAI/AAAAAAAACCs/aMoCXUfg0go/photo.jpg?sz=128", "display_name": "Joshua Waiswa", "link": "https://stackoverflow.com/users/6838276/joshua-waiswa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "accepted_answer_id": 41608851, "answer_count": 2, "score": 0, "last_activity_date": 1543390598, "creation_date": 1484135729, "last_edit_date": 1495535371, "question_id": 41590314, "link": "https://stackoverflow.com/questions/41590314/encodinginvalidbytesequenceerror-in-homeindex-xa9-on-utf-8", "title": "Encoding::InvalidByteSequenceError in Home#index &quot;\\xA9&quot; on UTF-8", "body": "<p>I'm new to Ruby on Rails, and have been battling with this issue for a while now. </p>\n\n<p>I have pulled a website from git, and made sure all the dependencies are installed, however, when I run the site, I get the error: </p>\n\n<blockquote>\n  <p>ActionView::Template::Error (\"\\xA9\" on UTF-8) </p>\n</blockquote>\n\n<p>because of the line linking images using the code <code>image_path(\"bground2.jpg\")</code>.</p>\n\n<p>When I remove the <code>image_path(\"bground2.jpg\")</code>, the error is resolved. </p>\n\n<p>I however need <code>image_path(\"bground2.jpg\")</code> and can't do without it. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/7484207/encodinginvalidbytesequenceerror-error-occurs-in-rails-3-1-0\">I have tried the solutions here, but it seems not to work</a></p>\n\n<p>This is a section of the <code>index.html.erb</code> file, but the error is recurring over all places containing the <code>image_path</code> and <code>image_url</code>:</p>\n\n<pre><code>&lt;%= provide(:title, 'Home') %&gt;\n  &lt;section id=\"slider\" class=\"\"&gt;\n    &lt;div class=\"img-responsive\" style=\"background-image: url(&lt;%= image_path(\"bground2.jpg\") %&gt;); background-position: 50% 0;height: 500px;\"&gt;\n      &lt;div class=\"container clearfix\"&gt;\n   &lt;!-- &lt;div class=\"slider-caption slider-caption-center\"&gt;\n     &lt;!-- &lt;div class=\"banner heading-block title-center nobottomborder\"&gt;\n            &lt;h1&gt;&lt;%= \"#{t('.reach_home')}\" %&gt;&lt;/h1&gt;\n          &lt;/div&gt; --&gt; \n</code></pre>\n"}, {"tags": ["ruby", "erb"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 4849950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8227223cc97618cbf233c4f5599a758?s=128&d=identicon&r=PG&f=1", "display_name": "matsve", "link": "https://stackoverflow.com/users/4849950/matsve"}, "edited": false, "score": 0, "creation_date": 1484137947, "post_id": 41590728, "comment_id": 70385361, "body": "Thanks Marko, that&#39;s really useful! I guess using the current binding would expose the current instance variables to the ERB code, but using something like what you do in the first line to create a dummy class from which to retrieve a new binding would fix that problem."}, {"owner": {"reputation": 1464, "user_id": 5712410, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2be8636271ba5bf194537f8119d752b1?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Avlija\u0161", "link": "https://stackoverflow.com/users/5712410/marko-avlija%c5%a1"}, "reply_to_user": {"reputation": 137, "user_id": 4849950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8227223cc97618cbf233c4f5599a758?s=128&d=identicon&r=PG&f=1", "display_name": "matsve", "link": "https://stackoverflow.com/users/4849950/matsve"}, "edited": false, "score": 1, "creation_date": 1484138364, "post_id": 41590728, "comment_id": 70385638, "body": "I don&#39;t understand your fear - that ERB code will add new instance variables to your object? That sounds impossible - try your scenario in IRB. Also upvote and accept the answer if it was helpful ;)"}, {"owner": {"reputation": 137, "user_id": 4849950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8227223cc97618cbf233c4f5599a758?s=128&d=identicon&r=PG&f=1", "display_name": "matsve", "link": "https://stackoverflow.com/users/4849950/matsve"}, "edited": false, "score": 0, "creation_date": 1484139057, "post_id": 41590728, "comment_id": 70386102, "body": "That was one of the fears, which I tried and, as you said, it does not seem to work that way. Also, the ERB code might get instance variables that it shouldn&#39;t. I want to be 100% explicit on what data gets passed to the ERB. Your answer helped me so I&#39;ve upvoted and accepted it. Thanks a lot :)"}], "tags": [], "owner": {"reputation": 1464, "user_id": 5712410, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2be8636271ba5bf194537f8119d752b1?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Avlija\u0161", "link": "https://stackoverflow.com/users/5712410/marko-avlija%c5%a1"}, "is_accepted": true, "score": 2, "last_activity_date": 1484137214, "last_edit_date": 1484137214, "creation_date": 1484136911, "answer_id": 41590728, "question_id": 41589976, "link": "https://stackoverflow.com/questions/41589976/how-to-create-new-binding-and-assign-instance-variables-to-it-for-availability-i/41590728#41590728", "title": "How to create new binding and assign instance variables to it for availability in ERB?", "body": "<p>1) No need to clone, new binding is created for you each time.</p>\n\n<p>I have tested this in irb:</p>\n\n<pre><code>class A; def bind; binding; end; end\na = A.new\nbind_1 = a.bind\nbind_2 = a.bind\n\nbind_1.local_variable_set(:x, 2)\n=&gt; 2\nbind_1.local_variables\n=&gt; [:x]\nbind_2.local_variables\n=&gt; []\n</code></pre>\n\n<p>2) Open the objects Eigenclass and add <code>attr_accessor</code> to it</p>\n\n<pre><code>class &lt;&lt; template_binding  # this opens Eigenclass for object template_binding\n  attr_accessor :x\nend\n</code></pre>\n\n<p>So in ruby you can just open any class and add methods for it.\nEigenclass means class of a single object - each object can have custom class definition. Coming from C# I couldn't imagine a situation where this would be used, until now. :)</p>\n\n<p>Do this for each hash</p>\n\n<pre><code>data.each do |k, v|\n  class &lt;&lt; template_binding; attr_accessor k.to_sym; end\n  template_binding.k = v\nend\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 4849950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8227223cc97618cbf233c4f5599a758?s=128&d=identicon&r=PG&f=1", "display_name": "matsve", "link": "https://stackoverflow.com/users/4849950/matsve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1226, "favorite_count": 0, "accepted_answer_id": 41590728, "answer_count": 1, "score": 3, "last_activity_date": 1484137214, "creation_date": 1484134857, "last_edit_date": 1495540373, "question_id": 41589976, "link": "https://stackoverflow.com/questions/41589976/how-to-create-new-binding-and-assign-instance-variables-to-it-for-availability-i", "title": "How to create new binding and assign instance variables to it for availability in ERB?", "body": "<p>I'm implementing HTML templating in a Ruby project (non-rails). To do this I'll be using ERB, but I have some concerns about the binding stuff.</p>\n\n<p>First out, this is the method I got so far:</p>\n\n<pre><code>def self.template(template, data)\n  template = File.read(\"#{ENV.root}/app/templates/#{template}.html.erb\")\n\n  template_binding = binding.clone\n\n  data.each do |k, v|\n    template_binding.local_variable_set(k, v)\n  end\n\n  ERB.new(template).result(template_binding)\nend\n</code></pre>\n\n<p>To call it I'll just do</p>\n\n<pre><code>Email.template('email/hello', {\n  name: 'Bill',\n  age:  41\n}\n</code></pre>\n\n<p>There are two issues with the current solution though.</p>\n\n<p><strong>First</strong>, I'm cloning the current binding. I want to create a new one. I tried <code>Class.new.binding</code> to create a new, but since <code>binding</code> is a private method it can't be obtained that way.\nThe reason I want a new one is that I want to avoid the risk of instance variables leaking into or out from the ERB file (cloning only takes care of the latter case).</p>\n\n<p><strong>Second</strong>, I want the variables passed to the ERB file to be exposed as instance variables. Here I tried with <code>template_binding.instance_variable_set</code>, passing the plain hash key <code>k</code> which complained that it wasn't a valid instance variable name and <code>\"@#{k}\"</code>, which did not complain but also didn't get available in the ERB code.\nThe reason I want to use instance variables is that it's a convention that the people relying on this code is familiar with.</p>\n\n<p>I have checked some topics here at Stack Overflow such as <a href=\"https://stackoverflow.com/questions/8954706/render-an-erb-template-with-values-from-a-hash\">Render an ERB template with values from a hash</a>, but the answers provided does not address the problems I'm discussing.</p>\n\n<p>So in short, like the title: <em>How to create new binding and assign instance variables to it for availability in ERB?</em></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rack-cors"], "comments": [{"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1484133858, "post_id": 41589352, "comment_id": 70382673, "body": "Try removing <code>http:&#47;&#47;</code> from <code>origins</code>."}], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 5119866, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c02d573c282e2b0de90223e7b2ce364d?s=128&d=identicon&r=PG&f=1", "display_name": "yl2015", "link": "https://stackoverflow.com/users/5119866/yl2015"}, "is_accepted": false, "score": 5, "last_activity_date": 1487657514, "creation_date": 1487657514, "answer_id": 42359932, "question_id": 41589352, "link": "https://stackoverflow.com/questions/41589352/ruby-on-rails-rack-cors-multiple-origins-with-different-resources/42359932#42359932", "title": "ruby on rails - rack-cors multiple origins with different resources", "body": "<p>After checking and testing it turns out it is the right syntax. You can add as many blocks as you need:</p>\n\n<pre><code>allow do\n    origins '[the domain]'\n    resource '[the resource/directories]', headers: :any, methods: [:get, :post, :options, :put, :delete]\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "edited": false, "score": 0, "creation_date": 1553960415, "post_id": 49550455, "comment_id": 97583667, "body": "I don&#39;t get your answer, as the question was how to restrict different domains to access to different resources. I&#39;m not sure your example does the job for this part  &gt; So it will allow &quot;<a href=\"http://localhost:3000\" rel=\"nofollow noreferrer\">localhost:3000</a>&quot; to access only &#39;/api/*&#39;"}, {"owner": {"reputation": 1809, "user_id": 3786657, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/36fc24f84a8173d1242876432c3990f2?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Dess", "link": "https://stackoverflow.com/users/3786657/rahul-dess"}, "edited": false, "score": 0, "creation_date": 1560459719, "post_id": 49550455, "comment_id": 99754746, "body": "Seems like <code>origins</code> doesn&#39;t like array in my case. This approach doesn&#39;t work for me"}], "tags": [], "owner": {"reputation": 387, "user_id": 5125846, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ISgRi55iHGU/AAAAAAAAAAI/AAAAAAAAANM/GHiAYlp2Y3Y/photo.jpg?sz=128", "display_name": "ALFmachine", "link": "https://stackoverflow.com/users/5125846/alfmachine"}, "is_accepted": true, "score": 14, "last_activity_date": 1522308984, "creation_date": 1522308984, "answer_id": 49550455, "question_id": 41589352, "link": "https://stackoverflow.com/questions/41589352/ruby-on-rails-rack-cors-multiple-origins-with-different-resources/49550455#49550455", "title": "ruby on rails - rack-cors multiple origins with different resources", "body": "<p>I know this is a little old but for those finding this I am solving this differently with Rails 5.1.4 api only</p>\n\n<p>-</p>\n\n<p>Origins</p>\n\n<pre><code>ENV['CORS_ORIGINS'] = 'https://domain.first.com, http://another.origin.io'\n</code></pre>\n\n<p>Cors </p>\n\n<pre><code>Rails.application.config.middleware.insert_before 0, Rack::Cors do\n  allow do\n    origins ENV['CORS_ORIGINS'].split(',').map { |origin| origin.strip }\n\n    resource '*',\n      headers: :any,\n      methods: [:get, :post, :put, :patch, :delete, :options, :head]\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 5119866, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c02d573c282e2b0de90223e7b2ce364d?s=128&d=identicon&r=PG&f=1", "display_name": "yl2015", "link": "https://stackoverflow.com/users/5119866/yl2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4617, "favorite_count": 2, "accepted_answer_id": 49550455, "answer_count": 2, "score": 8, "last_activity_date": 1567742306, "creation_date": 1484133034, "last_edit_date": 1567742306, "question_id": 41589352, "link": "https://stackoverflow.com/questions/41589352/ruby-on-rails-rack-cors-multiple-origins-with-different-resources", "title": "ruby on rails - rack-cors multiple origins with different resources", "body": "<p>I'm implementing CORS in my rails application using rack-cors gem for it, but I'm not sure how can i define different resources for different origins.</p>\n\n<p>I need something like that:</p>\n\n<pre><code>config.middleware.insert_before 0, Rack::Cors do\n\n  allow do\n    origins 'http://localhost:3000'\n    resource '/api/*', headers: :any, methods: [:get, :post, :options, :put, :delete]\n  end\n\n  allow do\n    origins 'http://localhost:6000'\n    resource '*', headers: :any, methods: [:get, :post, :options, :put, :delete]\n  end\n\nend\n</code></pre>\n\n<p>So it will allow \"<a href=\"http://localhost:3000\" rel=\"noreferrer\">http://localhost:3000</a>\" to access only '/api/*' \nand allow '<a href=\"http://localhost:6000\" rel=\"noreferrer\">http://localhost:6000</a>' to access all. is it possible?</p>\n\n<p>is the above code the correct code/syntax for doing that?</p>\n\n<p>thanks.</p>\n"}, {"tags": ["ruby", "puma", "grape", "grape-api"], "answers": [{"tags": [], "owner": {"reputation": 255, "user_id": 5113155, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FIUl3zhfb44/AAAAAAAAAAI/AAAAAAAAAH4/laqHbUiRvys/photo.jpg?sz=128", "display_name": "Amanda Cavallaro", "link": "https://stackoverflow.com/users/5113155/amanda-cavallaro"}, "is_accepted": false, "score": 0, "last_activity_date": 1484233971, "last_edit_date": 1484233971, "creation_date": 1484226969, "answer_id": 41614216, "question_id": 41588473, "link": "https://stackoverflow.com/questions/41588473/grape-stand-alone-rest-api-error-no-application-configured-nothing-to-run/41614216#41614216", "title": "Grape stand alone rest api ERROR: No application configured, nothing to run", "body": "<p>I got my answer from Daniel @ <a href=\"https://groups.google.com/forum/#!forum/ruby-grape\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!forum/ruby-grape</a></p>\n\n<p>There was a syntax error, his code below fixed my problem, I appreciate it.</p>\n\n<pre><code>require 'rubygems' \nrequire 'grape'\n\nDir.glob(\"**/*.rb\").each do |f|\nputs \"Loaded #{f}\"\nrequire_relative \"../#{f}\" unless File.absolute_path(f) == __FILE__\nend\n</code></pre>\n"}], "owner": {"reputation": 255, "user_id": 5113155, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FIUl3zhfb44/AAAAAAAAAAI/AAAAAAAAAH4/laqHbUiRvys/photo.jpg?sz=128", "display_name": "Amanda Cavallaro", "link": "https://stackoverflow.com/users/5113155/amanda-cavallaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 794, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484233971, "creation_date": 1484130862, "question_id": 41588473, "link": "https://stackoverflow.com/questions/41588473/grape-stand-alone-rest-api-error-no-application-configured-nothing-to-run", "title": "Grape stand alone rest api ERROR: No application configured, nothing to run", "body": "<p>I have followed this tutorial step by step: <a href=\"https://wildandcrazytutorials.wordpress.com/2016/03/05/how-to-build-a-grape-standalone-rest-api/\" rel=\"nofollow noreferrer\">https://wildandcrazytutorials.wordpress.com/2016/03/05/how-to-build-a-grape-standalone-rest-api/</a> </p>\n\n<p>However I get the error: </p>\n\n<pre><code>Puma starting in single mode...\nVersion 3.6.2 (ruby 2.2.2-p95), codename: Sleepy Sunday Serenity\nMin threads: 0, max threads: 16\nEnvironment: development\nERROR: No application configured, nothing to run\n</code></pre>\n\n<p>when I run puma in In ./myapp</p>\n\n<p>I am running it on a MacOs.</p>\n\n<p>I am new to grape and I would love some guidance. I have literally simply followed the tutorial up to \"Run the following to startup the server after every change\u2026</p>\n\n<p>In ./myapp</p>\n\n<p>$ puma\"</p>\n"}, {"tags": ["ruby-on-rails", "angularjs", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 2478, "user_id": 2791480, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lgiv3.jpg?s=128&g=1", "display_name": "Mohamed Yakout", "link": "https://stackoverflow.com/users/2791480/mohamed-yakout"}, "is_accepted": false, "score": 1, "last_activity_date": 1484137944, "creation_date": 1484137944, "answer_id": 41591075, "question_id": 41588044, "link": "https://stackoverflow.com/questions/41588044/booting-up-rails-api-and-angular2-app-with-single-command-for-local-development/41591075#41591075", "title": "Booting up Rails api and Angular2 app with single command for local development", "body": "<p>I think you'll need to merge the both in rails application. But Usually API &amp; FrontEnd should be on different servers. So, What's the solution if you have Mobile-App send the request to this API. I don't think you can start the mobile App &amp; rails App once?</p>\n\n<p>You can handle format HTML &amp; JSON in rails actions (To handle rails application &amp; API), then merge Angular App with Rails App as the following: </p>\n\n<p>You should add <code>app</code> directory of angular 2 to <code>public</code> folder in rails folder. Also, Load <code>node_modules</code> folder in <code>class Application</code> as the following: </p>\n\n<pre><code>config.assets.paths &lt;&lt; Rails.root.join('node_modules')\n</code></pre>\n\n<p>Change routes of angular 2 to the same port of rails server: </p>\n\n<pre><code>this.http.get('http://localhost:3000/api').subscribe( \ndata =&gt; this.message = data.json().some, err =&gt; console.log(err) );\n</code></pre>\n\n<p>I suggest to read this to help you: </p>\n\n<p><a href=\"https://www.pluralsight.com/guides/ruby-ruby-on-rails/react-vs-angular-2-integration-with-rails\" rel=\"nofollow noreferrer\">Integrate Angular 2 with rails</a>.</p>\n"}], "owner": {"reputation": 24422, "user_id": 190623, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ded2adc034647d0e934806583137ecdd?s=128&d=identicon&r=PG", "display_name": "Gandalf StormCrow", "link": "https://stackoverflow.com/users/190623/gandalf-stormcrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535995899, "creation_date": 1484129664, "last_edit_date": 1535995899, "question_id": 41588044, "link": "https://stackoverflow.com/questions/41588044/booting-up-rails-api-and-angular2-app-with-single-command-for-local-development", "title": "Booting up Rails api and Angular2 app with single command for local development", "body": "<p>I have our back-end api app running separately from our front-end Angular driven instance. </p>\n\n<p>Basically two different apps:</p>\n\n<ol>\n<li>Rails api runs on unicorn</li>\n<li>angular app that runs on Apache web server</li>\n</ol>\n\n<p>We might add more dependencies to our stack such as Redis or anything else. How do I start everything at once? Without having to start everything else individually in the separate console tabs?</p>\n\n<p>What I've found so far that could do something similar is (pow.cx), I just don't know how I would configure it to run Apache web server along with my api, that's why I'm kind of asking this question.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "capistrano3"], "comments": [{"owner": {"reputation": 708, "user_id": 3122676, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8010ad2ee7c8b7a109b6679699c0b20e?s=128&d=identicon&r=PG&f=1", "display_name": "fossil", "link": "https://stackoverflow.com/users/3122676/fossil"}, "edited": false, "score": 0, "creation_date": 1484180234, "post_id": 41587095, "comment_id": 70408704, "body": "Try <code>rsync -avvv &#47;home&#47;deploy&#47;unmounted &#47;home&#47;deploy&#47;mounted</code>. You will get a very verbose log. Probably it will tell you something."}, {"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "reply_to_user": {"reputation": 708, "user_id": 3122676, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8010ad2ee7c8b7a109b6679699c0b20e?s=128&d=identicon&r=PG&f=1", "display_name": "fossil", "link": "https://stackoverflow.com/users/3122676/fossil"}, "edited": false, "score": 0, "creation_date": 1484214981, "post_id": 41587095, "comment_id": 70421519, "body": "Thanks @fossil, I was actually doing a mistake, my intent was to copy the contents of unmounted folder and not the folder itself. So I fixed the rsync code: <code>rsync -av &#47;home&#47;deploy&#47;unmounted&#47;* &#47;home&#47;deploy&#47;mounted</code> and it worked as expected."}, {"owner": {"reputation": 708, "user_id": 3122676, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8010ad2ee7c8b7a109b6679699c0b20e?s=128&d=identicon&r=PG&f=1", "display_name": "fossil", "link": "https://stackoverflow.com/users/3122676/fossil"}, "edited": false, "score": 1, "creation_date": 1484215298, "post_id": 41587095, "comment_id": 70421743, "body": "Guessed so. <code>rsync -av</code> pretty much does what you want to do."}], "answers": [{"tags": [], "owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "is_accepted": true, "score": 0, "last_activity_date": 1484283043, "creation_date": 1484283043, "answer_id": 41627569, "question_id": 41587095, "link": "https://stackoverflow.com/questions/41587095/rsync-shows-files-are-synced-but-could-not-find-it-in-aws-s3/41627569#41627569", "title": "Rsync shows files are synced but could not find it in AWS S3", "body": "<p>I was actually doing a mistake, my intent was to copy the contents of <strong>unmounted</strong> folder and <strong>not the folder</strong> itself. So I fixed the rsync code: <code>rsync -av /home/deploy/unmounted/* /home/deploy/mounted</code> and it worked as expected.</p>\n"}], "owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 41627569, "answer_count": 1, "score": 1, "last_activity_date": 1484283043, "creation_date": 1484127036, "question_id": 41587095, "link": "https://stackoverflow.com/questions/41587095/rsync-shows-files-are-synced-but-could-not-find-it-in-aws-s3", "title": "Rsync shows files are synced but could not find it in AWS S3", "body": "<p>I am using <strong>capistrano 3</strong> and <strong>Ruby on Rails 3.2.14</strong>, with <strong>Ruby 2.1.0</strong>. I have written a <strong>recipe</strong> to check for S3 mount status and then run specific set of actions:</p>\n\n<ol>\n<li>If bucket is unmounted and the folder<code>(public/system)</code> is empty then mount it using <code>s3fs</code></li>\n<li>If bucket is unmounted and the folder is not empty then use rsync to move the files from <code>public/system</code> to s3 bucket and then emptying the folder <code>public/system</code> and remounting it.</li>\n</ol>\n\n<p><strong>rsync</strong> shows that the files are incrementally sent but I cannot find them in the bucket. This is the output that I get:</p>\n\n<pre><code>  05 rsync -av /home/deploy/unmounted /home/deploy/mounted\n  05 sending incremental file list\n  05 unmounted/\n  05 unmounted/ckeditor/\n  05 unmounted/ckeditor/pictures/\n  05 unmounted/ckeditor/pictures/16736/\n  05 unmounted/ckeditor/pictures/16736/bike.jpg\n  05 unmounted/ckeditor/pictures/16736/content_bike.jpg\n  05 unmounted/ckeditor/pictures/16736/thumb_bike.jpg\n  05\n  05 sent 750,943 bytes  received 93 bytes  166,896.89 bytes/sec\n  05 total size is 750,396  speedup is 1.00\n</code></pre>\n\n<p><strong>Recipe</strong> for mounting s3, I have not optimized it yet as first I just want to check if its working,</p>\n\n<pre><code>desc \"Mounting S3\"\n    task :mounting_s3 do\n        on main_server, in: :sequence, wait: 5 do |host|\n            as 'deploy' do\n                within \"#{code_folder_path}/current\" do\n                    code_folder = \"#{code_folder_path}/current\"\n                    path = \"#{code_folder_path}/current/public/system\"\n                    unmount_path = \"#{code_folder_path}/shared/public/system\"\n\n                    # check first if public/system exists\n                    puts \"** Checking if public/system folder exists on #{host}\"\n                    puts \"** testing if it is there #{test(\"[ -d #{path} ]\")}\"\n                    if test(\"[ -d #{path} ]\")\n                        puts \"** public/system folder exists..\"\n                        puts \"** Checking if S3 is mounted\"\n                        result = capture \"cd #{code_folder} &amp;&amp; mountpoint public/system\" , raise_on_non_zero_exit: false\n                        puts \"result #{result}\"\n                        if  result.match('is a mountpoint') != nil\n                            puts \"** S3 is mounted at #{path} on #{host}\"\n                        elsif result.match('is not a mountpoint') != nil\n                            puts \"** #{path} is not a mountpoint on #{host}\"\n                            result = capture \"ls -A #{unmount_path}\"\n                            if result.length &gt; 0\n                                puts \"** public/system is not empty\"\n                                if test(\"[ -d /home/deploy/mounted ]\")\n\n                                    puts \"** mounted folder exists\"\n\n                                    puts \"checking if folder is mounted\"\n                                    result = capture \"mountpoint /home/deploy/mounted\" , raise_on_non_zero_exit: false\n                                    puts \"result #{result}\"\n\n                                    if  result.match('is a mountpoint') != nil\n                                        puts \"** mounted folder is mounted so unmounting it\"\n                                        execute! \"fusermount -u /home/deploy/mounted\"\n                                        puts \"** mounted folder is unmounted now\"\n\n                                        puts \"** Deleting mounted folder\"\n                                        execute! \"cd /home/deploy/ &amp;&amp; sudo rm -r mounted\"\n                                        puts \"** mounted folder deleted\"\n\n                                    elsif result.match('is not a mountpoint') != nil\n\n                                        puts \"** Deleting mounted folder\"\n                                        execute! \"sudo rm -r /home/deploy/mounted\"\n                                        puts \"** mounted folder deleted\"\n\n                                    end\n                                end\n\n                                if test(\"[ -d /home/deploy/unmounted ]\")\n                                    puts \"** deleting unmounted folder\"\n                                    execute! \"cd /home/deploy/ &amp;&amp; sudo rm -r unmounted\"\n                                    puts \"** unmounted folder deleted\"\n                                end\n\n                                puts \"** mounting bucket\"\n                                execute! \"cd /home/deploy/ &amp;&amp; mkdir unmounted &amp;&amp; mkdir mounted\"\n                                execute! \"s3fs s3_bucket /home/deploy/mounted\"\n                                puts \"** bucket mounted on /home/deploy/mounted folder\"\n\n                                puts \"** copying files from public/system to unmounted\"\n                                execute! \"cp -r #{unmount_path}/* /home/deploy/unmounted/.\"\n                                puts \"** files copied\"\n\n                                puts \"** syncing unmounted files to s3\"\n                                execute! \"rsync -av /home/deploy/unmounted /home/deploy/mounted\"\n                                puts \"** Files synced\"\n\n                                puts \"** unmounting mounted folder now for safety\"\n                                execute! \"fusermount -u /home/deploy/mounted\"\n                                puts \"** folder unmounted\"\n\n                                puts \"** deleting unmounted folder now\"\n                                execute! \"sudo rm -r /home/deploy/unmounted\"\n                                puts \"** folders deleted\\n\"\n\n                                puts \"** emptying public/system\"\n                                execute! \"sudo rm -r #{unmount_path}/../system/*\"\n                                puts \"** folder is empty, mounting public/system\"\n\n                                execute! \"s3fs s3-bucket #{path}\"\n                                puts \"** s3 is mounted\"\n                            else\n                                puts \"** public/system is empty\"\n                                execute! \"cd #{code_folder} &amp;&amp; s3fs s3-bucket #{path}\"\n                                puts \"** s3 is mounted\"\n                            end \n\n                        end \n                    else\n                        puts \"** public/system folder does not exists..\"\n                        puts \"** Mounting S3\"\n                        execute! \"cd #{code_folder} &amp;&amp; s3fs s3-bucket #{path}\"\n                    end \n                end\n            end\n</code></pre>\n\n<p>The output that I get after running <code>cap staging deploy:mounting_s3 --trace</code>:</p>\n\n<pre><code>** Invoke www_data (first_time)\n** Execute www_data\n** Invoke load:defaults (first_time)\n** Execute load:defaults\n** Invoke rvm:hook (first_time)\n** Execute rvm:hook\n** Invoke rvm:check (first_time)\n** Execute rvm:check\nrvm 1.27.0 (latest) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\nruby-2.1.0\nruby 2.1.0p0 (2013-12-25 revision 44422) [x86_64-linux]\n** Invoke bundler:map_bins (first_time)\n** Execute bundler:map_bins\n** Invoke deploy:set_rails_env (first_time)\n** Execute deploy:set_rails_env\n** Invoke deploy:set_linked_dirs (first_time)\n** Execute deploy:set_linked_dirs\n** Invoke deploy:set_rails_env \n** Invoke deploy:mounting_s3 (first_time)\n** Execute deploy:mounting_s3\n** Checking if public/system folder exists on webby\n** testing if it is there true\n** public/system folder exists..\n** Checking if S3 is mounted\nresult public/system is not a mountpoint\n** /home/deploy/apps/web_cc_cap1/current/public/system is not a mountpoint on webby\n** public/system is not empty\n** mounted folder exists\nchecking if folder is mounted\nresult /home/deploy/mounted is not a mountpoint\n** Deleting mounted folder\n00:00 deploy:mounting_s3\n      01 sudo rm -r /home/deploy/mounted\n    \u2714 01 webby 0.649s\n** mounted folder deleted\n** mounting bucket\n      02 cd /home/deploy/ &amp;&amp; mkdir unmounted &amp;&amp; mkdir mounted\n    \u2714 02 webby 0.631s\n      03 s3fs s3-bucket /home/deploy/mounted\n    \u2714 03 webby 0.619s\n** bucket mounted on /home/deploy/mounted folder\n** copying files from public/system to unmounted\n      04 cp -r /home/deploy/apps/web_cc_cap1/shared/public/system/* /home/deploy/unmounted/.\n    \u2714 04 webby 0.651s\n** files copied\n** syncing unmounted files to s3\n      05 rsync -av /home/deploy/unmounted /home/deploy/mounted\n      05 sending incremental file list\n      05 unmounted/\n      05 unmounted/ckeditor/\n      05 unmounted/ckeditor/pictures/\n      05 unmounted/ckeditor/pictures/16736/\n      05 unmounted/ckeditor/pictures/16736/bike.jpg\n      05 unmounted/ckeditor/pictures/16736/content_bike.jpg\n      05 unmounted/ckeditor/pictures/16736/thumb_bike.jpg\n      05\n      05 sent 750,943 bytes  received 93 bytes  166,896.89 bytes/sec\n      05 total size is 750,396  speedup is 1.00\n    \u2714 05 webby 4.299s\n** Files synced\n** unmounting mounted folder now for safety\n      06 fusermount -u /home/deploy/mounted\n    \u2714 06 webby 0.631s\n** folder unmounted\n** deleting unmounted folder now\n      07 sudo rm -r /home/deploy/unmounted\n    \u2714 07 webby 0.621s\n** folders deleted\n** emptying public/system\n      08 sudo rm -r /home/deploy/apps/web_cc_cap1/shared/public/system/../system/*\n    \u2714 08 webby 0.649s\n** folder is empty, mounting public/system\n      09 s3fs s3-bucket /home/deploy/apps/web_cc_cap1/current/public/system\n    \u2714 09 webby 0.623s\n** s3 is mounted\n</code></pre>\n\n<p>Why is it not sending the files to s3 bucket?</p>\n"}, {"tags": ["ruby", "macos", "rubygems", "jekyll"], "comments": [{"owner": {"reputation": 506, "user_id": 4676485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/88b3de5f8204fa20457b1def81848368?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/4676485/alan"}, "edited": false, "score": 0, "creation_date": 1484251326, "post_id": 41586540, "comment_id": 70445246, "body": "I&#39;d personally add it to your gem file <code>gem &#39;jekyll-docs&#39;, &#39;3.3.0&#39;</code> and then do <code>bundle install</code>?  If it&#39;s already installed try running <code>jekyll _3.3.0_ docs</code>"}, {"owner": {"reputation": 506, "user_id": 4676485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/88b3de5f8204fa20457b1def81848368?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/4676485/alan"}, "edited": false, "score": 0, "creation_date": 1484251433, "post_id": 41586540, "comment_id": 70445314, "body": "You also need to make sure you&#39;re using Jekyll 3.3.0 as well."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 506, "user_id": 4676485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/88b3de5f8204fa20457b1def81848368?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/4676485/alan"}, "edited": false, "score": 0, "creation_date": 1484276139, "post_id": 41586540, "comment_id": 70454229, "body": "@Alan Yeah I was using <code>jekyll 3.3.1</code> with <code>jekyll-docs 3.3.0</code>, which presumably caused the issue. The problem now is that I&#39;m using other gems(<code>github-pages (= 114)</code>) which depends on <code>jekyll (= 3.3.1)</code>, so I cannot downgrade jekyll :("}, {"owner": {"reputation": 506, "user_id": 4676485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/88b3de5f8204fa20457b1def81848368?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/4676485/alan"}, "edited": false, "score": 0, "creation_date": 1484276719, "post_id": 41586540, "comment_id": 70454358, "body": "If you&#39;re using the gem method, you could try a <code>bundle update</code> but that will update all to the latest versions"}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 506, "user_id": 4676485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/88b3de5f8204fa20457b1def81848368?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/4676485/alan"}, "edited": false, "score": 0, "creation_date": 1484299193, "post_id": 41586540, "comment_id": 70462096, "body": "@Alan Updated everything with <code>bundle update</code>, still getting the above error, no matter I run <code>jekyll docs</code> or <code>bundle install jekyll docs</code>"}, {"owner": {"reputation": 506, "user_id": 4676485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/88b3de5f8204fa20457b1def81848368?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/4676485/alan"}, "edited": false, "score": 0, "creation_date": 1484304165, "post_id": 41586540, "comment_id": 70465092, "body": "Try this $ gem install jekyll-docs -v 3.0.3, then $ gem install jekyll -v 3.0.3, then $ jekyll <i>3.0.3</i> docs - sorry for lack of formatting I&#39;m on my phone will edit in a bit"}], "answers": [{"comments": [{"owner": {"reputation": 3331, "user_id": 2680007, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/30f9a8816cd2df4f9d80fbb0070f1b3d?s=128&d=identicon&r=PG", "display_name": "George WS", "link": "https://stackoverflow.com/users/2680007/george-ws"}, "edited": false, "score": 0, "creation_date": 1500059119, "post_id": 41952208, "comment_id": 77191523, "body": "Looks like the issue is having an installation of Jekyll with a higher version number than the version of Jekyll docs you have installed. (I imagine Jekyll docs and Jekyll have matching version numbers, to indicate which version of Jekyll is being documented.) This should be the accepted answer :)"}], "tags": [], "owner": {"reputation": 919, "user_id": 1119076, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68715865c30f64df9fb2c0e92e625596?s=128&d=identicon&r=PG", "display_name": "sergpank", "link": "https://stackoverflow.com/users/1119076/sergpank"}, "is_accepted": false, "score": 2, "last_activity_date": 1485848765, "creation_date": 1485848765, "answer_id": 41952208, "question_id": 41586540, "link": "https://stackoverflow.com/questions/41586540/jekyll-docs-not-installing-on-macos/41952208#41952208", "title": "jekyll-docs not installing on macOS", "body": "<p>Had the same issue.</p>\n\n<p>In my case I had two jekyll gems:</p>\n\n<pre><code>sergpank$ gem list jekyll\n\n*** LOCAL GEMS ***\n\njekyll (3.4.0, 3.3.1)\njekyll-docs (3.3.1)\njekyll-feed (0.8.0)\njekyll-sass-converter (1.5.0)\njekyll-watch (1.5.0)\n</code></pre>\n\n<p>I have simply uninstalled 3.4.0 (because there was no jekyll-docs-3.4.0):</p>\n\n<pre><code>sergpank$ gem uninstall jekyll -v 3.4.0\nSuccessfully uninstalled jekyll-3.4.0\n\n---------------------------------------\n\nsergpank$ gem list jekyll\n\n*** LOCAL GEMS ***\n\njekyll (3.3.1)\njekyll-docs (3.3.1)\njekyll-feed (0.8.0)\njekyll-sass-converter (1.5.0)\njekyll-watch (1.5.0)\n</code></pre>\n\n<p>After what <strong>jekyll docs</strong> was successfully started!</p>\n"}], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485848765, "creation_date": 1484125248, "question_id": 41586540, "link": "https://stackoverflow.com/questions/41586540/jekyll-docs-not-installing-on-macos", "title": "jekyll-docs not installing on macOS", "body": "<p><a href=\"https://jekyllrb.com/docs/usage/\" rel=\"nofollow noreferrer\">Jekyll's document</a> says,</p>\n\n<blockquote>\n  <p>If you\u2019re interested in browsing these docs on-the-go, install the\n  <code>jekyll-docs</code> gem and run <code>jekyll docs</code> in your terminal.</p>\n</blockquote>\n\n<p>When I tried to install jekyll-docs on my MacBook Air running macOS Sierra, I bumped into the following problem:</p>\n\n<pre><code>sunqingyaos-MacBook-Air:myblog sunqingyao$ jekyll docs\nYou must install the 'jekyll-docs' gem to use the 'jekyll docs' command. \nsunqingyaos-MacBook-Air:myblog sunqingyao$ sudo gem install jekyll-docs\nSuccessfully installed jekyll-docs-3.3.0\nParsing documentation for jekyll-docs-3.3.0\n1 gem installed\nsunqingyaos-MacBook-Air:myblog sunqingyao$ jekyll docs\nYou must install the 'jekyll-docs' gem to use the 'jekyll docs' command. \nsunqingyaos-MacBook-Air:myblog sunqingyao$ \n</code></pre>\n\n<p>As you can see, rubygems told me it has <code>successfully installed jekyll-docs-3.3.0</code>, while <code>jekyll docs</code> kept falling. I've restarted the terminal, still not working.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484125656, "post_id": 41585685, "comment_id": 70376989, "body": "I&#39;m not sure I understand. Did you already write something and would like to know if it can be done directly? If so, what did you write?"}], "answers": [{"comments": [{"owner": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "edited": false, "score": 0, "creation_date": 1484131615, "post_id": 41585993, "comment_id": 70381116, "body": "Thanks mohamed. This really works. But I would like to know if I pass an argument like (&#39;US&#39;) or (&#39;AE&#39;), will it give me the timezone available for them. Is there any way for that?"}, {"owner": {"reputation": 2478, "user_id": 2791480, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lgiv3.jpg?s=128&g=1", "display_name": "Mohamed Yakout", "link": "https://stackoverflow.com/users/2791480/mohamed-yakout"}, "reply_to_user": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "edited": false, "score": 0, "creation_date": 1484131911, "post_id": 41585993, "comment_id": 70381300, "body": "@ShabiniRajadas you should use string from Mapping Hash. So, you can use as the following: <code>ActiveSupport::TimeZone.new(&quot;Pacific Time (US &amp; Canada)&quot;)</code> Or <code>ActiveSupport::TimeZone.new(&quot;Mountain Time (US &amp; Canada)&quot;)</code> .. Because You should specify the place."}], "tags": [], "owner": {"reputation": 2478, "user_id": 2791480, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lgiv3.jpg?s=128&g=1", "display_name": "Mohamed Yakout", "link": "https://stackoverflow.com/users/2791480/mohamed-yakout"}, "is_accepted": true, "score": 3, "last_activity_date": 1484123454, "creation_date": 1484123454, "answer_id": 41585993, "question_id": 41585685, "link": "https://stackoverflow.com/questions/41585685/list-the-time-zones-for-a-country/41585993#41585993", "title": "List the time zones for a Country", "body": "<p>You can use <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html\" rel=\"nofollow noreferrer\">TimeZone</a> class. You can get all timezones list by: </p>\n\n<pre><code>zones_hash = ActiveSupport::TimeZone::MAPPING\n</code></pre>\n\n<p>And you can get time zone of any country as the following: </p>\n\n<pre><code>country_zone = ActiveSupport::TimeZone.new(\"Europe/Skopje\")\ncountry_zone.formatted_offset\n</code></pre>\n\n<p>The output: <code>+01:00</code> for the above example.</p>\n"}, {"tags": [], "owner": {"reputation": 2585, "user_id": 229976, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/710bfda3a3853600518fce649aaf8bb1?s=128&d=identicon&r=PG&f=1", "display_name": "tfwright", "link": "https://stackoverflow.com/users/229976/tfwright"}, "is_accepted": false, "score": 2, "last_activity_date": 1561702298, "creation_date": 1561702298, "answer_id": 56801749, "question_id": 41585685, "link": "https://stackoverflow.com/questions/41585685/list-the-time-zones-for-a-country/56801749#56801749", "title": "List the time zones for a Country", "body": "<p>In Rails 5.2 this is simple: <code>ActiveSupport::TimeZone.country_zones(\"US\")</code></p>\n"}], "owner": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2621, "favorite_count": 0, "accepted_answer_id": 41585993, "answer_count": 2, "score": 1, "last_activity_date": 1561702298, "creation_date": 1484122186, "last_edit_date": 1484123750, "question_id": 41585685, "link": "https://stackoverflow.com/questions/41585685/list-the-time-zones-for-a-country", "title": "List the time zones for a Country", "body": "<p>I am looking for the code that displays list of countries/regions in ruby on rails when selecting a specific country/region, it displays the time zone of it. For example when i choose \u201cUnited Kingdom\" as country/region then it should displays \u201c(GMT +00:00)London\" as Time Zone. My application runs on Rails 3.2.11. I am displaying all the countries using <strong>countries</strong> gem and all the time zones using <strong>ActiveSupport::TimeZone</strong>. I want to know if Ruby on Rails provide this functionality by default or if there is any other possible way to achieve this.</p>\n"}, {"tags": ["ruby", "programmatically", "instance-method"], "answers": [{"tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 5, "last_activity_date": 1484155894, "last_edit_date": 1484155894, "creation_date": 1484123706, "answer_id": 41586055, "question_id": 41585621, "link": "https://stackoverflow.com/questions/41585621/ruby-programmatically-calling-method-with-variable-number-of-args/41586055#41586055", "title": "Ruby programmatically calling method, with variable number of args", "body": "<p>Try this</p>\n\n<pre><code>def foo(a, b)\n  puts a\n  puts b\nend\n\narray = ['bar', 'qux']\nsend(:foo, *array) # using send\nfoo(*array) # using the method name\n</code></pre>\n\n<p>Both print</p>\n\n<pre><code>bar\nqux\n</code></pre>\n\n<p>The splat operator <code>*</code> packs or unpacks an array. </p>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 3950314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f452817dbb732a622ea3609a357c18e?s=128&d=identicon&r=PG&f=1", "display_name": "John Nikolaou", "link": "https://stackoverflow.com/users/3950314/john-nikolaou"}, "edited": false, "score": 0, "creation_date": 1484126775, "post_id": 41586082, "comment_id": 70377732, "body": "This solution works. I can&#39;t help to ask, is what I&#39;m doing a good practice? Or do you think I should construct this differently?"}, {"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "reply_to_user": {"reputation": 141, "user_id": 3950314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f452817dbb732a622ea3609a357c18e?s=128&d=identicon&r=PG&f=1", "display_name": "John Nikolaou", "link": "https://stackoverflow.com/users/3950314/john-nikolaou"}, "edited": false, "score": 0, "creation_date": 1484132803, "post_id": 41586082, "comment_id": 70381888, "body": "I&#39;m rails programmer for more than 7 years and for me it&#39;s no fault to do it this way. I saw a lot of rails code using splats. Be careful to not send direct user input to your function. This could be a security vulnerability."}], "tags": [], "owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "is_accepted": false, "score": 2, "last_activity_date": 1484133131, "last_edit_date": 1484133131, "creation_date": 1484123795, "answer_id": 41586082, "question_id": 41585621, "link": "https://stackoverflow.com/questions/41585621/ruby-programmatically-calling-method-with-variable-number-of-args/41586082#41586082", "title": "Ruby programmatically calling method, with variable number of args", "body": "<p>Some years ago I did what you are trying now. With an asterisk in front of a method parameter you can receive as many parameters as you want in a function. So You don't need to know the number of the given parameters. It's called a splat.</p>\n\n<p>Send your values as an array with an asterisk in front too and it will work.</p>\n\n<p>I tested the folling with an irb console:</p>\n\n<pre><code>def test(*args)\n  puts args.inspect\nend\n\nmy_args = [1, 2, 3]\nself.send(:test, *my_args)\n# [1, 2, 3]\n# =&gt; nil\n</code></pre>\n\n<p>Or send as many single parameters as you want:</p>\n\n<pre><code>self.send(:test, 'a', 'b', 'c', 'd')\n# [\"a\", \"b\", \"c\", \"d\"]\n# =&gt; nil\n</code></pre>\n\n<p>If you have a fixed number of parameters this will work:</p>\n\n<pre><code>def test(arg1, arg2, arg3)\n  puts arg1.inspect\n  puts arg2.inspect\n  puts arg3.inspect\nend\n\nmy_args = [1, 2, 3]\nself.send(:test, *my_args)\n# 1\n# 2\n# 3\n# =&gt; nil\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1484140544, "last_edit_date": 1484140544, "creation_date": 1484127439, "answer_id": 41587230, "question_id": 41585621, "link": "https://stackoverflow.com/questions/41585621/ruby-programmatically-calling-method-with-variable-number-of-args/41587230#41587230", "title": "Ruby programmatically calling method, with variable number of args", "body": "<p>First, you shouldn't use <code>send</code>. You could use <code>public_send</code>, <code>Method#call</code> or just <code>bar(...)</code> if you know the method name.</p>\n\n<h1>Homogenous parameters</h1>\n\n<p>If the parameters are homogenous (e.g. are instances of the same Class), you can just put them in an Array, and use this Array as parameter :</p>\n\n<pre><code>def analyze_array(array)\n  puts \"Elements : #{array}\"\n  puts \"Length   : #{array.size}\"\n  puts \"Sum      : #{array.inject(:+)}\"\n  puts\nend\n\nanalyze_array([1,2,3])\nanalyze_array([1,2,3,4,5])\n</code></pre>\n\n<p>It outputs :</p>\n\n<pre><code>Elements : [1, 2, 3]\nLength   : 3\nSum      : 6\n\nElements : [1, 2, 3, 4, 5]\nLength   : 5\nSum      : 15\n</code></pre>\n\n<h3>Example</h3>\n\n<p>Refactoring your code a bit, it could become :</p>\n\n<pre><code>arg_arr   = [:bar, 1]\narg_arr_2 = [:foobar, 1, 2]\n\ndef bar(array)\n  puts \"  bar with one parameter : #{array}\"\nend\n\ndef foobar(array)\n  puts \"  foobar with one parameter : #{array}\"\nend\n\n[:serial, :parallel].each do |mode|\n  puts \"Mode : #{mode}\"\n  [arg_arr, arg_arr_2].each do |method_and_args|\n    method_name, *args = method_and_args\n    args &lt;&lt; 3 if mode != :serial\n    method(method_name).call(args)\n  end\nend\n</code></pre>\n\n<p>It outputs :</p>\n\n<pre><code>Mode : serial\n  bar with one parameter : [1]\n  foobar with one parameter : [1, 2]\nMode : parallel\n  bar with one parameter : [1, 3]\n  foobar with one parameter : [1, 2, 3]\n</code></pre>\n\n<h1>Heterogenous parameters</h1>\n\n<p>For an unknown number of parameters that might belong to different classes, you can use the splat operator (<a href=\"https://ruby-doc.org/core-2.3.1/doc/syntax/calling_methods_rdoc.html\" rel=\"nofollow noreferrer\">documentation</a>) :</p>\n\n<pre><code>def analyze_parameters(*params)\n  puts \"Parameters : #{params}\"\n  puts \"Number     : #{params.size}\"\n  puts \"Classes    : #{params.map(&amp;:class)}\"\nend\n\nanalyze_parameters('Test')\nanalyze_parameters(1, 'a', :b, [:c, :d])\n</code></pre>\n\n<p>It outputs :</p>\n\n<pre><code>Parameters : [\"Test\"]\nNumber     : 1\nClasses    : [String]\n\nParameters : [1, \"a\", :b, [:c, :d]]\nNumber     : 4\nClasses    : [Fixnum, String, Symbol, Array]\n</code></pre>\n\n<p>Your example becomes :</p>\n\n<pre><code>arg_arr   = [:bar, 1 ]\narg_arr_2 = [:foobar, 1, 'a']\n\ndef bar(*params)\n  puts \"  bar with multiple parameters : #{params}\"\nend\n\ndef foobar(*params)\n  puts \"  foobar with multiple parameters : #{params}\"\nend\n\n[:serial, :parallel].each do |mode|\n  puts \"Mode : #{mode}\"\n  [arg_arr, arg_arr_2].each do |method_and_args|\n    method_name, *args = method_and_args\n    args &lt;&lt; :b if mode != :serial\n    method(method_name).call(*args)\n  end\nend\n</code></pre>\n\n<p>It outputs :</p>\n\n<pre><code>Mode : serial\n  bar with multiple parameters : [1]\n  foobar with multiple parameters : [1, \"a\"]\nMode : parallel\n  bar with multiple parameters : [1, :b]\n  foobar with multiple parameters : [1, \"a\", :b]\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 3950314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f452817dbb732a622ea3609a357c18e?s=128&d=identicon&r=PG&f=1", "display_name": "John Nikolaou", "link": "https://stackoverflow.com/users/3950314/john-nikolaou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1908, "favorite_count": 0, "accepted_answer_id": 41586055, "answer_count": 3, "score": 6, "last_activity_date": 1484155894, "creation_date": 1484121957, "question_id": 41585621, "link": "https://stackoverflow.com/questions/41585621/ruby-programmatically-calling-method-with-variable-number-of-args", "title": "Ruby programmatically calling method, with variable number of args", "body": "<p>I am trying to do something similar to this: </p>\n\n<pre><code>def foo(mode= :serial)\n\n  if (mode == :serial) then\n    self.send(:bar, \"one_type\")\n  else\n    self.send(:bar,\"second_type\",:T5)\n  end\nend\n</code></pre>\n\n<p>I can obviously type this out like this. </p>\n\n<p>But I've recently tried expanding it to include a second function like this:</p>\n\n<pre><code>def foo(mode= :serial)\n\n  if (mode == :serial) then\n    self.send(:bar, \"one_type\")\n    self.send(:foobar, \"one_type\",20)\n  else\n    self.send(:bar,\"second_type\",:T5)\n    self.send(:foobar, \"one_type\",20,:T5)\n  end\nend\n</code></pre>\n\n<p>I can still continue as it is, but I thought to myself, there's a pattern here, I should abstract the arguments away into another layer and make this simpler. </p>\n\n<p>So what I wanted to do was something like this: </p>\n\n<pre><code>arg_arr   = [:bar, \"one_type\"]\narg_arr_2 = [:foobar, \"one_type\", 20]\nif (mode == :serial) then\n  self.send(arg_arr)\n  self.send(arg_arr_2)\nelse\n  arg_arr &lt;&lt; :T5\n  arg_arr2 &lt;&lt; :T5\n  self.send(arg_arr)\n  self.send(arg_arr2 )\nend\n</code></pre>\n\n<p>I tried some other ideas involving .each, .inspect, but nothing that would work (the usual error was can't convert array into string, which I'm guessing refers to the fact that it treats the array as the entire function name). I can do it if I explicitly say \"use array elements[0] , [1] etc, but that just seems wasteful. </p>\n\n<p>Is there a way to achieve this without writing code that is hardcoded to the number of arguments? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "wicked-pdf"], "answers": [{"comments": [{"owner": {"reputation": 2123, "user_id": 5374999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4YXdN.jpg?s=128&g=1", "display_name": "Afsanefda", "link": "https://stackoverflow.com/users/5374999/afsanefda"}, "edited": false, "score": 0, "creation_date": 1484123277, "post_id": 41585754, "comment_id": 70375766, "body": "@Mohamad Yakout this solution didn&#39;t work for me.What&#39;s the difference between these two format of generating PDF ?"}, {"owner": {"reputation": 2478, "user_id": 2791480, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lgiv3.jpg?s=128&g=1", "display_name": "Mohamed Yakout", "link": "https://stackoverflow.com/users/2791480/mohamed-yakout"}, "reply_to_user": {"reputation": 2123, "user_id": 5374999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4YXdN.jpg?s=128&g=1", "display_name": "Afsanefda", "link": "https://stackoverflow.com/users/5374999/afsanefda"}, "edited": false, "score": 0, "creation_date": 1484123546, "post_id": 41585754, "comment_id": 70375898, "body": "You server is WEBrick server, you run using <code>rails s</code> .. and your server stopped when you send request ?  Are you facing this problem ?"}, {"owner": {"reputation": 2123, "user_id": 5374999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4YXdN.jpg?s=128&g=1", "display_name": "Afsanefda", "link": "https://stackoverflow.com/users/5374999/afsanefda"}, "edited": false, "score": 0, "creation_date": 1484124685, "post_id": 41585754, "comment_id": 70376470, "body": "@Mohamad Yakout I&#39;m on rails five so I have Puma instead of WEBrick .no my server doesn&#39;t stop!"}], "tags": [], "owner": {"reputation": 2478, "user_id": 2791480, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lgiv3.jpg?s=128&g=1", "display_name": "Mohamed Yakout", "link": "https://stackoverflow.com/users/2791480/mohamed-yakout"}, "is_accepted": false, "score": 0, "last_activity_date": 1484122505, "creation_date": 1484122505, "answer_id": 41585754, "question_id": 41585575, "link": "https://stackoverflow.com/questions/41585575/how-to-print-generated-pdf-automatically-with-wicked-pdf/41585754#41585754", "title": "How to print generated PDF automatically with Wicked PDF?", "body": "<p>Try the following in your controller: </p>\n\n<pre><code>def generate_pdf\n  render pdf: 'sample_offer_letter', handlers: [:erb], formats: [:html]\nend\n</code></pre>\n\n<p>And In Views folder, create file <code>generate_pdf.html.erb</code> as the following: </p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;title&gt;PDF Title&lt;/title&gt;\n    &lt;%= wicked_pdf_stylesheet_link_tag \"file.css\" -%&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n  &lt;div&gt;    \n    &lt;div&gt;\n      &lt;%= wicked_pdf_image_tag @image %&gt;\n      &lt;div&gt;\n        &lt;h4&gt;&lt;%= Date.today.strftime(\"%d %b, %Y\") %&gt;&lt;/h4&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div&gt;\n      &lt;div&gt;\n        &lt;h3&gt;&lt;%= @variable_in_controller %&gt;&lt;/h3&gt;\n      &lt;/div&gt;\n      &lt;br&gt;\n      &lt;strong&gt;&lt;%= @content %&gt;&lt;/strong&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Call this action, when you click on the button. That's working with me.\nThis action'll allow you to download PDF in your PC, Not open in new tab. </p>\n"}, {"comments": [{"owner": {"reputation": 2123, "user_id": 5374999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4YXdN.jpg?s=128&g=1", "display_name": "Afsanefda", "link": "https://stackoverflow.com/users/5374999/afsanefda"}, "edited": false, "score": 0, "creation_date": 1485358310, "post_id": 41588103, "comment_id": 70894616, "body": "Works fine in Ubuntu Thank you."}], "tags": [], "owner": {"reputation": 362, "user_id": 2787566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c8f0b4fc470756aa44845c610c7c94?s=128&d=identicon&r=PG&f=1", "display_name": "iskvmk", "link": "https://stackoverflow.com/users/2787566/iskvmk"}, "is_accepted": true, "score": 5, "last_activity_date": 1484129815, "creation_date": 1484129815, "answer_id": 41588103, "question_id": 41585575, "link": "https://stackoverflow.com/questions/41585575/how-to-print-generated-pdf-automatically-with-wicked-pdf/41588103#41588103", "title": "How to print generated PDF automatically with Wicked PDF?", "body": "<p>Actually, <strong>print_media_type</strong> option is used for styling your pdf file, not for printing it. <br>\nTo send pdf file directly to printer you can try following:</p>\n\n<ol>\n<li><p>Generate pdf and save it to a file:</p>\n\n<pre><code># create a pdf\npdf = render_to_string pdf: \"some_file_name\", template: \"templates/pdf\", encoding: \"UTF-8\"\n\n# then save to a file\nsave_path = Rails.root.join('pdfs','filename.pdf')\nFile.open(save_path, 'wb') do |file|\n  file &lt;&lt; pdf\nend\n</code></pre></li>\n<li><p>Call <strong>lpr</strong> command to print saved pdf file</p>\n\n<pre><code>system(\"lpr\", \"pdfs/filename.pdf\")\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 2123, "user_id": 5374999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4YXdN.jpg?s=128&g=1", "display_name": "Afsanefda", "link": "https://stackoverflow.com/users/5374999/afsanefda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2686, "favorite_count": 3, "accepted_answer_id": 41588103, "answer_count": 2, "score": 2, "last_activity_date": 1489160486, "creation_date": 1484121806, "last_edit_date": 1489160486, "question_id": 41585575, "link": "https://stackoverflow.com/questions/41585575/how-to-print-generated-pdf-automatically-with-wicked-pdf", "title": "How to print generated PDF automatically with Wicked PDF?", "body": "<p>I'm using <strong>Wicked</strong> PDF and I generate a pdf in a new tab while clicking on the button. But I want to print the pdf by clicking the button <strong>automatically</strong>.I add this <strong>print_media_type</strong> and set the value <strong>true</strong> and I expect my printer options to start working but nothing happens! Have any ideas ?</p>\n\n<pre><code>respond_to do |format|\n        format.html\n        format.pdf do\n          render pdf: \"file_name\", :template =&gt; 'officials/individual_receipt_export.html.erb', encoding: 'utf8',page_size: 'A4',:print_media_type =&gt; true\n        end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1484120617, "post_id": 41585012, "comment_id": 70374458, "body": "How specifically are you trying to store your hash in a CSV?"}, {"owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1484120680, "post_id": 41585012, "comment_id": 70374484, "body": "<code>result</code> has my hash. I then use  <code>CSV.open(csvfilename, &quot;w&quot;) {|csv| result.to_a.each {|elem| csv &lt;&lt; elem.to_s} }</code> to place the data in csv"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1484120996, "post_id": 41585012, "comment_id": 70374636, "body": "But that should work fine if you drop that strange <code>to_s</code> call on <code>elem</code>. I don&#39;t see where you&#39;re getting a TypeError from what you&#39;re doing anyway, a NoMethodError but not a TypeError."}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1484121052, "post_id": 41585012, "comment_id": 70374664, "body": "Works for me without <code>to_a</code> and <code>to_s</code> call, try this <code>CSV.open(fname, &#39;w&#39;) { |csv| hash.each { |each| csv &lt;&lt; each }}</code>"}, {"owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "edited": false, "score": 0, "creation_date": 1484121202, "post_id": 41585012, "comment_id": 70374722, "body": "I generate the result using <code>result = {} source1.each {|k, v| result[k] = source2[k] if source2[k] != v } </code> I am then trying to place this in a csv file"}, {"owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "edited": false, "score": 0, "creation_date": 1484121984, "post_id": 41585012, "comment_id": 70375114, "body": "Turned out one of my filename arguments was <code>nil</code>. This caused issues in data insertion into the csv. Thanks for all the help"}], "answers": [{"comments": [{"owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "edited": false, "score": 0, "creation_date": 1484120399, "post_id": 41585086, "comment_id": 70374346, "body": "This is working well... However, when I place the replaced hash into the csv I still get the error <code>no implicit conversion of nil into String (TypeError)</code>."}, {"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "reply_to_user": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "edited": false, "score": 0, "creation_date": 1484120953, "post_id": 41585086, "comment_id": 70374613, "body": "i&#39;ve checked with writing to  a csv file, and seemed ok. could you please check again?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1484121184, "post_id": 41585086, "comment_id": 70374717, "body": "<code>x.each { |k,v| x[k] = v || 0 }</code> instead of ternary?"}], "tags": [], "owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "is_accepted": false, "score": 2, "last_activity_date": 1484120875, "last_edit_date": 1484120875, "creation_date": 1484119915, "answer_id": 41585086, "question_id": 41585012, "link": "https://stackoverflow.com/questions/41585012/replacing-nil-in-hash-with-0-and-place-in-a-csv/41585086#41585086", "title": "Replacing nil in hash with 0 and place in a csv", "body": "<p>below code will take the hash (let's say x is your hash) and will look up if any of its values is nil, will set it to 0</p>\n\n<pre><code>2.3.1 :001 &gt; x = {:a =&gt; 5, :b =&gt; nil} \n2.3.1 :002 &gt; x.each {|k,v| x[k] = x[k].nil? ? 0 : x[k] }\n=&gt; {:a=&gt;5, :b=&gt;0} \n\n\n2.3.1 :009 &gt; require 'csv'\n =&gt; true \n2.3.1 :010 &gt; x\n =&gt; {:a=&gt;5, :b=&gt;0} \n2.3.1 :011 &gt; CSV.open('lorem.csv', 'wb') {|csv| x.to_a.each {|e| csv &lt;&lt; e}}\n =&gt; [[:a, 5], [:b, 0]] \n2.3.1 :012 &gt; exit\n$ cat lorem.csv \na,5\nb,0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "edited": false, "score": 0, "creation_date": 1484120490, "post_id": 41585229, "comment_id": 70374390, "body": "his is working well... However, when I place the replaced hash into the csv I still get the error <code>no implicit conversion of nil into String (TypeError)</code>"}, {"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "reply_to_user": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "edited": false, "score": 0, "creation_date": 1484120867, "post_id": 41585229, "comment_id": 70374576, "body": "How do you place the hash into the csv? How do you convert the hash into a string? Which information do you need to be in the csv."}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1484126880, "post_id": 41585229, "comment_id": 70377824, "body": "Maybe use <code>object.last.nil?</code> instead of <code>object.last == nil</code>."}, {"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "reply_to_user": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1484132188, "post_id": 41585229, "comment_id": 70381479, "body": "@LukasBaliak: Thx, that&#39;s better. At the moment I do a lot of php, so I   ignore unintendet the beauty of ruby."}], "tags": [], "owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "is_accepted": false, "score": 1, "last_activity_date": 1484131895, "last_edit_date": 1484131895, "creation_date": 1484120431, "answer_id": 41585229, "question_id": 41585012, "link": "https://stackoverflow.com/questions/41585012/replacing-nil-in-hash-with-0-and-place-in-a-csv/41585229#41585229", "title": "Replacing nil in hash with 0 and place in a csv", "body": "<pre><code>hash = {\"f8053d79-9ae8-4d78-888a-b866db12ce08\"=&gt;nil, \"d1063ee8-1e22-4e8c-b5f5-76a4f8d3cdbe\"=&gt;\"500\"}\n\nhash = hash.reduce({}) do |acc, object| \n    acc[object.first] = object.last.nil? ? '0' : object.last\n    acc\n  end\n# =&gt; {\"f8053d79-9ae8-4d78-888a-b866db12ce08\"=&gt;\"0\", \"d1063ee8-1e22-4e8c-b5f5-76a4f8d3cdbe\"=&gt;\"500\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 339, "user_id": 4948806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nikpC.jpg?s=128&g=1", "display_name": "kamal patwa", "link": "https://stackoverflow.com/users/4948806/kamal-patwa"}, "is_accepted": false, "score": 0, "last_activity_date": 1484132032, "creation_date": 1484132032, "answer_id": 41588934, "question_id": 41585012, "link": "https://stackoverflow.com/questions/41585012/replacing-nil-in-hash-with-0-and-place-in-a-csv/41588934#41588934", "title": "Replacing nil in hash with 0 and place in a csv", "body": "<p>Your code:</p>\n\n<pre><code>CSV.open(filename, \"w\") {|csv| result.to_a.each {|elem| csv &lt;&lt; elem.to_s} }\n\n# =&gt; undefined method `map' for \"[\\\"f8053d79-9ae8-4d78-888a-b866db12ce08\\\", nil]\":String\n</code></pre>\n\n<p>Change it to:</p>\n\n<pre><code>CSV.open(filename, \"w\") {|csv| result.to_a.each {|elem| csv &lt;&lt; elem} }\n\n# =&gt; [[\"f8053d79-9ae8-4d78-888a-b866db12ce08\", nil], [\"d1063ee8-1e22-4e8c-b5f5-76a4f8d3cdbe\", \"500\"]]\n</code></pre>\n\n<p>Hope that solved it.</p>\n"}, {"tags": [], "owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "is_accepted": false, "score": 0, "last_activity_date": 1484140946, "creation_date": 1484140946, "answer_id": 41592096, "question_id": 41585012, "link": "https://stackoverflow.com/questions/41585012/replacing-nil-in-hash-with-0-and-place-in-a-csv/41592096#41592096", "title": "Replacing nil in hash with 0 and place in a csv", "body": "<pre><code>data = {\n  \"f8053d79-9ae8-4d78-888a-b866db12ce08\" =&gt; nil, \n  \"d1063ee8-1e22-4e8c-b5f5-76a4f8d3cdbe\" =&gt; \"500\"\n}\n\ndata_without_nils = data.each_with_object({}){ |(k, v), h| h[k] = v || '0' }\n#=&gt; {\n#=&gt;   \"f8053d79-9ae8-4d78-888a-b866db12ce08\" =&gt; \"0\", \n#=&gt;   \"d1063ee8-1e22-4e8c-b5f5-76a4f8d3cdbe\"=&gt;\"500\"\n#=&gt; }\n</code></pre>\n"}], "owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1484140946, "creation_date": 1484119635, "last_edit_date": 1484121361, "question_id": 41585012, "link": "https://stackoverflow.com/questions/41585012/replacing-nil-in-hash-with-0-and-place-in-a-csv", "title": "Replacing nil in hash with 0 and place in a csv", "body": "<p>Hi I have a hash something like this:</p>\n\n<pre><code>{\"f8053d79-9ae8-4d78-888a-b866db12ce08\"=&gt;nil, \"d1063ee8-1e22-4e8c-b5f5-76a4f8d3cdbe\"=&gt;\"500\"}\n</code></pre>\n\n<p>which was created using the below code: </p>\n\n<pre><code>result = {}\nsource1.each {|k, v| result[k] = source2[k] if source2[k] != v }\n</code></pre>\n\n<p>When I try to store this hash in a csv, I get the following error:</p>\n\n<pre><code>no implicit conversion of nil into String (TypeError)\n</code></pre>\n\n<p>I'm hoping replacing nil with 0 should work. This is the current code I have:</p>\n\n<pre><code>def relacenill(h)\n  h.each_with_object({}) { |(k,v),g|\n    g[k] = (Hash === v) ?  relacenill(v) : v ? v : '0' }\nend\n</code></pre>\n\n<p>But this doesn't seem to be working. Can you please help?</p>\n"}, {"tags": ["ruby", "class", "oop", "uml"], "comments": [{"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 1, "creation_date": 1484121635, "post_id": 41584548, "comment_id": 70374943, "body": "See <a href=\"http://www.uml-diagrams.org/sequence-diagrams-reference.html\" rel=\"nofollow noreferrer\">uml-diagrams.org/sequence-diagrams-reference.html</a>"}, {"owner": {"reputation": 4944, "user_id": 6340948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ddf99c24b0bebc05681a2119286b120?s=128&d=identicon&r=PG&f=1", "display_name": "Ister", "link": "https://stackoverflow.com/users/6340948/ister"}, "edited": false, "score": 0, "creation_date": 1484125130, "post_id": 41584548, "comment_id": 70376713, "body": "Well, just as a side-note those diagrams are somewhat far from being fully UML compliant. In the lifeline the name and class should be separated with a colon, not a space (so e.g. <code>moe:Customer</code>). There should be a combined fragment to represent loop instead of putting a constraint. Arrow ends should either be a filled triangle or open arrowhead (co consist of only two lines). Those heads are neither filled triangles (then response would have incorrect head - it should be open) nor open head (then all messages are synchronous and can&#39;t have responses). It doesn&#39;t support understanding diagrams"}], "answers": [{"tags": [], "owner": {"reputation": 30989, "user_id": 3379653, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/f97JZ.png?s=128&g=1", "display_name": "qwerty_so", "link": "https://stackoverflow.com/users/3379653/qwerty-so"}, "is_accepted": true, "score": 2, "last_activity_date": 1484130658, "last_edit_date": 1484130658, "creation_date": 1484130347, "answer_id": 41588300, "question_id": 41584548, "link": "https://stackoverflow.com/questions/41584548/reading-uml-diagrams-poodr/41588300#41588300", "title": "Reading UML diagrams (POODR)", "body": "<p>I assume, this has been created with a painting tool, not an UML CASE tool. </p>\n\n<ol>\n<li>(up to 3.) This naming is wrong. The lifeline is either described with just the instance <code>name</code>, <code>:classifier</code> or as <code>name:classifier</code>. See p. 570 17.3.4.1 Lifeline in the spec:</li>\n</ol>\n\n<blockquote>\n  <p>A Lifeline is shown using a symbol that consists of a rectangle forming its \u201chead\u201d followed by a vertical line (which may be dashed) that represents the lifetime of the participant. Information identifying the lifeline is displayed inside the rectangle in the following format:</p>\n\n<pre><code>&lt;lifelineident&gt; ::= ([&lt;connectable-element-name&gt;[\u2018[\u2018 &lt;selector&gt; \u2018]\u2019]] [: &lt;connectable-element-type&gt;] [&lt;decomposition&gt;]) | \u2018self\u2019`\n&lt;selector&gt; ::= &lt;expression&gt;\n&lt;decomposition&gt; ::= \u2018ref\u2019 &lt;interactionident&gt; [\u2018strict\u2019]\n</code></pre>\n</blockquote>\n\n<ol start=\"4\">\n<li>correct</li>\n<li>The dashed return messages are optional. You can place them for clarity or to show special return values/conditions. Connector notations in UML are most confusing. In all (or most?) other diagrams a dashed line with open arrow means a dependency. See. p. 720 of the specs for correct dash/arrow use (the arrows in the example above are incorrect, since \"artistic\" with curves).</li>\n<li>Yes. See 1-3 and the top remark.</li>\n</ol>\n\n<p>Probably, I'd throw that book in the dump...</p>\n"}], "owner": {"reputation": 6391, "user_id": 2909897, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LMSiW.jpg?s=128&g=1", "display_name": "mbigras", "link": "https://stackoverflow.com/users/2909897/mbigras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 41588300, "answer_count": 1, "score": 2, "last_activity_date": 1484143220, "creation_date": 1484117760, "last_edit_date": 1484143220, "question_id": 41584548, "link": "https://stackoverflow.com/questions/41584548/reading-uml-diagrams-poodr", "title": "Reading UML diagrams (POODR)", "body": "<p>I'm reading <a href=\"http://www.poodr.com/\" rel=\"nofollow noreferrer\">POODR</a> and trying to wrap my head around Sandi's examples.</p>\n\n<p>I'm especially interested in trying to understand how her UML diagrams work.</p>\n\n<p>For example Figure 4.8 on page 75:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xMKVO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xMKVO.png\" alt=\"enter image description here\"></a>\nLooking at the image some questions come to mind:</p>\n\n<ol>\n<li><p>moe Customer - This represents an instance of the <code>Customer</code> class, perhaps with an attribute name equal to <code>moe</code>, or perhaps it's an instance stored in a variable named <code>moe</code>, either way the diagram makes it look like this box represents \"an object that is and instance of the Customer class\"?</p></li>\n<li><p>a TripFinder - This is a little confusing because it also seems like it represents \"an object that is an instance of the TripFinder class\"?</p></li>\n<li><p>class Trip and class Bicycle - Now we see the <code>class</code> keyword, so does is Sandi trying to say that those boxes represent \"a Trip Class object\" or \"a Bicycle Class object\"? Both of which are \"objects that are instances of the Class class\"?</p></li>\n<li><p>An arrow seems to go from the \"sender\" to the \"receiver\" of a \"message\". In code that translates to \"calling a method on the receiver object\"? The fact that the arrow is coming from moe means that somewhere inside the <code>Customer</code> class there is a method that calls the <code>TripFinder#suitable_trips</code> instance method. So the arrow going from the \"sender\" to the \"receiver\" tells us the receiver's method name (aka method signature?) but not the sender's method name right?</p></li>\n<li><p>What do the response arrows mean? Are they only return statements? What is the significance of a dotted vs. a solid line? I know in some diagrams they represent dependencies but now it seems like they are representing sending a message and getting a return statement. Is that the same thing as a dependency?</p></li>\n<li><p>Why is the last line a solid line? Is it just a typo?</p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "will-paginate"], "answers": [{"comments": [{"owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "edited": false, "score": 0, "creation_date": 1484119482, "post_id": 41584953, "comment_id": 70373890, "body": "also inspect element of view and check the path which is mentioned in html on pagination."}, {"owner": {"reputation": 21, "user_id": 4583287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72173a0d61351dce1fd51c8b9b89137?s=128&d=identicon&r=PG&f=1", "display_name": "sudmat", "link": "https://stackoverflow.com/users/4583287/sudmat"}, "edited": false, "score": 0, "creation_date": 1484122953, "post_id": 41584953, "comment_id": 70375615, "body": "` store_locator GET          /store_locator(.:format)                                   offers#store_locator` above is the output of rake routes."}, {"owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "reply_to_user": {"reputation": 21, "user_id": 4583287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72173a0d61351dce1fd51c8b9b89137?s=128&d=identicon&r=PG&f=1", "display_name": "sudmat", "link": "https://stackoverflow.com/users/4583287/sudmat"}, "edited": false, "score": 0, "creation_date": 1484131516, "post_id": 41584953, "comment_id": 70381056, "body": "Your error ie No route matches {:action=&gt;&quot;store_locator&quot;, :controller=&gt;&quot;spree/offers&quot;, :escape=&gt;nil, :page=&gt;2}** at  shows that request find your controller ie offers controler in spree folder.  Try to put your offers controller under spree ie  app -&gt; controllers -&gt; spree -&gt; offers controller"}, {"owner": {"reputation": 21, "user_id": 4583287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72173a0d61351dce1fd51c8b9b89137?s=128&d=identicon&r=PG&f=1", "display_name": "sudmat", "link": "https://stackoverflow.com/users/4583287/sudmat"}, "edited": false, "score": 0, "creation_date": 1484729506, "post_id": 41584953, "comment_id": 70624701, "body": "The offers_controller is under app-&gt;contollers-&gt;spree folder."}, {"owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "reply_to_user": {"reputation": 21, "user_id": 4583287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72173a0d61351dce1fd51c8b9b89137?s=128&d=identicon&r=PG&f=1", "display_name": "sudmat", "link": "https://stackoverflow.com/users/4583287/sudmat"}, "edited": false, "score": 0, "creation_date": 1484730103, "post_id": 41584953, "comment_id": 70625042, "body": "try to change post instead of get in routes.rb"}, {"owner": {"reputation": 21, "user_id": 4583287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72173a0d61351dce1fd51c8b9b89137?s=128&d=identicon&r=PG&f=1", "display_name": "sudmat", "link": "https://stackoverflow.com/users/4583287/sudmat"}, "edited": false, "score": 0, "creation_date": 1484733754, "post_id": 41584953, "comment_id": 70627586, "body": "I am able to hit the store_locator method in offers_controller.  <code>&lt;div class=&quot;col-md-12&quot; id=&quot;loadicon&quot;&gt;&lt;&#47;div&gt;  &lt;%if @flag%&gt;  &lt;%=will_paginate @storelist ,:params =&gt; { :escape =&gt; nil }, :class =&gt; &#39;store_paging&#39;%&gt;  &lt;%end%&gt;  &lt;div id=&quot;storediv&quot; style=&quot;background-color:#efefef;&quot;&gt;</code>  <code>&lt;%=will_paginate @storelist ,:params =&gt; { :escape =&gt; nil }, :class =&gt; &#39;store_paging&#39;%&gt;</code> throws the mentioned error"}], "tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": false, "score": 0, "last_activity_date": 1484119437, "creation_date": 1484119437, "answer_id": 41584953, "question_id": 41584014, "link": "https://stackoverflow.com/questions/41584014/ror-will-paginate-no-route-matches-error/41584953#41584953", "title": "RoR will_paginate No route matches error", "body": "<p>check routes using command:</p>\n\n<pre><code>rake routes\n</code></pre>\n\n<p>which list all routes and check /store_locator is call which controller and action.</p>\n"}], "owner": {"reputation": 21, "user_id": 4583287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72173a0d61351dce1fd51c8b9b89137?s=128&d=identicon&r=PG&f=1", "display_name": "sudmat", "link": "https://stackoverflow.com/users/4583287/sudmat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484119437, "creation_date": 1484115780, "last_edit_date": 1592644375, "question_id": 41584014, "link": "https://stackoverflow.com/questions/41584014/ror-will-paginate-no-route-matches-error", "title": "RoR will_paginate No route matches error", "body": "<p><strong>offers_controller.rb file</strong></p>\n<pre><code>def store_locator\n  city_name = params[:city]\n  @flag = true\n  per_page = 5\n  if !city_name.blank?\n    store = StoreCity.find_by_city(city_name.downcase)\n  end\n  if !store.nil?\n    @storelist= StoreAddress.where(:city_id=&gt;store.id)\n    @flag = false\n  else \n  @storelist= StoreAddress.order(:store_name).paginate(:page =&gt; params[:page], :per_page =&gt; per_page)\n  end\n  respond_to do |format|\n    format.html\n  end\nend\n</code></pre>\n<p>store_locator.html.erb pops up following error</p>\n<blockquote>\n<p>No route matches {:action=&gt;&quot;store_locator&quot;, :controller=&gt;&quot;spree/offers&quot;, :escape=&gt;nil, :page=&gt;2}** at</p>\n<pre><code>&lt;%=will_paginate @storelist ,:params =&gt; { :escape =&gt; nil }, :class =&gt; 'store_paging'%&gt;\n</code></pre>\n</blockquote>\n<p>code snippet:</p>\n<pre><code>&lt;div class=&quot;col-md-12&quot; id=&quot;loadicon&quot;&gt;&lt;/div&gt;\n  &lt;%if @flag%&gt;\n    &lt;%=will_paginate @storelist ,:params =&gt; { :escape =&gt; nil }, :class =&gt; 'store_paging'%&gt; \n  &lt;%end%&gt;\n&lt;div id=&quot;storediv&quot; style=&quot;background-color:#efefef;&quot;&gt;\n</code></pre>\n<p>routes.rb has proper namespacing</p>\n<pre><code>get '/store_locator' =&gt; 'offers#store_locator'\n</code></pre>\n<p>will_paginate version 3.1.5\nRoR version 4.2.3</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1484115724, "post_id": 41583591, "comment_id": 70372261, "body": "Although your typographic quotes look pretty, you have to use <code>&quot;...&quot;</code> and <code>&#39;...&#39;</code> instead of <code>\u201c...\u201d</code> and <code>\u2018...\u2019</code> in Ruby."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1484120006, "post_id": 41583591, "comment_id": 70374123, "body": "I edited the question to correct the errors identified by @Stefan. James, please alway run you code (in IRB, say) to make sure it is correct before posting."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4541806"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1485144750, "post_id": 41583591, "comment_id": 70786587, "body": "Will do @CarySwoveland - thanks"}], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 0, "last_activity_date": 1484114367, "creation_date": 1484114367, "answer_id": 41583708, "question_id": 41583591, "link": "https://stackoverflow.com/questions/41583591/ruby-array-of-hashes-for-each-financial-year/41583708#41583708", "title": "Ruby Array of Hashes - For each financial year", "body": "<p>You can group the values by year and then sum the principle and interest amount</p>\n\n<pre><code>@interest_totals =  @transactions.group_by{|a| a[\"financial_year\"]}.map{|k, v| {\"financial_year\" =&gt; k, \"total\" =&gt; v.map{|e|e[\"interest\"].to_i}.sum}}\n\n#=&gt; [{ \"financial_year\" =&gt; \"2017\", \"total\" =&gt; 360 },\n#=&gt;  { \"financial_year\" =&gt; \"2018\", \"total\" =&gt; 240 },\n#=&gt;  { \"financial_year\" =&gt; \"2019\", \"total\" =&gt; 240 }]\n\n@principal_totals = @transactions.group_by{|a| a[\"financial_year\"]}.map{|k, v| {\"financial_year\" =&gt; k, \"total\" =&gt; v.map{|e|e[\"principal\"].to_i}.sum}}\n\n#=&gt; [{ \"financial_year\" =&gt; \"2017\", \"total\" =&gt; 750 },\n#=&gt;  { \"financial_year\" =&gt; \"2018\", \"total\" =&gt; 500 },\n#=&gt;  { \"financial_year\" =&gt; \"2019\", \"total\" =&gt; 500 }]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "is_accepted": true, "score": 2, "last_activity_date": 1484115683, "creation_date": 1484115683, "answer_id": 41583986, "question_id": 41583591, "link": "https://stackoverflow.com/questions/41583591/ruby-array-of-hashes-for-each-financial-year/41583986#41583986", "title": "Ruby Array of Hashes - For each financial year", "body": "<p>Use <code>inject</code> or <code>reduce</code> or <code>each_with_object</code>.  I used <code>each_with_object</code> below so that I can calculate the sum for both in one iteration</p>\n\n<pre><code>interests, principals = @transactions.each_with_object([Hash.new(0), Hash.new(0)]) do |transaction, (interests, principals)|\n  interests[transaction['financial_year']] += transaction['interest'].to_d\n  principals[transaction['financial_year']] += transaction['principal'].to_d\nend\n\np interests\n# {\"2017\"=&gt;#&lt;BigDecimal:7fd1c6cc20f0,'0.36E3',9(18)&gt;, \"2018\"=&gt;#&lt;BigDecimal:7fd1c6cc1d30,'0.24E3',9(18)&gt;, \"2019\"=&gt;#&lt;BigDecimal:7fd1c6cc1970,'0.24E3',9(18)&gt;}\n\np principals\n# {\"2017\"=&gt;#&lt;BigDecimal:7fd1c6cc2050,'0.75E3',9(18)&gt;, \"2018\"=&gt;#&lt;BigDecimal:7fd1c6cc1c90,'0.5E3',9(18)&gt;, \"2019\"=&gt;#&lt;BigDecimal:7fd1c6cc18d0,'0.5E3',9(18)&gt;}\n</code></pre>\n\n<p>This will give you a hash where the year is the key and the value is the total.  If you really need an array of hashes, use <code>zip</code></p>\n\n<pre><code>@interest_sum = interests.map do |interest|\n  Hash[['financial_year', 'total'].zip(interest)]\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1484123548, "last_edit_date": 1484123548, "creation_date": 1484121418, "answer_id": 41585477, "question_id": 41583591, "link": "https://stackoverflow.com/questions/41583591/ruby-array-of-hashes-for-each-financial-year/41585477#41585477", "title": "Ruby Array of Hashes - For each financial year", "body": "<p>I suggest you first compute the following hash.</p>\n\n<pre><code>h = @transactions.each_with_object({}) do |g,h|\n  h.update(g[\"financial_year\"]=&gt;g.reject { |k,_| k==\"financial_year\" }) do |_,o,n|\n    o.merge(n) { |_,oo,nn| (oo.to_i + nn.to_i).to_s }\n  end\nend\n  #=&gt; {\"2017\"=&gt;{\"interest\"=&gt;\"360\", \"principal\"=&gt;\"750\"},\n  #    \"2018\"=&gt;{\"interest\"=&gt;\"240\", \"principal\"=&gt;\"500\"},\n  #    \"2019\"=&gt;{\"interest\"=&gt;\"240\", \"principal\"=&gt;\"500\"}}\n</code></pre>\n\n<p>This uses the form of <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> (aka <code>merge!</code>) and <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-i-merge\" rel=\"nofollow noreferrer\">Hash#merge</a> that employ a block to determine the values of keys that are present in both hashes being merged. See the docs for details, especially the values of the block variables, <code>_</code>, <code>o</code>, <code>n</code>, <code>k</code>, <code>oo</code> and <code>nn</code>. (In the first block I've used an underscore for the common key to signify that it is not used in the block calculation.)</p>\n\n<p>One advantage of this intermediate solution is that it needn't be changed if keys (other than \"financial_year\") are added (\"balance\", say), deleted or renamed.</p>\n\n<p>You can now easily construct other objects. For example,</p>\n\n<pre><code>@interest_totals = h.map { |year,v| {\"financial_year\"=&gt;year, \"total\"=&gt; v[\"interest\"] } }\n  #=&gt; [{\"financial_year\"=&gt;\"2017\", \"total\"=&gt;\"360\"},\n  #    {\"financial_year\"=&gt;\"2018\", \"total\"=&gt;\"240\"},\n  #    {\"financial_year\"=&gt;\"2019\", \"total\"=&gt;\"240\"}]   \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4541806"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 41583986, "answer_count": 3, "score": 1, "last_activity_date": 1484123548, "creation_date": 1484113829, "last_edit_date": 1484119920, "question_id": 41583591, "link": "https://stackoverflow.com/questions/41583591/ruby-array-of-hashes-for-each-financial-year", "title": "Ruby Array of Hashes - For each financial year", "body": "<p>I have a transactions array, which contains transaction hashes. I\u2019m wanting to loop through the array of transaction hashes, and for each financial year, sum the interest, and principal values. These then need to be added to the respective arrays, grouped by financial year, as shown below.</p>\n\n<p>In short:</p>\n\n<p>For each financial year:</p>\n\n<p>1.Sum the values of the interest keys</p>\n\n<p>2.Create a hash</p>\n\n<p>3.Add the hash to the respective array</p>\n\n<p>4.Repeat for the principal values</p>\n\n<p>I'm a little stuck on the very first step: For each financial year, do x - Any help would be appreciated.</p>\n\n<p>Ruby 2.3.1</p>\n\n<p>Given</p>\n\n<pre><code> @transactions = [\n  {\"interest\" =&gt; \"120.00\", \"principal\" =&gt; \"250\", \"financial_year\" =&gt; \"2017\"},\n  {\"interest\" =&gt; \"120.00\", \"principal\" =&gt; \"250\", \"financial_year\" =&gt; \"2017\"},\n  {\"interest\" =&gt; \"120.00\", \"principal\" =&gt; \"250\", \"financial_year\" =&gt; \"2017\"},\n  {\"interest\" =&gt; \"120.00\", \"principal\" =&gt; \"250\", \"financial_year\" =&gt; \"2018\"},\n  {\"interest\" =&gt; \"120.00\", \"principal\" =&gt; \"250\", \"financial_year\" =&gt; \"2018\"},\n  {\"interest\" =&gt; \"120.00\", \"principal\" =&gt; \"250\", \"financial_year\" =&gt; \"2019\"},\n  {\"interest\" =&gt; \"120.00\", \"principal\" =&gt; \"250\", \"financial_year\" =&gt; \"2019\"}\n ]\n</code></pre>\n\n<p>I wish to compute</p>\n\n<pre><code> @interest_totals = [\n    {\"financial_year\" =&gt; \"2017\", \"total\" =&gt; \"360\"}\n    {\"financial_year\" =&gt; \"2018\", \"total\" =&gt; \"240\"}\n    {\"financial_year\" =&gt; \"2019\", \"total\" =&gt; \"240\"}\n ]\n</code></pre>\n\n<p>and</p>\n\n<pre><code> @principal_totals = [\n    {\"financial_year\" =&gt; \"2017\", \"total\" =&gt; \"750\"}\n    {\"financial_year\" =&gt; \"2018\", \"total\" =&gt; \"500\"}\n    {\"financial_year\" =&gt; \"2019\", \"total\" =&gt; \"500\"}\n ]\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax"], "answers": [{"tags": [], "owner": {"reputation": 1624, "user_id": 2912211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059632598/picture?type=large", "display_name": "Zzz", "link": "https://stackoverflow.com/users/2912211/zzz"}, "is_accepted": true, "score": 0, "last_activity_date": 1484112075, "creation_date": 1484112075, "answer_id": 41583236, "question_id": 41583136, "link": "https://stackoverflow.com/questions/41583136/rendering-error-for-ajax-upvoting-system/41583236#41583236", "title": "Rendering Error for Ajax Upvoting System", "body": "<p>You are passing entire collection to partial</p>\n\n<pre><code>  &lt;% if @posts.each do |p| %&gt;\n  &lt;div class=\"panel-body\"&gt;\n    &lt;p class=\"post-content\"&gt;&lt;%= auto_link(p.content, :html =&gt; { :target =&gt;     '_blank' }) %&gt;&lt;/p&gt;\n\n    &lt;%= render :partial =&gt; 'vote', :class =&gt; \"vote\", :locals =&gt; { p: @posts } %&gt;\n\n  &lt;/div&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>In line <code>&lt;%= render :partial =&gt; 'vote', :class =&gt; \"vote\", :locals =&gt; { p: @posts } %&gt;</code> replace <code>@posts</code> with <code>p</code></p>\n"}], "owner": {"reputation": 67, "user_id": 7311390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a051b6cbc96fee8e339e642f2d1c6d2?s=128&d=identicon&r=PG&f=1", "display_name": "naridi", "link": "https://stackoverflow.com/users/7311390/naridi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15, "favorite_count": 0, "accepted_answer_id": 41583236, "answer_count": 1, "score": 0, "last_activity_date": 1484112075, "creation_date": 1484111479, "question_id": 41583136, "link": "https://stackoverflow.com/questions/41583136/rendering-error-for-ajax-upvoting-system", "title": "Rendering Error for Ajax Upvoting System", "body": "<p>I am using the gem \"acts_as_votable\" in my Rails application so that Users can vote on Posts.</p>\n\n<p>I'm adding Ajax functionality so that the entire page doesn't have to refresh when a user upvotes a post. This is what I have:</p>\n\n<p>routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  devise_for :users, controllers: {registrations: 'registrations'} \n\n  resources :posts do \n    member do\n      put \"like\", to: \"posts#upvote\"\n      put \"dislike\", to: \"posts#downvote\"\n    end\n  end\n\n  # Define Root URL\n  root 'pages#index'\n\n  # Define Routes for Pages\n  get '/home' =&gt; 'pages#home'\n  get '/explore' =&gt; 'pages#explore'\n  get '/privacy' =&gt; 'pages#privacy'\n  get '/:id' =&gt; 'pages#profile'\n\nend\n</code></pre>\n\n<p>pages_controller.rb</p>\n\n<pre><code>  def explore\n    @posts = Post.where('created_at &gt;= :one_days_ago', one_days_ago: Time.now - 16.hours)\n  end\n</code></pre>\n\n<p>posts_controller.rb</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n\n    def index\n    @posts = Post.allow\n    end\n\n    def new \n        @post = Post.new\n    end\n\n    def create\n        @post = Post.new(post_params)\n        @post.user_id = current_user.id\n        respond_to do |f|\n            if (@post.save) \n                f.html { redirect_to :back, :flash =&gt; { :notice =&gt; \"Posted\" } }\n            else\n                f.html { redirect_to :back, :flash =&gt; { :alert =&gt; \"Error\" } }\n            end\n        end\n    end\n\n    def destroy\n        @post = Post.find(params[:id])\n        if current_user == @post.user\n            @post.destroy\n        end\n            redirect_to :back, alert: 'Deleted.'\n    end\n\n\n\n    def upvote\n        @posts = Post.find(params[:id])\n      @posts.upvote_by current_user\n        respond_to do |format|\n            format.html { redirect_to :back }\n            format.js \n        end\n    end\n\n    def downvote\n        @posts = Post.find(params[:id])\n      @posts.downvote_by current_user\n        respond_to do |format|\n            format.html { redirect_to :back }\n            format.js \n        end\n    end\n\n\n\n    private\n    def post_params # allows certain data to be passed via form.\n        params.require(:post).permit(:user_id, :content)\n    end\n\nend\n</code></pre>\n\n<p>explore.html.erb</p>\n\n<pre><code>&lt;% if @posts.each do |p| %&gt;\n&lt;div class=\"panel-body\"&gt;\n  &lt;p class=\"post-content\"&gt;&lt;%= auto_link(p.content, :html =&gt; { :target =&gt; '_blank' }) %&gt;&lt;/p&gt;\n\n  &lt;%= render :partial =&gt; 'vote', :class =&gt; \"vote\", :locals =&gt; { p: @posts } %&gt;\n\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>_vote.html.erb</p>\n\n<pre><code>&lt;div id=\"vote_&lt;%= p.id %&gt;\" class=\"vote\"&gt;\n  &lt;%= link_to 'Vote Up', like_post_path(p), :class =&gt; \"upvote\", :method =&gt; :put, :remote =&gt; true %&gt;\n  &lt;span&gt;&lt;%= p.score %&gt;&lt;/span&gt;  &lt;!--show the current vote--&gt;\n  &lt;%= link_to 'Vote Down', dislike_post_path(p), :class =&gt; \"downvote\", :method =&gt; :put, :remote =&gt; true %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>upvote.js.erb</p>\n\n<pre><code>$(document).ready(function(){\n    $('#vote_&lt;%= p.id %&gt;').html(\"&lt;%= escape_javascript render :partial =&gt; '/pages/vote' %&gt;\");\n});\n</code></pre>\n\n<p>When I go to run the project I get this error:</p>\n\n<pre><code>NoMethodError in Pages#explore\n\nShowing /home/ubuntu/workspace/app/views/pages/_vote.html.erb where line #1 raised:\n\nundefined method `id' for #&lt;Post::ActiveRecord_Relation:0x007f6715d018e8&gt;\n\nDid you mean?  ids\n\n&lt;div id=\"vote_&lt;%= p.id %&gt;\" class=\"vote\"&gt;\n</code></pre>\n\n<p>The issue arises from trying to render _votes.html.erb.</p>\n\n<p>Where am I going wrong here? I've been stuck on this for a while and would appreciate any help. Thanks!</p>\n"}, {"tags": ["ruby", "product", "bigcartel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7402299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53ed7db125393fdd41c0c3abc9457206?s=128&d=identicon&r=PG&f=1", "display_name": "PinMail Gear", "link": "https://stackoverflow.com/users/7402299/pinmail-gear"}, "edited": false, "score": 0, "creation_date": 1485263278, "post_id": 41818195, "comment_id": 70844789, "body": "I never thought of doing a variable assignment like that. Thank you. This works perfectly."}], "tags": [], "owner": {"reputation": 38, "user_id": 5480738, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100467352469926/picture?type=large", "display_name": "Connor Burns Munro", "link": "https://stackoverflow.com/users/5480738/connor-burns-munro"}, "is_accepted": true, "score": 2, "last_activity_date": 1485218596, "creation_date": 1485218596, "answer_id": 41818195, "question_id": 41582241, "link": "https://stackoverflow.com/questions/41582241/big-cartel-hide-all-options-if-one-option-is-out-of-stock/41818195#41818195", "title": "Big Cartel - hide all options if one option is out of stock", "body": "<p>I'd try something like the following. I haven't tested to ensure the <code>has_default_option</code> conditional is setup properly, but this is just to illustrate the idea of using a variable assignment (<code>inStock</code>) to track the stock.</p>\n\n<pre><code>{% assign inStock = true %}\n{% for option in product.options %}\n    {% if option.sold_out %}\n        {% assign inStock = false %}\n    {% endif %}\n{% endfor %}\n\n{% if inStock %}\n    &lt;form id=\"product-form\" method=\"post\" action=\"/cart\"&gt;\n        {% if product.has_default_option %}\n            {{ product.option | hidden_option_input }}\n        {% else %}\n            &lt;div id=\"product-options\" class=\"options\"&gt;\n                {{ product.options | options_select }}\n            &lt;/div&gt;\n        {% endif %}\n        &lt;button class=\"button\" id=\"product-addtocart\" name=\"submit\" type=\"submit\"&gt;Add to cart&lt;/button&gt;\n        {% if product.on_sale %}&lt;div&gt;On Sale&lt;/div&gt;{% endif %}\n    &lt;/form&gt;\n{% else %}\n    &lt;div class=\"sold\"&gt;\n        &lt;h4&gt;&lt;span&gt;Sold&lt;/span&gt;&lt;/h4&gt;\n    &lt;/div&gt;\n{% endif %}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7402299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53ed7db125393fdd41c0c3abc9457206?s=128&d=identicon&r=PG&f=1", "display_name": "PinMail Gear", "link": "https://stackoverflow.com/users/7402299/pinmail-gear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 41818195, "answer_count": 1, "score": 0, "last_activity_date": 1485218596, "creation_date": 1484105535, "last_edit_date": 1484873166, "question_id": 41582241, "link": "https://stackoverflow.com/questions/41582241/big-cartel-hide-all-options-if-one-option-is-out-of-stock", "title": "Big Cartel - hide all options if one option is out of stock", "body": "<p>I'm trying to make an argument where if any product option on a product page is sold out then the add to cart button and the options dropdown isn't shown and the sold out div is shown instead. If there are no options then it will show the add to cart button, if the product is in stock, but I can't quite get it to work. </p>\n\n<p>I feel like I'm really close. I've been able to make it work if the product has no options then it shows the add to card button, if the product is sold out of any options it shows 'Sold', but if all options are in stock it will show the options selector and add to cart button as many times as there are options\n(Ex: if product has 2 options page will show:  </p>\n\n<p>Option selector<br>\nAdd to Cart Button<br>\nOption Selector<br>\nAdd to Cart Button)</p>\n\n<pre><code>{% when 'active' %}\n&lt;form id=\"product-form\" method=\"post\" action=\"/cart\"&gt;\n{% for option in product.options %}\n\n{% if product.has_default_option %}\n\n{{ product.option | hidden_option_input }}\n\n&lt;button class=\"button\" id=\"product-addtocart\" name=\"submit\"    \ntype=\"submit\"&gt;Add to cart&lt;/button&gt;\n\n{% endif %}\n\n{% if option.sold_out %}\n\n{{ product.option | hidden_option_input }}\n    &lt;div class=\"sold\"&gt;\n      &lt;h4&gt;&lt;span&gt;Sold&lt;/span&gt;&lt;/h4&gt;\n    &lt;/div&gt;\n{% endif %}\n{% if option.sold_out == false %}\n\n&lt;div id=\"product-options\" class=\"options\"&gt;\n{{ product.options | options_select }}\n&lt;/div&gt;&lt;br&gt;\n&lt;button class=\"button\" id=\"product-addtocart\" name=\"submit\"    \ntype=\"submit\"&gt;Add to cart&lt;/button&gt;\n\n{% endif %}\n\n{% endfor %}\n{% if product.on_sale %}&lt;div&gt;On Sale&lt;/div&gt;{% endif %}   \n&lt;/form&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "watir", "watir-webdriver", "rubymine"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 1, "creation_date": 1484142550, "post_id": 41582119, "comment_id": 70388348, "body": "Are you saying you don&#39;t see &quot;watir-webdriver&quot; installed? The message suggests it did install &quot;watir-webdriver&quot; correctly. The message is just suggesting that you switch to &quot;watir&quot; instead since that is the newer version - ie do a <code>sudo gem install watir</code>"}, {"owner": {"reputation": 1, "user_id": 6832245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2b72944351a69648399e7fd2853727?s=128&d=identicon&r=PG&f=1", "display_name": "Babba Booey", "link": "https://stackoverflow.com/users/6832245/babba-booey"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1484158184, "post_id": 41582119, "comment_id": 70398397, "body": "the message in terminal says it it did install watir-webdriver. I went ahead and  installed water as per your code and it says it successfully installed. But I do not see it in the folder ~/Libray/Ruby/Gems/2.0.0/          Cucumber and some other gems are in there but not watir"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1484159661, "post_id": 41582119, "comment_id": 70399181, "body": "Sorry, I&#39;m not a Mac user. In <a href=\"http://stackoverflow.com/a/1794502/1200545\">another answer</a>, they suggest that <code>sudo gem install</code> might install to <code>&#47;System&#47;Library&#47;Frameworks&#47;Ruby.framework</code> instead?"}], "answers": [{"tags": [], "owner": {"reputation": 286, "user_id": 6349403, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce09db1dc600f8c20326e791aa8e0e6c?s=128&d=identicon&r=PG&f=1", "display_name": "Gopal", "link": "https://stackoverflow.com/users/6349403/gopal"}, "is_accepted": false, "score": 0, "last_activity_date": 1484109404, "creation_date": 1484109404, "answer_id": 41582786, "question_id": 41582119, "link": "https://stackoverflow.com/questions/41582119/watir-webdriver-dependency-in-mac/41582786#41582786", "title": "watir-webdriver dependency in mac?", "body": "<p>You don't have to install watir-webdriver now, Simply install watir which includes watir-webdriver. Currently they have included waiting arragement for each element which is available to you If you install watir, this will not be available to you If you install watir-webdriver separately. </p>\n\n<p>If you write </p>\n\n<pre><code>b.text_field.set 'Hi'\n</code></pre>\n\n<p>With the installation watir, the above statement will automatically converted to </p>\n\n<pre><code>b.text_field.when_present.set 'Hi'\n</code></pre>\n\n<p>With the installation of Watir-webdriver, the above statement remains the same. </p>\n\n<p>Note: This recent watir is not a meta gem which chooses between watir-webdriver and watir-classic, this completely lies on watir-webdriver. </p>\n"}], "owner": {"reputation": 1, "user_id": 6832245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2b72944351a69648399e7fd2853727?s=128&d=identicon&r=PG&f=1", "display_name": "Babba Booey", "link": "https://stackoverflow.com/users/6832245/babba-booey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536943381, "creation_date": 1484104610, "question_id": 41582119, "link": "https://stackoverflow.com/questions/41582119/watir-webdriver-dependency-in-mac", "title": "watir-webdriver dependency in mac?", "body": "<p>I have a mac and am using the IDE Ruby Mine. I've tried to install watir-webdriver via the terminal with the code <code>sudo gem install watir-webdriver</code></p>\n\n<p>Terminal returns: \nWith the release of Watir 6.0, the watir-webdriver gem has changed its name\nto watir. Update your dependencies to use \"watir\", \"~> 6.0\"</p>\n\n<p>Successfully installed watir-webdriver-0.9.9\nParsing documentation for watir-webdriver-0.9.9\nDone installing documentation for watir-webdriver after 1 seconds\n1 gem installed</p>\n\n<p>If it's an issue with updating my dependencies how do I do that, I cannot find any information online. </p>\n\n<p>In my gems folder I don't see watir installed. I installed cucumber successfully, i see that folder in there but not watir. </p>\n\n<p>My version of ruby is ruby 2.4.0p0</p>\n\n<p>Any help would be much appreciated, thanks!</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484107474, "post_id": 41581912, "comment_id": 70369521, "body": "Ruby conventions strongly encourage people to use method names like <code>get_signature_key</code>, all lower-case with an underscore for separators where required. Capitals have significant meaning in Ruby and are reserved for <code>ClassName</code>, <code>ModuleName</code> and <code>CONSTANT_NAME</code> type situations."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 0, "last_activity_date": 1484107419, "creation_date": 1484107419, "answer_id": 41582493, "question_id": 41581912, "link": "https://stackoverflow.com/questions/41581912/get-signature-key-for-aws-s3-ruby/41582493#41582493", "title": "Get signature key for aws s3 (ruby)", "body": "<p>Values from <a href=\"https://ruby-doc.org/stdlib-2.4.0/libdoc/openssl/rdoc/OpenSSL/HMAC.html\" rel=\"nofollow noreferrer\"><code>digest</code></a> are documented as being binary in nature. If you want them human-readable then you must use <code>hexdigest</code> or convert them yourself.</p>\n"}], "owner": {"reputation": 766, "user_id": 4916450, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a524baf1067d39296deed2e11a7a23fe?s=128&d=identicon&r=PG&f=1", "display_name": "Afas", "link": "https://stackoverflow.com/users/4916450/afas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 41582493, "answer_count": 1, "score": 0, "last_activity_date": 1484107419, "creation_date": 1484102983, "question_id": 41581912, "link": "https://stackoverflow.com/questions/41581912/get-signature-key-for-aws-s3-ruby", "title": "Get signature key for aws s3 (ruby)", "body": "<p>I'm trying to run a script to get the hexadecimal representation of the aws signing key. But instead, I'm getting this on the terminal:</p>\n\n<pre><code>???&gt;?^?c???w?,????-??e??$C\n</code></pre>\n\n<p>What's wrong with my code?</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire 'openssl'\ndef getSignatureKey key, dateStamp, regionName, serviceName\n    kDate = OpenSSL::HMAC.digest('sha256', \"AWS4\" + key, dateStamp)\n    kRegion = OpenSSL::HMAC.digest('sha256', kDate, regionName)\n    kService = OpenSSL::HMAC.digest('sha256', kRegion, serviceName)\n    kSigning = OpenSSL::HMAC.digest('sha256', kService, \"aws4_request\")\n\n    kSigning\nend\n\nputs getSignatureKey('wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY','20170110', 'us-west-1', 's3')\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9, "user_id": 4811998, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9idtTeRX5zk/AAAAAAAAAAI/AAAAAAAAATs/Dy8yD_LOdFs/photo.jpg?sz=128", "display_name": "matheushf", "link": "https://stackoverflow.com/users/4811998/matheushf"}, "edited": false, "score": 0, "creation_date": 1484110773, "post_id": 41581798, "comment_id": 70370471, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18264446/rails-4-grouping-controllers-in-a-folder\">Rails 4: Grouping Controllers in a folder</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4811998, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9idtTeRX5zk/AAAAAAAAAAI/AAAAAAAAATs/Dy8yD_LOdFs/photo.jpg?sz=128", "display_name": "matheushf", "link": "https://stackoverflow.com/users/4811998/matheushf"}, "edited": false, "score": 0, "creation_date": 1484102790, "post_id": 41581828, "comment_id": 70368417, "body": "Still not working, ActionController::RoutingError (uninitialized constant Api::ReportController):"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 1, "last_activity_date": 1484103586, "last_edit_date": 1484103586, "creation_date": 1484102222, "answer_id": 41581828, "question_id": 41581798, "link": "https://stackoverflow.com/questions/41581798/rails-controllers-in-subfolder-actioncontrollerroutingerror-uninitialized-con/41581828#41581828", "title": "Rails Controllers in subfolder ActionController::RoutingError (uninitialized constant", "body": "<pre><code>module Api\n  module Report # &lt;============== missing module\n    class ReportController &lt; ApplicationController\n      def index\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Also</p>\n\n<pre><code>module Api\n  class Report::InfectedController &lt; Report::ReportController\n    def infected\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": false, "score": 0, "last_activity_date": 1484115666, "creation_date": 1484115666, "answer_id": 41583981, "question_id": 41581798, "link": "https://stackoverflow.com/questions/41581798/rails-controllers-in-subfolder-actioncontrollerroutingerror-uninitialized-con/41583981#41583981", "title": "Rails Controllers in subfolder ActionController::RoutingError (uninitialized constant", "body": "<p>Try below code</p>\n\n<pre><code># report_controller.rb\nmodule Api\n  class Report::ReportController &lt; ApplicationController\n    def index\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4811998, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9idtTeRX5zk/AAAAAAAAAAI/AAAAAAAAATs/Dy8yD_LOdFs/photo.jpg?sz=128", "display_name": "matheushf", "link": "https://stackoverflow.com/users/4811998/matheushf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1484115666, "creation_date": 1484102055, "last_edit_date": 1484102443, "question_id": 41581798, "link": "https://stackoverflow.com/questions/41581798/rails-controllers-in-subfolder-actioncontrollerroutingerror-uninitialized-con", "title": "Rails Controllers in subfolder ActionController::RoutingError (uninitialized constant", "body": "<p>I've seen related questions here in StackOverflow, but I still can't make it work.</p>\n\n<p>I'm making an API with subfolders inside controllers, but I keep getting this error: </p>\n\n<pre><code>LoadError (Unable to autoload constant Api::Report::ReportController, expected ... \n/controllers/api/report/report_controller.rb to define it):\n</code></pre>\n\n<p>Or this one:</p>\n\n<pre><code>ActionController::RoutingError (uninitialized constant Api::Report::ReportController):\n</code></pre>\n\n<p>This is my folder structure:</p>\n\n<pre><code>-&gt;controllers\n    -&gt;api\n       -&gt;report\n         infected_controller.rb\n         report_controller.rb\n\n\n# inflected_controller.rb\nmodule Api\n  class Report::InfectedController &lt; ReportController\n    def infected\n    end\n  end\nend\n\n# report_controller.rb\nmodule Api\n  class ReportController &lt; ApplicationController\n    def index\n    end\n  end\nend\n</code></pre>\n\n<p>And my routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  apipie\n  namespace :api do\n    scope module: 'report' do\n      get 'infected' =&gt; 'infected#infected'\n      resources :report\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "algorithm", "memory-leaks", "garbage-collection"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484125863, "post_id": 41581729, "comment_id": 70377114, "body": "Do you have any input example?"}, {"owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1484130416, "post_id": 41581729, "comment_id": 70380321, "body": "Checkout this gem:   <a href=\"https://github.com/schneems/derailed_benchmarks\" rel=\"nofollow noreferrer\">github.com/schneems/derailed_benchmarks</a>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1484134296, "post_id": 41581729, "comment_id": 70382967, "body": "What is the point of doubly negating? <code>-(-arr.length&#47;2)</code>"}, {"owner": {"reputation": 146, "user_id": 2865269, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e5c1c1fe05baa3fb44a7fee5b78be019?s=128&d=identicon&r=PG&f=1", "display_name": "Binyuan Sun", "link": "https://stackoverflow.com/users/2865269/binyuan-sun"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484166394, "post_id": 41581729, "comment_id": 70402915, "body": "@EricDuminil It feeds an array <code>[[obj1], [obj2], [obj3]]</code> where the objects are custom objects"}, {"owner": {"reputation": 146, "user_id": 2865269, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e5c1c1fe05baa3fb44a7fee5b78be019?s=128&d=identicon&r=PG&f=1", "display_name": "Binyuan Sun", "link": "https://stackoverflow.com/users/2865269/binyuan-sun"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1484166536, "post_id": 41581729, "comment_id": 70402988, "body": "@sawa It&#39;s just a lazy way to take the ceil without the function."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1484190489, "post_id": 41581729, "comment_id": 70411268, "body": "I see. It looks like a clever way."}, {"owner": {"reputation": 1279, "user_id": 603950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f00398411f0ff3cbe58d89e308dbec71?s=128&d=identicon&r=PG", "display_name": "joshuacronemeyer", "link": "https://stackoverflow.com/users/603950/joshuacronemeyer"}, "edited": false, "score": 0, "creation_date": 1484265880, "post_id": 41581729, "comment_id": 70451691, "body": "I don&#39;t see the definition of func in the code you supplied, so there might be something important missing from this description. Also useful to mention what version of Ruby/Rails you&#39;re using."}], "answers": [{"comments": [{"owner": {"reputation": 146, "user_id": 2865269, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e5c1c1fe05baa3fb44a7fee5b78be019?s=128&d=identicon&r=PG&f=1", "display_name": "Binyuan Sun", "link": "https://stackoverflow.com/users/2865269/binyuan-sun"}, "edited": false, "score": 0, "creation_date": 1484459105, "post_id": 41625566, "comment_id": 70515064, "body": "Oh that was a bummer. I think you&#39;re right. I have to call the <code>GC.start</code> over and over as the algorithm allocates way too much memory for the GC to free it in one shot."}], "tags": [], "owner": {"reputation": 1279, "user_id": 603950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f00398411f0ff3cbe58d89e308dbec71?s=128&d=identicon&r=PG", "display_name": "joshuacronemeyer", "link": "https://stackoverflow.com/users/603950/joshuacronemeyer"}, "is_accepted": false, "score": 0, "last_activity_date": 1484267645, "creation_date": 1484267645, "answer_id": 41625566, "question_id": 41581729, "link": "https://stackoverflow.com/questions/41581729/memory-leak-after-algorithm-in-rails/41625566#41625566", "title": "Memory leak after algorithm in Rails?", "body": "<p>Ruby garbage collection doesn't immediately reduce the amount of memory your ruby program has allocated. Memory allocation is expensive so even if the objects you create are immediately collected by GC the memory is slowly released back to the OS. If you think this function has a memory leak you should try running it in a non-rails process where you have more control over object lifecycles. You can use <a href=\"https://ruby-doc.org/core-2.1.1/GC.html#method-c-stat\" rel=\"nofollow noreferrer\">GC.stat</a> to get information about the number of live and free objects before and after you run the GC. It's also worth reading up on how ruby GC works I like <a href=\"https://www.sitepoint.com/ruby-uses-memory/\" rel=\"nofollow noreferrer\">this article</a>.</p>\n"}], "owner": {"reputation": 146, "user_id": 2865269, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e5c1c1fe05baa3fb44a7fee5b78be019?s=128&d=identicon&r=PG&f=1", "display_name": "Binyuan Sun", "link": "https://stackoverflow.com/users/2865269/binyuan-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1484267645, "creation_date": 1484101438, "last_edit_date": 1484134375, "question_id": 41581729, "link": "https://stackoverflow.com/questions/41581729/memory-leak-after-algorithm-in-rails", "title": "Memory leak after algorithm in Rails?", "body": "<p>I wrote an algorithm inspired by the merge part of the merge sort.</p>\n\n<pre><code>  def self.merge(arr)\n    if arr.length == 1\n      return arr\n    end\n    groups = []\n    (0...-(-arr.length/2)).each do |i|\n      groups &lt;&lt; []\n      if !arr[2*i+1].nil?\n        arr[2*i].each do |cal1|\n          arr[2*i+1].each do |cal2|\n            mergecal = func(cal1,cal2)\n            if mergecal\n              groups[i] &lt;&lt; mergecal\n            else\n              mergecal = nil\n            end\n          end\n        end\n      else\n        groups[i] = arr[2*i]\n      end\n    end\n    arr = nil\n    return merge(groups)\n  end\n</code></pre>\n\n<p>After the page using this algorithm is rendered, Task Manager reported around 500MB of RAM usage. Then by refreshing the same page again, memory usage have now reached 1GB. I tried adding <code>GC.start(full_mark: true)</code> to the controller just after the function call, but nothing seems to have changed. I'm not sure whether the memory leak has to code with my code or Ruby itself.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "actioncable"], "comments": [{"owner": {"reputation": 21992, "user_id": 712765, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/oLlVJ.jpg?s=128&g=1", "display_name": "Old Pro", "link": "https://stackoverflow.com/users/712765/old-pro"}, "edited": false, "score": 0, "creation_date": 1550958608, "post_id": 41581499, "comment_id": 96465826, "body": "Do you have an update on this? What did you do to ameliorate this problem?"}, {"owner": {"reputation": 667, "user_id": 386050, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5e7c9de76284b8e9164b7de23fd57c92?s=128&d=identicon&r=PG", "display_name": "Lorenz", "link": "https://stackoverflow.com/users/386050/lorenz"}, "reply_to_user": {"reputation": 21992, "user_id": 712765, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/oLlVJ.jpg?s=128&g=1", "display_name": "Old Pro", "link": "https://stackoverflow.com/users/712765/old-pro"}, "edited": false, "score": 1, "creation_date": 1551035800, "post_id": 41581499, "comment_id": 96482625, "body": "I found an issue with SSL and wss not being being properly configured.  I still do the hacky double checking to make sure the message goes to the right channel, but things got a lot smoother after I uncovered the SSL issue."}], "owner": {"reputation": 667, "user_id": 386050, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5e7c9de76284b8e9164b7de23fd57c92?s=128&d=identicon&r=PG", "display_name": "Lorenz", "link": "https://stackoverflow.com/users/386050/lorenz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 708, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1592328356, "creation_date": 1484099610, "question_id": 41581499, "link": "https://stackoverflow.com/questions/41581499/action-cable-issue-messages-occasionally-not-delivering-or-occasionally-sent-to", "title": "Action Cable issue: messages occasionally not delivering or occasionally sent to the wrong channel", "body": "<p>I'm using Action Cable for a chat application with many different channels.  Everything is set up with Redis and Postgresql (to save messages) on Heroku and 95% of the time works great in development and production.</p>\n\n<p>Occasionally though, messages sent do not show up.  The message is sent, it is saved in the database, but then it never shows up on the front end unless I refresh.  Or, the message shows up in another channel for which it is not directed.  Again, everything is properly saved in the Postgres database.  It just gets wonky on the front end.  Somewhere the ActionCable seems to get confused.</p>\n\n<p>This issue happens so rarely for me, that it is very difficult to replicate to debug properly.  But I have a bunch of users that are regularly reporting the issue and I'm struggling to figure out how to track it down.</p>\n\n<p>Here is some of my code:</p>\n\n<p>javascripts/channels/channels.js</p>\n\n<pre><code>class PodsChannel &lt; ApplicationCable::Channel\n  def subscribed\n    stream_from \"pods_channel_#{params['pod_slug']}\"\n  end\n\n  def unsubscribed\n    # Any cleanup needed when channel is unsubscribed\n  end\n\n  def speak(data)\n    #after_create_commit callback fires to create a job to broadcast message\n    pod_message = PodMessage.create! pod_slug: data['pod_slug'], message_body: data['message'], user_id: data['user_id'], message_type: data['msg_type']\n  end\nend\n</code></pre>\n\n<p>channels/pods_channel.rb</p>\n\n<pre><code>$(document).on(\"ready\",function(){\n  var pod_slug = $(\"#pod_slug_value\").val();\n\n  // hack to prevent double posting of messages\n  if (!App.pods || JSON.parse(App.pods.identifier).pod_slug != pod_slug){\n    App.pods = App.cable.subscriptions.create(\n      { channel: 'PodsChannel', pod_slug: pod_slug },\n      {\n      received: function(data) {\n        if ( ($(\".chat-stream\").length) &amp;&amp; data.pod_slug == pod_slug ){ // hack to prevent msgs going accross pods\n          //#CLEAN: this is a super hackish way of preventing double messages\n          if(!$(\"#msg_\" + data.msg_id).length){\n            $(data.message).appendTo($(\".chat-stream\")).find('.msg-text a').attr('target', '_blank');\n            $(\"#msg_\" + data.msg_id + \" .msg-text\").html(Autolinker.link($(\"#msg_\" + data.msg_id + \" .msg-text\").html(), { mention: \"sutra\" }));\n            $(\".chat-stream\").scrollTop($(\".chat-stream\")[0].scrollHeight);\n          }\n        }\n      },\n\n      speak: function(message, pod_slug, user_id, msg_type) {\n        return this.perform('speak',{\n          message: message,\n          pod_slug: pod_slug,\n          user_id: user_id,\n          msg_type: msg_type,\n        });\n      }\n    });\n  };\n\n  if ( $(\".chat-stream\").length ) {\n    $(\".chat-stream\").scrollTop($(\".chat-stream\")[0].scrollHeight);\n  };\n\n  captureMessage();\n});\n\nfunction captureMessage(){    \n\n  $(document).on('click', \"#btn-submit-msg\", {}, function(){\n    var raw_text = $(\"#msg-input-text\").val();\n    if (raw_text != \"\"){\n      submitMessage(raw_text, \"pod_message\");\n    }\n  });\n\n  $(document).on('keydown', '#msg-input-text', {}, function(event) {\n    if (event.which == 13 &amp;&amp; !event.shiftKey &amp;&amp; !event.ctrlKey &amp;&amp; !event.metaKey) {\n        event.preventDefault();\n        event.stopPropagation();\n        if (event.target.value != \"\") {\n          submitMessage(event.target.value, \"pod_message\")\n        }\n    }\n    });\n}\n\nfunction submitMessage(raw_text, msg_type){\n  var message = raw_text;\n  var pod_slug = $(\"#pod_slug_value\").val();\n  var user_id = $(\"#current_user_id_value\").val();\n  var msg_type = msg_type;\n  if (App.pods.consumer.connection.disconnected == false) {\n    App.pods.speak(message, pod_slug, user_id, msg_type);\n    if (msg_type != \"attachment\") {\n      $(\"#msg-input-text\").val(\"\");\n    }\n  }\n}\n</code></pre>\n\n<p>models/pod_message.rb</p>\n\n<pre><code>class PodMessage &lt; ApplicationRecord\n    after_create_commit { MessageBroadcastJob.perform_now self }\nend\n</code></pre>\n\n<p>jobs/message_broadcast_job.rb</p>\n\n<pre><code>class MessageBroadcastJob &lt; ApplicationJob\n  queue_as :default\n\n  def perform(pod_message)\n    stream_id = \"pods_channel_#{pod_message.pod_slug}\"\n    ActionCable.server.broadcast stream_id, message: render_message(pod_message), msg_id: pod_message.id, pod_slug: pod_message.pod_slug\n  end\n\n  private\n    def render_message(pod_message)\n      renderer = ApplicationController.renderer.new\n      renderer.render(partial: 'pod_messages/pod_message', locals: { pod_message: pod_message })\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "oop"], "comments": [{"owner": {"reputation": 4457, "user_id": 5281693, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fN4R.jpg?s=128&g=1", "display_name": "Alexander Luna", "link": "https://stackoverflow.com/users/5281693/alexander-luna"}, "edited": false, "score": 0, "creation_date": 1484097345, "post_id": 41581180, "comment_id": 70367181, "body": "tough question since we don&#39;t know the 40 methods. Some could be moved to other models some to helpers. You could also build methods in the other models to elegantly create new payments, etc."}], "answers": [{"tags": [], "owner": {"reputation": 12784, "user_id": 1373987, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bca7defe7b8087d8e261d32b29cf425e?s=128&d=identicon&r=PG", "display_name": "joshua.paling", "link": "https://stackoverflow.com/users/1373987/joshua-paling"}, "is_accepted": false, "score": 3, "last_activity_date": 1484097751, "last_edit_date": 1484097751, "creation_date": 1484097433, "answer_id": 41581233, "question_id": 41581180, "link": "https://stackoverflow.com/questions/41581180/rails-too-many-methods-in-model/41581233#41581233", "title": "Rails: too many methods in model", "body": "<blockquote>\n  <p>should I create modules in APP/lib directory</p>\n</blockquote>\n\n<p>Basically, yes, that's what you should do. Although I'd probably make them classes rather than modules. The pattern it sounds like you're after is called \"service Objects\" (or sometimes \"use cases\"). What this does is takes the logic from a specific operation you want to perform, and puts it in it's own self-contained class. That class then collaborates with whatever models it needs to. So, your models stay quite small, and your \"Service Classes\" follow the Single Responsibility Principle. Your controllers then usually call a single \"service class\" to do what they need to do - so your controllers stay pretty minimal too.</p>\n\n<p>If you google \"rails service objects\" or similar, you'll find lots of great stuff, but here's some resources to get you started.</p>\n\n<p>Service objects rails casts: <a href=\"https://www.youtube.com/watch?v=uIp6N89PH-c\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=uIp6N89PH-c</a></p>\n\n<p><a href=\"https://webuild.envato.com/blog/a-case-for-use-cases/\" rel=\"nofollow noreferrer\">https://webuild.envato.com/blog/a-case-for-use-cases/</a></p>\n\n<p><a href=\"https://blog.engineyard.com/2014/keeping-your-rails-controllers-dry-with-services\" rel=\"nofollow noreferrer\">https://blog.engineyard.com/2014/keeping-your-rails-controllers-dry-with-services</a></p>\n\n<p><a href=\"http://blog.codeclimate.com/blog/2012/10/17/7-ways-to-decompose-fat-activerecord-models/\" rel=\"nofollow noreferrer\">http://blog.codeclimate.com/blog/2012/10/17/7-ways-to-decompose-fat-activerecord-models/</a> (there's one section on service objects there)</p>\n\n<p>Keep in mind, once you do start using service objects, you don't necessarily have to ALWAYS go through your <code>Application</code> model to get to the related ones. A service object might take an <code>application_id</code> and then do eg. <code>@payment = Payment.find_by(application_id: application_id)</code> and so you don't have to fetch the application instance at all and can manipulate the <code>@payment</code> variable directly.</p>\n\n<p>The fact that Rails makes it \"easy\" and \"pretty\" to get to related models doesn't necessarily mean you should do it.</p>\n"}, {"tags": [], "owner": {"reputation": 473, "user_id": 2588887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c060e93f000081c298d2a112fa884f8a?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/2588887/jay"}, "is_accepted": false, "score": 1, "last_activity_date": 1484109989, "creation_date": 1484109989, "answer_id": 41582883, "question_id": 41581180, "link": "https://stackoverflow.com/questions/41581180/rails-too-many-methods-in-model/41582883#41582883", "title": "Rails: too many methods in model", "body": "<p>TL;DR: If your app has four models that are all tied to tables in your database (ie. leveraging ActiveRecord and inheriting from ActiveModel::Base), the framework is pretty opinionated toward using model classes.</p>\n\n<p>Abstractions of the service class pattern can be useful in some cases, but give yourself a break. One of the advantages of Rails is that its supposed to remove a lot of the barriers to development, among many things, by making organization decisions for you.  Leverage your model classes.</p>\n\n<p>Let's see if this starts an epic developer bickering war.</p>\n\n<p>Also, its ok to create interfaces in your models for related model creation:</p>\n\n<pre><code>class Application &lt; ActiveModel::Base\n  has_one :payment\n\n  def create_payment(attrs)\n    payment.create(attrs)\n  end\nend\n</code></pre>\n\n<p>And by ok, i mean that the framework will allow this.  But remember, you're already inheriting from <code>ActiveModel::Base</code> which defines many instance methods, including <code>create</code>.</p>\n\n<p>I would recommend, esp. if this is a small project and you're just getting your feet wet, to use well-named rails controllers to read and write objects to the database:</p>\n\n<pre><code>class ApplicationPaymentsController &lt; ActionController::Base\n  def create\n    application = Application.find(params[:id])\n    application.create_payment(payment_params)\n  end\n\n  private\n\n  def payment_params\n    params.require(:payment).permit(:x, :y) - whatever your attr names are.\n  end\nend\n</code></pre>\n\n<p>The sleekness you're looking for in abstracting foreign keys in creating a relational record is taken care of for you with Rails associations:</p>\n\n<p><a href=\"http://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/association_basics.html</a> (good starting point)</p>\n\n<p><a href=\"http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_one\" rel=\"nofollow noreferrer\">http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_one</a> (more explicit docs)</p>\n\n<p>That will help you slim down models if that is your goal. Just for clarification, this is one of those things that devs are extremely opinionated on, one way or another, but the truth is that there are code smells (which should be addressed) and then there are folks who arbitrary preach file length maxes.  The most important thing in all of this is readable code.</p>\n\n<p>A good litmus test for refactoring working code is put it down for a few weeks, come back to it, and if its confusing then put in some time to make it better (hopefully guided by already written test coverage).  Otherwise, enjoy what you do, especially if you're working solo.</p>\n"}, {"tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 2, "last_activity_date": 1484197362, "creation_date": 1484197362, "answer_id": 41605453, "question_id": 41581180, "link": "https://stackoverflow.com/questions/41581180/rails-too-many-methods-in-model/41605453#41605453", "title": "Rails: too many methods in model", "body": "<p>I would not worry about long controller and spec files in Rails.</p>\n\n<p>These files tend to get very long and the usual advice of keeping classes and methods short does not necessarily apply for controllers and their specs.</p>\n\n<p>For example, in our production system <code>user_controller.rb</code> is 8500 lines long and the corresponding <code>user_controller_spec.rb</code> is 7000 lines long.</p>\n\n<p>This is the length of our top 10 controllers</p>\n\n<pre><code>1285 app/controllers/*********_controller.rb\n1430 app/controllers/***********_controller.rb\n1444 app/controllers/****_controller.rb\n1950 app/controllers/****_controller.rb\n1994 app/controllers/********_controller.rb\n2530 app/controllers/***********_controller.rb\n2697 app/controllers/*********_controller.rb\n2998 app/controllers/*****_controller.rb\n3134 app/controllers/application_controller.rb\n8737 app/controllers/users_controller.rb\n</code></pre>\n"}], "owner": {"reputation": 1589, "user_id": 1123717, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fb3d5703694d21ac6573b31d3f3014f0?s=128&d=identicon&r=PG", "display_name": "aarkerio", "link": "https://stackoverflow.com/users/1123717/aarkerio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1484197362, "creation_date": 1484096881, "question_id": 41581180, "link": "https://stackoverflow.com/questions/41581180/rails-too-many-methods-in-model", "title": "Rails: too many methods in model", "body": "<p>TL;DR: I don't know how organise my logic domain classes. </p>\n\n<p>I have the model \"Application\", this model is in the \"core\" of the App and is the way I \"enter\" and operate over other models like:</p>\n\n<pre><code>@application = Application.find(params[:application_id])\n@application.payment.update_attribute 'active', true\n</code></pre>\n\n<p>or    </p>\n\n<pre><code>   unless @application.report.status \n</code></pre>\n\n<p>or </p>\n\n<pre><code>   @application.set_income(params[:income][:new_income])\n</code></pre>\n\n<p>so the models Payment, Income and Report are basically empty because I initialise the Application model and from there I do things \"on cascade\" to change the \"subordinated\" models. But now the Application model has more than forty methods and 600 lines.</p>\n\n<p>I'm doing it right? For instance when I want to add a new Payment I like to do :</p>\n\n<pre><code>payment = Payment.create params  \n</code></pre>\n\n<p>inside the Application model because ActiveRecord \"knows\" how to handle the foreign keys automatically. I could create the payment inside the Payment model using:</p>\n\n<pre><code>application = Application.find(application_id)\nparams[:application_id] = application.id\nself.create params\n</code></pre>\n\n<p>but this way, I need to set the Application.id manually and that looks more verbose and not elegant.</p>\n\n<p>So --if I want to reduce my Application model--, should I create modules in APP/lib directory or should I move methods to the other models?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching", "redis"], "comments": [{"owner": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "edited": false, "score": 0, "creation_date": 1484097007, "post_id": 41581179, "comment_id": 70367121, "body": "another option could be to generate a unique lat, long when the lat/long received is in the same area.  any position inside a radius from the center always report the same lat/long."}, {"owner": {"reputation": 16720, "user_id": 209591, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0ff9c3a23e73d87375f89ab6ccf62e31?s=128&d=identicon&r=PG", "display_name": "Geert-Jan", "link": "https://stackoverflow.com/users/209591/geert-jan"}, "edited": false, "score": 0, "creation_date": 1484101603, "post_id": 41581179, "comment_id": 70368115, "body": "A completely different solution (better imho) is to picture a grid on the globe. Your solution than consists of 2 steps: 1) given lat/long determine identifier of grid-cell (at a particular resolution). and possibly the 8 neighboring cells 2) store your stuff per grid-cell id in redis for a quick lookup or something. A nice way to create grids over a globe is <a href=\"https://en.wikipedia.org/wiki/Geohash\" rel=\"nofollow noreferrer\">geohash</a>. There&#39;s probably some libs in ruby to use. Apparently even <a href=\"https://redis.io/commands/geohash\" rel=\"nofollow noreferrer\">redis</a> has some support, although I don&#39;t know if that last one is useful. hth."}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 4337475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1e1604fc185d1a760f8fd721434363?s=128&d=identicon&r=PG&f=1", "display_name": "RamPrasad Reddy", "link": "https://stackoverflow.com/users/4337475/ramprasad-reddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1484109363, "creation_date": 1484109363, "answer_id": 41582784, "question_id": 41581179, "link": "https://stackoverflow.com/questions/41581179/create-a-cache-key-based-on-location/41582784#41582784", "title": "create a cache key based on location", "body": "<h2>Gemfile</h2>\n\n<pre><code>gem 'redis'\n</code></pre>\n\n<p>Run bundle install</p>\n\n<h2>config/redis.yml</h2>\n\n<pre><code>default: &amp;default\n  host: localhost\n  port: 6379\n  db: 15\n\ndevelopment:\n  &lt;&lt;: *default\n\ntest:\n  &lt;&lt;: *default\n\nproduction:\n  &lt;&lt;: *default\n</code></pre>\n\n<h2>config/initializers/redis.rb</h2>\n\n<pre><code>redis_config = HashWithIndifferentAccess.new(Rails.application.config_for(:redis))\nREDIS = Redis.new(host: redis_config[:host], port: redis_config[:port], db: redis_config[:db])\n</code></pre>\n\n<p>Now REDIS variable is available throughout your application since initializer files are loaded on app load.</p>\n\n<pre><code>REDIS.set(\"gas_station__#{some_location}\", latitude_values here)\nREDIS.get(\"gas_station_#{some_location}\")\n</code></pre>\n\n<p>References: <a href=\"https://github.com/redis/redis-rb\" rel=\"nofollow noreferrer\">https://github.com/redis/redis-rb</a></p>\n"}], "owner": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484109363, "creation_date": 1484096878, "question_id": 41581179, "link": "https://stackoverflow.com/questions/41581179/create-a-cache-key-based-on-location", "title": "create a cache key based on location", "body": "<p>All,</p>\n\n<p>I am trying to use cache to avoid request over http when the request is made for a specific area.</p>\n\n<p>For example, your are in Los Angeles and 3 persons around you ( appx 1miles) make a google search about gas station nearby.</p>\n\n<p>Instead of requesting each time, it's faster to allow people who are close to you and making the same search to get the result already cached.</p>\n\n<p>In a previous method, I am caching using Redis and build a key using the parameters but to re-use it, you need an exact match as the key created was based on \"gas_station__\" </p>\n\n<pre><code> def set_cache key, val\n    return if blank?( key ) || blank?( val )\n\n    connection.set key, val\n    connection.expire key, EXPIRY\n  end\n\n  def get_cache key\n    connection.get( key ) if present?( key )\n  end\n</code></pre>\n\n<p>now I have used the Ruby Gem geocode api and when giving a coordinate and distance, it give me back a range of lat/lon</p>\n\n<pre><code>  Geocoder::Calculations.bounding_box(location, distance)\n</code></pre>\n\n<p>and using the api below:</p>\n\n<pre><code>def isLocationInRange(location, area)\n  if location[0].between?(area[0], area[2]) &amp;&amp; location[1].between?(area[1], area[3])\n    return true\n  end\n  false\nend\n</code></pre>\n\n<p>I am able to know if the location gave in isLocationInRange is inside the \"area\"</p>\n\n<p>the issue now is to connect this logic to Redis and use it to re-use the cache.</p>\n\n<p>the best should be to generate a Redis key and look for it but it's not easy as I do not want to parse each key stored and check one by one the lat/lon params defined to see if that match an already known range of location.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 2, "creation_date": 1484093961, "post_id": 41580720, "comment_id": 70366413, "body": "This is a difficult one to answer without specific knowledge of the application. However, you&#39;ll want to profile your action and see where you can improve the slow parts. Tools like <a href=\"https://newrelic.com/\" rel=\"nofollow noreferrer\">NewRelic</a> and <a href=\"https://chris.heald.me/2013/ruby-prof-for-rails/\" rel=\"nofollow noreferrer\">RequestProfiler/KCachegrind</a> are useful for this sort of thing."}, {"owner": {"reputation": 4101, "user_id": 1482055, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f4D9p.jpg?s=128&g=1", "display_name": "Milind", "link": "https://stackoverflow.com/users/1482055/milind"}, "edited": false, "score": 1, "creation_date": 1484094190, "post_id": 41580720, "comment_id": 70366458, "body": "i was just wondering why there is a need to show 160k records and how user can view all those records on a page with a huge scroll."}, {"owner": {"reputation": 26940, "user_id": 106410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Sw9rk.png?s=128&g=1", "display_name": "Zepplock", "link": "https://stackoverflow.com/users/106410/zepplock"}, "edited": false, "score": 0, "creation_date": 1484095327, "post_id": 41580720, "comment_id": 70366729, "body": "Can you post controller and view source code?"}, {"owner": {"reputation": 3922, "user_id": 3399504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rRGvW.png?s=128&g=1", "display_name": "ErvalhouS", "link": "https://stackoverflow.com/users/3399504/ervalhous"}, "edited": false, "score": 0, "creation_date": 1484255710, "post_id": 41580720, "comment_id": 70447623, "body": "Usually, this is a code related problem, you should check for n+1 querys being called on view, or repetition of code that could be avoided"}], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 5281693, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fN4R.jpg?s=128&g=1", "display_name": "Alexander Luna", "link": "https://stackoverflow.com/users/5281693/alexander-luna"}, "is_accepted": false, "score": 1, "last_activity_date": 1484095741, "creation_date": 1484095741, "answer_id": 41581013, "question_id": 41580720, "link": "https://stackoverflow.com/questions/41580720/how-to-speed-up-view-rendering-on-rails-5/41581013#41581013", "title": "How to speed up view rendering on rails 5?", "body": "<p>Reduce the amount of records you show at the same time using pagination or something (5-10 at most). That way your queries and rendering will be reduces by a lot. I prefer the will_paginate gem for this but there are many more.</p>\n\n<p>In your views, reduce the amount of logic you are using to render each sensor and create separate views for single sensors (show). In the single sensor views you can add more logic.</p>\n\n<p>Use the new Relic gem to monitor your app and see which request take the most amount of time. Maybe you have slow external resources like api calls, etc which you can perform via Ajax and not on the server: <a href=\"https://docs.newrelic.com/docs/agents/ruby-agent/installation-configuration/ruby-agent-installation\" rel=\"nofollow noreferrer\">https://docs.newrelic.com/docs/agents/ruby-agent/installation-configuration/ruby-agent-installation</a></p>\n\n<p>Those are the basics, once you are done with that, move on to eager loading and caching. </p>\n\n<p>For eager loading read this: <a href=\"http://guides.rubyonrails.org/active_record_querying.html#eager-loading-associations\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/active_record_querying.html#eager-loading-associations</a></p>\n\n<p>For caching read DHH's blog post: <a href=\"https://signalvnoise.com/posts/3113-how-key-based-cache-expiration-works\" rel=\"nofollow noreferrer\">https://signalvnoise.com/posts/3113-how-key-based-cache-expiration-works</a></p>\n"}, {"tags": [], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "is_accepted": true, "score": 5, "last_activity_date": 1484257015, "last_edit_date": 1484257015, "creation_date": 1484096349, "answer_id": 41581088, "question_id": 41580720, "link": "https://stackoverflow.com/questions/41580720/how-to-speed-up-view-rendering-on-rails-5/41581088#41581088", "title": "How to speed up view rendering on rails 5?", "body": "<p>This certainly doesn't look like a hardware problem, but a problem with implementation. This is impossible to answer perfectly without knowing more about your data structure and architecture, but a few thoughts that may help you track down the problem:</p>\n\n<p>1) How big is the rendered page? Is it possible that the sheer size of the data is what's causing slow rendering times? If this is the problem and the rendered page is just too big, think about paginating the results.</p>\n\n<p>2) How much memory is the ruby process using at any time? When you say, it \"has about 160,000 records\", I assume you're talking about the sensor_registries table, and I assume the subsequent sensors query with the <code>sensors.id in (...)</code> bit is constructed with some data from the sensor_registries table. If this entire table is loaded up in memory before any further work is done, is it possible that the ruby process is just out of memory?</p>\n\n<p>3) Also, does the entire table really need to be loaded up all at once? You might want to take a look at <a href=\"http://apidock.com/rails/ActiveRecord/Batches/find_in_batches\" rel=\"nofollow noreferrer\">http://apidock.com/rails/ActiveRecord/Batches/find_in_batches</a>. That method is great for breaking up work that needs to be done on a large table.</p>\n\n<p>4) Even better\u2013and there's really not a better way to put this\u2013rethink your architecture. Loading up a whole table in memory as part of a synchronous request (even a small one) is almost always a no-no. Can you come up with a sql query to get all your needed records without loading the whole table?</p>\n\n<p>5) If you absolutely need the whole table, what about caching the result after a single load? If you expect the result of a query to be the same across requests with identical parameters, could you construct a cache key out of the params, and use that to store the result? At least that way, all requests after the first one will be fast(er).</p>\n"}, {"comments": [{"owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "edited": false, "score": 0, "creation_date": 1484116967, "post_id": 41584112, "comment_id": 70372782, "body": "Follow DRY principle  make fat model thin controller."}], "tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": false, "score": 3, "last_activity_date": 1484116152, "creation_date": 1484116152, "answer_id": 41584112, "question_id": 41580720, "link": "https://stackoverflow.com/questions/41580720/how-to-speed-up-view-rendering-on-rails-5/41584112#41584112", "title": "How to speed up view rendering on rails 5?", "body": "<p>User following methods:</p>\n\n<ul>\n<li>User pagination to display limit number of records on page and load more records on click button.</li>\n<li>User page caching to put the data into cache and load the heavy page in less time.</li>\n<li>Load js files after the page load and use compressed js files.</li>\n</ul>\n"}], "owner": {"reputation": 655, "user_id": 6237879, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh4.googleusercontent.com/-UfA0mW9tzP4/AAAAAAAAAAI/AAAAAAAAACw/LNGijM-AF6I/photo.jpg?sz=128", "display_name": "Jorge Cuevas", "link": "https://stackoverflow.com/users/6237879/jorge-cuevas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3225, "favorite_count": 0, "accepted_answer_id": 41581088, "answer_count": 3, "score": 3, "last_activity_date": 1484257015, "creation_date": 1484093630, "question_id": 41580720, "link": "https://stackoverflow.com/questions/41580720/how-to-speed-up-view-rendering-on-rails-5", "title": "How to speed up view rendering on rails 5?", "body": "<p>I have a Rails 5 app with a model called Sensor Registry.</p>\n\n<p>It currently has about 160,000 records, but I am experiencing extremely low loading times when trying to display this data.</p>\n\n<p>The application is running on a dual core Intel(R) Xeon(R) CPU E5-2670 v3 @ 2.30GHz and 2GB of RAM.</p>\n\n<p>The server logs show the following:</p>\n\n<blockquote>\n  <p>Started GET \"/sensor_registries\" for 187.220.30.180 at 2017-01-10 23:43:41 +0000</p>\n  \n  <p>Cannot render console from 187.220.30.180! Allowed networks: 127.0.0.1, ::1, 127.0.0.0/127.255.255.255</p>\n  \n  <p>ActiveRecord::SchemaMigration Load (1.2ms)  SELECT \"schema_migrations\".* FROM \"schema_migrations\"</p>\n  \n  <p>Processing by SensorRegistriesController#index as HTML\n    Rendering sensor_registries/index.html.erb within layouts/application</p>\n  \n  <p>SensorRegistry Load (604.0ms)  SELECT \"sensor_registries\".* FROM \"sensor_registries\"</p>\n  \n  <p>Sensor Load (0.6ms)  SELECT \"sensors\".* FROM \"sensors\" WHERE \"sensors\".\"id\" IN (49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 65, 61, 63, 64, 62)</p>\n  \n  <p>Rendered sensor_registries/index.html.erb within layouts/application (54663.9ms)\n  Completed 200 OK in 55468ms (Views: 54827.7ms | ActiveRecord: 611.5ms)</p>\n</blockquote>\n\n<p>I got rid of the N+1 problem, but I'm wondering if there is something more I can do about the database queries. </p>\n\n<p>Anyway the problem seems to be at the moment of rendering the page, it takes about 54 seconds to process it.</p>\n\n<p>Is there a way to optimize CPU usage?</p>\n\n<p>What would be the best solution for speeding up the process and showing the data to the user fast enough?</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1484091051, "post_id": 41580282, "comment_id": 70365560, "body": "Define &quot;integer&quot;? Are they strings? Are they actual <code>Integer</code> numerical values? It would really help if you could edit your question and add some sample data to add some specific context here."}, {"owner": {"reputation": 147, "user_id": 5231062, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/wxAd0.jpg?s=128&g=1", "display_name": "Beth Knight", "link": "https://stackoverflow.com/users/5231062/beth-knight"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484091120, "post_id": 41580282, "comment_id": 70365584, "body": "It&#39;s actually a bunch of floats rounded to 3, like 1.543, 0.753, 0.385, then an SoS or some string."}, {"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1484091135, "post_id": 41580282, "comment_id": 70365592, "body": "@BethKnight What does SoS mean in this context?"}, {"owner": {"reputation": 147, "user_id": 5231062, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/wxAd0.jpg?s=128&g=1", "display_name": "Beth Knight", "link": "https://stackoverflow.com/users/5231062/beth-knight"}, "edited": false, "score": 0, "creation_date": 1484091166, "post_id": 41580282, "comment_id": 70365601, "body": "&quot;SoS&quot;, it&#39;s nothing and I need to get rid of it"}, {"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 2, "creation_date": 1484091278, "post_id": 41580282, "comment_id": 70365637, "body": "@BethKnight So if you want to get only integers you can do <code>a.values.select{|i| Integer === i}</code> if you want to get numbers you can do <code>a.values.select{|i| Numeric === i}</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484091518, "post_id": 41580282, "comment_id": 70365719, "body": "When you say non-integers, do you mean &quot;not whole values&quot; or do you mean &quot;not of type Float&quot;? A short snippet of sample data here with expected results is extremely important. Your descriptions are just a little too vague."}, {"owner": {"reputation": 147, "user_id": 5231062, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/wxAd0.jpg?s=128&g=1", "display_name": "Beth Knight", "link": "https://stackoverflow.com/users/5231062/beth-knight"}, "reply_to_user": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1484091555, "post_id": 41580282, "comment_id": 70365732, "body": "That worked work @EliSadoff. Thanks!"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1484091581, "post_id": 41580282, "comment_id": 70365741, "body": "Please provide an example with desired output :)"}, {"owner": {"reputation": 147, "user_id": 5231062, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/wxAd0.jpg?s=128&g=1", "display_name": "Beth Knight", "link": "https://stackoverflow.com/users/5231062/beth-knight"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484091588, "post_id": 41580282, "comment_id": 70365742, "body": "Not type float @tadman"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 1, "creation_date": 1484127326, "post_id": 41580282, "comment_id": 70378154, "body": "@Eli, &quot;SoS&quot;, short for &quot;Save our Souls&quot;, is the universal symbol of extreme danger or distress.Rubiests might send out an SOS, for example, if an important app that must absolutely, positively be deployed this Friday is not working."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1484098221, "post_id": 41580459, "comment_id": 70367382, "body": "A reminder of the power of <code>grep</code> is always appreciated. If the array might contain floats and integers, and you want both, <code>[2, 3.1, :cat].grep(Numeric) #=&gt; [2, 3.1]</code>, as <code>Numeric === 2 #=&gt; true</code> and <code>Numeric === 3.1 #=&gt; true</code>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 6, "last_activity_date": 1484091884, "creation_date": 1484091884, "answer_id": 41580459, "question_id": 41580282, "link": "https://stackoverflow.com/questions/41580282/removing-non-integers-from-ruby-array/41580459#41580459", "title": "Removing non integers from ruby array", "body": "<p>If you've already done any conversion on your input then it should be a simple case of selecting out the things you want:</p>\n\n<pre><code>hash.values.grep(Float)\n</code></pre>\n\n<p>That looks for anything that's a Float, or derived from Float if your code is so exotic as to have that going on.</p>\n\n<p>It's worth noting that the <code>grep</code> tool is quite versatile. Most people presume it only works on strings or regular expressions, but it's actually a lot more capable than that.</p>\n"}], "owner": {"reputation": 147, "user_id": 5231062, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/wxAd0.jpg?s=128&g=1", "display_name": "Beth Knight", "link": "https://stackoverflow.com/users/5231062/beth-knight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484091884, "creation_date": 1484090959, "question_id": 41580282, "link": "https://stackoverflow.com/questions/41580282/removing-non-integers-from-ruby-array", "title": "Removing non integers from ruby array", "body": "<p>I'm mapping over a hash to create an array of numbers. There are a few elements that are not integers that I want to throw out entirely. Does anyone know how to do it? Or would I have to map over that array again and pull it out there?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 3630282, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c34fa8a2240e57d0732142034b61ab53?s=128&d=identicon&r=PG", "display_name": "Luis Flores", "link": "https://stackoverflow.com/users/3630282/luis-flores"}, "edited": false, "score": 0, "creation_date": 1484169891, "post_id": 41579921, "comment_id": 70404727, "body": "My logic for using a POST to the report controller action is that I use a GET for the parameter getting form, just like with a CRUD #new action posting to the #create action in the same controller, in this case I am GETting the parameters from the form and PUTting them into the report controller action. It did work fine... thks by the way, I was confused with the parameter grouping with parenthesis."}], "tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": true, "score": 2, "last_activity_date": 1484089026, "creation_date": 1484089026, "answer_id": 41579921, "question_id": 41579852, "link": "https://stackoverflow.com/questions/41579852/rails-5-routing-to-wrong-action/41579921#41579921", "title": "Rails 5 routing to wrong action", "body": "<p>HTML <code>&lt;a&gt;</code> links result in a <code>GET</code> request by default. Rails provides a method to create a <code>POST</code> request by setting an attribute on the link. </p>\n\n<p>The url helpers generated by your routes, like <code>reporte_asist</code>, only generate the correct path/url. They do not pass any additional parameters to <code>link_to</code>. If you want to send a <code>POST</code> request to the path specified, you need to add a <code>method: :post</code> to the options passed to <code>link_to</code>:</p>\n\n<pre><code>link_to \"Excel\", reporte_asist_url(...), method: :post\n</code></pre>\n\n<p>That said, it doesn't sound like <code>POST</code> is the correct HTTP verb to be using for this action. This sounds like it ought to be a <code>GET</code> request.</p>\n\n<p>Note: I truncated parameters passed to <code>reporte_asist_url</code> for brevity/clarity; you still need them.</p>\n"}], "owner": {"reputation": 111, "user_id": 3630282, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c34fa8a2240e57d0732142034b61ab53?s=128&d=identicon&r=PG", "display_name": "Luis Flores", "link": "https://stackoverflow.com/users/3630282/luis-flores"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 41579921, "answer_count": 1, "score": 0, "last_activity_date": 1484089026, "creation_date": 1484088611, "question_id": 41579852, "link": "https://stackoverflow.com/questions/41579852/rails-5-routing-to-wrong-action", "title": "Rails 5 routing to wrong action", "body": "<p>I did try several suggestions but I cannot find the way to solve this. My app is working fine but when I try to link_to a custom action it always tries to route to the 'show' action and the result is that parameters don't match (the 'show' action waits for an :id parameter which is assigned the name of the action \"id\"=>\"reporte_asist\") so I get an error:</p>\n\n<pre><code>Started GET \"/equipos/reporte_asist.xls?entrenador=1&amp;final=2017-01-30+00%3A00%3A00+-0600&amp;inicio=2017-01-01+00%3A00%3A00+-0600\" for ::1 at 2017-01-10 15:53:09 -0600\n**Processing by EquiposController#show as XLS**\n  Parameters: {\"entrenador\"=&gt;\"1\", \"final\"=&gt;\"2017-01-30 00:00:00 -0600\", \"inicio\"=&gt;\"2017-01-01 00:00:00 -0600\", \"id\"=&gt;\"reporte_asist\"}\n  Equipo Load (0.2ms)  SELECT  \"equipos\".* FROM \"equipos\" WHERE \"equipos\".\"id\" = ? LIMIT ?  [[\"id\", 0], [\"LIMIT\", 1]]\nCompleted 404 Not Found in 2ms (ActiveRecord: 0.2ms)\n\nActiveRecord::RecordNotFound (Couldn't find Equipo with 'id'=reporte_asist):\n</code></pre>\n\n<p>I tried removing Turbolinks but the problem persists, this is the piece of code that I am using to link to the 'xls' format response:</p>\n\n<pre><code>&lt;div data-no-turbolinks&gt;\n&lt;%= link_to \"Excel\", reporte_asist_url(format: \"xls\", entrenador: @entrenador.id, inicio: @inicio, final: @final, controller: \"equipos\", action: \"reporte_asist\")  %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>This is part of my config/routes.rb:</p>\n\n<pre><code>resources :categorias\nget '/equipos/forma_rep'\npost '/equipos/reporte_asist', to: 'equipos#reporte_asist', as: 'reporte_asist'\nresources :players\nget '/eventos/calendario' =&gt; 'eventos#calendario', as: 'calendario'\nresources :eventos\nget '/equipos/:id/eventos_feed' =&gt; 'equipos#eventos_feed', as: 'eventosFeed'\nget '/eventos/:id/players_feed' =&gt; 'eventos#evento_players', as: 'eventoPlayers'\npost '/asistencias', to: 'asistencias#create'\nget '/validar/:equipo_id', to: 'players#validar'\nresources :equipos\n</code></pre>\n\n<p>This is the rails routes output:</p>\n\n<pre><code>  equipos_forma_rep GET    /equipos/forma_rep(.:format)            equipos#forma_rep\n      reporte_asist POST   /equipos/reporte_asist(.:format)        equipos#reporte_asist\n            players GET    /players(.:format)                      players#index\n                    POST   /players(.:format)                      players#create\n         new_player GET    /players/new(.:format)                  players#new\n        edit_player GET    /players/:id/edit(.:format)             players#edit\n             player GET    /players/:id(.:format)                  players#show\n                    PATCH  /players/:id(.:format)                  players#update\n                    PUT    /players/:id(.:format)                  players#update\n                    DELETE /players/:id(.:format)                  players#destroy\n         calendario GET    /eventos/calendario(.:format)           eventos#calendario\n            eventos GET    /eventos(.:format)                      eventos#index\n                    POST   /eventos(.:format)                      eventos#create\n         new_evento GET    /eventos/new(.:format)                  eventos#new\n        edit_evento GET    /eventos/:id/edit(.:format)             eventos#edit\n             evento GET    /eventos/:id(.:format)                  eventos#show\n                    PATCH  /eventos/:id(.:format)                  eventos#update\n                    PUT    /eventos/:id(.:format)                  eventos#update\n                    DELETE /eventos/:id(.:format)                  eventos#destroy\n        eventosFeed GET    /equipos/:id/eventos_feed(.:format)     equipos#eventos_feed\n      eventoPlayers GET    /eventos/:id/players_feed(.:format)     eventos#evento_players\n        asistencias POST   /asistencias(.:format)                  asistencias#create\n                    GET    /validar/:equipo_id(.:format)           players#validar\n            equipos GET    /equipos(.:format)                      equipos#index\n                    POST   /equipos(.:format)                      equipos#create\n         new_equipo GET    /equipos/new(.:format)                  equipos#new\n        edit_equipo GET    /equipos/:id/edit(.:format)             equipos#edit\n             equipo GET    /equipos/:id(.:format)                  equipos#show\n                    PATCH  /equipos/:id(.:format)                  equipos#update\n                    PUT    /equipos/:id(.:format)                  equipos#update\n                    DELETE /equipos/:id(.:format)                  equipos#destroy\n</code></pre>\n\n<p>Please help me.</p>\n"}, {"tags": ["ruby", "concurrency", "promise", "concurrent-ruby"], "answers": [{"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 2, "last_activity_date": 1484138298, "creation_date": 1484138298, "answer_id": 41591201, "question_id": 41579240, "link": "https://stackoverflow.com/questions/41579240/chain-an-array-of-tasks-in-concurrent-ruby/41591201#41591201", "title": "Chain an array of tasks in Concurrent Ruby", "body": "<p>It isn't shorter, but this structure might make it easier to add new functionality :</p>\n\n<pre><code>require 'concurrent'\n\nclass Task\n  def exec(x = 0)\n    sleep 0.1\n    p x + 1\n  end\n\n  alias call exec\n\n  def to_promise(*params)\n    Concurrent::Promise.new { exec(*params) }\n  end\nend\n\nmodule PromiseChains\n  refine Concurrent::Promise do\n    def chained_thens(callables)\n      callables.inject(self) do |promise, callable|\n        promise.then do |prev_result|\n          callable.call(prev_result)\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>It can be used this way :</p>\n\n<pre><code>using PromiseChains\n\narray_of_tasks = Array.new(10) { Task.new } \n\narray_of_tasks &lt;&lt; -&gt;(x) { p x * 2 } \narray_of_tasks &lt;&lt; proc { |x| p x * 3 }\n\nfirst_task, *other_tasks = array_of_tasks\n\nchain = first_task.to_promise.chained_thens(other_tasks)\n\nchain.on_success { |last_result| puts \"Success: #{last_result} \" }\nchain.rescue { |reason| puts \"Failure: #{reason}\" }\n\nchain.execute\nsleep(2)\n</code></pre>\n\n<p>It outputs :</p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n20\n60\nSuccess: 60 \n</code></pre>\n"}], "owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 1, "accepted_answer_id": 41591201, "answer_count": 1, "score": 4, "last_activity_date": 1484138298, "creation_date": 1484085754, "question_id": 41579240, "link": "https://stackoverflow.com/questions/41579240/chain-an-array-of-tasks-in-concurrent-ruby", "title": "Chain an array of tasks in Concurrent Ruby", "body": "<p>I have a set of tasks that I want to execute sequentially in some background thread, with the result of each task being passed to the next, and with the chain failing if any link in the chain fails.</p>\n\n<p>For the sake of argument, let's say each task is an object with an <code>exec</code> method that returns a value, although they could equally well be procs or lambdas.</p>\n\n<p>What I have now is something like:</p>\n\n<pre><code>promise = array_of_tasks.inject(nil) do |promise, task|\n            if promise\n              promise.then { |prev_result| task.exec(prev_result) }\n            else\n              Concurrent::Promise.new { task.exec }\n            end\n          end\n\npromise.on_success { |last_result| log.info(\"Success: #{last_result} \")}\npromise.rescue { |reason| log.error(\"Failure: #{reason}\")}\n</code></pre>\n\n<p>Is there a more concise way to do this, either in the <code>Promise</code> API or elsewhere in Concurrent Ruby? It seems like a fairly basic operation, but I'm not seeing an existing method that does it.</p>\n\n<p>(Side note: if there isn't such a method, is there a well-known name for this pattern in the futures-and-promises world? I.e., if I write the method myself, is there some existing obvious name for it?)</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1484086634, "post_id": 41579214, "comment_id": 70363848, "body": "That means a literal backslash is also doubled, right? <code>&#39;my name\\\\ is\\ max&#39;</code> would be <code>[ &quot;my&quot;, &quot;name\\\\\\\\&quot;, &quot;is\\\\ max&quot;]</code>?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1484086731, "post_id": 41579214, "comment_id": 70363892, "body": "@WiktorStribi\u017cew I&#39;m trying to split on whitespace that is not preceeded by a backslash. So I don&#39;t think that&#39;s correct."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1484086793, "post_id": 41579214, "comment_id": 70363916, "body": "Then <code>.split(&#47;(?&lt;!\\\\)\\s&#47;)</code>. Or <code>.scan(&#47;(?:[^\\s\\\\]|\\\\.)+&#47;)</code>"}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1484103176, "post_id": 41579214, "comment_id": 70368520, "body": "Try <code>shellwords</code> lib, no need for a regexp. See my answer."}], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1484087363, "post_id": 41579536, "comment_id": 70364179, "body": "Can you see my edit to the question please? There&#39;s a second test case that this wasn&#39;t working with."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1484087511, "post_id": 41579536, "comment_id": 70364238, "body": "See <a href=\"http://ideone.com/Ji3HsM\" rel=\"nofollow noreferrer\">ideone.com/Ji3HsM</a>. Actually, the splitting I suggested also results in expected result: <a href=\"http://ideone.com/4sY1E2\" rel=\"nofollow noreferrer\">ideone.com/4sY1E2</a>"}], "tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1484087734, "last_edit_date": 1484087734, "creation_date": 1484087144, "answer_id": 41579536, "question_id": 41579214, "link": "https://stackoverflow.com/questions/41579214/regex-to-split-on-whitespace-but-not-escaped-whitespace/41579536#41579536", "title": "Regex to split on whitespace but not escaped whitespace", "body": "<p>Regarding</p>\n\n<blockquote>\n  <p>I'm trying to split on whitespace that is not preceeded by a backslash.</p>\n</blockquote>\n\n<p>If you only care about backslash before whitespace and there are no other special cases to consider, use a negative lookbehind <code>(?&lt;!\\\\)</code> before <code>\\s</code>:</p>\n\n<pre><code>s.split(/(?&lt;!\\\\)\\s/)\n</code></pre>\n\n<p>Here, <code>\\s+</code> matches 1+ whitespaces if not preceded with a backslash (<code>(?&lt;!\\\\)</code> is a <em>negative lookbehind</em> that checks if the text to the left of the current location matches the pattern, and if yes, the match is failed).</p>\n\n<p>In case there are multiple whitespaces to consider, and in case there is need to deal with escape sequences, use </p>\n\n<pre><code>s.scan(/(?:[^\\s\\\\]|\\\\.)+/) \n</code></pre>\n\n<p>See the <a href=\"http://ideone.com/shV86c\" rel=\"nofollow noreferrer\">Ruby demo</a></p>\n\n<p>Here, <code>(?:[^\\s\\\\]|\\\\.)+</code> matches 1 or more chars other than a backslash and whitespace (<code>[^\\s\\\\]</code>) or any escape sequence (<code>\\\\.</code>). Add <code>/m</code> modifier to make <code>.</code> match line break chars, too.</p>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484087909, "post_id": 41579674, "comment_id": 70364430, "body": "Why do you use a negative lookahead? Shouldn&#39;t the negative lookbehind be enough?"}, {"owner": {"reputation": 990, "user_id": 2201388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdab0a969d54b8cfed60691e96f7fe62?s=128&d=identicon&r=PG", "display_name": "Mosab Sasi", "link": "https://stackoverflow.com/users/2201388/mosab-sasi"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484088616, "post_id": 41579674, "comment_id": 70364711, "body": "Good question. I was thinking, for whatever reason, that there might be instances where there would be a whitespace followed by a backslash, but I now that I think about it I guess it&#39;s not necessary."}], "tags": [], "owner": {"reputation": 990, "user_id": 2201388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdab0a969d54b8cfed60691e96f7fe62?s=128&d=identicon&r=PG", "display_name": "Mosab Sasi", "link": "https://stackoverflow.com/users/2201388/mosab-sasi"}, "is_accepted": false, "score": 1, "last_activity_date": 1484088211, "last_edit_date": 1484088211, "creation_date": 1484087851, "answer_id": 41579674, "question_id": 41579214, "link": "https://stackoverflow.com/questions/41579214/regex-to-split-on-whitespace-but-not-escaped-whitespace/41579674#41579674", "title": "Regex to split on whitespace but not escaped whitespace", "body": "<p>try this:\n<code>\"./db/users/WGDl-HATof-uhdtT7sPfog: email=maxpleaner@gmail.com name=max\\\\ p\".split(/(?&lt;![\\\\])[\\s](?![\\\\])/)</code>.</p>\n\n<p>A break-down of the regex <code>(?&lt;![\\\\])[\\s](?![\\\\])</code> :</p>\n\n<p><code>(?&lt;![\\\\])</code> This tells the regex engine to match a whitespace not preceded by a backslash \"\\\" (escaped here with another backslash)</p>\n\n<p><code>[\\s]</code> This is a character class for a 'space'</p>\n\n<p><code>(?![\\\\])</code> This tells the regex engine to match a whitespace that is preceded by a backslash \"\\\" (escaped here with another backslash)</p>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1484313981, "post_id": 41581927, "comment_id": 70470954, "body": "Never heard of it. Thanks!"}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 2, "last_activity_date": 1484103404, "last_edit_date": 1484103404, "creation_date": 1484103078, "answer_id": 41581927, "question_id": 41579214, "link": "https://stackoverflow.com/questions/41579214/regex-to-split-on-whitespace-but-not-escaped-whitespace/41581927#41581927", "title": "Regex to split on whitespace but not escaped whitespace", "body": "<p>Try this</p>\n\n<pre><code>require 'shellwords'\n\n'my name\\ is\\ max'.shellsplit\n# =&gt; [\"my\", \"name is max\"]\n</code></pre>\n\n<p>No need for a regexp.</p>\n"}], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 41579536, "answer_count": 3, "score": 1, "last_activity_date": 1484103404, "creation_date": 1484085685, "last_edit_date": 1484087308, "question_id": 41579214, "link": "https://stackoverflow.com/questions/41579214/regex-to-split-on-whitespace-but-not-escaped-whitespace", "title": "Regex to split on whitespace but not escaped whitespace", "body": "<p>I want to split on standard whitespace <code>\" \"</code> but not escaped whitespace \"\\ \"</p>\n\n<p>For example, with the string <code>'my name\\ is\\ max'</code> (single quotes so <code>\\</code> is literal)</p>\n\n<p>I want to get <code>[\"my\", \"name\\ is\\ max\"]</code></p>\n\n<p>I've tried this regex: <code>/[^\\\\]\\s/</code></p>\n\n<p>but the result is this:</p>\n\n<pre><code>=&gt; [\"m\", \"name\\\\ is\\\\ max\"]\n</code></pre>\n\n<p>This is close but I don't know how to keep the <code>y</code> in <code>my</code></p>\n\n<hr>\n\n<p><em>edit</em></p>\n\n<p>As another example consider this string:</p>\n\n<pre><code>\"./db/users/WGDl-HATof-uhdtT7sPfog: email=maxpleaner@gmail.com name=max\\\\ p\"\n</code></pre>\n\n<p>I want to split it into three:</p>\n\n<pre><code>[\n  \"./db/users/WGDl-HATof-uhdtT7sPfog:\",\n  \"email=maxpleaner@gmail.com\",\n  \"name=max\\\\ p\"\n]\n</code></pre>\n"}, {"tags": ["ruby", "wiringpi"], "answers": [{"comments": [{"owner": {"reputation": 4670, "user_id": 2658159, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ca457ff473ed766a9c140f9956c910a?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Thomas", "link": "https://stackoverflow.com/users/2658159/aaron-thomas"}, "edited": false, "score": 0, "creation_date": 1484085753, "post_id": 41579049, "comment_id": 70363407, "body": "Thanks, but unfortunately when I move that portion of the code outside of the method, I get &quot;undefined local variable or method `io&#39; for #&quot; when I navigate to the url the first time."}, {"owner": {"reputation": 45754, "user_id": 17410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1022b779bdc1ddef7cd9d29abd70ed15?s=128&d=identicon&r=PG", "display_name": "zetetic", "link": "https://stackoverflow.com/users/17410/zetetic"}, "reply_to_user": {"reputation": 4670, "user_id": 2658159, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ca457ff473ed766a9c140f9956c910a?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Thomas", "link": "https://stackoverflow.com/users/2658159/aaron-thomas"}, "edited": false, "score": 0, "creation_date": 1484103796, "post_id": 41579049, "comment_id": 70368672, "body": "@AaronThomas you need to cache the <code>io</code> object outside the method. Initialize the object and save it to a variable, then use the variable inside the <code>getstate</code> method. Move the part that is in the <code>do .. end</code> block up into the body of the <code>getstate</code> method."}, {"owner": {"reputation": 4670, "user_id": 2658159, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ca457ff473ed766a9c140f9956c910a?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Thomas", "link": "https://stackoverflow.com/users/2658159/aaron-thomas"}, "reply_to_user": {"reputation": 45754, "user_id": 17410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1022b779bdc1ddef7cd9d29abd70ed15?s=128&d=identicon&r=PG", "display_name": "zetetic", "link": "https://stackoverflow.com/users/17410/zetetic"}, "edited": false, "score": 0, "creation_date": 1484104718, "post_id": 41579049, "comment_id": 70368893, "body": "@zetetic I&#39;m not following - could you give an example of what you have in mind?"}, {"owner": {"reputation": 360, "user_id": 3654206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zw75f.jpg?s=128&g=1", "display_name": "myfashionhub", "link": "https://stackoverflow.com/users/3654206/myfashionhub"}, "reply_to_user": {"reputation": 4670, "user_id": 2658159, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ca457ff473ed766a9c140f9956c910a?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Thomas", "link": "https://stackoverflow.com/users/2658159/aaron-thomas"}, "edited": false, "score": 0, "creation_date": 1484155935, "post_id": 41579049, "comment_id": 70397089, "body": "@AaronThomas See edited code. ||= is memoization. It basically caches the value of io so that the initialization code block doesn&#39;t run every single time. This is assuming pinNumber doesn&#39;t change every time?"}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 1, "creation_date": 1484156732, "post_id": 41579049, "comment_id": 70397630, "body": "<code>def</code> statements are scope boundaries, so <code>pinNumber</code> is not in-scope inside of <code>getstate</code>."}], "tags": [], "owner": {"reputation": 360, "user_id": 3654206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zw75f.jpg?s=128&g=1", "display_name": "myfashionhub", "link": "https://stackoverflow.com/users/3654206/myfashionhub"}, "is_accepted": false, "score": 1, "last_activity_date": 1484155798, "last_edit_date": 1484155798, "creation_date": 1484084973, "answer_id": 41579049, "question_id": 41578664, "link": "https://stackoverflow.com/questions/41578664/unable-to-run-method-multiple-times/41579049#41579049", "title": "Unable to run method multiple times", "body": "<pre><code>pinNumber = 7\n\ndef io\n    @io ||= begin\n        WiringPi::GPIO.new do |gpio|\n          gpio.pin_mode(pinNumber, WiringPi::INPUT)\n        end\n    end\nend\n\ndef getstate()\n    pin_state = io.digital_read(pinNumber)\n    return pin_state\nend \n\nget '/' do\n    getstate() end\n</code></pre>\n\n<p>Initialize the API once when your application starts (outside getState() method). You're initializing the API multiple times, thus the error.</p>\n"}, {"comments": [{"owner": {"reputation": 45754, "user_id": 17410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1022b779bdc1ddef7cd9d29abd70ed15?s=128&d=identicon&r=PG", "display_name": "zetetic", "link": "https://stackoverflow.com/users/17410/zetetic"}, "edited": false, "score": 0, "creation_date": 1484161034, "post_id": 41597377, "comment_id": 70399959, "body": "This demonstrates good use of Ruby idioms. The constant value InputPin is implemented as .... a constant!"}, {"owner": {"reputation": 4670, "user_id": 2658159, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ca457ff473ed766a9c140f9956c910a?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Thomas", "link": "https://stackoverflow.com/users/2658159/aaron-thomas"}, "edited": false, "score": 0, "creation_date": 1484251443, "post_id": 41597377, "comment_id": 70445320, "body": "running this gives me a 404 error, even if i replace the <code>get_state</code> with &quot;hello world&quot;. some other boilerplate needed perhaps?"}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "reply_to_user": {"reputation": 4670, "user_id": 2658159, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ca457ff473ed766a9c140f9956c910a?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Thomas", "link": "https://stackoverflow.com/users/2658159/aaron-thomas"}, "edited": false, "score": 0, "creation_date": 1484256110, "post_id": 41597377, "comment_id": 70447856, "body": "@AaronThomas You&#39;ve got to require <code>sinatra&#47;base</code> for a modular app instead of <code>sinatra</code> which is for top-level apps. Also, you might need to adjust the way you access the <code>get_state</code> method with this depending on the scope. Sinatra does some hoop jumping that gets confusing. When in doubt, <a href=\"http://www.sinatrarb.com/intro.html\" rel=\"nofollow noreferrer\">check the docs</a>."}], "tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 2, "last_activity_date": 1484256072, "last_edit_date": 1484256072, "creation_date": 1484156655, "answer_id": 41597377, "question_id": 41578664, "link": "https://stackoverflow.com/questions/41578664/unable-to-run-method-multiple-times/41597377#41597377", "title": "Unable to run method multiple times", "body": "<p>After creating your GPIO instance, you can make repeated calls to read pins from it. Your code is creating a new instance on each call, however.</p>\n\n<pre><code>require 'wiringpi'\nrequire 'sinatra/base'\n\nclass MyApp &lt; Sinatra::Base\n  InputPin = 7\n\n  IO = WiringPi::GPIO.new do |gpio|\n    gpio.pin_mode(InputPin, WiringPi::INPUT)\n  end     \n\n  def get_state(pin_number = MyApp::InputPin)\n    MyApp::IO.digital_read(pin_number)\n  end \n\n  get '/' do\n    get_state\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 4670, "user_id": 2658159, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ca457ff473ed766a9c140f9956c910a?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Thomas", "link": "https://stackoverflow.com/users/2658159/aaron-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484256072, "creation_date": 1484083388, "last_edit_date": 1484083968, "question_id": 41578664, "link": "https://stackoverflow.com/questions/41578664/unable-to-run-method-multiple-times", "title": "Unable to run method multiple times", "body": "<p>I'm using the <a href=\"https://github.com/WiringPi/WiringPi-Ruby\" rel=\"nofollow noreferrer\">WiringPi</a> gem. This block of code works as expected:</p>\n\n<pre><code>pinNumber = 7\nio = WiringPi::GPIO.new do |gpio| \n    gpio.pin_mode(pinNumber, WiringPi::INPUT) \nend \n\npin_state = io.digital_read(pinNumber) \nreturn pin_state\n</code></pre>\n\n<p>However, when I enclose this in a method so I can make a call using <a href=\"http://www.sinatrarb.com/\" rel=\"nofollow noreferrer\">Sinatra</a>, I get the following error when I try to refresh:</p>\n\n<blockquote>\n  <p>wiringPiSetup*: You must only call this once per program run. This is\n  a fatal error. Please fix your code.</p>\n</blockquote>\n\n<p>Why must this be run only once, and what is the best solution? Ultimately <code>pin_state</code> needs to be retrieved every time I navigate to the root url.</p>\n\n<p>Here's the full code:</p>\n\n<pre><code>require 'wiringpi'\nrequire 'sinatra'\n\ndef getstate()\n    pinNumber = 7\n    io = WiringPi::GPIO.new do |gpio|\n      gpio.pin_mode(pinNumber, WiringPi::INPUT)\n    end     \n\n    pin_state = io.digital_read(pinNumber)\n    return pin_state\nend \n\nget '/' do\n    getstate()\nend \n</code></pre>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1484083318, "post_id": 41578611, "comment_id": 70362122, "body": "Sounds like a great time for a lesson on HTTP\u2026foundational knowledge will help you get out of situations like this."}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1484084549, "post_id": 41578611, "comment_id": 70362777, "body": "<a href=\"http://stackoverflow.com/questions/32724881/is-there-a-way-to-pass-javascript-variable-into-ruby-method-in-html-erb\" title=\"is there a way to pass javascript variable into ruby method in html erb\">stackoverflow.com/questions/32724881/&hellip;</a>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1484085027, "post_id": 41578611, "comment_id": 70363044, "body": "You need to understand that Ruby does not run in the browser. So there&#39;s no way for Ruby to know about the &#39;change&#39; event without you sending a HTTP request to the server. From the client&#39;s perspective, there is no ERB. They only see HTML/CSS/Javascript, etc."}, {"owner": {"reputation": 27, "user_id": 7015537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b61e2634d5f79f12130bd95c1a9fcb05?s=128&d=identicon&r=PG&f=1", "display_name": "jcxswc", "link": "https://stackoverflow.com/users/7015537/jcxswc"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1484086311, "post_id": 41578611, "comment_id": 70363697, "body": "Ah! @maxple that explains my error in thinking completely. Thank you! Would best practice be to have a &#39;submit&#39; button below the selected date, to then process the value via ruby and sort the results?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1484086570, "post_id": 41578611, "comment_id": 70363817, "body": "@jcxswc there&#39;s not really a single best practice here. It depends how you&#39;re building the site.I.e.  does every form submission cause a page reload?(this is the easiest way). or are you using AJAX or websockets?"}, {"owner": {"reputation": 27, "user_id": 7015537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b61e2634d5f79f12130bd95c1a9fcb05?s=128&d=identicon&r=PG&f=1", "display_name": "jcxswc", "link": "https://stackoverflow.com/users/7015537/jcxswc"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1484087421, "post_id": 41578611, "comment_id": 70364204, "body": "@maxple all form submissions cause page reloading! My purpose here is to pass the information to the user.rb model and display the result filtered by the month-range of transactions (as seen in the model). So, I could process the date via form submission, and reload the page with the updated query. To do this, will I need to process this input value in my model then call it in the controller, thereby passing it as a parameter?"}], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 5281693, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fN4R.jpg?s=128&g=1", "display_name": "Alexander Luna", "link": "https://stackoverflow.com/users/5281693/alexander-luna"}, "is_accepted": true, "score": 1, "last_activity_date": 1484087696, "creation_date": 1484087696, "answer_id": 41579642, "question_id": 41578611, "link": "https://stackoverflow.com/questions/41578611/using-javascript-in-embedded-ruby-to-pass-a-variable-as-a-parameter/41579642#41579642", "title": "Using JavaScript in embedded Ruby to pass a variable as a parameter", "body": "<p>Simply put, Ruby runs on your server and all erb tags are evaluated by the time it reaches the client. Ex:</p>\n\n<pre><code>&lt;%= number_to_currency(@user.total_income(date)) %&gt;\n</code></pre>\n\n<p>If you attempt to change \"date\" with javascript you will fail because by the time javascript tries to change it, rails and your server already evaluated the method and it will return that value not the Ruby method.</p>\n\n<p>Now, you have two simple options here:</p>\n\n<ol>\n<li>Write a Javascript function that does the same what your Ruby code is suppose to do.</li>\n<li>Sent an Ajax call to your server, let Rails process the request and respond with json or javascript to the client.</li>\n</ol>\n\n<p>The first option is probably simpler and will be better for your server since it would not have to take care of extra requests. </p>\n\n<p>The second option requires you to create a form and set it to <code>remote: true</code>. In your controller you will have to receive the content of the form, call your @user.total_income method and set the <code>respond_to</code> so that it return json or javascript:</p>\n\n<pre><code>@user_income = @user.total_income(params[:date)\nrespond_to do |format|\n  format.html\n  format.js\nend\n</code></pre>\n\n<p>Then you will have to create a javascript file in your views folder and write some javascript with the info you want the user to get. Simplistically, it will look something like this:</p>\n\n<pre><code>$('#where-to-put-your-income').append('&lt;%= j render @user_income %&gt;');\n</code></pre>\n\n<p>You can read about how to use Ruby and Javascript here:</p>\n\n<p><a href=\"http://guides.rubyonrails.org/working_with_javascript_in_rails.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/working_with_javascript_in_rails.html</a>\n<a href=\"http://apidock.com/rails/ActionController/MimeResponds/InstanceMethods/respond_to\" rel=\"nofollow noreferrer\">http://apidock.com/rails/ActionController/MimeResponds/InstanceMethods/respond_to</a></p>\n\n<p>Good luck, I'm also still a Junior Rails developer, let's do our best.</p>\n"}], "owner": {"reputation": 27, "user_id": 7015537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b61e2634d5f79f12130bd95c1a9fcb05?s=128&d=identicon&r=PG&f=1", "display_name": "jcxswc", "link": "https://stackoverflow.com/users/7015537/jcxswc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 1, "accepted_answer_id": 41579642, "answer_count": 1, "score": 1, "last_activity_date": 1484087696, "creation_date": 1484083175, "question_id": 41578611, "link": "https://stackoverflow.com/questions/41578611/using-javascript-in-embedded-ruby-to-pass-a-variable-as-a-parameter", "title": "Using JavaScript in embedded Ruby to pass a variable as a parameter", "body": "<p><strong>Short story:</strong></p>\n\n<p>I am trying to pass a variable from JavaScript (specifically, jQuery) as a parameter in an embedded ruby method.</p>\n\n<p><strong>Long story:</strong></p>\n\n<p>It all begins with a function. In summary, I have date picker built via jQuery UI.</p>\n\n<pre><code>#my_budget.html.erb\n&lt;h1 class=\"text-center\"&gt;Your Budget&lt;/h1&gt;\n&lt;h4 class=\"text-center\"&gt;Select Month to View&lt;/h4&gt;\n&lt;input style=\"width:200px\" name=\"startDate\" id=\"startDate\" class=\"date-picker form-control\" placeholder=\"Select Month\"/&gt;\n\n&lt;br&gt;\n&lt;br&gt;\n\n&lt;script type=\"text/javascript\"&gt;\n  function setDateRange() {\n    $('.date-picker').change(function() {\n     var date = $(this).val(); \n     return date\n    });\n  }\n\n  $(document).ready(setDateRange);\n&lt;/script&gt;\n</code></pre>\n\n<p>Further down the road, I have embedded ruby attempting to make a call to said variable (date). This value is passed via MM/YYYY format.</p>\n\n<pre><code>#my_budget.html.erb\n&lt;td class=\"section-value\"&gt;&lt;%= number_to_currency(@user.total_income(date)) %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>Here's a peek at my model.</p>\n\n<pre><code>#user.rb\n# General Income\n  def total_income(current_month)\n    total_value = Transaction.joins(:user).where(\"transactions.sub_category\" =&gt; '11').where(\"created_at = ?\", current_month).sum(:amount)\n    total_value\n  end\n</code></pre>\n\n<p>For fairly obvious reasons, this does not work.</p>\n\n<p>I am a junior developer in Rails and am still learning when to use Ruby versus JS for certain functions.</p>\n\n<p>What is the best way to go about passing my JS variable into my embedded Ruby? Alternatively, how can I call the input value \"on change\" via Ruby into my function, so when a user selects \"March 2017\" in the date picker, Ruby says \"Hey, it changed! Let's use it!\" and adjusts the value accordingly.</p>\n\n<p>Thank you! </p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "devise", "jruby", "custom-authentication"], "answers": [{"tags": [], "owner": {"reputation": 84, "user_id": 7064867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c722ca59210e387a1202c154d0c04b6?s=128&d=identicon&r=PG&f=1", "display_name": "355E3b", "link": "https://stackoverflow.com/users/7064867/355e3b"}, "is_accepted": false, "score": 0, "last_activity_date": 1484092841, "creation_date": 1484092841, "answer_id": 41580591, "question_id": 41578279, "link": "https://stackoverflow.com/questions/41578279/rails-custom-authentication-with-internal-jar-security/41580591#41580591", "title": "Rails Custom Authentication with internal jar security", "body": "<p>The omniauth route is not too bad. You can subclass the provider in <a href=\"https://github.com/intridea/omniauth-identity/blob/master/lib/omniauth/strategies/identity.rb\" rel=\"nofollow noreferrer\">omniauth-identity</a> and add your custom sign in logic. </p>\n"}], "owner": {"reputation": 11, "user_id": 7395966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bdd57e2df0fa0c5abb4370ab4db12c?s=128&d=identicon&r=PG&f=1", "display_name": "KSummers", "link": "https://stackoverflow.com/users/7395966/ksummers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484233185, "creation_date": 1484081865, "last_edit_date": 1484233086, "question_id": 41578279, "link": "https://stackoverflow.com/questions/41578279/rails-custom-authentication-with-internal-jar-security", "title": "Rails Custom Authentication with internal jar security", "body": "<p>Our company uses a jar file with java code to authenticate users for access to internal websites.  I have so far been able to integrate that jar file into a devise strategy which allows a user to sign in.  However when I run the code, I get a successful log in/redirect followed by an unauthorized/redirect to log in.</p>\n\n<pre><code>Started POST \"/login\" for 0:0:0:0:0:0:0:1 at 2017-01-09 11:05:40 -0500\n(7.0ms)  SELECT name FROM sqlite_master WHERE type = 'table' AND name =  \"schema_migrations\"\nActiveRecord::SchemaMigration Load (2.0ms)  SELECT \"schema_migrations\".* FROM \"schema_migrations\"\nProcessing by Devise::SessionsController#create as HTML\nParameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"WCrhgdRgZsQng2rgHdhnCBB7me5lAfhvDxwYrMpMUxfUdMN0fN/PjBHJPIUxMYiNjoJlaLsCIlQdN4WmbPlclg==\", \"user\"=&gt;{\"email\"=&gt;\"&lt;valid email&gt;\", \"password\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Log in\"}\nCustom Authenticate\nAuthenticated=true\n{:username=&gt;\"&lt;valid un&gt;\", :firstname=&gt;\"\", :lastname=&gt;\"\", :fullname=&gt;\"\", :email=&gt;\"\"}\n(0.0ms)  SELECT name FROM sqlite_master WHERE type = 'table' AND NOT name = 'sqlite_sequence'\nRedirected to http://localhost:3000/ideas\nCompleted 302 Found in 825ms (ActiveRecord: 2.0ms)\n\n\nStarted GET \"/ideas\" for 0:0:0:0:0:0:0:1 at 2017-01-09 11:05:42 -0500\nProcessing by IdeasController#index as HTML\n  User Load (1.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" IS NULL ORDER BY \"users\".\"id\" ASC LIMIT 1\nCompleted 401 Unauthorized in 34ms (ActiveRecord: 1.0ms)\n\n\nStarted GET \"/login\" for 0:0:0:0:0:0:0:1 at 2017-01-09 11:05:42 -0500\nProcessing by Devise::SessionsController#new as HTML\n  Rendered /Users/un/.rbenv/versions/jruby-9.1.2.0/lib/ruby/gems/shared/gems/devise-4.2.0/app/views/devise/shared/_links.html.erb (6.0ms)\n  Rendered /Users/un/.rbenv/versions/jruby-9.1.2.0/lib/ruby/gems/shared/gems/devise-4.2.0/app/views/devise/sessions/new.html.erb within layouts/application (60.0ms)\nCompleted 200 OK in 1724ms (Views: 1684.7ms | ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>I'm assuming that this is part of the \":database_authenticatable\" line in my user.rb.  </p>\n\n<p>User.rb:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  #include ActiveModel::Model\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable #, :registerable,\n         #:recoverable, :rememberable, :trackable, :validatable\n\n  attr_accessor :username\n  attr_accessor :firstname\n  attr_accessor :lastname\n  attr_accessor :fullname\n  attr_accessor :email\n\nend\n</code></pre>\n\n<p>Custom_authenticatable strategy</p>\n\n<pre><code>module Devise\n  module Strategies\n    class CustomAuthenticatable &lt; Authenticatable\n\n      def authenticate!\n        puts \"Custom Authenticate\"\n        if password.present? &amp;&amp; has_valid_credentials?\n          #puts \"Username and password:\" + password\n          puts authentication_hash[:email]\n\n          authorized = jar.authenticate(authentication_hash[:email], password);\n          puts \"Authenticated=\" + authorized\n          if authorized == false\n            return fail!\n          else\n            personInfo = jar.getPerson(username);\n            puts personInfo\n            personHash = {:username =&gt; personInfo.userName, \n                          :firstname =&gt; personInfo.firstName, \n                          :lastname =&gt; personInfo.lastName,\n                          :fullname =&gt; personInfo.longName,\n                          :email =&gt; personInfo.emailAddress}\n            puts personHash\n            return success! User.new(personHash)\n          end\n        else\n          fail(:unable_to_authenticate)\n        end\n      end\n\n      def has_valid_credentials?\n        true\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<p>However when I change from :database_authenticatable to :custom_authenticatable, I no longer have a users/sign_in route.</p>\n\n<p>Routes as :database_authenticatable</p>\n\n<pre><code>              Prefix Verb   URI Pattern               Controller#Action\n               ideas GET    /ideas(.:format)          ideas#index\n                     POST   /ideas(.:format)          ideas#create\n            new_idea GET    /ideas/new(.:format)      ideas#new\n           edit_idea GET    /ideas/:id/edit(.:format) ideas#edit\n                idea GET    /ideas/:id(.:format)      ideas#show\n                     PATCH  /ideas/:id(.:format)      ideas#update\n                     PUT    /ideas/:id(.:format)      ideas#update\n                     DELETE /ideas/:id(.:format)      ideas#destroy\n    new_user_session GET    /login(.:format)          devise/sessions#new\n        user_session POST   /login(.:format)          devise/sessions#create\ndestroy_user_session DELETE /logout(.:format)         devise/sessions#destroy\n                root GET    /                         redirect(301, /ideas)\n</code></pre>\n\n<p>Routes as :custom_authenticatable</p>\n\n<pre><code>   Prefix Verb   URI Pattern               Controller#Action\n    ideas GET    /ideas(.:format)          ideas#index\n          POST   /ideas(.:format)          ideas#create\n new_idea GET    /ideas/new(.:format)      ideas#new\nedit_idea GET    /ideas/:id/edit(.:format) ideas#edit\n     idea GET    /ideas/:id(.:format)      ideas#show\n          PATCH  /ideas/:id(.:format)      ideas#update\n          PUT    /ideas/:id(.:format)      ideas#update\n          DELETE /ideas/:id(.:format)      ideas#destroy\n     root GET    /                         redirect(301, /ideas)\n</code></pre>\n\n<p>I'm at a bit of a loss as to how to continue.  I have also found that OmniAuth will probably allow me to do the same thing although I'm not sure how I would setup the callback phase.  Is it worth my time to continue down the Devise strategy path trying to allow sign in or should I stop what I'm doing and use OmniAuth?</p>\n\n<p>If it is worth my time to continue down the devise route, what would be the next steps?</p>\n\n<p>This is the first time I have setup Devise, as much of my Rails experience in the past has ben modifying existing Rails applications in the past. Thanks in advance.</p>\n\n<p>References: (I would include links for all of the references, but I lack sufficient reputation points to post more links)</p>\n\n<p>Devise Authentication Strategies</p>\n\n<p>How to create custom authentication strategies with devise and warden\n<a href=\"https://www.ldstudios.co/blog/2016/06/15/how-to-create-custom-authentication-strategies-with-devise-and-warden.html\" rel=\"nofollow noreferrer\">https://www.ldstudios.co/blog/2016/06/15/how-to-create-custom-authentication-strategies-with-devise-and-warden.html</a></p>\n\n<p>Writing a Non-Gemified Strategy for OmniAuth\n<a href=\"http://www.polyglotprogramminginc.com/writing-a-non-gemified-strategy-for-omniauth/\" rel=\"nofollow noreferrer\">http://www.polyglotprogramminginc.com/writing-a-non-gemified-strategy-for-omniauth/</a></p>\n\n<p><strong>Edit</strong> I actually was very close to the answer.  I hadn't setup Devise correctly and was accessing Warden directly, which is I was able to \"sign in\" and then was immediately signed out of my application.</p>\n\n<p>config/initializers/devise.rb <em>(the wrong way)</em></p>\n\n<pre><code>config.warden do |manager|  \n  manager.strategies.add(:custom_authenticatable, Devise::Strategies::CustomAuthenticatable)\n  manager.default_strategies(:scope =&gt; :user).unshift :custom_authenticatable\nend\n</code></pre>\n\n<p>This caused the custom_authenticatatable code to be called but was still trying to use the local Database for the user.  When I made the following change to devise.rb (as described in the ldstudios blog) it started working as expected.</p>\n\n<p>config/initializers/devise.rb <em>(the right way)</em></p>\n\n<pre><code>Devise.add_module(:custom_authenticatable, {\n  strategy: true,\n  controller: :sessions,\n  model: 'custom_auth',\n  route: :session\n})\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "routes", "http-status-code-422"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484081563, "post_id": 41578159, "comment_id": 70361108, "body": "Have you tried <a href=\"http://api.rubyonrails.org/v5.0/classes/ActiveSupport/Rescuable/ClassMethods.html\" rel=\"nofollow noreferrer\"><code>rescue_from</code></a>?"}, {"owner": {"reputation": 10344, "user_id": 1509401, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HiLe4.jpg?s=128&g=1", "display_name": "thank_you", "link": "https://stackoverflow.com/users/1509401/thank-you"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484081634, "post_id": 41578159, "comment_id": 70361151, "body": "None of the tutorials I&#39;ve found use <code>rescue_from</code>. I&#39;ll post links to the tutorials I looked at in my question."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484082643, "post_id": 41578159, "comment_id": 70361723, "body": "That&#39;s why I linked to it. The Rails documentation covers this in more depth than most tutorials do."}, {"owner": {"reputation": 10344, "user_id": 1509401, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HiLe4.jpg?s=128&g=1", "display_name": "thank_you", "link": "https://stackoverflow.com/users/1509401/thank-you"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484083576, "post_id": 41578159, "comment_id": 70362261, "body": "Yes, I&#39;ve used <code>rescue_from</code> and it works flawlessly. I was hoping I didn&#39;t have to use <code>rescue_from</code> in the first place. No other tutorials mention this approach and if I can get rid of <code>rescue_from</code> and the method it calls then I would have simplified my code."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484083774, "post_id": 41578159, "comment_id": 70362359, "body": "Why would you hope that? It&#39;s the tool for the job. It&#39;s the simplest way of expressing what you want to do. The default is to just fail out."}, {"owner": {"reputation": 10344, "user_id": 1509401, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HiLe4.jpg?s=128&g=1", "display_name": "thank_you", "link": "https://stackoverflow.com/users/1509401/thank-you"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484083921, "post_id": 41578159, "comment_id": 70362426, "body": "I had another developer comment that it might be easier for <code>config.exceptions_app = self.routes</code> to do it&#39;s job and simply redirect the user to the 422 error page. I researched and found these articles. None of them are using <code>rescue_from</code> which made me think there must be another way to accomplish this. But from what you&#39;re saying the only way to such a thing is through <code>rescue_from</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484084087, "post_id": 41578159, "comment_id": 70362519, "body": "Unless you have a really compelling argument, I think the <code>rescue_from</code> way is the least surprising, least messy way of doing this. Maybe you can add an answer here that explains your solution and your hesitation for going that route so others might understand better."}, {"owner": {"reputation": 10344, "user_id": 1509401, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HiLe4.jpg?s=128&g=1", "display_name": "thank_you", "link": "https://stackoverflow.com/users/1509401/thank-you"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484084203, "post_id": 41578159, "comment_id": 70362569, "body": "I honestly don&#39;t have a compelling argument. For whatever reason these tutorials are incorrect or I&#39;m missing something obvious. <code>rescue_from</code> is an appropriate answer. I&#39;ll add the answer in two days when I have the ability to do so."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484084278, "post_id": 41578159, "comment_id": 70362621, "body": "They might be out of date. <code>rescue_from</code> wasn&#39;t always as well advertised as it should be."}, {"owner": {"reputation": 10344, "user_id": 1509401, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HiLe4.jpg?s=128&g=1", "display_name": "thank_you", "link": "https://stackoverflow.com/users/1509401/thank-you"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484084348, "post_id": 41578159, "comment_id": 70362664, "body": "@tadman, Thanks for the help."}], "answers": [{"tags": [], "owner": {"reputation": 392, "user_id": 2486834, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8cfa345fa34245351e5dc37864a5a676?s=128&d=identicon&r=PG", "display_name": "arthurlewis", "link": "https://stackoverflow.com/users/2486834/arthurlewis"}, "is_accepted": true, "score": 5, "last_activity_date": 1484342982, "last_edit_date": 1495541336, "creation_date": 1484342982, "answer_id": 41643733, "question_id": 41578159, "link": "https://stackoverflow.com/questions/41578159/generating-the-error-page-for-a-422-error/41643733#41643733", "title": "Generating the Error Page for a 422 Error", "body": "<p>I'm another developer who worked on this with @jason328. It turned out to be a multi-part problem, first with general 422 errors, and then with the specific scenario in which Rails was raising <code>ActiveRecord::InvalidAuthenticityToken</code> and not rendering the appropriate page.</p>\n\n<h1>1. General 422 Errors</h1>\n\n<h2>The Rails error page</h2>\n\n<p>We got rid of this temporarily in our local development environment by setting <code>config.consider_all_requests_local = false</code>. But then instead of getting our custom error page, we got a blank white page.</p>\n\n<h2>The blank white page</h2>\n\n<p>As per <a href=\"https://stackoverflow.com/questions/33149971/rails-dynamic-error-pages-404-422-500-showing-as-blank\">this Stack Overflow question</a>, we needed <code>match '/422', to: 'errors#unprocessable_entity', via: :all</code> for the route instead of <code>get '/422' =&gt; 'errors#unprocessable_entity'</code>. </p>\n\n<p>At this point, generic 422 errors performed as they should. We set up a controller action that raised <code>ActiveRecord::InvalidAuthenticityToken</code> as soon as you hit it, and it rendered our custom 422 page. So for anyone just having trouble with 422 errors in general, the above should cover you.</p>\n\n<h1>2. InvalidAuthenticityToken</h1>\n\n<p>But since a common cause of 422 errors is actually getting an <code>InvalidAuthenticityToken</code> error in the wild, it seems worth describing the rest of the problem we were seeing. In the actual scenario where the app was generating its own <code>InvalidAuthenticityToken</code> error, we were now getting a text-only 500 error, instead of our custom 422 page.</p>\n\n<h2>Text-only 500 error</h2>\n\n<p>We were able to trace this to the <code>FAILSAFE_RESPONSE</code> in  <a href=\"https://github.com/rails/rails/blob/4-2-stable/actionpack/lib/action_dispatch/middleware/show_exceptions.rb#L41\" rel=\"nofollow noreferrer\"><code>ActionDispatch::ShowExceptions#render_exception</code></a>. This is where Rails takes the exception that's been thrown and converts it to a <code>[status, body, headers]</code> response array. If another exception gets thrown during that time, rather than getting caught in an endless loop, it gives up and returns the <a href=\"https://github.com/rails/rails/blob/4-2-stable/actionpack/lib/action_dispatch/middleware/show_exceptions.rb#L18\" rel=\"nofollow noreferrer\">FAILSAFE_RESPONSE</a>. In this case, another <code>InvalidAuthenticityToken</code> error was getting thrown while putting together the response.</p>\n\n<p>At this point, it was time for the <code>:rescue_from</code> strategy:</p>\n\n<pre><code>rescue_from ActionController::InvalidAuthenticityToken,\n            with: :rescue_invalid_authenticity_token\n\ndef rescue_invalid_authenticity_token\n  #...notify services as if this error weren't being rescued\n\n  redirect_to '/422'\nend\n</code></pre>\n\n<p>with a redirect to keep us safe from any more <code>InvalidAuthenticityToken</code> errors in the same request.</p>\n"}], "owner": {"reputation": 10344, "user_id": 1509401, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HiLe4.jpg?s=128&g=1", "display_name": "thank_you", "link": "https://stackoverflow.com/users/1509401/thank-you"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1769, "favorite_count": 0, "accepted_answer_id": 41643733, "answer_count": 1, "score": 2, "last_activity_date": 1484342982, "creation_date": 1484081440, "last_edit_date": 1484081806, "question_id": 41578159, "link": "https://stackoverflow.com/questions/41578159/generating-the-error-page-for-a-422-error", "title": "Generating the Error Page for a 422 Error", "body": "<p>I'm currently generating dynamic error pages for 500 and 404 errors. I want to expand this to 422 errors. Here's what we have so far.</p>\n\n<p>config/application.rb</p>\n\n<pre><code>config.exceptions_app = self.routes\n</code></pre>\n\n<p>controllers/errors_controller.rb</p>\n\n<pre><code>class ErrorsController &lt; ApplicationController\n  def not_found\n    render status: 404\n  end\n\n  def internal_server_error\n    render status: 500\n  end\n\n  def unacceptable\n    render status: 422\n  end\nend\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>get '/404' =&gt; 'errors#not_found'\nget '/500' =&gt; 'errors#internal_server_error'\nget '/422' =&gt; 'errors#unacceptable'\n</code></pre>\n\n<p>The public/422.html page has been deleted. The error view pages have been created but omitted for brevity. When a 404 or 500 error is raised, the error pages are shown. However, when I receive a 422 error I get the following error page.</p>\n\n<p><a href=\"https://i.stack.imgur.com/E49LC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E49LC.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've seen numerous tutorials implementing this same approach and it works. However, I'm receiving a generated Rails error and not the error page I created. What's wrong and how do I fix this?</p>\n\n<p>Tutorials I've looked at:</p>\n\n<ul>\n<li><a href=\"https://wearestac.com/blog/dynamic-error-pages-in-rails\" rel=\"nofollow noreferrer\">https://wearestac.com/blog/dynamic-error-pages-in-rails</a></li>\n<li><a href=\"https://salayhin.wordpress.com/2015/04/17/create-custom-error-pages-dynamically-in-ruby-on-rails-4/\" rel=\"nofollow noreferrer\">https://salayhin.wordpress.com/2015/04/17/create-custom-error-pages-dynamically-in-ruby-on-rails-4/</a></li>\n<li><a href=\"http://sumof.xyz/Custom-Error-Pages-in-Rails-4/\" rel=\"nofollow noreferrer\">http://sumof.xyz/Custom-Error-Pages-in-Rails-4/</a></li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1484082932, "post_id": 41578076, "comment_id": 70361901, "body": "We need a lot more information. WHAT directory is Ruby installed in? How did you install Ruby?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1484083061, "post_id": 41578076, "comment_id": 70361974, "body": "You say your <code>PATH</code> is correct but either that&#39;s not the case, or your Ruby components are installed somewhere other than you expect. <code>find &#47; -name rails</code> or <code>which rails</code> can help find it."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1484084381, "post_id": 41578076, "comment_id": 70362683, "body": "How did you install ruby? Where do you expect the executable to be? Don&#39;t naively assume that your <code>$PATH</code> is correct; it clearly isn&#39;t, since the <code>ruby</code> executable cannot be found! For example, if you installed ruby via RVM then <code>&#47;home&#47;&lt;your-username&gt;&#47;.rvm&#47;rubies&#47;ruby-&lt;VERSION&gt;&#47;bin</code> would also need to be in your <code>$PATH</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1484085635, "post_id": 41578076, "comment_id": 70363347, "body": "please specify version"}, {"owner": {"reputation": 107, "user_id": 5507768, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5abe3fcddd3c1ffbbbc573c07b866ee6?s=128&d=identicon&r=PG&f=1", "display_name": "RM3", "link": "https://stackoverflow.com/users/5507768/rm3"}, "edited": false, "score": 0, "creation_date": 1484532637, "post_id": 41578076, "comment_id": 70535119, "body": "<code>&#47;home&#47;&lt;your-username&gt;&#47;.rvm&#47;rubies&#47;ruby-&lt;VERSION&gt;&#47;bin</code> is not in <code>$PATH</code>, so I&#39;ll guess this is an issue.  Ruby version 2.3.3 installed with rvm version 1.28. Ruby is installed in my <code>workspace</code> directory.   running the find function returns a bunch of permission denieds"}], "owner": {"reputation": 107, "user_id": 5507768, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5abe3fcddd3c1ffbbbc573c07b866ee6?s=128&d=identicon&r=PG&f=1", "display_name": "RM3", "link": "https://stackoverflow.com/users/5507768/rm3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484586009, "creation_date": 1484081181, "last_edit_date": 1484586009, "question_id": 41578076, "link": "https://stackoverflow.com/questions/41578076/rails-gem-and-other-commands-not-found", "title": "rails, gem, and other commands not found", "body": "<p>Many commands are not able to be executed in the terminal. </p>\n\n<p>From looking around, the likely reason is that the $PATH is not pointing to the right place, but the solutions offered would not change anything on my machine, i.e. my $PATH is set up correctly</p>\n\n<p><code>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/home/usr/.rvm/bin:/home/usr/.rvm/bin</code> (the one is repeated, i don't know why)</p>\n\n<p>I am in the directory ruby is installed in when trying to execute the commands.\nAnything else that would help you pinpoint the problem, let me know</p>\n"}, {"tags": ["ruby", "rspec", "cloud9-ide", "translate"], "comments": [{"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 2, "creation_date": 1484080406, "post_id": 41577814, "comment_id": 70360484, "body": "Your IDE is wrong. <code>translate</code> does not mean anything special in Ruby."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1484080539, "post_id": 41577814, "comment_id": 70360556, "body": "It&#39;s a function name, and that&#39;s how the IDE syntax-highlights function names."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1484081045, "post_id": 41577814, "comment_id": 70360838, "body": "cloud9IDE editor doesn&#39;t normally highlight method names in ruby files. So this is just an error. You can ignore it an carry on."}, {"owner": {"reputation": 500, "user_id": 6148582, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4df4768cb482ebfe0bf0ff10a02381b0?s=128&d=identicon&r=PG&f=1", "display_name": "ToTenMilan", "link": "https://stackoverflow.com/users/6148582/totenmilan"}, "edited": false, "score": 0, "creation_date": 1484082209, "post_id": 41577814, "comment_id": 70361463, "body": "Thanks for responses. However I&#39;m still curious about behaviour in irb. Why &#39;start_with?&#39; becomes undefined after that code was loaded?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1484082961, "post_id": 41577814, "comment_id": 70361919, "body": "I see, this only happens in irb and not in scripts. It&#39;s a shame this isn&#39;t your main question and that you have posted a screenshot instead of code, which is what you should really do."}, {"owner": {"reputation": 500, "user_id": 6148582, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4df4768cb482ebfe0bf0ff10a02381b0?s=128&d=identicon&r=PG&f=1", "display_name": "ToTenMilan", "link": "https://stackoverflow.com/users/6148582/totenmilan"}, "edited": false, "score": 0, "creation_date": 1484085701, "post_id": 41577814, "comment_id": 70363377, "body": "I&#39;ve edited the question and added the code causing this. Thanks for pointing this out. I will remember in future. It&#39;s not the first time when I think c9 IDE is acting weird, so that&#39;s why I am curious."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1484089118, "post_id": 41577814, "comment_id": 70364901, "body": "tadman has posted an answer to your first question and it&#39;s a great high-level overview of what&#39;s going on. However as it stands your post is actually two questions. I suggest you edit and remove the question regarding irb in this post (but <i>don&#39;t</i> delete this post) and re-post your irb related question as a new post/SO question. And remember, no screenshots. Post code and your error message."}, {"owner": {"reputation": 500, "user_id": 6148582, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4df4768cb482ebfe0bf0ff10a02381b0?s=128&d=identicon&r=PG&f=1", "display_name": "ToTenMilan", "link": "https://stackoverflow.com/users/6148582/totenmilan"}, "edited": false, "score": 0, "creation_date": 1484137802, "post_id": 41577814, "comment_id": 70385252, "body": "Done. <a href=\"http://stackoverflow.com/questions/41590976/why-word-translate-is-messing-irb\" title=\"why word translate is messing irb\">stackoverflow.com/questions/41590976/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1484085865, "creation_date": 1484085865, "answer_id": 41579263, "question_id": 41577814, "link": "https://stackoverflow.com/questions/41577814/what-is-translate-keyword-do-in-ruby/41579263#41579263", "title": "What is &quot;translate&quot; keyword do in Ruby", "body": "<p>Each Ruby syntax highlighting library often includes common phrases that are used in things like Rails. For example, <code>belongs_to</code>, while not a special keyword in a Ruby sense, is very common in Rails applications so it's often highlighted.</p>\n\n<p><code>translate</code> might be a special phrase as well as it's used by a lot of I18N libraries.</p>\n\n<p>The only way to find out for sure is to look at the rules for syntax highlighting your editor uses. Usually there's a list of special method names in there.</p>\n"}], "owner": {"reputation": 500, "user_id": 6148582, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4df4768cb482ebfe0bf0ff10a02381b0?s=128&d=identicon&r=PG&f=1", "display_name": "ToTenMilan", "link": "https://stackoverflow.com/users/6148582/totenmilan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 41579263, "answer_count": 1, "score": 0, "last_activity_date": 1484137770, "creation_date": 1484080206, "last_edit_date": 1484137770, "question_id": 41577814, "link": "https://stackoverflow.com/questions/41577814/what-is-translate-keyword-do-in-ruby", "title": "What is &quot;translate&quot; keyword do in Ruby", "body": "<p>Short question:<br>\nWhat is 'translate' word doing and why it's colored as special in my IDE?</p>\n\n<p>Long question:<br>\nI am doing the Odin Project, and code in 04_pig_latin Ruby and RSpec exercise should look like this:</p>\n\n<pre><code>def translate(string) \n  # some code\nend\n</code></pre>\n\n<p>Per the spec which I need to pass:</p>\n\n<pre><code>describe \"#translate\" do\n\n  it \"translates a word beginning with a vowel\" do\n    s = translate(\"apple\")\n    expect(s).to eq(\"appleay\")\n  end\n\nend\n</code></pre>\n\n<p>In my Cloud9 IDE the word translate is colored blue (like <code>require</code> or <code>render</code>), so I assume that I can't use it as a method name and will need to change the given RSpec test to pass it. However, I saw that others doing this task are naming this method <code>translate</code> without any issues.<br><br>\nI haven't found anything about this \"keyword\" what could make it unique, I don't know what it's really doing, and don't know whether it's uniqueness comes from Ruby or Cloud9.<br><br></p>\n\n<p><a href=\"https://github.com/TheOdinProject/learn_ruby\" rel=\"nofollow noreferrer\">Link to exercises repo </a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "rubygems"], "comments": [{"owner": {"reputation": 3922, "user_id": 3399504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rRGvW.png?s=128&g=1", "display_name": "ErvalhouS", "link": "https://stackoverflow.com/users/3399504/ervalhous"}, "edited": false, "score": 2, "creation_date": 1484141941, "post_id": 41577694, "comment_id": 70387946, "body": "This is not the error, it is only the indication that an error occourred and you do not have the translation i18n of it&#39;s term. Try saving the model with a bang! like <b>save!</b> to see the stacktrace and identify the real error. Is imagemagick library installed? Check minimagick&#39;s dependencies."}], "owner": {"reputation": 311, "user_id": 6487334, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-mR_kAM02zew/AAAAAAAAAAI/AAAAAAAAAB4/JxJCA3D5shE/photo.jpg?sz=128", "display_name": "Alaap Dhall", "link": "https://stackoverflow.com/users/6487334/alaap-dhall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1220, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484090127, "creation_date": 1484079746, "last_edit_date": 1484090127, "question_id": 41577694, "link": "https://stackoverflow.com/questions/41577694/carrier-wave-mini-magick-processing-error", "title": "Carrier Wave mini_magick_processing error", "body": "<p>I am trying to upload an image in my signup form using carrierwave gem but getting this error:</p>\n\n<blockquote>\n  <p>Avatar translation missing: en.errors.messages.mini_magick_processing_error</p>\n</blockquote>\n\n<p>This is my form:</p>\n\n<pre><code>    &lt;%= form_for @user do |f| %&gt;\n\n    &lt;%= f.label :avatar %&gt;\n    &lt;%= f.file_field :avatar %&gt;\n    &lt;%= f.submit \"SignUp\", class: \"btn btn-primary button\" %&gt;\n\n   &lt;% end %&gt;\n   &lt;%= image_tag @user.avatar.url %&gt;\n</code></pre>\n\n<p>and this is my AvatarUploader:</p>\n\n<pre><code>class AvatarUploader &lt; CarrierWave::Uploader::Base\n  # Include RMagick or MiniMagick support:\n  # include CarrierWave::RMagick\n   include CarrierWave::MiniMagick\n\n  # Choose what kind of storage to use for this uploader:\n  storage :file\n  # storage :fog\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  # Provide a default URL as a default if there hasn't been a file uploaded:\n  # def default_url\n  #   # For Rails 3.1+ asset pipeline compatibility:\n  #   # ActionController::Base.helpers.asset_path(\"fallback/\" + [version_name, \"default.png\"].compact.join('_'))\n  #\n  #   \"/images/fallback/\" + [version_name, \"default.png\"].compact.join('_')\n  # end\n\n  # Process files as they are uploaded:\n  # process scale: [200, 300]\n  #\n   def scale(width, height)\n  #   # do something\n   end\n\n  # Create different versions of your uploaded files:\n   version :thumb do\n     process resize_to_fit: [50, 50]\n   end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n   def extension_whitelist\n     %w(jpg jpeg gif png)\n   end\n\n  # Override the filename of the uploaded files:\n  # Avoid using model.id or version_name here, see uploader/store.rb for details.\n  # def filename\n  #   \"something.jpg\" if original_filename\n  # end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "azure", "automation", "azure-active-directory", "azure-ad-graph-api"], "answers": [{"comments": [{"owner": {"reputation": 9375, "user_id": 1396977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PylBh.jpg?s=128&g=1", "display_name": "Shawn Tabrizi", "link": "https://stackoverflow.com/users/1396977/shawn-tabrizi"}, "edited": false, "score": 0, "creation_date": 1484172328, "post_id": 41599588, "comment_id": 70405858, "body": "Glad you were able to resolve this issue. I have found in the past that a really easy way to avoid issues like this is to first do a &#39;GET&#39; on a similar object, then modify that object to contain the new properties you want, and then use that for your POST. For example, I would create an app using the Azure Portal, and then use the skeleton of that app to then create new apps in my POST request. Another tip could be to use Fiddler to capture the HTTP traffic of PowerShell, or another service which can create applications using graph, and then use that to help create your body."}, {"owner": {"reputation": 23, "user_id": 7395826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacb7b0e8c7cab0635e08d37bda6f5ae?s=128&d=identicon&r=PG&f=1", "display_name": "natia", "link": "https://stackoverflow.com/users/7395826/natia"}, "reply_to_user": {"reputation": 9375, "user_id": 1396977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PylBh.jpg?s=128&g=1", "display_name": "Shawn Tabrizi", "link": "https://stackoverflow.com/users/1396977/shawn-tabrizi"}, "edited": false, "score": 0, "creation_date": 1484175378, "post_id": 41599588, "comment_id": 70407082, "body": "Thanks for the tip, will keep it in mind for future!"}], "tags": [], "owner": {"reputation": 23, "user_id": 7395826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacb7b0e8c7cab0635e08d37bda6f5ae?s=128&d=identicon&r=PG&f=1", "display_name": "natia", "link": "https://stackoverflow.com/users/7395826/natia"}, "is_accepted": false, "score": 1, "last_activity_date": 1484164454, "creation_date": 1484164454, "answer_id": 41599588, "question_id": 41577568, "link": "https://stackoverflow.com/questions/41577568/getting-service-internalservererror-when-creating-application-through-graph-ap/41599588#41599588", "title": "Getting &#39;Service_InternalServerError&#39; when creating application through Graph API in Azure AD", "body": "<p>I fixed my problem, getting internal error when trying to create App.\nBe careful when forming 'body' for http request. I was adding extra '/' at the end of url in 'replyUrls' property. Also adding data type for each property is important. Here is the sample request that worked for me:</p>\n\n<pre><code>body = {\n  \"odata.type\" =&gt; \"Microsoft.DirectoryServices.Application\",\n  \"identifierUris\" =&gt; [\"https://mynamehere.com/#{someidentifier}\"],\n  \"identifierUris@odata.type\" =&gt; \"Collection(Edm.String)\",\n  \"availableToOtherTenants\" =&gt; true,\n  \"homepage\" =&gt; 'https://myhomepage.com',\n  \"replyURLs\" =&gt; [\"http://localhost:3000/someUrl\"],\n  \"replyURLs@odata.type\" =&gt; \"Collection(Edm.String)\",\n  \"displayName\" =&gt; 'This is my app',   \n }\n</code></pre>\n\n<p>Here is the link to blog that was helpful:</p>\n\n<p><a href=\"http://blog.mszcool.com/index.php/2016/06/a-deep-dive-into-azure-ad-multi-tenant-apps-oauthopenidconnect-flows-admin-consent-and-azure-ad-graph-api/\" rel=\"nofollow noreferrer\">http://blog.mszcool.com/index.php/2016/06/a-deep-dive-into-azure-ad-multi-tenant-apps-oauthopenidconnect-flows-admin-consent-and-azure-ad-graph-api/</a></p>\n"}], "owner": {"reputation": 23, "user_id": 7395826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacb7b0e8c7cab0635e08d37bda6f5ae?s=128&d=identicon&r=PG&f=1", "display_name": "natia", "link": "https://stackoverflow.com/users/7395826/natia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484164454, "creation_date": 1484079282, "last_edit_date": 1484104114, "question_id": 41577568, "link": "https://stackoverflow.com/questions/41577568/getting-service-internalservererror-when-creating-application-through-graph-ap", "title": "Getting &#39;Service_InternalServerError&#39; when creating application through Graph API in Azure AD", "body": "<p>I am trying to create application in Azure AD programatically.\nI added initial app in management portal and granted permissions to Graph Api and Active directory (Directory read/write in both).</p>\n\n<p>First I acquire authorization code, sample url formation is below:</p>\n\n<pre><code>uri = Addressable::URI.parse('https://login.microsoftonline.com/common/oauth2/authorize')\n  uri.query_values = {\n    response_type: 'code',\n    response_mode: 'form_post',\n    client_id: &lt;Application ID&gt;,\n    redirect_uri: &lt;Redirect URI&gt;,   \n    resource: 'https://graph.windows.net/',\n    state: &lt;UUID&gt;,\n  }\n</code></pre>\n\n<p>Afterwards I get auth token through bellow request:</p>\n\n<pre><code>client = OAuth2::Client.new(client_id,\n                          client_secret,\n                          :site =&gt; 'https://login.microsoftonline.com',\n                          :authorize_url =&gt; '/common/oauth2/authorize',\n                          :token_url =&gt; '/common/oauth2/token')\n\nauth_token = client.auth_code.get_token(auth_code,\n                                 :redirect_uri =&gt; redirect_uri,\n                                 :scope =&gt; 'openid'\n</code></pre>\n\n<p>Finally i can make graph api call to to applications endpoint to add an app:</p>\n\n<pre><code>graph_url = 'https://graph.windows.net/&lt;TENANT ID&gt;/applications?api-version=1.6'\nbody = {\n  'identifierUris' =&gt; ['&lt;URI&gt;'],\n  'availableToOtherTenants' =&gt; true,\n  'homepage' =&gt; &lt;Home PAGE&gt;,\n  'replyURLs' =&gt; &lt;SOME REPLY URL&gt;,\n  'displayName' =&gt; &lt;APP DISPLAY NAME&gt;,\n}\nheaders = {'Content-Type' =&gt; 'application/json','Authorization' =&gt;  \"Bearer #{auth_token.token}\"}\nconn = Faraday.new(graph_url, {headers: headers})\nres = conn.post graph_url, body.to_json\n</code></pre>\n\n<p>In response I get bellow error which is not very descriptive and not sure what's wrong:</p>\n\n<pre><code>{\"odata.error\"=&gt;{\"code\"=&gt;\"Service_InternalServerError\", \"message\"=&gt;{\"lang\"=&gt;\"en\", \"value\"=&gt;\"Encountered an internal server error.\"}}}\n</code></pre>\n\n<p>Any suggestions are appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 365, "user_id": 43672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc49a2918d8cf87b7fbad0a3b6234a98?s=128&d=identicon&r=PG", "display_name": "chris raethke", "link": "https://stackoverflow.com/users/43672/chris-raethke"}, "is_accepted": true, "score": 0, "last_activity_date": 1484095818, "creation_date": 1484095818, "answer_id": 41581024, "question_id": 41577168, "link": "https://stackoverflow.com/questions/41577168/rails-get-event-name-with-sneakers/41581024#41581024", "title": "Rails: get event name with sneakers", "body": "<p>I had a quick look and it looks like you can implement <code>work_with_params</code> as opposed to <code>work</code> and you'll be passed additional parameters.</p>\n\n<p>Reference <a href=\"https://github.com/jondot/sneakers/blob/9de1f485648d884036347c6bea81cf4d9edaa7b9/lib/sneakers/worker.rb#L57\" rel=\"nofollow noreferrer\">https://github.com/jondot/sneakers/blob/9de1f485648d884036347c6bea81cf4d9edaa7b9/lib/sneakers/worker.rb#L57</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3303864"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 41581024, "answer_count": 1, "score": 0, "last_activity_date": 1484095818, "creation_date": 1484077773, "question_id": 41577168, "link": "https://stackoverflow.com/questions/41577168/rails-get-event-name-with-sneakers", "title": "Rails: get event name with sneakers", "body": "<p>I have this code:</p>\n\n<pre><code>require 'json'\n\nclass PaymentEvents &lt; Workers\n  include Sneakers::Worker\n\n  from_queue \"my-queue\",\n    exchange: 'payment',\n    exchange_type: :topic,\n    exchange_options: { durable: true },\n    queue_options: { durable: true },\n    routing_key: 'event.payment.*',\n    timeout_job_after: 120\n\n  def internal_work(msg)\n    #do stuff here, according to the type of the event\n\n    ack!\n  end\n</code></pre>\n\n<p>since my routing_key is \"event.payment.*\", is there any way to know exactly what event is beeing received?</p>\n"}, {"tags": ["ruby", "regex", "binary", "range"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1484079044, "post_id": 41577126, "comment_id": 70359784, "body": "Welcome to Stack Overflow. Please pay attention to your spelling and grammar. Stack Overflow isn&#39;t a discussion list, it&#39;s an online reference, where those things do matter. We have to fix those if you don&#39;t, which takes away the time we could spend helping others."}], "answers": [{"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484078779, "post_id": 41577246, "comment_id": 70359657, "body": "Perhaps asking hte painfully obvious, but to get this working with my example, am I using &quot;(160..194).each { |e| text.gsub!(e.chr,&#39; &#39;) }&quot;?"}, {"owner": {"reputation": 322, "user_id": 6062644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3MLX.jpg?s=128&g=1", "display_name": "JLB", "link": "https://stackoverflow.com/users/6062644/jlb"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484078974, "post_id": 41577246, "comment_id": 70359754, "body": "Yes, but try my 2nd version as well. I believe it is closer to your original intent (and perhaps more efficient); just use the hex values of the range you want."}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484079751, "post_id": 41577246, "comment_id": 70360147, "body": "When I try the second solution using &quot;td_text.gsub(/[\\xA0-\\xC2]/, &#39; &#39;)&quot;, it fails with the error &quot;invalid multibyte escape: /[\\xA0-\\xC2]/&quot;.  The first solution also fails, but with the error, &quot;Encoding::CompatibilityError: incompatible character encodings: UTF-8 and ASCII-8BIT&quot;"}, {"owner": {"reputation": 322, "user_id": 6062644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3MLX.jpg?s=128&g=1", "display_name": "JLB", "link": "https://stackoverflow.com/users/6062644/jlb"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484080487, "post_id": 41577246, "comment_id": 70360528, "body": "We&#39;re starting to get into the weeds here, but...   <a href=\"https://ruby-doc.org/core-2.4.0/Encoding.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.4.0/Encoding.html</a>"}, {"owner": {"reputation": 322, "user_id": 6062644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3MLX.jpg?s=128&g=1", "display_name": "JLB", "link": "https://stackoverflow.com/users/6062644/jlb"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484080534, "post_id": 41577246, "comment_id": 70360551, "body": "You could force the encoding to ASCII-8Bit."}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484081574, "post_id": 41577246, "comment_id": 70361118, "body": "Ok.  Am I to assume then, that your solution only works if the encoding of the variable in question is &quot;ASCII-8Bit&quot;?"}], "tags": [], "owner": {"reputation": 322, "user_id": 6062644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3MLX.jpg?s=128&g=1", "display_name": "JLB", "link": "https://stackoverflow.com/users/6062644/jlb"}, "is_accepted": false, "score": 0, "last_activity_date": 1484078895, "last_edit_date": 1484078895, "creation_date": 1484078058, "answer_id": 41577246, "question_id": 41577126, "link": "https://stackoverflow.com/questions/41577126/how-to-replace-a-range-of-binary-characters/41577246#41577246", "title": "How to replace a range of binary characters", "body": "<p>Let's say you wanted to replace characters between ASCII values 97 to 127 with a space:</p>\n\n<pre><code>irb(main):002:0&gt; text = 'TeStInG'\n=&gt; \"TeStInG\"\nirb(main):003:0&gt; (97..127).each { |e| text.gsub!(e.chr,' ') }\n=&gt; 97..127\nirb(main):004:0&gt; text\n=&gt; \"T S I G\"\n</code></pre>\n\n<p>Alternately, you can try something like this:</p>\n\n<pre><code>irb(main):024:0&gt; text.gsub(/[\\x00-\\x20]/, 'Z')\n=&gt; \"TZSZIZG\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484079549, "post_id": 41577499, "comment_id": 70360042, "body": "Unfortunately when I ran &quot;td_text.tr(&quot;\\xA0-\\xC2&quot;, &#39; &#39;)&quot;, I got the error, &quot;ArgumentError: invalid byte sequence in UTF-8&quot;.  When I output the problematic string to the screen it takes up several lines, but contains the visible text &quot;  ?PLACE&quot;."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1484081507, "post_id": 41577499, "comment_id": 70361073, "body": "The problem is that <code>&quot;\\xA0-\\xC2&quot;</code> and <code>[160.chr,194.chr].join(&#39;-&#39;)</code> are generating 8-bit ASCII, and Ruby defaults to UTF-8 now. How to tell Ruby to use 8-bit ASCII is covered in the documentation and multiple pages on the internet and SO."}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1484326568, "post_id": 41577499, "comment_id": 70479125, "body": "Why the downvote? Please explain so I can improve the answer."}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 0, "last_activity_date": 1484078995, "creation_date": 1484078995, "answer_id": 41577499, "question_id": 41577126, "link": "https://stackoverflow.com/questions/41577126/how-to-replace-a-range-of-binary-characters/41577499#41577499", "title": "How to replace a range of binary characters", "body": "<p>Just use</p>\n\n<pre><code>str.tr(\"\\xA0-\\xC2\", ' ')\n</code></pre>\n\n<p>Using a hexadecimal <code>\\x</code> escape sequence.</p>\n\n<p>Or if the charcodes are not static</p>\n\n<pre><code>charset = [160.chr,194.chr].join('-')\nstr.tr(charset, ' ')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484081909, "post_id": 41578058, "comment_id": 70361285, "body": "Unfortunately, if I set a variable to &#39;text = &quot;\\r\\n  \\xA0PLACE \\r\\n  &quot;&#39; and then run &quot;text.gsub(/[\\u00A0-\\u00c2]/, &#39; &#39;)&quot;, I get the error &quot;ArgumentError: invalid byte sequence in UTF-8&quot;."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484082092, "post_id": 41578058, "comment_id": 70361387, "body": "You probably need to read about telling Ruby to use 8-Bit ASCII or converting from 8-Bit ASCII to UTF-8."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1484081099, "last_edit_date": 1495541788, "creation_date": 1484081099, "answer_id": 41578058, "question_id": 41577126, "link": "https://stackoverflow.com/questions/41577126/how-to-replace-a-range-of-binary-characters/41578058#41578058", "title": "How to replace a range of binary characters", "body": "<p>Meditate on this:</p>\n\n<pre><code>160.to_s(16) # =&gt; \"a0\"\n194.to_s(16) # =&gt; \"c2\"\n</code></pre>\n\n<p><code>\"a0\"</code> and <code>\"c2\"</code> are the hexadecimal representations for 160 and 194 respectively. Typically we use the hexadecimal version because decimals can cause confusion.</p>\n\n<p>You can use <code>\"\\xa0\"</code> or <code>\"\\u00a0\"</code>, depending on whether you're using 8-bit ASCII, or UTF-8 or Unicode. Current Rubies default to UTF-8.</p>\n\n<p>Here's a string consisting of the character range to test against:</p>\n\n<pre><code>text = (\"\\u00a0\" .. \"\\u00c2\").to_a.map(&amp;:chr).join\n# =&gt; \"\u00a0\u00a1\u00a2\u00a3\u00a4\u00a5\u00a6\u00a7\u00a8\u00a9\u00aa\u00ab\u00ac\u00ad\u00ae\u00af\u00b0\u00b1\u00b2\u00b3\u00b4\u00b5\u00b6\u00b7\u00b8\u00b9\u00ba\u00bb\u00bc\u00bd\u00be\u00bf\u00c0\u00c1\u00c2\"\n</code></pre>\n\n<p>This is how to tell Ruby to modify all characters in that range:</p>\n\n<pre><code>text.gsub(/[\\u00A0-\\u00c2]/, ' ')\n# =&gt; \"                                   \"\n</code></pre>\n\n<p>All that said, I'd recommend using <code>tr</code> as in <a href=\"https://stackoverflow.com/a/41577499/128421\">akuhn's answer</a>. <code>tr</code> is faster for this purpose. </p>\n"}, {"tags": [], "owner": {"reputation": 990, "user_id": 2201388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdab0a969d54b8cfed60691e96f7fe62?s=128&d=identicon&r=PG", "display_name": "Mosab Sasi", "link": "https://stackoverflow.com/users/2201388/mosab-sasi"}, "is_accepted": false, "score": 0, "last_activity_date": 1484157142, "creation_date": 1484157142, "answer_id": 41597510, "question_id": 41577126, "link": "https://stackoverflow.com/questions/41577126/how-to-replace-a-range-of-binary-characters/41597510#41597510", "title": "How to replace a range of binary characters", "body": "<p>Give this a shot:</p>\n\n<pre><code>string = \"\\xA0\"\nstring.gsub( /[\\x00-\\xFF]/, '' )\n=&gt; \" \"\n</code></pre>\n\n<p>This covers the range of ASCII characters between 0x00 (0 decimal) and 0xFF (255 decimal).</p>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 380, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1484157142, "creation_date": 1484077632, "last_edit_date": 1484081220, "question_id": 41577126, "link": "https://stackoverflow.com/questions/41577126/how-to-replace-a-range-of-binary-characters", "title": "How to replace a range of binary characters", "body": "<p>How do I replace a range of binary characters, similar to having a range of regular characters (<code>\"[a-z]\"</code>) in a regexp?  I'm trying this:</p>\n\n<pre><code>2.4.0 :016 &gt; text.gsub([160.chr-194.chr], ' ')\nNoMethodError: undefined method `-' for \"\\xA0\":String\nDid you mean?  -@\n  from (irb):16\n  from /Users/davea/.rvm/gems/ruby-2.4.0@global/gems/railties-5.0.1/lib/rails/commands/console.rb:65:in `start'\n  from /Users/davea/.rvm/gems/ruby-2.4.0@global/gems/railties-5.0.1/lib/rails/commands/console_helper.rb:9:in `start'\n  from /Users/davea/.rvm/gems/ruby-2.4.0@global/gems/railties-5.0.1/lib/rails/commands/commands_tasks.rb:78:in `console'\n  from /Users/davea/.rvm/gems/ruby-2.4.0@global/gems/railties-5.0.1/lib/rails/commands/commands_tasks.rb:49:in `run_command!'\n  from /Users/davea/.rvm/gems/ruby-2.4.0@global/gems/railties-5.0.1/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n  from bin/rails:4:in `require'\n  from bin/rails:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>but I am getting the </p>\n\n<pre><code>NoMethodError: undefined method `-' for \"\\xA0\":String\n</code></pre>\n\n<p>error that you see above.  </p>\n\n<p>I don't have to use a regular expression, but couldn't think of anything else that allowed me to substitute a range of things.</p>\n\n<p>I'm using Ruby 2.4.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1484079400, "post_id": 41576973, "comment_id": 70359967, "body": "As others have stated this is intended behavior or atleast designed behavior <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/associations/has_one_association.rb#L35\" rel=\"nofollow noreferrer\">Source Reference for HasOneAssociation#replace</a>. In essence you are &quot;replacing&quot; <code>Subscription</code> with <code>nil</code> and this causes <code>Subscription#destroy</code> if <code>options[:dependent] == :destroy</code> otherwise it  it nullifies the relationship.  <code>User#destroy</code> is handled very similarly <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/associations/builder/association.rb#L138\" rel=\"nofollow noreferrer\">Source</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1692, "user_id": 530944, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/beafe1b7ac9c832ba4ad25dd0c078fba?s=128&d=identicon&r=PG", "display_name": "Ryan Bosinger", "link": "https://stackoverflow.com/users/530944/ryan-bosinger"}, "edited": false, "score": 0, "creation_date": 1484080344, "post_id": 41577422, "comment_id": 70360453, "body": "The docs you quoted for <code>dependent: destroy</code> suggests to me that when the parent is destroyed it&#39;s association goes with it (as it does). It does not seem to suggest that it would have any affect on the outcome of altering the associated object directly. Am I just looking at this the wrong way?"}, {"owner": {"reputation": 1692, "user_id": 530944, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/beafe1b7ac9c832ba4ad25dd0c078fba?s=128&d=identicon&r=PG", "display_name": "Ryan Bosinger", "link": "https://stackoverflow.com/users/530944/ryan-bosinger"}, "edited": false, "score": 0, "creation_date": 1484163561, "post_id": 41577422, "comment_id": 70401330, "body": "I accepted this answer because the doc quote explaining how the setter works for a <code>has_one</code> is interesting. However, I personally am going to have to leave with the belief that the behaviour of <code>dependent: destroy</code> here is odd and not properly documented. Ah well."}, {"owner": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "reply_to_user": {"reputation": 1692, "user_id": 530944, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/beafe1b7ac9c832ba4ad25dd0c078fba?s=128&d=identicon&r=PG", "display_name": "Ryan Bosinger", "link": "https://stackoverflow.com/users/530944/ryan-bosinger"}, "edited": false, "score": 0, "creation_date": 1484165394, "post_id": 41577422, "comment_id": 70402392, "body": "Reading through <a href=\"http://guides.rubyonrails.org/association_basics.html#has-one-association-reference\" rel=\"nofollow noreferrer\">4.2.1.2 association=(associate)</a> and the other answer, I think you&#39;re right that there isn&#39;t documentation about the <code>DELETE</code> SQL query being fired when setting the association to <code>nil</code>. It definitely works implicitly - exact opposite effect of <code>&quot;When you assign an object to a has_one association, that object is automatically saved&quot;</code>."}], "tags": [], "owner": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "is_accepted": true, "score": 1, "last_activity_date": 1484078746, "creation_date": 1484078746, "answer_id": 41577422, "question_id": 41576973, "link": "https://stackoverflow.com/questions/41576973/rails-activerecord-has-one-association-behavior-when-setting-child-to-nil/41577422#41577422", "title": "Rails/ActiveRecord has_one association behavior when setting child to &quot;nil&quot;", "body": "<p><em>Is this expected behavior?</em></p>\n\n<p>Yes. An example from the <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_one\" rel=\"nofollow noreferrer\">Rails docs on <code>has_one</code> associations</a>:</p>\n\n<blockquote>\n  <p>Account#beneficiary=(beneficiary) (similar to beneficiary.account_id =\n  account.id; beneficiary.save)</p>\n</blockquote>\n\n<p>As for <code>dependent: :destroy</code>, from the same docs:</p>\n\n<blockquote>\n  <p>:destroy causes the associated object to also be destroyed</p>\n</blockquote>\n\n<p>hence the SQL <code>DELETE</code> query.</p>\n"}, {"tags": [], "owner": {"reputation": 17527, "user_id": 516690, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/568c7fdf3e43141d7046e3255685a1d5?s=128&d=identicon&r=PG", "display_name": "Vadim", "link": "https://stackoverflow.com/users/516690/vadim"}, "is_accepted": false, "score": 2, "last_activity_date": 1484078918, "creation_date": 1484078918, "answer_id": 41577471, "question_id": 41576973, "link": "https://stackoverflow.com/questions/41576973/rails-activerecord-has-one-association-behavior-when-setting-child-to-nil/41577471#41577471", "title": "Rails/ActiveRecord has_one association behavior when setting child to &quot;nil&quot;", "body": "<p>From the <a href=\"http://guides.rubyonrails.org/association_basics.html#has-one-association-reference\" rel=\"nofollow noreferrer\">guide</a>:</p>\n\n<blockquote>\n  <p>4.2.5 When are Objects Saved?</p>\n  \n  <p>When you assign an object to a has_one association, that object is\n  automatically saved (in order to update its foreign key). In addition,\n  any object being replaced is also automatically saved, because its\n  foreign key will change too.</p>\n  \n  <p>If either of these saves fails due to validation errors, then the\n  assignment statement returns false and the assignment itself is\n  cancelled.</p>\n  \n  <p>If the parent object (the one declaring the has_one association) is\n  unsaved (that is, new_record? returns true) then the child objects are\n  not saved. They will automatically when the parent object is saved.</p>\n  \n  <p>If you want to assign an object to a has_one association without\n  saving the object, use the association.build method.</p>\n</blockquote>\n"}], "owner": {"reputation": 1692, "user_id": 530944, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/beafe1b7ac9c832ba4ad25dd0c078fba?s=128&d=identicon&r=PG", "display_name": "Ryan Bosinger", "link": "https://stackoverflow.com/users/530944/ryan-bosinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 2, "accepted_answer_id": 41577422, "answer_count": 2, "score": 4, "last_activity_date": 1484079597, "creation_date": 1484077043, "last_edit_date": 1484079597, "question_id": 41576973, "link": "https://stackoverflow.com/questions/41576973/rails-activerecord-has-one-association-behavior-when-setting-child-to-nil", "title": "Rails/ActiveRecord has_one association behavior when setting child to &quot;nil&quot;", "body": "<p>My colleagues and I noticed something about ActiveRecord <code>has_one</code> associations that feels wrong/dangerous and doesn't seem to be readily documented.</p>\n\n<p>Suppose we have this set-up:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_one :subscription\nend\n\nclass Subscription &lt; ApplicationRecord\n  belongs_to :user\nend\n</code></pre>\n\n<h1>Without \"dependent: destroy\"</h1>\n\n<pre><code>&gt; user = User.create(name: \"Bob\")\n&gt; user.subscription = Subscription.create(provider: \"Stripe\")\n\n&gt; user.subscription = nil\n\n   (0.1ms)  begin transaction\n  SQL (0.4ms)  UPDATE \"subscriptions\" SET \"user_id\" = ?, \"updated_at\" = ? WHERE \"subscriptions\".\"id\" = ?  [[\"user_id\", nil], [\"updated_at\", 2017-01-10 19:24:56 UTC], [\"id\", 2]]\n   (2.0ms)  commit transaction\n</code></pre>\n\n<h1>With \"dependent: destroy\"</h1>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_one :subscription, dependent: :destroy\nend\n\n\n&gt; user = User.create(name: \"Bob\")\n&gt; user.subscription = Subscription.create(provider: \"Stripe\")\n\n&gt; user.subscription = nil\n\n   (0.1ms)  begin transaction\n    SQL (1.1ms)  DELETE FROM \"subscriptions\" WHERE \"subscriptions\".\"id\" = ?  [[\"id\", 1]]\n   (0.7ms)  commit transaction\n</code></pre>\n\n<p>Is this expected behaviour? I'm actually surprised that a SQL call is made at all without explicitly calling <code>save</code> or <code>destroy</code> or <code>update</code>, etc. I'm also confused about why <code>dependant: destroy</code> changes behaviour in this scenario.</p>\n\n<p>Is this supposed to happen, and if so, is it documented anywhere? The <code>dependant: destroy</code> version seems particularly dangerous.</p>\n\n<p><strong>This was tested with Rails 5 as well as several versions of Rails 4.</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redirect", "devise"], "answers": [{"tags": [], "owner": {"reputation": 365, "user_id": 43672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc49a2918d8cf87b7fbad0a3b6234a98?s=128&d=identicon&r=PG", "display_name": "chris raethke", "link": "https://stackoverflow.com/users/43672/chris-raethke"}, "is_accepted": false, "score": 0, "last_activity_date": 1484095968, "creation_date": 1484095968, "answer_id": 41581036, "question_id": 41576362, "link": "https://stackoverflow.com/questions/41576362/devise-redirect-after-signing-in-user-from-controller/41581036#41581036", "title": "Devise redirect after signing in user from controller", "body": "<p>You need to make sure you are using the <code>sign_in_and_redirect_method</code> otherwise the url helpers won't get called.</p>\n\n<p><a href=\"http://www.rubydoc.info/github/plataformatec/devise/Devise%2FControllers%2FHelpers%3Asign_in_and_redirect\" rel=\"nofollow noreferrer\">http://www.rubydoc.info/github/plataformatec/devise/Devise%2FControllers%2FHelpers%3Asign_in_and_redirect</a></p>\n"}], "owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484231663, "creation_date": 1484074786, "last_edit_date": 1484231663, "question_id": 41576362, "link": "https://stackoverflow.com/questions/41576362/devise-redirect-after-signing-in-user-from-controller", "title": "Devise redirect after signing in user from controller", "body": "<p>I'm trying to sign in and redirect a user to <code>home_path</code> if certain criteria are met, otherwise they are unapproved and redirected to another page. When I sign in the user through the controller, they are redirected to <code>users#show</code> though (users/:id).</p>\n\n<p>How can I sign them in, and get it to redirect to <code>home_path</code> which is <code>'profile/home'</code> from the registrations controller?</p>\n\n<p>registrations controller:</p>\n\n<pre><code>def after_inactive_sign_up_path_for(resource)\n    if resource.location === \"New York, NY, United States\"\n      if (really long query)\n        puts \"accepted!\"\n        resource.approved = true \n        resource.save!\n        sign_in(resource)\n        home_path\n      else\n        puts \"Not accepted\"\n        '/profile/waitlist'\n      end\n    else\n      puts \"City is not New York!\"\n      '/profile/waitlist'\n    end\nend\n</code></pre>\n\n<p>application controller</p>\n\n<pre><code>def after_sign_in_path_for(resource)\n   home_path\nend\n</code></pre>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["ruby", "facebook", "devise", "omniauth", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 2379, "user_id": 1242752, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0420ab286af5465b57af0e279362464d?s=128&d=identicon&r=PG", "display_name": "CupraR_On_Rails", "link": "https://stackoverflow.com/users/1242752/cuprar-on-rails"}, "edited": false, "score": 0, "creation_date": 1501170790, "post_id": 41575478, "comment_id": 77672544, "body": "Did you find a solution?"}], "owner": {"reputation": 11, "user_id": 7397553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f7c49569b7a56c621d0bad38decadb6?s=128&d=identicon&r=PG&f=1", "display_name": "SHUVO SAHA", "link": "https://stackoverflow.com/users/7397553/shuvo-saha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484075395, "creation_date": 1484071581, "last_edit_date": 1484075395, "question_id": 41575478, "link": "https://stackoverflow.com/questions/41575478/rails-5-faraday-connection-for-facebook-omniauth", "title": "Rails 5 Faraday connection for Facebook Omniauth", "body": "<p>I have tried all the tricks in the book and all the possible solution in stack over flow.But still couldn't figure out the problem. The program pauses at the call back initiated stage and shows <code>faraday connection : timed out</code>. I have the following code:</p>\n\n<pre><code>gem 'omniauth', '~&gt; 1.3', '&gt;= 1.3.1'\ngem 'omniauth-facebook'\n</code></pre>\n\n<p>Routes.rb </p>\n\n<pre><code>devise_for :users, \n:path =&gt; '', \n:path_names =&gt; {:sign_in =&gt; 'login', :sign_out =&gt; 'logout',             :edit =&gt; 'profile' },\n:controllers =&gt; {:omniauth_callbacks =&gt; 'omniauth_callbacks'}\n</code></pre>\n\n<p>/Controller.rb</p>\n\n<pre><code>class OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController\n  def facebook\n    @user = User.from_omniauth(request.env[\"omniauth.auth\"])\n    if @user.persisted? \n      sign_in_and_redirect @user, :event =&gt; :authentication\n      set_flash_message(:notice, :success, :kind =&gt; \"Facebook\") if is_navigational_format?\n    else\n      session[\"devise.facebook_data\"] = request.env[\"omniauth.auth\"].except(\"extra\")\n      redirect_to new_user_registration_url\n    end\n  end\nend\n</code></pre>\n\n<p>/user.rb </p>\n\n<pre><code>class User &lt; ApplicationRecord\n  def self.from_omniauth(auth)\n    user = User.where(email: auth.info.email).first\n    if user\n      return user\n    else\n      where(provider: auth.provider, uid: auth.uid).first_or_create do |user|\n        user.provider = auth.provider\n        user.uid = auth.uid\n        user.email = auth.info.email\n        user.image = auth.info.image\n        user.password = Devise.friendly_token[0,20]\n        user.firstname = auth.info.first_name\n        user.lastname = auth.info.last_name\n        user.phonenumber == '0000000000'\n        user.tc == true\n        user.year == true\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>/devise.rb</p>\n\n<pre><code>config.omniauth:facebook,ENV['FACEBOOK_ID'],ENV['FACEBOOK_SECRET'],scope:'email',info_fields:'email,first_name,last_name'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "amazon-s3", "paperclip"], "comments": [{"owner": {"reputation": 258, "user_id": 1024104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Po14z.png?s=128&g=1", "display_name": "Guillaume Petit", "link": "https://stackoverflow.com/users/1024104/guillaume-petit"}, "edited": false, "score": 0, "creation_date": 1491337484, "post_id": 41574722, "comment_id": 73505289, "body": "Can you tell us more about your setup: Docker image, ruby version, rails version, etc ... Pretty hard to help if you give us no clue"}, {"owner": {"reputation": 55, "user_id": 4970448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27ea7c43464e964d89c36174903f4cf?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Mokhtari", "link": "https://stackoverflow.com/users/4970448/mohamed-mokhtari"}, "reply_to_user": {"reputation": 258, "user_id": 1024104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Po14z.png?s=128&g=1", "display_name": "Guillaume Petit", "link": "https://stackoverflow.com/users/1024104/guillaume-petit"}, "edited": false, "score": 0, "creation_date": 1491426400, "post_id": 41574722, "comment_id": 73553465, "body": "Thank&#39;s for you reply, My Docker image was ruby 2.3.1-slim, rails 5.0.1. and actually I found a quick solution by changing the docker image to the full ruby 2.3.1 and it did the trick, The problem was the slim image is missing some dependencies that paperclip needs to process.  if you have any idea about what might be the real issue it will be very helpful."}, {"owner": {"reputation": 2738, "user_id": 4862564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IuLvH.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4862564/chris"}, "edited": false, "score": 0, "creation_date": 1504186820, "post_id": 41574722, "comment_id": 78925359, "body": "I am also using ruby slim and to make it work I added <code>imagemagick</code> and <code>file</code> dependencies. Since imagemagick uses file command internally to determine the mime type."}, {"owner": {"reputation": 55, "user_id": 4970448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27ea7c43464e964d89c36174903f4cf?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Mokhtari", "link": "https://stackoverflow.com/users/4970448/mohamed-mokhtari"}, "reply_to_user": {"reputation": 2738, "user_id": 4862564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IuLvH.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4862564/chris"}, "edited": false, "score": 0, "creation_date": 1504890138, "post_id": 41574722, "comment_id": 79205321, "body": "@Chris can you please provide me with that part of your docker compose file ?"}], "answers": [{"tags": [], "owner": {"reputation": 2738, "user_id": 4862564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IuLvH.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4862564/chris"}, "is_accepted": true, "score": 2, "last_activity_date": 1504896601, "creation_date": 1504896601, "answer_id": 46122878, "question_id": 41574722, "link": "https://stackoverflow.com/questions/41574722/paperclip-on-docker-doesnt-upload-image/46122878#46122878", "title": "Paperclip on docker doesn&#39;t upload image?", "body": "<p>This is my Dockerfile</p>\n\n<pre><code># Use the barebones version of Ruby 2.3.\nFROM ruby:2.3.1-slim\n\n# Optionally set a maintainer name to let people know who made this image.\nMAINTAINER Chris de Bruin &lt;chris@studytube.nl&gt;\n\n# Install dependencies:\n# - build-essential: To ensure certain gems can be compiled\n# - nodejs: Compile assets\n# - imagemagick: converting images\n# - file: needed by paperclip\n# - wkhtmltopdf: generating pdf from html\n# - libxml2: needed for nokogiri\nRUN apt-get update &amp;&amp; apt-get install -qq -y --no-install-recommends \\\n      build-essential libmysqlclient-dev git-core imagemagick wkhtmltopdf \\\n      libxml2 libxml2-dev libxslt1-dev nodejs file\n\n# Set an environment variable to store where the app is installed to inside\n# of the Docker image. The name matches the project name out of convention only.\nENV INSTALL_PATH /backend\nRUN mkdir -p $INSTALL_PATH\n\n# This sets the context of where commands will be ran in and is documented\n# on Docker's website extensively.\nWORKDIR $INSTALL_PATH\n\n# Ensure gems are cached and only get updated when they change. This will\n# drastically increase build times when your gems do not change.\nCOPY Gemfile Gemfile\nCOPY Gemfile.lock Gemfile.lock\n\nRUN bundle install\n\n# Copy in the application code from your work station at the current directory\n# over to the working directory.\nCOPY . .\n\n# Ensure the static assets are exposed through a volume so that nginx can read\n# in these values later.\nVOLUME [\"$INSTALL_PATH/public\"]\n\n# The default command that gets ran will be to start the Puma server.\nCMD bundle exec puma -C config/puma.rb\n</code></pre>\n\n<p>So you should have your own <code>Dockerfile</code> and use this in your <code>docker-compose.yml</code></p>\n"}], "owner": {"reputation": 55, "user_id": 4970448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27ea7c43464e964d89c36174903f4cf?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Mokhtari", "link": "https://stackoverflow.com/users/4970448/mohamed-mokhtari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 1, "accepted_answer_id": 46122878, "answer_count": 1, "score": 2, "last_activity_date": 1504896601, "creation_date": 1484069185, "question_id": 41574722, "link": "https://stackoverflow.com/questions/41574722/paperclip-on-docker-doesnt-upload-image", "title": "Paperclip on docker doesn&#39;t upload image?", "body": "<p>I have an issue with paperclip when using it with rails under docker development environment,\nI followed all the steps on the <a href=\"https://github.com/thoughtbot/paperclip\" rel=\"nofollow noreferrer\">README</a> to add an image to an existing model, everything works no errors but the image is not uploading locally, even I tried to upload to S3 directly and the same issue no errors at all and image is missing folders are empty?</p>\n\n<p>my code is clean I tried it out of docker and it works, any suggestions ?</p>\n\n<p>to mention I even tried carrierwave and it works very well but I do love to use paperclip I do find it more lightweight and powerful.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "vagrant"], "comments": [{"owner": {"reputation": 1672, "user_id": 1015286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6761adbf746cd896eb6f7816dde3d8b3?s=128&d=identicon&r=PG", "display_name": "Steve Westbrook", "link": "https://stackoverflow.com/users/1015286/steve-westbrook"}, "edited": false, "score": 1, "creation_date": 1484069898, "post_id": 41574720, "comment_id": 70354683, "body": "It would be helpful to describe what you are doing and what issues you are experiencing."}], "answers": [{"tags": [], "owner": {"reputation": 2274, "user_id": 7390929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WPB1g.jpg?s=128&g=1", "display_name": "Lucas Andrade", "link": "https://stackoverflow.com/users/7390929/lucas-andrade"}, "is_accepted": false, "score": 0, "last_activity_date": 1484069568, "creation_date": 1484069568, "answer_id": 41574851, "question_id": 41574720, "link": "https://stackoverflow.com/questions/41574720/vagrant-up-permission-denied-rb-sysopen/41574851#41574851", "title": "Vagrant Up - Permission denied @ rb_sysopen", "body": "<p>I also had a lot of problems with vagrant, I think is a good tool but still had many bugs. Every time I had problems with \n<code>vagrant up</code>\nI just restart my computer.</p>\n"}], "owner": {"reputation": 11, "user_id": 7055026, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7zClaSn20CU/AAAAAAAAAAI/AAAAAAAAADg/Tf89E0oWgA0/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/7055026/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 972, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484069568, "creation_date": 1484069178, "question_id": 41574720, "link": "https://stackoverflow.com/questions/41574720/vagrant-up-permission-denied-rb-sysopen", "title": "Vagrant Up - Permission denied @ rb_sysopen", "body": "<p>I'm having issues with my Vagrant after installing upgrading ruby and rails using Rbenv. Now my vagrant is no longer working. Here is my results from and trying to initialize with <code>vagrant up</code> </p>\n\n<pre><code>    Progress: 90%/opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/machine.rb:288:in `initialize': Permission denied @rb_sysopen - /vagrants/public-records/.vagrant/machines/default/virtualbox/id (Errno::EACCES)\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/machine.rb:288:in `open'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/machine.rb:288:in `open'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/machine.rb:288:in `id='\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/plugins/providers/virtualbox/action/import.rb:60:in `import'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/plugins/providers/virtualbox/action/import.rb:13:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/plugins/providers/virtualbox/action/prepare_clone_snapshot.rb:17:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/builtin/prepare_clone.rb:15:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/plugins/providers/virtualbox/action/customize.rb:40:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/plugins/providers/virtualbox/action/check_accessible.rb:18:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:95:in `block in finalize_action'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/builder.rb:116:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/runner.rb:66:in `block in run'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/util/busy.rb:19:in `busy'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/runner.rb:66:in `run'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/builtin/call.rb:53:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/builtin/config_validate.rb:25:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:95:in `block in finalize_action'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/builtin/handle_box.rb:56:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:95:in `block in finalize_action'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/builder.rb:116:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/runner.rb:66:in `block in run'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/util/busy.rb:19:in `busy'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/runner.rb:66:in `run'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/builtin/call.rb:53:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/plugins/providers/virtualbox/action/check_virtualbox.rb:17:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/warden.rb:34:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/builder.rb:116:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/runner.rb:66:in `block in run'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/util/busy.rb:19:in `busy'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/action/runner.rb:66:in `run'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/machine.rb:225:in `action_raw'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/machine.rb:200:in `block in action'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/environment.rb:567:in `lock'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/machine.rb:186:in `call'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/machine.rb:186:in `action'\nfrom /opt/vagrant/embedded/gems/gems/vagrant-1.8.6/lib/vagrant/batch_action.rb:82:in `block (2 levels) in run'\n</code></pre>\n\n<p>I also tried running <code>sudo chmod -R 1777 tmp/</code> but got the same results.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1484072977, "post_id": 41574375, "comment_id": 70356409, "body": "<b>Indentation</b> please! You&#39;ll catch mistakes like this if the errors are visible. Having this all completely disorganized is a huge problem. The second thing is to avoid using global variables unless it&#39;s absolutely necessary. Ruby&#39;s <code>$x</code> is not like the PHP or Perl equivalent where that&#39;s simply a variable, the <code>$</code> prefix means global. Additionally Ruby style recommends using <code>no_right</code>, all lower-case with underscores, for method and variable names, as case has significant meaning in Ruby."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7396695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e7ebfffc6cf1a73170fd8af905bdc6?s=128&d=identicon&r=PG&f=1", "display_name": "ga_r", "link": "https://stackoverflow.com/users/7396695/ga-r"}, "edited": false, "score": 0, "creation_date": 1484068576, "post_id": 41574418, "comment_id": 70353891, "body": "I changed that and it still wouldn&#39;t run, after changing &quot;when &lt;= 5&quot; to &quot;when $noRight &lt;= 5&quot; it runs but now the final output is the error- the original code worked fine."}, {"owner": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "reply_to_user": {"reputation": 1, "user_id": 7396695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e7ebfffc6cf1a73170fd8af905bdc6?s=128&d=identicon&r=PG&f=1", "display_name": "ga_r", "link": "https://stackoverflow.com/users/7396695/ga-r"}, "edited": false, "score": 0, "creation_date": 1484069073, "post_id": 41574418, "comment_id": 70354185, "body": "Case statements aren&#39;t really meant for inequalities.  The best you could do would likely by <code>when 5,4,3,2,1</code> instead."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1484069221, "post_id": 41574418, "comment_id": 70354273, "body": "Case statement are perfectly meant for inequalities in ruby, use <code>-Float::INFINITY..5</code> instead of <code>&lt;= 5</code> and voila\u0300."}], "tags": [], "owner": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "is_accepted": false, "score": 0, "last_activity_date": 1484068170, "creation_date": 1484068170, "answer_id": 41574418, "question_id": 41574375, "link": "https://stackoverflow.com/questions/41574375/ruby-syntax-error-unexpected-keyword-when-expecting-end-of-input/41574418#41574418", "title": "Ruby: syntax error, unexpected keyword_when, expecting end-of-input", "body": "<p>You don't need the <code>end</code> statements inside of the <code>when</code> block.  That's what's throwing the interpreter off.  Also, your multi-value <code>when</code> is wrong; it should be <code>when 9, 10</code> instead of <code>when 9 || 10</code> since that will evaluate to a truthy value.</p>\n\n<p>Remove those and your new code should be equivalent to your original code.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7396695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e7ebfffc6cf1a73170fd8af905bdc6?s=128&d=identicon&r=PG&f=1", "display_name": "ga_r", "link": "https://stackoverflow.com/users/7396695/ga-r"}, "edited": false, "score": 0, "creation_date": 1484070363, "post_id": 41574797, "comment_id": 70354943, "body": "Tried that and now it simply doesn&#39;t print out any results."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 1, "user_id": 7396695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e7ebfffc6cf1a73170fd8af905bdc6?s=128&d=identicon&r=PG&f=1", "display_name": "ga_r", "link": "https://stackoverflow.com/users/7396695/ga-r"}, "edited": false, "score": 0, "creation_date": 1484073462, "post_id": 41574797, "comment_id": 70356698, "body": "It is impossible. You have an induced error somewhere else. This code works perfectly."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1484070318, "last_edit_date": 1484070318, "creation_date": 1484069390, "answer_id": 41574797, "question_id": 41574375, "link": "https://stackoverflow.com/questions/41574375/ruby-syntax-error-unexpected-keyword-when-expecting-end-of-input/41574797#41574797", "title": "Ruby: syntax error, unexpected keyword_when, expecting end-of-input", "body": "<pre><code>def determine_grade\n  Console_Screen.cls #Clear the display area\n  #To pass the test the player must correctly retype 6 sentences\n  print case $noRight\n        when 9..10 then \"You get an A!\"\n        when 8 then \"You get a B!\"\n        when 7 then \"You get a C.\"\n        when 6 then \"You get a D.\"\n        when -Float::INFINITY..5 then \"You get an F.\"\n        else \"Error\"\n        end\nend  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7396695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e7ebfffc6cf1a73170fd8af905bdc6?s=128&d=identicon&r=PG&f=1", "display_name": "ga_r", "link": "https://stackoverflow.com/users/7396695/ga-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 439, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1484070318, "creation_date": 1484068061, "question_id": 41574375, "link": "https://stackoverflow.com/questions/41574375/ruby-syntax-error-unexpected-keyword-when-expecting-end-of-input", "title": "Ruby: syntax error, unexpected keyword_when, expecting end-of-input", "body": "<p>I'm trying to modify a script to include a case block but whenever I do I seem to get this error. I initially thought it was because I missed an end somewhere but I checked my entire code and it seems to check out fine.</p>\n\n<p>Working (before adding case):</p>\n\n<pre><code> def determine_grade\n Console_Screen.cls #Clear the display area\n #To pass the test the player must correctly retype 3 sentences\n if $noRight &gt;= 6 then\n #Inform the player of the good news\n print \"You retyped \" + $noRight.to_s + \" sentence(s)\" +\n \"correctly. \"\n puts \"You have passed the typing test!\\n\\nPress Enter\" +\n \"to continue.\"\n else #The player has failed the test\n#Inform the player of the bad news\n print \"You retyped \" + $noRight.to_s + \" sentence(s)\" +\n\"correctly. \"\nputs \"You have failed the typing test!\\n\\nPress Enter \nto continue.\"\nend\nend\nend\n</code></pre>\n\n<p>After:</p>\n\n<pre><code> def determine_grade\n Console_Screen.cls #Clear the display area\n #To pass the test the player must correctly retype 6 sentences\n case $noRight\n when 9 || 10\n    print \"You get an A!\"\n    end\n when 8\n    print \"You get a B!\"\n    end\n when 7\n    print \"You get a C.\"\n    end\n when 6\n    print \"You get a D.\"\n    end\n when &lt;= 5\n    print \"You get an F.\"\n    end\n else\n    print \"Error\"\n    end\n end\n end\n end\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby", "binary", "bit-manipulation", "bitwise-operators", "bit-shift"], "comments": [{"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1484070203, "post_id": 41573887, "comment_id": 70354854, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/141525/what-are-bitwise-shift-bit-shift-operators-and-how-do-they-work\">What are bitwise shift (bit-shift) operators and how do they work?</a>"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1484072518, "post_id": 41573887, "comment_id": 70356138, "body": "@EliSadoff no mention of <code>~</code> in the question you linked."}, {"owner": {"reputation": 1959, "user_id": 1207554, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/02bed14d16954900634cb83771445dc0?s=128&d=identicon&r=PG", "display_name": "Douglas G. Allen", "link": "https://stackoverflow.com/users/1207554/douglas-g-allen"}, "edited": false, "score": 0, "creation_date": 1495562840, "post_id": 41573887, "comment_id": 75302186, "body": "There is a lot chained together there. Is there any useful purpose for it or does it just happen to be somebody&#39;s sample/example?"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1484076526, "post_id": 41574340, "comment_id": 70358464, "body": "Excellent answer! Note the innermost set of parentheses is redundant: <code>((2*n)&gt;&gt;1) == (2*n&gt;&gt;1) #=&gt; true</code>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 8, "last_activity_date": 1484067967, "creation_date": 1484067967, "answer_id": 41574340, "question_id": 41573887, "link": "https://stackoverflow.com/questions/41573887/bitwise-operators-in-ruby-programming/41574340#41574340", "title": "Bitwise operators in ruby programming", "body": "<p>First, let\u2019s understand the operator precedence:</p>\n\n<pre><code># 5 3  4   1   2\n  ~(~1&lt;&lt;((2*n)&gt;&gt;1))\n</code></pre>\n\n<ol>\n<li><code>2*n</code> multiplies <code>n</code> by <code>2</code></li>\n<li><code>&gt;&gt;1</code> divides the result by <code>2</code> making these two operations completely redundant, the original code is 100% equal to <code>~(~1&lt;&lt;n)</code></li>\n<li><code>~1</code> is a <a href=\"https://ruby-doc.org/core-2.4.0/Integer.html#method-i-7E\" rel=\"nofollow noreferrer\">bitwise complement</a>, for <code>0b01</code> it is <code>-0b10</code>, which is <code>-2</code>,</li>\n<li><code>base&lt;&lt;power</code> is a doubled power, hence we have <code>-2^(5+1) = -64</code></li>\n<li>bitwise complement again produces <code>0b0111111</code> out of <code>-0b1000000</code>.</li>\n</ol>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1351104"}, "edited": false, "score": 0, "creation_date": 1484135044, "post_id": 41582183, "comment_id": 70383463, "body": "Concise, to the point and directly addresses the question at hand. Wait..."}], "tags": [], "owner": {"reputation": 1959, "user_id": 1207554, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/02bed14d16954900634cb83771445dc0?s=128&d=identicon&r=PG", "display_name": "Douglas G. Allen", "link": "https://stackoverflow.com/users/1207554/douglas-g-allen"}, "is_accepted": false, "score": 1, "last_activity_date": 1495562620, "last_edit_date": 1495562620, "creation_date": 1484105088, "answer_id": 41582183, "question_id": 41573887, "link": "https://stackoverflow.com/questions/41573887/bitwise-operators-in-ruby-programming/41582183#41582183", "title": "Bitwise operators in ruby programming", "body": "<p>Update edit.</p>\n\n<p>Let's describe as well as we may what is going on and what order they are in here.\nFirst let me give credit to the first answer about the redundancy of the original\nexpression. I start with the simple one.</p>\n\n<pre><code>def bitwise_complement_bits(args)\n  ~ args\nend\n\ndef bitwise_shift_left(o, n)\n  o &lt;&lt; n\nend\n\na = bitwise_complement_bits(1)\nb = bitwise_shift_left(a, 5)\np bitwise_complement_bits(b)\n</code></pre>\n\n<p>Update edit:</p>\n\n<p><a href=\"http://www.pythontutor.com/visualize.html#code=def%20bitwise_complement_bits%28args%29%0A%20%20~%20args%0Aend%0A%0Adef%20bitwise_shift_left%28o,%20n%29%0A%20%20o%20%3C%3C%20n%0Aend%0A%0Aa%20%3D%20bitwise_complement_bits%281%29%0Ab%20%3D%20bitwise_shift_left%28a,%205%29%0Ap%20bitwise_complement_bits%28b%29&amp;cumulative=false&amp;curInstr=0&amp;heapPrimitives=false&amp;mode=display&amp;origin=opt-frontend.js&amp;py=ruby&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false\" rel=\"nofollow noreferrer\">Here's a nifty site for some quick evaluation of code.</a></p>\n\n<p>I just pasted in what we had here. You may step though it there and really see what is going on. </p>\n\n<p>Or you can use your own installation as well as repl.it <a href=\"https://repl.it/languages/ruby\" rel=\"nofollow noreferrer\">https://repl.it/languages/ruby</a>\nHave fun!</p>\n"}], "owner": {"reputation": 508, "user_id": 3108224, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pKwqD.jpg?s=128&g=1", "display_name": "Rikkas", "link": "https://stackoverflow.com/users/3108224/rikkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 41574340, "answer_count": 2, "score": 1, "last_activity_date": 1495562620, "creation_date": 1484066584, "question_id": 41573887, "link": "https://stackoverflow.com/questions/41573887/bitwise-operators-in-ruby-programming", "title": "Bitwise operators in ruby programming", "body": "<p>Bitwise operators is tough to understand. Can somebody explain the ruby code below in detail? </p>\n\n<pre><code> def res(n)\n ~(~1&lt;&lt;((2*n)&gt;&gt;1))\n end\n\n res(5) --&gt; 63\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rescue"], "comments": [{"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1484065907, "post_id": 41573640, "comment_id": 70352028, "body": "What exactly do you want to do? It is not clear to me."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1484065912, "post_id": 41573640, "comment_id": 70352033, "body": "What do you think backtrace is for? It&#39;s exactly for requests like this."}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1484065991, "post_id": 41573640, "comment_id": 70352076, "body": "I would like to know if there is a method that can be called that would return the name &quot;client.list_order_items_by_next_token&quot; :  I am setting up a retry section but I need to know what caused the error to pull a message from the locale file. @EddeAlmeida"}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1484066142, "post_id": 41573640, "comment_id": 70352167, "body": "@SergioTulentsev did that comment help?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1484066271, "post_id": 41573640, "comment_id": 70352246, "body": "@chrishough: it became a bit clearer what you&#39;re up to, but the answer is still the same. :)"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 1, "creation_date": 1484066276, "post_id": 41573640, "comment_id": 70352252, "body": "dig into <a href=\"https://ruby-doc.org/core-2.3.1/Exception.html#method-i-backtrace\" rel=\"nofollow noreferrer\"><code>error.backtrace</code></a> ;)"}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1484066681, "post_id": 41573640, "comment_id": 70352538, "body": "Is that the only way @AndreyDeineko?  that would be rather slow right?"}, {"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1484068559, "post_id": 41573640, "comment_id": 70353876, "body": "Let me address performance concerns in an answer."}], "answers": [{"tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 0, "last_activity_date": 1484068537, "creation_date": 1484068537, "answer_id": 41574520, "question_id": 41573640, "link": "https://stackoverflow.com/questions/41573640/retrieve-method-that-caused-error-using-rescue/41574520#41574520", "title": "Retrieve method that caused error using Rescue", "body": "<p>Just use</p>\n\n<pre><code>error.backtrace\n</code></pre>\n\n<p>Don't worry about performance.</p>\n\n<p>By the time you rescue the exception the cost of creating the backtrace has already occurred. The backtrace is created when the exception is raised. And it is expensive! Ruby has to create <code>O(N)</code> new strings whenever an exception is raised, where <code>N</code> is the depth of the stacktrace. Which can be 1000+ in a common Rails application. It gets even worse in a loop. And all these strings are usually never used and just clog up garbage collection. In our production system those backtrace strings are one of the major causes of performance degradation. But as I said, that cost occurs when the exception is raised, accessing the backtrace later is free of cost.</p>\n"}], "owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 41574520, "answer_count": 1, "score": 1, "last_activity_date": 1516702819, "creation_date": 1484065804, "last_edit_date": 1516702819, "question_id": 41573640, "link": "https://stackoverflow.com/questions/41573640/retrieve-method-that-caused-error-using-rescue", "title": "Retrieve method that caused error using Rescue", "body": "<p>Let's say you have the following example code block:</p>\n\n<pre><code>  def next_page(next_token)\n    client.list_order_items_by_next_token(next_token)\n  rescue =&gt; error\n    binding.pry\n  end\n</code></pre>\n\n<p>Without diving into the issue that this rescue is capturing all errors and how that is bad (this block has been modified) is there a way to determine the method <code>list_order_items_by_next_token</code> caused the issue? I know the stack trace is available but that does not feel right.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "encoding", "utf-8", "strip"], "answers": [{"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484067179, "post_id": 41573540, "comment_id": 70352893, "body": "Thanks but how do I override the strip function so that this is automatically included?  Although this works for my specific example, it would mean I would have to go through my entire application and replace &quot;strip&quot; with &quot;force_encoding(&#39;binary&#39;).strip,&quot; which I&#39;m trying to avoid."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484067455, "post_id": 41573540, "comment_id": 70353076, "body": "You don&#39;t want to touch the strip method. It is used everywhere in many gems."}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 1, "creation_date": 1484069347, "post_id": 41573540, "comment_id": 70354329, "body": "I do.  If other stuff breaks, that is my own damn fault, but when I said &quot;how can I override the strip method&quot; in my question, I genuinely mean it, crazy as it may seem."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484069998, "post_id": 41573540, "comment_id": 70354745, "body": "Ahah! :D Roger that."}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484249980, "post_id": 41573540, "comment_id": 70444445, "body": "Hey thanks so much for your updated answer.  THis is awesome!  Jus tone question -- where do I place the &quot;class String&quot; file?  Would I put that in my Rails installation or is there a project-specific place I can stick the file (please say a project-specific place)?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1484250574, "post_id": 41573540, "comment_id": 70444817, "body": "In Ruby, every class can be re-opened at any time. So you really can put this code wherever you want, as long as it is executed before you try to use this modified method. See update"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1484250506, "last_edit_date": 1495542273, "creation_date": 1484065520, "answer_id": 41573540, "question_id": 41573361, "link": "https://stackoverflow.com/questions/41573361/how-do-i-prevent-strip-from-dying-when-it-encounters-a-non-utf-8-character-witho/41573540#41573540", "title": "How do I prevent strip from dying when it encounters a non-UTF-8 character without manipulating my string before applying strip?", "body": "<p>The best idea would be to make sure your data has correct encoding.</p>\n\n<h1>Alternative</h1>\n\n<p>You could use :</p>\n\n<pre><code>\"\\r\\n  \\xA0PLACE \\r\\n  \".force_encoding('binary').strip\n</code></pre>\n\n<p>It returns :</p>\n\n<pre><code>\"\\xA0PLACE\"\n</code></pre>\n\n<h1>Handle with care!!!!</h1>\n\n<p>If you feel adventurous, you could just override <code>String#strip</code> :</p>\n\n<pre><code>### Proof of concept\n### HANDLE WITH CARE!!!\nclass String\n  alias_method :original_strip, :strip\n  def strip\n    self.force_encoding('binary').original_strip\n  end\nend\n\np \"\\r\\n  \\xA0PLACE \\r\\n  \".strip\n#=&gt; \"\\xA0PLACE\"\n</code></pre>\n\n<p>A <a href=\"https://ruby-doc.org/core-2.1.1/doc/syntax/refinements_rdoc.html\" rel=\"nofollow noreferrer\">refinement</a> might limit the damage.</p>\n\n<p>For a Rails project, you'd just need to put this code in an <a href=\"https://stackoverflow.com/a/5654574/6419007\">initializer</a>.</p>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484250506, "creation_date": 1484064972, "last_edit_date": 1484066905, "question_id": 41573361, "link": "https://stackoverflow.com/questions/41573361/how-do-i-prevent-strip-from-dying-when-it-encounters-a-non-utf-8-character-witho", "title": "How do I prevent strip from dying when it encounters a non-UTF-8 character without manipulating my string before applying strip?", "body": "<p>I'm using Ruby 2.4 with Rails 5.  I have the following String </p>\n\n<pre><code>2.4.0 :005 &gt; tr = doc.search(\"//td\").first.text\n =&gt; \"\\r\\n  \\xA0PLACE \\r\\n  \" \n</code></pre>\n\n<p>the String is UTF-8 encoded, although this is just an example.  I'm not guaranteed that all data will have UTF-8 encoding.</p>\n\n<pre><code>2.4.0 :007 &gt; tr = doc.search(\"//td\").first.text.encoding\n =&gt; #&lt;Encoding:UTF-8&gt; \n</code></pre>\n\n<p>but when I apply the \"strip\" method to it, the call dies</p>\n\n<pre><code>2.4.0 :006 &gt; tr = doc.search(\"//td\").first.text.strip\nArgumentError: invalid byte sequence in UTF-8\n</code></pre>\n\n<p>This is just an example, but how can I override the strip method so it doesn't die when it encounters a character it doesn't like?  I don't want to change the string in question.  I'm happy to write my own \"strip\" method, but I want to be able to keep the above exactly as I have it and just not have the error thrown.</p>\n"}, {"tags": ["ruby", "selenium", "webdriver", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1484082879, "post_id": 41575733, "comment_id": 70361866, "body": "This is exactly what I was looking for! It works, thank you!"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1484072520, "creation_date": 1484072520, "answer_id": 41575733, "question_id": 41572392, "link": "https://stackoverflow.com/questions/41572392/capybara-selenium-force-to-reload-selenium-driver-on-each-call/41575733#41575733", "title": "Capybara/Selenium - force to reload Selenium Driver on each call", "body": "<p>Capybara's <code>register_driver</code> registers the driver by the name you assign globally, and will use those drivers (by name) in its sessions.  It will also automatically manage sessions in a manner designed for ease of use by people testing web-apps.   The issue here is that a new session with the newly registered driver isn't being created. This is because you're not really using Capybara for what it was designed, and therefore need to pick up a bit more of the weight of session management.  If you're ever going to have more than 2 of your MyParser objects around you probably should be creating a new session per MyParser instance you create and then using that session in all of the MyParser methods.  Since you're using different driver settings per MyParser instance you should probably also be naming each driver registered differently.</p>\n\n<pre><code>class MyParser\n  def initialize(path_to_firefox_profile)\n    Capybara.register_driver(self.object_id.to_s) do |app|\n      client = Selenium::WebDriver::Remote::Http::Default.new\n      client.timeout = 150\n      Capybara::Selenium::Driver.new(app,\n        profile: path_to_firefox_profile,\n        http_client: client)\n    end\n    @session = Capybara::Session.new(self.object_id.to_s)\n  end\n\n  def parse_something\n    @session.visit(\"some url\")\n    @session.find(...)  # perform some parsings &amp; return result\n  end\nend\n</code></pre>\n\n<p>You will also need to handle cleaning up the session when you're done with each MyParser instance.</p>\n"}], "owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 1, "accepted_answer_id": 41575733, "answer_count": 1, "score": 0, "last_activity_date": 1484072520, "creation_date": 1484062107, "question_id": 41572392, "link": "https://stackoverflow.com/questions/41572392/capybara-selenium-force-to-reload-selenium-driver-on-each-call", "title": "Capybara/Selenium - force to reload Selenium Driver on each call", "body": "<p>I have a solution to parse some data from a remote websites using Firefox(46) + Capybara + Selenium. I pass <code>path_to_firefox_profile</code> argument on initialize, which is some real Firefox profile folder.</p>\n\n<p>The problem is that if I execute this code:</p>\n\n<pre><code>a = MyParser.new(profile_a)\na.parse_something\nb = MyParser.new(profile_b)\nb.parse_something\n</code></pre>\n\n<p>... the instance <code>b</code> will have profile A loaded despite I specified another profile. </p>\n\n<p>But, if I run these 2 lines in a separate processes, I'll get what I want. So I assume one of them - either Capybara or Selenium - stores profiles settings once per ruby process, and won't change it on demand.</p>\n\n<p>Are there are ideas how to change profile within the same process?</p>\n\n<p>I tries to <code>.quit</code> Firefox, but it doesn't help, on visiting new URL Selenium opens another Firefox window with the exact same profile instead of new one.</p>\n\n<pre><code>class MyParser\n  def initialize(path_to_firefox_profile)\n    Capybara.register_driver(:selenium) do |app|\n      client = Selenium::WebDriver::Remote::Http::Default.new\n      client.timeout = 150\n      Capybara::Selenium::Driver.new(app,\n        profile: path_to_firefox_profile,\n        http_client: client)\n    end\n  end\n\n  def parse_something\n    # perform some parsings &amp; return result\n  end\nend\n</code></pre>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1484062852, "post_id": 41572319, "comment_id": 70349889, "body": "What database? Most DBs provide some date parsing options but it is going to be DB specific. I would migrate to a real date type column ASAP though. Thats a horrible date format since it cannot simply be numerically compared like a ISO 8601 date anyways."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1484063119, "post_id": 41572319, "comment_id": 70350059, "body": "Since your setup is not typical please provide which DB, and a small example of what the data looks like."}], "answers": [{"comments": [{"owner": {"reputation": 74, "user_id": 6058578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1010566642351525/picture?type=large", "display_name": "Rafa\u0142 Piekara", "link": "https://stackoverflow.com/users/6058578/rafa%c5%82-piekara"}, "edited": false, "score": 0, "creation_date": 1484062559, "post_id": 41572497, "comment_id": 70349701, "body": "Hi @NickM, thank you for your response but I need the solution with pure RoR, without any gem."}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1484062691, "last_edit_date": 1484062691, "creation_date": 1484062432, "answer_id": 41572497, "question_id": 41572319, "link": "https://stackoverflow.com/questions/41572319/ruby-on-rails-where-query-with-time-parse/41572497#41572497", "title": "Ruby on Rails - where query with Time parse", "body": "<p>You're going to have trouble parsing a string column to date unless you can use a native SQL function.</p>\n\n<p>You may have to consider reformatting your date column to a more conventional datetime format, but you can use <code>chronic</code> for that as well.</p>\n\n<p>In a migration:</p>\n\n<pre><code>Article.find_each do |article|\n  stamp = Chronic.parse(article.date)\n  article.update_attributes(date: stamp)\nend\n</code></pre>\n\n<p>In short, <code>chronic</code> makes it easy to handle unconventional date formats, which you kind of have going on here. If you run the above migration you can run the following query, which is much cleaner:</p>\n\n<p><code>Article.where(\"date &lt;= ?\", Time.now)</code></p>\n"}, {"comments": [{"owner": {"reputation": 74, "user_id": 6058578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1010566642351525/picture?type=large", "display_name": "Rafa\u0142 Piekara", "link": "https://stackoverflow.com/users/6058578/rafa%c5%82-piekara"}, "edited": false, "score": 0, "creation_date": 1484062655, "post_id": 41572538, "comment_id": 70349765, "body": "Unfortunately it&#39;s a string."}, {"owner": {"reputation": 16977, "user_id": 2518355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3ed231a208476815d1b89dcc045aa6?s=128&d=identicon&r=PG", "display_name": "wjordan", "link": "https://stackoverflow.com/users/2518355/wjordan"}, "reply_to_user": {"reputation": 74, "user_id": 6058578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1010566642351525/picture?type=large", "display_name": "Rafa\u0142 Piekara", "link": "https://stackoverflow.com/users/6058578/rafa%c5%82-piekara"}, "edited": false, "score": 0, "creation_date": 1484064217, "post_id": 41572538, "comment_id": 70350835, "body": "Updated with an answer that should work for MySQL- or you can probably do something similar if using another database implementation."}, {"owner": {"reputation": 16977, "user_id": 2518355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3ed231a208476815d1b89dcc045aa6?s=128&d=identicon&r=PG", "display_name": "wjordan", "link": "https://stackoverflow.com/users/2518355/wjordan"}, "reply_to_user": {"reputation": 74, "user_id": 6058578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1010566642351525/picture?type=large", "display_name": "Rafa\u0142 Piekara", "link": "https://stackoverflow.com/users/6058578/rafa%c5%82-piekara"}, "edited": false, "score": 0, "creation_date": 1484127443, "post_id": 41572538, "comment_id": 70378241, "body": "@RafalPiekara Glad to hear it&#39;s working. If this answer helped solve your question, next step is to <a href=\"http://meta.stackexchange.com/a/5235/327137\">mark it as Accepted</a>. Welcome to Stack Overflow!"}], "tags": [], "owner": {"reputation": 16977, "user_id": 2518355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3ed231a208476815d1b89dcc045aa6?s=128&d=identicon&r=PG", "display_name": "wjordan", "link": "https://stackoverflow.com/users/2518355/wjordan"}, "is_accepted": true, "score": 1, "last_activity_date": 1484063057, "last_edit_date": 1484063057, "creation_date": 1484062585, "answer_id": 41572538, "question_id": 41572319, "link": "https://stackoverflow.com/questions/41572319/ruby-on-rails-where-query-with-time-parse/41572538#41572538", "title": "Ruby on Rails - where query with Time parse", "body": "<p>This might work, if your underlying database can use the MySQL <a href=\"http://dev.mysql.com/doc/refman/5.7/en/date-and-time-functions.html#function_str-to-date\" rel=\"nofollow noreferrer\"><code>STR_TO_DATE</code></a> function:</p>\n\n<pre><code>Article.where(\"STR_TO_DATE(date, '%m/%d/%Y') &lt; ?)\", Time.now)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1484062945, "post_id": 41572621, "comment_id": 70349955, "body": "Won&#39;t work either way since OP has the dates stored in string column."}, {"owner": {"reputation": 95, "user_id": 6129289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qXEXx.png?s=128&g=1", "display_name": "LBarry", "link": "https://stackoverflow.com/users/6129289/lbarry"}, "reply_to_user": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1484063241, "post_id": 41572621, "comment_id": 70350136, "body": "I did not notice that, thank you. That is a problem. Although I&#39;m not sure why he can&#39;t just rollback and change the column type, but that probably has something to do with the rest of his application."}], "tags": [], "owner": {"reputation": 95, "user_id": 6129289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qXEXx.png?s=128&g=1", "display_name": "LBarry", "link": "https://stackoverflow.com/users/6129289/lbarry"}, "is_accepted": false, "score": 0, "last_activity_date": 1484062799, "creation_date": 1484062799, "answer_id": 41572621, "question_id": 41572319, "link": "https://stackoverflow.com/questions/41572319/ruby-on-rails-where-query-with-time-parse/41572621#41572621", "title": "Ruby on Rails - where query with Time parse", "body": "<p>I believe this should work for you:</p>\n\n<p><code>Article.where('date &lt; ?', Time.now)</code></p>\n\n<p>This will pull all the records where the date at is before today.</p>\n\n<p>EDIT:\nDamn, I was writing this answer while three other people were writing the same thing. Sorry</p>\n"}], "owner": {"reputation": 74, "user_id": 6058578, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1010566642351525/picture?type=large", "display_name": "Rafa\u0142 Piekara", "link": "https://stackoverflow.com/users/6058578/rafa%c5%82-piekara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "accepted_answer_id": 41572538, "answer_count": 3, "score": 1, "last_activity_date": 1484063057, "creation_date": 1484061909, "last_edit_date": 1484062775, "question_id": 41572319, "link": "https://stackoverflow.com/questions/41572319/ruby-on-rails-where-query-with-time-parse", "title": "Ruby on Rails - where query with Time parse", "body": "<p>How can I select all records where the date is past?</p>\n\n<p>I have \"Date\" column with format : '%m/%d/%Y' e.g \"01/10/2017\".\nColumn type is string, I can't change the type.</p>\n\n<p>How should I write query.</p>\n\n<p>Something like: <code>Article.where(Time.parse(:date).past?)</code>?</p>\n\n<p>I need solution in pure RoR, without any gem.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 5582, "user_id": 27060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50576d785edd6db7d1999810863bcb01?s=128&d=identicon&r=PG", "display_name": "Reuben Mallaby", "link": "https://stackoverflow.com/users/27060/reuben-mallaby"}, "edited": false, "score": 0, "creation_date": 1484062158, "post_id": 41572287, "comment_id": 70349411, "body": "The before action(previously filter) should be stated near the top of your controller. As it is &quot;before&quot; your action code is not useful, If you have a line or more that says &quot;before_filter.....&quot; simply change it to &quot;before_action&quot;. The cheeky code may even be in your ApplicationController."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1484063788, "post_id": 41572287, "comment_id": 70350528, "body": "Just use a find and replace tool and replace <code>before_filter</code>  with <code>before_action</code>. The free Atom text editor has a pretty good find and replace that works in your whole project dir. Otherwise you can use grep <code>grep -rl before_filter app&#47;controllers | xargs sed -i &#39;s&#47;before_filter&#47;before_action&#47;g&#39; </code>"}], "answers": [{"tags": [], "owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "is_accepted": true, "score": 3, "last_activity_date": 1484062186, "creation_date": 1484062186, "answer_id": 41572416, "question_id": 41572287, "link": "https://stackoverflow.com/questions/41572287/deprecation-warning-before-filter-is-deprecated-and-will-be-removed-in-rails-5/41572416#41572416", "title": "DEPRECATION WARNING: before_filter is deprecated and will be removed in Rails 5.1. Use before_action instead", "body": "<p>This is just depreciation warning which can turn into error if you upgrade your app to rails <code>5.1</code>, as clearly mentioned on the log you can resolve it by searching through your controller where you are using <code>before_filter</code> and replace it with <code>before_action</code>.</p>\n\n<p><code>before_action</code> does the same thing (run some code before the request hit the action in your controller) that <code>before_filter</code> does in earlier versions of rails. </p>\n"}, {"tags": [], "owner": {"reputation": 16977, "user_id": 2518355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3ed231a208476815d1b89dcc045aa6?s=128&d=identicon&r=PG", "display_name": "wjordan", "link": "https://stackoverflow.com/users/2518355/wjordan"}, "is_accepted": false, "score": 0, "last_activity_date": 1484062328, "creation_date": 1484062328, "answer_id": 41572465, "question_id": 41572287, "link": "https://stackoverflow.com/questions/41572287/deprecation-warning-before-filter-is-deprecated-and-will-be-removed-in-rails-5/41572465#41572465", "title": "DEPRECATION WARNING: before_filter is deprecated and will be removed in Rails 5.1. Use before_action instead", "body": "<p>The <code>DEPRECATION WARNING</code> line is coming from your <code>application_controller.rb</code>, just change <code>before_filter</code> to <code>before_action</code> and this warning will go away.</p>\n\n<p>The <code>Can't verify CSRF token authenticity</code> is the actual error preventing the correct results from being returned. If your controller doesn't require the CSRF token for JSON requests, you should add a line like the following to your controller:</p>\n\n<pre><code>skip_before_action :verify_authenticity_token, if: :json_request?\n</code></pre>\n"}], "owner": {"reputation": 126, "user_id": 5747405, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f6df507d43a44a61ddad066e32a90c40?s=128&d=identicon&r=PG&f=1", "display_name": "Shital luitel", "link": "https://stackoverflow.com/users/5747405/shital-luitel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1356, "favorite_count": 0, "accepted_answer_id": 41572416, "answer_count": 2, "score": 2, "last_activity_date": 1484065388, "creation_date": 1484061824, "last_edit_date": 1484065388, "question_id": 41572287, "link": "https://stackoverflow.com/questions/41572287/deprecation-warning-before-filter-is-deprecated-and-will-be-removed-in-rails-5", "title": "DEPRECATION WARNING: before_filter is deprecated and will be removed in Rails 5.1. Use before_action instead", "body": "<p>What is happening here? I am trying to add data through ajax call with JSON datatype. But each time I try to add data it shows error as shown in the image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/OFwz2.png\" rel=\"nofollow noreferrer\">Rails log in terminal</a></p>\n\n<p>I think it always respond to html format but does not respond to json format.</p>\n\n<pre><code>def new\n  @batch = Batch.new\n  respond_to do |format|\n    format.json\n    format.html\n  end\nend\n\ndef create\n  @batch = Batch.new(batch_param)\n  puts \"/n/n/n/n name: #{@batch.name} /n/n/n/n\"\n  respond_to do |format|\n     if @batch.save\n       format.json { render json: @batch, status: :created, location: @batch }\n       format.html { redirect_to @batch, notice: \"Save process completed!\" }\n     else\n      format.html {\n        flash.now[:notice]=\"Save proccess coudn't be completed!\"\n        render :new\n      }\n      format.json { render json: @batch.errors, status: :unprocessable_entity}\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1484061875, "post_id": 41572263, "comment_id": 70349218, "body": "what do your logs say?  <code>log&#47;test.log</code>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1484063437, "post_id": 41572263, "comment_id": 70350284, "body": "That the controller returns 200 tells you nothing. You can have a controller that does absolutely nothing and still returns 200. Please include the actual code under test."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1484065533, "post_id": 41572263, "comment_id": 70351795, "body": "Your controller of course."}, {"owner": {"reputation": 301, "user_id": 7338173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cf5f4cc9a6c6173f95951a727c87cc59?s=128&d=identicon&r=PG&f=1", "display_name": "Jodooomi", "link": "https://stackoverflow.com/users/7338173/jodooomi"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1484066214, "post_id": 41572263, "comment_id": 70352214, "body": "@max the same as here <a href=\"http://stackoverflow.com/questions/41568643/unable-to-create-a-model-in-rspec-via-post/41569446#41569446\" title=\"unable to create a model in rspec via post\">stackoverflow.com/questions/41568643/&hellip;</a> but for update"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1484066384, "post_id": 41572263, "comment_id": 70352325, "body": "When asked for supplementary information add it to the question itself. Don&#39;t expect people willing to help you to dig around, and don&#39;t make us guess..."}, {"owner": {"reputation": 301, "user_id": 7338173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cf5f4cc9a6c6173f95951a727c87cc59?s=128&d=identicon&r=PG&f=1", "display_name": "Jodooomi", "link": "https://stackoverflow.com/users/7338173/jodooomi"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1484115244, "post_id": 41572263, "comment_id": 70372079, "body": "@max, I will expect."}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 6341982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10206246890437893/picture?type=large", "display_name": "Luiz Henrique", "link": "https://stackoverflow.com/users/6341982/luiz-henrique"}, "is_accepted": false, "score": 1, "last_activity_date": 1484113526, "creation_date": 1484113526, "answer_id": 41583511, "question_id": 41572263, "link": "https://stackoverflow.com/questions/41572263/updating-in-rspec-isnt-working-although-the-status-is-200/41583511#41583511", "title": "Updating in Rspec isn&#39;t working, although the status is 200", "body": "<p>I don't know what are your attributes on attr, but try this:</p>\n\n<pre><code>describe \"PUT #update\" do\n      let(:option) { assigns(:option) }\n\n      before(:each) do\n        attr1 = { .............. }\n        u1 = create(:user, attr1....)\n        put :update, params: {\n          user: attributes_for(:user, name: \"name2\", email: \"email2@mail.com\"),\n          id: u1.id\n        }\n      end\n\n      it \"should be success\" do\n        expect(response.status).to eq(200)\n      end\n\n      it \"should update attributes\" do\n        expect(u1.name).to \"name2\"\n      end\n    end\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 7338173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cf5f4cc9a6c6173f95951a727c87cc59?s=128&d=identicon&r=PG&f=1", "display_name": "Jodooomi", "link": "https://stackoverflow.com/users/7338173/jodooomi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1484113526, "creation_date": 1484061745, "question_id": 41572263, "link": "https://stackoverflow.com/questions/41572263/updating-in-rspec-isnt-working-although-the-status-is-200", "title": "Updating in Rspec isn&#39;t working, although the status is 200", "body": "<p>I'm trying to update a User in Rspec:</p>\n\n<pre><code>require \"rails_helper\"\n\nRSpec.describe UsersController, type: :controller do\n  describe \"PUT #update\" do\n    it 'should update a user' do\n        attr1 = { .............. }\n        u1 = User.create!(attr1)\n        put :update, { id: u1.to_param, user: attr1.merge({name: \"name2\", email: \"email2@mail.com\"}) }, format: :json\n        u1.reload\n\n        expect(response.status).to eq(200)\n        expect(u1.name).to eq(\"name2\")\n</code></pre>\n\n<p>The status is 200, but in the body the attributes that are returned aren't updated.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "haml"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3789327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Vvb4X.png?s=128&g=1", "display_name": "mtreize", "link": "https://stackoverflow.com/users/3789327/mtreize"}, "edited": false, "score": 0, "creation_date": 1484081999, "post_id": 41573866, "comment_id": 70361339, "body": "Oh, i get it, i was being dumb. Thanks !"}], "tags": [], "owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "is_accepted": true, "score": 0, "last_activity_date": 1484066552, "creation_date": 1484066552, "answer_id": 41573866, "question_id": 41572260, "link": "https://stackoverflow.com/questions/41572260/rails-get-js-variable-inside-ruby-inside-inline-js/41573866#41573866", "title": "Rails : get JS variable inside ruby inside inline js", "body": "<p>The rendering of the partial happens <em>before</em> the <code>click</code> event. In fact, the partial is rendered on the server, before the browser receives a response.</p>\n\n<p>You must use an XHR to replace the contents of <code>#my_destination_div</code>. See <a href=\"https://api.jquery.com/load/\" rel=\"nofollow noreferrer\">https://api.jquery.com/load/</a></p>\n\n<blockquote>\n  <p><code>.load( url [, data ] [, complete ] )</code></p>\n  \n  <p>Description: Load data from the server and place the returned HTML into the matched element.</p>\n  \n  <p>This method is the simplest way to fetch data from the server.</p>\n  \n  <p><a href=\"https://api.jquery.com/load/\" rel=\"nofollow noreferrer\">https://api.jquery.com/load/</a></p>\n</blockquote>\n"}], "owner": {"reputation": 57, "user_id": 3789327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Vvb4X.png?s=128&g=1", "display_name": "mtreize", "link": "https://stackoverflow.com/users/3789327/mtreize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 41573866, "answer_count": 1, "score": 0, "last_activity_date": 1484066552, "creation_date": 1484061736, "question_id": 41572260, "link": "https://stackoverflow.com/questions/41572260/rails-get-js-variable-inside-ruby-inside-inline-js", "title": "Rails : get JS variable inside ruby inside inline js", "body": "<p>I need to change some div content depending on the link the user clicked.\nHere is my code</p>\n\n<pre><code>:javascript\n  $('.some_clickable_item').on('click', function(e) {\n    clicked_element_id=$(this).data(\"element_id\")\n    $('#my_destination_div').html(\"#{ render partial: \"dashboard/some_partial_name\", locals: {item_id: clicked_element_id} }\");\n  })\n</code></pre>\n\n<p>Obviously, this is not working because clicked_element_id is a js variable, but i need to pass it to my partial.</p>\n\n<p>Any simple idea to make it work ?\nThanks !!</p>\n"}]